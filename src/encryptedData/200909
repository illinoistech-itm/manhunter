From java-user-return-42088-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 06:24:51 2009
Return-Path: <java-user-return-42088-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51694 invoked from network); 1 Sep 2009 06:24:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 06:24:51 -0000
Received: (qmail 15661 invoked by uid 500); 1 Sep 2009 06:24:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15578 invoked by uid 500); 1 Sep 2009 06:24:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15568 invoked by uid 99); 1 Sep 2009 06:24:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 06:24:48 +0000
X-ASF-Spam-Status: No, hits=1.1 required=10.0
	tests=FORGED_HOTMAIL_RCVD2,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 06:24:39 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MiMmw-0002LW-7k
	for java-user@lucene.apache.org; Mon, 31 Aug 2009 23:24:18 -0700
Message-ID: <25234966.post@talk.nabble.com>
Date: Mon, 31 Aug 2009 23:24:18 -0700 (PDT)
From: marquinhocb <marquinhocb@hotmail.com>
To: java-user@lucene.apache.org
Subject: Score for query-generated value
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: marquinhocb@hotmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


I would like to create a scorer that applies a score based on a value that is
calculated during a query.  More specifically, to apply a score based on
geographical distance from a latitude,longitude.

What is the easiest way to go about doing this?  The LocalLucene contrib
uses a SortComparatorSource, but I would like to, if possible, use the
scoring mechanism so that distance is scored just like all other fields,
thus allowing for searches which give more/less weight to distance (and for
example, more weight to a closer-matching search term).

Are there any good examples of how to do this? Or can someone point me in
the right direction?

Ideally I would create a CustomScoreQuery (instead of a ConstantScoreQuery)
that would take in a filter that would automatically give matching documents
a score, but I don't see a straight-forward way of doing this.
-- 
View this message in context: http://www.nabble.com/Score-for-query-generated-value-tp25234966p25234966.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42089-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 08:49:00 2009
Return-Path: <java-user-return-42089-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92270 invoked from network); 1 Sep 2009 08:49:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 08:49:00 -0000
Received: (qmail 54969 invoked by uid 500); 1 Sep 2009 08:48:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54866 invoked by uid 500); 1 Sep 2009 08:48:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54856 invoked by uid 99); 1 Sep 2009 08:48:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 08:48:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.204] (HELO mail-yx0-f204.google.com) (209.85.210.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 08:48:48 +0000
Received: by yxe42 with SMTP id 42so1268785yxe.20
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 01:48:26 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.88.27 with SMTP id l27mr11221887ybb.23.1251794906290; Tue, 
	01 Sep 2009 01:48:26 -0700 (PDT)
In-Reply-To: <25234966.post@talk.nabble.com>
References: <25234966.post@talk.nabble.com>
Date: Tue, 1 Sep 2009 04:48:26 -0400
Message-ID: <9ac0c6aa0909010148sc1e81a6y19f3cc8a467951c4@mail.gmail.com>
Subject: Re: Score for query-generated value
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Function queries should work here? (org.apache.lucene.search.function.*).

Mike

On Tue, Sep 1, 2009 at 2:24 AM, marquinhocb<marquinhocb@hotmail.com> wrote:
>
> I would like to create a scorer that applies a score based on a value tha=
t is
> calculated during a query. =A0More specifically, to apply a score based o=
n
> geographical distance from a latitude,longitude.
>
> What is the easiest way to go about doing this? =A0The LocalLucene contri=
b
> uses a SortComparatorSource, but I would like to, if possible, use the
> scoring mechanism so that distance is scored just like all other fields,
> thus allowing for searches which give more/less weight to distance (and f=
or
> example, more weight to a closer-matching search term).
>
> Are there any good examples of how to do this? Or can someone point me in
> the right direction?
>
> Ideally I would create a CustomScoreQuery (instead of a ConstantScoreQuer=
y)
> that would take in a filter that would automatically give matching docume=
nts
> a score, but I don't see a straight-forward way of doing this.
> --
> View this message in context: http://www.nabble.com/Score-for-query-gener=
ated-value-tp25234966p25234966.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42090-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 09:34:01 2009
Return-Path: <java-user-return-42090-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3608 invoked from network); 1 Sep 2009 09:34:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 09:34:01 -0000
Received: (qmail 28348 invoked by uid 500); 1 Sep 2009 09:33:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28231 invoked by uid 500); 1 Sep 2009 09:33:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28207 invoked by uid 99); 1 Sep 2009 09:33:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 09:33:57 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 09:33:45 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n819XMla003078
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 10:33:22 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Tue, 01 Sep 2009 10:33:22 +0100 (BST)
Date: Tue, 1 Sep 2009 10:33:22 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <863227869.20901251797602027.JavaMail.root@mail.uk.scalix.com>
In-Reply-To: <695C6352-5CCC-4603-9211-0C931448529E@apache.org>
Subject: RE: New "Stream closed" exception with Java 6
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Hi Grant,
 
>>I think you code there needs to show the underlying exception, too, so  
>>we can see that stack trace.

Ummm... isn't this code already doing that?  What am I missing?

            try {

                indexWriter.addDocument(doc);

            } catch (CorruptIndexException ex) {

                throw new IndexerException ("CorruptIndexException on doc: " + doc.toString() +

                    " - " + ex.toString());

            } catch (IOException ex) {

                throw new IndexerException ("IOException on doc: " + doc.toString() +

                    " - " + ex.toString());

            }

Thanks,

- Chris

Chris Bamford
Senior Development Engineer
Scalix
chris.bamford@scalix.com
Tel: +44 (0)1344 381814
www.scalix.com



----- Original Message -----
From: Grant Ingersoll <gsingers@apache.org>
Sent: Sat, 29/8/2009 12:00pm
To: java-user@lucene.apache.org
Subject: Re: New "Stream closed" exception with Java 6

I think you code there needs to show the underlying exception, too, so  
we can see that stack trace.

-Grant

On Aug 28, 2009, at 11:47 AM, Chris Bamford wrote:

> Hi Grant
>
> Please see attached.
>
> Thanks,
>
> - Chris
>
>
> ----- Original Message -----
> From: Grant Ingersoll <gsingers@apache.org>
> Sent: Fri, 28/8/2009 1:26pm
> To: java-user@lucene.apache.org
> Subject: Re: New "Stream closed" exception with Java 6
>
> Are there any log messages around that spot?  Did something happen to
> the underlying Reader you are using?  Can you share that little bit of
> indexing code?
>
> On Aug 27, 2009, at 10:11 AM, Chris Bamford wrote:
>
>> Hi,
>>
>> Since moving our app to Java 6 and Tomcat 6, we have started getting
>> occasional exceptions of the form:
>>
>> java.io.IOException: Stream closed
>>   at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>>   at sun.nio.cs.StreamDecoder.read(Unknown Source)
>>   at java.io.InputStreamReader.read(Unknown Source)
>>   at
>> org
>> .apache
>> .lucene
>> .analysis
>> .standard.StandardTokenizerImpl.zzRefill(StandardTokenizerImpl.java:
>> 443)
>>   at
>> org
>> .apache
>> .lucene
>> .analysis
>> .standard
>> .StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
>>   at
>> org
>> .apache
>> .lucene
>> .analysis.standard.StandardTokenizer.next(StandardTokenizer.java:140)
>>   at
>> org
>> .apache
>> .lucene.analysis.standard.StandardFilter.next(StandardFilter.java:43)
>>   at
>> org.apache.lucene.analysis.LowerCaseFilter.next(LowerCaseFilter.java:
>> 34)
>>   at
>> org
>> .apache
>> .lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:64)
>>   at
>> org
>> .apache
>> .lucene
>> .index.DocInverterPerField.processFields(DocInverterPerField.java: 
>> 134)
>>   at
>> org
>> .apache
>> .lucene
>> .index
>> .DocFieldConsumersPerField
>> .processFields(DocFieldConsumersPerField.java:36)
>>   at
>> org
>> .apache
>> .lucene
>> .index
>> .DocFieldProcessorPerThread
>> .processDocument(DocFieldProcessorPerThread.java:234)
>>   at
>> org
>> .apache
>> .lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java: 
>> 765)
>>   at
>> org
>> .apache
>> .lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
>>   at
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java: 
>> 1902)
>>   at
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java: 
>> 1880)
>>   at
>> com
>> .scalix
>> .index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:386)
>>   at
>> com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater.java:
>> 176)
>>   at
>> com.scalix.index.manager.QueueManager.processQueue(QueueManager.java:
>> 134)
>>   at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
>>   at java.lang.Thread.run(Unknown Source)
>>
>> We are using Lucene 2.4.  Any ideas what is happening?
>>
>> Thanks!
>>
>> - Chris
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
> <lucene_msg.txt>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42091-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 09:41:06 2009
Return-Path: <java-user-return-42091-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7023 invoked from network); 1 Sep 2009 09:41:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 09:41:06 -0000
Received: (qmail 37477 invoked by uid 500); 1 Sep 2009 09:41:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37414 invoked by uid 500); 1 Sep 2009 09:41:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37404 invoked by uid 99); 1 Sep 2009 09:41:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 09:41:03 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Fang_Li@emc.com designates 128.222.32.20 as permitted sender)
Received: from [128.222.32.20] (HELO mexforward.lss.emc.com) (128.222.32.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 09:40:52 +0000
Received: from hop04-l1d11-si01.isus.emc.com (HOP04-L1D11-SI01.isus.emc.com [10.254.111.54])
	by mexforward.lss.emc.com (Switch-3.3.2/Switch-3.1.7) with ESMTP id n819eVfl028382
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 05:40:31 -0400
Received: from mailhub.lss.emc.com (numailhub.lss.emc.com [10.254.144.16]) by hop04-l1d11-si01.isus.emc.com (Tablus Interceptor) for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 05:40:22 -0400
Received: from corpussmtp4.corp.emc.com (corpussmtp4.corp.emc.com [10.254.169.197])
	by mailhub.lss.emc.com (Switch-3.3.2/Switch-3.3.2) with ESMTP id n819eLee022234
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 05:40:22 -0400
Received: from CORPUSMX110B.corp.emc.com ([128.221.151.108]) by corpussmtp4.corp.emc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 1 Sep 2009 05:40:21 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
x-cr-puzzleid: {B01A85C7-5A76-414D-B430-9C0D9F85CDFE}
Content-class: urn:content-classes:message
Subject: exception to open a large index Insufficient system resources exist 
Date: Tue, 1 Sep 2009 05:37:48 -0400
x-cr-hashedpuzzle: ATmX AuVz B5u/ CBnZ D1nG Eij3 FRLP Fa2C F0ad F5Ag F7Sm G3D9 HDrl IzCc KqJ7 Lgsl;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{B01A85C7-5A76-414D-B430-9C0D9F85CDFE};ZgBhAG4AZwBfAGwAaQBAAGUAbQBjAC4AYwBvAG0A;Tue, 01 Sep 2009 09:38:00 GMT;ZQB4AGMAZQBwAHQAaQBvAG4AIAB0AG8AIABvAHAAZQBuACAAYQAgAGwAYQByAGcAZQAgAGkAbgBkAGUAeAAgAEkAbgBzAHUAZgBmAGkAYwBpAGUAbgB0ACAAcwB5AHMAdABlAG0AIAByAGUAcwBvAHUAcgBjAGUAcwAgAGUAeABpAHMAdAA=
Message-ID: <247ECD1AB4ED914A80AE4873CFC230A4506845@CORPUSMX110B.corp.emc.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: exception to open a large index Insufficient system resources exist 
thread-index: Acoq595VxnpfkoAtRzG89miByz7Bmw==
From: <Fang_Li@emc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 01 Sep 2009 09:40:21.0480 (UTC) FILETIME=[3940AE80:01CA2AE8]
X-EMM-EM: Active
X-Virus-Checked: Checked by ClamAV on apache.org

I met a problem to open an index bigger than 8GB and the following
exception was thrown. There is a segment which is bigger than 4GB
already. After searching internet, it is said that not using compound
index may solve the problem.

The same exception was thrown when merging with another index happens.
If the problem is caused by the big segment, we can adjust Lucene
parameters to control the segment size.=20
Anyone knows what's the cause for this exception? As reproducing the
problem will take a long time, your idea will be save us a lot of
effort.

java.io.IOException: Insufficient system resources exist to complete the
requested service
	at java.io.RandomAccessFile.readBytes(Native Method)
	at java.io.RandomAccessFile.read(RandomAccessFile.java:315)
	at
org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirector
y.java:596)
	at
org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.jav
a:157)
	at
org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.j
ava:38)
	at
org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
	at
org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav
a:73)
	at
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
	at
org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
	at
org.apache.lucene.index.SegmentReader.get(SegmentReader.java:228)
	at
org.apache.lucene.index.MultiSegmentReader.<init>(MultiSegmentReader.jav
a:55)
	at
org.apache.lucene.index.DirectoryIndexReader$1.doBody(DirectoryIndexRead
er.java:104)
	at
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.j
ava:653)
	at
org.apache.lucene.index.DirectoryIndexReader.open(DirectoryIndexReader.j
ava:115)
	at
org.apache.lucene.index.IndexReader.open(IndexReader.java:316)
	at
org.apache.lucene.index.IndexReader.open(IndexReader.java:227)

Thanks,
-Li


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42092-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 09:56:32 2009
Return-Path: <java-user-return-42092-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11739 invoked from network); 1 Sep 2009 09:56:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 09:56:32 -0000
Received: (qmail 58535 invoked by uid 500); 1 Sep 2009 09:56:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58478 invoked by uid 500); 1 Sep 2009 09:56:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58468 invoked by uid 99); 1 Sep 2009 09:56:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 09:56:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of torindan@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 09:56:22 +0000
Received: by qw-out-2122.google.com with SMTP id 8so1235113qwh.53
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 02:56:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=9Mj+aJq9Wh9mo1PkUYasSIBZITOuKJEnISoNcpsfFc8=;
        b=bpg+ZstQPmpA7vtSntefxKSQNAXImBGe875mWgtA0L9WLe8G1IErrRCe405iMVuu4+
         TH265mKf6kE7/x1Ro67FUG7p7cBVarzutFgrkRh1oH7CBGLS4+CkXtooCzssfU9VWm5T
         n+UUYMlkf/+KMKSXY68I7G+trjz0nitSN0REs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=cLN7ILr9EoZiuWd6xoUDMty0sO5fD9IaWgJw4RLpE2fQcIvAC2xE0HRhw+Q2LqoOXX
         MylRJGjsztsMxgZPbLzD7RDBjsJiUTYtSZeL7QokEdWMNU2EC9MTg5msJ8PG3Z1csF/E
         dd742NyvG3pzCqHBC0a9Uqby9LPM8dGG9huVg=
MIME-Version: 1.0
Received: by 10.229.9.130 with SMTP id l2mr2001603qcl.41.1251798960727; Tue, 
	01 Sep 2009 02:56:00 -0700 (PDT)
In-Reply-To: <247ECD1AB4ED914A80AE4873CFC230A4506845@CORPUSMX110B.corp.emc.com>
References: <247ECD1AB4ED914A80AE4873CFC230A4506845@CORPUSMX110B.corp.emc.com>
Date: Tue, 1 Sep 2009 12:56:00 +0300
Message-ID: <2ffb6d060909010256ye0a3ca9h44dd5d85fc339260@mail.gmail.com>
Subject: Re: exception to open a large index Insufficient system resources 
	exist
From: =?UTF-8?B?RGFuaWwgxaJPUklO?= <torindan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

There should be no problem with large segments.
Please describe OS, FileSystem and JDK you are running on.

There might be some problems with file >2Gb on Win32/FAT, or in some
ancient Linuxes.

On Tue, Sep 1, 2009 at 12:37, <Fang_Li@emc.com> wrote:
> I met a problem to open an index bigger than 8GB and the following
> exception was thrown. There is a segment which is bigger than 4GB
> already. After searching internet, it is said that not using compound
> index may solve the problem.
>
> The same exception was thrown when merging with another index happens.
> If the problem is caused by the big segment, we can adjust Lucene
> parameters to control the segment size.
> Anyone knows what's the cause for this exception? As reproducing the
> problem will take a long time, your idea will be save us a lot of
> effort.
>
> java.io.IOException: Insufficient system resources exist to complete the
> requested service
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.readBytes(Native M=
ethod)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at java.io.RandomAccessFile.read(RandomAccessF=
ile.java:315)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirector
> y.java:596)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.jav
> a:157)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.j
> ava:38)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav
> a:73)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.SegmentReader.get(SegmentReader.java:228)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.MultiSegmentReader.<init>(MultiSegmentReader.jav
> a:55)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.DirectoryIndexReader$1.doBody(DirectoryIndexRead
> er.java:104)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.j
> ava:653)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.DirectoryIndexReader.open(DirectoryIndexReader.j
> ava:115)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.IndexReader.open(IndexReader.java:316)
> =C2=A0 =C2=A0 =C2=A0 =C2=A0at
> org.apache.lucene.index.IndexReader.open(IndexReader.java:227)
>
> Thanks,
> -Li
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42093-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 10:06:17 2009
Return-Path: <java-user-return-42093-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14623 invoked from network); 1 Sep 2009 10:06:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 10:06:17 -0000
Received: (qmail 73190 invoked by uid 500); 1 Sep 2009 10:06:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73122 invoked by uid 500); 1 Sep 2009 10:06:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73109 invoked by uid 99); 1 Sep 2009 10:06:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 10:06:15 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Fang_Li@emc.com designates 128.222.32.20 as permitted sender)
Received: from [128.222.32.20] (HELO mexforward.lss.emc.com) (128.222.32.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 10:06:05 +0000
Received: from hop04-l1d11-si04.isus.emc.com (HOP04-L1D11-SI04.isus.emc.com [10.254.111.24])
	by mexforward.lss.emc.com (Switch-3.3.2/Switch-3.1.7) with ESMTP id n81A5i4W013291
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 06:05:44 -0400
Received: from mailhub.lss.emc.com (nagas.lss.emc.com [10.254.144.15]) by hop04-l1d11-si04.isus.emc.com (Tablus Interceptor) for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 06:05:39 -0400
Received: from corpussmtp3.corp.emc.com (corpussmtp3.corp.emc.com [10.254.169.196])
	by mailhub.lss.emc.com (Switch-3.3.2mp/Switch-3.3.2mp) with ESMTP id n81A5c02016611
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 06:05:38 -0400
Received: from CORPUSMX110B.corp.emc.com ([128.221.151.108]) by corpussmtp3.corp.emc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 1 Sep 2009 06:05:37 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: base64
Subject: RE: exception to open a large index Insufficient system resources exist
Date: Tue, 1 Sep 2009 06:03:32 -0400
Message-ID: <247ECD1AB4ED914A80AE4873CFC230A4506860@CORPUSMX110B.corp.emc.com>
In-Reply-To: <2ffb6d060909010256ye0a3ca9h44dd5d85fc339260@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: exception to open a large index Insufficient system resources exist
thread-index: Acoq6oECiSqANxdpSp2cvd2nxttaBgAAH1RQ
References: <247ECD1AB4ED914A80AE4873CFC230A4506845@CORPUSMX110B.corp.emc.com> <2ffb6d060909010256ye0a3ca9h44dd5d85fc339260@mail.gmail.com>
From: <Fang_Li@emc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 01 Sep 2009 10:05:37.0965 (UTC) FILETIME=[C125EDD0:01CA2AEB]
X-EMM-EM: Active
X-Virus-Checked: Checked by ClamAV on apache.org

V2UgYXJlIHJ1bm5pbmcgb24gV2luZG93cyAyMDAzIEVudGVycHJpc2UgRWRpdGlvbiB3aXRoIE5U
RlMgZmlsZSBzeXN0ZW0gb24gYSBsb2NhbCBkaXNjLiBKREsgdmVyc2lvbiBpcyAxLjUuMC4xMi4N
Cg0KVGhlIHByb2JsZW0gd2FzIGRpc2N1c3NlZCBiZWZvcmUgYW5kIHRoZXJlIGlzIG5vIGNsZWFy
IHNvbHV0aW9uIGNvbmZpcm1lZC4NCg0KVGhhbmtzLg0KDQotLS0tLU9yaWdpbmFsIE1lc3NhZ2Ut
LS0tLQ0KRnJvbTogRGFuaWwgxaJPUklOIFttYWlsdG86dG9yaW5kYW5AZ21haWwuY29tXSANClNl
bnQ6IFR1ZXNkYXksIFNlcHRlbWJlciAwMSwgMjAwOSA1OjU2IFBNDQpUbzogamF2YS11c2VyQGx1
Y2VuZS5hcGFjaGUub3JnDQpTdWJqZWN0OiBSZTogZXhjZXB0aW9uIHRvIG9wZW4gYSBsYXJnZSBp
bmRleCBJbnN1ZmZpY2llbnQgc3lzdGVtIHJlc291cmNlcyBleGlzdA0KDQpUaGVyZSBzaG91bGQg
YmUgbm8gcHJvYmxlbSB3aXRoIGxhcmdlIHNlZ21lbnRzLg0KUGxlYXNlIGRlc2NyaWJlIE9TLCBG
aWxlU3lzdGVtIGFuZCBKREsgeW91IGFyZSBydW5uaW5nIG9uLg0KDQpUaGVyZSBtaWdodCBiZSBz
b21lIHByb2JsZW1zIHdpdGggZmlsZSA+MkdiIG9uIFdpbjMyL0ZBVCwgb3IgaW4gc29tZQ0KYW5j
aWVudCBMaW51eGVzLg0KDQpPbiBUdWUsIFNlcCAxLCAyMDA5IGF0IDEyOjM3LCA8RmFuZ19MaUBl
bWMuY29tPiB3cm90ZToNCj4gSSBtZXQgYSBwcm9ibGVtIHRvIG9wZW4gYW4gaW5kZXggYmlnZ2Vy
IHRoYW4gOEdCIGFuZCB0aGUgZm9sbG93aW5nDQo+IGV4Y2VwdGlvbiB3YXMgdGhyb3duLiBUaGVy
ZSBpcyBhIHNlZ21lbnQgd2hpY2ggaXMgYmlnZ2VyIHRoYW4gNEdCDQo+IGFscmVhZHkuIEFmdGVy
IHNlYXJjaGluZyBpbnRlcm5ldCwgaXQgaXMgc2FpZCB0aGF0IG5vdCB1c2luZyBjb21wb3VuZA0K
PiBpbmRleCBtYXkgc29sdmUgdGhlIHByb2JsZW0uDQo+DQo+IFRoZSBzYW1lIGV4Y2VwdGlvbiB3
YXMgdGhyb3duIHdoZW4gbWVyZ2luZyB3aXRoIGFub3RoZXIgaW5kZXggaGFwcGVucy4NCj4gSWYg
dGhlIHByb2JsZW0gaXMgY2F1c2VkIGJ5IHRoZSBiaWcgc2VnbWVudCwgd2UgY2FuIGFkanVzdCBM
dWNlbmUNCj4gcGFyYW1ldGVycyB0byBjb250cm9sIHRoZSBzZWdtZW50IHNpemUuDQo+IEFueW9u
ZSBrbm93cyB3aGF0J3MgdGhlIGNhdXNlIGZvciB0aGlzIGV4Y2VwdGlvbj8gQXMgcmVwcm9kdWNp
bmcgdGhlDQo+IHByb2JsZW0gd2lsbCB0YWtlIGEgbG9uZyB0aW1lLCB5b3VyIGlkZWEgd2lsbCBi
ZSBzYXZlIHVzIGEgbG90IG9mDQo+IGVmZm9ydC4NCj4NCj4gamF2YS5pby5JT0V4Y2VwdGlvbjog
SW5zdWZmaWNpZW50IHN5c3RlbSByZXNvdXJjZXMgZXhpc3QgdG8gY29tcGxldGUgdGhlDQo+IHJl
cXVlc3RlZCBzZXJ2aWNlDQo+IMKgIMKgIMKgIMKgYXQgamF2YS5pby5SYW5kb21BY2Nlc3NGaWxl
LnJlYWRCeXRlcyhOYXRpdmUgTWV0aG9kKQ0KPiDCoCDCoCDCoCDCoGF0IGphdmEuaW8uUmFuZG9t
QWNjZXNzRmlsZS5yZWFkKFJhbmRvbUFjY2Vzc0ZpbGUuamF2YTozMTUpDQo+IMKgIMKgIMKgIMKg
YXQNCj4gb3JnLmFwYWNoZS5sdWNlbmUuc3RvcmUuRlNEaXJlY3RvcnkkRlNJbmRleElucHV0LnJl
YWRJbnRlcm5hbChGU0RpcmVjdG9yDQo+IHkuamF2YTo1OTYpDQo+IMKgIMKgIMKgIMKgYXQNCj4g
b3JnLmFwYWNoZS5sdWNlbmUuc3RvcmUuQnVmZmVyZWRJbmRleElucHV0LnJlZmlsbChCdWZmZXJl
ZEluZGV4SW5wdXQuamF2DQo+IGE6MTU3KQ0KPiDCoCDCoCDCoCDCoGF0DQo+IG9yZy5hcGFjaGUu
bHVjZW5lLnN0b3JlLkJ1ZmZlcmVkSW5kZXhJbnB1dC5yZWFkQnl0ZShCdWZmZXJlZEluZGV4SW5w
dXQuag0KPiBhdmE6MzgpDQo+IMKgIMKgIMKgIMKgYXQNCj4gb3JnLmFwYWNoZS5sdWNlbmUuc3Rv
cmUuSW5kZXhJbnB1dC5yZWFkVkludChJbmRleElucHV0LmphdmE6NzgpDQo+IMKgIMKgIMKgIMKg
YXQNCj4gb3JnLmFwYWNoZS5sdWNlbmUuaW5kZXguQ29tcG91bmRGaWxlUmVhZGVyLjxpbml0PihD
b21wb3VuZEZpbGVSZWFkZXIuamF2DQo+IGE6NzMpDQo+IMKgIMKgIMKgIMKgYXQNCj4gb3JnLmFw
YWNoZS5sdWNlbmUuaW5kZXguU2VnbWVudFJlYWRlci5pbml0aWFsaXplKFNlZ21lbnRSZWFkZXIu
amF2YTozMjEpDQo+IMKgIMKgIMKgIMKgYXQNCj4gb3JnLmFwYWNoZS5sdWNlbmUuaW5kZXguU2Vn
bWVudFJlYWRlci5nZXQoU2VnbWVudFJlYWRlci5qYXZhOjMwNikNCj4gwqAgwqAgwqAgwqBhdA0K
PiBvcmcuYXBhY2hlLmx1Y2VuZS5pbmRleC5TZWdtZW50UmVhZGVyLmdldChTZWdtZW50UmVhZGVy
LmphdmE6MjI4KQ0KPiDCoCDCoCDCoCDCoGF0DQo+IG9yZy5hcGFjaGUubHVjZW5lLmluZGV4Lk11
bHRpU2VnbWVudFJlYWRlci48aW5pdD4oTXVsdGlTZWdtZW50UmVhZGVyLmphdg0KPiBhOjU1KQ0K
PiDCoCDCoCDCoCDCoGF0DQo+IG9yZy5hcGFjaGUubHVjZW5lLmluZGV4LkRpcmVjdG9yeUluZGV4
UmVhZGVyJDEuZG9Cb2R5KERpcmVjdG9yeUluZGV4UmVhZA0KPiBlci5qYXZhOjEwNCkNCj4gwqAg
wqAgwqAgwqBhdA0KPiBvcmcuYXBhY2hlLmx1Y2VuZS5pbmRleC5TZWdtZW50SW5mb3MkRmluZFNl
Z21lbnRzRmlsZS5ydW4oU2VnbWVudEluZm9zLmoNCj4gYXZhOjY1MykNCj4gwqAgwqAgwqAgwqBh
dA0KPiBvcmcuYXBhY2hlLmx1Y2VuZS5pbmRleC5EaXJlY3RvcnlJbmRleFJlYWRlci5vcGVuKERp
cmVjdG9yeUluZGV4UmVhZGVyLmoNCj4gYXZhOjExNSkNCj4gwqAgwqAgwqAgwqBhdA0KPiBvcmcu
YXBhY2hlLmx1Y2VuZS5pbmRleC5JbmRleFJlYWRlci5vcGVuKEluZGV4UmVhZGVyLmphdmE6MzE2
KQ0KPiDCoCDCoCDCoCDCoGF0DQo+IG9yZy5hcGFjaGUubHVjZW5lLmluZGV4LkluZGV4UmVhZGVy
Lm9wZW4oSW5kZXhSZWFkZXIuamF2YToyMjcpDQo+DQo+IFRoYW5rcywNCj4gLUxpDQo+DQo+DQo+
IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQ0KPiBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJz
Y3JpYmVAbHVjZW5lLmFwYWNoZS5vcmcNCj4gRm9yIGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFp
bDogamF2YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNoZS5vcmcNCj4NCj4NCg0KLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
DQpUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVjZW5lLmFw
YWNoZS5vcmcNCkZvciBhZGRpdGlvbmFsIGNvbW1hbmRzLCBlLW1haWw6IGphdmEtdXNlci1oZWxw
QGx1Y2VuZS5hcGFjaGUub3JnDQoNCg0K


From java-user-return-42094-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 10:14:36 2009
Return-Path: <java-user-return-42094-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16594 invoked from network); 1 Sep 2009 10:14:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 10:14:36 -0000
Received: (qmail 84568 invoked by uid 500); 1 Sep 2009 10:14:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84493 invoked by uid 500); 1 Sep 2009 10:14:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84480 invoked by uid 99); 1 Sep 2009 10:14:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 10:14:33 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 10:14:23 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id CD77645E442
	for <java-user@lucene.apache.org>; Tue,  1 Sep 2009 12:14:01 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id VVW8NuT3gGW2 for <java-user@lucene.apache.org>;
	Tue,  1 Sep 2009 12:13:53 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.75])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 2393645E383
	for <java-user@lucene.apache.org>; Tue,  1 Sep 2009 12:13:52 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <247ECD1AB4ED914A80AE4873CFC230A4506845@CORPUSMX110B.corp.emc.com> <2ffb6d060909010256ye0a3ca9h44dd5d85fc339260@mail.gmail.com> <247ECD1AB4ED914A80AE4873CFC230A4506860@CORPUSMX110B.corp.emc.com>
Subject: RE: exception to open a large index Insufficient system resources exist
Date: Tue, 1 Sep 2009 12:13:51 +0200
Message-ID: <471B926324114432B1D4E5B9F054F93F@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-2"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <247ECD1AB4ED914A80AE4873CFC230A4506860@CORPUSMX110B.corp.emc.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
thread-index: Acoq6oECiSqANxdpSp2cvd2nxttaBgAAH1RQAAB3yNA=
X-Virus-Checked: Checked by ClamAV on apache.org

Which Lucene version, 64 bit JVM?

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Fang_Li@emc.com [mailto:Fang_Li@emc.com]
> Sent: Tuesday, September 01, 2009 12:04 PM
> To: java-user@lucene.apache.org
> Subject: RE: exception to open a large index Insufficient system =
resources
> exist
>=20
> We are running on Windows 2003 Enterprise Edition with NTFS file =
system on
> a local disc. JDK version is 1.5.0.12.
>=20
> The problem was discussed before and there is no clear solution =
confirmed.
>=20
> Thanks.
>=20
> -----Original Message-----
> From: Danil =DEORIN [mailto:torindan@gmail.com]
> Sent: Tuesday, September 01, 2009 5:56 PM
> To: java-user@lucene.apache.org
> Subject: Re: exception to open a large index Insufficient system =
resources
> exist
>=20
> There should be no problem with large segments.
> Please describe OS, FileSystem and JDK you are running on.
>=20
> There might be some problems with file >2Gb on Win32/FAT, or in some
> ancient Linuxes.
>=20
> On Tue, Sep 1, 2009 at 12:37, <Fang_Li@emc.com> wrote:
> > I met a problem to open an index bigger than 8GB and the following
> > exception was thrown. There is a segment which is bigger than 4GB
> > already. After searching internet, it is said that not using =
compound
> > index may solve the problem.
> >
> > The same exception was thrown when merging with another index =
happens.
> > If the problem is caused by the big segment, we can adjust Lucene
> > parameters to control the segment size.
> > Anyone knows what's the cause for this exception? As reproducing the
> > problem will take a long time, your idea will be save us a lot of
> > effort.
> >
> > java.io.IOException: Insufficient system resources exist to complete =
the
> > requested service
> > =A0 =A0 =A0 =A0at java.io.RandomAccessFile.readBytes(Native Method)
> > =A0 =A0 =A0 =A0at =
java.io.RandomAccessFile.read(RandomAccessFile.java:315)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirector
> > y.java:596)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.jav
> > a:157)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.j
> > ava:38)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav
> > a:73)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.index.SegmentReader.get(SegmentReader.java:228)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.MultiSegmentReader.<init>(MultiSegmentReader.jav
> > a:55)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.DirectoryIndexReader$1.doBody(DirectoryIndexRead
> > er.java:104)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.j
> > ava:653)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.DirectoryIndexReader.open(DirectoryIndexReader.j
> > ava:115)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.index.IndexReader.open(IndexReader.java:316)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.index.IndexReader.open(IndexReader.java:227)
> >
> > Thanks,
> > -Li
> >
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42095-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 10:32:48 2009
Return-Path: <java-user-return-42095-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21675 invoked from network); 1 Sep 2009 10:32:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 10:32:47 -0000
Received: (qmail 3729 invoked by uid 500); 1 Sep 2009 10:32:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3633 invoked by uid 500); 1 Sep 2009 10:32:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3623 invoked by uid 99); 1 Sep 2009 10:32:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 10:32:45 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 10:32:35 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n81AWCQe020475
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 11:32:12 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Tue, 01 Sep 2009 11:32:12 +0100 (BST)
Date: Tue, 1 Sep 2009 11:32:12 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>
Subject: RE: Lucene gobbling file descriptors
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Hi Erick,

>>Note that for search speed reasons, you really, really want to share your
>>readers and NOT open/close for every request.
I have often wondered about this - I hope you can help me understand it better in the context of our app, which is an email client:

When one of our users receives email we index and store it so he (and only he) can search on it.  This means a separate index per user.  On large customer sites this can mean hundreds/thousands of indexes.  Sharing readers seems counter-intuitive, unless I am missing something.  What we do instead is that once a user performs a search, we keep his IndexReader open in case he searches again.  At present, we have no expiry on this mechanism, so they stay open indefinitely.  I'm a bit hazy on the underlying details but we have observed that the number of open fds jumps by around 10 each time a new user performs a search.  What would be a good strategy for managing this in your opinon?  Does it really make sense to keep the IndexReader open?  Would performance suffer that much if we did an open/close for each search?  Or would it perhaps be better to close open readers after a period of inactivity?

Thanks for any wisdom / thoughts/ ideas.

- Chris
 


----- Original Message -----
From: Erick Erickson <erickerickson@gmail.com>
Sent: Thu, 27/8/2009 4:49pm
To: java-user@lucene.apache.org
Subject: Re: Lucene gobbling file descriptors

Note that for search speed reasons, you really, really want to share your
readers and NOT open/close for every request.
FWIW
Erick

On Thu, Aug 27, 2009 at 9:10 AM, Chris Bamford <Chris.Bamford@scalix.com>wrote:

> I'm glad its not normal.  That means we can fix it!  I will conduct a
> review of IndexReader/Searcher open/close ops.
>
> Thanks!
>
> Chris
>
> ----- Original Message -----
> From: Michael McCandless <lucene@mikemccandless.com>
> Sent: Wed, 26/8/2009 2:26pm
> To: java-user@lucene.apache.org
> Subject: Re: Lucene gobbling file descriptors
>
> This is not normal.  As long as you are certain you close every
> IndexReader/Searcher that you opened, the number of file descriptors
> should stay "contained".
>
> Though: how many files are there in your index directory?
>
> Mike
>
> On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com>
> wrote:
> > Hi there,
> >
> > I wonder if someone can help?  We have a successful Lucene app deployed
> on Tomcat which works well.  As far as we can tell, our developers have
> observed all the guidelines in the Lucene FAQ, but on some of our
> installations, Tomcat eventually runs out of file descriptors and needs a
> restart to clear it.  We know Lucene is the culprit because use lsof -p
> <java PID> and the vast majority (usually tens of thousands) of files
> reported are Lucene index files.
> >
> > I am hoping to get some tips on how this can be avoided.  Is it simply
> the case that as time goes by, more and more descriptors are left open and
> no matter how high ulimit is set, you will run out?  Or is there a policy of
> recycling that we are failing to utilise properly?
> >
> > I am happy to provide more information, just don't know what at this
> point!  Please ask....
> >
> > Thanks in advance
> >
> > - Chris
> >
> > Chris Bamford
> > Senior Development Engineer
> > Scalix
> > chris.bamford@scalix.com
> > Tel: +44 (0)1344 381814
> > www.scalix.com
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42096-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 11:04:24 2009
Return-Path: <java-user-return-42096-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30581 invoked from network); 1 Sep 2009 11:04:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 11:04:24 -0000
Received: (qmail 39748 invoked by uid 500); 1 Sep 2009 11:04:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39657 invoked by uid 500); 1 Sep 2009 11:04:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39647 invoked by uid 99); 1 Sep 2009 11:04:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 11:04:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.204] (HELO mail-yx0-f204.google.com) (209.85.210.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 11:04:12 +0000
Received: by yxe42 with SMTP id 42so1307288yxe.20
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 04:03:50 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.26.5 with SMTP id 5mr11379575ybz.135.1251803028488; Tue, 
	01 Sep 2009 04:03:48 -0700 (PDT)
In-Reply-To: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>
References: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>
Date: Tue, 1 Sep 2009 07:03:48 -0400
Message-ID: <9ac0c6aa0909010403k3306307dxa7751ecff3fa2abd@mail.gmail.com>
Subject: Re: Lucene gobbling file descriptors
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

In this approach it's expected you'll run out of file descriptors,
when "enough" users attempt to search at the same time.

You can reduce the number of file descriptors required per IndexReader
by 1) using compound file format (it's the default for IndexWriter),
and 2) optimizing the index before opening it (though, since you have
updates trickling in, that could get costly).  Yet, if enough users
try to search, you'll run out of descriptors.

If performance is OK, I think you should in fact open IndexReader, do
search, close IndexReader, per request.  Or maybe reuse IndexReader
for the "biggest" indexes.  This reduces your "max file descriptors
envelope". Still, you can run of descriptors with the "perfect storm"
of usage.

Also make sure you're giving the JRE the max open file descriptors
allowed by the OS.

A bigger change would be to aggregate multiple users into a single
index, and use filtering to apply the entitlements constraints.  But
that's got its own set of tradeoffs... eg, scoring will be different,
respelling is dangerous (entitlements can "leak" through), it's less
"secure", etc.

Mike

On Tue, Sep 1, 2009 at 6:32 AM, Chris Bamford<Chris.Bamford@scalix.com> wro=
te:
> Hi Erick,
>
>>>Note that for search speed reasons, you really, really want to share you=
r
>>>readers and NOT open/close for every request.
> I have often wondered about this - I hope you can help me understand it b=
etter in the context of our app, which is an email client:
>
> When one of our users receives email we index and store it so he (and onl=
y he) can search on it. =A0This means a separate index per user. =A0On larg=
e customer sites this can mean hundreds/thousands of indexes. =A0Sharing re=
aders seems counter-intuitive, unless I am missing something. =A0What we do=
 instead is that once a user performs a search, we keep his IndexReader ope=
n in case he searches again. =A0At present, we have no expiry on this mecha=
nism, so they stay open indefinitely. =A0I'm a bit hazy on the underlying d=
etails but we have observed that the number of open fds jumps by around 10 =
each time a new user performs a search. =A0What would be a good strategy fo=
r managing this in your opinon? =A0Does it really make sense to keep the In=
dexReader open? =A0Would performance suffer that much if we did an open/clo=
se for each search? =A0Or would it perhaps be better to close open readers =
after a period of inactivity?
>
> Thanks for any wisdom / thoughts/ ideas.
>
> - Chris
>
>
>
> ----- Original Message -----
> From: Erick Erickson <erickerickson@gmail.com>
> Sent: Thu, 27/8/2009 4:49pm
> To: java-user@lucene.apache.org
> Subject: Re: Lucene gobbling file descriptors
>
> Note that for search speed reasons, you really, really want to share your
> readers and NOT open/close for every request.
> FWIW
> Erick
>
> On Thu, Aug 27, 2009 at 9:10 AM, Chris Bamford <Chris.Bamford@scalix.com>=
wrote:
>
>> I'm glad its not normal. =A0That means we can fix it! =A0I will conduct =
a
>> review of IndexReader/Searcher open/close ops.
>>
>> Thanks!
>>
>> Chris
>>
>> ----- Original Message -----
>> From: Michael McCandless <lucene@mikemccandless.com>
>> Sent: Wed, 26/8/2009 2:26pm
>> To: java-user@lucene.apache.org
>> Subject: Re: Lucene gobbling file descriptors
>>
>> This is not normal. =A0As long as you are certain you close every
>> IndexReader/Searcher that you opened, the number of file descriptors
>> should stay "contained".
>>
>> Though: how many files are there in your index directory?
>>
>> Mike
>>
>> On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com>
>> wrote:
>> > Hi there,
>> >
>> > I wonder if someone can help? =A0We have a successful Lucene app deplo=
yed
>> on Tomcat which works well. =A0As far as we can tell, our developers hav=
e
>> observed all the guidelines in the Lucene FAQ, but on some of our
>> installations, Tomcat eventually runs out of file descriptors and needs =
a
>> restart to clear it. =A0We know Lucene is the culprit because use lsof -=
p
>> <java PID> and the vast majority (usually tens of thousands) of files
>> reported are Lucene index files.
>> >
>> > I am hoping to get some tips on how this can be avoided. =A0Is it simp=
ly
>> the case that as time goes by, more and more descriptors are left open a=
nd
>> no matter how high ulimit is set, you will run out? =A0Or is there a pol=
icy of
>> recycling that we are failing to utilise properly?
>> >
>> > I am happy to provide more information, just don't know what at this
>> point! =A0Please ask....
>> >
>> > Thanks in advance
>> >
>> > - Chris
>> >
>> > Chris Bamford
>> > Senior Development Engineer
>> > Scalix
>> > chris.bamford@scalix.com
>> > Tel: +44 (0)1344 381814
>> > www.scalix.com
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42097-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 12:21:07 2009
Return-Path: <java-user-return-42097-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57109 invoked from network); 1 Sep 2009 12:21:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 12:21:07 -0000
Received: (qmail 26542 invoked by uid 500); 1 Sep 2009 12:21:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26476 invoked by uid 500); 1 Sep 2009 12:21:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26388 invoked by uid 99); 1 Sep 2009 12:21:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 12:21:04 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 12:20:54 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n81CKUIn021661
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 13:20:30 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Tue, 01 Sep 2009 13:20:30 +0100 (BST)
Date: Tue, 1 Sep 2009 13:20:30 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <1110995055.21131251807630070.JavaMail.root@mail.uk.scalix.com>
Subject: RE: Lucene gobbling file descriptors
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Hi Mike,

Thanks for the suggestions, very useful.  I would like to adopt a combination of setUseCompoundFile on the IndexReader and perform an open/close per search.
As a start, I just tried to set compound file format on the IndexSearcher's underlying IndexReader, but it is not available as a method.  This is for a Lucene 2.0 branch of the code...  Did it come in after 2.0 or am I doing something wrong here?  This is what I am attempting to do:

        currentSearcher = new DelayCloseIndexSearcher(directory);
        if (currentSearcher != null) {
            currentSearcher.getIndexReader().setUseCompoundFile(true);
        }

However, the setUseCompoundFile() is not available  :-(

Thanks again,

- Chris

Chris Bamford
Senior Development Engineer
Scalix
chris.bamford@scalix.com
Tel: +44 (0)1344 381814
www.scalix.com



----- Original Message -----
From: Michael McCandless <lucene@mikemccandless.com>
Sent: Tue, 1/9/2009 12:03pm
To: java-user@lucene.apache.org
Subject: Re: Lucene gobbling file descriptors

In this approach it's expected you'll run out of file descriptors,
when "enough" users attempt to search at the same time.

You can reduce the number of file descriptors required per IndexReader
by 1) using compound file format (it's the default for IndexWriter),
and 2) optimizing the index before opening it (though, since you have
updates trickling in, that could get costly).  Yet, if enough users
try to search, you'll run out of descriptors.

If performance is OK, I think you should in fact open IndexReader, do
search, close IndexReader, per request.  Or maybe reuse IndexReader
for the "biggest" indexes.  This reduces your "max file descriptors
envelope". Still, you can run of descriptors with the "perfect storm"
of usage.

Also make sure you're giving the JRE the max open file descriptors
allowed by the OS.

A bigger change would be to aggregate multiple users into a single
index, and use filtering to apply the entitlements constraints.  But
that's got its own set of tradeoffs... eg, scoring will be different,
respelling is dangerous (entitlements can "leak" through), it's less
"secure", etc.

Mike

On Tue, Sep 1, 2009 at 6:32 AM, Chris Bamford<Chris.Bamford@scalix.com> wrote:
> Hi Erick,
>
>>>Note that for search speed reasons, you really, really want to share your
>>>readers and NOT open/close for every request.
> I have often wondered about this - I hope you can help me understand it better in the context of our app, which is an email client:
>
> When one of our users receives email we index and store it so he (and only he) can search on it.  This means a separate index per user.  On large customer sites this can mean hundreds/thousands of indexes.  Sharing readers seems counter-intuitive, unless I am missing something.  What we do instead is that once a user performs a search, we keep his IndexReader open in case he searches again.  At present, we have no expiry on this mechanism, so they stay open indefinitely.  I'm a bit hazy on the underlying details but we have observed that the number of open fds jumps by around 10 each time a new user performs a search.  What would be a good strategy for managing this in your opinon?  Does it really make sense to keep the IndexReader open?  Would performance suffer that much if we did an open/close for each search?  Or would it perhaps be better to close open readers after a period of inactivity?
>
> Thanks for any wisdom / thoughts/ ideas.
>
> - Chris
>
>
>
> ----- Original Message -----
> From: Erick Erickson <erickerickson@gmail.com>
> Sent: Thu, 27/8/2009 4:49pm
> To: java-user@lucene.apache.org
> Subject: Re: Lucene gobbling file descriptors
>
> Note that for search speed reasons, you really, really want to share your
> readers and NOT open/close for every request.
> FWIW
> Erick
>
> On Thu, Aug 27, 2009 at 9:10 AM, Chris Bamford <Chris.Bamford@scalix.com>wrote:
>
>> I'm glad its not normal.  That means we can fix it!  I will conduct a
>> review of IndexReader/Searcher open/close ops.
>>
>> Thanks!
>>
>> Chris
>>
>> ----- Original Message -----
>> From: Michael McCandless <lucene@mikemccandless.com>
>> Sent: Wed, 26/8/2009 2:26pm
>> To: java-user@lucene.apache.org
>> Subject: Re: Lucene gobbling file descriptors
>>
>> This is not normal.  As long as you are certain you close every
>> IndexReader/Searcher that you opened, the number of file descriptors
>> should stay "contained".
>>
>> Though: how many files are there in your index directory?
>>
>> Mike
>>
>> On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com>
>> wrote:
>> > Hi there,
>> >
>> > I wonder if someone can help?  We have a successful Lucene app deployed
>> on Tomcat which works well.  As far as we can tell, our developers have
>> observed all the guidelines in the Lucene FAQ, but on some of our
>> installations, Tomcat eventually runs out of file descriptors and needs a
>> restart to clear it.  We know Lucene is the culprit because use lsof -p
>> <java PID> and the vast majority (usually tens of thousands) of files
>> reported are Lucene index files.
>> >
>> > I am hoping to get some tips on how this can be avoided.  Is it simply
>> the case that as time goes by, more and more descriptors are left open and
>> no matter how high ulimit is set, you will run out?  Or is there a policy of
>> recycling that we are failing to utilise properly?
>> >
>> > I am happy to provide more information, just don't know what at this
>> point!  Please ask....
>> >
>> > Thanks in advance
>> >
>> > - Chris
>> >
>> > Chris Bamford
>> > Senior Development Engineer
>> > Scalix
>> > chris.bamford@scalix.com
>> > Tel: +44 (0)1344 381814
>> > www.scalix.com
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42098-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 12:24:05 2009
Return-Path: <java-user-return-42098-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57536 invoked from network); 1 Sep 2009 12:24:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 12:24:05 -0000
Received: (qmail 29576 invoked by uid 500); 1 Sep 2009 12:24:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29488 invoked by uid 500); 1 Sep 2009 12:24:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29478 invoked by uid 99); 1 Sep 2009 12:24:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 12:24:03 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.177] (HELO mail-yw0-f177.google.com) (209.85.211.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 12:23:53 +0000
Received: by ywh7 with SMTP id 7so7340238ywh.21
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 05:23:31 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.236.17 with SMTP id j17mr10252022ybh.128.1251807811483; 
	Tue, 01 Sep 2009 05:23:31 -0700 (PDT)
In-Reply-To: <1110995055.21131251807630070.JavaMail.root@mail.uk.scalix.com>
References: <1110995055.21131251807630070.JavaMail.root@mail.uk.scalix.com>
Date: Tue, 1 Sep 2009 08:23:31 -0400
Message-ID: <9ac0c6aa0909010523p474e64aep85c342eff6f76317@mail.gmail.com>
Subject: Re: Lucene gobbling file descriptors
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

setUseCompoundFile is an IndexWriter method.  It already defaults to
"true", so you probably are already using compound file format.  If
you look in your index directory and see only *.cfs (plus segments_N
and segments.gen) then you are using compound file format.

Mike

On Tue, Sep 1, 2009 at 8:20 AM, Chris Bamford<Chris.Bamford@scalix.com> wro=
te:
> Hi Mike,
>
> Thanks for the suggestions, very useful. =A0I would like to adopt a combi=
nation of setUseCompoundFile on the IndexReader and perform an open/close p=
er search.
> As a start, I just tried to set compound file format on the IndexSearcher=
's underlying IndexReader, but it is not available as a method. =A0This is =
for a Lucene 2.0 branch of the code... =A0Did it come in after 2.0 or am I =
doing something wrong here? =A0This is what I am attempting to do:
>
> =A0 =A0 =A0 =A0currentSearcher =3D new DelayCloseIndexSearcher(directory)=
;
> =A0 =A0 =A0 =A0if (currentSearcher !=3D null) {
> =A0 =A0 =A0 =A0 =A0 =A0currentSearcher.getIndexReader().setUseCompoundFil=
e(true);
> =A0 =A0 =A0 =A0}
>
> However, the setUseCompoundFile() is not available =A0:-(
>
> Thanks again,
>
> - Chris
>
> Chris Bamford
> Senior Development Engineer
> Scalix
> chris.bamford@scalix.com
> Tel: +44 (0)1344 381814
> www.scalix.com
>
>
>
> ----- Original Message -----
> From: Michael McCandless <lucene@mikemccandless.com>
> Sent: Tue, 1/9/2009 12:03pm
> To: java-user@lucene.apache.org
> Subject: Re: Lucene gobbling file descriptors
>
> In this approach it's expected you'll run out of file descriptors,
> when "enough" users attempt to search at the same time.
>
> You can reduce the number of file descriptors required per IndexReader
> by 1) using compound file format (it's the default for IndexWriter),
> and 2) optimizing the index before opening it (though, since you have
> updates trickling in, that could get costly). =A0Yet, if enough users
> try to search, you'll run out of descriptors.
>
> If performance is OK, I think you should in fact open IndexReader, do
> search, close IndexReader, per request. =A0Or maybe reuse IndexReader
> for the "biggest" indexes. =A0This reduces your "max file descriptors
> envelope". Still, you can run of descriptors with the "perfect storm"
> of usage.
>
> Also make sure you're giving the JRE the max open file descriptors
> allowed by the OS.
>
> A bigger change would be to aggregate multiple users into a single
> index, and use filtering to apply the entitlements constraints. =A0But
> that's got its own set of tradeoffs... eg, scoring will be different,
> respelling is dangerous (entitlements can "leak" through), it's less
> "secure", etc.
>
> Mike
>
> On Tue, Sep 1, 2009 at 6:32 AM, Chris Bamford<Chris.Bamford@scalix.com> w=
rote:
>> Hi Erick,
>>
>>>>Note that for search speed reasons, you really, really want to share yo=
ur
>>>>readers and NOT open/close for every request.
>> I have often wondered about this - I hope you can help me understand it =
better in the context of our app, which is an email client:
>>
>> When one of our users receives email we index and store it so he (and on=
ly he) can search on it. =A0This means a separate index per user. =A0On lar=
ge customer sites this can mean hundreds/thousands of indexes. =A0Sharing r=
eaders seems counter-intuitive, unless I am missing something. =A0What we d=
o instead is that once a user performs a search, we keep his IndexReader op=
en in case he searches again. =A0At present, we have no expiry on this mech=
anism, so they stay open indefinitely. =A0I'm a bit hazy on the underlying =
details but we have observed that the number of open fds jumps by around 10=
 each time a new user performs a search. =A0What would be a good strategy f=
or managing this in your opinon? =A0Does it really make sense to keep the I=
ndexReader open? =A0Would performance suffer that much if we did an open/cl=
ose for each search? =A0Or would it perhaps be better to close open readers=
 after a period of inactivity?
>>
>> Thanks for any wisdom / thoughts/ ideas.
>>
>> - Chris
>>
>>
>>
>> ----- Original Message -----
>> From: Erick Erickson <erickerickson@gmail.com>
>> Sent: Thu, 27/8/2009 4:49pm
>> To: java-user@lucene.apache.org
>> Subject: Re: Lucene gobbling file descriptors
>>
>> Note that for search speed reasons, you really, really want to share you=
r
>> readers and NOT open/close for every request.
>> FWIW
>> Erick
>>
>> On Thu, Aug 27, 2009 at 9:10 AM, Chris Bamford <Chris.Bamford@scalix.com=
>wrote:
>>
>>> I'm glad its not normal. =A0That means we can fix it! =A0I will conduct=
 a
>>> review of IndexReader/Searcher open/close ops.
>>>
>>> Thanks!
>>>
>>> Chris
>>>
>>> ----- Original Message -----
>>> From: Michael McCandless <lucene@mikemccandless.com>
>>> Sent: Wed, 26/8/2009 2:26pm
>>> To: java-user@lucene.apache.org
>>> Subject: Re: Lucene gobbling file descriptors
>>>
>>> This is not normal. =A0As long as you are certain you close every
>>> IndexReader/Searcher that you opened, the number of file descriptors
>>> should stay "contained".
>>>
>>> Though: how many files are there in your index directory?
>>>
>>> Mike
>>>
>>> On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com=
>
>>> wrote:
>>> > Hi there,
>>> >
>>> > I wonder if someone can help? =A0We have a successful Lucene app depl=
oyed
>>> on Tomcat which works well. =A0As far as we can tell, our developers ha=
ve
>>> observed all the guidelines in the Lucene FAQ, but on some of our
>>> installations, Tomcat eventually runs out of file descriptors and needs=
 a
>>> restart to clear it. =A0We know Lucene is the culprit because use lsof =
-p
>>> <java PID> and the vast majority (usually tens of thousands) of files
>>> reported are Lucene index files.
>>> >
>>> > I am hoping to get some tips on how this can be avoided. =A0Is it sim=
ply
>>> the case that as time goes by, more and more descriptors are left open =
and
>>> no matter how high ulimit is set, you will run out? =A0Or is there a po=
licy of
>>> recycling that we are failing to utilise properly?
>>> >
>>> > I am happy to provide more information, just don't know what at this
>>> point! =A0Please ask....
>>> >
>>> > Thanks in advance
>>> >
>>> > - Chris
>>> >
>>> > Chris Bamford
>>> > Senior Development Engineer
>>> > Scalix
>>> > chris.bamford@scalix.com
>>> > Tel: +44 (0)1344 381814
>>> > www.scalix.com
>>> >
>>> >
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42099-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 12:55:26 2009
Return-Path: <java-user-return-42099-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66918 invoked from network); 1 Sep 2009 12:55:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 12:55:25 -0000
Received: (qmail 71882 invoked by uid 500); 1 Sep 2009 12:55:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71835 invoked by uid 500); 1 Sep 2009 12:55:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71825 invoked by uid 99); 1 Sep 2009 12:55:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 12:55:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [76.13.9.48] (HELO web65504.mail.ac4.yahoo.com) (76.13.9.48)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 01 Sep 2009 12:55:13 +0000
Received: (qmail 98273 invoked by uid 60001); 1 Sep 2009 12:54:52 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1251809692; bh=0VAxPEhwtt8tQyxMTHBh3RiBPkwJHWxYyA9FLe3RH6w=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=JZah34bIeyQYj9H3xdgAPQzIDGFDN/CJ0xnJyfalZmqLQNcB35/FnXuXlbhN4ch8wrFQGPY+qciK0gg1pnGY7gLoWoC7JnfcT+0xhzxAwxzibqPLL5DvFiws16hrVBTY4fmvZWySfSX05HNzyoJQEnujJavQYBVGn3SQoQhuQfE=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=o8HcKRSTehuXY6DL50irGBLxuoQt/1tqoTUpg1K1RFMBzQiwc8GtpfuOz7XZjyzw6E8PD+GqTWFsvAhnooARrJRQ0JzskoJ2Sm/w+Tp0wegf88DziNZxHry9i8DKWIPcPAxmdGoy4Y4cF2bRDPOMsSrhTIKt72oxvZb/KNnnnl8=;
Message-ID: <183825.97843.qm@web65504.mail.ac4.yahoo.com>
X-YMail-OSG: 5hsqaosVM1mdafEL2BBUuyQ6yw0EtMmT6zVF0gKbYoPcg3vdDZasxKGSgRNViI25cVimZaHBSDeiuWlXfgITLXz.yM2l5sCVaSTX7rcPmudFEo9PwTMNWbrYKbs4zzmPvUBQXWIzutuywpAXDW7GS8NUJY0FXGm79EdvZBW21Cl2hEtDWRKr2aQyxuBbKgPD2wzftqfOPG2NKIePlUymYTKI_tigamrN1h7VGZYIkJRQddoGOzi4DXOIzxGl4ohAd1iLdHbuZpCxYtfsDsrU6H74Qchm8R5f0xW0l5gUn7iMxGj5dR4yDGA.PHcOA1Fh7Y0QQkQ-
Received: from [99.11.247.36] by web65504.mail.ac4.yahoo.com via HTTP; Tue, 01 Sep 2009 05:54:52 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com> <9ac0c6aa0909010403k3306307dxa7751ecff3fa2abd@mail.gmail.com>
Date: Tue, 1 Sep 2009 05:54:52 -0700 (PDT)
From: Ted Stockwell <emorning@yahoo.com>
Subject: Question about IndexCommit
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa0909010403k3306307dxa7751ecff3fa2abd@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

I am interested in using Lucene to index RDF (Resource Description Format) data.
Ultimately I want to create a transactional interface to the data with proper transaction isolation.
Therefore I am trying to educate myself on the details of index readers and writers, I am using v2.9rc2.

One thing I have noticed is that it seems that Lucene is designed with the intent that changes to the index by a writer should not be visible to index readers until the writer commits its changes.
However, one thing that I have noticed in the code is that when documents are deleted by a writer the writers change the .del (deleted documents) files in the segment in which the document exists.
Thus, it appears that document deletions may become visible to readers *before* a write actually commits its changes.

Am I correct about how document deletions work?
Since I'm new to Lucene I'm wondering if I'm missing something...


Thanks,
ted stockwell


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42100-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 13:05:54 2009
Return-Path: <java-user-return-42100-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70720 invoked from network); 1 Sep 2009 13:05:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 13:05:54 -0000
Received: (qmail 92418 invoked by uid 500); 1 Sep 2009 13:05:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92345 invoked by uid 500); 1 Sep 2009 13:05:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92335 invoked by uid 99); 1 Sep 2009 13:05:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 13:05:51 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 13:05:43 +0000
Received: by ewy6 with SMTP id 6so3227197ewy.10
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 06:04:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=fOhD6Y9u6fFY+vcG4Ls9VWHObOg6HX9q5VYXBeQaiwI=;
        b=Co4hB/1tvcw2f30NuqDIpD3G3pznzrUIU1hV3q97paTsuuOM7Z1NAJ86ZXuJy3LovI
         T//iwbO8nENM8UlItR5gAIOv2noBtY5nf4WY/9IWbSSPAgQkC5VAGbeE8wAijhhgNIAD
         Lj/01QGuf68OBx/ih6PQtg3hbF7s28OC8X7O4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=FNdvv6O7poit1cQZNT7MnwdHSwsqeR9qMR3pnwAenQfClVmfdSOppYffWX1nJd3g5T
         +VkE91Of36D8X/mkgMb0wLPOi40HMnRaekY+fLLNbwhRK+awVivweEWOK0UIsIpYg2up
         Fc7JKGYvbeiwen4g84COVoGOHSqeQHXVH+pI4=
MIME-Version: 1.0
Received: by 10.210.59.10 with SMTP id h10mr6217161eba.47.1251810261507; Tue, 
	01 Sep 2009 06:04:21 -0700 (PDT)
In-Reply-To: <183825.97843.qm@web65504.mail.ac4.yahoo.com>
References: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>
	 <9ac0c6aa0909010403k3306307dxa7751ecff3fa2abd@mail.gmail.com>
	 <183825.97843.qm@web65504.mail.ac4.yahoo.com>
Date: Tue, 1 Sep 2009 16:04:21 +0300
Message-ID: <786fde50909010604s6100f0aufe5922ef4bc3502e@mail.gmail.com>
Subject: Re: Question about IndexCommit
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c382cf6a295047283c996
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c382cf6a295047283c996
Content-Type: text/plain; charset=ISO-8859-1

If I'm not mistaken, IndexReader reads the .del file into memory, and
therefore subsequent updates to it won't be visible to it.

Shai

On Tue, Sep 1, 2009 at 3:54 PM, Ted Stockwell <emorning@yahoo.com> wrote:

> Hi All,
>
> I am interested in using Lucene to index RDF (Resource Description Format)
> data.
> Ultimately I want to create a transactional interface to the data with
> proper transaction isolation.
> Therefore I am trying to educate myself on the details of index readers and
> writers, I am using v2.9rc2.
>
> One thing I have noticed is that it seems that Lucene is designed with the
> intent that changes to the index by a writer should not be visible to index
> readers until the writer commits its changes.
> However, one thing that I have noticed in the code is that when documents
> are deleted by a writer the writers change the .del (deleted documents)
> files in the segment in which the document exists.
> Thus, it appears that document deletions may become visible to readers
> *before* a write actually commits its changes.
>
> Am I correct about how document deletions work?
> Since I'm new to Lucene I'm wondering if I'm missing something...
>
>
> Thanks,
> ted stockwell
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c382cf6a295047283c996--

From java-user-return-42101-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 13:28:20 2009
Return-Path: <java-user-return-42101-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77844 invoked from network); 1 Sep 2009 13:28:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 13:28:20 -0000
Received: (qmail 31749 invoked by uid 500); 1 Sep 2009 13:28:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31708 invoked by uid 500); 1 Sep 2009 13:28:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31698 invoked by uid 99); 1 Sep 2009 13:28:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 13:28:17 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 13:28:09 +0000
Received: by gxk12 with SMTP id 12so1750419gxk.4
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 06:26:47 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.214.18 with SMTP id m18mr11647114ybg.129.1251811607467; 
	Tue, 01 Sep 2009 06:26:47 -0700 (PDT)
In-Reply-To: <786fde50909010604s6100f0aufe5922ef4bc3502e@mail.gmail.com>
References: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>
	 <9ac0c6aa0909010403k3306307dxa7751ecff3fa2abd@mail.gmail.com>
	 <183825.97843.qm@web65504.mail.ac4.yahoo.com>
	 <786fde50909010604s6100f0aufe5922ef4bc3502e@mail.gmail.com>
Date: Tue, 1 Sep 2009 09:26:45 -0400
Message-ID: <9ac0c6aa0909010626w69d1c951rc22f67ff2e305c3c@mail.gmail.com>
Subject: Re: Question about IndexCommit
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Further, when IndexWriter writes new .del files, it's always to a new
(next generation) filename, so that the old .del file remains present.
 This means if a fresh IndexReader is opened, it will load the old
.del file, and still not see any of IndexWriter's pending changes.

Mike

On Tue, Sep 1, 2009 at 9:04 AM, Shai Erera<serera@gmail.com> wrote:
> If I'm not mistaken, IndexReader reads the .del file into memory, and
> therefore subsequent updates to it won't be visible to it.
>
> Shai
>
> On Tue, Sep 1, 2009 at 3:54 PM, Ted Stockwell <emorning@yahoo.com> wrote:
>
>> Hi All,
>>
>> I am interested in using Lucene to index RDF (Resource Description Format)
>> data.
>> Ultimately I want to create a transactional interface to the data with
>> proper transaction isolation.
>> Therefore I am trying to educate myself on the details of index readers and
>> writers, I am using v2.9rc2.
>>
>> One thing I have noticed is that it seems that Lucene is designed with the
>> intent that changes to the index by a writer should not be visible to index
>> readers until the writer commits its changes.
>> However, one thing that I have noticed in the code is that when documents
>> are deleted by a writer the writers change the .del (deleted documents)
>> files in the segment in which the document exists.
>> Thus, it appears that document deletions may become visible to readers
>> *before* a write actually commits its changes.
>>
>> Am I correct about how document deletions work?
>> Since I'm new to Lucene I'm wondering if I'm missing something...
>>
>>
>> Thanks,
>> ted stockwell
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42102-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 13:53:10 2009
Return-Path: <java-user-return-42102-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84855 invoked from network); 1 Sep 2009 13:53:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 13:53:10 -0000
Received: (qmail 71716 invoked by uid 500); 1 Sep 2009 13:53:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71644 invoked by uid 500); 1 Sep 2009 13:53:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71633 invoked by uid 99); 1 Sep 2009 13:53:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 13:53:07 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 13:52:57 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n81DqXJS030682
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 14:52:34 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Tue, 01 Sep 2009 14:52:33 +0100 (BST)
Date: Tue, 1 Sep 2009 14:52:33 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <2129259985.21161251813153399.JavaMail.root@mail.uk.scalix.com>
Subject: RE: Lucene gobbling file descriptors
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Thanks Mike, I get what you mean now  :-)

BTW I have tested the code with 1 open/close per search (rather than keeping the IndexReader open between searches) and so far I have witnessed no change in performance!  I will experiment with bigger indexes, but early signs are very encouraging  :-)

Kind regards

- Chris


----- Original Message -----
From: Michael McCandless <lucene@mikemccandless.com>
Sent: Tue, 1/9/2009 1:23pm
To: java-user@lucene.apache.org
Subject: Re: Lucene gobbling file descriptors

setUseCompoundFile is an IndexWriter method.  It already defaults to
"true", so you probably are already using compound file format.  If
you look in your index directory and see only *.cfs (plus segments_N
and segments.gen) then you are using compound file format.

Mike

On Tue, Sep 1, 2009 at 8:20 AM, Chris Bamford<Chris.Bamford@scalix.com> wrote:
> Hi Mike,
>
> Thanks for the suggestions, very useful.  I would like to adopt a combination of setUseCompoundFile on the IndexReader and perform an open/close per search.
> As a start, I just tried to set compound file format on the IndexSearcher's underlying IndexReader, but it is not available as a method.  This is for a Lucene 2.0 branch of the code...  Did it come in after 2.0 or am I doing something wrong here?  This is what I am attempting to do:
>
>        currentSearcher = new DelayCloseIndexSearcher(directory);
>        if (currentSearcher != null) {
>            currentSearcher.getIndexReader().setUseCompoundFile(true);
>        }
>
> However, the setUseCompoundFile() is not available  :-(
>
> Thanks again,
>
> - Chris
>
> Chris Bamford
> Senior Development Engineer
> Scalix
> chris.bamford@scalix.com
> Tel: +44 (0)1344 381814
> www.scalix.com
>
>
>
> ----- Original Message -----
> From: Michael McCandless <lucene@mikemccandless.com>
> Sent: Tue, 1/9/2009 12:03pm
> To: java-user@lucene.apache.org
> Subject: Re: Lucene gobbling file descriptors
>
> In this approach it's expected you'll run out of file descriptors,
> when "enough" users attempt to search at the same time.
>
> You can reduce the number of file descriptors required per IndexReader
> by 1) using compound file format (it's the default for IndexWriter),
> and 2) optimizing the index before opening it (though, since you have
> updates trickling in, that could get costly).  Yet, if enough users
> try to search, you'll run out of descriptors.
>
> If performance is OK, I think you should in fact open IndexReader, do
> search, close IndexReader, per request.  Or maybe reuse IndexReader
> for the "biggest" indexes.  This reduces your "max file descriptors
> envelope". Still, you can run of descriptors with the "perfect storm"
> of usage.
>
> Also make sure you're giving the JRE the max open file descriptors
> allowed by the OS.
>
> A bigger change would be to aggregate multiple users into a single
> index, and use filtering to apply the entitlements constraints.  But
> that's got its own set of tradeoffs... eg, scoring will be different,
> respelling is dangerous (entitlements can "leak" through), it's less
> "secure", etc.
>
> Mike
>
> On Tue, Sep 1, 2009 at 6:32 AM, Chris Bamford<Chris.Bamford@scalix.com> wrote:
>> Hi Erick,
>>
>>>>Note that for search speed reasons, you really, really want to share your
>>>>readers and NOT open/close for every request.
>> I have often wondered about this - I hope you can help me understand it better in the context of our app, which is an email client:
>>
>> When one of our users receives email we index and store it so he (and only he) can search on it.  This means a separate index per user.  On large customer sites this can mean hundreds/thousands of indexes.  Sharing readers seems counter-intuitive, unless I am missing something.  What we do instead is that once a user performs a search, we keep his IndexReader open in case he searches again.  At present, we have no expiry on this mechanism, so they stay open indefinitely.  I'm a bit hazy on the underlying details but we have observed that the number of open fds jumps by around 10 each time a new user performs a search.  What would be a good strategy for managing this in your opinon?  Does it really make sense to keep the IndexReader open?  Would performance suffer that much if we did an open/close for each search?  Or would it perhaps be better to close open readers after a period of inactivity?
>>
>> Thanks for any wisdom / thoughts/ ideas.
>>
>> - Chris
>>
>>
>>
>> ----- Original Message -----
>> From: Erick Erickson <erickerickson@gmail.com>
>> Sent: Thu, 27/8/2009 4:49pm
>> To: java-user@lucene.apache.org
>> Subject: Re: Lucene gobbling file descriptors
>>
>> Note that for search speed reasons, you really, really want to share your
>> readers and NOT open/close for every request.
>> FWIW
>> Erick
>>
>> On Thu, Aug 27, 2009 at 9:10 AM, Chris Bamford <Chris.Bamford@scalix.com>wrote:
>>
>>> I'm glad its not normal.  That means we can fix it!  I will conduct a
>>> review of IndexReader/Searcher open/close ops.
>>>
>>> Thanks!
>>>
>>> Chris
>>>
>>> ----- Original Message -----
>>> From: Michael McCandless <lucene@mikemccandless.com>
>>> Sent: Wed, 26/8/2009 2:26pm
>>> To: java-user@lucene.apache.org
>>> Subject: Re: Lucene gobbling file descriptors
>>>
>>> This is not normal.  As long as you are certain you close every
>>> IndexReader/Searcher that you opened, the number of file descriptors
>>> should stay "contained".
>>>
>>> Though: how many files are there in your index directory?
>>>
>>> Mike
>>>
>>> On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com>
>>> wrote:
>>> > Hi there,
>>> >
>>> > I wonder if someone can help?  We have a successful Lucene app deployed
>>> on Tomcat which works well.  As far as we can tell, our developers have
>>> observed all the guidelines in the Lucene FAQ, but on some of our
>>> installations, Tomcat eventually runs out of file descriptors and needs a
>>> restart to clear it.  We know Lucene is the culprit because use lsof -p
>>> <java PID> and the vast majority (usually tens of thousands) of files
>>> reported are Lucene index files.
>>> >
>>> > I am hoping to get some tips on how this can be avoided.  Is it simply
>>> the case that as time goes by, more and more descriptors are left open and
>>> no matter how high ulimit is set, you will run out?  Or is there a policy of
>>> recycling that we are failing to utilise properly?
>>> >
>>> > I am happy to provide more information, just don't know what at this
>>> point!  Please ask....
>>> >
>>> > Thanks in advance
>>> >
>>> > - Chris
>>> >
>>> > Chris Bamford
>>> > Senior Development Engineer
>>> > Scalix
>>> > chris.bamford@scalix.com
>>> > Tel: +44 (0)1344 381814
>>> > www.scalix.com
>>> >
>>> >
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42103-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 14:14:03 2009
Return-Path: <java-user-return-42103-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90625 invoked from network); 1 Sep 2009 14:14:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 14:14:03 -0000
Received: (qmail 96363 invoked by uid 500); 1 Sep 2009 14:14:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96308 invoked by uid 500); 1 Sep 2009 14:14:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96298 invoked by uid 99); 1 Sep 2009 14:14:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 14:14:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [76.13.9.55] (HELO web65511.mail.ac4.yahoo.com) (76.13.9.55)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 01 Sep 2009 14:13:50 +0000
Received: (qmail 52961 invoked by uid 60001); 1 Sep 2009 14:13:29 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1251814409; bh=Lh6k9n/MjzEupoeJLetylADE30GXTlc2OnQPG/9RYhY=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=REgMpWc6anrIJBDT1xfxCb/v7QcUlHh2CVMcLYN8GBhE2sT+OCQ7DKbx8/qDds/hf8XnIzyiyKjL0/7H1OxEXbMbt7yMp13PrCgjQKM4/Bher4rOzaXdnPiDUEJ1pS4eQ4CA7h6MwaeFFj/+fNCyvpIZGKpOWkivGpgSz9T00Ag=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=gHtcHcMM6V6uNOtPdqoM6xYkdkLX2JfNBj/WaYz7ECFXn8Aos/2pBr4F66IeizPFeiwIo5HZg8uKmME5NcAqpUWa3DK9G+yKwpSd/s/eQpDFIgFtSCLprRww1PMaeHatcgHt3AHWQm7JGGyR4mp8TU6WdFB1yNK5sdIU+nLRYpk=;
Message-ID: <471651.52560.qm@web65511.mail.ac4.yahoo.com>
X-YMail-OSG: _ZfRn80VM1mr7pIhv4g.BE0A6jv.JU41jCeZUL_NbJD_FkrHNrKBHhfaiXx9bGVCEYrIwP3uOLp7mYKmq7KbsOXEJU0jGPAH3cbaeO9GOQxPfvkEqtGWBQbgCrLuOThN2yoBuyzC2oUYVjQ1V0MC.aMdDGo_z_60SoOFCloBI.Zn9fJWUD8YpQ0BnjYI6G.uSCmeOPIdqT1S85IXPnjOZmZat3sTMIjKtRIyspZM9semf__Ikq7WgEQda9iiSqDo6f2UPKvEoD4F9sViNBgXqvmaP.8LtHNdHp_e1aXbrhpMOaQvRwExlD5wnzTN4zjXghCIhIAe_MrBFkHPAgQeD_AlIrdknUzEPjMEDmplxilnTfmxGTN27g--
Received: from [140.239.67.170] by web65511.mail.ac4.yahoo.com via HTTP; Tue, 01 Sep 2009 07:13:29 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>  <9ac0c6aa0909010403k3306307dxa7751ecff3fa2abd@mail.gmail.com>  <183825.97843.qm@web65504.mail.ac4.yahoo.com>  <786fde50909010604s6100f0aufe5922ef4bc3502e@mail.gmail.com> <9ac0c6aa0909010626w69d1c951rc22f67ff2e305c3c@mail.gmail.com>
Date: Tue, 1 Sep 2009 07:13:29 -0700 (PDT)
From: Ted Stockwell <emorning@yahoo.com>
Subject: Re: Question about IndexCommit
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa0909010626w69d1c951rc22f67ff2e305c3c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

That's excellent.
Thanks very much for the explanations....



----- Original Message ----
> From: Michael McCandless <lucene@mikemccandless.com>
> To: java-user@lucene.apache.org
> Sent: Tuesday, September 1, 2009 8:26:45 AM
> Subject: Re: Question about IndexCommit
> 
> Further, when IndexWriter writes new .del files, it's always to a new
> (next generation) filename, so that the old .del file remains present.
> This means if a fresh IndexReader is opened, it will load the old
> .del file, and still not see any of IndexWriter's pending changes.
> 
> Mike
> 
> On Tue, Sep 1, 2009 at 9:04 AM, Shai Erera wrote:
> > If I'm not mistaken, IndexReader reads the .del file into memory, and
> > therefore subsequent updates to it won't be visible to it.
> >
> > Shai
> >
> > On Tue, Sep 1, 2009 at 3:54 PM, Ted Stockwell wrote:
> >
> >> Hi All,
> >>
> >> I am interested in using Lucene to index RDF (Resource Description Format)
> >> data.
> >> Ultimately I want to create a transactional interface to the data with
> >> proper transaction isolation.
> >> Therefore I am trying to educate myself on the details of index readers and
> >> writers, I am using v2.9rc2.
> >>
> >> One thing I have noticed is that it seems that Lucene is designed with the
> >> intent that changes to the index by a writer should not be visible to index
> >> readers until the writer commits its changes.
> >> However, one thing that I have noticed in the code is that when documents
> >> are deleted by a writer the writers change the .del (deleted documents)
> >> files in the segment in which the document exists.
> >> Thus, it appears that document deletions may become visible to readers
> >> *before* a write actually commits its changes.
> >>
> >> Am I correct about how document deletions work?
> >> Since I'm new to Lucene I'm wondering if I'm missing something...
> >>
> >>
> >> Thanks,
> >> ted stockwell
> >>
> >>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42104-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 14:30:47 2009
Return-Path: <java-user-return-42104-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95403 invoked from network); 1 Sep 2009 14:30:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 14:30:47 -0000
Received: (qmail 19018 invoked by uid 500); 1 Sep 2009 14:30:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18932 invoked by uid 500); 1 Sep 2009 14:30:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18921 invoked by uid 99); 1 Sep 2009 14:30:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 14:30:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of azlist1@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 14:30:35 +0000
Received: by fg-out-1718.google.com with SMTP id 16so76614fgg.5
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 07:30:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=tjiVfcAa+nREQ3SKHo/bixDdPulyiVsxKSf08Pm5qks=;
        b=EdeLXRz9V0WU8QHR/ulCGVanX5OuOfEVf2wyqNBJP3vt7QqG9PdQJq0EPKkSnGU3QR
         sakCsid0BkQ9Tfb+FaEHjGD9VHgi+EQyIJCv/JipHeZM4h+azJhErruc1MeFLFSSYgbI
         0ACo6xRNnyDKzuHx1d6LyJhDG7RhfK4DWLGUI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=PVeNrxlupCAlqbSNUyEBD2djNLZzyIE/K+0edx7RJpxnFiDZ6XTckMo4ZHGXMyeUWA
         3x3pykUfZEPukV3W0RhnLKSCN3F8koRUX1DDmonBP8SlfRRZy7n4q81x0AYIyMDmkqyY
         De0BGTAP2cSk72mrFzTNUlqeFdWSEGOZB+Fss=
MIME-Version: 1.0
Received: by 10.86.34.12 with SMTP id h12mr1501505fgh.25.1251815414226; Tue, 
	01 Sep 2009 07:30:14 -0700 (PDT)
Date: Tue, 1 Sep 2009 16:30:14 +0200
Message-ID: <76c1202b0909010730o79d03b28yd7c39762a4c5a3ac@mail.gmail.com>
Subject: Query and language conversion
From: Alex <azlist1@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1ea3a16df4f047284fdb6
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1ea3a16df4f047284fdb6
Content-Type: text/plain; charset=ISO-8859-1

Hi,

I am new to Lucene so excuse me if this is a trivial question ..


I have data that I Index in a given language (English). My users will come
from different countries and my search screen will be internationalized. My
users will then probably query thing in their own language. Is it possible
too lookup for Items that were indexed in a different language.


To make thing a bit more clear.

My "Business" object has a "type" attribute. In lucene the "type" field is
created. The Business object for  "Doctor Smuck" will be indexed with the
"type" field as  "medical doctor" or anything similar.
My German users will query using german languange. He tries to find a Doctor
using "Arzt" or maybe "Mediziner" as a query.
Is Lucene able to match the query to the value that was indexed in another
language ?
Is there an analyser for that ?

By the way : I can provide the probable input language, based on the
client's search page language,  as a parameter if that helps (it probably
will) .


Many thanks for your thoughts !

--000e0cd1ea3a16df4f047284fdb6--

From java-user-return-42105-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 15:26:16 2009
Return-Path: <java-user-return-42105-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13023 invoked from network); 1 Sep 2009 15:26:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 15:26:16 -0000
Received: (qmail 29346 invoked by uid 500); 1 Sep 2009 15:26:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29280 invoked by uid 500); 1 Sep 2009 15:26:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29270 invoked by uid 99); 1 Sep 2009 15:26:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 15:26:14 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.200 as permitted sender)
Received: from [209.85.223.200] (HELO mail-iw0-f200.google.com) (209.85.223.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 15:26:04 +0000
Received: by iwn38 with SMTP id 38so23516iwn.29
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 08:25:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=BTwHFHJd5N54bz5JXsvhNJxv1yy3EIqIK6N4X6zL718=;
        b=wL7yRFBWjNVPk5bmkLGDe5gc4krcGu/shuiXUV/+Gh3gVZDInp3C0Bce65n+3KQkUl
         XR4qxAIkTVEQV1qEbMVA1NVoC+QyOe9Sb3+iwF9rYE2g1Wfg7nGjjjC4s6MKTgQ9R8qX
         RA0symP3USwgBB1twdGcR1k7MS9UdVUBiZ/58=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=bCXS9h74TuTEcDwuOmBtjY5CA855iMg2/qJcTGaeM7qpWOMdWgg8wlx0ajIG+VFcjO
         PK+WSGOAN4pDISpDOKUc9SydXMZjorux376CaZe9pBwBPUE1/rramRQunWH7qIWK9EYI
         XlvfdnEU5cGShOod2P0Z0M6WeOMy/MS0ZrzH8=
MIME-Version: 1.0
Received: by 10.231.122.208 with SMTP id m16mr7959891ibr.16.1251818742988; 
	Tue, 01 Sep 2009 08:25:42 -0700 (PDT)
In-Reply-To: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>
References: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>
Date: Tue, 1 Sep 2009 11:25:42 -0400
Message-ID: <359a92830909010825r58599e98t6aca7f2eab8c78b3@mail.gmail.com>
Subject: Re: Lucene gobbling file descriptors
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64078f07fbffc047285c378
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64078f07fbffc047285c378
Content-Type: text/plain; charset=ISO-8859-1

Late reply, but do what Michael said. I didn't understand that you hadso
many indexes, but opening/closing makes sense to me now, reusing
them wouldn't be very useful. Although I *can* imagine a "keep each open
for 5 minute" sort of rule being useful on the assumption that a user might
search several ways in a short interval, but I sure wouldn't go there unless
and until I had a performance issue to deal with....

In fact, I'd leave all the complex stuff (like, perhaps, queueing requests
after there were X outstanding ones being serviced) until I could
demonstrate
a need.

Although I would put in a bit of logging showing the max number of
concurrent requests just to try to get ahead of the "perfect storm"
scenario Michael mentioned.

Erick

On Tue, Sep 1, 2009 at 6:32 AM, Chris Bamford <Chris.Bamford@scalix.com>wrote:

> Hi Erick,
>
> >>Note that for search speed reasons, you really, really want to share your
> >>readers and NOT open/close for every request.
> I have often wondered about this - I hope you can help me understand it
> better in the context of our app, which is an email client:
>
> When one of our users receives email we index and store it so he (and only
> he) can search on it.  This means a separate index per user.  On large
> customer sites this can mean hundreds/thousands of indexes.  Sharing readers
> seems counter-intuitive, unless I am missing something.  What we do instead
> is that once a user performs a search, we keep his IndexReader open in case
> he searches again.  At present, we have no expiry on this mechanism, so they
> stay open indefinitely.  I'm a bit hazy on the underlying details but we
> have observed that the number of open fds jumps by around 10 each time a new
> user performs a search.  What would be a good strategy for managing this in
> your opinon?  Does it really make sense to keep the IndexReader open?  Would
> performance suffer that much if we did an open/close for each search?  Or
> would it perhaps be better to close open readers after a period of
> inactivity?
>
> Thanks for any wisdom / thoughts/ ideas.
>
> - Chris
>
>
>
> ----- Original Message -----
> From: Erick Erickson <erickerickson@gmail.com>
> Sent: Thu, 27/8/2009 4:49pm
> To: java-user@lucene.apache.org
> Subject: Re: Lucene gobbling file descriptors
>
> Note that for search speed reasons, you really, really want to share your
> readers and NOT open/close for every request.
> FWIW
> Erick
>
> On Thu, Aug 27, 2009 at 9:10 AM, Chris Bamford <Chris.Bamford@scalix.com
> >wrote:
>
> > I'm glad its not normal.  That means we can fix it!  I will conduct a
> > review of IndexReader/Searcher open/close ops.
> >
> > Thanks!
> >
> > Chris
> >
> > ----- Original Message -----
> > From: Michael McCandless <lucene@mikemccandless.com>
> > Sent: Wed, 26/8/2009 2:26pm
> > To: java-user@lucene.apache.org
> > Subject: Re: Lucene gobbling file descriptors
> >
> > This is not normal.  As long as you are certain you close every
> > IndexReader/Searcher that you opened, the number of file descriptors
> > should stay "contained".
> >
> > Though: how many files are there in your index directory?
> >
> > Mike
> >
> > On Wed, Aug 26, 2009 at 9:18 AM, Chris Bamford<Chris.Bamford@scalix.com>
> > wrote:
> > > Hi there,
> > >
> > > I wonder if someone can help?  We have a successful Lucene app deployed
> > on Tomcat which works well.  As far as we can tell, our developers have
> > observed all the guidelines in the Lucene FAQ, but on some of our
> > installations, Tomcat eventually runs out of file descriptors and needs a
> > restart to clear it.  We know Lucene is the culprit because use lsof -p
> > <java PID> and the vast majority (usually tens of thousands) of files
> > reported are Lucene index files.
> > >
> > > I am hoping to get some tips on how this can be avoided.  Is it simply
> > the case that as time goes by, more and more descriptors are left open
> and
> > no matter how high ulimit is set, you will run out?  Or is there a policy
> of
> > recycling that we are failing to utilise properly?
> > >
> > > I am happy to provide more information, just don't know what at this
> > point!  Please ask....
> > >
> > > Thanks in advance
> > >
> > > - Chris
> > >
> > > Chris Bamford
> > > Senior Development Engineer
> > > Scalix
> > > chris.bamford@scalix.com
> > > Tel: +44 (0)1344 381814
> > > www.scalix.com
> > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64078f07fbffc047285c378--

From java-user-return-42106-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 16:47:04 2009
Return-Path: <java-user-return-42106-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40858 invoked from network); 1 Sep 2009 16:47:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 16:47:04 -0000
Received: (qmail 49411 invoked by uid 500); 1 Sep 2009 16:47:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49369 invoked by uid 500); 1 Sep 2009 16:47:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49359 invoked by uid 99); 1 Sep 2009 16:47:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 16:47:02 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.18.82] (HELO smtp1.syr.edu) (128.230.18.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 16:46:51 +0000
Received: from suex07-hub-02.ad.syr.edu (suex07-hub-02.ad.syr.edu [128.230.108.196])
	by smtp1.syr.edu (8.14.3/8.14.3) with ESMTP id n81GkRYO005941
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 12:46:29 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-02.ad.syr.edu ([fe80::813b:49a2:a4d5:6367%10]) with mapi; Tue, 1
 Sep 2009 12:46:29 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 1 Sep 2009 12:46:27 -0400
Subject: RE: Query and language conversion
Thread-Topic: Query and language conversion
Thread-Index: AcorENB0166tNXLlSuiZW2zgvbTRzgAB/VDA
Message-ID: <2D127F11DC79714E9B6A43AC9458147F2F8EF835@suex07-mbx-03.ad.syr.edu>
References: <76c1202b0909010730o79d03b28yd7c39762a4c5a3ac@mail.gmail.com>
In-Reply-To: <76c1202b0909010730o79d03b28yd7c39762a4c5a3ac@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.8161:2.4.5,1.2.40,4.0.166 definitions=2009-09-01_10:2009-08-26,2009-09-01,2009-09-01 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Alex,

What you want to do is commonly referred to as "Cross Language Information =
Retrieval".  Doug Oard at the University of Maryland has a page of CLIR res=
ources here:
=20
http://terpconnect.umd.edu/~dlrg/clir/

Grant Ingersoll responded to a similar question a couple of years ago on th=
is list:

<http://search.lucidimagination.com/search/document/e1398067af353a49/cross_=
lingual_ir#e1398067af353a49>

Here's another recent thread with lots of good info, from the solr-user mai=
ling list, on the same topic:

<http://search.lucidimagination.com/search/document/f7c17dc516c89bf6/prepar=
ing_the_ground_for_a_real_multilang_index#797001daa3f73e17>

Here's a paper written by a group that put together a Greek-English cross-l=
anguage retrieval system using Lucene:

http://www.springerlink.com/content/n172420t1346q683/

And here's another paper written by a group that made a Hindi and Telugu to=
 English cross-language retrieval system using Lucene, from the CLEF 2006 c=
onference proceedings:

http://www.iiit.ac.in/techreports/2008_76.pdf

Steve

> -----Original Message-----
> From: Alex [mailto:azlist1@gmail.com]
> Sent: Tuesday, September 01, 2009 10:30 AM
> To: java-user@lucene.apache.org
> Subject: Query and language conversion
>=20
> Hi,
>=20
> I am new to Lucene so excuse me if this is a trivial question ..
>=20
>=20
> I have data that I Index in a given language (English). My users will
> come from different countries and my search screen will be
> internationalized. My users will then probably query thing in their
> own language. Is it possible too lookup for Items that were indexed
> in a different language.
>=20
> To make thing a bit more clear.
>=20
> My "Business" object has a "type" attribute. In lucene the "type" field
> is created. The Business object for  "Doctor Smuck" will be indexed with
> the "type" field as  "medical doctor" or anything similar. My German
> users will query using german languange. He tries to find a Doctor
> using "Arzt" or maybe "Mediziner" as a query. Is Lucene able to match
> the query to the value that was indexed in another language ?
> Is there an analyser for that ?
>=20
> By the way : I can provide the probable input language, based on the
> client's search page language,  as a parameter if that helps (it
> probably will) .
>=20
> Many thanks for your thoughts !


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42107-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 16:51:14 2009
Return-Path: <java-user-return-42107-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42062 invoked from network); 1 Sep 2009 16:51:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 16:51:14 -0000
Received: (qmail 56890 invoked by uid 500); 1 Sep 2009 16:51:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56803 invoked by uid 500); 1 Sep 2009 16:51:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56793 invoked by uid 99); 1 Sep 2009 16:51:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 16:51:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of azlist1@gmail.com designates 209.85.220.225 as permitted sender)
Received: from [209.85.220.225] (HELO mail-fx0-f225.google.com) (209.85.220.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 16:51:00 +0000
Received: by fxm25 with SMTP id 25so196715fxm.5
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 09:50:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lJ7N5QKwPM9Z+EP5m0tPAoG+VqgDmzaevuG+Tkmm/QU=;
        b=sGiwbcilgRa0pMTqLsipgo38hNZ5MbMilDhGzlAt/ytmQGGya+ucoSTquyGzF19s5K
         /QFB53ayuVK4JW/krFLJYzYoqQyNEo/r/ayE5H6X68yKJsnRhG6JH4SHELcoLKHj+lhv
         nXziG3yBBK/rshM6byJP88jdTVTlIu7mLVTzE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Lc9B5fFwT6SdD6XqnesBTYuTH673tosfCut785WVJ50kayM8eVQhKFRPzwnqekY1Pp
         Rk9bfMu2MCD9GZ4ulriieO5b/6RKlWMBPeRA+kzjLYL5aw5v9cXvqdz7pcYkFSvWcFZd
         90OIaugDwm5IPJkkleRUFuKR3EeA4n/68QxPk=
MIME-Version: 1.0
Received: by 10.86.12.35 with SMTP id 35mr1698664fgl.20.1251823840138; Tue, 01 
	Sep 2009 09:50:40 -0700 (PDT)
In-Reply-To: <2D127F11DC79714E9B6A43AC9458147F2F8EF835@suex07-mbx-03.ad.syr.edu>
References: <76c1202b0909010730o79d03b28yd7c39762a4c5a3ac@mail.gmail.com>
	 <2D127F11DC79714E9B6A43AC9458147F2F8EF835@suex07-mbx-03.ad.syr.edu>
Date: Tue, 1 Sep 2009 18:50:40 +0200
Message-ID: <76c1202b0909010950x29b62c70pb85f618634ea3d57@mail.gmail.com>
Subject: Re: Query and language conversion
From: Alex <azlist1@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00c09ffb56b85017c1047286f302
X-Virus-Checked: Checked by ClamAV on apache.org

--00c09ffb56b85017c1047286f302
Content-Type: text/plain; charset=ISO-8859-1

Many thanks Steve for all that information.

I understand by your answer that cross-lingual search doesn't come "out-of
-the-box" in Lucene.

Cheers.

Alex

On Tue, Sep 1, 2009 at 6:46 PM, Steven A Rowe <sarowe@syr.edu> wrote:

> Hi Alex,
>
> What you want to do is commonly referred to as "Cross Language Information
> Retrieval".  Doug Oard at the University of Maryland has a page of CLIR
> resources here:
>
> http://terpconnect.umd.edu/~dlrg/clir/<http://terpconnect.umd.edu/%7Edlrg/clir/>
>
> Grant Ingersoll responded to a similar question a couple of years ago on
> this list:
>
> <
> http://search.lucidimagination.com/search/document/e1398067af353a49/cross_lingual_ir#e1398067af353a49
> >
>
> Here's another recent thread with lots of good info, from the solr-user
> mailing list, on the same topic:
>
> <
> http://search.lucidimagination.com/search/document/f7c17dc516c89bf6/preparing_the_ground_for_a_real_multilang_index#797001daa3f73e17
> >
>
> Here's a paper written by a group that put together a Greek-English
> cross-language retrieval system using Lucene:
>
> http://www.springerlink.com/content/n172420t1346q683/
>
> And here's another paper written by a group that made a Hindi and Telugu to
> English cross-language retrieval system using Lucene, from the CLEF 2006
> conference proceedings:
>
> http://www.iiit.ac.in/techreports/2008_76.pdf
>
> Steve
>
> > -----Original Message-----
> > From: Alex [mailto:azlist1@gmail.com]
> > Sent: Tuesday, September 01, 2009 10:30 AM
> > To: java-user@lucene.apache.org
> > Subject: Query and language conversion
> >
> > Hi,
> >
> > I am new to Lucene so excuse me if this is a trivial question ..
> >
> >
> > I have data that I Index in a given language (English). My users will
> > come from different countries and my search screen will be
> > internationalized. My users will then probably query thing in their
> > own language. Is it possible too lookup for Items that were indexed
> > in a different language.
> >
> > To make thing a bit more clear.
> >
> > My "Business" object has a "type" attribute. In lucene the "type" field
> > is created. The Business object for  "Doctor Smuck" will be indexed with
> > the "type" field as  "medical doctor" or anything similar. My German
> > users will query using german languange. He tries to find a Doctor
> > using "Arzt" or maybe "Mediziner" as a query. Is Lucene able to match
> > the query to the value that was indexed in another language ?
> > Is there an analyser for that ?
> >
> > By the way : I can provide the probable input language, based on the
> > client's search page language,  as a parameter if that helps (it
> > probably will) .
> >
> > Many thanks for your thoughts !
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00c09ffb56b85017c1047286f302--

From java-user-return-42108-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 17:11:29 2009
Return-Path: <java-user-return-42108-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50334 invoked from network); 1 Sep 2009 17:11:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 17:11:29 -0000
Received: (qmail 90764 invoked by uid 500); 1 Sep 2009 17:11:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90690 invoked by uid 500); 1 Sep 2009 17:11:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90680 invoked by uid 99); 1 Sep 2009 17:11:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 17:11:26 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.18.82] (HELO smtp1.syr.edu) (128.230.18.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 17:11:14 +0000
Received: from suex07-hub-02.ad.syr.edu (suex07-hub-02.ad.syr.edu [128.230.108.196])
	by smtp1.syr.edu (8.14.3/8.14.3) with ESMTP id n81HAr9G031341
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 13:10:53 -0400
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-02.ad.syr.edu ([fe80::813b:49a2:a4d5:6367%10]) with mapi; Tue, 1
 Sep 2009 13:10:53 -0400
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 1 Sep 2009 13:10:53 -0400
Subject: RE: Query and language conversion
Thread-Topic: Query and language conversion
Thread-Index: AcorJG7IDx/QkDqoRdSC0XGixRqaJgAAEuzA
Message-ID: <2D127F11DC79714E9B6A43AC9458147F2F8EF836@suex07-mbx-03.ad.syr.edu>
References: <76c1202b0909010730o79d03b28yd7c39762a4c5a3ac@mail.gmail.com>
	 <2D127F11DC79714E9B6A43AC9458147F2F8EF835@suex07-mbx-03.ad.syr.edu>
 <76c1202b0909010950x29b62c70pb85f618634ea3d57@mail.gmail.com>
In-Reply-To: <76c1202b0909010950x29b62c70pb85f618634ea3d57@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.8161:2.4.5,1.2.40,4.0.166 definitions=2009-09-01_10:2009-08-26,2009-09-01,2009-09-01 signatures=0
X-Proofpoint-Spam-Reason: safe
X-Virus-Checked: Checked by ClamAV on apache.org

Alex,

That's right, you'll have to roll your own if you want to do cross-language=
 search in Lucene.  But some of the components you need are available.

Two possible cross-language search strategies don't scale well when the doc=
ument collection size is non-trivial: a) translating all documents into all=
 possible query languages; and b) requiring all documents and queries to us=
e "controlled vocabulary", with fully mapped correspondences between langua=
ges.

The most commonly chosen strategy is to translate the query into the langua=
ge(s) of the documents.  Typically, because queries are so short, machine t=
ranslation is overkill, since it depends on larger context for accuracy tha=
n is available.  So people generally use bi-lingual dictionaries, sometimes=
 combined with stemming and/or stopword removal, to convert queries into th=
e language(s) of the documents.

Lucene does have analyzers (some or all of: tokenizers, stemmers and stopwo=
rd lists) for several languages, but these are monolingual in nature.

Lucene does not have bi-lingual dictionaries.  You would have to supply the=
se.

You didn't directly say so, but if you're unsure of the language of any of =
your content, you'll also need to be able to identify it.  Nutch, a Lucene =
sub-project, has language identification code.

Steve

> -----Original Message-----
> From: Alex [mailto:azlist1@gmail.com]
> Sent: Tuesday, September 01, 2009 12:51 PM
> To: java-user@lucene.apache.org
> Subject: Re: Query and language conversion
>=20
> Many thanks Steve for all that information.
>=20
> I understand by your answer that cross-lingual search doesn't come
> "out-of-the-box" in Lucene.
>=20
> Cheers.
>=20
> Alex
>=20
> On Tue, Sep 1, 2009 at 6:46 PM, Steven A Rowe <sarowe@syr.edu> wrote:
>=20
> > Hi Alex,
> >
> > What you want to do is commonly referred to as "Cross Language
> Information
> > Retrieval".  Doug Oard at the University of Maryland has a page of
> CLIR
> > resources here:
> >
> >
> http://terpconnect.umd.edu/~dlrg/clir/<http://terpconnect.umd.edu/%7Edl
> rg/clir/>
> >
> > Grant Ingersoll responded to a similar question a couple of years ago
> on
> > this list:
> >
> > <
> >
> http://search.lucidimagination.com/search/document/e1398067af353a49/cro
> ss_lingual_ir#e1398067af353a49
> > >
> >
> > Here's another recent thread with lots of good info, from the solr-
> user
> > mailing list, on the same topic:
> >
> > <
> >
> http://search.lucidimagination.com/search/document/f7c17dc516c89bf6/pre
> paring_the_ground_for_a_real_multilang_index#797001daa3f73e17
> > >
> >
> > Here's a paper written by a group that put together a Greek-English
> > cross-language retrieval system using Lucene:
> >
> > http://www.springerlink.com/content/n172420t1346q683/
> >
> > And here's another paper written by a group that made a Hindi and
> Telugu to
> > English cross-language retrieval system using Lucene, from the CLEF
> 2006
> > conference proceedings:
> >
> > http://www.iiit.ac.in/techreports/2008_76.pdf
> >
> > Steve
> >
> > > -----Original Message-----
> > > From: Alex [mailto:azlist1@gmail.com]
> > > Sent: Tuesday, September 01, 2009 10:30 AM
> > > To: java-user@lucene.apache.org
> > > Subject: Query and language conversion
> > >
> > > Hi,
> > >
> > > I am new to Lucene so excuse me if this is a trivial question ..
> > >
> > >
> > > I have data that I Index in a given language (English). My users
> will
> > > come from different countries and my search screen will be
> > > internationalized. My users will then probably query thing in their
> > > own language. Is it possible too lookup for Items that were indexed
> > > in a different language.
> > >
> > > To make thing a bit more clear.
> > >
> > > My "Business" object has a "type" attribute. In lucene the "type"
> field
> > > is created. The Business object for  "Doctor Smuck" will be indexed
> with
> > > the "type" field as  "medical doctor" or anything similar. My
> German
> > > users will query using german languange. He tries to find a Doctor
> > > using "Arzt" or maybe "Mediziner" as a query. Is Lucene able to
> match
> > > the query to the value that was indexed in another language ?
> > > Is there an analyser for that ?
> > >
> > > By the way : I can provide the probable input language, based on
> the
> > > client's search page language,  as a parameter if that helps (it
> > > probably will) .
> > >
> > > Many thanks for your thoughts !
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42109-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 20:01:23 2009
Return-Path: <java-user-return-42109-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4105 invoked from network); 1 Sep 2009 20:01:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 20:01:23 -0000
Received: (qmail 94969 invoked by uid 500); 1 Sep 2009 20:01:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94866 invoked by uid 500); 1 Sep 2009 20:01:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94856 invoked by uid 99); 1 Sep 2009 20:01:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 20:01:20 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of engrean@gmail.com designates 209.85.211.177 as permitted sender)
Received: from [209.85.211.177] (HELO mail-yw0-f177.google.com) (209.85.211.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 20:01:10 +0000
Received: by ywh7 with SMTP id 7so429298ywh.21
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 13:00:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=E4buqaagACCCUzqE+NREYQFbEiQaZxO4XWeMHXHEqgg=;
        b=mKNTFJT+ftqPeCJf75WWdDIuYRI2uwrctkLWWnXL2sHJlnC7CANInnmWIGh0TfbOk+
         3vxVXtV5t54kxojFyYuMLjlcteFDVpK1gBSWjDPe4++GeJVYG8/bFhnkraENoc2briX9
         VPmHwjQb7U7ilNeptjQ01WMsTU3nRFe9HBenY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=WrxCWkyduVEviLeOf5UgJBzLkysMHSxNp81Nkues3DeRynv4jBjpaluQ/ZJPxbZHcB
         GxixzTgAD2ZVsxTlyWz7scjbsb6F/aMcAGotbxwVE8gjJnIrnNkHpvtE0tnXN8bf4jdn
         usKxxk/yUjuXORyIQJpA+m99RGh371Co9truw=
MIME-Version: 1.0
Received: by 10.91.105.3 with SMTP id h3mr5388442agm.6.1251835249278; Tue, 01 
	Sep 2009 13:00:49 -0700 (PDT)
Date: Tue, 1 Sep 2009 14:00:49 -0600
Message-ID: <333a2bef0909011300m34de9ceyd23af3ce0e20a6b4@mail.gmail.com>
Subject: Field.Store.NO & Field.Index.NOT_ANALYZED & hashCode
From: Christian <engrean@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016367f92e159c1640472899bd3
X-Virus-Checked: Checked by ClamAV on apache.org

--0016367f92e159c1640472899bd3
Content-Type: text/plain; charset=ISO-8859-1

Hi,

I am putting some text into a field which we set to Field.Store.NO &
Field.Index.NOT_ANALYZED. We are then doing exact & fuzzy matches against
that text (about the length of an average sentence). Currently, we have a
single field that is being used for both exact and fuzzy matches while we
have another field with the same text in it for phrase matches.

As for the exact matching, I am wondering if I should store the hashcode of
the text in a separate field and convert the text in the query to a hashcode
before passing it on or if Lucene already does something like that under the
covers when it sees Field.Store.NO & Field.Index.NOT_ANALYZED. We will have
millions of entries.

Thanks,
Christian

--0016367f92e159c1640472899bd3--

From java-user-return-42110-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 21:16:26 2009
Return-Path: <java-user-return-42110-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22133 invoked from network); 1 Sep 2009 21:16:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 21:16:26 -0000
Received: (qmail 71027 invoked by uid 500); 1 Sep 2009 21:16:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70947 invoked by uid 500); 1 Sep 2009 21:16:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70937 invoked by uid 99); 1 Sep 2009 21:16:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:16:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:16:14 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id E1FF471C5DC; Tue,  1 Sep 2009 14:15:53 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id DF32471C4D6
	for <java-user@lucene.apache.org>; Tue,  1 Sep 2009 14:15:53 -0700 (PDT)
Date: Tue, 1 Sep 2009 14:15:53 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Why perform optimization in 'off hours'?
In-Reply-To: <408754.43565.qm@web65504.mail.ac4.yahoo.com>
Message-ID: <Pine.LNX.4.64.0909011415230.8633@radix.cryptio.net>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
 <408754.43565.qm@web65504.mail.ac4.yahoo.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Subject: Why perform optimization in 'off hours'?
: In-Reply-To:
:     <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>

http://people.apache.org/~hossman/#threadhijack
Thread Hijacking on Mailing Lists

When starting a new discussion on a mailing list, please do not reply to 
an existing message, instead start a fresh email.  Even if you change the 
subject line of your email, other mail headers still track which thread 
you replied to and your question is "hidden" in that thread and gets less 
attention.   It makes following discussions in the mailing list archives 
particularly difficult.
See Also:  http://en.wikipedia.org/wiki/Thread_hijacking



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42111-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 21:18:25 2009
Return-Path: <java-user-return-42111-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22280 invoked from network); 1 Sep 2009 21:18:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 21:18:25 -0000
Received: (qmail 72885 invoked by uid 500); 1 Sep 2009 21:18:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72810 invoked by uid 500); 1 Sep 2009 21:18:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72800 invoked by uid 99); 1 Sep 2009 21:18:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:18:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:18:12 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 1E62471C4D6; Tue,  1 Sep 2009 14:17:51 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 1C73771C2BC
	for <java-user@lucene.apache.org>; Tue,  1 Sep 2009 14:17:51 -0700 (PDT)
Date: Tue, 1 Sep 2009 14:17:51 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Question about IndexCommit
In-Reply-To: <183825.97843.qm@web65504.mail.ac4.yahoo.com>
Message-ID: <Pine.LNX.4.64.0909011417270.8633@radix.cryptio.net>
References: <316006701.21041251801132080.JavaMail.root@mail.uk.scalix.com>
 <9ac0c6aa0909010403k3306307dxa7751ecff3fa2abd@mail.gmail.com>
 <183825.97843.qm@web65504.mail.ac4.yahoo.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Subject: Question about IndexCommit
: In-Reply-To: <9ac0c6aa0909010403k3306307dxa7751ecff3fa2abd@mail.gmail.com>

http://people.apache.org/~hossman/#threadhijack
Thread Hijacking on Mailing Lists

When starting a new discussion on a mailing list, please do not reply to 
an existing message, instead start a fresh email.  Even if you change the 
subject line of your email, other mail headers still track which thread 
you replied to and your question is "hidden" in that thread and gets less 
attention.   It makes following discussions in the mailing list archives 
particularly difficult.
See Also:  http://en.wikipedia.org/wiki/Thread_hijacking



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42112-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 21:20:03 2009
Return-Path: <java-user-return-42112-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22556 invoked from network); 1 Sep 2009 21:20:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 21:20:03 -0000
Received: (qmail 76062 invoked by uid 500); 1 Sep 2009 21:20:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75999 invoked by uid 500); 1 Sep 2009 21:20:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75985 invoked by uid 99); 1 Sep 2009 21:20:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:20:00 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of engrean@gmail.com designates 209.85.210.204 as permitted sender)
Received: from [209.85.210.204] (HELO mail-yx0-f204.google.com) (209.85.210.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:19:50 +0000
Received: by yxe42 with SMTP id 42so405571yxe.20
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 14:19:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=0f2U66s589NFsSKgHF/LUtISJZkuAkqcTxzyVAfwU/0=;
        b=X7x4UKdyb5RuZIYAX7IyaeKPI8Y/0o+PUzTlm5rIq9Fhdi3Pm3wlJbefM2Aw7fZzX9
         iNqpJECrqW8u6rduiQxVg0NQlxvNHWD4hPdfvybtfqpHjrDidK+smiU10Pr8Vy//zNVg
         97ugjXH0ut9caKIm8+RkmP1gHmfo0Vki3rtOI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=BqtGhcug/RHwJtfKruKclQeVBTHLaH+05N18uPqYzs9qkur/jUEaKUCLm5po4fJHvy
         h3hcLuAZ5pNVf/Hj+CBONtrrJXbmKWSk9p0nbLj5ktlk8WyLd0XKr8qUofVyEMZoxtaU
         13zR4/BUenL5GWJ0FR85qoA49UvLTarpGn55k=
MIME-Version: 1.0
Received: by 10.91.76.5 with SMTP id d5mr5426470agl.68.1251839968372; Tue, 01 
	Sep 2009 14:19:28 -0700 (PDT)
Date: Tue, 1 Sep 2009 15:19:28 -0600
Message-ID: <333a2bef0909011419g34ad0ebai4d82a0e2133aa92@mail.gmail.com>
Subject: Field.Store.NO & Field.Index.NOT_ANALYZED & hashCode
From: Christian <engrean@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6460652a167c304728ab43b
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6460652a167c304728ab43b
Content-Type: text/plain; charset=ISO-8859-1

Hi,

I am putting some text into a field which we set to Field.Store.NO &
Field.Index.NOT_ANALYZED. We are then doing exact & fuzzy matches against
that text (about the length of an average sentence). Currently, we have a
single field that is being used for both exact and fuzzy matches while we
have another field with the same text in it for phrase matches.

As for the exact matching, I am wondering if I should store the hashcode of
the text in a separate field and convert the text in the query to a hashcode
before passing it on or if Lucene already does something like that under the
covers when it sees Field.Store.NO & Field.Index.NOT_ANALYZED. We will have
millions of entries.

Thanks,
Christian

--0016e6460652a167c304728ab43b--

From java-user-return-42113-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 21:22:07 2009
Return-Path: <java-user-return-42113-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22813 invoked from network); 1 Sep 2009 21:22:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 21:22:07 -0000
Received: (qmail 78198 invoked by uid 500); 1 Sep 2009 21:22:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78131 invoked by uid 500); 1 Sep 2009 21:22:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78121 invoked by uid 99); 1 Sep 2009 21:22:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:22:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:21:55 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 7688671C5FF; Tue,  1 Sep 2009 14:21:34 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 74FEB71C5DC
	for <java-user@lucene.apache.org>; Tue,  1 Sep 2009 14:21:34 -0700 (PDT)
Date: Tue, 1 Sep 2009 14:21:34 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Purpose of the file modification date methods in Directory?
In-Reply-To: <25197062.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.64.0909011420460.8633@radix.cryptio.net>
References: <25136045.post@talk.nabble.com> <25192797.post@talk.nabble.com>
 <9ac0c6aa0908281032j18d7fbefvab6dcb2583c0f766@mail.gmail.com>
 <25197062.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Right, and those methods (IndexReader.lastModified and
: IndexCommit.lastModified) aren't used at all.  I guess what I meant to say

they aren't used internal in Lucene, but they are part of the public API, 
so client code (apps built using Lucene) may expect them to work for their 
own internal purposes.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42114-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 21:52:47 2009
Return-Path: <java-user-return-42114-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33456 invoked from network); 1 Sep 2009 21:52:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 21:52:47 -0000
Received: (qmail 18463 invoked by uid 500); 1 Sep 2009 21:52:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18371 invoked by uid 500); 1 Sep 2009 21:52:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18361 invoked by uid 99); 1 Sep 2009 21:52:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:52:45 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 21:52:34 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n81LqBcG020497
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 17:52:11 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Tue, 01 Sep 2009 17:52:10 -0400
  id 000273EB.4A9D978A.0000088E
Message-ID: <4A9D978A.7000406@lexum.umontreal.ca>
Date: Tue, 01 Sep 2009 17:52:10 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: New "Stream closed" exception with Java 6
References: <863227869.20901251797602027.JavaMail.root@mail.uk.scalix.com>
In-Reply-To: <863227869.20901251797602027.JavaMail.root@mail.uk.scalix.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3353=0
X-Virus-Checked: Checked by ClamAV on apache.org

I think you should do this instead (it will print the exception message 
*and* the stack trace instead of only the message) :

throw new IndexerException ("CorruptIndexException on doc: " + doc.toString(), ex);

Daniel Shane

Chris Bamford wrote:
> Hi Grant,
>  
>   
>>> I think you code there needs to show the underlying exception, too, so  
>>> we can see that stack trace.
>>>       
>
> Ummm... isn't this code already doing that?  What am I missing?
>
>             try {
>
>                 indexWriter.addDocument(doc);
>
>             } catch (CorruptIndexException ex) {
>
>                 throw new IndexerException ("CorruptIndexException on doc: " + doc.toString() +
>
>                     " - " + ex.toString());
>
>             } catch (IOException ex) {
>
>                 throw new IndexerException ("IOException on doc: " + doc.toString() +
>
>                     " - " + ex.toString());
>
>             }
>
> Thanks,
>
> - Chris
>
> Chris Bamford
> Senior Development Engineer
> Scalix
> chris.bamford@scalix.com
> Tel: +44 (0)1344 381814
> www.scalix.com
>
>
>
> ----- Original Message -----
> From: Grant Ingersoll <gsingers@apache.org>
> Sent: Sat, 29/8/2009 12:00pm
> To: java-user@lucene.apache.org
> Subject: Re: New "Stream closed" exception with Java 6
>
> I think you code there needs to show the underlying exception, too, so  
> we can see that stack trace.
>
> -Grant
>
> On Aug 28, 2009, at 11:47 AM, Chris Bamford wrote:
>
>   
>> Hi Grant
>>
>> Please see attached.
>>
>> Thanks,
>>
>> - Chris
>>
>>
>> ----- Original Message -----
>> From: Grant Ingersoll <gsingers@apache.org>
>> Sent: Fri, 28/8/2009 1:26pm
>> To: java-user@lucene.apache.org
>> Subject: Re: New "Stream closed" exception with Java 6
>>
>> Are there any log messages around that spot?  Did something happen to
>> the underlying Reader you are using?  Can you share that little bit of
>> indexing code?
>>
>> On Aug 27, 2009, at 10:11 AM, Chris Bamford wrote:
>>
>>     
>>> Hi,
>>>
>>> Since moving our app to Java 6 and Tomcat 6, we have started getting
>>> occasional exceptions of the form:
>>>
>>> java.io.IOException: Stream closed
>>>   at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>>>   at sun.nio.cs.StreamDecoder.read(Unknown Source)
>>>   at java.io.InputStreamReader.read(Unknown Source)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .analysis
>>> .standard.StandardTokenizerImpl.zzRefill(StandardTokenizerImpl.java:
>>> 443)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .analysis
>>> .standard
>>> .StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .analysis.standard.StandardTokenizer.next(StandardTokenizer.java:140)
>>>   at
>>> org
>>> .apache
>>> .lucene.analysis.standard.StandardFilter.next(StandardFilter.java:43)
>>>   at
>>> org.apache.lucene.analysis.LowerCaseFilter.next(LowerCaseFilter.java:
>>> 34)
>>>   at
>>> org
>>> .apache
>>> .lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:64)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .index.DocInverterPerField.processFields(DocInverterPerField.java: 
>>> 134)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .index
>>> .DocFieldConsumersPerField
>>> .processFields(DocFieldConsumersPerField.java:36)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .index
>>> .DocFieldProcessorPerThread
>>> .processDocument(DocFieldProcessorPerThread.java:234)
>>>   at
>>> org
>>> .apache
>>> .lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java: 
>>> 765)
>>>   at
>>> org
>>> .apache
>>> .lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
>>>   at
>>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java: 
>>> 1902)
>>>   at
>>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java: 
>>> 1880)
>>>   at
>>> com
>>> .scalix
>>> .index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:386)
>>>   at
>>> com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater.java:
>>> 176)
>>>   at
>>> com.scalix.index.manager.QueueManager.processQueue(QueueManager.java:
>>> 134)
>>>   at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
>>>   at java.lang.Thread.run(Unknown Source)
>>>
>>> We are using Lucene 2.4.  Any ideas what is happening?
>>>
>>> Thanks!
>>>
>>> - Chris
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>       
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>>
>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
>> using Solr/Lucene:
>> http://www.lucidimagination.com/search
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>> <lucene_msg.txt>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42115-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 22:02:19 2009
Return-Path: <java-user-return-42115-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36137 invoked from network); 1 Sep 2009 22:02:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 22:02:19 -0000
Received: (qmail 27239 invoked by uid 500); 1 Sep 2009 22:02:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27172 invoked by uid 500); 1 Sep 2009 22:02:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27157 invoked by uid 99); 1 Sep 2009 22:02:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 22:02:17 +0000
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=HTML_FONT_FACE_BAD,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 22:02:06 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n81M1hvJ020908
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 18:01:43 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Tue, 01 Sep 2009 18:01:43 -0400
  id 000273ED.4A9D99C7.00000D14
Message-ID: <4A9D99C7.3080400@lexum.umontreal.ca>
Date: Tue, 01 Sep 2009 18:01:43 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken / AttributeSource),
 cannot implement a LookaheadTokenFilter.
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
In-Reply-To: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
Content-Type: multipart/alternative;
 boundary="------------090303050903020106030406"
X-NAI-Spam-Level: *
X-NAI-Spam-Score: 1
X-NAI-Spam-Rules: 2 Rules triggered
	TB_BNDRY_PTRN=1, RV3353=0
X-Virus-Checked: Checked by ClamAV on apache.org

--------------090303050903020106030406
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi all!

I'm trying to port my Lucene code to the new TokenStream API and I have 
a filter that I cannot seem to port using the current new API.

The filter is called LookaheadTokenFilter. It behaves exactly like a 
normal token filter, except, you can call peek() and get information on 
the next token in the stream.

Since Lucene does not support stream "rewinding", we did this by 
buffering tokens when peek() was called and giving those back when 
next() was called and when no more "peeked" tokens exist, we then call 
super.next();

Now, I'm looking at this new API and really I'm stuck at how to port 
this using incrementToken...

Am I missing something, is there an object I can get from the 
TokenStream that I can save and get all the attributes from?

Here is the code I'm trying to port :

public class LookaheadTokenFilter extends TokenFilter {
    /** List of tokens that were peeked but not returned with next. */
    LinkedList<Token> peekedTokens = new LinkedList<Token>();

    /** The position of the next character that peek() will return in 
peekedTokens */
    int peekPosition = 0;

    public LookaheadTokenFilter(TokenStream input) {
        super(input);
    }
   
    public Token peek() throws IOException {
        if (this.peekPosition >= this.peekedTokens.size()) {
            Token token = new Token();
            token = this.input.next(token);
            if (token != null) {
                this.peekedTokens.add(token);
                this.peekPosition = this.peekedTokens.size();
            }
            return token;
        }

        return this.peekedTokens.get(this.peekPosition++);
    }
 
    public void reset() { this.peekPosition = 0; }

    public Token next(Token token) throws IOException {
        reset();

        if (this.peekedTokens.size() > 0) {
            return this.peekedTokens.removeFirst();
        }
           
        return this.input.next(token);       
    }
}

Let me know if anyone has an idea,
Daniel Shane

--------------090303050903020106030406--

From java-user-return-42116-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 22:12:59 2009
Return-Path: <java-user-return-42116-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39712 invoked from network); 1 Sep 2009 22:12:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 22:12:59 -0000
Received: (qmail 38156 invoked by uid 500); 1 Sep 2009 22:12:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38078 invoked by uid 500); 1 Sep 2009 22:12:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38068 invoked by uid 99); 1 Sep 2009 22:12:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 22:12:56 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 22:12:46 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n81MCOAp021365
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 18:12:24 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Tue, 01 Sep 2009 18:12:24 -0400
  id 000273EE.4A9D9C48.000010E0
Message-ID: <4A9D9C48.7040703@lexum.umontreal.ca>
Date: Tue, 01 Sep 2009 18:12:24 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken
 / AttributeSource), cannot implement a LookaheadTokenFilter.
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca>
In-Reply-To: <4A9D99C7.3080400@lexum.umontreal.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3353=0
X-Virus-Checked: Checked by ClamAV on apache.org

After thinking about it, the only conclusion I got was instead of saving 
the token, to save an iterator of Attributes and use that instead. It 
may work.

Daniel Shane

Daniel Shane wrote:
> Hi all!
>
> I'm trying to port my Lucene code to the new TokenStream API and I 
> have a filter that I cannot seem to port using the current new API.
>
> The filter is called LookaheadTokenFilter. It behaves exactly like a 
> normal token filter, except, you can call peek() and get information 
> on the next token in the stream.
>
> Since Lucene does not support stream "rewinding", we did this by 
> buffering tokens when peek() was called and giving those back when 
> next() was called and when no more "peeked" tokens exist, we then call 
> super.next();
>
> Now, I'm looking at this new API and really I'm stuck at how to port 
> this using incrementToken...
>
> Am I missing something, is there an object I can get from the 
> TokenStream that I can save and get all the attributes from?
>
> Here is the code I'm trying to port :
>
> public class LookaheadTokenFilter extends TokenFilter {
>    /** List of tokens that were peeked but not returned with next. */
>    LinkedList<Token> peekedTokens = new LinkedList<Token>();
>
>    /** The position of the next character that peek() will return in 
> peekedTokens */
>    int peekPosition = 0;
>
>    public LookaheadTokenFilter(TokenStream input) {
>        super(input);
>    }
>      public Token peek() throws IOException {
>        if (this.peekPosition >= this.peekedTokens.size()) {
>            Token token = new Token();
>            token = this.input.next(token);
>            if (token != null) {
>                this.peekedTokens.add(token);
>                this.peekPosition = this.peekedTokens.size();
>            }
>            return token;
>        }
>
>        return this.peekedTokens.get(this.peekPosition++);
>    }
>
>    public void reset() { this.peekPosition = 0; }
>
>    public Token next(Token token) throws IOException {
>        reset();
>
>        if (this.peekedTokens.size() > 0) {
>            return this.peekedTokens.removeFirst();
>        }
>                  return this.input.next(token);          }
> }
>
> Let me know if anyone has an idea,
> Daniel Shane
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42117-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 23:42:32 2009
Return-Path: <java-user-return-42117-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63543 invoked from network); 1 Sep 2009 23:42:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 23:42:32 -0000
Received: (qmail 28339 invoked by uid 500); 1 Sep 2009 23:42:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28252 invoked by uid 500); 1 Sep 2009 23:42:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28242 invoked by uid 99); 1 Sep 2009 23:42:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 23:42:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 209.85.211.177 as permitted sender)
Received: from [209.85.211.177] (HELO mail-yw0-f177.google.com) (209.85.211.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 23:42:20 +0000
Received: by ywh7 with SMTP id 7so674091ywh.21
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 16:41:59 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=gdyCKYUI2TT2OnxOKgFApF4eS1zHb6Cg8tD96qlMuNs=;
        b=dfTspiAehQLrcnMqx7hgVIGUuScc4uohnAbPEbDVqKIpb3n8oRcQEZsqWe1RQbPPSM
         YV7pX6wURjoHr679srCmL5FlRUGE+lzExLncDwSuHikwgGARn7g0NeKiDp/fuHpg9Je7
         pf07fyPRPUwksj+Lrer6K+StYHZAguTA0jsYU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=EjHCrA+3+ZebwsxyjNDyXXJlDIIi5U+fu6wk+oKpu2QGolDvBq5g81DKzpGXsRbfx1
         3VWDOmsuUh6CvUEZlq6CRL/exBLjqonJd1BuvwxzFHdRQFetqaPt+PRB+5ReyXtdkqiC
         gXcMAGs8gzPvlvatfvmJ4EFe8cKzMlYVqDveo=
Received: by 10.150.254.8 with SMTP id b8mr643402ybi.136.1251848519662;
        Tue, 01 Sep 2009 16:41:59 -0700 (PDT)
Received: from michael-buschs-macbook-pro-2.local (ip98-176-1-54.sd.sd.cox.net [98.176.1.54])
        by mx.google.com with ESMTPS id 23sm1522060ywh.11.2009.09.01.16.41.57
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 01 Sep 2009 16:41:58 -0700 (PDT)
Message-ID: <4A9DB1C4.3000001@gmail.com>
Date: Tue, 01 Sep 2009 16:44:04 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.1) Gecko/20090715 Thunderbird/3.0b3
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken
 / AttributeSource), cannot implement a LookaheadTokenFilter.
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca> <4A9D9C48.7040703@lexum.umontreal.ca>
In-Reply-To: <4A9D9C48.7040703@lexum.umontreal.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Daniel,

take a look at the captureState() and restoreState() APIs in 
AttributeSource and TokenStream. captureState() returns a State object 
containing all attributes with its' current values. restoreState(State) 
takes a given State and copies its values back into the TokenStream. You 
should be able to achieve the same thing by storing State objects in 
your List, instead of Token objects. peek() would change to return 
true/false instead of Token and the caller of peek consumes the values 
using the new attribute API. The change on your side should be pretty 
simple, let us know if you run into problems!

  Michael

On 9/1/09 3:12 PM, Daniel Shane wrote:
> After thinking about it, the only conclusion I got was instead of 
> saving the token, to save an iterator of Attributes and use that 
> instead. It may work.
>
> Daniel Shane
>
> Daniel Shane wrote:
>> Hi all!
>>
>> I'm trying to port my Lucene code to the new TokenStream API and I 
>> have a filter that I cannot seem to port using the current new API.
>>
>> The filter is called LookaheadTokenFilter. It behaves exactly like a 
>> normal token filter, except, you can call peek() and get information 
>> on the next token in the stream.
>>
>> Since Lucene does not support stream "rewinding", we did this by 
>> buffering tokens when peek() was called and giving those back when 
>> next() was called and when no more "peeked" tokens exist, we then 
>> call super.next();
>>
>> Now, I'm looking at this new API and really I'm stuck at how to port 
>> this using incrementToken...
>>
>> Am I missing something, is there an object I can get from the 
>> TokenStream that I can save and get all the attributes from?
>>
>> Here is the code I'm trying to port :
>>
>> public class LookaheadTokenFilter extends TokenFilter {
>>    /** List of tokens that were peeked but not returned with next. */
>>    LinkedList<Token> peekedTokens = new LinkedList<Token>();
>>
>>    /** The position of the next character that peek() will return in 
>> peekedTokens */
>>    int peekPosition = 0;
>>
>>    public LookaheadTokenFilter(TokenStream input) {
>>        super(input);
>>    }
>>      public Token peek() throws IOException {
>>        if (this.peekPosition >= this.peekedTokens.size()) {
>>            Token token = new Token();
>>            token = this.input.next(token);
>>            if (token != null) {
>>                this.peekedTokens.add(token);
>>                this.peekPosition = this.peekedTokens.size();
>>            }
>>            return token;
>>        }
>>
>>        return this.peekedTokens.get(this.peekPosition++);
>>    }
>>
>>    public void reset() { this.peekPosition = 0; }
>>
>>    public Token next(Token token) throws IOException {
>>        reset();
>>
>>        if (this.peekedTokens.size() > 0) {
>>            return this.peekedTokens.removeFirst();
>>        }
>>                  return this.input.next(token);          }
>> }
>>
>> Let me know if anyone has an idea,
>> Daniel Shane
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42118-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 01 23:51:41 2009
Return-Path: <java-user-return-42118-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64922 invoked from network); 1 Sep 2009 23:51:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Sep 2009 23:51:41 -0000
Received: (qmail 32187 invoked by uid 500); 1 Sep 2009 23:51:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32120 invoked by uid 500); 1 Sep 2009 23:51:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32110 invoked by uid 99); 1 Sep 2009 23:51:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 23:51:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 209.85.216.193 as permitted sender)
Received: from [209.85.216.193] (HELO mail-px0-f193.google.com) (209.85.216.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Sep 2009 23:51:29 +0000
Received: by pxi31 with SMTP id 31so376780pxi.3
        for <java-user@lucene.apache.org>; Tue, 01 Sep 2009 16:51:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=pHl6a0b3PueHYRP9jr0KkIaMnUK5ftPGCO9lrT096v0=;
        b=BAJ7sd4kVItDKfePwdI/1Al4ZFr5UcGiV5B+CkRKiPpHJKLmizf7H9IGCq2UWIzx8m
         8TVmvi5Kn4duqGU3GnJZ3dUrJLXkk5s3gtSZoHlodE7cduUDjt4+J8P+MwrnGXP38DU6
         t0cBbCYWN6smoC/K22T5jhmSYo91YVCsEyHlw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=FzPVq3ClXS8WAbpMS5/O8zQt1/a7rXFPPn8F9C5qdgkeVZGj6A+fHQSCcx4/GFSSu5
         cZ+tuNaFbAA8LlGKWcrfhVcRYv/JXgt8TrQyFDIIfF9z1T4WB8KFm5OQrvx5QLdxaBLY
         LEtji090V3Kzfj5zxWuEWXoXy1xn83s+I/KhU=
Received: by 10.114.164.17 with SMTP id m17mr5367541wae.3.1251849068796;
        Tue, 01 Sep 2009 16:51:08 -0700 (PDT)
Received: from michael-buschs-macbook-pro-2.local (ip98-176-1-54.sd.sd.cox.net [98.176.1.54])
        by mx.google.com with ESMTPS id 22sm646764pxi.14.2009.09.01.16.51.07
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 01 Sep 2009 16:51:08 -0700 (PDT)
Message-ID: <4A9DB3EA.7000800@gmail.com>
Date: Tue, 01 Sep 2009 16:53:14 -0700
From: Michael Busch <buschmic@gmail.com>
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.1) Gecko/20090715 Thunderbird/3.0b3
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken
 / AttributeSource), cannot implement a LookaheadTokenFilter.
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca> <4A9D9C48.7040703@lexum.umontreal.ca> <4A9DB1C4.3000001@gmail.com>
In-Reply-To: <4A9DB1C4.3000001@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

This is what I had in mind (completely untested!):

public class LookaheadTokenFilter extends TokenFilter {
   /** List of tokens that were peeked but not returned with next. */
   LinkedList<AttributeSource.State> peekedTokens = new 
LinkedList<AttributeSource.State>();

   /** The position of the next character that peek() will return in 
peekedTokens */
   int peekPosition = 0;

   public LookaheadTokenFilter(TokenStream input) {
       super(input);
   }
     public boolean peek() throws IOException {
       if (this.peekPosition >= this.peekedTokens.size()) {
           boolean hasNext = input.incrementToken();
           if (hasNext) {
               this.peekedTokens.add(captureState());
               this.peekPosition = this.peekedTokens.size();
           }
           return hasNext;
       }

       restoreState(this.peekedTokens.get(this.peekPosition++));
       return true;
   }

   public void reset() { this.peekPosition = 0; }

   public boolean incrementToken() throws IOException {
     reset();

     if (this.peekedTokens.size() > 0) {
       restoreState(this.peekedTokens.removeFirst());
       return true;
     }
     return this.input.incrementToken();
   }
}


On 9/1/09 4:44 PM, Michael Busch wrote:
> Daniel,
>
> take a look at the captureState() and restoreState() APIs in 
> AttributeSource and TokenStream. captureState() returns a State object 
> containing all attributes with its' current values. 
> restoreState(State) takes a given State and copies its values back 
> into the TokenStream. You should be able to achieve the same thing by 
> storing State objects in your List, instead of Token objects. peek() 
> would change to return true/false instead of Token and the caller of 
> peek consumes the values using the new attribute API. The change on 
> your side should be pretty simple, let us know if you run into problems!
>
>  Michael
>
> On 9/1/09 3:12 PM, Daniel Shane wrote:
>> After thinking about it, the only conclusion I got was instead of 
>> saving the token, to save an iterator of Attributes and use that 
>> instead. It may work.
>>
>> Daniel Shane
>>
>> Daniel Shane wrote:
>>> Hi all!
>>>
>>> I'm trying to port my Lucene code to the new TokenStream API and I 
>>> have a filter that I cannot seem to port using the current new API.
>>>
>>> The filter is called LookaheadTokenFilter. It behaves exactly like a 
>>> normal token filter, except, you can call peek() and get information 
>>> on the next token in the stream.
>>>
>>> Since Lucene does not support stream "rewinding", we did this by 
>>> buffering tokens when peek() was called and giving those back when 
>>> next() was called and when no more "peeked" tokens exist, we then 
>>> call super.next();
>>>
>>> Now, I'm looking at this new API and really I'm stuck at how to port 
>>> this using incrementToken...
>>>
>>> Am I missing something, is there an object I can get from the 
>>> TokenStream that I can save and get all the attributes from?
>>>
>>> Here is the code I'm trying to port :
>>>
>>> public class LookaheadTokenFilter extends TokenFilter {
>>>    /** List of tokens that were peeked but not returned with next. */
>>>    LinkedList<Token> peekedTokens = new LinkedList<Token>();
>>>
>>>    /** The position of the next character that peek() will return in 
>>> peekedTokens */
>>>    int peekPosition = 0;
>>>
>>>    public LookaheadTokenFilter(TokenStream input) {
>>>        super(input);
>>>    }
>>>      public Token peek() throws IOException {
>>>        if (this.peekPosition >= this.peekedTokens.size()) {
>>>            Token token = new Token();
>>>            token = this.input.next(token);
>>>            if (token != null) {
>>>                this.peekedTokens.add(token);
>>>                this.peekPosition = this.peekedTokens.size();
>>>            }
>>>            return token;
>>>        }
>>>
>>>        return this.peekedTokens.get(this.peekPosition++);
>>>    }
>>>
>>>    public void reset() { this.peekPosition = 0; }
>>>
>>>    public Token next(Token token) throws IOException {
>>>        reset();
>>>
>>>        if (this.peekedTokens.size() > 0) {
>>>            return this.peekedTokens.removeFirst();
>>>        }
>>>                  return this.input.next(token);          }
>>> }
>>>
>>> Let me know if anyone has an idea,
>>> Daniel Shane
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42119-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 00:29:27 2009
Return-Path: <java-user-return-42119-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79692 invoked from network); 2 Sep 2009 00:29:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 00:29:27 -0000
Received: (qmail 59571 invoked by uid 500); 2 Sep 2009 00:29:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59484 invoked by uid 500); 2 Sep 2009 00:29:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59474 invoked by uid 99); 2 Sep 2009 00:29:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 00:29:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 00:29:17 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id C03EF71C77C; Tue,  1 Sep 2009 17:28:56 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id BDC4771C698
	for <java-user@lucene.apache.org>; Tue,  1 Sep 2009 17:28:56 -0700 (PDT)
Date: Tue, 1 Sep 2009 17:28:56 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Performance diffs between filter.bits() and searcher.docFreq()
In-Reply-To: <25186776.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.64.0909011728090.17644@radix.cryptio.net>
References: <25186776.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org

: new TermsFilter( termsList:[ new Term( 'id', '111' ) ] ).bits( indexReader
: ).cardinality()
	...
: indexReader.docFreq( new Term( 'id', '111' ) )
	...
: Which one is faster? Can I replace the 2nd one with the 1st and still get
: the same performance?

"the second", and "no"




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42120-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 02:36:17 2009
Return-Path: <java-user-return-42120-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3058 invoked from network); 2 Sep 2009 02:36:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 02:36:17 -0000
Received: (qmail 52225 invoked by uid 500); 2 Sep 2009 02:36:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52156 invoked by uid 500); 2 Sep 2009 02:36:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52146 invoked by uid 99); 2 Sep 2009 02:36:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 02:36:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 02:36:06 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MifhJ-0006IK-Qr
	for java-user@lucene.apache.org; Tue, 01 Sep 2009 19:35:45 -0700
Message-ID: <25250745.post@talk.nabble.com>
Date: Tue, 1 Sep 2009 19:35:45 -0700 (PDT)
From: cemerick <cemerick@snowtide.com>
To: java-user@lucene.apache.org
Subject: Re: Purpose of the file modification date methods in Directory?
In-Reply-To: <Pine.LNX.4.64.0909011420460.8633@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: cemerick@snowtide.com
References: <25136045.post@talk.nabble.com> <25192797.post@talk.nabble.com> <9ac0c6aa0908281032j18d7fbefvab6dcb2583c0f766@mail.gmail.com> <25197062.post@talk.nabble.com> <Pine.LNX.4.64.0909011420460.8633@radix.cryptio.net>
X-Virus-Checked: Checked by ClamAV on apache.org


Fair enough.  This Directory impl is really only useful in conjunction with
other usage of the jdbm embedded database -- I can't imagine people layering
other Lucene-dependent projects on top (like Solr or whatever).

I suppose if that time ever comes, I'll revisit the issue. :-)

- Chas


hossman wrote:
> 
> 
> : Right, and those methods (IndexReader.lastModified and
> : IndexCommit.lastModified) aren't used at all.  I guess what I meant to
> say
> 
> they aren't used internal in Lucene, but they are part of the public API, 
> so client code (apps built using Lucene) may expect them to work for their 
> own internal purposes.
> 
> 
> -Hoss
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Purpose-of-the-file-modification-date-methods-in-Directory--tp25136045p25250745.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42121-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 02:52:38 2009
Return-Path: <java-user-return-42121-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5847 invoked from network); 2 Sep 2009 02:52:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 02:52:38 -0000
Received: (qmail 61176 invoked by uid 500); 2 Sep 2009 02:52:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61106 invoked by uid 500); 2 Sep 2009 02:52:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61094 invoked by uid 99); 2 Sep 2009 02:52:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 02:52:35 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Fang_Li@emc.com designates 128.222.32.20 as permitted sender)
Received: from [128.222.32.20] (HELO mexforward.lss.emc.com) (128.222.32.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 02:52:23 +0000
Received: from hop04-l1d11-si02.isus.emc.com (HOP04-L1D11-SI02.isus.emc.com [10.254.111.55])
	by mexforward.lss.emc.com (Switch-3.3.2/Switch-3.1.7) with ESMTP id n822q222028733
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 22:52:02 -0400
Received: from mailhub.lss.emc.com (numailhub.lss.emc.com [10.254.144.16]) by hop04-l1d11-si02.isus.emc.com (Tablus Interceptor) for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 22:51:52 -0400
Received: from corpussmtp4.corp.emc.com (corpussmtp4.corp.emc.com [10.254.169.197])
	by mailhub.lss.emc.com (Switch-3.3.2/Switch-3.3.2) with ESMTP id n822poUn018944
	for <java-user@lucene.apache.org>; Tue, 1 Sep 2009 22:51:52 -0400
Received: from CORPUSMX110B.corp.emc.com ([128.221.151.108]) by corpussmtp4.corp.emc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 1 Sep 2009 22:51:50 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-2"
Content-Transfer-Encoding: quoted-printable
Subject: RE: exception to open a large index Insufficient system resources exist
Date: Tue, 1 Sep 2009 22:49:22 -0400
Message-ID: <247ECD1AB4ED914A80AE4873CFC230A45069F4@CORPUSMX110B.corp.emc.com>
In-Reply-To: <471B926324114432B1D4E5B9F054F93F@VEGA>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: exception to open a large index Insufficient system resources exist
thread-index: Acoq6oECiSqANxdpSp2cvd2nxttaBgAAH1RQAAB3yNAAInlHcA==
References: <247ECD1AB4ED914A80AE4873CFC230A4506845@CORPUSMX110B.corp.emc.com> <2ffb6d060909010256ye0a3ca9h44dd5d85fc339260@mail.gmail.com> <247ECD1AB4ED914A80AE4873CFC230A4506860@CORPUSMX110B.corp.emc.com> <471B926324114432B1D4E5B9F054F93F@VEGA>
From: <Fang_Li@emc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 02 Sep 2009 02:51:50.0427 (UTC) FILETIME=[51F08EB0:01CA2B78]
X-EMM-EM: Active
X-Virus-Checked: Checked by ClamAV on apache.org

32 bit JVM, 1.3G allocated heap size, Lucene 2.4.1.

In my option, this exception should not be caused by out of memory or =
out of system file handle because different exception should be thrown =
for these two cases.

Any hint?

Thanks,
Fang, Li

-----Original Message-----
From: Uwe Schindler [mailto:uwe@thetaphi.de]=20
Sent: Tuesday, September 01, 2009 6:14 PM
To: java-user@lucene.apache.org
Subject: RE: exception to open a large index Insufficient system =
resources exist

Which Lucene version, 64 bit JVM?

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Fang_Li@emc.com [mailto:Fang_Li@emc.com]
> Sent: Tuesday, September 01, 2009 12:04 PM
> To: java-user@lucene.apache.org
> Subject: RE: exception to open a large index Insufficient system =
resources
> exist
>=20
> We are running on Windows 2003 Enterprise Edition with NTFS file =
system on
> a local disc. JDK version is 1.5.0.12.
>=20
> The problem was discussed before and there is no clear solution =
confirmed.
>=20
> Thanks.
>=20
> -----Original Message-----
> From: Danil =DEORIN [mailto:torindan@gmail.com]
> Sent: Tuesday, September 01, 2009 5:56 PM
> To: java-user@lucene.apache.org
> Subject: Re: exception to open a large index Insufficient system =
resources
> exist
>=20
> There should be no problem with large segments.
> Please describe OS, FileSystem and JDK you are running on.
>=20
> There might be some problems with file >2Gb on Win32/FAT, or in some
> ancient Linuxes.
>=20
> On Tue, Sep 1, 2009 at 12:37, <Fang_Li@emc.com> wrote:
> > I met a problem to open an index bigger than 8GB and the following
> > exception was thrown. There is a segment which is bigger than 4GB
> > already. After searching internet, it is said that not using =
compound
> > index may solve the problem.
> >
> > The same exception was thrown when merging with another index =
happens.
> > If the problem is caused by the big segment, we can adjust Lucene
> > parameters to control the segment size.
> > Anyone knows what's the cause for this exception? As reproducing the
> > problem will take a long time, your idea will be save us a lot of
> > effort.
> >
> > java.io.IOException: Insufficient system resources exist to complete =
the
> > requested service
> > =A0 =A0 =A0 =A0at java.io.RandomAccessFile.readBytes(Native Method)
> > =A0 =A0 =A0 =A0at =
java.io.RandomAccessFile.read(RandomAccessFile.java:315)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.store.FSDirectory$FSIndexInput.readInternal(FSDirector
> > y.java:596)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.jav
> > a:157)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.j
> > ava:38)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.store.IndexInput.readVInt(IndexInput.java:78)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.CompoundFileReader.<init>(CompoundFileReader.jav
> > a:73)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java:321)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.index.SegmentReader.get(SegmentReader.java:306)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.index.SegmentReader.get(SegmentReader.java:228)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.MultiSegmentReader.<init>(MultiSegmentReader.jav
> > a:55)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.DirectoryIndexReader$1.doBody(DirectoryIndexRead
> > er.java:104)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.j
> > ava:653)
> > =A0 =A0 =A0 =A0at
> > =
org.apache.lucene.index.DirectoryIndexReader.open(DirectoryIndexReader.j
> > ava:115)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.index.IndexReader.open(IndexReader.java:316)
> > =A0 =A0 =A0 =A0at
> > org.apache.lucene.index.IndexReader.open(IndexReader.java:227)
> >
> > Thanks,
> > -Li
> >
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42122-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 04:09:50 2009
Return-Path: <java-user-return-42122-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20423 invoked from network); 2 Sep 2009 04:09:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 04:09:50 -0000
Received: (qmail 98405 invoked by uid 500); 2 Sep 2009 04:09:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98295 invoked by uid 500); 2 Sep 2009 04:09:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98148 invoked by uid 99); 2 Sep 2009 04:09:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 04:09:46 +0000
X-ASF-Spam-Status: No, hits=1.1 required=10.0
	tests=FORGED_HOTMAIL_RCVD2,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 04:09:36 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mih9n-0000dc-KS
	for java-user@lucene.apache.org; Tue, 01 Sep 2009 21:09:15 -0700
Message-ID: <25251378.post@talk.nabble.com>
Date: Tue, 1 Sep 2009 21:09:15 -0700 (PDT)
From: Sahi <sahilkaushik@hotmail.com>
To: java-user@lucene.apache.org
Subject: Deletion of words in articles of Wikipedia
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sahilkaushik@hotmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I'm new to this site. My question is:

Articles in wikipedia can be edited by everyone and may or may not be
accurate. If any contributor writes an article and then another contributor
deletes certain content in that article would indicate that the article is
controversial. 
I need to start off with this project where we can find the ranking of
controversial articles. Could anyone kindly help me how to start?

Thanks
-- 
View this message in context: http://www.nabble.com/Deletion-of-words-in-articles-of-Wikipedia-tp25251378p25251378.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42123-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 06:23:58 2009
Return-Path: <java-user-return-42123-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50057 invoked from network); 2 Sep 2009 06:23:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 06:23:58 -0000
Received: (qmail 6537 invoked by uid 500); 2 Sep 2009 06:23:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6451 invoked by uid 500); 2 Sep 2009 06:23:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6441 invoked by uid 99); 2 Sep 2009 06:23:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 06:23:56 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 06:23:45 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 43644D36006
	for <java-user@lucene.apache.org>; Wed,  2 Sep 2009 08:23:23 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 0+AJWHbdFVQB for <java-user@lucene.apache.org>;
	Wed,  2 Sep 2009 08:23:13 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id D3AD0D36003
	for <java-user@lucene.apache.org>; Wed,  2 Sep 2009 08:23:12 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca> <4A9D9C48.7040703@lexum.umontreal.ca> <4A9DB1C4.3000001@gmail.com> <4A9DB3EA.7000800@gmail.com>
Subject: RE: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken / AttributeSource), cannot implement a LookaheadTokenFilter.
Date: Wed, 2 Sep 2009 08:23:12 +0200
Message-ID: <A95513C77FA44482B345BA468895E341@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4A9DB3EA.7000800@gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
thread-index: AcorXy7Ezz3NYlToTxW+y2qUAXXJtAANd0Iw
X-Virus-Checked: Checked by ClamAV on apache.org

There may be a problem that you may not want to restore the peek token into
the TokenFilter's attributes itsself. It looks like you want to have a Token
instance returned from peek, but the current Stream should not reset to this
Token (you only want to "look" into the next Token and then possibly do
something special with the current Token). To achive this, there is a method
cloneAttributes() in TokenStream, that creates a new AttributeSource with
same attribute types, which is independent from the cloned one. You can then
use clone.getAttribute(TermAttribute.class).term() or similar to look into
the next token. But creating this new clone is costy, so you may also create
it once and reuse. In the peek method, you simply copy the state of this to
the cloned attributesource.

It's a bit complicated but should work somehow. Tell me if you need more
help. Maybe you should provide us with some code, what you want to do with
the TokenFilter.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Michael Busch [mailto:buschmic@gmail.com]
> Sent: Wednesday, September 02, 2009 1:53 AM
> To: java-user@lucene.apache.org
> Subject: Re: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken
> / AttributeSource), cannot implement a LookaheadTokenFilter.
> 
> This is what I had in mind (completely untested!):
> 
> public class LookaheadTokenFilter extends TokenFilter {
>    /** List of tokens that were peeked but not returned with next. */
>    LinkedList<AttributeSource.State> peekedTokens = new
> LinkedList<AttributeSource.State>();
> 
>    /** The position of the next character that peek() will return in
> peekedTokens */
>    int peekPosition = 0;
> 
>    public LookaheadTokenFilter(TokenStream input) {
>        super(input);
>    }
>      public boolean peek() throws IOException {
>        if (this.peekPosition >= this.peekedTokens.size()) {
>            boolean hasNext = input.incrementToken();
>            if (hasNext) {
>                this.peekedTokens.add(captureState());
>                this.peekPosition = this.peekedTokens.size();
>            }
>            return hasNext;
>        }
> 
>        restoreState(this.peekedTokens.get(this.peekPosition++));
>        return true;
>    }
> 
>    public void reset() { this.peekPosition = 0; }
> 
>    public boolean incrementToken() throws IOException {
>      reset();
> 
>      if (this.peekedTokens.size() > 0) {
>        restoreState(this.peekedTokens.removeFirst());
>        return true;
>      }
>      return this.input.incrementToken();
>    }
> }
> 
> 
> On 9/1/09 4:44 PM, Michael Busch wrote:
> > Daniel,
> >
> > take a look at the captureState() and restoreState() APIs in
> > AttributeSource and TokenStream. captureState() returns a State object
> > containing all attributes with its' current values.
> > restoreState(State) takes a given State and copies its values back
> > into the TokenStream. You should be able to achieve the same thing by
> > storing State objects in your List, instead of Token objects. peek()
> > would change to return true/false instead of Token and the caller of
> > peek consumes the values using the new attribute API. The change on
> > your side should be pretty simple, let us know if you run into problems!
> >
> >  Michael
> >
> > On 9/1/09 3:12 PM, Daniel Shane wrote:
> >> After thinking about it, the only conclusion I got was instead of
> >> saving the token, to save an iterator of Attributes and use that
> >> instead. It may work.
> >>
> >> Daniel Shane
> >>
> >> Daniel Shane wrote:
> >>> Hi all!
> >>>
> >>> I'm trying to port my Lucene code to the new TokenStream API and I
> >>> have a filter that I cannot seem to port using the current new API.
> >>>
> >>> The filter is called LookaheadTokenFilter. It behaves exactly like a
> >>> normal token filter, except, you can call peek() and get information
> >>> on the next token in the stream.
> >>>
> >>> Since Lucene does not support stream "rewinding", we did this by
> >>> buffering tokens when peek() was called and giving those back when
> >>> next() was called and when no more "peeked" tokens exist, we then
> >>> call super.next();
> >>>
> >>> Now, I'm looking at this new API and really I'm stuck at how to port
> >>> this using incrementToken...
> >>>
> >>> Am I missing something, is there an object I can get from the
> >>> TokenStream that I can save and get all the attributes from?
> >>>
> >>> Here is the code I'm trying to port :
> >>>
> >>> public class LookaheadTokenFilter extends TokenFilter {
> >>>    /** List of tokens that were peeked but not returned with next. */
> >>>    LinkedList<Token> peekedTokens = new LinkedList<Token>();
> >>>
> >>>    /** The position of the next character that peek() will return in
> >>> peekedTokens */
> >>>    int peekPosition = 0;
> >>>
> >>>    public LookaheadTokenFilter(TokenStream input) {
> >>>        super(input);
> >>>    }
> >>>      public Token peek() throws IOException {
> >>>        if (this.peekPosition >= this.peekedTokens.size()) {
> >>>            Token token = new Token();
> >>>            token = this.input.next(token);
> >>>            if (token != null) {
> >>>                this.peekedTokens.add(token);
> >>>                this.peekPosition = this.peekedTokens.size();
> >>>            }
> >>>            return token;
> >>>        }
> >>>
> >>>        return this.peekedTokens.get(this.peekPosition++);
> >>>    }
> >>>
> >>>    public void reset() { this.peekPosition = 0; }
> >>>
> >>>    public Token next(Token token) throws IOException {
> >>>        reset();
> >>>
> >>>        if (this.peekedTokens.size() > 0) {
> >>>            return this.peekedTokens.removeFirst();
> >>>        }
> >>>                  return this.input.next(token);          }
> >>> }
> >>>
> >>> Let me know if anyone has an idea,
> >>> Daniel Shane
> >>>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42124-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 08:28:03 2009
Return-Path: <java-user-return-42124-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78240 invoked from network); 2 Sep 2009 08:28:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 08:28:02 -0000
Received: (qmail 34855 invoked by uid 500); 2 Sep 2009 08:28:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34776 invoked by uid 500); 2 Sep 2009 08:28:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34766 invoked by uid 99); 2 Sep 2009 08:28:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 08:28:00 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 08:27:51 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MilBj-00006v-1H
	for java-user@lucene.apache.org; Wed, 02 Sep 2009 01:27:31 -0700
Message-ID: <25253535.post@talk.nabble.com>
Date: Wed, 2 Sep 2009 01:27:31 -0700 (PDT)
From: Konstantyn Smirnov <injecteer@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: Performance diffs between filter.bits() and searcher.docFreq()
In-Reply-To: <Pine.LNX.4.64.0909011728090.17644@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: injecteer@yahoo.com
References: <25186776.post@talk.nabble.com> <Pine.LNX.4.64.0909011728090.17644@radix.cryptio.net>
X-Virus-Checked: Checked by ClamAV on apache.org



hossman wrote:
> 
> "the second", and "no"
> 
Thanks for that. 

Concerning the *theoretical* performance difference, for the mid-size index,
what will it be in % roughly?

Are there any way to make indexReader.docFreqs() reflect the changes faster,
i.e. without the need to optimize()?

-----
Konstantyn Smirnov, CTO 
http://www.poiradar.ru www.poiradar.ru 
http://www.poiradar.com.ua www.poiradar.com.ua 
http://www.poiradar.com www.poiradar.com 
http://www.poiradar.de www.poiradar.de 
-- 
View this message in context: http://www.nabble.com/Performance-diffs-between-filter.bits%28%29-and-searcher.docFreq%28%29-tp25186776p25253535.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42125-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 09:56:21 2009
Return-Path: <java-user-return-42125-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99812 invoked from network); 2 Sep 2009 09:56:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 09:56:20 -0000
Received: (qmail 40358 invoked by uid 500); 2 Sep 2009 09:56:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40283 invoked by uid 500); 2 Sep 2009 09:56:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40268 invoked by uid 99); 2 Sep 2009 09:56:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 09:56:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 09:56:09 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MimZA-00037B-KC
	for java-user@lucene.apache.org; Wed, 02 Sep 2009 02:55:48 -0700
Message-ID: <25254673.post@talk.nabble.com>
Date: Wed, 2 Sep 2009 02:55:48 -0700 (PDT)
From: prasenjit <prasen.bea@gmail.com>
To: java-user@lucene.apache.org
Subject: lucene on amazon s3
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: prasen.bea@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


I am exploring the possibility of creating large lucene indices via ec2/s3.
Till now I have got only teh following url :
http://www.kimchy.org/lucene-and-amazon-s3/

But still dont know whether the lucene locking problem ( on a distributed FS
like S3/DFS ) is fixed or not. Any information is greatly apreciated. 
-- 
View this message in context: http://www.nabble.com/lucene-on-amazon-s3-tp25254673p25254673.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42126-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 10:08:58 2009
Return-Path: <java-user-return-42126-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3414 invoked from network); 2 Sep 2009 10:08:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 10:08:58 -0000
Received: (qmail 60628 invoked by uid 500); 2 Sep 2009 10:08:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60564 invoked by uid 500); 2 Sep 2009 10:08:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60554 invoked by uid 99); 2 Sep 2009 10:08:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 10:08:55 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [212.82.104.180] (HELO web24707.mail.ird.yahoo.com) (212.82.104.180)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 02 Sep 2009 10:08:43 +0000
Received: (qmail 13323 invoked by uid 60001); 2 Sep 2009 10:08:20 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1251886100; bh=vmpuF7xywokAW1dX2WPyhZn1TC5sz02tJDhxXbv5KOg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=4dkmNzV0iRwuKAocOyQ6J6g2AWdAJfGZS3iwzu/i+Gft3hm+TFM4YvbF9swDYQ8SRgS38XEVxKsyeLCRq8QSc9OXTpJGLDGVrF3Vw4lszm2rr1ulrvKTUW6V0kto3DK3UfO35FrdsWjj6TNNvDu3W5wbnbPTCgfCNUqgaRTNtYc=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=2qxd6eR89zPRY8M6Q1aiyfB2MoeU/pOqioTklnJn/iXvbH51Z4HCbRFEUNfgYOuLf6XPW7nJ8ieN4MgG9kNSJDvoO7+pIZjIv88/G5ndtVmvCZl3tlxLMt92QVUWvlL9YrOleJHZ4vMYI4ZJ8mDw/D9uBTllOSEIfVB+8NGwP1w=;
Message-ID: <470611.4890.qm@web24707.mail.ird.yahoo.com>
X-YMail-OSG: dObkdGoVM1ndoHvlq5_0HvO4blM1QaNSPENLvXwa7JZdHK8e.vtF71Je0poyY9wYSsfwWBXcfjH2ciRk.RkdfPr9AUPA_LvEU34U83bkzhW.K3uPfbmtEkeidWu5aQ27j45i9jNCchGaM8_gyVeHKAdSbtpUrcm1O8EaZhgeDfm9I9jpY3xYY0KbjdUD5P1qTL7JZIUYKBz2HrIv6OLIJNt5lJE42AYq33LF2U2urDYRJDOZ0_TqABZzq9yix1xPWGih3Wk_csN6DILyoiUc_QA2Svyav.wAOKpjvggWqdvfNGKOQivWectdRP13lzyxqitDXe4-
Received: from [193.36.230.96] by web24707.mail.ird.yahoo.com via HTTP; Wed, 02 Sep 2009 10:08:20 GMT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <25251378.post@talk.nabble.com>
Date: Wed, 2 Sep 2009 10:08:20 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Deletion of words in articles of Wikipedia
To: java-user@lucene.apache.org
In-Reply-To: <25251378.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

>>I need to start off with this project where we can find the ranking of=0A=
>>controversial articles. Could anyone kindly help me how to start?=0A=0ACh=
eck out the wikipedia "logging" dumps which contain the reasons for actions=
 on page titles (including ip blocks and deletes) but without the bulk of t=
he full text changes.=0Ae.g. http://download.wikimedia.org/enwiki/20090827/=
enwiki-20090827-pages-logging.xml.gz=0A=0AOnce you get this in Lucene "Luke=
" can help you explore and pinpoint the key target pages for vandalism.=0A=
=0A=0ACheers,=0AMark=0A=0A=0A=0A=0A----- Original Message ----=0AFrom: Sahi=
 <sahilkaushik@hotmail.com>=0ATo: java-user@lucene.apache.org=0ASent: Wedne=
sday, 2 September, 2009 5:09:15=0ASubject: Deletion of words in articles of=
 Wikipedia=0A=0A=0AHi,=0A=0AI'm new to this site. My question is:=0A=0AArti=
cles in wikipedia can be edited by everyone and may or may not be=0Aaccurat=
e. If any contributor writes an article and then another contributor=0Adele=
tes certain content in that article would indicate that the article is=0Aco=
ntroversial. =0AI need to start off with this project where we can find the=
 ranking of=0Acontroversial articles. Could anyone kindly help me how to st=
art?=0A=0AThanks=0A-- =0AView this message in context: http://www.nabble.co=
m/Deletion-of-words-in-articles-of-Wikipedia-tp25251378p25251378.html=0ASen=
t from the Lucene - Java Users mailing list archive at Nabble.com.=0A=0A=0A=
---------------------------------------------------------------------=0ATo =
unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0AFor addition=
al commands, e-mail: java-user-help@lucene.apache.org=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42127-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 10:16:50 2009
Return-Path: <java-user-return-42127-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6111 invoked from network); 2 Sep 2009 10:16:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 10:16:50 -0000
Received: (qmail 77710 invoked by uid 500); 2 Sep 2009 10:16:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77647 invoked by uid 500); 2 Sep 2009 10:16:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77637 invoked by uid 99); 2 Sep 2009 10:16:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 10:16:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 10:16:37 +0000
Received: by fg-out-1718.google.com with SMTP id d23so989415fga.5
        for <java-user@lucene.apache.org>; Wed, 02 Sep 2009 03:16:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type;
        bh=K0ch6LBJhd/wFy8/WODtMNzKdTaYaFysIXRMfWVMF98=;
        b=P3f92M+3RQWE/IbGmDADCcvhkKb+OzM4CFzFOKuKhbF0Mx7jxtL4htjO/Z1lJx3BpZ
         xzKH5qwVPUQM7bYVgbFbC5ODkmMbO/EVQz/XKfat8pFewUPNIKOFN1yhPVFIVyKHZ/QW
         siXV/oaCQ/9jxwh5rjlP0K5Xts0weEZlaW63g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type;
        b=Cx/58xUaCPEP8OLR4JFtETVz2vMZgYrJJeyUz5h6QQdGw+EaAIJjYKoImtVCZ35AVg
         S+n5viAemRQHExNZY4bBRTEkcjnb1nzT9YHg4YDGNU9P5juKuYy8rD37eMNwfJwfV+nF
         b9n3mMaamYfG4Qx98OlxxAkGQXBWrxrV717oQ=
MIME-Version: 1.0
Received: by 10.239.179.94 with SMTP id c30mr672117hbg.159.1251886575942; Wed, 
	02 Sep 2009 03:16:15 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <25254673.post@talk.nabble.com>
References: <25254673.post@talk.nabble.com>
Date: Wed, 2 Sep 2009 12:16:15 +0200
Message-ID: <f18c9dde0909020316r18ef860bref13b7263967816a@mail.gmail.com>
Subject: Re: lucene on amazon s3
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Hey there, AFAIK this problem on S3 has not been solved but anyway
there might be other solutions to overcome this problem. As you are
running on amazon anyway you might wanna consider to have some locking
service like ZooKeeper  (http://hadoop.apache.org/zookeeper/) which
could help you with other problems in the future too. You might wanna
look at the recipes section
(http://hadoop.apache.org/zookeeper/docs/r3.2.0/recipes.html#sc_recipes_Locks)
and create you distributed lock yourself.
One more thing, I guess this is not a lucene-locking problem as the
locking API is highly customizable see LockFactory
(http://lucene.apache.org/java/2_4_0/api/core/org/apache/lucene/store/LockFactory.html)
and Directory@setLockFactory
(http://lucene.apache.org/java/2_4_0/api/core/org/apache/lucene/store/Directory.html#setLockFactory%28org.apache.lucene.store.LockFactory%29)

simon

On Wed, Sep 2, 2009 at 11:55 AM, prasenjit<prasen.bea@gmail.com> wrote:
>
> I am exploring the possibility of creating large lucene indices via ec2/s3.
> Till now I have got only teh following url :
> http://www.kimchy.org/lucene-and-amazon-s3/
>
> But still dont know whether the lucene locking problem ( on a distributed FS
> like S3/DFS ) is fixed or not. Any information is greatly apreciated.
> --
> View this message in context: http://www.nabble.com/lucene-on-amazon-s3-tp25254673p25254673.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42128-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 10:37:18 2009
Return-Path: <java-user-return-42128-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12130 invoked from network); 2 Sep 2009 10:37:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 10:37:17 -0000
Received: (qmail 4750 invoked by uid 500); 2 Sep 2009 10:37:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4691 invoked by uid 500); 2 Sep 2009 10:37:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4681 invoked by uid 99); 2 Sep 2009 10:37:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 10:37:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [202.86.5.95] (HELO smtp108.mail.in.yahoo.com) (202.86.5.95)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 02 Sep 2009 10:37:03 +0000
Received: (qmail 35383 invoked from network); 2 Sep 2009 10:36:40 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=SBwp29uzJ+xPTW0gWgvLZS9z3Tf8hILTpQgRf3DUjMblZwWQBDVBJ7svJ3KYuObe25BtOGrA0doHRh9znHHL2fSBjABMNk/LtaAhoCOCNP4+BHRPEewGuD6Igp2wY5J7RazjwdCxJn8AL3MwHR9P0dSAthEYpWAgHDyY1MarSBU=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp108.mail.in.yahoo.com with SMTP; 2 Sep 2009 10:36:40 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: 5bGiri0VM1kVXMNHnQNwY1AoleYcHrw.21kg1v1iRbM1B39Gfzwov2JizWF91TaaBCFbX9X7UpNOGvYsZd2hJydRv6Wj2bdzkpT5ym01F0dW.NE7NOVOjTxn3hiUr67WFEHJ3ek55QuNU2AYqC3uDeEyqbB7Jls09TzVyFgamgnYyxn.ZTxq8p7iU1Fm
X-Yahoo-Newman-Property: ymail-3
Message-ID: <003101ca2bb9$419a0f00$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Subject: First result in the group
Date: Wed, 2 Sep 2009 16:06:35 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all,

I want to retrieve the first result in the group. How to acheive this? =
Currently i am parsing all the results, using a hash and avoiding =
duplicate entries.=20

Is there any better way?

Regards
Ganesh
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42129-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 10:58:34 2009
Return-Path: <java-user-return-42129-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17796 invoked from network); 2 Sep 2009 10:58:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 10:58:34 -0000
Received: (qmail 31583 invoked by uid 500); 2 Sep 2009 10:58:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31508 invoked by uid 500); 2 Sep 2009 10:58:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31498 invoked by uid 99); 2 Sep 2009 10:58:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 10:58:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.204] (HELO mail-yx0-f204.google.com) (209.85.210.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 10:58:21 +0000
Received: by yxe42 with SMTP id 42so964479yxe.20
        for <java-user@lucene.apache.org>; Wed, 02 Sep 2009 03:58:00 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.90.4 with SMTP id n4mr12329503ybb.170.1251889079949; Wed, 
	02 Sep 2009 03:57:59 -0700 (PDT)
In-Reply-To: <25254673.post@talk.nabble.com>
References: <25254673.post@talk.nabble.com>
Date: Wed, 2 Sep 2009 06:57:59 -0400
Message-ID: <9ac0c6aa0909020357x3d7b2af3t76d4ed095499c1d3@mail.gmail.com>
Subject: Re: lucene on amazon s3
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

So long as you can ensure, external to Lucene, that only one
IndexWriter is open at once on the index, you can disable all of
Lucene's normal locking.  But you must be certain: if you accidentally
allow two IndexWriter's to be open at once, it will quickly corrupt
the index.

Beyond locking, Lucene also generally requires client side cache
coherence of the filesystem.  Notably, NFS and the 2.0 version of
Microsoft's SMB/CIFS (the default in Windows Server 7 & Vista), have
cache coherence problems (SMB/CIFS 1.0 works fine).  EG, if a writer
somewhere updates the index, when a reader somewhere else lists the
directory, is it guaranteed that the directory listing is always
correct?

If there are cache coherence problems, it usually manifests as a
"false" FileNotFoundException... the good news is, you can catch this,
wait a bit, and retry, as a workaround.

If you get any data on S3's cache coherence, please post back!

Mike

On Wed, Sep 2, 2009 at 5:55 AM, prasenjit<prasen.bea@gmail.com> wrote:
>
> I am exploring the possibility of creating large lucene indices via ec2/s3.
> Till now I have got only teh following url :
> http://www.kimchy.org/lucene-and-amazon-s3/
>
> But still dont know whether the lucene locking problem ( on a distributed FS
> like S3/DFS ) is fixed or not. Any information is greatly apreciated.
> --
> View this message in context: http://www.nabble.com/lucene-on-amazon-s3-tp25254673p25254673.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42130-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 11:04:08 2009
Return-Path: <java-user-return-42130-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19788 invoked from network); 2 Sep 2009 11:04:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 11:04:08 -0000
Received: (qmail 39800 invoked by uid 500); 2 Sep 2009 11:04:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39727 invoked by uid 500); 2 Sep 2009 11:04:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39717 invoked by uid 99); 2 Sep 2009 11:04:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 11:04:05 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 11:03:57 +0000
Received: by ewy22 with SMTP id 22so534485ewy.28
        for <java-user@lucene.apache.org>; Wed, 02 Sep 2009 04:03:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=URtWOzRqT2xBP4SxLCit37syuuCgZVOpBvmMYFigCFw=;
        b=RDuxksscvswJ1mQ+32kuftmwsko7O1OiVzsk5dV0CDJtVI18h8ZdzSxXCERTePslgo
         OrdASQUDo+fDnIN+E4mK9dV8ffWx9p83n0wDMRfNguMuHhSIdskaAVaa49VLudCQ0GWS
         QONrQCizuGtl7J/ru812wD1a9EXgwK7pORbgE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=lwdf8XaFOxXg96B2DSE5ydlcPQnkSItbzsspDOUlrBqfGM26evconAymiewG1/DEqi
         eY4jcbitV+V7ztxnedv6HvXcD7cgIOqe0X9fDXFOGrNMxf3Gfou0s0+PZ151O0wUR5ZM
         ENFiWzqY1uV/qDa4OZXUISkFPB8B1yr8F9cwc=
MIME-Version: 1.0
Received: by 10.216.87.201 with SMTP id y51mr118797wee.80.1251889415391; Wed, 
	02 Sep 2009 04:03:35 -0700 (PDT)
In-Reply-To: <003101ca2bb9$419a0f00$710bc30a@sv.us.sonicwall.com>
References: <003101ca2bb9$419a0f00$710bc30a@sv.us.sonicwall.com>
Date: Wed, 2 Sep 2009 14:03:35 +0300
Message-ID: <786fde50909020403n3f2d72d8gc35a0d7bc6d21c62@mail.gmail.com>
Subject: Re: First result in the group
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d564c2e70b2004729637ef
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d564c2e70b2004729637ef
Content-Type: text/plain; charset=ISO-8859-1

What do you mean by "first result in the group"? What is a group?

On Wed, Sep 2, 2009 at 1:36 PM, Ganesh <emailgane@yahoo.co.in> wrote:

> Hello all,
>
> I want to retrieve the first result in the group. How to acheive this?
> Currently i am parsing all the results, using a hash and avoiding duplicate
> entries.
>
> Is there any better way?
>
> Regards
> Ganesh
> Send instant messages to your online friends http://in.messenger.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d564c2e70b2004729637ef--

From java-user-return-42131-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 11:39:17 2009
Return-Path: <java-user-return-42131-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30181 invoked from network); 2 Sep 2009 11:39:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 11:39:17 -0000
Received: (qmail 92369 invoked by uid 500); 2 Sep 2009 11:39:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92277 invoked by uid 500); 2 Sep 2009 11:39:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92267 invoked by uid 99); 2 Sep 2009 11:39:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 11:39:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [202.86.5.91] (HELO smtp104.mail.in.yahoo.com) (202.86.5.91)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 02 Sep 2009 11:39:02 +0000
Received: (qmail 19893 invoked from network); 2 Sep 2009 11:38:40 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=Ay40Pj9K37Y+HbhK2mot4l5fxJfMDcbXGmgYTTWrdrRSkKw3Q/I7oNGWK+++TrsqixOGoOUN3vFd59IyQt/Sv62MVv7/BkFs2/xjJ1siQy9bLTXp0gEKHBRYzV3TJmLXKmp3QB/fDMYXw0eaa6oJyrz6fjzhmUdfCa2WBij2mBc=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp104.mail.in.yahoo.com with SMTP; 2 Sep 2009 11:38:39 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: XE3.JyAVM1mMyDna9WouKDR8kO6jYjjDCX3GduCfedAZkjzkenFIQoM.QPlIjr1h5BVMuMHSn5wDUT03ypoq.iFLT8jR5OPsnqkGt9IUB3F5qbfQ7oEFBMgQfxIzpVPq0WvFPDKLXd8.hPIcg4hc3lPjVzKOdmaRhescORlndFzo8cOFwKrHFHZCVIw-
X-Yahoo-Newman-Property: ymail-3
Message-ID: <004101ca2bc1$eab54070$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <003101ca2bb9$419a0f00$710bc30a@sv.us.sonicwall.com> <786fde50909020403n3f2d72d8gc35a0d7bc6d21c62@mail.gmail.com>
Subject: Re: First result in the group
Date: Wed, 2 Sep 2009 17:08:35 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

I have a field called category and all documents will have belong to =
some category( say some belong to X and some Y etc). The field values =
may change dynamically. I want the search results to be filterted to =
retrieve one document per category.=20

This is similar to 'group by' feature in database.

Regards
Ganesh
=20

----- Original Message -----=20
From: "Shai Erera" <serera@gmail.com>
To: <java-user@lucene.apache.org>
Sent: Wednesday, September 02, 2009 4:33 PM
Subject: Re: First result in the group


> What do you mean by "first result in the group"? What is a group?
>=20
> On Wed, Sep 2, 2009 at 1:36 PM, Ganesh <emailgane@yahoo.co.in> wrote:
>=20
>> Hello all,
>>
>> I want to retrieve the first result in the group. How to acheive =
this?
>> Currently i am parsing all the results, using a hash and avoiding =
duplicate
>> entries.
>>
>> Is there any better way?
>>
>> Regards
>> Ganesh
>> Send instant messages to your online friends =
http://in.messenger.yahoo.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42132-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 11:51:42 2009
Return-Path: <java-user-return-42132-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32843 invoked from network); 2 Sep 2009 11:51:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 11:51:41 -0000
Received: (qmail 7700 invoked by uid 500); 2 Sep 2009 11:51:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7627 invoked by uid 500); 2 Sep 2009 11:51:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7617 invoked by uid 99); 2 Sep 2009 11:51:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 11:51:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 11:51:29 +0000
Received: by ey-out-2122.google.com with SMTP id 4so677891eyf.5
        for <java-user@lucene.apache.org>; Wed, 02 Sep 2009 04:51:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=MwzZsROkxVB5RIbLLkj1AwCq513muJwWXNha4KZa288=;
        b=qWk2ytK/UVxDHPwYTR3mP3+XOWvzgjj6mbA2ynxadrw7zDz7DZl007NzLwxGTNQ49L
         xD7S7FmtTmjxhnLWKwvnGi0An4i30kaQ6LCmIOHP1Ha8RLJeceXm0E/nouVEF75qJpBG
         b7VCKUi2d+TLbsYYpBNHJKYZQYZA2icCSLuok=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=tXXGeRHyJccXdTzDppDVnktVV0N8DavhMvAIkQOkY/8zF0bJ5aCEas3hotMUPiO5Ag
         MPxwjZ7Hb/XiBebvgc/pEOL/7t7gSLGjSATHCAu8ynsy4NnMA1Ozy+WSqFNTCC9NxsnV
         syw3TYwVO3OiY56vEQOehZ79JbvnWoOaLHW28=
MIME-Version: 1.0
Received: by 10.216.52.204 with SMTP id e54mr131854wec.171.1251892269293; Wed, 
	02 Sep 2009 04:51:09 -0700 (PDT)
In-Reply-To: <004101ca2bc1$eab54070$710bc30a@sv.us.sonicwall.com>
References: <003101ca2bb9$419a0f00$710bc30a@sv.us.sonicwall.com>
	 <786fde50909020403n3f2d72d8gc35a0d7bc6d21c62@mail.gmail.com>
	 <004101ca2bc1$eab54070$710bc30a@sv.us.sonicwall.com>
Date: Wed, 2 Sep 2009 14:51:09 +0300
Message-ID: <786fde50909020451p3ef98563s40f94a595c059087@mail.gmail.com>
Subject: Re: First result in the group
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6dbe74c022190047296e21e
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6dbe74c022190047296e21e
Content-Type: text/plain; charset=ISO-8859-1

I see ... the solution I have in mind is not simple, but it follows the
Collector approach. Index categories as payloads of documents such that
there is one field (cats:all for example) that includes a posting list for
all documents, each has the categories it is associated w/ in its payload:
cats:all --> 0 [cat1, cat2] 1 [cat1, cat3, cat4] 4 [cat2, cat3, cat4] ...

Then when Collector.collect() is called, skip to that doc ID and read its
categories and store the ID in category maps (i.e., you'll have maps for
cat1, cat2, ... catN, each will include all doc IDs, sorted by score, which
were collected by this query).

Then you can fetch all categories whose maps/sets are not empty and display
M docs from each.

If you know in advance which categories are requested to be grouped by, for
example I want a group by on categories 1, 3, 4 and 7, you can optimize the
solution further, but I'm not sure if that's what you requested.

Also, if you can translate category Strings to integers, you can store more
efficient payloads ...

Shai

On Wed, Sep 2, 2009 at 2:38 PM, Ganesh <emailgane@yahoo.co.in> wrote:

> I have a field called category and all documents will have belong to some
> category( say some belong to X and some Y etc). The field values may change
> dynamically. I want the search results to be filterted to retrieve one
> document per category.
>
> This is similar to 'group by' feature in database.
>
> Regards
> Ganesh
>
>
> ----- Original Message -----
> From: "Shai Erera" <serera@gmail.com>
> To: <java-user@lucene.apache.org>
> Sent: Wednesday, September 02, 2009 4:33 PM
> Subject: Re: First result in the group
>
>
> > What do you mean by "first result in the group"? What is a group?
> >
> > On Wed, Sep 2, 2009 at 1:36 PM, Ganesh <emailgane@yahoo.co.in> wrote:
> >
> >> Hello all,
> >>
> >> I want to retrieve the first result in the group. How to acheive this?
> >> Currently i am parsing all the results, using a hash and avoiding
> duplicate
> >> entries.
> >>
> >> Is there any better way?
> >>
> >> Regards
> >> Ganesh
> >> Send instant messages to your online friends
> http://in.messenger.yahoo.com
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> Send instant messages to your online friends http://in.messenger.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6dbe74c022190047296e21e--

From java-user-return-42133-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 12:06:53 2009
Return-Path: <java-user-return-42133-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37031 invoked from network); 2 Sep 2009 12:06:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 12:06:53 -0000
Received: (qmail 24801 invoked by uid 500); 2 Sep 2009 12:06:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24715 invoked by uid 500); 2 Sep 2009 12:06:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24705 invoked by uid 99); 2 Sep 2009 12:06:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 12:06:50 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.82.104.176] (HELO web24703.mail.ird.yahoo.com) (212.82.104.176)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 02 Sep 2009 12:06:40 +0000
Received: (qmail 41926 invoked by uid 60001); 2 Sep 2009 12:06:19 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1251893178; bh=5Yn2k7CzIlbSR5FB/ZZqfPGuisxzBU1ddbcWNvybcbo=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=OdG/Zs40AVi/wzJ4vShgVpXDIeIR636PpNUJmcNX3B3PvR+3D313PplPZe8sWKwUnICtLtToSgR9qF/KY27iOOpOOOub+hLC0v0liV4nvzxxmiHH43du9j/fsK3jPF2u11WGADumDVnxjtOX/jPsXNh8HNtAf5eNXUF4hIE09vE=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=VzRnlFTMkTEpoje5XWKaSQ7q45g+QZrbJo/KyxMGelqZ5d/XbNtby6fUU0uiVnzdNmaRaEnjjCUcgvkPCGr8jhAXo12W9L3juiQoUgLmB9SdfHuuuU51s02oatuAnl7VRxOcYyQ2a/9XAe1i4iuy56NIgyPTq8gxgP3iNRTv41A=;
Message-ID: <907723.41487.qm@web24703.mail.ird.yahoo.com>
X-YMail-OSG: I5bSgO4VM1kvuapPdACZkqwTqtLl84VItgSTF6gXvq4YIsdTS.wDIGu.BYSIxUBpk.cOYwSXuo.fMJ6DERKlZ6WorQc.FCueuwEz4kuI_ZHKo3K1.YIPtTBMhdLDWoCj7UVzLSVxuatOVqM9ety4uQut47Jr7XtkafgV1a7w5OnMA5xCscHUto_L0ezgexpV9euGo1ue6o09N9B3yfsGBIqMZhVBRmWvLM8lUbxdThy2UCD1AY.BgJld.RrjBAfLUsDuo4Z0iO2wL8GGfBKHdeh2zl5ZG3_g0Ea3wQFRZychbmK3qd4Z7vaLP.aFcocnUnLxw7sYyQ--
Received: from [193.36.230.96] by web24703.mail.ird.yahoo.com via HTTP; Wed, 02 Sep 2009 12:06:18 GMT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <003101ca2bb9$419a0f00$710bc30a@sv.us.sonicwall.com> <786fde50909020403n3f2d72d8gc35a0d7bc6d21c62@mail.gmail.com> <004101ca2bc1$eab54070$710bc30a@sv.us.sonicwall.com>
Date: Wed, 2 Sep 2009 12:06:18 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: First result in the group
To: java-user@lucene.apache.org
In-Reply-To: <004101ca2bc1$eab54070$710bc30a@sv.us.sonicwall.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

See "DuplicateFilter" in contrib.=0A=0Ahttp://markmail.org/message/lsvnpu7m=
whht3a4p=0A=0ACheers=0AMark=0A=0A=0A=0A----- Original Message ----=0AFrom: =
Ganesh <emailgane@yahoo.co.in>=0ATo: java-user@lucene.apache.org=0ASent: We=
dnesday, 2 September, 2009 12:38:35=0ASubject: Re: First result in the grou=
p=0A=0AI have a field called category and all documents will have belong to=
 some category( say some belong to X and some Y etc). The field values may =
change dynamically. I want the search results to be filterted to retrieve o=
ne document per category. =0A=0AThis is similar to 'group by' feature in da=
tabase.=0A=0ARegards=0AGanesh=0A=0A=0A----- Original Message ----- =0AFrom:=
 "Shai Erera" <serera@gmail.com>=0ATo: <java-user@lucene.apache.org>=0ASent=
: Wednesday, September 02, 2009 4:33 PM=0ASubject: Re: First result in the =
group=0A=0A=0A> What do you mean by "first result in the group"? What is a =
group?=0A> =0A> On Wed, Sep 2, 2009 at 1:36 PM, Ganesh <emailgane@yahoo.co.=
in> wrote:=0A> =0A>> Hello all,=0A>>=0A>> I want to retrieve the first resu=
lt in the group. How to acheive this?=0A>> Currently i am parsing all the r=
esults, using a hash and avoiding duplicate=0A>> entries.=0A>>=0A>> Is ther=
e any better way?=0A>>=0A>> Regards=0A>> Ganesh=0A>> Send instant messages =
to your online friends http://in.messenger.yahoo.com=0A>>=0A>> ------------=
---------------------------------------------------------=0A>> To unsubscri=
be, e-mail: java-user-unsubscribe@lucene.apache.org=0A>> For additional com=
mands, e-mail: java-user-help@lucene.apache.org=0A>>=0A>>=0A>=0ASend instan=
t messages to your online friends http://in.messenger.yahoo.com=0A=0A------=
---------------------------------------------------------------=0ATo unsubs=
cribe, e-mail: java-user-unsubscribe@lucene.apache.org=0AFor additional com=
mands, e-mail: java-user-help@lucene.apache.org=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42134-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 12:40:46 2009
Return-Path: <java-user-return-42134-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50580 invoked from network); 2 Sep 2009 12:40:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 12:40:46 -0000
Received: (qmail 63269 invoked by uid 500); 2 Sep 2009 12:40:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63208 invoked by uid 500); 2 Sep 2009 12:40:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63198 invoked by uid 99); 2 Sep 2009 12:40:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 12:40:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [91.121.16.47] (HELO ns23917.ovh.net) (91.121.16.47)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 12:40:34 +0000
Received: (qmail 16341 invoked by uid 508); 2 Sep 2009 12:45:11 -0000
Received: from unknown (HELO spotter-dclnx) (88.182.17.109)
  by ns23917.ovh.net with AES256-SHA encrypted SMTP; 2 Sep 2009 12:45:11 -0000
Received: from techno by spotter-dclnx with local (Exim 4.69)
	(envelope-from <dcausse@spotter.com>)
	id 1Mip8A-0001z5-EI
	for java-user@lucene.apache.org; Wed, 02 Sep 2009 14:40:06 +0200
Date: Wed, 2 Sep 2009 14:40:06 +0200
From: David Causse <dcausse@spotter.com>
To: java-user@lucene.apache.org
Subject: Use of tika for parsing, offsets questions
Message-ID: <20090902124006.GA32711@spotter-dclnx>
Mail-Followup-To: David Causse <dcausse@spotter.com>,
	java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.18 (2008-05-17)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

If I use tika for parsing HTML code and inject parsed String to a lucene
analyzer. What about the offset information for KWIC and return to text
(like the google cache view)? how can I keep track of the offsets
between tika parser and lucene analyzer?

What are the solutions/ideas to do a sort of google cache view with
tika and lucene analyzer API?

With the provided API I can't keep the original content as a cache, I
need to cache the tika output and result in degraded cache view. I
didn't look too closely at tika but there is maybe a way with SAX
Locators? Build an associative array of tika parsed string offsets vs
actual offsets and use a sort of token filter to rectify
OffsetAttribute?

-- 
David Causse
Spotter
http://www.spotter.com/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42135-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 14:45:48 2009
Return-Path: <java-user-return-42135-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87471 invoked from network); 2 Sep 2009 14:45:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 14:45:48 -0000
Received: (qmail 68030 invoked by uid 500); 2 Sep 2009 14:45:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67982 invoked by uid 500); 2 Sep 2009 14:45:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67972 invoked by uid 99); 2 Sep 2009 14:45:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 14:45:45 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 14:45:33 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n82EjB8E017664
	for <java-user@lucene.apache.org>; Wed, 2 Sep 2009 15:45:11 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Wed, 02 Sep 2009 15:45:09 +0100 (BST)
Date: Wed, 2 Sep 2009 15:45:09 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <756478217.22351251902709576.JavaMail.root@mail.uk.scalix.com>
In-Reply-To: <4A9D978A.7000406@lexum.umontreal.ca>
Subject: RE: New "Stream closed" exception with Java 6
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Hi Grant,

I have now followed Daniel's advice and catch the exception with:

    try {
        indexWriter.addDocument(doc);
    } catch (CorruptIndexException ex) {
        throw new IndexerException ("CorruptIndexException on doc: " + do=
c.toString(), ex);
    } catch (IOException ex) {
        throw new IndexerException ("*IOException* on doc: " + doc.toStri=
ng(), ex);
    }

The result now appears as:

2009-09-02 10:14:24,014 ERROR [QueueManager] [BatchUpdater.processMods:18=
3] Failed to add content document(s) for user 0bb00000daaa2864-9.0.61.271=
 com.scalix.index.api.IndexerException: *IOException* on doc: Document<in=
dexed,tokenized<return-path:christian.sholtz@scalix.com> indexed,tokenize=
d<received:from scalixmail.scalix.com (localhost [127.0.0.1])
        by scalixmail.scalix.com (8.13.6/8.13.6/SuSE Linux 0.8) with ESMT=
P id m0F9545p008012;
        Tue, 15 Jan 2008 04:05:05 -0500> indexed,tokenized<received:from [=
10.13.1.51] (scalixmail.scalix.com [172.16.0.9])
    by scalixmail.scalix.com (Scalix SMTP Relay 11.3.0.11339)
    via ESMTP; Tue, 15 Jan 2008 04:05:05 -0500 (EST)> indexed<CREATE-DATE=
:20080115090228> indexed,tokenized<date:Tue Jan 15 04:02:28 EST 2008>  in=
dexed,tokenized<from:"Christian Sholtz" <christian.sholtz@scalix.com>> in=
dexed,tokenized<to:SIN - Robert Smith <Robert.Smi
th@sin.co.at>> indexed,tokenized<cc:Patrick Lauria <patrick@scalix.com>> i=
ndexed<message-id:478C76A4.2090600@scalix.com> indexed<in-reply-to:H00000=
7b0031e9f3.1200380510.scalix.sin.co.at@MHS> indexed<references:H000007b00=
31e9f3.1200380510.scalix.sin.co.at@MHS> indexed,tokenized<subject:
Re: AW: Lead Landwirtschaftskammer K=C3=A4rnten -> Smith> indexed,tokeniz=
ed<autoforwarded:FALSE> indexed,tokenized<importance:Normal> indexed,toke=
nized<priority:Normal> indexed,tokenized<sensitivity:Normal> indexed,toke=
nized<x-msmail-priority:Medium> indexed,tokenized<x-priority:3> indexed<x=
-scalix-autoreplied:FALSE> indexed,tokenized<user-agent:Thunderbird 2.0.0=
=2E9 (Windows/20071031)> indexed,tokenized<x-spam-status:No, score=3D-1.3=
 required=3D5.0 tests=3DAWL,BAYES_00,
        SUBJECT_ENCODED_TWICE autolearn=3Dno version=3D3.1.8> indexed,tok=
enized<x-spam-checker-version:SpamAssassin 3.1.8 (2007-02-13) on
        scalixmail.scalix.com> indexed,tokenized<x-mime-autoconverted:fro=
m 8bit to quoted-printable by scalixmail.scalix.com id m0F9545p00801
2> indexed,tokenized<mime-version:1.0> indexed<SIZE-KBYTES:0000000006> in=
dexed<DELIVERY-DATE:20080115090509> indexed,tokenized<x-scalix-internalda=
te:Tue Jan 15 04:05:09 EST 2008> indexed<x-scalix-has-attach:FALSE> index=
ed,tokenized<content-type:text/plain;
        charset=3D"ISO-8859-1";
        format=3D"flowed"> indexed,tokenized<content-transfer-encoding:qu=
oted-printable> indexed,tokenized<content-disposition:inline> indexed<CON=
TENT-TYPE:text/plain> indexed,tokenized<BODY:java.io.InputStreamReader@75=
b940> indexed<x-scalix-class:IPM.Note> indexed<MSG-TYPE:email> stored/unc=
ompressed,indexed<INDEXID:90010ac-4682aaad-478c7745-2ee4ab>>
        at com.scalix.index.manager.BatchUpdater.performContentAdds(Batch=
Updater.java:394)
        at com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater=
=2Ejava:179)
        at com.scalix.index.manager.QueueManager.processQueue(QueueManage=
r.java:134)
        at com.scalix.index.manager.QueueManager.run(QueueManager.java:81=
)
        at java.lang.Thread.run(Unknown Source)
Caused by: java.io.IOException: Stream closed
        at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
        at sun.nio.cs.StreamDecoder.read(Unknown Source)
        at java.io.InputStreamReader.read(Unknown Source)
        at org.apache.lucene.analysis.standard.StandardTokenizerImpl.zzRe=
fill(StandardTokenizerImpl.java:443)
        at org.apache.lucene.analysis.standard.StandardTokenizerImpl.getN=
extToken(StandardTokenizerImpl.java:629)
        at org.apache.lucene.analysis.standard.StandardTokenizer.next(Sta=
ndardTokenizer.java:140)
        at org.apache.lucene.analysis.standard.StandardFilter.next(Standa=
rdFilter.java:43)
        at org.apache.lucene.analysis.LowerCaseFilter.next(LowerCaseFilte=
r.java:34)
        at org.apache.lucene.analysis.snowball.SnowballFilter.next(Snowba=
llFilter.java:64)
        at org.apache.lucene.index.DocInverterPerField.processFields(DocI=
nverterPerField.java:134)
        at org.apache.lucene.index.DocFieldConsumersPerField.processField=
s(DocFieldConsumersPerField.java:36)
        at org.apache.lucene.index.DocFieldProcessorPerThread.processDocu=
ment(DocFieldProcessorPerThread.java:234)
        at org.apache.lucene.index.DocumentsWriter.updateDocument(Documen=
tsWriter.java:765)
        at org.apache.lucene.index.DocumentsWriter.addDocument(DocumentsW=
riter.java:743)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.ja=
va:1902)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.ja=
va:1880)
        at com.scalix.index.manager.BatchUpdater.performContentAdds(Batch=
Updater.java:390)
        ... 4 more

Does this help?

Thanks,

- Chris



----- Original Message -----
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
Sent: Tue, 1/9/2009 10:52pm
To: java-user@lucene.apache.org
Subject: Re: New "Stream closed" exception with Java 6

I think you should do this instead (it will print the exception message=20
*and* the stack trace instead of only the message) :

throw new IndexerException ("CorruptIndexException on doc: " + doc.toStri=
ng(), ex);

Daniel Shane

Chris Bamford wrote:
> Hi Grant,
> =20
>  =20
>>> I think you code there needs to show the underlying exception, too, s=
o =20
>>> we can see that stack trace.
>>>      =20
>
> Ummm... isn't this code already doing that?  What am I missing?
>
>             try {
>
>                 indexWriter.addDocument(doc);
>
>             } catch (CorruptIndexException ex) {
>
>                 throw new IndexerException ("CorruptIndexException on d=
oc: " + doc.toString() +
>
>                     " - " + ex.toString());
>
>             } catch (IOException ex) {
>
>                 throw new IndexerException ("IOException on doc: " + do=
c.toString() +
>
>                     " - " + ex.toString());
>
>             }
>
> Thanks,
>
> - Chris
>
> Chris Bamford
> Senior Development Engineer
> Scalix
> chris.bamford@scalix.com
> Tel: +44 (0)1344 381814
> www.scalix.com
>
>
>
> ----- Original Message -----
> From: Grant Ingersoll <gsingers@apache.org>
> Sent: Sat, 29/8/2009 12:00pm
> To: java-user@lucene.apache.org
> Subject: Re: New "Stream closed" exception with Java 6
>
> I think you code there needs to show the underlying exception, too, so =20
> we can see that stack trace.
>
> -Grant
>
> On Aug 28, 2009, at 11:47 AM, Chris Bamford wrote:
>
>  =20
>> Hi Grant
>>
>> Please see attached.
>>
>> Thanks,
>>
>> - Chris
>>
>>
>> ----- Original Message -----
>> From: Grant Ingersoll <gsingers@apache.org>
>> Sent: Fri, 28/8/2009 1:26pm
>> To: java-user@lucene.apache.org
>> Subject: Re: New "Stream closed" exception with Java 6
>>
>> Are there any log messages around that spot?  Did something happen to
>> the underlying Reader you are using?  Can you share that little bit of=

>> indexing code?
>>
>> On Aug 27, 2009, at 10:11 AM, Chris Bamford wrote:
>>
>>    =20
>>> Hi,
>>>
>>> Since moving our app to Java 6 and Tomcat 6, we have started getting
>>> occasional exceptions of the form:
>>>
>>> java.io.IOException: Stream closed
>>>   at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>>>   at sun.nio.cs.StreamDecoder.read(Unknown Source)
>>>   at java.io.InputStreamReader.read(Unknown Source)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .analysis
>>> .standard.StandardTokenizerImpl.zzRefill(StandardTokenizerImpl.java:
>>> 443)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .analysis
>>> .standard
>>> .StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .analysis.standard.StandardTokenizer.next(StandardTokenizer.java:140)=

>>>   at
>>> org
>>> .apache
>>> .lucene.analysis.standard.StandardFilter.next(StandardFilter.java:43)=

>>>   at
>>> org.apache.lucene.analysis.LowerCaseFilter.next(LowerCaseFilter.java:=

>>> 34)
>>>   at
>>> org
>>> .apache
>>> .lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:64)=

>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .index.DocInverterPerField.processFields(DocInverterPerField.java:=20
>>> 134)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .index
>>> .DocFieldConsumersPerField
>>> .processFields(DocFieldConsumersPerField.java:36)
>>>   at
>>> org
>>> .apache
>>> .lucene
>>> .index
>>> .DocFieldProcessorPerThread
>>> .processDocument(DocFieldProcessorPerThread.java:234)
>>>   at
>>> org
>>> .apache
>>> .lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:=20
>>> 765)
>>>   at
>>> org
>>> .apache
>>> .lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
>>>   at
>>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:=20
>>> 1902)
>>>   at
>>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:=20
>>> 1880)
>>>   at
>>> com
>>> .scalix
>>> .index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:386)=

>>>   at
>>> com.scalix.index.manager.BatchUpdater.processMods(BatchUpdater.java:
>>> 176)
>>>   at
>>> com.scalix.index.manager.QueueManager.processQueue(QueueManager.java:=

>>> 134)
>>>   at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
>>>   at java.lang.Thread.run(Unknown Source)
>>>
>>> We are using Lucene 2.4.  Any ideas what is happening?
>>>
>>> Thanks!
>>>
>>> - Chris
>>>
>>> ---------------------------------------------------------------------=

>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>      =20
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>>
>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
>> using Solr/Lucene:
>> http://www.lucidimagination.com/search
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>> <lucene_msg.txt>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>    =20
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) =20
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>  =20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42136-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 21:14:58 2009
Return-Path: <java-user-return-42136-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29425 invoked from network); 2 Sep 2009 21:14:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 21:14:58 -0000
Received: (qmail 82395 invoked by uid 500); 2 Sep 2009 21:14:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82312 invoked by uid 500); 2 Sep 2009 21:14:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82302 invoked by uid 99); 2 Sep 2009 21:14:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 21:14:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mikerthomsen@gmail.com designates 209.85.223.192 as permitted sender)
Received: from [209.85.223.192] (HELO mail-iw0-f192.google.com) (209.85.223.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 21:14:46 +0000
Received: by iwn30 with SMTP id 30so549629iwn.21
        for <java-user@lucene.apache.org>; Wed, 02 Sep 2009 14:14:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=QcMoydTFx8U6kfX4ZDL0D2G1DkwFL4xpFD+l0AN14OM=;
        b=VsPLorcCfg2bIB8W2HyPN1u7hpiXGIoh0hkkjjel5ls0JtnuwqvRLlVLIe/f7DF5BH
         yYmkfv7kxQlyFyxeDZyS8M2ZC/tb4AcMWEqAeBCoCSZr5VJCOnyMxDZMEnxFoDLXeeAq
         jww0NkmVEeRJticNsezSO71Hra81f+J1sP3iw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=FDy8IZjeCqOTNsraFxHSv0Vmhz85h3DATHRFGuLuaOjH3RCPt7V/4QbioNuHzKAWFz
         dwU6HHepb/udQ8EyEqn5JEmxLzDTfjPqV9YEDxAlc24LT+DLu90cAza8dKwInwQ/cSZI
         kr1uZFL6+ngWsG0E22V2Gn9ivV7LEqOTWpNXc=
MIME-Version: 1.0
Received: by 10.231.41.1 with SMTP id m1mr8724965ibe.49.1251926065674; Wed, 02 
	Sep 2009 14:14:25 -0700 (PDT)
Date: Wed, 2 Sep 2009 17:14:25 -0400
Message-ID: <22bb517f0909021414h3d85db85pc8be70de1bc865dd@mail.gmail.com>
Subject: Can this regex be done?
From: Michael Thomsen <mikerthomsen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Is it possible to translate this sort of Perl regex into a lucene query:

/goth(am|ic)/

Where the only results that would be returned would be gotham or gothic?

Thanks,

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42137-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 22:23:45 2009
Return-Path: <java-user-return-42137-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43704 invoked from network); 2 Sep 2009 22:23:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 22:23:45 -0000
Received: (qmail 48102 invoked by uid 500); 2 Sep 2009 22:23:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48018 invoked by uid 500); 2 Sep 2009 22:23:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48008 invoked by uid 99); 2 Sep 2009 22:23:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 22:23:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.132.249 as permitted sender)
Received: from [209.85.132.249] (HELO an-out-0708.google.com) (209.85.132.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 22:23:35 +0000
Received: by an-out-0708.google.com with SMTP id b2so475849ana.5
        for <java-user@lucene.apache.org>; Wed, 02 Sep 2009 15:23:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=KfBW8mI64qb9Y9Gf469Hg9FbXXZAyipMmDco8OaYRH8=;
        b=BcQWEGbuZIKVkR2oOcrECDQ+R+HGi7Bhd7rmbkhkPE/H+dNgWLviXTFURkP+DBP+KY
         GTgNL1eEYGpivupBDI+LCdpx8r/njZaJAaSwVmFSNG57qTP+LAchR0NbhrE7/crEHux9
         I1tcGgVFbcB1T+dMH9HBOYXuaL9x+HVP1F24w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ck8SOVWUS+8fS1p8lJTnN1NYXjQIQ8W3tWVC1Nublkij0pN5ohThHcA9Tn3yQo88ix
         vBYELoAMY8A9gdj8k0QXu2dX0up9lz+Mft/FJP1Y22N89dtARXspwnPL9phLSGHyBFPm
         U+bPDgaB9CWFh2CCipQqFqxQwXz1XL2SCROII=
MIME-Version: 1.0
Received: by 10.101.88.1 with SMTP id q1mr9829129anl.177.1251930194254; Wed, 
	02 Sep 2009 15:23:14 -0700 (PDT)
In-Reply-To: <22bb517f0909021414h3d85db85pc8be70de1bc865dd@mail.gmail.com>
References: <22bb517f0909021414h3d85db85pc8be70de1bc865dd@mail.gmail.com>
Date: Wed, 2 Sep 2009 18:23:14 -0400
Message-ID: <8f0ad1f30909021523m6d2de55cn9ed419c96db3b21e@mail.gmail.com>
Subject: Re: Can this regex be done?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Have you tried the regex package in lucene's contrib?

http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/regex/package-summary.html

there are several implementations, I am not sure if one really exactly
"perl compatible", but for your example I think it will do the trick.

On Wed, Sep 2, 2009 at 5:14 PM, Michael Thomsen<mikerthomsen@gmail.com> wrote:
> Is it possible to translate this sort of Perl regex into a lucene query:
>
> /goth(am|ic)/
>
> Where the only results that would be returned would be gotham or gothic?
>
> Thanks,
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42138-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 22:42:53 2009
Return-Path: <java-user-return-42138-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48344 invoked from network); 2 Sep 2009 22:42:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 22:42:53 -0000
Received: (qmail 65927 invoked by uid 500); 2 Sep 2009 22:42:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65876 invoked by uid 500); 2 Sep 2009 22:42:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65866 invoked by uid 99); 2 Sep 2009 22:42:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 22:42:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lafadev@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 22:42:41 +0000
Received: by ewy22 with SMTP id 22so1200844ewy.28
        for <java-user@lucene.apache.org>; Wed, 02 Sep 2009 15:42:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=n+mhYmwpqai6eM7rl6Qn605UbiO4XTU8RG55Gtob8T0=;
        b=Og1KT2gwsyaFYxB96AoOXt528OTdWwBYW+y2vbQgxzKnflEcSdvT2B5iTEf0GscQaC
         H0i/7UKYAux+MpccN0MdqQgU+LOWgJTCg8WckOlEkpKWq62eotQ0SETvEHkOBxQL0AlX
         hP7QNwgziPzE8kmONpsG1Zd4EFoJaNqsmWGII=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=VAGAmkx2J5iBerV1i3O4NZYSmbE35y1GDJb5P3BKP95JhObngyuaBC1T0XbwpUY2/N
         gxD75X2HPxIeVdlae4rclMOVRY/j059+9WbKNwrb9Mfpb7XiBldvQi2KtbXlJye8KkpN
         at/rFHibNv64M2MXADSZXfksXtnmFzmXzHe/c=
Received: by 10.216.88.14 with SMTP id z14mr301847wee.25.1251931340024;
        Wed, 02 Sep 2009 15:42:20 -0700 (PDT)
Received: from ?9.30.38.143? ([32.97.110.56])
        by mx.google.com with ESMTPS id m5sm1321445gve.18.2009.09.02.15.42.18
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 02 Sep 2009 15:42:19 -0700 (PDT)
Message-ID: <4A9EF4C7.30307@gmail.com>
Date: Wed, 02 Sep 2009 15:42:15 -0700
From: Luis Alves <lafadev@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Can this regex be done?
References: <22bb517f0909021414h3d85db85pc8be70de1bc865dd@mail.gmail.com>
In-Reply-To: <22bb517f0909021414h3d85db85pc8be70de1bc865dd@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Why can't you use a OR? gotham OR gothic
> Is it possible to translate this sort of Perl regex into a lucene query:
>
> /goth(am|ic)/
>
> Where the only results that would be returned would be gotham or gothic?
>
> Thanks,
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   


-- 
-Lafa



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42139-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 02 23:53:28 2009
Return-Path: <java-user-return-42139-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66045 invoked from network); 2 Sep 2009 23:53:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Sep 2009 23:53:28 -0000
Received: (qmail 38656 invoked by uid 500); 2 Sep 2009 23:53:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38570 invoked by uid 500); 2 Sep 2009 23:53:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38560 invoked by uid 99); 2 Sep 2009 23:53:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 23:53:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mikerthomsen@gmail.com designates 209.85.223.192 as permitted sender)
Received: from [209.85.223.192] (HELO mail-iw0-f192.google.com) (209.85.223.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Sep 2009 23:53:16 +0000
Received: by iwn30 with SMTP id 30so594585iwn.21
        for <java-user@lucene.apache.org>; Wed, 02 Sep 2009 16:52:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=eH9DbRypoJeH0KWvD8TGB6vujBDjKKwq9uBapwVC/w8=;
        b=w54OwXO2WdoaNBKlaUtUYugD08Rv0AsQvY160zn4j7enesudT/ncJQr+DYEF9lQ31R
         AzTSOahQ8Gf5IekiIzGAwazlIdc/i6r0yiJ7L/8RcJlNKgiCaVz3KJjtA6Wocw9eGK7E
         8ihqQXHxkUy/yLNs0CrKqcytuuiuU7nkrMBxw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ptP3P01R2C+yKbVEOTRV2LGt9YnkvC5H9iJG85a+Q1jXGS2AT7OT5QVSFppHtFgO3/
         LbgTKThBAbkqGG/YofdacXp5Ubr2dJKcjMfKHv9KoBfsZvMfZPrSHoXsVI1lk/HOK4ig
         nMHy96Fsdzca6qoBdfPvMWY3eFIg73RIZaQqI=
MIME-Version: 1.0
Received: by 10.231.24.208 with SMTP id w16mr8810109ibb.38.1251935575367; Wed, 
	02 Sep 2009 16:52:55 -0700 (PDT)
In-Reply-To: <4A9EF4C7.30307@gmail.com>
References: <22bb517f0909021414h3d85db85pc8be70de1bc865dd@mail.gmail.com>
	 <4A9EF4C7.30307@gmail.com>
Date: Wed, 2 Sep 2009 19:52:55 -0400
Message-ID: <22bb517f0909021652w69b0a241o9dd2c676d8aa5817@mail.gmail.com>
Subject: Re: Can this regex be done?
From: Michael Thomsen <mikerthomsen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Because some of the queries that I have to convert (without modifying
them, unfortunately) have a half literally a page of statements
expressed like that that, if expanded, would equal a several page long
lucene query.

On Wed, Sep 2, 2009 at 6:42 PM, Luis Alves<lafadev@gmail.com> wrote:
> Why can't you use a OR? gotham OR gothic
>>
>> Is it possible to translate this sort of Perl regex into a lucene query:
>>
>> /goth(am|ic)/
>>
>> Where the only results that would be returned would be gotham or gothic?
>>
>> Thanks,
>>
>> Mike
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
>
> --
> -Lafa
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42140-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 13:08:10 2009
Return-Path: <java-user-return-42140-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81273 invoked from network); 3 Sep 2009 13:08:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 13:08:10 -0000
Received: (qmail 65497 invoked by uid 500); 3 Sep 2009 13:08:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65404 invoked by uid 500); 3 Sep 2009 13:08:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65394 invoked by uid 99); 3 Sep 2009 13:08:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 13:08:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jukka.zitting@gmail.com designates 209.85.132.250 as permitted sender)
Received: from [209.85.132.250] (HELO an-out-0708.google.com) (209.85.132.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 13:07:59 +0000
Received: by an-out-0708.google.com with SMTP id b2so650211ana.5
        for <java-user@lucene.apache.org>; Thu, 03 Sep 2009 06:07:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=vtPpVeKmJ76zWh3WHgvZ6dzZ/TnMPWink/i6X/Drx78=;
        b=jimgKEbE9JMWbpNpRY/BQkeKkG2cWVU3S9kNyGc+jXrTlbuXHrG+AdKfonRyaqeQIG
         Ul7anlBR5ylaWa2i0GRMbP6p95nrHuiVwxERx0tTEn44zdDONLcnWO54168WrIvT0kRJ
         uM+Ltk2J3jIxuvJ2Rt6g7Azvnyx+TUmq7MkzU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=Car9pE0obu+R2gGEMfK90UJgH+c5K1Ro1jxTcHz/aSMbKSxpgXeHW0q22s3VA7CsDE
         z8PNxa6w4qaj3cYrhIGpxbUsz1k+6W/dvNHYfz83l1cDZyPkr+jNKtLvzVL5ImU0JFaE
         NJmQVif5QqO7VWGFmZJFx5f1Kezbc7aowOA1o=
MIME-Version: 1.0
Received: by 10.100.76.3 with SMTP id y3mr10716686ana.76.1251983258128; Thu, 
	03 Sep 2009 06:07:38 -0700 (PDT)
In-Reply-To: <20090902124006.GA32711@spotter-dclnx>
References: <20090902124006.GA32711@spotter-dclnx>
From: Jukka Zitting <jukka.zitting@gmail.com>
Date: Thu, 3 Sep 2009 15:07:18 +0200
Message-ID: <510143ac0909030607o510f6d0ftef81357fad1ff25a@mail.gmail.com>
Subject: Re: Use of tika for parsing, offsets questions
To: java-user@lucene.apache.org, David Causse <dcausse@spotter.com>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Wed, Sep 2, 2009 at 2:40 PM, David Causse<dcausse@spotter.com> wrote:
> If I use tika for parsing HTML code and inject parsed String to a lucene
> analyzer. What about the offset information for KWIC and return to text
> (like the google cache view)? how can I keep track of the offsets
> between tika parser and lucene analyzer?

Currently Tika doesn't expose that information but the Tika Parser API
was designed for such use in mind, so it will be possible to add the
offset information. Please file a Tika feature request [1] for this.

[1] https://issues.apache.org/jira/browse/TIKA

BR,

Jukka Zitting

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42141-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 13:27:45 2009
Return-Path: <java-user-return-42141-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87772 invoked from network); 3 Sep 2009 13:27:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 13:27:45 -0000
Received: (qmail 8058 invoked by uid 500); 3 Sep 2009 13:27:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8009 invoked by uid 500); 3 Sep 2009 13:27:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7999 invoked by uid 99); 3 Sep 2009 13:27:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 13:27:42 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 13:27:31 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 26AB1D36007
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 15:27:11 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Ydxyqe9UMEIo for <java-user@lucene.apache.org>;
	Thu,  3 Sep 2009 15:27:01 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.75])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id EEACED36003
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 15:27:00 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <20090902124006.GA32711@spotter-dclnx> <510143ac0909030607o510f6d0ftef81357fad1ff25a@mail.gmail.com>
Subject: RE: Use of tika for parsing, offsets questions
Date: Thu, 3 Sep 2009 15:26:59 +0200
Message-ID: <DC6331DB2ED14ACA861205D63446A444@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <510143ac0909030607o510f6d0ftef81357fad1ff25a@mail.gmail.com>
Thread-Index: Acosl5qqB5UFsShPQ0WELUDTD/+lDgAAfgkQ
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

An additional good solution for Lucene (from 2.9 on), would be to create a
special TIKA analyzer that can be used to directly add TIKA-parseable
content and metadata to the Tokenstream as Attributes (using the new API) or
only text and offset data (old Lucene TokenStream API).

I wrote something similar for XML files that added the current XML element
path as an additional Token Attribute. It also set the SAX parsers current
position as offset. This attribute could then later be used to construct
additional indexing setting (in our case the field name to index into).

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Jukka Zitting [mailto:jukka.zitting@gmail.com]
> Sent: Thursday, September 03, 2009 3:07 PM
> To: java-user@lucene.apache.org; David Causse
> Subject: Re: Use of tika for parsing, offsets questions
> 
> Hi,
> 
> On Wed, Sep 2, 2009 at 2:40 PM, David Causse<dcausse@spotter.com> wrote:
> > If I use tika for parsing HTML code and inject parsed String to a lucene
> > analyzer. What about the offset information for KWIC and return to text
> > (like the google cache view)? how can I keep track of the offsets
> > between tika parser and lucene analyzer?
> 
> Currently Tika doesn't expose that information but the Tika Parser API
> was designed for such use in mind, so it will be possible to add the
> offset information. Please file a Tika feature request [1] for this.
> 
> [1] https://issues.apache.org/jira/browse/TIKA
> 
> BR,
> 
> Jukka Zitting
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42142-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 13:52:01 2009
Return-Path: <java-user-return-42142-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98337 invoked from network); 3 Sep 2009 13:52:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 13:52:01 -0000
Received: (qmail 65014 invoked by uid 500); 3 Sep 2009 13:51:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64960 invoked by uid 500); 3 Sep 2009 13:51:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64950 invoked by uid 99); 3 Sep 2009 13:51:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 13:51:59 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a18.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 13:51:49 +0000
Received: from [10.0.1.2] (72-254-9-136.client.stsn.net [72.254.9.136])
	by spunkymail-a18.g.dreamhost.com (Postfix) with ESMTP id C07AF5B52C
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 06:51:28 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1075.2)
Subject: Re: Use of tika for parsing, offsets questions
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <20090902124006.GA32711@spotter-dclnx>
Date: Thu, 3 Sep 2009 06:51:28 -0700
Content-Transfer-Encoding: 7bit
Message-Id: <514A548B-E475-414D-9404-0CF6C8101DB1@apache.org>
References: <20090902124006.GA32711@spotter-dclnx>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1075.2)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 2, 2009, at 5:40 AM, David Causse wrote:

> Hi,
>
> If I use tika for parsing HTML code and inject parsed String to a  
> lucene
> analyzer. What about the offset information for KWIC and return to  
> text
> (like the google cache view)? how can I keep track of the offsets
> between tika parser and lucene analyzer?
>
> What are the solutions/ideas to do a sort of google cache view with
> tika and lucene analyzer API?
>
> With the provided API I can't keep the original content as a cache, I
> need to cache the tika output and result in degraded cache view. I
> didn't look too closely at tika but there is maybe a way with SAX
> Locators? Build an associative array of tika parsed string offsets vs
> actual offsets and use a sort of token filter to rectify
> OffsetAttribute?
>

Hmm, maybe you could implement the ContentHandler for Tika that  
instead of creating a string for the Document, creates a TokenStream.   
Then, you can have it add the offsets as payloads so that you then  
have those offsets later when rendering your view.


> -- 
> David Causse
> Spotter
> http://www.spotter.com/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42143-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 14:00:09 2009
Return-Path: <java-user-return-42143-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1180 invoked from network); 3 Sep 2009 14:00:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 14:00:09 -0000
Received: (qmail 86160 invoked by uid 500); 3 Sep 2009 14:00:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86107 invoked by uid 500); 3 Sep 2009 14:00:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86093 invoked by uid 99); 3 Sep 2009 14:00:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 14:00:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a3.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 13:59:56 +0000
Received: from [10.0.1.2] (72-254-9-136.client.stsn.net [72.254.9.136])
	by spunkymail-a3.g.dreamhost.com (Postfix) with ESMTP id EB3B415D48B
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 06:59:35 -0700 (PDT)
Content-Type: text/plain; charset=iso-8859-1; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1075.2)
Subject: Re: New "Stream closed" exception with Java 6
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <756478217.22351251902709576.JavaMail.root@mail.uk.scalix.com>
Date: Thu, 3 Sep 2009 06:59:35 -0700
Content-Transfer-Encoding: quoted-printable
Message-Id: <A78DC107-68AA-4737-8E41-F558D3538CB3@apache.org>
References: <756478217.22351251902709576.JavaMail.root@mail.uk.scalix.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1075.2)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 2, 2009, at 7:45 AM, Chris Bamford wrote:

> Hi Grant,
>
> I have now followed Daniel's advice and catch the exception with:
>
>    try {
>        indexWriter.addDocument(doc);

What does your Document/Field creation code look like?  In other =20
words, how do you construct doc?  Seems like something is closing your =20=

InputStreamReader out from under you.  Is there a concurrency issue, =20
perhaps?


>    } catch (CorruptIndexException ex) {
>        throw new IndexerException ("CorruptIndexException on doc: " =20=

> + doc.toString(), ex);
>    } catch (IOException ex) {
>        throw new IndexerException ("*IOException* on doc: " + =20
> doc.toString(), ex);
>    }
>
> The result now appears as:
>
> 2009-09-02 10:14:24,014 ERROR [QueueManager] =20
> [BatchUpdater.processMods:183] Failed to add content document(s) for =20=

> user 0bb00000daaa2864-9.0.61.271 =20
> com.scalix.index.api.IndexerException: *IOException* on doc: =20
> Document<indexed,tokenized<return-path:christian.sholtz@scalix.com> =20=

> indexed,tokenized<received:from scalixmail.scalix.com (localhost =20
> [127.0.0.1])
>        by scalixmail.scalix.com (8.13.6/8.13.6/SuSE Linux 0.8) with =20=

> ESMTP id m0F9545p008012;
>        Tue, 15 Jan 2008 04:05:05 -0500> =20
> indexed,tokenized<received:from [10.13.1.51] (scalixmail.scalix.com =20=

> [172.16.0.9])
>    by scalixmail.scalix.com (Scalix SMTP Relay 11.3.0.11339)
>    via ESMTP; Tue, 15 Jan 2008 04:05:05 -0500 (EST)> indexed<CREATE-=20=

> DATE:20080115090228> indexed,tokenized<date:Tue Jan 15 04:02:28 EST =20=

> 2008>  indexed,tokenized<from:"Christian Sholtz" =
<christian.sholtz@scalix.com=20
> >> indexed,tokenized<to:SIN - Robert Smith <Robert.Smi
> th@sin.co.at>> indexed,tokenized<cc:Patrick Lauria =20
> <patrick@scalix.com>> indexed<message-id:=20
> 478C76A4.2090600@scalix.com> indexed<in-reply-=20
> to:H000007b0031e9f3.1200380510.scalix.sin.co.at@MHS> =20
> indexed<references:H000007b0031e9f3.1200380510.scalix.sin.co.at@MHS> =20=

> indexed,tokenized<subject:
> Re: AW: Lead Landwirtschaftskammer K=C3=A4rnten -> Smith> =20
> indexed,tokenized<autoforwarded:FALSE> =20
> indexed,tokenized<importance:Normal> =20
> indexed,tokenized<priority:Normal> =20
> indexed,tokenized<sensitivity:Normal> indexed,tokenized<x-msmail-=20
> priority:Medium> indexed,tokenized<x-priority:3> indexed<x-scalix-=20
> autoreplied:FALSE> indexed,tokenized<user-agent:Thunderbird 2.0.0.9 =20=

> (Windows/20071031)> indexed,tokenized<x-spam-status:No, score=3D-1.3 =20=

> required=3D5.0 tests=3DAWL,BAYES_00,
>        SUBJECT_ENCODED_TWICE autolearn=3Dno version=3D3.1.8> =20
> indexed,tokenized<x-spam-checker-version:SpamAssassin 3.1.8 =20
> (2007-02-13) on
>        scalixmail.scalix.com> indexed,tokenized<x-mime-=20
> autoconverted:from 8bit to quoted-printable by scalixmail.scalix.com =20=

> id m0F9545p00801
> 2> indexed,tokenized<mime-version:1.0> indexed<SIZE-KBYTES:=20
> 0000000006> indexed<DELIVERY-DATE:20080115090509> =20
> indexed,tokenized<x-scalix-internaldate:Tue Jan 15 04:05:09 EST =20
> 2008> indexed<x-scalix-has-attach:FALSE> indexed,tokenized<content-=20
> type:text/plain;
>        charset=3D"ISO-8859-1";
>        format=3D"flowed"> indexed,tokenized<content-transfer-=20
> encoding:quoted-printable> indexed,tokenized<content-=20
> disposition:inline> indexed<CONTENT-TYPE:text/plain> =20
> indexed,tokenized<BODY:java.io.InputStreamReader@75b940> indexed<x-=20
> scalix-class:IPM.Note> indexed<MSG-TYPE:email> stored/=20
> uncompressed,indexed<INDEXID:90010ac-4682aaad-478c7745-2ee4ab>>
>        at com.scalix.index.manager.BatchUpdater.performContentAdds=20
> (BatchUpdater.java:394)
>        at com.scalix.index.manager.BatchUpdater.processMods=20
> (BatchUpdater.java:179)
>        at com.scalix.index.manager.QueueManager.processQueue=20
> (QueueManager.java:134)
>        at com.scalix.index.manager.QueueManager.run=20
> (QueueManager.java:81)
>        at java.lang.Thread.run(Unknown Source)
> Caused by: java.io.IOException: Stream closed
>        at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>        at sun.nio.cs.StreamDecoder.read(Unknown Source)
>        at java.io.InputStreamReader.read(Unknown Source)
>        at =20
> org.apache.lucene.analysis.standard.StandardTokenizerImpl.zzRefill=20
> (StandardTokenizerImpl.java:443)
>        at =20
> org.apache.lucene.analysis.standard.StandardTokenizerImpl.getNextToken=20=

> (StandardTokenizerImpl.java:629)
>        at org.apache.lucene.analysis.standard.StandardTokenizer.next=20=

> (StandardTokenizer.java:140)
>        at org.apache.lucene.analysis.standard.StandardFilter.next=20
> (StandardFilter.java:43)
>        at org.apache.lucene.analysis.LowerCaseFilter.next=20
> (LowerCaseFilter.java:34)
>        at org.apache.lucene.analysis.snowball.SnowballFilter.next=20
> (SnowballFilter.java:64)
>        at org.apache.lucene.index.DocInverterPerField.processFields=20
> (DocInverterPerField.java:134)
>        at =20
> org.apache.lucene.index.DocFieldConsumersPerField.processFields=20
> (DocFieldConsumersPerField.java:36)
>        at =20
> org.apache.lucene.index.DocFieldProcessorPerThread.processDocument=20
> (DocFieldProcessorPerThread.java:234)
>        at org.apache.lucene.index.DocumentsWriter.updateDocument=20
> (DocumentsWriter.java:765)
>        at org.apache.lucene.index.DocumentsWriter.addDocument=20
> (DocumentsWriter.java:743)
>        at org.apache.lucene.index.IndexWriter.addDocument=20
> (IndexWriter.java:1902)
>        at org.apache.lucene.index.IndexWriter.addDocument=20
> (IndexWriter.java:1880)
>        at com.scalix.index.manager.BatchUpdater.performContentAdds=20
> (BatchUpdater.java:390)
>        ... 4 more
>
> Does this help?
>
> Thanks,
>
> - Chris
>
>
>
> ----- Original Message -----
> From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
> Sent: Tue, 1/9/2009 10:52pm
> To: java-user@lucene.apache.org
> Subject: Re: New "Stream closed" exception with Java 6
>
> I think you should do this instead (it will print the exception =20
> message
> *and* the stack trace instead of only the message) :
>
> throw new IndexerException ("CorruptIndexException on doc: " + =20
> doc.toString(), ex);
>
> Daniel Shane
>
> Chris Bamford wrote:
>> Hi Grant,
>>
>>
>>>> I think you code there needs to show the underlying exception, =20
>>>> too, so
>>>> we can see that stack trace.
>>>>
>>
>> Ummm... isn't this code already doing that?  What am I missing?
>>
>>            try {
>>
>>                indexWriter.addDocument(doc);
>>
>>            } catch (CorruptIndexException ex) {
>>
>>                throw new IndexerException ("CorruptIndexException =20
>> on doc: " + doc.toString() +
>>
>>                    " - " + ex.toString());
>>
>>            } catch (IOException ex) {
>>
>>                throw new IndexerException ("IOException on doc: " + =20=

>> doc.toString() +
>>
>>                    " - " + ex.toString());
>>
>>            }
>>
>> Thanks,
>>
>> - Chris
>>
>> Chris Bamford
>> Senior Development Engineer
>> Scalix
>> chris.bamford@scalix.com
>> Tel: +44 (0)1344 381814
>> www.scalix.com
>>
>>
>>
>> ----- Original Message -----
>> From: Grant Ingersoll <gsingers@apache.org>
>> Sent: Sat, 29/8/2009 12:00pm
>> To: java-user@lucene.apache.org
>> Subject: Re: New "Stream closed" exception with Java 6
>>
>> I think you code there needs to show the underlying exception, too, =20=

>> so
>> we can see that stack trace.
>>
>> -Grant
>>
>> On Aug 28, 2009, at 11:47 AM, Chris Bamford wrote:
>>
>>
>>> Hi Grant
>>>
>>> Please see attached.
>>>
>>> Thanks,
>>>
>>> - Chris
>>>
>>>
>>> ----- Original Message -----
>>> From: Grant Ingersoll <gsingers@apache.org>
>>> Sent: Fri, 28/8/2009 1:26pm
>>> To: java-user@lucene.apache.org
>>> Subject: Re: New "Stream closed" exception with Java 6
>>>
>>> Are there any log messages around that spot?  Did something happen =20=

>>> to
>>> the underlying Reader you are using?  Can you share that little =20
>>> bit of
>>> indexing code?
>>>
>>> On Aug 27, 2009, at 10:11 AM, Chris Bamford wrote:
>>>
>>>
>>>> Hi,
>>>>
>>>> Since moving our app to Java 6 and Tomcat 6, we have started =20
>>>> getting
>>>> occasional exceptions of the form:
>>>>
>>>> java.io.IOException: Stream closed
>>>>  at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>>>>  at sun.nio.cs.StreamDecoder.read(Unknown Source)
>>>>  at java.io.InputStreamReader.read(Unknown Source)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .analysis
>>>> .standard.StandardTokenizerImpl.zzRefill=20
>>>> (StandardTokenizerImpl.java:
>>>> 443)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .analysis
>>>> .standard
>>>> .StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .analysis.standard.StandardTokenizer.next(StandardTokenizer.java:=20=

>>>> 140)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene.analysis.standard.StandardFilter.next(StandardFilter.java:=20=

>>>> 43)
>>>>  at
>>>> org.apache.lucene.analysis.LowerCaseFilter.next=20
>>>> (LowerCaseFilter.java:
>>>> 34)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:=20=

>>>> 64)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .index.DocInverterPerField.processFields(DocInverterPerField.java:
>>>> 134)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .index
>>>> .DocFieldConsumersPerField
>>>> .processFields(DocFieldConsumersPerField.java:36)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .index
>>>> .DocFieldProcessorPerThread
>>>> .processDocument(DocFieldProcessorPerThread.java:234)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:
>>>> 765)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
>>>>  at
>>>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:
>>>> 1902)
>>>>  at
>>>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:
>>>> 1880)
>>>>  at
>>>> com
>>>> .scalix
>>>> .index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:=20=

>>>> 386)
>>>>  at
>>>> com.scalix.index.manager.BatchUpdater.processMods=20
>>>> (BatchUpdater.java:
>>>> 176)
>>>>  at
>>>> com.scalix.index.manager.QueueManager.processQueue=20
>>>> (QueueManager.java:
>>>> 134)
>>>>  at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
>>>>  at java.lang.Thread.run(Unknown Source)
>>>>
>>>> We are using Lucene 2.4.  Any ideas what is happening?
>>>>
>>>> Thanks!
>>>>
>>>> - Chris
>>>>
>>>> =
---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>> --------------------------
>>> Grant Ingersoll
>>> http://www.lucidimagination.com/
>>>
>>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
>>> using Solr/Lucene:
>>> http://www.lucidimagination.com/search
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>> <lucene_msg.txt>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>>
>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
>> using Solr/Lucene:
>> http://www.lucidimagination.com/search
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) =20
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42144-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 15:55:54 2009
Return-Path: <java-user-return-42144-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38639 invoked from network); 3 Sep 2009 15:55:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 15:55:54 -0000
Received: (qmail 69458 invoked by uid 500); 3 Sep 2009 15:55:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69385 invoked by uid 500); 3 Sep 2009 15:55:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69362 invoked by uid 99); 3 Sep 2009 15:55:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 15:55:51 +0000
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=HTML_FONT_FACE_BAD,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 15:55:40 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n83FtD9m002073
	for <java-user@lucene.apache.org>; Thu, 3 Sep 2009 11:55:13 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Thu, 03 Sep 2009 11:55:13 -0400
  id 00027341.4A9FE6E1.000002FC
Message-ID: <4A9FE6E1.1060108@lexum.umontreal.ca>
Date: Thu, 03 Sep 2009 11:55:13 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken
 / AttributeSource), cannot implement a LookaheadTokenFilter.
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca> <4A9D9C48.7040703@lexum.umontreal.ca> <4A9DB1C4.3000001@gmail.com> <4A9DB3EA.7000800@gmail.com> <A95513C77FA44482B345BA468895E341@VEGA>
In-Reply-To: <A95513C77FA44482B345BA468895E341@VEGA>
Content-Type: multipart/alternative;
 boundary="------------050909080305030201030205"
X-NAI-Spam-Level: *
X-NAI-Spam-Score: 1
X-NAI-Spam-Rules: 2 Rules triggered
	TB_BNDRY_PTRN=1, RV3355=0
X-Virus-Checked: Checked by ClamAV on apache.org

--------------050909080305030201030205
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Uwe Schindler wrote:
> There may be a problem that you may not want to restore the peek token into
> the TokenFilter's attributes itsself. It looks like you want to have a Token
> instance returned from peek, but the current Stream should not reset to this
> Token (you only want to "look" into the next Token and then possibly do
> something special with the current Token). To achive this, there is a method
> cloneAttributes() in TokenStream, that creates a new AttributeSource with
> same attribute types, which is independent from the cloned one. You can then
> use clone.getAttribute(TermAttribute.class).term() or similar to look into
> the next token. But creating this new clone is costy, so you may also create
> it once and reuse. In the peek method, you simply copy the state of this to
> the cloned attributesource.
>
> It's a bit complicated but should work somehow. Tell me if you need more
> help. Maybe you should provide us with some code, what you want to do with
> the TokenFilter.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>
>   
Humm... I looked at captureState() and restoreState() and it doesnt seem 
like it would work in my scenario.

I'd like the LookAheadFilter to be able to peek() several tokens forward 
and they can have different attributes, so I don't think I should assume 
I can restoreState() safely.

Here is an application for the filter, lets say I want to recognize 
abbreviations (like S.C.R.) at the token level. I'd need to be able to 
peek() a few tokens forward to make sure S.C.R. is an abbreviation and 
not simply the end of a sentence.

So the user should be able to peek() a number of token forward before 
returning to usual behavior.

Here is the implementation I had in mind (untested yet because of a 
StackOverflow) :

public class LookaheadTokenFilter extends TokenFilter {
    /** List of tokens that were peeked but not returned with next. */
    LinkedList<AttributeSource> peekedTokens = new 
LinkedList<AttributeSource>();

    /** The position of the next character that peek() will return in 
peekedTokens */
    int peekPosition = 0;

    public LookaheadTokenFilter(TokenStream input) {
        super(input);
    }
 
    public boolean peekIncrementToken() throws IOException {
        if (this.peekPosition >= this.peekedTokens.size()) {
            if (this.input.incrementToken() == false) {
                return false;
            }
           
            this.peekedTokens.add(cloneAttributes());           
            this.peekPosition = this.peekedTokens.size();
            return true;
        }
        
        this.peekPosition++;       
        return true;
    }
   
    @Override
    public boolean incrementToken() throws IOException {
        reset();
       
        if (this.peekedTokens.isEmpty() == false) {
            this.peekedTokens.removeFirst();
        }
       
        if (this.peekedTokens.isEmpty() == false) {
            return true;
        }
       
        return super.incrementToken();
    }
       
    @Override
    public void reset() {
        this.peekPosition = 0;
    }   
   

    //Overloaded methods...
   
    public Attribute getAttribute(Class attClass) {
        if (this.peekedTokens.size() > 0) {
            return 
this.peekedTokens.get(this.peekPosition).getAttribute(attClass);
        }       
        return super.getAttribute(attClass);
    }
   
    //Overload all these just like getAttribute() ...
    public Iterator<?> getAttributeClassesIterator() ...
    public AttributeFactory getAttributeFactory() ...
    public Iterator getAttributeImplsIterator() ...
    public Attribute addAttribute(Class attClass) ...
    public void addAttributeImpl(AttributeImpl att) ...
    public State captureState() ...
    public void clearAttributes() ...
    public AttributeSource cloneAttributes() ...
    public boolean hasAttribute(Class attClass) ...
    public boolean hasAttributes() ...
    public void restoreState(State state) ...                     
}


Now the problem I have is that the below code triggers an evil 
StackOverflow because I'm overriding incrementToken() and calling 
super.incrementToken() which will loop back because of this :

public boolean incrementToken() throws IOException {
    assert tokenWrapper != null;
   
    final Token token;
    if (supportedMethods.hasReusableNext) {
      token = next(tokenWrapper.delegate);
    } else {
      assert supportedMethods.hasNext;
      token = next(); <----- Lucene calls next();
    }
    if (token == null) return false;
    tokenWrapper.delegate = token;
    return true;
  }

which then calls :

public Token next() throws IOException {
    if (tokenWrapper == null)
      throw new UnsupportedOperationException("This TokenStream only 
supports the new Attributes API.");
   
    if (supportedMethods.hasIncrementToken) {
      return incrementToken() ? ((Token) tokenWrapper.delegate.clone()) 
: null; <--- incrementToken() gets called
    } else {
      assert supportedMethods.hasReusableNext;
      final Token token = next(tokenWrapper.delegate);
      if (token == null) return null;
      tokenWrapper.delegate = token;
      return (Token) token.clone();
    }
  }

and hasIncrementToken is true because I overloaded incrementToken();

 MethodSupport(Class clazz) {
    hasIncrementToken = isMethodOverridden(clazz, "incrementToken", 
METHOD_NO_PARAMS);
    hasReusableNext = isMethodOverridden(clazz, "next", METHOD_TOKEN_PARAM);
    hasNext = isMethodOverridden(clazz, "next", METHOD_NO_PARAMS);
}

Seems like a "catch-22". From what I understand, if I override 
incrementToken() I should not call super.incrementToken()????

Daniel S.

--------------050909080305030201030205--

From java-user-return-42145-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 16:02:05 2009
Return-Path: <java-user-return-42145-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41359 invoked from network); 3 Sep 2009 16:02:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 16:02:05 -0000
Received: (qmail 88401 invoked by uid 500); 3 Sep 2009 16:02:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88376 invoked by uid 500); 3 Sep 2009 16:02:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88366 invoked by uid 99); 3 Sep 2009 16:02:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 16:02:01 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [132.204.246.22] (HELO pruche.dit.umontreal.ca) (132.204.246.22)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 16:01:52 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by pruche.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n83G1TYP002166
	for <java-user@lucene.apache.org>; Thu, 3 Sep 2009 12:01:29 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Thu, 03 Sep 2009 12:01:29 -0400
  id 00027341.4A9FE859.00000635
Message-ID: <4A9FE859.40404@lexum.umontreal.ca>
Date: Thu, 03 Sep 2009 12:01:29 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken
 / AttributeSource), cannot implement a LookaheadTokenFilter.
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca> <4A9D9C48.7040703@lexum.umontreal.ca> <4A9DB1C4.3000001@gmail.com> <4A9DB3EA.7000800@gmail.com> <A95513C77FA44482B345BA468895E341@VEGA> <4A9FE6E1.1060108@lexum.umontreal.ca>
In-Reply-To: <4A9FE6E1.1060108@lexum.umontreal.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3355=0
X-Virus-Checked: Checked by ClamAV on apache.org

Ok, I got it, from checking other filters, I should call 
input.incrementToken() instead of super.incrementToken().

Do you feel this kind of breaks the object model (super.incrementToken() 
should also work).

Maybe when the old API is gone, we can stop checking if someone has 
overloaded next() or incrementToken()?

Daniel S.

> Humm... I looked at captureState() and restoreState() and it doesnt 
> seem like it would work in my scenario.
>
> I'd like the LookAheadFilter to be able to peek() several tokens 
> forward and they can have different attributes, so I don't think I 
> should assume I can restoreState() safely.
>
> Here is an application for the filter, lets say I want to recognize 
> abbreviations (like S.C.R.) at the token level. I'd need to be able to 
> peek() a few tokens forward to make sure S.C.R. is an abbreviation and 
> not simply the end of a sentence.
>
> So the user should be able to peek() a number of token forward before 
> returning to usual behavior.
>
> Here is the implementation I had in mind (untested yet because of a 
> StackOverflow) :
>
> public class LookaheadTokenFilter extends TokenFilter {
>    /** List of tokens that were peeked but not returned with next. */
>    LinkedList<AttributeSource> peekedTokens = new 
> LinkedList<AttributeSource>();
>
>    /** The position of the next character that peek() will return in 
> peekedTokens */
>    int peekPosition = 0;
>
>    public LookaheadTokenFilter(TokenStream input) {
>        super(input);
>    }
>
>    public boolean peekIncrementToken() throws IOException {
>        if (this.peekPosition >= this.peekedTokens.size()) {
>            if (this.input.incrementToken() == false) {
>                return false;
>            }
>                      
> this.peekedTokens.add(cloneAttributes());                      
> this.peekPosition = this.peekedTokens.size();
>            return true;
>        }
>               this.peekPosition++;              return true;
>    }
>      @Override
>    public boolean incrementToken() throws IOException {
>        reset();
>              if (this.peekedTokens.isEmpty() == false) {
>            this.peekedTokens.removeFirst();
>        }
>              if (this.peekedTokens.isEmpty() == false) {
>            return true;
>        }
>              return super.incrementToken();
>    }
>          @Override
>    public void reset() {
>        this.peekPosition = 0;
>    }    
>    //Overloaded methods...
>      public Attribute getAttribute(Class attClass) {
>        if (this.peekedTokens.size() > 0) {
>            return 
> this.peekedTokens.get(this.peekPosition).getAttribute(attClass);
>        }              return super.getAttribute(attClass);
>    }
>      //Overload all these just like getAttribute() ...
>    public Iterator<?> getAttributeClassesIterator() ...
>    public AttributeFactory getAttributeFactory() ...
>    public Iterator getAttributeImplsIterator() ...
>    public Attribute addAttribute(Class attClass) ...
>    public void addAttributeImpl(AttributeImpl att) ...
>    public State captureState() ...
>    public void clearAttributes() ...
>    public AttributeSource cloneAttributes() ...
>    public boolean hasAttribute(Class attClass) ...
>    public boolean hasAttributes() ...
>    public void restoreState(State state) ...                     }
>
>
> Now the problem I have is that the below code triggers an evil 
> StackOverflow because I'm overriding incrementToken() and calling 
> super.incrementToken() which will loop back because of this :
>
> public boolean incrementToken() throws IOException {
>    assert tokenWrapper != null;
>      final Token token;
>    if (supportedMethods.hasReusableNext) {
>      token = next(tokenWrapper.delegate);
>    } else {
>      assert supportedMethods.hasNext;
>      token = next(); <----- Lucene calls next();
>    }
>    if (token == null) return false;
>    tokenWrapper.delegate = token;
>    return true;
>  }
>
> which then calls :
>
> public Token next() throws IOException {
>    if (tokenWrapper == null)
>      throw new UnsupportedOperationException("This TokenStream only 
> supports the new Attributes API.");
>      if (supportedMethods.hasIncrementToken) {
>      return incrementToken() ? ((Token) tokenWrapper.delegate.clone()) 
> : null; <--- incrementToken() gets called
>    } else {
>      assert supportedMethods.hasReusableNext;
>      final Token token = next(tokenWrapper.delegate);
>      if (token == null) return null;
>      tokenWrapper.delegate = token;
>      return (Token) token.clone();
>    }
>  }
>
> and hasIncrementToken is true because I overloaded incrementToken();
>
> MethodSupport(Class clazz) {
>    hasIncrementToken = isMethodOverridden(clazz, "incrementToken", 
> METHOD_NO_PARAMS);
>    hasReusableNext = isMethodOverridden(clazz, "next", 
> METHOD_TOKEN_PARAM);
>    hasNext = isMethodOverridden(clazz, "next", METHOD_NO_PARAMS);
> }
>
> Seems like a "catch-22". From what I understand, if I override 
> incrementToken() I should not call super.incrementToken()????
>
> Daniel S.
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42146-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 18:55:37 2009
Return-Path: <java-user-return-42146-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2444 invoked from network); 3 Sep 2009 18:55:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 18:55:37 -0000
Received: (qmail 32646 invoked by uid 500); 3 Sep 2009 18:55:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32573 invoked by uid 500); 3 Sep 2009 18:55:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32563 invoked by uid 99); 3 Sep 2009 18:55:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 18:55:34 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 18:55:25 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n83It3jU021644
	for <java-user@lucene.apache.org>; Thu, 3 Sep 2009 14:55:03 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Thu, 03 Sep 2009 14:55:00 -0400
  id 00027341.4AA01104.00004D2E
Message-ID: <4AA01104.2000609@lexum.umontreal.ca>
Date: Thu, 03 Sep 2009 14:55:00 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: TokenStream API, Quick Question.
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca> <4A9D9C48.7040703@lexum.umontreal.ca> <4A9DB1C4.3000001@gmail.com> <4A9DB3EA.7000800@gmail.com> <A95513C77FA44482B345BA468895E341@VEGA> <4A9FE6E1.1060108@lexum.umontreal.ca> <4A9FE859.40404@lexum.umontreal.ca>
In-Reply-To: <4A9FE859.40404@lexum.umontreal.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3355=0
X-Virus-Checked: Checked by ClamAV on apache.org

Does a TokenStream have to return always the same number of attributes 
with the same underlying classes for all the tokens it generates?

I mean, during the tokenization phase, can the first "token" have a Term 
and Offset Attribute and the second "token" only a Type Attribute or 
does this mean that the first token has to have an empty Type attribute 
as well?

I'm just not sure,
Daniel Shane

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42147-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 19:04:52 2009
Return-Path: <java-user-return-42147-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4894 invoked from network); 3 Sep 2009 19:04:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 19:04:52 -0000
Received: (qmail 43988 invoked by uid 500); 3 Sep 2009 19:04:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43932 invoked by uid 500); 3 Sep 2009 19:04:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43922 invoked by uid 99); 3 Sep 2009 19:04:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 19:04:49 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 19:04:39 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 5064ED36008
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 21:04:16 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id GHF0-Q49Irv1 for <java-user@lucene.apache.org>;
	Thu,  3 Sep 2009 21:04:06 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 4ABC9D36007
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 21:04:06 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca> <4A9D9C48.7040703@lexum.umontreal.ca> <4A9DB1C4.3000001@gmail.com> <4A9DB3EA.7000800@gmail.com> <A95513C77FA44482B345BA468895E341@VEGA> <4A9FE6E1.1060108@lexum.umontreal.ca> <4A9FE859.40404@lexum.umontreal.ca> <4AA01104.2000609@lexum.umontreal.ca>
Subject: RE: TokenStream API, Quick Question.
Date: Thu, 3 Sep 2009 21:04:04 +0200
Message-ID: <106B272C42E643C3B7BECC6C7086162A@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-reply-to: <4AA01104.2000609@lexum.umontreal.ca>
Thread-index: AcosyCdsRgPyGs59TryeQB2iW6Qg0AAAP6/g
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

The indexer only call getAttribute/addAttribute one time after initializing
(see docs). It will never call it later. If you cache tokens, you always
have to restore the state into the TokenStream's attributes.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Daniel Shane [mailto:shaned@LEXUM.UMontreal.CA]
> Sent: Thursday, September 03, 2009 8:55 PM
> To: java-user@lucene.apache.org
> Subject: TokenStream API, Quick Question.
> 
> Does a TokenStream have to return always the same number of attributes
> with the same underlying classes for all the tokens it generates?
> 
> I mean, during the tokenization phase, can the first "token" have a Term
> and Offset Attribute and the second "token" only a Type Attribute or
> does this mean that the first token has to have an empty Type attribute
> as well?
> 
> I'm just not sure,
> Daniel Shane
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42148-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 21:56:17 2009
Return-Path: <java-user-return-42148-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53284 invoked from network); 3 Sep 2009 21:56:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 21:56:16 -0000
Received: (qmail 90243 invoked by uid 500); 3 Sep 2009 21:56:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90172 invoked by uid 500); 3 Sep 2009 21:56:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90162 invoked by uid 99); 3 Sep 2009 21:56:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 21:56:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 21:56:05 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 1885F71C5CF; Thu,  3 Sep 2009 14:55:44 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 1078B71C5A5
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 14:55:44 -0700 (PDT)
Date: Thu, 3 Sep 2009 14:55:44 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Can this regex be done?
In-Reply-To: <22bb517f0909021652w69b0a241o9dd2c676d8aa5817@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0909031450370.20830@radix.cryptio.net>
References: <22bb517f0909021414h3d85db85pc8be70de1bc865dd@mail.gmail.com> 
 <4A9EF4C7.30307@gmail.com> <22bb517f0909021652w69b0a241o9dd2c676d8aa5817@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Because some of the queries that I have to convert (without modifying
: them, unfortunately) have a half literally a page of statements
: expressed like that that, if expanded, would equal a several page long
: lucene query.

FWIW: the RegexQuery (in contrib) applies the regex input to every term in 
the field (in some cases it can skip ahead if there it can find a 
constant prefix) to see if it matches, and then essentially builds a giant 
"OR" query of all the terms that match.

so if your concern is that you don't want to translate the regex 
expressions yourself, the RegexQuerry can handle it for you ... but if 
your concern is that the equivilent query will be really big, well... it's 
going to be really big anyway, but if you convert it you might be able to 
make some optimizations during your conversion process (ie: if you know 
you only need to worry about groupings and alternates, and that you'll 
never have any wildcards (like your one example) then you can build up all 
of the possible clauses without doing a full TermEnum walk ... even for 
100s of clauses, that's probably faster if your field has thousands of 
terms.




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42149-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 22:02:00 2009
Return-Path: <java-user-return-42149-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55433 invoked from network); 3 Sep 2009 22:02:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 22:02:00 -0000
Received: (qmail 99860 invoked by uid 500); 3 Sep 2009 22:01:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99807 invoked by uid 500); 3 Sep 2009 22:01:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99797 invoked by uid 99); 3 Sep 2009 22:01:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 22:01:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 22:01:46 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 8B15671C5A5; Thu,  3 Sep 2009 15:01:25 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 8954F71C2C0
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 15:01:25 -0700 (PDT)
Date: Thu, 3 Sep 2009 15:01:25 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Field.Store.NO & Field.Index.NOT_ANALYZED & hashCode
In-Reply-To: <333a2bef0909011419g34ad0ebai4d82a0e2133aa92@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0909031459510.20830@radix.cryptio.net>
References: <333a2bef0909011419g34ad0ebai4d82a0e2133aa92@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: As for the exact matching, I am wondering if I should store the hashcode of
: the text in a separate field and convert the text in the query to a hashcode
: before passing it on or if Lucene already does something like that under the
: covers when it sees Field.Store.NO & Field.Index.NOT_ANALYZED. We will have
: millions of entries.

lucene doesn't modify your data ... if you have a hashing function that 
you are reasonably sure won't produce any collisions, you might see 
speed / index-size improvements in using a hash instead of the orriginal 
string (it depends on how fast your hashing function is, and how small the 
has values are compared to the input values)



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42150-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 22:07:08 2009
Return-Path: <java-user-return-42150-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56617 invoked from network); 3 Sep 2009 22:07:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 22:07:07 -0000
Received: (qmail 5996 invoked by uid 500); 3 Sep 2009 22:07:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5897 invoked by uid 500); 3 Sep 2009 22:07:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5887 invoked by uid 99); 3 Sep 2009 22:07:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 22:07:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.210.199 as permitted sender)
Received: from [209.85.210.199] (HELO mail-yx0-f199.google.com) (209.85.210.199)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 22:06:55 +0000
Received: by yxe37 with SMTP id 37so1585120yxe.5
        for <java-user@lucene.apache.org>; Thu, 03 Sep 2009 15:06:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=jmeMgq7wyHw4Tela7VZIUL6b/BohonwDeeDXskvXrKg=;
        b=VuDVZL8DYBTgaAGcfFq2VNcHujNI3O435tuZ0UfBeAVz5Wz/jKQo7F8o9tLRVJ9P6C
         z8haGY3HZglnx8oPkoAqcD65lb7yGxxZd0nZPXIfh18d3zAbiZQI2hWACcfKXDOxi4ph
         uqezhTOC9+ZlghA4XAOgbUX2aPFFTBIQm/Rus=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=auJrX8azHCtnWtEfBin5Ee0UNZ6c8BIIOLdvc+vvUyjHv2HnXN62JJasUWttJojNhM
         Qb7LesoHn9B8E1eSR+zSlzCvw0omKPycUQmsL5c4NFsMRlM1tDVsa1TjhkRyU2uv0yRu
         tyRtvdrb1qokciUJFkdb/TNJTegDNR99GpoS8=
MIME-Version: 1.0
Received: by 10.101.88.1 with SMTP id q1mr11398835anl.177.1252015541472; Thu, 
	03 Sep 2009 15:05:41 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0909031450370.20830@radix.cryptio.net>
References: <22bb517f0909021414h3d85db85pc8be70de1bc865dd@mail.gmail.com>
	 <4A9EF4C7.30307@gmail.com>
	 <22bb517f0909021652w69b0a241o9dd2c676d8aa5817@mail.gmail.com>
	 <Pine.LNX.4.64.0909031450370.20830@radix.cryptio.net>
Date: Thu, 3 Sep 2009 18:05:41 -0400
Message-ID: <8f0ad1f30909031505l2bd73d6bg3b395ad8d6f64639@mail.gmail.com>
Subject: Re: Can this regex be done?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

just a side note, LUCENE-1606 is intended to address exactly the
performance issue that you described.

rather than depending upon constant prefix or enumerating terms, it
can efficiently skip through the term dictionary.

the downside is that this behavior depends upon the ability to compile
a regular expression into a DFA.
some regex features (such as capturing groups/backreferences) need NFA
representation, though it does not support those.

On Thu, Sep 3, 2009 at 5:55 PM, Chris Hostetter<hossman_lucene@fucit.org> wrote:
>
> : Because some of the queries that I have to convert (without modifying
> : them, unfortunately) have a half literally a page of statements
> : expressed like that that, if expanded, would equal a several page long
> : lucene query.
>
> FWIW: the RegexQuery (in contrib) applies the regex input to every term in
> the field (in some cases it can skip ahead if there it can find a
> constant prefix) to see if it matches, and then essentially builds a giant
> "OR" query of all the terms that match.
>
> so if your concern is that you don't want to translate the regex
> expressions yourself, the RegexQuerry can handle it for you ... but if
> your concern is that the equivilent query will be really big, well... it's
> going to be really big anyway, but if you convert it you might be able to
> make some optimizations during your conversion process (ie: if you know
> you only need to worry about groupings and alternates, and that you'll
> never have any wildcards (like your one example) then you can build up all
> of the possible clauses without doing a full TermEnum walk ... even for
> 100s of clauses, that's probably faster if your field has thousands of
> terms.
>
>
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42151-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 03 22:16:05 2009
Return-Path: <java-user-return-42151-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60078 invoked from network); 3 Sep 2009 22:16:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Sep 2009 22:16:05 -0000
Received: (qmail 14825 invoked by uid 500); 3 Sep 2009 22:16:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14773 invoked by uid 500); 3 Sep 2009 22:16:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14763 invoked by uid 99); 3 Sep 2009 22:16:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 22:16:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Sep 2009 22:15:54 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 6789971C787; Thu,  3 Sep 2009 15:15:34 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 6180771C785
	for <java-user@lucene.apache.org>; Thu,  3 Sep 2009 15:15:34 -0700 (PDT)
Date: Thu, 3 Sep 2009 15:15:34 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Extending Sort/FieldCache
In-Reply-To: <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com> 
 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: I wanted to avoid two things:
: * Writing the logic that invokes cache-refresh upon IndexReader reload.

Uh... i don't think there is any code that FieldCache refreshing on 
reload (yet), so you wouldn't be missing out on anything.  (as long as 
your custom cache works at the SegmentReader level, you'd have the exact 
same benefits as using FieldCache)

: * Write my own TopFieldCollector which uses this cache.

well, yeah ... there you're screwed.

you know ... just because FieldCache.DEFAULT is a static final singleton, 
doesn't mean we need to have FieldCache.DEFAULT hardcoded in so many 
places ... a lot of the high level classes that refer to 
FieldCache.DEFAULT could probably be refacotred to have a 
setFieldCache(FieldCache) method that defaults to FieldCache.DEFAULT, and 
then they could pass it down to the lower level classes ... that way you 
*could* write a "MyFieldCache extends FieldCache", and then have a 
SortComparator (or FieldComparator, or whatever it's called now) that cast 
the FieldCache it gets to your MyFieldCache and calls the custom methods 
... withoutneeding to rewrite all of hte Collector code.

It sounds a little invasive to make it into 2.9 ... but i haven't looked 
ito what it would involve ... in theory it could be really straight 
forward and backwards compatible.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42152-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 04:33:43 2009
Return-Path: <java-user-return-42152-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56030 invoked from network); 4 Sep 2009 04:33:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 04:33:43 -0000
Received: (qmail 5159 invoked by uid 500); 4 Sep 2009 04:33:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5075 invoked by uid 500); 4 Sep 2009 04:33:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5065 invoked by uid 99); 4 Sep 2009 04:33:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 04:33:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 04:33:30 +0000
Received: by ewy22 with SMTP id 22so562640ewy.28
        for <java-user@lucene.apache.org>; Thu, 03 Sep 2009 21:33:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=yNTs+oOQin+XjFTrYlGJSXblc8HbB9tUqFxJbPkeR38=;
        b=SmL5v4vVT34miuUK1/JSMnMP6qtXbJRJB9jWcknZh55RsXCHh/0gF8am8fn5IJl+4/
         VSlyYIAqAdXtptA/IRDlR/6C6nY4WeAi79taNL4XCh7FmtN94wuqzM9X9rG3rHo5exx9
         rNaOjqccW0XtmKwhrrbulB81fcN5imR/cCjrI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=m6MKVhqhbIJfQ4aizw5EOtOqxXa1vniEI5ZMO07eJLwu2EUhjScWNdfjWpbaRUoTE9
         Wx79v2YvWFPaFxLPIlCwglcYLRC1ucjAuIw0/uix8FRG8szSY2HHLqOtOTkl7EhRNSaT
         ySmoAIb0Rw1Aj4VtHUwOluPYLY0cyUon81l8s=
MIME-Version: 1.0
Received: by 10.216.29.213 with SMTP id i63mr732052wea.90.1252038790267; Thu, 
	03 Sep 2009 21:33:10 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
Date: Fri, 4 Sep 2009 07:33:10 +0300
Message-ID: <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6db61c056c1e50472b8ffeb
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6db61c056c1e50472b8ffeb
Content-Type: text/plain; charset=ISO-8859-1

Thanks

I plan to look into two things, and then probably create two separate
issues:

1) Refactor the FieldCache API (and TopFieldCollector) such that one can
provide its own Cache of native values. I'd hate to rewrite the
FieldComparators logic just because the current API is not extendable. That
I agree should be quite straightforward, but I'll need to look into it
first.

2) Contribute my payload-based sorting package. Currently it only reads from
disk during searches, and I'd like to enhance it to use in-memory cache as
well. It's a moderate-size package, so this one will need to wait until (1)
is done, and I get enough time to adapt it to 2.9 and work on the issue.

I definitely don't think this should be a 2.9 sort of work, unless someone
else volunteers to do it. I can't pull (1) together that quickly.

I thought that FieldCache is loaded when the IndexReader is reopened no? I
mean, it's a per IndexReader instance no? If not, then I'll need to rethink
the entire approach, because then (1) may not be that important anymore.

Shai

On Fri, Sep 4, 2009 at 1:15 AM, Chris Hostetter <hossman_lucene@fucit.org>wrote:

>
> : I wanted to avoid two things:
> : * Writing the logic that invokes cache-refresh upon IndexReader reload.
>
> Uh... i don't think there is any code that FieldCache refreshing on
> reload (yet), so you wouldn't be missing out on anything.  (as long as
> your custom cache works at the SegmentReader level, you'd have the exact
> same benefits as using FieldCache)
>
> : * Write my own TopFieldCollector which uses this cache.
>
> well, yeah ... there you're screwed.
>
> you know ... just because FieldCache.DEFAULT is a static final singleton,
> doesn't mean we need to have FieldCache.DEFAULT hardcoded in so many
> places ... a lot of the high level classes that refer to
> FieldCache.DEFAULT could probably be refacotred to have a
> setFieldCache(FieldCache) method that defaults to FieldCache.DEFAULT, and
> then they could pass it down to the lower level classes ... that way you
> *could* write a "MyFieldCache extends FieldCache", and then have a
> SortComparator (or FieldComparator, or whatever it's called now) that cast
> the FieldCache it gets to your MyFieldCache and calls the custom methods
> ... withoutneeding to rewrite all of hte Collector code.
>
> It sounds a little invasive to make it into 2.9 ... but i haven't looked
> ito what it would involve ... in theory it could be really straight
> forward and backwards compatible.
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6db61c056c1e50472b8ffeb--

From java-user-return-42153-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 06:02:24 2009
Return-Path: <java-user-return-42153-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80339 invoked from network); 4 Sep 2009 06:02:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 06:02:24 -0000
Received: (qmail 92785 invoked by uid 500); 4 Sep 2009 06:02:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92716 invoked by uid 500); 4 Sep 2009 06:02:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92706 invoked by uid 99); 4 Sep 2009 06:02:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 06:02:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.92] (HELO smtp105.mail.in.yahoo.com) (202.86.5.92)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 04 Sep 2009 06:02:10 +0000
Received: (qmail 19481 invoked from network); 4 Sep 2009 06:01:47 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=gGzmL4Xwm6/nX8XCF/9ZR9aykTPn9yamRDU+QhD4hSdYe6OHqZpK5wpZmfBCUN5ZabzzF78bXL1P4WlRyk6cMxMpLHfbsScqXj7bKiqOmyijYs/rLEahlOBLBNj+YIrRUqBPglFtrLTTMvKHXof8W10rtgPn7maVzFsfN6h+EwA=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp105.mail.in.yahoo.com with SMTP; 4 Sep 2009 06:01:46 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: NTsN4AcVM1l3kIc81QvxOb.8eUFYsEFUnDCBH9qQEWITx6ha5eFsH0zpqApqgdyQi6DKtxhNk2TNBMeso.M8hXJSf7n4HOe6EQsJnJadGG3Jprrk1utpsYJZlv1XdY.Xea486pY1nmN0EFdZ0HHldo4r1S.KRhwSx7A3pYABgp6_P97f3kSHM1ZNDGXL5g--
X-Yahoo-Newman-Property: ymail-3
Message-ID: <000901ca2d25$2f44ac30$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <003101ca2bb9$419a0f00$710bc30a@sv.us.sonicwall.com> <786fde50909020403n3f2d72d8gc35a0d7bc6d21c62@mail.gmail.com> <004101ca2bc1$eab54070$710bc30a@sv.us.sonicwall.com> <907723.41487.qm@web24703.mail.ird.yahoo.com>
Subject: Re: First result in the group
Date: Fri, 4 Sep 2009 11:31:44 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks shai and mark for your suggestions.

I initially tried DuplicateFilter and it is not giving me expected =
results. It removes the duplicates at query time and not in the results.

Regards
Ganesh

----- Original Message -----=20
From: "mark harwood" <markharw00d@yahoo.co.uk>
To: <java-user@lucene.apache.org>
Sent: Wednesday, September 02, 2009 5:36 PM
Subject: Re: First result in the group


See "DuplicateFilter" in contrib.

http://markmail.org/message/lsvnpu7mwhht3a4p

Cheers
Mark



----- Original Message ----
From: Ganesh <emailgane@yahoo.co.in>
To: java-user@lucene.apache.org
Sent: Wednesday, 2 September, 2009 12:38:35
Subject: Re: First result in the group

I have a field called category and all documents will have belong to =
some category( say some belong to X and some Y etc). The field values =
may change dynamically. I want the search results to be filterted to =
retrieve one document per category.=20

This is similar to 'group by' feature in database.

Regards
Ganesh


----- Original Message -----=20
From: "Shai Erera" <serera@gmail.com>
To: <java-user@lucene.apache.org>
Sent: Wednesday, September 02, 2009 4:33 PM
Subject: Re: First result in the group


> What do you mean by "first result in the group"? What is a group?
>=20
> On Wed, Sep 2, 2009 at 1:36 PM, Ganesh <emailgane@yahoo.co.in> wrote:
>=20
>> Hello all,
>>
>> I want to retrieve the first result in the group. How to acheive =
this?
>> Currently i am parsing all the results, using a hash and avoiding =
duplicate
>> entries.
>>
>> Is there any better way?
>>
>> Regards
>> Ganesh
>> Send instant messages to your online friends =
http://in.messenger.yahoo.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
Send instant messages to your online friends =
http://in.messenger.yahoo.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


     =20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42154-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 06:11:32 2009
Return-Path: <java-user-return-42154-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83900 invoked from network); 4 Sep 2009 06:11:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 06:11:32 -0000
Received: (qmail 7686 invoked by uid 500); 4 Sep 2009 06:11:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7612 invoked by uid 500); 4 Sep 2009 06:11:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7602 invoked by uid 99); 4 Sep 2009 06:11:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 06:11:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.92] (HELO smtp105.mail.in.yahoo.com) (202.86.5.92)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 04 Sep 2009 06:11:19 +0000
Received: (qmail 21186 invoked from network); 4 Sep 2009 06:10:56 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=nKdueOiff5DTyTF6OzTMxt1uc4EO0yLz10KnEW+FcZHAu4pt5QhyaoPNsBIw8Skuw+34PIpuIT0TvkKhJdpXoMf0Qn5dFlPFwRkn6w0Zu8odAC50cPufsI9nHbxG9pZ0pflykohG3lEDiv/Hwlm2wCMsUdBJK3H/2RfenQyoPzM=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp105.mail.in.yahoo.com with SMTP; 4 Sep 2009 06:10:56 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: yiDkMPsVM1nn1vu2tWrPgnAYeu5N1dxe18bJNXlLOe1JpHB7ji4a9hfF4oIJU_Of9VC.h5AjprJtwq6CykXAdj1lFypCYCqyptm1J5sjqYIIOzVvhEX.EAIM1Y1Kcm2nPNT0A8Y3em_UIoB2Mq38MeYP
X-Yahoo-Newman-Property: ymail-3
Message-ID: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Subject: too many file descriptors opened by Lucene shows (deleted) in /proc 
Date: Fri, 4 Sep 2009 11:40:53 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all,

In my linux pc, there are too many fd counts for lucene database. =
/proc/<processid>/fd shows very big list. I have provided sample below.

lr-x------    1 root     root           64 Sep  3 17:02 360 -> =
/opt/ganesh/lucenedb/_2w5.tvf (deleted)
lr-x------    1 root     root           64 Sep  3 17:02 361 -> =
/opt/ganesh/lucenedb/_hr.frq (deleted)
lr-x------    1 root     root           64 Sep  3 17:02 362 -> =
/opt/ganesh/lucenedb/_hr.prx (deleted)
lr-x------    1 root     root           64 Sep  3 17:02 363 -> =
/opt/ganesh/lucenedb/_hr.tvx (deleted)
lr-x------    1 root     root           64 Sep  3 21:01 364 -> =
/opt/ganesh/lucenedb/_hr.tvd (deleted)
lr-x------    1 root     root           64 Sep  3 17:02 365 -> =
/opt/ganesh/lucenedb/_hr.tvf (deleted)
lr-x------    1 root     root           64 Sep  3 17:02 366 -> =
/opt/ganesh/lucenedb/_2w4.fdt (deleted)
lr-x------    1 root     root           64 Sep  3 17:02 367 -> =
/opt/ganesh/lucenedb/_2w4.fdx (deleted)

These files not exist in the disk but why it is showing as (deleted) in =
the /proc. This means the process is still holding the fd. Please =
provide me more information on this. I am using Fedora Linux, ext-3 file =
system, Lucene 2.4.1.

Regards
Ganesh     
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42155-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 06:26:49 2009
Return-Path: <java-user-return-42155-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96128 invoked from network); 4 Sep 2009 06:26:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 06:26:49 -0000
Received: (qmail 22962 invoked by uid 500); 4 Sep 2009 06:26:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22899 invoked by uid 500); 4 Sep 2009 06:26:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22889 invoked by uid 99); 4 Sep 2009 06:26:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 06:26:46 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 06:26:36 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 45155D36008
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 08:26:14 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id gH38o4LrXbBf for <java-user@lucene.apache.org>;
	Fri,  4 Sep 2009 08:26:04 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id BD384D36001
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 08:26:03 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com>
Subject: RE: too many file descriptors opened by Lucene shows (deleted) in /proc 
Date: Fri, 4 Sep 2009 08:26:01 +0200
Message-ID: <56868BB9D33F495591AAB653D8EDDB1B@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: AcotJpN+eI3gMOZ+Rni/3NRD/bheKQAAUBxQ
X-Virus-Checked: Checked by ClamAV on apache.org

This is normal. When you open an IndexReader/IndexSearcher, it opens various
file handles. If you additionally update/add/delete documents in parallel
(even in other process), or optimize the index, the original IndexReader
stays on using the "old" state of the index. IndexWriter deletes some files,
but IndexReader still have them open (this is our segment based
"transaction" handling of IndexWriter). If you reopen your IndexReader to
get the last updates of the underlying index, these "deleted" files will
disappear, as they can be closed. As long as they are open, they disappear
from directory listing, but they still consume space on disk (because they
are still used). This is why you see this deleted files.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> From: Ganesh [mailto:emailgane@yahoo.co.in]
> Sent: Friday, September 04, 2009 8:11 AM
> To: java-user@lucene.apache.org
> Subject: too many file descriptors opened by Lucene shows (deleted) in
> /proc
> 
> Hello all,
> 
> In my linux pc, there are too many fd counts for lucene database.
> /proc/<processid>/fd shows very big list. I have provided sample below.
> 
> lr-x------    1 root     root           64 Sep  3 17:02 360 ->
> /opt/ganesh/lucenedb/_2w5.tvf (deleted)
> lr-x------    1 root     root           64 Sep  3 17:02 361 ->
> /opt/ganesh/lucenedb/_hr.frq (deleted)
> lr-x------    1 root     root           64 Sep  3 17:02 362 ->
> /opt/ganesh/lucenedb/_hr.prx (deleted)
> lr-x------    1 root     root           64 Sep  3 17:02 363 ->
> /opt/ganesh/lucenedb/_hr.tvx (deleted)
> lr-x------    1 root     root           64 Sep  3 21:01 364 ->
> /opt/ganesh/lucenedb/_hr.tvd (deleted)
> lr-x------    1 root     root           64 Sep  3 17:02 365 ->
> /opt/ganesh/lucenedb/_hr.tvf (deleted)
> lr-x------    1 root     root           64 Sep  3 17:02 366 ->
> /opt/ganesh/lucenedb/_2w4.fdt (deleted)
> lr-x------    1 root     root           64 Sep  3 17:02 367 ->
> /opt/ganesh/lucenedb/_2w4.fdx (deleted)
> 
> These files not exist in the disk but why it is showing as (deleted) in
> the /proc. This means the process is still holding the fd. Please provide
> me more information on this. I am using Fedora Linux, ext-3 file system,
> Lucene 2.4.1.
> 
> Regards
> Ganesh
> Send instant messages to your online friends http://in.messenger.yahoo.com
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42156-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 07:24:16 2009
Return-Path: <java-user-return-42156-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13290 invoked from network); 4 Sep 2009 07:24:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 07:24:16 -0000
Received: (qmail 76418 invoked by uid 500); 4 Sep 2009 07:24:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76367 invoked by uid 500); 4 Sep 2009 07:24:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76357 invoked by uid 99); 4 Sep 2009 07:24:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 07:24:13 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [77.238.184.53] (HELO smtp122.mail.ukl.yahoo.com) (77.238.184.53)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 04 Sep 2009 07:24:02 +0000
Received: (qmail 1306 invoked from network); 4 Sep 2009 07:23:41 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Subject:Mime-Version:Content-Type:From:X-Priority:In-Reply-To:Date:Content-Transfer-Encoding:Message-Id:References:To:X-Mailer;
  b=YFD6C5qJWM8om84wkfm7Hk+5utoHTBqZRiRMTGbdcZkK9FEBKijz52YE+LkrV+ocdKrdG+BmA1TCTXpqghbzOy3X8GWpEMWYniQFmkuyL4gDVSQf09KAXJLLR6+78LoX5owA/JuIAUeNizp55MeU1HJrjcvLemfz7N99RB68tFY=  ;
Received: from unknown (HELO ?192.168.2.50?) (markharw00d@194.106.34.5 with plain)
  by smtp122.mail.ukl.yahoo.com with SMTP; 4 Sep 2009 07:23:41 -0000
X-Yahoo-SMTP: zTNABayswBADoI1EHkfx1KN3qDu5p6Ws
X-YMail-OSG: N4hcpZoVM1lbR61Q_stMW_sLSVvOsGzseL9rFugDNezrgUfDdaKDHq5ikdOlOFK17NoE9qGEBen_MI0Jw5YnlmQ0sEpGywZqLht.Asi00HKCBU4lB2nQnXTlYJe1KSRhN5NjkKv_uI6spm04TEpY77E9ZzLL1YvWm5NuH7bj2LcHeJkB6Jq4uMeL.ulAnSZBJHeCX2SpE_izAQw1MFxIglhzrakV8Q1ECFeXZ6bkNZ3f5L.JEnU8_n4v5tcUTLhPRt1VNQ--
X-Yahoo-Newman-Property: ymail-3
Subject: Re: First result in the group
Mime-Version: 1.0 (Apple Message framework v1075.2)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
From: Mark Harwood <markharw00d@yahoo.co.uk>
X-Priority: 3
In-Reply-To: <000901ca2d25$2f44ac30$710bc30a@sv.us.sonicwall.com>
Date: Fri, 4 Sep 2009 08:23:39 +0100
Content-Transfer-Encoding: 7bit
Message-Id: <9DB594A2-2E12-4E04-A071-83B11114D8F6@yahoo.co.uk>
References: <003101ca2bb9$419a0f00$710bc30a@sv.us.sonicwall.com> <786fde50909020403n3f2d72d8gc35a0d7bc6d21c62@mail.gmail.com> <004101ca2bc1$eab54070$710bc30a@sv.us.sonicwall.com> <907723.41487.qm@web24703.mail.ird.yahoo.com> <000901ca2d25$2f44ac30$710bc30a@sv.us.sonicwall.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1075.2)
X-Virus-Checked: Checked by ClamAV on apache.org

 >>It removes the duplicates at query time and not in the results.


Not sure I understand that statement. Do you mean you want index-time  
rejection of potentially duplicate inserts?



On 4 Sep 2009, at 07:01, Ganesh wrote:

> It removes the duplicates at query time and not in the results.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42157-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 07:35:27 2009
Return-Path: <java-user-return-42157-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14784 invoked from network); 4 Sep 2009 07:35:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 07:35:27 -0000
Received: (qmail 86515 invoked by uid 500); 4 Sep 2009 07:35:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86443 invoked by uid 500); 4 Sep 2009 07:35:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86433 invoked by uid 99); 4 Sep 2009 07:35:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 07:35:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [202.86.5.92] (HELO smtp105.mail.in.yahoo.com) (202.86.5.92)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 04 Sep 2009 07:35:12 +0000
Received: (qmail 35154 invoked from network); 4 Sep 2009 07:34:49 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=oqnASQSIkH/UTbaamQ51KkUQ/XPQr46BWKOet6gvuN7KwZmATQ5NVpkSNH4EaE4mpkhAfTDqBELFz2+gKBAZzwaG1FzmCWNifxhGE0k39qn2CCtPtGH5zwd+jA7qahhpmVkyi5hZ/CnC4d00uXKJQLBcA94HFD2JPxAxCT1WMIA=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp105.mail.in.yahoo.com with SMTP; 4 Sep 2009 07:34:49 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: 4ATJ17AVM1kth11lCSW2Lxg4Tyotz.iWvaRpXaUKui7P52i4KBoU4k2XS.7AEiqhJE4XD16UGg7JLsaKKuDI.TaQGtcf_p0k_2KLeqLbmN8TT99HKvQS3gwxe3Qb7jWfXWj5qEGObXdLzEAk.O_gmEP951uXH5uQFTIssguCl2SMRPNSe_pxI1qUGF93iO5.XfYi7hCnJKyvJucbXjYYlRin9sRlrdw-
X-Yahoo-Newman-Property: ymail-3
Message-ID: <002401ca2d32$2f2d19a0$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com> <56868BB9D33F495591AAB653D8EDDB1B@VEGA>
Subject: Re: too many file descriptors opened by Lucene shows (deleted) in /proc 
Date: Fri, 4 Sep 2009 13:04:47 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

I am having only one process using Lucene DB. The same process writes =
and reads. I do re-open indexreader. I am maintaing ref count for each =
reader/searcher and closing it if it is not used. I am not able to =
understand, why the file descriptor is showing as (deleted)?

I guessing some issues? Could any one tell me what are the other part of =
code to look in to (related to Lucene)? Any other way to identify the =
root cause?

Regards
Ganesh=20


----- Original Message -----=20
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
Sent: Friday, September 04, 2009 11:56 AM
Subject: RE: too many file descriptors opened by Lucene shows (deleted) =
in /proc=20


> This is normal. When you open an IndexReader/IndexSearcher, it opens =
various
> file handles. If you additionally update/add/delete documents in =
parallel
> (even in other process), or optimize the index, the original =
IndexReader
> stays on using the "old" state of the index. IndexWriter deletes some =
files,
> but IndexReader still have them open (this is our segment based
> "transaction" handling of IndexWriter). If you reopen your IndexReader =
to
> get the last updates of the underlying index, these "deleted" files =
will
> disappear, as they can be closed. As long as they are open, they =
disappear
> from directory listing, but they still consume space on disk (because =
they
> are still used). This is why you see this deleted files.
>=20
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>=20
>> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> Sent: Friday, September 04, 2009 8:11 AM
>> To: java-user@lucene.apache.org
>> Subject: too many file descriptors opened by Lucene shows (deleted) =
in
>> /proc
>>=20
>> Hello all,
>>=20
>> In my linux pc, there are too many fd counts for lucene database.
>> /proc/<processid>/fd shows very big list. I have provided sample =
below.
>>=20
>> lr-x------    1 root     root           64 Sep  3 17:02 360 ->
>> /opt/ganesh/lucenedb/_2w5.tvf (deleted)
>> lr-x------    1 root     root           64 Sep  3 17:02 361 ->
>> /opt/ganesh/lucenedb/_hr.frq (deleted)
>> lr-x------    1 root     root           64 Sep  3 17:02 362 ->
>> /opt/ganesh/lucenedb/_hr.prx (deleted)
>> lr-x------    1 root     root           64 Sep  3 17:02 363 ->
>> /opt/ganesh/lucenedb/_hr.tvx (deleted)
>> lr-x------    1 root     root           64 Sep  3 21:01 364 ->
>> /opt/ganesh/lucenedb/_hr.tvd (deleted)
>> lr-x------    1 root     root           64 Sep  3 17:02 365 ->
>> /opt/ganesh/lucenedb/_hr.tvf (deleted)
>> lr-x------    1 root     root           64 Sep  3 17:02 366 ->
>> /opt/ganesh/lucenedb/_2w4.fdt (deleted)
>> lr-x------    1 root     root           64 Sep  3 17:02 367 ->
>> /opt/ganesh/lucenedb/_2w4.fdx (deleted)
>>=20
>> These files not exist in the disk but why it is showing as (deleted) =
in
>> the /proc. This means the process is still holding the fd. Please =
provide
>> me more information on this. I am using Fedora Linux, ext-3 file =
system,
>> Lucene 2.4.1.
>>=20
>> Regards
>> Ganesh
>> Send instant messages to your online friends =
http://in.messenger.yahoo.com
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42158-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 07:43:34 2009
Return-Path: <java-user-return-42158-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16296 invoked from network); 4 Sep 2009 07:43:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 07:43:34 -0000
Received: (qmail 96639 invoked by uid 500); 4 Sep 2009 07:43:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96581 invoked by uid 500); 4 Sep 2009 07:43:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96571 invoked by uid 99); 4 Sep 2009 07:43:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 07:43:32 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 07:43:20 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id C1AD7D36001
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 09:42:59 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 0c35zlVI6PDh for <java-user@lucene.apache.org>;
	Fri,  4 Sep 2009 09:42:49 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.75])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 510F945F21F
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 09:42:49 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com> <56868BB9D33F495591AAB653D8EDDB1B@VEGA> <002401ca2d32$2f2d19a0$710bc30a@sv.us.sonicwall.com>
Subject: RE: too many file descriptors opened by Lucene shows (deleted) in /proc 
Date: Fri, 4 Sep 2009 09:42:47 +0200
Message-ID: <07E1D9132E514DEF99909ED72A299B9D@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: AcotMkv977Qlwt80Qcy5zmkULTiGPwAAHGvg
In-Reply-To: <002401ca2d32$2f2d19a0$710bc30a@sv.us.sonicwall.com>
X-Virus-Checked: Checked by ClamAV on apache.org

One general trap with reopen(): Reopen() returns a *new* IndexReader. If
this new IndexReader is different from the actual one, you have to close the
old reader when you are finished working on it. If you only have one thread
working on this IndexReader that is reopened, you can close the old reader
directly after reopening:

IndexReader new = actualReader.reopen();
if (new != actualReader) {
	actualReader.close();
	actualReader = new;
}

If you have some multithreaded architecture, you have to keep the old reader
open as long as there are accesses (which you can manage by refcounting).

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Ganesh [mailto:emailgane@yahoo.co.in]
> Sent: Friday, September 04, 2009 9:35 AM
> To: java-user@lucene.apache.org
> Subject: Re: too many file descriptors opened by Lucene shows (deleted) in
> /proc
> 
> I am having only one process using Lucene DB. The same process writes and
> reads. I do re-open indexreader. I am maintaing ref count for each
> reader/searcher and closing it if it is not used. I am not able to
> understand, why the file descriptor is showing as (deleted)?
> 
> I guessing some issues? Could any one tell me what are the other part of
> code to look in to (related to Lucene)? Any other way to identify the root
> cause?
> 
> Regards
> Ganesh
> 
> 
> ----- Original Message -----
> From: "Uwe Schindler" <uwe@thetaphi.de>
> To: <java-user@lucene.apache.org>
> Sent: Friday, September 04, 2009 11:56 AM
> Subject: RE: too many file descriptors opened by Lucene shows (deleted) in
> /proc
> 
> 
> > This is normal. When you open an IndexReader/IndexSearcher, it opens
> various
> > file handles. If you additionally update/add/delete documents in
> parallel
> > (even in other process), or optimize the index, the original IndexReader
> > stays on using the "old" state of the index. IndexWriter deletes some
> files,
> > but IndexReader still have them open (this is our segment based
> > "transaction" handling of IndexWriter). If you reopen your IndexReader
> to
> > get the last updates of the underlying index, these "deleted" files will
> > disappear, as they can be closed. As long as they are open, they
> disappear
> > from directory listing, but they still consume space on disk (because
> they
> > are still used). This is why you see this deleted files.
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> >> From: Ganesh [mailto:emailgane@yahoo.co.in]
> >> Sent: Friday, September 04, 2009 8:11 AM
> >> To: java-user@lucene.apache.org
> >> Subject: too many file descriptors opened by Lucene shows (deleted) in
> >> /proc
> >>
> >> Hello all,
> >>
> >> In my linux pc, there are too many fd counts for lucene database.
> >> /proc/<processid>/fd shows very big list. I have provided sample below.
> >>
> >> lr-x------    1 root     root           64 Sep  3 17:02 360 ->
> >> /opt/ganesh/lucenedb/_2w5.tvf (deleted)
> >> lr-x------    1 root     root           64 Sep  3 17:02 361 ->
> >> /opt/ganesh/lucenedb/_hr.frq (deleted)
> >> lr-x------    1 root     root           64 Sep  3 17:02 362 ->
> >> /opt/ganesh/lucenedb/_hr.prx (deleted)
> >> lr-x------    1 root     root           64 Sep  3 17:02 363 ->
> >> /opt/ganesh/lucenedb/_hr.tvx (deleted)
> >> lr-x------    1 root     root           64 Sep  3 21:01 364 ->
> >> /opt/ganesh/lucenedb/_hr.tvd (deleted)
> >> lr-x------    1 root     root           64 Sep  3 17:02 365 ->
> >> /opt/ganesh/lucenedb/_hr.tvf (deleted)
> >> lr-x------    1 root     root           64 Sep  3 17:02 366 ->
> >> /opt/ganesh/lucenedb/_2w4.fdt (deleted)
> >> lr-x------    1 root     root           64 Sep  3 17:02 367 ->
> >> /opt/ganesh/lucenedb/_2w4.fdx (deleted)
> >>
> >> These files not exist in the disk but why it is showing as (deleted) in
> >> the /proc. This means the process is still holding the fd. Please
> provide
> >> me more information on this. I am using Fedora Linux, ext-3 file
> system,
> >> Lucene 2.4.1.
> >>
> >> Regards
> >> Ganesh
> >> Send instant messages to your online friends
> http://in.messenger.yahoo.com
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> Send instant messages to your online friends http://in.messenger.yahoo.com
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42159-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 08:10:26 2009
Return-Path: <java-user-return-42159-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44382 invoked from network); 4 Sep 2009 08:10:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 08:10:26 -0000
Received: (qmail 26383 invoked by uid 500); 4 Sep 2009 08:10:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26301 invoked by uid 500); 4 Sep 2009 08:10:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26291 invoked by uid 99); 4 Sep 2009 08:10:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 08:10:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 08:10:15 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MjTrm-0002NV-Gk
	for java-user@lucene.apache.org; Fri, 04 Sep 2009 01:09:54 -0700
Message-ID: <25289618.post@talk.nabble.com>
Date: Fri, 4 Sep 2009 01:09:54 -0700 (PDT)
From: Marc Sturlese <marc.sturlese@gmail.com>
To: java-user@lucene.apache.org
Subject: Doubt about Fieldcache.DEFAUL.getStrings[] and
 Fieldcache.DEFAULT.getStringIndex
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: marc.sturlese@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hey there, I am iterating over a DocSet and for every id I neew to get the
value of a field wich is analyzed with KeyworddAnalyzer and is not sored.
I have noticed to ways of doing it using Fieldcache. Can someone pleas
explain me the pros and contras of using one or another?
 
Using StringIndex:
private FieldCache.StringIndex myIndex;
myIndex = FieldCache.DEFAULT.getStringIndex(searcher.getReader(),
fieldName);
//for every docId...
    int currentId = i.nextDoc();
    String fieldValue = myIndex.lookup[myIndex.order[currentId]];
//}

Using getStrings:
String[] values = FieldCache.DEFAULT.getStrings(searcher.getReader(),
fieldName);
//for every docId...
    int currentId = i.nextDoc();
    String fieldValue = values[currentId];
//}

Would be true to say that if the terms are repeated many times in that index
field is better to use my first option but if the terms are never repeated
it doesn't matter to use the first or the second one?
Thanks in advance


-- 
View this message in context: http://www.nabble.com/Doubt-about-Fieldcache.DEFAUL.getStrings---and-Fieldcache.DEFAULT.getStringIndex-tp25289618p25289618.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42160-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 08:30:17 2009
Return-Path: <java-user-return-42160-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54044 invoked from network); 4 Sep 2009 08:30:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 08:30:17 -0000
Received: (qmail 56825 invoked by uid 500); 4 Sep 2009 08:30:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56757 invoked by uid 500); 4 Sep 2009 08:30:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56747 invoked by uid 99); 4 Sep 2009 08:30:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 08:30:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [91.121.16.47] (HELO ns23917.ovh.net) (91.121.16.47)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 08:30:03 +0000
Received: (qmail 8801 invoked by uid 508); 4 Sep 2009 08:34:43 -0000
Received: from unknown (HELO spotter-dclnx) (88.182.17.109)
  by ns23917.ovh.net with AES256-SHA encrypted SMTP; 4 Sep 2009 08:34:43 -0000
Received: from techno by spotter-dclnx with local (Exim 4.69)
	(envelope-from <dcausse@spotter.com>)
	id 1MjUAm-0001xa-SE
	for java-user@lucene.apache.org; Fri, 04 Sep 2009 10:29:32 +0200
Date: Fri, 4 Sep 2009 10:29:32 +0200
From: David Causse <dcausse@spotter.com>
To: java-user@lucene.apache.org
Subject: Re: Use of tika for parsing, offsets questions
Message-ID: <20090904082932.GA12797@spotter-dclnx>
Mail-Followup-To: David Causse <dcausse@spotter.com>,
	java-user@lucene.apache.org
References: <20090902124006.GA32711@spotter-dclnx> <510143ac0909030607o510f6d0ftef81357fad1ff25a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <510143ac0909030607o510f6d0ftef81357fad1ff25a@mail.gmail.com>
User-Agent: Mutt/1.5.18 (2008-05-17)
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Sep 03, 2009 at 03:07:18PM +0200, Jukka Zitting wrote:
> Hi,
> 
> On Wed, Sep 2, 2009 at 2:40 PM, David Causse<dcausse@spotter.com> wrote:
> > If I use tika for parsing HTML code and inject parsed String to a lucene
> > analyzer. What about the offset information for KWIC and return to text
> > (like the google cache view)? how can I keep track of the offsets
> > between tika parser and lucene analyzer?
> 
> Currently Tika doesn't expose that information but the Tika Parser API
> was designed for such use in mind, so it will be possible to add the
> offset information. Please file a Tika feature request [1] for this.

I created TIKA-272, the idea behind is to be able to use unmodified
lucene analyzers with tika and keep offset correctness.

Thank you.

-- 
David Causse
Spotter
http://www.spotter.com/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42161-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 09:17:38 2009
Return-Path: <java-user-return-42161-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72682 invoked from network); 4 Sep 2009 09:17:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 09:17:37 -0000
Received: (qmail 55663 invoked by uid 500); 4 Sep 2009 09:17:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55631 invoked by uid 500); 4 Sep 2009 09:17:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55621 invoked by uid 99); 4 Sep 2009 09:17:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:17:35 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of aminmc@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:17:26 +0000
Received: by ewy22 with SMTP id 22so687980ewy.28
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 02:17:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=p6Ek8yS284l/yciuz4n9uBu6vA3FxaAjHpuDQiVwi5E=;
        b=K/b0y19XIIfKjUhF/y5gqsbhhjxsWWsS3YUuNCk3aCHAmpU0xJkdBKaECxiJiOrRLY
         CoVmqXITWfNCAr1ls0SOCW12li8Rr19J8cLKDtwudFFQ3DRDyKri5PWeNUjmddw+pNOQ
         9h3fPD0hDQdQwgQz4dHDwTD+RjzCsM+2GeKFU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=oDSKQX6sTlkafZqnI30+MOA1oqXA1Mt23l3qdW5izo6jPgRNJUO83GMzpdmjE0NPGr
         3m0aroEASsn26BTZz0Po06c1ez2Ee68YRhBNmhtpGacDey39W7h/HCb7fJY4bMf5/R/1
         NpIg2gHn6bHRXYdxnGcMC0OgoP2QMkEdcM8DI=
MIME-Version: 1.0
Received: by 10.216.29.72 with SMTP id h50mr731638wea.137.1252055825848; Fri, 
	04 Sep 2009 02:17:05 -0700 (PDT)
Date: Fri, 4 Sep 2009 10:17:05 +0100
Message-ID: <6f4104d80909040217yd24a342t22232a9b4f217fbb@mail.gmail.com>
Subject: Filtering question/advice
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6de0013bd1b830472bcf6e0
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6de0013bd1b830472bcf6e0
Content-Type: text/plain; charset=ISO-8859-1

Hi,

I am looking at applying a security filter for our lucene document and I was
wondering if I could get feedback on whether the solution I have come up
with.  Firstly I will explain the scenario and followed by the proposed
solution:


We have a concept of a Layer which is a project whereby a broker can trade
with underwriters.  A layer can have more than one underwriter working on
this project therefore both underwriters can search for the same layer.  The
issue is the following:

UWA signs business on a Layer L1 using a reference 'HELLO'

UWB signs business on the same Layer L1 using a reference 'BYE'

Both Underwriters are legitimately allowed to access the Layer L1 so the
security rules will not remove any search hits for L1. However, if UWB
searches for text 'HELLO' he should not get L1 in his search results as he
is not to know that L1 includes a writer reference HELLO for UWA. In the
simple case he will see this result.  Now this is not acceptable for our
case.

The proposed solution is that we do the following:

Document:
uw-reference = HELLO
uw-reference = BYE

With additional field like

uw-uwa = HELLO
uw-uwb = BYE

So when UWB performs a search of "HELLO" there will be an additional filter
applied which would be like "uw-uwb:HELLO" so the final query would be like:

uw-reference:HELLO + (uw-uwb:HELLO) (approximately)

Th

I created a test case to test this solution and it works. The problem is
that if UWB searches for "HELLO" that exists in another field such as:
data:HELLO then he should get a result. It's only when the query is matched
on reference he should not see anything.  My testcase fails when the match
is made on the data field as the security filter does not pass (valid
filter).  Is there a way around this?  Hope this made sense!

Any advice would be highly appreciated

--0016e6de0013bd1b830472bcf6e0--

From java-user-return-42162-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 09:18:01 2009
Return-Path: <java-user-return-42162-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72786 invoked from network); 4 Sep 2009 09:18:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 09:18:00 -0000
Received: (qmail 57494 invoked by uid 500); 4 Sep 2009 09:17:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57413 invoked by uid 500); 4 Sep 2009 09:17:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57403 invoked by uid 99); 4 Sep 2009 09:17:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:17:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.199] (HELO mail-yx0-f199.google.com) (209.85.210.199)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:17:50 +0000
Received: by yxe37 with SMTP id 37so2235988yxe.5
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 02:17:29 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.115.21 with SMTP id n21mr18164497ybc.30.1252055849400; 
	Fri, 04 Sep 2009 02:17:29 -0700 (PDT)
In-Reply-To: <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
	 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
Date: Fri, 4 Sep 2009 05:17:29 -0400
Message-ID: <9ac0c6aa0909040217j7c91b234p9243b9fb86b3d170@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Sep 4, 2009 at 12:33 AM, Shai Erera<serera@gmail.com> wrote:

> 1) Refactor the FieldCache API (and TopFieldCollector) such that one can
> provide its own Cache of native values. I'd hate to rewrite the
> FieldComparators logic just because the current API is not extendable. That
> I agree should be quite straightforward, but I'll need to look into it
> first.

+1

Or, so that the current consumers of FieldCache (that hardwire to
FieldCache.DEFAULT) could simply accept any other FieldCache
instance, as Hoss suggested.

> 2) Contribute my payload-based sorting package. Currently it only reads from
> disk during searches, and I'd like to enhance it to use in-memory cache as
> well. It's a moderate-size package, so this one will need to wait until (1)
> is done, and I get enough time to adapt it to 2.9 and work on the issue.

+1, sounds cool!

> I definitely don't think this should be a 2.9 sort of work, unless someone
> else volunteers to do it. I can't pull (1) together that quickly.

Me too... 2.9 train is moving out of the station now!

> I thought that FieldCache is loaded when the IndexReader is reopened no? I
> mean, it's a per IndexReader instance no? If not, then I'll need to rethink
> the entire approach, because then (1) may not be that important anymore.

FieldCache is only opened on demand, ie, the first time that a newly
opened reader calls FieldCache.DEFAULT.getXXX does it get populated.

So it's not during the reopen... it's during the first query that eg sorts
by a field.

It'd be great if your use case gives us enough clarity on LUCENE-831
to make concrete progress.

Note that function queries already "wrap" FieldCache w/ an alternate API
for native value per doc (ValueSource, DocValues, FieldCacheSource),
that do allow custom ValueSources to be provided.  It'd be great if
as part of LUCENE-831 they could be more unified w/ FieldCache's
API.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42163-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 09:39:05 2009
Return-Path: <java-user-return-42163-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80193 invoked from network); 4 Sep 2009 09:39:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 09:39:05 -0000
Received: (qmail 81769 invoked by uid 500); 4 Sep 2009 09:39:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81691 invoked by uid 500); 4 Sep 2009 09:39:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81676 invoked by uid 99); 4 Sep 2009 09:39:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:39:02 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:38:54 +0000
Received: by ewy22 with SMTP id 22so699875ewy.28
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 02:38:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=5j5wtZUK1p4XIjBz22akjUlz9iMLDe3yKMYsWur0mAA=;
        b=MAtnSgXEg1Ut1oLOsE9DZIQyG2Ktvav/4V2LIcCRxKFtxasO+kup35rGvYqjZui6YO
         vqgbI3rx6weHCgxDdzypbiT1Lxc+x4AhVDzx1TrAHWF39QNq1DMtRtc378VV4bl5WpH3
         9Sv7tN5SUaTraXNhSrnz5c6R0W2zZPh6abCN8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Y66r1e7bACPCQsQVOVdICGB7yF8C6ZY9e1xJIgiYlIrQqcsArObeATRQ+g2yWIiyRY
         34OeX2++CQbxE/AZcHih68rbbBamLjZCe/bkNO0Bed6B4Y6z+l3wwjQa6eSPxOJW0mw3
         XKt9x4j7dl+v4AEbzH5okcORBweUZTj1WLj84=
MIME-Version: 1.0
Received: by 10.216.29.72 with SMTP id h50mr736377wea.137.1252057112816; Fri, 
	04 Sep 2009 02:38:32 -0700 (PDT)
In-Reply-To: <6f4104d80909040217yd24a342t22232a9b4f217fbb@mail.gmail.com>
References: <6f4104d80909040217yd24a342t22232a9b4f217fbb@mail.gmail.com>
Date: Fri, 4 Sep 2009 10:38:32 +0100
Message-ID: <6f4104d80909040238i877609ev65a2f284c07a99df@mail.gmail.com>
Subject: Re: Filtering question/advice
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/mixed; boundary=0016e6de001372ae980472bd43e1
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6de001372ae980472bd43e1
Content-Type: multipart/alternative; boundary=0016e6de001372ae8f0472bd43df

--0016e6de001372ae8f0472bd43df
Content-Type: text/plain; charset=ISO-8859-1

Hi
I include a testcase to show what I am trying to do.  Testcase number 3
fails.

Thanks
Amin

On Fri, Sep 4, 2009 at 10:17 AM, Amin Mohammed-Coleman <aminmc@gmail.com>wrote:

> Hi,
>
> I am looking at applying a security filter for our lucene document and I
> was wondering if I could get feedback on whether the solution I have come up
> with.  Firstly I will explain the scenario and followed by the proposed
> solution:
>
>
> We have a concept of a Layer which is a project whereby a broker can trade
> with underwriters.  A layer can have more than one underwriter working on
> this project therefore both underwriters can search for the same layer.  The
> issue is the following:
>
> UWA signs business on a Layer L1 using a reference 'HELLO'
>
> UWB signs business on the same Layer L1 using a reference 'BYE'
>
> Both Underwriters are legitimately allowed to access the Layer L1 so the
> security rules will not remove any search hits for L1. However, if UWB
> searches for text 'HELLO' he should not get L1 in his search results as he
> is not to know that L1 includes a writer reference HELLO for UWA. In the
> simple case he will see this result.  Now this is not acceptable for our
> case.
>
> The proposed solution is that we do the following:
>
> Document:
> uw-reference = HELLO
> uw-reference = BYE
>
> With additional field like
>
> uw-uwa = HELLO
> uw-uwb = BYE
>
> So when UWB performs a search of "HELLO" there will be an additional filter
> applied which would be like "uw-uwb:HELLO" so the final query would be like:
>
> uw-reference:HELLO + (uw-uwb:HELLO) (approximately)
>
> Th
>
> I created a test case to test this solution and it works. The problem is
> that if UWB searches for "HELLO" that exists in another field such as:
> data:HELLO then he should get a result. It's only when the query is matched
> on reference he should not see anything.  My testcase fails when the match
> is made on the data field as the security filter does not pass (valid
> filter).  Is there a way around this?  Hope this made sense!
>
> Any advice would be highly appreciated
>

--0016e6de001372ae8f0472bd43df
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi=A0<div><br></div><div>I include a testcase to show what I am trying to d=
o. =A0Testcase number 3 fails.</div><div><br></div><div>Thanks</div><div>Am=
in<br><br><div class=3D"gmail_quote">On Fri, Sep 4, 2009 at 10:17 AM, Amin =
Mohammed-Coleman <span dir=3D"ltr">&lt;<a href=3D"mailto:aminmc@gmail.com">=
aminmc@gmail.com</a>&gt;</span> wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex;">Hi,<br><br>I am looking at applying a secur=
ity filter for our lucene document and I was wondering if I could get feedb=
ack on whether the solution I have come up with.=A0 Firstly I will explain =
the scenario and followed by the proposed solution:<br>

<br><br>We have a concept of a Layer which is a project whereby a broker ca=
n trade with underwriters.=A0 A layer can have more than one underwriter wo=
rking on this project therefore both underwriters can search for the same l=
ayer.=A0 The issue is the following:<br>

<br><span style=3D"font-size:12pt;font-family:&quot;Times New Roman&quot;,&=
quot;serif&quot;">UWA signs business on a Layer L1 using a
reference &#39;HELLO&#39;<br>
<br>
UWB signs business on the same Layer L1 using a reference &#39;BYE&#39;<br>
<br>
Both Underwriters are legitimately allowed to access the Layer L1 so the se=
curity
rules will not remove any search hits for L1. However, if UWB searches for =
text
&#39;HELLO&#39; he should not get L1 in his search results as he is not to =
know that L1
includes a writer reference HELLO for UWA. In the simple case he will see t=
his
result.=A0 Now this is not acceptable for our case.<br><br>The proposed sol=
ution is that we do the following:<br><br>Document:<br>uw-reference =3D HEL=
LO<br>uw-reference =3D BYE<br><br>With additional field like<br><br>uw-uwa =
=3D HELLO<br>

uw-uwb =3D BYE<br><br>So when UWB performs a search of &quot;HELLO&quot; th=
ere will be an additional filter applied which would be like &quot;uw-uwb:H=
ELLO&quot; so the final query would be like:<br><br>uw-reference:HELLO + (u=
w-uwb:HELLO) (approximately)<br>

<br>Th<br><br>I created a test case to test this solution and it works. The=
 problem is that if UWB searches for &quot;HELLO&quot; that exists in anoth=
er field such as:<br>data:HELLO then he should get a result. It&#39;s only =
when the query is matched on reference he should not see anything.=A0 My te=
stcase fails when the match is made on the data field as the security filte=
r does not pass (valid filter).=A0 Is there a way around this?=A0 Hope this=
 made sense!<br>

<br>Any advice would be highly appreciated<br></span>
</blockquote></div><br></div>

--0016e6de001372ae8f0472bd43df--

--0016e6de001372ae980472bd43e1
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--0016e6de001372ae980472bd43e1--

From java-user-return-42164-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 09:40:05 2009
Return-Path: <java-user-return-42164-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80354 invoked from network); 4 Sep 2009 09:40:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 09:40:04 -0000
Received: (qmail 84146 invoked by uid 500); 4 Sep 2009 09:40:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84072 invoked by uid 500); 4 Sep 2009 09:40:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84061 invoked by uid 99); 4 Sep 2009 09:40:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:40:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [202.86.5.92] (HELO smtp105.mail.in.yahoo.com) (202.86.5.92)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 04 Sep 2009 09:39:49 +0000
Received: (qmail 56402 invoked from network); 4 Sep 2009 09:39:26 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=pKfo0+fOTF+1RQcnsdzWMnGeGF+UTp//3wUj65USFKrCIufvTLimLq2TsXn7q7JYGflE06bb9u2vcc4T+stKbaJDSm/WcpbEYst6glK8lwwDauOTaf5h6HgfjgbxcmRkpyYfZU56w969rCty9VELHl5B9A2DYbxOM2h7jB2dizc=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp105.mail.in.yahoo.com with SMTP; 4 Sep 2009 09:39:26 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: 0gAmR3IVM1mNI4LzHhwHw5Shm0Ss6V9xLb3o1iYh_m8kme5EMJt8MPf91VmYRvkmzpzaUVEdhxdrql4cYtwMTgNPl.2C59gylK0TMdy9UKHqxBTO0oGvHSUTonEuDOGNHY1XaVnbfW.l06cNFhlWjpR1uCpLhjQb.hPwEqT.CgpE4YS4MtOF.IOOvbY-
X-Yahoo-Newman-Property: ymail-3
Message-ID: <002d01ca2d43$9837c150$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com> <56868BB9D33F495591AAB653D8EDDB1B@VEGA> <002401ca2d32$2f2d19a0$710bc30a@sv.us.sonicwall.com> <07E1D9132E514DEF99909ED72A299B9D@VEGA>
Subject: Re: too many file descriptors opened by Lucene shows (deleted) in /proc 
Date: Fri, 4 Sep 2009 15:09:24 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

I doing the following way.

if (!reader.isCurrent()) {
//reOpen=20
}

I tried debugging and my log shows the correct reference count. Any =
other idea?

Regards
Ganesh

----- Original Message -----=20
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
Sent: Friday, September 04, 2009 1:12 PM
Subject: RE: too many file descriptors opened by Lucene shows (deleted) =
in /proc=20


> One general trap with reopen(): Reopen() returns a *new* IndexReader. =
If
> this new IndexReader is different from the actual one, you have to =
close the
> old reader when you are finished working on it. If you only have one =
thread
> working on this IndexReader that is reopened, you can close the old =
reader
> directly after reopening:
>=20
> IndexReader new =3D actualReader.reopen();
> if (new !=3D actualReader) {
> actualReader.close();
> actualReader =3D new;
> }
>=20
> If you have some multithreaded architecture, you have to keep the old =
reader
> open as long as there are accesses (which you can manage by =
refcounting).
>=20
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>=20
>> -----Original Message-----
>> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> Sent: Friday, September 04, 2009 9:35 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: too many file descriptors opened by Lucene shows =
(deleted) in
>> /proc
>>=20
>> I am having only one process using Lucene DB. The same process writes =
and
>> reads. I do re-open indexreader. I am maintaing ref count for each
>> reader/searcher and closing it if it is not used. I am not able to
>> understand, why the file descriptor is showing as (deleted)?
>>=20
>> I guessing some issues? Could any one tell me what are the other part =
of
>> code to look in to (related to Lucene)? Any other way to identify the =
root
>> cause?
>>=20
>> Regards
>> Ganesh
>>=20
>>=20
>> ----- Original Message -----
>> From: "Uwe Schindler" <uwe@thetaphi.de>
>> To: <java-user@lucene.apache.org>
>> Sent: Friday, September 04, 2009 11:56 AM
>> Subject: RE: too many file descriptors opened by Lucene shows =
(deleted) in
>> /proc
>>=20
>>=20
>> > This is normal. When you open an IndexReader/IndexSearcher, it =
opens
>> various
>> > file handles. If you additionally update/add/delete documents in
>> parallel
>> > (even in other process), or optimize the index, the original =
IndexReader
>> > stays on using the "old" state of the index. IndexWriter deletes =
some
>> files,
>> > but IndexReader still have them open (this is our segment based
>> > "transaction" handling of IndexWriter). If you reopen your =
IndexReader
>> to
>> > get the last updates of the underlying index, these "deleted" files =
will
>> > disappear, as they can be closed. As long as they are open, they
>> disappear
>> > from directory listing, but they still consume space on disk =
(because
>> they
>> > are still used). This is why you see this deleted files.
>> >
>> > -----
>> > Uwe Schindler
>> > H.-H.-Meier-Allee 63, D-28213 Bremen
>> > http://www.thetaphi.de
>> > eMail: uwe@thetaphi.de
>> >
>> >> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> >> Sent: Friday, September 04, 2009 8:11 AM
>> >> To: java-user@lucene.apache.org
>> >> Subject: too many file descriptors opened by Lucene shows =
(deleted) in
>> >> /proc
>> >>
>> >> Hello all,
>> >>
>> >> In my linux pc, there are too many fd counts for lucene database.
>> >> /proc/<processid>/fd shows very big list. I have provided sample =
below.
>> >>
>> >> lr-x------    1 root     root           64 Sep  3 17:02 360 ->
>> >> /opt/ganesh/lucenedb/_2w5.tvf (deleted)
>> >> lr-x------    1 root     root           64 Sep  3 17:02 361 ->
>> >> /opt/ganesh/lucenedb/_hr.frq (deleted)
>> >> lr-x------    1 root     root           64 Sep  3 17:02 362 ->
>> >> /opt/ganesh/lucenedb/_hr.prx (deleted)
>> >> lr-x------    1 root     root           64 Sep  3 17:02 363 ->
>> >> /opt/ganesh/lucenedb/_hr.tvx (deleted)
>> >> lr-x------    1 root     root           64 Sep  3 21:01 364 ->
>> >> /opt/ganesh/lucenedb/_hr.tvd (deleted)
>> >> lr-x------    1 root     root           64 Sep  3 17:02 365 ->
>> >> /opt/ganesh/lucenedb/_hr.tvf (deleted)
>> >> lr-x------    1 root     root           64 Sep  3 17:02 366 ->
>> >> /opt/ganesh/lucenedb/_2w4.fdt (deleted)
>> >> lr-x------    1 root     root           64 Sep  3 17:02 367 ->
>> >> /opt/ganesh/lucenedb/_2w4.fdx (deleted)
>> >>
>> >> These files not exist in the disk but why it is showing as =
(deleted) in
>> >> the /proc. This means the process is still holding the fd. Please
>> provide
>> >> me more information on this. I am using Fedora Linux, ext-3 file
>> system,
>> >> Lucene 2.4.1.
>> >>
>> >> Regards
>> >> Ganesh
>> >> Send instant messages to your online friends
>> http://in.messenger.yahoo.com
>> >>
>> >> =
---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> >
>> > =
---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> Send instant messages to your online friends =
http://in.messenger.yahoo.com
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42165-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 09:48:27 2009
Return-Path: <java-user-return-42165-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82884 invoked from network); 4 Sep 2009 09:48:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 09:48:27 -0000
Received: (qmail 99186 invoked by uid 500); 4 Sep 2009 09:48:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99128 invoked by uid 500); 4 Sep 2009 09:48:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99118 invoked by uid 99); 4 Sep 2009 09:48:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:48:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:48:14 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id B3A97D36008
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 11:47:53 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id R1tVl2DEu8l3 for <java-user@lucene.apache.org>;
	Fri,  4 Sep 2009 11:47:45 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.75])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 7C5ADD36001
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 11:47:45 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com> <56868BB9D33F495591AAB653D8EDDB1B@VEGA> <002401ca2d32$2f2d19a0$710bc30a@sv.us.sonicwall.com> <07E1D9132E514DEF99909ED72A299B9D@VEGA> <002d01ca2d43$9837c150$710bc30a@sv.us.sonicwall.com>
Subject: RE: too many file descriptors opened by Lucene shows (deleted) in /proc 
Date: Fri, 4 Sep 2009 11:47:43 +0200
Message-ID: <0F1111CE57AE406BAD4794E43A791CF6@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <002d01ca2d43$9837c150$710bc30a@sv.us.sonicwall.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: AcotQ7QI+iiE6YHSTT6ALMoiyaO45gAAN2UA
X-Virus-Checked: Checked by ClamAV on apache.org

Yes you are doing the reopen right, but my question was: in your code "//
reOpen", which is not visible, do you close the old reader after reopen? If
you do not do this, it stays open forever. This is what I suggested by my
example.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Ganesh [mailto:emailgane@yahoo.co.in]
> Sent: Friday, September 04, 2009 11:39 AM
> To: java-user@lucene.apache.org
> Subject: Re: too many file descriptors opened by Lucene shows (deleted) in
> /proc
> 
> I doing the following way.
> 
> if (!reader.isCurrent()) {
> //reOpen
> }
> 
> I tried debugging and my log shows the correct reference count. Any other
> idea?
> 
> Regards
> Ganesh
> 
> ----- Original Message -----
> From: "Uwe Schindler" <uwe@thetaphi.de>
> To: <java-user@lucene.apache.org>
> Sent: Friday, September 04, 2009 1:12 PM
> Subject: RE: too many file descriptors opened by Lucene shows (deleted) in
> /proc
> 
> 
> > One general trap with reopen(): Reopen() returns a *new* IndexReader. If
> > this new IndexReader is different from the actual one, you have to close
> the
> > old reader when you are finished working on it. If you only have one
> thread
> > working on this IndexReader that is reopened, you can close the old
> reader
> > directly after reopening:
> >
> > IndexReader new = actualReader.reopen();
> > if (new != actualReader) {
> > actualReader.close();
> > actualReader = new;
> > }
> >
> > If you have some multithreaded architecture, you have to keep the old
> reader
> > open as long as there are accesses (which you can manage by
> refcounting).
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> >> -----Original Message-----
> >> From: Ganesh [mailto:emailgane@yahoo.co.in]
> >> Sent: Friday, September 04, 2009 9:35 AM
> >> To: java-user@lucene.apache.org
> >> Subject: Re: too many file descriptors opened by Lucene shows (deleted)
> in
> >> /proc
> >>
> >> I am having only one process using Lucene DB. The same process writes
> and
> >> reads. I do re-open indexreader. I am maintaing ref count for each
> >> reader/searcher and closing it if it is not used. I am not able to
> >> understand, why the file descriptor is showing as (deleted)?
> >>
> >> I guessing some issues? Could any one tell me what are the other part
> of
> >> code to look in to (related to Lucene)? Any other way to identify the
> root
> >> cause?
> >>
> >> Regards
> >> Ganesh
> >>
> >>
> >> ----- Original Message -----
> >> From: "Uwe Schindler" <uwe@thetaphi.de>
> >> To: <java-user@lucene.apache.org>
> >> Sent: Friday, September 04, 2009 11:56 AM
> >> Subject: RE: too many file descriptors opened by Lucene shows (deleted)
> in
> >> /proc
> >>
> >>
> >> > This is normal. When you open an IndexReader/IndexSearcher, it opens
> >> various
> >> > file handles. If you additionally update/add/delete documents in
> >> parallel
> >> > (even in other process), or optimize the index, the original
> IndexReader
> >> > stays on using the "old" state of the index. IndexWriter deletes some
> >> files,
> >> > but IndexReader still have them open (this is our segment based
> >> > "transaction" handling of IndexWriter). If you reopen your
> IndexReader
> >> to
> >> > get the last updates of the underlying index, these "deleted" files
> will
> >> > disappear, as they can be closed. As long as they are open, they
> >> disappear
> >> > from directory listing, but they still consume space on disk (because
> >> they
> >> > are still used). This is why you see this deleted files.
> >> >
> >> > -----
> >> > Uwe Schindler
> >> > H.-H.-Meier-Allee 63, D-28213 Bremen
> >> > http://www.thetaphi.de
> >> > eMail: uwe@thetaphi.de
> >> >
> >> >> From: Ganesh [mailto:emailgane@yahoo.co.in]
> >> >> Sent: Friday, September 04, 2009 8:11 AM
> >> >> To: java-user@lucene.apache.org
> >> >> Subject: too many file descriptors opened by Lucene shows (deleted)
> in
> >> >> /proc
> >> >>
> >> >> Hello all,
> >> >>
> >> >> In my linux pc, there are too many fd counts for lucene database.
> >> >> /proc/<processid>/fd shows very big list. I have provided sample
> below.
> >> >>
> >> >> lr-x------    1 root     root           64 Sep  3 17:02 360 ->
> >> >> /opt/ganesh/lucenedb/_2w5.tvf (deleted)
> >> >> lr-x------    1 root     root           64 Sep  3 17:02 361 ->
> >> >> /opt/ganesh/lucenedb/_hr.frq (deleted)
> >> >> lr-x------    1 root     root           64 Sep  3 17:02 362 ->
> >> >> /opt/ganesh/lucenedb/_hr.prx (deleted)
> >> >> lr-x------    1 root     root           64 Sep  3 17:02 363 ->
> >> >> /opt/ganesh/lucenedb/_hr.tvx (deleted)
> >> >> lr-x------    1 root     root           64 Sep  3 21:01 364 ->
> >> >> /opt/ganesh/lucenedb/_hr.tvd (deleted)
> >> >> lr-x------    1 root     root           64 Sep  3 17:02 365 ->
> >> >> /opt/ganesh/lucenedb/_hr.tvf (deleted)
> >> >> lr-x------    1 root     root           64 Sep  3 17:02 366 ->
> >> >> /opt/ganesh/lucenedb/_2w4.fdt (deleted)
> >> >> lr-x------    1 root     root           64 Sep  3 17:02 367 ->
> >> >> /opt/ganesh/lucenedb/_2w4.fdx (deleted)
> >> >>
> >> >> These files not exist in the disk but why it is showing as (deleted)
> in
> >> >> the /proc. This means the process is still holding the fd. Please
> >> provide
> >> >> me more information on this. I am using Fedora Linux, ext-3 file
> >> system,
> >> >> Lucene 2.4.1.
> >> >>
> >> >> Regards
> >> >> Ganesh
> >> >> Send instant messages to your online friends
> >> http://in.messenger.yahoo.com
> >> >>
> >> >> --------------------------------------------------------------------
> -
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >> >
> >> > ---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> Send instant messages to your online friends
> http://in.messenger.yahoo.com
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> Send instant messages to your online friends http://in.messenger.yahoo.com
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42166-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 09:54:14 2009
Return-Path: <java-user-return-42166-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84414 invoked from network); 4 Sep 2009 09:54:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 09:54:13 -0000
Received: (qmail 9071 invoked by uid 500); 4 Sep 2009 09:54:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8984 invoked by uid 500); 4 Sep 2009 09:54:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8974 invoked by uid 99); 4 Sep 2009 09:54:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:54:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of francisco.borges@gmail.com designates 209.85.211.194 as permitted sender)
Received: from [209.85.211.194] (HELO mail-yw0-f194.google.com) (209.85.211.194)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 09:54:03 +0000
Received: by ywh32 with SMTP id 32so1331011ywh.11
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 02:53:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=knaQbF5JB422iQ+svh6/40fMSpW76cqwuYfmfLi8dME=;
        b=cdgaJJpJ4UcQv6OWvUyxQR+YRphq+rtCjfBvEPwcycXddUZxWhHshZu5yJ+vZg9/9u
         vL2wHoCW5qv17mpGjCunUathWNzRDn7DR4UnLYAG2PvzS4sMjw1/TupMMuao2qUht6er
         5a7w06X3tLL4+AbMJInc/xq5YrLwTbKgB7nJg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=Ns15YJjU9xcQBDfe6u1ALX6r2LT8AxP8IsB2fRbNvBkJWCGGf+dqrcCzLBDN+kc/sc
         Kc76m7gUKvztd/qaQlnWeVUqkh1wAifsOXlcUmf3YLkxlGvTldyX8u7D3IHefFVoeMxj
         V17nkBw21jlvt2RsBhOE2a3mFBmNq7sISXexQ=
MIME-Version: 1.0
Received: by 10.91.39.9 with SMTP id r9mr8038968agj.61.1252058022467; Fri, 04 
	Sep 2009 02:53:42 -0700 (PDT)
Date: Fri, 4 Sep 2009 11:53:42 +0200
Message-ID: <f950edef0909040253k2f5fa18dm9f3b5bfec23e7dd9@mail.gmail.com>
Subject: how can I merge indexes without deleting the original index?
From: Francisco Borges <francisco.borges@gmail.com>
To: lucene user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Hello everyone,

As I understood it, merging indexes will lead to the deletion of the
original indexes.

Is there a way to merge indexes while keeping the original indexes intact?

Kind regards,
-- 
Francisco

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42167-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 10:34:47 2009
Return-Path: <java-user-return-42167-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95072 invoked from network); 4 Sep 2009 10:34:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 10:34:46 -0000
Received: (qmail 57105 invoked by uid 500); 4 Sep 2009 10:34:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57026 invoked by uid 500); 4 Sep 2009 10:34:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57016 invoked by uid 99); 4 Sep 2009 10:34:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 10:34:44 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 10:34:33 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n84AY9vl025799
	for <java-user@lucene.apache.org>; Fri, 4 Sep 2009 11:34:09 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Fri, 04 Sep 2009 11:34:09 +0100 (BST)
Date: Fri, 4 Sep 2009 11:34:09 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <821717001.23001252060449019.JavaMail.root@mail.uk.scalix.com>
In-Reply-To: <A78DC107-68AA-4737-8E41-F558D3538CB3@apache.org>
Subject: RE: New "Stream closed" exception with Java 6
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Hi Grant

> Seems like something is closing your InputStreamReader out from under y=
ou.=20
> Is there a concurrency issue, perhaps?

I'm coming to the same conclusion - there must be >1 threads accessing th=
is index at the same time.  Better go figure it out  ...  :-)

Thanks again

- Chris

Chris Bamford
Senior Development Engineer
Scalix
chris.bamford@scalix.com
Tel: +44 (0)1344 381814
www.scalix.com



----- Original Message -----
From: Grant Ingersoll <gsingers@apache.org>
Sent: Thu, 3/9/2009 2:59pm
To: java-user@lucene.apache.org
Subject: Re: New "Stream closed" exception with Java 6


On Sep 2, 2009, at 7:45 AM, Chris Bamford wrote:

> Hi Grant,
>
> I have now followed Daniel's advice and catch the exception with:
>
>    try {
>        indexWriter.addDocument(doc);

What does your Document/Field creation code look like?  In other =20
words, how do you construct doc?  Seems like something is closing your =20
InputStreamReader out from under you.  Is there a concurrency issue, =20
perhaps?


>    } catch (CorruptIndexException ex) {
>        throw new IndexerException ("CorruptIndexException on doc: " =20
> + doc.toString(), ex);
>    } catch (IOException ex) {
>        throw new IndexerException ("*IOException* on doc: " + =20
> doc.toString(), ex);
>    }
>
> The result now appears as:
>
> 2009-09-02 10:14:24,014 ERROR [QueueManager] =20
> [BatchUpdater.processMods:183] Failed to add content document(s) for =20
> user 0bb00000daaa2864-9.0.61.271 =20
> com.scalix.index.api.IndexerException: *IOException* on doc: =20
> Document<indexed,tokenized<return-path:christian.sholtz@scalix.com> =20
> indexed,tokenized<received:from scalixmail.scalix.com (localhost =20
> [127.0.0.1])
>        by scalixmail.scalix.com (8.13.6/8.13.6/SuSE Linux 0.8) with =20
> ESMTP id m0F9545p008012;
>        Tue, 15 Jan 2008 04:05:05 -0500> =20
> indexed,tokenized<received:from [10.13.1.51] (scalixmail.scalix.com =20
> [172.16.0.9])
>    by scalixmail.scalix.com (Scalix SMTP Relay 11.3.0.11339)
>    via ESMTP; Tue, 15 Jan 2008 04:05:05 -0500 (EST)> indexed<CREATE-=20
> DATE:20080115090228> indexed,tokenized<date:Tue Jan 15 04:02:28 EST =20
> 2008>  indexed,tokenized<from:"Christian Sholtz" <christian.sholtz@scal=
ix.com=20
> >> indexed,tokenized<to:SIN - Robert Smith <Robert.Smi
> th@sin.co.at>> indexed,tokenized<cc:Patrick Lauria =20
> <patrick@scalix.com>> indexed<message-id:=20
> 478C76A4.2090600@scalix.com> indexed<in-reply-=20
> to:H000007b0031e9f3.1200380510.scalix.sin.co.at@MHS> =20
> indexed<references:H000007b0031e9f3.1200380510.scalix.sin.co.at@MHS> =20
> indexed,tokenized<subject:
> Re: AW: Lead Landwirtschaftskammer K=C3=A4rnten -> Smith> =20
> indexed,tokenized<autoforwarded:FALSE> =20
> indexed,tokenized<importance:Normal> =20
> indexed,tokenized<priority:Normal> =20
> indexed,tokenized<sensitivity:Normal> indexed,tokenized<x-msmail-=20
> priority:Medium> indexed,tokenized<x-priority:3> indexed<x-scalix-=20
> autoreplied:FALSE> indexed,tokenized<user-agent:Thunderbird 2.0.0.9 =20
> (Windows/20071031)> indexed,tokenized<x-spam-status:No, score=3D-1.3 =20
> required=3D5.0 tests=3DAWL,BAYES_00,
>        SUBJECT_ENCODED_TWICE autolearn=3Dno version=3D3.1.8> =20
> indexed,tokenized<x-spam-checker-version:SpamAssassin 3.1.8 =20
> (2007-02-13) on
>        scalixmail.scalix.com> indexed,tokenized<x-mime-=20
> autoconverted:from 8bit to quoted-printable by scalixmail.scalix.com =20
> id m0F9545p00801
> 2> indexed,tokenized<mime-version:1.0> indexed<SIZE-KBYTES:=20
> 0000000006> indexed<DELIVERY-DATE:20080115090509> =20
> indexed,tokenized<x-scalix-internaldate:Tue Jan 15 04:05:09 EST =20
> 2008> indexed<x-scalix-has-attach:FALSE> indexed,tokenized<content-=20
> type:text/plain;
>        charset=3D"ISO-8859-1";
>        format=3D"flowed"> indexed,tokenized<content-transfer-=20
> encoding:quoted-printable> indexed,tokenized<content-=20
> disposition:inline> indexed<CONTENT-TYPE:text/plain> =20
> indexed,tokenized<BODY:java.io.InputStreamReader@75b940> indexed<x-=20
> scalix-class:IPM.Note> indexed<MSG-TYPE:email> stored/=20
> uncompressed,indexed<INDEXID:90010ac-4682aaad-478c7745-2ee4ab>>
>        at com.scalix.index.manager.BatchUpdater.performContentAdds=20
> (BatchUpdater.java:394)
>        at com.scalix.index.manager.BatchUpdater.processMods=20
> (BatchUpdater.java:179)
>        at com.scalix.index.manager.QueueManager.processQueue=20
> (QueueManager.java:134)
>        at com.scalix.index.manager.QueueManager.run=20
> (QueueManager.java:81)
>        at java.lang.Thread.run(Unknown Source)
> Caused by: java.io.IOException: Stream closed
>        at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>        at sun.nio.cs.StreamDecoder.read(Unknown Source)
>        at java.io.InputStreamReader.read(Unknown Source)
>        at =20
> org.apache.lucene.analysis.standard.StandardTokenizerImpl.zzRefill=20
> (StandardTokenizerImpl.java:443)
>        at =20
> org.apache.lucene.analysis.standard.StandardTokenizerImpl.getNextToken=20
> (StandardTokenizerImpl.java:629)
>        at org.apache.lucene.analysis.standard.StandardTokenizer.next=20
> (StandardTokenizer.java:140)
>        at org.apache.lucene.analysis.standard.StandardFilter.next=20
> (StandardFilter.java:43)
>        at org.apache.lucene.analysis.LowerCaseFilter.next=20
> (LowerCaseFilter.java:34)
>        at org.apache.lucene.analysis.snowball.SnowballFilter.next=20
> (SnowballFilter.java:64)
>        at org.apache.lucene.index.DocInverterPerField.processFields=20
> (DocInverterPerField.java:134)
>        at =20
> org.apache.lucene.index.DocFieldConsumersPerField.processFields=20
> (DocFieldConsumersPerField.java:36)
>        at =20
> org.apache.lucene.index.DocFieldProcessorPerThread.processDocument=20
> (DocFieldProcessorPerThread.java:234)
>        at org.apache.lucene.index.DocumentsWriter.updateDocument=20
> (DocumentsWriter.java:765)
>        at org.apache.lucene.index.DocumentsWriter.addDocument=20
> (DocumentsWriter.java:743)
>        at org.apache.lucene.index.IndexWriter.addDocument=20
> (IndexWriter.java:1902)
>        at org.apache.lucene.index.IndexWriter.addDocument=20
> (IndexWriter.java:1880)
>        at com.scalix.index.manager.BatchUpdater.performContentAdds=20
> (BatchUpdater.java:390)
>        ... 4 more
>
> Does this help?
>
> Thanks,
>
> - Chris
>
>
>
> ----- Original Message -----
> From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
> Sent: Tue, 1/9/2009 10:52pm
> To: java-user@lucene.apache.org
> Subject: Re: New "Stream closed" exception with Java 6
>
> I think you should do this instead (it will print the exception =20
> message
> *and* the stack trace instead of only the message) :
>
> throw new IndexerException ("CorruptIndexException on doc: " + =20
> doc.toString(), ex);
>
> Daniel Shane
>
> Chris Bamford wrote:
>> Hi Grant,
>>
>>
>>>> I think you code there needs to show the underlying exception, =20
>>>> too, so
>>>> we can see that stack trace.
>>>>
>>
>> Ummm... isn't this code already doing that?  What am I missing?
>>
>>            try {
>>
>>                indexWriter.addDocument(doc);
>>
>>            } catch (CorruptIndexException ex) {
>>
>>                throw new IndexerException ("CorruptIndexException =20
>> on doc: " + doc.toString() +
>>
>>                    " - " + ex.toString());
>>
>>            } catch (IOException ex) {
>>
>>                throw new IndexerException ("IOException on doc: " + =20
>> doc.toString() +
>>
>>                    " - " + ex.toString());
>>
>>            }
>>
>> Thanks,
>>
>> - Chris
>>
>> Chris Bamford
>> Senior Development Engineer
>> Scalix
>> chris.bamford@scalix.com
>> Tel: +44 (0)1344 381814
>> www.scalix.com
>>
>>
>>
>> ----- Original Message -----
>> From: Grant Ingersoll <gsingers@apache.org>
>> Sent: Sat, 29/8/2009 12:00pm
>> To: java-user@lucene.apache.org
>> Subject: Re: New "Stream closed" exception with Java 6
>>
>> I think you code there needs to show the underlying exception, too, =20
>> so
>> we can see that stack trace.
>>
>> -Grant
>>
>> On Aug 28, 2009, at 11:47 AM, Chris Bamford wrote:
>>
>>
>>> Hi Grant
>>>
>>> Please see attached.
>>>
>>> Thanks,
>>>
>>> - Chris
>>>
>>>
>>> ----- Original Message -----
>>> From: Grant Ingersoll <gsingers@apache.org>
>>> Sent: Fri, 28/8/2009 1:26pm
>>> To: java-user@lucene.apache.org
>>> Subject: Re: New "Stream closed" exception with Java 6
>>>
>>> Are there any log messages around that spot?  Did something happen =20
>>> to
>>> the underlying Reader you are using?  Can you share that little =20
>>> bit of
>>> indexing code?
>>>
>>> On Aug 27, 2009, at 10:11 AM, Chris Bamford wrote:
>>>
>>>
>>>> Hi,
>>>>
>>>> Since moving our app to Java 6 and Tomcat 6, we have started =20
>>>> getting
>>>> occasional exceptions of the form:
>>>>
>>>> java.io.IOException: Stream closed
>>>>  at sun.nio.cs.StreamDecoder.ensureOpen(Unknown Source)
>>>>  at sun.nio.cs.StreamDecoder.read(Unknown Source)
>>>>  at java.io.InputStreamReader.read(Unknown Source)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .analysis
>>>> .standard.StandardTokenizerImpl.zzRefill=20
>>>> (StandardTokenizerImpl.java:
>>>> 443)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .analysis
>>>> .standard
>>>> .StandardTokenizerImpl.getNextToken(StandardTokenizerImpl.java:629)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .analysis.standard.StandardTokenizer.next(StandardTokenizer.java:=20
>>>> 140)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene.analysis.standard.StandardFilter.next(StandardFilter.java:=20
>>>> 43)
>>>>  at
>>>> org.apache.lucene.analysis.LowerCaseFilter.next=20
>>>> (LowerCaseFilter.java:
>>>> 34)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene.analysis.snowball.SnowballFilter.next(SnowballFilter.java:=20
>>>> 64)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .index.DocInverterPerField.processFields(DocInverterPerField.java:
>>>> 134)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .index
>>>> .DocFieldConsumersPerField
>>>> .processFields(DocFieldConsumersPerField.java:36)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene
>>>> .index
>>>> .DocFieldProcessorPerThread
>>>> .processDocument(DocFieldProcessorPerThread.java:234)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:
>>>> 765)
>>>>  at
>>>> org
>>>> .apache
>>>> .lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:743)
>>>>  at
>>>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:
>>>> 1902)
>>>>  at
>>>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:
>>>> 1880)
>>>>  at
>>>> com
>>>> .scalix
>>>> .index.manager.BatchUpdater.performContentAdds(BatchUpdater.java:=20
>>>> 386)
>>>>  at
>>>> com.scalix.index.manager.BatchUpdater.processMods=20
>>>> (BatchUpdater.java:
>>>> 176)
>>>>  at
>>>> com.scalix.index.manager.QueueManager.processQueue=20
>>>> (QueueManager.java:
>>>> 134)
>>>>  at com.scalix.index.manager.QueueManager.run(QueueManager.java:81)
>>>>  at java.lang.Thread.run(Unknown Source)
>>>>
>>>> We are using Lucene 2.4.  Any ideas what is happening?
>>>>
>>>> Thanks!
>>>>
>>>> - Chris
>>>>
>>>> --------------------------------------------------------------------=
-
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>> --------------------------
>>> Grant Ingersoll
>>> http://www.lucidimagination.com/
>>>
>>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
>>> using Solr/Lucene:
>>> http://www.lucidimagination.com/search
>>>
>>>
>>> ---------------------------------------------------------------------=

>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>> <lucene_msg.txt>
>>> ---------------------------------------------------------------------=

>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>>
>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)
>> using Solr/Lucene:
>> http://www.lucidimagination.com/search
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) =20
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42168-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 12:48:26 2009
Return-Path: <java-user-return-42168-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42482 invoked from network); 4 Sep 2009 12:48:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 12:48:26 -0000
Received: (qmail 96667 invoked by uid 500); 4 Sep 2009 12:48:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96568 invoked by uid 500); 4 Sep 2009 12:48:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96558 invoked by uid 99); 4 Sep 2009 12:48:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 12:48:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.93] (HELO smtp106.mail.in.yahoo.com) (202.86.5.93)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 04 Sep 2009 12:48:12 +0000
Received: (qmail 61203 invoked from network); 4 Sep 2009 12:47:49 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=1tqEqNnGDPLcGbLpa8PGlgdEVkZCpyhzCvyDggUEihL2m1tPvQXgADJeh1JIaFHzQt2DgZsuGS0F37AZWR93mUQ47rPoQ2U/RE5n8GIxhqRE2as0Pl3cUZHVEJfuKpap/WqxrSvWPsmfLKO27gNLcLEpz5x1CXt4IJgjPLSUshc=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp106.mail.in.yahoo.com with SMTP; 4 Sep 2009 12:47:48 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: QKH2MhcVM1kj83eXMduwo4pwobrjG_PP2VLhir.P5.UjUciP7eyDrRG6taR8S17FDqZ2nxBLLh0Pa5mFbWoYFJBt72fktbxt0Jd0eIdk3ShNhXiOAs7YMwkXiEq1perME6Gggunt7A.hjLiC3aZm0Xz9XPFeqORi7UbQL6AkaVttVGyEO29HHeoCMf0-
X-Yahoo-Newman-Property: ymail-3
Message-ID: <005c01ca2d5d$e86a75e0$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com> <56868BB9D33F495591AAB653D8EDDB1B@VEGA> <002401ca2d32$2f2d19a0$710bc30a@sv.us.sonicwall.com> <07E1D9132E514DEF99909ED72A299B9D@VEGA> <002d01ca2d43$9837c150$710bc30a@sv.us.sonicwall.com> <0F1111CE57AE406BAD4794E43A791CF6@VEGA>
Subject: Re: too many file descriptors opened by Lucene shows (deleted) in /proc 
Date: Fri, 4 Sep 2009 18:17:46 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

I am closing the readers when not in use.=20

I tried testing explicitly not closing the reader and found that the =
file is not actually deleted and it remains in the disk. I remeber =
reading this information. In my case, readers and searchers are closed =
and the files are not existing in disk but /proc shows many fds with =
(deleted).

Regards
Ganesh=20


----- Original Message -----=20
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
Sent: Friday, September 04, 2009 3:17 PM
Subject: RE: too many file descriptors opened by Lucene shows (deleted) =
in /proc=20


> Yes you are doing the reopen right, but my question was: in your code =
"//
> reOpen", which is not visible, do you close the old reader after =
reopen? If
> you do not do this, it stays open forever. This is what I suggested by =
my
> example.
>=20
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>=20
>> -----Original Message-----
>> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> Sent: Friday, September 04, 2009 11:39 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: too many file descriptors opened by Lucene shows =
(deleted) in
>> /proc
>>=20
>> I doing the following way.
>>=20
>> if (!reader.isCurrent()) {
>> //reOpen
>> }
>>=20
>> I tried debugging and my log shows the correct reference count. Any =
other
>> idea?
>>=20
>> Regards
>> Ganesh
>>=20
>> ----- Original Message -----
>> From: "Uwe Schindler" <uwe@thetaphi.de>
>> To: <java-user@lucene.apache.org>
>> Sent: Friday, September 04, 2009 1:12 PM
>> Subject: RE: too many file descriptors opened by Lucene shows =
(deleted) in
>> /proc
>>=20
>>=20
>> > One general trap with reopen(): Reopen() returns a *new* =
IndexReader. If
>> > this new IndexReader is different from the actual one, you have to =
close
>> the
>> > old reader when you are finished working on it. If you only have =
one
>> thread
>> > working on this IndexReader that is reopened, you can close the old
>> reader
>> > directly after reopening:
>> >
>> > IndexReader new =3D actualReader.reopen();
>> > if (new !=3D actualReader) {
>> > actualReader.close();
>> > actualReader =3D new;
>> > }
>> >
>> > If you have some multithreaded architecture, you have to keep the =
old
>> reader
>> > open as long as there are accesses (which you can manage by
>> refcounting).
>> >
>> > -----
>> > Uwe Schindler
>> > H.-H.-Meier-Allee 63, D-28213 Bremen
>> > http://www.thetaphi.de
>> > eMail: uwe@thetaphi.de
>> >
>> >> -----Original Message-----
>> >> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> >> Sent: Friday, September 04, 2009 9:35 AM
>> >> To: java-user@lucene.apache.org
>> >> Subject: Re: too many file descriptors opened by Lucene shows =
(deleted)
>> in
>> >> /proc
>> >>
>> >> I am having only one process using Lucene DB. The same process =
writes
>> and
>> >> reads. I do re-open indexreader. I am maintaing ref count for each
>> >> reader/searcher and closing it if it is not used. I am not able to
>> >> understand, why the file descriptor is showing as (deleted)?
>> >>
>> >> I guessing some issues? Could any one tell me what are the other =
part
>> of
>> >> code to look in to (related to Lucene)? Any other way to identify =
the
>> root
>> >> cause?
>> >>
>> >> Regards
>> >> Ganesh
>> >>
>> >>
>> >> ----- Original Message -----
>> >> From: "Uwe Schindler" <uwe@thetaphi.de>
>> >> To: <java-user@lucene.apache.org>
>> >> Sent: Friday, September 04, 2009 11:56 AM
>> >> Subject: RE: too many file descriptors opened by Lucene shows =
(deleted)
>> in
>> >> /proc
>> >>
>> >>
>> >> > This is normal. When you open an IndexReader/IndexSearcher, it =
opens
>> >> various
>> >> > file handles. If you additionally update/add/delete documents in
>> >> parallel
>> >> > (even in other process), or optimize the index, the original
>> IndexReader
>> >> > stays on using the "old" state of the index. IndexWriter deletes =
some
>> >> files,
>> >> > but IndexReader still have them open (this is our segment based
>> >> > "transaction" handling of IndexWriter). If you reopen your
>> IndexReader
>> >> to
>> >> > get the last updates of the underlying index, these "deleted" =
files
>> will
>> >> > disappear, as they can be closed. As long as they are open, they
>> >> disappear
>> >> > from directory listing, but they still consume space on disk =
(because
>> >> they
>> >> > are still used). This is why you see this deleted files.
>> >> >
>> >> > -----
>> >> > Uwe Schindler
>> >> > H.-H.-Meier-Allee 63, D-28213 Bremen
>> >> > http://www.thetaphi.de
>> >> > eMail: uwe@thetaphi.de
>> >> >
>> >> >> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> >> >> Sent: Friday, September 04, 2009 8:11 AM
>> >> >> To: java-user@lucene.apache.org
>> >> >> Subject: too many file descriptors opened by Lucene shows =
(deleted)
>> in
>> >> >> /proc
>> >> >>
>> >> >> Hello all,
>> >> >>
>> >> >> In my linux pc, there are too many fd counts for lucene =
database.
>> >> >> /proc/<processid>/fd shows very big list. I have provided =
sample
>> below.
>> >> >>
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 360 ->
>> >> >> /opt/ganesh/lucenedb/_2w5.tvf (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 361 ->
>> >> >> /opt/ganesh/lucenedb/_hr.frq (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 362 ->
>> >> >> /opt/ganesh/lucenedb/_hr.prx (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 363 ->
>> >> >> /opt/ganesh/lucenedb/_hr.tvx (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 21:01 364 ->
>> >> >> /opt/ganesh/lucenedb/_hr.tvd (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 365 ->
>> >> >> /opt/ganesh/lucenedb/_hr.tvf (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 366 ->
>> >> >> /opt/ganesh/lucenedb/_2w4.fdt (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 367 ->
>> >> >> /opt/ganesh/lucenedb/_2w4.fdx (deleted)
>> >> >>
>> >> >> These files not exist in the disk but why it is showing as =
(deleted)
>> in
>> >> >> the /proc. This means the process is still holding the fd. =
Please
>> >> provide
>> >> >> me more information on this. I am using Fedora Linux, ext-3 =
file
>> >> system,
>> >> >> Lucene 2.4.1.
>> >> >>
>> >> >> Regards
>> >> >> Ganesh
>> >> >> Send instant messages to your online friends
>> >> http://in.messenger.yahoo.com
>> >> >>
>> >> >> =
--------------------------------------------------------------------
>> -
>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> >> For additional commands, e-mail: =
java-user-help@lucene.apache.org
>> >> >
>> >> >
>> >> >
>> >> > =
---------------------------------------------------------------------
>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> > For additional commands, e-mail: =
java-user-help@lucene.apache.org
>> >> >
>> >> Send instant messages to your online friends
>> http://in.messenger.yahoo.com
>> >>
>> >> =
---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> >
>> > =
---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> Send instant messages to your online friends =
http://in.messenger.yahoo.com
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42169-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 13:07:43 2009
Return-Path: <java-user-return-42169-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51497 invoked from network); 4 Sep 2009 13:07:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 13:07:43 -0000
Received: (qmail 27678 invoked by uid 500); 4 Sep 2009 13:07:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27588 invoked by uid 500); 4 Sep 2009 13:07:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27577 invoked by uid 99); 4 Sep 2009 13:07:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 13:07:41 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 13:07:33 +0000
Received: by ewy22 with SMTP id 22so834426ewy.28
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 06:07:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=0UyM6tBzdHLIw+JRXskJuk89qJDwEV2MD6bJV06ipQg=;
        b=rikI+dhhPnYOuElOxr4G855rfkiZMnkk5DKWztfEJoJP2v5yZvrrbZ3Xewv0a7JQqc
         vpbsk2NwDGO3eNmHGHfa56APOwQgkJNXRGqOTCKdasOYfRJvZxeNitgFfcSHO+bEnUE2
         7Dg3SeXtNj589pG1aeKOm4BTvt+kY1CCViLAU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=YOqWm5SscwCC65Eu1guyDoUHiAZdUvtUrDCvfY2PxAbOyYoPSBms65G4MVYfyfK+yT
         OQvmlVSo57KPDhaGptv1ZJayo38aGr3b9Skk4i8ucQOcujy0aIpYa+WcweJ5fBG9AuXN
         MK6V0j9mxmxDrlDVOd7FBZjcg5fSOZlxPAzAo=
MIME-Version: 1.0
Received: by 10.216.19.68 with SMTP id m46mr849657wem.7.1252069631816; Fri, 04 
	Sep 2009 06:07:11 -0700 (PDT)
In-Reply-To: <6f4104d80909040238i877609ev65a2f284c07a99df@mail.gmail.com>
References: <6f4104d80909040217yd24a342t22232a9b4f217fbb@mail.gmail.com>
	 <6f4104d80909040238i877609ev65a2f284c07a99df@mail.gmail.com>
Date: Fri, 4 Sep 2009 14:07:11 +0100
Message-ID: <6f4104d80909040607n6b20616em562d1b9dc7e409a@mail.gmail.com>
Subject: Re: Filtering question/advice
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64c2718a375350472c02d9d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64c2718a375350472c02d9d
Content-Type: text/plain; charset=ISO-8859-1

Hi,

Apologies for resending this email but just wondering if I could get some
input on the below.  I am in the final stages of getting a proof of concept
together and this is the final piece of the puzzle.

Sorry again for sending this!

Cheers
Amin

On Fri, Sep 4, 2009 at 10:38 AM, Amin Mohammed-Coleman <aminmc@gmail.com>wrote:

> Hi
> I include a testcase to show what I am trying to do.  Testcase number 3
> fails.
>
> Thanks
> Amin
>
>
> On Fri, Sep 4, 2009 at 10:17 AM, Amin Mohammed-Coleman <aminmc@gmail.com>wrote:
>
>> Hi,
>>
>> I am looking at applying a security filter for our lucene document and I
>> was wondering if I could get feedback on whether the solution I have come up
>> with.  Firstly I will explain the scenario and followed by the proposed
>> solution:
>>
>>
>> We have a concept of a Layer which is a project whereby a broker can trade
>> with underwriters.  A layer can have more than one underwriter working on
>> this project therefore both underwriters can search for the same layer.  The
>> issue is the following:
>>
>> UWA signs business on a Layer L1 using a reference 'HELLO'
>>
>> UWB signs business on the same Layer L1 using a reference 'BYE'
>>
>> Both Underwriters are legitimately allowed to access the Layer L1 so the
>> security rules will not remove any search hits for L1. However, if UWB
>> searches for text 'HELLO' he should not get L1 in his search results as he
>> is not to know that L1 includes a writer reference HELLO for UWA. In the
>> simple case he will see this result.  Now this is not acceptable for our
>> case.
>>
>> The proposed solution is that we do the following:
>>
>> Document:
>> uw-reference = HELLO
>> uw-reference = BYE
>>
>> With additional field like
>>
>> uw-uwa = HELLO
>> uw-uwb = BYE
>>
>> So when UWB performs a search of "HELLO" there will be an additional
>> filter applied which would be like "uw-uwb:HELLO" so the final query would
>> be like:
>>
>> uw-reference:HELLO + (uw-uwb:HELLO) (approximately)
>>
>> Th
>>
>> I created a test case to test this solution and it works. The problem is
>> that if UWB searches for "HELLO" that exists in another field such as:
>> data:HELLO then he should get a result. It's only when the query is
>> matched on reference he should not see anything.  My testcase fails when the
>> match is made on the data field as the security filter does not pass (valid
>> filter).  Is there a way around this?  Hope this made sense!
>>
>> Any advice would be highly appreciated
>>
>
>

--0016e64c2718a375350472c02d9d--

From java-user-return-42170-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 13:35:26 2009
Return-Path: <java-user-return-42170-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61836 invoked from network); 4 Sep 2009 13:35:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 13:35:26 -0000
Received: (qmail 79250 invoked by uid 500); 4 Sep 2009 13:35:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79175 invoked by uid 500); 4 Sep 2009 13:35:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79165 invoked by uid 99); 4 Sep 2009 13:35:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 13:35:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.191 as permitted sender)
Received: from [209.85.223.191] (HELO mail-iw0-f191.google.com) (209.85.223.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 13:35:15 +0000
Received: by iwn29 with SMTP id 29so1648iwn.20
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 06:34:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=/0gMJ+IflK8nojSDuoELTA+tiRut1U8e19Hj719KWpQ=;
        b=F/uiww2H6vp95x8niXzHPBlqvlEYe5/f3FBfUBUAb5Gm3nLV6ATcmWfrxIGXUJI6aC
         eYFlezKRE95hgdukZ1kBA6bOIIrq5ezfkexu/a+NqUiH7geozS3GtFim/+pcp/uKv3X8
         eYerEignq+MO79FflumGB6QV4O3lPnJ4Z8hak=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=sPF+2qa28oEgItcNXgYrkO0bqynR/4LV0NO/VAxkfxwN24qafex+zatktuSdAQpvww
         FUfiBoynZlLJrBfOESzxL/OaWb/ke2hjBm9kOW0GPkIjad/R1tJ8WCXmzpyc5wovBAo9
         0fl0waSgUjqmpcxePNtuzn6z1b+EO+V4OYknI=
MIME-Version: 1.0
Received: by 10.231.42.81 with SMTP id r17mr9952164ibe.50.1252070813782; Fri, 
	04 Sep 2009 06:26:53 -0700 (PDT)
In-Reply-To: <f950edef0909040253k2f5fa18dm9f3b5bfec23e7dd9@mail.gmail.com>
References: <f950edef0909040253k2f5fa18dm9f3b5bfec23e7dd9@mail.gmail.com>
Date: Fri, 4 Sep 2009 09:26:52 -0400
Message-ID: <359a92830909040626o3e36412du7d4efb905fe9f27a@mail.gmail.com>
Subject: Re: how can I merge indexes without deleting the original index?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151773e45816f8290472c07415
X-Virus-Checked: Checked by ClamAV on apache.org

--00151773e45816f8290472c07415
Content-Type: text/plain; charset=ISO-8859-1

Sure, copy them first to some other directory <G>....
We might have something more helpful if you'd tell us *why* you want to do
this? What problem are you trying to solve? Because having two copies of
your index in the same directory doesn't sound very save.

Best
Erick

On Fri, Sep 4, 2009 at 5:53 AM, Francisco Borges <francisco.borges@gmail.com
> wrote:

> Hello everyone,
>
> As I understood it, merging indexes will lead to the deletion of the
> original indexes.
>
> Is there a way to merge indexes while keeping the original indexes intact?
>
> Kind regards,
> --
> Francisco
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00151773e45816f8290472c07415--

From java-user-return-42171-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 13:53:32 2009
Return-Path: <java-user-return-42171-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66913 invoked from network); 4 Sep 2009 13:53:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 13:53:32 -0000
Received: (qmail 19032 invoked by uid 500); 4 Sep 2009 13:53:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18960 invoked by uid 500); 4 Sep 2009 13:53:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18947 invoked by uid 99); 4 Sep 2009 13:53:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 13:53:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of shashi.mit@gmail.com designates 209.85.212.177 as permitted sender)
Received: from [209.85.212.177] (HELO mail-vw0-f177.google.com) (209.85.212.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 13:53:22 +0000
Received: by vws7 with SMTP id 7so720085vws.29
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 06:53:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=40Zb5X5q36859SjtACkpj6/BKWrIDV5OLYIHHJ27IvM=;
        b=A3SeeWPFGj6D6r1HFcqda6uNApnQOB8a/8cyMkVlvsafNOdQlH3+XNfkmXVM3LZChY
         TKRt992RNJlrJVfG1b0vCeSg0wLN0Uup2N0GSfH33sKfyNctgWIahBitSJGb1xrga+9g
         z9RfaxJEuYn2Ch59Qdeb+YKUEzpfhXPR4lIuM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=PVvEv8ade0mqDPHcqhh+L1LW2vGgxnqbBS7yiQ4hGapX/V9/CQTe489WSX0j0awnsM
         AB5bCFjXDb6JHuY1kqFEHtz6Dx5RGfLcr1nJgeeo4HRsH7cBjejJHdIEMIFcT2kkZTmq
         MJNph1w2F4IrSHZE2Z0iYe3/SiM4+NFpRb2Pg=
MIME-Version: 1.0
Received: by 10.150.81.13 with SMTP id e13mr18577448ybb.48.1252072379977; Fri, 
	04 Sep 2009 06:52:59 -0700 (PDT)
In-Reply-To: <359a92830909040626o3e36412du7d4efb905fe9f27a@mail.gmail.com>
References: <f950edef0909040253k2f5fa18dm9f3b5bfec23e7dd9@mail.gmail.com> 
	<359a92830909040626o3e36412du7d4efb905fe9f27a@mail.gmail.com>
From: Shashi Kant <shashi.mit@gmail.com>
Date: Fri, 4 Sep 2009 09:51:17 -0400
Message-ID: <4d19a3630909040651g7dda9f6dkdc61c22f9392b62a@mail.gmail.com>
Subject: Re: how can I merge indexes without deleting the original index?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Here is some code to help you along.  This should leave the source
indices intact and merges them into a destination.

                //the index to hold our merged index
                IndexWriter iw = new IndexWriter(dest, new
StandardAnalyzer(), true);

                string[] sourceIndices; //an array containing the sources
               // the directory containing the "source" indices
                foreach (string si in sourceindices)
                {
                    IndexReader r = IndexReader.Open(si);
                    iw.AddIndexes(new IndexReader[] { r });
                    r.Close();
                }

                iw.Optimize();
                iw.Close();

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42172-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 14:40:39 2009
Return-Path: <java-user-return-42172-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82094 invoked from network); 4 Sep 2009 14:40:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 14:40:39 -0000
Received: (qmail 8260 invoked by uid 500); 4 Sep 2009 14:40:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8201 invoked by uid 500); 4 Sep 2009 14:40:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8187 invoked by uid 99); 4 Sep 2009 14:40:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 14:40:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of francisco.borges@gmail.com designates 209.85.210.199 as permitted sender)
Received: from [209.85.210.199] (HELO mail-yx0-f199.google.com) (209.85.210.199)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 14:40:28 +0000
Received: by yxe37 with SMTP id 37so2557903yxe.5
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 07:40:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uZRZ4lk8T4BkCsu934vLsgq0dsEuk4fBYu+kAMfUzxY=;
        b=hEQa/pBE33QVUwddD67sMwXeDNO2OPgKqtjIAirbUbfCqZDSs3AKx+Kl73UWrr5SfP
         lkA3a5ICggdG5IXqY2jgOT4i28R1UXgbp4siq7Rp8ygztO1DIFbAgp3BhtwMK1Vhvr64
         wfDEJH3lGmbY3Rv19AgXBtTF0ys4CwOu4cjTw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=xuMYLzFVmts6/9mR/lwSF38LiTcO50fnC9GR82K5kBq/Wc/JtQZYl/YL1G4vEVZM8y
         6h/fgDMoWg1vbg6/qG+UMOavGArCmfNzLupG9UrzlqtO/uk9Nw9Cg7CeImXxhS/glgZ+
         m2HoZ+XLrQTl4vtGZz5UU4oihHltdNN3pDzj8=
MIME-Version: 1.0
Received: by 10.90.216.7 with SMTP id o7mr8212738agg.45.1252075207608; Fri, 04 
	Sep 2009 07:40:07 -0700 (PDT)
In-Reply-To: <359a92830909040626o3e36412du7d4efb905fe9f27a@mail.gmail.com>
References: <f950edef0909040253k2f5fa18dm9f3b5bfec23e7dd9@mail.gmail.com>
	 <359a92830909040626o3e36412du7d4efb905fe9f27a@mail.gmail.com>
Date: Fri, 4 Sep 2009 16:40:07 +0200
Message-ID: <f950edef0909040740y7e743290u29c4487d11dcf8e8@mail.gmail.com>
Subject: Re: how can I merge indexes without deleting the original index?
From: Francisco Borges <francisco.borges@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Hello Erick,

On Fri, Sep 4, 2009 at 3:26 PM, Erick Erickson<erickerickson@gmail.com> wrote:
> Sure, copy them first to some other directory <G>....
> We might have something more helpful if you'd tell us *why* you want to do
> this? What problem are you trying to solve? Because having two copies of
> your index in the same directory doesn't sound very save.

I have a folder hierarchy, where each subfolder contains documents

A/B
A/C
A/D

and where only the contents of D have been indexed.

Now I would like to index the whole content of A.

I wanted to avoid re-indexing the documents in D, so I thought about
doing a merge. At the same time, I wouldn't like to lose the index I
already had.

Thus I am trying to merge without deleting the original index.

Kind regards,
-- 
Francisco

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42173-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 15:19:32 2009
Return-Path: <java-user-return-42173-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97124 invoked from network); 4 Sep 2009 15:19:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 15:19:31 -0000
Received: (qmail 79019 invoked by uid 500); 4 Sep 2009 15:19:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78953 invoked by uid 500); 4 Sep 2009 15:19:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78943 invoked by uid 99); 4 Sep 2009 15:19:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 15:19:29 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 15:19:19 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id CEEFE58C7A
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 11:18:57 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Fri, 04 Sep 2009 11:18:57 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=q55EzYrYE6BE/eIU56LuXW1aFZI=; b=PA72EeenfnWbBSMp/40Jh2U8ulCysqDFYNlgF33cLjsgAZglN8ryBob1ybvS/nIEEKLqLmG8hmrew01t4awnbAFISYzB213sgZnyXFpdNPyLMsudpF+6eJ+mOsx1K/OnO7WRGES8dk3rwy3G8AnTLHZoaaEDvlmOGpPsjUzqRhM=
X-Sasl-enc: 9sbLd6Sam7lAD64bxMu7G8c0Qc7/ICuUB19fPXHksZj3 1252077537
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 44B201D462
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 11:18:57 -0400 (EDT)
Message-ID: <4AA12FE0.9040408@fastmail.fm>
Date: Fri, 04 Sep 2009 16:18:56 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Best way to create own version of StandardTokenizer ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I submitted this https://issues.apache.org/jira/browse/LUCENE-1787 patch 
to StandardTokenizerImpl, understandably it hasn't been incoroprated 
into Lucene (yet) but I need it for the project Im working on. So would 
you recommend keeping the same class name, and just putting in the 
classpath before the lucene.jar, or creating a new Tokenizer,Impl and 
Jflex file in my own projects package space.

Also, the StandardTokenizerImpl.jflex file states it should be compiled 
with Java 1.4 not a later JDK, is this just for backwards compatability 
? Because the indexes will be built afresh with this project  would I 
actually get a better results if I used a later JVM, the project has to 
deal with indexing text  which can be in any language and I'm hoping 
using the latest JVM may solve some mapping problems with Japanese, 
Hebrew and Korean that I don't really understand. Also our build process 
uses Maven (not ant) and code is built using source 1.6 so its going to 
be a pain to configure Maven to deal with this class differently.

thanks Paul


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42174-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 15:51:06 2009
Return-Path: <java-user-return-42174-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9098 invoked from network); 4 Sep 2009 15:51:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 15:51:06 -0000
Received: (qmail 32117 invoked by uid 500); 4 Sep 2009 15:51:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32060 invoked by uid 500); 4 Sep 2009 15:51:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32049 invoked by uid 99); 4 Sep 2009 15:51:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 15:51:03 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of francisco.borges@gmail.com designates 209.85.210.199 as permitted sender)
Received: from [209.85.210.199] (HELO mail-yx0-f199.google.com) (209.85.210.199)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 15:50:55 +0000
Received: by yxe37 with SMTP id 37so2649701yxe.5
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 08:50:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=g/A4lqj6enrPLFbLh9KRB1Ep8g0HdAFurPyeh/azUVc=;
        b=S4UVxsaWWtWQymqaIeDgACtW3vJdgZDkCc8ANgTPDCWJNOFUURW91P5AGfIpjC/dFy
         uDcFgG3Ofj6KeEj6oZKTiTOHcFkLG7ZjU7eIQfQWC/GvZH+XwIsqFJn0chMewJ20MPwf
         h5V1HKNJH1t0h2phmvatHaOOoBld3JNYTw1PM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=S9N7I0M5UDUbsti/9Z6Hd5+QcI4WhIOa71eS1AyzEyGYfCJ408/mbtlritsZiUnWd1
         6PH6Qnb0xiJ7YjVwmHuU2j/3vFv2SDl8aUfKrVk1G2MRVlIcefo5/HpS1+C8U4U1K42E
         /Z6NKU/08MbGHytPF6s2vVvim9KIpFjBSu7iY=
MIME-Version: 1.0
Received: by 10.90.10.1 with SMTP id 1mr8292815agj.62.1252079432872; Fri, 04 
	Sep 2009 08:50:32 -0700 (PDT)
In-Reply-To: <4d19a3630909040651g7dda9f6dkdc61c22f9392b62a@mail.gmail.com>
References: <f950edef0909040253k2f5fa18dm9f3b5bfec23e7dd9@mail.gmail.com>
	 <359a92830909040626o3e36412du7d4efb905fe9f27a@mail.gmail.com>
	 <4d19a3630909040651g7dda9f6dkdc61c22f9392b62a@mail.gmail.com>
Date: Fri, 4 Sep 2009 17:50:28 +0200
Message-ID: <f950edef0909040850y136d80e2u74320d71ea09adc8@mail.gmail.com>
Subject: Re: how can I merge indexes without deleting the original index?
From: Francisco Borges <francisco.borges@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636283516d41ff30472c275fb
X-Virus-Checked: Checked by ClamAV on apache.org

--001636283516d41ff30472c275fb
Content-Type: text/plain; charset=UTF-8

Hello,

Many thanks for the sample. I've already written a proof of concept with it.

Cheers,
Francisco

On Sep 4, 2009 3:53 PM, "Shashi Kant" <shashi.mit@gmail.com> wrote:

Here is some code to help you along.  This should leave the source
indices intact and merges them into a destination.

               //the index to hold our merged index
               IndexWriter iw = new IndexWriter(dest, new
StandardAnalyzer(), true);

               string[] sourceIndices; //an array containing the sources
              // the directory containing the "source" indices
               foreach (string si in sourceindices)
               {
                   IndexReader r = IndexReader.Open(si);
                   iw.AddIndexes(new IndexReader[] { r });
                   r.Close();
               }

               iw.Optimize();
               iw.Close();

--------------------------------------------------------------------- To
unsubscribe, e-mail: java-...

--001636283516d41ff30472c275fb--

From java-user-return-42175-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 16:03:17 2009
Return-Path: <java-user-return-42175-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12498 invoked from network); 4 Sep 2009 16:03:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 16:03:17 -0000
Received: (qmail 54607 invoked by uid 500); 4 Sep 2009 16:03:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54536 invoked by uid 500); 4 Sep 2009 16:03:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54526 invoked by uid 99); 4 Sep 2009 16:03:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 16:03:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.210.199 as permitted sender)
Received: from [209.85.210.199] (HELO mail-yx0-f199.google.com) (209.85.210.199)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 16:03:04 +0000
Received: by yxe37 with SMTP id 37so2665220yxe.5
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 09:02:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=77AJnI5lfiXld6CP1li4k1H9rNW6HmiEUzcPn66BOtc=;
        b=rVygjd9rv4u1M7RCOxUUOwt3Xuyejfcivsi6adU+FsRw8sOdfti5lrYR0dk8ER4gep
         CwXq+JXe/9Otsh9UrJ2bNdErcR+S9yKLtrLaC6tACgY7DFfrM3gguu6Aim/1jKLdKON0
         2gI1HCRCMh9rUTn9X5JYwsPBwzeWFY/F5vDOw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=ArKd6S8h0RwkirD46po13qk8/d0/DZi2TPFW0StBht+7dvhjGNRs4PvLOpKbTeheet
         /QBj5IsxMJlxuO/6cuoSpvEZWi/Xmq2cccZEmrFBmq4xuxJtkVejt/WvxK+6iCFdL69n
         VwxiOaYNFzwQ5jVUUuyoiI3bOHp8vXa2X5iZ8=
MIME-Version: 1.0
Received: by 10.101.10.5 with SMTP id n5mr12372219ani.122.1252080163667; Fri, 
	04 Sep 2009 09:02:43 -0700 (PDT)
In-Reply-To: <4AA12FE0.9040408@fastmail.fm>
References: <4AA12FE0.9040408@fastmail.fm>
Date: Fri, 4 Sep 2009 12:02:43 -0400
Message-ID: <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>
Subject: Re: Best way to create own version of StandardTokenizer ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Sep 4, 2009 at 11:18 AM, Paul Taylor<paul_t100@fastmail.fm> wrote:
> I submitted this https://issues.apache.org/jira/browse/LUCENE-1787 patch =
to
> StandardTokenizerImpl, understandably it hasn't been incoroprated into
> Lucene (yet) but I need it for the project Im working on. So would you
> recommend keeping the same class name, and just putting in the classpath
> before the lucene.jar, or creating a new Tokenizer,Impl and Jflex file in=
 my
> own projects package space.

i would recommend creating one in your own package space.

> Also, the StandardTokenizerImpl.jflex file states it should be compiled w=
ith
> Java 1.4 not a later JDK, is this just for backwards compatability ? Beca=
use
> the indexes will be built afresh with this project =C2=A0would I actually=
 get a
> better results if I used a later JVM, the project has to deal with indexi=
ng
> text =C2=A0which can be in any language and I'm hoping using the latest J=
VM may
> solve some mapping problems with Japanese, Hebrew and Korean that I don't
> really understand.

i do not think you will really get better results, but it depends what
your issue is (can you elaborate?)
upgrading from 1.4 -> 1.6 will bump your unicode version from 3 to 4.
you can see a list of the changes here:
http://www.unicode.org/versions/Unicode4.0.0/


--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42176-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 16:20:24 2009
Return-Path: <java-user-return-42176-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17462 invoked from network); 4 Sep 2009 16:20:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 16:20:24 -0000
Received: (qmail 87330 invoked by uid 500); 4 Sep 2009 16:20:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87244 invoked by uid 500); 4 Sep 2009 16:20:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87234 invoked by uid 99); 4 Sep 2009 16:20:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 16:20:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 16:20:12 +0000
Received: by ewy22 with SMTP id 22so1006196ewy.28
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 09:19:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=cAkUkW98F6LdHb6tANyEYO31Q8mQ8484O3xlsa6iDYc=;
        b=BcEpVIMjGkguFHZau8hpmNh9iI+7HKIKObbLbHZ6rN6zmoD6osOFymrfIPTeAge6Kx
         47pFi4i6t/MnW2f2E9jdx28ZGgxyNAdWyJdVyHH+cGOXFN5xcWH5DsXDG8UyjXRXkguQ
         KhmDYIHVyxbXO422u+6NYi+gSCBpFjtCcnCJo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Tw2HMMXJKjYBPqxPbiCeFZW4SOcstyMNUmrb+G23h2fknZN64Z6lEWcVbZURT3vPkR
         E5mcqYVrUHuoZBQIPMJPExtDU2UoCRU7vOD3Rj5CSEzKnnzpceMDAmBUQBFFDLpP8Wbv
         uhrPiKoTqr3n+R4Krtyyg/vZeMoGURC2cpnmc=
MIME-Version: 1.0
Received: by 10.216.87.201 with SMTP id y51mr980126wee.80.1252081191866; Fri, 
	04 Sep 2009 09:19:51 -0700 (PDT)
In-Reply-To: <9ac0c6aa0909040217j7c91b234p9243b9fb86b3d170@mail.gmail.com>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
	 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
	 <9ac0c6aa0909040217j7c91b234p9243b9fb86b3d170@mail.gmail.com>
Date: Fri, 4 Sep 2009 19:19:51 +0300
Message-ID: <786fde50909040919m79acc828sffc35a737f83cec5@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d564c2abd0490472c2dec6
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d564c2abd0490472c2dec6
Content-Type: text/plain; charset=ISO-8859-1

Thanks Mike. I did not phrase well my understanding of Cache reload. I
didn't mean literally as part of the reopen, but *because* of the reopen.
Because FieldCache is tied to an IndexReader instance, after reopen it gets
refreshed. If I keep my own Cache, I'll need to code that logic, and I
prefer to use what's currently in Lucene. (Sloth? :) )

I'll look at the mentioned function queries. Thanks for the pointer !

Shai
On Fri, Sep 4, 2009 at 12:17 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Fri, Sep 4, 2009 at 12:33 AM, Shai Erera<serera@gmail.com> wrote:
>
> > 1) Refactor the FieldCache API (and TopFieldCollector) such that one can
> > provide its own Cache of native values. I'd hate to rewrite the
> > FieldComparators logic just because the current API is not extendable.
> That
> > I agree should be quite straightforward, but I'll need to look into it
> > first.
>
> +1
>
> Or, so that the current consumers of FieldCache (that hardwire to
> FieldCache.DEFAULT) could simply accept any other FieldCache
> instance, as Hoss suggested.
>
> > 2) Contribute my payload-based sorting package. Currently it only reads
> from
> > disk during searches, and I'd like to enhance it to use in-memory cache
> as
> > well. It's a moderate-size package, so this one will need to wait until
> (1)
> > is done, and I get enough time to adapt it to 2.9 and work on the issue.
>
> +1, sounds cool!
>
> > I definitely don't think this should be a 2.9 sort of work, unless
> someone
> > else volunteers to do it. I can't pull (1) together that quickly.
>
> Me too... 2.9 train is moving out of the station now!
>
> > I thought that FieldCache is loaded when the IndexReader is reopened no?
> I
> > mean, it's a per IndexReader instance no? If not, then I'll need to
> rethink
> > the entire approach, because then (1) may not be that important anymore.
>
> FieldCache is only opened on demand, ie, the first time that a newly
> opened reader calls FieldCache.DEFAULT.getXXX does it get populated.
>
> So it's not during the reopen... it's during the first query that eg sorts
> by a field.
>
> It'd be great if your use case gives us enough clarity on LUCENE-831
> to make concrete progress.
>
> Note that function queries already "wrap" FieldCache w/ an alternate API
> for native value per doc (ValueSource, DocValues, FieldCacheSource),
> that do allow custom ValueSources to be provided.  It'd be great if
> as part of LUCENE-831 they could be more unified w/ FieldCache's
> API.
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d564c2abd0490472c2dec6--

From java-user-return-42177-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 16:55:11 2009
Return-Path: <java-user-return-42177-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45138 invoked from network); 4 Sep 2009 16:55:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 16:55:11 -0000
Received: (qmail 48182 invoked by uid 500); 4 Sep 2009 16:55:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48106 invoked by uid 500); 4 Sep 2009 16:55:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48096 invoked by uid 99); 4 Sep 2009 16:55:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 16:55:08 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 16:54:57 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id F3D3160445
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 12:54:36 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Fri, 04 Sep 2009 12:54:37 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=ngIZ7ExEbiZWyJz4iFpnA0na3eU=; b=FXqs2xNWmgy4bHGmSLQVMakyF34shQsZTeUk8wCojgCr/aZWogEaRJrvDm/UHm0uDTkOcOrmQhzx0desSQ4qec5sl4wPmCm2QJ28vjpEqcLzOZhYRi4kqtQqIpdYmGd9MrrEnIqRjHrlYHDp7JRUhm8YtfgbEP4JhyHT43hOKbU=
X-Sasl-enc: lLvF4TzBrKGhk/rto5HaNe4Ym9MBKaAqlzOeDsB0rjwa 1252083276
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 38A0A12702
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 12:54:36 -0400 (EDT)
Message-ID: <4AA1464B.4070002@fastmail.fm>
Date: Fri, 04 Sep 2009 17:54:35 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Best way to create own version of StandardTokenizer ?
References: <4AA12FE0.9040408@fastmail.fm> <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>
In-Reply-To: <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Robert Muir wrote:
> On Fri, Sep 4, 2009 at 11:18 AM, Paul Taylor<paul_t100@fastmail.fm> wrote:
>   
>> I submitted this https://issues.apache.org/jira/browse/LUCENE-1787 patch to
>> StandardTokenizerImpl, understandably it hasn't been incoroprated into
>> Lucene (yet) but I need it for the project Im working on. So would you
>> recommend keeping the same class name, and just putting in the classpath
>> before the lucene.jar, or creating a new Tokenizer,Impl and Jflex file in my
>> own projects package space.
>>     
>
> i would recommend creating one in your own package space.
>
>   
>> Also, the StandardTokenizerImpl.jflex file states it should be compiled with
>> Java 1.4 not a later JDK, is this just for backwards compatability ? Because
>> the indexes will be built afresh with this project  would I actually get a
>> better results if I used a later JVM, the project has to deal with indexing
>> text  which can be in any language and I'm hoping using the latest JVM may
>> solve some mapping problems with Japanese, Hebrew and Korean that I don't
>> really understand.
>>     
>
> i do not think you will really get better results, but it depends what
> your issue is (can you elaborate?)
> upgrading from 1.4 -> 1.6 will bump your unicode version from 3 to 4.
> you can see a list of the changes here:
> http://www.unicode.org/versions/Unicode4.0.0/
>
>
>   
Things like:
 
http://bugs.musicbrainz.org/ticket/1006
http://bugs.musicbrainz.org/ticket/5311
http://bugs.musicbrainz.org/ticket/4827

Paul


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42178-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 17:28:24 2009
Return-Path: <java-user-return-42178-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54228 invoked from network); 4 Sep 2009 17:28:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 17:28:24 -0000
Received: (qmail 75080 invoked by uid 500); 4 Sep 2009 17:28:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74997 invoked by uid 500); 4 Sep 2009 17:28:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74987 invoked by uid 99); 4 Sep 2009 17:28:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 17:28:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.210.199 as permitted sender)
Received: from [209.85.210.199] (HELO mail-yx0-f199.google.com) (209.85.210.199)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 17:28:10 +0000
Received: by yxe37 with SMTP id 37so2775166yxe.5
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 10:27:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=waDp2ljODrBvvfFw/jS2EWwFFGgUmYtrpLBQVePuF/U=;
        b=DkkrDacMJNKxhpmkc1RsQhXXKHs0yKQm1WsOY7qoy/6beZb42dVSBWvXlfMQpAdM/9
         Wz4MiAKdOn/FRej1RQ5RvZzjn2vK90JT6I0GvZkY7mR1zTFU9geUjHHfHgBEGjiRtC2K
         QXgXOGP2zXfUI6IFc1u61l9pMvIDZouoqIk78=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=MyZQlGS4h7r1y4zUjeefAT4GuPEFXkUinnAL23L+mMrcM3LRU283VePI1VZrik7/iJ
         pjOBEfNA7nhYp9DH3ujZ8XxWu80Cowsjx8BvuWGvxNoMiZMelLEcNTCh4fqkl6V/dxwA
         HJEQfWk5whvMURDPsD+66d8m+bj4GxHL1ggh4=
MIME-Version: 1.0
Received: by 10.101.95.6 with SMTP id x6mr12741080anl.108.1252085269049; Fri, 
	04 Sep 2009 10:27:49 -0700 (PDT)
In-Reply-To: <4AA1464B.4070002@fastmail.fm>
References: <4AA12FE0.9040408@fastmail.fm>
	 <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>
	 <4AA1464B.4070002@fastmail.fm>
Date: Fri, 4 Sep 2009 13:27:49 -0400
Message-ID: <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>
Subject: Re: Best way to create own version of StandardTokenizer ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Paul, thanks for the examples. In my opinion, only one of these is a
tokenizer problem :)
none of these will be affected by a unicode upgrade.

> Things like:
>
> http://bugs.musicbrainz.org/ticket/1006

in this case, it appears you want to do script conversion, and it
appears from the ticket you are familiar with the details of this one
:)

one approach you could do (requiring 2.9) would be to use the new
CharFilter mechanism.
there is even a set of mappings defined here:
https://issues.apache.org/jira/secure/attachment/12408724/japanese-h-to-k-m=
apping.txt
but these are static mappings and may or may not handle all the cases
you care about.

another approach is using ibm ICU library for this case, as the
builtin Katakana-Hiragana works well.
you don't need to write the rules, as its built in, but if you are
curious they are defined here:
http://unicode.org/repos/cldr/trunk/common/transforms/Hiragana-Katakana.xml=
?rev=3D1.7&content-type=3Dtext/vnd.viewcvs-markup
if CharFilter/the static mappings I described do not meet your
requirements, and you want a filter that does this via the rules
above, I can give you some code.

finally, you could write a tokenfilter in java code to do this.

> http://bugs.musicbrainz.org/ticket/5311

in this case, it appears you want to do fullwidth-halfwidth conversion
(hard to tell from the ticket but it claims that solves the issue)

you could use a similar CharFilter approach as I described above for this o=
ne.

alternatively, you could write java code. this kind of mapping is done
within the CJKTokenizer in Lucene's contrib, and you could steal some
code from there.

but a different way to look at this, is that its just one example of
Unicode normalization (compatibility decomposition)
so you could say, implement a tokenfilter that normalizes your text to
NFKC and solve this problem, as well as a bunch of other issues in a
bunch of other languages.
if you want code to do this, there are several open jira tickets in
lucene with different implementations.

> http://bugs.musicbrainz.org/ticket/4827

this is a tokenization issue. its also not unicode standard (as really
geresh/gershayim etc should be used).
in the unicode standard (uax #29 segmentation), this issue is
specifically mentioned:

For Hebrew, a tailoring may include a double quotation mark between
letters, because legacy data may contain that in place of U+05F4 (=D7=B4)
gershayim. This can be done by adding double quotation mark to
MidLetter. U+05F3 (=D7=B3) HEBREW PUNCTUATION GERESH may also be included
in a tailoring.

So the easiest way for you to get this, would be to modify jflex rules
for these characters to behave differently, perhaps only when
surrounded by hebrew context.


thanks for your feedback it inspired me to work some more on
LUCENE-1488 as its designed to handle all these cases out of box :)
>
> Paul
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42179-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 19:41:50 2009
Return-Path: <java-user-return-42179-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96370 invoked from network); 4 Sep 2009 19:41:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 19:41:50 -0000
Received: (qmail 60878 invoked by uid 500); 4 Sep 2009 19:41:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60779 invoked by uid 500); 4 Sep 2009 19:41:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60769 invoked by uid 99); 4 Sep 2009 19:41:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 19:41:48 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 19:41:37 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 1170062661
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 15:41:16 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute2.internal (MEProxy); Fri, 04 Sep 2009 15:41:16 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=mom2jlbCXBdnhT+R8dQ0LZENzeM=; b=SB5SGSg4YG94OIbud2G2mFiviQOhxstGvlni6tnBtFY8slPZgnlD1JRcIGEhRP7spTwopsfm0CoP/fB1Dw+U26sN/W+5PqokOVBgM0BjosbIEqYGURFgrW8GKhppZpQRUSTK9vRIHbAVu4rIRd81zE93Mti7Jvc9bnynCfOYMoo=
X-Sasl-enc: CXdgprzJtsN5dheb7Y9QAjy6Wxxb/TR08Y3UBnW5jc6T 1252093275
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 863D72E235
	for <java-user@lucene.apache.org>; Fri,  4 Sep 2009 15:41:15 -0400 (EDT)
Message-ID: <4AA16D59.3080401@fastmail.fm>
Date: Fri, 04 Sep 2009 20:41:13 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Best way to create own version of StandardTokenizer ?
References: <4AA12FE0.9040408@fastmail.fm>	 <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>	 <4AA1464B.4070002@fastmail.fm> <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>
In-Reply-To: <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Robert Muir wrote:
> Paul, thanks for the examples. In my opinion, only one of these is a
> tokenizer problem :)
> none of these will be affected by a unicode upgrade.
Thanks for taking the time to write that response, it will take me a bit 
of time to understand all this because I've ever used Lucene in quite a 
simple basis, but some excellant ideas there and I will take a look at 
your ICUAnalyser.

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42180-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 19:46:29 2009
Return-Path: <java-user-return-42180-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97879 invoked from network); 4 Sep 2009 19:46:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 19:46:29 -0000
Received: (qmail 66685 invoked by uid 500); 4 Sep 2009 19:46:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66606 invoked by uid 500); 4 Sep 2009 19:46:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66596 invoked by uid 99); 4 Sep 2009 19:46:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 19:46:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.132.245 as permitted sender)
Received: from [209.85.132.245] (HELO an-out-0708.google.com) (209.85.132.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 19:46:18 +0000
Received: by an-out-0708.google.com with SMTP id b2so434292ana.5
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 12:45:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=j5CHT/uilk+1G4NzH3W0IEy8jy2iHihBzJkZM3S44nA=;
        b=KeAnk4uwZbVZzPjTaAz+HQEw+lRJog2QaWOp4S2r/wJaL75NGmOk3DWPJRHqZNfbZp
         eolPnOb8MAiKt0nT439cEHZpudVtIjGp2SlUNhRvehdpYnPzNPc/b4ZjMe/R8J1OhJwn
         WGZqyrP4vYNCN2Vx/zoXhyhV+PfrSJGaikwek=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=m1oUHPOkCEgdY7WhD8V6oSy7IRlNp7jEpSBRRY8kPNKKoHAbAvtct7eDMpVe+4A5kj
         tCD5gBdViFe/O0dIpzmsudKI6faRiEtJ4JAK7YisNpxkS+p7tXZheH6gh6ODKxi1sPN7
         PyeeVml0KaLkuqFIvDgmIvXERNuY/x3QkQ2VE=
MIME-Version: 1.0
Received: by 10.101.81.8 with SMTP id i8mr12838375anl.185.1252093558061; Fri, 
	04 Sep 2009 12:45:58 -0700 (PDT)
In-Reply-To: <4AA16D59.3080401@fastmail.fm>
References: <4AA12FE0.9040408@fastmail.fm>
	 <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>
	 <4AA1464B.4070002@fastmail.fm>
	 <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>
	 <4AA16D59.3080401@fastmail.fm>
Date: Fri, 4 Sep 2009 15:45:57 -0400
Message-ID: <8f0ad1f30909041245s10944623l8494ff6aa1d30799@mail.gmail.com>
Subject: Re: Best way to create own version of StandardTokenizer ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Paul, no problem.

it is not fully functional right now (incomplete, bugs, etc). patch is
kinda for reading only :)
but if you have other similar issues on your project, feel free to
post links to them on that jira ticket.
this way we can look at what problems you have and if appropriate
maybe they can be incorporated in (maybe not there, but somewhere).

On Fri, Sep 4, 2009 at 3:41 PM, Paul Taylor <paul_t100@fastmail.fm> wrote:
> Robert Muir wrote:
>>
>> Paul, thanks for the examples. In my opinion, only one of these is a
>> tokenizer problem :)
>> none of these will be affected by a unicode upgrade.
>
> Thanks for taking the time to write that response, it will take me a bit of
> time to understand all this because I've ever used Lucene in quite a simple
> basis, but some excellant ideas there and I will take a look at your
> ICUAnalyser.
>
> Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42181-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 04 23:56:05 2009
Return-Path: <java-user-return-42181-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51886 invoked from network); 4 Sep 2009 23:56:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Sep 2009 23:56:04 -0000
Received: (qmail 48799 invoked by uid 500); 4 Sep 2009 23:56:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48714 invoked by uid 500); 4 Sep 2009 23:56:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48703 invoked by uid 99); 4 Sep 2009 23:56:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 23:56:02 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ianvink@gmail.com designates 209.85.223.191 as permitted sender)
Received: from [209.85.223.191] (HELO mail-iw0-f191.google.com) (209.85.223.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Sep 2009 23:55:53 +0000
Received: by iwn29 with SMTP id 29so175067iwn.20
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 16:55:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=0sEAZvCb9lbYz8nDuQt9FqmnnNJkShFRf2/n81UzlyY=;
        b=YEKJyTXuJHFTkhTzykPzhjht5seQVEAka+FhK3oHEOWIjABEM7YQvNELHgLdVfxYNo
         26AJxxZW+RR3AldpkVULI996f15z9yiZBhBsnIU0J41NsXeKxS9mLOqlV+nQRZnLwos6
         MUFjllei3SEcBBFJppcCJQGoHZ7S4Jo/KQHmk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=ajoA2+J7m7mxHCPjdsZ1ILrLZBtvYyIiDKh4XHKafngCAav2XTFJMzmxCmObDmjunR
         093fIdMOiVcXZzsyFpPer7RNsDR7CTUVTP4WrrzMxLi9FVB7nqBP5chvEDFTPSthjfi9
         pvYwMkHDRq5DLZ9cptBA9QeE+qOsXxk0obBuc=
MIME-Version: 1.0
Received: by 10.231.5.200 with SMTP id 8mr2217997ibw.46.1252108531901; Fri, 04 
	Sep 2009 16:55:31 -0700 (PDT)
Date: Fri, 4 Sep 2009 20:55:31 -0300
Message-ID: <5d53d5770909041655h4ae19b11uaaee1dbcf1647097@mail.gmail.com>
Subject: Newbie: Luke and fields
From: Ian Vink <ianvink@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151773d9f243a5c00472c93c91
X-Virus-Checked: Checked by ClamAV on apache.org

--00151773d9f243a5c00472c93c91
Content-Type: text/plain; charset=ISO-8859-1

I have created an index and each document has a contents field and a
language field.

contents has the flags: Indexed Tokenized Stored Vector
language has the flags: Indexed Stored

In luke I can search contents fine, but when I try to search the field
language, I never ever get results.

Every document has a language field populated which I can see in Luke's
document browser.

I have tried language:english and even made language the default field.

I gotta be missing something simple....

--00151773d9f243a5c00472c93c91--

From java-user-return-42182-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 05 00:51:13 2009
Return-Path: <java-user-return-42182-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66801 invoked from network); 5 Sep 2009 00:51:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Sep 2009 00:51:13 -0000
Received: (qmail 72299 invoked by uid 500); 5 Sep 2009 00:51:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72220 invoked by uid 500); 5 Sep 2009 00:51:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72210 invoked by uid 99); 5 Sep 2009 00:51:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 00:51:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.223.191 as permitted sender)
Received: from [209.85.223.191] (HELO mail-iw0-f191.google.com) (209.85.223.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 00:51:01 +0000
Received: by iwn29 with SMTP id 29so184631iwn.20
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 17:50:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=1U3H7BeR0is8vb+NiG9Dd3chg0ZQVNnwEOEoJrqoklw=;
        b=Vm4p97a1H/38wMe29oZg5M3u59Tmiz70rECcRiMApwTPIxEFS/u9mmxRMTFvG5Xb36
         dRcCdQlsNHt3T3hUgrXUA5IPeKHwecwrTu0IO11Sxa6K76zDeG7nrjAX4dwsZcXYNxH1
         Itgam0uaYuL0zMtg6sjBzw5+Mzl2WPs4X75hY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=JlCnV0hejTZ0ltzuBCuyjs3V+W6SDRsUExlgBu5n1vPm7FnvjK3nVqsdyyJww8tgLI
         IOWAc0hnrQdWDWyHmz2VG+A6KeMMYAOYsxmNtLreNJ4IG/sFPwETxIu84WMGpm57yTeH
         UtrhLLAO6HJ7aNuCVpLeX8F7VHxzNiqKpw+8M=
MIME-Version: 1.0
Received: by 10.231.125.9 with SMTP id w9mr10160121ibr.27.1252111840508; Fri, 
	04 Sep 2009 17:50:40 -0700 (PDT)
In-Reply-To: <f950edef0909040740y7e743290u29c4487d11dcf8e8@mail.gmail.com>
References: <f950edef0909040253k2f5fa18dm9f3b5bfec23e7dd9@mail.gmail.com>
	 <359a92830909040626o3e36412du7d4efb905fe9f27a@mail.gmail.com>
	 <f950edef0909040740y7e743290u29c4487d11dcf8e8@mail.gmail.com>
Date: Fri, 4 Sep 2009 20:50:40 -0400
Message-ID: <359a92830909041750t660de543kacee5696fa48cb08@mail.gmail.com>
Subject: Re: how can I merge indexes without deleting the original index?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64f686678fa320472ca0138
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64f686678fa320472ca0138
Content-Type: text/plain; charset=ISO-8859-1

OK, that makes sense. Note that Shashi's solution and mine are essentially
identical.
Shashi's code snippet, I think, pre-supposes that source and dest index
directories are
different. So copying your A/D index off some place else is functionally
equivalent.

I'm not sure what would happen if you had two separately constructed indexes
in the
same directory and then opened that dir....

Best
Erick

On Fri, Sep 4, 2009 at 10:40 AM, Francisco Borges <
francisco.borges@gmail.com> wrote:

> Hello Erick,
>
> On Fri, Sep 4, 2009 at 3:26 PM, Erick Erickson<erickerickson@gmail.com>
> wrote:
> > Sure, copy them first to some other directory <G>....
> > We might have something more helpful if you'd tell us *why* you want to
> do
> > this? What problem are you trying to solve? Because having two copies of
> > your index in the same directory doesn't sound very save.
>
> I have a folder hierarchy, where each subfolder contains documents
>
> A/B
> A/C
> A/D
>
> and where only the contents of D have been indexed.
>
> Now I would like to index the whole content of A.
>
> I wanted to avoid re-indexing the documents in D, so I thought about
> doing a merge. At the same time, I wouldn't like to lose the index I
> already had.
>
> Thus I am trying to merge without deleting the original index.
>
> Kind regards,
> --
> Francisco
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64f686678fa320472ca0138--

From java-user-return-42183-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 05 00:53:03 2009
Return-Path: <java-user-return-42183-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66970 invoked from network); 5 Sep 2009 00:53:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Sep 2009 00:53:03 -0000
Received: (qmail 74248 invoked by uid 500); 5 Sep 2009 00:53:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74160 invoked by uid 500); 5 Sep 2009 00:53:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74150 invoked by uid 99); 5 Sep 2009 00:53:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 00:53:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.191 as permitted sender)
Received: from [209.85.223.191] (HELO mail-iw0-f191.google.com) (209.85.223.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 00:52:53 +0000
Received: by iwn29 with SMTP id 29so184925iwn.20
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 17:52:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=g8anauyR3e/fYzVDWutwNb8scUsb8HfBDNRN15kkw6E=;
        b=YvYzkPVjz7iyob/UodgMRnfemXbzXI2z32yAspbycDDZEhcbYlAfi/XHV64OBoJyje
         5XhZzp81UrHerRJEpuR3ChHOuAD5hhkevDLoOIjh8Ds/AmVLnpPrpefWfHBEyrAZi1ek
         ybYgXmlP2v0QF9wHpslb6SefUKrskjQ+xDzOw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Xent0MxMkYF/OEp2okM4mEKe9hxebtd3chudXYZMHgR92HZtwpfVw9gAGrjrpedTXL
         j6ackERtG2fjlkWh96B4Met3/Fw3UIy8A0kKFLuxYQc9Z86NyMaznu/Y4eYOcmsf3nHB
         VA8uWTEtOX2kFIpVY7RQnhDLNDG0DzZZTPpX0=
MIME-Version: 1.0
Received: by 10.231.67.212 with SMTP id s20mr10260737ibi.32.1252111952378; 
	Fri, 04 Sep 2009 17:52:32 -0700 (PDT)
In-Reply-To: <786fde50909040919m79acc828sffc35a737f83cec5@mail.gmail.com>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
	 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
	 <9ac0c6aa0909040217j7c91b234p9243b9fb86b3d170@mail.gmail.com>
	 <786fde50909040919m79acc828sffc35a737f83cec5@mail.gmail.com>
Date: Fri, 4 Sep 2009 20:52:32 -0400
Message-ID: <359a92830909041752k5aafe159k5e7b5ef79ea01b18@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151774033c23fb0d0472ca0825
X-Virus-Checked: Checked by ClamAV on apache.org

--00151774033c23fb0d0472ca0825
Content-Type: text/plain; charset=ISO-8859-1

No, not sloth. Making use of the fine work that others have done in
order to help get your product out the door faster/cheaper <G>....

As in "There's no virtue in re-inventing the wheel. No matter how
productive it feels" <GGGG>.

Best
Erick

On Fri, Sep 4, 2009 at 12:19 PM, Shai Erera <serera@gmail.com> wrote:

> Thanks Mike. I did not phrase well my understanding of Cache reload. I
> didn't mean literally as part of the reopen, but *because* of the reopen.
> Because FieldCache is tied to an IndexReader instance, after reopen it gets
> refreshed. If I keep my own Cache, I'll need to code that logic, and I
> prefer to use what's currently in Lucene. (Sloth? :) )
>
> I'll look at the mentioned function queries. Thanks for the pointer !
>
> Shai
> On Fri, Sep 4, 2009 at 12:17 PM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
> > On Fri, Sep 4, 2009 at 12:33 AM, Shai Erera<serera@gmail.com> wrote:
> >
> > > 1) Refactor the FieldCache API (and TopFieldCollector) such that one
> can
> > > provide its own Cache of native values. I'd hate to rewrite the
> > > FieldComparators logic just because the current API is not extendable.
> > That
> > > I agree should be quite straightforward, but I'll need to look into it
> > > first.
> >
> > +1
> >
> > Or, so that the current consumers of FieldCache (that hardwire to
> > FieldCache.DEFAULT) could simply accept any other FieldCache
> > instance, as Hoss suggested.
> >
> > > 2) Contribute my payload-based sorting package. Currently it only reads
> > from
> > > disk during searches, and I'd like to enhance it to use in-memory cache
> > as
> > > well. It's a moderate-size package, so this one will need to wait until
> > (1)
> > > is done, and I get enough time to adapt it to 2.9 and work on the
> issue.
> >
> > +1, sounds cool!
> >
> > > I definitely don't think this should be a 2.9 sort of work, unless
> > someone
> > > else volunteers to do it. I can't pull (1) together that quickly.
> >
> > Me too... 2.9 train is moving out of the station now!
> >
> > > I thought that FieldCache is loaded when the IndexReader is reopened
> no?
> > I
> > > mean, it's a per IndexReader instance no? If not, then I'll need to
> > rethink
> > > the entire approach, because then (1) may not be that important
> anymore.
> >
> > FieldCache is only opened on demand, ie, the first time that a newly
> > opened reader calls FieldCache.DEFAULT.getXXX does it get populated.
> >
> > So it's not during the reopen... it's during the first query that eg
> sorts
> > by a field.
> >
> > It'd be great if your use case gives us enough clarity on LUCENE-831
> > to make concrete progress.
> >
> > Note that function queries already "wrap" FieldCache w/ an alternate API
> > for native value per doc (ValueSource, DocValues, FieldCacheSource),
> > that do allow custom ValueSources to be provided.  It'd be great if
> > as part of LUCENE-831 they could be more unified w/ FieldCache's
> > API.
> >
> > Mike
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--00151774033c23fb0d0472ca0825--

From java-user-return-42184-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 05 01:03:20 2009
Return-Path: <java-user-return-42184-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69040 invoked from network); 5 Sep 2009 01:03:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Sep 2009 01:03:20 -0000
Received: (qmail 85604 invoked by uid 500); 5 Sep 2009 01:03:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85518 invoked by uid 500); 5 Sep 2009 01:03:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85508 invoked by uid 99); 5 Sep 2009 01:03:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 01:03:18 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.191 as permitted sender)
Received: from [209.85.223.191] (HELO mail-iw0-f191.google.com) (209.85.223.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 01:03:10 +0000
Received: by iwn29 with SMTP id 29so186570iwn.20
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 18:02:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=mjYx0B9fm7urZU7u2+cWFK9SrrPxK8QVgaOUUAgc0DE=;
        b=A2ihYPmen9etyElipfdy4BaZonoywRBtGjPx13R/j2xfqfwmIuCbY8UY8Pu2qdCjEt
         gBeUtcUa+qQP0U9jIycG/cwM9K8knoAXn6ZXtz8QJW9x9bzaNFWAspVoPekwagVURfrz
         F78sEfgZ8O3nPe2a58PO21/sqROpxWD5MBFmk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=qvCV1gcjdMRWrWZVnGmDAelqtNzBNNB4i6+RZGp1V2T/ygV6rOFRO5CrJzrEN3PRB2
         iThGsZYBHNLWDCpwjWViRKX62S0le95r72CSkIVnSODXoA/2P2GS/vY89+RgbP7rIhui
         KBPMgcv+SiK7oO+aQ8rYx0Muf78BqYU2C7vxU=
MIME-Version: 1.0
Received: by 10.231.120.84 with SMTP id c20mr1835227ibr.47.1252112569561; Fri, 
	04 Sep 2009 18:02:49 -0700 (PDT)
In-Reply-To: <5d53d5770909041655h4ae19b11uaaee1dbcf1647097@mail.gmail.com>
References: <5d53d5770909041655h4ae19b11uaaee1dbcf1647097@mail.gmail.com>
Date: Fri, 4 Sep 2009 21:02:49 -0400
Message-ID: <359a92830909041802qeb4b678x1755efe5aed60784@mail.gmail.com>
Subject: Re: Newbie: Luke and fields
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016363b7984ed71eb0472ca2cda
X-Virus-Checked: Checked by ClamAV on apache.org

--0016363b7984ed71eb0472ca2cda
Content-Type: text/plain; charset=ISO-8859-1

Hmmmmm. Let's see the queries, and query.toString() may give
you some clues. I *suspect* that you really didn't index language.
Did you, perhaps, not re-index all your docs? Or use an analyzer
that didn't fold case when searching but did when searching (or
vice-versa)?

It's *possible* that you've got some kind of case problem. I've also
done really silly things like stared at the field for hours and never
noticed that it was "langauge".

Two things would help:
1> show us the index code you actually use.
2> make an index with, say, two documents and attach it to a post. Maybe
     someone with eyes less tired than yours will spot the issue.

Because you're right. This *should* work just fine, so there's probably
something that'll make you slap your forehead when you figure it out.
I speak from experience here, I've given myself lumps on my forehead
when someone pointed out *perfectly obvious* problems that I couldn't
find for hours<G>.

Best
Erick

On Fri, Sep 4, 2009 at 7:55 PM, Ian Vink <ianvink@gmail.com> wrote:

> I have created an index and each document has a contents field and a
> language field.
>
> contents has the flags: Indexed Tokenized Stored Vector
> language has the flags: Indexed Stored
>
> In luke I can search contents fine, but when I try to search the field
> language, I never ever get results.
>
> Every document has a language field populated which I can see in Luke's
> document browser.
>
> I have tried language:english and even made language the default field.
>
> I gotta be missing something simple....
>

--0016363b7984ed71eb0472ca2cda--

From java-user-return-42185-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 05 02:08:29 2009
Return-Path: <java-user-return-42185-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75203 invoked from network); 5 Sep 2009 02:08:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Sep 2009 02:08:29 -0000
Received: (qmail 15803 invoked by uid 500); 5 Sep 2009 02:08:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15725 invoked by uid 500); 5 Sep 2009 02:08:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15715 invoked by uid 99); 5 Sep 2009 02:08:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 02:08:26 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ianvink@gmail.com designates 209.85.223.191 as permitted sender)
Received: from [209.85.223.191] (HELO mail-iw0-f191.google.com) (209.85.223.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 02:08:16 +0000
Received: by iwn29 with SMTP id 29so197095iwn.20
        for <java-user@lucene.apache.org>; Fri, 04 Sep 2009 19:07:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=1yFglf9yCarEmukvDz/QAXxED6+VcqmvOPdiZ8tvn+w=;
        b=MPjPx33AHfUGmKaf9RZAW9pUH33WlvfeTLl1QB3pE2i2YhJfxUDh5QaQTSVeDpc456
         PYO8rXXPSv3/c6eb+mpHUBj24WuAop0UwL8nhh1xn/yo/zxN3VcZc9q0QbnXHVOZ4iva
         tc4BVzRX7IsMqiJYygjLH1LqLhAUt+NGCqe24=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=BU/wnOyv75oULtTkJcj4RSuJYreXBAaBxHeDZ1AmEKw6auy9qwGCaObr3q7ZjJ2B2R
         2tFHCT24+1IE1WGWJwp0LJsy8jADqm0izOpmGYdhmdsjg1fGgzoGYmtwiNj4aWeYcZom
         oa3thRc0eCfNL44kDX9/hiY+6eLkmE54KK8WE=
MIME-Version: 1.0
Received: by 10.231.5.200 with SMTP id 8mr2262616ibw.46.1252116474287; Fri, 04 
	Sep 2009 19:07:54 -0700 (PDT)
In-Reply-To: <359a92830909041802qeb4b678x1755efe5aed60784@mail.gmail.com>
References: <5d53d5770909041655h4ae19b11uaaee1dbcf1647097@mail.gmail.com>
	 <359a92830909041802qeb4b678x1755efe5aed60784@mail.gmail.com>
Date: Fri, 4 Sep 2009 23:07:54 -0300
Message-ID: <5d53d5770909041907w51639e77q8f5c1a1f049cacb4@mail.gmail.com>
Subject: Re: Newbie: Luke and fields
From: Ian Vink <ianvink@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151773d9f2aad8f40472cb15c0
X-Virus-Checked: Checked by ClamAV on apache.org

--00151773d9f2aad8f40472cb15c0
Content-Type: text/plain; charset=ISO-8859-1

Case?

Hmm. I thought it was case intensive.

I will re-index and revert all to lower case and see. The language is stored
as "English" not "english"

ian

P.S. Here's what I built with a basic understanding of Lucene.
http://BahaiResearch.com it's open source, ad-free. It allows people in 20
languages search the texts of any religion. Promotes understanding among the
different peoples of the world. Chinese Buddhists can better understand say
Spanish Baha'is or Dutch Jews.


On Fri, Sep 4, 2009 at 10:02 PM, Erick Erickson <erickerickson@gmail.com>wrote:

> Hmmmmm. Let's see the queries, and query.toString() may give
> you some clues. I *suspect* that you really didn't index language.
> Did you, perhaps, not re-index all your docs? Or use an analyzer
> that didn't fold case when searching but did when searching (or
> vice-versa)?
>
> It's *possible* that you've got some kind of case problem. I've also
> done really silly things like stared at the field for hours and never
> noticed that it was "langauge".
>
> Two things would help:
> 1> show us the index code you actually use.
> 2> make an index with, say, two documents and attach it to a post. Maybe
>     someone with eyes less tired than yours will spot the issue.
>
> Because you're right. This *should* work just fine, so there's probably
> something that'll make you slap your forehead when you figure it out.
> I speak from experience here, I've given myself lumps on my forehead
> when someone pointed out *perfectly obvious* problems that I couldn't
> find for hours<G>.
>
> Best
> Erick
>
> On Fri, Sep 4, 2009 at 7:55 PM, Ian Vink <ianvink@gmail.com> wrote:
>
> > I have created an index and each document has a contents field and a
> > language field.
> >
> > contents has the flags: Indexed Tokenized Stored Vector
> > language has the flags: Indexed Stored
> >
> > In luke I can search contents fine, but when I try to search the field
> > language, I never ever get results.
> >
> > Every document has a language field populated which I can see in Luke's
> > document browser.
> >
> > I have tried language:english and even made language the default field.
> >
> > I gotta be missing something simple....
> >
>

--00151773d9f2aad8f40472cb15c0--

From java-user-return-42186-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 05 15:45:39 2009
Return-Path: <java-user-return-42186-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11473 invoked from network); 5 Sep 2009 15:45:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Sep 2009 15:45:39 -0000
Received: (qmail 87917 invoked by uid 500); 5 Sep 2009 15:45:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87836 invoked by uid 500); 5 Sep 2009 15:45:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87826 invoked by uid 99); 5 Sep 2009 15:45:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 15:45:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 74.125.78.27 as permitted sender)
Received: from [74.125.78.27] (HELO ey-out-2122.google.com) (74.125.78.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 15:45:28 +0000
Received: by ey-out-2122.google.com with SMTP id 22so775397eye.3
        for <java-user@lucene.apache.org>; Sat, 05 Sep 2009 08:45:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        bh=fmDWK4tDHK/WT6IV8tU8VH2FDQ9IUVLWBvaLkkavzdA=;
        b=Uwd/JiD5XfIq1AIfI0TUol+Asv2RNDjgCeeUyCmvwX/b9l/voYnXhwEjzbAvoa3DNe
         yIj5OgZXJzHMxi9aAGGSv5uREzrNiynZ/UYyZMmkZ3XR53A0lGQyDn0uXnFkHRswbygz
         KSmXmKGY+PzJQFvrSzSEENAb2IzuNHKAkCGqA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=ceG4UDd4+LkxDCDLjAv5qlsQ9QirOgtPTHMl+oxoSDSr4E5f9CbpbR0dteCgtubaFX
         pFwl/WojrD4EO5vikEDBgBl4uEyZm9vPWKlzbros5hWc/yVrwoosrGaQmEUb883PuzMM
         7dxL7vIkD4MWJO6YaXuohCZ45tJ4Nyi+5P6WA=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.216.87.75 with SMTP id x53mr2361132wee.13.1252165506627; Sat, 
	05 Sep 2009 08:45:06 -0700 (PDT)
In-Reply-To: <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
	 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
Date: Sat, 5 Sep 2009 11:45:06 -0400
X-Google-Sender-Auth: c2afd124ebd532ad
Message-ID: <c68e39170909050845s506025bdvc92903e4704d6b69@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Sep 4, 2009 at 12:33 AM, Shai Erera<serera@gmail.com> wrote:
> 2) Contribute my payload-based sorting package. Currently it only reads from
> disk during searches, and I'd like to enhance it to use in-memory cache as
> well. It's a moderate-size package, so this one will need to wait until (1)
> is done, and I get enough time to adapt it to 2.9 and work on the issue.

I've resisted using payloads for this purpose in Solr because it felt
like an interim hack until CSF is implemented.  It feels like payloads
are properly used when one actually cares what the term or position
is.  Thoughts?  Do we think CSF will make it in 3.1?

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42187-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 05 17:27:31 2009
Return-Path: <java-user-return-42187-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24213 invoked from network); 5 Sep 2009 17:27:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Sep 2009 17:27:31 -0000
Received: (qmail 26465 invoked by uid 500); 5 Sep 2009 17:27:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26384 invoked by uid 500); 5 Sep 2009 17:27:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26374 invoked by uid 99); 5 Sep 2009 17:27:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 17:27:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Sep 2009 17:27:18 +0000
Received: by ewy22 with SMTP id 22so1618699ewy.28
        for <java-user@lucene.apache.org>; Sat, 05 Sep 2009 10:26:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=zCjCt2LVPGJWQ/j0gnR6F3e1l9j+/vhbia4C6+Xn+O0=;
        b=vb2uUh9W+a47a7WwX5AEgFVf1SR0FWbxvP8kGmxKm/9yWXqo3zHCigx/fZuL9Uu5Ru
         OJHJCDZPAfIxPsPuIp6WncD4s/sTy1Uv8X+XwJPm+9dBq2PsBUb8AzsmZzqBl2dh38ao
         TTbN+tNzvOuI6ZurlJ/069INJk0MW0ohCh124=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=a1eqJiIlW2kpZ9hY0lXG2B/rTjgcGrBYyNqNQVJoyMN2/WZ8x87gfe1DNSFOFqs6jQ
         ITjLm/UUz0m48N6gR7MMl7T7xMBXQq/8AaOAJuI0rxDrf4vM1wmqaqsRBN/Fjj+NKHid
         mXmRrO9BLUHusF3R6lCSxy7cCetOvriq0J0Lc=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.216.88.19 with SMTP id z19mr1146509wee.93.1252171618224; Sat, 
	05 Sep 2009 10:26:58 -0700 (PDT)
In-Reply-To: <25289618.post@talk.nabble.com>
References: <25289618.post@talk.nabble.com>
Date: Sat, 5 Sep 2009 13:26:58 -0400
X-Google-Sender-Auth: 425aaf15a533baa3
Message-ID: <c68e39170909051026j73cdffep35d0c5f8d9421cc6@mail.gmail.com>
Subject: Re: Doubt about Fieldcache.DEFAUL.getStrings[] and 
	Fieldcache.DEFAULT.getStringIndex
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Sep 4, 2009 at 4:09 AM, Marc Sturlese<marc.sturlese@gmail.com> wrot=
e:
>
> Hey there, I am iterating over a DocSet and for every id I neew to get th=
e
> value of a field wich is analyzed with KeyworddAnalyzer and is not sored.
> I have noticed to ways of doing it using Fieldcache. Can someone pleas
> explain me the pros and contras of using one or another?
>
> Using StringIndex:
> private FieldCache.StringIndex myIndex;
> myIndex =3D FieldCache.DEFAULT.getStringIndex(searcher.getReader(),
> fieldName);
> //for every docId...
> =A0 =A0int currentId =3D i.nextDoc();
> =A0 =A0String fieldValue =3D myIndex.lookup[myIndex.order[currentId]];
> //}
>
> Using getStrings:
> String[] values =3D FieldCache.DEFAULT.getStrings(searcher.getReader(),
> fieldName);
> //for every docId...
> =A0 =A0int currentId =3D i.nextDoc();
> =A0 =A0String fieldValue =3D values[currentId];
> //}
>
> Would be true to say that if the terms are repeated many times in that in=
dex
> field is better to use my first option but if the terms are never repeate=
d
> it doesn't matter to use the first or the second one?

Pretty much... *if* this field isn't used for anything else.
If you use this field for something else that asks for FieldCache
instances like sorting or faceting, then the StringIndex would be used
and you would be best served by reusing that.

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42188-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 06 03:45:20 2009
Return-Path: <java-user-return-42188-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11380 invoked from network); 6 Sep 2009 03:45:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Sep 2009 03:45:20 -0000
Received: (qmail 53503 invoked by uid 500); 6 Sep 2009 03:45:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53352 invoked by uid 500); 6 Sep 2009 03:45:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53179 invoked by uid 99); 6 Sep 2009 03:45:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Sep 2009 03:45:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erik.hatcher@gmail.com designates 209.85.211.183 as permitted sender)
Received: from [209.85.211.183] (HELO mail-yw0-f183.google.com) (209.85.211.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Sep 2009 03:45:05 +0000
Received: by ywh13 with SMTP id 13so1371391ywh.20
        for <multiple recipients>; Sat, 05 Sep 2009 20:44:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :content-type:content-transfer-encoding:mime-version:subject:date
         :x-mailer;
        bh=JuVWm5RK4h8qyyxMI22Nvetp1yQ57TyoUGRUqyKIXEs=;
        b=AZMyRTDXGm8X4lMPrWhxFK8aRRFOlH+b4wIyme+Z10AQ89dvUbiiVdZJarlrz9pABg
         qkzbBFSPkH9atMOBGDO8euzd+M/m3qC8SfI+PxuqMSODbfx1HC6NFHuyeNR1NMwpB9cu
         GA+2SQTo6L7Rk0zGhOVJ+aE6IoQ5HiUc1nUGI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:content-transfer-encoding
         :mime-version:subject:date:x-mailer;
        b=Grn3BwagidwZ+PbtGaPLj56Z8Tj1nMz8TUvQ0LICMkKJwnqNgBvRIHqxByR5RmcCm6
         Sb8dXmzp/hYxefO/NYihfias2NNV4PcxEwOseYNKdjdCt6RLL9xqybSWyH4L7IsLv5/8
         gZxxfQJATvwbvzdW7S+XrKUkU98kBLRMeem2Y=
Received: by 10.90.125.3 with SMTP id x3mr9801753agc.23.1252208681733;
        Sat, 05 Sep 2009 20:44:41 -0700 (PDT)
Received: from ?10.0.1.14? (va-71-51-2-147.dhcp.embarqhsd.net [71.51.2.147])
        by mx.google.com with ESMTPS id 9sm2879236agb.29.2009.09.05.20.44.39
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 05 Sep 2009 20:44:40 -0700 (PDT)
Message-Id: <9424F0F0-6F04-490C-83B2-5501AEAAFC28@gmail.com>
From: Erik Hatcher <erik.hatcher@gmail.com>
To: java-user@lucene.apache.org,
 solr-user@lucene.apache.org,
 general@lucene.apache.org
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v935.3)
Subject: Scandinavia Apache Lucene/Solr September Meetup: 9 September
Date: Sat, 5 Sep 2009 23:44:37 -0400
X-Mailer: Apple Mail (2.935.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Excuse the cross-posted announcement.  Next week we'll be having a =20
Lucene/Solr meetup around the JavaZone conference in Oslo, Norway.

Before, during, AND after - now that's my kind of meetup!

	Erik


Details here and below: =
http://www.meetup.com/Scandinavia-Apache-Lucene-Solr-Meetup/

September 9th, next Wednesday, 6pm
Radisson SAS Plaza Hotel
Sonja Henies Plass 3
Oslo

Presentations and discussions on Lucene/Solr, the Apache Open Source =20
Search Engine/Platform, alongside JavaZone 2009 of Oslo, Scandinavia's =20=

biggest meeting place for software developers:

Agenda:


	=95 "Solr at the Speed of Light": Erik Hatcher, Lucene/Solr PMC =
Member =20
and Committer, co-author of Lucene In Action, Lucid Imagination
	=95 "Migrating from commercial search engines to Solr",Tobias =
Larsson =20
Hult and Eskil Andreen, Findwise SE
	=95 Presentations followed by Lightning Talks from community =20
members:talks are 7-10 minute presentations, electronic, demo, or on =20
whiteboard; sign-ups at the event.
We'll have beer and food and socializing before, during and after.=20=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42189-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 06 08:42:54 2009
Return-Path: <java-user-return-42189-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64356 invoked from network); 6 Sep 2009 08:42:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Sep 2009 08:42:54 -0000
Received: (qmail 26562 invoked by uid 500); 6 Sep 2009 08:42:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26484 invoked by uid 500); 6 Sep 2009 08:42:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26474 invoked by uid 99); 6 Sep 2009 08:42:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Sep 2009 08:42:51 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.222 as permitted sender)
Received: from [209.85.219.222] (HELO mail-ew0-f222.google.com) (209.85.219.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Sep 2009 08:42:42 +0000
Received: by ewy22 with SMTP id 22so1846596ewy.28
        for <java-user@lucene.apache.org>; Sun, 06 Sep 2009 01:42:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=rMKO//zCuFaZ0U93kvTe92vJo8IL9lycritR7kkfCa8=;
        b=GwQ8QJGoLD/I7g5tHKFYXT6ZXjRdoqQJALQTsnhoXyAL1cCSLRKmT5PLwanm+EWLwk
         CedhPDQefgwq7f3hbldeqKSPvq5VIrGyiy/woylzqls+H4lFlPGpKLWCP8evnkkc8KFz
         zzjmEiu1ElvipQ+7C1aN50IDmDhzcszmiClpA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=UB70OyHLGu1O0QsbQt3CuLFGfXqTO+Nuwj4lRL8z1SxAVurXG0G+LH1a6lJ37BtlWe
         zvVb5QChXZULdJ5PbPnW02kne6d/Gu2R+h5el2Y12UGvaB1HumVHsRjmCcvXHUUytsm1
         JqhDec68HU0gjVqc2hJjXcmuMdvUpLRk+2fuA=
MIME-Version: 1.0
Received: by 10.216.47.204 with SMTP id t54mr2712501web.75.1252226541495; Sun, 
	06 Sep 2009 01:42:21 -0700 (PDT)
In-Reply-To: <c68e39170909050845s506025bdvc92903e4704d6b69@mail.gmail.com>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
	 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
	 <c68e39170909050845s506025bdvc92903e4704d6b69@mail.gmail.com>
Date: Sun, 6 Sep 2009 11:42:21 +0300
Message-ID: <786fde50909060142y7ba2367fj21cd4a16cb3517ed@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org, yonik@lucidimagination.com
Content-Type: multipart/alternative; boundary=001485f724f02f26170472e4b6c4
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f724f02f26170472e4b6c4
Content-Type: text/plain; charset=ISO-8859-1

>
> I've resisted using payloads for this purpose in Solr because it felt
> like an interim hack until CSF is implemented.
>

I don't see it as a hack, but as a proper use of a great feature in Lucene.
CSF and this are essentially the same. Adding document-level metadata, or
adding a term which puts stuff in the payload feels the same to me. We'll
definitely need to perf. test the two and compare. The package I wrote
"hides" this payload stuff from the app developer. If after CSF is
introduced is makes sense to move to use it, it should be very simple to
change the sort-by-payload package to use it, w/o affecting apps too much (I
think and hope).

The term just describes the "sort-by" type (e.g. date, title, priority etc.)
and there is only one position and nobody really cares about it and needs to
know that.

Shai

On Sat, Sep 5, 2009 at 6:45 PM, Yonik Seeley <yonik@lucidimagination.com>wrote:

> On Fri, Sep 4, 2009 at 12:33 AM, Shai Erera<serera@gmail.com> wrote:
> > 2) Contribute my payload-based sorting package. Currently it only reads
> from
> > disk during searches, and I'd like to enhance it to use in-memory cache
> as
> > well. It's a moderate-size package, so this one will need to wait until
> (1)
> > is done, and I get enough time to adapt it to 2.9 and work on the issue.
>
> I've resisted using payloads for this purpose in Solr because it felt
> like an interim hack until CSF is implemented.  It feels like payloads
> are properly used when one actually cares what the term or position
> is.  Thoughts?  Do we think CSF will make it in 3.1?
>
> -Yonik
> http://www.lucidimagination.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001485f724f02f26170472e4b6c4--

From java-user-return-42190-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 05:17:53 2009
Return-Path: <java-user-return-42190-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91626 invoked from network); 7 Sep 2009 05:17:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 05:17:52 -0000
Received: (qmail 37634 invoked by uid 500); 7 Sep 2009 05:17:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37549 invoked by uid 500); 7 Sep 2009 05:17:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37481 invoked by uid 99); 7 Sep 2009 05:17:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 05:17:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.89] (HELO smtp102.mail.in.yahoo.com) (202.86.5.89)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 07 Sep 2009 05:17:38 +0000
Received: (qmail 78324 invoked from network); 7 Sep 2009 05:17:15 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=1ZOdx3uTJJdpd2ROSUK7OXgdP0a133YTPoaDTR7bv1/m7gHBJHa/NXg5NxnqPJ5NNA4cS1B33NK28bTfWp06YOaM+3uu9gtQkNTHDCWkkMS//7f2psxC1d2ITytPzfBm/HCurDscTHpnMMo8BqWli2brWy8BdkAYL9UILukX5ps=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp102.mail.in.yahoo.com with SMTP; 7 Sep 2009 05:17:14 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: xFezOtEVM1kh4JghizYewuQz0NuBYboeunOFtDbru4HKCLectduo8w.YPuactp9SNjm6PX1wPvhqscpRMdO4bvD82dRW2b0QWBstZo5p1AGjJW14O2f5GIiaZsjCPetFNTKuDbKwk.wR6RGi1M15gxOHES_xBKm_IvdsVTtGzr5_ngsyNygXjNZPdzs-
X-Yahoo-Newman-Property: ymail-3
Message-ID: <007301ca2f7a$75de9f00$710bc30a@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com> <56868BB9D33F495591AAB653D8EDDB1B@VEGA> <002401ca2d32$2f2d19a0$710bc30a@sv.us.sonicwall.com> <07E1D9132E514DEF99909ED72A299B9D@VEGA> <002d01ca2d43$9837c150$710bc30a@sv.us.sonicwall.com> <0F1111CE57AE406BAD4794E43A791CF6@VEGA> <005c01ca2d5d$e86a75e0$710bc30a@sv.us.sonicwall.com>
Subject: Re: too many file descriptors opened by Lucene shows (deleted) in /proc 
Date: Mon, 7 Sep 2009 10:47:12 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3138
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3138
X-Virus-Checked: Checked by ClamAV on apache.org

Any adivice on this. I am closing the reader when not in use. But still =
/proc/<processid>/fd shows many files as (deleted). What are other =
things i need to look in to.

Regards
Ganesh


----- Original Message -----=20
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Sent: Friday, September 04, 2009 6:17 PM
Subject: Re: too many file descriptors opened by Lucene shows (deleted) =
in /proc=20


I am closing the readers when not in use.=20

I tried testing explicitly not closing the reader and found that the =
file is not actually deleted and it remains in the disk. I remeber =
reading this information. In my case, readers and searchers are closed =
and the files are not existing in disk but /proc shows many fds with =
(deleted).

Regards
Ganesh=20


----- Original Message -----=20
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
Sent: Friday, September 04, 2009 3:17 PM
Subject: RE: too many file descriptors opened by Lucene shows (deleted) =
in /proc=20


> Yes you are doing the reopen right, but my question was: in your code =
"//
> reOpen", which is not visible, do you close the old reader after =
reopen? If
> you do not do this, it stays open forever. This is what I suggested by =
my
> example.
>=20
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>=20
>> -----Original Message-----
>> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> Sent: Friday, September 04, 2009 11:39 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: too many file descriptors opened by Lucene shows =
(deleted) in
>> /proc
>>=20
>> I doing the following way.
>>=20
>> if (!reader.isCurrent()) {
>> //reOpen
>> }
>>=20
>> I tried debugging and my log shows the correct reference count. Any =
other
>> idea?
>>=20
>> Regards
>> Ganesh
>>=20
>> ----- Original Message -----
>> From: "Uwe Schindler" <uwe@thetaphi.de>
>> To: <java-user@lucene.apache.org>
>> Sent: Friday, September 04, 2009 1:12 PM
>> Subject: RE: too many file descriptors opened by Lucene shows =
(deleted) in
>> /proc
>>=20
>>=20
>> > One general trap with reopen(): Reopen() returns a *new* =
IndexReader. If
>> > this new IndexReader is different from the actual one, you have to =
close
>> the
>> > old reader when you are finished working on it. If you only have =
one
>> thread
>> > working on this IndexReader that is reopened, you can close the old
>> reader
>> > directly after reopening:
>> >
>> > IndexReader new =3D actualReader.reopen();
>> > if (new !=3D actualReader) {
>> > actualReader.close();
>> > actualReader =3D new;
>> > }
>> >
>> > If you have some multithreaded architecture, you have to keep the =
old
>> reader
>> > open as long as there are accesses (which you can manage by
>> refcounting).
>> >
>> > -----
>> > Uwe Schindler
>> > H.-H.-Meier-Allee 63, D-28213 Bremen
>> > http://www.thetaphi.de
>> > eMail: uwe@thetaphi.de
>> >
>> >> -----Original Message-----
>> >> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> >> Sent: Friday, September 04, 2009 9:35 AM
>> >> To: java-user@lucene.apache.org
>> >> Subject: Re: too many file descriptors opened by Lucene shows =
(deleted)
>> in
>> >> /proc
>> >>
>> >> I am having only one process using Lucene DB. The same process =
writes
>> and
>> >> reads. I do re-open indexreader. I am maintaing ref count for each
>> >> reader/searcher and closing it if it is not used. I am not able to
>> >> understand, why the file descriptor is showing as (deleted)?
>> >>
>> >> I guessing some issues? Could any one tell me what are the other =
part
>> of
>> >> code to look in to (related to Lucene)? Any other way to identify =
the
>> root
>> >> cause?
>> >>
>> >> Regards
>> >> Ganesh
>> >>
>> >>
>> >> ----- Original Message -----
>> >> From: "Uwe Schindler" <uwe@thetaphi.de>
>> >> To: <java-user@lucene.apache.org>
>> >> Sent: Friday, September 04, 2009 11:56 AM
>> >> Subject: RE: too many file descriptors opened by Lucene shows =
(deleted)
>> in
>> >> /proc
>> >>
>> >>
>> >> > This is normal. When you open an IndexReader/IndexSearcher, it =
opens
>> >> various
>> >> > file handles. If you additionally update/add/delete documents in
>> >> parallel
>> >> > (even in other process), or optimize the index, the original
>> IndexReader
>> >> > stays on using the "old" state of the index. IndexWriter deletes =
some
>> >> files,
>> >> > but IndexReader still have them open (this is our segment based
>> >> > "transaction" handling of IndexWriter). If you reopen your
>> IndexReader
>> >> to
>> >> > get the last updates of the underlying index, these "deleted" =
files
>> will
>> >> > disappear, as they can be closed. As long as they are open, they
>> >> disappear
>> >> > from directory listing, but they still consume space on disk =
(because
>> >> they
>> >> > are still used). This is why you see this deleted files.
>> >> >
>> >> > -----
>> >> > Uwe Schindler
>> >> > H.-H.-Meier-Allee 63, D-28213 Bremen
>> >> > http://www.thetaphi.de
>> >> > eMail: uwe@thetaphi.de
>> >> >
>> >> >> From: Ganesh [mailto:emailgane@yahoo.co.in]
>> >> >> Sent: Friday, September 04, 2009 8:11 AM
>> >> >> To: java-user@lucene.apache.org
>> >> >> Subject: too many file descriptors opened by Lucene shows =
(deleted)
>> in
>> >> >> /proc
>> >> >>
>> >> >> Hello all,
>> >> >>
>> >> >> In my linux pc, there are too many fd counts for lucene =
database.
>> >> >> /proc/<processid>/fd shows very big list. I have provided =
sample
>> below.
>> >> >>
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 360 ->
>> >> >> /opt/ganesh/lucenedb/_2w5.tvf (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 361 ->
>> >> >> /opt/ganesh/lucenedb/_hr.frq (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 362 ->
>> >> >> /opt/ganesh/lucenedb/_hr.prx (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 363 ->
>> >> >> /opt/ganesh/lucenedb/_hr.tvx (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 21:01 364 ->
>> >> >> /opt/ganesh/lucenedb/_hr.tvd (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 365 ->
>> >> >> /opt/ganesh/lucenedb/_hr.tvf (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 366 ->
>> >> >> /opt/ganesh/lucenedb/_2w4.fdt (deleted)
>> >> >> lr-x------    1 root     root           64 Sep  3 17:02 367 ->
>> >> >> /opt/ganesh/lucenedb/_2w4.fdx (deleted)
>> >> >>
>> >> >> These files not exist in the disk but why it is showing as =
(deleted)
>> in
>> >> >> the /proc. This means the process is still holding the fd. =
Please
>> >> provide
>> >> >> me more information on this. I am using Fedora Linux, ext-3 =
file
>> >> system,
>> >> >> Lucene 2.4.1.
>> >> >>
>> >> >> Regards
>> >> >> Ganesh
>> >> >> Send instant messages to your online friends
>> >> http://in.messenger.yahoo.com
>> >> >>
>> >> >> =
--------------------------------------------------------------------
>> -
>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> >> For additional commands, e-mail: =
java-user-help@lucene.apache.org
>> >> >
>> >> >
>> >> >
>> >> > =
---------------------------------------------------------------------
>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> > For additional commands, e-mail: =
java-user-help@lucene.apache.org
>> >> >
>> >> Send instant messages to your online friends
>> http://in.messenger.yahoo.com
>> >>
>> >> =
---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> >
>> > =
---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> Send instant messages to your online friends =
http://in.messenger.yahoo.com
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
Send instant messages to your online friends =
http://in.messenger.yahoo.com=20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42191-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 09:28:37 2009
Return-Path: <java-user-return-42191-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56069 invoked from network); 7 Sep 2009 09:28:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 09:28:36 -0000
Received: (qmail 34181 invoked by uid 500); 7 Sep 2009 09:28:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34115 invoked by uid 500); 7 Sep 2009 09:28:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34105 invoked by uid 99); 7 Sep 2009 09:28:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 09:28:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mindas@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 09:28:26 +0000
Received: by bwz10 with SMTP id 10so876905bwz.5
        for <java-user@lucene.apache.org>; Mon, 07 Sep 2009 02:28:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=7E7W4SvhCFElaeLQkugscKdVi/M4y2QrG+/mC4O/O5E=;
        b=JAiJwG7jYhRAEdxJg4AHItimV2t1prm2cNm8iZrc5IiRTFvxy3uFQp1/go4gHnSuKG
         XUy1QkAZQGgeA2wruf3ekK8CXzzLg85M/Ex/C+N+4DAFXJt0GMzO21KTuXq4ZOJ/Os1K
         41DO06ikZ9oqvH4M0wfgarQESGQfg5NNhQDZA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ewaLaCAPKxPpXi+vU//yZWkhelQjnN/30hEm41272xWMMAPtrHuF2CXgvtpc9SgUa5
         uYstlmKZuQJy6ON4RrPiNi1hnI7uOcPr/mwwpyiZSwmfIBHhL86hWfhcfZmCqnTsKA8a
         Vz5Sjf+vAVrz0Dt/wQEhOfRpIgaSKGDUs0R64=
MIME-Version: 1.0
Received: by 10.103.80.18 with SMTP id h18mr6062423mul.65.1252315684393; Mon, 
	07 Sep 2009 02:28:04 -0700 (PDT)
In-Reply-To: <007301ca2f7a$75de9f00$710bc30a@sv.us.sonicwall.com>
References: <000d01ca2d26$76792b20$710bc30a@sv.us.sonicwall.com>
	 <56868BB9D33F495591AAB653D8EDDB1B@VEGA>
	 <002401ca2d32$2f2d19a0$710bc30a@sv.us.sonicwall.com>
	 <07E1D9132E514DEF99909ED72A299B9D@VEGA>
	 <002d01ca2d43$9837c150$710bc30a@sv.us.sonicwall.com>
	 <0F1111CE57AE406BAD4794E43A791CF6@VEGA>
	 <005c01ca2d5d$e86a75e0$710bc30a@sv.us.sonicwall.com>
	 <007301ca2f7a$75de9f00$710bc30a@sv.us.sonicwall.com>
Date: Mon, 7 Sep 2009 10:28:04 +0100
Message-ID: <a4d7dcf50909070228u1ba4592fq3a9ddc0c22477c8c@mail.gmail.com>
Subject: Re: too many file descriptors opened by Lucene shows (deleted) in 
	/proc
From: =?ISO-8859-13?Q?Mindaugas_=DEak=F0auskas?= <mindas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Mon, Sep 7, 2009 at 6:17 AM, Ganesh<emailgane@yahoo.co.in> wrote:
> Any adivice on this. I am closing the reader when not in use. But still /proc/<processid>/fd shows many files as (deleted). What are other things i need to look in to.

If I was in your shoes, I'd wait for a moment when the problem comes
up, do a memory dump (hint: jmap -dump:format=b,file=filename pid),
then fire up a profiler and search for instances of
org.apache.lucene.index.IndexReader, org.apache.lucene.store.Directory
and if that doesn't help - java.io.File. This would show you the
traces all the way to the top.

m.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42192-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 10:08:21 2009
Return-Path: <java-user-return-42192-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70680 invoked from network); 7 Sep 2009 10:08:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 10:08:21 -0000
Received: (qmail 81584 invoked by uid 500); 7 Sep 2009 10:08:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81497 invoked by uid 500); 7 Sep 2009 10:08:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81487 invoked by uid 99); 7 Sep 2009 10:08:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 10:08:18 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 10:08:07 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 85FDD6909F
	for <java-user@lucene.apache.org>; Mon,  7 Sep 2009 06:07:46 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute2.internal (MEProxy); Mon, 07 Sep 2009 06:07:46 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=F4SXYlUpfTBzggmmkClIK34zJh4=; b=XpdqUA6AW5Al//EmDyEx+OmIfgA2TXrxTJ+brSKQahjHiNDeTCaeXizZmA6wGshTSLViZ3MHf/xxNjk1IQ8UHuiICmQJxwhxRp/MOqkTrwpnLfVnnjGwawG91k4gKVwiqu+Lf4xQmYEIGRJiCf+iCrmIcocRTA+1qZDzc2Gqhkg=
X-Sasl-enc: z50fQNFI8QOVZgT5T/qz6bHs79UU1nx3NenTVZolM7Nx 1252318065
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 95BB55C1BF
	for <java-user@lucene.apache.org>; Mon,  7 Sep 2009 06:07:45 -0400 (EDT)
Message-ID: <4AA4DB70.9050205@fastmail.fm>
Date: Mon, 07 Sep 2009 11:07:44 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Best way to create own version of StandardTokenizer ?
References: <4AA12FE0.9040408@fastmail.fm>	 <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>	 <4AA1464B.4070002@fastmail.fm> <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>
In-Reply-To: <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Robert Muir wrote:
> Paul, thanks for the examples. In my opinion, only one of these is a
> tokenizer problem :)
> none of these will be affected by a unicode upgrade.
>
>   
>> Things like:
>>
>> http://bugs.musicbrainz.org/ticket/1006
>>     
>
>
> another approach is using ibm ICU library for this case, as the
> builtin Katakana-Hiragana works well.
> you don't need to write the rules, as its built in, but if you are
> curious they are defined here:
> http://unicode.org/repos/cldr/trunk/common/transforms/Hiragana-Katakana.xml?rev=1.7&content-type=text/vnd.viewcvs-markup
> if CharFilter/the static mappings I described do not meet your
> requirements, and you want a filter that does this via the rules
> above, I can give you some code.
>
>   
I think we would like to implement the complete unicode rules, so if you 
could provide us with some code that would be great.
>> http://bugs.musicbrainz.org/ticket/5311
>>     
>
> in this case, it appears you want to do fullwidth-halfwidth conversion
> (hard to tell from the ticket but it claims that solves the issue)
>
> you could use a similar CharFilter approach as I described above for this one.
>
>   
If there is a mapping from halfwidth / fullwidth that would work so 
converted to fullwidth for indexing and searching, but having read the 
details it would seem to convert a half width character you would have 
to know you were looking at chinese (or korean/japanses ecetera) , but 
as the Musicbrainz system supports any language and the user doesn't 
specify the language being used  when searching I cannot safetly  
convert these characters because they may just be latin ecetera. However 
when the entity is added to the database the language is specified so I 
could do a conversion like this to ensure all chinese albums were always 
indexed as full width, and then educate users to use full width charcters.
> alternatively, you could write java code. this kind of mapping is done
> within the CJKTokenizer in Lucene's contrib, and you could steal some
> code from there.
>   
Not really going to work for me because need to handle all scripts, if I 
ad extra chinese handling to tokenizer I expect I'll break handling for 
other languages
> but a different way to look at this, is that its just one example of
> Unicode normalization (compatibility decomposition)
> so you could say, implement a tokenfilter that normalizes your text to
> NFKC and solve this problem, as well as a bunch of other issues in a
> bunch of other languages.
> if you want code to do this, there are several open jira tickets in
> lucene with different implementations.
>   
I assume once again you have to know the script being used in order to 
do this
>   
>> http://bugs.musicbrainz.org/ticket/4827
>>     
>
> this is a tokenization issue. its also not unicode standard (as really
> geresh/gershayim etc should be used).
> in the unicode standard (uax #29 segmentation), this issue is
> specifically mentioned:
>
> For Hebrew, a tailoring may include a double quotation mark between
> letters, because legacy data may contain that in place of U+05F4 ()
> gershayim. This can be done by adding double quotation mark to
> MidLetter. U+05F3 () HEBREW PUNCTUATION GERESH may also be included
> in a tailoring.
>
> So the easiest way for you to get this, would be to modify jflex rules
> for these characters to behave differently, perhaps only when
> surrounded by hebrew context.
I think there are two issues, firstly the data needs to be indexed to 
always use gerhayim is this what you are suggesting I couldn't follow 
how to change jflex.
Then its an issue for the query parser that the user uses a " for 
searching but doesn't escape it, but I cannot automatically escape it 
because it may not be Hebrew.


Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42193-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 12:16:45 2009
Return-Path: <java-user-return-42193-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94756 invoked from network); 7 Sep 2009 12:16:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 12:16:45 -0000
Received: (qmail 23011 invoked by uid 500); 7 Sep 2009 12:16:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22947 invoked by uid 500); 7 Sep 2009 12:16:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22937 invoked by uid 99); 7 Sep 2009 12:16:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 12:16:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.222.200 as permitted sender)
Received: from [209.85.222.200] (HELO mail-pz0-f200.google.com) (209.85.222.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 12:16:35 +0000
Received: by pzk38 with SMTP id 38so2452312pzk.5
        for <java-user@lucene.apache.org>; Mon, 07 Sep 2009 05:16:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=lQrGvpdFRqSh3dLm/THzxgpbRzyxN+p/t+C50CJ6Uh4=;
        b=xSIfv+1tfSCuglViEkSzGNlTH9JqaHOLdKZ7OeXYnB/Hlo1W6VsrGiDX1f6Z3zQZe6
         CU0TpFTeIUbb4K99EZ/6X4gS6Oa/AlKSeJ1fVCn/uTTcFftQfP79YoQCXk//FLXHhOwt
         R7wdFKBUiKc0/7/axYlVwDg1OSQYHOvh5Qm9M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=T3gub5cLT4yFgCfvOZ3dT5soefN7OeDfjdJga7rc0qvJJI04opQ6beIK/SMTtpZV0e
         TDN5U+dFXOhHRfrNqWTI7EAyMPkwwPcndqZz2t1Ik0ySsVcB8KNt/i131ZBrEqk64Z4J
         Wd4C8whADqTXezLcTY5cIP3pP9PgbyDXRQmB0=
MIME-Version: 1.0
Received: by 10.115.114.7 with SMTP id r7mr2238433wam.72.1252325774775; Mon, 
	07 Sep 2009 05:16:14 -0700 (PDT)
Date: Mon, 7 Sep 2009 17:46:14 +0530
Message-ID: <867513fe0909070516o2631d141jf7ccec15783fa2b@mail.gmail.com>
Subject: "Lucid Gaze for Lucene: How to " - A Blog
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64eeac2f2d6af0472fbd020
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64eeac2f2d6af0472fbd020
Content-Type: text/plain; charset=ISO-8859-1

Wrote a post about 'how to use lucid gaze for lucene'. Thought I'd share
here as I didn't find anything elsewhere on the information superhighway.
Feel free to comment!
http://ai-cafe.blogspot.com


--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............

--0016e64eeac2f2d6af0472fbd020--

From java-user-return-42194-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 14:19:24 2009
Return-Path: <java-user-return-42194-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28761 invoked from network); 7 Sep 2009 14:19:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 14:19:24 -0000
Received: (qmail 64696 invoked by uid 500); 7 Sep 2009 14:19:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64618 invoked by uid 500); 7 Sep 2009 14:19:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64608 invoked by uid 99); 7 Sep 2009 14:19:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 14:19:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.211.183 as permitted sender)
Received: from [209.85.211.183] (HELO mail-yw0-f183.google.com) (209.85.211.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 14:19:10 +0000
Received: by ywh13 with SMTP id 13so2379571ywh.20
        for <java-user@lucene.apache.org>; Mon, 07 Sep 2009 07:18:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=2KsL9IJ0D7kUDL5YW5HbAsew+Moqo25vKEcHbrS9Hnw=;
        b=cvhgsJUwgOU4+KhyGgB1tHNdv1z8V1Z9KA8SKAseNnMvZ7ehbQygD89uhzzxdZNi6i
         v7x+dvia00fn0nRWlFL0kFhITpBWovvLte5buYZ1g3haeJs9Oirs+ml+2feo5gaqo/5S
         WRc74v47FTv81gcU8EU0zKIcVdcNYbdXl5hdg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=WuyK1dLcmx2IJX4elahz0qx2wpCuWv9oNBML0oQtLbQqkZcwRNhKtZPEuZugbTQ8Py
         EQ0epgdZQVPyeNAHc3zkBxFgx6tG87P3JuL013cbx13FDq4goWvbpvqV0lfA9VYClrBT
         yTkpZZkNZHh8NBC3vLHLxH8U7Y4zvNvODHzKk=
MIME-Version: 1.0
Received: by 10.101.95.6 with SMTP id x6mr15594180anl.108.1252333129946; Mon, 
	07 Sep 2009 07:18:49 -0700 (PDT)
In-Reply-To: <4AA4DB70.9050205@fastmail.fm>
References: <4AA12FE0.9040408@fastmail.fm>
	 <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>
	 <4AA1464B.4070002@fastmail.fm>
	 <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>
	 <4AA4DB70.9050205@fastmail.fm>
Date: Mon, 7 Sep 2009 10:18:49 -0400
Message-ID: <8f0ad1f30909070718g4a39d887i387cd35fe1efe090@mail.gmail.com>
Subject: Re: Best way to create own version of StandardTokenizer ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

> I think we would like to implement the complete unicode rules, so if you
> could provide us with some code that would be great.

ok, I will followup... what version of lucene are you using, 2.9?

...
> but having read the
> details it would seem to convert a half width character you would have to
> know you were looking at chinese (or korean/japanses ecetera) , but as th=
e
> Musicbrainz system supports any language and the user doesn't specify the
> language being used =C2=A0when searching

no, theres no language involved... why would you not simply apply the
filter all the time.
if i am looking at =EF=BC=B4 (fullwidth character T), it should indexed as =
T
everytime (or later probably t if you are going to apply
lowercasefilter)

> I assume once again you have to know the script being used in order to do
> this

this is ok, because normalization, if you want to do it that way, is
definitely not language dependent!
its not like collation, where you have a locale 'parameter', its a
language-independent process.
http://unicode.org/reports/tr15/

> I think there are two issues, firstly the data needs to be indexed to alw=
ays
> use gerhayim is this what you are suggesting I couldn't follow how to cha=
nge
> jflex.

you are right, for you there are a couple issues.
first, i do not know what standardtokenizer does with
geresh/gershayim, forget about single quote/double quote.

but to fix the tokenization (gershayim example), you want to ensure
you do not split on these.
since this is used in hebrew acronym, i would modify the acronym rule to al=
low

[hebrew letter]+ (" | =D7=B4) [hebrew letter]+

next, if you want these to be indexed the same so that =D7=90=D7=A8=D7=94"=
=D7=91 and =D7=90=D7=A8=D7=94=D7=B4=D7=91
will match, you will need to create a tokenfilter
to standardize " to =D7=B4 for acronyms.

> Then its an issue for the query parser that the user uses a " for searchi=
ng
> but doesn't escape it, but I cannot automatically escape it because it ma=
y
> not be Hebrew.

yes, you have a queryparser parsing ambiguity because " is also the
phrase operator.
I don't know what to recommend here off the top of my head... do you
allow phrase queries?

also as an fyi, when i say according to unicode they should be using
gershayim instead of double-quote, this is a little theoretical.
its not very user-friendly to expect users to use gershayim for input,
when its not even on hebrew keyboard layout...!

http://en.wikipedia.org/wiki/Hebrew_keyboard#Inaccessible_punctuation

--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42195-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 14:47:50 2009
Return-Path: <java-user-return-42195-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34376 invoked from network); 7 Sep 2009 14:47:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 14:47:50 -0000
Received: (qmail 3100 invoked by uid 500); 7 Sep 2009 14:47:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3013 invoked by uid 500); 7 Sep 2009 14:47:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3003 invoked by uid 99); 7 Sep 2009 14:47:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 14:47:47 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 14:47:35 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id C6BA069209
	for <java-user@lucene.apache.org>; Mon,  7 Sep 2009 10:47:13 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Mon, 07 Sep 2009 10:47:13 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=T0xZ8Ryi+EIiVyeDZoPpE3WeFbY=; b=jzQqltO/HNtGeKEu1lCZtMlYYR/GOP4TL9pvBdUGNGzsHk6Sdhw/JJaKmZHu1RXIXA1077Cd03R6GlRQ18e2ayIapftf40OU4uNtZ3KtQ0xydmLPtjncwNV49I64iCKYkA2erIraiudCdxyahIQ9MOl6x054d4KpxmlAR8feD+c=
X-Sasl-enc: WbGXC5g7gBbZp7MZxApqGUeQvvLUNqluF4ZrPeF3x3aq 1252334833
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id D0D5A1FBCF
	for <java-user@lucene.apache.org>; Mon,  7 Sep 2009 10:47:12 -0400 (EDT)
Message-ID: <4AA51CEF.5050200@fastmail.fm>
Date: Mon, 07 Sep 2009 15:47:11 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Best way to create own version of StandardTokenizer ?
References: <4AA12FE0.9040408@fastmail.fm>	 <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>	 <4AA1464B.4070002@fastmail.fm>	 <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>	 <4AA4DB70.9050205@fastmail.fm> <8f0ad1f30909070718g4a39d887i387cd35fe1efe090@mail.gmail.com>
In-Reply-To: <8f0ad1f30909070718g4a39d887i387cd35fe1efe090@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Robert Muir wrote:
>> I think we would like to implement the complete unicode rules, so if you
>> could provide us with some code that would be great.
>>     
>
> ok, I will followup... what version of lucene are you using, 2.9?
>
> ...
>   
Yes
>> but having read the
>> details it would seem to convert a half width character you would have to
>> know you were looking at chinese (or korean/japanses ecetera) , but as the
>> Musicbrainz system supports any language and the user doesn't specify the
>> language being used  when searching
>>     
>
> no, theres no language involved... why would you not simply apply the
> filter all the time.
> if i am looking at  (fullwidth character T), it should indexed as T
> everytime (or later probably t if you are going to apply
> lowercasefilter)
>
>   
I'm obviously misunderstanding I thought that Halfwidth  was an encoding 
to allow storing the most common Chinese characters in a single byte, 
therefore the charcters would be read as different characters if you 
assumed they were using the HalfWidth Encoding rather than Latin 
Encoding. But are you saying Halfwidth characters are actually valid 
Unicode characters with their own distinct unicode value   so can just  
use a CharFilter again to map these, please confirm.
>> I assume once again you have to know the script being used in order to do
>> this
>>     
>
> this is ok, because normalization, if you want to do it that way, is
> definitely not language dependent!
> its not like collation, where you have a locale 'parameter', its a
> language-independent process.
> http://unicode.org/reports/tr15/
>
>   
>> I think there are two issues, firstly the data needs to be indexed to always
>> use gerhayim is this what you are suggesting I couldn't follow how to change
>> jflex.
>>     
>
> you are right, for you there are a couple issues.
> first, i do not know what standardtokenizer does with
> geresh/gershayim, forget about single quote/double quote.
>
> but to fix the tokenization (gershayim example), you want to ensure
> you do not split on these.
> since this is used in hebrew acronym, i would modify the acronym rule to allow
>
> [hebrew letter]+ (" | ) [hebrew letter]+
>
> next, if you want these to be indexed the same so that " and 
> will match, you will need to create a tokenfilter
> to standardize " to  for acronyms.
>   
Oh I see , so we convert one to the other, but only when matches 
ACRONYM_TYPE
>   
>> Then its an issue for the query parser that the user uses a " for searching
>> but doesn't escape it, but I cannot automatically escape it because it may
>> not be Hebrew.
>>     
>
> yes, you have a queryparser parsing ambiguity because " is also the
> phrase operator.
> I don't know what to recommend here off the top of my head... do you
> allow phrase queries?
>   
Yes we do , we allow full Lucene syntax if the 'Advanced Query' option 
is selected at http://musicbrainz.org/
> also as an fyi, when i say according to unicode they should be using
> gershayim instead of double-quote, this is a little theoretical.
> its not very user-friendly to expect users to use gershayim for input,
> when its not even on hebrew keyboard layout...!
>
> http://en.wikipedia.org/wiki/Hebrew_keyboard#Inaccessible_punctuation
>
>   
Understood, so I think users will continue to use the Double Quotes 
Character in their searches

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42196-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 15:04:22 2009
Return-Path: <java-user-return-42196-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39145 invoked from network); 7 Sep 2009 15:04:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 15:04:22 -0000
Received: (qmail 26159 invoked by uid 500); 7 Sep 2009 15:04:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26079 invoked by uid 500); 7 Sep 2009 15:04:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26069 invoked by uid 99); 7 Sep 2009 15:04:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 15:04:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.210.193 as permitted sender)
Received: from [209.85.210.193] (HELO mail-yx0-f193.google.com) (209.85.210.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 15:04:08 +0000
Received: by yxe31 with SMTP id 31so5118778yxe.29
        for <java-user@lucene.apache.org>; Mon, 07 Sep 2009 08:03:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=pJqXJiH15L22lViTF6vtOWBaIamjkvJVy1d5R5tFuwg=;
        b=cQ/h4WEDKFrrRq0bBLwzgw0Ct5/+o16pf86xI/lDVgmlWcDHH75Cs5a747vLWtkmZm
         v9WpALVrctTJwBjyBzYxPDnZ0DlpYe+NFqIj4IqK8qbQift1V50I5186/YG9QKfo8iiM
         iCZo8zm5/EXUymLgWeGbb3STwfisNueXIEOSE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=Vqk7jZdenDFC/pP57Iqg9nP1H2lZAX4I15Hx75OKRWA790NP3d+8fZG6g1WeWin6l7
         kxAN3TDWeSC70qTiOsPYSP8jn7jqv1WEM0bv2gYCJa4U9W9po8rO1bHyKbeKClLvHlWD
         6psHsKOSjO1L/3OuBxDVkHUHQsGYVPrYde6Xw=
MIME-Version: 1.0
Received: by 10.101.5.34 with SMTP id h34mr15389503ani.150.1252335827189; Mon, 
	07 Sep 2009 08:03:47 -0700 (PDT)
In-Reply-To: <4AA51CEF.5050200@fastmail.fm>
References: <4AA12FE0.9040408@fastmail.fm>
	 <8f0ad1f30909040902w6edebdefx569d87edc1ba1a89@mail.gmail.com>
	 <4AA1464B.4070002@fastmail.fm>
	 <8f0ad1f30909041027p30883b81v8d0bb181d13b9c99@mail.gmail.com>
	 <4AA4DB70.9050205@fastmail.fm>
	 <8f0ad1f30909070718g4a39d887i387cd35fe1efe090@mail.gmail.com>
	 <4AA51CEF.5050200@fastmail.fm>
Date: Mon, 7 Sep 2009 11:03:47 -0400
Message-ID: <8f0ad1f30909070803t307fece5he1bd114671c9fe3b@mail.gmail.com>
Subject: Re: Best way to create own version of StandardTokenizer ?
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Mon, Sep 7, 2009 at 10:47 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:
> Robert Muir wrote:
>>>
>>> I think we would like to implement the complete unicode rules, so if yo=
u
>>> could provide us with some code that would be great.
>>>
>>
>> ok, I will followup... what version of lucene are you using, 2.9?
>>
>> ...
>>
>
> Yes

I will update LUCENE-1488 with the latest code so you can steal the
ICUTransformFilter from there.

> I'm obviously misunderstanding I thought that Halfwidth =C2=A0was an enco=
ding to
> allow storing the most common Chinese characters in a single byte, theref=
ore
> the charcters would be read as different characters if you assumed they w=
ere
> using the HalfWidth Encoding rather than Latin Encoding. But are you sayi=
ng
> Halfwidth characters are actually valid Unicode characters with their own
> distinct unicode value =C2=A0 so can just =C2=A0use a CharFilter again to=
 map these,
> please confirm.

yes, fullwidth latin forms are distinct characters that have a different wi=
dth:
http://unicode.org/cldr/utility/list-unicodeset.jsp?a=3D[:East_Asian_Width=
=3DFullwidth:]

so yes, you can use charfilter to map these to their standard latin forms.

beware though, there is a similar issue with halfwidth characters:
http://unicode.org/cldr/utility/list-unicodeset.jsp?a=3D[:East_Asian_Width=
=3DHalfwidth:]
example, =EF=BE=85 is halfwidth for the standard =E3=83=8A
so you might want to include mappings for those as well.

the reason i brought up normalization is because this issue (width) is
a subset of things normalization can help with.
if you click on some of the characters in the two sets i provided you
will notice properties like 'toNFKC' containing the 'standardized'
form.

if in the future, you run into trouble with things in other languages
that aren't matching as expected,
because they aren't being considered the "same" when perhaps they
should, then a more general approach would be applying Unicode
normalization form NFKC in a TokenFilter.

--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42197-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 16:11:33 2009
Return-Path: <java-user-return-42197-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55724 invoked from network); 7 Sep 2009 16:11:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 16:11:33 -0000
Received: (qmail 7825 invoked by uid 500); 7 Sep 2009 16:11:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7730 invoked by uid 500); 7 Sep 2009 16:11:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7720 invoked by uid 99); 7 Sep 2009 16:11:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 16:11:31 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of stone54321277@mac.com designates 17.148.16.91 as permitted sender)
Received: from [17.148.16.91] (HELO asmtpout016.mac.com) (17.148.16.91)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 16:11:20 +0000
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed
Received: from [192.168.1.22] (hearts175024120.hearts.ne.jp [203.175.24.120])
 by asmtp016.mac.com
 (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec 16 2008; 32bit))
 with ESMTPA id <0KPL008QJZM6EM50@asmtp016.mac.com> for
 java-user@lucene.apache.org; Mon, 07 Sep 2009 09:10:55 -0700 (PDT)
Message-id: <A2143719-47AE-4E5C-85D9-DCCBCE1DBB1D@mac.com>
From: =?UTF-8?B?6ZaiIOejig==?= <stone54321277@mac.com>
To: java-user@lucene.apache.org
Subject: Best way to understand the "*.frq" file?
Date: Tue, 08 Sep 2009 01:10:53 +0900
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Hello dears,

I an studying the index format of lucene.

But, I really cannot understand the format in "*.frq" file.

Please you help me.

I think an example is very easy to understand.

Thanks for your help.

Kan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42198-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 07 20:43:20 2009
Return-Path: <java-user-return-42198-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21605 invoked from network); 7 Sep 2009 20:43:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Sep 2009 20:43:20 -0000
Received: (qmail 4894 invoked by uid 500); 7 Sep 2009 20:43:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4798 invoked by uid 500); 7 Sep 2009 20:43:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4788 invoked by uid 99); 7 Sep 2009 20:43:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 20:43:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of marcelo.ochoa@gmail.com designates 209.85.210.193 as permitted sender)
Received: from [209.85.210.193] (HELO mail-yx0-f193.google.com) (209.85.210.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Sep 2009 20:43:06 +0000
Received: by yxe31 with SMTP id 31so5380273yxe.29
        for <java-user@lucene.apache.org>; Mon, 07 Sep 2009 13:42:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=vD8hD+gg94WOYksUxRPTjEetp4sOEm515jfxZnWa5RY=;
        b=jezN0URH2S36xGBhy7LrUX74mygLQWbDDCnPw/lG6k1TFI/HiS2wrPXFFLz32cMbdk
         IcXiO0Cusew2//xQ2zQ6vGHstXjYeysareSJmx683Lk5zpxU3mlN3hlXIC5AkOWVTFsm
         wCTV4CQTPTQGl5M9n9BJ99cU/zCYsCvRYDGIY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=brnezKylW14N89I/6SObdznQH8n2VTkEaQ4vYBXyrbujRg0s68djZ4YOEO8bUQP4kz
         BtEczjWEc4rVVBC+OXqbOGI2GOFO2blOjkwpMxWzHQaGOdHLPiusgCKCobVk+F2igDE0
         WrunO/k3nbvA5wnPjoqQPnI7a0nKbr4ZEBIx4=
MIME-Version: 1.0
Received: by 10.150.129.27 with SMTP id b27mr24658998ybd.29.1252356165939; 
	Mon, 07 Sep 2009 13:42:45 -0700 (PDT)
In-Reply-To: <4A982DA1.9090608@gmail.com>
References: <4A9829C2.2000104@apache.org> <4A982DA1.9090608@gmail.com>
Date: Mon, 7 Sep 2009 17:42:45 -0300
Message-ID: <126142c0909071342w65570d6ua666d20be71d50f2@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Marcelo Ochoa <marcelo.ochoa@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All:
   I am already have integrated Lucene 2.9RC2 with Lucene Domain Index:
http://docs.google.com/Doc?id=ddgw7sjp_54fgj9kg
   As usual, a new Lucene version do a fastest product :)
   All my internal test runs OK and I only need to re-test on 10g database.
   Once Lucene 2.9 is ready for production I'll put a new binary
distribution of Lucene Domain Index, updating the docs to reflect the
new functionality of TopFieldCollector which is available from the SQL
layer through the combination of lscore() and lcontains(,,'sort',..)
operators.
   Thanks a lot to all the dev group to release a new great piece of software.
    Best regards, Marcelo.

On Fri, Aug 28, 2009 at 4:18 PM, Mark Miller<markrmiller@gmail.com> wrote:
> Mark Miller wrote:
>>
>> Download release candidate 1 here:
>> http://people.apache.org/~markrmiller/staging-area/lucene2.9rc2/
>>
> In case anyone catches - yes that is a cut and paste typo - should read
> release candidate 2 (obvious, but just to cross my t's).
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
Marcelo F. Ochoa
http://marceloochoa.blogspot.com/
http://marcelo.ochoa.googlepages.com/home
______________
Want to integrate Lucene and Oracle?
http://marceloochoa.blogspot.com/2007/09/running-lucene-inside-your-oracle-jvm.html
Is Oracle 11g REST ready?
http://marceloochoa.blogspot.com/2008/02/is-oracle-11g-rest-ready.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42199-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 11:58:12 2009
Return-Path: <java-user-return-42199-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15302 invoked from network); 8 Sep 2009 11:58:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 11:58:12 -0000
Received: (qmail 85580 invoked by uid 500); 8 Sep 2009 11:58:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85502 invoked by uid 500); 8 Sep 2009 11:58:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85492 invoked by uid 99); 8 Sep 2009 11:58:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 11:58:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of SGreene@metalseconomics.com designates 142.176.162.29 as permitted sender)
Received: from [142.176.162.29] (HELO mail.metalseconomics.com) (142.176.162.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 11:58:01 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA307B.90C9F9D3"
x-cr-puzzleid: {629868DC-61A2-4A11-9A0F-D1C63DD8448D}
Content-class: urn:content-classes:message
Subject: large document with multiple fields performance
x-cr-hashedpuzzle: Bw/V DN21 EK6H EvO8 GRXQ Gq9a HagK Hs3Q IPqv IkAZ I6Cj JFaQ JR1m KPaG KU67 K3fq;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{629868DC-61A2-4A11-9A0F-D1C63DD8448D};cwBnAHIAZQBlAG4AZQBAAG0AZQB0AGEAbABzAGUAYwBvAG4AbwBtAGkAYwBzAC4AYwBvAG0A;Tue, 08 Sep 2009 11:57:32 GMT;bABhAHIAZwBlACAAZABvAGMAdQBtAGUAbgB0ACAAdwBpAHQAaAAgAG0AdQBsAHQAaQBwAGwAZQAgAGYAaQBlAGwAZABzACAAcABlAHIAZgBvAHIAbQBhAG4AYwBlAA==
Date: Tue, 8 Sep 2009 08:57:32 -0300
Message-ID: <A098673D2A673A43849164E87EB3B36101926E0C@copper.meg.local>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: large document with multiple fields performance
Thread-index: Acowe4w18GTBPVU6STy6dZ21jVVuhA==
From: "Stephen Greene" <SGreene@metalseconomics.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA307B.90C9F9D3
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hello,

=20

I am new to lucene and building an application which requires documents
with many fields to be searched.

A "project" id is being stored (not_analyzed) and all matching project
ids will be returned to be used to join other data from a database.

Will it provide better performance to store each comment field in a
separate document with the project ID and a comment ID or to store all
the comments for a single project in a single document with multiple
fields?

=20

Thanks,

=20

Steve Greene


------_=_NextPart_001_01CA307B.90C9F9D3--

From java-user-return-42200-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 12:03:52 2009
Return-Path: <java-user-return-42200-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17089 invoked from network); 8 Sep 2009 12:03:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 12:03:52 -0000
Received: (qmail 96223 invoked by uid 500); 8 Sep 2009 12:03:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96147 invoked by uid 500); 8 Sep 2009 12:03:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96137 invoked by uid 99); 8 Sep 2009 12:03:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 12:03:49 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.119] (HELO spunkymail-a20.g.dreamhost.com) (208.97.132.119)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 12:03:39 +0000
Received: from [10.0.0.162] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a20.g.dreamhost.com (Postfix) with ESMTP id 5C5B4E251F
	for <java-user@lucene.apache.org>; Tue,  8 Sep 2009 05:03:17 -0700 (PDT)
Content-Type: text/plain; charset=utf-8; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1075.2)
Subject: Re: Best way to understand the "*.frq" file?
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <A2143719-47AE-4E5C-85D9-DCCBCE1DBB1D@mac.com>
Date: Tue, 8 Sep 2009 08:03:16 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <B897B853-3756-4868-9CCC-F36436934621@apache.org>
References: <A2143719-47AE-4E5C-85D9-DCCBCE1DBB1D@mac.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1075.2)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 7, 2009, at 12:10 PM, =E9=96=A2 =E7=A3=8A wrote:

> Hello dears,
>
> I an studying the index format of lucene.
>
> But, I really cannot understand the format in "*.frq" file.

http://lucene.apache.org/java/2_4_1/fileformats.html

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) =20
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42201-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 12:47:04 2009
Return-Path: <java-user-return-42201-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37387 invoked from network); 8 Sep 2009 12:47:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 12:47:04 -0000
Received: (qmail 57571 invoked by uid 500); 8 Sep 2009 12:47:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57494 invoked by uid 500); 8 Sep 2009 12:47:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57484 invoked by uid 99); 8 Sep 2009 12:47:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 12:47:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.222.192 as permitted sender)
Received: from [209.85.222.192] (HELO mail-pz0-f192.google.com) (209.85.222.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 12:46:52 +0000
Received: by pzk30 with SMTP id 30so1640152pzk.21
        for <java-user@lucene.apache.org>; Tue, 08 Sep 2009 05:46:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=4HyFrRO9HEyUO2qwbKtqNuW7kYVlmFanci0/D2TTCGw=;
        b=aCuTNYGUU3QFXMesTTy6xEnDpdPjhQTs4SqNKplp6ZdFt8id7VAakM6Mn3IVgSNFsv
         4drBXr8MaNSONro2X3ECb3rPIzQAz7beg1i5XdZ7lvGhnfvnJ1s/qLLANpyy7FmxcW2a
         aBdDijm1OhSc4mNRaomqZm8QgETp0BxfuENV8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=lGo0dY/ZtThZCZtxqcg7SDiFqYhAE+j5bwzuYx2iaVG+4o5jNLoo342wvpHO+rUOlE
         GiVNF7TMYYlXMcsXACMNFi3LKfwuCQYTYKTs1rem+A//35/YM8kSDJdPzE9Fp1mpTsUz
         lH30RP4Y1LDnGiituv3xljV+MV9dCjy3mUGnU=
MIME-Version: 1.0
Received: by 10.114.45.13 with SMTP id s13mr6656763was.167.1252413990932; Tue, 
	08 Sep 2009 05:46:30 -0700 (PDT)
In-Reply-To: <A098673D2A673A43849164E87EB3B36101926E0C@copper.meg.local>
References: <A098673D2A673A43849164E87EB3B36101926E0C@copper.meg.local>
Date: Tue, 8 Sep 2009 18:16:30 +0530
Message-ID: <867513fe0909080546n1271ca5er7d55d31d99fc2839@mail.gmail.com>
Subject: Re: large document with multiple fields performance
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00504502964d0aa2d00473105bec
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502964d0aa2d00473105bec
Content-Type: text/plain; charset=ISO-8859-1

Hi Stephen,
Could you clarify more on the requirement. Do you intend to have data in
index as:
Document{
  String Comment;
  String CommentId;
  String ProjectId;
}

How do you intend to index it.. as in the doc structure? Is there  a primary
key there? What would you search on? What would you want to have as the
result?
All said and done, its not really an overhead as long as the number of
fields is within normal bounds.


--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Tue, Sep 8, 2009 at 5:27 PM, Stephen Greene
<SGreene@metalseconomics.com>wrote:

> Hello,
>
>
>
> I am new to lucene and building an application which requires documents
> with many fields to be searched.
>
> A "project" id is being stored (not_analyzed) and all matching project
> ids will be returned to be used to join other data from a database.
>
> Will it provide better performance to store each comment field in a
> separate document with the project ID and a comment ID or to store all
> the comments for a single project in a single document with multiple
> fields?
>
>
>
> Thanks,
>
>
>
> Steve Greene
>
>

--00504502964d0aa2d00473105bec--

From java-user-return-42202-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 13:27:48 2009
Return-Path: <java-user-return-42202-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50663 invoked from network); 8 Sep 2009 13:27:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 13:27:48 -0000
Received: (qmail 65167 invoked by uid 500); 8 Sep 2009 13:27:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65097 invoked by uid 500); 8 Sep 2009 13:27:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65087 invoked by uid 99); 8 Sep 2009 13:27:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 13:27:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of SGreene@metalseconomics.com designates 142.176.162.29 as permitted sender)
Received: from [142.176.162.29] (HELO mail.metalseconomics.com) (142.176.162.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 13:27:36 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
x-cr-puzzleid: {7B65EBCD-3F8B-454A-B4BD-EDB0C5F663C6}
Content-class: urn:content-classes:message
Subject: RE: large document with multiple fields performance
x-cr-hashedpuzzle: AUXz Ar51 A0zp A96P BFFg CW+b ClP7 EHw3 FIBE FY64 GuNa G+Qm HAT/ HBmA KE+h KsIF;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{7B65EBCD-3F8B-454A-B4BD-EDB0C5F663C6};cwBnAHIAZQBlAG4AZQBAAG0AZQB0AGEAbABzAGUAYwBvAG4AbwBtAGkAYwBzAC4AYwBvAG0A;Tue, 08 Sep 2009 13:27:09 GMT;UgBFADoAIABsAGEAcgBnAGUAIABkAG8AYwB1AG0AZQBuAHQAIAB3AGkAdABoACAAbQB1AGwAdABpAHAAbABlACAAZgBpAGUAbABkAHMAIABwAGUAcgBmAG8AcgBtAGEAbgBjAGUA
Date: Tue, 8 Sep 2009 10:27:09 -0300
Message-ID: <A098673D2A673A43849164E87EB3B36101926E3E@copper.meg.local>
In-reply-to: <867513fe0909080546n1271ca5er7d55d31d99fc2839@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: large document with multiple fields performance
Thread-index: AcowgnkokQEPvJd8S5aHTUoZGaC6MQABKIVQ
References: <A098673D2A673A43849164E87EB3B36101926E0C@copper.meg.local> <867513fe0909080546n1271ca5er7d55d31d99fc2839@mail.gmail.com>
From: "Stephen Greene" <SGreene@metalseconomics.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Anshum,

Thank you for your reply. I have two options I am considering.
One would be:
Document {
	String projectID;
	String generalComment;
	String workHistoryComment;
	String environmentalComment;
	String claimsComment;
	...
}

And the document may contain upwards of 20 comment fields.

The other option would be to normalize the data
Document {
	String projectID;
	String commentType;
	String comment;
}

I will need to return only the projectID for all found documents. I have
implemented a custom Collector to capture the projectID for each
document. Then it occurred to me that I might be better served by the
normalized document model. But I am wondering which method will have
better performance: possibly returning 20 documents per hit, or having
to search 20 fields per document? (This also has implications for the
query, as each search term will always search all fields, this is
somewhat easier in the normalized example as opposed to creating 20 "or"
queries.)

Thanks,

Steve

-----Original Message-----
From: Anshum [mailto:anshumg@gmail.com]=20
Sent: Tuesday, September 08, 2009 9:47 AM
To: java-user@lucene.apache.org
Subject: Re: large document with multiple fields performance

Hi Stephen,
Could you clarify more on the requirement. Do you intend to have data in
index as:
Document{
  String Comment;
  String CommentId;
  String ProjectId;
}

How do you intend to index it.. as in the doc structure? Is there  a
primary
key there? What would you search on? What would you want to have as the
result?
All said and done, its not really an overhead as long as the number of
fields is within normal bounds.


--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Tue, Sep 8, 2009 at 5:27 PM, Stephen Greene
<SGreene@metalseconomics.com>wrote:

> Hello,
>
>
>
> I am new to lucene and building an application which requires
documents
> with many fields to be searched.
>
> A "project" id is being stored (not_analyzed) and all matching project
> ids will be returned to be used to join other data from a database.
>
> Will it provide better performance to store each comment field in a
> separate document with the project ID and a comment ID or to store all
> the comments for a single project in a single document with multiple
> fields?
>
>
>
> Thanks,
>
>
>
> Steve Greene
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42203-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 14:38:53 2009
Return-Path: <java-user-return-42203-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72299 invoked from network); 8 Sep 2009 14:38:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 14:38:53 -0000
Received: (qmail 1449 invoked by uid 500); 8 Sep 2009 14:38:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1384 invoked by uid 500); 8 Sep 2009 14:38:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1374 invoked by uid 99); 8 Sep 2009 14:38:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 14:38:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 14:38:40 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Ml1pr-00050t-J0
	for java-user@lucene.apache.org; Tue, 08 Sep 2009 07:38:19 -0700
Message-ID: <25347505.post@talk.nabble.com>
Date: Tue, 8 Sep 2009 07:38:19 -0700 (PDT)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: How to avoid huge index files
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,

I'm using Lucene2.4. I'm developing a web application that using Lucene (via
compass) to do the searches.
I'm intending to deploy the application in Google App Engine
(http://code.google.com/appengine/), which limits files length to be smaller
than 10MB. I've read about the various policies supported by Lucene to limit
the file sizes, but on matter which policy I used and which parameters, the
index files still grew to be lot more the 10MB. Looking at the code, I've
managed to limit the cfs files (predicting the file size in
CompoundFileWriter before closing the file) - I guess that will degrade
performance, but it's OK for now. But now the FDT files are becoming huge
(about 60MB) and I cant identifiy a way to limit those files.

Is there some built-in and correct way to limit these files length? If no,
can someone direct me please how should I tweak the source code to achieve
that?

Thanks for any help.
-- 
View this message in context: http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p25347505.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42204-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 15:40:19 2009
Return-Path: <java-user-return-42204-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92724 invoked from network); 8 Sep 2009 15:40:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 15:40:19 -0000
Received: (qmail 7486 invoked by uid 500); 8 Sep 2009 15:40:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7428 invoked by uid 500); 8 Sep 2009 15:40:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7418 invoked by uid 99); 8 Sep 2009 15:40:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 15:40:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [98.137.26.162] (HELO web112511.mail.gq1.yahoo.com) (98.137.26.162)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 08 Sep 2009 15:40:07 +0000
Received: (qmail 34799 invoked by uid 60001); 8 Sep 2009 15:39:46 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252424386; bh=aej7HaoRBZbB62zDCOHgTAOhfZISC1OcSnKEDtx4ZSA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=rKW8PoCRgtTdVJxKVzTh9Lm3+WTGPhda1EvFZgabVVaMlA6qotgqXAxS2g6QmcpHZAOo0OBQK0Ejntawf3KuyveAD0poMh+YYbInkD49/fUyXIJABuqfnWbSdAij+a00CovXBxfFzKW1Juz0wGWZhWWqWRQSdJ8nrKgTDaoURC0=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=csb31Gig8DigSoluqgnEdmagYl+JuO2blWwRcwtft76YdODS5YT9PKhPSg6rGs1ZEh5F0smGcgW1O/0qr+T5YG4joHjHRoDgR/XLYZhJAuvftNSbpONzH8rvzdbXY0vKb6Y4JK47biFNpr99q7c5/kAKEiDM2zaMwDlF6s+r6jw=;
Message-ID: <350747.32309.qm@web112511.mail.gq1.yahoo.com>
X-YMail-OSG: G16NagEVM1nu61c5KqkCEYE.FusG0qQBYmYzupjDouuwbm3shH5GFelqOaGnM29pFD8JvpuYpdhmGNomHPja7zD3pHHsJSSjM_4UvR6edHr5HkZF1eWSN9ISvueyeH88Ol0Aw2uzhuaY27BXmflJiAPri5isCXsRsaM9Eghkml0B96EtQ0Xmn7uBbtJE_8bmruLeh6xSTvj3BFA__tcrOoEhmZT4OsYAz3kjdRiR4lqBsm7_ajjjS7UCDt9C6GPsmbYmceDnhqUQ8Fwqflvjg5iFaLKg6R9CxQMRBT5i1jU4RayR_TibnBNYoocx6JDpZYI-
Received: from [122.167.223.4] by web112511.mail.gq1.yahoo.com via HTTP; Tue, 08 Sep 2009 08:39:45 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
Date: Tue, 8 Sep 2009 08:39:45 -0700 (PDT)
From: d' Ani <anirbande@yahoo.com>
Subject: How to ead the index contents one by one
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-584196006-1252424385=:32309"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-584196006-1252424385=:32309
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

I am requied to read a compound index db and dump the contents one bu one. =
Its a single field index stred and indexed.=0A=0Ahow do i go about doing it=
. can any body just give some hints=0ARegards,=0AAnirban De=0AYahoo: anirba=
nde=0ASkype: anirbande=0AGtalk : ade.sxc=0A=0A=0A=0A      Love Cricket? Che=
ck out live scores, photos, video highlights and more. Click here http://cr=
icket.yahoo.com
--0-584196006-1252424385=:32309--

From java-user-return-42205-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 17:08:21 2009
Return-Path: <java-user-return-42205-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14475 invoked from network); 8 Sep 2009 17:08:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 17:08:21 -0000
Received: (qmail 46862 invoked by uid 500); 8 Sep 2009 17:08:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46805 invoked by uid 500); 8 Sep 2009 17:08:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46793 invoked by uid 99); 8 Sep 2009 17:08:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 17:08:18 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.216.202 as permitted sender)
Received: from [209.85.216.202] (HELO mail-px0-f202.google.com) (209.85.216.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 17:08:10 +0000
Received: by pxi40 with SMTP id 40so3466636pxi.5
        for <java-user@lucene.apache.org>; Tue, 08 Sep 2009 10:07:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=/D0psUmQEoow4cX7eJj1KNq4+A/bSfJaqwF2MnN5NdI=;
        b=C/hnK37xXQzOBTtBv82YkI/HUWw1FipFePevPzVT/pa43C0n6XLOa76CXpfyM4aPxY
         7znmGKmVir+cIJdBRcWA6hnrzAunVeaACeNYL4ivTApc+HfbqTf5nVLFefLvMDeI1vts
         oehV4RLE5Z2LNz3jRlVj8sfH7lVlNzEW55n1A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=G/RVsqLih3Oj8EqI2u1y9ef/gMcC0mQoMX4YOOatHFrvjyE2KOrUAxZc2t5BKo4SF/
         H7E7c48tzAdxuzSRBdyIM/GdseeG8qDnPQCRoRznRfRvSP45ROjxVYXKLekEYyCQltOO
         oLZXW6yxEDgaS9Rc5DHUTh40VmIOqnrTPOenE=
MIME-Version: 1.0
Received: by 10.114.55.40 with SMTP id d40mr18050073waa.169.1252429668304; 
	Tue, 08 Sep 2009 10:07:48 -0700 (PDT)
In-Reply-To: <A098673D2A673A43849164E87EB3B36101926E3E@copper.meg.local>
References: <A098673D2A673A43849164E87EB3B36101926E0C@copper.meg.local>
	 <867513fe0909080546n1271ca5er7d55d31d99fc2839@mail.gmail.com>
	 <A098673D2A673A43849164E87EB3B36101926E3E@copper.meg.local>
Date: Tue, 8 Sep 2009 22:37:48 +0530
Message-ID: <867513fe0909081007v5a417ee4y297e33537b5cef80@mail.gmail.com>
Subject: Re: large document with multiple fields performance
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636b2ad267c45ed04731401ae
X-Virus-Checked: Checked by ClamAV on apache.org

--001636b2ad267c45ed04731401ae
Content-Type: text/plain; charset=ISO-8859-1

Hey Steve,

I'd suggest you go with the 20 fields (Non normalized) model. I've used much
larger models and they happen to work just fine. Wouldnt be a point
increasing the complexity.
Hope that clarifies things a little atleast :)
--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Tue, Sep 8, 2009 at 6:57 PM, Stephen Greene
<SGreene@metalseconomics.com>wrote:

> Hi Anshum,
>
> Thank you for your reply. I have two options I am considering.
> One would be:
> Document {
>        String projectID;
>        String generalComment;
>        String workHistoryComment;
>        String environmentalComment;
>        String claimsComment;
>        ...
> }
>
> And the document may contain upwards of 20 comment fields.
>
> The other option would be to normalize the data
> Document {
>        String projectID;
>        String commentType;
>        String comment;
> }
>
> I will need to return only the projectID for all found documents. I have
> implemented a custom Collector to capture the projectID for each
> document. Then it occurred to me that I might be better served by the
> normalized document model. But I am wondering which method will have
> better performance: possibly returning 20 documents per hit, or having
> to search 20 fields per document? (This also has implications for the
> query, as each search term will always search all fields, this is
> somewhat easier in the normalized example as opposed to creating 20 "or"
> queries.)
>
> Thanks,
>
> Steve
>
> -----Original Message-----
> From: Anshum [mailto:anshumg@gmail.com]
> Sent: Tuesday, September 08, 2009 9:47 AM
> To: java-user@lucene.apache.org
> Subject: Re: large document with multiple fields performance
>
> Hi Stephen,
> Could you clarify more on the requirement. Do you intend to have data in
> index as:
> Document{
>  String Comment;
>  String CommentId;
>  String ProjectId;
> }
>
> How do you intend to index it.. as in the doc structure? Is there  a
> primary
> key there? What would you search on? What would you want to have as the
> result?
> All said and done, its not really an overhead as long as the number of
> fields is within normal bounds.
>
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>
>
> On Tue, Sep 8, 2009 at 5:27 PM, Stephen Greene
> <SGreene@metalseconomics.com>wrote:
>
> > Hello,
> >
> >
> >
> > I am new to lucene and building an application which requires
> documents
> > with many fields to be searched.
> >
> > A "project" id is being stored (not_analyzed) and all matching project
> > ids will be returned to be used to join other data from a database.
> >
> > Will it provide better performance to store each comment field in a
> > separate document with the project ID and a comment ID or to store all
> > the comments for a single project in a single document with multiple
> > fields?
> >
> >
> >
> > Thanks,
> >
> >
> >
> > Steve Greene
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636b2ad267c45ed04731401ae--

From java-user-return-42206-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 17:31:02 2009
Return-Path: <java-user-return-42206-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22017 invoked from network); 8 Sep 2009 17:31:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 17:31:02 -0000
Received: (qmail 86693 invoked by uid 500); 8 Sep 2009 17:31:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86581 invoked by uid 500); 8 Sep 2009 17:31:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86571 invoked by uid 99); 8 Sep 2009 17:30:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 17:30:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lucene-java-user@adrianbanks.co.uk designates 70.86.129.138 as permitted sender)
Received: from [70.86.129.138] (HELO dumbledore.securesitex.com) (70.86.129.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 17:30:47 +0000
Received: from localhost ([127.0.0.1])
	by dumbledore.securesitex.com with esmtpa (Exim 4.69)
	(envelope-from <lucene-java-user@adrianbanks.co.uk>)
	id 1Ml4WP-0003lE-IW
	for java-user@lucene.apache.org; Tue, 08 Sep 2009 17:30:25 +0000
Received: from 213.106.81.24 ([213.106.81.24]) by adrianbanks.co.uk (Horde
	MIME library) with HTTP; Tue, 08 Sep 2009 17:30:25 +0000
Message-ID: <20090908173025.jxlkm2mw8ogw844s@adrianbanks.co.uk>
Date: Tue, 08 Sep 2009 17:30:25 +0000
From: Adrian Banks <lucene-java-user@adrianbanks.co.uk>
To: java-user@lucene.apache.org
Subject: Combining hits from multiple documents into a single hit
MIME-Version: 1.0
Content-Type: text/plain;
	charset=ISO-8859-1;
	DelSp="Yes";
	format="flowed"
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable
User-Agent: Internet Messaging Program (IMP) H3 (4.1.6)
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - dumbledore.securesitex.com
X-AntiAbuse: Original Domain - lucene.apache.org
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - adrianbanks.co.uk
X-Virus-Checked: Checked by ClamAV on apache.org

[I originally posted this to the Lucene.net mailing list,but it was =20
suggested that I might have more luck here]

I am trying to get a particular search to work and it is proving =20
problematic. The actual source data is quite complex but can be =20
summarised by the following example:

I have articles that are indexed so that they can be searched. Each =20
article also has multiple properties associated with it which are also =20
indexed and searchable. When users search, they can get hits in either =20
the main article or the associated properties. Regardless of where a =20
hit is achieved, the article is returned as a search hit (ie. the =20
properties are never a hit in their own right).

Now for the complexity:

Each property has security on it, which means that for any given user, =20
they may or may not be able to see the property. If a user cannot see =20
a property, they obviously do not get a search hit in it. This =20
security check is proprietary and cannot be done using the typical =20
mechanism of storing a role in the index alongside the other fields in =20
the document.

I currently have a index that contains the articles and properties =20
indexed separately (ie. an article is indexed as a document, and each =20
property has its own document). When a search happens, a hit in =20
article A or a hit in any of the properties of article A should be =20
classed as hit for article A alone, with the scores combined.

Whether or not a user can see a property is not based on the property =20
itself, but on the value of the property. I cannot therefore put the =20
extra security conditions into the query upfront as I don't know the =20
value to filter by.

As an example:

+---------+------------+------------+
| Article | Property 1 | Property 2 |
+---------+------------+------------+
|    A    |     X      |     J      |
|    B    |     Y      |     K      |
|    C    |     Z      |     L      |
+---------+------------+------------+

If a user can see everything, then searching for "B and Y" will return =20
a single search result for article B.

If another user cannot see a property if its value contains Y, then =20
searching for "B and Y" will return no hits.

I have no way of knowing what values a user can and cannot see =20
upfront. They only way to tell is to perform the security check =20
(currently done at the time of filtering a hit from a field in the =20
document), which I obviously cannot do for every possible data value =20
for each user.

To achieve this originally, Lucene v1.3 was modified to allow this to =20
happen by changing BooleanQuery to have a custom Scorer that could =20
apply the logic of the security check and the combination of two hits =20
in different documents being classed as a hit in a single document. I =20
am trying to upgrade this version to the latest (v2.3.2 - I am using =20
Lucene.Net), but ideally without having to modify Lucene in any way.

An additional problem occurs if I do an AND search. If an article =20
contains the word foo and one of its properties contains the word bar, =20
then searching for "foo AND bar" will return the article as a hit. My =20
current code deals with this inside the custom Scorer.

Any ideas how/if this can be done?

I am thinking along the lines of using a custom HitCollector and =20
passing that into the search, but when doing the boolean search "foo =20
AND bar", execution never reaches my HitCollector as the =20
ConjunctionScorer filters out all of the results from the sub-queries =20
before getting there.

Thanks,

Adrian



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42207-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 18:58:10 2009
Return-Path: <java-user-return-42207-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54032 invoked from network); 8 Sep 2009 18:58:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 18:58:10 -0000
Received: (qmail 11306 invoked by uid 500); 8 Sep 2009 18:58:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11230 invoked by uid 500); 8 Sep 2009 18:58:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11220 invoked by uid 99); 8 Sep 2009 18:58:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 18:58:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 18:57:59 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 8129A71C378; Tue,  8 Sep 2009 11:57:38 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 7AEE071C347
	for <java-user@lucene.apache.org>; Tue,  8 Sep 2009 11:57:38 -0700 (PDT)
Date: Tue, 8 Sep 2009 11:57:38 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: RE: New "Stream closed" exception with Java 6
In-Reply-To: <821717001.23001252060449019.JavaMail.root@mail.uk.scalix.com>
Message-ID: <Pine.LNX.4.64.0909081153220.3997@radix.cryptio.net>
References: <821717001.23001252060449019.JavaMail.root@mail.uk.scalix.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: I'm coming to the same conclusion - there must be >1 threads accessing this index at the same time.  Better go figure it out  ...  :-)

careful about your assumptions ... you could get this same type of 
exception even with only one thread, the stream that's being closed isn't 
internal to Lucene, it's the InputStreamReader you supplied as the value 
of some Field.  it's possibly you just have a simple bug where you are 
closing hte reader before you pass it to Lucene, or maybe you are 
mistakenly adding the saame field twice (or in two different documents)


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42208-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 19:07:30 2009
Return-Path: <java-user-return-42208-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57071 invoked from network); 8 Sep 2009 19:07:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 19:07:30 -0000
Received: (qmail 31662 invoked by uid 500); 8 Sep 2009 19:07:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31583 invoked by uid 500); 8 Sep 2009 19:07:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31573 invoked by uid 99); 8 Sep 2009 19:07:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 19:07:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 19:07:17 +0000
Received: by qw-out-2122.google.com with SMTP id 9so111584qwb.53
        for <java-user@lucene.apache.org>; Tue, 08 Sep 2009 12:06:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=JZ0CAlob+tDRpvLZks9hcSPPvd/wPHn5JNtTzUQTE2Y=;
        b=U0vf4z/yDIgKzAcvmU1PSvhw2mdZDr0+Kow1u+kbsxoadYnuYEPGEit06Bh2svCoSl
         oICewVdK6vkijfYWh0diTyT9+VfpQUl+0bLBGZP0Xi0k86oykLqWDKw48k+6kfQbgG8O
         AVwqAYY0X7uYkogZNPo8O88Z7QjiNslYaQsAA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=kMcq0UjA4nUuE9UL0Fm1gjN0xRVKGepzJ1mHTeZ7mngoo+ldHEl0BxKH76rYX/KK/Q
         UYbVJXMve6hSO+M++L6MILBf4A0aLygBkhZ2+JXvyQmzsemvGjbGvUXkrWG18bazBruP
         UDBx9nseSlE00pIBAs3HaRxDWw0Iu3hY0vEaM=
Received: by 10.224.26.92 with SMTP id d28mr10291068qac.301.1252436816099;
        Tue, 08 Sep 2009 12:06:56 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm25082qwf.6.2009.09.08.12.06.55
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 08 Sep 2009 12:06:55 -0700 (PDT)
Message-ID: <4AA6AB4F.8050209@gmail.com>
Date: Tue, 08 Sep 2009 15:06:55 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: New "Stream closed" exception with Java 6
References: <821717001.23001252060449019.JavaMail.root@mail.uk.scalix.com> <Pine.LNX.4.64.0909081153220.3997@radix.cryptio.net>
In-Reply-To: <Pine.LNX.4.64.0909081153220.3997@radix.cryptio.net>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Chris Hostetter wrote:
> : I'm coming to the same conclusion - there must be >1 threads accessing this index at the same time.  Better go figure it out  ...  :-)
>
> careful about your assumptions ... you could get this same type of 
> exception even with only one thread, the stream that's being closed isn't 
> internal to Lucene, it's the InputStreamReader you supplied as the value 
> of some Field.  it's possibly you just have a simple bug where you are 
> closing hte reader before you pass it to Lucene, or maybe you are 
> mistakenly adding the saame field twice (or in two different documents)
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   
Its possible its something tricky. When I was converting the Highlighter
to the new TokenStream API, I started to
get this exception in the Highlighter rewrite test - everything else
passed, but this was failing. I couldn't figure it out - and
before I could find the root cause, all the tests started passing
(perhaps from changing code doing other things, rebuilding, or who knows
- I don't have a clue). I couldn't get it to fail again after that.

Not very helpful - but just to note, there were not multiple threads
involved concurrently, nor multiple Writers.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42209-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 20:44:23 2009
Return-Path: <java-user-return-42209-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86084 invoked from network); 8 Sep 2009 20:44:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 20:44:23 -0000
Received: (qmail 83645 invoked by uid 500); 8 Sep 2009 20:44:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83571 invoked by uid 500); 8 Sep 2009 20:44:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83561 invoked by uid 99); 8 Sep 2009 20:44:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 20:44:21 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 20:44:08 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id BCFDB64FC4
	for <java-user@lucene.apache.org>; Tue,  8 Sep 2009 16:43:47 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute2.internal (MEProxy); Tue, 08 Sep 2009 16:43:47 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=tnazF+ZUUUDJk4+q3U/RIYFTeIk=; b=D9VUL2X7B91Mb4+cRZ4n4XLKWSBsKAXEdK9Ij2cKABc8fFCmMr7xaLNX0i5kEFmB+G8DXpl3uzJmbjwiAD4JTT2In8ESLosMRIqPrVJbw90oQC6lJPxvElN8X+WkbmmhNO9mdqzsToe8m+bZRHyrLUV4EYVufcEoVPkDr+K+5HY=
X-Sasl-enc: ijCrtMQXGs/ElZ2vTasLPXxrpOmOm58y7O9zYZrQAD/4 1252442627
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 253A3687C2
	for <java-user@lucene.apache.org>; Tue,  8 Sep 2009 16:43:47 -0400 (EDT)
Message-ID: <4AA6C202.8090406@fastmail.fm>
Date: Tue, 08 Sep 2009 21:43:46 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Is there way to get complete start end matches to be first in the
 list ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Is there way to get complete start end matches to be first in the list

We use Lucene to search song albums titles typically one to ten words 
long. If the user enter something like 'foo bar' everything that 
contains foo bar is returned with max score , thats fine but it would be 
better if an exact match is right at the top. Also although an OR Search 
has been entered would be great if that it ranked matches where both 
words are together higher than when they are not , but still return 
results that only match one condirtion.

 Ideally giving results in this order

    * Foo Bar (exact match)
    * The Foo Bar Somethings (substring - exact match)
    * Bar Foo (all terms match)
    * Bar Baz and the Foo (substring - all terms match)
    * Foo (some terms match)
    * Foo Something (substring - some terms match)


Is there something I can do in Lucene, or some way I can modify the 
query (as entered by the user) to get results better aproaching this


Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42210-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 20:52:12 2009
Return-Path: <java-user-return-42210-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91274 invoked from network); 8 Sep 2009 20:52:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 20:52:12 -0000
Received: (qmail 1855 invoked by uid 500); 8 Sep 2009 20:52:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1781 invoked by uid 500); 8 Sep 2009 20:52:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1771 invoked by uid 99); 8 Sep 2009 20:52:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 20:52:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mbarbarelli@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 20:52:02 +0000
Received: by fxm18 with SMTP id 18so353943fxm.5
        for <java-user@lucene.apache.org>; Tue, 08 Sep 2009 13:51:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=b1f5ROYb3JCmlYCp4is4aUzG08Bxr48VKB7M9OpWFZE=;
        b=JfJWQ3Ni+MTazeYdExP5U4KucdWJ79yyKf94NVe32jZU5iWkMOVmyBa3QCM37dFzAK
         OYKXk5sREjYMS9dcpkVJ1GMA0nzb7DmHjBqnksqUaUNU2Ft16ySw0XfLFCz4i4D+IvpB
         XtazXdP8CQgAKU3kLHJwU8kRNcNcDf4yWi8Ws=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=IrOH+WZzw5d63oDwkscB6TXtZhPyJ7P2A08GJdB9zSSlJyHPSWFKBdH9j2JTCSYQqC
         YGEczb0azewNi4PM2E8zNTaZArbS/1oNJz3HUvT6G4sMtip096/zCxrG5khzyGYFfV95
         HxmLc/YMdCH19nT56AMSZRD2qaHFeeAhZvyz0=
MIME-Version: 1.0
Received: by 10.204.154.82 with SMTP id n18mr13678181bkw.128.1252443100568; 
	Tue, 08 Sep 2009 13:51:40 -0700 (PDT)
In-Reply-To: <a258c0620909081347n6a96d02fxa5994815f5515418@mail.gmail.com>
References: <4AA6C202.8090406@fastmail.fm>
	 <a258c0620909081347n6a96d02fxa5994815f5515418@mail.gmail.com>
Date: Tue, 8 Sep 2009 21:51:40 +0100
Message-ID: <a258c0620909081351r27f46e07k700871454c1e1eed@mail.gmail.com>
Subject: Re: Is there way to get complete start end matches to be first in the 
	list ?
From: Michael Barbarelli <mbarbarelli@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=0015175cac181c5db8047317226e
X-Virus-Checked: Checked by ClamAV on apache.org

--0015175cac181c5db8047317226e
Content-Type: text/plain; charset=ISO-8859-1

What I do is run each entry in the hits collection through a home-rolled
levenstein distance algorithm to obtain a score. Then I sort by score.

On Sep 8, 2009 9:44 PM, "Paul Taylor" <paul_t100@fastmail.fm> wrote:

Is there way to get complete start end matches to be first in the list

We use Lucene to search song albums titles typically one to ten words long.
If the user enter something like 'foo bar' everything that contains foo bar
is returned with max score , thats fine but it would be better if an exact
match is right at the top. Also although an OR Search has been entered would
be great if that it ranked matches where both words are together higher than
when they are not , but still return results that only match one condirtion.

Ideally giving results in this order

  * Foo Bar (exact match)
  * The Foo Bar Somethings (substring - exact match)
  * Bar Foo (all terms match)
  * Bar Baz and the Foo (substring - all terms match)
  * Foo (some terms match)
  * Foo Something (substring - some terms match)


Is there something I can do in Lucene, or some way I can modify the query
(as entered by the user) to get results better aproaching this


Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

--0015175cac181c5db8047317226e--

From java-user-return-42211-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 22:25:09 2009
Return-Path: <java-user-return-42211-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32373 invoked from network); 8 Sep 2009 22:25:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 22:25:09 -0000
Received: (qmail 13333 invoked by uid 500); 8 Sep 2009 22:25:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13263 invoked by uid 500); 8 Sep 2009 22:25:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13253 invoked by uid 99); 8 Sep 2009 22:25:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 22:25:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 22:24:59 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 5BFB471C479; Tue,  8 Sep 2009 15:24:38 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 30DBB71C45A
	for <java-user@lucene.apache.org>; Tue,  8 Sep 2009 15:24:38 -0700 (PDT)
Date: Tue, 8 Sep 2009 15:24:38 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Filtering question/advice
In-Reply-To: <6f4104d80909040238i877609ev65a2f284c07a99df@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0909081521040.26698@radix.cryptio.net>
References: <6f4104d80909040217yd24a342t22232a9b4f217fbb@mail.gmail.com>
 <6f4104d80909040238i877609ev65a2f284c07a99df@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org

: Hi
: I include a testcase to show what I am trying to do.  Testcase number 3
: fails.

the mailing list is finicky about attachments ... the best thing to do is 
to include your test case directly in the body of your email as plain 
text.

: > I created a test case to test this solution and it works. The problem is
: > that if UWB searches for "HELLO" that exists in another field such as:
: > data:HELLO then he should get a result. It's only when the query is matched
: > on reference he should not see anything.  My testcase fails when the match
: > is made on the data field as the security filter does not pass (valid
: > filter).  Is there a way around this?  Hope this made sense!

it sounds like perhaps you just need to group your clauses...

  data:HELLO (uw-reference:HELLO +uw-uwb:HELLO)

...if HELLO is in data, you'll get a match regardless of the other fields.  
if it's not in data, but it is in uw-reference, it will only match if it's 
also in uw-uwb.




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42212-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 22:37:12 2009
Return-Path: <java-user-return-42212-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48679 invoked from network); 8 Sep 2009 22:37:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 22:37:12 -0000
Received: (qmail 23819 invoked by uid 500); 8 Sep 2009 22:29:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23745 invoked by uid 500); 8 Sep 2009 22:29:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23735 invoked by uid 99); 8 Sep 2009 22:29:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 22:29:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 22:29:42 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 81EF971C479; Tue,  8 Sep 2009 15:29:21 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 7F86D71C45A
	for <java-user@lucene.apache.org>; Tue,  8 Sep 2009 15:29:21 -0700 (PDT)
Date: Tue, 8 Sep 2009 15:29:21 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Extending Sort/FieldCache
In-Reply-To: <786fde50909040919m79acc828sffc35a737f83cec5@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0909081525580.26698@radix.cryptio.net>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com> 
 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net> 
 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com> 
 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net> 
 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com> 
 <9ac0c6aa0909040217j7c91b234p9243b9fb86b3d170@mail.gmail.com>
 <786fde50909040919m79acc828sffc35a737f83cec5@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Thanks Mike. I did not phrase well my understanding of Cache reload. I
: didn't mean literally as part of the reopen, but *because* of the reopen.
: Because FieldCache is tied to an IndexReader instance, after reopen it gets
: refreshed. If I keep my own Cache, I'll need to code that logic, and I
: prefer to use what's currently in Lucene. (Sloth? :) )

but there is no actually refresh anywhere in Lucene ... the first time 
it's used on a reader, it's cached.  when that reader gets garbage 
collected, it's remved from the cache.  the only way the reopen/segment 
level sorting changed things is that in a multireader the indexreader refs 
put in the cache are all segment readers ... so if you reopen a 
multireader only the changed segments will need to be added to hte cache 
(the others will still be there)

but extending FieldCache doesn't really help you get any reuse out of that 
that you couldn't get with your own weakhashmap keyed on indexreaders -- 
the sorting code will always give your custom Sort the segment readers.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42213-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 22:38:50 2009
Return-Path: <java-user-return-42213-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50405 invoked from network); 8 Sep 2009 22:38:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 22:38:50 -0000
Received: (qmail 27819 invoked by uid 500); 8 Sep 2009 22:31:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27740 invoked by uid 500); 8 Sep 2009 22:31:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27729 invoked by uid 99); 8 Sep 2009 22:31:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 22:31:28 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 22:31:17 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id D3A1A68F1E;
	Tue,  8 Sep 2009 18:30:55 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute1.internal (MEProxy); Tue, 08 Sep 2009 18:30:55 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=wGX/JhWLOnmgH/6MOTxPHwhnV/U=; b=cBennYp/WwtjpWc5qXbQdXVwRgg2RIlCk67265/6KKGNvEqaJxv5j70ighv/nTlNzhLMNMi8K3t12HDZuNvlHPcCOLSuSeLxmQNdKIKLumPAP+wYTgv8uPX2wYAliaUCaVZTyaJoHwfriMDhKCoQtZj+8ulshNJg9woH93ufsnM=
X-Sasl-enc: WiKnh4ldAPw8oKOdwc5WUUNFvqP2NcQ8Dzr2nwqmbeGr 1252449055
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 0699821203;
	Tue,  8 Sep 2009 18:30:54 -0400 (EDT)
Message-ID: <4AA6DB1E.2040107@fastmail.fm>
Date: Tue, 08 Sep 2009 23:30:54 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: Michael Barbarelli <mbarbarelli@gmail.com>
CC: java-user@lucene.apache.org
Subject: Re: Is there way to get complete start end matches to be first in
 the 	list ?
References: <4AA6C202.8090406@fastmail.fm>	 <a258c0620909081347n6a96d02fxa5994815f5515418@mail.gmail.com> <a258c0620909081351r27f46e07k700871454c1e1eed@mail.gmail.com>
In-Reply-To: <a258c0620909081351r27f46e07k700871454c1e1eed@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael Barbarelli wrote:
>
> What I do is run each entry in the hits collection through a 
> home-rolled levenstein distance algorithm to obtain a score. Then I 
> sort by score.
>
>> On Sep 8, 2009 9:44 PM, "Paul Taylor" <paul_t100@fastmail.fm 
>> <mailto:paul_t100@fastmail.fm>> wrote:
>>
>> Is there way to get complete start end matches to be first in the list
>>
>> We use Lucene to search song albums titles typically one to ten words 
>> long. If the user enter something like 'foo bar' everything that 
>> contains foo bar is returned with max score , thats fine but it would 
>> be better if an exact match is right at the top. Also although an OR 
>> Search has been entered would be great if that it ranked matches 
>> where both words are together higher than when they are not , but 
>> still return results that only match one condirtion.
>>
>> Ideally giving results in this order
>>
>>   * Foo Bar (exact match)
>>   * The Foo Bar Somethings (substring - exact match)
>>   * Bar Foo (all terms match)
>>   * Bar Baz and the Foo (substring - all terms match)
>>   * Foo (some terms match)
>>   * Foo Something (substring - some terms match)
>>
>>
>> Is there something I can do in Lucene, or some way I can modify the 
>> query (as entered by the user) to get results better aproaching this
>>
>>
>> Paul
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org 
>> <mailto:java-user-unsubscribe@lucene.apache.org>
>> For additional commands, e-mail: java-user-help@lucene.apache.org 
>> <mailto:java-user-help@lucene.apache.org>
>>
Thats sounds like the right algorithm but cannot this be done within 
Lucene. The trouble is say I get a 1000 hits, I only want the first 10 
but if I openly apply the algorithm to the first ten it might miss out 
on the 11th which should really be the 5th, but if have to get all 1000 
docs and apply algorithm its going to be a bit of an overhead.

Code excerpt might make it clearer:
        TopScoreDocCollector collector = 
TopScoreDocCollector.create(offset + limit, true);
        searcher.search(parser.parse(query), collector);
        Results results = new Results();
        TopDocs topDocs = collector.topDocs();
        results.offset = offset;
        results.totalHits = topDocs.totalHits;
        ScoreDoc docs[] = topDocs.scoreDocs;
        float maxScore = topDocs.getMaxScore();
        for (int i = offset; i < docs.length; i++) {
            Result result = new Result();
            result.score = docs[i].score / maxScore;
            result.doc = new MbDocument(searcher.doc(docs[i].doc));
            results.results.add(result);
        }
        return results;

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42214-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 08 22:40:27 2009
Return-Path: <java-user-return-42214-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51484 invoked from network); 8 Sep 2009 22:40:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Sep 2009 22:40:26 -0000
Received: (qmail 41340 invoked by uid 500); 8 Sep 2009 22:40:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41254 invoked by uid 500); 8 Sep 2009 22:40:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41243 invoked by uid 99); 8 Sep 2009 22:40:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 22:40:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Sep 2009 22:40:15 +0000
Received: by ewy28 with SMTP id 28so465480ewy.28
        for <java-user@lucene.apache.org>; Tue, 08 Sep 2009 15:39:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        bh=XfeGj0acM9ue1NaH3rA11azn3oafC/PhgSkBt6iqPXQ=;
        b=R34wjgDVDGHr9GXSBpoVjGqNYNekx6o6Co0F1n3MGSfoTslzkZogAwdst2BPQtNaCv
         6iItP9+3/nh9Pfiqym4BnNt0PMOq6NTHcssuLhV/Fpj5uBUvFwlAMlRdK5GsRO4ZHqjA
         BXtX/CleX8BtU21/QXDFIh9KYrpg66Uz2VMZs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=bvXIDaNRfFd98URPB7uw6EijoidGFVQndnalG+w4oEg2rrenzhKSYEE6BNUSdshkQn
         ZNZRbvRWG006PsTfspLhkVW1s0Y4/+lNfulkcllsQ60LB38tDFly8ZWscjiLv60Bni+I
         E3h2vvKD781bDW4ubohxoJnSFsCATqaOc9uI0=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.216.8.212 with SMTP id 62mr1969335wer.81.1252449593619; Tue, 
	08 Sep 2009 15:39:53 -0700 (PDT)
In-Reply-To: <786fde50909060142y7ba2367fj21cd4a16cb3517ed@mail.gmail.com>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
	 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
	 <c68e39170909050845s506025bdvc92903e4704d6b69@mail.gmail.com>
	 <786fde50909060142y7ba2367fj21cd4a16cb3517ed@mail.gmail.com>
Date: Tue, 8 Sep 2009 18:39:53 -0400
X-Google-Sender-Auth: e6103a5c61b1747b
Message-ID: <c68e39170909081539r438e5545m3ca8c934aef13b6b@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Sun, Sep 6, 2009 at 4:42 AM, Shai Erera<serera@gmail.com> wrote:
>> I've resisted using payloads for this purpose in Solr because it felt
>> like an interim hack until CSF is implemented.
>
> I don't see it as a hack, but as a proper use of a great feature in Lucene.

It's proper use for an application perhaps, but not for core Lucene.
Applications are pretty much required to work with what's given in
Lucene... but Lucene developers can make better choices.  Hence if at
all possible, work should be put into implementing CSF rather than
sorting by payloads.

> CSF and this are essentially the same.

In which case we wouldn't need CSF?

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42215-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 03:45:18 2009
Return-Path: <java-user-return-42215-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85200 invoked from network); 9 Sep 2009 03:45:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 03:45:18 -0000
Received: (qmail 79485 invoked by uid 500); 9 Sep 2009 03:45:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79327 invoked by uid 500); 9 Sep 2009 03:45:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79317 invoked by uid 99); 9 Sep 2009 03:45:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 03:45:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 03:45:05 +0000
Received: by ewy28 with SMTP id 28so612669ewy.28
        for <java-user@lucene.apache.org>; Tue, 08 Sep 2009 20:44:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=yFwkDCO1fssBXEfqxOZN6a2lcmVSa8lZApwrW6XBdio=;
        b=ckOKw7745rF3iATNKXyPBr8jTwtbTYUG5ZgI+5oykUKmQzt3aKV0gFxeyoScVDEM6D
         TmQuhxfgWGYTzkuNT7bWvumU2lwT7y9zJl/2of9bFhv2pKhzZ7+cvkcEHiJUupvonVD+
         zXKrX7bjpgvZMjkD1c4TJXmSyRa710qmvh5ew=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=mA7/R1Hws+FBNXOUfYJJ2p0fXjYPfwID/1Peh19g8s3XKdc/WsvHwq2/g0h8UGDHnR
         9623Jz2y/hLXMTpXO85VnB8gH1Mpd2X4Vk0T7R+ZHviOAt/WySlKeBw1XpMr0B+WoNUv
         QgVDiHbej+5caupWJAQFNW0w0ZWg4069RuJdw=
MIME-Version: 1.0
Received: by 10.216.28.66 with SMTP id f44mr1866081wea.28.1252467885457; Tue, 
	08 Sep 2009 20:44:45 -0700 (PDT)
In-Reply-To: <4AA6DB1E.2040107@fastmail.fm>
References: <4AA6C202.8090406@fastmail.fm>
	 <a258c0620909081347n6a96d02fxa5994815f5515418@mail.gmail.com>
	 <a258c0620909081351r27f46e07k700871454c1e1eed@mail.gmail.com>
	 <4AA6DB1E.2040107@fastmail.fm>
Date: Wed, 9 Sep 2009 06:44:45 +0300
Message-ID: <786fde50909082044q250e9a6w9a15fc3f5f6641a8@mail.gmail.com>
Subject: Re: Is there way to get complete start end matches to be first in the 
	list ?
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=0016e6d6233667c02e04731ce7e3
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d6233667c02e04731ce7e3
Content-Type: text/plain; charset=ISO-8859-1

I can think of a way where you rely solely on scores and therefore there is
still chance to get results not ordered the way you want, but you can try it
- run the query [foo bar OR "foo bar"^10]. That way, your first result
should be scored by [foo], [bar] and ["foo bar"]. Also, the phrase is added
a score modifier so that it will score 10 times more than regular matches.
You can change it to 2, 5, 100 whichever works for you.

There is still some remote chance that the above approach will rank a "bar
foo" higher than "foo bar" but it depends on your content. If you don't
think this can happen in your content, then I'd try to above query.

Shai

On Wed, Sep 9, 2009 at 1:30 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:

> Michael Barbarelli wrote:
>
>>
>> What I do is run each entry in the hits collection through a home-rolled
>> levenstein distance algorithm to obtain a score. Then I sort by score.
>>
>>  On Sep 8, 2009 9:44 PM, "Paul Taylor" <paul_t100@fastmail.fm <mailto:
>>> paul_t100@fastmail.fm>> wrote:
>>>
>>> Is there way to get complete start end matches to be first in the list
>>>
>>> We use Lucene to search song albums titles typically one to ten words
>>> long. If the user enter something like 'foo bar' everything that contains
>>> foo bar is returned with max score , thats fine but it would be better if an
>>> exact match is right at the top. Also although an OR Search has been entered
>>> would be great if that it ranked matches where both words are together
>>> higher than when they are not , but still return results that only match one
>>> condirtion.
>>>
>>> Ideally giving results in this order
>>>
>>>  * Foo Bar (exact match)
>>>  * The Foo Bar Somethings (substring - exact match)
>>>  * Bar Foo (all terms match)
>>>  * Bar Baz and the Foo (substring - all terms match)
>>>  * Foo (some terms match)
>>>  * Foo Something (substring - some terms match)
>>>
>>>
>>> Is there something I can do in Lucene, or some way I can modify the query
>>> (as entered by the user) to get results better aproaching this
>>>
>>>
>>> Paul
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org <mailto:
>>> java-user-unsubscribe@lucene.apache.org>
>>> For additional commands, e-mail: java-user-help@lucene.apache.org<mailto:
>>> java-user-help@lucene.apache.org>
>>>
>>>  Thats sounds like the right algorithm but cannot this be done within
> Lucene. The trouble is say I get a 1000 hits, I only want the first 10 but
> if I openly apply the algorithm to the first ten it might miss out on the
> 11th which should really be the 5th, but if have to get all 1000 docs and
> apply algorithm its going to be a bit of an overhead.
>
> Code excerpt might make it clearer:
>       TopScoreDocCollector collector = TopScoreDocCollector.create(offset +
> limit, true);
>       searcher.search(parser.parse(query), collector);
>       Results results = new Results();
>       TopDocs topDocs = collector.topDocs();
>       results.offset = offset;
>       results.totalHits = topDocs.totalHits;
>       ScoreDoc docs[] = topDocs.scoreDocs;
>       float maxScore = topDocs.getMaxScore();
>       for (int i = offset; i < docs.length; i++) {
>           Result result = new Result();
>           result.score = docs[i].score / maxScore;
>           result.doc = new MbDocument(searcher.doc(docs[i].doc));
>           results.results.add(result);
>       }
>       return results;
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d6233667c02e04731ce7e3--

From java-user-return-42216-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 03:46:59 2009
Return-Path: <java-user-return-42216-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85576 invoked from network); 9 Sep 2009 03:46:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 03:46:59 -0000
Received: (qmail 81479 invoked by uid 500); 9 Sep 2009 03:46:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81382 invoked by uid 500); 9 Sep 2009 03:46:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81372 invoked by uid 99); 9 Sep 2009 03:46:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 03:46:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 03:46:46 +0000
Received: by ewy28 with SMTP id 28so613295ewy.28
        for <java-user@lucene.apache.org>; Tue, 08 Sep 2009 20:46:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=xGUhqlzrr9OantA3q2sGMIGJCjmgrtrE0rpb4t3YI5g=;
        b=SadTHkfadYYvzzMaNQF8kD1PXHjTXRWwjuzeDWcMQj9dbC7+7xlLR6Ym1/4OOglqLE
         uOOPFlBKChhWUNiAXkaLsT/SoFH+5uge/9/NVQ39e8EoMm5+3/sDUickfPk59NOzSYWz
         1ObfGarjKee6Y90CeY+/afL6FVM2eBHsAMv7k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=W0V0cyYupOC6+0jPZRu7BTkj+4ShPe6jLIl+ApCaJujn6nHV97aToJy9StCBHO5cSQ
         ig3IPh98pHrArqxEiRd3t008xBPXj1Q4MK8YkdLAuOqN8taqetcb7baPYXsBCtPn8dU7
         sg7857tnxMXmGDunxJG98BXuQgneT46x5G4c4=
MIME-Version: 1.0
Received: by 10.216.90.203 with SMTP id e53mr2047781wef.28.1252467984720; Tue, 
	08 Sep 2009 20:46:24 -0700 (PDT)
In-Reply-To: <c68e39170909081539r438e5545m3ca8c934aef13b6b@mail.gmail.com>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
	 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
	 <c68e39170909050845s506025bdvc92903e4704d6b69@mail.gmail.com>
	 <786fde50909060142y7ba2367fj21cd4a16cb3517ed@mail.gmail.com>
	 <c68e39170909081539r438e5545m3ca8c934aef13b6b@mail.gmail.com>
Date: Wed, 9 Sep 2009 06:46:24 +0300
Message-ID: <786fde50909082046o2ca90e9cl86738737ed870f59@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org, yonik@lucidimagination.com
Content-Type: multipart/alternative; boundary=0016e6d7e32d52650104731cede8
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d7e32d52650104731cede8
Content-Type: text/plain; charset=ISO-8859-1

I didn't say we won't need CSF, but that at least conceptually, CSF and my
sort-by-payload are the same. If however it turns out that CSF performs
better, then I'll definitely switch my sort-by-payload package to use it. I
thought that CSF is going to be implemented using payloads, but perhaps I'm
wrong.

Shai

On Wed, Sep 9, 2009 at 1:39 AM, Yonik Seeley <yonik@lucidimagination.com>wrote:

> On Sun, Sep 6, 2009 at 4:42 AM, Shai Erera<serera@gmail.com> wrote:
> >> I've resisted using payloads for this purpose in Solr because it felt
> >> like an interim hack until CSF is implemented.
> >
> > I don't see it as a hack, but as a proper use of a great feature in
> Lucene.
>
> It's proper use for an application perhaps, but not for core Lucene.
> Applications are pretty much required to work with what's given in
> Lucene... but Lucene developers can make better choices.  Hence if at
> all possible, work should be put into implementing CSF rather than
> sorting by payloads.
>
> > CSF and this are essentially the same.
>
> In which case we wouldn't need CSF?
>
> -Yonik
> http://www.lucidimagination.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d7e32d52650104731cede8--

From java-user-return-42217-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 06:39:15 2009
Return-Path: <java-user-return-42217-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39193 invoked from network); 9 Sep 2009 06:39:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 06:39:15 -0000
Received: (qmail 1272 invoked by uid 500); 9 Sep 2009 06:39:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1194 invoked by uid 500); 9 Sep 2009 06:39:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1184 invoked by uid 99); 9 Sep 2009 06:39:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 06:39:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 06:39:03 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MlGpG-0005y4-VY
	for java-user@lucene.apache.org; Tue, 08 Sep 2009 23:38:42 -0700
Message-ID: <25359411.post@talk.nabble.com>
Date: Tue, 8 Sep 2009 23:38:42 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: get all tokens from index
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


hello all ,

       is there any way to get all tokens from my index ? please anyone
suggest me
-- 
View this message in context: http://www.nabble.com/get-all-tokens-from-index-tp25359411p25359411.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42218-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 07:08:45 2009
Return-Path: <java-user-return-42218-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49629 invoked from network); 9 Sep 2009 07:08:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 07:08:45 -0000
Received: (qmail 33086 invoked by uid 500); 9 Sep 2009 07:08:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33020 invoked by uid 500); 9 Sep 2009 07:08:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33008 invoked by uid 99); 9 Sep 2009 07:08:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 07:08:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.11] (HELO web52901.mail.re2.yahoo.com) (206.190.49.11)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 09 Sep 2009 07:08:33 +0000
Received: (qmail 37235 invoked by uid 60001); 9 Sep 2009 07:08:12 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252480092; bh=VEG2zXoPEiZfFXsAMKRAW9LMvJeKpgTetThpZ4fQcoE=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=MgjwgiQbs75eg0hdOwLmjFU0a5zS+lHLXSfj7pmCXJ6T4VwKHLadR0l5c/36v+B2FLz3kUbNRukC7xBeByMdXAhwKvJF9xTF2MI6YcF3aXL97haDseu+3z4e52DCzeWjH6NTYKgcfWaBPOFDleHK9fUzCNQSgHWmhRMSJv9plss=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=wBJbwdviBR1awu1E/SWh4md2j6DoB2SLWzErIoVhm69fRl5exBuMAn6Ka5fZiWLCvJJBrZuXm2zQHzTNc6NjGQT5k4I5t5+sjqzQIje6EeQtrZfEguxzgI3MwhYdyELbflgEILIic8hi+ZxFFw6StSgmipgh6Upunw8pJlBuDBg=;
Message-ID: <35615.36416.qm@web52901.mail.re2.yahoo.com>
X-YMail-OSG: v58NjrkVM1lJSPb_4pGSznEtc8UBclaTfP0bsQQb0pvDPUxMM2iHF2nxlbm.5a3b1O.8SrmjcYmcMEAOVVTCmMEFrHJdYnUfXvv59XDwLmtI7CL2KTUSDAeRaCyouT3BtWi97ius5IH6tIGMvc5zODs.kGwIt0tqFymYypISehgtckeM.Z6d_g7pvebIgy5rBY5mbm469oHJgI8yTg0QEmOduMIM7T4xj33N9woxDXSDBjQIjNwrQXUI6jfqceu2CVDw_k8h27Je2joqj4Ot4pJwn9Bcc5eA1nPO3B5IGEnACq3nB1ut4mLkrnHYVlcwzRWnYF1g5mmhCd0wEYFvdmvIx4nZLH3nz0pUBDU-
Received: from [193.140.184.100] by web52901.mail.re2.yahoo.com via HTTP; Wed, 09 Sep 2009 00:08:11 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.338.2
Date: Wed, 9 Sep 2009 00:08:11 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: get all tokens from index
To: java-user@lucene.apache.org
In-Reply-To: <25359411.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org


> hello all, is there any way to get all
> tokens from my index ? please anyone
> suggest me

The code below prints all terms of a field.

       String path = "E:\\ThesaurusSolrHome\\data\\index";
       String field = "contents";

        IndexReader indexReader = IndexReader.open(path);
        TermEnum termEnum = indexReader.terms();

        while (termEnum.next()) {
            Term term = termEnum.term();
            if (term.field().equalsIgnoreCase(field))
                System.out.println(term.text());

        }
        termEnum.close();
        indexReader.close();


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42219-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 07:16:46 2009
Return-Path: <java-user-return-42219-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52128 invoked from network); 9 Sep 2009 07:16:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 07:16:46 -0000
Received: (qmail 44997 invoked by uid 500); 9 Sep 2009 07:16:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44948 invoked by uid 500); 9 Sep 2009 07:16:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44938 invoked by uid 99); 9 Sep 2009 07:16:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 07:16:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of aminmc@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 07:16:32 +0000
Received: by ewy28 with SMTP id 28so696156ewy.28
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 00:16:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=hOgR8rBLXe6S5ndWH0ovR8RXhQF+M6tyrNMkxExFskA=;
        b=BDYwVISXeyWQUwyJW07pvAYmgb1WSxvJdbPxvULcagjFdF/HNKBOoAvyC67eIid4kU
         v6fIGTBWJFlzZGO3qBIhRh2jDhnktjFO5BHw3y4kJZaD9gCyX3hFWtrCI/vIVWJwXerj
         zba1fjc7f//6mkeoqCOif4j24mXWJtFgAFwQM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=Vjb2Ib8fiIJvvUlxScdEFUBm5A+Y48abVIH0OmnIrNaIcoygGitWbzIpV9uD0ar4u0
         7i8Nh/ypaBnBiR1zPuRRxwKcLG7zNIipAzygSHnrzUw1r9sM6sHiyWjOZILL0iaf2+iN
         okpF0yMRWTXs6aW8OG6NHwpoXhowz2FgIZhCQ=
MIME-Version: 1.0
Received: by 10.216.29.213 with SMTP id i63mr2088122wea.90.1252480571290; Wed, 
	09 Sep 2009 00:16:11 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0909081521040.26698@radix.cryptio.net>
References: <6f4104d80909040217yd24a342t22232a9b4f217fbb@mail.gmail.com>
	 <6f4104d80909040238i877609ev65a2f284c07a99df@mail.gmail.com>
	 <Pine.LNX.4.64.0909081521040.26698@radix.cryptio.net>
Date: Wed, 9 Sep 2009 08:16:11 +0100
Message-ID: <6f4104d80909090016i577d87ajb96e8de84db59834@mail.gmail.com>
Subject: Re: Filtering question/advice
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6db61c08a354f04731fdbb2
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6db61c08a354f04731fdbb2
Content-Type: text/plain; charset=ISO-8859-1

Hi

Thanks for your reponse.  Here is the following testcase:

public class UnderwriterReferenceTest {
    private Directory directory;
    private Analyzer analyzer;
    private IndexSearcher indexSearcher;
    private IndexWriter indexWriter;
    private Document layerDocumentA;


    @Before
    public void setUp() throws Exception {
        directory = new RAMDirectory();
        analyzer = new StandardAnalyzer();
        indexWriter = new IndexWriter(directory, analyzer,
IndexWriter.MaxFieldLength.UNLIMITED);

    }

   @Before
   public void setUpDocumentsForIndexing() throws Exception {

       Field uw1 = new Field("uw-refernce", "hello", Field.Store.NO,
Field.Index.ANALYZED);
       Field uw2 = new Field("uw-refernce", "bye", Field.Store.NO,
Field.Index.ANALYZED);


       Field uw1UWA = new Field("uw-uwa", "hello", Field.Store.NO,
Field.Index.ANALYZED);
       Field uw2UWB = new Field("uw-uwb", "bye", Field.Store.NO,
Field.Index.ANALYZED);


       layerDocumentA = new Document();
       layerDocumentA.add(uw1);
       layerDocumentA.add(uw1);
       layerDocumentA.add(uw1UWA);
       layerDocumentA.add(uw2UWB);
   }


    @Test
    public void
testUWBCannotSeeResultIfUWReferenceIsSearchThatDoesNotBelongToUWB() throws
Exception {
        indexWriter.addDocument(layerDocumentA);
        indexWriter.commit();
        indexWriter.close();

        indexSearcher = new IndexSearcher(directory);

        UnderwriterReferenceFilter filter = new
UnderwriterReferenceFilter();
        filter.setUwId("uwb");
        filter.setTermValue("hello");

        QueryParser queryParser = new QueryParser("uw-refernce", analyzer);
        Query q = queryParser.parse("hello");
        long start = System.currentTimeMillis();
        TopDocs topDocs = indexSearcher.search(q, filter, 100);
        long end = System.currentTimeMillis();
        System.out.println("Total time taken to search = " + (end - start) +
" milli seconds");
        System.out.println("Total results returned = " + topDocs.totalHits);
        assertNotNull(topDocs);
        assertEquals(0, topDocs.totalHits);
    }


    @Test
    public void
testUWACanSeeResultIfUWReferenceIsSearchThatDoesBelongToUWA() throws
Exception {
        indexWriter.addDocument(layerDocumentA);
        indexWriter.commit();
        indexWriter.close();

        indexSearcher = new IndexSearcher(directory);

        UnderwriterReferenceFilter filter = new
UnderwriterReferenceFilter();
        filter.setUwId("uwa");
        filter.setTermValue("hello");

        QueryParser queryParser = new QueryParser("uw-refernce", analyzer);
        Query q = queryParser.parse("hello");
        long start = System.currentTimeMillis();
        TopDocs topDocs = indexSearcher.search(q, filter, 100);
        long end = System.currentTimeMillis();
        System.out.println("Total time taken to search = " + (end - start) +
" milli seconds");
        System.out.println("Total results returned = " + topDocs.totalHits);
        assertNotNull(topDocs);
        assertEquals(1, topDocs.totalHits);
    }

    @Test
    public void testUWBCanSeeResultIfSearchTermMatchesOnSomethingElse()
throws Exception {

        Field data = new Field("data", "hello", Field.Store.NO,
Field.Index.ANALYZED);
        layerDocumentA.add(data);
        indexWriter.addDocument(layerDocumentA);
        indexWriter.commit();
        indexWriter.close();

        indexSearcher = new IndexSearcher(directory);



        UnderwriterReferenceFilter filter = new
UnderwriterReferenceFilter();

        MultiFieldQueryParser queryParser = new MultiFieldQueryParser(new
String[]{"uw-refernce", "data"}, analyzer);
        queryParser.enable_tracing();
        Query q = queryParser.parse("hello");
        long start = System.currentTimeMillis();



        TopDocs topDocs = indexSearcher.search(q, filter, 100);
        long end = System.currentTimeMillis();
        System.out.println("Total time taken to search = " + (end - start) +
" milli seconds");
        System.out.println("Total results returned = " + topDocs.totalHits);
        assertNotNull(topDocs);
        assertEquals(1, topDocs.totalHits);

    }

   private class UnderwriterReferenceFilter extends Filter {

    private String uwId;
    private String termValue;

    public void setTermValue(String termValue) {
       this.termValue = termValue;
    }

    public void setUwId(String uwId) {
        this.uwId = uwId;
    }

    @Override
    public DocIdSet getDocIdSet(org.apache.lucene.index.IndexReader reader)
throws java.io.IOException  {
        if (uwId == null || "".equals(uwId)) {
            throw new IllegalArgumentException("uwidnot set for filtering");
        }

        OpenBitSet bitSet = new OpenBitSet( reader.maxDoc());
        Term term = new Term("uw-"+uwId, termValue);
        TermDocs termDocs = reader.termDocs( term );
        while ( termDocs.next() ) {
            bitSet.set( termDocs.doc() );
        }

        return bitSet;

    }
   }

}

As you can see I am using a filter to filter out results based on uwId.  Is
it possible to use the grouping that you mentioned within a filter or should
be implemented some other way for example appending the grouping concept
after recieveing the query from the user?


Thanks again for your input!

Cheers
Amin


On Tue, Sep 8, 2009 at 11:24 PM, Chris Hostetter
<hossman_lucene@fucit.org>wrote:

> : Hi
> : I include a testcase to show what I am trying to do.  Testcase number 3
> : fails.
>
> the mailing list is finicky about attachments ... the best thing to do is
> to include your test case directly in the body of your email as plain
> text.
>
> : > I created a test case to test this solution and it works. The problem
> is
> : > that if UWB searches for "HELLO" that exists in another field such as:
> : > data:HELLO then he should get a result. It's only when the query is
> matched
> : > on reference he should not see anything.  My testcase fails when the
> match
> : > is made on the data field as the security filter does not pass (valid
> : > filter).  Is there a way around this?  Hope this made sense!
>
> it sounds like perhaps you just need to group your clauses...
>
>  data:HELLO (uw-reference:HELLO +uw-uwb:HELLO)
>
> ...if HELLO is in data, you'll get a match regardless of the other fields.
> if it's not in data, but it is in uw-reference, it will only match if it's
> also in uw-uwb.
>
>
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6db61c08a354f04731fdbb2--

From java-user-return-42220-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 07:19:44 2009
Return-Path: <java-user-return-42220-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54226 invoked from network); 9 Sep 2009 07:19:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 07:19:43 -0000
Received: (qmail 53940 invoked by uid 500); 9 Sep 2009 07:19:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53888 invoked by uid 500); 9 Sep 2009 07:19:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53878 invoked by uid 99); 9 Sep 2009 07:19:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 07:19:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 07:19:32 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MlHSR-0007Rm-Jm
	for java-user@lucene.apache.org; Wed, 09 Sep 2009 00:19:11 -0700
Message-ID: <25359857.post@talk.nabble.com>
Date: Wed, 9 Sep 2009 00:19:11 -0700 (PDT)
From: "m.harig" <m.harig@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: get all tokens from index
In-Reply-To: <35615.36416.qm@web52901.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: m.harig@gmail.com
References: <25359411.post@talk.nabble.com> <35615.36416.qm@web52901.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks Ahmet , i found the solution. thanks a lot


Ahmet Arslan wrote:
> 
> 
>> hello all, is there any way to get all
>> tokens from my index ? please anyone
>> suggest me
> 
> The code below prints all terms of a field.
> 
>        String path = "E:\\ThesaurusSolrHome\\data\\index";
>        String field = "contents";
> 
>         IndexReader indexReader = IndexReader.open(path);
>         TermEnum termEnum = indexReader.terms();
> 
>         while (termEnum.next()) {
>             Term term = termEnum.term();
>             if (term.field().equalsIgnoreCase(field))
>                 System.out.println(term.text());
> 
>         }
>         termEnum.close();
>         indexReader.close();
> 
> 
>       
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/get-all-tokens-from-index-tp25359411p25359857.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42221-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 11:32:36 2009
Return-Path: <java-user-return-42221-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56104 invoked from network); 9 Sep 2009 11:32:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 11:32:35 -0000
Received: (qmail 56593 invoked by uid 500); 9 Sep 2009 11:32:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56549 invoked by uid 500); 9 Sep 2009 11:32:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56539 invoked by uid 99); 9 Sep 2009 11:32:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 11:32:33 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 11:32:23 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n89BW1Ng006554
	for <java-user@lucene.apache.org>; Wed, 9 Sep 2009 12:32:01 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Wed, 09 Sep 2009 12:32:00 +0100 (BST)
Date: Wed, 9 Sep 2009 12:32:00 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <183595320.3061252495920278.JavaMail.root@mail.uk.scalix.com>
In-Reply-To: <4AA6AB4F.8050209@gmail.com>
Subject: RE: New "Stream closed" exception with Java 6
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Thanks for your input Mark and Chris.  I will take all into account

Chris


----- Original Message -----
From: Mark Miller <markrmiller@gmail.com>
Sent: Tue, 8/9/2009 8:06pm
To: java-user@lucene.apache.org
Subject: Re: New "Stream closed" exception with Java 6

Chris Hostetter wrote:
> : I'm coming to the same conclusion - there must be >1 threads accessing this index at the same time.  Better go figure it out  ...  :-)
>
> careful about your assumptions ... you could get this same type of 
> exception even with only one thread, the stream that's being closed isn't 
> internal to Lucene, it's the InputStreamReader you supplied as the value 
> of some Field.  it's possibly you just have a simple bug where you are 
> closing hte reader before you pass it to Lucene, or maybe you are 
> mistakenly adding the saame field twice (or in two different documents)
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   
Its possible its something tricky. When I was converting the Highlighter
to the new TokenStream API, I started to
get this exception in the Highlighter rewrite test - everything else
passed, but this was failing. I couldn't figure it out - and
before I could find the root cause, all the tests started passing
(perhaps from changing code doing other things, rebuilding, or who knows
- I don't have a clue). I couldn't get it to fail again after that.

Not very helpful - but just to note, there were not multiple threads
involved concurrently, nor multiple Writers.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42222-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 12:58:27 2009
Return-Path: <java-user-return-42222-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1556 invoked from network); 9 Sep 2009 12:58:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 12:58:26 -0000
Received: (qmail 95067 invoked by uid 500); 9 Sep 2009 12:58:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94992 invoked by uid 500); 9 Sep 2009 12:58:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94982 invoked by uid 99); 9 Sep 2009 12:58:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 12:58:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of peterlkeegan@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 12:58:13 +0000
Received: by ey-out-2122.google.com with SMTP id 4so709422eyf.5
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 05:57:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=+gk3EdV7b57Qd+rIPYTi+kCzcDVrW3qG3iBaFN2Cqqk=;
        b=kLP8IciSJeVEdI+ym+PfwJTVQBFWAGSg2TQ3DWHnIylTWt+yBk0vifMIRQNIEPp5Fs
         4UWTd+L0OMFfPEj07sP7EOuefNl4cfMameePo97mvrq/VwNVdPwKa3KtSlOAPGur+Ei/
         epLVa6zThBGECGF2FWMQpDxio8D813dmtTRSY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=YSEEazFoyzy3Qe3N4w8pSKRHVyiCzdHB+TMlkxaJoRaI557e/yik7CY01koIKi7Lre
         alnjnlef+IZ8RnrKJZC/8yuNcgamskuHRC0579x040xFL0HJmUW4tXxzwBYqfT1/+o9j
         cdMLVC3kgDcra3ZA6fIjXkvwdAD/MZuuCLYd4=
MIME-Version: 1.0
Received: by 10.211.147.10 with SMTP id z10mr148951ebn.61.1252501073528; Wed, 
	09 Sep 2009 05:57:53 -0700 (PDT)
In-Reply-To: <4A9829C2.2000104@apache.org>
References: <4A9829C2.2000104@apache.org>
Date: Wed, 9 Sep 2009 08:57:53 -0400
Message-ID: <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Peter Keegan <peterlkeegan@gmail.com>
To: java-user@lucene.apache.org, markrmiller@apache.org
Content-Type: multipart/alternative; boundary=001636c5ba979188a6047324a18f
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5ba979188a6047324a18f
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: quoted-printable

I've been testing 2.9 RC2 lately and comparing query performance to 2.3.2.
I'm seeing a huge increase in throughput (2x-10x) on an index that was buil=
t
with 2.3.2. The queries have a lot of BoostingTermQuerys and boolean clause=
s
containing a custom scorer. Using JProfiler, I observe that the improvement
is due to a huge reduction in the number of calls to TermDocs.next and
TermDocs.skipTo (about 65% fewer calls). Since the custom scorer is somewha=
t
expensive and frequent in these queries, the improvement is quite noticable=
.

Have there been a lot of optimizations in the IndexSearcher/skipto/next
logic since 2.3.2?
Should I expect to see even more query improvement by building the index
with 2.9?  (pinch me!)
Good stuff!

Thanks,
Peter

On Fri, Aug 28, 2009 at 3:02 PM, Mark Miller <markrmiller@gmail.com> wrote:

> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA1
>
> Hello Lucene users,
>
> On behalf of the Lucene dev community (a growing community far larger
> than just the committers) I would like to announce the second release
> candidate for Lucene 2.9.
>
> Please download and check it out =96 take it for a spin and kick the
> tires. If all goes well, we hope to release the final version of
> Lucene 2.9 in a little over a week.
>
> The following changes have been applied since the first release candidate=
:
> LUCENE-1867: replace collation/lib/icu4j.jar with a smaller icu jar
> LUCENE-1868: add Arabic stemmer to notice.txt
> LUCENE-1870: fix contrib dist - missing analyzers/db binaries - extra
> miscellaneous folder with misc readme in it
> LUCENE-1869: include 'file exists?' when we throw RuntimeException
> from fdx or tvx size mismatches during flush or merge
> LUCENE-1871: Add option to avoid needlessly wrapping TokenStream with
> CachingTokenFilter in Highlighter
>
> While we generally try and maintain full backwards compatibility
> between major versions, Lucene 2.9 has a variety of breaks that are
> spelled out in the 'Changes in backwards compatibility policy' section
> of CHANGES.txt.
>
> We recommend that you recompile your application with Lucene 2.9
> rather than attempting to =93drop=94 it in. This will alert you to any
> issues you may have to fix if you are affected by one of the backward
> compatibility breaks. As always, its a really good idea to thoroughly
> read CHANGES.txt before upgrading. Also, remember that this is a
> release candidate, and not the final Lucene 2.9 release.
>
> Lucene 2.9 comes with a bevy of new features, including:
>
> Per segment searching and caching (can lead to much faster reopen
> among other things)
>
> Near real-time search capabilities added to IndexWriter
>
> New queries, including NumericRangeQuery and NumericRangeFilter =96
> fast, highly scalable alternatives to RangeQuery/RangeFilter for
> numeric searches.
>
> Smarter, more scalable multi-term queries (wildcard, range, etc)
>
> A freshly optimized Collector/Scorer API
>
> Improved Unicode support
>
> A new Attribute based TokenStream API
>
> A new QueryParser framework in contrib with a core QueryParser
> replacement impl included.
>
>  =85.
>
> And many, many more features, bug fixes, optimizations, and various
> improvements. You can find the full list of changes here:
>
> HTML version:
>
> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Chang=
es.html<http://people.apache.org/%7Emarkrmiller/staging-area/lucene2.9chang=
es/Changes.html>
>
> Text version:
>
> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CHANG=
ES.txt<http://people.apache.org/%7Emarkrmiller/staging-area/lucene2.9change=
s/CHANGES.txt>
>
> Many changes have also occurred in Lucene's contrib area:
>
> http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/contr=
ib/CHANGES.txt<http://people.apache.org/%7Emarkrmiller/staging-area/lucene2=
.9changes/contrib/CHANGES.txt>
>
> Download release candidate 1 here:
> http://people.apache.org/~markrmiller/staging-area/lucene2.9rc2/<http://p=
eople.apache.org/%7Emarkrmiller/staging-area/lucene2.9rc2/>
>
> Be sure to report back with any issues you find!
>
> Thanks,
>
> Mark Miller
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v1.4.9 (GNU/Linux)
> Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/
>
> iEYEARECAAYFAkqYKcIACgkQ0DU3IV7ywDkZHACfbzHKac0sVjNkdSi+79WTYWme
> JR4An18v1SJ6HN8mkCYHF0ybqUSypOG/
> =3DqS9t
> -----END PGP SIGNATURE-----
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636c5ba979188a6047324a18f--

From java-user-return-42223-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 13:18:07 2009
Return-Path: <java-user-return-42223-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9621 invoked from network); 9 Sep 2009 13:18:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 13:18:07 -0000
Received: (qmail 24896 invoked by uid 500); 9 Sep 2009 13:18:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24827 invoked by uid 500); 9 Sep 2009 13:18:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24817 invoked by uid 99); 9 Sep 2009 13:18:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:18:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:17:55 +0000
Received: by ewy28 with SMTP id 28so920273ewy.28
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 06:17:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:date:x-google-sender-auth:message-id:subject:from:to:cc
         :content-type;
        bh=Gs92E9ryYBtIltk2KjE6Q1TpfPIEmw6LbAxsn5kA060=;
        b=bEyqUinyOpEonn0NhMCl/KsJhcI17fMnvTXi1D+i93AD3Y1WJ5jE2kJ5wrOwaqSVBQ
         POyU1C40KJX7SRYST7AD1pwt9L5FLy5jiC4FqRwVh32TyOSFGTi+T0c6RwWPGkwiPiTn
         4WJbQQqEv7LJiUI/pNaeVnm+Ch0vFJmQbbruk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:cc:content-type;
        b=oiM/nLbjy0udswsFyeHICyah8FL4+9x9dVLzd03f4SXT/c8SWvikklXURMdEaTf/2o
         Nj9B9IJfQ4BJm0JcBx0PWWwmr98CEmEcKJHCmHuHefQ1wM+GcqWtDeyvgGk4J0H/eL2P
         VRB8OWDFcJKw+S2MIfXGlg+7bPZsgwJZZ0HRA=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Received: by 10.216.15.5 with SMTP id e5mr40382wee.18.1252502254060; Wed, 09 
	Sep 2009 06:17:34 -0700 (PDT)
In-Reply-To: <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
References: <4A9829C2.2000104@apache.org>
	 <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
Date: Wed, 9 Sep 2009 09:17:33 -0400
X-Google-Sender-Auth: 724e92a8f3e9292e
Message-ID: <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Yonik Seeley <yonik.seeley@lucidimagination.com>
To: java-user@lucene.apache.org
Cc: markrmiller@apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Sep 9, 2009 at 8:57 AM, Peter Keegan<peterlkeegan@gmail.com> wrote:
> Using JProfiler, I observe that the improvement
> is due to a huge reduction in the number of calls to TermDocs.next and
> TermDocs.skipTo (about 65% fewer calls).

Indexes are searched per-segment now (i.e. MultiTermDocs isn't normally used).
Off the top of my head, I'm not sure how this can lead to fewer
TermDocs.skipTo() calls though.  Are you sure you weren't also
counting Scorer.skipTo()... which would now be Scorer.advance()?
Have you verified that your custom scorer is working correctly with
2.9 and that you're getting the same number of hits on the overall
query as you were with previous versions?

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42224-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 13:22:44 2009
Return-Path: <java-user-return-42224-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11801 invoked from network); 9 Sep 2009 13:22:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 13:22:43 -0000
Received: (qmail 33493 invoked by uid 500); 9 Sep 2009 13:22:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33202 invoked by uid 500); 9 Sep 2009 13:22:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33132 invoked by uid 99); 9 Sep 2009 13:22:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:22:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:22:31 +0000
Received: by ewy28 with SMTP id 28so924446ewy.28
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 06:22:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:date:x-google-sender-auth:message-id:subject:from:to:cc
         :content-type:content-transfer-encoding;
        bh=0DKBRAf5BHpbxU07ClxgElcMzrkU9QZ8CCT1pJ1KkjA=;
        b=cJ3bMK0oNpsQ35SODSQoJVZdF/j7uJM7LueRgkvvm8qfD5lWD7e3OUIS2hlbgoTlX6
         8/LP+txpm7UQePpiSyDkyynz13bIBD7ItC8dZmuLp8VzEZF15Rf+lHJXHlW3PErR/noI
         Cr1SKmSgpYAA9UoWkaBcAdvMTIn/ox/jqTmzQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:cc:content-type
         :content-transfer-encoding;
        b=aNKCov+Jh8ImJ7pNPpOGilsLicwEEgtc8JVQOZ5C+OB6FRT8d9ZTAsNt3upNWnLMKh
         A2+0kBRm+B9OUWYZ5vHpHWuSZB4a9RsDF9OQDykNC7x5YPl9hOlmTVxmQItAvW7SxwoL
         Chx66feIUZXSoHPlrnhVi5FojtuxfKZNeswPc=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Received: by 10.216.13.74 with SMTP id a52mr36116wea.145.1252502531652; Wed, 
	09 Sep 2009 06:22:11 -0700 (PDT)
In-Reply-To: <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
References: <4A9829C2.2000104@apache.org>
	 <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
	 <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
Date: Wed, 9 Sep 2009 09:22:11 -0400
X-Google-Sender-Auth: 9a1200f3abc2ab42
Message-ID: <c68e39170909090622tbe4621bl6eaac6f52dc7372@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Yonik Seeley <yonik.seeley@lucidimagination.com>
To: java-user@lucene.apache.org
Cc: markrmiller@apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Sep 9, 2009 at 9:17 AM, Yonik
Seeley<yonik.seeley@lucidimagination.com> wrote:
> On Wed, Sep 9, 2009 at 8:57 AM, Peter Keegan<peterlkeegan@gmail.com> wrot=
e:
>> Using JProfiler, I observe that the improvement
>> is due to a huge reduction in the number of calls to TermDocs.next and
>> TermDocs.skipTo (about 65% fewer calls).
>
> Indexes are searched per-segment now (i.e. MultiTermDocs isn't normally u=
sed).
> Off the top of my head, I'm not sure how this can lead to fewer
> TermDocs.skipTo() calls though.

Wait... perhaps it's just that  accounting for the skipTo() decrease?
Instead of MultiTermDocs.skipTo() delegating to
SegmentTermDocs.skipTo() (2 calls since they both inherit from
TermDocs), it's now just SegmentTermDocs.skipTo() directly.

-Yonik
http://www.lucidimagination.com


 =A0Are you sure you weren't also
> counting Scorer.skipTo()... which would now be Scorer.advance()?
> Have you verified that your custom scorer is working correctly with
> 2.9 and that you're getting the same number of hits on the overall
> query as you were with previous versions?
>
> -Yonik
> http://www.lucidimagination.com
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42225-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 13:28:30 2009
Return-Path: <java-user-return-42225-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14213 invoked from network); 9 Sep 2009 13:28:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 13:28:29 -0000
Received: (qmail 44464 invoked by uid 500); 9 Sep 2009 13:28:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44375 invoked by uid 500); 9 Sep 2009 13:28:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44365 invoked by uid 99); 9 Sep 2009 13:28:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:28:27 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.183 as permitted sender)
Received: from [209.85.223.183] (HELO mail-iw0-f183.google.com) (209.85.223.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:28:17 +0000
Received: by iwn13 with SMTP id 13so38456iwn.6
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 06:27:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=u2te8orZWttuteAt9lSJu2gpacLt3BTeHkkjSehAI58=;
        b=wqDA0NTC8RW42rIju+oGV4Vz0ucrkbWfLoHVwBNdWaeMXAGoTzA1LyTdyk39DiwWoM
         DH6ajT8nRYJG5zZdZ9oyX9sp7Pv59sJ7lWJIPKbFWvBNnf4mkiZJoKvGAUXtXTcDPhPa
         iIgSvVzf8ViorlTqQU+xnCzTSpVS2R6mBpM2c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=aJhuv3MraKlzQawR6qUCVF31jr1euLQ4yt0xMuvpbGxtA9cwe+A3OqPojEcvVJyz6O
         3MCTgAl4FOCZiHOaKKv/VVM9WWF2rnMcry9xYrL54r2wAxMDH7Vps4d7qiOChYYIPu2g
         mbFip0KOqZdrT+mVVcyT1ZeCfZTtxkCErtOyM=
MIME-Version: 1.0
Received: by 10.231.120.136 with SMTP id d8mr327507ibr.14.1252502877130; Wed, 
	09 Sep 2009 06:27:57 -0700 (PDT)
In-Reply-To: <5d53d5770909041907w51639e77q8f5c1a1f049cacb4@mail.gmail.com>
References: <5d53d5770909041655h4ae19b11uaaee1dbcf1647097@mail.gmail.com>
	 <359a92830909041802qeb4b678x1755efe5aed60784@mail.gmail.com>
	 <5d53d5770909041907w51639e77q8f5c1a1f049cacb4@mail.gmail.com>
Date: Wed, 9 Sep 2009 09:27:56 -0400
Message-ID: <359a92830909090627u3441d42cv4f92fad0e7194a52@mail.gmail.com>
Subject: Re: Newbie: Luke and fields
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e644c18e1250ec0473250def
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e644c18e1250ec0473250def
Content-Type: text/plain; charset=ISO-8859-1

It's all in the analyzers. Depending upon which analyzer you use manythings
happen to the input stream. Casing is one example, but that's just
the simplest. Which is why it's so important to use the same analyzer
when indexing and querying unless you have a *very* good reason not to.

I'd really advise looking at the Analyzer docs to see what transformations
they make. You'll see they're composed of Filters that perform various
transformations..

Best
Erick

On Fri, Sep 4, 2009 at 10:07 PM, Ian Vink <ianvink@gmail.com> wrote:

> Case?
>
> Hmm. I thought it was case intensive.
>
> I will re-index and revert all to lower case and see. The language is
> stored
> as "English" not "english"
>
> ian
>
> P.S. Here's what I built with a basic understanding of Lucene.
> http://BahaiResearch.com it's open source, ad-free. It allows people in 20
> languages search the texts of any religion. Promotes understanding among
> the
> different peoples of the world. Chinese Buddhists can better understand say
> Spanish Baha'is or Dutch Jews.
>
>
> On Fri, Sep 4, 2009 at 10:02 PM, Erick Erickson <erickerickson@gmail.com
> >wrote:
>
> > Hmmmmm. Let's see the queries, and query.toString() may give
> > you some clues. I *suspect* that you really didn't index language.
> > Did you, perhaps, not re-index all your docs? Or use an analyzer
> > that didn't fold case when searching but did when searching (or
> > vice-versa)?
> >
> > It's *possible* that you've got some kind of case problem. I've also
> > done really silly things like stared at the field for hours and never
> > noticed that it was "langauge".
> >
> > Two things would help:
> > 1> show us the index code you actually use.
> > 2> make an index with, say, two documents and attach it to a post. Maybe
> >     someone with eyes less tired than yours will spot the issue.
> >
> > Because you're right. This *should* work just fine, so there's probably
> > something that'll make you slap your forehead when you figure it out.
> > I speak from experience here, I've given myself lumps on my forehead
> > when someone pointed out *perfectly obvious* problems that I couldn't
> > find for hours<G>.
> >
> > Best
> > Erick
> >
> > On Fri, Sep 4, 2009 at 7:55 PM, Ian Vink <ianvink@gmail.com> wrote:
> >
> > > I have created an index and each document has a contents field and a
> > > language field.
> > >
> > > contents has the flags: Indexed Tokenized Stored Vector
> > > language has the flags: Indexed Stored
> > >
> > > In luke I can search contents fine, but when I try to search the field
> > > language, I never ever get results.
> > >
> > > Every document has a language field populated which I can see in Luke's
> > > document browser.
> > >
> > > I have tried language:english and even made language the default field.
> > >
> > > I gotta be missing something simple....
> > >
> >
>

--0016e644c18e1250ec0473250def--

From java-user-return-42226-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 13:41:06 2009
Return-Path: <java-user-return-42226-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18477 invoked from network); 9 Sep 2009 13:41:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 13:41:06 -0000
Received: (qmail 59105 invoked by uid 500); 9 Sep 2009 13:41:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59022 invoked by uid 500); 9 Sep 2009 13:41:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59012 invoked by uid 99); 9 Sep 2009 13:41:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:41:04 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of peterlkeegan@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:40:54 +0000
Received: by ewy6 with SMTP id 6so2570399ewy.10
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 06:40:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=n+4XNe9o447kxDZUep/muvTfuCieu3nyEKCE0QXVjTw=;
        b=FO54g7IzMN5LzapGTK0RuZVlSc1xvYOjWSsvA0v03XDllwvI8RuJO7vSvuGdkDUIv2
         RvHhPS/y2Oj4DZnMmicKpHHy2kgR71+vsePQ2/mohPMzKxz9xfLpI/6c+QVPw6x9EdtA
         IGuC6JBDWyOzfr4/eSLk+091bwSfgK6uf1lDk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=YzULMREUzf/4SgMD9WQ5T3tX/AWbiQt0/dd2NW8KSDq/MmW2JGbg93i6jYts2XI6gO
         qm2ZxQZWZcZNcXeWDuGNBeFtkDPC5SYdRurUQnSuQEJIrQRHGSCk8YqwomXJMYiPlF9H
         KImzRqHV4e/5jt8AZcTEZNrPho7gFb9aXY4tY=
MIME-Version: 1.0
Received: by 10.210.94.7 with SMTP id r7mr4658750ebb.36.1252503632059; Wed, 09 
	Sep 2009 06:40:32 -0700 (PDT)
In-Reply-To: <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
References: <4A9829C2.2000104@apache.org>
	 <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
	 <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
Date: Wed, 9 Sep 2009 09:40:32 -0400
Message-ID: <e994873a0909090640q5206527epeb494ab43c8ebcc0@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Peter Keegan <peterlkeegan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cdf936a119d670473253af1
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cdf936a119d670473253af1
Content-Type: text/plain; charset=ISO-8859-1

IndexSearcher.search is calling my custom scorer's 'next' and 'doc' methods
64% fewer times. I see no 'advance' method in any of the hot spots'. I am
getting the same number of hits from the custom scorer.
Has the BooleanScorer2 logic changed?

Peter

On Wed, Sep 9, 2009 at 9:17 AM, Yonik Seeley <
yonik.seeley@lucidimagination.com> wrote:

> On Wed, Sep 9, 2009 at 8:57 AM, Peter Keegan<peterlkeegan@gmail.com>
> wrote:
> > Using JProfiler, I observe that the improvement
> > is due to a huge reduction in the number of calls to TermDocs.next and
> > TermDocs.skipTo (about 65% fewer calls).
>
> Indexes are searched per-segment now (i.e. MultiTermDocs isn't normally
> used).
> Off the top of my head, I'm not sure how this can lead to fewer
> TermDocs.skipTo() calls though.  Are you sure you weren't also
> counting Scorer.skipTo()... which would now be Scorer.advance()?
> Have you verified that your custom scorer is working correctly with
> 2.9 and that you're getting the same number of hits on the overall
> query as you were with previous versions?
>
> -Yonik
> http://www.lucidimagination.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cdf936a119d670473253af1--

From java-user-return-42227-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 13:44:48 2009
Return-Path: <java-user-return-42227-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19874 invoked from network); 9 Sep 2009 13:44:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 13:44:48 -0000
Received: (qmail 66234 invoked by uid 500); 9 Sep 2009 13:44:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66162 invoked by uid 500); 9 Sep 2009 13:44:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66152 invoked by uid 99); 9 Sep 2009 13:44:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:44:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.183 as permitted sender)
Received: from [209.85.221.183] (HELO mail-qy0-f183.google.com) (209.85.221.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:44:34 +0000
Received: by qyk13 with SMTP id 13so3533333qyk.3
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 06:44:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=8Lnj5TnFr9kckTHnkRTma+F1NwzzoTBYLDjMdGu/4XI=;
        b=duV6q/ZI+fD3f0asCWjBT+UTEABPpqoO+WynBRGNTWarg3pDuK9gqni7OvRv5R+YjP
         R8dr3PeeB69Tu3aJDh7nrH6hRbVEsg/I2qwtCOCgCU0GUpn7d/RC3jW1p0vSlH2MEvCT
         U3mbKtPs350YAn5ZaJg0OS9MMiq/jFPi+brMQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=hsNEXkksEZv9Ug9y4eHxfexP5n0HXrzrXbt52nAoM1h5HWZt0THaAZuF7KEBMQcY8d
         gjJVTVPOLGC/UcCj5uilBSygmS5IvBgzt9vQjUDqGwWC0hiDQaYNEh1Upx9BJTCrqeEs
         F9lxSpGYsGeOXeoVe54QsO/sRQ8Zmq3orL4m0=
Received: by 10.224.95.196 with SMTP id e4mr140831qan.180.1252503852616;
        Wed, 09 Sep 2009 06:44:12 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 5sm1816qwh.40.2009.09.09.06.44.11
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 09 Sep 2009 06:44:11 -0700 (PDT)
Message-ID: <4AA7B12D.8060208@gmail.com>
Date: Wed, 09 Sep 2009 09:44:13 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9 RC2 now available for testing
References: <4A9829C2.2000104@apache.org>	 <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>	 <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com> <e994873a0909090640q5206527epeb494ab43c8ebcc0@mail.gmail.com>
In-Reply-To: <e994873a0909090640q5206527epeb494ab43c8ebcc0@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

How about the new score inorder/out of order stuff? It was an option
before, but I think now it uses whats best by default? And pairs with
the collector? I didn't follow any of that closely though.

- Mark

Peter Keegan wrote:
> IndexSearcher.search is calling my custom scorer's 'next' and 'doc' methods
> 64% fewer times. I see no 'advance' method in any of the hot spots'. I am
> getting the same number of hits from the custom scorer.
> Has the BooleanScorer2 logic changed?
>
> Peter
>
> On Wed, Sep 9, 2009 at 9:17 AM, Yonik Seeley <
> yonik.seeley@lucidimagination.com> wrote:
>
>   
>> On Wed, Sep 9, 2009 at 8:57 AM, Peter Keegan<peterlkeegan@gmail.com>
>> wrote:
>>     
>>> Using JProfiler, I observe that the improvement
>>> is due to a huge reduction in the number of calls to TermDocs.next and
>>> TermDocs.skipTo (about 65% fewer calls).
>>>       
>> Indexes are searched per-segment now (i.e. MultiTermDocs isn't normally
>> used).
>> Off the top of my head, I'm not sure how this can lead to fewer
>> TermDocs.skipTo() calls though.  Are you sure you weren't also
>> counting Scorer.skipTo()... which would now be Scorer.advance()?
>> Have you verified that your custom scorer is working correctly with
>> 2.9 and that you're getting the same number of hits on the overall
>> query as you were with previous versions?
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42228-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 13:57:55 2009
Return-Path: <java-user-return-42228-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27448 invoked from network); 9 Sep 2009 13:57:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 13:57:55 -0000
Received: (qmail 95330 invoked by uid 500); 9 Sep 2009 13:57:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95257 invoked by uid 500); 9 Sep 2009 13:57:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95247 invoked by uid 99); 9 Sep 2009 13:57:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:57:52 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.185] (HELO mail-yw0-f185.google.com) (209.85.211.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 13:57:42 +0000
Received: by ywh15 with SMTP id 15so1412319ywh.6
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 06:57:20 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.240.21 with SMTP id n21mr557573ybh.165.1252504640345; Wed, 
	09 Sep 2009 06:57:20 -0700 (PDT)
In-Reply-To: <4AA7B12D.8060208@gmail.com>
References: <4A9829C2.2000104@apache.org>
	 <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
	 <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
	 <e994873a0909090640q5206527epeb494ab43c8ebcc0@mail.gmail.com>
	 <4AA7B12D.8060208@gmail.com>
Date: Wed, 9 Sep 2009 09:57:20 -0400
Message-ID: <9ac0c6aa0909090657r56a35763vcf0bfaf02dbf1c0e@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Right, BooleanQuery will now try to use BooleanScorer (does "out of
order" collection, which does not use skipTo/advance at all, I think)
when possible, instead of BooleanScorer2.

This only applies for boolean queries that have only SHOULD clauses,
and up to 32 MUST_NOT clauses (if there's even 1 MUST clause,
BooleanScorer2 will be used).

But: it's interesting that you see such gains (2x-10x) from this.  In
simple (clauses that were TermQuery) boolean queries I saw maybe ~30%
speedup, I think.

Is it possible that skipTo is very costly with your custom scorer?
That could explain the gains.

Mike

On Wed, Sep 9, 2009 at 9:44 AM, Mark Miller<markrmiller@gmail.com> wrote:
> How about the new score inorder/out of order stuff? It was an option
> before, but I think now it uses whats best by default? And pairs with
> the collector? I didn't follow any of that closely though.
>
> - Mark
>
> Peter Keegan wrote:
>> IndexSearcher.search is calling my custom scorer's 'next' and 'doc' meth=
ods
>> 64% fewer times. I see no 'advance' method in any of the hot spots'. I a=
m
>> getting the same number of hits from the custom scorer.
>> Has the BooleanScorer2 logic changed?
>>
>> Peter
>>
>> On Wed, Sep 9, 2009 at 9:17 AM, Yonik Seeley <
>> yonik.seeley@lucidimagination.com> wrote:
>>
>>
>>> On Wed, Sep 9, 2009 at 8:57 AM, Peter Keegan<peterlkeegan@gmail.com>
>>> wrote:
>>>
>>>> Using JProfiler, I observe that the improvement
>>>> is due to a huge reduction in the number of calls to TermDocs.next and
>>>> TermDocs.skipTo (about 65% fewer calls).
>>>>
>>> Indexes are searched per-segment now (i.e. MultiTermDocs isn't normally
>>> used).
>>> Off the top of my head, I'm not sure how this can lead to fewer
>>> TermDocs.skipTo() calls though. =A0Are you sure you weren't also
>>> counting Scorer.skipTo()... which would now be Scorer.advance()?
>>> Have you verified that your custom scorer is working correctly with
>>> 2.9 and that you're getting the same number of hits on the overall
>>> query as you were with previous versions?
>>>
>>> -Yonik
>>> http://www.lucidimagination.com
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>>
>
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42229-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 14:17:55 2009
Return-Path: <java-user-return-42229-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37896 invoked from network); 9 Sep 2009 14:17:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 14:17:55 -0000
Received: (qmail 37489 invoked by uid 500); 9 Sep 2009 14:17:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37413 invoked by uid 500); 9 Sep 2009 14:17:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37403 invoked by uid 99); 9 Sep 2009 14:17:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 14:17:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.219.227 as permitted sender)
Received: from [209.85.219.227] (HELO mail-ew0-f227.google.com) (209.85.219.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 14:17:43 +0000
Received: by ewy27 with SMTP id 27so4655917ewy.40
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 07:17:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=7gM30FrBVMbogxaIvfcd3j52qz1XFn3mjxKNSvKFh4g=;
        b=GgAANbhu8i95wDKKrVaIJdHLsZFjX6ICUZOiI0kTbWF4Tui9WnXslfSmk0w8QJg2s+
         D1+7Vc6YpOi+iU2YEJWfkU9n+gqD2DPpv7jfjncFXXvUC29myss4G36UfVjGicpSdjay
         jtcszBjqVFlp/SCwUaNGCtUkUvbzgxtIM8Vkg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=DsFMnh5krzK+AC93a7vvigjp5ORw1iRLfjx/iIn7TFA8mORAygzNLXlSQU2/WeqQTl
         r4ugIgHZSU/qpR3klx0Qtxxr1BPsYcgiyL9x8HC76S1yTc+R4SWZtbk44ciWxhMW/MD2
         Xg8fNKlyTocIrPkQlhV8F9kJERilLJlhTeVLE=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.216.70.82 with SMTP id o60mr62799wed.83.1252505842004; Wed, 09 
	Sep 2009 07:17:22 -0700 (PDT)
In-Reply-To: <e994873a0909090640q5206527epeb494ab43c8ebcc0@mail.gmail.com>
References: <4A9829C2.2000104@apache.org>
	 <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
	 <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
	 <e994873a0909090640q5206527epeb494ab43c8ebcc0@mail.gmail.com>
Date: Wed, 9 Sep 2009 10:17:21 -0400
X-Google-Sender-Auth: 66cd9c11a1b25981
Message-ID: <c68e39170909090717w4b9c5423jb45e294c01798032@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Sep 9, 2009 at 9:40 AM, Peter Keegan<peterlkeegan@gmail.com> wrote:
> IndexSearcher.search is calling my custom scorer's 'next' and 'doc' metho=
ds
> 64% fewer times. I see no 'advance' method in any of the hot spots'. I am
> getting the same number of hits from the custom scorer.
> Has the BooleanScorer2 logic changed?

What does your query structure look like?
BS2 hasn't changed much.  The old BS may be used in certain
circumstances, but not in a way that you would see a decrease in
skipTo()+next().

Shot in the dark: if your scorer is part of a conjunction, maybe
you're getting lucky with an optimization:
http://svn.apache.org/viewvc?view=3Drev&revision=3D630698
It was part of http://issues.apache.org/jira/browse/LUCENE-693 , but I
had a slight bug to the "highest skip first" optimization that wasn't
fixed until 2.4

Let's assume that your custom scorer is dense (matches almost
everything) and that another scorer is sparse.  If your custom scorer
appears first, the conjunction scorer logic would be like so:
custom.skipTo(),  scorer1.skipTo(),  custom.skipTo() =3D> match!

If the sparse scorer is first, it will look more like so:
scorer1.skipTo(),  custom.skipTo() =3D> match!

-Yonik
http://www.lucidimagination.com


> Peter
>
> On Wed, Sep 9, 2009 at 9:17 AM, Yonik Seeley <
> yonik.seeley@lucidimagination.com> wrote:
>
>> On Wed, Sep 9, 2009 at 8:57 AM, Peter Keegan<peterlkeegan@gmail.com>
>> wrote:
>> > Using JProfiler, I observe that the improvement
>> > is due to a huge reduction in the number of calls to TermDocs.next and
>> > TermDocs.skipTo (about 65% fewer calls).
>>
>> Indexes are searched per-segment now (i.e. MultiTermDocs isn't normally
>> used).
>> Off the top of my head, I'm not sure how this can lead to fewer
>> TermDocs.skipTo() calls though. =A0Are you sure you weren't also
>> counting Scorer.skipTo()... which would now be Scorer.advance()?
>> Have you verified that your custom scorer is working correctly with
>> 2.9 and that you're getting the same number of hits on the overall
>> query as you were with previous versions?
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42230-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 14:18:46 2009
Return-Path: <java-user-return-42230-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38839 invoked from network); 9 Sep 2009 14:18:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 14:18:46 -0000
Received: (qmail 42991 invoked by uid 500); 9 Sep 2009 14:18:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42937 invoked by uid 500); 9 Sep 2009 14:18:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42917 invoked by uid 99); 9 Sep 2009 14:18:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 14:18:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of peterlkeegan@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 14:18:33 +0000
Received: by ey-out-2122.google.com with SMTP id 22so1362080eye.3
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 07:18:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=9LNmmFCqLGF3I/ixJn9CT+go2Ja5D8aBBMAWlqJpoj0=;
        b=ouR7ScxTS4JYjvESv7+wOpO2ugpf7TWoikOGF4ax20AdxOO2vS53Go4SJa09L1g3W9
         4twLa3jPUWYWgJP816lLogHE4B9HZqqzrro2KU6IaDFynntmybI3rHiJy/aOO31Pt91e
         8yrPymuTaeWqEdULmzwYzdcdOt1UYWATnXdYU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=WatmZ/mq2PO5TaJttQjvYLPTmptLXJsFdbEhUUmiNPrdywe8P+MmBUZIRciagkjfJs
         tQByL3KdeaO1shnvAePrij4rG+3HZmHe2e17BfMIXkHWI6XgWxaXRO16m36lAjwqpAfy
         qpQyYTB7YZLDyEk66/nL4OrJbPyWS+H3lucYE=
MIME-Version: 1.0
Received: by 10.211.161.22 with SMTP id n22mr4694132ebo.83.1252505891883; Wed, 
	09 Sep 2009 07:18:11 -0700 (PDT)
In-Reply-To: <9ac0c6aa0909090657r56a35763vcf0bfaf02dbf1c0e@mail.gmail.com>
References: <4A9829C2.2000104@apache.org>
	 <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
	 <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
	 <e994873a0909090640q5206527epeb494ab43c8ebcc0@mail.gmail.com>
	 <4AA7B12D.8060208@gmail.com>
	 <9ac0c6aa0909090657r56a35763vcf0bfaf02dbf1c0e@mail.gmail.com>
Date: Wed, 9 Sep 2009 10:18:11 -0400
Message-ID: <e994873a0909090718l4411f54boffa0e551f767b76b@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Peter Keegan <peterlkeegan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636c5b9d2c3ca6d047325c068
X-Virus-Checked: Checked by ClamAV on apache.org

--001636c5b9d2c3ca6d047325c068
Content-Type: text/plain; charset=ISO-8859-1

>Is it possible that skipTo is very costly with your custom scorer?

It's no more expensive than 'next'. The scorer's 'skipTo' and 'next' methods
call  termdocs.skipTo or termdocs.next to get the next 'candidate' doc. This
just checks a BitVector to find the next non-deleted doc. But the scorer
must visit some metadata (RAM resident) for each candidate doc, which is the
most expensive part. So, reducing the number of calls to the scorer's 'next'
and 'skipTo' methods is always a win.  Since the custom scorer is the
bottleneck with both versions of Lucene (according to JProfiler), the
improvements here are going weigh much more.

Peter


On Wed, Sep 9, 2009 at 9:57 AM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> Right, BooleanQuery will now try to use BooleanScorer (does "out of
> order" collection, which does not use skipTo/advance at all, I think)
> when possible, instead of BooleanScorer2.
>
> This only applies for boolean queries that have only SHOULD clauses,
> and up to 32 MUST_NOT clauses (if there's even 1 MUST clause,
> BooleanScorer2 will be used).
>
> But: it's interesting that you see such gains (2x-10x) from this.  In
> simple (clauses that were TermQuery) boolean queries I saw maybe ~30%
> speedup, I think.
>
> Is it possible that skipTo is very costly with your custom scorer?
> That could explain the gains.
>
> Mike
>
> On Wed, Sep 9, 2009 at 9:44 AM, Mark Miller<markrmiller@gmail.com> wrote:
> > How about the new score inorder/out of order stuff? It was an option
> > before, but I think now it uses whats best by default? And pairs with
> > the collector? I didn't follow any of that closely though.
> >
> > - Mark
> >
> > Peter Keegan wrote:
> >> IndexSearcher.search is calling my custom scorer's 'next' and 'doc'
> methods
> >> 64% fewer times. I see no 'advance' method in any of the hot spots'. I
> am
> >> getting the same number of hits from the custom scorer.
> >> Has the BooleanScorer2 logic changed?
> >>
> >> Peter
> >>
> >> On Wed, Sep 9, 2009 at 9:17 AM, Yonik Seeley <
> >> yonik.seeley@lucidimagination.com> wrote:
> >>
> >>
> >>> On Wed, Sep 9, 2009 at 8:57 AM, Peter Keegan<peterlkeegan@gmail.com>
> >>> wrote:
> >>>
> >>>> Using JProfiler, I observe that the improvement
> >>>> is due to a huge reduction in the number of calls to TermDocs.next and
> >>>> TermDocs.skipTo (about 65% fewer calls).
> >>>>
> >>> Indexes are searched per-segment now (i.e. MultiTermDocs isn't normally
> >>> used).
> >>> Off the top of my head, I'm not sure how this can lead to fewer
> >>> TermDocs.skipTo() calls though.  Are you sure you weren't also
> >>> counting Scorer.skipTo()... which would now be Scorer.advance()?
> >>> Have you verified that your custom scorer is working correctly with
> >>> 2.9 and that you're getting the same number of hits on the overall
> >>> query as you were with previous versions?
> >>>
> >>> -Yonik
> >>> http://www.lucidimagination.com
> >>>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>>
> >>>
> >>
> >>
> >
> >
> > --
> > - Mark
> >
> > http://www.lucidimagination.com
> >
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001636c5b9d2c3ca6d047325c068--

From java-user-return-42231-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 14:34:08 2009
Return-Path: <java-user-return-42231-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45399 invoked from network); 9 Sep 2009 14:34:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 14:34:08 -0000
Received: (qmail 77001 invoked by uid 500); 9 Sep 2009 14:34:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76960 invoked by uid 500); 9 Sep 2009 14:34:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76900 invoked by uid 99); 9 Sep 2009 14:34:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 14:34:04 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of peterlkeegan@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 14:33:54 +0000
Received: by ewy25 with SMTP id 25so4289908ewy.9
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 07:33:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=nioJUe9v6PRpRTuzBQg2DpZIPQ2AOL01BblKeplqgG4=;
        b=N6pI0hh3u80frVpkAoKIKxzdawuVypbW4LBtvP7wohXEAkwSuTJvgZyMJkc/QHe0oR
         4Nub+XvRDnDTsppV6een2IgMydbB2wrfw6HqRbzOtL4vNVtGUR9o/KFIfBc1pOQN/Vad
         LokQKYnkTxJc6ZC1xb3S42ZMXXfIpPp/J2FrQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=vcrXBVpJ9k/RuxcC4Z7PR1iCx5hXwINvcYhHxB7pOmayYmdkMpEcz1eB7TB5kMi5n1
         uVRxAl3mahE2RHjBe8qEY10LbNV8B+E0wvE//r0X6zGyow1eKDyKJlcjhiS+b9kHsLKn
         +5znp6O772lQtgmm53WDHZnoAA7JnZebCqgDU=
MIME-Version: 1.0
Received: by 10.211.143.13 with SMTP id v13mr294433ebn.21.1252506813335; Wed, 
	09 Sep 2009 07:33:33 -0700 (PDT)
In-Reply-To: <c68e39170909090717w4b9c5423jb45e294c01798032@mail.gmail.com>
References: <4A9829C2.2000104@apache.org>
	 <e994873a0909090557v3a414566k8b24608bfab8b62c@mail.gmail.com>
	 <c68e39170909090617n7dfb031dube6cddb0a6437593@mail.gmail.com>
	 <e994873a0909090640q5206527epeb494ab43c8ebcc0@mail.gmail.com>
	 <c68e39170909090717w4b9c5423jb45e294c01798032@mail.gmail.com>
Date: Wed, 9 Sep 2009 10:33:33 -0400
Message-ID: <e994873a0909090733x3bf61b44qa7b4a10e182dcba9@mail.gmail.com>
Subject: Re: Lucene 2.9 RC2 now available for testing
From: Peter Keegan <peterlkeegan@gmail.com>
To: java-user@lucene.apache.org, yonik@lucidimagination.com
Content-Type: multipart/alternative; boundary=00504502d35fb00737047325f780
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502d35fb00737047325f780
Content-Type: text/plain; charset=ISO-8859-1

> http://svn.apache.org/viewvc?view=rev&revision=630698
This may be it. The scorer is sparse and usually in a conjuction with a
dense scorer.
Does the index format matter? I haven't yet built it with 2.9.

Peter

On Wed, Sep 9, 2009 at 10:17 AM, Yonik Seeley <yonik@lucidimagination.com>wrote:

> On Wed, Sep 9, 2009 at 9:40 AM, Peter Keegan<peterlkeegan@gmail.com>
> wrote:
> > IndexSearcher.search is calling my custom scorer's 'next' and 'doc'
> methods
> > 64% fewer times. I see no 'advance' method in any of the hot spots'. I am
> > getting the same number of hits from the custom scorer.
> > Has the BooleanScorer2 logic changed?
>
> What does your query structure look like?
> BS2 hasn't changed much.  The old BS may be used in certain
> circumstances, but not in a way that you would see a decrease in
> skipTo()+next().
>
> Shot in the dark: if your scorer is part of a conjunction, maybe
> you're getting lucky with an optimization:
> http://svn.apache.org/viewvc?view=rev&revision=630698
> It was part of http://issues.apache.org/jira/browse/LUCENE-693 , but I
> had a slight bug to the "highest skip first" optimization that wasn't
> fixed until 2.4
>
> Let's assume that your custom scorer is dense (matches almost
> everything) and that another scorer is sparse.  If your custom scorer
> appears first, the conjunction scorer logic would be like so:
> custom.skipTo(),  scorer1.skipTo(),  custom.skipTo() => match!
>
> If the sparse scorer is first, it will look more like so:
> scorer1.skipTo(),  custom.skipTo() => match!
>
> -Yonik
> http://www.lucidimagination.com
>
>
> > Peter
> >
> > On Wed, Sep 9, 2009 at 9:17 AM, Yonik Seeley <
> > yonik.seeley@lucidimagination.com> wrote:
> >
> >> On Wed, Sep 9, 2009 at 8:57 AM, Peter Keegan<peterlkeegan@gmail.com>
> >> wrote:
> >> > Using JProfiler, I observe that the improvement
> >> > is due to a huge reduction in the number of calls to TermDocs.next and
> >> > TermDocs.skipTo (about 65% fewer calls).
> >>
> >> Indexes are searched per-segment now (i.e. MultiTermDocs isn't normally
> >> used).
> >> Off the top of my head, I'm not sure how this can lead to fewer
> >> TermDocs.skipTo() calls though.  Are you sure you weren't also
> >> counting Scorer.skipTo()... which would now be Scorer.advance()?
> >> Have you verified that your custom scorer is working correctly with
> >> 2.9 and that you're getting the same number of hits on the overall
> >> query as you were with previous versions?
> >>
> >> -Yonik
> >> http://www.lucidimagination.com
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00504502d35fb00737047325f780--

From java-user-return-42232-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 15:33:08 2009
Return-Path: <java-user-return-42232-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73626 invoked from network); 9 Sep 2009 15:33:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 15:33:08 -0000
Received: (qmail 4932 invoked by uid 500); 9 Sep 2009 15:33:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4877 invoked by uid 500); 9 Sep 2009 15:33:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4867 invoked by uid 99); 9 Sep 2009 15:33:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 15:33:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of stone54321277@mac.com designates 17.148.16.93 as permitted sender)
Received: from [17.148.16.93] (HELO asmtpout018.mac.com) (17.148.16.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 15:32:55 +0000
MIME-version: 1.0
Content-type: multipart/alternative;
 boundary="Boundary_(ID_Tu3ISmcRm19zakvPw8h/1A)"
Received: from [192.168.1.22] (hearts175024120.hearts.ne.jp [203.175.24.120])
 by asmtp018.mac.com
 (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec 16 2008; 32bit))
 with ESMTPA id <0KPP00IATN5YJC40@asmtp018.mac.com> for
 java-user@lucene.apache.org; Wed, 09 Sep 2009 08:32:24 -0700 (PDT)
Message-id: <2A345345-72E7-448B-86A5-23145958EA37@mac.com>
From: =?UTF-8?B?6ZaiIOejig==?= <stone54321277@mac.com>
To: java-user@lucene.apache.org
Subject: How to calculate the DGaps value in *.del file?
Date: Thu, 10 Sep 2009 00:32:22 +0900
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary_(ID_Tu3ISmcRm19zakvPw8h/1A)
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-transfer-encoding: 7BIT

Hello,

I want to know how to calculate the DGaps value  in *.del file?

For example, if there are 8000 bits and only bits 10,12,32 are set,  
DGaps would be used:

                            (VInt) 1 , (byte) 20 , (VInt) 3 , (Byte) 1

I do not understand why the DGraps is 1 and 3.

Please tell me the conversion method.

Thanks very much.

Kan

--Boundary_(ID_Tu3ISmcRm19zakvPw8h/1A)--

From java-user-return-42233-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 16:51:40 2009
Return-Path: <java-user-return-42233-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8820 invoked from network); 9 Sep 2009 16:51:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 16:51:40 -0000
Received: (qmail 33355 invoked by uid 500); 9 Sep 2009 16:51:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33255 invoked by uid 500); 9 Sep 2009 16:51:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33244 invoked by uid 99); 9 Sep 2009 16:51:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 16:51:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 16:51:27 +0000
Received: by fxm18 with SMTP id 18so1020208fxm.5
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 09:51:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to
         :organization:user-agent:mime-version:to:subject:x-enigmail-version
         :content-type:content-transfer-encoding;
        bh=kFdhjuk3r0KvcEQYRyytgemWAjZWkbXqNa6qzrMTdr0=;
        b=LDoI1jp2ySHtc1ERUHipUB23CDJv5+7IacwxmZRr8BSiBKMGVWO2rGa/Jb6OYQuxna
         yGTm/ti/3ovs7lf8f42Ig6mi1dO2PQoJkWq4sld8YU5jhB/jsbkEeDT9QbHHY3uBiMN4
         evj/39wGgiZM1pNcN2ludx7jd8TTeIqMxItw4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:organization:user-agent:mime-version
         :to:subject:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=EdjBUExYbC9843pyEf1AcuKKFQVa0RrIkQPdebC3oYO7PemOUvtQvbK8Wa3vRY8F4B
         8Fe1ub61hTPn/ZSSq8oHQos6iX4DBwnz0hGOuQFwekVC7We0cME3jOtgrpYgK+kuOOI2
         gxOY6nGWrwu1QqTXN55MMwfSBoYi2irJBWxuc=
Received: by 10.86.217.8 with SMTP id p8mr266704fgg.73.1252515065616;
        Wed, 09 Sep 2009 09:51:05 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id l12sm744590fgb.21.2009.09.09.09.51.03
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 09 Sep 2009 09:51:04 -0700 (PDT)
Message-ID: <4AA7DCF6.9000604@apache.org>
Date: Wed, 09 Sep 2009 12:51:02 -0400
From: Mark Miller <markrmiller@gmail.com>
Reply-To: markrmiller@apache.org
Organization: Apache
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene 2.9 RC3 now available for testing
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello Lucene users,

On behalf of the Lucene dev community (a growing community far larger
than just the committers) I would like to announce the third release
candidate for Lucene 2.9.

Please download and check it out  take it for a spin and kick the
tires. If all goes well, we hope to release the final version of
Lucene 2.9 very shortly.

A handful of bug fixes and documentation improvements (mostly doc)
have been
incorporated since the last RC. The most wide reaching change is
likely the
switch to using the native lock factory by default.

While we generally try and maintain full backwards compatibility
between major versions, Lucene 2.9 has a variety of breaks that are
spelled out in the 'Changes in backwards compatibility policy' section
of CHANGES.txt.

We recommend that you recompile your application with Lucene 2.9
rather than attempting to drop it in. This will alert you to any
issues you may have to fix if you are affected by one of the backward
compatibility breaks. As always, its a really good idea to thoroughly
read CHANGES.txt before upgrading. Also, remember that this is a
release candidate, and not the final Lucene 2.9 release.

Lucene 2.9 comes with a bevy of new features, including:

  * Per segment searching and caching (can lead to much faster reopen
    among other things)

  * Near real-time search capabilities added to IndexWriter

  * New Query types

  * Smarter, more scalable multi-term queries (wildcard, range, etc)

  * A freshly optimized Collector/Scorer API

  * Improved Unicode support and the addition of Collation contrib

  * A new Attribute based TokenStream API

  * A new QueryParser framework in contrib with a core QueryParser
    replacement impl included.

  * Scoring is now optional when sorting by Field, or using a custom
    Collector, gaining sizable performance when scores are not
    required.

  * New analyzers (PersianAnalyzer, ArabicAnalyzer,
    SmartChineseAnalyzer)

  * New fast-vector-highlighter

  * Lucene now includes high-performance handling of numeric fields.
    Such fields are indexed with a trie structure, enabling simple to
    use and much faster numeric range searching without having to
    externally pre-process numeric values into textual values.

  .

And many, many more features, bug fixes, optimizations, and various
improvements. You can find the full list of changes here:

HTML version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Changes.html

Text version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CHANGES.txt

Many changes have also occurred in Lucene's Contrib area:

HTML version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Contrib-Changes.html

Text version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CONTRIB-CHANGES.txt


Download release candidate 3 here:
http://people.apache.org/~markrmiller/staging-area/lucene2.9rc3/

Be sure to report back with any issues you find!

Thanks,

Mark Miller
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkqn3PYACgkQ0DU3IV7ywDnY9gCgrRhUaD3NoXbeSg8+VfqQH399
fDsAn1HFIUMSRfsiOyaiZK+dx8M3Nie6
=SCvS
-----END PGP SIGNATURE-----


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42234-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 20:39:53 2009
Return-Path: <java-user-return-42234-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82024 invoked from network); 9 Sep 2009 20:39:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 20:39:53 -0000
Received: (qmail 26578 invoked by uid 500); 9 Sep 2009 20:39:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26495 invoked by uid 500); 9 Sep 2009 20:39:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26485 invoked by uid 99); 9 Sep 2009 20:39:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 20:39:51 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of bill.w.au@gmail.com designates 209.85.221.171 as permitted sender)
Received: from [209.85.221.171] (HELO mail-qy0-f171.google.com) (209.85.221.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 20:39:42 +0000
Received: by qyk1 with SMTP id 1so209358qyk.22
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 13:39:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=QTSMaSJQBdFxtpvoAXKyFWbSEKIol4HCBdqEEyLb2XA=;
        b=f5/uauGsfpYxvqp0JyI0ttxBv6JCYlrxvrXY3KMryMKNmsGxx9awUYuYw4orAStLVF
         khD0gD3THGbxhI4vaO0mQZdH63+TUbLM00ljOwmbZ0gyBL8A0iSRDAe3f/OOkPrHt+em
         VJ3lb6D6plDnKdjk4kD2YclGmcAiLlvAPLN+M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=f1fvbkny/eeQ5WJI3+xjfhihbTfBZS3+wHblbv6NDpxqICp1ApNoBkz8yOJpab5tOj
         M4EQPFJDLb3PqaTXSf7sz/+G4FH7Qf8J1jZPZvz0WjBOe/nocBCn0x2orWjGs4mcslPS
         Qsnxeu2DSKctGNd+jszPZcKNMVBG0W586rTH8=
MIME-Version: 1.0
Received: by 10.229.69.85 with SMTP id y21mr540962qci.92.1252528761233; Wed, 
	09 Sep 2009 13:39:21 -0700 (PDT)
Date: Wed, 9 Sep 2009 16:39:21 -0400
Message-ID: <3b5f72030909091339l299dc8ddrf74809428f935652@mail.gmail.com>
Subject: support for PayloadTermQuery in MoreLikeThis
From: Bill Au <bill.w.au@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00032557b4d2e261fa04732b1345
X-Virus-Checked: Checked by ClamAV on apache.org

--00032557b4d2e261fa04732b1345
Content-Type: text/plain; charset=ISO-8859-1

Has anyone done anything regarding the support of PayloadTermQuery in
MoreLikeThis?

I took a quick look at the code and it seems to be simply a matter of
swapping TermQuery with PayloadTermQuery.  I guess a generic solution would
be to add a enable method to enable PayloadTermQuery, keeping TermQuery as
the default for backwards compatibility.  The call signature of the same
enable method would also include the PayloadFunction to use for the
PayloadTermQuery.

Any comments/thoughts?

Bill

--00032557b4d2e261fa04732b1345--

From java-user-return-42235-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 09 21:33:57 2009
Return-Path: <java-user-return-42235-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96111 invoked from network); 9 Sep 2009 21:33:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Sep 2009 21:33:57 -0000
Received: (qmail 80665 invoked by uid 500); 9 Sep 2009 21:33:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80598 invoked by uid 500); 9 Sep 2009 21:33:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80588 invoked by uid 99); 9 Sep 2009 21:33:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 21:33:54 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nickb@mailtrust.com designates 207.97.245.121 as permitted sender)
Received: from [207.97.245.121] (HELO smtp121.iad.emailsrvr.com) (207.97.245.121)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Sep 2009 21:33:45 +0000
Received: from relay2.r2.iad.emailsrvr.com (localhost [127.0.0.1])
	by relay2.r2.iad.emailsrvr.com (SMTP Server) with ESMTP id 8EE6D44C141
	for <java-user@lucene.apache.org>; Wed,  9 Sep 2009 17:33:24 -0400 (EDT)
Received: from dynamic8.wm-web.iad.mlsrvr.com (dynamic8.wm-web.iad.mlsrvr.com [192.168.2.149])
	by relay2.r2.iad.emailsrvr.com (SMTP Server) with ESMTP id 8740844C15E
	for <java-user@lucene.apache.org>; Wed,  9 Sep 2009 17:33:24 -0400 (EDT)
Received: from mailtrust.com (localhost [127.0.0.1])
	by dynamic8.wm-web.iad.mlsrvr.com (Postfix) with ESMTP id 79D9C305006C
	for <java-user@lucene.apache.org>; Wed,  9 Sep 2009 17:33:24 -0400 (EDT)
Received: by apps.rackspace.com
    (Authenticated sender: nickb@mailtrust.com, from: nicholas.bailey@rackspace.com) 
    with HTTP; Wed, 9 Sep 2009 17:33:24 -0400 (EDT)
Date: Wed, 9 Sep 2009 17:33:24 -0400 (EDT)
Subject: IndexReader.isCurrent for cached indexes
From: "Nick Bailey" <nicholas.bailey@rackspace.com>
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain;charset=UTF-8
Content-Transfer-Encoding: quoted-printable
Importance: Normal
X-Priority: 3 (Normal)
X-Type: plain
Message-ID: <1252532004.497624575@192.168.1.71>
X-Mailer: webmail7.0b
X-Virus-Checked: Checked by ClamAV on apache.org

Looking for some help figuring out a problem with the IndexReader.isCurrent=
() method and cached indexes. =C2=A0=0A=0AWe have a number of lucene indexe=
s that we attempt to keep in memory after an initial query is performed. =
=C2=A0In order to prevent the indexes from becoming stale, we check for cha=
nges about every minute by calling isCurrent(). =C2=A0If the index has chan=
ged, we will then reopen it.=0A=0AFrom our logs it appears that in some cas=
es isCurrent() will return true even though the index has changed since the=
 last time the reader was opened. =C2=A0=0A=0AThe code to refresh the index=
 is basically this:=0A=0A// Checked every minute=0Aif(!reader.isCurrent()){=
=0A =C2=A0// reopen the existing reader=0A =C2=A0reader =3D this.searcher.g=
etIndexReader();=0A =C2=A0reader =3D reader.reopen();=0A}=0A=0AThis is an e=
xample of the problem from the logs:=0A=0A2009-08-29 17:50:51,387 Indexed 0=
 documents and deleted 1 documents from index 'example' in 0 ms=0A2009-08-3=
0 03:11:58,410 Indexed 0 documents and deleted 5 documents from index 'exam=
ple' in 0 ms=0A2009-08-30 16:30:03,466 Using cached reader <age=3D88648201 =
lastRefresh=3D81415526> =0A// numbers indicate milliseconds since opened or=
 refreshed aka age =3D 24.6hrs, lastRefresh =3D 22.6hrs=0A=0AThe logs indic=
ate we deleted documents from the index at about 5:50 on August 29th, and t=
hen again on the 30th at 3:11. =C2=A0Then at 4:30 on we attempted to query =
the index. =C2=A0We found the cached reader and used it, however, the last =
time the cache was refreshed was about 22 hours previously, coinciding with=
 the first delete. =C2=A0The index should have been reopened after the seco=
nd delete.=0A=0AI have checked, and the code to refresh the indexes is defi=
nitely being run every 60 seconds. =C2=A0All I can see is that the problem =
might be with the isCurrent() method. =C2=A0=0A=0ACould it be due to holdin=
g the reader open for so long? Any other ideas?=0A=0AThanks a lot,=0ANick B=
ailey=0A


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42236-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 03:25:47 2009
Return-Path: <java-user-return-42236-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6089 invoked from network); 10 Sep 2009 03:25:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 03:25:46 -0000
Received: (qmail 97557 invoked by uid 500); 10 Sep 2009 03:25:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97457 invoked by uid 500); 10 Sep 2009 03:25:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97447 invoked by uid 99); 10 Sep 2009 03:25:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 03:25:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of adb@teamware.com designates 212.226.92.15 as permitted sender)
Received: from [212.226.92.15] (HELO monkey.teamware.com) (212.226.92.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 03:25:34 +0000
Received: from intrepid (intrepid.teamw.com [10.142.128.11])
	by monkey.teamware.com (8.13.8/8.13.8) with ESMTP id n8A3P1Fa014438
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 06:25:02 +0300
Received: from mobile.teamware.com ([212.226.92.17]) by nimitz.teamw.com with ESMTP
	 id m33+vkli; 10 Sep 2009 06:24:00 +0300
Message-ID: <4AA871A8.3070307@teamware.com>
Date: Thu, 10 Sep 2009 13:25:28 +1000
From: Antony Bowesman <adb@teamware.com>
User-Agent: Thunderbird 2.0.0.19 (Windows/20081209)
MIME-Version: 1.0
To: Lucene User <java-user@lucene.apache.org>
Subject: NumberFormatException when creating field cache
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-3.0 (monkey.teamware.com [212.226.92.15]); Thu, 10 Sep 2009 06:25:02 +0300 (EEST)
X-Teamware-Monkey-MailScanner-Information: Please contact the ISP for more information
X-Teamware-Monkey-MailScanner-ID: n8A3P1Fa014438
X-Teamware-Monkey-MailScanner: Found to be clean
X-Teamware-Monkey-MailScanner-SpamScore: 1
X-Teamware-Monkey-MailScanner-From: adb@teamware.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No

I'm using Lucene 2.3.2 and have a date field used for sorting, which is 
YYYYMMDDHHMM.  I get an exception when the FieldCache is being generated as follows:

java.lang.NumberFormatException: For input string: "190400-412317"
java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
         at java.lang.Long.parseLong(Long.java:412)
         at java.lang.Long.parseLong(Long.java:461)
org.apache.lucene.search.ExtendedFieldCacheImpl$1.parseLong(ExtendedFieldCacheImpl.java:18)
org.apache.lucene.search.ExtendedFieldCacheImpl$3.createValue(ExtendedFieldCacheImpl.java:53)
org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:72)
org.apache.lucene.search.ExtendedFieldCacheImpl.getLongs(ExtendedFieldCacheImpl.java:36)
org.apache.lucene.search.ExtendedFieldCacheImpl.getLongs(ExtendedFieldCacheImpl.java:30)
org.apache.lucene.search.FieldSortedHitQueue.comparatorLong(FieldSortedHitQueue.java:254)
org.apache.lucene.search.FieldSortedHitQueue$1.createValue(FieldSortedHitQueue.java:194)
org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:72)
org.apache.lucene.search.FieldSortedHitQueue.getCachedComparator(FieldSortedHitQueue.java:168)
org.apache.lucene.search.FieldSortedHitQueue.<init>(FieldSortedHitQueue.java:56)

I'm not able to get onto the server that has the index DB at the moment, but I 
expect my data is corrupt in the index.  That may have been because I have not 
validated certain data given by a 'trusted' source, however, the problem now is 
that assuming that data exists as it is, I am then unable to ever sort on the 
date field.

It maybe that the original data for the Document is no longer available, so 
deleting and re-creating may not be an option.

Would it be useful to allow some sort of data tolerance when creating these 
caches?  At least now the only solution is to delete that Document.  Perhaps the 
values could then be returned as 0 in the Parser implementations for numeric 
failures.

Antony



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42237-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 03:33:17 2009
Return-Path: <java-user-return-42237-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8215 invoked from network); 10 Sep 2009 03:33:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 03:33:17 -0000
Received: (qmail 2824 invoked by uid 500); 10 Sep 2009 03:33:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2679 invoked by uid 500); 10 Sep 2009 03:33:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2669 invoked by uid 99); 10 Sep 2009 03:33:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 03:33:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.221.183 as permitted sender)
Received: from [209.85.221.183] (HELO mail-qy0-f183.google.com) (209.85.221.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 03:33:03 +0000
Received: by qyk13 with SMTP id 13so4212431qyk.3
        for <java-user@lucene.apache.org>; Wed, 09 Sep 2009 20:32:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=yYyW1asoHHF+ugA2oJzgYosDvRNLzrzV1ptcrq+LXKQ=;
        b=FcKF3Fptbgx7YNc1dzQOlGAVRy0mcEZKUT3NhH1ZD3YLsJe194aWe+h5xJevQDmhpm
         GD3heNvqXSuWoV25ElGVOE9mOAWG9E4s14sAFQjEmY3OrdjrVHJIM0S2jVFOZL4V3KrG
         7RAjD9XjVXtSgXsPv8ivgX/FPOmgb8cn6bHjo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=rQ1GseUqOv5JdXtjjam3szFJcIzisaM4Sq6U50BehZyIxUFSguhQmD9ZVnd5JYG2ei
         Y8m/SONbm1R1AGPWyx4yy5B6wpHTZxuPtv5qa+jRMThfXs4/YbYPTLn8USApp0WT3Gjq
         0aorCGwOhxLA9hTztgQWPnO7Qg1wfQzCyHE0Q=
Received: by 10.224.101.144 with SMTP id c16mr979250qao.12.1252553563051;
        Wed, 09 Sep 2009 20:32:43 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 6sm14037qwk.41.2009.09.09.20.32.42
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 09 Sep 2009 20:32:42 -0700 (PDT)
Message-ID: <4AA8735B.5090909@gmail.com>
Date: Wed, 09 Sep 2009 23:32:43 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: NumberFormatException when creating field cache
References: <4AA871A8.3070307@teamware.com>
In-Reply-To: <4AA871A8.3070307@teamware.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Antony Bowesman wrote:
> I'm using Lucene 2.3.2 and have a date field used for sorting, which
> is YYYYMMDDHHMM.  I get an exception when the FieldCache is being
> generated as follows:
>
> java.lang.NumberFormatException: For input string: "190400-412317"
> java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
>
>         at java.lang.Long.parseLong(Long.java:412)
>         at java.lang.Long.parseLong(Long.java:461)
> org.apache.lucene.search.ExtendedFieldCacheImpl$1.parseLong(ExtendedFieldCacheImpl.java:18)
>
> org.apache.lucene.search.ExtendedFieldCacheImpl$3.createValue(ExtendedFieldCacheImpl.java:53)
>
> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:72)
> org.apache.lucene.search.ExtendedFieldCacheImpl.getLongs(ExtendedFieldCacheImpl.java:36)
>
> org.apache.lucene.search.ExtendedFieldCacheImpl.getLongs(ExtendedFieldCacheImpl.java:30)
>
> org.apache.lucene.search.FieldSortedHitQueue.comparatorLong(FieldSortedHitQueue.java:254)
>
> org.apache.lucene.search.FieldSortedHitQueue$1.createValue(FieldSortedHitQueue.java:194)
>
> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:72)
> org.apache.lucene.search.FieldSortedHitQueue.getCachedComparator(FieldSortedHitQueue.java:168)
>
> org.apache.lucene.search.FieldSortedHitQueue.<init>(FieldSortedHitQueue.java:56)
>
>
> I'm not able to get onto the server that has the index DB at the
> moment, but I expect my data is corrupt in the index.  That may have
> been because I have not validated certain data given by a 'trusted'
> source, however, the problem now is that assuming that data exists as
> it is, I am then unable to ever sort on the date field.
>
> It maybe that the original data for the Document is no longer
> available, so deleting and re-creating may not be an option.
>
> Would it be useful to allow some sort of data tolerance when creating
> these caches?  At least now the only solution is to delete that
> Document.  Perhaps the values could then be returned as 0 in the
> Parser implementations for numeric failures.
>
> Antony
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
Validation adds costs - its best for you to validate before putting it
in the field if you need it.

Not only do you have to delete, but you also have to purge the delete by
causing the right merge or
optimizing (guaranteed to cause the right merge). Until then, deleted or
not, it will attempt to parse
the bad Long.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42238-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 06:33:32 2009
Return-Path: <java-user-return-42238-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50113 invoked from network); 10 Sep 2009 06:33:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 06:33:32 -0000
Received: (qmail 51637 invoked by uid 500); 10 Sep 2009 06:33:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51556 invoked by uid 500); 10 Sep 2009 06:33:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51546 invoked by uid 99); 10 Sep 2009 06:33:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 06:33:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 06:33:20 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MldDH-0007dm-I8
	for java-user@lucene.apache.org; Wed, 09 Sep 2009 23:32:59 -0700
Message-ID: <25378056.post@talk.nabble.com>
Date: Wed, 9 Sep 2009 23:32:59 -0700 (PDT)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to avoid huge index files
In-Reply-To: <25347505.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
References: <25347505.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hello again,

Can someone please comment on that, whether what I'm looking is possible or
not?


Dvora wrote:
> 
> Hello,
> 
> I'm using Lucene2.4. I'm developing a web application that using Lucene
> (via compass) to do the searches.
> I'm intending to deploy the application in Google App Engine
> (http://code.google.com/appengine/), which limits files length to be
> smaller than 10MB. I've read about the various policies supported by
> Lucene to limit the file sizes, but on matter which policy I used and
> which parameters, the index files still grew to be lot more the 10MB.
> Looking at the code, I've managed to limit the cfs files (predicting the
> file size in CompoundFileWriter before closing the file) - I guess that
> will degrade performance, but it's OK for now. But now the FDT files are
> becoming huge (about 60MB) and I cant identifiy a way to limit those
> files.
> 
> Is there some built-in and correct way to limit these files length? If no,
> can someone direct me please how should I tweak the source code to achieve
> that?
> 
> Thanks for any help.
> 

-- 
View this message in context: http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p25378056.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42239-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 08:43:28 2009
Return-Path: <java-user-return-42239-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87268 invoked from network); 10 Sep 2009 08:43:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 08:43:27 -0000
Received: (qmail 92084 invoked by uid 500); 10 Sep 2009 08:41:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92060 invoked by uid 500); 10 Sep 2009 08:41:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92034 invoked by uid 99); 10 Sep 2009 08:41:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 08:41:21 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_HELO_PASS,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.227.17.9] (HELO moutng.kundenserver.de) (212.227.17.9)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 08:41:12 +0000
Received: from [192.168.178.53] (p5083C394.dip.t-dialin.net [80.131.195.148])
	by mrelayeu.kundenserver.de (node=mrbap1) with ESMTP (Nemesis)
	id 0MKt2u-1MlfCz3kyT-000SwX; Thu, 10 Sep 2009 10:40:50 +0200
Message-ID: <4AA8BB8C.6050604@prometa.de>
Date: Thu, 10 Sep 2009 10:40:44 +0200
From: Patricio Galeas <galeas@prometa.de>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: TooManyClauses by wildcard queries
Content-Type: text/plain; charset=ISO-8859-15; format=flowed
Content-Transfer-Encoding: 7bit
X-Provags-ID: V01U2FsdGVkX1/9aI1SWGiP3FETB7xgYkw8PpNhXnAW/KlYBQL
 2wTMNzBiS6wfYWskEJE4KgeI3mlXvFK2YNag1kDtpN8gbQJ8Xa
 vag2cLMo83z3Qx33zh40Z717ONKvFEo
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

I get the TooManyClauses exception by some wildcard queries like :
(a) de*
(b) country AND de*
(c) ma?s* AND de*

I'm not sure how to apply the solution proposed in LuceneFAQ for the 
case of WildcardQueries like the examples above.

Can you confirm if it is the right procedure?

1. Override QueryParser.getWildcardQuery() to return a ConstantScoreQuery.
2. Break up the query to identify the wildcard query part.
3. Create a custom Filter for the wildcard query
4. Create the final query using the custom filter.

If the item 2. is right, can you suggest me an optimal way to do that?

Thank you
Patricio




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42240-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 09:06:07 2009
Return-Path: <java-user-return-42240-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93552 invoked from network); 10 Sep 2009 09:06:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 09:06:06 -0000
Received: (qmail 22014 invoked by uid 500); 10 Sep 2009 09:06:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21931 invoked by uid 500); 10 Sep 2009 09:06:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21921 invoked by uid 99); 10 Sep 2009 09:06:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:06:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:05:56 +0000
Received: by fxm2 with SMTP id 2so4006599fxm.28
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 02:05:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=1UMRyBfPf8xdg531mNpivdFfHP/q8HFovkZbpk++Xn0=;
        b=wFM5tMzZCT7FLnWlXYrhSuDfh8w2xsteelz436ZZBIBHhE4sdT4lx/6GYXZzgJ83mg
         OkMCVJtpzjvJgWIF2G5vuayDtl1ba2jeFdyhHHTEuIQeNu0BM5HDjmnm4Ud2Wxx/TkB4
         VgDJuXidBCjqu3nrVP3sZVZ67sO4WlE8V+boM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=kZtTMCGK4vIQVIRdHjT0gtChlNHQCb6knX7+9R2fwr5oP5XDTcLX/6FzM8xFhiitF+
         ihSG8sZA/szHg431o+C5gbQuueHRDHfswMDzWayvLo0cP7hW2YTcsCUUMoOEJwB+2q4A
         79lWGY2OlnacAYNJdZOv2LWscOVHqOTOfW0E0=
MIME-Version: 1.0
Received: by 10.86.17.27 with SMTP id 27mr934667fgq.31.1252573535078; Thu, 10 
	Sep 2009 02:05:35 -0700 (PDT)
In-Reply-To: <1252532004.497624575@192.168.1.71>
References: <1252532004.497624575@192.168.1.71>
From: Ian Lea <ian.lea@gmail.com>
Date: Thu, 10 Sep 2009 10:05:15 +0100
Message-ID: <8c4e68610909100205l36f15a66t7471c545d3e845d3@mail.gmail.com>
Subject: Re: IndexReader.isCurrent for cached indexes
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

isCurrent() will only return true if there have been committed changes
to the index.  Maybe for some reason your index update job hasn't
committed or closed the index.

Probably not relevant to this problem, but your reopen code snippet
doesn't close the old reader.  It should.  See the javadocs.

What version of lucene are you running?



--
Ian.


On Wed, Sep 9, 2009 at 10:33 PM, Nick Bailey
<nicholas.bailey@rackspace.com> wrote:
> Looking for some help figuring out a problem with the IndexReader.isCurre=
nt() method and cached indexes.
>
> We have a number of lucene indexes that we attempt to keep in memory afte=
r an initial query is performed. =A0In order to prevent the indexes from be=
coming stale, we check for changes about every minute by calling isCurrent(=
). =A0If the index has changed, we will then reopen it.
>
> From our logs it appears that in some cases isCurrent() will return true =
even though the index has changed since the last time the reader was opened=
.
>
> The code to refresh the index is basically this:
>
> // Checked every minute
> if(!reader.isCurrent()){
> =A0=A0// reopen the existing reader
> =A0=A0reader =3D this.searcher.getIndexReader();
> =A0=A0reader =3D reader.reopen();
> }
>
> This is an example of the problem from the logs:
>
> 2009-08-29 17:50:51,387 Indexed 0 documents and deleted 1 documents from =
index 'example' in 0 ms
> 2009-08-30 03:11:58,410 Indexed 0 documents and deleted 5 documents from =
index 'example' in 0 ms
> 2009-08-30 16:30:03,466 Using cached reader <age=3D88648201 lastRefresh=
=3D81415526>
> // numbers indicate milliseconds since opened or refreshed aka age =3D 24=
.6hrs, lastRefresh =3D 22.6hrs
>
> The logs indicate we deleted documents from the index at about 5:50 on Au=
gust 29th, and then again on the 30th at 3:11. =A0Then at 4:30 on we attemp=
ted to query the index. =A0We found the cached reader and used it, however,=
 the last time the cache was refreshed was about 22 hours previously, coinc=
iding with the first delete. =A0The index should have been reopened after t=
he second delete.
>
> I have checked, and the code to refresh the indexes is definitely being r=
un every 60 seconds. =A0All I can see is that the problem might be with the=
 isCurrent() method.
>
> Could it be due to holding the reader open for so long? Any other ideas?
>
> Thanks a lot,
> Nick Bailey
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42241-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 09:07:09 2009
Return-Path: <java-user-return-42241-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94051 invoked from network); 10 Sep 2009 09:07:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 09:07:09 -0000
Received: (qmail 25718 invoked by uid 500); 10 Sep 2009 09:07:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25639 invoked by uid 500); 10 Sep 2009 09:07:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25623 invoked by uid 99); 10 Sep 2009 09:07:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:07:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.183] (HELO mail-yw0-f183.google.com) (209.85.211.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:06:56 +0000
Received: by ywh13 with SMTP id 13so5677946ywh.20
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 02:06:34 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.151.20.17 with SMTP id x17mr2317981ybi.102.1252573593897; Thu, 
	10 Sep 2009 02:06:33 -0700 (PDT)
In-Reply-To: <25378056.post@talk.nabble.com>
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 05:06:33 -0400
Message-ID: <9ac0c6aa0909100206h753657feiddf01de25850ad7e@mail.gmail.com>
Subject: Re: How to avoid huge index files
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

First, you need to limit the size of segments initially created by
IndexWriter due to newly added documents.  Probably the simplest way
is to call IndexWriter.commit() frequently enough.  You might want to
use IndexWriter.ramSizeInBytes() to gauge how much RAM is currently
consumed by IndexWriter's buffer to determine when to commit.  But it
won't be an exact science, ie, the segment size will be different from
the RAM buffer size.  So, experiment w/ it...

Second, you need to prevent merging from creating a segment that's too
large.  For this I would use the setMaxMergeMB method of the
LogByteSizeMergePolicy (which is IndexWriter's default merge policy).
But note that this max size applies to the *input* segments, so you'd
roughly want that to be 1.0 MB (your 10.0 MB divided by the merge
factor = 10), but probably make it smaller to be sure things stay
small enough.

Note that with this approach, if your index is large enough, you'll
wind up with many segments and search performance will suffer when
compared to an index that doesn't have this max 10.0 MB file size
restriction.

Mike

On Thu, Sep 10, 2009 at 2:32 AM, Dvora <barak.yaish@gmail.com> wrote:
>
> Hello again,
>
> Can someone please comment on that, whether what I'm looking is possible or
> not?
>
>
> Dvora wrote:
>>
>> Hello,
>>
>> I'm using Lucene2.4. I'm developing a web application that using Lucene
>> (via compass) to do the searches.
>> I'm intending to deploy the application in Google App Engine
>> (http://code.google.com/appengine/), which limits files length to be
>> smaller than 10MB. I've read about the various policies supported by
>> Lucene to limit the file sizes, but on matter which policy I used and
>> which parameters, the index files still grew to be lot more the 10MB.
>> Looking at the code, I've managed to limit the cfs files (predicting the
>> file size in CompoundFileWriter before closing the file) - I guess that
>> will degrade performance, but it's OK for now. But now the FDT files are
>> becoming huge (about 60MB) and I cant identifiy a way to limit those
>> files.
>>
>> Is there some built-in and correct way to limit these files length? If no,
>> can someone direct me please how should I tweak the source code to achieve
>> that?
>>
>> Thanks for any help.
>>
>
> --
> View this message in context: http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p25378056.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42242-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 09:11:53 2009
Return-Path: <java-user-return-42242-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94916 invoked from network); 10 Sep 2009 09:11:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 09:11:52 -0000
Received: (qmail 31215 invoked by uid 500); 10 Sep 2009 09:11:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31127 invoked by uid 500); 10 Sep 2009 09:11:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31117 invoked by uid 99); 10 Sep 2009 09:11:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:11:50 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:11:38 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id AB92C45EFC7
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 11:11:18 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id UvqXjTZmDid2 for <java-user@lucene.apache.org>;
	Thu, 10 Sep 2009 11:11:08 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 60554D36003
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 11:11:08 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AA8BB8C.6050604@prometa.de>
Subject: RE: TooManyClauses by wildcard queries
Date: Thu, 10 Sep 2009 11:11:05 +0200
Message-ID: <CB9FFC1766B84ACF8FD0E46B8137BB24@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AA8BB8C.6050604@prometa.de>
Thread-Index: Acox8swgdQzjHP60StyWGevBksU/AQAA7RDQ
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Or use Lucene 2.9, it automatically uses constant score mode in wild card
queries, if needed.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Patricio Galeas [mailto:galeas@prometa.de]
> Sent: Thursday, September 10, 2009 10:41 AM
> To: java-user@lucene.apache.org
> Subject: TooManyClauses by wildcard queries
> 
> Hi all,
> 
> I get the TooManyClauses exception by some wildcard queries like :
> (a) de*
> (b) country AND de*
> (c) ma?s* AND de*
> 
> I'm not sure how to apply the solution proposed in LuceneFAQ for the
> case of WildcardQueries like the examples above.
> 
> Can you confirm if it is the right procedure?
> 
> 1. Override QueryParser.getWildcardQuery() to return a ConstantScoreQuery.
> 2. Break up the query to identify the wildcard query part.
> 3. Create a custom Filter for the wildcard query
> 4. Create the final query using the custom filter.
> 
> If the item 2. is right, can you suggest me an optimal way to do that?
> 
> Thank you
> Patricio
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42243-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 09:13:07 2009
Return-Path: <java-user-return-42243-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95258 invoked from network); 10 Sep 2009 09:13:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 09:13:07 -0000
Received: (qmail 35678 invoked by uid 500); 10 Sep 2009 09:13:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35589 invoked by uid 500); 10 Sep 2009 09:13:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35579 invoked by uid 99); 10 Sep 2009 09:13:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:13:04 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:12:55 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n8A9CYtu014404
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 10:12:34 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Thu, 10 Sep 2009 10:12:33 +0100 (BST)
Date: Thu, 10 Sep 2009 10:12:33 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <802289754.4941252573953010.JavaMail.root@mail.uk.scalix.com>
Subject: RE: New "Stream closed" exception with Java 6
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Hi Hoss,

I have been thinking more about what you said (below) - could you please expand on the indented part of this sentence:

"it's possibly you just have a simple bug where you are  closing the reader before you pass it to Lucene, 

      or maybe you are mistakenly adding the same field twice

(or in two different documents)"

Are you saying that if I were attempting to delete a doc and then add it again (e.g. update), but for some reason the delete didn't work, I would get a "Stream closed" exception?

Thanks 

- Chris

----- Original Message -----
From: Chris Hostetter <hossman_lucene@fucit.org>
Sent: Tue, 8/9/2009 7:57pm
To: java-user@lucene.apache.org
Subject: RE: New "Stream closed" exception with Java 6


: I'm coming to the same conclusion - there must be >1 threads accessing this index at the same time.  Better go figure it out  ...  :-)

careful about your assumptions ... you could get this same type of 
exception even with only one thread, the stream that's being closed isn't 
internal to Lucene, it's the InputStreamReader you supplied as the value 
of some Field.  it's possibly you just have a simple bug where you are 
closing hte reader before you pass it to Lucene, or maybe you are 
mistakenly adding the saame field twice (or in two different documents)


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42244-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 09:27:19 2009
Return-Path: <java-user-return-42244-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97473 invoked from network); 10 Sep 2009 09:27:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 09:27:19 -0000
Received: (qmail 48384 invoked by uid 500); 10 Sep 2009 09:27:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48322 invoked by uid 500); 10 Sep 2009 09:27:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48311 invoked by uid 99); 10 Sep 2009 09:27:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:27:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 09:27:08 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MlfvT-0004Z8-LA
	for java-user@lucene.apache.org; Thu, 10 Sep 2009 02:26:47 -0700
Message-ID: <25380052.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 02:26:47 -0700 (PDT)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to avoid huge index files
In-Reply-To: <9ac0c6aa0909100206h753657feiddf01de25850ad7e@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com> <9ac0c6aa0909100206h753657feiddf01de25850ad7e@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

Thanks a lot for that, will peforms the experiments and publish the results.
I'm aware to the risk of peformance degredation, but for the pilot I'm
trying to run I think it's acceptable.

Thanks again!



Michael McCandless-2 wrote:
> 
> First, you need to limit the size of segments initially created by
> IndexWriter due to newly added documents.  Probably the simplest way
> is to call IndexWriter.commit() frequently enough.  You might want to
> use IndexWriter.ramSizeInBytes() to gauge how much RAM is currently
> consumed by IndexWriter's buffer to determine when to commit.  But it
> won't be an exact science, ie, the segment size will be different from
> the RAM buffer size.  So, experiment w/ it...
> 
> Second, you need to prevent merging from creating a segment that's too
> large.  For this I would use the setMaxMergeMB method of the
> LogByteSizeMergePolicy (which is IndexWriter's default merge policy).
> But note that this max size applies to the *input* segments, so you'd
> roughly want that to be 1.0 MB (your 10.0 MB divided by the merge
> factor = 10), but probably make it smaller to be sure things stay
> small enough.
> 
> Note that with this approach, if your index is large enough, you'll
> wind up with many segments and search performance will suffer when
> compared to an index that doesn't have this max 10.0 MB file size
> restriction.
> 
> Mike
> 
> On Thu, Sep 10, 2009 at 2:32 AM, Dvora <barak.yaish@gmail.com> wrote:
>>
>> Hello again,
>>
>> Can someone please comment on that, whether what I'm looking is possible
>> or
>> not?
>>
>>
>> Dvora wrote:
>>>
>>> Hello,
>>>
>>> I'm using Lucene2.4. I'm developing a web application that using Lucene
>>> (via compass) to do the searches.
>>> I'm intending to deploy the application in Google App Engine
>>> (http://code.google.com/appengine/), which limits files length to be
>>> smaller than 10MB. I've read about the various policies supported by
>>> Lucene to limit the file sizes, but on matter which policy I used and
>>> which parameters, the index files still grew to be lot more the 10MB.
>>> Looking at the code, I've managed to limit the cfs files (predicting the
>>> file size in CompoundFileWriter before closing the file) - I guess that
>>> will degrade performance, but it's OK for now. But now the FDT files are
>>> becoming huge (about 60MB) and I cant identifiy a way to limit those
>>> files.
>>>
>>> Is there some built-in and correct way to limit these files length? If
>>> no,
>>> can someone direct me please how should I tweak the source code to
>>> achieve
>>> that?
>>>
>>> Thanks for any help.
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p25378056.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p25380052.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42245-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 10:43:06 2009
Return-Path: <java-user-return-42245-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18657 invoked from network); 10 Sep 2009 10:43:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 10:43:06 -0000
Received: (qmail 35011 invoked by uid 500); 10 Sep 2009 10:43:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34922 invoked by uid 500); 10 Sep 2009 10:43:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34912 invoked by uid 99); 10 Sep 2009 10:43:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 10:43:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.193] (HELO mail-yx0-f193.google.com) (209.85.210.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 10:42:52 +0000
Received: by yxe31 with SMTP id 31so8598932yxe.29
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 03:42:30 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.240.21 with SMTP id n21mr2447934ybh.165.1252579350819; 
	Thu, 10 Sep 2009 03:42:30 -0700 (PDT)
In-Reply-To: <25380052.post@talk.nabble.com>
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com>
	 <9ac0c6aa0909100206h753657feiddf01de25850ad7e@mail.gmail.com>
	 <25380052.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 06:42:30 -0400
Message-ID: <9ac0c6aa0909100342l683d8d6evc4026106447073fb@mail.gmail.com>
Subject: Re: How to avoid huge index files
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

You're welcome!

Another, bottoms-up option would be to make a custom Directory impl
that simply splits up files above a certain size.  That'd be more
generic and more reliable...

Mike

On Thu, Sep 10, 2009 at 5:26 AM, Dvora <barak.yaish@gmail.com> wrote:
>
> Hi,
>
> Thanks a lot for that, will peforms the experiments and publish the resul=
ts.
> I'm aware to the risk of peformance degredation, but for the pilot I'm
> trying to run I think it's acceptable.
>
> Thanks again!
>
>
>
> Michael McCandless-2 wrote:
>>
>> First, you need to limit the size of segments initially created by
>> IndexWriter due to newly added documents. =A0Probably the simplest way
>> is to call IndexWriter.commit() frequently enough. =A0You might want to
>> use IndexWriter.ramSizeInBytes() to gauge how much RAM is currently
>> consumed by IndexWriter's buffer to determine when to commit. =A0But it
>> won't be an exact science, ie, the segment size will be different from
>> the RAM buffer size. =A0So, experiment w/ it...
>>
>> Second, you need to prevent merging from creating a segment that's too
>> large. =A0For this I would use the setMaxMergeMB method of the
>> LogByteSizeMergePolicy (which is IndexWriter's default merge policy).
>> But note that this max size applies to the *input* segments, so you'd
>> roughly want that to be 1.0 MB (your 10.0 MB divided by the merge
>> factor =3D 10), but probably make it smaller to be sure things stay
>> small enough.
>>
>> Note that with this approach, if your index is large enough, you'll
>> wind up with many segments and search performance will suffer when
>> compared to an index that doesn't have this max 10.0 MB file size
>> restriction.
>>
>> Mike
>>
>> On Thu, Sep 10, 2009 at 2:32 AM, Dvora <barak.yaish@gmail.com> wrote:
>>>
>>> Hello again,
>>>
>>> Can someone please comment on that, whether what I'm looking is possibl=
e
>>> or
>>> not?
>>>
>>>
>>> Dvora wrote:
>>>>
>>>> Hello,
>>>>
>>>> I'm using Lucene2.4. I'm developing a web application that using Lucen=
e
>>>> (via compass) to do the searches.
>>>> I'm intending to deploy the application in Google App Engine
>>>> (http://code.google.com/appengine/), which limits files length to be
>>>> smaller than 10MB. I've read about the various policies supported by
>>>> Lucene to limit the file sizes, but on matter which policy I used and
>>>> which parameters, the index files still grew to be lot more the 10MB.
>>>> Looking at the code, I've managed to limit the cfs files (predicting t=
he
>>>> file size in CompoundFileWriter before closing the file) - I guess tha=
t
>>>> will degrade performance, but it's OK for now. But now the FDT files a=
re
>>>> becoming huge (about 60MB) and I cant identifiy a way to limit those
>>>> files.
>>>>
>>>> Is there some built-in and correct way to limit these files length? If
>>>> no,
>>>> can someone direct me please how should I tweak the source code to
>>>> achieve
>>>> that?
>>>>
>>>> Thanks for any help.
>>>>
>>>
>>> --
>>> View this message in context:
>>> http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p25378056=
.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://www.nabble.com/How-to-avoid-huge-ind=
ex-files-tp25347505p25380052.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42246-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 10:54:31 2009
Return-Path: <java-user-return-42246-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20250 invoked from network); 10 Sep 2009 10:54:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 10:54:31 -0000
Received: (qmail 50295 invoked by uid 500); 10 Sep 2009 10:54:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50239 invoked by uid 500); 10 Sep 2009 10:54:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50229 invoked by uid 99); 10 Sep 2009 10:54:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 10:54:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [202.54.194.105] (HELO mail.prathamsoftware.com) (202.54.194.105)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 10:54:19 +0000
Received: (qmail 25713 invoked by uid 510); 10 Sep 2009 16:24:02 +0530
Received: from 192.168.0.88 by QMAIL (envelope-from <vibhuti.gupta@thepsi.com>, uid 508) with qmail-scanner-1.25-st-qms 
 (clamdscan: 0.87/4951. spamassassin: 3.0.6. perlscan: 1.25-st-qms.  
 Clear:RC:1(192.168.0.88):. 
 Processed in 0.270928 secs); 10 Sep 2009 10:54:02 -0000
X-Antivirus-thepsi.com-Mail-From: vibhuti.gupta@thepsi.com via QMAIL
X-Antivirus-thepsi.com: 1.25-st-qms (Clear:RC:1(192.168.0.88):. Processed in 0.270928 secs Process 25707)
Received: from unknown (HELO ps163) (vibhuti.gupta@thePSI.com@192.168.0.88)
  by prathamsoftware.com with SMTP; 10 Sep 2009 16:24:01 +0530
From: "vibhuti" <vibhuti.gupta@thePSI.com>
To: <java-user@lucene.apache.org>
Subject: Problem in lucene query
Date: Thu, 10 Sep 2009 16:17:51 +0530
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0031_01CA3232.3F6A5FD0"
X-Mailer: Microsoft Office Outlook, Build 11.0.5510
Thread-Index: AcoyBCUL2JoHG1DsRHGhEHoO6Xchew==
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3350
Message-ID: <1252580042107325707@QMAIL>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0031_01CA3232.3F6A5FD0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Hello 

 

I am new to Lucene and facing a problem while performing searches. I am
using lucene 2.2.0.

My application indexes documents on "keyword" field which contains integer
values. If the value is negative the query does not return correct results.

 

Following is my lucene query:

 

(keyword: \-1)

 

I also tried: 

(keyword: "-1")

 

 

But none of them returns correct results. It seems that Lucene ignores '-'.
My purpose is to search documents with index value "-1".

 

Any ideas??

 

Thanks


------=_NextPart_000_0031_01CA3232.3F6A5FD0--



From java-user-return-42247-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 10:58:23 2009
Return-Path: <java-user-return-42247-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20937 invoked from network); 10 Sep 2009 10:58:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 10:58:22 -0000
Received: (qmail 53196 invoked by uid 500); 10 Sep 2009 10:58:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53110 invoked by uid 500); 10 Sep 2009 10:58:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53099 invoked by uid 99); 10 Sep 2009 10:58:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 10:58:20 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.66] (HELO spunkymail-a20.g.dreamhost.com) (208.97.132.66)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 10:58:11 +0000
Received: from [10.0.0.169] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by spunkymail-a20.g.dreamhost.com (Postfix) with ESMTP id 88A77E24DF
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 03:57:49 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1075.2)
Subject: Re: support for PayloadTermQuery in MoreLikeThis
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <3b5f72030909091339l299dc8ddrf74809428f935652@mail.gmail.com>
Date: Thu, 10 Sep 2009 06:57:43 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <28AA461D-CC4D-4000-B88D-75D3754A1F98@apache.org>
References: <3b5f72030909091339l299dc8ddrf74809428f935652@mail.gmail.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1075.2)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 9, 2009, at 4:39 PM, Bill Au wrote:

> Has anyone done anything regarding the support of PayloadTermQuery in
> MoreLikeThis?

Not yet!  Sounds interesting

>
> I took a quick look at the code and it seems to be simply a matter of
> swapping TermQuery with PayloadTermQuery.  I guess a generic  
> solution would
> be to add a enable method to enable PayloadTermQuery, keeping  
> TermQuery as
> the default for backwards compatibility.  The call signature of the  
> same
> enable method would also include the PayloadFunction to use for the
> PayloadTermQuery.
>
> Any comments/thoughts?


Hmm, this could work, but I think we should try to be generic if we  
can and have it be overridable.  Today's PTQ is likely to segue to  
tomorrow's AttributeTermQuery and I wouldn't want to preclude them.

-Grant

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42248-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 11:23:51 2009
Return-Path: <java-user-return-42248-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29497 invoked from network); 10 Sep 2009 11:23:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 11:23:51 -0000
Received: (qmail 77688 invoked by uid 500); 10 Sep 2009 11:23:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77625 invoked by uid 500); 10 Sep 2009 11:23:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77615 invoked by uid 99); 10 Sep 2009 11:23:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 11:23:48 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 11:23:39 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MlhkE-00088U-Bu
	for java-user@lucene.apache.org; Thu, 10 Sep 2009 04:23:18 -0700
Message-ID: <25381489.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 04:23:18 -0700 (PDT)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to avoid huge index files
In-Reply-To: <9ac0c6aa0909100342l683d8d6evc4026106447073fb@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: barak.yaish@gmail.com
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com> <9ac0c6aa0909100206h753657feiddf01de25850ad7e@mail.gmail.com> <25380052.post@talk.nabble.com> <9ac0c6aa0909100342l683d8d6evc4026106447073fb@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi again,

Can you add some details and guidelines how to implement that? Different
files types have different structure, is such spliting doable without
knowing Lucene internals?


Michael McCandless-2 wrote:
>=20
> You're welcome!
>=20
> Another, bottoms-up option would be to make a custom Directory impl
> that simply splits up files above a certain size.  That'd be more
> generic and more reliable...
>=20
> Mike
>=20
> On Thu, Sep 10, 2009 at 5:26 AM, Dvora <barak.yaish@gmail.com> wrote:
>>
>> Hi,
>>
>> Thanks a lot for that, will peforms the experiments and publish the
>> results.
>> I'm aware to the risk of peformance degredation, but for the pilot I'm
>> trying to run I think it's acceptable.
>>
>> Thanks again!
>>
>>
>>
>> Michael McCandless-2 wrote:
>>>
>>> First, you need to limit the size of segments initially created by
>>> IndexWriter due to newly added documents. =C2=A0Probably the simplest w=
ay
>>> is to call IndexWriter.commit() frequently enough. =C2=A0You might want=
 to
>>> use IndexWriter.ramSizeInBytes() to gauge how much RAM is currently
>>> consumed by IndexWriter's buffer to determine when to commit. =C2=A0But=
 it
>>> won't be an exact science, ie, the segment size will be different from
>>> the RAM buffer size. =C2=A0So, experiment w/ it...
>>>
>>> Second, you need to prevent merging from creating a segment that's too
>>> large. =C2=A0For this I would use the setMaxMergeMB method of the
>>> LogByteSizeMergePolicy (which is IndexWriter's default merge policy).
>>> But note that this max size applies to the *input* segments, so you'd
>>> roughly want that to be 1.0 MB (your 10.0 MB divided by the merge
>>> factor =3D 10), but probably make it smaller to be sure things stay
>>> small enough.
>>>
>>> Note that with this approach, if your index is large enough, you'll
>>> wind up with many segments and search performance will suffer when
>>> compared to an index that doesn't have this max 10.0 MB file size
>>> restriction.
>>>
>>> Mike
>>>
>>> On Thu, Sep 10, 2009 at 2:32 AM, Dvora <barak.yaish@gmail.com> wrote:
>>>>
>>>> Hello again,
>>>>
>>>> Can someone please comment on that, whether what I'm looking is
>>>> possible
>>>> or
>>>> not?
>>>>
>>>>
>>>> Dvora wrote:
>>>>>
>>>>> Hello,
>>>>>
>>>>> I'm using Lucene2.4. I'm developing a web application that using
>>>>> Lucene
>>>>> (via compass) to do the searches.
>>>>> I'm intending to deploy the application in Google App Engine
>>>>> (http://code.google.com/appengine/), which limits files length to be
>>>>> smaller than 10MB. I've read about the various policies supported by
>>>>> Lucene to limit the file sizes, but on matter which policy I used and
>>>>> which parameters, the index files still grew to be lot more the 10MB.
>>>>> Looking at the code, I've managed to limit the cfs files (predicting
>>>>> the
>>>>> file size in CompoundFileWriter before closing the file) - I guess
>>>>> that
>>>>> will degrade performance, but it's OK for now. But now the FDT files
>>>>> are
>>>>> becoming huge (about 60MB) and I cant identifiy a way to limit those
>>>>> files.
>>>>>
>>>>> Is there some built-in and correct way to limit these files length? I=
f
>>>>> no,
>>>>> can someone direct me please how should I tweak the source code to
>>>>> achieve
>>>>> that?
>>>>>
>>>>> Thanks for any help.
>>>>>
>>>>
>>>> --
>>>> View this message in context:
>>>> http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p2537805=
6.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p25380052.=
html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/How-to-avoid-huge-index=
-files-tp25347505p25381489.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42249-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 11:29:38 2009
Return-Path: <java-user-return-42249-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30787 invoked from network); 10 Sep 2009 11:29:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 11:29:38 -0000
Received: (qmail 82632 invoked by uid 500); 10 Sep 2009 11:29:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82543 invoked by uid 500); 10 Sep 2009 11:29:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82533 invoked by uid 99); 10 Sep 2009 11:29:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 11:29:35 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 11:29:23 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 4CE5CD36004
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 13:29:03 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id c7EXmxrqwbH4 for <java-user@lucene.apache.org>;
	Thu, 10 Sep 2009 13:28:52 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.78])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id BE795D36003
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 13:28:52 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com> <9ac0c6aa0909100206h753657feiddf01de25850ad7e@mail.gmail.com> <25380052.post@talk.nabble.com> <9ac0c6aa0909100342l683d8d6evc4026106447073fb@mail.gmail.com> <25381489.post@talk.nabble.com>
Subject: RE: How to avoid huge index files
Date: Thu, 10 Sep 2009 13:28:49 +0200
Message-ID: <5474EB3EDAE040419152186A54F3787C@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <25381489.post@talk.nabble.com>
Thread-Index: AcoyCTKwo2ZDaXMLR1SXMRV0m2cWlgAAEFdQ
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

The idea is just to put a layer on top of the abstract file system =
function
supplied by directory. Whenever somebody wants to create a file and =
write
data to it, the methods create more than one file and switch e.g. after =
10
Megabytes to another file. E.g. look into MMapDirectory that uses MMap =
to
map files into address space. Because MappedByteBuffer only supports 32 =
bit
offsets, there will be created different mappings for the same file (the
file is splitted up into parts of 2 Gigabytes). You could use similar =
code
here and just use another file, if somebody seeks or writes above the 10 =
MiB
limit. Just "virtualize" the files.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> From: Dvora [mailto:barak.yaish@gmail.com]
> Sent: Thursday, September 10, 2009 1:23 PM
> To: java-user@lucene.apache.org
> Subject: Re: How to avoid huge index files
>=20
>=20
> Hi again,
>=20
> Can you add some details and guidelines how to implement that? =
Different
> files types have different structure, is such spliting doable without
> knowing Lucene internals?
>=20
>=20
> Michael McCandless-2 wrote:
> >
> > You're welcome!
> >
> > Another, bottoms-up option would be to make a custom Directory impl
> > that simply splits up files above a certain size.  That'd be more
> > generic and more reliable...
> >
> > Mike
> >
> > On Thu, Sep 10, 2009 at 5:26 AM, Dvora <barak.yaish@gmail.com> =
wrote:
> >>
> >> Hi,
> >>
> >> Thanks a lot for that, will peforms the experiments and publish the
> >> results.
> >> I'm aware to the risk of peformance degredation, but for the pilot =
I'm
> >> trying to run I think it's acceptable.
> >>
> >> Thanks again!
> >>
> >>
> >>
> >> Michael McCandless-2 wrote:
> >>>
> >>> First, you need to limit the size of segments initially created by
> >>> IndexWriter due to newly added documents. =A0Probably the simplest =
way
> >>> is to call IndexWriter.commit() frequently enough. =A0You might =
want to
> >>> use IndexWriter.ramSizeInBytes() to gauge how much RAM is =
currently
> >>> consumed by IndexWriter's buffer to determine when to commit. =
=A0But it
> >>> won't be an exact science, ie, the segment size will be different =
from
> >>> the RAM buffer size. =A0So, experiment w/ it...
> >>>
> >>> Second, you need to prevent merging from creating a segment that's =
too
> >>> large. =A0For this I would use the setMaxMergeMB method of the
> >>> LogByteSizeMergePolicy (which is IndexWriter's default merge =
policy).
> >>> But note that this max size applies to the *input* segments, so =
you'd
> >>> roughly want that to be 1.0 MB (your 10.0 MB divided by the merge
> >>> factor =3D 10), but probably make it smaller to be sure things =
stay
> >>> small enough.
> >>>
> >>> Note that with this approach, if your index is large enough, =
you'll
> >>> wind up with many segments and search performance will suffer when
> >>> compared to an index that doesn't have this max 10.0 MB file size
> >>> restriction.
> >>>
> >>> Mike
> >>>
> >>> On Thu, Sep 10, 2009 at 2:32 AM, Dvora <barak.yaish@gmail.com> =
wrote:
> >>>>
> >>>> Hello again,
> >>>>
> >>>> Can someone please comment on that, whether what I'm looking is
> >>>> possible
> >>>> or
> >>>> not?
> >>>>
> >>>>
> >>>> Dvora wrote:
> >>>>>
> >>>>> Hello,
> >>>>>
> >>>>> I'm using Lucene2.4. I'm developing a web application that using
> >>>>> Lucene
> >>>>> (via compass) to do the searches.
> >>>>> I'm intending to deploy the application in Google App Engine
> >>>>> (http://code.google.com/appengine/), which limits files length =
to be
> >>>>> smaller than 10MB. I've read about the various policies =
supported by
> >>>>> Lucene to limit the file sizes, but on matter which policy I =
used
> and
> >>>>> which parameters, the index files still grew to be lot more the
> 10MB.
> >>>>> Looking at the code, I've managed to limit the cfs files =
(predicting
> >>>>> the
> >>>>> file size in CompoundFileWriter before closing the file) - I =
guess
> >>>>> that
> >>>>> will degrade performance, but it's OK for now. But now the FDT =
files
> >>>>> are
> >>>>> becoming huge (about 60MB) and I cant identifiy a way to limit =
those
> >>>>> files.
> >>>>>
> >>>>> Is there some built-in and correct way to limit these files =
length?
> If
> >>>>> no,
> >>>>> can someone direct me please how should I tweak the source code =
to
> >>>>> achieve
> >>>>> that?
> >>>>>
> >>>>> Thanks for any help.
> >>>>>
> >>>>
> >>>> --
> >>>> View this message in context:
> >>>> http://www.nabble.com/How-to-avoid-huge-index-files-
> tp25347505p25378056.html
> >>>> Sent from the Lucene - Java Users mailing list archive at =
Nabble.com.
> >>>>
> >>>>
> >>>> =
---------------------------------------------------------------------
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>>
> >>>
> >>> =
---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>>
> >>>
> >>
> >> --
> >> View this message in context:
> >> http://www.nabble.com/How-to-avoid-huge-index-files-
> tp25347505p25380052.html
> >> Sent from the Lucene - Java Users mailing list archive at =
Nabble.com.
> >>
> >>
> >> =
---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
>=20
> --
> View this message in context: http://www.nabble.com/How-to-avoid-huge-
> index-files-tp25347505p25381489.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42250-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 11:53:52 2009
Return-Path: <java-user-return-42250-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37311 invoked from network); 10 Sep 2009 11:53:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 11:53:52 -0000
Received: (qmail 792 invoked by uid 500); 10 Sep 2009 11:53:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 699 invoked by uid 500); 10 Sep 2009 11:53:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 673 invoked by uid 99); 10 Sep 2009 11:53:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 11:53:48 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 11:53:37 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 6EDCFD36004;
	Thu, 10 Sep 2009 13:53:15 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id i1GrFXLSKMIu; Thu, 10 Sep 2009 13:53:06 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.78])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 5AD5CD36003;
	Thu, 10 Sep 2009 13:53:06 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>,
	<general@lucene.apache.org>,
	<java-dev@lucene.apache.org>
Subject: September 2009 Hadoop/Lucene/Solr/UIMA/katta/Mahout Get Together Berlin
Date: Thu, 10 Sep 2009 13:53:03 +0200
Message-ID: <AEA26A85BE6F4C4B99AFA258F4AB7EBE@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcoyDUCCm5pbiNdTQNiUHAQS2VQ4Aw==
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I cross-post this here, Isabel Drost is managing the meetup. This time =
it is
more about Hadoop, but there is also a talk about the new Lucene 2.9 =
release
(presented by me). As far as I know, Simon Willnauer will also be there:

-------------------------------------------------------------------------=
--
I would like to announce the September-2009 Hadoop Get Together in
newthinking store Berlin.

When: 29. September 2009 at 5:00pm
Where: newthinking store, Tucholskystr. 48, Berlin, Germany

As always there will be slots of 20min each for talks on your Hadoop =
topic.
After each talk there will be a lot time to discuss. You can order =
drinks
directly at the bar in the newthinking store. If you like, you can order
pizza. There are quite a few good restaurants nearby, so we can go there
after the official part.

Talks scheduled so far:
Thorsten Schuett, Solving Puzzles with MapReduce: MapReduce is most =
often
used for data mining and filtering large datasets. In this talk we will =
show
that it also useful for a completely different problem domain: solving
puzzles. Based on MapReduce, we can implement massively parallel
breadth-first and heuristic search. MapReduce will take care of the hard
problems, like parallelization, disk and error handling, while we can
concentrate on the puzzle. Throughout the talk we will use the sliding
puzzle (http://en.wikipedia.org/wiki/Sliding_puzzle) as our example.

Thilo G=F6tz, Text analytics on jaql: Jaql (JSON query language) is a =
query
language for Javascript Object Notation that runs on top of Apache =
Hadoop.
It was primarily designed for large scale analysis of semi-structured =
data.
I will give an introduction to jaql and describe our experiences using =
it
for text analytics tasks. Jaql is open source and available from
http://code.google.com/p/jaql.

Uwe Schindler, Lucene 2.9 Developments: Numeric Search, Per-Segment- and
Near-Real-Time Search, new TokenStream API: Uwe Schindler presents some =
new
additions to Lucene 2.9. In the first half he will talk about fast =
numerical
and date range queries (NumericRangeQuery, formerly TrieRangeQuery) and
their usage in geospatial search applications like the Publishing =
Network
for Geoscientific & Environmental Data (PANGAEA). In the second half of =
his
talk, Uwe will highlight various improvements to the internal search
implementation for near-real-time search. Finally, he will present the =
new
TokenStream API, based on AttributeSource/Attributes that make indexing =
more
pluggable. Future
developments in the Flexible Indexing Area will make use of it. Uwe will
show a Tokenizer that uses custom attributes to index XML files into =
various
document fields based on XML element names as a possible use-case.

We would like to invite you, the visitor to also tell your Hadoop story, =
if
you like, you can bring slides - there will be a beamer.

A big Thanks goes to the newthinking store for providing a room in the
center of Berlin for us.

See the Upcoming page: http://upcoming.yahoo.com/event/4314020/

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42251-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 11:58:59 2009
Return-Path: <java-user-return-42251-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38489 invoked from network); 10 Sep 2009 11:58:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 11:58:59 -0000
Received: (qmail 7715 invoked by uid 500); 10 Sep 2009 11:58:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7651 invoked by uid 500); 10 Sep 2009 11:58:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7641 invoked by uid 99); 10 Sep 2009 11:58:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 11:58:57 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 11:58:47 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id EDAD4D36004
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 13:58:26 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id PHMPxmmKbT0c for <java-user@lucene.apache.org>;
	Thu, 10 Sep 2009 13:58:23 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.78])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 9B450D36003
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 13:58:23 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <AEA26A85BE6F4C4B99AFA258F4AB7EBE@VEGA>
Subject: RE: September 2009 Hadoop/Lucene/Solr/UIMA/katta/Mahout Get Together Berlin
Date: Thu, 10 Sep 2009 13:58:20 +0200
Message-ID: <7CD6CAC63B8D4B4EB4CF7E6723C856FD@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcoyDUCCm5pbiNdTQNiUHAQS2VQ4AwAAGRXw
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <AEA26A85BE6F4C4B99AFA258F4AB7EBE@VEGA>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi again,

By the way, if somebody of the other involved developers want to provide me
some PPT Slides about the other new features in Lucene 2.9 (NRT, future
Flexible Indexing), I would be happy!

Uwe

> Uwe Schindler, Lucene 2.9 Developments: Numeric Search, Per-Segment- and
> Near-Real-Time Search, new TokenStream API: Uwe Schindler presents some
> new
> additions to Lucene 2.9. In the first half he will talk about fast
> numerical
> and date range queries (NumericRangeQuery, formerly TrieRangeQuery) and
> their usage in geospatial search applications like the Publishing Network
> for Geoscientific & Environmental Data (PANGAEA). In the second half of
> his
> talk, Uwe will highlight various improvements to the internal search
> implementation for near-real-time search. Finally, he will present the new
> TokenStream API, based on AttributeSource/Attributes that make indexing
> more
> pluggable. Future
> developments in the Flexible Indexing Area will make use of it. Uwe will
> show a Tokenizer that uses custom attributes to index XML files into
> various
> document fields based on XML element names as a possible use-case.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42252-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 12:01:02 2009
Return-Path: <java-user-return-42252-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39437 invoked from network); 10 Sep 2009 12:01:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 12:01:01 -0000
Received: (qmail 13371 invoked by uid 500); 10 Sep 2009 12:00:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13289 invoked by uid 500); 10 Sep 2009 12:00:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13279 invoked by uid 99); 10 Sep 2009 12:00:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 12:00:59 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_HELO_PASS,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [212.227.17.9] (HELO moutng.kundenserver.de) (212.227.17.9)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 12:00:47 +0000
Received: from [192.168.178.53] (p5083C394.dip.t-dialin.net [80.131.195.148])
	by mrelayeu.kundenserver.de (node=mrbap1) with ESMTP (Nemesis)
	id 0MKt2u-1MliK22GEw-000Sxx; Thu, 10 Sep 2009 14:00:18 +0200
Message-ID: <4AA8EA4C.1030400@prometa.de>
Date: Thu, 10 Sep 2009 14:00:12 +0200
From: Patricio Galeas <galeas@prometa.de>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: TooManyClauses by wildcard queries
References: <4AA8BB8C.6050604@prometa.de> <CB9FFC1766B84ACF8FD0E46B8137BB24@VEGA>
In-Reply-To: <CB9FFC1766B84ACF8FD0E46B8137BB24@VEGA>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
X-Provags-ID: V01U2FsdGVkX1/kdg0inVhM8+GmmDLkP37ZrTov8kBUwCMijm3
 Gv6mzrESpvDovSHMHAJi5JTRnjdEbx3DOKbedFp/HzN3R5FRe4
 0ykWOu15njtRLxQb+D2MFgMyY4OWVIJ
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Uwe

But if  I don't use Lucene 2.9, is this procedure (items 1-4) the right 
way to avoid the TooManyClauses exception? or is there a more efficients 
procedure to do that?
Thanks
Patricio

Uwe Schindler schrieb:
> Or use Lucene 2.9, it automatically uses constant score mode in wild card
> queries, if needed.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>   
>> -----Original Message-----
>> From: Patricio Galeas [mailto:galeas@prometa.de]
>> Sent: Thursday, September 10, 2009 10:41 AM
>> To: java-user@lucene.apache.org
>> Subject: TooManyClauses by wildcard queries
>>
>> Hi all,
>>
>> I get the TooManyClauses exception by some wildcard queries like :
>> (a) de*
>> (b) country AND de*
>> (c) ma?s* AND de*
>>
>> I'm not sure how to apply the solution proposed in LuceneFAQ for the
>> case of WildcardQueries like the examples above.
>>
>> Can you confirm if it is the right procedure?
>>
>> 1. Override QueryParser.getWildcardQuery() to return a ConstantScoreQuery.
>> 2. Break up the query to identify the wildcard query part.
>> 3. Create a custom Filter for the wildcard query
>> 4. Create the final query using the custom filter.
>>
>> If the item 2. is right, can you suggest me an optimal way to do that?
>>
>> Thank you
>> Patricio
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
P a t r i c i o   G a l e a s
ProMeta Team
--------------------------------------
I n f o t r a X  G m b H

Fon  +49 (0)271 30 30 888
Fax  +49 (0)271 74124-77
Mob  +49 (0)177 2962611

Adresse:
Friedrichstrae 81
D-57072 Siegen 

Geschftsfhrerin
Dipl.-Wi.-Inf. Stephanie Sarach 

Handelsregister
HRB 8877 Amtsgericht Siegen 

http://www.prometa.de
http://www.infotrax.de
--------------------------------------


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42253-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 12:26:14 2009
Return-Path: <java-user-return-42253-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52736 invoked from network); 10 Sep 2009 12:26:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 12:26:14 -0000
Received: (qmail 56334 invoked by uid 500); 10 Sep 2009 12:26:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56282 invoked by uid 500); 10 Sep 2009 12:26:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56272 invoked by uid 99); 10 Sep 2009 12:26:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 12:26:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 12:25:59 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MliiZ-0001hQ-0R
	for java-user@lucene.apache.org; Thu, 10 Sep 2009 05:25:39 -0700
Message-ID: <25382376.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 05:25:39 -0700 (PDT)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: How to avoid huge index files
In-Reply-To: <5474EB3EDAE040419152186A54F3787C@VEGA>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: barak.yaish@gmail.com
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com> <9ac0c6aa0909100206h753657feiddf01de25850ad7e@mail.gmail.com> <25380052.post@talk.nabble.com> <9ac0c6aa0909100342l683d8d6evc4026106447073fb@mail.gmail.com> <25381489.post@talk.nabble.com> <5474EB3EDAE040419152186A54F3787C@VEGA>
X-Virus-Checked: Checked by ClamAV on apache.org


Me again :-)

I'm looking at the code of FSDirectory and MMapDirectory, and found that it=
s
somewhat difficult for to understand how should subclass the FSDirectory an=
d
adjust it to my needs. If I understand correct, MMapDirectory overrides the
openInput() method and returns MultiMMapIndexInput if the file size exceeds
the threshold. What I'm not understand is that how the new impl should keep
track on the generated files (or shouldn't it?..) so when searhcing Lucene
will know in which file to search - I'm confused :-)

Can I bother you so you supply some kind of psuedo code illustrating how th=
e
implementation should look like?

Thanks again for your huge help!


Uwe Schindler wrote:
>=20
> The idea is just to put a layer on top of the abstract file system
> function
> supplied by directory. Whenever somebody wants to create a file and write
> data to it, the methods create more than one file and switch e.g. after 1=
0
> Megabytes to another file. E.g. look into MMapDirectory that uses MMap to
> map files into address space. Because MappedByteBuffer only supports 32
> bit
> offsets, there will be created different mappings for the same file (the
> file is splitted up into parts of 2 Gigabytes). You could use similar cod=
e
> here and just use another file, if somebody seeks or writes above the 10
> MiB
> limit. Just "virtualize" the files.
>=20
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>=20
>> From: Dvora [mailto:barak.yaish@gmail.com]
>> Sent: Thursday, September 10, 2009 1:23 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: How to avoid huge index files
>>=20
>>=20
>> Hi again,
>>=20
>> Can you add some details and guidelines how to implement that? Different
>> files types have different structure, is such spliting doable without
>> knowing Lucene internals?
>>=20
>>=20
>> Michael McCandless-2 wrote:
>> >
>> > You're welcome!
>> >
>> > Another, bottoms-up option would be to make a custom Directory impl
>> > that simply splits up files above a certain size.  That'd be more
>> > generic and more reliable...
>> >
>> > Mike
>> >
>> > On Thu, Sep 10, 2009 at 5:26 AM, Dvora <barak.yaish@gmail.com> wrote:
>> >>
>> >> Hi,
>> >>
>> >> Thanks a lot for that, will peforms the experiments and publish the
>> >> results.
>> >> I'm aware to the risk of peformance degredation, but for the pilot I'=
m
>> >> trying to run I think it's acceptable.
>> >>
>> >> Thanks again!
>> >>
>> >>
>> >>
>> >> Michael McCandless-2 wrote:
>> >>>
>> >>> First, you need to limit the size of segments initially created by
>> >>> IndexWriter due to newly added documents. =C2=A0Probably the simples=
t way
>> >>> is to call IndexWriter.commit() frequently enough. =C2=A0You might w=
ant to
>> >>> use IndexWriter.ramSizeInBytes() to gauge how much RAM is currently
>> >>> consumed by IndexWriter's buffer to determine when to commit. =C2=A0=
But it
>> >>> won't be an exact science, ie, the segment size will be different
>> from
>> >>> the RAM buffer size. =C2=A0So, experiment w/ it...
>> >>>
>> >>> Second, you need to prevent merging from creating a segment that's
>> too
>> >>> large. =C2=A0For this I would use the setMaxMergeMB method of the
>> >>> LogByteSizeMergePolicy (which is IndexWriter's default merge policy)=
.
>> >>> But note that this max size applies to the *input* segments, so you'=
d
>> >>> roughly want that to be 1.0 MB (your 10.0 MB divided by the merge
>> >>> factor =3D 10), but probably make it smaller to be sure things stay
>> >>> small enough.
>> >>>
>> >>> Note that with this approach, if your index is large enough, you'll
>> >>> wind up with many segments and search performance will suffer when
>> >>> compared to an index that doesn't have this max 10.0 MB file size
>> >>> restriction.
>> >>>
>> >>> Mike
>> >>>
>> >>> On Thu, Sep 10, 2009 at 2:32 AM, Dvora <barak.yaish@gmail.com> wrote=
:
>> >>>>
>> >>>> Hello again,
>> >>>>
>> >>>> Can someone please comment on that, whether what I'm looking is
>> >>>> possible
>> >>>> or
>> >>>> not?
>> >>>>
>> >>>>
>> >>>> Dvora wrote:
>> >>>>>
>> >>>>> Hello,
>> >>>>>
>> >>>>> I'm using Lucene2.4. I'm developing a web application that using
>> >>>>> Lucene
>> >>>>> (via compass) to do the searches.
>> >>>>> I'm intending to deploy the application in Google App Engine
>> >>>>> (http://code.google.com/appengine/), which limits files length to
>> be
>> >>>>> smaller than 10MB. I've read about the various policies supported
>> by
>> >>>>> Lucene to limit the file sizes, but on matter which policy I used
>> and
>> >>>>> which parameters, the index files still grew to be lot more the
>> 10MB.
>> >>>>> Looking at the code, I've managed to limit the cfs files
>> (predicting
>> >>>>> the
>> >>>>> file size in CompoundFileWriter before closing the file) - I guess
>> >>>>> that
>> >>>>> will degrade performance, but it's OK for now. But now the FDT
>> files
>> >>>>> are
>> >>>>> becoming huge (about 60MB) and I cant identifiy a way to limit
>> those
>> >>>>> files.
>> >>>>>
>> >>>>> Is there some built-in and correct way to limit these files length=
?
>> If
>> >>>>> no,
>> >>>>> can someone direct me please how should I tweak the source code to
>> >>>>> achieve
>> >>>>> that?
>> >>>>>
>> >>>>> Thanks for any help.
>> >>>>>
>> >>>>
>> >>>> --
>> >>>> View this message in context:
>> >>>> http://www.nabble.com/How-to-avoid-huge-index-files-
>> tp25347505p25378056.html
>> >>>> Sent from the Lucene - Java Users mailing list archive at
>> Nabble.com.
>> >>>>
>> >>>>
>> >>>>
>> ---------------------------------------------------------------------
>> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>>>
>> >>>>
>> >>>
>> >>> --------------------------------------------------------------------=
-
>> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>>
>> >>>
>> >>>
>> >>
>> >> --
>> >> View this message in context:
>> >> http://www.nabble.com/How-to-avoid-huge-index-files-
>> tp25347505p25380052.html
>> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> >
>>=20
>> --
>> View this message in context: http://www.nabble.com/How-to-avoid-huge-
>> index-files-tp25347505p25381489.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>=20
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/How-to-avoid-huge-index=
-files-tp25347505p25382376.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42254-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 12:32:13 2009
Return-Path: <java-user-return-42254-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54874 invoked from network); 10 Sep 2009 12:32:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 12:32:13 -0000
Received: (qmail 63912 invoked by uid 500); 10 Sep 2009 12:32:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63839 invoked by uid 500); 10 Sep 2009 12:32:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63829 invoked by uid 99); 10 Sep 2009 12:32:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 12:32:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.21] (HELO web52911.mail.re2.yahoo.com) (206.190.49.21)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 10 Sep 2009 12:32:02 +0000
Received: (qmail 75510 invoked by uid 60001); 10 Sep 2009 12:31:40 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252585900; bh=SU17hRcOzKUOmQi5w40k5884jB3pU2q5ZRr7AISqTRM=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=3Ve6SS5FkCfsJJ3u4vB5ZJm8F91cYbhYG0TjB2c2M6Ht4SQ3tjfCt+vVV4HWxFqX/YrQMi3iZFs/Ga8l89woz5riEr0WQPRguXvzodNLKZnpjUt2fNJeFKHl3WOqlMlNpeT9MSAoIVg1wpSUxzUqtMX3gHH6iCQJQGCv/4OeLrw=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=BvDkmcD4uJ5rgirdZPVGmuf0d4pvxG7TrEX7Z8gQb0zeiJvl1ClvOvCSh4lu6sS59Hspvg0YuVkpliLCHyUIBSLuopDj3dCnZ+L5gxTGDIOiKGtYvq/KOZ/EIjCQUcT+/3CdBaSUKm0f6zKlcLbRhum4a+h8F3G+DYUi7bqPMHM=;
Message-ID: <98796.70502.qm@web52911.mail.re2.yahoo.com>
X-YMail-OSG: ltPNm1cVM1mDVJbQrI_JIUDXKmSNRgf4esL3_aq4sn6q5FrFWr4W3UZjespkw8AaBpqll1Bo4cB6us6mQbEPlTi9AulvvubBm_r6FyyWVXhklwuk4gZo1jDUDYjC5loF09BXJPX_eRqVRzO7mHDk9sKIHtb99794oVJQPCznQnUAB6xbWJyXidkR.QIY49VZNoLeYuRNiAEd98cLr4QOCMaiqXDlRggx8p1uPC6TSPfy29XyNJ3PMXGyCXo0vNH7NY81wVPnFmd71OPGx8tNR.cnB53sG6_e1sFRdACZQfZM0zDUYfSqsG.Peb1QufyzPXuxaK1aeTJ6YicxmZoOevS5CaeNN9.SVlQmuMI-
Received: from [193.140.184.100] by web52911.mail.re2.yahoo.com via HTTP; Thu, 10 Sep 2009 05:31:40 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.347.2
Date: Thu, 10 Sep 2009 05:31:40 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Problem in lucene query
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> I am new to Lucene and facing a problem while performing
> searches. I am using lucene 2.2.0.
> 
> My application indexes documents on "keyword" field which
> contains integer values. 

Which analyzer/tokenizer are you using on that field? I am assuming it is a tokenized field.

>If the value is negative the query does not return
> correct results.

Is it returning 1's as well as -1's?

- is a special character so you have to escape it when querying.
So keyword:\-1 is correct. But the problem is StandardTokenizer tokenizes 
-1 to 1. If you use it all -1's and 1's are threated same. Use whitespaceanalyzer instead.

Hope this helps.



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42255-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 13:19:18 2009
Return-Path: <java-user-return-42255-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69182 invoked from network); 10 Sep 2009 13:19:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 13:19:18 -0000
Received: (qmail 39570 invoked by uid 500); 10 Sep 2009 13:19:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39478 invoked by uid 500); 10 Sep 2009 13:19:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39468 invoked by uid 99); 10 Sep 2009 13:19:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 13:19:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.216.189 as permitted sender)
Received: from [209.85.216.189] (HELO mail-px0-f189.google.com) (209.85.216.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 13:19:06 +0000
Received: by pxi27 with SMTP id 27so82943pxi.15
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 06:18:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=FrfnsTssFJXrEKVbWdXM3VIBYxwu/tRcb1EozUgW+gQ=;
        b=B/kHqALFeGps0zgL5vX8XOWoq0TtYvkGi2nGsL+bbgxUdY0DSr8X47d8q2a5407cTF
         sgZze4N770OqMDX0bm0ShSNkSdfj4AHutLZdFDJJ+0L30akszsyX6r7jG5SNjuWaMDT2
         7zzPra4bvVy8udfKP92zaOVdIvIzUuN+MpKic=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=jEh0DVCsW4G4/3vK7vU17hhLvqjTQcJNd4fLq38BKj8BljowNTiCIZZYbMi5kdRrav
         nIskVZrl7azdQcnUZvDV+5bBP8QqVcjHbTrcWP56fQW4468MG3oN1bBfLpTR6q88TsGy
         /bPM4q2jCFpGrThao6oZa6kgttoR23JtcQ8aU=
MIME-Version: 1.0
Received: by 10.115.101.27 with SMTP id d27mr2779844wam.126.1252588725067; 
	Thu, 10 Sep 2009 06:18:45 -0700 (PDT)
In-Reply-To: <1252580042107325707@QMAIL>
References: <1252580042107325707@QMAIL>
Date: Thu, 10 Sep 2009 18:48:45 +0530
Message-ID: <867513fe0909100618m45f91b45ka0f1e9dcfba46a6e@mail.gmail.com>
Subject: Re: Problem in lucene query
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64b95fa01dfcf0473390a0e
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64b95fa01dfcf0473390a0e
Content-Type: text/plain; charset=ISO-8859-1

Hi Vibhuti,
Not in sync with your query, but I'd advice you to graduate you to a rather
recent lucene release. Something like 2.4.1 or atleast a 2.3.1 [Considering
its already time for 2.9].

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Thu, Sep 10, 2009 at 4:17 PM, vibhuti <vibhuti.gupta@thepsi.com> wrote:

> Hello
>
>
>
> I am new to Lucene and facing a problem while performing searches. I am
> using lucene 2.2.0.
>
> My application indexes documents on "keyword" field which contains integer
> values. If the value is negative the query does not return correct results.
>
>
>
> Following is my lucene query:
>
>
>
> (keyword: \-1)
>
>
>
> I also tried:
>
> (keyword: "-1")
>
>
>
>
>
> But none of them returns correct results. It seems that Lucene ignores '-'.
> My purpose is to search documents with index value "-1".
>
>
>
> Any ideas??
>
>
>
> Thanks
>
>

--0016e64b95fa01dfcf0473390a0e--

From java-user-return-42256-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 13:22:27 2009
Return-Path: <java-user-return-42256-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70289 invoked from network); 10 Sep 2009 13:22:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 13:22:27 -0000
Received: (qmail 47974 invoked by uid 500); 10 Sep 2009 13:22:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47900 invoked by uid 500); 10 Sep 2009 13:22:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47890 invoked by uid 99); 10 Sep 2009 13:22:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 13:22:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of m.madanipour@gmail.com designates 209.85.211.178 as permitted sender)
Received: from [209.85.211.178] (HELO mail-yw0-f178.google.com) (209.85.211.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 13:22:16 +0000
Received: by ywh8 with SMTP id 8so152362ywh.14
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 06:21:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=MkYazMIlanQgaEXuqvA9O/S7q9ZduFCMvtp56iZ4YEY=;
        b=gaCuVVtDvcMmTM9mbPlcX1gXl+WkRDqBtfEeHel+OG+L3TUo0BAaNoPQMMcqgm8x4d
         nHxh4ypli64hMDEb3xsxKacgZ1HwpvK8t+TvDvZCm2gYo8tpePVPcy1VP8gLlg9qioLg
         SlnDEn/5D838ZfY1zbdlqhbdvkGwaRkyRQPmk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=ea57GDl+WRpdo5DVnhOO54oGgVTmeTXjdH+S/2R9RLxZyGqBUZ7P5jkAewKmhQ5mwZ
         zlJJDD7IpXDXXCn0Z0c19cvDLNNc43oyaUe0DfAo0TWC/qIps7gc+Ox+NchnZbftrkl+
         zzQbOVDAAO5jfcI+7JSFgw0hvrPn34exxoZgg=
MIME-Version: 1.0
Received: by 10.91.82.13 with SMTP id j13mr890047agl.112.1252588914070; Thu, 
	10 Sep 2009 06:21:54 -0700 (PDT)
Date: Thu, 10 Sep 2009 17:51:54 +0430
Message-ID: <243a0909100621x2762af3fr855191d4f19fe5d1@mail.gmail.com>
Subject: MultiSearcherThread.hits(ParallelMultiSearcher.java:280) 
	nullPointerException
From: "maryam ma'danipour" <m.madanipour@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f91df245d658047339155e
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f91df245d658047339155e
Content-Type: text/plain; charset=ISO-8859-1

Hello every .
I have a problem with MultiSearcherThread.hits in ParallelMultiSearcher.java
. Some times when I want to search via paralleMultiSearcher,
the method MultiSearcherThread.hits() throws nullPointerException. this is
because docs somehow has become null.
but why this field is null. I've checked lucene code . this field never
becomes null except in the ParallelMultiSearcher when lucene wants to
aggregate all results ( in line 79) the
instruction of msta[i].join throws InterruptedException. then the ioe will
be null and because msta[i] hasn't finished its work yet so docs will be
null.
is this right? or is it possible the msta[i] be interrupted in this part of
code?

the exception is :
java.lang.NullPointerException
    at
org.apache.lucene.search.MultiSearcherThread.hits(ParallelMultiSearcher.java:280)
    at
org.apache.lucene.search.ParallelMultiSearcher.search(ParallelMultiSearcher.java:83)

Best Regards

--001485f91df245d658047339155e--

From java-user-return-42257-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 14:38:37 2009
Return-Path: <java-user-return-42257-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94719 invoked from network); 10 Sep 2009 14:38:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 14:38:37 -0000
Received: (qmail 99443 invoked by uid 500); 10 Sep 2009 14:38:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99391 invoked by uid 500); 10 Sep 2009 14:38:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99381 invoked by uid 99); 10 Sep 2009 14:38:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 14:38:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.196 as permitted sender)
Received: from [209.85.223.196] (HELO mail-iw0-f196.google.com) (209.85.223.196)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 14:38:26 +0000
Received: by iwn34 with SMTP id 34so58825iwn.21
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 07:38:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=KsfScDMyQNXSs0S7dzsYXhXHZfMNrVAvzNCEy1fCiVE=;
        b=x8ujoF30GTqqBlUAHECJoZQXAV45qsdyLyj40ePOmsObI1mqqxYRI9vy9dRLmvP9wN
         kg2GVZmMTO38jVOJfvSFTRki+tm98UHQMaehV4xYzUn3oOQL1Bil5yIp4M0u4enwJimW
         ornn2w+hAStIZczNI8PWR1ZtlPkvPOP8kpvIQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=SrBVvWQcex8/9FGySBV5tSfoiYaDf8Jnmk71JstIKBqFtssdmGqUY1UPja8iNdX5WT
         CA8nmuVIM1mVf6CHjfAycVuW37HvgU7B0CaqDdFMnXF3c+7Aa4actahT+9KTIzt456Ld
         pbDemeiQXOJKY+E2llco8G1g7objCuT6mnp6Y=
MIME-Version: 1.0
Received: by 10.231.6.164 with SMTP id 36mr3029874ibz.39.1252593486317; Thu, 
	10 Sep 2009 07:38:06 -0700 (PDT)
In-Reply-To: <1252580042107325707@QMAIL>
References: <1252580042107325707@QMAIL>
Date: Thu, 10 Sep 2009 10:38:05 -0400
Message-ID: <359a92830909100738j25114a9v4bfd9838c233db47@mail.gmail.com>
Subject: Re: Problem in lucene query
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015175ce068cccb5004733a256b
X-Virus-Checked: Checked by ClamAV on apache.org

--0015175ce068cccb5004733a256b
Content-Type: text/plain; charset=ISO-8859-1

Also, get a copy of Luke and examine your index, that'll tell you what
isactually
in there *and* it will let you see how queries parse under
various analyzers.....

Best
Erick

On Thu, Sep 10, 2009 at 6:47 AM, vibhuti <vibhuti.gupta@thepsi.com> wrote:

> Hello
>
>
>
> I am new to Lucene and facing a problem while performing searches. I am
> using lucene 2.2.0.
>
> My application indexes documents on "keyword" field which contains integer
> values. If the value is negative the query does not return correct results.
>
>
>
> Following is my lucene query:
>
>
>
> (keyword: \-1)
>
>
>
> I also tried:
>
> (keyword: "-1")
>
>
>
>
>
> But none of them returns correct results. It seems that Lucene ignores '-'.
> My purpose is to search documents with index value "-1".
>
>
>
> Any ideas??
>
>
>
> Thanks
>
>

--0015175ce068cccb5004733a256b--

From java-user-return-42258-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 14:54:02 2009
Return-Path: <java-user-return-42258-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 379 invoked from network); 10 Sep 2009 14:54:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 14:54:01 -0000
Received: (qmail 28745 invoked by uid 500); 10 Sep 2009 14:53:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28677 invoked by uid 500); 10 Sep 2009 14:53:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28667 invoked by uid 99); 10 Sep 2009 14:53:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 14:53:59 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nickb@mailtrust.com designates 207.97.245.151 as permitted sender)
Received: from [207.97.245.151] (HELO smtp151.iad.emailsrvr.com) (207.97.245.151)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 14:53:51 +0000
Received: from relay15.relay.iad.mlsrvr.com (localhost [127.0.0.1])
	by relay15.relay.iad.mlsrvr.com (SMTP Server) with ESMTP id 615361B4241
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 10:53:30 -0400 (EDT)
Received: from dynamic4.wm-web.iad.mlsrvr.com (dynamic4.wm-web.iad.mlsrvr.com [192.168.2.153])
	by relay15.relay.iad.mlsrvr.com (SMTP Server) with ESMTP id 5AD641B4066
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 10:53:30 -0400 (EDT)
Received: from mailtrust.com (localhost [127.0.0.1])
	by dynamic4.wm-web.iad.mlsrvr.com (Postfix) with ESMTP id 45BE01D4806E
	for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 10:53:30 -0400 (EDT)
Received: by apps.rackspace.com
    (Authenticated sender: nickb@mailtrust.com, from: nicholas.bailey@rackspace.com) 
    with HTTP; Thu, 10 Sep 2009 10:53:30 -0400 (EDT)
Date: Thu, 10 Sep 2009 10:53:30 -0400 (EDT)
Subject: Re: IndexReader.isCurrent for cached indexes
From: "Nick Bailey" <nicholas.bailey@rackspace.com>
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain;charset=UTF-8
Content-Transfer-Encoding: quoted-printable
Importance: Normal
X-Priority: 3 (Normal)
X-Type: plain
In-Reply-To: <8c4e68610909100205l36f15a66t7471c545d3e845d3@mail.gmail.com>
References: <1252532004.497624575@192.168.1.71> 
 <8c4e68610909100205l36f15a66t7471c545d3e845d3@mail.gmail.com>
Message-ID: <1252594410.28411442@192.168.1.71>
X-Mailer: webmail7.0b
X-Virus-Checked: Checked by ClamAV on apache.org

Our commit code will close the IndexWriter after adding the documents and b=
efore we see the log message indicating the documents have been added and d=
eleted, so I don't believe that is the problem.=0A=0AThanks for the tip abo=
ut reopen.  I actually noticed that when researching this problem but didn'=
t think it was related.=0A=0AWe are running 2.4.1=0A=0A=0A-----Original Mes=
sage-----=0AFrom: "Ian Lea" <ian.lea@gmail.com>=0ASent: Thursday, September=
 10, 2009 5:05am=0ATo: java-user@lucene.apache.org=0ASubject: Re: IndexRead=
er.isCurrent for cached indexes=0A=0AisCurrent() will only return true if t=
here have been committed changes=0Ato the index.  Maybe for some reason you=
r index update job hasn't=0Acommitted or closed the index.=0A=0AProbably no=
t relevant to this problem, but your reopen code snippet=0Adoesn't close th=
e old reader.  It should.  See the javadocs.=0A=0AWhat version of lucene ar=
e you running?=0A=0A=0A=0A--=0AIan.=0A=0A=0AOn Wed, Sep 9, 2009 at 10:33 PM=
, Nick Bailey=0A<nicholas.bailey@rackspace.com> wrote:=0A> Looking for some=
 help figuring out a problem with the IndexReader.isCurrent() method and ca=
ched indexes.=0A>=0A> We have a number of lucene indexes that we attempt to=
 keep in memory after an initial query is performed. =C2=A0In order to prev=
ent the indexes from becoming stale, we check for changes about every minut=
e by calling isCurrent(). =C2=A0If the index has changed, we will then reop=
en it.=0A>=0A> From our logs it appears that in some cases isCurrent() will=
 return true even though the index has changed since the last time the read=
er was opened.=0A>=0A> The code to refresh the index is basically this:=0A>=
=0A> // Checked every minute=0A> if(!reader.isCurrent()){=0A> =C2=A0=C2=A0/=
/ reopen the existing reader=0A> =C2=A0=C2=A0reader =3D this.searcher.getIn=
dexReader();=0A> =C2=A0=C2=A0reader =3D reader.reopen();=0A> }=0A>=0A> This=
 is an example of the problem from the logs:=0A>=0A> 2009-08-29 17:50:51,38=
7 Indexed 0 documents and deleted 1 documents from index 'example' in 0 ms=
=0A> 2009-08-30 03:11:58,410 Indexed 0 documents and deleted 5 documents fr=
om index 'example' in 0 ms=0A> 2009-08-30 16:30:03,466 Using cached reader =
<age=3D88648201 lastRefresh=3D81415526>=0A> // numbers indicate millisecond=
s since opened or refreshed aka age =3D 24.6hrs, lastRefresh =3D 22.6hrs=0A=
>=0A> The logs indicate we deleted documents from the index at about 5:50 o=
n August 29th, and then again on the 30th at 3:11. =C2=A0Then at 4:30 on we=
 attempted to query the index. =C2=A0We found the cached reader and used it=
, however, the last time the cache was refreshed was about 22 hours previou=
sly, coinciding with the first delete. =C2=A0The index should have been reo=
pened after the second delete.=0A>=0A> I have checked, and the code to refr=
esh the indexes is definitely being run every 60 seconds. =C2=A0All I can s=
ee is that the problem might be with the isCurrent() method.=0A>=0A> Could =
it be due to holding the reader open for so long? Any other ideas?=0A>=0A> =
Thanks a lot,=0A> Nick Bailey=0A>=0A>=0A>=0A> -----------------------------=
----------------------------------------=0A> To unsubscribe, e-mail: java-u=
ser-unsubscribe@lucene.apache.org=0A> For additional commands, e-mail: java=
-user-help@lucene.apache.org=0A>=0A>=0A=0A---------------------------------=
------------------------------------=0ATo unsubscribe, e-mail: java-user-un=
subscribe@lucene.apache.org=0AFor additional commands, e-mail: java-user-he=
lp@lucene.apache.org=0A=0A


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42259-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 14:56:44 2009
Return-Path: <java-user-return-42259-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1154 invoked from network); 10 Sep 2009 14:56:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 14:56:44 -0000
Received: (qmail 34411 invoked by uid 500); 10 Sep 2009 14:56:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34319 invoked by uid 500); 10 Sep 2009 14:56:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34309 invoked by uid 99); 10 Sep 2009 14:56:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 14:56:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [76.13.9.50] (HELO web65506.mail.ac4.yahoo.com) (76.13.9.50)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 10 Sep 2009 14:56:25 +0000
Received: (qmail 48346 invoked by uid 60001); 10 Sep 2009 14:56:02 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252594562; bh=a5ogmVb5n+sxXuETQjk1bJSroUf7tIlh22xYpPUhCls=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=4Adp642bB30jGC70itBrwkZwyfQXEls7XxNPZ268iKOhOmJYI/oCeqMa5tEIaySYWa8BHs6c93mdyDVb2JJH6RXtgH1suuUHy2NhPPSGgWlO6NfgI8LDwhh4jDq6vsW3WJX0XxgKVMCxAfZ/RldYedahjgYZgQszauV1upAgLAc=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=sDYJ1AqznAXTu8bOBtfKkmly+Z9yX/102Gky77idP2jXK1DKY2OERKnAAAQUdsTQ98EFKICBJGPiU363MRay+UGaMvorM+6JintA0C3zB0I8wzi7kSD0KJvUxErV3aqxoN08iHK1j1+0i8WhnJVxgVp4Hw6KLiFEPRmGka5MCT4=;
Message-ID: <842619.47864.qm@web65506.mail.ac4.yahoo.com>
X-YMail-OSG: b0AYFFwVM1mQZYj5ter8pu3A4.EglemFApOHDmn8wh16DemrGTT81B1Mh.lVJG7_G6kRT57vekUmBl2w6KYQVWGpHyGN9iffATDgvjDrqJHFKNjfHEwMXJUmf1uXrbAjH9ScsvkQjeXtpzoMFuxdRk9tBw4sdV17IblIMuN_BnZEphonf44AyJQYsS5yudZ.xobt._6MmYL3PrN8SZ3Utuxk.nvd_b2D_xKNVJIXv15uDvTxcvoOi4D1VrR_geUqUtqCgnMJSJ_cj_xQteO3et08m.mAy4J762T3qCVs8l1sGI4YvoguuBJtUDQkxnJxHCj0ehvslhh.cTJcen9Ix7KTvYaWL8ES6MhXqYY3FeQszRr.y5OMtw4YtJZJFnnmjQ--
Received: from [140.239.67.170] by web65506.mail.ac4.yahoo.com via HTTP; Thu, 10 Sep 2009 07:56:02 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 07:56:02 -0700 (PDT)
From: Ted Stockwell <emorning@yahoo.com>
Subject: Re: How to avoid huge index files
To: java-user@lucene.apache.org
In-Reply-To: <25378056.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Another alternative is storing the indexes in the Google Datastore, I think Compass already supports that (though I have not used it).

Also, I have successfully run Lucene on GAE using GaeVFS (http://code.google.com/p/gaevfs/) to store the index in the Datastore.
(I developed a Lucene Directory implementation on top of GaeVFS that's available at http://sf.net/contrail).



> Dvora wrote:
> > 
> > Hello,
> > 
> > I'm using Lucene2.4. I'm developing a web application that using Lucene
> > (via compass) to do the searches.
> > I'm intending to deploy the application in Google App Engine
> > (http://code.google.com/appengine/), which limits files length to be
> > smaller than 10MB. 



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42260-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 17:03:45 2009
Return-Path: <java-user-return-42260-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43137 invoked from network); 10 Sep 2009 17:03:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 17:03:45 -0000
Received: (qmail 76946 invoked by uid 500); 10 Sep 2009 17:03:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76907 invoked by uid 500); 10 Sep 2009 17:03:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76897 invoked by uid 99); 10 Sep 2009 17:03:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 17:03:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 17:03:33 +0000
Received: by qw-out-2122.google.com with SMTP id 9so99870qwb.53
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 10:03:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=4E7E9NFIWjV0/EBOlfgD0i8bKCILBTsZhefz64S10q0=;
        b=vYnRyC+VrQ5YEuw/JvzCilLQJzMnMdUUva7UXAaVhvd12v0gZZWHpuX6oraxTvAO8t
         88nIVK4TH00GuVu0lskRH2ZVq2cgO01tIRFVHrnjRt2HFvHWs1y924rteDT+GgLRe0W8
         zlSKof3HqwYuOTsnFDIjlh30Q1b8qLtcteYuA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=eX8qE0vpOPrTM2umv6eVX4tFmcptqvKLFZ3rHHMQb7RyHJmYaj7pjSJAOXjK6aWb2Y
         x0tv5LkCb4FwH+F1WbUEmVJ/loecJJJJW5DymGNVNKPhUS7OgTu7zU7lIYuUWJKG0h8h
         VHY2OpcyGo+zRmSTGNo9o6pALOTXtLsR1+0V4=
MIME-Version: 1.0
Received: by 10.224.101.141 with SMTP id c13mr1620965qao.21.1252602192938; 
	Thu, 10 Sep 2009 10:03:12 -0700 (PDT)
In-Reply-To: <786fde50909082046o2ca90e9cl86738737ed870f59@mail.gmail.com>
References: <786fde50908200449rfb30156p39f7b8bb7a9a2f5f@mail.gmail.com>
	 <Pine.LNX.4.64.0908251027390.28995@radix.cryptio.net>
	 <786fde50908262031u7602aac0lb01fde4d0dd9c393@mail.gmail.com>
	 <Pine.LNX.4.64.0909031502050.20830@radix.cryptio.net>
	 <786fde50909032133jea4ac1av4c1fc8d5377e82a4@mail.gmail.com>
	 <c68e39170909050845s506025bdvc92903e4704d6b69@mail.gmail.com>
	 <786fde50909060142y7ba2367fj21cd4a16cb3517ed@mail.gmail.com>
	 <c68e39170909081539r438e5545m3ca8c934aef13b6b@mail.gmail.com>
	 <786fde50909082046o2ca90e9cl86738737ed870f59@mail.gmail.com>
Date: Thu, 10 Sep 2009 10:03:12 -0700
Message-ID: <85d3c3b60909101003o7a2b2081h8dbb573a31eff9f5@mail.gmail.com>
Subject: Re: Extending Sort/FieldCache
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I think CSF hasn't been implemented because it's only marginally
useful yet requires fairly significant rewrites of core code
(i.e. SegmentMerger) so no one's picked it up including myself.
An interim solution that fulfills the same function (quickly
loading field cache values) using what works reliably today
(i.e. payloads) is a good simple forward moving step.

Shai, feel free to open an issue and post your code. I'd will
check it out and help where possible.

On Tue, Sep 8, 2009 at 8:46 PM, Shai Erera <serera@gmail.com> wrote:
> I didn't say we won't need CSF, but that at least conceptually, CSF and m=
y
> sort-by-payload are the same. If however it turns out that CSF performs
> better, then I'll definitely switch my sort-by-payload package to use it.=
 I
> thought that CSF is going to be implemented using payloads, but perhaps I=
'm
> wrong.
>
> Shai
>
> On Wed, Sep 9, 2009 at 1:39 AM, Yonik Seeley <yonik@lucidimagination.com>=
wrote:
>
>> On Sun, Sep 6, 2009 at 4:42 AM, Shai Erera<serera@gmail.com> wrote:
>> >> I've resisted using payloads for this purpose in Solr because it felt
>> >> like an interim hack until CSF is implemented.
>> >
>> > I don't see it as a hack, but as a proper use of a great feature in
>> Lucene.
>>
>> It's proper use for an application perhaps, but not for core Lucene.
>> Applications are pretty much required to work with what's given in
>> Lucene... but Lucene developers can make better choices. =A0Hence if at
>> all possible, work should be put into implementing CSF rather than
>> sorting by payloads.
>>
>> > CSF and this are essentially the same.
>>
>> In which case we wouldn't need CSF?
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42261-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 17:53:00 2009
Return-Path: <java-user-return-42261-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64103 invoked from network); 10 Sep 2009 17:53:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 17:53:00 -0000
Received: (qmail 81473 invoked by uid 500); 10 Sep 2009 17:52:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81427 invoked by uid 500); 10 Sep 2009 17:52:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81417 invoked by uid 99); 10 Sep 2009 17:52:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 17:52:57 +0000
X-ASF-Spam-Status: No, hits=1.1 required=10.0
	tests=FORGED_HOTMAIL_RCVD2,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 17:52:48 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mlnop-0004bV-Ml
	for java-user@lucene.apache.org; Thu, 10 Sep 2009 10:52:27 -0700
Message-ID: <25388003.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 10:52:27 -0700 (PDT)
From: asitag <asit_agarwal@hotmail.com>
To: java-user@lucene.apache.org
Subject: Chinese Japanese Korean Indexing issue Version 2.4
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: asit_agarwal@hotmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

We are trying to index html files which have japanese /  korean / chinese
content using the CJK analyser. But while indexing we are getting Lexical
parse error. Encountered unkown character. We tried setting the string
encoding to UTF 8 but it does not help.

Can anyone please help. Any pointers will be highly appreciated. 

Thanks
-- 
View this message in context: http://www.nabble.com/Chinese-Japanese-Korean-Indexing-issue-Version-2.4-tp25388003p25388003.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42262-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 17:58:15 2009
Return-Path: <java-user-return-42262-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65641 invoked from network); 10 Sep 2009 17:58:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 17:58:14 -0000
Received: (qmail 90475 invoked by uid 500); 10 Sep 2009 17:58:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90415 invoked by uid 500); 10 Sep 2009 17:58:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90400 invoked by uid 99); 10 Sep 2009 17:58:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 17:58:12 +0000
X-ASF-Spam-Status: No, hits=1.1 required=10.0
	tests=FORGED_HOTMAIL_RCVD2,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 17:58:03 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mlntu-0004mc-Lx
	for java-user@lucene.apache.org; Thu, 10 Sep 2009 10:57:42 -0700
Message-ID: <25388078.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 10:57:42 -0700 (PDT)
From: asitag <asit_agarwal@hotmail.com>
To: java-user@lucene.apache.org
Subject: Re: Chinese Japanese Korean Indexing issue Version 2.4
In-Reply-To: <25388003.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: asit_agarwal@hotmail.com
References: <25388003.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


TO add some more context - I am able to index english and Western european
langauages.


asitag wrote:
> 
> Hi,
> 
> We are trying to index html files which have japanese /  korean / chinese
> content using the CJK analyser. But while indexing we are getting Lexical
> parse error. Encountered unkown character. We tried setting the string
> encoding to UTF 8 but it does not help.
> 
> Can anyone please help. Any pointers will be highly appreciated. 
> 
> Thanks
> 

-- 
View this message in context: http://www.nabble.com/Chinese-Japanese-Korean-Indexing-issue-Version-2.4-tp25388003p25388078.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42263-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 19:19:08 2009
Return-Path: <java-user-return-42263-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10795 invoked from network); 10 Sep 2009 19:19:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 19:19:08 -0000
Received: (qmail 12375 invoked by uid 500); 10 Sep 2009 19:19:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12285 invoked by uid 500); 10 Sep 2009 19:19:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12275 invoked by uid 99); 10 Sep 2009 19:19:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 19:19:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 19:18:56 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MlpAB-00087f-Mr
	for java-user@lucene.apache.org; Thu, 10 Sep 2009 12:18:35 -0700
Message-ID: <25389394.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 12:18:35 -0700 (PDT)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to avoid huge index files
In-Reply-To: <842619.47864.qm@web65506.mail.ac4.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com> <842619.47864.qm@web65506.mail.ac4.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Is it possible to upload to GAE an already exist index? My index is data I'm
collecting for long time, and I prefer not to give it up.



ted stockwell wrote:
> 
> Another alternative is storing the indexes in the Google Datastore, I
> think Compass already supports that (though I have not used it).
> 
> Also, I have successfully run Lucene on GAE using GaeVFS
> (http://code.google.com/p/gaevfs/) to store the index in the Datastore.
> (I developed a Lucene Directory implementation on top of GaeVFS that's
> available at http://sf.net/contrail).
> 
> 
> 
>> Dvora wrote:
>> > 
>> > Hello,
>> > 
>> > I'm using Lucene2.4. I'm developing a web application that using Lucene
>> > (via compass) to do the searches.
>> > I'm intending to deploy the application in Google App Engine
>> > (http://code.google.com/appengine/), which limits files length to be
>> > smaller than 10MB. 
> 
> 
> 
>       
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/How-to-avoid-huge-index-files-tp25347505p25389394.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42264-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 20:01:39 2009
Return-Path: <java-user-return-42264-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20762 invoked from network); 10 Sep 2009 20:01:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 20:01:38 -0000
Received: (qmail 58447 invoked by uid 500); 10 Sep 2009 20:01:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58371 invoked by uid 500); 10 Sep 2009 20:01:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58342 invoked by uid 99); 10 Sep 2009 20:01:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 20:01:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [76.13.9.50] (HELO web65506.mail.ac4.yahoo.com) (76.13.9.50)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 10 Sep 2009 20:01:25 +0000
Received: (qmail 92745 invoked by uid 60001); 10 Sep 2009 20:01:04 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252612864; bh=H4h1YZMf4K14ZGZhZ+qk2YjD8CWZUwmxEs6rwNCOlpA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=aTeOGu0EGMFsuj3D+bgOC/RljfCawMPwwCjNHuEgzvelHI/76fNTLagJMf6Woy29Y15JxPq6AIFjBZZX36xWOr/3UrDtL+nyzKJfKw86GnwldeyQRGlnjPs8xRyIGTi9m0ywieSKVm8u/pPGQlsZIi3XesWD+Uj5eIcOfbeFrO0=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=vuF1192nj0f2d2o07pB1SDvDzIZgW1u17f9e9ti3O31ds5k0XZ2/5e2Y5J6qg4LnuI9JUD0X0It3ydcQHqUI4us+PA6k9ptocxTPUx0+UuizE9y2e1lGpqP7wya5xzYKwKOY1lx3lkhFL9/tOITK+BTljMobCp1N+/Jk+rBJ4zo=;
Message-ID: <561623.89264.qm@web65506.mail.ac4.yahoo.com>
X-YMail-OSG: ESB5BsMVM1nrXOmE5eWBG3zqWipW89x9LDTQKR3grGmAXzFdzOzqWx6zjN8PbTdR_0SlSrsssuiLvTWpF4q7INWros.1365Tc5wlldEwNZI9av5E439crzwHtnortArm6gQ27JM9V2RBbaKDwhMqRQ.giG3tj.2_FSRzq.HC2CM2h64VNSmsMJ0X31CpXa1Yn5tBPhp0FXlQdthS6rTY7Fm7Zp1TTA8x10BkbSJeN2wXBMZiddaPRNpa0mNIKgdrqWvL5smVq_9ftvR0Ntg436_5_Ko5oOHnlCEyvNI4PQ6OZQyE1RfV95kVNLGhTBhk09GQpLvskKb0vPmqLEi88AjqatldsXOHTsltbtso4nu_
Received: from [140.239.67.170] by web65506.mail.ac4.yahoo.com via HTTP; Thu, 10 Sep 2009 13:01:04 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <25347505.post@talk.nabble.com> <25378056.post@talk.nabble.com> <842619.47864.qm@web65506.mail.ac4.yahoo.com> <25389394.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 13:01:04 -0700 (PDT)
From: Ted Stockwell <emorning@yahoo.com>
Subject: Re: How to avoid huge index files
To: java-user@lucene.apache.org
In-Reply-To: <25389394.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Not at the moment.
Actually, I'm already working on a remote copy utility for gaevfs that will upload large files and folders but the first cut is about a week away.



----- Original Message ----
> From: Dvora <barak.yaish@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, September 10, 2009 2:18:35 PM
> Subject: Re: How to avoid huge index files
> 
> 
> Is it possible to upload to GAE an already exist index? My index is data I'm
> collecting for long time, and I prefer not to give it up.
> 
> 


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42265-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 23:19:53 2009
Return-Path: <java-user-return-42265-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92394 invoked from network); 10 Sep 2009 23:19:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 23:19:53 -0000
Received: (qmail 55214 invoked by uid 500); 10 Sep 2009 23:19:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55146 invoked by uid 500); 10 Sep 2009 23:19:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55136 invoked by uid 99); 10 Sep 2009 23:19:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 23:19:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 23:19:41 +0000
Received: by qyk30 with SMTP id 30so557837qyk.5
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 16:19:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=3Z6EEa5clBnhEJSgb2GtxGiLAArEerePMQFt0bSUYz0=;
        b=ia7aVyy/hf6aa3X3AaRFezZGSdOnaZzs9l3aG1a1QW4dlvN6yifk8RbyuixqFw4vRo
         yFTGWraSne/+3dIfQbEqp0SLKmxgO+lDEgJHdJVQPV4ny5q1+BYcMczPeIEtMkiVpyX4
         JUeRnPGyvPhBb0yoa+GRptMZMvl4lEJ9cEmW0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=Yhm+7//TkyJsHVg1g/NCq+PrW6k3j1eCJn/bQK9jsAktmOQA2yeii2sdl690HZ3VBk
         YzmLpwUSB5M3x3BVcuw5mNNO3KS4Ww5lXeNyfCKKZO+jAOgpVe3neBIyGbhtD1HbzE7p
         Xj46glMRTPaz6uHP2Qb0m39ZQCyiQv2UbDUpc=
MIME-Version: 1.0
Received: by 10.224.43.164 with SMTP id w36mr1966380qae.336.1252624760883; 
	Thu, 10 Sep 2009 16:19:20 -0700 (PDT)
Date: Thu, 10 Sep 2009 16:19:20 -0700
Message-ID: <85d3c3b60909101619x401c39a1wc4abb551b35a97b1@mail.gmail.com>
Subject: Index docstore flush problem
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

I'm seeing a strange exception when indexing using the latest Solr rev on EC2.

org.apache.solr.client.solrj.SolrServerException:
org.apache.solr.client.solrj.SolrServerException:
java.lang.RuntimeException: after flush: fdx size mismatch: 468 docs
vs 298404 length in bytes of _0.fdx
	at org.apache.solr.client.solrj.embedded.EmbeddedSolrServer.request(EmbeddedSolrServer.java:153)
	at org.apache.solr.client.solrj.request.UpdateRequest.process(UpdateRequest.java:268)
	at org.apache.solr.client.solrj.SolrServer.commit(SolrServer.java:86)
	at org.apache.solr.hadoop.SolrRecordWriter$1.run(SolrRecordWriter.java:239)
Caused by: org.apache.solr.client.solrj.SolrServerException:
java.lang.RuntimeException: after flush: fdx size mismatch: 468 docs
vs 298404 length in bytes of _0.fdx
	at org.apache.solr.client.solrj.embedded.EmbeddedSolrServer.request(EmbeddedSolrServer.java:141)
	... 3 more
Caused by: java.lang.RuntimeException: after flush: fdx size mismatch:
468 docs vs 298404 length in bytes of _0.fdx
	at org.apache.lucene.index.StoredFieldsWriter.closeDocStore(StoredFieldsWriter.java:95)
	at org.apache.lucene.index.DocFieldProcessor.closeDocStore(DocFieldProcessor.java:50)
	at org.apache.lucene.index.DocumentsWriter.closeDocStore(DocumentsWriter.java:380)
	at org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:574)
	at org.apache.lucene.index.IndexWriter.doFlushInternal(IndexWriter.java:4212)
	at org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:4110)
	at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:4101)
	at org.apache.lucene.index.IndexWriter.closeInternal(IndexWriter.java:2108)
	at org.apache.lucene.index.IndexWriter.close(IndexWriter.java:2071)
	at org.apache.lucene.index.IndexWriter.close(IndexWriter.java:2035)
	at org.apache.solr.update.SolrIndexWriter.close(SolrIndexWriter.java:215)
	at org.apache.solr.update.DirectUpdateHandler2.closeWriter(DirectUpdateHandler2.java:180)
	at org.apache.solr.update.DirectUpdateHandler2.commit(DirectUpdateHandler2.java:404)
	at org.apache.solr.update.processor.RunUpdateProcessor.processCommit(RunUpdateProcessorFactory.java:85)
	at org.apache.solr.handler.RequestHandlerUtils.handleCommit(RequestHandlerUtils.java:105)
	at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:48)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:1299)
	at org.apache.solr.client.solrj.embedded.EmbeddedSolrServer.request(EmbeddedSolrServer.java:139)
	... 3 more

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42266-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 10 23:50:16 2009
Return-Path: <java-user-return-42266-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1264 invoked from network); 10 Sep 2009 23:50:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Sep 2009 23:50:16 -0000
Received: (qmail 81662 invoked by uid 500); 10 Sep 2009 23:50:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81562 invoked by uid 500); 10 Sep 2009 23:50:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81552 invoked by uid 99); 10 Sep 2009 23:50:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 23:50:13 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.191] (HELO mail-yw0-f191.google.com) (209.85.211.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Sep 2009 23:50:05 +0000
Received: by ywh29 with SMTP id 29so932532ywh.23
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 16:49:44 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.44.24 with SMTP id r24mr3709564ybr.249.1252626584304; Thu, 
	10 Sep 2009 16:49:44 -0700 (PDT)
In-Reply-To: <85d3c3b60909101619x401c39a1wc4abb551b35a97b1@mail.gmail.com>
References: <85d3c3b60909101619x401c39a1wc4abb551b35a97b1@mail.gmail.com>
Date: Thu, 10 Sep 2009 19:49:44 -0400
Message-ID: <9ac0c6aa0909101649t5ca87f77r8c8525db52d38bf1@mail.gmail.com>
Subject: Re: Index docstore flush problem
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

That's an odd exception.  It means IndexWriter thinks 468 docs have
been written to the stored fields file, which should mean the fdx file
size is 3748 (=3D 4 + 468*8), yet the file size is far larger than that
(298404).

How repeatable is it?  Can you turn on infoStream, get the exception
to happen, then post the resulting output?

Mike

On Thu, Sep 10, 2009 at 7:19 PM, Jason Rutherglen
<jason.rutherglen@gmail.com> wrote:
> I'm seeing a strange exception when indexing using the latest Solr rev on=
 EC2.
>
> org.apache.solr.client.solrj.SolrServerException:
> org.apache.solr.client.solrj.SolrServerException:
> java.lang.RuntimeException: after flush: fdx size mismatch: 468 docs
> vs 298404 length in bytes of _0.fdx
> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrServe=
r.request(EmbeddedSolrServer.java:153)
> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.request.UpdateRequest.proc=
ess(UpdateRequest.java:268)
> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.SolrServer.commit(SolrServ=
er.java:86)
> =A0 =A0 =A0 =A0at org.apache.solr.hadoop.SolrRecordWriter$1.run(SolrRecor=
dWriter.java:239)
> Caused by: org.apache.solr.client.solrj.SolrServerException:
> java.lang.RuntimeException: after flush: fdx size mismatch: 468 docs
> vs 298404 length in bytes of _0.fdx
> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrServe=
r.request(EmbeddedSolrServer.java:141)
> =A0 =A0 =A0 =A0... 3 more
> Caused by: java.lang.RuntimeException: after flush: fdx size mismatch:
> 468 docs vs 298404 length in bytes of _0.fdx
> =A0 =A0 =A0 =A0at org.apache.lucene.index.StoredFieldsWriter.closeDocStor=
e(StoredFieldsWriter.java:95)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocFieldProcessor.closeDocStore=
(DocFieldProcessor.java:50)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocumentsWriter.closeDocStore(D=
ocumentsWriter.java:380)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocumentsWriter.flush(Documents=
Writer.java:574)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.doFlushInternal(Ind=
exWriter.java:4212)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.doFlush(IndexWriter=
.java:4110)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.flush(IndexWriter.j=
ava:4101)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.closeInternal(Index=
Writer.java:2108)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.close(IndexWriter.j=
ava:2071)
> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.close(IndexWriter.j=
ava:2035)
> =A0 =A0 =A0 =A0at org.apache.solr.update.SolrIndexWriter.close(SolrIndexW=
riter.java:215)
> =A0 =A0 =A0 =A0at org.apache.solr.update.DirectUpdateHandler2.closeWriter=
(DirectUpdateHandler2.java:180)
> =A0 =A0 =A0 =A0at org.apache.solr.update.DirectUpdateHandler2.commit(Dire=
ctUpdateHandler2.java:404)
> =A0 =A0 =A0 =A0at org.apache.solr.update.processor.RunUpdateProcessor.pro=
cessCommit(RunUpdateProcessorFactory.java:85)
> =A0 =A0 =A0 =A0at org.apache.solr.handler.RequestHandlerUtils.handleCommi=
t(RequestHandlerUtils.java:105)
> =A0 =A0 =A0 =A0at org.apache.solr.handler.ContentStreamHandlerBase.handle=
RequestBody(ContentStreamHandlerBase.java:48)
> =A0 =A0 =A0 =A0at org.apache.solr.handler.RequestHandlerBase.handleReques=
t(RequestHandlerBase.java:131)
> =A0 =A0 =A0 =A0at org.apache.solr.core.SolrCore.execute(SolrCore.java:129=
9)
> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrServe=
r.request(EmbeddedSolrServer.java:139)
> =A0 =A0 =A0 =A0... 3 more
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42267-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 00:14:55 2009
Return-Path: <java-user-return-42267-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6254 invoked from network); 11 Sep 2009 00:14:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 00:14:55 -0000
Received: (qmail 4534 invoked by uid 500); 11 Sep 2009 00:14:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4455 invoked by uid 500); 11 Sep 2009 00:14:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4445 invoked by uid 99); 11 Sep 2009 00:14:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 00:14:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.221.171 as permitted sender)
Received: from [209.85.221.171] (HELO mail-qy0-f171.google.com) (209.85.221.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 00:14:45 +0000
Received: by qyk1 with SMTP id 1so539206qyk.22
        for <java-user@lucene.apache.org>; Thu, 10 Sep 2009 17:14:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=6N5946kW/cGaPHMQCFdzcafXKiKvcQaRDsQSwCCVyvs=;
        b=FLJisATfyn2OicfTyBgjT0iXzVFwBwCffNMDg4gj81wYDwuHvbIY5ZAiIEEpYzWnG/
         jv43mkBm9oTt651T2wL6OFpIqOn8zZwju2MOj+GBSCkWho92jj7iIFI33LS9BDsWzegv
         /BnaU+Vi5TeGE4w6Ma/0HhiYDB9XA1M/KXYC4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=vtLgjk+I/i3Hm++mGs/IL0EyXBIeF1fJ1lZUNsVD+pNzcaDfNt3BXn1Oy/UiBdj1Rw
         qScUzXAIEiuHzr1Q35GY9IHVjQkbaOouWox8m/sXYUblPooN8WDMGN7glBqjGiFro1uu
         d2BhE/+guOcZx8JSnJ9kTHtbOMmB8u9Pq/hrk=
MIME-Version: 1.0
Received: by 10.224.116.137 with SMTP id m9mr2006330qaq.319.1252628063656; 
	Thu, 10 Sep 2009 17:14:23 -0700 (PDT)
In-Reply-To: <9ac0c6aa0909101649t5ca87f77r8c8525db52d38bf1@mail.gmail.com>
References: <85d3c3b60909101619x401c39a1wc4abb551b35a97b1@mail.gmail.com>
	 <9ac0c6aa0909101649t5ca87f77r8c8525db52d38bf1@mail.gmail.com>
Date: Thu, 10 Sep 2009 17:14:23 -0700
Message-ID: <85d3c3b60909101714s5355982agda3dd7f25eddf731@mail.gmail.com>
Subject: Re: Index docstore flush problem
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Indexing locking was off, there was a bug higher up clobbering the
index.  Sorry and thanks!

On Thu, Sep 10, 2009 at 4:49 PM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> That's an odd exception. =A0It means IndexWriter thinks 468 docs have
> been written to the stored fields file, which should mean the fdx file
> size is 3748 (=3D 4 + 468*8), yet the file size is far larger than that
> (298404).
>
> How repeatable is it? =A0Can you turn on infoStream, get the exception
> to happen, then post the resulting output?
>
> Mike
>
> On Thu, Sep 10, 2009 at 7:19 PM, Jason Rutherglen
> <jason.rutherglen@gmail.com> wrote:
>> I'm seeing a strange exception when indexing using the latest Solr rev o=
n EC2.
>>
>> org.apache.solr.client.solrj.SolrServerException:
>> org.apache.solr.client.solrj.SolrServerException:
>> java.lang.RuntimeException: after flush: fdx size mismatch: 468 docs
>> vs 298404 length in bytes of _0.fdx
>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrServ=
er.request(EmbeddedSolrServer.java:153)
>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.request.UpdateRequest.pro=
cess(UpdateRequest.java:268)
>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.SolrServer.commit(SolrSer=
ver.java:86)
>> =A0 =A0 =A0 =A0at org.apache.solr.hadoop.SolrRecordWriter$1.run(SolrReco=
rdWriter.java:239)
>> Caused by: org.apache.solr.client.solrj.SolrServerException:
>> java.lang.RuntimeException: after flush: fdx size mismatch: 468 docs
>> vs 298404 length in bytes of _0.fdx
>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrServ=
er.request(EmbeddedSolrServer.java:141)
>> =A0 =A0 =A0 =A0... 3 more
>> Caused by: java.lang.RuntimeException: after flush: fdx size mismatch:
>> 468 docs vs 298404 length in bytes of _0.fdx
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.StoredFieldsWriter.closeDocSto=
re(StoredFieldsWriter.java:95)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocFieldProcessor.closeDocStor=
e(DocFieldProcessor.java:50)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocumentsWriter.closeDocStore(=
DocumentsWriter.java:380)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocumentsWriter.flush(Document=
sWriter.java:574)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.doFlushInternal(In=
dexWriter.java:4212)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.doFlush(IndexWrite=
r.java:4110)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.flush(IndexWriter.=
java:4101)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.closeInternal(Inde=
xWriter.java:2108)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.close(IndexWriter.=
java:2071)
>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.close(IndexWriter.=
java:2035)
>> =A0 =A0 =A0 =A0at org.apache.solr.update.SolrIndexWriter.close(SolrIndex=
Writer.java:215)
>> =A0 =A0 =A0 =A0at org.apache.solr.update.DirectUpdateHandler2.closeWrite=
r(DirectUpdateHandler2.java:180)
>> =A0 =A0 =A0 =A0at org.apache.solr.update.DirectUpdateHandler2.commit(Dir=
ectUpdateHandler2.java:404)
>> =A0 =A0 =A0 =A0at org.apache.solr.update.processor.RunUpdateProcessor.pr=
ocessCommit(RunUpdateProcessorFactory.java:85)
>> =A0 =A0 =A0 =A0at org.apache.solr.handler.RequestHandlerUtils.handleComm=
it(RequestHandlerUtils.java:105)
>> =A0 =A0 =A0 =A0at org.apache.solr.handler.ContentStreamHandlerBase.handl=
eRequestBody(ContentStreamHandlerBase.java:48)
>> =A0 =A0 =A0 =A0at org.apache.solr.handler.RequestHandlerBase.handleReque=
st(RequestHandlerBase.java:131)
>> =A0 =A0 =A0 =A0at org.apache.solr.core.SolrCore.execute(SolrCore.java:12=
99)
>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrServ=
er.request(EmbeddedSolrServer.java:139)
>> =A0 =A0 =A0 =A0... 3 more
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42268-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 03:18:03 2009
Return-Path: <java-user-return-42268-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69272 invoked from network); 11 Sep 2009 03:18:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 03:18:03 -0000
Received: (qmail 66253 invoked by uid 500); 11 Sep 2009 03:18:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66111 invoked by uid 500); 11 Sep 2009 03:18:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66097 invoked by uid 99); 11 Sep 2009 03:18:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 03:17:59 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 03:17:49 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Mlwdc-0007fc-H1
	for java-user@lucene.apache.org; Thu, 10 Sep 2009 20:17:28 -0700
Message-ID: <25394429.post@talk.nabble.com>
Date: Thu, 10 Sep 2009 20:17:28 -0700 (PDT)
From: rr04 <reach_reddy_04@yahoo.com>
To: java-user@lucene.apache.org
Subject: quick survey on schema less database usage
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: reach_reddy_04@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


I am a MIT student doing a project on schema-less database usage and would
greatly appreciate if you guys can fill out a quick survey on this (should
take < 5 mins)

http://bit.ly/nosqldb
-- 
View this message in context: http://www.nabble.com/quick-survey-on-schema-less-database-usage-tp25394429p25394429.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42269-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 08:41:44 2009
Return-Path: <java-user-return-42269-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71407 invoked from network); 11 Sep 2009 08:41:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 08:41:44 -0000
Received: (qmail 97404 invoked by uid 500); 11 Sep 2009 08:41:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97326 invoked by uid 500); 11 Sep 2009 08:41:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97316 invoked by uid 99); 11 Sep 2009 08:41:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 08:41:42 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.191] (HELO mail-yw0-f191.google.com) (209.85.211.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 08:41:34 +0000
Received: by ywh29 with SMTP id 29so1386905ywh.23
        for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 01:41:12 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.118.36 with SMTP id q36mr4395141ybc.277.1252658472742; 
	Fri, 11 Sep 2009 01:41:12 -0700 (PDT)
In-Reply-To: <85d3c3b60909101714s5355982agda3dd7f25eddf731@mail.gmail.com>
References: <85d3c3b60909101619x401c39a1wc4abb551b35a97b1@mail.gmail.com>
	 <9ac0c6aa0909101649t5ca87f77r8c8525db52d38bf1@mail.gmail.com>
	 <85d3c3b60909101714s5355982agda3dd7f25eddf731@mail.gmail.com>
Date: Fri, 11 Sep 2009 04:41:12 -0400
Message-ID: <9ac0c6aa0909110141v223d5cd3sdad6b8f93ac001ce@mail.gmail.com>
Subject: Re: Index docstore flush problem
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Phew :)

Mike

On Thu, Sep 10, 2009 at 8:14 PM, Jason Rutherglen
<jason.rutherglen@gmail.com> wrote:
> Indexing locking was off, there was a bug higher up clobbering the
> index. =A0Sorry and thanks!
>
> On Thu, Sep 10, 2009 at 4:49 PM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>> That's an odd exception. =A0It means IndexWriter thinks 468 docs have
>> been written to the stored fields file, which should mean the fdx file
>> size is 3748 (=3D 4 + 468*8), yet the file size is far larger than that
>> (298404).
>>
>> How repeatable is it? =A0Can you turn on infoStream, get the exception
>> to happen, then post the resulting output?
>>
>> Mike
>>
>> On Thu, Sep 10, 2009 at 7:19 PM, Jason Rutherglen
>> <jason.rutherglen@gmail.com> wrote:
>>> I'm seeing a strange exception when indexing using the latest Solr rev =
on EC2.
>>>
>>> org.apache.solr.client.solrj.SolrServerException:
>>> org.apache.solr.client.solrj.SolrServerException:
>>> java.lang.RuntimeException: after flush: fdx size mismatch: 468 docs
>>> vs 298404 length in bytes of _0.fdx
>>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrSer=
ver.request(EmbeddedSolrServer.java:153)
>>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.request.UpdateRequest.pr=
ocess(UpdateRequest.java:268)
>>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.SolrServer.commit(SolrSe=
rver.java:86)
>>> =A0 =A0 =A0 =A0at org.apache.solr.hadoop.SolrRecordWriter$1.run(SolrRec=
ordWriter.java:239)
>>> Caused by: org.apache.solr.client.solrj.SolrServerException:
>>> java.lang.RuntimeException: after flush: fdx size mismatch: 468 docs
>>> vs 298404 length in bytes of _0.fdx
>>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrSer=
ver.request(EmbeddedSolrServer.java:141)
>>> =A0 =A0 =A0 =A0... 3 more
>>> Caused by: java.lang.RuntimeException: after flush: fdx size mismatch:
>>> 468 docs vs 298404 length in bytes of _0.fdx
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.StoredFieldsWriter.closeDocSt=
ore(StoredFieldsWriter.java:95)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocFieldProcessor.closeDocSto=
re(DocFieldProcessor.java:50)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocumentsWriter.closeDocStore=
(DocumentsWriter.java:380)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.DocumentsWriter.flush(Documen=
tsWriter.java:574)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.doFlushInternal(I=
ndexWriter.java:4212)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.doFlush(IndexWrit=
er.java:4110)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.flush(IndexWriter=
.java:4101)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.closeInternal(Ind=
exWriter.java:2108)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.close(IndexWriter=
.java:2071)
>>> =A0 =A0 =A0 =A0at org.apache.lucene.index.IndexWriter.close(IndexWriter=
.java:2035)
>>> =A0 =A0 =A0 =A0at org.apache.solr.update.SolrIndexWriter.close(SolrInde=
xWriter.java:215)
>>> =A0 =A0 =A0 =A0at org.apache.solr.update.DirectUpdateHandler2.closeWrit=
er(DirectUpdateHandler2.java:180)
>>> =A0 =A0 =A0 =A0at org.apache.solr.update.DirectUpdateHandler2.commit(Di=
rectUpdateHandler2.java:404)
>>> =A0 =A0 =A0 =A0at org.apache.solr.update.processor.RunUpdateProcessor.p=
rocessCommit(RunUpdateProcessorFactory.java:85)
>>> =A0 =A0 =A0 =A0at org.apache.solr.handler.RequestHandlerUtils.handleCom=
mit(RequestHandlerUtils.java:105)
>>> =A0 =A0 =A0 =A0at org.apache.solr.handler.ContentStreamHandlerBase.hand=
leRequestBody(ContentStreamHandlerBase.java:48)
>>> =A0 =A0 =A0 =A0at org.apache.solr.handler.RequestHandlerBase.handleRequ=
est(RequestHandlerBase.java:131)
>>> =A0 =A0 =A0 =A0at org.apache.solr.core.SolrCore.execute(SolrCore.java:1=
299)
>>> =A0 =A0 =A0 =A0at org.apache.solr.client.solrj.embedded.EmbeddedSolrSer=
ver.request(EmbeddedSolrServer.java:139)
>>> =A0 =A0 =A0 =A0... 3 more
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42270-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 11:59:08 2009
Return-Path: <java-user-return-42270-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20171 invoked from network); 11 Sep 2009 11:59:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 11:59:08 -0000
Received: (qmail 61243 invoked by uid 500); 11 Sep 2009 11:59:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61160 invoked by uid 500); 11 Sep 2009 11:59:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61150 invoked by uid 99); 11 Sep 2009 11:59:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 11:59:05 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [149.8.64.10] (HELO mclmx.mail.saic.com) (149.8.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 11:58:56 +0000
Received: from 0015-its-sbg01.saic.com ([149.8.64.21] [149.8.64.21]) by mclmx.mail.saic.com with ESMTP id BT-MMP-10420887 for java-user@lucene.apache.org; Fri, 11 Sep 2009 07:58:26 -0400
X-AuditID: 9508401a-b7ceeae00000220a-86-4aaa3b62a424
Received: from mclmx2.mail.saic.com (mcl-sixl-nat.saic.com [149.8.64.21])
	by  (Symantec Brightmail Gateway) with SMTP id A1.F7.08714.26B3AAA4; Fri, 11 Sep 2009 07:58:26 -0400 (EDT)
Received: from sc2xfe1.emainc.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-1820030 for java-user@lucene.apache.org; Fri, 11 Sep 2009 07:58:26 -0400
Received: from sc1exc2.corp.emainc.com ([10.36.152.47]) by sc2xfe1.emainc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 11 Sep 2009 08:01:43 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Indexing large files? - No answers yet...
Date: Fri, 11 Sep 2009 07:57:23 -0400
Message-Id: <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>
In-Reply-To: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Indexing large files? - No answers yet...
Thread-Index: AcoqR0dKyqqfoNWqQp2LCReH0r4g8AIj1yHg
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
From: <Paul_Murdoch@emainc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 11 Sep 2009 12:01:43.0564 (UTC) FILETIME=[A1197CC0:01CA32D7]
X-Brightmail-Tracker: AAAAAA==
X-Virus-Checked: Checked by ClamAV on apache.org

This issue is still open.  Any suggestions/help with this would be
greatly appreciated.

Thanks,

Paul


-----Original Message-----
From: java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.org
[mailto:java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g
] On Behalf Of Paul_Murdoch@emainc.com
Sent: Monday, August 31, 2009 10:28 AM
To: java-user@lucene.apache.org
Subject: Indexing large files?

Hi,

=20

I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07).  I'm
consistently receiving "OutOfMemoryError: Java heap space", when trying
to index large text files.

=20

Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
max. heap size.  So I increased the max. heap size to 512 MB.  This
worked for the 5 MB text file, but Lucene still used 84 MB of heap space
to do this.  Why so much?

=20

The class FreqProxTermsWriterPerField appears to be the biggest memory
consumer by far according to JConsole and the TPTP Memory Profiling
plugin for Eclipse Ganymede.

=20

Example 2: Indexing a 62 MB text file runs out of memory with a 512 MB
max. heap size.  Increasing the max. heap size to 1024 MB works but
Lucene uses 826 MB of heap space while performing this.  Still seems
like way too much memory is being used to do this.  I'm sure larger
files would cause the error as it seems correlative.

=20

I'm on a Windows XP SP2 platform with 2 GB of RAM.  So what is the best
practice for indexing large files?  Here is a code snippet that I'm
using:

=20

// Index the content of a text file.

      private Boolean saveTXTFile(File textFile, Document textDocument)
throws CIDBException {          =20

           =20

            try {            =20

                             =20

                  Boolean isFile =3D textFile.isFile();

                  Boolean hasTextExtension =3D
textFile.getName().endsWith(".txt");

                 =20

                  if (isFile && hasTextExtension) {

            =20

                        System.out.println("File " +
textFile.getCanonicalPath() + " is being indexed");

                        Reader textFileReader =3D new
FileReader(textFile);

                        if (textDocument =3D=3D null)

                              textDocument =3D new Document();

                        textDocument.add(new Field("content",
textFileReader));

                        indexWriter.addDocument(textDocument);
// BREAKS HERE!!!!

                  }                   =20

            } catch (FileNotFoundException fnfe) {

                  System.out.println(fnfe.getMessage());

                  return false;

            } catch (CorruptIndexException cie) {

                  throw new CIDBException("The index has become
corrupt.");

            } catch (IOException ioe) {

                  System.out.println(ioe.getMessage());

                  return false;

            }                   =20

            return true;

      }

=20

=20

Thanks much,

=20

Paul

=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42271-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 12:13:45 2009
Return-Path: <java-user-return-42271-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24321 invoked from network); 11 Sep 2009 12:13:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 12:13:45 -0000
Received: (qmail 90774 invoked by uid 500); 11 Sep 2009 12:13:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90689 invoked by uid 500); 11 Sep 2009 12:13:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90679 invoked by uid 99); 11 Sep 2009 12:13:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 12:13:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.123.65.155] (HELO mail2.acquiremedia.com) (209.123.65.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 12:13:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail2.acquiremedia.com (Postfix) with ESMTP id B1F095AC086
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 08:13:12 -0400 (EDT)
X-Virus-Scanned: amavisd-new at mmu.acquiremedia.com
Received: from mail2.acquiremedia.com ([127.0.0.1])
	by localhost (mail.mmu.acquiremedia.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id c+IToKPvTjlK for <java-user@lucene.apache.org>;
	Fri, 11 Sep 2009 08:13:12 -0400 (EDT)
Received: from exchange.mmu.acquiremedia.com (exchange.mmu.acquiremedia.com [10.10.40.251])
	by mail2.acquiremedia.com (Postfix) with ESMTP
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 08:13:12 -0400 (EDT)
Received: from exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) by
 exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) with mapi; Fri, 11 Sep
 2009 08:13:12 -0400
From: Dan OConnor <doconnor@acquiremedia.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 11 Sep 2009 08:13:08 -0400
Subject: RE: Indexing large files? - No answers yet...
Thread-Topic: Indexing large files? - No answers yet...
Thread-Index: AcoqR0dKyqqfoNWqQp2LCReH0r4g8AIj1yHgAAA64AA=
Message-ID: <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
 <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>
In-Reply-To: <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Paul:

My first suggestion would be to update your JVM to the latest version (or a=
t least .14). There were several garbage collection related issues resolved=
 in version 10 - 13 (especially dealing with large heaps).

Next, your IndexWriter parameters would help figure out why you are using s=
o much RAM
	getMaxFieldLength()
	getMaxBufferedDocs()
	getMaxMergeDocs()
	getRAMBufferSizeMB()

How often are you calling commit?
Do you close your IndexWriter after every document?
How many documents of this size are you indexing?
Have you used luke to look at your index?
If this is a large index, have you optimized it recently?
Are there any searches going on while you are indexing?


Regards,
Dan


-----Original Message-----
From: Paul_Murdoch@emainc.com [mailto:Paul_Murdoch@emainc.com]=20
Sent: Friday, September 11, 2009 7:57 AM
To: java-user@lucene.apache.org
Subject: RE: Indexing large files? - No answers yet...

This issue is still open.  Any suggestions/help with this would be
greatly appreciated.

Thanks,

Paul


-----Original Message-----
From: java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.org
[mailto:java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.org
] On Behalf Of Paul_Murdoch@emainc.com
Sent: Monday, August 31, 2009 10:28 AM
To: java-user@lucene.apache.org
Subject: Indexing large files?

Hi,

=20

I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07).  I'm
consistently receiving "OutOfMemoryError: Java heap space", when trying
to index large text files.

=20

Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
max. heap size.  So I increased the max. heap size to 512 MB.  This
worked for the 5 MB text file, but Lucene still used 84 MB of heap space
to do this.  Why so much?

=20

The class FreqProxTermsWriterPerField appears to be the biggest memory
consumer by far according to JConsole and the TPTP Memory Profiling
plugin for Eclipse Ganymede.

=20

Example 2: Indexing a 62 MB text file runs out of memory with a 512 MB
max. heap size.  Increasing the max. heap size to 1024 MB works but
Lucene uses 826 MB of heap space while performing this.  Still seems
like way too much memory is being used to do this.  I'm sure larger
files would cause the error as it seems correlative.

=20

I'm on a Windows XP SP2 platform with 2 GB of RAM.  So what is the best
practice for indexing large files?  Here is a code snippet that I'm
using:

=20

// Index the content of a text file.

      private Boolean saveTXTFile(File textFile, Document textDocument)
throws CIDBException {          =20

           =20

            try {            =20

                             =20

                  Boolean isFile =3D textFile.isFile();

                  Boolean hasTextExtension =3D
textFile.getName().endsWith(".txt");

                 =20

                  if (isFile && hasTextExtension) {

            =20

                        System.out.println("File " +
textFile.getCanonicalPath() + " is being indexed");

                        Reader textFileReader =3D new
FileReader(textFile);

                        if (textDocument =3D=3D null)

                              textDocument =3D new Document();

                        textDocument.add(new Field("content",
textFileReader));

                        indexWriter.addDocument(textDocument);
// BREAKS HERE!!!!

                  }                   =20

            } catch (FileNotFoundException fnfe) {

                  System.out.println(fnfe.getMessage());

                  return false;

            } catch (CorruptIndexException cie) {

                  throw new CIDBException("The index has become
corrupt.");

            } catch (IOException ioe) {

                  System.out.println(ioe.getMessage());

                  return false;

            }                   =20

            return true;

      }

=20

=20

Thanks much,

=20

Paul

=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42272-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 13:53:55 2009
Return-Path: <java-user-return-42272-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53808 invoked from network); 11 Sep 2009 13:53:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 13:53:54 -0000
Received: (qmail 31353 invoked by uid 500); 11 Sep 2009 13:53:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31308 invoked by uid 500); 11 Sep 2009 13:53:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31298 invoked by uid 99); 11 Sep 2009 13:53:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 13:53:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of glen.newton@gmail.com designates 209.85.132.248 as permitted sender)
Received: from [209.85.132.248] (HELO an-out-0708.google.com) (209.85.132.248)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 13:53:43 +0000
Received: by an-out-0708.google.com with SMTP id b2so359163ana.5
        for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 06:53:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=KRFYFDfWq8SEcxvPxAphoYrPe52eorMnoJmNxagymFg=;
        b=M3iwdXzRJZeacdunREFpo466ZPbMJFP0yYb2ceQ3pChR9ocNRFxZ18fN0Jp6HFWgjS
         LzfxpG7ss9DBVTjtLL5YhNfHCOZdk1nG1GxXewOJ3fFKG5gB7yBO9GXpwNZAclnce0Hk
         qbjARtf254pRdkLyW3H/mUgBVrigrteZ/ZYd8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=HxG1H24l/QRs8EOizY59SPXcmsIDvH12veeuy2sT0MG4hBqfNsK14wrrkS+3haqZOe
         QnZH9+xO5k6+C9BsIn3zCYwD5Y0sJ+wLB8DH2PsbKogDbhKJrEtL2rXRu5wdlcfhh2EM
         KgTK0IPC+WQ2q2jQwSI54mdrApglXae874428=
MIME-Version: 1.0
Received: by 10.101.81.8 with SMTP id i8mr3182575anl.185.1252677202289; Fri, 
	11 Sep 2009 06:53:22 -0700 (PDT)
In-Reply-To: <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
	 <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>
	 <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
Date: Fri, 11 Sep 2009 09:53:22 -0400
Message-ID: <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
Subject: Re: Indexing large files? - No answers yet...
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

In this project:
 http://zzzoot.blogspot.com/2009/07/project-torngat-building-large-scale.ht=
ml

I concatenate all the text of all of articles of a single journal into
a single text file.
This can create a text file that is 500MB in size.
Lucene is OK in indexing files this size (in parallel even), but I
have a heap size of 8GB.

I would suggest increasing your heap to as large as your machine can
reasonably take.
The reality is that Java programs (like Lucene) take up more memory
than a similar C or even C++ program.
Java may approach C/C++ in speed, but not memory.

We don't use Java because of its memory footprint!  ;-)

See:
 Programming language shootout: speed:
http://shootout.alioth.debian.org/u32q/benchmark.php?test=3Dall&lang=3Dall&=
d=3Dndata&calc=3Dcalculate&xfullcpu=3D1&xmem=3D0&xloc=3D0&binarytrees=3D1&c=
hameneosredux=3D1&fannkuch=3D1&fasta=3D1&knucleotide=3D1&mandelbrot=3D1&met=
eor=3D0&nbody=3D1&pidigits=3D1&regexdna=3D1&revcomp=3D1&spectralnorm=3D1&th=
readring=3D0
 Programming language shootout: memory:
http://shootout.alioth.debian.org/u32q/benchmark.php?test=3Dall&lang=3Dall&=
d=3Dndata&calc=3Dcalculate&xfullcpu=3D0&xmem=3D1&xloc=3D0&binarytrees=3D1&c=
hameneosredux=3D1&fannkuch=3D1&fasta=3D1&knucleotide=3D1&mandelbrot=3D1&met=
eor=3D0&nbody=3D1&pidigits=3D1&regexdna=3D1&revcomp=3D1&spectralnorm=3D1&th=
readring=3D0

-glen

2009/9/11 Dan OConnor <doconnor@acquiremedia.com>:
> Paul:
>
> My first suggestion would be to update your JVM to the latest version (or=
 at least .14). There were several garbage collection related issues resolv=
ed in version 10 - 13 (especially dealing with large heaps).
>
> Next, your IndexWriter parameters would help figure out why you are using=
 so much RAM
>        getMaxFieldLength()
>        getMaxBufferedDocs()
>        getMaxMergeDocs()
>        getRAMBufferSizeMB()
>
> How often are you calling commit?
> Do you close your IndexWriter after every document?
> How many documents of this size are you indexing?
> Have you used luke to look at your index?
> If this is a large index, have you optimized it recently?
> Are there any searches going on while you are indexing?
>
>
> Regards,
> Dan
>
>
> -----Original Message-----
> From: Paul_Murdoch@emainc.com [mailto:Paul_Murdoch@emainc.com]
> Sent: Friday, September 11, 2009 7:57 AM
> To: java-user@lucene.apache.org
> Subject: RE: Indexing large files? - No answers yet...
>
> This issue is still open.  Any suggestions/help with this would be
> greatly appreciated.
>
> Thanks,
>
> Paul
>
>
> -----Original Message-----
> From: java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.org
> [mailto:java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g
> ] On Behalf Of Paul_Murdoch@emainc.com
> Sent: Monday, August 31, 2009 10:28 AM
> To: java-user@lucene.apache.org
> Subject: Indexing large files?
>
> Hi,
>
>
>
> I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07).  I'm
> consistently receiving "OutOfMemoryError: Java heap space", when trying
> to index large text files.
>
>
>
> Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
> max. heap size.  So I increased the max. heap size to 512 MB.  This
> worked for the 5 MB text file, but Lucene still used 84 MB of heap space
> to do this.  Why so much?
>
>
>
> The class FreqProxTermsWriterPerField appears to be the biggest memory
> consumer by far according to JConsole and the TPTP Memory Profiling
> plugin for Eclipse Ganymede.
>
>
>
> Example 2: Indexing a 62 MB text file runs out of memory with a 512 MB
> max. heap size.  Increasing the max. heap size to 1024 MB works but
> Lucene uses 826 MB of heap space while performing this.  Still seems
> like way too much memory is being used to do this.  I'm sure larger
> files would cause the error as it seems correlative.
>
>
>
> I'm on a Windows XP SP2 platform with 2 GB of RAM.  So what is the best
> practice for indexing large files?  Here is a code snippet that I'm
> using:
>
>
>
> // Index the content of a text file.
>
>      private Boolean saveTXTFile(File textFile, Document textDocument)
> throws CIDBException {
>
>
>
>            try {
>
>
>
>                  Boolean isFile =3D textFile.isFile();
>
>                  Boolean hasTextExtension =3D
> textFile.getName().endsWith(".txt");
>
>
>
>                  if (isFile && hasTextExtension) {
>
>
>
>                        System.out.println("File " +
> textFile.getCanonicalPath() + " is being indexed");
>
>                        Reader textFileReader =3D new
> FileReader(textFile);
>
>                        if (textDocument =3D=3D null)
>
>                              textDocument =3D new Document();
>
>                        textDocument.add(new Field("content",
> textFileReader));
>
>                        indexWriter.addDocument(textDocument);
> // BREAKS HERE!!!!
>
>                  }
>
>            } catch (FileNotFoundException fnfe) {
>
>                  System.out.println(fnfe.getMessage());
>
>                  return false;
>
>            } catch (CorruptIndexException cie) {
>
>                  throw new CIDBException("The index has become
> corrupt.");
>
>            } catch (IOException ioe) {
>
>                  System.out.println(ioe.getMessage());
>
>                  return false;
>
>            }
>
>            return true;
>
>      }
>
>
>
>
>
> Thanks much,
>
>
>
> Paul
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42273-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 14:25:04 2009
Return-Path: <java-user-return-42273-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65159 invoked from network); 11 Sep 2009 14:25:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 14:25:04 -0000
Received: (qmail 98302 invoked by uid 500); 11 Sep 2009 14:25:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98275 invoked by uid 500); 11 Sep 2009 14:25:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98265 invoked by uid 99); 11 Sep 2009 14:25:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:25:01 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [149.8.64.10] (HELO mclmx.mail.saic.com) (149.8.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:24:52 +0000
Received: from 0015-its-sbg01.saic.com ([149.8.64.21] [149.8.64.21]) by mclmx.mail.saic.com with ESMTP id BT-MMP-10453685 for java-user@lucene.apache.org; Fri, 11 Sep 2009 10:24:16 -0400
X-AuditID: 9508401a-b7ceeae00000220a-d6-4aaa5d90f92c
Received: from mclmx2.mail.saic.com (mcl-sixl-nat.saic.com [149.8.64.21])
	by  (Symantec Brightmail Gateway) with SMTP id 91.C3.08714.09D5AAA4; Fri, 11 Sep 2009 10:24:16 -0400 (EDT)
Received: from sc2xfe1.emainc.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-1824602 for java-user@lucene.apache.org; Fri, 11 Sep 2009 10:24:15 -0400
Received: from sc1exc2.corp.emainc.com ([10.36.152.47]) by sc2xfe1.emainc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 11 Sep 2009 10:27:23 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Indexing large files? - No answers yet...
Date: Fri, 11 Sep 2009 10:23:52 -0400
Message-Id: <5B20DEF02611534DB08854076CE825D80362652A@sc1exc2.corp.emainc.com>
In-Reply-To: <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Indexing large files? - No answers yet...
Thread-Index: AcoqR0dKyqqfoNWqQp2LCReH0r4g8AIj1yHgAAA64AAABGNHcA==
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com> <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
From: <Paul_Murdoch@emainc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 11 Sep 2009 14:27:23.0376 (UTC) FILETIME=[FA6EF700:01CA32EB]
X-Brightmail-Tracker: AAAAAA==
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Dan!

I upgraded my JVM from .12 to .16.  I'll test with that.

I've been testing by setting many IndexWriter parameters manually to see
where the best performance is.  Then net result was just delaying the
OOM.

The scenario is a test with an empty index.  I have a 5 MB file with
800,000 unique terms in it. I make one document with the file and then
add that document to the IndexWriter for indexing.  At a heap space of
64 MB the OOM occurs almost immediately when the
IndexWriter.add(document) is called. If I increase the heap space to 128
MB indexing is successful taking less than 5 seconds to complete. So...

I commit only once.
The OOM occurs before I can close the IndexWriter at 64 MB heap space. I
close and optimize on the successful 128 MB test.
I'm only indexing one document.
I use Luke all the time for other indexes, but after the OOM on this
test not even the "Force Open" will get me into the index.
There are no searches going on.  This is a test to try and index one 5
MB file to an empty index.

So you're probably asking why I don't just increase the heap space and
be happy.  The answer is that the larger the file the more heap space is
needed.  The system I'm developing doesn't have the heap space required
for the potential large files that the end user might try to index.  So
I would like a way to index the file as one document using a small
memory footprint.  It would be nice to be able to "throttle" the
indexing of large files to control memory usage.

Thanks,
Paul


-----Original Message-----
From: java-user-return-42271-Paul_Murdoch=3Demainc.com@lucene.apache.org
[mailto:java-user-return-42271-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g
] On Behalf Of Dan OConnor
Sent: Friday, September 11, 2009 8:13 AM
To: java-user@lucene.apache.org
Subject: RE: Indexing large files? - No answers yet...

Paul:

My first suggestion would be to update your JVM to the latest version
(or at least .14). There were several garbage collection related issues
resolved in version 10 - 13 (especially dealing with large heaps).

Next, your IndexWriter parameters would help figure out why you are
using so much RAM
	getMaxFieldLength()
	getMaxBufferedDocs()
	getMaxMergeDocs()
	getRAMBufferSizeMB()

How often are you calling commit?
Do you close your IndexWriter after every document?
How many documents of this size are you indexing?
Have you used luke to look at your index?
If this is a large index, have you optimized it recently?
Are there any searches going on while you are indexing?


Regards,
Dan


-----Original Message-----
From: Paul_Murdoch@emainc.com [mailto:Paul_Murdoch@emainc.com]=20
Sent: Friday, September 11, 2009 7:57 AM
To: java-user@lucene.apache.org
Subject: RE: Indexing large files? - No answers yet...

This issue is still open.  Any suggestions/help with this would be
greatly appreciated.

Thanks,

Paul


-----Original Message-----
From: java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.org
[mailto:java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g
] On Behalf Of Paul_Murdoch@emainc.com
Sent: Monday, August 31, 2009 10:28 AM
To: java-user@lucene.apache.org
Subject: Indexing large files?

Hi,

=20

I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07).  I'm
consistently receiving "OutOfMemoryError: Java heap space", when trying
to index large text files.

=20

Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
max. heap size.  So I increased the max. heap size to 512 MB.  This
worked for the 5 MB text file, but Lucene still used 84 MB of heap space
to do this.  Why so much?

=20

The class FreqProxTermsWriterPerField appears to be the biggest memory
consumer by far according to JConsole and the TPTP Memory Profiling
plugin for Eclipse Ganymede.

=20

Example 2: Indexing a 62 MB text file runs out of memory with a 512 MB
max. heap size.  Increasing the max. heap size to 1024 MB works but
Lucene uses 826 MB of heap space while performing this.  Still seems
like way too much memory is being used to do this.  I'm sure larger
files would cause the error as it seems correlative.

=20

I'm on a Windows XP SP2 platform with 2 GB of RAM.  So what is the best
practice for indexing large files?  Here is a code snippet that I'm
using:

=20

// Index the content of a text file.

      private Boolean saveTXTFile(File textFile, Document textDocument)
throws CIDBException {          =20

           =20

            try {            =20

                             =20

                  Boolean isFile =3D textFile.isFile();

                  Boolean hasTextExtension =3D
textFile.getName().endsWith(".txt");

                 =20

                  if (isFile && hasTextExtension) {

            =20

                        System.out.println("File " +
textFile.getCanonicalPath() + " is being indexed");

                        Reader textFileReader =3D new
FileReader(textFile);

                        if (textDocument =3D=3D null)

                              textDocument =3D new Document();

                        textDocument.add(new Field("content",
textFileReader));

                        indexWriter.addDocument(textDocument);
// BREAKS HERE!!!!

                  }                   =20

            } catch (FileNotFoundException fnfe) {

                  System.out.println(fnfe.getMessage());

                  return false;

            } catch (CorruptIndexException cie) {

                  throw new CIDBException("The index has become
corrupt.");

            } catch (IOException ioe) {

                  System.out.println(ioe.getMessage());

                  return false;

            }                   =20

            return true;

      }

=20

=20

Thanks much,

=20

Paul

=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42274-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 14:26:22 2009
Return-Path: <java-user-return-42274-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65467 invoked from network); 11 Sep 2009 14:26:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 14:26:21 -0000
Received: (qmail 1695 invoked by uid 500); 11 Sep 2009 14:26:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1638 invoked by uid 500); 11 Sep 2009 14:26:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1628 invoked by uid 99); 11 Sep 2009 14:26:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:26:19 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:26:09 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n8BEPiAH002853
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 10:25:44 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Fri, 11 Sep 2009 10:25:44 -0400
  id 00027326.4AAA5DE8.0000171E
Message-ID: <4AAA5DE8.9070200@lexum.umontreal.ca>
Date: Fri, 11 Sep 2009 10:25:44 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Stopping a runaway search, any ideas?
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>	 <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>	 <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
In-Reply-To: <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3360=0
X-Virus-Checked: Checked by ClamAV on apache.org

I don't think its possible, but is there something in lucene to cap a 
search to a predefined time length or is there a way to stop a search 
when its running for too long?

Daniel Shane


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42275-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 14:34:09 2009
Return-Path: <java-user-return-42275-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68090 invoked from network); 11 Sep 2009 14:34:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 14:34:08 -0000
Received: (qmail 28929 invoked by uid 500); 11 Sep 2009 14:34:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28889 invoked by uid 500); 11 Sep 2009 14:34:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28879 invoked by uid 99); 11 Sep 2009 14:34:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:34:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:33:54 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 5362A45F276
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 16:33:34 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id orjcKhAzuNXW for <java-user@lucene.apache.org>;
	Fri, 11 Sep 2009 16:33:24 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 2A62845F272
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 16:33:24 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>	 <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>	 <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com> <4AAA5DE8.9070200@lexum.umontreal.ca>
Subject: RE: Stopping a runaway search, any ideas?
Date: Fri, 11 Sep 2009 16:33:19 +0200
Message-ID: <6447E7C4AFD04DD4A58932257C06AC39@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AAA5DE8.9070200@lexum.umontreal.ca>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: Acoy6+CUmciKy2KtSyu/3izwaSDK3QAALv+A
X-Virus-Checked: Checked by ClamAV on apache.org

Yes: TimeLimitedCollector in 2.4.1 (and the new non-deprecated ones in 2.9).
Just wrap your own collector (like TopDocsCollector) with this class.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Daniel Shane [mailto:shaned@LEXUM.UMontreal.CA]
> Sent: Friday, September 11, 2009 4:26 PM
> To: java-user@lucene.apache.org
> Subject: Stopping a runaway search, any ideas?
> 
> I don't think its possible, but is there something in lucene to cap a
> search to a predefined time length or is there a way to stop a search
> when its running for too long?
> 
> Daniel Shane
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42276-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 14:34:52 2009
Return-Path: <java-user-return-42276-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68382 invoked from network); 11 Sep 2009 14:34:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 14:34:52 -0000
Received: (qmail 31618 invoked by uid 500); 11 Sep 2009 14:34:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31533 invoked by uid 500); 11 Sep 2009 14:34:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31523 invoked by uid 99); 11 Sep 2009 14:34:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:34:50 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [149.8.64.10] (HELO mclmx.mail.saic.com) (149.8.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:34:40 +0000
Received: from 0015-its-sbg01.saic.com ([149.8.64.21] [149.8.64.21]) by mclmx.mail.saic.com with ESMTP id BT-MMP-10455591 for java-user@lucene.apache.org; Fri, 11 Sep 2009 10:34:13 -0400
X-AuditID: 9508401a-b7ceeae00000220a-a2-4aaa5fe58f7a
Received: from mclmx2.mail.saic.com (mcl-sixl-nat.saic.com [149.8.64.21])
	by  (Symantec Brightmail Gateway) with SMTP id 2A.D4.08714.5EF5AAA4; Fri, 11 Sep 2009 10:34:13 -0400 (EDT)
Received: from sc2xfe1.emainc.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-1825121 for java-user@lucene.apache.org; Fri, 11 Sep 2009 10:34:13 -0400
Received: from sc1exc2.corp.emainc.com ([10.36.152.47]) by sc2xfe1.emainc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 11 Sep 2009 10:37:27 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: base64
Subject: RE: Indexing large files? - No answers yet...
Date: Fri, 11 Sep 2009 10:33:49 -0400
Message-Id: <5B20DEF02611534DB08854076CE825D803626596@sc1exc2.corp.emainc.com>
In-Reply-To: <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Indexing large files? - No answers yet...
Thread-Index: Acoy59M5AY73OV74SwK1T/lZAjOVbQAA7AcQ
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com> <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
From: <Paul_Murdoch@emainc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 11 Sep 2009 14:37:27.0688 (UTC) FILETIME=[62A1A880:01CA32ED]
X-Brightmail-Tracker: AAAAAA==
X-Virus-Checked: Checked by ClamAV on apache.org

VGhhbmtzIEdsZW4hDQoNCkkgd2lsbCB0YWtlIGF0IHlvdXIgcHJvamVjdC4gIFVuZm9ydHVuYXRl
bHkgSSB3aWxsIG9ubHkgaGF2ZSA1MTIgTUIgdG8gMTAyNCBNQiB0byB3b3JrIHdpdGggYXMgTHVj
ZW5lIGlzIG9ubHkgb25lIGNvbXBvbmVudCBpbiBhIGxhcmdlciBzb2Z0d2FyZSBzeXN0ZW0gcnVu
bmluZyBvbiBvbmUgbWFjaGluZS4gIEkgYWdyZWUgd2l0aCB5b3Ugb24gdGhlIENcQysrIGNvbW1l
bnQuICBUaGF0IGlzIHdoYXQgSSB3b3VsZCBub3JtYWxseSB1c2UgZm9yIG1lbW9yeSBpbnRlbnNl
IHNvZnR3YXJlLiAgSXQgdHVybnMgb3V0IHRoYXQgdGhlIGxhcmdlciBmaWxlIHlvdSB3YW50IHRv
IGluZGV4IGlzIHRoZSBsYXJnZXIgdGhlIGhlYXAgc3BhY2UgeW91IHdpbGwgbmVlZC4gIFdoYXQg
SSB3b3VsZCBsaWtlIHRvIHNlZSBpcyBhIHdheSB0byAidGhyb3R0bGUiIHRoZSBpbmRleGluZyBw
cm9jZXNzIHRvIGNvbnRyb2wgdGhlIG1lbW9yeSBmb290cHJpbnQuICBJIHVuZGVyc3RhbmQgdGhh
dCB0aGlzIHdpbGwgdGFrZSBsb25nZXIsIGJ1dCBpZiBJIHBlcmZvcm0gdGhlIHRhc2sgZHVyaW5n
IG9mZiBob3VycyBpdCBzaG91bGRuJ3QgbWF0dGVyLiBBdCBsZWFzdCB0aGUgZmlsZSB3aWxsIGJl
IGluZGV4ZWQgY29ycmVjdGx5Lg0KDQpUaGFua3MsDQpQYXVsDQoNCg0KLS0tLS1PcmlnaW5hbCBN
ZXNzYWdlLS0tLS0NCkZyb206IGphdmEtdXNlci1yZXR1cm4tNDIyNzItUGF1bF9NdXJkb2NoPWVt
YWluYy5jb21AbHVjZW5lLmFwYWNoZS5vcmcgW21haWx0bzpqYXZhLXVzZXItcmV0dXJuLTQyMjcy
LVBhdWxfTXVyZG9jaD1lbWFpbmMuY29tQGx1Y2VuZS5hcGFjaGUub3JnXSBPbiBCZWhhbGYgT2Yg
R2xlbiBOZXd0b24NClNlbnQ6IEZyaWRheSwgU2VwdGVtYmVyIDExLCAyMDA5IDk6NTMgQU0NClRv
OiBqYXZhLXVzZXJAbHVjZW5lLmFwYWNoZS5vcmcNClN1YmplY3Q6IFJlOiBJbmRleGluZyBsYXJn
ZSBmaWxlcz8gLSBObyBhbnN3ZXJzIHlldC4uLg0KDQpJbiB0aGlzIHByb2plY3Q6DQogaHR0cDov
L3p6em9vdC5ibG9nc3BvdC5jb20vMjAwOS8wNy9wcm9qZWN0LXRvcm5nYXQtYnVpbGRpbmctbGFy
Z2Utc2NhbGUuaHRtbA0KDQpJIGNvbmNhdGVuYXRlIGFsbCB0aGUgdGV4dCBvZiBhbGwgb2YgYXJ0
aWNsZXMgb2YgYSBzaW5nbGUgam91cm5hbCBpbnRvDQphIHNpbmdsZSB0ZXh0IGZpbGUuDQpUaGlz
IGNhbiBjcmVhdGUgYSB0ZXh0IGZpbGUgdGhhdCBpcyA1MDBNQiBpbiBzaXplLg0KTHVjZW5lIGlz
IE9LIGluIGluZGV4aW5nIGZpbGVzIHRoaXMgc2l6ZSAoaW4gcGFyYWxsZWwgZXZlbiksIGJ1dCBJ
DQpoYXZlIGEgaGVhcCBzaXplIG9mIDhHQi4NCg0KSSB3b3VsZCBzdWdnZXN0IGluY3JlYXNpbmcg
eW91ciBoZWFwIHRvIGFzIGxhcmdlIGFzIHlvdXIgbWFjaGluZSBjYW4NCnJlYXNvbmFibHkgdGFr
ZS4NClRoZSByZWFsaXR5IGlzIHRoYXQgSmF2YSBwcm9ncmFtcyAobGlrZSBMdWNlbmUpIHRha2Ug
dXAgbW9yZSBtZW1vcnkNCnRoYW4gYSBzaW1pbGFyIEMgb3IgZXZlbiBDKysgcHJvZ3JhbS4NCkph
dmEgbWF5IGFwcHJvYWNoIEMvQysrIGluIHNwZWVkLCBidXQgbm90IG1lbW9yeS4NCg0KV2UgZG9u
J3QgdXNlIEphdmEgYmVjYXVzZSBvZiBpdHMgbWVtb3J5IGZvb3RwcmludCEgIDstKQ0KDQpTZWU6
DQogUHJvZ3JhbW1pbmcgbGFuZ3VhZ2Ugc2hvb3RvdXQ6IHNwZWVkOg0KaHR0cDovL3Nob290b3V0
LmFsaW90aC5kZWJpYW4ub3JnL3UzMnEvYmVuY2htYXJrLnBocD90ZXN0PWFsbCZsYW5nPWFsbCZk
PW5kYXRhJmNhbGM9Y2FsY3VsYXRlJnhmdWxsY3B1PTEmeG1lbT0wJnhsb2M9MCZiaW5hcnl0cmVl
cz0xJmNoYW1lbmVvc3JlZHV4PTEmZmFubmt1Y2g9MSZmYXN0YT0xJmtudWNsZW90aWRlPTEmbWFu
ZGVsYnJvdD0xJm1ldGVvcj0wJm5ib2R5PTEmcGlkaWdpdHM9MSZyZWdleGRuYT0xJnJldmNvbXA9
MSZzcGVjdHJhbG5vcm09MSZ0aHJlYWRyaW5nPTANCiBQcm9ncmFtbWluZyBsYW5ndWFnZSBzaG9v
dG91dDogbWVtb3J5Og0KaHR0cDovL3Nob290b3V0LmFsaW90aC5kZWJpYW4ub3JnL3UzMnEvYmVu
Y2htYXJrLnBocD90ZXN0PWFsbCZsYW5nPWFsbCZkPW5kYXRhJmNhbGM9Y2FsY3VsYXRlJnhmdWxs
Y3B1PTAmeG1lbT0xJnhsb2M9MCZiaW5hcnl0cmVlcz0xJmNoYW1lbmVvc3JlZHV4PTEmZmFubmt1
Y2g9MSZmYXN0YT0xJmtudWNsZW90aWRlPTEmbWFuZGVsYnJvdD0xJm1ldGVvcj0wJm5ib2R5PTEm
cGlkaWdpdHM9MSZyZWdleGRuYT0xJnJldmNvbXA9MSZzcGVjdHJhbG5vcm09MSZ0aHJlYWRyaW5n
PTANCg0KLWdsZW4NCg0KMjAwOS85LzExIERhbiBPQ29ubm9yIDxkb2Nvbm5vckBhY3F1aXJlbWVk
aWEuY29tPjoNCj4gUGF1bDoNCj4NCj4gTXkgZmlyc3Qgc3VnZ2VzdGlvbiB3b3VsZCBiZSB0byB1
cGRhdGUgeW91ciBKVk0gdG8gdGhlIGxhdGVzdCB2ZXJzaW9uIChvciBhdCBsZWFzdCAuMTQpLiBU
aGVyZSB3ZXJlIHNldmVyYWwgZ2FyYmFnZSBjb2xsZWN0aW9uIHJlbGF0ZWQgaXNzdWVzIHJlc29s
dmVkIGluIHZlcnNpb24gMTAgLSAxMyAoZXNwZWNpYWxseSBkZWFsaW5nIHdpdGggbGFyZ2UgaGVh
cHMpLg0KPg0KPiBOZXh0LCB5b3VyIEluZGV4V3JpdGVyIHBhcmFtZXRlcnMgd291bGQgaGVscCBm
aWd1cmUgb3V0IHdoeSB5b3UgYXJlIHVzaW5nIHNvIG11Y2ggUkFNDQo+ICAgICAgICBnZXRNYXhG
aWVsZExlbmd0aCgpDQo+ICAgICAgICBnZXRNYXhCdWZmZXJlZERvY3MoKQ0KPiAgICAgICAgZ2V0
TWF4TWVyZ2VEb2NzKCkNCj4gICAgICAgIGdldFJBTUJ1ZmZlclNpemVNQigpDQo+DQo+IEhvdyBv
ZnRlbiBhcmUgeW91IGNhbGxpbmcgY29tbWl0Pw0KPiBEbyB5b3UgY2xvc2UgeW91ciBJbmRleFdy
aXRlciBhZnRlciBldmVyeSBkb2N1bWVudD8NCj4gSG93IG1hbnkgZG9jdW1lbnRzIG9mIHRoaXMg
c2l6ZSBhcmUgeW91IGluZGV4aW5nPw0KPiBIYXZlIHlvdSB1c2VkIGx1a2UgdG8gbG9vayBhdCB5
b3VyIGluZGV4Pw0KPiBJZiB0aGlzIGlzIGEgbGFyZ2UgaW5kZXgsIGhhdmUgeW91IG9wdGltaXpl
ZCBpdCByZWNlbnRseT8NCj4gQXJlIHRoZXJlIGFueSBzZWFyY2hlcyBnb2luZyBvbiB3aGlsZSB5
b3UgYXJlIGluZGV4aW5nPw0KPg0KPg0KPiBSZWdhcmRzLA0KPiBEYW4NCj4NCj4NCj4gLS0tLS1P
cmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogUGF1bF9NdXJkb2NoQGVtYWluYy5jb20gW21h
aWx0bzpQYXVsX011cmRvY2hAZW1haW5jLmNvbV0NCj4gU2VudDogRnJpZGF5LCBTZXB0ZW1iZXIg
MTEsIDIwMDkgNzo1NyBBTQ0KPiBUbzogamF2YS11c2VyQGx1Y2VuZS5hcGFjaGUub3JnDQo+IFN1
YmplY3Q6IFJFOiBJbmRleGluZyBsYXJnZSBmaWxlcz8gLSBObyBhbnN3ZXJzIHlldC4uLg0KPg0K
PiBUaGlzIGlzc3VlIGlzIHN0aWxsIG9wZW4uICBBbnkgc3VnZ2VzdGlvbnMvaGVscCB3aXRoIHRo
aXMgd291bGQgYmUNCj4gZ3JlYXRseSBhcHByZWNpYXRlZC4NCj4NCj4gVGhhbmtzLA0KPg0KPiBQ
YXVsDQo+DQo+DQo+IC0tLS0tT3JpZ2luYWwgTWVzc2FnZS0tLS0tDQo+IEZyb206IGphdmEtdXNl
ci1yZXR1cm4tNDIwODAtUGF1bF9NdXJkb2NoPWVtYWluYy5jb21AbHVjZW5lLmFwYWNoZS5vcmcN
Cj4gW21haWx0bzpqYXZhLXVzZXItcmV0dXJuLTQyMDgwLVBhdWxfTXVyZG9jaD1lbWFpbmMuY29t
QGx1Y2VuZS5hcGFjaGUub3JnDQo+IF0gT24gQmVoYWxmIE9mIFBhdWxfTXVyZG9jaEBlbWFpbmMu
Y29tDQo+IFNlbnQ6IE1vbmRheSwgQXVndXN0IDMxLCAyMDA5IDEwOjI4IEFNDQo+IFRvOiBqYXZh
LXVzZXJAbHVjZW5lLmFwYWNoZS5vcmcNCj4gU3ViamVjdDogSW5kZXhpbmcgbGFyZ2UgZmlsZXM/
DQo+DQo+IEhpLA0KPg0KPg0KPg0KPiBJJ20gd29ya2luZyB3aXRoIEx1Y2VuZSAyLjQuMCBhbmQg
dGhlIEpWTSAoSkRLIDEuNi4wXzA3KS4gIEknbQ0KPiBjb25zaXN0ZW50bHkgcmVjZWl2aW5nICJP
dXRPZk1lbW9yeUVycm9yOiBKYXZhIGhlYXAgc3BhY2UiLCB3aGVuIHRyeWluZw0KPiB0byBpbmRl
eCBsYXJnZSB0ZXh0IGZpbGVzLg0KPg0KPg0KPg0KPiBFeGFtcGxlIDE6IEluZGV4aW5nIGEgNSBN
QiB0ZXh0IGZpbGUgcnVucyBvdXQgb2YgbWVtb3J5IHdpdGggYSAxNiBNQg0KPiBtYXguIGhlYXAg
c2l6ZS4gIFNvIEkgaW5jcmVhc2VkIHRoZSBtYXguIGhlYXAgc2l6ZSB0byA1MTIgTUIuICBUaGlz
DQo+IHdvcmtlZCBmb3IgdGhlIDUgTUIgdGV4dCBmaWxlLCBidXQgTHVjZW5lIHN0aWxsIHVzZWQg
ODQgTUIgb2YgaGVhcCBzcGFjZQ0KPiB0byBkbyB0aGlzLiAgV2h5IHNvIG11Y2g/DQo+DQo+DQo+
DQo+IFRoZSBjbGFzcyBGcmVxUHJveFRlcm1zV3JpdGVyUGVyRmllbGQgYXBwZWFycyB0byBiZSB0
aGUgYmlnZ2VzdCBtZW1vcnkNCj4gY29uc3VtZXIgYnkgZmFyIGFjY29yZGluZyB0byBKQ29uc29s
ZSBhbmQgdGhlIFRQVFAgTWVtb3J5IFByb2ZpbGluZw0KPiBwbHVnaW4gZm9yIEVjbGlwc2UgR2Fu
eW1lZGUuDQo+DQo+DQo+DQo+IEV4YW1wbGUgMjogSW5kZXhpbmcgYSA2MiBNQiB0ZXh0IGZpbGUg
cnVucyBvdXQgb2YgbWVtb3J5IHdpdGggYSA1MTIgTUINCj4gbWF4LiBoZWFwIHNpemUuICBJbmNy
ZWFzaW5nIHRoZSBtYXguIGhlYXAgc2l6ZSB0byAxMDI0IE1CIHdvcmtzIGJ1dA0KPiBMdWNlbmUg
dXNlcyA4MjYgTUIgb2YgaGVhcCBzcGFjZSB3aGlsZSBwZXJmb3JtaW5nIHRoaXMuICBTdGlsbCBz
ZWVtcw0KPiBsaWtlIHdheSB0b28gbXVjaCBtZW1vcnkgaXMgYmVpbmcgdXNlZCB0byBkbyB0aGlz
LiAgSSdtIHN1cmUgbGFyZ2VyDQo+IGZpbGVzIHdvdWxkIGNhdXNlIHRoZSBlcnJvciBhcyBpdCBz
ZWVtcyBjb3JyZWxhdGl2ZS4NCj4NCj4NCj4NCj4gSSdtIG9uIGEgV2luZG93cyBYUCBTUDIgcGxh
dGZvcm0gd2l0aCAyIEdCIG9mIFJBTS4gIFNvIHdoYXQgaXMgdGhlIGJlc3QNCj4gcHJhY3RpY2Ug
Zm9yIGluZGV4aW5nIGxhcmdlIGZpbGVzPyAgSGVyZSBpcyBhIGNvZGUgc25pcHBldCB0aGF0IEkn
bQ0KPiB1c2luZzoNCj4NCj4NCj4NCj4gLy8gSW5kZXggdGhlIGNvbnRlbnQgb2YgYSB0ZXh0IGZp
bGUuDQo+DQo+ICAgICAgcHJpdmF0ZSBCb29sZWFuIHNhdmVUWFRGaWxlKEZpbGUgdGV4dEZpbGUs
IERvY3VtZW50IHRleHREb2N1bWVudCkNCj4gdGhyb3dzIENJREJFeGNlcHRpb24gew0KPg0KPg0K
Pg0KPiAgICAgICAgICAgIHRyeSB7DQo+DQo+DQo+DQo+ICAgICAgICAgICAgICAgICAgQm9vbGVh
biBpc0ZpbGUgPSB0ZXh0RmlsZS5pc0ZpbGUoKTsNCj4NCj4gICAgICAgICAgICAgICAgICBCb29s
ZWFuIGhhc1RleHRFeHRlbnNpb24gPQ0KPiB0ZXh0RmlsZS5nZXROYW1lKCkuZW5kc1dpdGgoIi50
eHQiKTsNCj4NCj4NCj4NCj4gICAgICAgICAgICAgICAgICBpZiAoaXNGaWxlICYmIGhhc1RleHRF
eHRlbnNpb24pIHsNCj4NCj4NCj4NCj4gICAgICAgICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0
LnByaW50bG4oIkZpbGUgIiArDQo+IHRleHRGaWxlLmdldENhbm9uaWNhbFBhdGgoKSArICIgaXMg
YmVpbmcgaW5kZXhlZCIpOw0KPg0KPiAgICAgICAgICAgICAgICAgICAgICAgIFJlYWRlciB0ZXh0
RmlsZVJlYWRlciA9IG5ldw0KPiBGaWxlUmVhZGVyKHRleHRGaWxlKTsNCj4NCj4gICAgICAgICAg
ICAgICAgICAgICAgICBpZiAodGV4dERvY3VtZW50ID09IG51bGwpDQo+DQo+ICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdGV4dERvY3VtZW50ID0gbmV3IERvY3VtZW50KCk7DQo+DQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgdGV4dERvY3VtZW50LmFkZChuZXcgRmllbGQoImNvbnRlbnQi
LA0KPiB0ZXh0RmlsZVJlYWRlcikpOw0KPg0KPiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4
V3JpdGVyLmFkZERvY3VtZW50KHRleHREb2N1bWVudCk7DQo+IC8vIEJSRUFLUyBIRVJFISEhIQ0K
Pg0KPiAgICAgICAgICAgICAgICAgIH0NCj4NCj4gICAgICAgICAgICB9IGNhdGNoIChGaWxlTm90
Rm91bmRFeGNlcHRpb24gZm5mZSkgew0KPg0KPiAgICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQu
cHJpbnRsbihmbmZlLmdldE1lc3NhZ2UoKSk7DQo+DQo+ICAgICAgICAgICAgICAgICAgcmV0dXJu
IGZhbHNlOw0KPg0KPiAgICAgICAgICAgIH0gY2F0Y2ggKENvcnJ1cHRJbmRleEV4Y2VwdGlvbiBj
aWUpIHsNCj4NCj4gICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ0lEQkV4Y2VwdGlvbigiVGhl
IGluZGV4IGhhcyBiZWNvbWUNCj4gY29ycnVwdC4iKTsNCj4NCj4gICAgICAgICAgICB9IGNhdGNo
IChJT0V4Y2VwdGlvbiBpb2UpIHsNCj4NCj4gICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnBy
aW50bG4oaW9lLmdldE1lc3NhZ2UoKSk7DQo+DQo+ICAgICAgICAgICAgICAgICAgcmV0dXJuIGZh
bHNlOw0KPg0KPiAgICAgICAgICAgIH0NCj4NCj4gICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCj4N
Cj4gICAgICB9DQo+DQo+DQo+DQo+DQo+DQo+IFRoYW5rcyBtdWNoLA0KPg0KPg0KPg0KPiBQYXVs
DQo+DQo+DQo+DQo+DQo+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KPiBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBq
YXZhLXVzZXItdW5zdWJzY3JpYmVAbHVjZW5lLmFwYWNoZS5vcmcNCj4gRm9yIGFkZGl0aW9uYWwg
Y29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNoZS5vcmcNCj4NCj4N
Cj4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tDQo+IFRvIHVuc3Vic2NyaWJlLCBlLW1haWw6IGphdmEtdXNlci11bnN1
YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZw0KPiBGb3IgYWRkaXRpb25hbCBjb21tYW5kcywgZS1t
YWlsOiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZw0KPg0KPg0KDQoNCg0KLS0gDQoN
Ci0NCg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tDQpUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5z
dWJzY3JpYmVAbHVjZW5lLmFwYWNoZS5vcmcNCkZvciBhZGRpdGlvbmFsIGNvbW1hbmRzLCBlLW1h
aWw6IGphdmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnDQoNCg==


From java-user-return-42277-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 14:44:10 2009
Return-Path: <java-user-return-42277-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71551 invoked from network); 11 Sep 2009 14:44:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 14:44:10 -0000
Received: (qmail 55821 invoked by uid 500); 11 Sep 2009 14:44:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55749 invoked by uid 500); 11 Sep 2009 14:44:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55739 invoked by uid 99); 11 Sep 2009 14:44:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:44:08 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of glen.newton@gmail.com designates 209.85.132.249 as permitted sender)
Received: from [209.85.132.249] (HELO an-out-0708.google.com) (209.85.132.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:44:00 +0000
Received: by an-out-0708.google.com with SMTP id b2so374170ana.5
        for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 07:43:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=VfSfMPkdwCleIlVwseJgEm/WRpH6hTxoDnfPIAcK0J4=;
        b=tfZ3kGdDA+PmAk56MTc5eMrf6lVD6zPYddwErV5qRAjW+WC2zueGoJQ95rpf1dTD8S
         mLVWyusPXo8N1WIvrT5h/YXBYWFr/hal/MQ/sn4HiPQdO2Sjk1YbPIBTQYj8mU5xkVLZ
         uQw2sN32uyNlZwVOQkocpra6+Cs/dpj5ZGJIo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=J2j4szy3e3gzpiSzVUG5NohDArgVq/i7rhvKLp9tSm2iu0asMdK7jZ6PdFDO8I/eLL
         /j5QhoCxCJV4F8G/KDQYX+pbWGuD5sK6WMkqCN/gLmZLg2l64PGueZGvlJC74ok/etkX
         I4BKz5PnNQZu04FmmzA5+LsOOHoLI0Q0G/emA=
MIME-Version: 1.0
Received: by 10.101.27.20 with SMTP id e20mr3266668anj.137.1252680219137; Fri, 
	11 Sep 2009 07:43:39 -0700 (PDT)
In-Reply-To: <5B20DEF02611534DB08854076CE825D803626596@sc1exc2.corp.emainc.com>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
	 <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>
	 <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
	 <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
	 <5B20DEF02611534DB08854076CE825D803626596@sc1exc2.corp.emainc.com>
Date: Fri, 11 Sep 2009 10:43:39 -0400
Message-ID: <5e76f3840909110743tc68b087mbde5a05883e95eed@mail.gmail.com>
Subject: Re: Indexing large files? - No answers yet...
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Paul,

I saw your last post and now understand the issues you face.

I don't think there has been any effort to produce a
reduced-memory-footprint configurable (RMFC) Lucene. With the many
mobile devices, embedded and other reduced memory devices, should this
perhaps be one of the areas the Lucene community looks in to?

-Glen

2009/9/11  <Paul_Murdoch@emainc.com>:
> Thanks Glen!
>
> I will take at your project.  Unfortunately I will only have 512 MB to 10=
24 MB to work with as Lucene is only one component in a larger software sys=
tem running on one machine.  I agree with you on the C\C++ comment.  That i=
s what I would normally use for memory intense software.  It turns out that=
 the larger file you want to index is the larger the heap space you will ne=
ed.  What I would like to see is a way to "throttle" the indexing process t=
o control the memory footprint.  I understand that this will take longer, b=
ut if I perform the task during off hours it shouldn't matter. At least the=
 file will be indexed correctly.
>
> Thanks,
> Paul
>
>
> -----Original Message-----
> From: java-user-return-42272-Paul_Murdoch=3Demainc.com@lucene.apache.org =
[mailto:java-user-return-42272-Paul_Murdoch=3Demainc.com@lucene.apache.org]=
 On Behalf Of Glen Newton
> Sent: Friday, September 11, 2009 9:53 AM
> To: java-user@lucene.apache.org
> Subject: Re: Indexing large files? - No answers yet...
>
> In this project:
>  http://zzzoot.blogspot.com/2009/07/project-torngat-building-large-scale.=
html
>
> I concatenate all the text of all of articles of a single journal into
> a single text file.
> This can create a text file that is 500MB in size.
> Lucene is OK in indexing files this size (in parallel even), but I
> have a heap size of 8GB.
>
> I would suggest increasing your heap to as large as your machine can
> reasonably take.
> The reality is that Java programs (like Lucene) take up more memory
> than a similar C or even C++ program.
> Java may approach C/C++ in speed, but not memory.
>
> We don't use Java because of its memory footprint!  ;-)
>
> See:
>  Programming language shootout: speed:
> http://shootout.alioth.debian.org/u32q/benchmark.php?test=3Dall&lang=3Dal=
l&d=3Dndata&calc=3Dcalculate&xfullcpu=3D1&xmem=3D0&xloc=3D0&binarytrees=3D1=
&chameneosredux=3D1&fannkuch=3D1&fasta=3D1&knucleotide=3D1&mandelbrot=3D1&m=
eteor=3D0&nbody=3D1&pidigits=3D1&regexdna=3D1&revcomp=3D1&spectralnorm=3D1&=
threadring=3D0
>  Programming language shootout: memory:
> http://shootout.alioth.debian.org/u32q/benchmark.php?test=3Dall&lang=3Dal=
l&d=3Dndata&calc=3Dcalculate&xfullcpu=3D0&xmem=3D1&xloc=3D0&binarytrees=3D1=
&chameneosredux=3D1&fannkuch=3D1&fasta=3D1&knucleotide=3D1&mandelbrot=3D1&m=
eteor=3D0&nbody=3D1&pidigits=3D1&regexdna=3D1&revcomp=3D1&spectralnorm=3D1&=
threadring=3D0
>
> -glen
>
> 2009/9/11 Dan OConnor <doconnor@acquiremedia.com>:
>> Paul:
>>
>> My first suggestion would be to update your JVM to the latest version (o=
r at least .14). There were several garbage collection related issues resol=
ved in version 10 - 13 (especially dealing with large heaps).
>>
>> Next, your IndexWriter parameters would help figure out why you are usin=
g so much RAM
>>        getMaxFieldLength()
>>        getMaxBufferedDocs()
>>        getMaxMergeDocs()
>>        getRAMBufferSizeMB()
>>
>> How often are you calling commit?
>> Do you close your IndexWriter after every document?
>> How many documents of this size are you indexing?
>> Have you used luke to look at your index?
>> If this is a large index, have you optimized it recently?
>> Are there any searches going on while you are indexing?
>>
>>
>> Regards,
>> Dan
>>
>>
>> -----Original Message-----
>> From: Paul_Murdoch@emainc.com [mailto:Paul_Murdoch@emainc.com]
>> Sent: Friday, September 11, 2009 7:57 AM
>> To: java-user@lucene.apache.org
>> Subject: RE: Indexing large files? - No answers yet...
>>
>> This issue is still open.  Any suggestions/help with this would be
>> greatly appreciated.
>>
>> Thanks,
>>
>> Paul
>>
>>
>> -----Original Message-----
>> From: java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.org
>> [mailto:java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.o=
rg
>> ] On Behalf Of Paul_Murdoch@emainc.com
>> Sent: Monday, August 31, 2009 10:28 AM
>> To: java-user@lucene.apache.org
>> Subject: Indexing large files?
>>
>> Hi,
>>
>>
>>
>> I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07).  I'm
>> consistently receiving "OutOfMemoryError: Java heap space", when trying
>> to index large text files.
>>
>>
>>
>> Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
>> max. heap size.  So I increased the max. heap size to 512 MB.  This
>> worked for the 5 MB text file, but Lucene still used 84 MB of heap space
>> to do this.  Why so much?
>>
>>
>>
>> The class FreqProxTermsWriterPerField appears to be the biggest memory
>> consumer by far according to JConsole and the TPTP Memory Profiling
>> plugin for Eclipse Ganymede.
>>
>>
>>
>> Example 2: Indexing a 62 MB text file runs out of memory with a 512 MB
>> max. heap size.  Increasing the max. heap size to 1024 MB works but
>> Lucene uses 826 MB of heap space while performing this.  Still seems
>> like way too much memory is being used to do this.  I'm sure larger
>> files would cause the error as it seems correlative.
>>
>>
>>
>> I'm on a Windows XP SP2 platform with 2 GB of RAM.  So what is the best
>> practice for indexing large files?  Here is a code snippet that I'm
>> using:
>>
>>
>>
>> // Index the content of a text file.
>>
>>      private Boolean saveTXTFile(File textFile, Document textDocument)
>> throws CIDBException {
>>
>>
>>
>>            try {
>>
>>
>>
>>                  Boolean isFile =3D textFile.isFile();
>>
>>                  Boolean hasTextExtension =3D
>> textFile.getName().endsWith(".txt");
>>
>>
>>
>>                  if (isFile && hasTextExtension) {
>>
>>
>>
>>                        System.out.println("File " +
>> textFile.getCanonicalPath() + " is being indexed");
>>
>>                        Reader textFileReader =3D new
>> FileReader(textFile);
>>
>>                        if (textDocument =3D=3D null)
>>
>>                              textDocument =3D new Document();
>>
>>                        textDocument.add(new Field("content",
>> textFileReader));
>>
>>                        indexWriter.addDocument(textDocument);
>> // BREAKS HERE!!!!
>>
>>                  }
>>
>>            } catch (FileNotFoundException fnfe) {
>>
>>                  System.out.println(fnfe.getMessage());
>>
>>                  return false;
>>
>>            } catch (CorruptIndexException cie) {
>>
>>                  throw new CIDBException("The index has become
>> corrupt.");
>>
>>            } catch (IOException ioe) {
>>
>>                  System.out.println(ioe.getMessage());
>>
>>                  return false;
>>
>>            }
>>
>>            return true;
>>
>>      }
>>
>>
>>
>>
>>
>> Thanks much,
>>
>>
>>
>> Paul
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
>
> -
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42278-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 14:48:31 2009
Return-Path: <java-user-return-42278-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72692 invoked from network); 11 Sep 2009 14:48:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 14:48:31 -0000
Received: (qmail 67797 invoked by uid 500); 11 Sep 2009 14:48:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67733 invoked by uid 500); 11 Sep 2009 14:48:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67723 invoked by uid 99); 11 Sep 2009 14:48:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 14:48:28 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.82.104.142] (HELO web24716.mail.ird.yahoo.com) (212.82.104.142)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 11 Sep 2009 14:48:16 +0000
Received: (qmail 61798 invoked by uid 60001); 11 Sep 2009 14:47:54 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1252680474; bh=q0U55Vc+0p+zhZq5XCsJ9OmNILuwHYX7UorpTwzeAzs=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=CAm8EderNPAFzbLE2LlLrKYLODZJRz1Zw6hXOl0N2CvofwKHDBSIC1Q8+Nx6in8HGSdv5FDo1zTIi3qzSiHj4gGhP58X31MJHyh+ltD/UIU7mfXIm1Ojjo37RG+aJAaivzvMw2ndNWLwDLvFKPXquryRYUlv96lGlybO0IBwakQ=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=xviySgWwXJ6Ad2Eny4gMwDjC9Uhcr7f7cbgBykjtcWMbXpq/ZLVMmE5WzJbnCa61TsC2aQw9nOleF29Lq7RKELwGngx9J6wyv5VHSiW26B1Mw0pJkVmsNkRbSUa99e7Fcg9flxAA6ztE1iVwp9rtpomQyfotfYJDtM+RaL+fS0c=;
Message-ID: <150550.61727.qm@web24716.mail.ird.yahoo.com>
X-YMail-OSG: Duc.QlAVM1nlO4v7fPnJ29mTgExE.gLrCuQ5HK_J.fDnQEH_nXRSvL1QhW1ToPGNO30FD_TAXue0FsMpUfz2Pw4qT0kLmmSmxrV.lsuofueWFOfdXiysfMmStNLha75ZCBxHh9U6kwlppM.buLEDV5b4zRCVVgWWI5iZiU8xaWbGE6i7Fz_BQEan91hgZkLz7F1LCeaMJew9JfmgR4Gpa.omrM13vEN_eQMC8FHm4sWtS8ot_eSNFcIXF0wtcCYNG5QXLUhlkl3MyGqmYJTGgmyuXV6_5lkJ6C1Q0NPQgbK0ZYrskh0mxwpJmW8KYxFkvqwkxzxQjA--
Received: from [193.36.230.96] by web24716.mail.ird.yahoo.com via HTTP; Fri, 11 Sep 2009 14:47:54 GMT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.338.2
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>  <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>  <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com> <4AAA5DE8.9070200@lexum.umontreal.ca> <6447E7C4AFD04DD4A58932257C06AC39@VEGA>
Date: Fri, 11 Sep 2009 14:47:54 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Stopping a runaway search, any ideas?
To: java-user@lucene.apache.org
In-Reply-To: <6447E7C4AFD04DD4A58932257C06AC39@VEGA>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Or https://issues.apache.org/jira/browse/LUCENE-1720 offers lightweight tim=
eout testing at all index access stages prior to calls to Collector e.g. wi=
ll catch a runaway fuzzy query during it's expensive term expansion phase.=
=0A=0A=0A=0A----- Original Message ----=0AFrom: Uwe Schindler <uwe@thetaphi=
.de>=0ATo: java-user@lucene.apache.org=0ASent: Friday, 11 September, 2009 1=
5:33:19=0ASubject: RE: Stopping a runaway search, any ideas?=0A=0AYes: Time=
LimitedCollector in 2.4.1 (and the new non-deprecated ones in 2.9).=0AJust =
wrap your own collector (like TopDocsCollector) with this class.=0A=0A-----=
=0AUwe Schindler=0AH.-H.-Meier-Allee 63, D-28213 Bremen=0Ahttp://www.thetap=
hi.de=0AeMail: uwe@thetaphi.de=0A=0A> -----Original Message-----=0A> From: =
Daniel Shane [mailto:shaned@LEXUM.UMontreal.CA]=0A> Sent: Friday, September=
 11, 2009 4:26 PM=0A> To: java-user@lucene.apache.org=0A> Subject: Stopping=
 a runaway search, any ideas?=0A> =0A> I don't think its possible, but is t=
here something in lucene to cap a=0A> search to a predefined time length or=
 is there a way to stop a search=0A> when its running for too long?=0A> =0A=
> Daniel Shane=0A> =0A> =0A> ----------------------------------------------=
-----------------------=0A> To unsubscribe, e-mail: java-user-unsubscribe@l=
ucene.apache.org=0A> For additional commands, e-mail: java-user-help@lucene=
.apache.org=0A=0A=0A=0A----------------------------------------------------=
-----------------=0ATo unsubscribe, e-mail: java-user-unsubscribe@lucene.ap=
ache.org=0AFor additional commands, e-mail: java-user-help@lucene.apache.or=
g=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42279-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 15:04:14 2009
Return-Path: <java-user-return-42279-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80122 invoked from network); 11 Sep 2009 15:04:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 15:04:13 -0000
Received: (qmail 4997 invoked by uid 500); 11 Sep 2009 15:04:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4932 invoked by uid 500); 11 Sep 2009 15:04:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4922 invoked by uid 99); 11 Sep 2009 15:04:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:04:10 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [149.8.64.32] (HELO mclmx2.mail.saic.com) (149.8.64.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:03:59 +0000
Received: from 0015-its-sbg03.saic.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-10257760 for java-user@lucene.apache.org; Fri, 11 Sep 2009 11:03:25 -0400
X-AuditID: 95084018-b7bdbae000005fc6-4d-4aaa66bd01ce
Received: from mclmx2.mail.saic.com (mcl-sixl-nat.saic.com [149.8.64.21])
	by  (Symantec Brightmail Gateway) with SMTP id 62.E3.24518.DB66AAA4; Fri, 11 Sep 2009 11:03:25 -0400 (EDT)
Received: from sc2xfe1.emainc.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-1826229 for java-user@lucene.apache.org; Fri, 11 Sep 2009 11:03:25 -0400
Received: from sc1exc2.corp.emainc.com ([10.36.152.47]) by sc2xfe1.emainc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 11 Sep 2009 11:06:40 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: base64
Subject: RE: Indexing large files? - No answers yet...
Date: Fri, 11 Sep 2009 11:02:15 -0400
Message-Id: <5B20DEF02611534DB08854076CE825D80362667B@sc1exc2.corp.emainc.com>
In-Reply-To: <5e76f3840909110743tc68b087mbde5a05883e95eed@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Indexing large files? - No answers yet...
Thread-Index: Acoy7sp+bOat/BxLQh2Ch8MtzthLCgAACquw
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com> <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com> <5B20DEF02611534DB08854076CE825D803626596@sc1exc2.corp.emainc.com> <5e76f3840909110743tc68b087mbde5a05883e95eed@mail.gmail.com>
From: <Paul_Murdoch@emainc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 11 Sep 2009 15:06:40.0188 (UTC) FILETIME=[7733EFC0:01CA32F1]
X-Brightmail-Tracker: AAAAAA==
X-Virus-Checked: Checked by ClamAV on apache.org

R2xlbiwNCg0KQWJzb2x1dGVseS4gSSB0aGluayBhIFJNRkMgTHVjZW5lIHdvdWxkIGdyZWF0LCBl
c3BlY2lhbGx5IGZvciByZWR1Y2VkIG1lbW9yeSBvciBsb3cgYmFuZHdpZHRoIGNsaWVudC9zZXJ2
ZXIgc2NlbmFyaW9zLiANCg0KSSBqdXN0IGxvb2tlZCBhdCB5b3VyIEx1U3FsIHRvb2wgYW5kIGl0
IGp1c3Qgd2hhdCBJIG5lZWRlZCBhYm91dCA5IG1vbnRocyBhZ28gOi0pLiAgSSB3cm90ZSBhIHNp
bXBsZSByZS1pbmRleGVyIHRoYXQgaW50ZXJmYWNlcyB0byBhbiBTUUwgU2VydmVyIDIwMDUgZGF0
YWJhc2UgYW5kIEx1Y2VuZSwgYnV0IEkgY291bGQgaGF2ZSBzYXZlZCBzb21lIHRpbWUgaWYgSSBr
bmV3IGFib3V0IEx1U3FsLiAgVW5mb3J0dW5hdGVseSB3ZSdyZSB0b28gZmFyIGRvd24gdGhlIHJv
YWQgaW4gZGV2ZWxvcG1lbnQgdG8gdGVzdCBhbmQgcG9zc2libHkgaW50ZWdyYXRlIGl0IGludG8g
b3VyIHN5c3RlbSBub3csIGJ1dCBJIHdpbGwgcHV0IGl0IG9uIHRoZSBSJkQgbGlzdCBmb3IgdGhl
IG5leHQgaXRlcmF0aW9uLg0KDQpUaGFua3MgYWdhaW4sDQoNClBhdWwNCg0KDQotLS0tLU9yaWdp
bmFsIE1lc3NhZ2UtLS0tLQ0KRnJvbTogamF2YS11c2VyLXJldHVybi00MjI3Ny1QYXVsX011cmRv
Y2g9ZW1haW5jLmNvbUBsdWNlbmUuYXBhY2hlLm9yZyBbbWFpbHRvOmphdmEtdXNlci1yZXR1cm4t
NDIyNzctUGF1bF9NdXJkb2NoPWVtYWluYy5jb21AbHVjZW5lLmFwYWNoZS5vcmddIE9uIEJlaGFs
ZiBPZiBHbGVuIE5ld3Rvbg0KU2VudDogRnJpZGF5LCBTZXB0ZW1iZXIgMTEsIDIwMDkgMTA6NDQg
QU0NClRvOiBqYXZhLXVzZXJAbHVjZW5lLmFwYWNoZS5vcmcNClN1YmplY3Q6IFJlOiBJbmRleGlu
ZyBsYXJnZSBmaWxlcz8gLSBObyBhbnN3ZXJzIHlldC4uLg0KDQpQYXVsLA0KDQpJIHNhdyB5b3Vy
IGxhc3QgcG9zdCBhbmQgbm93IHVuZGVyc3RhbmQgdGhlIGlzc3VlcyB5b3UgZmFjZS4NCg0KSSBk
b24ndCB0aGluayB0aGVyZSBoYXMgYmVlbiBhbnkgZWZmb3J0IHRvIHByb2R1Y2UgYQ0KcmVkdWNl
ZC1tZW1vcnktZm9vdHByaW50IGNvbmZpZ3VyYWJsZSAoUk1GQykgTHVjZW5lLiBXaXRoIHRoZSBt
YW55DQptb2JpbGUgZGV2aWNlcywgZW1iZWRkZWQgYW5kIG90aGVyIHJlZHVjZWQgbWVtb3J5IGRl
dmljZXMsIHNob3VsZCB0aGlzDQpwZXJoYXBzIGJlIG9uZSBvZiB0aGUgYXJlYXMgdGhlIEx1Y2Vu
ZSBjb21tdW5pdHkgbG9va3MgaW4gdG8/DQoNCi1HbGVuDQoNCjIwMDkvOS8xMSAgPFBhdWxfTXVy
ZG9jaEBlbWFpbmMuY29tPjoNCj4gVGhhbmtzIEdsZW4hDQo+DQo+IEkgd2lsbCB0YWtlIGF0IHlv
dXIgcHJvamVjdC4gIFVuZm9ydHVuYXRlbHkgSSB3aWxsIG9ubHkgaGF2ZSA1MTIgTUIgdG8gMTAy
NCBNQiB0byB3b3JrIHdpdGggYXMgTHVjZW5lIGlzIG9ubHkgb25lIGNvbXBvbmVudCBpbiBhIGxh
cmdlciBzb2Z0d2FyZSBzeXN0ZW0gcnVubmluZyBvbiBvbmUgbWFjaGluZS4gIEkgYWdyZWUgd2l0
aCB5b3Ugb24gdGhlIENcQysrIGNvbW1lbnQuICBUaGF0IGlzIHdoYXQgSSB3b3VsZCBub3JtYWxs
eSB1c2UgZm9yIG1lbW9yeSBpbnRlbnNlIHNvZnR3YXJlLiAgSXQgdHVybnMgb3V0IHRoYXQgdGhl
IGxhcmdlciBmaWxlIHlvdSB3YW50IHRvIGluZGV4IGlzIHRoZSBsYXJnZXIgdGhlIGhlYXAgc3Bh
Y2UgeW91IHdpbGwgbmVlZC4gIFdoYXQgSSB3b3VsZCBsaWtlIHRvIHNlZSBpcyBhIHdheSB0byAi
dGhyb3R0bGUiIHRoZSBpbmRleGluZyBwcm9jZXNzIHRvIGNvbnRyb2wgdGhlIG1lbW9yeSBmb290
cHJpbnQuICBJIHVuZGVyc3RhbmQgdGhhdCB0aGlzIHdpbGwgdGFrZSBsb25nZXIsIGJ1dCBpZiBJ
IHBlcmZvcm0gdGhlIHRhc2sgZHVyaW5nIG9mZiBob3VycyBpdCBzaG91bGRuJ3QgbWF0dGVyLiBB
dCBsZWFzdCB0aGUgZmlsZSB3aWxsIGJlIGluZGV4ZWQgY29ycmVjdGx5Lg0KPg0KPiBUaGFua3Ms
DQo+IFBhdWwNCj4NCj4NCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogamF2
YS11c2VyLXJldHVybi00MjI3Mi1QYXVsX011cmRvY2g9ZW1haW5jLmNvbUBsdWNlbmUuYXBhY2hl
Lm9yZyBbbWFpbHRvOmphdmEtdXNlci1yZXR1cm4tNDIyNzItUGF1bF9NdXJkb2NoPWVtYWluYy5j
b21AbHVjZW5lLmFwYWNoZS5vcmddIE9uIEJlaGFsZiBPZiBHbGVuIE5ld3Rvbg0KPiBTZW50OiBG
cmlkYXksIFNlcHRlbWJlciAxMSwgMjAwOSA5OjUzIEFNDQo+IFRvOiBqYXZhLXVzZXJAbHVjZW5l
LmFwYWNoZS5vcmcNCj4gU3ViamVjdDogUmU6IEluZGV4aW5nIGxhcmdlIGZpbGVzPyAtIE5vIGFu
c3dlcnMgeWV0Li4uDQo+DQo+IEluIHRoaXMgcHJvamVjdDoNCj4gIGh0dHA6Ly96enpvb3QuYmxv
Z3Nwb3QuY29tLzIwMDkvMDcvcHJvamVjdC10b3JuZ2F0LWJ1aWxkaW5nLWxhcmdlLXNjYWxlLmh0
bWwNCj4NCj4gSSBjb25jYXRlbmF0ZSBhbGwgdGhlIHRleHQgb2YgYWxsIG9mIGFydGljbGVzIG9m
IGEgc2luZ2xlIGpvdXJuYWwgaW50bw0KPiBhIHNpbmdsZSB0ZXh0IGZpbGUuDQo+IFRoaXMgY2Fu
IGNyZWF0ZSBhIHRleHQgZmlsZSB0aGF0IGlzIDUwME1CIGluIHNpemUuDQo+IEx1Y2VuZSBpcyBP
SyBpbiBpbmRleGluZyBmaWxlcyB0aGlzIHNpemUgKGluIHBhcmFsbGVsIGV2ZW4pLCBidXQgSQ0K
PiBoYXZlIGEgaGVhcCBzaXplIG9mIDhHQi4NCj4NCj4gSSB3b3VsZCBzdWdnZXN0IGluY3JlYXNp
bmcgeW91ciBoZWFwIHRvIGFzIGxhcmdlIGFzIHlvdXIgbWFjaGluZSBjYW4NCj4gcmVhc29uYWJs
eSB0YWtlLg0KPiBUaGUgcmVhbGl0eSBpcyB0aGF0IEphdmEgcHJvZ3JhbXMgKGxpa2UgTHVjZW5l
KSB0YWtlIHVwIG1vcmUgbWVtb3J5DQo+IHRoYW4gYSBzaW1pbGFyIEMgb3IgZXZlbiBDKysgcHJv
Z3JhbS4NCj4gSmF2YSBtYXkgYXBwcm9hY2ggQy9DKysgaW4gc3BlZWQsIGJ1dCBub3QgbWVtb3J5
Lg0KPg0KPiBXZSBkb24ndCB1c2UgSmF2YSBiZWNhdXNlIG9mIGl0cyBtZW1vcnkgZm9vdHByaW50
ISAgOy0pDQo+DQo+IFNlZToNCj4gIFByb2dyYW1taW5nIGxhbmd1YWdlIHNob290b3V0OiBzcGVl
ZDoNCj4gaHR0cDovL3Nob290b3V0LmFsaW90aC5kZWJpYW4ub3JnL3UzMnEvYmVuY2htYXJrLnBo
cD90ZXN0PWFsbCZsYW5nPWFsbCZkPW5kYXRhJmNhbGM9Y2FsY3VsYXRlJnhmdWxsY3B1PTEmeG1l
bT0wJnhsb2M9MCZiaW5hcnl0cmVlcz0xJmNoYW1lbmVvc3JlZHV4PTEmZmFubmt1Y2g9MSZmYXN0
YT0xJmtudWNsZW90aWRlPTEmbWFuZGVsYnJvdD0xJm1ldGVvcj0wJm5ib2R5PTEmcGlkaWdpdHM9
MSZyZWdleGRuYT0xJnJldmNvbXA9MSZzcGVjdHJhbG5vcm09MSZ0aHJlYWRyaW5nPTANCj4gIFBy
b2dyYW1taW5nIGxhbmd1YWdlIHNob290b3V0OiBtZW1vcnk6DQo+IGh0dHA6Ly9zaG9vdG91dC5h
bGlvdGguZGViaWFuLm9yZy91MzJxL2JlbmNobWFyay5waHA/dGVzdD1hbGwmbGFuZz1hbGwmZD1u
ZGF0YSZjYWxjPWNhbGN1bGF0ZSZ4ZnVsbGNwdT0wJnhtZW09MSZ4bG9jPTAmYmluYXJ5dHJlZXM9
MSZjaGFtZW5lb3NyZWR1eD0xJmZhbm5rdWNoPTEmZmFzdGE9MSZrbnVjbGVvdGlkZT0xJm1hbmRl
bGJyb3Q9MSZtZXRlb3I9MCZuYm9keT0xJnBpZGlnaXRzPTEmcmVnZXhkbmE9MSZyZXZjb21wPTEm
c3BlY3RyYWxub3JtPTEmdGhyZWFkcmluZz0wDQo+DQo+IC1nbGVuDQo+DQo+IDIwMDkvOS8xMSBE
YW4gT0Nvbm5vciA8ZG9jb25ub3JAYWNxdWlyZW1lZGlhLmNvbT46DQo+PiBQYXVsOg0KPj4NCj4+
IE15IGZpcnN0IHN1Z2dlc3Rpb24gd291bGQgYmUgdG8gdXBkYXRlIHlvdXIgSlZNIHRvIHRoZSBs
YXRlc3QgdmVyc2lvbiAob3IgYXQgbGVhc3QgLjE0KS4gVGhlcmUgd2VyZSBzZXZlcmFsIGdhcmJh
Z2UgY29sbGVjdGlvbiByZWxhdGVkIGlzc3VlcyByZXNvbHZlZCBpbiB2ZXJzaW9uIDEwIC0gMTMg
KGVzcGVjaWFsbHkgZGVhbGluZyB3aXRoIGxhcmdlIGhlYXBzKS4NCj4+DQo+PiBOZXh0LCB5b3Vy
IEluZGV4V3JpdGVyIHBhcmFtZXRlcnMgd291bGQgaGVscCBmaWd1cmUgb3V0IHdoeSB5b3UgYXJl
IHVzaW5nIHNvIG11Y2ggUkFNDQo+PiAgICAgICAgZ2V0TWF4RmllbGRMZW5ndGgoKQ0KPj4gICAg
ICAgIGdldE1heEJ1ZmZlcmVkRG9jcygpDQo+PiAgICAgICAgZ2V0TWF4TWVyZ2VEb2NzKCkNCj4+
ICAgICAgICBnZXRSQU1CdWZmZXJTaXplTUIoKQ0KPj4NCj4+IEhvdyBvZnRlbiBhcmUgeW91IGNh
bGxpbmcgY29tbWl0Pw0KPj4gRG8geW91IGNsb3NlIHlvdXIgSW5kZXhXcml0ZXIgYWZ0ZXIgZXZl
cnkgZG9jdW1lbnQ/DQo+PiBIb3cgbWFueSBkb2N1bWVudHMgb2YgdGhpcyBzaXplIGFyZSB5b3Ug
aW5kZXhpbmc/DQo+PiBIYXZlIHlvdSB1c2VkIGx1a2UgdG8gbG9vayBhdCB5b3VyIGluZGV4Pw0K
Pj4gSWYgdGhpcyBpcyBhIGxhcmdlIGluZGV4LCBoYXZlIHlvdSBvcHRpbWl6ZWQgaXQgcmVjZW50
bHk/DQo+PiBBcmUgdGhlcmUgYW55IHNlYXJjaGVzIGdvaW5nIG9uIHdoaWxlIHlvdSBhcmUgaW5k
ZXhpbmc/DQo+Pg0KPj4NCj4+IFJlZ2FyZHMsDQo+PiBEYW4NCj4+DQo+Pg0KPj4gLS0tLS1Pcmln
aW5hbCBNZXNzYWdlLS0tLS0NCj4+IEZyb206IFBhdWxfTXVyZG9jaEBlbWFpbmMuY29tIFttYWls
dG86UGF1bF9NdXJkb2NoQGVtYWluYy5jb21dDQo+PiBTZW50OiBGcmlkYXksIFNlcHRlbWJlciAx
MSwgMjAwOSA3OjU3IEFNDQo+PiBUbzogamF2YS11c2VyQGx1Y2VuZS5hcGFjaGUub3JnDQo+PiBT
dWJqZWN0OiBSRTogSW5kZXhpbmcgbGFyZ2UgZmlsZXM/IC0gTm8gYW5zd2VycyB5ZXQuLi4NCj4+
DQo+PiBUaGlzIGlzc3VlIGlzIHN0aWxsIG9wZW4uICBBbnkgc3VnZ2VzdGlvbnMvaGVscCB3aXRo
IHRoaXMgd291bGQgYmUNCj4+IGdyZWF0bHkgYXBwcmVjaWF0ZWQuDQo+Pg0KPj4gVGhhbmtzLA0K
Pj4NCj4+IFBhdWwNCj4+DQo+Pg0KPj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4+IEZy
b206IGphdmEtdXNlci1yZXR1cm4tNDIwODAtUGF1bF9NdXJkb2NoPWVtYWluYy5jb21AbHVjZW5l
LmFwYWNoZS5vcmcNCj4+IFttYWlsdG86amF2YS11c2VyLXJldHVybi00MjA4MC1QYXVsX011cmRv
Y2g9ZW1haW5jLmNvbUBsdWNlbmUuYXBhY2hlLm9yZw0KPj4gXSBPbiBCZWhhbGYgT2YgUGF1bF9N
dXJkb2NoQGVtYWluYy5jb20NCj4+IFNlbnQ6IE1vbmRheSwgQXVndXN0IDMxLCAyMDA5IDEwOjI4
IEFNDQo+PiBUbzogamF2YS11c2VyQGx1Y2VuZS5hcGFjaGUub3JnDQo+PiBTdWJqZWN0OiBJbmRl
eGluZyBsYXJnZSBmaWxlcz8NCj4+DQo+PiBIaSwNCj4+DQo+Pg0KPj4NCj4+IEknbSB3b3JraW5n
IHdpdGggTHVjZW5lIDIuNC4wIGFuZCB0aGUgSlZNIChKREsgMS42LjBfMDcpLiAgSSdtDQo+PiBj
b25zaXN0ZW50bHkgcmVjZWl2aW5nICJPdXRPZk1lbW9yeUVycm9yOiBKYXZhIGhlYXAgc3BhY2Ui
LCB3aGVuIHRyeWluZw0KPj4gdG8gaW5kZXggbGFyZ2UgdGV4dCBmaWxlcy4NCj4+DQo+Pg0KPj4N
Cj4+IEV4YW1wbGUgMTogSW5kZXhpbmcgYSA1IE1CIHRleHQgZmlsZSBydW5zIG91dCBvZiBtZW1v
cnkgd2l0aCBhIDE2IE1CDQo+PiBtYXguIGhlYXAgc2l6ZS4gIFNvIEkgaW5jcmVhc2VkIHRoZSBt
YXguIGhlYXAgc2l6ZSB0byA1MTIgTUIuICBUaGlzDQo+PiB3b3JrZWQgZm9yIHRoZSA1IE1CIHRl
eHQgZmlsZSwgYnV0IEx1Y2VuZSBzdGlsbCB1c2VkIDg0IE1CIG9mIGhlYXAgc3BhY2UNCj4+IHRv
IGRvIHRoaXMuICBXaHkgc28gbXVjaD8NCj4+DQo+Pg0KPj4NCj4+IFRoZSBjbGFzcyBGcmVxUHJv
eFRlcm1zV3JpdGVyUGVyRmllbGQgYXBwZWFycyB0byBiZSB0aGUgYmlnZ2VzdCBtZW1vcnkNCj4+
IGNvbnN1bWVyIGJ5IGZhciBhY2NvcmRpbmcgdG8gSkNvbnNvbGUgYW5kIHRoZSBUUFRQIE1lbW9y
eSBQcm9maWxpbmcNCj4+IHBsdWdpbiBmb3IgRWNsaXBzZSBHYW55bWVkZS4NCj4+DQo+Pg0KPj4N
Cj4+IEV4YW1wbGUgMjogSW5kZXhpbmcgYSA2MiBNQiB0ZXh0IGZpbGUgcnVucyBvdXQgb2YgbWVt
b3J5IHdpdGggYSA1MTIgTUINCj4+IG1heC4gaGVhcCBzaXplLiAgSW5jcmVhc2luZyB0aGUgbWF4
LiBoZWFwIHNpemUgdG8gMTAyNCBNQiB3b3JrcyBidXQNCj4+IEx1Y2VuZSB1c2VzIDgyNiBNQiBv
ZiBoZWFwIHNwYWNlIHdoaWxlIHBlcmZvcm1pbmcgdGhpcy4gIFN0aWxsIHNlZW1zDQo+PiBsaWtl
IHdheSB0b28gbXVjaCBtZW1vcnkgaXMgYmVpbmcgdXNlZCB0byBkbyB0aGlzLiAgSSdtIHN1cmUg
bGFyZ2VyDQo+PiBmaWxlcyB3b3VsZCBjYXVzZSB0aGUgZXJyb3IgYXMgaXQgc2VlbXMgY29ycmVs
YXRpdmUuDQo+Pg0KPj4NCj4+DQo+PiBJJ20gb24gYSBXaW5kb3dzIFhQIFNQMiBwbGF0Zm9ybSB3
aXRoIDIgR0Igb2YgUkFNLiAgU28gd2hhdCBpcyB0aGUgYmVzdA0KPj4gcHJhY3RpY2UgZm9yIGlu
ZGV4aW5nIGxhcmdlIGZpbGVzPyAgSGVyZSBpcyBhIGNvZGUgc25pcHBldCB0aGF0IEknbQ0KPj4g
dXNpbmc6DQo+Pg0KPj4NCj4+DQo+PiAvLyBJbmRleCB0aGUgY29udGVudCBvZiBhIHRleHQgZmls
ZS4NCj4+DQo+PiAgICAgIHByaXZhdGUgQm9vbGVhbiBzYXZlVFhURmlsZShGaWxlIHRleHRGaWxl
LCBEb2N1bWVudCB0ZXh0RG9jdW1lbnQpDQo+PiB0aHJvd3MgQ0lEQkV4Y2VwdGlvbiB7DQo+Pg0K
Pj4NCj4+DQo+PiAgICAgICAgICAgIHRyeSB7DQo+Pg0KPj4NCj4+DQo+PiAgICAgICAgICAgICAg
ICAgIEJvb2xlYW4gaXNGaWxlID0gdGV4dEZpbGUuaXNGaWxlKCk7DQo+Pg0KPj4gICAgICAgICAg
ICAgICAgICBCb29sZWFuIGhhc1RleHRFeHRlbnNpb24gPQ0KPj4gdGV4dEZpbGUuZ2V0TmFtZSgp
LmVuZHNXaXRoKCIudHh0Iik7DQo+Pg0KPj4NCj4+DQo+PiAgICAgICAgICAgICAgICAgIGlmIChp
c0ZpbGUgJiYgaGFzVGV4dEV4dGVuc2lvbikgew0KPj4NCj4+DQo+Pg0KPj4gICAgICAgICAgICAg
ICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIkZpbGUgIiArDQo+PiB0ZXh0RmlsZS5nZXRD
YW5vbmljYWxQYXRoKCkgKyAiIGlzIGJlaW5nIGluZGV4ZWQiKTsNCj4+DQo+PiAgICAgICAgICAg
ICAgICAgICAgICAgIFJlYWRlciB0ZXh0RmlsZVJlYWRlciA9IG5ldw0KPj4gRmlsZVJlYWRlcih0
ZXh0RmlsZSk7DQo+Pg0KPj4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGV4dERvY3VtZW50
ID09IG51bGwpDQo+Pg0KPj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RG9jdW1l
bnQgPSBuZXcgRG9jdW1lbnQoKTsNCj4+DQo+PiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRE
b2N1bWVudC5hZGQobmV3IEZpZWxkKCJjb250ZW50IiwNCj4+IHRleHRGaWxlUmVhZGVyKSk7DQo+
Pg0KPj4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleFdyaXRlci5hZGREb2N1bWVudCh0ZXh0
RG9jdW1lbnQpOw0KPj4gLy8gQlJFQUtTIEhFUkUhISEhDQo+Pg0KPj4gICAgICAgICAgICAgICAg
ICB9DQo+Pg0KPj4gICAgICAgICAgICB9IGNhdGNoIChGaWxlTm90Rm91bmRFeGNlcHRpb24gZm5m
ZSkgew0KPj4NCj4+ICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKGZuZmUuZ2V0
TWVzc2FnZSgpKTsNCj4+DQo+PiAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCj4+DQo+
PiAgICAgICAgICAgIH0gY2F0Y2ggKENvcnJ1cHRJbmRleEV4Y2VwdGlvbiBjaWUpIHsNCj4+DQo+
PiAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBDSURCRXhjZXB0aW9uKCJUaGUgaW5kZXggaGFz
IGJlY29tZQ0KPj4gY29ycnVwdC4iKTsNCj4+DQo+PiAgICAgICAgICAgIH0gY2F0Y2ggKElPRXhj
ZXB0aW9uIGlvZSkgew0KPj4NCj4+ICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxu
KGlvZS5nZXRNZXNzYWdlKCkpOw0KPj4NCj4+ICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNl
Ow0KPj4NCj4+ICAgICAgICAgICAgfQ0KPj4NCj4+ICAgICAgICAgICAgcmV0dXJuIHRydWU7DQo+
Pg0KPj4gICAgICB9DQo+Pg0KPj4NCj4+DQo+Pg0KPj4NCj4+IFRoYW5rcyBtdWNoLA0KPj4NCj4+
DQo+Pg0KPj4gUGF1bA0KPj4NCj4+DQo+Pg0KPj4NCj4+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KPj4gVG8gdW5z
dWJzY3JpYmUsIGUtbWFpbDogamF2YS11c2VyLXVuc3Vic2NyaWJlQGx1Y2VuZS5hcGFjaGUub3Jn
DQo+PiBGb3IgYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWlsOiBqYXZhLXVzZXItaGVscEBsdWNl
bmUuYXBhY2hlLm9yZw0KPj4NCj4+DQo+PiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCj4+IFRvIHVuc3Vic2NyaWJl
LCBlLW1haWw6IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZw0KPj4gRm9y
IGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhlbHBAbHVjZW5lLmFwYWNo
ZS5vcmcNCj4+DQo+Pg0KPg0KPg0KPg0KPiAtLQ0KPg0KPiAtDQo+DQo+IC0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0K
PiBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVjZW5lLmFw
YWNoZS5vcmcNCj4gRm9yIGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhl
bHBAbHVjZW5lLmFwYWNoZS5vcmcNCj4NCj4NCg0KDQoNCi0tIA0KDQotDQoNCi0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LQ0KVG8gdW5zdWJzY3JpYmUsIGUtbWFpbDogamF2YS11c2VyLXVuc3Vic2NyaWJlQGx1Y2VuZS5h
cGFjaGUub3JnDQpGb3IgYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWlsOiBqYXZhLXVzZXItaGVs
cEBsdWNlbmUuYXBhY2hlLm9yZw0KDQo=


From java-user-return-42280-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 15:24:09 2009
Return-Path: <java-user-return-42280-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87461 invoked from network); 11 Sep 2009 15:24:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 15:24:09 -0000
Received: (qmail 41847 invoked by uid 500); 11 Sep 2009 15:24:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41745 invoked by uid 500); 11 Sep 2009 15:24:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41728 invoked by uid 99); 11 Sep 2009 15:24:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:24:07 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [132.204.246.22] (HELO pruche.dit.umontreal.ca) (132.204.246.22)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:23:56 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by pruche.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n8BFNXeF000307
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 11:23:33 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Fri, 11 Sep 2009 11:23:33 -0400
  id 0002737F.4AAA6B75.00003DA4
Message-ID: <4AAA6B75.80702@lexum.umontreal.ca>
Date: Fri, 11 Sep 2009 11:23:33 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Stopping a runaway search, any ideas?
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>  <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>  <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com> <4AAA5DE8.9070200@lexum.umontreal.ca> <6447E7C4AFD04DD4A58932257C06AC39@VEGA> <150550.61727.qm@web24716.mail.ird.yahoo.com>
In-Reply-To: <150550.61727.qm@web24716.mail.ird.yahoo.com>
Content-Type: multipart/alternative;
 boundary="------------050300000504040005040601"
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3360=0
X-Virus-Checked: Checked by ClamAV on apache.org

--------------050300000504040005040601
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

Wow thats exactly what I was looking for! In the mean time I'll use the 
time based collector.

Thanks Uwe and Mark for your help!
Daniel Shane

mark harwood wrote:
> Or https://issues.apache.org/jira/browse/LUCENE-1720 offers lightweight timeout testing at all index access stages prior to calls to Collector e.g. will catch a runaway fuzzy query during it's expensive term expansion phase.
>
>
>
> ----- Original Message ----
> From: Uwe Schindler <uwe@thetaphi.de>
> To: java-user@lucene.apache.org
> Sent: Friday, 11 September, 2009 15:33:19
> Subject: RE: Stopping a runaway search, any ideas?
>
> Yes: TimeLimitedCollector in 2.4.1 (and the new non-deprecated ones in 2.9).
> Just wrap your own collector (like TopDocsCollector) with this class.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>   
>> -----Original Message-----
>> From: Daniel Shane [mailto:shaned@LEXUM.UMontreal.CA]
>> Sent: Friday, September 11, 2009 4:26 PM
>> To: java-user@lucene.apache.org
>> Subject: Stopping a runaway search, any ideas?
>>
>> I don't think its possible, but is there something in lucene to cap a
>> search to a predefined time length or is there a way to stop a search
>> when its running for too long?
>>
>> Daniel Shane
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>       
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


--------------050300000504040005040601--

From java-user-return-42281-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 15:35:25 2009
Return-Path: <java-user-return-42281-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91924 invoked from network); 11 Sep 2009 15:35:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 15:35:25 -0000
Received: (qmail 57817 invoked by uid 500); 11 Sep 2009 15:35:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57778 invoked by uid 500); 11 Sep 2009 15:35:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57765 invoked by uid 99); 11 Sep 2009 15:35:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:35:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of isaacrc82@gmail.com designates 209.85.211.191 as permitted sender)
Received: from [209.85.211.191] (HELO mail-yw0-f191.google.com) (209.85.211.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:35:14 +0000
Received: by ywh29 with SMTP id 29so1804898ywh.23
        for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 08:34:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=VNexwfnMmI4HqwAz85v9xH4Lw9iu9E2M3UbNV4XVL9w=;
        b=Bcq3TBQNOIjHlBw1WN6XD0p1yg6pByWpvuwYQJHd0j7jXLEPA0eru+wPBLPB817/hO
         7Y+nslMq9Pr6otwAgjNQWbGGWF/75S2iodTf+zd7unEScQ+2lwJ8xTDbQUGgSmNv1ri8
         6E9c7BSyPG8xXRLMQfIYIMQnB9c58slgNF7Ik=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=NyqSy+fTiDloDfgLNpQ+9kIzYqGawLenTJdU++WLA49RfcaLDAIs9PpiOSAl7AXCTy
         xbjhrARQQ6xA9LMnH4QMOca1BNZBp8wMXgNMt97c64drgrqnI1kVDtRXlYGG/clXuN9J
         WtQtaMddoKg1/D+YAyYG1+WaOtiyzsNNjhOWA=
MIME-Version: 1.0
Received: by 10.101.33.9 with SMTP id l9mr3390722anj.98.1252683293834; Fri, 11 
	Sep 2009 08:34:53 -0700 (PDT)
Date: Fri, 11 Sep 2009 11:34:52 -0400
Message-ID: <bf1404350909110834k7f9e010fpde812c562061cad2@mail.gmail.com>
Subject: How to delete documents from an index and how to reset de remote 
	multisearcher so the deleted docs not being shown in the search results ???
From: Ariel <isaacrc82@gmail.com>
To: lucene user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi every body:
I am using lucene version 2.3.2 to index and search my documents.
The problem is that I have a remote search server implemented this way:
[code]
	    Searcher parallelSearcher;	
		try {
			parallelSearcher = new ParallelMultiSearcher(searchables);
		    parallelImpl = new RemoteSearchable(parallelSearcher);
			Naming.rebind(rmiUrlSearch, parallelImpl);
		} catch (RemoteException e) {
			log.error("ERROR" , e);
		} catch (MalformedURLException e) {
			log.error("ERROR" , e);
		} catch (IOException e) {
			log.error("ERROR" , e);
		}
[/code]
Then a client from another host connect to the search server to obtain
the search results. But when a document is deleted in the indexes in
the search server the deleted documents still appear in the search
results, the only way the deleted documents don't appear in the search
results is restarting the rmi in the search server.
Please could you help me to know what can I do to make that the
documents deleted don't appear in the search results when they are
deleted ???
I hope you can help me.
Regards
Ariel

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42282-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 15:50:50 2009
Return-Path: <java-user-return-42282-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95274 invoked from network); 11 Sep 2009 15:50:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 15:50:50 -0000
Received: (qmail 76232 invoked by uid 500); 11 Sep 2009 15:50:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76171 invoked by uid 500); 11 Sep 2009 15:50:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76161 invoked by uid 99); 11 Sep 2009 15:50:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:50:48 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [38.102.63.181] (HELO smtp-2.01.com) (38.102.63.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:50:37 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by smtp-2.01.com (Postfix) with ESMTP id 4E9131ADA72
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 10:50:16 -0500 (CDT)
Received: from smtp-2.01.com ([127.0.0.1])
	by localhost (smtp-2.01.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id k0lW3T5-yBYE for <java-user@lucene.apache.org>;
	Fri, 11 Sep 2009 10:50:16 -0500 (CDT)
Received: from [192.168.17.7] (unknown [216.2.21.34])
	by smtp-2.01.com (Postfix) with ESMTP id EB0EC1ADA5C
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 10:50:11 -0500 (CDT)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1076)
Subject: Re: Indexing large files? - No answers yet...
From: Brian Pinkerton <brian.pinkerton@lucidimagination.com>
In-Reply-To: <5e76f3840909110743tc68b087mbde5a05883e95eed@mail.gmail.com>
Date: Fri, 11 Sep 2009 08:50:10 -0700
Content-Transfer-Encoding: 7bit
Message-Id: <92672921-D69B-4B85-86BF-F2B3AE8AC5AD@lucidimagination.com>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com> <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com> <5B20DEF02611534DB08854076CE825D803626596@sc1exc2.corp.emainc.com> <5e76f3840909110743tc68b087mbde5a05883e95eed@mail.gmail.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1076)
X-Virus-Checked: Checked by ClamAV on apache.org

Quite possibly, but shouldn't one expect Lucene's resource to track  
the size of the problem in question?     Paul's two examples below use  
input files of 5 and 62MB, hardly the size of input I'd expect to  
handle in a memory-compromised environment.

bri

On Sep 11, 2009, at 7:43 AM, Glen Newton wrote:

> Paul,
>
> I saw your last post and now understand the issues you face.
>
> I don't think there has been any effort to produce a
> reduced-memory-footprint configurable (RMFC) Lucene. With the many
> mobile devices, embedded and other reduced memory devices, should this
> perhaps be one of the areas the Lucene community looks in to?
>
> -Glen
>
> 2009/9/11  <Paul_Murdoch@emainc.com>:
>> Thanks Glen!
>>
>> I will take at your project.  Unfortunately I will only have 512 MB  
>> to 1024 MB to work with as Lucene is only one component in a larger  
>> software system running on one machine.  I agree with you on the C\C 
>> ++ comment.  That is what I would normally use for memory intense  
>> software.  It turns out that the larger file you want to index is  
>> the larger the heap space you will need.  What I would like to see  
>> is a way to "throttle" the indexing process to control the memory  
>> footprint.  I understand that this will take longer, but if I  
>> perform the task during off hours it shouldn't matter. At least the  
>> file will be indexed correctly.
>>
>> Thanks,
>> Paul
>>
>>
>> -----Original Message-----
>> From: java-user-return-42272-Paul_Murdoch=emainc.com@lucene.apache.org 
>>  [mailto:java-user-return-42272- 
>> Paul_Murdoch=emainc.com@lucene.apache.org] On Behalf Of Glen Newton
>> Sent: Friday, September 11, 2009 9:53 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: Indexing large files? - No answers yet...
>>
>> In this project:
>> http://zzzoot.blogspot.com/2009/07/project-torngat-building-large-scale.html
>>
>> I concatenate all the text of all of articles of a single journal  
>> into
>> a single text file.
>> This can create a text file that is 500MB in size.
>> Lucene is OK in indexing files this size (in parallel even), but I
>> have a heap size of 8GB.
>>
>> I would suggest increasing your heap to as large as your machine can
>> reasonably take.
>> The reality is that Java programs (like Lucene) take up more memory
>> than a similar C or even C++ program.
>> Java may approach C/C++ in speed, but not memory.
>>
>> We don't use Java because of its memory footprint!  ;-)
>>
>> See:
>> Programming language shootout: speed:
>> http://shootout.alioth.debian.org/u32q/benchmark.php?test=all&lang=all&d=ndata&calc=calculate&xfullcpu=1&xmem=0&xloc=0&binarytrees=1&chameneosredux=1&fannkuch=1&fasta=1&knucleotide=1&mandelbrot=1&meteor=0&nbody=1&pidigits=1&regexdna=1&revcomp=1&spectralnorm=1&threadring=0
>> Programming language shootout: memory:
>> http://shootout.alioth.debian.org/u32q/benchmark.php?test=all&lang=all&d=ndata&calc=calculate&xfullcpu=0&xmem=1&xloc=0&binarytrees=1&chameneosredux=1&fannkuch=1&fasta=1&knucleotide=1&mandelbrot=1&meteor=0&nbody=1&pidigits=1&regexdna=1&revcomp=1&spectralnorm=1&threadring=0
>>
>> -glen
>>
>> 2009/9/11 Dan OConnor <doconnor@acquiremedia.com>:
>>> Paul:
>>>
>>> My first suggestion would be to update your JVM to the latest  
>>> version (or at least .14). There were several garbage collection  
>>> related issues resolved in version 10 - 13 (especially dealing  
>>> with large heaps).
>>>
>>> Next, your IndexWriter parameters would help figure out why you  
>>> are using so much RAM
>>>       getMaxFieldLength()
>>>       getMaxBufferedDocs()
>>>       getMaxMergeDocs()
>>>       getRAMBufferSizeMB()
>>>
>>> How often are you calling commit?
>>> Do you close your IndexWriter after every document?
>>> How many documents of this size are you indexing?
>>> Have you used luke to look at your index?
>>> If this is a large index, have you optimized it recently?
>>> Are there any searches going on while you are indexing?
>>>
>>>
>>> Regards,
>>> Dan
>>>
>>>
>>> -----Original Message-----
>>> From: Paul_Murdoch@emainc.com [mailto:Paul_Murdoch@emainc.com]
>>> Sent: Friday, September 11, 2009 7:57 AM
>>> To: java-user@lucene.apache.org
>>> Subject: RE: Indexing large files? - No answers yet...
>>>
>>> This issue is still open.  Any suggestions/help with this would be
>>> greatly appreciated.
>>>
>>> Thanks,
>>>
>>> Paul
>>>
>>>
>>> -----Original Message-----
>>> From: java-user-return-42080-Paul_Murdoch=emainc.com@lucene.apache.org
>>> [mailto:java-user-return-42080- 
>>> Paul_Murdoch=emainc.com@lucene.apache.org
>>> ] On Behalf Of Paul_Murdoch@emainc.com
>>> Sent: Monday, August 31, 2009 10:28 AM
>>> To: java-user@lucene.apache.org
>>> Subject: Indexing large files?
>>>
>>> Hi,
>>>
>>>
>>>
>>> I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07).  I'm
>>> consistently receiving "OutOfMemoryError: Java heap space", when  
>>> trying
>>> to index large text files.
>>>
>>>
>>>
>>> Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
>>> max. heap size.  So I increased the max. heap size to 512 MB.  This
>>> worked for the 5 MB text file, but Lucene still used 84 MB of heap  
>>> space
>>> to do this.  Why so much?
>>>
>>>
>>>
>>> The class FreqProxTermsWriterPerField appears to be the biggest  
>>> memory
>>> consumer by far according to JConsole and the TPTP Memory Profiling
>>> plugin for Eclipse Ganymede.
>>>
>>>
>>>
>>> Example 2: Indexing a 62 MB text file runs out of memory with a  
>>> 512 MB
>>> max. heap size.  Increasing the max. heap size to 1024 MB works but
>>> Lucene uses 826 MB of heap space while performing this.  Still seems
>>> like way too much memory is being used to do this.  I'm sure larger
>>> files would cause the error as it seems correlative.
>>>
>>>
>>>
>>> I'm on a Windows XP SP2 platform with 2 GB of RAM.  So what is the  
>>> best
>>> practice for indexing large files?  Here is a code snippet that I'm
>>> using:
>>>
>>>
>>>
>>> // Index the content of a text file.
>>>
>>>     private Boolean saveTXTFile(File textFile, Document  
>>> textDocument)
>>> throws CIDBException {
>>>
>>>
>>>
>>>           try {
>>>
>>>
>>>
>>>                 Boolean isFile = textFile.isFile();
>>>
>>>                 Boolean hasTextExtension =
>>> textFile.getName().endsWith(".txt");
>>>
>>>
>>>
>>>                 if (isFile && hasTextExtension) {
>>>
>>>
>>>
>>>                       System.out.println("File " +
>>> textFile.getCanonicalPath() + " is being indexed");
>>>
>>>                       Reader textFileReader = new
>>> FileReader(textFile);
>>>
>>>                       if (textDocument == null)
>>>
>>>                             textDocument = new Document();
>>>
>>>                       textDocument.add(new Field("content",
>>> textFileReader));
>>>
>>>                       indexWriter.addDocument(textDocument);
>>> // BREAKS HERE!!!!
>>>
>>>                 }
>>>
>>>           } catch (FileNotFoundException fnfe) {
>>>
>>>                 System.out.println(fnfe.getMessage());
>>>
>>>                 return false;
>>>
>>>           } catch (CorruptIndexException cie) {
>>>
>>>                 throw new CIDBException("The index has become
>>> corrupt.");
>>>
>>>           } catch (IOException ioe) {
>>>
>>>                 System.out.println(ioe.getMessage());
>>>
>>>                 return false;
>>>
>>>           }
>>>
>>>           return true;
>>>
>>>     }
>>>
>>>
>>>
>>>
>>>
>>> Thanks much,
>>>
>>>
>>>
>>> Paul
>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> --
>>
>> -
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> -- 
>
> -
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42283-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 15:54:51 2009
Return-Path: <java-user-return-42283-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96063 invoked from network); 11 Sep 2009 15:54:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 15:54:51 -0000
Received: (qmail 81420 invoked by uid 500); 11 Sep 2009 15:54:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81348 invoked by uid 500); 11 Sep 2009 15:54:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81337 invoked by uid 99); 11 Sep 2009 15:54:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:54:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.200] (HELO mail-yx0-f200.google.com) (209.85.210.200)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 15:54:41 +0000
Received: by yxe38 with SMTP id 38so1523790yxe.6
        for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 08:54:19 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.240.21 with SMTP id n21mr5158044ybh.165.1252684459221; 
	Fri, 11 Sep 2009 08:54:19 -0700 (PDT)
In-Reply-To: <5B20DEF02611534DB08854076CE825D80362667B@sc1exc2.corp.emainc.com>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
	 <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>
	 <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
	 <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
	 <5B20DEF02611534DB08854076CE825D803626596@sc1exc2.corp.emainc.com>
	 <5e76f3840909110743tc68b087mbde5a05883e95eed@mail.gmail.com>
	 <5B20DEF02611534DB08854076CE825D80362667B@sc1exc2.corp.emainc.com>
Date: Fri, 11 Sep 2009 11:54:19 -0400
Message-ID: <9ac0c6aa0909110854w9ce67e2qad9550f4eb7d8868@mail.gmail.com>
Subject: Re: Indexing large files? - No answers yet...
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

To minimize Lucene's RAM usage during indexing, you should flush after
every document, eg by setting the ramBufferSizeMB to something tiny
(or maxBufferedDocs to 1).

But, unfortunately, Lucene cannot flush partway through indexing one
document.  Ie, the full document must be indexed into RAM before being
flushed.  So the worst case for Lucene will always be a single large
document.

Worse, documents with an unusually high number of unique terms will
then consume even more memory, because there is a certain RAM cost for
each unique term that's seen.

So the absolute worst case is a single large document, all of whose
terms are unique, which seems to be what's being tested here.

In theory one could make a custom indexing chain that knows it will
only hold a single document in ram at once, and could therefore trim
some of the data that we now must store per term, or maybe reduce the
size of the data types (we now use int for most fields per term, but
you could reduce them to shorts and force a flush whenever the shorts
might overflow), etc.

One possible workaround would be to pre-divide such large documents,
before indexing them, though this'd require coalescing at search time.

Mike

On Fri, Sep 11, 2009 at 11:02 AM,  <Paul_Murdoch@emainc.com> wrote:
> Glen,
>
> Absolutely. I think a RMFC Lucene would great, especially for reduced mem=
ory or low bandwidth client/server scenarios.
>
> I just looked at your LuSql tool and it just what I needed about 9 months=
 ago :-). =A0I wrote a simple re-indexer that interfaces to an SQL Server 2=
005 database and Lucene, but I could have saved some time if I knew about L=
uSql. =A0Unfortunately we're too far down the road in development to test a=
nd possibly integrate it into our system now, but I will put it on the R&D =
list for the next iteration.
>
> Thanks again,
>
> Paul
>
>
> -----Original Message-----
> From: java-user-return-42277-Paul_Murdoch=3Demainc.com@lucene.apache.org =
[mailto:java-user-return-42277-Paul_Murdoch=3Demainc.com@lucene.apache.org]=
 On Behalf Of Glen Newton
> Sent: Friday, September 11, 2009 10:44 AM
> To: java-user@lucene.apache.org
> Subject: Re: Indexing large files? - No answers yet...
>
> Paul,
>
> I saw your last post and now understand the issues you face.
>
> I don't think there has been any effort to produce a
> reduced-memory-footprint configurable (RMFC) Lucene. With the many
> mobile devices, embedded and other reduced memory devices, should this
> perhaps be one of the areas the Lucene community looks in to?
>
> -Glen
>
> 2009/9/11 =A0<Paul_Murdoch@emainc.com>:
>> Thanks Glen!
>>
>> I will take at your project. =A0Unfortunately I will only have 512 MB to=
 1024 MB to work with as Lucene is only one component in a larger software =
system running on one machine. =A0I agree with you on the C\C++ comment. =
=A0That is what I would normally use for memory intense software. =A0It tur=
ns out that the larger file you want to index is the larger the heap space =
you will need. =A0What I would like to see is a way to "throttle" the index=
ing process to control the memory footprint. =A0I understand that this will=
 take longer, but if I perform the task during off hours it shouldn't matte=
r. At least the file will be indexed correctly.
>>
>> Thanks,
>> Paul
>>
>>
>> -----Original Message-----
>> From: java-user-return-42272-Paul_Murdoch=3Demainc.com@lucene.apache.org=
 [mailto:java-user-return-42272-Paul_Murdoch=3Demainc.com@lucene.apache.org=
] On Behalf Of Glen Newton
>> Sent: Friday, September 11, 2009 9:53 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: Indexing large files? - No answers yet...
>>
>> In this project:
>> =A0http://zzzoot.blogspot.com/2009/07/project-torngat-building-large-sca=
le.html
>>
>> I concatenate all the text of all of articles of a single journal into
>> a single text file.
>> This can create a text file that is 500MB in size.
>> Lucene is OK in indexing files this size (in parallel even), but I
>> have a heap size of 8GB.
>>
>> I would suggest increasing your heap to as large as your machine can
>> reasonably take.
>> The reality is that Java programs (like Lucene) take up more memory
>> than a similar C or even C++ program.
>> Java may approach C/C++ in speed, but not memory.
>>
>> We don't use Java because of its memory footprint! =A0;-)
>>
>> See:
>> =A0Programming language shootout: speed:
>> http://shootout.alioth.debian.org/u32q/benchmark.php?test=3Dall&lang=3Da=
ll&d=3Dndata&calc=3Dcalculate&xfullcpu=3D1&xmem=3D0&xloc=3D0&binarytrees=3D=
1&chameneosredux=3D1&fannkuch=3D1&fasta=3D1&knucleotide=3D1&mandelbrot=3D1&=
meteor=3D0&nbody=3D1&pidigits=3D1&regexdna=3D1&revcomp=3D1&spectralnorm=3D1=
&threadring=3D0
>> =A0Programming language shootout: memory:
>> http://shootout.alioth.debian.org/u32q/benchmark.php?test=3Dall&lang=3Da=
ll&d=3Dndata&calc=3Dcalculate&xfullcpu=3D0&xmem=3D1&xloc=3D0&binarytrees=3D=
1&chameneosredux=3D1&fannkuch=3D1&fasta=3D1&knucleotide=3D1&mandelbrot=3D1&=
meteor=3D0&nbody=3D1&pidigits=3D1&regexdna=3D1&revcomp=3D1&spectralnorm=3D1=
&threadring=3D0
>>
>> -glen
>>
>> 2009/9/11 Dan OConnor <doconnor@acquiremedia.com>:
>>> Paul:
>>>
>>> My first suggestion would be to update your JVM to the latest version (=
or at least .14). There were several garbage collection related issues reso=
lved in version 10 - 13 (especially dealing with large heaps).
>>>
>>> Next, your IndexWriter parameters would help figure out why you are usi=
ng so much RAM
>>> =A0 =A0 =A0 =A0getMaxFieldLength()
>>> =A0 =A0 =A0 =A0getMaxBufferedDocs()
>>> =A0 =A0 =A0 =A0getMaxMergeDocs()
>>> =A0 =A0 =A0 =A0getRAMBufferSizeMB()
>>>
>>> How often are you calling commit?
>>> Do you close your IndexWriter after every document?
>>> How many documents of this size are you indexing?
>>> Have you used luke to look at your index?
>>> If this is a large index, have you optimized it recently?
>>> Are there any searches going on while you are indexing?
>>>
>>>
>>> Regards,
>>> Dan
>>>
>>>
>>> -----Original Message-----
>>> From: Paul_Murdoch@emainc.com [mailto:Paul_Murdoch@emainc.com]
>>> Sent: Friday, September 11, 2009 7:57 AM
>>> To: java-user@lucene.apache.org
>>> Subject: RE: Indexing large files? - No answers yet...
>>>
>>> This issue is still open. =A0Any suggestions/help with this would be
>>> greatly appreciated.
>>>
>>> Thanks,
>>>
>>> Paul
>>>
>>>
>>> -----Original Message-----
>>> From: java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g
>>> [mailto:java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.=
org
>>> ] On Behalf Of Paul_Murdoch@emainc.com
>>> Sent: Monday, August 31, 2009 10:28 AM
>>> To: java-user@lucene.apache.org
>>> Subject: Indexing large files?
>>>
>>> Hi,
>>>
>>>
>>>
>>> I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07). =A0I'm
>>> consistently receiving "OutOfMemoryError: Java heap space", when trying
>>> to index large text files.
>>>
>>>
>>>
>>> Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
>>> max. heap size. =A0So I increased the max. heap size to 512 MB. =A0This
>>> worked for the 5 MB text file, but Lucene still used 84 MB of heap spac=
e
>>> to do this. =A0Why so much?
>>>
>>>
>>>
>>> The class FreqProxTermsWriterPerField appears to be the biggest memory
>>> consumer by far according to JConsole and the TPTP Memory Profiling
>>> plugin for Eclipse Ganymede.
>>>
>>>
>>>
>>> Example 2: Indexing a 62 MB text file runs out of memory with a 512 MB
>>> max. heap size. =A0Increasing the max. heap size to 1024 MB works but
>>> Lucene uses 826 MB of heap space while performing this. =A0Still seems
>>> like way too much memory is being used to do this. =A0I'm sure larger
>>> files would cause the error as it seems correlative.
>>>
>>>
>>>
>>> I'm on a Windows XP SP2 platform with 2 GB of RAM. =A0So what is the be=
st
>>> practice for indexing large files? =A0Here is a code snippet that I'm
>>> using:
>>>
>>>
>>>
>>> // Index the content of a text file.
>>>
>>> =A0 =A0 =A0private Boolean saveTXTFile(File textFile, Document textDocu=
ment)
>>> throws CIDBException {
>>>
>>>
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0try {
>>>
>>>
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Boolean isFile =3D textFile.isFile()=
;
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Boolean hasTextExtension =3D
>>> textFile.getName().endsWith(".txt");
>>>
>>>
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (isFile && hasTextExtension) {
>>>
>>>
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println("File=
 " +
>>> textFile.getCanonicalPath() + " is being indexed");
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Reader textFileReader =
=3D new
>>> FileReader(textFile);
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (textDocument =3D=3D =
null)
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0textDocument=
 =3D new Document();
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0textDocument.add(new Fie=
ld("content",
>>> textFileReader));
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0indexWriter.addDocument(=
textDocument);
>>> // BREAKS HERE!!!!
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0} catch (FileNotFoundException fnfe) {
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println(fnfe.getMessage()=
);
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0return false;
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0} catch (CorruptIndexException cie) {
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0throw new CIDBException("The index h=
as become
>>> corrupt.");
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException ioe) {
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0System.out.println(ioe.getMessage())=
;
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0return false;
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0}
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0return true;
>>>
>>> =A0 =A0 =A0}
>>>
>>>
>>>
>>>
>>>
>>> Thanks much,
>>>
>>>
>>>
>>> Paul
>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> --
>>
>> -
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
>
> -
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42284-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 17:17:38 2009
Return-Path: <java-user-return-42284-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30494 invoked from network); 11 Sep 2009 17:17:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 17:17:38 -0000
Received: (qmail 54516 invoked by uid 500); 11 Sep 2009 17:17:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54396 invoked by uid 500); 11 Sep 2009 17:17:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54373 invoked by uid 99); 11 Sep 2009 17:17:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 17:17:34 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [149.8.64.32] (HELO mclmx2.mail.saic.com) (149.8.64.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 17:17:23 +0000
Received: from 0015-its-sbg01.saic.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-10287343 for java-user@lucene.apache.org; Fri, 11 Sep 2009 13:16:44 -0400
X-AuditID: 9508401a-b7ceeae00000220a-d5-4aaa85fcc04a
Received: from mclmx2.mail.saic.com (mcl-sixl-nat.saic.com [149.8.64.21])
	by  (Symantec Brightmail Gateway) with SMTP id 82.D3.08714.CF58AAA4; Fri, 11 Sep 2009 13:16:44 -0400 (EDT)
Received: from sc2xfe1.emainc.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-1830696 for java-user@lucene.apache.org; Fri, 11 Sep 2009 13:16:44 -0400
Received: from sc1exc2.corp.emainc.com ([10.36.152.47]) by sc2xfe1.emainc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 11 Sep 2009 13:19:57 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Indexing large files? - No answers yet...
Date: Fri, 11 Sep 2009 13:15:52 -0400
Message-Id: <5B20DEF02611534DB08854076CE825D8036269F1@sc1exc2.corp.emainc.com>
In-Reply-To: <9ac0c6aa0909110854w9ce67e2qad9550f4eb7d8868@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Indexing large files? - No answers yet...
Thread-Index: Acoy+K+Cc7MlTSNhTQOb3KrSjxZS8wAB1I3Q
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com> <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com> <5B20DEF02611534DB08854076CE825D803626596@sc1exc2.corp.emainc.com> <5e76f3840909110743tc68b087mbde5a05883e95eed@mail.gmail.com> <5B20DEF02611534DB08854076CE825D80362667B@sc1exc2.corp.emainc.com> <9ac0c6aa0909110854w9ce67e2qad9550f4eb7d8868@mail.gmail.com>
From: <Paul_Murdoch@emainc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 11 Sep 2009 17:19:57.0595 (UTC) FILETIME=[160766B0:01CA3304]
X-Brightmail-Tracker: AAAAAA==
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Mike!

I've been testing out "paging" the document this past week.  I'm still =
working on getting a successful test and think I'm close.  The down side =
was a drastic slow down in indexing speed, and lots of open files, but =
that was expected.  I tried with small mergeFactors, =
maxBufferedDocs(haven't tried 1 though), and ramBufferSizeMB.  Using =
JConsole to monitor the heap usage, this method slowly creeps towards my =
max heap space until OOM. I can say that at least some of the document =
gets indexed before OOM.
So I performed a heap dump at OOM and saw that =
FreqProxTermsWriterPerField had by far consumed the most memory.  I =
haven't looked into that yet... =20

Let's say I page the document into ten different smaller documents and =
they are indexed successfully (I'm not quite at this point yet).  Is =
there a way to select documents by id and merge them into one large =
document after they are in the index?  That was my plan to work around =
OOM and achieve the same end result as trying to index the large =
document in one shot.
 =20
Paul


-----Original Message-----
From: java-user-return-42283-Paul_Murdoch=3Demainc.com@lucene.apache.org =
[mailto:java-user-return-42283-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g] On Behalf Of Michael McCandless
Sent: Friday, September 11, 2009 11:54 AM
To: java-user@lucene.apache.org
Subject: Re: Indexing large files? - No answers yet...

To minimize Lucene's RAM usage during indexing, you should flush after
every document, eg by setting the ramBufferSizeMB to something tiny
(or maxBufferedDocs to 1).

But, unfortunately, Lucene cannot flush partway through indexing one
document.  Ie, the full document must be indexed into RAM before being
flushed.  So the worst case for Lucene will always be a single large
document.

Worse, documents with an unusually high number of unique terms will
then consume even more memory, because there is a certain RAM cost for
each unique term that's seen.

So the absolute worst case is a single large document, all of whose
terms are unique, which seems to be what's being tested here.

In theory one could make a custom indexing chain that knows it will
only hold a single document in ram at once, and could therefore trim
some of the data that we now must store per term, or maybe reduce the
size of the data types (we now use int for most fields per term, but
you could reduce them to shorts and force a flush whenever the shorts
might overflow), etc.

One possible workaround would be to pre-divide such large documents,
before indexing them, though this'd require coalescing at search time.

Mike

On Fri, Sep 11, 2009 at 11:02 AM,  <Paul_Murdoch@emainc.com> wrote:
> Glen,
>
> Absolutely. I think a RMFC Lucene would great, especially for reduced =
memory or low bandwidth client/server scenarios.
>
> I just looked at your LuSql tool and it just what I needed about 9 =
months ago :-). =A0I wrote a simple re-indexer that interfaces to an SQL =
Server 2005 database and Lucene, but I could have saved some time if I =
knew about LuSql. =A0Unfortunately we're too far down the road in =
development to test and possibly integrate it into our system now, but I =
will put it on the R&D list for the next iteration.
>
> Thanks again,
>
> Paul
>
>
> -----Original Message-----
> From: =
java-user-return-42277-Paul_Murdoch=3Demainc.com@lucene.apache.org =
[mailto:java-user-return-42277-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g] On Behalf Of Glen Newton
> Sent: Friday, September 11, 2009 10:44 AM
> To: java-user@lucene.apache.org
> Subject: Re: Indexing large files? - No answers yet...
>
> Paul,
>
> I saw your last post and now understand the issues you face.
>
> I don't think there has been any effort to produce a
> reduced-memory-footprint configurable (RMFC) Lucene. With the many
> mobile devices, embedded and other reduced memory devices, should this
> perhaps be one of the areas the Lucene community looks in to?
>
> -Glen
>
> 2009/9/11 =A0<Paul_Murdoch@emainc.com>:
>> Thanks Glen!
>>
>> I will take at your project. =A0Unfortunately I will only have 512 MB =
to 1024 MB to work with as Lucene is only one component in a larger =
software system running on one machine. =A0I agree with you on the C\C++ =
comment. =A0That is what I would normally use for memory intense =
software. =A0It turns out that the larger file you want to index is the =
larger the heap space you will need. =A0What I would like to see is a =
way to "throttle" the indexing process to control the memory footprint. =
=A0I understand that this will take longer, but if I perform the task =
during off hours it shouldn't matter. At least the file will be indexed =
correctly.
>>
>> Thanks,
>> Paul
>>
>>
>> -----Original Message-----
>> From: =
java-user-return-42272-Paul_Murdoch=3Demainc.com@lucene.apache.org =
[mailto:java-user-return-42272-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g] On Behalf Of Glen Newton
>> Sent: Friday, September 11, 2009 9:53 AM
>> To: java-user@lucene.apache.org
>> Subject: Re: Indexing large files? - No answers yet...
>>
>> In this project:
>> =
=A0http://zzzoot.blogspot.com/2009/07/project-torngat-building-large-scal=
e.html
>>
>> I concatenate all the text of all of articles of a single journal =
into
>> a single text file.
>> This can create a text file that is 500MB in size.
>> Lucene is OK in indexing files this size (in parallel even), but I
>> have a heap size of 8GB.
>>
>> I would suggest increasing your heap to as large as your machine can
>> reasonably take.
>> The reality is that Java programs (like Lucene) take up more memory
>> than a similar C or even C++ program.
>> Java may approach C/C++ in speed, but not memory.
>>
>> We don't use Java because of its memory footprint! =A0;-)
>>
>> See:
>> =A0Programming language shootout: speed:
>> =
http://shootout.alioth.debian.org/u32q/benchmark.php?test=3Dall&lang=3Dal=
l&d=3Dndata&calc=3Dcalculate&xfullcpu=3D1&xmem=3D0&xloc=3D0&binarytrees=3D=
1&chameneosredux=3D1&fannkuch=3D1&fasta=3D1&knucleotide=3D1&mandelbrot=3D=
1&meteor=3D0&nbody=3D1&pidigits=3D1&regexdna=3D1&revcomp=3D1&spectralnorm=
=3D1&threadring=3D0
>> =A0Programming language shootout: memory:
>> =
http://shootout.alioth.debian.org/u32q/benchmark.php?test=3Dall&lang=3Dal=
l&d=3Dndata&calc=3Dcalculate&xfullcpu=3D0&xmem=3D1&xloc=3D0&binarytrees=3D=
1&chameneosredux=3D1&fannkuch=3D1&fasta=3D1&knucleotide=3D1&mandelbrot=3D=
1&meteor=3D0&nbody=3D1&pidigits=3D1&regexdna=3D1&revcomp=3D1&spectralnorm=
=3D1&threadring=3D0
>>
>> -glen
>>
>> 2009/9/11 Dan OConnor <doconnor@acquiremedia.com>:
>>> Paul:
>>>
>>> My first suggestion would be to update your JVM to the latest =
version (or at least .14). There were several garbage collection related =
issues resolved in version 10 - 13 (especially dealing with large =
heaps).
>>>
>>> Next, your IndexWriter parameters would help figure out why you are =
using so much RAM
>>> =A0 =A0 =A0 =A0getMaxFieldLength()
>>> =A0 =A0 =A0 =A0getMaxBufferedDocs()
>>> =A0 =A0 =A0 =A0getMaxMergeDocs()
>>> =A0 =A0 =A0 =A0getRAMBufferSizeMB()
>>>
>>> How often are you calling commit?
>>> Do you close your IndexWriter after every document?
>>> How many documents of this size are you indexing?
>>> Have you used luke to look at your index?
>>> If this is a large index, have you optimized it recently?
>>> Are there any searches going on while you are indexing?
>>>
>>>
>>> Regards,
>>> Dan
>>>
>>>
>>> -----Original Message-----
>>> From: Paul_Murdoch@emainc.com [mailto:Paul_Murdoch@emainc.com]
>>> Sent: Friday, September 11, 2009 7:57 AM
>>> To: java-user@lucene.apache.org
>>> Subject: RE: Indexing large files? - No answers yet...
>>>
>>> This issue is still open. =A0Any suggestions/help with this would be
>>> greatly appreciated.
>>>
>>> Thanks,
>>>
>>> Paul
>>>
>>>
>>> -----Original Message-----
>>> From: =
java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.org
>>> =
[mailto:java-user-return-42080-Paul_Murdoch=3Demainc.com@lucene.apache.or=
g
>>> ] On Behalf Of Paul_Murdoch@emainc.com
>>> Sent: Monday, August 31, 2009 10:28 AM
>>> To: java-user@lucene.apache.org
>>> Subject: Indexing large files?
>>>
>>> Hi,
>>>
>>>
>>>
>>> I'm working with Lucene 2.4.0 and the JVM (JDK 1.6.0_07). =A0I'm
>>> consistently receiving "OutOfMemoryError: Java heap space", when =
trying
>>> to index large text files.
>>>
>>>
>>>
>>> Example 1: Indexing a 5 MB text file runs out of memory with a 16 MB
>>> max. heap size. =A0So I increased the max. heap size to 512 MB. =
=A0This
>>> worked for the 5 MB text file, but Lucene still used 84 MB of heap =
space
>>> to do this. =A0Why so much?
>>>
>>>
>>>
>>> The class FreqProxTermsWriterPerField appears to be the biggest =
memory
>>> consumer by far according to JConsole and the TPTP Memory Profiling
>>> plugin for Eclipse Ganymede.
>>>
>>>
>>>
>>> Example 2: Indexing a 62 MB text file runs out of memory with a 512 =
MB
>>> max. heap size. =A0Increasing the max. heap size to 1024 MB works =
but
>>> Lucene uses 826 MB of heap space while performing this. =A0Still =
seems
>>> like way too much memory is being used to do this. =A0I'm sure =
larger
>>> files would cause the error as it seems correlative.
>>>
>>>
>>>
>>> I'm on a Windows XP SP2 platform with 2 GB of RAM. =A0So what is the =
best
>>> practice for indexing large files? =A0Here is a code snippet that =
I'm
>>> using:
>>>
>>>
>>>
>>> // Index the content of a text file.
>>>
>>> =A0 =A0 =A0private Boolean saveTXTFile(File textFile, Document =
textDocument)
>>> throws CIDBException {
>>>
>>>
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0try {
>>>
>>>
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Boolean isFile =3D =
textFile.isFile();
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Boolean hasTextExtension =3D
>>> textFile.getName().endsWith(".txt");
>>>
>>>
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (isFile && hasTextExtension) {
>>>
>>>
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0System.out.println("File " +
>>> textFile.getCanonicalPath() + " is being indexed");
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Reader textFileReader =
=3D new
>>> FileReader(textFile);
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0if (textDocument =
=3D=3D null)
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0textDocument =3D new Document();
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0textDocument.add(new =
Field("content",
>>> textFileReader));
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0indexWriter.addDocument(textDocument);
>>> // BREAKS HERE!!!!
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0} catch (FileNotFoundException fnfe) {
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0System.out.println(fnfe.getMessage());
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0return false;
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0} catch (CorruptIndexException cie) {
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0throw new CIDBException("The =
index has become
>>> corrupt.");
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException ioe) {
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0System.out.println(ioe.getMessage());
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0return false;
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0}
>>>
>>> =A0 =A0 =A0 =A0 =A0 =A0return true;
>>>
>>> =A0 =A0 =A0}
>>>
>>>
>>>
>>>
>>>
>>> Thanks much,
>>>
>>>
>>>
>>> Paul
>>>
>>>
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> --
>>
>> -
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
>
> -
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42285-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 18:03:20 2009
Return-Path: <java-user-return-42285-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50790 invoked from network); 11 Sep 2009 18:03:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 18:03:19 -0000
Received: (qmail 25708 invoked by uid 500); 11 Sep 2009 18:03:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25624 invoked by uid 500); 11 Sep 2009 18:03:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25614 invoked by uid 99); 11 Sep 2009 18:03:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 18:03:17 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.191] (HELO mail-yw0-f191.google.com) (209.85.211.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 18:03:09 +0000
Received: by ywh29 with SMTP id 29so1991354ywh.23
        for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 11:02:47 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.17.5 with SMTP id 5mr5343255ybq.195.1252692167202; Fri, 11 
	Sep 2009 11:02:47 -0700 (PDT)
In-Reply-To: <5B20DEF02611534DB08854076CE825D8036269F1@sc1exc2.corp.emainc.com>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
	 <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>
	 <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
	 <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
	 <5B20DEF02611534DB08854076CE825D803626596@sc1exc2.corp.emainc.com>
	 <5e76f3840909110743tc68b087mbde5a05883e95eed@mail.gmail.com>
	 <5B20DEF02611534DB08854076CE825D80362667B@sc1exc2.corp.emainc.com>
	 <9ac0c6aa0909110854w9ce67e2qad9550f4eb7d8868@mail.gmail.com>
	 <5B20DEF02611534DB08854076CE825D8036269F1@sc1exc2.corp.emainc.com>
Date: Fri, 11 Sep 2009 14:02:47 -0400
Message-ID: <9ac0c6aa0909111102m44e9bd70x9e011bbc1c9c6305@mail.gmail.com>
Subject: Re: Indexing large files? - No answers yet...
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Sep 11, 2009 at 1:15 PM,  <Paul_Murdoch@emainc.com> wrote:

> I've been testing out "paging" the document this past week.  I'm
> still working on getting a successful test and think I'm close.  The
> down side was a drastic slow down in indexing speed, and lots of
> open files, but that was expected.

You mean a slowdown in indexing speed because you now flush after
every page not after every document, right?  That's expected.

But I'm not sure why you'd see a change in the number of open files...

> I tried with small mergeFactors, maxBufferedDocs(haven't tried 1
> though), and ramBufferSizeMB.  Using JConsole to monitor the heap
> usage, this method slowly creeps towards my max heap space until
> OOM. I can say that at least some of the document gets indexed
> before OOM.  So I performed a heap dump at OOM and saw that
> FreqProxTermsWriterPerField had by far consumed the most memory.  I
> haven't looked into that yet...

It's at least ~60 bytes per unique term, not counting the char[] to
hold the term, and FreqProxTermsWriterPerField is exactly where most
of those bytes are allocated (eg its PostingList class).

> Let's say I page the document into ten different smaller documents
> and they are indexed successfully (I'm not quite at this point yet).
> Is there a way to select documents by id and merge them into one
> large document after they are in the index?  That was my plan to
> work around OOM and achieve the same end result as trying to index
> the large document in one shot.

You mean at search time right?  You basically want the equivalent of
SQL's "group by".

You could make a custom Collector that does this...  Or look at how
Solr is iterating on field collapsing
(https://issues.apache.org/jira/browse/SOLR-236)?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42286-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 11 22:01:27 2009
Return-Path: <java-user-return-42286-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40834 invoked from network); 11 Sep 2009 22:01:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Sep 2009 22:01:27 -0000
Received: (qmail 59088 invoked by uid 500); 11 Sep 2009 22:01:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59006 invoked by uid 500); 11 Sep 2009 22:01:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58990 invoked by uid 99); 11 Sep 2009 22:01:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 22:01:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.132.249 as permitted sender)
Received: from [209.85.132.249] (HELO an-out-0708.google.com) (209.85.132.249)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Sep 2009 22:01:11 +0000
Received: by an-out-0708.google.com with SMTP id b2so492020ana.5
        for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 15:00:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=UsDZEACZYYzmCqPUgMkO31EXnEFI+ULew7fBX3NjylY=;
        b=gpWsP1KMKjE9xelYonxRBdtKCDOJgDHTWNUY7gKl4jkn0GEMHS2Qt42FUiTGx6V5QP
         A6i6snfGGDcEQkHp2r8EX1pErvO29kdfjvQMeDiI37pnyoG+2Pp+e8oyEj7D4e3X3eyx
         ij3/IdSzMx2pXEzJlHKCpYpCwUkBEGPL4sWw0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=fd1PVHsgpZcP8qyUJxV+Z/bv73l9loUsdMNS1MuPrCxkTZd7iJGXbMUqC9G2vWV8OZ
         Pkuq9jNzXt21OUqWieJMa51WY8Sr1TY0Gfb4Guej1Kt8nezVFh0v4MBvx+8BTL5aaP1+
         1IB7S4C8gHXHSXi4l0n0RxhojKo4G7z41pQxc=
MIME-Version: 1.0
Received: by 10.101.113.16 with SMTP id q16mr3846699anm.47.1252706450015; Fri, 
	11 Sep 2009 15:00:50 -0700 (PDT)
Date: Fri, 11 Sep 2009 15:00:49 -0700
Message-ID: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>
Subject: Enumerating NumericField using TermEnum?
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I've used NumericField to store my "hour" field.

Example...

     doc.add(new NumericField("hour").setIntValue(Integer.parseInt("12")));

Before I was using plain string Field and enumerating them with
TermEnum, which worked fine.
Now I'm using NumericField's I'm not sure how to port this enumeration code.

Any pointers?

This is the code I was using previously for plain Fields.

    ArrayList hours = new ArrayList();
    TermEnum termEnum = reader.terms( new Term( "hour", "" ) );
    Term term = null;
    while ( ( term = termEnum.term() ) != null ) {
	
        if ( ! term.field().equals( "hour" ) )
            break;
	
        hours.add( (Integer)term.text() );
        termEnum.next();	
    }

Thanks,
Phil

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42287-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 04:41:54 2009
Return-Path: <java-user-return-42287-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33169 invoked from network); 12 Sep 2009 04:41:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 04:41:54 -0000
Received: (qmail 25864 invoked by uid 500); 12 Sep 2009 04:41:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25767 invoked by uid 500); 12 Sep 2009 04:41:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25757 invoked by uid 99); 12 Sep 2009 04:41:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 04:41:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 04:41:41 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 539B971C780; Fri, 11 Sep 2009 21:41:21 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 5134B71C2D1
	for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 21:41:21 -0700 (PDT)
Date: Fri, 11 Sep 2009 21:41:21 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Stopping a runaway search, any ideas?
In-Reply-To: <4AAA5DE8.9070200@lexum.umontreal.ca>
Message-ID: <Pine.LNX.4.64.0909112139510.25391@radix.cryptio.net>
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
  <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com> 
 <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquiremedia.com>
 <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
 <4AAA5DE8.9070200@lexum.umontreal.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Subject: Stopping a runaway search, any ideas?
: References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com>
:      <5B20DEF02611534DB08854076CE825D803626008@sc1exc2.corp.emainc.com>	
:     <24098ED350C76D46A4FDBD81B51BE0E903F040B80F@exchange.windows.mmu.acquireme
:     dia.com> <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>
: In-Reply-To: <5e76f3840909110653g7fb33ae6xd79a050996b45a09@mail.gmail.com>

http://people.apache.org/~hossman/#threadhijack
Thread Hijacking on Mailing Lists

When starting a new discussion on a mailing list, please do not reply to 
an existing message, instead start a fresh email.  Even if you change the 
subject line of your email, other mail headers still track which thread 
you replied to and your question is "hidden" in that thread and gets less 
attention.   It makes following discussions in the mailing list archives 
particularly difficult.
See Also:  http://en.wikipedia.org/wiki/Thread_hijacking



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42288-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 06:25:46 2009
Return-Path: <java-user-return-42288-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52417 invoked from network); 12 Sep 2009 06:25:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 06:25:46 -0000
Received: (qmail 63120 invoked by uid 500); 12 Sep 2009 06:25:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63037 invoked by uid 500); 12 Sep 2009 06:25:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63027 invoked by uid 99); 12 Sep 2009 06:25:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 06:25:44 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of deliverable@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 06:25:34 +0000
Received: by bwz10 with SMTP id 10so1444080bwz.5
        for <java-user@lucene.apache.org>; Fri, 11 Sep 2009 23:25:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=vNdbVtsx77vYizO42rFu2vjA35n7FCZJSsYL2IYgmnU=;
        b=HOMNyGspTxRoPJJT1zGSaWkdvvRBxyuXFChe8bVWz/Ly4owAE8cP7QRHVReGjb3Wyt
         RLFDOVvCFvkJpiLn7YFanQx3hatz5I4RIBep832pVVmPxK0AF7VTKtt/PN22kE2gSNVx
         a2iJ7wEoH1ae+x2M12660iW2Waj9Z3mq+pP/Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=IJMda7FEGi6ZkLRhHB6RgzBtyTTbwZMcm3yJxQ6oOELpli3uVc3lYx/vzefW1yJZKz
         d2iYzYg22+p8IXmc1JY+nQIEOUrWctv+WWsCs75it9dpve71lpBIXHYnGhv3w2p5ZxXt
         LsDYM0fexgazUwIp8Zjy84WbtAODbKvNBPnms=
MIME-Version: 1.0
Received: by 10.239.183.26 with SMTP id s26mr63731hbg.179.1252736714385; Fri, 
	11 Sep 2009 23:25:14 -0700 (PDT)
Date: Sat, 12 Sep 2009 02:25:14 -0400
Message-ID: <7c737f300909112325w7bf5b149xa9061437ddd9e907@mail.gmail.com>
Subject: applying cosine similarity directly
From: Alexy Khrabrov <deliverable@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f7bf1adba91c04735b7e3b
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f7bf1adba91c04735b7e3b
Content-Type: text/plain; charset=ISO-8859-1

Given that I have a field for which term vector was computed and stored, and
that field is the text of a document, I'd like to rank a subset of such
documents by similarity to a given held-out document, or query, directly
using the cosine measure.  How can that be done without going through
creating a usual query?
Cheers,
Alexy

--001485f7bf1adba91c04735b7e3b--

From java-user-return-42289-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 08:55:49 2009
Return-Path: <java-user-return-42289-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8105 invoked from network); 12 Sep 2009 08:55:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 08:55:49 -0000
Received: (qmail 11315 invoked by uid 500); 12 Sep 2009 08:55:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11223 invoked by uid 500); 12 Sep 2009 08:55:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11213 invoked by uid 99); 12 Sep 2009 08:55:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 08:55:46 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 08:55:37 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 5179845F276
	for <java-user@lucene.apache.org>; Sat, 12 Sep 2009 10:55:16 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id RqBeSB8Dbkxe for <java-user@lucene.apache.org>;
	Sat, 12 Sep 2009 10:55:13 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id D38E845F275
	for <java-user@lucene.apache.org>; Sat, 12 Sep 2009 10:55:12 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>
Subject: RE: Enumerating NumericField using TermEnum?
Date: Sat, 12 Sep 2009 10:55:12 +0200
Message-ID: <CD681DB0CB284B4B9438E2A5F47260A7@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcozK27bbDgrUDZAS7+ufAEOZzITkwAWgIqQ
In-Reply-To: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Phil,

thanks for checking out NumericField. I have two comments about your
problem:

> I've used NumericField to store my "hour" field.
> 
> Example...
> 
>      doc.add(new
> NumericField("hour").setIntValue(Integer.parseInt("12")));

NumericField uses a spezial encoding of terms for fast NumericRangeQueries.
It indexes more than one term per value. How many terms depends on the
precisionStep ctor parameter. If you set it to infinity (or something ge the
bit size of your value, 32 for ints, it indexes exactly one value). These
terms are used for very fast numeric queries. This extra overhead only has a
positive impact for field with high cardinality (something > 500). For a
simple hour field with 24 distinct values, the speed impact of
NumericRangeQuery would be neglectible, it may even be a little bit slower
because of additional overhead. I would suggest to use NumericField ony for
real high-cardinality fields (like unix time stamps, prices,
latitudes/longitudes (all types of float/doubles), day of year,...).

Maybe I add this t the javadocs.

> Before I was using plain string Field and enumerating them with
> TermEnum, which worked fine.
> Now I'm using NumericField's I'm not sure how to port this enumeration
> code.

As explained above, each numerfic value is indexed by more than one term, so
your termenum is of no use. There are some tricks to get the distict values,
but this needs deeper knowledge of the underlying term structure encoding of
terms, shift value,... - see the FieldCache parsers for numeric fields).

As your field (hours) is of low cardinality, you can index with
precisionStep=Integer.MAX_VALUE. Range queries will be not faster than with
normal TermRangeQuery and your term enum will work. You only have to use
NumericUtils.prefixCodedToInt() to decode the term into a int:

hours.add( Integer.valueOf(NumericUtils.prefixCodedToInt(term.text()) );

This code would also work for other precision steps, but you would get some
additional "lower precision terms" (values with some lower bits removed).
You have to break iteration in this case (see FieldCache code).

> Any pointers?
> 
> This is the code I was using previously for plain Fields.
> 
>     ArrayList hours = new ArrayList();
>     TermEnum termEnum = reader.terms( new Term( "hour", "" ) );
>     Term term = null;
>     while ( ( term = termEnum.term() ) != null ) {
> 
>         if ( ! term.field().equals( "hour" ) )
>             break;
> 
>         hours.add( (Integer)term.text() );
>         termEnum.next();
>     }
> 
> Thanks,
> Phil
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42290-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 18:39:39 2009
Return-Path: <java-user-return-42290-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23075 invoked from network); 12 Sep 2009 18:39:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 18:39:39 -0000
Received: (qmail 27632 invoked by uid 500); 12 Sep 2009 18:39:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27568 invoked by uid 500); 12 Sep 2009 18:39:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27558 invoked by uid 99); 12 Sep 2009 18:39:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 18:39:37 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 18:39:25 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 67C316B6DC
	for <java-user@lucene.apache.org>; Sat, 12 Sep 2009 14:39:04 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Sat, 12 Sep 2009 14:39:04 -0400
X-Sasl-enc: L7KH9nbE4Y9I0avtoOZvVcDI6gizhh8/uIElkW8G3Cz2 1252780744
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id DA5EF27C07
	for <java-user@lucene.apache.org>; Sat, 12 Sep 2009 14:39:03 -0400 (EDT)
Message-ID: <4AABEAC6.9080800@fastmail.fm>
Date: Sat, 12 Sep 2009 19:39:02 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Filter before tokenize ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Is it possible to filter before tokenize, or is that not a good idea.
I want to convert '&' to 'and' , so they are dealt with the same way, 
but the StandardTokenizer I am using removes the &, I could change the 
tokenizer but  because I'm not too clear on jflex syntax it would seem 
easier to just apply a CharFilter before tokenizing, but is that possible

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42291-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 19:26:20 2009
Return-Path: <java-user-return-42291-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27925 invoked from network); 12 Sep 2009 19:26:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 19:26:20 -0000
Received: (qmail 58045 invoked by uid 500); 12 Sep 2009 19:26:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57958 invoked by uid 500); 12 Sep 2009 19:26:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57948 invoked by uid 99); 12 Sep 2009 19:26:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 19:26:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ianvink@gmail.com designates 209.85.223.176 as permitted sender)
Received: from [209.85.223.176] (HELO mail-iw0-f176.google.com) (209.85.223.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 19:26:09 +0000
Received: by iwn6 with SMTP id 6so810059iwn.20
        for <java-user@lucene.apache.org>; Sat, 12 Sep 2009 12:25:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=mRFUL1+2Q0FwcZs/+zGVvlCwe3MY9dYU+qZdsA6wBFA=;
        b=x2oVLI01jy2v43Fj/E6marKvm+9kpV+RcgFd1FxyAczbWNQwspwkErYeSVfkCLyXW/
         voQJcmWU/3+lNVvYqTQgS72DlTYyqgOVv9JmogQsvVR5h3drRM0zKasq5rADnamaF9uI
         NJLmDbOgf7GIKCyF9tnR/Dp4KwdD29jFLAImw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=dwvB4iSBab2GNjleNHCh3xk9bGSatRiTpJJAnuYFb33kTrFH/YsEnlIIgddP2Qxa27
         e/clegZftp/oFcKozqTdp8SVeJRKBzX8PoHt64KOuK3osUcqb8/8EB3X1QJrWrCyLvZr
         jcNcLf2l5bSKQQVgEMo0dkEr6SZtUxl8jkv/8=
MIME-Version: 1.0
Received: by 10.231.6.87 with SMTP id 23mr8914446iby.19.1252783549315; Sat, 12 
	Sep 2009 12:25:49 -0700 (PDT)
Date: Sat, 12 Sep 2009 16:25:49 -0300
Message-ID: <5d53d5770909121225s28867a40p3e43308f5541c885@mail.gmail.com>
Subject: field with single quote <baha'i> being split
From: Ian Vink <ianvink@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015176f1cf86ffa3104736666b1
X-Virus-Checked: Checked by ClamAV on apache.org

--0015176f1cf86ffa3104736666b1
Content-Type: text/plain; charset=ISO-8859-1

My index has a field <religion> with the source of the document. In luke I
can see that religion has baha'i or islam or Tao etc....

The problem is that when I construct a query in luke with "religion:baha'i"
luke thinks it's 2 terms "baha" and "i"

Is there a way to construct a query to make it search <religion> with the
single term "baha'i" ?

I've tried escaping the single quote but still luke splits the query into 2
terms.

Thanks,
ian

--0015176f1cf86ffa3104736666b1--

From java-user-return-42292-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 19:50:43 2009
Return-Path: <java-user-return-42292-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29547 invoked from network); 12 Sep 2009 19:50:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 19:50:42 -0000
Received: (qmail 69243 invoked by uid 500); 12 Sep 2009 19:50:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69171 invoked by uid 500); 12 Sep 2009 19:50:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69161 invoked by uid 99); 12 Sep 2009 19:50:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 19:50:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.17] (HELO web52907.mail.re2.yahoo.com) (206.190.49.17)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 12 Sep 2009 19:50:31 +0000
Received: (qmail 98116 invoked by uid 60001); 12 Sep 2009 19:50:09 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252785009; bh=1MmClILqq7Q5DSgwh1Y3qOPCdCqh7mn3TZ6P78pjrwk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=CvnvMMP8+kJkB92xl212HQz3fvYj+VvN58aHhMk0OC0pLaJnMaUDmWmYdhkxuPaP2PDxNbMHXCpi5zHMeibkJppjLVejPUetbfcZ+Eft44Zw0aSypgN/ZbZfw3UJSJ38uKkOq3xSc8brD5ycVk6QbfoNn9Ma9wFbu/PRYEpGKTs=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=J05I//9JwjMTqWCtNU0mtrtU+Y9LjZrtNGDAGoRalahu4wohYEF8kkU4qwFlGyUibXrK4rnvZ7O81wdGVnVAl50HlxLo4O6ILL/upyPcQj7vAFMtqCmZoWD9jkn1UvWr7wnEaTh+ZM1KnPJJobDtbfThfzVLof/8gq3QdUYiPCE=;
Message-ID: <560575.97572.qm@web52907.mail.re2.yahoo.com>
X-YMail-OSG: z_HvuUUVM1kmn_b.GTgIgF3fNFheJwjt0UzKIKwVvFT6fGvThM.zArKQzvjY0g9YwxN7Qm8dTWJauDUQ7XI0YPXx6croI8gpQv.i.QSfOh2Pav88otQTmdNUZqI2.4COPmLjLRpNY5JvxcBrDmTYWZWIo0AqjT.7hkllz1nM3upeS6rgyFfzbBzsGMCaHjVzF.yrLbEP_rUkMZi3GU4SANMimIaSOkL4GHc99pnRwPupjEwBhQPkwVAJ2ZrixFTF0lU_qPGcIyd3UeS3_2gLKSvttGtkLtIa3wxRvCLKdpejlwkazI6v96OOegRFwG1ZR.cJWKoWfisw0vpUCu7NCQTEU8BRXqpYDM8Kr2KugM0k6OyUB4QObScahZ32CrzSHxc6_Q--
Received: from [78.165.19.67] by web52907.mail.re2.yahoo.com via HTTP; Sat, 12 Sep 2009 12:50:09 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.347.2
Date: Sat, 12 Sep 2009 12:50:09 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Filter before tokenize ?
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
In-Reply-To: <4AABEAC6.9080800@fastmail.fm>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

--- On Sat, 9/12/09, Paul Taylor <paul_t100@fastmail.fm> wrote:=0A=0A> From=
: Paul Taylor <paul_t100@fastmail.fm>=0A> Subject: Filter before tokenize ?=
=0A> To: java-user@lucene.apache.org=0A> Date: Saturday, September 12, 2009=
, 9:39 PM=0A> Is it possible to filter before=0A> tokenize, or is that not =
a good idea.=0A> I want to convert '&' to 'and' , so they are dealt with=0A=
> the same way, but the StandardTokenizer I am using removes=0A> the &, I c=
ould change the tokenizer but=A0 because=0A> I'm not too clear on jflex syn=
tax it would seem easier to=0A> just apply a CharFilter before tokenizing, =
but is that=0A> possible=0A=0AMay be you can use WhitespaceTokenizer that w=
on't remove &?=0AWhy and's (&) are import for you? Do you need to search th=
em?=0AReplacing &'s before indexing (by preprocessing) can be a option?=0A=
=0A=0AFilter before tokenizer can be simulated by using:=0A=0A1-)KeywordTok=
enizer =0A2-)Your CharFilter=0A3-)A token filter that tokenizes input token=
's text using StandardTokenizer=0A=0ABut i think this is not a good idea.=
=0A=0AHope this helps.=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42293-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 19:57:06 2009
Return-Path: <java-user-return-42293-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30237 invoked from network); 12 Sep 2009 19:57:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 19:57:06 -0000
Received: (qmail 76675 invoked by uid 500); 12 Sep 2009 19:57:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76596 invoked by uid 500); 12 Sep 2009 19:57:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76585 invoked by uid 99); 12 Sep 2009 19:57:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 19:57:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.13] (HELO web52903.mail.re2.yahoo.com) (206.190.49.13)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 12 Sep 2009 19:56:53 +0000
Received: (qmail 77491 invoked by uid 60001); 12 Sep 2009 19:56:31 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252785391; bh=eeb9H+Lgak/zpi0EsErd7r27luTQn+S7IZX6XtIj5Mg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=h1qndBFSd24tC5OJW5XHACdMKTm70ukRGouJkEH6AW36gysGnx25lq0Ua0ziTPK7iUveDaX1FKbG0iKq9ZeYpVPzmdTOa+HTGrG7fkHW7giQ7SZlr7QF48mRkS0MHdWWOvJMEuxBm4tfbDfpxF8ygdXV2tOwz5pABCyE3ZoJggQ=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=ANKXSToSDhpPWjbqlhHn+9pGh7tYMdJrb56dZ7aymLAtxarx/bL2GMMtrnx/gPLH5eZOVF8Bx95wkRDlf7T9OVEJAhyrYtnQ49nlNv8dYI/m536XyGr8MLHIcWUKfQArceklyvYBtuRyCEKHQQCx/ccr5XayD5RwsR44yeyqrKs=;
Message-ID: <423158.77030.qm@web52903.mail.re2.yahoo.com>
X-YMail-OSG: LdyH4twVM1l6q5eZFDD6puotwfcptk6rrEmbssvPzgNbL_IZbsYQaBRaaLKpQ.Z9dkVJIJgiBvBhLZvXj_xtNW85IhXMJlZ94x8gHqqnHqY8jAbvxOcwbuUc7Iq4yafjNZBp5EnK63U.8tQsPP7np3.O1X8_ksggLK0Zlh0v1eK6V4FwfNh8wmjHNF6P6BnfFJ4T3GMnEvKhARMBjN1jqqtBF8kpXZ0weM9U6VVxFUqM_WsnFxD7_8dJafDCX8ujYDFFVty7o.AwbPpi14Hnqjq9vAidY41cfugu0hp4__qRN0IIXfk0kT7KILrdA6jK8gZWbFs-
Received: from [78.165.19.67] by web52903.mail.re2.yahoo.com via HTTP; Sat, 12 Sep 2009 12:56:31 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.347.2
Date: Sat, 12 Sep 2009 12:56:31 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: field with single quote <baha'i> being split
To: java-user@lucene.apache.org
In-Reply-To: <5d53d5770909121225s28867a40p3e43308f5541c885@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> The problem is that when I construct a query in luke with
> "religion:baha'i"
> luke thinks it's 2 terms "baha" and "i"

Which analyzer is used in query parsing? LetterTokenizer?

> Is there a way to construct a query to make it search
> <religion> with the
> single term "baha'i" ?

Using different analyzer (StandardAnalyzer for example) in queryparsing can do that.

hope this helps.



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42294-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 20:01:59 2009
Return-Path: <java-user-return-42294-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30977 invoked from network); 12 Sep 2009 20:01:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 20:01:59 -0000
Received: (qmail 79112 invoked by uid 500); 12 Sep 2009 20:01:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79025 invoked by uid 500); 12 Sep 2009 20:01:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79015 invoked by uid 99); 12 Sep 2009 20:01:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 20:01:57 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ianvink@gmail.com designates 209.85.223.176 as permitted sender)
Received: from [209.85.223.176] (HELO mail-iw0-f176.google.com) (209.85.223.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 20:01:49 +0000
Received: by iwn6 with SMTP id 6so814844iwn.20
        for <java-user@lucene.apache.org>; Sat, 12 Sep 2009 13:01:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=nB3r2G4KBb2JVHoQv3HkfcixwoNL8npASknv8q11BSg=;
        b=GA7JDq47Bm9GIWbRb0z2kK3r4JZdK1oqmWrYZo+a7b91JJ8tReE/fTetd7TXFptUaz
         QvKSG+mhguWbxa7/fhUwyWaVEl56lMVQQYtBWWGJRE8++9HY8401+rG+EIZWXiejk7kZ
         hbo3ndyUF2bHwzBmcdwo6PDUdrNQHMfsJRtZM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=cBzOZ+m37D4Rse/LrAUNCHnZphCu2E+eZAKX1kFUm818icyM/5DI4kC7iu2k0eBnoX
         ox/e2Y6m46371aQCo/ub2ZR1Qq0xtzpGbPF1Ol7nyFaCvqtwDcZ9SNs9kTIc9wvXch5J
         Nw/bv/OsRuCk2WdS3K0wpcF4ziOo2gun8QY64=
MIME-Version: 1.0
Received: by 10.231.124.164 with SMTP id u36mr8967067ibr.21.1252785687080; 
	Sat, 12 Sep 2009 13:01:27 -0700 (PDT)
In-Reply-To: <423158.77030.qm@web52903.mail.re2.yahoo.com>
References: <5d53d5770909121225s28867a40p3e43308f5541c885@mail.gmail.com>
	 <423158.77030.qm@web52903.mail.re2.yahoo.com>
Date: Sat, 12 Sep 2009 17:01:27 -0300
Message-ID: <5d53d5770909121301r1eb4d718j37673d5c40a593b9@mail.gmail.com>
Subject: Re: field with single quote <baha'i> being split
From: Ian Vink <ianvink@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64719b0dbaecd047366e51d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64719b0dbaecd047366e51d
Content-Type: text/plain; charset=ISO-8859-1

I'm using Snowball as I have a dozen languages.

ian



On Sat, Sep 12, 2009 at 4:56 PM, AHMET ARSLAN <iorixxx@yahoo.com> wrote:

> > The problem is that when I construct a query in luke with
> > "religion:baha'i"
> > luke thinks it's 2 terms "baha" and "i"
>
> Which analyzer is used in query parsing? LetterTokenizer?
>
> > Is there a way to construct a query to make it search
> > <religion> with the
> > single term "baha'i" ?
>
> Using different analyzer (StandardAnalyzer for example) in queryparsing can
> do that.
>
> hope this helps.
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64719b0dbaecd047366e51d--

From java-user-return-42295-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 20:07:04 2009
Return-Path: <java-user-return-42295-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31992 invoked from network); 12 Sep 2009 20:07:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 20:07:04 -0000
Received: (qmail 83218 invoked by uid 500); 12 Sep 2009 20:07:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83121 invoked by uid 500); 12 Sep 2009 20:07:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83111 invoked by uid 99); 12 Sep 2009 20:07:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 20:07:01 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 20:06:52 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 1F7CA69807;
	Sat, 12 Sep 2009 16:06:31 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Sat, 12 Sep 2009 16:06:31 -0400
X-Sasl-enc: N5FP/FS1IKYFUkhOkoyKG9ABWFQprtOZMKUuFEDJ7PAF 1252785990
Received: from macbook.lan (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 364AF27C7D;
	Sat, 12 Sep 2009 16:06:30 -0400 (EDT)
Message-ID: <4AABFF45.8070602@fastmail.fm>
Date: Sat, 12 Sep 2009 21:06:29 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: AHMET ARSLAN <iorixxx@yahoo.com>
CC: java-user@lucene.apache.org
Subject: Re: Filter before tokenize ?
References: <560575.97572.qm@web52907.mail.re2.yahoo.com>
In-Reply-To: <560575.97572.qm@web52907.mail.re2.yahoo.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

AHMET ARSLAN wrote:
> --- On Sat, 9/12/09, Paul Taylor <paul_t100@fastmail.fm> wrote:
>
>   
>> From: Paul Taylor <paul_t100@fastmail.fm>
>> Subject: Filter before tokenize ?
>> To: java-user@lucene.apache.org
>> Date: Saturday, September 12, 2009, 9:39 PM
>> Is it possible to filter before
>> tokenize, or is that not a good idea.
>> I want to convert '&' to 'and' , so they are dealt with
>> the same way, but the StandardTokenizer I am using removes
>> the &, I could change the tokenizer but  because
>> I'm not too clear on jflex syntax it would seem easier to
>> just apply a CharFilter before tokenizing, but is that
>> possible
>>     
>
> May be you can use WhitespaceTokenizer that won't remove &?
> Why and's (&) are import for you? Do you need to search them?
> Replacing &'s before indexing (by preprocessing) can be a option?
>
>
> Filter before tokenizer can be simulated by using:
>
> 1-)KeywordTokenizer 
> 2-)Your CharFilter
> 3-)A token filter that tokenizes input token's text using StandardTokenizer
>
> But i think this is not a good idea.
>
> Hope this helps.
>
>   
Yes, I want to search them and I want to be able to search using either 
'&' or 'and' and get the same results. Ive just been playing with this 
and using a CharFilter before the Tokenizer did work, the only problem 
was modifications required for reusableTokenStream because CharFilter 
doesn't have a reset(Reader) method like tokenizer, so I guess I 
recreate this bit and then reset tokenizer, seems to work okay so thats 
what Im going with, if this is wronmg please someone let me know.

Because of this problem I also tried modifying the StandardTokenizer 
jflex file so that it didn't remove &s, but then realised CharFilter HAS 
to be before a tokenizer it cant work on a tokenizers output. I then 
tried making a modiofication to StandardFilter, but because this only 
removes characters it wasnt clear how tro add a case for adding characters.

Paul

public class StandardUnaccentAnalyzer extends Analyzer {

private NormalizeCharMap charConvertMap;

private void setCharConvertMap() {
charConvertMap = new NormalizeCharMap();
charConvertMap.add("&","and");
}

public StandardUnaccentAnalyzer() {
setCharConvertMap();
}

public TokenStream tokenStream(String fieldName, Reader reader) {
CharFilter mappingCharFilter = new MappingCharFilter(charConvertMap,reader);
StandardTokenizer tokenStream = new StandardTokenizer(mappingCharFilter);
TokenStream result = new ICUTransformFilter(tokenStream, 
Transliterator.getInstance("[[:Script=Katakana:]]Katakana-Hiragana"));
result = new StandardFilter(result);
result = new AccentFilter(result);
result = new LowerCaseFilter(result);
return result;
}

private static final class SavedStreams {
CharFilter preFilter;
StandardTokenizer tokenStream;
TokenStream filteredTokenStream;
}

public TokenStream reusableTokenStream(String fieldName, Reader reader) 
throws IOException {
SavedStreams streams = (SavedStreams)getPreviousTokenStream();
if (streams == null) {
streams = new SavedStreams();
setPreviousTokenStream(streams);
streams.preFilter = new MappingCharFilter(charConvertMap,reader);
streams.tokenStream = new StandardTokenizer(streams.preFilter);
streams.filteredTokenStream = new 
ICUTransformFilter(streams.tokenStream, Transliterator.getInstance("[ 
[:Script=Katakana:]]Katakana-Hiragana"));
streams.filteredTokenStream = new 
StandardFilter(streams.filteredTokenStream);
streams.filteredTokenStream = new AccentFilter(streams.filteredTokenStream);
streams.filteredTokenStream = new 
LowerCaseFilter(streams.filteredTokenStream);
}
else {
streams.preFilter = new MappingCharFilter(charConvertMap,reader);
streams.tokenStream.reset(streams.preFilter);
}
return streams.filteredTokenStream;
}

>     

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42296-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 20:09:41 2009
Return-Path: <java-user-return-42296-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32312 invoked from network); 12 Sep 2009 20:09:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 20:09:41 -0000
Received: (qmail 85685 invoked by uid 500); 12 Sep 2009 20:09:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85612 invoked by uid 500); 12 Sep 2009 20:09:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85602 invoked by uid 99); 12 Sep 2009 20:09:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 20:09:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.20] (HELO web52910.mail.re2.yahoo.com) (206.190.49.20)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 12 Sep 2009 20:09:28 +0000
Received: (qmail 89278 invoked by uid 60001); 12 Sep 2009 20:09:06 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252786146; bh=Rz82S2ET+D/gSV/gLZwNxaoW+GSEqinnoYBN6m+aw+M=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=rOX7tjYpYccw5fZVmUjkyDpOE+YWWNTREOqeSHfoqRvFULIPvRsKSAocVGBAJqBntbI0fB6wXLrrFA7cm9lxkkrHcxio2L+TVJ6ZoYc/yvUoo+oYTLqM27HMb12TxxmLzN7n3XUX1y/8oOCBq2AmEjwNds2KOnImV3ZipS8J1SA=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=lCErDL/15NS+CHUr1MU0xQiAmWu4cG5l60P/Lwbk0oaMuq9ZWQLNF+qPoR+PVmI1Csopb/kigGgtPd9UO2azjIvlp+TucWNNHtMFOSGiISwV0Fqq8o8aJplLdpLd7MDFFlUJBNmnfTMDxnd2wOBgU6tV0kvGaaZKi19iKNTcG2k=;
Message-ID: <802630.89210.qm@web52910.mail.re2.yahoo.com>
X-YMail-OSG: TIllJioVM1kuG8uv96F7nr8.Ty5ZfoTWsUyGiYKzYGBCnT0qbybg0YAc2A1DH3uKfhz7aHcN9i.jC4am4V.qZKhiyNddrGhn9_G7RKrebu0TMFtl3w8bnpzU67N6tTdecfsEkkNVXqQwG8kqhMUZHiDhgEidq8JRoBClEiZcCp9QMhgp5fQi1XnCe4TIOot83dAUy1f5G5f7dO6LQIgWT1UDJemIAeloKPurmO_GGQQ59kAGCP4o3K91VajAlX2eEzmxujHe6fHutfySCNhaJO.O_6_IL7.VYM8JPLLlxI9UygX0fPwnys7lYf3RzQAX1CDGngoHBiQC6aCxdUB66sfAzckuIW01e8M-
Received: from [78.165.19.67] by web52910.mail.re2.yahoo.com via HTTP; Sat, 12 Sep 2009 13:09:06 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.347.2
Date: Sat, 12 Sep 2009 13:09:06 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: field with single quote <baha'i> being split
To: java-user@lucene.apache.org
In-Reply-To: <5d53d5770909121301r1eb4d718j37673d5c40a593b9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org


> I'm using Snowball as I have a dozen languages.

You are using SnowballAnalyzer at both index and query time, right?
SnowballAnalyzer uses StandardTokenizer which keeps baha'i as one token.

The apostrophe in your query, can it be \u2019 ? Something similar to ' but different character.



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42297-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 12 23:26:52 2009
Return-Path: <java-user-return-42297-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60176 invoked from network); 12 Sep 2009 23:26:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Sep 2009 23:26:52 -0000
Received: (qmail 78837 invoked by uid 500); 12 Sep 2009 23:26:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78745 invoked by uid 500); 12 Sep 2009 23:26:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78734 invoked by uid 99); 12 Sep 2009 23:26:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 23:26:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anthony.urso@gmail.com designates 209.85.222.183 as permitted sender)
Received: from [209.85.222.183] (HELO mail-pz0-f183.google.com) (209.85.222.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Sep 2009 23:26:42 +0000
Received: by pzk13 with SMTP id 13so1697685pzk.5
        for <java-user@lucene.apache.org>; Sat, 12 Sep 2009 16:26:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=6tu2gYuH6jWi2KGfntxzGDZ3evvLJRJedBgqiZUwVNM=;
        b=Vcfmfs5UHdtE8b6QDbM/ZC3lttTiv2kMEjPGqSiju/1SsmWsvRlLZNQG3H6xpV2XhF
         1XfP174lxyhxSfgWiYkSmHsvqUcg6bME4Fjd6fPDdrOfQ3qUDWQkJk99mv61wVvq6rTa
         6cB0qR7SERMn3IK3OAZxt36DCvJts/aZNuP9k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=EhmOgQhqvDV41WJJs2Oq1CAcjkZwWFjsn1m5jQBzNALgnSD0IWh+pMDtonCrzmn26H
         Mo/VWNkV3oUQ6b1yyqD0uiEgRBV9dfTXqZ1745UCVpRNBLlhGTXXRT5vwoYEyl0fAxsX
         vT8a+NhEdM1LIYaQjA8Mhe7QFquW/4TqwQYaE=
MIME-Version: 1.0
Received: by 10.140.147.2 with SMTP id u2mr820346rvd.214.1252797981532; Sat, 
	12 Sep 2009 16:26:21 -0700 (PDT)
In-Reply-To: <7c737f300909112325w7bf5b149xa9061437ddd9e907@mail.gmail.com>
References: <7c737f300909112325w7bf5b149xa9061437ddd9e907@mail.gmail.com>
Date: Sat, 12 Sep 2009 16:26:21 -0700
Message-ID: <ba72f77f0909121626w41a8c5c9xeb856aa38cefe4fa@mail.gmail.com>
Subject: Re: applying cosine similarity directly
From: Anthony Urso <anthony.urso@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

There is a MoreLikeThis similarity search class in Lucene, it should
do what you're looking for.

http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/similar/Mo=
reLikeThis.html

Cheers,
Anthony

On Fri, Sep 11, 2009 at 11:25 PM, Alexy Khrabrov <deliverable@gmail.com> wr=
ote:
> Given that I have a field for which term vector was computed and stored, =
and
> that field is the text of a document, I'd like to rank a subset of such
> documents by similarity to a given held-out document, or query, directly
> using the cosine measure. =A0How can that be done without going through
> creating a usual query?
> Cheers,
> Alexy
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42298-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 00:54:10 2009
Return-Path: <java-user-return-42298-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80331 invoked from network); 13 Sep 2009 00:54:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 00:54:10 -0000
Received: (qmail 9860 invoked by uid 500); 13 Sep 2009 00:54:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9770 invoked by uid 500); 13 Sep 2009 00:54:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9760 invoked by uid 99); 13 Sep 2009 00:54:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 00:54:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 59.106.19.174 is neither permitted nor denied by domain of koji@r.email.ne.jp)
Received: from [59.106.19.174] (HELO www724.sakura.ne.jp) (59.106.19.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 00:53:58 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	(authenticated bits=0)
	by www724.sakura.ne.jp (8.14.3/8.14.3) with ESMTP id n8D0ra91075895
	for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 09:53:36 +0900 (JST)
	(envelope-from koji@r.email.ne.jp)
Message-ID: <4AAC4290.2080207@r.email.ne.jp>
Date: Sun, 13 Sep 2009 09:53:36 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Filter before tokenize ?
References: <4AABEAC6.9080800@fastmail.fm>
In-Reply-To: <4AABEAC6.9080800@fastmail.fm>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Paul,

CharFilter should work for this case. How about this?

public class MappingAnd {
 
  static final String[] DOCS = {
    "R&B", "H&M", "Hennes & Mauritz", "cheeseburger and french fries"
  };
  static final String F = "f";
  static Directory dir = new RAMDirectory();
  static Analyzer analyzer = new MyStandardAnalyzer();

  public static void main(String[] args) throws Exception {
    makeIndex();
    searchIndex( "&" );
    searchIndex( "and" );
  }
 
  static void makeIndex() throws IOException {
    IndexWriter writer = new IndexWriter( dir, analyzer, true, 
MaxFieldLength.LIMITED );
    for( String value : DOCS ){
      Document doc = new Document();
      doc.add( new Field( F, value, Store.YES, Index.ANALYZED ) );
      writer.addDocument( doc );
    }
    writer.close();
  }
 
  static void searchIndex( String q ) throws Exception {
    System.out.println( "\n\n*** Searching \"" + q + "\" ..." );
    IndexSearcher searcher = new IndexSearcher( dir );
    QueryParser parser = new QueryParser( F, analyzer );
    Query query = parser.parse( q );
    TopDocs docs = searcher.search( query, 10 );
    for( ScoreDoc scoreDoc : docs.scoreDocs ){
      Document doc = searcher.doc( scoreDoc.doc );
      System.out.println( scoreDoc.score + " : " + doc.get( F ) );
    }
    searcher.close();
  }
 
  static class MyStandardAnalyzer extends Analyzer {
    public TokenStream tokenStream(String field, Reader in) {
      StandardTokenizer tokenStream = new StandardTokenizer( 
getCharFilter( in ) );
      tokenStream.setMaxTokenLength( 255 );
      TokenStream result = new StandardFilter(tokenStream);
      result = new LowerCaseFilter(result);
      return result;
    }
   
  }

  static CharFilter getCharFilter( Reader in ){
    NormalizeCharMap map = new NormalizeCharMap();
    map.add( "&", " and " );
    return new MappingCharFilter( map, CharReader.get( in ) );
  }
}

Koji


Paul Taylor wrote:
> Is it possible to filter before tokenize, or is that not a good idea.
> I want to convert '&' to 'and' , so they are dealt with the same way, 
> but the StandardTokenizer I am using removes the &, I could change the 
> tokenizer but  because I'm not too clear on jflex syntax it would seem 
> easier to just apply a CharFilter before tokenizing, but is that possible
>
> Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42299-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 14:06:36 2009
Return-Path: <java-user-return-42299-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83485 invoked from network); 13 Sep 2009 14:06:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 14:06:36 -0000
Received: (qmail 53482 invoked by uid 500); 13 Sep 2009 14:06:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53405 invoked by uid 500); 13 Sep 2009 14:06:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53395 invoked by uid 99); 13 Sep 2009 14:06:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 14:06:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 14:06:23 +0000
Received: by qw-out-2122.google.com with SMTP id 9so797633qwb.53
        for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 07:06:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to
         :organization:user-agent:mime-version:to:subject:x-enigmail-version
         :content-type:content-transfer-encoding;
        bh=QC+1fwaydBESBWngJNIGa8zAV8bzb6ewuJVzfBIKy5M=;
        b=XXTwbv5Uf7TOIdU8tVIGHl78daxZLZ9sv4+thpjDUMBO+nAgA6hHT4FjyueVAzu0eP
         c0f/xUrm1+/ULCdfGQ6bF6RLw3uMQeXRV6YczzjNljMia+Afnd5mPLPZAe1NaR6WwZRW
         Sp6qSXIqr1wmW8hOJFdLhoisN0dyciUM/JlcI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:organization:user-agent:mime-version
         :to:subject:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=UbEsPjU3hedM7FsTVTfxdx+4VrDmjO+ccwSDwVC9fhNmLs1g56XkO91Fma9GD0QUuh
         pItqSz3OtHF6QL8Q+alaHAGY1Mw7yl/uAoYkmj8niVRlgmCVjPyX9PQTLhTxjLNj9biq
         ZcJN80xBG8FrlQxEmhLpq6xRvAGlIeHJTUYyE=
Received: by 10.224.30.196 with SMTP id v4mr3671448qac.343.1252850762535;
        Sun, 13 Sep 2009 07:06:02 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm4319419qwe.25.2009.09.13.07.06.00
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 13 Sep 2009 07:06:01 -0700 (PDT)
Message-ID: <4AACFC4E.2090705@apache.org>
Date: Sun, 13 Sep 2009 10:06:06 -0400
From: Mark Miller <markrmiller@gmail.com>
Reply-To: markrmiller@apache.org
Organization: Apache
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene 2.9 RC4 now available for testing
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello Lucene users,

On behalf of the Lucene dev community (a growing community far larger
than just the committers) I would like to announce the fourth release
candidate for Lucene 2.9.

Please download and check it out - take it for a spin and kick the
tires. If all goes well, we hope to release the final version of
Lucene 2.9 very shortly.

We let out a bug in the lock factory changes we made in RC3 -
making a new SimpleFSDirectory with a String param would throw
an illegal state exception - a fix for this is in RC4. We also
took the opportunity to add a few more documentation improvements,
take care of another another minor bug fix or two, and move the
message package from contrib queryParser to core.

While we generally try and maintain full backwards compatibility
between major versions, Lucene 2.9 has a variety of breaks that are
spelled out in the 'Changes in backwards compatibility policy' section
of CHANGES.txt.

We recommend that you recompile your application with Lucene 2.9
rather than attempting to drop it in. This will alert you to any
issues you may have to fix if you are affected by one of the backward
compatibility breaks. As always, its a really good idea to thoroughly
read CHANGES.txt before upgrading. Also, remember that this is a
release candidate, and not the final Lucene 2.9 release.

Lucene 2.9 comes with a bevy of new features, including:

  * Per segment searching and caching (can lead to much faster reopen
    among other things)

  * Near real-time search capabilities added to IndexWriter

  * New Query types

  * Smarter, more scalable multi-term queries (wildcard, range, etc)

  * A freshly optimized Collector/Scorer API

  * Improved Unicode support and the addition of Collation contrib

  * A new Attribute based TokenStream API

  * A new QueryParser framework in contrib with a core QueryParser
    replacement impl included.

  * Scoring is now optional when sorting by Field, or using a custom
    Collector, gaining sizable performance when scores are not
    required.

  * New analyzers (PersianAnalyzer, ArabicAnalyzer,
    SmartChineseAnalyzer)

  * New fast-vector-highlighter

  * Lucene now includes high-performance handling of numeric fields.
    Such fields are indexed with a trie structure, enabling simple to
    use and much faster numeric range searching without having to
    externally pre-process numeric values into textual values.

  ---

And many, many more features, bug fixes, optimizations, and various
improvements. You can find the full list of changes here:

HTML version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Changes.html

Text version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CHANGES.txt

Many changes have also occurred in Lucene's Contrib area:

HTML version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Contrib-Changes.html

Text version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CONTRIB-CHANGES.txt


Download release candidate 4 here:
http://people.apache.org/~markrmiller/staging-area/lucene2.9rc4/

Be sure to report back with any issues you find!

Thanks,

Mark Miller
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkqs/E0ACgkQ0DU3IV7ywDlolwCeLP2FNQbdC9QoQzgWi3YMsAzG
LX0AniTMMLLaYR/xpPpx6abjDIDREzV6
=7MwC
-----END PGP SIGNATURE-----


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42300-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 17:20:59 2009
Return-Path: <java-user-return-42300-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15837 invoked from network); 13 Sep 2009 17:20:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 17:20:59 -0000
Received: (qmail 41952 invoked by uid 500); 13 Sep 2009 17:20:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41876 invoked by uid 500); 13 Sep 2009 17:20:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41866 invoked by uid 99); 13 Sep 2009 17:20:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 17:20:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of phil123@gmail.com designates 209.85.210.176 as permitted sender)
Received: from [209.85.210.176] (HELO mail-yx0-f176.google.com) (209.85.210.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 17:20:47 +0000
Received: by yxe6 with SMTP id 6so3414569yxe.22
        for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 10:20:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=iPPqEa2zW2x/dCd/N9hs8PoN4+YhKXv98JZcpZ5BzOw=;
        b=SeRhd5QRZzdJebOppvs+wGPJ9VPboc6J97GQ4hpiJ275+tLTKsyNFmGtaMZ1W0p+3v
         oMiDpUlvZWZwUo92SHQ88TKE3dQqNkopCwsVt0LWzzB1DJytFDBflnuQjauiMpIOLH76
         4sTCh/S6E9vhE5gXlYg0xRgpCPMUOptrgGS4I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=lw3g179mXM7hv+m95pzfNOf4FiyfFgFRZqm+cNI5Np7F6+P1D2p+6Sj94IYv/yG69h
         +osm0y6QCytFxhNEfveddg4rNSbFcZLfDn/7PCH0MmquBJ+osIlvmbVGoUtrSOS9v0sA
         ZjO3sBmmQ40tupBmj/sac0ef4EOcmQPGmd7FY=
MIME-Version: 1.0
Received: by 10.100.24.22 with SMTP id 22mr5461880anx.119.1252862426452; Sun, 
	13 Sep 2009 10:20:26 -0700 (PDT)
In-Reply-To: <CD681DB0CB284B4B9438E2A5F47260A7@VEGA>
References: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>
	 <CD681DB0CB284B4B9438E2A5F47260A7@VEGA>
Date: Sun, 13 Sep 2009 10:20:26 -0700
Message-ID: <9cafbc680909131020x4a6bd54fn47cffae41f95fc2f@mail.gmail.com>
Subject: Re: Enumerating NumericField using TermEnum?
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Uwe,

Thanks for the explanation! It really helps. That makes sense that for
a small number of values, such as "hour" NumericField is not going to
help me. I'm experimenting with using epoch NumericField for sorting,
which funnily is where I started with 2.4.1, before going down the
usual TooManyClauses path and breaking it down to multiple fields. 2.9
seems a great improvement there. Downloading the new 2.9 rc4...

Thanks,
Phil

On Sat, Sep 12, 2009 at 1:55 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
> Hi Phil,
>
> thanks for checking out NumericField. I have two comments about your
> problem:
>
>> I've used NumericField to store my "hour" field.
>>
>> Example...
>>
>> =A0 =A0 =A0doc.add(new
>> NumericField("hour").setIntValue(Integer.parseInt("12")));
>
> NumericField uses a spezial encoding of terms for fast NumericRangeQuerie=
s.
> It indexes more than one term per value. How many terms depends on the
> precisionStep ctor parameter. If you set it to infinity (or something ge =
the
> bit size of your value, 32 for ints, it indexes exactly one value). These
> terms are used for very fast numeric queries. This extra overhead only ha=
s a
> positive impact for field with high cardinality (something > 500). For a
> simple hour field with 24 distinct values, the speed impact of
> NumericRangeQuery would be neglectible, it may even be a little bit slowe=
r
> because of additional overhead. I would suggest to use NumericField ony f=
or
> real high-cardinality fields (like unix time stamps, prices,
> latitudes/longitudes (all types of float/doubles), day of year,...).
>
> Maybe I add this t the javadocs.
>
>> Before I was using plain string Field and enumerating them with
>> TermEnum, which worked fine.
>> Now I'm using NumericField's I'm not sure how to port this enumeration
>> code.
>
> As explained above, each numerfic value is indexed by more than one term,=
 so
> your termenum is of no use. There are some tricks to get the distict valu=
es,
> but this needs deeper knowledge of the underlying term structure encoding=
 of
> terms, shift value,... - see the FieldCache parsers for numeric fields).
>
> As your field (hours) is of low cardinality, you can index with
> precisionStep=3DInteger.MAX_VALUE. Range queries will be not faster than =
with
> normal TermRangeQuery and your term enum will work. You only have to use
> NumericUtils.prefixCodedToInt() to decode the term into a int:
>
> hours.add( Integer.valueOf(NumericUtils.prefixCodedToInt(term.text()) );
>
> This code would also work for other precision steps, but you would get so=
me
> additional "lower precision terms" (values with some lower bits removed).
> You have to break iteration in this case (see FieldCache code).
>
>> Any pointers?
>>
>> This is the code I was using previously for plain Fields.
>>
>> =A0 =A0 ArrayList hours =3D new ArrayList();
>> =A0 =A0 TermEnum termEnum =3D reader.terms( new Term( "hour", "" ) );
>> =A0 =A0 Term term =3D null;
>> =A0 =A0 while ( ( term =3D termEnum.term() ) !=3D null ) {
>>
>> =A0 =A0 =A0 =A0 if ( ! term.field().equals( "hour" ) )
>> =A0 =A0 =A0 =A0 =A0 =A0 break;
>>
>> =A0 =A0 =A0 =A0 hours.add( (Integer)term.text() );
>> =A0 =A0 =A0 =A0 termEnum.next();
>> =A0 =A0 }
>>
>> Thanks,
>> Phil
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Mobile: +1  778-233-4935
Website: http://philw.co.uk
Skype: philwhelan76
Twitter: philwhln
Email : phil123@gmail.com
iChat: philwhln@mac.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42301-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 18:10:27 2009
Return-Path: <java-user-return-42301-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23427 invoked from network); 13 Sep 2009 18:10:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 18:10:27 -0000
Received: (qmail 65697 invoked by uid 500); 13 Sep 2009 18:10:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65612 invoked by uid 500); 13 Sep 2009 18:10:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65602 invoked by uid 99); 13 Sep 2009 18:10:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 18:10:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 18:10:15 +0000
Received: by qyk30 with SMTP id 30so2122034qyk.5
        for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 11:09:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=QwZxZGK3DZzW9gBRbUe3P+ehotPaW7IXLWyw84azxO8=;
        b=LwM13zPIRcVlC4QupoCU0uAvH3eTp7YQ+Q3xrZNgdDxJNfBUKr0S5sAiDWoq5jbUBz
         XxhdeHCGM5kbnRdw373VFiiUqBhY56S0Lv73awXdwz65jFug0pcTMRFVMFfQSrQgXq96
         GkODPd5ITWhwIeYtzIQfb6m88I7VJqrEO/ZR4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=JnTB1afjLuaceEMd9wDHDGIDkB156Z+xiQdTvkOu8Qsu7frizyOmwaschmaBUpdvV9
         gnDVDGq2PlUywFOOyVia0cZrYcfPRKJ16635ykYqTqYDcqn+5TNOXktI4Gt6pDuxnjWn
         62qEac5KPm2tRtaM8z4GN6m2hfAcqI1zW669U=
Received: by 10.224.36.139 with SMTP id t11mr4470461qad.350.1252865394162;
        Sun, 13 Sep 2009 11:09:54 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 8sm5308397qwj.28.2009.09.13.11.09.53
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 13 Sep 2009 11:09:53 -0700 (PDT)
Message-ID: <4AAD3577.9040403@gmail.com>
Date: Sun, 13 Sep 2009 14:09:59 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Enumerating NumericField using TermEnum?
References: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>	 <CD681DB0CB284B4B9438E2A5F47260A7@VEGA> <9cafbc680909131020x4a6bd54fn47cffae41f95fc2f@mail.gmail.com>
In-Reply-To: <9cafbc680909131020x4a6bd54fn47cffae41f95fc2f@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


>> NumericField uses a spezial encoding of terms for fast NumericRangeQueries.
>> It indexes more than one term per value. How many terms depends on the
>> precisionStep ctor parameter. If you set it to infinity (or something ge the
>> bit size of your value, 32 for ints, it indexes exactly one value). These
>> terms are used for very fast numeric queries. This extra overhead only has a
>> positive impact for field with high cardinality (something > 500). For a
>> simple hour field with 24 distinct values, the speed impact of
>> NumericRangeQuery would be neglectible, it may even be a little bit slower
>> because of additional overhead. I would suggest to use NumericField ony for
>> real high-cardinality fields (like unix time stamps, prices,
>> latitudes/longitudes (all types of float/doubles), day of year,...).
>>
>> Maybe I add this t the javadocs.
>>     
+1 - intuition might be to use it for anything numeric.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42302-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 18:11:35 2009
Return-Path: <java-user-return-42302-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23576 invoked from network); 13 Sep 2009 18:11:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 18:11:35 -0000
Received: (qmail 67472 invoked by uid 500); 13 Sep 2009 18:11:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67402 invoked by uid 500); 13 Sep 2009 18:11:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67392 invoked by uid 99); 13 Sep 2009 18:11:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 18:11:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 18:11:22 +0000
Received: by qw-out-2122.google.com with SMTP id 9so826018qwb.53
        for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 11:11:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=BXpw0GLaSnU6YMnixNvn7Spkfj2YN6w0ryZb9Yv/P40=;
        b=UFFgcag+c4BgI2w4qyui3+CeG/9HYyY3OiajVw+j4kAYApxYGmDTOeN0avq8Y3j7f4
         KMYS2JmTvtC1G0bNSvVFYKLIAnCygrqRPZV74LE/EJfckO3ihnBMYyD5h+v5ddwFTW9W
         y3P8p+W+UxmWMa1YQt1LkKOMES4ZW4t37iHTc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=AgjXlZ+IU3NRId6HsAFKoP2nUneOSGhOLtb1PWNsD2C5dQyidwewW1H4pp1AzLKo3W
         /5GzRu8HrDIUJXPVVkSyGsTy/1SVbSCzp9BfV9QYPiajR6bFMT0j5b9MP2mJKdQU4Jct
         mOzSMNdOhf5pXClf01N3bzGLrR4g+eyh6DUrw=
Received: by 10.224.113.210 with SMTP id b18mr4501467qaq.354.1252865461014;
        Sun, 13 Sep 2009 11:11:01 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 5sm4597741qwh.10.2009.09.13.11.11.00
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 13 Sep 2009 11:11:00 -0700 (PDT)
Message-ID: <4AAD35BA.8090404@gmail.com>
Date: Sun, 13 Sep 2009 14:11:06 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9 RC4 now available for testing
References: <4AACFC4E.2090705@apache.org>
In-Reply-To: <4AACFC4E.2090705@apache.org>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Mark Miller wrote:
> Hello Lucene users,
>
> ...
>
> We let out a bug in the lock factory changes we made in RC3 -
> making a new SimpleFSDirectory with a String param would throw
> an illegal state exception - a fix for this is in RC4.

My apologies - not SimpleFSDirectory, but SimpleFSLockFactory.



-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42303-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 20:23:30 2009
Return-Path: <java-user-return-42303-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44817 invoked from network); 13 Sep 2009 20:23:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 20:23:30 -0000
Received: (qmail 51652 invoked by uid 500); 13 Sep 2009 20:23:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51570 invoked by uid 500); 13 Sep 2009 20:23:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51560 invoked by uid 99); 13 Sep 2009 20:23:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 20:23:28 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 20:23:17 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id BFEB6D36003
	for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 22:22:56 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id eWU+1nXxPjRv for <java-user@lucene.apache.org>;
	Sun, 13 Sep 2009 22:22:54 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 484E3D36001
	for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 22:22:54 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AACFC4E.2090705@apache.org> <4AAD35BA.8090404@gmail.com>
Subject: RE: Lucene 2.9 RC4 now available for testing
Date: Sun, 13 Sep 2009 22:22:53 +0200
Message-ID: <D45123F608F84CC68D5DEBFA9A49E10A@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AAD35BA.8090404@gmail.com>
Thread-index: Aco0nacDV6vsKELaRdCn6bFHhic06QAEdyIA
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

> Mark Miller wrote:
> > Hello Lucene users,
> >
> > ...
> >
> > We let out a bug in the lock factory changes we made in RC3 -
> > making a new SimpleFSDirectory with a String param would throw
> > an illegal state exception - a fix for this is in RC4.
> 
> My apologies - not SimpleFSDirectory, but SimpleFSLockFactory.
> 
> - Mark

And we should also add the changes to the new CharStream/CharFilters
wrappers around java.io.Reader and the related offset correction to the list
for RC4. This were also some API changes, so anybody started to use
CharFilters or own Tokenizers have to change to use
Tokenizer.correctOffset(). But we fixed bugs in Solr (Highlighting) and
backwards compatibility with it.

Uwe



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42304-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 20:26:51 2009
Return-Path: <java-user-return-42304-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45028 invoked from network); 13 Sep 2009 20:26:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 20:26:50 -0000
Received: (qmail 55073 invoked by uid 500); 13 Sep 2009 20:26:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54990 invoked by uid 500); 13 Sep 2009 20:26:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54980 invoked by uid 99); 13 Sep 2009 20:26:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 20:26:48 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 20:26:39 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 9E660D36003
	for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 22:26:16 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 2iaFiPQCA2ZG for <java-user@lucene.apache.org>;
	Sun, 13 Sep 2009 22:26:14 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 2C0DAD36001
	for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 22:26:14 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>	 <CD681DB0CB284B4B9438E2A5F47260A7@VEGA> <9cafbc680909131020x4a6bd54fn47cffae41f95fc2f@mail.gmail.com> <4AAD3577.9040403@gmail.com>
Subject: RE: Enumerating NumericField using TermEnum?
Date: Sun, 13 Sep 2009 22:26:14 +0200
Message-ID: <72177373C63F4A2F9485B39E7ED2643D@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AAD3577.9040403@gmail.com>
Thread-index: Aco0nYNAWBlxFqKrQ0687VXlzZYC2wAEnexA
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

> >> Maybe I add this t the javadocs.
> >>
> +1 - intuition might be to use it for anything numeric.

If we do not need a new RC fort hat I can do it tomorrow! I am not yet sure
what to write: I tend to say: "Use NumericField, but with infinite
precisionStep for low-cardinality fields - and you get the old TermEnum
value list as before (with conversion through NumericUtils)". In general,
users should use NumericField for numbers, but use a appropinquate precStep,
so infinite if no faster RangeQueries are possible because of low
cardinality.

Uwe


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42305-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 20:38:58 2009
Return-Path: <java-user-return-42305-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45887 invoked from network); 13 Sep 2009 20:38:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 20:38:58 -0000
Received: (qmail 58815 invoked by uid 500); 13 Sep 2009 20:38:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58725 invoked by uid 500); 13 Sep 2009 20:38:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58715 invoked by uid 99); 13 Sep 2009 20:38:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 20:38:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.221.172 as permitted sender)
Received: from [209.85.221.172] (HELO mail-qy0-f172.google.com) (209.85.221.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 20:38:45 +0000
Received: by qyk2 with SMTP id 2so2033989qyk.21
        for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 13:38:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=4uSmHN4DtXSVfHSzqYgZxpXDzVon7c1tiXUzHe9YRT4=;
        b=Rl5HDaMr+hU4s1ynzRBFmnlhyKAG3B8fCdjEU/1HP5fl6lp5NYEBWhljzK1hqkGy49
         QO7KRNRpsQ+04DDlVHs7nvzEst7W3sanvlhMhMjetJotZEB8b6zz02tMh/pc84EQ3Z/p
         LwvV7GAtGt7kmysq8gRBPXahLiwFIkWpfDge4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=BPVZ0zuTRL0Bbt1jUdhFJa/3XEeFb4mudZ7HTTBlVEfJZjTRvarXsWAL7Q9NowJFsa
         Z0aOA9DWMhIYQ74ckch04xYq5uSRoCmrYLJDKgGX+mLt2MfnitWNHjhFJs47j89C0z0T
         rewCHwvV6O2YU7AQxWl75d9/cP8SjWoWGiszw=
Received: by 10.224.81.148 with SMTP id x20mr4576493qak.156.1252874304668;
        Sun, 13 Sep 2009 13:38:24 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm5132070qwb.44.2009.09.13.13.38.22
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 13 Sep 2009 13:38:23 -0700 (PDT)
Message-ID: <4AAD5824.8020900@gmail.com>
Date: Sun, 13 Sep 2009 16:37:56 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Enumerating NumericField using TermEnum?
References: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>	 <CD681DB0CB284B4B9438E2A5F47260A7@VEGA> <9cafbc680909131020x4a6bd54fn47cffae41f95fc2f@mail.gmail.com> <4AAD3577.9040403@gmail.com> <72177373C63F4A2F9485B39E7ED2643D@VEGA>
In-Reply-To: <72177373C63F4A2F9485B39E7ED2643D@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Uwe Schindler wrote:
>>>> Maybe I add this t the javadocs.
>>>>
>>>>         
>> +1 - intuition might be to use it for anything numeric.
>>     
>
> If we do not need a new RC fort hat I can do it tomorrow! I am not yet sure
> what to write: I tend to say: "Use NumericField, but with infinite
> precisionStep for low-cardinality fields - and you get the old TermEnum
> value list as before (with conversion through NumericUtils)". In general,
> users should use NumericField for numbers, but use a appropinquate precStep,
> so infinite if no faster RangeQueries are possible because of low
> cardinality.
>
> Uwe
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   
Okay, good point. That makes sense - how about an example of low card,
just for grounding? In the hundreds? Under 10,000? Only 10's?

Also, do you mean to use Integer.Max_VALUE as infinite?

My personal opinion is that we can make javadoc changes for the final
without doing an RC, as long as no code/build/scipts at all is touched.
Not sure how others feel though.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42306-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 13 20:52:35 2009
Return-Path: <java-user-return-42306-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47636 invoked from network); 13 Sep 2009 20:52:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Sep 2009 20:52:35 -0000
Received: (qmail 69449 invoked by uid 500); 13 Sep 2009 20:52:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69358 invoked by uid 500); 13 Sep 2009 20:52:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69348 invoked by uid 99); 13 Sep 2009 20:52:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 20:52:32 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Sep 2009 20:52:23 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id A9823D36003
	for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 22:52:02 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id HmYO9pVc+4hl for <java-user@lucene.apache.org>;
	Sun, 13 Sep 2009 22:51:59 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 50B13D36001
	for <java-user@lucene.apache.org>; Sun, 13 Sep 2009 22:51:59 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>	 <CD681DB0CB284B4B9438E2A5F47260A7@VEGA> <9cafbc680909131020x4a6bd54fn47cffae41f95fc2f@mail.gmail.com> <4AAD3577.9040403@gmail.com> <72177373C63F4A2F9485B39E7ED2643D@VEGA> <4AAD5824.8020900@gmail.com>
Subject: RE: Enumerating NumericField using TermEnum?
Date: Sun, 13 Sep 2009 22:51:59 +0200
Message-ID: <1CE0367E72CB4084B00FB4BAC114A1A3@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AAD5824.8020900@gmail.com>
Thread-Index: Aco0sj3Z8EBy/8c0TtCRbUVYBiD0ngAAONEA
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

> > If we do not need a new RC fort hat I can do it tomorrow! I am not yet
> sure
> > what to write: I tend to say: "Use NumericField, but with infinite
> > precisionStep for low-cardinality fields - and you get the old TermEnum
> > value list as before (with conversion through NumericUtils)". In
> general,
> > users should use NumericField for numbers, but use a appropinquate
> precStep,
> > so infinite if no faster RangeQueries are possible because of low
> > cardinality.
>
> Okay, good point. That makes sense - how about an example of low card,
> just for grounding? In the hundreds? Under 10,000? Only 10's?

The example of Phil is good: 24 for a hour fiel dis good. I would say,
everything upto 100 is low cardinality. It does not hurt to use small
precSteps, but you loose the possibility to enumerate the terms easily. The
typical example of a drop down list filled by a list terms in the web
interface is a typical example for low cardinality. E.g. credit card
expiration,... These are no real numeric values (although "hour" is a
number), they are used as list of preselected terms (and the list is
intelligently filled by the index). I have a lot of these, but they are
mostly country names, project names, and so on (or better said: facets). So:
low cardinality lists. If you use numbers this way, you can handle them as
simple text terms (and you will not use RangeQueries on them).

> Also, do you mean to use Integer.Max_VALUE as infinite?

Yes, sorry.

> My personal opinion is that we can make javadoc changes for the final
> without doing an RC, as long as no code/build/scipts at all is touched.
> Not sure how others feel though.

I just wanted to ask for confirmation.

Uwe


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42307-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 01:49:26 2009
Return-Path: <java-user-return-42307-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96597 invoked from network); 14 Sep 2009 01:49:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 01:49:26 -0000
Received: (qmail 23708 invoked by uid 500); 14 Sep 2009 01:49:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23639 invoked by uid 500); 14 Sep 2009 01:49:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23526 invoked by uid 99); 14 Sep 2009 01:49:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 01:49:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of SGreene@metalseconomics.com designates 142.176.162.29 as permitted sender)
Received: from [142.176.162.29] (HELO mail.metalseconomics.com) (142.176.162.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 01:49:15 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: large document with multiple fields performance
Date: Sun, 13 Sep 2009 22:48:51 -0300
Message-ID: <A098673D2A673A43849164E87EB3B3610192713C@copper.meg.local>
In-reply-to: <867513fe0909081007v5a417ee4y297e33537b5cef80@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: large document with multiple fields performance
Thread-index: AcowpvfFTcZ2bWRTQQCFYd3P+OzTFQENgobA
References: <A098673D2A673A43849164E87EB3B36101926E0C@copper.meg.local> <867513fe0909080546n1271ca5er7d55d31d99fc2839@mail.gmail.com> <A098673D2A673A43849164E87EB3B36101926E3E@copper.meg.local> <867513fe0909081007v5a417ee4y297e33537b5cef80@mail.gmail.com>
From: "Stephen Greene" <SGreene@metalseconomics.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Anshum,

Thanks for your insight. I will stick with the 20 fields.=20
I realized that I had neglected to mention that in a separate query I
will search on the primary key and a search term to return details about
how many hits come from each field. Is it safe to assume that this will
also not be a problem and implementing a custom hitcollector will do the
trick?

Thanks again,

Steve=20

-----Original Message-----
From: Anshum [mailto:anshumg@gmail.com]=20
Sent: Tuesday, September 08, 2009 2:08 PM
To: java-user@lucene.apache.org
Subject: Re: large document with multiple fields performance

Hey Steve,

I'd suggest you go with the 20 fields (Non normalized) model. I've used
much
larger models and they happen to work just fine. Wouldnt be a point
increasing the complexity.
Hope that clarifies things a little atleast :)
--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Tue, Sep 8, 2009 at 6:57 PM, Stephen Greene
<SGreene@metalseconomics.com>wrote:

> Hi Anshum,
>
> Thank you for your reply. I have two options I am considering.
> One would be:
> Document {
>        String projectID;
>        String generalComment;
>        String workHistoryComment;
>        String environmentalComment;
>        String claimsComment;
>        ...
> }
>
> And the document may contain upwards of 20 comment fields.
>
> The other option would be to normalize the data
> Document {
>        String projectID;
>        String commentType;
>        String comment;
> }
>
> I will need to return only the projectID for all found documents. I
have
> implemented a custom Collector to capture the projectID for each
> document. Then it occurred to me that I might be better served by the
> normalized document model. But I am wondering which method will have
> better performance: possibly returning 20 documents per hit, or having
> to search 20 fields per document? (This also has implications for the
> query, as each search term will always search all fields, this is
> somewhat easier in the normalized example as opposed to creating 20
"or"
> queries.)
>
> Thanks,
>
> Steve
>
> -----Original Message-----
> From: Anshum [mailto:anshumg@gmail.com]
> Sent: Tuesday, September 08, 2009 9:47 AM
> To: java-user@lucene.apache.org
> Subject: Re: large document with multiple fields performance
>
> Hi Stephen,
> Could you clarify more on the requirement. Do you intend to have data
in
> index as:
> Document{
>  String Comment;
>  String CommentId;
>  String ProjectId;
> }
>
> How do you intend to index it.. as in the doc structure? Is there  a
> primary
> key there? What would you search on? What would you want to have as
the
> result?
> All said and done, its not really an overhead as long as the number of
> fields is within normal bounds.
>
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>
>
> On Tue, Sep 8, 2009 at 5:27 PM, Stephen Greene
> <SGreene@metalseconomics.com>wrote:
>
> > Hello,
> >
> >
> >
> > I am new to lucene and building an application which requires
> documents
> > with many fields to be searched.
> >
> > A "project" id is being stored (not_analyzed) and all matching
project
> > ids will be returned to be used to join other data from a database.
> >
> > Will it provide better performance to store each comment field in a
> > separate document with the project ID and a comment ID or to store
all
> > the comments for a single project in a single document with multiple
> > fields?
> >
> >
> >
> > Thanks,
> >
> >
> >
> > Steve Greene
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42308-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 12:15:19 2009
Return-Path: <java-user-return-42308-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61989 invoked from network); 14 Sep 2009 12:15:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 12:15:19 -0000
Received: (qmail 83400 invoked by uid 500); 14 Sep 2009 12:15:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83308 invoked by uid 500); 14 Sep 2009 12:15:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83298 invoked by uid 99); 14 Sep 2009 12:15:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 12:15:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 12:15:07 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MnASE-0000Cp-8f
	for java-user@lucene.apache.org; Mon, 14 Sep 2009 05:14:46 -0700
Message-ID: <25434739.post@talk.nabble.com>
Date: Mon, 14 Sep 2009 05:14:46 -0700 (PDT)
From: Hajiz <amirhos.hajiz@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Clarification about segments
In-Reply-To: <16f8407d0808251039y35a7ed26x393153c4f73fbb3b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: amirhos.hajiz@gmail.com
References: <16f8407d0808221635l4d4967b0ra0f45383b4194c6d@mail.gmail.com> <19120086.post@talk.nabble.com> <16f8407d0808251039y35a7ed26x393153c4f73fbb3b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi all,

I'm new to Lucene and to this forum too. I'm a little confused about commit
and flush concepts in Lucene. You said that after we call "commit" the
documents/segments in RAM will be wrote in disk(directory). So what is
"minMergeDocs" factor? What does it mean?

In another way, I can ask my question like this: In which conditions will
Lucene write in-memory(cached) documents into directory?

Thanks in advance.



David Lee-26 wrote:
> 
> ok, thanks. I knew that the documents were buffered in memory until they
> were flushed, but I thought that in memory, they were still separate
> documents/segments until they were merged together at the appropriate time
> (dependent on the mergeFactor).
> 
> Do you mean that when the IndexWriter flushes the documents in memory to
> the
> disk, it will merge all the documents in that flush to one segment?
> 
> Thanks!
> David
> 
> On Sat, Aug 23, 2008 at 2:40 AM, Karsten F.
> <karsten-lucene@fiz-technik.de>wrote:
> 
>>
>> Hi David,
>>
>> this is not true, please take a look to
>> IndexWriter#setRAMBufferSizeMB
>> and
>> IndexWriter#setMaxBufferedDocs
>>
>> But you can produce 9 segments (each with only one document), if you call
>> IndexWriter#flush
>> or
>> IndexWriter#commit
>> after each addDocument
>>
>> so from my knowledge about lucene there is no difference between
>> #flush
>> and
>> #optimize(getMergeFactor())
>> (btw #optimize() is equal to optimize(1) ).
>>
>>
>> Best regards
>>  Karsten
>>
>> p.s. and yes, searching goes through every segment.
>>
>>
>> David Lee-26 wrote:
>> >
>> > So from what I understand, is it true that if mergeFactor is 10, then
>> when
>> > I
>> > index my first 9 documents, I have 9 separate segments, each containing
>> 1
>> > document? And when searching, it will search through every segment?
>> >
>> > Thanks!
>> > David
>> >
>> >
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Clarification-about-segments-tp19117115p19120086.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Clarification-about-segments-tp19117115p25434739.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42309-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 16:05:03 2009
Return-Path: <java-user-return-42309-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61921 invoked from network); 14 Sep 2009 16:05:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 16:05:03 -0000
Received: (qmail 44530 invoked by uid 500); 14 Sep 2009 16:05:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44478 invoked by uid 500); 14 Sep 2009 16:05:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44467 invoked by uid 99); 14 Sep 2009 16:05:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 16:05:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [67.195.15.145] (HELO web111503.mail.gq1.yahoo.com) (67.195.15.145)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 14 Sep 2009 16:04:50 +0000
Received: (qmail 59939 invoked by uid 60001); 14 Sep 2009 16:04:28 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1252944268; bh=RPLexKFupGhtTLT7Jd2v6lg8aBxDN9OULFCTyTfNUoA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=AAURC3LeVJt9hsrz2kM97GBTcXgBYF1IisaxCQNRpOgBoESg6yoWSer/wcPZYyH83dXDieSaRB0iTbGbxWuN87RDyi/S3IQGGO+YEGwvi9Iz5/JqI3BFlmJCGk5f+9J2SQGvLo961Kg8c7KGkwTFOlrazz4ENjpzewgg97qTwh4=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=uRO+iDtpCyy9wEq9W9tegW/msZjnlJiugjQXpJyMB9SefZLQ35BVW4qQhEp7LOtMbQnx2IpON+0tkXUb4w/ahU5cCXCDyYZggQQk2XYt3HA9Qa9cWzpJloJmmP0f8TQeGXNbaVWl8HKld5Rf+pITwMQSJNjuxiEDwF8ZFQh2my0=;
Message-ID: <309714.59761.qm@web111503.mail.gq1.yahoo.com>
X-YMail-OSG: 90I48YoVM1nlijCHdoMgFfAqYAvTpDYFIgUsX8ywmmnu.VyYKPajqz5hVfyziQqQXVarPNgE2kQLd6tbqWzHEWpsAHqJDkIbsFWFG3UR0oGEbRD1o5.bbuM9DsR8SGykZzynF0RHzB056kwHzN0HgGMhNKK4d2aJmf6zpc1n5f.OQZFwlLOmR1cR6d26gHM1ETZ_X7cMydKwU7p3TGfcmF6hyUoOgATgbKRQvkm9zB.AdyWB7DrVKaBJCCxSib_cmak4KnAb8ug0GASAQPHb3e9I9LCxF.G5otf1ukHg9Zkuvr7WLtbi
Received: from [219.238.185.157] by web111503.mail.gq1.yahoo.com via HTTP; Mon, 14 Sep 2009 09:04:27 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.347.2
Date: Mon, 14 Sep 2009 09:04:27 -0700 (PDT)
From: Kerang Lv <lvkrnewer@yahoo.com>
Subject: Run your Lucene Applications on Google AppEngine with GAELucene
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Lucene users,

Enlightened by the discussion "Can I run Lucene in google app engine? [http://www.nabble.com/Can-I-run-Lucene-in-google-app-engine--td23017742.html], I implemented a google datastore based Lucene component, GAELucene, which can help you to run search applications on google app engine.

The main clazz of GAELucene include: 
    * GAEDirectory - a read only Directory based on google datastore. 
    * GAEFile - stands for an index file, the file's byte content will be splited into multi GAEFileContent. 
    * GAEFileContent - stands for a segment of index file. 
    * GAECategory - the identifier of different indices. 
    * GAEIndexInput - a memory-resident IndexInput? implementation like the RAMInputStream. 
    * GAEIndexReader - wrapper for IndexReader? that cached in GAEIndexReaderPool 
    * GAEIndexReaderPool - pool for GAEIndexReader 

The following code snippet demonstrates the use of GAELucene do searching: 
  Query queryObject = parserQuery(request);
  GAEIndexReaderPool readerPool =GAEIndexReaderPool.getInstance();
  GAEIndexReader indexReader = readerPool.borrowReader(INDEX_CATEGORY_DEMO);
  IndexSearcher searcher =newIndexSearcher(indexReader);
  Hits hits = searcher.search(queryObject);
  readerPool.returnReader(indexReader);

You can find more here 'http://code.google.com/p/gaelucene/'



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42310-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 16:14:56 2009
Return-Path: <java-user-return-42310-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66899 invoked from network); 14 Sep 2009 16:14:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 16:14:56 -0000
Received: (qmail 73961 invoked by uid 500); 14 Sep 2009 16:14:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73903 invoked by uid 500); 14 Sep 2009 16:14:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73893 invoked by uid 99); 14 Sep 2009 16:14:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 16:14:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 16:14:44 +0000
Received: by fxm18 with SMTP id 18so2555791fxm.5
        for <java-user@lucene.apache.org>; Mon, 14 Sep 2009 09:14:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=ibTlrj4vzLQwGAeE5GzLLsG4KeE9WfyozyuTj521MdQ=;
        b=NSQioU+xIkaBwrKPVMyemeS/XR51mEzo0i7xczizlZ7n9ppjfY76w8cbHClnIonC2k
         zpyUNGYkP1VZbGzlf0psMHk/clYXdp9sgt8HzBwycPo5VOr6GUCEzuf9V2ZcqOkHgjOK
         RaByFB7MQDcHasMoBx3FF1macw/BPuh6yfcoI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=rjq9pIRv3DFXYgy1YP/GRv/IV1kQKAiEFFsVwp5L5PreogeESaebuUU4XuJAyKaBxD
         6j+ZQUb58ePfQUFu8d5xZAwsebZcOASm7l9zOAgshcv6wKBPSfAMg4LI72PoSeTWW5oZ
         7sbYDKI9cxpxw2J2O70WNKpWsE/GiXh+TKIzM=
Received: by 10.86.230.27 with SMTP id c27mr5155247fgh.63.1252944862092;
        Mon, 14 Sep 2009 09:14:22 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id l12sm244928fgb.23.2009.09.14.09.14.20
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 14 Sep 2009 09:14:21 -0700 (PDT)
Message-ID: <4AAE6BDB.1030909@gmail.com>
Date: Mon, 14 Sep 2009 12:14:19 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Enumerating NumericField using TermEnum?
References: <9cafbc680909111500j156eafe3u2cfcd21b4f57ce37@mail.gmail.com>	 <CD681DB0CB284B4B9438E2A5F47260A7@VEGA> <9cafbc680909131020x4a6bd54fn47cffae41f95fc2f@mail.gmail.com> <4AAD3577.9040403@gmail.com> <72177373C63F4A2F9485B39E7ED2643D@VEGA> <4AAD5824.8020900@gmail.com> <1CE0367E72CB4084B00FB4BAC114A1A3@VEGA>
In-Reply-To: <1CE0367E72CB4084B00FB4BAC114A1A3@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Uwe Schindler wrote:
>
>> My personal opinion is that we can make javadoc changes for the final
>> without doing an RC, as long as no code/build/scipts at all is touched.
>> Not sure how others feel though.
>>     
>
> I just wanted to ask for confirmation.
>
> Uwe
>
>   
I know - we always should check for consensus, I agree. I was just giving
my piece of the consensus pie. Now we are two strong, and if no grumpy,
stickler jumps in to thwart us, I think we are good to go!

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42311-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 17:37:04 2009
Return-Path: <java-user-return-42311-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2431 invoked from network); 14 Sep 2009 17:37:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 17:37:04 -0000
Received: (qmail 40107 invoked by uid 500); 14 Sep 2009 17:37:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40048 invoked by uid 500); 14 Sep 2009 17:37:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40038 invoked by uid 99); 14 Sep 2009 17:37:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 17:37:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 17:36:51 +0000
Received: by an-out-0708.google.com with SMTP id b2so1141006ana.5
        for <java-user@lucene.apache.org>; Mon, 14 Sep 2009 10:36:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Z8w0rpus3RpueaEeUXJ1oZdFRoE+p/z5//qScCHTBTo=;
        b=FvnPyT1Jwt8/J/gKrV5fb1yiHVLgyqiRd8fEYehvuX03g+nog5IxD+uBipzd3QNTB0
         ecOHTDpshl2XHcYi2uf2NorKIlBHG68LdaFwrpe5G0qRbkbyIaOEbtC2sz7ZrRhFU4O+
         cXXtt5dBjzWo+GwqpQCmCSH4JfR1H0uC9UxR8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=gWVs+TV/WZS8dgZgGlkRc/FaIaZsZR90MdcrCsbskfEnLUpVIHgxU/UNJJdj6HsTUQ
         ov15PaY0swgrBcYDsLL5Jlt0p8baLv+Yg0veqNU+IOe5Xr61nMB1XARPKR4Gjd1+/mBx
         /3n/+5J2vzBPXAYGBGyvsKGiCEYXiMNg0E9bs=
MIME-Version: 1.0
Received: by 10.101.52.13 with SMTP id e13mr6545991ank.0.1252949790411; Mon, 
	14 Sep 2009 10:36:30 -0700 (PDT)
In-Reply-To: <4A931250.6020201@gmail.com>
References: <4A931250.6020201@gmail.com>
Date: Mon, 14 Sep 2009 10:36:30 -0700
Message-ID: <9cafbc680909141036o73d8a655wc8ec42a329c254f0@mail.gmail.com>
Subject: Re: [ANNOUNCEMENT] LucidGaze for Lucene released
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Mark,

Is there any Lucene 2.9 versions of this in development that I could
get my hands on? I'd be happy to be an alpha tester.

Cheers,
Phil

> LucidGaze for Lucene works as a drop-in replacement for the Lucene JAR;
> it requires no changes to the source code of the application, or even
> recompilation. This makes it readily usable with existing applications
> even if their source code is unavailable or difficult to change.
> LucidGaze for Lucene has been developed for enterprises that use Lucene
> without Solr. It supports Apache Lucene version 2.4.1 and later. (Mark:
> released versions only at the moment)
>
> --
> - Mark
>
> http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42312-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 18:41:46 2009
Return-Path: <java-user-return-42312-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31132 invoked from network); 14 Sep 2009 18:41:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 18:41:46 -0000
Received: (qmail 50964 invoked by uid 500); 14 Sep 2009 18:41:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50887 invoked by uid 500); 14 Sep 2009 18:41:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50868 invoked by uid 99); 14 Sep 2009 18:41:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 18:41:40 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=HS_INDEX_PARAM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of bradfordstephens@gmail.com designates 209.85.211.191 as permitted sender)
Received: from [209.85.211.191] (HELO mail-yw0-f191.google.com) (209.85.211.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 18:41:29 +0000
Received: by ywh29 with SMTP id 29so5058734ywh.23
        for <multiple recipients>; Mon, 14 Sep 2009 11:41:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=JokDMJ41Z8XoK1Tr59S71icLdvC006bf/SLmSTHnyl0=;
        b=megNJ7NuEEhwOxhfjPmlK40jEmS+IyGYxF/gbkvFojsao7neVgjpdY9w5a1I9kAoRI
         2CBXjLuZM9wJX0tItFLXLyYJ3con5iqCNcgUwYPhssph1fYLUI45CZT8ArVSXBbh8mzs
         xYHzLIy+9DBZDsXEdMssWRqJ3FU5UE/84Dk7s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=NMUJiEk6GjJtJJdbzOsPyC8x1x1srBj2CIM1CwmJkv86UffTXJg6Yzl8xriOpf/1zb
         VU0D8yAtReFymFmvPiZQMH6CjO61fSnadtoPXSPA2ypdP6Mp+x0L4zbKzendXuqyswlG
         kZWkYxjw1OQ6uZh0Vi0AHGK+sUUNMi3eWfRfo=
MIME-Version: 1.0
Received: by 10.90.182.20 with SMTP id e20mr4020460agf.106.1252953312768; Mon, 
	14 Sep 2009 11:35:12 -0700 (PDT)
Date: Mon, 14 Sep 2009 11:35:12 -0700
Message-ID: <860544ed0909141135y3e4c83a7mfd350e083e51ad11@mail.gmail.com>
Subject: Seattle / PNW Hadoop/Lucene/HBase Meetup, Wed Sep 30th
From: Bradford Stephens <bradfordstephens@gmail.com>
To: core-user@hadoop.apache.org, java-user@lucene.apache.org, 
	solr-user@lucene.apache.org, hbase-user@hadoop.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Greetings,

It's time for another Hadoop/Lucene/Apache"Cloud"  Stack meetup!
This month it'll be on Wednesday, the 30th, at 6:45 pm.

We should have a few interesting guests this time around -- someone from
Facebook may be stopping by to talk about Hive :)

We've had great attendance in the past few months, let's keep it up! I'm always
amazed by the things I learn from everyone.

We're back at the University of Washington, Allen Computer Science
Center (not Computer Engineering)
Map: http://www.washington.edu/home/maps/?CSE

Room: 303 -or- the Entry level. If there are changes, signs will be posted.

More Info:

The meetup is about 2 hours (and there's usually food): we'll have two
in-depth talks of 15-20
minutes each, and then several "lightning talks" of 5 minutes. If no
one offers, We'll then have discussion and 'social time'.  we'll just
have general discussion. Let net know if you're interested in speaking
or attending. We'd like to focus on education, so every presentation
*needs* to ask some questions at the end. We can talk about these
after the presentations, and I'll record what we've learned in a wiki
and share that with the rest of us.

Contact: Bradford Stephens, 904-415-3009, bradfordstephens@gmail.com

Cheers,
Bradford
-- 
http://www.roadtofailure.com -- The Fringes of Scalability, Social
Media, and Computer Science

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42313-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 20:03:46 2009
Return-Path: <java-user-return-42313-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59166 invoked from network); 14 Sep 2009 20:03:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 20:03:46 -0000
Received: (qmail 83553 invoked by uid 500); 14 Sep 2009 20:03:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83469 invoked by uid 500); 14 Sep 2009 20:03:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83459 invoked by uid 99); 14 Sep 2009 20:03:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 20:03:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of glen.newton@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 20:03:32 +0000
Received: by an-out-0708.google.com with SMTP id b2so1187300ana.5
        for <java-user@lucene.apache.org>; Mon, 14 Sep 2009 13:03:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=iKrg9Rxib7C8NIFmYhH0vps/xe4+is/9WovmH9VM9Gw=;
        b=DHVZUudSETTI5pGBkD45BlET1n/Lh9UZrZBkkFwoZOKzZtCsyr1uHEUcyZ0bIDmCSU
         2WapOuNrm8huBPxRkWMXV20TwE1MLgVMKjZLaY+M0wegmULFPyKa2m34ShWZGrjeFtmU
         eNrctH3xOPjXSmZHpjOnOaNsuV5PBaB/EpBeA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=L4hRANzYEcXJzE/0BrhzJHfCuecEPm85+FS7SXvMpnF04qtJI9rlpMUcr66MgS/xf/
         rVqTdC0YozFzf8oFTSDecLTFqXAgeGHzipQ4ydlgOuMYmOCy/K4B4Yft6saOpSYuWAdw
         ZzlN9EUApwB2eUGuuzHzfAi5mxTM9qcaUn4fE=
MIME-Version: 1.0
Received: by 10.101.62.6 with SMTP id p6mr5912722ank.153.1252958591152; Mon, 
	14 Sep 2009 13:03:11 -0700 (PDT)
Date: Mon, 14 Sep 2009 16:03:11 -0400
Message-ID: <5e76f3840909141303x7da19b6bmb66f31de9da6fef1@mail.gmail.com>
Subject: Field with reader limitation arbitrary
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

In 2.4.1, Field has 2 constructors that involve a Reader:
public Field(String name,
                  Reader reader)
public Field(String name,
                  Reader reader,
                  Field.TermVector termVector)

http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/document/Field.html#Field(java.lang.String,%20java.io.Reader,%20org.apache.lucene.document.Field.TermVector)

The Reader references a text file on the filesystem. These
constructors do the following:
"Create a tokenized and indexed field that is not stored, optionally
with storing term vectors. The Reader is read only when the Document
is added to the index, i.e. you may not close the Reader until
IndexWriter.addDocument(Document)  has been called."

Someone has made the decision that we will not be interested in
storing files read using a Reader (at least not with these
constructors).
This is rather arbitrary.
As someone who has massively parralelized my indexing AND sometimes
might want to also store files in the index,  having a queue of 1000
Documents with 1000 Readers to files is vastly preferable to having
1000 documents with 1000 (perhaps very large) Strings with all the
contents of the files. While this is not the best for all cases (#open
file handles, etc), this is a use case which would benefit from being
able to do this (i.e. reduced memory footprint, especially for large
files or large queues).

Suggestion: replace or add a constructor with:
public Field(String name,
             Reader reader,
             Field.Store store,
             Field.Index index,
             Field.TermVector termVector)

Constructively,

Glen Newton
 http://zzzoot.blogspot.com/
 http://lab.cisti-icist.nrc-cnrc.gc.ca/cistilabswiki/index.php/LuSql

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42314-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 21:56:49 2009
Return-Path: <java-user-return-42314-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8029 invoked from network); 14 Sep 2009 21:56:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 21:56:48 -0000
Received: (qmail 55837 invoked by uid 500); 14 Sep 2009 21:56:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55750 invoked by uid 500); 14 Sep 2009 21:56:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55740 invoked by uid 99); 14 Sep 2009 21:56:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 21:56:46 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,UNPARSEABLE_RELAY
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [129.55.12.41] (HELO ll.mit.edu) (129.55.12.41)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 21:56:37 +0000
Received: (from smtp@localhost)
	by ll.mit.edu (8.12.10/8.8.8) id n8ELpDWA001237
	for <java-user@lucene.apache.org>; Mon, 14 Sep 2009 17:51:13 -0400 (EDT)
Received: from lle2k7-hub02.llan.ll.mit.edu(            ), claiming to be "LLE2K7-HUB02.mitll.ad.local"
 via SMTP by llpost, id smtpdAAAguaq9X; Mon Sep 14 17:42:38 2009
Received: from LLE2K7-BE01.mitll.ad.local ([            ]) by
 LLE2K7-HUB02.mitll.ad.local ([            ]) with mapi; Mon, 14 Sep 2009
 17:42:38 -0400
From: "Sherrill, Delsey" <dsherrill@ll.mit.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 14 Sep 2009 17:42:36 -0400
Subject: Getting payload data in search results
Thread-Topic: Getting payload data in search results
Thread-Index: Aco1hEZNoaVnHJe7RIibyEgcN791BA==
Message-ID: <7B2F9411AE05FE44B327EF6BC4FD7A53012155565A43@LLE2K7-BE01.mitll.ad.local>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

I think I have a problem that would benefit from the new term payload featu=
re, but I'm not sure.  Every example of payload usage that I can find facto=
rs them into the scoring, but doesn't return them with the search results. =
=20

In my case, I don't need the payload to affect scoring, but I do need to ge=
t a list for each search result containing all the payloads for terms in th=
at document that matched the query.

Let's say I have the following two documents, divided into chunks as shown,=
 and the chunk ids are added as payloads on each term:
=20
DocA, chunk1: "blue blue red orange"
DocA, chunk2: "purple orange"

DocB, chunk3: "blue orange blue"
DocB, chunk4: "orange green red"
DocB, chunk5: "blue red purple"

The desired results of a search for "blue" would then be:

DocB, some score, (chunk3, chunk5)
DocA, some lower score, (chunk1)

Are payloads the right answer here?  Is there perhaps some other way to get=
 the chunk ids into my search results?

- Delsey



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42315-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 22:26:02 2009
Return-Path: <java-user-return-42315-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14872 invoked from network); 14 Sep 2009 22:26:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 22:26:02 -0000
Received: (qmail 75110 invoked by uid 500); 14 Sep 2009 22:26:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75048 invoked by uid 500); 14 Sep 2009 22:26:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75038 invoked by uid 99); 14 Sep 2009 22:25:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 22:25:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.210.194 as permitted sender)
Received: from [209.85.210.194] (HELO mail-yx0-f194.google.com) (209.85.210.194)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 22:25:48 +0000
Received: by yxe32 with SMTP id 32so213909yxe.5
        for <java-user@lucene.apache.org>; Mon, 14 Sep 2009 15:25:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=GFPn+tqH748+Td4YFf+B5NQXXZndGeWLQtBdncFvu50=;
        b=HzJvWNHzsBZGBfgUhiLa2jhNF5Yubr4QfsOGRYbI5nnXw5mQtslAomgU4sX7saJzfo
         Ql2aKJf9SrJxQ40RWkcgHjfLxdUqMeD8ArFSL9RX0b67nGZU29Y0LcA8wJtkOTtJwGD9
         DuBNoqm5S0LTT6Q4L9q7N6hsBCSZl4BgH5Wls=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=hxehNYCR+mbSzzOQ8IBFI7EWAC7Tx5x6czCBF8gGPTBpdzjhoqaeiMe+RypsYi5FOe
         955o78MqOL0dVi/jgasbGGF8VJ7pOIk1famUXz0ruq6ZEzfC5BGrCh+iGZ0tD6RtS2ps
         GLkUdQckLKTtyuz3Og5DcX5joDy1GKfuNmb4s=
MIME-Version: 1.0
Received: by 10.101.121.3 with SMTP id y3mr6839929anm.53.1252967127463; Mon, 
	14 Sep 2009 15:25:27 -0700 (PDT)
In-Reply-To: <9cafbc680909141520x7da87847pb677376a0fb1b93@mail.gmail.com>
References: <9cafbc680909141520x7da87847pb677376a0fb1b93@mail.gmail.com>
Date: Mon, 14 Sep 2009 15:25:27 -0700
Message-ID: <9cafbc680909141525g1957b51dx75a66b7262d3c73c@mail.gmail.com>
Subject: Re: Problems with IndexReader.reopen()
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry, just realised my mistake. I should read the docs more
carefully. IndexReader.reopen() does not reopen the existing
IndexReader, but returns a new one.

Phil

On Mon, Sep 14, 2009 at 3:20 PM, Phil Whelan <phil123@gmail.com> wrote:
> Hi,
>
> I'm not sure why my IndexReader.reopen() call is not working.
>
> The latest results are not coming back, meaning the reader / searcher
> has not being re-opened for the new Documents that have been added.
>
> =A0IndexReader openReader =3D searcher.getIndexReader();
> =A0searcher.close();
> =A0openReader.reopen();
> =A0searcher =3D new IndexSearcher(openReader);
>
> If I close and open the reader, I do see the updated results, but I
> thought reopen was more efficient, so I really like to use that.
>
> =A0IndexReader openReader =3D searcher.getIndexReader();
> =A0searcher.close();
> =A0openReader.close();
> =A0openReader =3D IndexReader.open(new NIOFSDirectory(indexPath), true);
> =A0searcher =3D new IndexSearcher(openReader);
>
> Any advice? (using lucene 2.9rc4)
>
> Thanks,
> Phil
>



--=20
Mobile: +1  778-233-4935
Website: http://philw.co.uk
Skype: philwhelan76
Twitter: philwhln
Email : phil123@gmail.com
iChat: philwhln@mac.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42316-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 14 22:40:40 2009
Return-Path: <java-user-return-42316-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21281 invoked from network); 14 Sep 2009 22:40:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Sep 2009 22:40:40 -0000
Received: (qmail 88611 invoked by uid 500); 14 Sep 2009 22:40:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88527 invoked by uid 500); 14 Sep 2009 22:40:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88517 invoked by uid 99); 14 Sep 2009 22:40:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 22:40:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of phil123@gmail.com designates 209.85.132.242 as permitted sender)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Sep 2009 22:40:28 +0000
Received: by an-out-0708.google.com with SMTP id b2so1230078ana.5
        for <java-user@lucene.apache.org>; Mon, 14 Sep 2009 15:30:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=WmpBiNdSTgY1lz8TPoCtPSV8zSyLe7vsoKHm4+InxYg=;
        b=qljjtIeUSHQeVosvROixHK09ZFRccFqrzgiIKddPUdMAReeFdHxPmX6CLmjtLXgOwW
         2kgrOkzyKSu9djrW2r5B4VbIbYT7S6h+OeAlXIU6M6s9XCkTPtwBO+iKB0GPsZgXZb0C
         gVOj15SVxWD8WYyMy3N3d8eYLI3gqu9YwXD7A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=iMwB9VnKgP6F7oIPbwRGJYMQTLNShRi91PU/rO4IFVXrzu8z7XjMq9CetTFs8uO4N0
         NnFY00vooRwRmu++/xYiRwKxbCtulLinabiruYHzc4jaFFht6vec0Be2lsAZqCLE2BmM
         nC2AFmvrGo0ha0RWFx4lTrciFPbZuh80x27Wk=
MIME-Version: 1.0
Received: by 10.101.86.7 with SMTP id o7mr6892631anl.39.1252966807229; Mon, 14 
	Sep 2009 15:20:07 -0700 (PDT)
Date: Mon, 14 Sep 2009 15:20:07 -0700
Message-ID: <9cafbc680909141520x7da87847pb677376a0fb1b93@mail.gmail.com>
Subject: Problems with IndexReader.reopen()
From: Phil Whelan <phil123@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I'm not sure why my IndexReader.reopen() call is not working.

The latest results are not coming back, meaning the reader / searcher
has not being re-opened for the new Documents that have been added.

  IndexReader openReader = searcher.getIndexReader();
  searcher.close();
  openReader.reopen();
  searcher = new IndexSearcher(openReader);

If I close and open the reader, I do see the updated results, but I
thought reopen was more efficient, so I really like to use that.

  IndexReader openReader = searcher.getIndexReader();
  searcher.close();
  openReader.close();
  openReader = IndexReader.open(new NIOFSDirectory(indexPath), true);
  searcher = new IndexSearcher(openReader);

Any advice? (using lucene 2.9rc4)

Thanks,
Phil

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42317-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 03:06:30 2009
Return-Path: <java-user-return-42317-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79794 invoked from network); 15 Sep 2009 03:06:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 03:06:29 -0000
Received: (qmail 66240 invoked by uid 500); 15 Sep 2009 03:06:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66053 invoked by uid 500); 15 Sep 2009 03:06:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66043 invoked by uid 99); 15 Sep 2009 03:06:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 03:06:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anthony.urso@gmail.com designates 209.85.216.176 as permitted sender)
Received: from [209.85.216.176] (HELO mail-px0-f176.google.com) (209.85.216.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 03:06:15 +0000
Received: by pxi6 with SMTP id 6so2825737pxi.21
        for <java-user@lucene.apache.org>; Mon, 14 Sep 2009 20:05:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=3nHxDH4WjvUyRrhQ7eS+s6LlvoTJ1ucSxrmkd42V7TM=;
        b=bXowoAY/e2iavqeBiZcx/TLHDFqkIKGuLrF1wQHA8j6JwFLwUAid+IfcB3elaNfhp8
         hEWhvJFWjgzjy7ts3y2YrU9M1etqmylEqoGb+MCwjasU9gf+5DJpXsMyNu9gz6/3PMUC
         QCGx9BYvjrnaH/OhIPuydVRhNbiopCM2R83Y8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=fwkPQYCsRkEGNDfhtTyzLkZj7+SXeVp11fcS3BobtLEvm/GOxiZvxrVDSn6Pi/CezA
         lf4VIQgiPW9SiEacZVUFRmPrBfPDfmtJDjw1YDZ5HU80bJo4fkfiNA/X8aGaCoKgeZX9
         +lF9waqPM3mSMZZfaoYXnuQ4UH05nkvTOcqZw=
MIME-Version: 1.0
Received: by 10.141.18.5 with SMTP id v5mr950559rvi.254.1252983953851; Mon, 14 
	Sep 2009 20:05:53 -0700 (PDT)
In-Reply-To: <5e76f3840909141303x7da19b6bmb66f31de9da6fef1@mail.gmail.com>
References: <5e76f3840909141303x7da19b6bmb66f31de9da6fef1@mail.gmail.com>
Date: Mon, 14 Sep 2009 20:05:53 -0700
Message-ID: <ba72f77f0909142005i31f77829rda8fff327bf5b5b1@mail.gmail.com>
Subject: Re: Field with reader limitation arbitrary
From: Anthony Urso <anthony.urso@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

It's best to file a feature request on the Lucene issue tracker if you
are interested in seeing this implemented.

http://issues.apache.org/jira/browse/LUCENE

Just cut and paste your description and attach a patch and/or tests if
you have them.

Cheers,
Anthony

On Mon, Sep 14, 2009 at 1:03 PM, Glen Newton <glen.newton@gmail.com> wrote:
> Hi,
>
> In 2.4.1, Field has 2 constructors that involve a Reader:
> public Field(String name,
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Reader reader)
> public Field(String name,
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Reader reader,
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0Field.TermVector termVector)
>
> http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/document/F=
ield.html#Field(java.lang.String,%20java.io.Reader,%20org.apache.lucene.doc=
ument.Field.TermVector)
>
> The Reader references a text file on the filesystem. These
> constructors do the following:
> "Create a tokenized and indexed field that is not stored, optionally
> with storing term vectors. The Reader is read only when the Document
> is added to the index, i.e. you may not close the Reader until
> IndexWriter.addDocument(Document) =A0has been called."
>
> Someone has made the decision that we will not be interested in
> storing files read using a Reader (at least not with these
> constructors).
> This is rather arbitrary.
> As someone who has massively parralelized my indexing AND sometimes
> might want to also store files in the index, =A0having a queue of 1000
> Documents with 1000 Readers to files is vastly preferable to having
> 1000 documents with 1000 (perhaps very large) Strings with all the
> contents of the files. While this is not the best for all cases (#open
> file handles, etc), this is a use case which would benefit from being
> able to do this (i.e. reduced memory footprint, especially for large
> files or large queues).
>
> Suggestion: replace or add a constructor with:
> public Field(String name,
> =A0 =A0 =A0 =A0 =A0 =A0 Reader reader,
> =A0 =A0 =A0 =A0 =A0 =A0 Field.Store store,
> =A0 =A0 =A0 =A0 =A0 =A0 Field.Index index,
> =A0 =A0 =A0 =A0 =A0 =A0 Field.TermVector termVector)
>
> Constructively,
>
> Glen Newton
> =A0http://zzzoot.blogspot.com/
> =A0http://lab.cisti-icist.nrc-cnrc.gc.ca/cistilabswiki/index.php/LuSql
>
> -
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42318-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 04:39:53 2009
Return-Path: <java-user-return-42318-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97723 invoked from network); 15 Sep 2009 04:39:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 04:39:52 -0000
Received: (qmail 25498 invoked by uid 500); 15 Sep 2009 04:39:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25422 invoked by uid 500); 15 Sep 2009 04:39:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25412 invoked by uid 99); 15 Sep 2009 04:39:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 04:39:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [122.98.10.33] (HELO KECGATE08.infosys.com) (122.98.10.33)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 04:39:39 +0000
X-TM-IMSS-Message-ID:<0026d52900000b95@KECGATE08.infosys.com>
Received: from blrkechub02.ad.infosys.com ([10.66.236.42]) by KECGATE08.infosys.com ([122.98.10.33]) with ESMTP (TREND IMSS SMTP Service 7.0) id 0026d52900000b95 ; Tue, 15 Sep 2009 10:08:58 +0530
Received: from BLRKECMBX06.ad.infosys.com ([10.66.236.32]) by
 blrkechub02.ad.infosys.com ([10.66.236.42]) with mapi; Tue, 15 Sep 2009
 10:09:17 +0530
From: Allahbaksh Mohammedali Asadullah <Allahbaksh_Asadullah@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 15 Sep 2009 10:09:16 +0530
Subject: RE: Run your Lucene Applications on Google AppEngine with GAELucene
Thread-Topic: Run your Lucene Applications on Google AppEngine with GAELucene
Thread-Index: Aco1VW0IAB3/eWQcR1mZXpDkBuv26wAaL6cg
Message-ID: <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com>
References: <309714.59761.qm@web111503.mail.gq1.yahoo.com>
In-Reply-To: <309714.59761.qm@web111503.mail.gq1.yahoo.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,
This is great news and good work. I think I will try this today evening. I =
think we should put this as one of component in lucene-contrib. What do you=
 say? Committer and owner please comment.
Regards,
Allahbaksh
=20
=20
=20
-----Original Message-----
From: Kerang Lv [mailto:lvkrnewer@yahoo.com]=20
Sent: Monday, September 14, 2009 9:34 PM
To: java-user@lucene.apache.org
Subject: Run your Lucene Applications on Google AppEngine with GAELucene

Hi Lucene users,

Enlightened by the discussion "Can I run Lucene in google app engine? [http=
://www.nabble.com/Can-I-run-Lucene-in-google-app-engine--td23017742.html], =
I implemented a google datastore based Lucene component, GAELucene, which c=
an help you to run search applications on google app engine.

The main clazz of GAELucene include:=20
    * GAEDirectory - a read only Directory based on google datastore.=20
    * GAEFile - stands for an index file, the file's byte content will be s=
plited into multi GAEFileContent.=20
    * GAEFileContent - stands for a segment of index file.=20
    * GAECategory - the identifier of different indices.=20
    * GAEIndexInput - a memory-resident IndexInput? implementation like the=
 RAMInputStream.=20
    * GAEIndexReader - wrapper for IndexReader? that cached in GAEIndexRead=
erPool=20
    * GAEIndexReaderPool - pool for GAEIndexReader=20

The following code snippet demonstrates the use of GAELucene do searching:=
=20
  Query queryObject =3D parserQuery(request);
  GAEIndexReaderPool readerPool =3DGAEIndexReaderPool.getInstance();
  GAEIndexReader indexReader =3D readerPool.borrowReader(INDEX_CATEGORY_DEM=
O);
  IndexSearcher searcher =3DnewIndexSearcher(indexReader);
  Hits hits =3D searcher.search(queryObject);
  readerPool.returnReader(indexReader);

You can find morere 'http://code.google.com/p/gaelucene/'



     =20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42319-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 08:20:16 2009
Return-Path: <java-user-return-42319-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80002 invoked from network); 15 Sep 2009 08:20:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 08:20:16 -0000
Received: (qmail 24098 invoked by uid 500); 15 Sep 2009 08:20:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24002 invoked by uid 500); 15 Sep 2009 08:20:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23992 invoked by uid 99); 15 Sep 2009 08:20:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 08:20:14 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [82.132.130.152] (HELO mail.o2.co.uk) (82.132.130.152)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 08:20:03 +0000
Received: from [192.168.60.45] (188.220.58.136) by mail.o2.co.uk (8.0.013.3) (authenticated as joelhalbert)
        id 4A4B4C711A6EE287 for java-user@lucene.apache.org; Tue, 15 Sep 2009 09:19:37 +0100
Subject: Displaying search result data - stored fields vs external source
From: Joel Halbert <joel@su3analytics.com>
To: Lucene Users <java-user@lucene.apache.org>
Content-Type: text/plain
Organization: SU3 Analytics
Date: Tue, 15 Sep 2009 09:19:50 +0100
Message-Id: <1253002790.7551.20.camel@bohr>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.3.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

When using Lucene I always consider two approaches to displaying search
result data to users:

1. Store any fields that we index and display to users in the Lucene
Documents themselves. When we perform a search simply retrieve the data
to be displayed from the Lucence documents themselves.

or

2. Index fields in Lucene but reference data to be displayed from
another source, such as a database. So, when searching I would search
for documents then use a (stored) reference key on the documents to then
lookup the display fields to display from another source e.g. a
database.

With regards to the number and size of stored fields I am looking at
indexing and displaying approximately 4 relatively small fields for each
document (e.g.  name, age, short description, URL ~ approx 500bytes in
total). In any query about 10 hits will be displayed to the user.
Approximately 10 million documents to index and search.

I am interested the differences in both approaches with regards to:

1) Indexing time performance (how long it might take to index with and
without stored fields)
2) Search time performance (total time taken to search for matching
documents and then display fields to users)

I am less interested in differences arising from
maintainability/increased storage requirements.

I would be interested to see what others  think of using each approach.

Cheers,
Joel


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42320-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 09:56:38 2009
Return-Path: <java-user-return-42320-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8134 invoked from network); 15 Sep 2009 09:56:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 09:56:37 -0000
Received: (qmail 48061 invoked by uid 500); 15 Sep 2009 09:56:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47985 invoked by uid 500); 15 Sep 2009 09:56:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47975 invoked by uid 99); 15 Sep 2009 09:56:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 09:56:35 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.198] (HELO mail-yw0-f198.google.com) (209.85.211.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 09:56:26 +0000
Received: by ywh36 with SMTP id 36so5922868ywh.21
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 02:55:04 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.243.21 with SMTP id q21mr12007289ybh.215.1253008502448; 
	Tue, 15 Sep 2009 02:55:02 -0700 (PDT)
In-Reply-To: <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com>
References: <309714.59761.qm@web111503.mail.gq1.yahoo.com>
	 <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com>
Date: Tue, 15 Sep 2009 05:55:02 -0400
Message-ID: <9ac0c6aa0909150255k48f18dfcp91df10abc0f596f2@mail.gmail.com>
Subject: Re: Run your Lucene Applications on Google AppEngine with GAELucene
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Sep 15, 2009 at 12:39 AM, Allahbaksh Mohammedali Asadullah
<Allahbaksh_Asadullah@infosys.com> wrote:

> I think we should put this as one of component in lucene-contrib.

+1, this looks like a great contribution!

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42321-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 10:05:50 2009
Return-Path: <java-user-return-42321-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10107 invoked from network); 15 Sep 2009 10:05:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 10:05:49 -0000
Received: (qmail 56322 invoked by uid 500); 15 Sep 2009 10:05:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56248 invoked by uid 500); 15 Sep 2009 10:05:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56238 invoked by uid 99); 15 Sep 2009 10:05:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 10:05:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erdincyilmazel@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 10:05:36 +0000
Received: by bwz10 with SMTP id 10so3074222bwz.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 03:05:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=rZNG0jp1SuhZL7A+cOL9PNhYTZzZSsXQcZseyE+ZINg=;
        b=J70zKZEtgu/4TAP0+iKsv8UKeRaq5HKZzlDG3lDuwk4pHUnH7oaEYLwS61/rXHDjaO
         LDxC0hb6HLcX6grRd7fe6xdsjy5uA+TtLzpZA+mAJfo72G5lV6cCseVmU+rJuVxLEABM
         LZuTysFZOmNNMoLNQi5GBYy0uFFxML6BlRJPE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=FHQ75K8d5iForx5rMa+58gAnwhcOU/3obo0EcADulLhah/Jo1COUpz4tjAsOqim4io
         n5L1HDziJqnGEYU4s3kLSVjdpIAbccm9RWPLeHDBkE7tZcT8skxXdsQ+AJmramlvuv+0
         AJ1kAOYtcK9jOE8aTkSQU+vraidjpWV/+B1ow=
MIME-Version: 1.0
Received: by 10.223.97.132 with SMTP id l4mr2407290fan.100.1253009115800; Tue, 
	15 Sep 2009 03:05:15 -0700 (PDT)
In-Reply-To: <309714.59761.qm@web111503.mail.gq1.yahoo.com>
References: <309714.59761.qm@web111503.mail.gq1.yahoo.com>
Date: Tue, 15 Sep 2009 11:05:15 +0100
Message-ID: <7af3bac90909150305t6583e36aidc2bb63584665f76@mail.gmail.com>
Subject: Re: Run your Lucene Applications on Google AppEngine with GAELucene
From: Erdinc Yilmazel <erdincyilmazel@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174bdcc83f664004739aeb2b
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174bdcc83f664004739aeb2b
Content-Type: text/plain; charset=ISO-8859-1

This is great news! Are you happy with the the performance of the google
data store? Do you plan to support in memory indexes using the memcache api?

Thanks

On Mon, Sep 14, 2009 at 5:04 PM, Kerang Lv <lvkrnewer@yahoo.com> wrote:

> Hi Lucene users,
>
> Enlightened by the discussion "Can I run Lucene in google app engine? [
> http://www.nabble.com/Can-I-run-Lucene-in-google-app-engine--td23017742.html],
> I implemented a google datastore based Lucene component, GAELucene, which
> can help you to run search applications on google app engine.
>
> The main clazz of GAELucene include:
>    * GAEDirectory - a read only Directory based on google datastore.
>    * GAEFile - stands for an index file, the file's byte content will be
> splited into multi GAEFileContent.
>    * GAEFileContent - stands for a segment of index file.
>    * GAECategory - the identifier of different indices.
>    * GAEIndexInput - a memory-resident IndexInput? implementation like the
> RAMInputStream.
>    * GAEIndexReader - wrapper for IndexReader? that cached in
> GAEIndexReaderPool
>    * GAEIndexReaderPool - pool for GAEIndexReader
>
> The following code snippet demonstrates the use of GAELucene do searching:
>  Query queryObject = parserQuery(request);
>  GAEIndexReaderPool readerPool =GAEIndexReaderPool.getInstance();
>  GAEIndexReader indexReader = readerPool.borrowReader(INDEX_CATEGORY_DEMO);
>  IndexSearcher searcher =newIndexSearcher(indexReader);
>  Hits hits = searcher.search(queryObject);
>  readerPool.returnReader(indexReader);
>
> You can find more here 'http://code.google.com/p/gaelucene/'
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174bdcc83f664004739aeb2b--

From java-user-return-42322-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 12:20:00 2009
Return-Path: <java-user-return-42322-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55118 invoked from network); 15 Sep 2009 12:19:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 12:19:59 -0000
Received: (qmail 40510 invoked by uid 500); 15 Sep 2009 12:19:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40446 invoked by uid 500); 15 Sep 2009 12:19:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40434 invoked by uid 99); 15 Sep 2009 12:19:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 12:19:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mathias.bank@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 12:19:48 +0000
Received: by ewy28 with SMTP id 28so74134ewy.28
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 05:19:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=aYklciFNmmiMlP4QN/PMAYni9h1a600IBJ0VX0CigCU=;
        b=hbx26vLGTiXz0UgNtWCkoNsJi2Wge+HsapfuicJlse7sw8N9CPv5TchnRSVHnx5DO+
         Ywr0cq5ZIrolJUqLWt9xqh6YYJcFJ1L8QJ2AMN61Z/m5gOYPkfYd01ubuHNbmiHvrX4b
         cm7Oa1wKLIISBr+50pFcY8Cmo+jwETxjj3WWQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=JoheoXZ/l2dokgD+50RX2u5gt1eg5JonJjUtuaJbiFwnERNMgUWAlB9TLrPEc5xA92
         YPG6dyO+obNp8dMWU3qgP4wxnwSAiWZwEyjXoeDFgjouZT9RR2KqDHgGYP3d1FIYTZIs
         jPf8L2EWisda59+LNOCWv/nEmCHGD6y8y0uSI=
MIME-Version: 1.0
Received: by 10.216.30.4 with SMTP id j4mr1574691wea.16.1253017167884; Tue, 15 
	Sep 2009 05:19:27 -0700 (PDT)
Date: Tue, 15 Sep 2009 14:19:27 +0200
Message-ID: <53480e280909150519y2f5dfce8l4a2166ffd86706f1@mail.gmail.com>
Subject: Counting search results
From: Mathias Bank <mathias.bank@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

I'm trying to find the number of documents for a specific term to
create text statistics. I'm not interested in ordering the results or
even recieving the first result. I just need the number of results.

Currently, I'm trying to do this by using the lucene searcher class:

IndexSearcher searcher = new IndexSearcher(reader);
String queryString = fieldname+":" + term;
QueryParser parser = new QueryParser(fieldname, new GermanAnalyzer());
TopDocs d = searcher.search(parser.parse(queryString), filter, 1);
int count = d.totalHits;

The problem is, that there is a large index (optimized) with > 8 mio.
entries. One search could return a large number of search results (> 1
mio). Currently these search tasks take more than 15 secunds.

The question is: is there any way to get the number of search results
faster? I think, that it could be optimized by not using a Weight
object (order is not interesting), but I haven't seen a way to do
this.

I hope, someone has already solved this problem.

Mathias

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42323-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 12:33:55 2009
Return-Path: <java-user-return-42323-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59159 invoked from network); 15 Sep 2009 12:33:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 12:33:55 -0000
Received: (qmail 60044 invoked by uid 500); 15 Sep 2009 12:33:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59957 invoked by uid 500); 15 Sep 2009 12:33:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59947 invoked by uid 99); 15 Sep 2009 12:33:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 12:33:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [122.98.10.33] (HELO KECGATE08.infosys.com) (122.98.10.33)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 12:33:43 +0000
X-TM-IMSS-Message-ID:<01d8de81000095b8@KECGATE08.infosys.com>
Received: from blrkechub03.ad.infosys.com ([10.66.236.43]) by KECGATE08.infosys.com ([122.98.10.33]) with ESMTP (TREND IMSS SMTP Service 7.0) id 01d8de81000095b8 ; Tue, 15 Sep 2009 18:03:03 +0530
Received: from BLRKECMBX06.ad.infosys.com ([10.66.236.32]) by
 blrkechub03.ad.infosys.com ([10.66.236.43]) with mapi; Tue, 15 Sep 2009
 18:03:21 +0530
From: Allahbaksh Mohammedali Asadullah <Allahbaksh_Asadullah@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 15 Sep 2009 18:03:20 +0530
Subject: RE: Run your Lucene Applications on Google AppEngine with GAELucene
Thread-Topic: Run your Lucene Applications on Google AppEngine with GAELucene
Thread-Index: Aco16tLQ21tcQ3hSTZGRm8CaKPMMmgAFVr7g
Message-ID: <68959F25CDEBCB4F917D5A253291D73E0EFC2F72AE@BLRKECMBX06.ad.infosys.com>
References: <309714.59761.qm@web111503.mail.gq1.yahoo.com>
	 <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com>
 <9ac0c6aa0909150255k48f18dfcp91df10abc0f596f2@mail.gmail.com>
In-Reply-To: <9ac0c6aa0909150255k48f18dfcp91df10abc0f596f2@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org


HI Mike,
I think adding this in Lucene 3.0 contrib would be the best we could do. I =
think we could add it in Lucene 2.9 Release as it would grow the community =
and we would also able to find some nice practices, bugs, improvement and t=
hat would make it better in upcoming release.=20

Regards,
Allahbaksh

-----Original Message----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Tuesday, September 15, 2009 3:25 PM
To: java-user@lucene.apache.org
Subject: Re: Run your Lucene Applications on Google AppEngine with GAELucen=
e

On Tue, Sep 15, 2009 at 12:39 AM, Allahbaksh Mohammedali Asadullah
<Allahbaksh_Asadullah@infosys.com> wrote:

> I think we should put this as one of component in lucene-contrib.

+1, this looks like a great contribution!

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42324-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 12:34:24 2009
Return-Path: <java-user-return-42324-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59311 invoked from network); 15 Sep 2009 12:34:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 12:34:24 -0000
Received: (qmail 62496 invoked by uid 500); 15 Sep 2009 12:34:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62423 invoked by uid 500); 15 Sep 2009 12:34:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62413 invoked by uid 99); 15 Sep 2009 12:34:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 12:34:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of glen.newton@gmail.com designates 209.85.132.245 as permitted sender)
Received: from [209.85.132.245] (HELO an-out-0708.google.com) (209.85.132.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 12:34:10 +0000
Received: by an-out-0708.google.com with SMTP id b2so1413235ana.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 05:32:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=sa+NaaSrBsNiMWesE7NfcOIRXY5qXUiliLDMuwyVZzg=;
        b=PTpF8IaU6dG+QbmCWKR1GcqF2ZTwSzG9Bxc+k13yrjBwTPcJCjSTy0gy6m4gtbS20n
         QanFLezB6ldyv9j8pSzBRUM9su/2TAyhSPArqQz/cYr9QTHH0C88Eg2VfC2qktopZf9R
         qkhbfT/hy3e4TYUGG2T0X9mOhYZ8MrWJsTAe8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=Owh1m0ugoZabT2TnEbyucukY4Ljma3brQYejoHpcaGuw/Zav8bdDZERI281o/Z6knX
         wkQqu5QY9VsXhbPVccVIUb5Jje+i3hjLBZPvWi1W7qC0YfmvxY+OUM1Z5AssKez5ygJG
         yFlESlEBQAi/Rj1vc+iH+MaOdsUozdItbRjgo=
MIME-Version: 1.0
Received: by 10.101.166.10 with SMTP id t10mr1810009ano.143.1253017969153; 
	Tue, 15 Sep 2009 05:32:49 -0700 (PDT)
In-Reply-To: <ba72f77f0909142005i31f77829rda8fff327bf5b5b1@mail.gmail.com>
References: <5e76f3840909141303x7da19b6bmb66f31de9da6fef1@mail.gmail.com>
	 <ba72f77f0909142005i31f77829rda8fff327bf5b5b1@mail.gmail.com>
Date: Tue, 15 Sep 2009 08:32:49 -0400
Message-ID: <5e76f3840909150532s4583376k47d0023198a61c23@mail.gmail.com>
Subject: Re: Field with reader limitation arbitrary
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

OK, thanks. :-)

Glen

2009/9/14 Anthony Urso <anthony.urso@gmail.com>:
> It's best to file a feature request on the Lucene issue tracker if you
> are interested in seeing this implemented.
>
> http://issues.apache.org/jira/browse/LUCENE
>
> Just cut and paste your description and attach a patch and/or tests if
> you have them.
>
> Cheers,
> Anthony
>
> On Mon, Sep 14, 2009 at 1:03 PM, Glen Newton <glen.newton@gmail.com> wrot=
e:
>> Hi,
>>
>> In 2.4.1, Field has 2 constructors that involve a Reader:
>> public Field(String name,
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Reader rea=
der)
>> public Field(String name,
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Reader rea=
der,
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Field.Term=
Vector termVector)
>>
>> http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/document/=
Field.html#Field(java.lang.String,%20java.io.Reader,%20org.apache.lucene.do=
cument.Field.TermVector)
>>
>> The Reader references a text file on the filesystem. These
>> constructors do the following:
>> "Create a tokenized and indexed field that is not stored, optionally
>> with storing term vectors. The Reader is read only when the Document
>> is added to the index, i.e. you may not close the Reader until
>> IndexWriter.addDocument(Document) =C2=A0has been called."
>>
>> Someone has made the decision that we will not be interested in
>> storing files read using a Reader (at least not with these
>> constructors).
>> This is rather arbitrary.
>> As someone who has massively parralelized my indexing AND sometimes
>> might want to also store files in the index, =C2=A0having a queue of 100=
0
>> Documents with 1000 Readers to files is vastly preferable to having
>> 1000 documents with 1000 (perhaps very large) Strings with all the
>> contents of the files. While this is not the best for all cases (#open
>> file handles, etc), this is a use case which would benefit from being
>> able to do this (i.e. reduced memory footprint, especially for large
>> files or large queues).
>>
>> Suggestion: replace or add a constructor with:
>> public Field(String name,
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Reader reader,
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Field.Store store,
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Field.Index index,
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 Field.TermVector termVector)
>>
>> Constructively,
>>
>> Glen Newton
>> =C2=A0http://zzzoot.blogspot.com/
>> =C2=A0http://lab.cisti-icist.nrc-cnrc.gc.ca/cistilabswiki/index.php/LuSq=
l
>>
>> -
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42325-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 12:37:17 2009
Return-Path: <java-user-return-42325-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60372 invoked from network); 15 Sep 2009 12:37:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 12:37:17 -0000
Received: (qmail 68137 invoked by uid 500); 15 Sep 2009 12:37:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68064 invoked by uid 500); 15 Sep 2009 12:37:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68054 invoked by uid 99); 15 Sep 2009 12:37:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 12:37:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 12:37:03 +0000
Received: by fxm18 with SMTP id 18so3184446fxm.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 05:36:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type;
        bh=2XPPkGEHKeevzml+glwVmIr1hEjjh5NGvyuouzl1Tg0=;
        b=QMOz0XZ00P0j56QjLb162F57DOeDmF0ntTLyBNkQKhnIijnG4znkH2O4QStcYaTlm+
         w6Jz6kg2fGKLSHgwq8i2HvcpyZTQTK5sUIiBHAM3TMiq7SaKJcwC6RnGDLDaDZsh0GWf
         OGRxlNlSy/q03GJT3TNRCBGm88km7dCz19+58=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type;
        b=knq3kXBTgyqEK6Ye0Mx3naMc32VUy8LhZxM2bWmyRiSEtvyGuSbqljmCkFVvDIu2JF
         kaEcjT/DvxUGSus8bA8TN2xeIHstvEtFujZGlYkc5cHID0kGikMMdjUtqOHU6oF/MX9p
         ibzxDyCwsuZR2npCdmnmqV8+xnSY8UGM4t66A=
MIME-Version: 1.0
Received: by 10.239.183.17 with SMTP id s17mr633729hbg.172.1253018202756; Tue, 
	15 Sep 2009 05:36:42 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <53480e280909150519y2f5dfce8l4a2166ffd86706f1@mail.gmail.com>
References: <53480e280909150519y2f5dfce8l4a2166ffd86706f1@mail.gmail.com>
Date: Tue, 15 Sep 2009 14:36:42 +0200
Message-ID: <f18c9dde0909150536s401f4bb9r16a75336bb852238@mail.gmail.com>
Subject: Re: Counting search results
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Did you try:
int numDocs
TermDocs termDocs = reader.termDocs(new Term("myField", "myTerm"));
while (termDocs.next()) { numDocs++; }

simon

On Tue, Sep 15, 2009 at 2:19 PM, Mathias Bank <mathias.bank@gmail.com> wrote:
> Hello,
>
> I'm trying to find the number of documents for a specific term to
> create text statistics. I'm not interested in ordering the results or
> even recieving the first result. I just need the number of results.
>
> Currently, I'm trying to do this by using the lucene searcher class:
>
> IndexSearcher searcher = new IndexSearcher(reader);
> String queryString = fieldname+":" + term;
> QueryParser parser = new QueryParser(fieldname, new GermanAnalyzer());
> TopDocs d = searcher.search(parser.parse(queryString), filter, 1);
> int count = d.totalHits;
>
> The problem is, that there is a large index (optimized) with > 8 mio.
> entries. One search could return a large number of search results (> 1
> mio). Currently these search tasks take more than 15 secunds.
>
> The question is: is there any way to get the number of search results
> faster? I think, that it could be optimized by not using a Weight
> object (order is not interesting), but I haven't seen a way to do
> this.
>
> I hope, someone has already solved this problem.
>
> Mathias
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42326-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 13:27:59 2009
Return-Path: <java-user-return-42326-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78209 invoked from network); 15 Sep 2009 13:27:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 13:27:59 -0000
Received: (qmail 67263 invoked by uid 500); 15 Sep 2009 13:27:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67194 invoked by uid 500); 15 Sep 2009 13:27:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67184 invoked by uid 99); 15 Sep 2009 13:27:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:27:56 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:27:42 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n8FDQ7rQ030740
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 14:26:07 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.4.5.13150)
    via ESMTP; Tue, 15 Sep 2009 14:26:06 +0100 (BST)
Date: Tue, 15 Sep 2009 14:26:06 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <1402026381.8381253021166639.JavaMail.root@mail.uk.scalix.com>
Subject: RE: New "Stream closed" exception with Java 6
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Mark

It appears you are right - it *IS* something tricky.  My code is single threaded, so there is no contention.  I still get intermittent "Stream Close" exceptions (about 1 in every 800 indexWriter.addDocument() calls) which I cannot explain.  By moving code around / recompiling, I have managed successful test runs where I get none, but now I have added some more logging code, the problem has come back  :-(
I feel like I have wasted the last 10 days chasing shadows and am no further forward.  

My assumption is that 2.4 is stable (we are moving from 2.0 to 2.4 at present) - should I reconsider that assumption?

Thanks for any ideas.

- Chris

----- Original Message -----
From: Mark Miller <markrmiller@gmail.com>
Sent: Tue, 8/9/2009 8:06pm
To: java-user@lucene.apache.org
Subject: Re: New "Stream closed" exception with Java 6

Chris Hostetter wrote:
> : I'm coming to the same conclusion - there must be >1 threads accessing this index at the same time.  Better go figure it out  ...  :-)
>
> careful about your assumptions ... you could get this same type of 
> exception even with only one thread, the stream that's being closed isn't 
> internal to Lucene, it's the InputStreamReader you supplied as the value 
> of some Field.  it's possibly you just have a simple bug where you are 
> closing hte reader before you pass it to Lucene, or maybe you are 
> mistakenly adding the saame field twice (or in two different documents)
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   
Its possible its something tricky. When I was converting the Highlighter
to the new TokenStream API, I started to
get this exception in the Highlighter rewrite test - everything else
passed, but this was failing. I couldn't figure it out - and
before I could find the root cause, all the tests started passing
(perhaps from changing code doing other things, rebuilding, or who knows
- I don't have a clue). I couldn't get it to fail again after that.

Not very helpful - but just to note, there were not multiple threads
involved concurrently, nor multiple Writers.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42327-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 13:30:49 2009
Return-Path: <java-user-return-42327-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79174 invoked from network); 15 Sep 2009 13:30:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 13:30:49 -0000
Received: (qmail 74286 invoked by uid 500); 15 Sep 2009 13:30:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74211 invoked by uid 500); 15 Sep 2009 13:30:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74201 invoked by uid 99); 15 Sep 2009 13:30:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:30:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:30:35 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FDUEDv032057
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 15:30:15 +0200
Message-ID: <4AAF96E6.7000909@net-m.de>
Date: Tue, 15 Sep 2009 15:30:14 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: lucene 2.9.0RC4 slower than 2.4.1?
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 15:30:15 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9806/Mon Sep 14 20:37:58 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

I'm experiencing a performance degradation after migrating to 2.9 and running
some tests. I'm getting out of ideas and any help to identify the reasons why
2.9 is slower than 2.4 are highly appreciated.

We've had some issues with custom sorting in lucene 2.4.1. We worked around them
by sorting the resultsets manually and caching the results after sorting (memory
consuming but fast).

I now migrated to lucene 2.9.0RC4. Build some new FieldComparatorSource
implementation for sorting and refactored all deprecated api calls to the new
lucene 2.9 api.

Everything works fine from a functional perspective. But performance severly is
(negatively) affected by lucene 2.9.

I profiled the application for a couple of hours, build a jmeter load test and
compared the following scenarios:

1. lucene 2.9 - new api
2. lucene 2.9 - old api and custom sorting after lucene
3. lucene 2.4.1 - old api and custom sorting after lucene (what we had up2now)

Please find attached an rrd graph showing the results. The lighter the color the
faster the request has been served. y=# requests, x=time.

Most interestingly simply switching the lucene jars between 2.4 and 2.9 degraded
response times and therefore throughput (see results of testcase 2 and 3).
Adapting to the new api decreased performance again. The difference between
testcase 1 and 2 is most probably due to precached custom sorted results.

The application under test is a dedicated lucene search engine doing nothing
else, but serving search requests. We're running a cluster of them in prd and
it's incredibly fast. With the old implementation and prd traffic we've above
98% of the requests served in 200ms.
The index under test contains about 3 million documents (with lots of fields),
consumes about 2,5gig disk space and is stored on a tmpfs RAMDISK provided by
the linux kernel.

Most interesting methods used for searching are:

getHitsCount (is there a way to speed this up?):

	public int getHitsCount(String query, Filter filter) throws
LuceneServiceException {
		log.debug("getHitsCount('{}, {}')", query, filter);
		if (StringUtils.isBlank(query)) {
			log.warn("getHitsCount: empty lucene query");
			return 0;
		}
		long startTimeMillis = System.currentTimeMillis();
		int count = 0;

		if (indexSearcher == null) {
			return 0;
		}

		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
		Query q = null;
		try {
			q = createQuery(query);
			TopScoreDocCollector tsdc = TopScoreDocCollector.create(1, true);
			indexSearcher.search(q, filter, tsdc);
			count = tsdc.getTotalHits();
			log.info("getHitsCount: count = {}",count);
		} catch (ParseException ex) {
			throw new LuceneServiceException("invalid lucene query:" + query, ex);
		} catch (IOException e) {
			throw new LuceneServiceException(" indexSearcher could be corrupted", e);
		} finally {
			long durationMillis = System.currentTimeMillis() - startTimeMillis;
			if (durationMillis > slowQueryLimit) {
				log.warn("getHitsCount: Slow query: {} ms, query={}", durationMillis, query);
			}
			log.debug("getHitsCount: query took {} ms", durationMillis);
		}
		return count;
	}

search:
	public List<Document> search(String query, Filter filter, Sort sort, int from,
int size) throws LuceneServiceException {
		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] { indexAlias, query,
filter, sort, from, size });
		long startTimeMillis = System.currentTimeMillis();

		List<Document> docs = new ArrayList<Document>();
		if (indexSearcher == null) {
			return docs;
		}
		Query q = null;
		try {
			if (query == null) {
				log.warn("search: lucene query is null...");
				return docs;
			}
			q = createQuery(query);
			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
			if (size < 0 || size > maxNumHits) {
				// set hard limit for numHits
				size = maxNumHits;
				if (log.isDebugEnabled())
					log.debug("search: Size set to hardlimit: {} for query: {} with filter:
{}", new Object[] { size, query, filter });
			}
			TopFieldCollector collector = TopFieldCollector.create(sort, size + from,
true, false, false, true);
			indexSearcher.search(q, filter, collector);
			if(size > collector.getTotalHits())
				size = collector.getTotalHits();
			if (size > 100000)
				log.info("search: size: {} bigger than 100.000 for query: {} with filter:
{}", new Object[] { size, query, filter });
			TopDocs td = collector.topDocs(from, size);
			ScoreDoc[] scoreDocs = td.scoreDocs;
			for (ScoreDoc scoreDoc : scoreDocs) {
				docs.add(indexSearcher.doc(scoreDoc.doc));
			}
		} catch (ParseException e) {
			log.warn("search: ParseException: {}", e.getMessage());
			if (log.isDebugEnabled())
				log.warn("search: ParseException: ", e);
			return Collections.emptyList();
		} catch (IOException e) {
			log.warn("search: IOException: ", e);
			return Collections.emptyList();
		} finally {
			long durationMillis = System.currentTimeMillis() - startTimeMillis;
			if (durationMillis > slowQueryLimit) {
				log.warn("search: Slow query: {} ms, query={}, indexUsed={}",
						new Object[] { durationMillis, query,
indexSearcher.getIndexReader().directory() });
			}
			log.debug("search: query took {} ms", durationMillis);
		}
		return docs;
	}

I'm wondering why others are experiencing better performance with 2.9 and why
our implementations performance is going bad. Maybe our way of using the 2.9 api
is not the best and sorting is definetly expensive.

Any ideas are appreciated. I'm torning out my hair since hours and days to find
the root cause. Also hints how I could find the bottlenecks myself are appreciated.

Cheers,
Thomas

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42328-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 13:31:24 2009
Return-Path: <java-user-return-42328-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79263 invoked from network); 15 Sep 2009 13:31:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 13:31:24 -0000
Received: (qmail 76076 invoked by uid 500); 15 Sep 2009 13:31:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75992 invoked by uid 500); 15 Sep 2009 13:31:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75964 invoked by uid 99); 15 Sep 2009 13:31:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:31:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:31:02 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FDUfHp032128
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 15:30:41 +0200
Message-ID: <4AAF9700.9010509@net-m.de>
Date: Tue, 15 Sep 2009 15:30:40 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de>
In-Reply-To: <4AAF96E6.7000909@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: multipart/mixed;
 boundary="------------050709040705060101030103"
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 15:30:41 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9806/Mon Sep 14 20:37:58 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

--------------050709040705060101030103
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit

Missed the attachment, sorry.

Thomas Becker wrote:
> Hi all,
> 
> I'm experiencing a performance degradation after migrating to 2.9 and running
> some tests. I'm getting out of ideas and any help to identify the reasons why
> 2.9 is slower than 2.4 are highly appreciated.
> 
> We've had some issues with custom sorting in lucene 2.4.1. We worked around them
> by sorting the resultsets manually and caching the results after sorting (memory
> consuming but fast).
> 
> I now migrated to lucene 2.9.0RC4. Build some new FieldComparatorSource
> implementation for sorting and refactored all deprecated api calls to the new
> lucene 2.9 api.
> 
> Everything works fine from a functional perspective. But performance severly is
> (negatively) affected by lucene 2.9.
> 
> I profiled the application for a couple of hours, build a jmeter load test and
> compared the following scenarios:
> 
> 1. lucene 2.9 - new api
> 2. lucene 2.9 - old api and custom sorting after lucene
> 3. lucene 2.4.1 - old api and custom sorting after lucene (what we had up2now)
> 
> Please find attached an rrd graph showing the results. The lighter the color the
> faster the request has been served. y=# requests, x=time.
> 
> Most interestingly simply switching the lucene jars between 2.4 and 2.9 degraded
> response times and therefore throughput (see results of testcase 2 and 3).
> Adapting to the new api decreased performance again. The difference between
> testcase 1 and 2 is most probably due to precached custom sorted results.
> 
> The application under test is a dedicated lucene search engine doing nothing
> else, but serving search requests. We're running a cluster of them in prd and
> it's incredibly fast. With the old implementation and prd traffic we've above
> 98% of the requests served in 200ms.
> The index under test contains about 3 million documents (with lots of fields),
> consumes about 2,5gig disk space and is stored on a tmpfs RAMDISK provided by
> the linux kernel.
> 
> Most interesting methods used for searching are:
> 
> getHitsCount (is there a way to speed this up?):
> 
> 	public int getHitsCount(String query, Filter filter) throws
> LuceneServiceException {
> 		log.debug("getHitsCount('{}, {}')", query, filter);
> 		if (StringUtils.isBlank(query)) {
> 			log.warn("getHitsCount: empty lucene query");
> 			return 0;
> 		}
> 		long startTimeMillis = System.currentTimeMillis();
> 		int count = 0;
> 
> 		if (indexSearcher == null) {
> 			return 0;
> 		}
> 
> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
> 		Query q = null;
> 		try {
> 			q = createQuery(query);
> 			TopScoreDocCollector tsdc = TopScoreDocCollector.create(1, true);
> 			indexSearcher.search(q, filter, tsdc);
> 			count = tsdc.getTotalHits();
> 			log.info("getHitsCount: count = {}",count);
> 		} catch (ParseException ex) {
> 			throw new LuceneServiceException("invalid lucene query:" + query, ex);
> 		} catch (IOException e) {
> 			throw new LuceneServiceException(" indexSearcher could be corrupted", e);
> 		} finally {
> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
> 			if (durationMillis > slowQueryLimit) {
> 				log.warn("getHitsCount: Slow query: {} ms, query={}", durationMillis, query);
> 			}
> 			log.debug("getHitsCount: query took {} ms", durationMillis);
> 		}
> 		return count;
> 	}
> 
> search:
> 	public List<Document> search(String query, Filter filter, Sort sort, int from,
> int size) throws LuceneServiceException {
> 		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] { indexAlias, query,
> filter, sort, from, size });
> 		long startTimeMillis = System.currentTimeMillis();
> 
> 		List<Document> docs = new ArrayList<Document>();
> 		if (indexSearcher == null) {
> 			return docs;
> 		}
> 		Query q = null;
> 		try {
> 			if (query == null) {
> 				log.warn("search: lucene query is null...");
> 				return docs;
> 			}
> 			q = createQuery(query);
> 			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
> 			if (size < 0 || size > maxNumHits) {
> 				// set hard limit for numHits
> 				size = maxNumHits;
> 				if (log.isDebugEnabled())
> 					log.debug("search: Size set to hardlimit: {} for query: {} with filter:
> {}", new Object[] { size, query, filter });
> 			}
> 			TopFieldCollector collector = TopFieldCollector.create(sort, size + from,
> true, false, false, true);
> 			indexSearcher.search(q, filter, collector);
> 			if(size > collector.getTotalHits())
> 				size = collector.getTotalHits();
> 			if (size > 100000)
> 				log.info("search: size: {} bigger than 100.000 for query: {} with filter:
> {}", new Object[] { size, query, filter });
> 			TopDocs td = collector.topDocs(from, size);
> 			ScoreDoc[] scoreDocs = td.scoreDocs;
> 			for (ScoreDoc scoreDoc : scoreDocs) {
> 				docs.add(indexSearcher.doc(scoreDoc.doc));
> 			}
> 		} catch (ParseException e) {
> 			log.warn("search: ParseException: {}", e.getMessage());
> 			if (log.isDebugEnabled())
> 				log.warn("search: ParseException: ", e);
> 			return Collections.emptyList();
> 		} catch (IOException e) {
> 			log.warn("search: IOException: ", e);
> 			return Collections.emptyList();
> 		} finally {
> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
> 			if (durationMillis > slowQueryLimit) {
> 				log.warn("search: Slow query: {} ms, query={}, indexUsed={}",
> 						new Object[] { durationMillis, query,
> indexSearcher.getIndexReader().directory() });
> 			}
> 			log.debug("search: query took {} ms", durationMillis);
> 		}
> 		return docs;
> 	}
> 
> I'm wondering why others are experiencing better performance with 2.9 and why
> our implementations performance is going bad. Maybe our way of using the 2.9 api
> is not the best and sorting is definetly expensive.
> 
> Any ideas are appreciated. I'm torning out my hair since hours and days to find
> the root cause. Also hints how I could find the bottlenecks myself are appreciated.
> 
> Cheers,
> Thomas
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem


--------------050709040705060101030103
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--------------050709040705060101030103--

From java-user-return-42329-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 13:39:01 2009
Return-Path: <java-user-return-42329-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82838 invoked from network); 15 Sep 2009 13:39:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 13:39:01 -0000
Received: (qmail 98148 invoked by uid 500); 15 Sep 2009 13:38:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98115 invoked by uid 500); 15 Sep 2009 13:38:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98105 invoked by uid 99); 15 Sep 2009 13:38:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:38:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:38:47 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FDcQ2p000959
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 15:38:26 +0200
Message-ID: <4AAF98D1.5010207@net-m.de>
Date: Tue, 15 Sep 2009 15:38:25 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de>
In-Reply-To: <4AAF9700.9010509@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 15:38:26 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9806/Mon Sep 14 20:37:58 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Urm and uploaded here:
http://ankeschwarzer.de/tmp/graph.jpg

Sorry.

Thomas Becker wrote:
> Missed the attachment, sorry.
> 
> Thomas Becker wrote:
>> Hi all,
>>
>> I'm experiencing a performance degradation after migrating to 2.9 and running
>> some tests. I'm getting out of ideas and any help to identify the reasons why
>> 2.9 is slower than 2.4 are highly appreciated.
>>
>> We've had some issues with custom sorting in lucene 2.4.1. We worked around them
>> by sorting the resultsets manually and caching the results after sorting (memory
>> consuming but fast).
>>
>> I now migrated to lucene 2.9.0RC4. Build some new FieldComparatorSource
>> implementation for sorting and refactored all deprecated api calls to the new
>> lucene 2.9 api.
>>
>> Everything works fine from a functional perspective. But performance severly is
>> (negatively) affected by lucene 2.9.
>>
>> I profiled the application for a couple of hours, build a jmeter load test and
>> compared the following scenarios:
>>
>> 1. lucene 2.9 - new api
>> 2. lucene 2.9 - old api and custom sorting after lucene
>> 3. lucene 2.4.1 - old api and custom sorting after lucene (what we had up2now)
>>
>> Please find attached an rrd graph showing the results. The lighter the color the
>> faster the request has been served. y=# requests, x=time.
>>
>> Most interestingly simply switching the lucene jars between 2.4 and 2.9 degraded
>> response times and therefore throughput (see results of testcase 2 and 3).
>> Adapting to the new api decreased performance again. The difference between
>> testcase 1 and 2 is most probably due to precached custom sorted results.
>>
>> The application under test is a dedicated lucene search engine doing nothing
>> else, but serving search requests. We're running a cluster of them in prd and
>> it's incredibly fast. With the old implementation and prd traffic we've above
>> 98% of the requests served in 200ms.
>> The index under test contains about 3 million documents (with lots of fields),
>> consumes about 2,5gig disk space and is stored on a tmpfs RAMDISK provided by
>> the linux kernel.
>>
>> Most interesting methods used for searching are:
>>
>> getHitsCount (is there a way to speed this up?):
>>
>> 	public int getHitsCount(String query, Filter filter) throws
>> LuceneServiceException {
>> 		log.debug("getHitsCount('{}, {}')", query, filter);
>> 		if (StringUtils.isBlank(query)) {
>> 			log.warn("getHitsCount: empty lucene query");
>> 			return 0;
>> 		}
>> 		long startTimeMillis = System.currentTimeMillis();
>> 		int count = 0;
>>
>> 		if (indexSearcher == null) {
>> 			return 0;
>> 		}
>>
>> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>> 		Query q = null;
>> 		try {
>> 			q = createQuery(query);
>> 			TopScoreDocCollector tsdc = TopScoreDocCollector.create(1, true);
>> 			indexSearcher.search(q, filter, tsdc);
>> 			count = tsdc.getTotalHits();
>> 			log.info("getHitsCount: count = {}",count);
>> 		} catch (ParseException ex) {
>> 			throw new LuceneServiceException("invalid lucene query:" + query, ex);
>> 		} catch (IOException e) {
>> 			throw new LuceneServiceException(" indexSearcher could be corrupted", e);
>> 		} finally {
>> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
>> 			if (durationMillis > slowQueryLimit) {
>> 				log.warn("getHitsCount: Slow query: {} ms, query={}", durationMillis, query);
>> 			}
>> 			log.debug("getHitsCount: query took {} ms", durationMillis);
>> 		}
>> 		return count;
>> 	}
>>
>> search:
>> 	public List<Document> search(String query, Filter filter, Sort sort, int from,
>> int size) throws LuceneServiceException {
>> 		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] { indexAlias, query,
>> filter, sort, from, size });
>> 		long startTimeMillis = System.currentTimeMillis();
>>
>> 		List<Document> docs = new ArrayList<Document>();
>> 		if (indexSearcher == null) {
>> 			return docs;
>> 		}
>> 		Query q = null;
>> 		try {
>> 			if (query == null) {
>> 				log.warn("search: lucene query is null...");
>> 				return docs;
>> 			}
>> 			q = createQuery(query);
>> 			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>> 			if (size < 0 || size > maxNumHits) {
>> 				// set hard limit for numHits
>> 				size = maxNumHits;
>> 				if (log.isDebugEnabled())
>> 					log.debug("search: Size set to hardlimit: {} for query: {} with filter:
>> {}", new Object[] { size, query, filter });
>> 			}
>> 			TopFieldCollector collector = TopFieldCollector.create(sort, size + from,
>> true, false, false, true);
>> 			indexSearcher.search(q, filter, collector);
>> 			if(size > collector.getTotalHits())
>> 				size = collector.getTotalHits();
>> 			if (size > 100000)
>> 				log.info("search: size: {} bigger than 100.000 for query: {} with filter:
>> {}", new Object[] { size, query, filter });
>> 			TopDocs td = collector.topDocs(from, size);
>> 			ScoreDoc[] scoreDocs = td.scoreDocs;
>> 			for (ScoreDoc scoreDoc : scoreDocs) {
>> 				docs.add(indexSearcher.doc(scoreDoc.doc));
>> 			}
>> 		} catch (ParseException e) {
>> 			log.warn("search: ParseException: {}", e.getMessage());
>> 			if (log.isDebugEnabled())
>> 				log.warn("search: ParseException: ", e);
>> 			return Collections.emptyList();
>> 		} catch (IOException e) {
>> 			log.warn("search: IOException: ", e);
>> 			return Collections.emptyList();
>> 		} finally {
>> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
>> 			if (durationMillis > slowQueryLimit) {
>> 				log.warn("search: Slow query: {} ms, query={}, indexUsed={}",
>> 						new Object[] { durationMillis, query,
>> indexSearcher.getIndexReader().directory() });
>> 			}
>> 			log.debug("search: query took {} ms", durationMillis);
>> 		}
>> 		return docs;
>> 	}
>>
>> I'm wondering why others are experiencing better performance with 2.9 and why
>> our implementations performance is going bad. Maybe our way of using the 2.9 api
>> is not the best and sorting is definetly expensive.
>>
>> Any ideas are appreciated. I'm torning out my hair since hours and days to find
>> the root cause. Also hints how I could find the bottlenecks myself are appreciated.
>>
>> Cheers,
>> Thomas
>>
> 
> 
> ------------------------------------------------------------------------
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42330-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 13:49:26 2009
Return-Path: <java-user-return-42330-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86166 invoked from network); 15 Sep 2009 13:49:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 13:49:26 -0000
Received: (qmail 15842 invoked by uid 500); 15 Sep 2009 13:49:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15774 invoked by uid 500); 15 Sep 2009 13:49:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15764 invoked by uid 99); 15 Sep 2009 13:49:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:49:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:49:12 +0000
Received: by fxm18 with SMTP id 18so3241752fxm.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 06:47:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=24NHtK985LKwdG38FdPlLuR5SvKjnraxTJ+mDEn0xDE=;
        b=l4q1U+8cgY2z01IAcr0JVT1lsXgvlNKHTZ1HVcraUO/q/wyDVQUok7R2hsoIv1Os50
         L0ynSzjkCB+2hR2NJTpLGgv7Sjqk74mzcLFYvsPqr8zDQpxPbqrEXcm13A2MjIDVj8lh
         fvDaEbOqLCufHOkXpVfyGRI3XBeNrP1R+7MEA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=q8zfxv8HoRX3Pi+ncEC6O6OdKkp7SozN99Lrwpo+Mz0xsU3yAphePZE5lpitzLk9b1
         RqytaKx5QNhYKwjRTvEJF9R9oGgjNmUk0jqAgb9MUwtDEO2Ow7Li8LrVxO6UtnRmDSaU
         OXBHEjQl8pB8q7QfpbejIdotmfZ6DBLJkNJNA=
Received: by 10.86.242.15 with SMTP id p15mr6244854fgh.14.1253022470535;
        Tue, 15 Sep 2009 06:47:50 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm464700fge.18.2009.09.15.06.47.48
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 06:47:49 -0700 (PDT)
Message-ID: <4AAF9B03.1040708@gmail.com>
Date: Tue, 15 Sep 2009 09:47:47 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de>
In-Reply-To: <4AAF98D1.5010207@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hey Thomas - any chance you can do some quick profiling and grab the
hotspots from the 3 configurations?

Are your custom sorts doing anything tricky?

-- 
- Mark

http://www.lucidimagination.com


Thomas Becker wrote:
> Urm and uploaded here:
> http://ankeschwarzer.de/tmp/graph.jpg
>
> Sorry.
>
> Thomas Becker wrote:
>   
>> Missed the attachment, sorry.
>>
>> Thomas Becker wrote:
>>     
>>> Hi all,
>>>
>>> I'm experiencing a performance degradation after migrating to 2.9 and running
>>> some tests. I'm getting out of ideas and any help to identify the reasons why
>>> 2.9 is slower than 2.4 are highly appreciated.
>>>
>>> We've had some issues with custom sorting in lucene 2.4.1. We worked around them
>>> by sorting the resultsets manually and caching the results after sorting (memory
>>> consuming but fast).
>>>
>>> I now migrated to lucene 2.9.0RC4. Build some new FieldComparatorSource
>>> implementation for sorting and refactored all deprecated api calls to the new
>>> lucene 2.9 api.
>>>
>>> Everything works fine from a functional perspective. But performance severly is
>>> (negatively) affected by lucene 2.9.
>>>
>>> I profiled the application for a couple of hours, build a jmeter load test and
>>> compared the following scenarios:
>>>
>>> 1. lucene 2.9 - new api
>>> 2. lucene 2.9 - old api and custom sorting after lucene
>>> 3. lucene 2.4.1 - old api and custom sorting after lucene (what we had up2now)
>>>
>>> Please find attached an rrd graph showing the results. The lighter the color the
>>> faster the request has been served. y=# requests, x=time.
>>>
>>> Most interestingly simply switching the lucene jars between 2.4 and 2.9 degraded
>>> response times and therefore throughput (see results of testcase 2 and 3).
>>> Adapting to the new api decreased performance again. The difference between
>>> testcase 1 and 2 is most probably due to precached custom sorted results.
>>>
>>> The application under test is a dedicated lucene search engine doing nothing
>>> else, but serving search requests. We're running a cluster of them in prd and
>>> it's incredibly fast. With the old implementation and prd traffic we've above
>>> 98% of the requests served in 200ms.
>>> The index under test contains about 3 million documents (with lots of fields),
>>> consumes about 2,5gig disk space and is stored on a tmpfs RAMDISK provided by
>>> the linux kernel.
>>>
>>> Most interesting methods used for searching are:
>>>
>>> getHitsCount (is there a way to speed this up?):
>>>
>>> 	public int getHitsCount(String query, Filter filter) throws
>>> LuceneServiceException {
>>> 		log.debug("getHitsCount('{}, {}')", query, filter);
>>> 		if (StringUtils.isBlank(query)) {
>>> 			log.warn("getHitsCount: empty lucene query");
>>> 			return 0;
>>> 		}
>>> 		long startTimeMillis = System.currentTimeMillis();
>>> 		int count = 0;
>>>
>>> 		if (indexSearcher == null) {
>>> 			return 0;
>>> 		}
>>>
>>> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>>> 		Query q = null;
>>> 		try {
>>> 			q = createQuery(query);
>>> 			TopScoreDocCollector tsdc = TopScoreDocCollector.create(1, true);
>>> 			indexSearcher.search(q, filter, tsdc);
>>> 			count = tsdc.getTotalHits();
>>> 			log.info("getHitsCount: count = {}",count);
>>> 		} catch (ParseException ex) {
>>> 			throw new LuceneServiceException("invalid lucene query:" + query, ex);
>>> 		} catch (IOException e) {
>>> 			throw new LuceneServiceException(" indexSearcher could be corrupted", e);
>>> 		} finally {
>>> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
>>> 			if (durationMillis > slowQueryLimit) {
>>> 				log.warn("getHitsCount: Slow query: {} ms, query={}", durationMillis, query);
>>> 			}
>>> 			log.debug("getHitsCount: query took {} ms", durationMillis);
>>> 		}
>>> 		return count;
>>> 	}
>>>
>>> search:
>>> 	public List<Document> search(String query, Filter filter, Sort sort, int from,
>>> int size) throws LuceneServiceException {
>>> 		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] { indexAlias, query,
>>> filter, sort, from, size });
>>> 		long startTimeMillis = System.currentTimeMillis();
>>>
>>> 		List<Document> docs = new ArrayList<Document>();
>>> 		if (indexSearcher == null) {
>>> 			return docs;
>>> 		}
>>> 		Query q = null;
>>> 		try {
>>> 			if (query == null) {
>>> 				log.warn("search: lucene query is null...");
>>> 				return docs;
>>> 			}
>>> 			q = createQuery(query);
>>> 			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>>> 			if (size < 0 || size > maxNumHits) {
>>> 				// set hard limit for numHits
>>> 				size = maxNumHits;
>>> 				if (log.isDebugEnabled())
>>> 					log.debug("search: Size set to hardlimit: {} for query: {} with filter:
>>> {}", new Object[] { size, query, filter });
>>> 			}
>>> 			TopFieldCollector collector = TopFieldCollector.create(sort, size + from,
>>> true, false, false, true);
>>> 			indexSearcher.search(q, filter, collector);
>>> 			if(size > collector.getTotalHits())
>>> 				size = collector.getTotalHits();
>>> 			if (size > 100000)
>>> 				log.info("search: size: {} bigger than 100.000 for query: {} with filter:
>>> {}", new Object[] { size, query, filter });
>>> 			TopDocs td = collector.topDocs(from, size);
>>> 			ScoreDoc[] scoreDocs = td.scoreDocs;
>>> 			for (ScoreDoc scoreDoc : scoreDocs) {
>>> 				docs.add(indexSearcher.doc(scoreDoc.doc));
>>> 			}
>>> 		} catch (ParseException e) {
>>> 			log.warn("search: ParseException: {}", e.getMessage());
>>> 			if (log.isDebugEnabled())
>>> 				log.warn("search: ParseException: ", e);
>>> 			return Collections.emptyList();
>>> 		} catch (IOException e) {
>>> 			log.warn("search: IOException: ", e);
>>> 			return Collections.emptyList();
>>> 		} finally {
>>> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
>>> 			if (durationMillis > slowQueryLimit) {
>>> 				log.warn("search: Slow query: {} ms, query={}, indexUsed={}",
>>> 						new Object[] { durationMillis, query,
>>> indexSearcher.getIndexReader().directory() });
>>> 			}
>>> 			log.debug("search: query took {} ms", durationMillis);
>>> 		}
>>> 		return docs;
>>> 	}
>>>
>>> I'm wondering why others are experiencing better performance with 2.9 and why
>>> our implementations performance is going bad. Maybe our way of using the 2.9 api
>>> is not the best and sorting is definetly expensive.
>>>
>>> Any ideas are appreciated. I'm torning out my hair since hours and days to find
>>> the root cause. Also hints how I could find the bottlenecks myself are appreciated.
>>>
>>> Cheers,
>>> Thomas
>>>
>>>       
>> ------------------------------------------------------------------------
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>   




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42331-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 13:56:12 2009
Return-Path: <java-user-return-42331-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88319 invoked from network); 15 Sep 2009 13:56:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 13:56:12 -0000
Received: (qmail 30048 invoked by uid 500); 15 Sep 2009 13:56:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29989 invoked by uid 500); 15 Sep 2009 13:56:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29979 invoked by uid 99); 15 Sep 2009 13:56:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:56:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.223.176 as permitted sender)
Received: from [209.85.223.176] (HELO mail-iw0-f176.google.com) (209.85.223.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 13:56:00 +0000
Received: by iwn6 with SMTP id 6so1619560iwn.20
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 06:55:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=diYcxCEGGlj5hEBJP1J9MC1K9dQ/Se5ARz2lB+lmh10=;
        b=scBloQTp1DdKWckFEixUmowHJyqHqGnhicKp+Nm1YlEgS4GdRZn9WKPa7CgtcB3uT1
         dQFl1dq/lIcvg1+AiEHx+Vp3YG2C5bY8FVDF1AayOvbtIfUAvYz2a1Ymi489kxdrY+4Y
         Y/BrQNaW6hk1j3gwEvyZghpvZCDt4YyWVlero=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=SeL+2wG7fzkcGPA+06jsGfd10anji4RXOhUYCpzpwObUOqcXWYPL1o91jCfgFYkWgk
         hrdzWgcVefBC3R1IqHnfDuhVs6+d5mzq+OYnRTED74yd58iJPQWzRuSzYSGB6ErDxaoG
         IzEiaOb9wxdfTHvwAKe85SRh0luztwKGYFCH8=
MIME-Version: 1.0
Received: by 10.231.126.69 with SMTP id b5mr5328046ibs.54.1253022938930; Tue, 
	15 Sep 2009 06:55:38 -0700 (PDT)
In-Reply-To: <1253002790.7551.20.camel@bohr>
References: <1253002790.7551.20.camel@bohr>
Date: Tue, 15 Sep 2009 09:55:38 -0400
Message-ID: <359a92830909150655q67ca5ab1v151cff002b13bed7@mail.gmail.com>
Subject: Re: Displaying search result data - stored fields vs external source
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016368e2f2f2b9fa204739e2393
X-Virus-Checked: Checked by ClamAV on apache.org

--0016368e2f2f2b9fa204739e2393
Content-Type: text/plain; charset=ISO-8859-1

Categorically I store everything in the index unless/until I *know* it
doesn'twork. With some things, it's easy to know from the outset, like if I
have
20T of data to store.

First, storing fields has minimal impact on the search speed, the stored
text
isn't interleaved with the search tokens, so they're pretty much disjoint.

Second, any scheme storing data separately is inherently more complex
and difficult to maintain. From the eXtreme Programming folks "Do the
simplest thing that could possibly work".

Third, there isn't much work in trying it and seeing. I mean you have to
write
the retrieval code, and if you encapsulate fetching the data you can switch
it out later if it comes to that pretty easily. So you don't lose much at
all
by "just trying it" <G>..

HTH
Erick

On Tue, Sep 15, 2009 at 4:19 AM, Joel Halbert <joel@su3analytics.com> wrote:

> Hi,
>
> When using Lucene I always consider two approaches to displaying search
> result data to users:
>
> 1. Store any fields that we index and display to users in the Lucene
> Documents themselves. When we perform a search simply retrieve the data
> to be displayed from the Lucence documents themselves.
>
> or
>
> 2. Index fields in Lucene but reference data to be displayed from
> another source, such as a database. So, when searching I would search
> for documents then use a (stored) reference key on the documents to then
> lookup the display fields to display from another source e.g. a
> database.
>
> With regards to the number and size of stored fields I am looking at
> indexing and displaying approximately 4 relatively small fields for each
> document (e.g.  name, age, short description, URL ~ approx 500bytes in
> total). In any query about 10 hits will be displayed to the user.
> Approximately 10 million documents to index and search.
>
> I am interested the differences in both approaches with regards to:
>
> 1) Indexing time performance (how long it might take to index with and
> without stored fields)
> 2) Search time performance (total time taken to search for matching
> documents and then display fields to users)
>
> I am less interested in differences arising from
> maintainability/increased storage requirements.
>
> I would be interested to see what others  think of using each approach.
>
> Cheers,
> Joel
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016368e2f2f2b9fa204739e2393--

From java-user-return-42332-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 14:05:47 2009
Return-Path: <java-user-return-42332-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91942 invoked from network); 15 Sep 2009 14:05:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 14:05:47 -0000
Received: (qmail 49658 invoked by uid 500); 15 Sep 2009 14:05:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49580 invoked by uid 500); 15 Sep 2009 14:05:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49570 invoked by uid 99); 15 Sep 2009 14:05:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:05:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:05:33 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FE5C3T004881
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 16:05:12 +0200
Message-ID: <4AAF9F17.2030307@net-m.de>
Date: Tue, 15 Sep 2009 16:05:11 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com>
In-Reply-To: <4AAF9B03.1040708@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 16:05:12 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9806/Mon Sep 14 20:37:58 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Hey Mark,

thanks for your reply. Will do. Results will follow in a couple of minutes.

Yes the custom sorts are doing something tricky. :) I'll try to explain them in
few words and paste the code.

But even w/o them 2.9 is slower. Testcase 2 and 3 have only different lucene jars.

CustomFieldComparatorPrefix.java:

a field containing for example releaseDates for sorting. But there's different
releaseDates for a single document and different countries for example. They're
prefixed and comma separated in a single field.

Here's the code:

public final class CustomFieldComparatorPrefix extends FieldComparatorSource {

	/**
	 *
	 */
	private static final long serialVersionUID = 200907240001L;

	private final String prefix;

	public CustomFieldComparatorPrefix(String prefix) {
		this.prefix = prefix;
	}

	/*
	 * (non-Javadoc)
	 *
	 * @see
	 * org.apache.lucene.search.FieldComparatorSource#newComparator(java.lang
	 * .String, int, int, boolean)
	 */
	public FieldComparator newComparator(final String fieldname, final int numHits,
int sortPos, boolean reversed) throws IOException {
		return new FieldComparator() {

			private int[] currentReaderValues;

			private int[] values = new int[numHits];

			private int bottom;

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#compare(int, int)
			 */
			public int compare(int slot1, int slot2) {
				// TODO: there are sneaky non-branch ways to compute
				// -1/+1/0 sign
				// Cannot return values[slot1] - values[slot2] because that
				// may overflow
				final int v1 = values[slot1];
				final int v2 = values[slot2];
				if (v1 > v2) {
					return 1;
				} else if (v1 < v2) {
					return -1;
				} else {
					return 0;
				}
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#compareBottom(int)
			 */
			public int compareBottom(int doc) throws IOException {
				// TODO: there are sneaky non-branch ways to compute
				// -1/+1/0 sign
				// Cannot return bottom - values[slot2] because that
				// may overflow
				final int v2 = currentReaderValues[doc];
				if (bottom > v2) {
					return 1;
				} else if (bottom < v2) {
					return -1;
				} else {
					return 0;
				}
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#copy(int, int)
			 */
			public void copy(int slot, int doc) throws IOException {
				values[slot] = currentReaderValues[doc];
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#setBottom(int)
			 */
			public void setBottom(int slot) {
				this.bottom = values[slot];
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#sortType()
			 */
			public int sortType() {
				return SortField.CUSTOM;
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#value(int)
			 */
			public Comparable<Integer> value(int slot) {
				return new Integer(values[slot]);
			}

			@Override
			public void setNextReader(IndexReader reader, int docBase) throws IOException {
				currentReaderValues = FieldCache.DEFAULT.getInts(reader, fieldname, new
PrefixedIntParser(prefix));
			}

		};
	}
}

CustomFieldComparatorPosition.java:

works similar to the one above. But in the field are different positions for
different contentgroups. Example "10_1,11_5,14_1". Whereas the prefix are
defining the contentgroup id and the digit after the underscore is the actual
position to define the documents place in the sort order.
This one could in theory use the same comparator as above, but the app will run
oom due to too many different contentgroups. Since only few (~280.000) documents
have positions set I wrote my own lucene cache implementation storing only not
default values.

Comparator Source:

public final class CustomFieldComparatorPosition extends FieldComparatorSource {
	private final Logger log = LoggerFactory.getLogger(this.getClass());

	/**
	 *
	 */
	private static final long serialVersionUID = 200907240001L;

	private final String prefix;

	private static PositionCache cache;

	private StopWatch sw = new StopWatch();

	public CustomFieldComparatorPosition(String prefix) {
		if (cache == null) {
			log.debug("CustomFieldComparatorPosition:initializing PositionCache");
			cache = new PositionCache();
		}
		this.prefix = prefix;
	}

	/*
	 * (non-Javadoc)
	 *
	 * @see
	 * org.apache.lucene.search.FieldComparatorSource#newComparator(java.lang
	 * .String, int, int, boolean)
	 */
	public FieldComparator newComparator(final String fieldname, final int numHits,
int sortPos, boolean reversed) throws IOException {
		return new FieldComparator() {

			private Map<Integer, Integer> currentReaderValues;

			private int[] values = new int[numHits];

			private int bottom;

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#compare(int, int)
			 */
			public int compare(int slot1, int slot2) {
				// TODO: there are sneaky non-branch ways to compute
				// -1/+1/0 sign
				// Cannot return values[slot1] - values[slot2] because that
				// may overflow
				final int v1 = values[slot1];
				final int v2 = values[slot2];
				if (v1 > v2) {
					return 1;
				} else if (v1 < v2) {
					return -1;
				} else {
					return 0;
				}
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#compareBottom(int)
			 */
			public int compareBottom(int doc) throws IOException {
				int i;
				try {
					i = currentReaderValues.get(doc);
				} catch (NullPointerException e) {
					i = 999999;
				}
				// TODO: there are sneaky non-branch ways to compute
				// -1/+1/0 sign
				// Cannot return bottom - values[slot2] because that
				// may overflow
				final int v2 = i;
				if (bottom > v2) {
					return 1;
				} else if (bottom < v2) {
					return -1;
				} else {
					return 0;
				}
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#copy(int, int)
			 */
			public void copy(int slot, int doc) throws IOException {
				// This will be executed n times where n is the amount of
				// documents in the index.
				int value;
				try{
					value = currentReaderValues.get(doc);
				}catch(NullPointerException e){
					value = 999999;
				}
				values[slot] = value;
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#setBottom(int)
			 */
			public void setBottom(int slot) {
				this.bottom = values[slot];
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#sortType()
			 */
			public int sortType() {
				return SortField.CUSTOM;
			}

			/*
			 * (non-Javadoc)
			 *
			 * @see org.apache.lucene.search.FieldComparator#value(int)
			 */
			public Comparable<Integer> value(int slot) {
				return new Integer(values[slot]);
			}

			@Override
			public void setNextReader(IndexReader reader, int docBase) throws IOException {
				sw.start();
				try {
					currentReaderValues = cache.getInts(reader, fieldname, new
PrefixedIntParser(prefix));
				} catch (InterruptedException e) {
					throw new IllegalStateException(e.getCause());
				}
				sw.stop();
				if (sw.getTime() > 3000) {
					log.info("setNextReader: Slow: Time to get currentReaderValues from cache:
{}ms. Items in cache: {}", sw.getTime(), cache.getItemCount());
				}
			}

		};
	}
}

PositionCache.java:
/**
 * This cache implementation caches the position values of items stored as
 * documents in lucene. This cache has a WeakHashMap with an IndexReader
 * reference as a key thus if the indexReader reference gets deleted, the cache
 * is marked to be gced. The innerCache is a Map containing field + parser
 * (contracttocontentgroup prefix) as the key and as a value yet another map.
 * The latter map finally contains the docIds as key and positionvalue for this
 * prefix as value.
 *
 * @author Thomas Becker (thomas.becker@net-m.de)
 *
 */
public class PositionCache {
	final Map<Object, Map<String, Future<Map<Integer, Integer>>>> readerCache = new
WeakHashMap<Object, Map<String, Future<Map<Integer, Integer>>>>();

	AtomicInteger itemCount = new AtomicInteger(0); // only for debugging...only
increasing

	public Map<Integer, Integer> getInts(final IndexReader reader, final String
field, final IntParser parser) throws InterruptedException {

		String key = parser.toString();
		// Future<Map<Integer,Integer> contains docId as key and position as
		// value
		HashMap<String, Future<Map<Integer, Integer>>> innerCache;
		final Object readerKey = reader.getFieldCacheKey();
		synchronized (readerCache) {
			innerCache = (HashMap<String, Future<Map<Integer, Integer>>>)
readerCache.get(readerKey);
			if (innerCache == null) {
				innerCache = new HashMap<String, Future<Map<Integer, Integer>>>();
				readerCache.put(readerKey, innerCache);
			}
		}
		Future<Map<Integer, Integer>> f = innerCache.get(key);
		if (f == null) {
			Callable<Map<Integer, Integer>> eval = new Callable<Map<Integer, Integer>>() {
				public Map<Integer, Integer> call() throws InterruptedException, IOException {
					HashMap<Integer, Integer> docPositions = new HashMap<Integer, Integer>();
					TermDocs termDocs = reader.termDocs();
					TermEnum termEnum = reader.terms(new Term(field));
					try {
						do {
							Term term = termEnum.term();
							if (term == null || term.field() != field)
								break;
							int termval = parser.parseInt(term.text());
							termDocs.seek(termEnum);
							while (termDocs.next()) {
								// do not store defaults to save memory
								if (termval < 999999) {
									itemCount.incrementAndGet();
									docPositions.put(termDocs.doc(), termval);
								}
							}
						} while (termEnum.next());
					} finally {
						termDocs.close();
						termEnum.close();
					}
					return docPositions;
				}
			};
			FutureTask<Map<Integer, Integer>> ft = new FutureTask<Map<Integer,
Integer>>(eval);
			f = innerCache.put(key, ft);
			if (f == null) {
				f = ft;
				ft.run();
			}
		}
		try {
			return f.get();
		} catch (CancellationException e) {
			innerCache.remove(key);
		} catch (ExecutionException e) {
			throw new IllegalStateException(e.getCause());
		}
		return null;
	}


Cheers,
Thomas


Mark Miller wrote:
> Hey Thomas - any chance you can do some quick profiling and grab the
> hotspots from the 3 configurations?
> 
> Are your custom sorts doing anything tricky?
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42333-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 14:13:37 2009
Return-Path: <java-user-return-42333-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94618 invoked from network); 15 Sep 2009 14:13:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 14:13:36 -0000
Received: (qmail 66352 invoked by uid 500); 15 Sep 2009 14:13:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66270 invoked by uid 500); 15 Sep 2009 14:13:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66260 invoked by uid 99); 15 Sep 2009 14:13:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:13:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:13:23 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1205266fgg.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 07:13:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=QWElURjfxsw93QKFYicptw59VrqBGjSlzNsxpETmOhA=;
        b=i7apeQEZz4z2/lQYkElPYEzblzSWMtKzs+IMkX7OtpgxFlv4E3xlwqUkZptkC0pWtM
         i2Pe303J76E7DkB+GZdy7O6SnOA8oYOcYSfdCNlBb6mrkgPOauOVfklsN5O8vucU9IfC
         XexEjanMCR0CXQrZZfSmEQnV3Ay5+4Wwe7GL8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=l8L50OYgO2kujPqysi13M/vcJDmshpresv0uES/SjDlnlnbcefjBE1KrIEbOaQeUDS
         CHMLC9CP9In7bF5Tfcc1MlfTusDPM1HD6G9YhE/GGrtotPlazb1RPRkng1xYY4kT25Rf
         5aOppeqaMsHFDAusUNN6dJVVaL5d1swGcN6Us=
Received: by 10.86.249.30 with SMTP id w30mr2859231fgh.35.1253023982756;
        Tue, 15 Sep 2009 07:13:02 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm316183fge.13.2009.09.15.07.12.59
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 07:13:01 -0700 (PDT)
Message-ID: <4AAFA0EA.2090300@gmail.com>
Date: Tue, 15 Sep 2009 10:12:58 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de>
In-Reply-To: <4AAF9F17.2030307@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Thomas Becker wrote:
> Hey Mark,
>
> thanks for your reply. Will do. Results will follow in a couple of minutes.
>
>
>   
Thanks, awesome.

Also, how many segments (approx) are in your index? If there are a lot,
have you/can you try the same tests on an optimized index? Don't want to
get ahead of the profiling results, but just to continue the info loop.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42334-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 14:19:21 2009
Return-Path: <java-user-return-42334-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96595 invoked from network); 15 Sep 2009 14:19:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 14:19:20 -0000
Received: (qmail 82877 invoked by uid 500); 15 Sep 2009 14:19:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82806 invoked by uid 500); 15 Sep 2009 14:19:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82796 invoked by uid 99); 15 Sep 2009 14:19:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:19:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.207] (HELO homiemail-a20.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:19:05 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by homiemail-a20.g.dreamhost.com (Postfix) with ESMTPA id 60C2E7EC063
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 07:18:44 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1076)
Subject: Re: New "Stream closed" exception with Java 6
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <1402026381.8381253021166639.JavaMail.root@mail.uk.scalix.com>
Date: Tue, 15 Sep 2009 10:18:43 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <92EBB00B-B84A-4FFB-8F2E-4F3FF5CFAF21@apache.org>
References: <1402026381.8381253021166639.JavaMail.root@mail.uk.scalix.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1076)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 15, 2009, at 9:26 AM, Chris Bamford wrote:

> Mark
>
> It appears you are right - it *IS* something tricky.  My code is  
> single threaded, so there is no contention.  I still get  
> intermittent "Stream Close" exceptions (about 1 in every 800  
> indexWriter.addDocument() calls) which I cannot explain.  By moving  
> code around / recompiling, I have managed successful test runs where  
> I get none, but now I have added some more logging code, the problem  
> has come back  :-(
> I feel like I have wasted the last 10 days chasing shadows and am no  
> further forward.
>

Your description sure sounds like a threading issue (adding logging or  
other code causing the problem to flare up).  I believe tools like  
YourKit and some others can help with threading issues.

Can you isolate (take it out of Tomcat) your indexing code and  
reproduce it in a standalone test case?


> My assumption is that 2.4 is stable (we are moving from 2.0 to 2.4  
> at present) - should I reconsider that assumption?
>
> Thanks for any ideas.
>
> - Chris
>
> ----- Original Message -----
> From: Mark Miller <markrmiller@gmail.com>
> Sent: Tue, 8/9/2009 8:06pm
> To: java-user@lucene.apache.org
> Subject: Re: New "Stream closed" exception with Java 6
>
> Chris Hostetter wrote:
>> : I'm coming to the same conclusion - there must be >1 threads  
>> accessing this index at the same time.  Better go figure it  
>> out  ...  :-)
>>
>> careful about your assumptions ... you could get this same type of
>> exception even with only one thread, the stream that's being closed  
>> isn't
>> internal to Lucene, it's the InputStreamReader you supplied as the  
>> value
>> of some Field.  it's possibly you just have a simple bug where you  
>> are
>> closing hte reader before you pass it to Lucene, or maybe you are
>> mistakenly adding the saame field twice (or in two different  
>> documents)
>>
>>
>> -Hoss
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> Its possible its something tricky. When I was converting the  
> Highlighter
> to the new TokenStream API, I started to
> get this exception in the Highlighter rewrite test - everything else
> passed, but this was failing. I couldn't figure it out - and
> before I could find the root cause, all the tests started passing
> (perhaps from changing code doing other things, rebuilding, or who  
> knows
> - I don't have a clue). I couldn't get it to fail again after that.
>
> Not very helpful - but just to note, there were not multiple threads
> involved concurrently, nor multiple Writers.
>
> -- 
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42335-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 14:44:04 2009
Return-Path: <java-user-return-42335-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7499 invoked from network); 15 Sep 2009 14:44:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 14:44:04 -0000
Received: (qmail 33699 invoked by uid 500); 15 Sep 2009 14:44:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33649 invoked by uid 500); 15 Sep 2009 14:44:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33639 invoked by uid 99); 15 Sep 2009 14:44:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:44:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:43:49 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FEhDu5009442
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 16:43:13 +0200
Message-ID: <4AAFA800.5040600@net-m.de>
Date: Tue, 15 Sep 2009 16:43:12 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com>
In-Reply-To: <4AAFA0EA.2090300@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 16:43:13 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9807/Tue Sep 15 14:43:15 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Here's the results of profiling 10 different search requests:

http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
http://ankeschwarzer.de/tmp/lucene_29_newapi.png

But you already gave me a good hint. The index being used is an old one build
with lucene 2.4. I will now try a freshly build 2.9 index and see if performance
improves. Maybe that already solves the issue...stupid me...
We're updating the index every 30 min. at the moment and it gets optimized after
each update.


Mark Miller wrote:
> Thomas Becker wrote:
>> Hey Mark,
>>
>> thanks for your reply. Will do. Results will follow in a couple of minutes.
>>
>>
>>   
> Thanks, awesome.
> 
> Also, how many segments (approx) are in your index? If there are a lot,
> have you/can you try the same tests on an optimized index? Don't want to
> get ahead of the profiling results, but just to continue the info loop.
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42336-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 14:53:26 2009
Return-Path: <java-user-return-42336-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11412 invoked from network); 15 Sep 2009 14:53:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 14:53:26 -0000
Received: (qmail 58228 invoked by uid 500); 15 Sep 2009 14:53:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58169 invoked by uid 500); 15 Sep 2009 14:53:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58159 invoked by uid 99); 15 Sep 2009 14:53:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:53:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 14:53:12 +0000
Received: by fg-out-1718.google.com with SMTP id d23so829022fga.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 07:52:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=lidDBZVVqzy/BDPwYsvYzhvTLgYhRYzmjScaRMnd6sM=;
        b=DxdQBeDSjANmmqJ3aTy/rQaozEnj1zoBanoGIfkMFiQv+3u2zUf2ZPpouYJzFiqG2J
         x0fR76FUDB9hgOQ2kmPpGQvwDQDtqbx93rNE3Sl1Lm95rujtFWEawXjRnbywlyanC7bx
         PsWh2f4iiqqazNxIOYxxoYsxGXEGjFNfHQncA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=Rox+frH8UOMBZs0v/ZB8XdwxosuHUaug0jvW23INruLSNyEw+RxNjLuabZul+61i0k
         Gu45REAJDGXoCtih6rJA8JiP6i8lWUOq4upNXdlsb6wVjOYXQ6ds//5q6zSzsb2JdorH
         RJgsBNkbcd3/w4KH64mmqH6JmaLdXx+SgLX3I=
Received: by 10.86.222.5 with SMTP id u5mr6281891fgg.67.1253026372266;
        Tue, 15 Sep 2009 07:52:52 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id d6sm31318fga.26.2009.09.15.07.52.50
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 07:52:51 -0700 (PDT)
Message-ID: <4AAFAA41.1070103@gmail.com>
Date: Tue, 15 Sep 2009 10:52:49 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de>
In-Reply-To: <4AAFA800.5040600@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Thomas Becker wrote:
> Here's the results of profiling 10 different search requests:
>
> http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
> http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
> http://ankeschwarzer.de/tmp/lucene_29_newapi.png
>
> But you already gave me a good hint. The index being used is an old one build
> with lucene 2.4. I will now try a freshly build 2.9 index and see if performance
> improves. Maybe that already solves the issue...stupid me...
>   
That shouldn't be an issue unless there is some odd bug.

> We're updating the index every 30 min. at the moment and it gets optimized after
> each update.
>   
So this profiling is on an optimized index (eg a single segment) ?
That would be odd indeed, and possibly point to some of the scoring changes.

>
> Mark Miller wrote:
>   
>> Thomas Becker wrote:
>>     
>>> Hey Mark,
>>>
>>> thanks for your reply. Will do. Results will follow in a couple of minutes.
>>>
>>>
>>>   
>>>       
>> Thanks, awesome.
>>
>> Also, how many segments (approx) are in your index? If there are a lot,
>> have you/can you try the same tests on an optimized index? Don't want to
>> get ahead of the profiling results, but just to continue the info loop.
>>
>>     
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42337-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:02:33 2009
Return-Path: <java-user-return-42337-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14755 invoked from network); 15 Sep 2009 15:02:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:02:33 -0000
Received: (qmail 74884 invoked by uid 500); 15 Sep 2009 15:02:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74820 invoked by uid 500); 15 Sep 2009 15:02:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74809 invoked by uid 99); 15 Sep 2009 15:02:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:02:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mathias.bank@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:02:21 +0000
Received: by ewy28 with SMTP id 28so239593ewy.28
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 08:01:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Rc1lZQoXHlo5BKhoxb5lkPZBHGCrnzLWz4BHaSIOG1A=;
        b=WVo3fskJvJGxBmJfoLuaMpOJkBHyT2oNT+pp2r8H3AIXjFm5JtULkCG31ESa6pxZ6r
         0MtI6trZ9sAPDR2up22qmXZlyTCchSQvtXVp5ugrFbnL1/xS/ZVn7tR7+EIMMWNwsyhh
         /nbQMkV4vHgZCk/lPOXeddpTACrGMAJLwLBhM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=NoYI1f+xTDFsylJKfVs88PMK4KmctZNsycFs0rs+uI4JfzxpW3dbUwzcSCLklUMS8b
         cu0yFWD1W4xYGmDpskDTGVLNyxC+y4Eo0mN6DgORgUtoNN0dsRPYHKkR3BEGf4xMfCmd
         WPzOmhdnwWeWJiFmQJyb/cPFskLAnqvXDSJvA=
MIME-Version: 1.0
Received: by 10.216.87.79 with SMTP id x57mr2145806wee.83.1253026861270; Tue, 
	15 Sep 2009 08:01:01 -0700 (PDT)
In-Reply-To: <f18c9dde0909150536s401f4bb9r16a75336bb852238@mail.gmail.com>
References: <53480e280909150519y2f5dfce8l4a2166ffd86706f1@mail.gmail.com>
	 <f18c9dde0909150536s401f4bb9r16a75336bb852238@mail.gmail.com>
Date: Tue, 15 Sep 2009 17:01:00 +0200
Message-ID: <53480e280909150801p698770ddkede51f4f0e3ed3e9@mail.gmail.com>
Subject: Re: Counting search results
From: Mathias Bank <mathias.bank@gmail.com>
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

This seams to be a similar solution like:

Term t = new Term(fieldname, term);
int count = searcher.docFreq(t);

The problem is, that in this situation it is not possible to apply a
filter object. If I don't wanna use this filter object, I would have
to use a complex search query, wich is - again - very slow. So,
unfortunatelly, your solution does not help.

Mathias

2009/9/15 Simon Willnauer <simon.willnauer@googlemail.com>:
> Did you try:
> int numDocs
> TermDocs termDocs = reader.termDocs(new Term("myField", "myTerm"));
> while (termDocs.next()) { numDocs++; }
>
> simon
>
> On Tue, Sep 15, 2009 at 2:19 PM, Mathias Bank <mathias.bank@gmail.com> wrote:
>> Hello,
>>
>> I'm trying to find the number of documents for a specific term to
>> create text statistics. I'm not interested in ordering the results or
>> even recieving the first result. I just need the number of results.
>>
>> Currently, I'm trying to do this by using the lucene searcher class:
>>
>> IndexSearcher searcher = new IndexSearcher(reader);
>> String queryString = fieldname+":" + term;
>> QueryParser parser = new QueryParser(fieldname, new GermanAnalyzer());
>> TopDocs d = searcher.search(parser.parse(queryString), filter, 1);
>> int count = d.totalHits;
>>
>> The problem is, that there is a large index (optimized) with > 8 mio.
>> entries. One search could return a large number of search results (> 1
>> mio). Currently these search tasks take more than 15 secunds.
>>
>> The question is: is there any way to get the number of search results
>> faster? I think, that it could be optimized by not using a Weight
>> object (order is not interesting), but I haven't seen a way to do
>> this.
>>
>> I hope, someone has already solved this problem.
>>
>> Mathias
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42338-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:04:25 2009
Return-Path: <java-user-return-42338-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15804 invoked from network); 15 Sep 2009 15:04:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:04:25 -0000
Received: (qmail 79860 invoked by uid 500); 15 Sep 2009 15:04:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79792 invoked by uid 500); 15 Sep 2009 15:04:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79782 invoked by uid 99); 15 Sep 2009 15:04:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:04:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:04:10 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1221710fgg.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 08:02:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=I0NuicZ1AmHSduTvUNFRasZhX5dR6bVvtyYYHkgdLD0=;
        b=xDJ9ZIS32rFQjw+xknO0vWijZC8T0qONqCVlYvzrKO35ofVXxSvAkk7c5nyS2ItYTL
         UUTjqUdDiq6b2RmFyJSczX98M1qne0kIqUSuyiMmDVgPTPdXa28Gdq55G0qf3O5kgc5C
         99sIQSx8eaXX7w1ZIXTgQxHAlWMfee5m9z3Po=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=oPUHpCdYjryLcyJx/wvrPpQ0ib2bY+JNvlLItaJ70XlTnkZhGOGkxD2RJH57sMDfX/
         FRl+DhSCN6vdlR3WMlvZtrFjtp2gsftUBpArDtB+BJh0YswWPgX39J2omyz+Y8Ux/3Bh
         8KX3QdihJ+epVdPeoh/fTTG3hAnzFEe7kCZLk=
Received: by 10.86.41.19 with SMTP id o19mr2919348fgo.45.1253026967924;
        Tue, 15 Sep 2009 08:02:47 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 12sm587732fgg.15.2009.09.15.08.02.46
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 08:02:47 -0700 (PDT)
Message-ID: <4AAFAC95.4050307@gmail.com>
Date: Tue, 15 Sep 2009 11:02:45 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com>
In-Reply-To: <4AAFAA41.1070103@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

A few quick notes -

Lucene 2.9 old api doesn't appear much worse than Lucene 2.4?

You save a lot with the new Intern impl, because thats not a hotspot
anymore. But then,
RandomAccessFile seeks end up being a lot more of the pie. They look
fairly similar in speed overall?

It looks like the major bottleneck with 2.9 new api is that its using
NIOFSDirectory (your on unix I guess, and it now
defaults to that on non Windows os's), and that appears to be a real
killer for you. Its taking half the time for its
reads.  ???

No conclusions yet, but I'm looking it over. Some other guys will come
in with some ideas as well.

Do confirm that those profiling results are on a single segment though.

- Mark


Mark Miller wrote:
> Thomas Becker wrote:
>   
>> Here's the results of profiling 10 different search requests:
>>
>> http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
>> http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
>> http://ankeschwarzer.de/tmp/lucene_29_newapi.png
>>
>> But you already gave me a good hint. The index being used is an old one build
>> with lucene 2.4. I will now try a freshly build 2.9 index and see if performance
>> improves. Maybe that already solves the issue...stupid me...
>>   
>>     
> That shouldn't be an issue unless there is some odd bug.
>
>   
>> We're updating the index every 30 min. at the moment and it gets optimized after
>> each update.
>>   
>>     
> So this profiling is on an optimized index (eg a single segment) ?
> That would be odd indeed, and possibly point to some of the scoring changes.
>
>   
>> Mark Miller wrote:
>>   
>>     
>>> Thomas Becker wrote:
>>>     
>>>       
>>>> Hey Mark,
>>>>
>>>> thanks for your reply. Will do. Results will follow in a couple of minutes.
>>>>
>>>>
>>>>   
>>>>       
>>>>         
>>> Thanks, awesome.
>>>
>>> Also, how many segments (approx) are in your index? If there are a lot,
>>> have you/can you try the same tests on an optimized index? Don't want to
>>> get ahead of the profiling results, but just to continue the info loop.
>>>
>>>     
>>>       
>>   
>>     
>
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42339-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:15:23 2009
Return-Path: <java-user-return-42339-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20477 invoked from network); 15 Sep 2009 15:15:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:15:22 -0000
Received: (qmail 650 invoked by uid 500); 15 Sep 2009 15:15:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 588 invoked by uid 500); 15 Sep 2009 15:15:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 578 invoked by uid 99); 15 Sep 2009 15:15:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:15:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:15:08 +0000
Received: by bwz10 with SMTP id 10so3294594bwz.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 08:13:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:cc:content-type;
        bh=0hN8AW2yJrlsDl9pAF8xPmpZBqK5uxIrHKn8niqDhzo=;
        b=maENu018Xc0fkAWpW2uADb/MMBUhVwfIiIzuLZ+qA6jZpMr+ZCAhDo9x4pSOy//fng
         k6Unrfn3d1foftbF0ZufQOfETrCrrxyTQ/zmYBBU19cREgI1tD26aTxAATKkwo79Axtv
         ZHZMJvSEibqMv/gfna9j2xbR+OG47falzWNDI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:cc:content-type;
        b=s1aWne5fNMNPyj176omGvisYp4Q9lNfmZEgDpjs/VYvg6JwVhoc0U/NDDXl5bQWo24
         E+6guI/PysxTf7o2V9zZD/hgLo4MRKSEhMZ8NQA0+7IHZ03zl9evXruMmpXzwba2HQHo
         y2/iy+PtwxmfMFG87bWRVKVcvMXf9JXheZ7t0=
MIME-Version: 1.0
Received: by 10.239.138.25 with SMTP id n25mr727120hbn.8.1253027627767; Tue, 
	15 Sep 2009 08:13:47 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <53480e280909150801p698770ddkede51f4f0e3ed3e9@mail.gmail.com>
References: <53480e280909150519y2f5dfce8l4a2166ffd86706f1@mail.gmail.com>
	 <f18c9dde0909150536s401f4bb9r16a75336bb852238@mail.gmail.com>
	 <53480e280909150801p698770ddkede51f4f0e3ed3e9@mail.gmail.com>
Date: Tue, 15 Sep 2009 17:13:47 +0200
Message-ID: <f18c9dde0909150813la8557ecj143f85179dc7df95@mail.gmail.com>
Subject: Re: Counting search results
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: Mathias Bank <mathias.bank@gmail.com>
Cc: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Hmm, so if you wanna use the Filter to narrow down the search results
you could use it in the while loop like this:

BitSet set = filter.bits(reader);
 int numDocs
TermDocs termDocs = reader.termDocs(new Term("myField", "myTerm"));
while (termDocs.next()) {
  if(set.get(termDocs.doc()))
    numDocs++;
}

would that help?

simon
>>
On Tue, Sep 15, 2009 at 5:01 PM, Mathias Bank <mathias.bank@gmail.com> wrote:
> Hello,
>
> This seams to be a similar solution like:
>
> Term t = new Term(fieldname, term);
> int count = searcher.docFreq(t);
>
> The problem is, that in this situation it is not possible to apply a
> filter object. If I don't wanna use this filter object, I would have
> to use a complex search query, wich is - again - very slow. So,
> unfortunatelly, your solution does not help.
>
> Mathias
>
> 2009/9/15 Simon Willnauer <simon.willnauer@googlemail.com>:
>> Did you try:
>> int numDocs
>> TermDocs termDocs = reader.termDocs(new Term("myField", "myTerm"));
>> while (termDocs.next()) { numDocs++; }
>>
>> simon
>>
>> On Tue, Sep 15, 2009 at 2:19 PM, Mathias Bank <mathias.bank@gmail.com> wrote:
>>> Hello,
>>>
>>> I'm trying to find the number of documents for a specific term to
>>> create text statistics. I'm not interested in ordering the results or
>>> even recieving the first result. I just need the number of results.
>>>
>>> Currently, I'm trying to do this by using the lucene searcher class:
>>>
>>> IndexSearcher searcher = new IndexSearcher(reader);
>>> String queryString = fieldname+":" + term;
>>> QueryParser parser = new QueryParser(fieldname, new GermanAnalyzer());
>>> TopDocs d = searcher.search(parser.parse(queryString), filter, 1);
>>> int count = d.totalHits;
>>>
>>> The problem is, that there is a large index (optimized) with > 8 mio.
>>> entries. One search could return a large number of search results (> 1
>>> mio). Currently these search tasks take more than 15 secunds.
>>>
>>> The question is: is there any way to get the number of search results
>>> faster? I think, that it could be optimized by not using a Weight
>>> object (order is not interesting), but I haven't seen a way to do
>>> this.
>>>
>>> I hope, someone has already solved this problem.
>>>
>>> Mathias
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42340-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:24:39 2009
Return-Path: <java-user-return-42340-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25145 invoked from network); 15 Sep 2009 15:24:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:24:39 -0000
Received: (qmail 20123 invoked by uid 500); 15 Sep 2009 15:24:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20074 invoked by uid 500); 15 Sep 2009 15:24:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20064 invoked by uid 99); 15 Sep 2009 15:24:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:24:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:24:24 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FFNmNf014290
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 17:23:48 +0200
Message-ID: <4AAFB183.4070006@net-m.de>
Date: Tue, 15 Sep 2009 17:23:47 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com>
In-Reply-To: <4AAFAC95.4050307@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 17:23:48 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9807/Tue Sep 15 14:43:15 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Hey Mark,

yes. I'm running the app on unix. You see the difference between 2.9 and 2.4 here:

http://ankeschwarzer.de/tmp/graph.jpg

2.4 responds much quicker thus increasing throughput severly. I'm having a
single segment only:

-rw-r--r-- 1 asuser asgroup         20 Sep  9 16:40 segments.gen
-rw-r--r-- 1 asuser asgroup        294 Sep  9 16:44 segments_1o
-rw-r--r-- 1 asuser asgroup 2810603184 Sep  9 16:44 _7c.cfs

The FileChannel.read hotspot is indeed strange. Especially if taking into
account that the index is lying on a tmpfs (in memory). And 2.4 should be using
NIOFSDirectory as well?! Will check that.

Thanks a lot for your support!

Cheers,
Thomas

Mark Miller wrote:
> A few quick notes -
> 
> Lucene 2.9 old api doesn't appear much worse than Lucene 2.4?
> 
> You save a lot with the new Intern impl, because thats not a hotspot
> anymore. But then,
> RandomAccessFile seeks end up being a lot more of the pie. They look
> fairly similar in speed overall?
> 
> It looks like the major bottleneck with 2.9 new api is that its using
> NIOFSDirectory (your on unix I guess, and it now
> defaults to that on non Windows os's), and that appears to be a real
> killer for you. Its taking half the time for its
> reads.  ???
> 
> No conclusions yet, but I'm looking it over. Some other guys will come
> in with some ideas as well.
> 
> Do confirm that those profiling results are on a single segment though.
> 
> - Mark
> 
> 
> Mark Miller wrote:
>> Thomas Becker wrote:
>>   
>>> Here's the results of profiling 10 different search requests:
>>>
>>> http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
>>> http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
>>> http://ankeschwarzer.de/tmp/lucene_29_newapi.png
>>>
>>> But you already gave me a good hint. The index being used is an old one build
>>> with lucene 2.4. I will now try a freshly build 2.9 index and see if performance
>>> improves. Maybe that already solves the issue...stupid me...
>>>   
>>>     
>> That shouldn't be an issue unless there is some odd bug.
>>
>>   
>>> We're updating the index every 30 min. at the moment and it gets optimized after
>>> each update.
>>>   
>>>     
>> So this profiling is on an optimized index (eg a single segment) ?
>> That would be odd indeed, and possibly point to some of the scoring changes.
>>
>>   
>>> Mark Miller wrote:
>>>   
>>>     
>>>> Thomas Becker wrote:
>>>>     
>>>>       
>>>>> Hey Mark,
>>>>>
>>>>> thanks for your reply. Will do. Results will follow in a couple of minutes.
>>>>>
>>>>>
>>>>>   
>>>>>       
>>>>>         
>>>> Thanks, awesome.
>>>>
>>>> Also, how many segments (approx) are in your index? If there are a lot,
>>>> have you/can you try the same tests on an optimized index? Don't want to
>>>> get ahead of the profiling results, but just to continue the info loop.
>>>>
>>>>     
>>>>       
>>>   
>>>     
>>
>>   
> 
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42341-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:30:24 2009
Return-Path: <java-user-return-42341-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30327 invoked from network); 15 Sep 2009 15:30:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:30:24 -0000
Received: (qmail 30564 invoked by uid 500); 15 Sep 2009 15:30:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30507 invoked by uid 500); 15 Sep 2009 15:30:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30497 invoked by uid 99); 15 Sep 2009 15:30:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:30:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:30:10 +0000
Received: by fxm18 with SMTP id 18so3330400fxm.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 08:29:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=acInO8Tf0nk8F8aHImq2kkaSitaTXqsdsRnJvMqdMKU=;
        b=K9Lsj8u97MB2F+mmDOqQrr/6NSszuUy4uiISoVRphGMl01Xpoe3OtHLqpogP11ujRl
         ENPHIWWVjEmXx51+v2MtfWCpCGoE2aF7pyD0FRX51SL/yEiR7yy7Fm3TyFKJ91l9iH6S
         q6hcvJdVcr9//WLCmQYjPGoF6lCxj8tS0VbBA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=FDbToqifG2g54eAbDd6Sz1NrNSOS+NuHnog72THSNm0BA5+5WZRLy42LrL12lOacGY
         BWhttVRxRFQ/okinuDTMKz8SiJ9S9LOCvL0Mg3y1YITaPerGzxYrkiqGzVa7zMRGPbea
         bdQjuxQSdsGnyRMCsglq/Uw9xwfk6Y/0D5LPE=
Received: by 10.86.173.4 with SMTP id v4mr6303569fge.78.1253028589621;
        Tue, 15 Sep 2009 08:29:49 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 12sm225800fgg.5.2009.09.15.08.29.48
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 08:29:48 -0700 (PDT)
Message-ID: <4AAFB2EB.4020403@gmail.com>
Date: Tue, 15 Sep 2009 11:29:47 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de>
In-Reply-To: <4AAFB183.4070006@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Thomas Becker wrote:
> Hey Mark,
>
> yes. I'm running the app on unix. You see the difference between 2.9 and 2.4 here:
>
> http://ankeschwarzer.de/tmp/graph.jpg
>   
Right - I know your measurements showed a difference (and will keep that
in mind) - but the profiling results then seem
oddly similar.

> 2.4 responds much quicker thus increasing throughput severly. I'm having a
> single segment only:
>
> -rw-r--r-- 1 asuser asgroup         20 Sep  9 16:40 segments.gen
> -rw-r--r-- 1 asuser asgroup        294 Sep  9 16:44 segments_1o
> -rw-r--r-- 1 asuser asgroup 2810603184 Sep  9 16:44 _7c.cfs
>
> The FileChannel.read hotspot is indeed strange. Especially if taking into
> account that the index is lying on a tmpfs (in memory). And 2.4 should be using
> NIOFSDirectory as well?! Will check that.
>   
2.4 did not use NIOFSDirectory by default - you would have had to
manually specified it. Now its used by default if its detects a non
Windows OS.

Any particular reason your profiling output does not show invocations?
Its not essential most likely, but I've found it to be helpful in
comparisons.

We are about to release 2.9, and its been such a long haul, I'd hate to
see a release with an unknown performance trap.

-- 
- Mark

http://www.lucidimagination.com


> Thanks a lot for your support!
>
> Cheers,
> Thomas
>
> Mark Miller wrote:
>   
>> A few quick notes -
>>
>> Lucene 2.9 old api doesn't appear much worse than Lucene 2.4?
>>
>> You save a lot with the new Intern impl, because thats not a hotspot
>> anymore. But then,
>> RandomAccessFile seeks end up being a lot more of the pie. They look
>> fairly similar in speed overall?
>>
>> It looks like the major bottleneck with 2.9 new api is that its using
>> NIOFSDirectory (your on unix I guess, and it now
>> defaults to that on non Windows os's), and that appears to be a real
>> killer for you. Its taking half the time for its
>> reads.  ???
>>
>> No conclusions yet, but I'm looking it over. Some other guys will come
>> in with some ideas as well.
>>
>> Do confirm that those profiling results are on a single segment though.
>>
>> - Mark
>>
>>
>> Mark Miller wrote:
>>     
>>> Thomas Becker wrote:
>>>   
>>>       
>>>> Here's the results of profiling 10 different search requests:
>>>>
>>>> http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
>>>> http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi.png
>>>>
>>>> But you already gave me a good hint. The index being used is an old one build
>>>> with lucene 2.4. I will now try a freshly build 2.9 index and see if performance
>>>> improves. Maybe that already solves the issue...stupid me...
>>>>   
>>>>     
>>>>         
>>> That shouldn't be an issue unless there is some odd bug.
>>>
>>>   
>>>       
>>>> We're updating the index every 30 min. at the moment and it gets optimized after
>>>> each update.
>>>>   
>>>>     
>>>>         
>>> So this profiling is on an optimized index (eg a single segment) ?
>>> That would be odd indeed, and possibly point to some of the scoring changes.
>>>
>>>   
>>>       
>>>> Mark Miller wrote:
>>>>   
>>>>     
>>>>         
>>>>> Thomas Becker wrote:
>>>>>     
>>>>>       
>>>>>           
>>>>>> Hey Mark,
>>>>>>
>>>>>> thanks for your reply. Will do. Results will follow in a couple of minutes.
>>>>>>
>>>>>>
>>>>>>   
>>>>>>       
>>>>>>         
>>>>>>             
>>>>> Thanks, awesome.
>>>>>
>>>>> Also, how many segments (approx) are in your index? If there are a lot,
>>>>> have you/can you try the same tests on an optimized index? Don't want to
>>>>> get ahead of the profiling results, but just to continue the info loop.
>>>>>
>>>>>     
>>>>>       
>>>>>           
>>>>   
>>>>     
>>>>         
>>>   
>>>       
>>     
>
>   



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42342-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:44:19 2009
Return-Path: <java-user-return-42342-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36080 invoked from network); 15 Sep 2009 15:44:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:44:19 -0000
Received: (qmail 62579 invoked by uid 500); 15 Sep 2009 15:44:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62489 invoked by uid 500); 15 Sep 2009 15:44:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62479 invoked by uid 99); 15 Sep 2009 15:44:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:44:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:44:05 +0000
Received: by fg-out-1718.google.com with SMTP id d23so845181fga.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 08:43:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=QPBhZkrPFIRInY42mlpAJ6HNcIWfiUNDQ21UihvkS1I=;
        b=GVYB51eMNgy8C0yCadefcks8NU7IwLoBYtY52HoS4pVDqR7mo7M7RQpVGUDX5vXtm/
         SjRhM2fEG913lumWjMvhV2Snh1jr0zeYzmCViTIXPtwE3JAwFOi5s9Fpeu7hfdEhxvVa
         HQ0kGjQi9eJB99HpXCisaCLRLhBe/xzYtzKaI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=B8azUSjYkh0YR6OE9hrxDr4Mpal/1lsqxcdy14X5JSD9R3XvIbrbluqEFKkEl0X+IH
         fbAbbYkZzkPa7gMjMpTeHjnqpXk+54RkXCuSH+G1oSHuoQeJ2f+g+6IrOp79YRd0sDth
         l+rt2u6SC6O1KewG5J2QbVftF6BDnruy8NKjQ=
Received: by 10.86.231.15 with SMTP id d15mr6364230fgh.74.1253029425093;
        Tue, 15 Sep 2009 08:43:45 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e20sm105871fga.25.2009.09.15.08.43.43
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 08:43:43 -0700 (PDT)
Message-ID: <4AAFB62E.10403@gmail.com>
Date: Tue, 15 Sep 2009 11:43:42 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com>
In-Reply-To: <4AAFB2EB.4020403@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Can you run the following test on your RAMDISK?

http://people.apache.org/~markrmiller/FileReadTest.java

I've taken it from the following issue (in which NIOFSDirectory was
developed):
https://issues.apache.org/jira/browse/LUCENE-753

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42343-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:51:24 2009
Return-Path: <java-user-return-42343-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38533 invoked from network); 15 Sep 2009 15:51:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:51:24 -0000
Received: (qmail 72084 invoked by uid 500); 15 Sep 2009 15:51:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72007 invoked by uid 500); 15 Sep 2009 15:51:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71976 invoked by uid 99); 15 Sep 2009 15:51:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:51:22 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:51:10 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 1D2C4D36003
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 17:50:20 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Fw8Q7s7ha9J6 for <java-user@lucene.apache.org>;
	Tue, 15 Sep 2009 17:50:04 +0200 (CEST)
Received: from VEGA (unknown [134.102.249.78])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id A7F7BD36002
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 17:50:04 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Tue, 15 Sep 2009 17:50:04 +0200
Message-ID: <A0B170DD0B3640CB85D24DDE2A8F56E4@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AAFB2EB.4020403@gmail.com>
Thread-Index: Aco2GXul2PObEFLySi2I2p3X/zVCMQAAoRrg
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

On 2.9. NIOFS is only used, if you use FSDirectory.open() instead of
FSDirectory.getDirectory (Deprecated). Can you compare when you use instead
of FSDirectory.open() the direct ctor of SimpleFSDir vs. NIOFSDir vs.
MMapDir and compare?

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Mark Miller [mailto:markrmiller@gmail.com]
> Sent: Tuesday, September 15, 2009 5:30 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
> 
> Thomas Becker wrote:
> > Hey Mark,
> >
> > yes. I'm running the app on unix. You see the difference between 2.9 and
> 2.4 here:
> >
> > http://ankeschwarzer.de/tmp/graph.jpg
> >
> Right - I know your measurements showed a difference (and will keep that
> in mind) - but the profiling results then seem
> oddly similar.
> 
> > 2.4 responds much quicker thus increasing throughput severly. I'm having
> a
> > single segment only:
> >
> > -rw-r--r-- 1 asuser asgroup         20 Sep  9 16:40 segments.gen
> > -rw-r--r-- 1 asuser asgroup        294 Sep  9 16:44 segments_1o
> > -rw-r--r-- 1 asuser asgroup 2810603184 Sep  9 16:44 _7c.cfs
> >
> > The FileChannel.read hotspot is indeed strange. Especially if taking
> into
> > account that the index is lying on a tmpfs (in memory). And 2.4 should
> be using
> > NIOFSDirectory as well?! Will check that.
> >
> 2.4 did not use NIOFSDirectory by default - you would have had to
> manually specified it. Now its used by default if its detects a non
> Windows OS.
> 
> Any particular reason your profiling output does not show invocations?
> Its not essential most likely, but I've found it to be helpful in
> comparisons.
> 
> We are about to release 2.9, and its been such a long haul, I'd hate to
> see a release with an unknown performance trap.
> 
> --
> - Mark
> 
> http://www.lucidimagination.com
> 
> 
> > Thanks a lot for your support!
> >
> > Cheers,
> > Thomas
> >
> > Mark Miller wrote:
> >
> >> A few quick notes -
> >>
> >> Lucene 2.9 old api doesn't appear much worse than Lucene 2.4?
> >>
> >> You save a lot with the new Intern impl, because thats not a hotspot
> >> anymore. But then,
> >> RandomAccessFile seeks end up being a lot more of the pie. They look
> >> fairly similar in speed overall?
> >>
> >> It looks like the major bottleneck with 2.9 new api is that its using
> >> NIOFSDirectory (your on unix I guess, and it now
> >> defaults to that on non Windows os's), and that appears to be a real
> >> killer for you. Its taking half the time for its
> >> reads.  ???
> >>
> >> No conclusions yet, but I'm looking it over. Some other guys will come
> >> in with some ideas as well.
> >>
> >> Do confirm that those profiling results are on a single segment though.
> >>
> >> - Mark
> >>
> >>
> >> Mark Miller wrote:
> >>
> >>> Thomas Becker wrote:
> >>>
> >>>
> >>>> Here's the results of profiling 10 different search requests:
> >>>>
> >>>> http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
> >>>> http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
> >>>> http://ankeschwarzer.de/tmp/lucene_29_newapi.png
> >>>>
> >>>> But you already gave me a good hint. The index being used is an old
> one build
> >>>> with lucene 2.4. I will now try a freshly build 2.9 index and see if
> performance
> >>>> improves. Maybe that already solves the issue...stupid me...
> >>>>
> >>>>
> >>>>
> >>> That shouldn't be an issue unless there is some odd bug.
> >>>
> >>>
> >>>
> >>>> We're updating the index every 30 min. at the moment and it gets
> optimized after
> >>>> each update.
> >>>>
> >>>>
> >>>>
> >>> So this profiling is on an optimized index (eg a single segment) ?
> >>> That would be odd indeed, and possibly point to some of the scoring
> changes.
> >>>
> >>>
> >>>
> >>>> Mark Miller wrote:
> >>>>
> >>>>
> >>>>
> >>>>> Thomas Becker wrote:
> >>>>>
> >>>>>
> >>>>>
> >>>>>> Hey Mark,
> >>>>>>
> >>>>>> thanks for your reply. Will do. Results will follow in a couple of
> minutes.
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>> Thanks, awesome.
> >>>>>
> >>>>> Also, how many segments (approx) are in your index? If there are a
> lot,
> >>>>> have you/can you try the same tests on an optimized index? Don't
> want to
> >>>>> get ahead of the profiling results, but just to continue the info
> loop.
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>
> >>>>
> >>>>
> >>>
> >>>
> >>
> >
> >
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42344-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:59:52 2009
Return-Path: <java-user-return-42344-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42799 invoked from network); 15 Sep 2009 15:59:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:59:52 -0000
Received: (qmail 92196 invoked by uid 500); 15 Sep 2009 15:59:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92121 invoked by uid 500); 15 Sep 2009 15:59:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92111 invoked by uid 99); 15 Sep 2009 15:59:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:59:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:59:38 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FFxIP5017687
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 17:59:18 +0200
Message-ID: <4AAFB9D5.7080207@net-m.de>
Date: Tue, 15 Sep 2009 17:59:17 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com>
In-Reply-To: <4AAFB62E.10403@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 17:59:18 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9807/Tue Sep 15 14:43:15 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Will do, tomorrow.

Mark Miller wrote:
> Can you run the following test on your RAMDISK?
> 
> http://people.apache.org/~markrmiller/FileReadTest.java
> 
> I've taken it from the following issue (in which NIOFSDirectory was
> developed):
> https://issues.apache.org/jira/browse/LUCENE-753
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42345-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 15:59:55 2009
Return-Path: <java-user-return-42345-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42845 invoked from network); 15 Sep 2009 15:59:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 15:59:55 -0000
Received: (qmail 92896 invoked by uid 500); 15 Sep 2009 15:59:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92849 invoked by uid 500); 15 Sep 2009 15:59:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92809 invoked by uid 99); 15 Sep 2009 15:59:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:59:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 15:59:39 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FFx391017662
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 17:59:04 +0200
Message-ID: <4AAFB9C7.90508@net-m.de>
Date: Tue, 15 Sep 2009 17:59:03 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com>
In-Reply-To: <4AAFB2EB.4020403@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 17:59:04 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9807/Tue Sep 15 14:43:15 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org



Mark Miller wrote:
> Thomas Becker wrote:
>> Hey Mark,
>>
>> yes. I'm running the app on unix. You see the difference between 2.9 and 2.4 here:
>>
>> http://ankeschwarzer.de/tmp/graph.jpg
>>   
> Right - I know your measurements showed a difference (and will keep that
> in mind) - but the profiling results then seem
> oddly similar.
Ok, got your point and agree.
> 
>> 2.4 responds much quicker thus increasing throughput severly. I'm having a
>> single segment only:
>>
>> -rw-r--r-- 1 asuser asgroup         20 Sep  9 16:40 segments.gen
>> -rw-r--r-- 1 asuser asgroup        294 Sep  9 16:44 segments_1o
>> -rw-r--r-- 1 asuser asgroup 2810603184 Sep  9 16:44 _7c.cfs
>>
>> The FileChannel.read hotspot is indeed strange. Especially if taking into
>> account that the index is lying on a tmpfs (in memory). And 2.4 should be using
>> NIOFSDirectory as well?! Will check that.
>>   
> 2.4 did not use NIOFSDirectory by default - you would have had to
> manually specified it. Now its used by default if its detects a non
> Windows OS.
Yes, I've checked that in the sources. I'm right now building the app and will
try it with SimpleFSDirectory. FSDirectory.open is replaced with new
SimpleFSDirectory. Will collect and post the results tomorrow. Seems to be a tad
faster. Details and new profiling data tomorrow. Have to leave now, sorry.
> 
> Any particular reason your profiling output does not show invocations?
> Its not essential most likely, but I've found it to be helpful in
> comparisons.
Yes, I reduced the profiler's impact on performance. It got horribly slow with
my usual profiling settings as soon as I included the org.apache.lucene files.
> 
> We are about to release 2.9, and its been such a long haul, I'd hate to
> see a release with an unknown performance trap.
> 
And me too. Doing my best to find the issue. :)
-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42346-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 16:00:16 2009
Return-Path: <java-user-return-42346-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43377 invoked from network); 15 Sep 2009 16:00:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 16:00:16 -0000
Received: (qmail 99257 invoked by uid 500); 15 Sep 2009 16:00:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99193 invoked by uid 500); 15 Sep 2009 16:00:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99183 invoked by uid 99); 15 Sep 2009 16:00:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:00:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:00:01 +0000
Received: from tbeckers-MacBook.local ([192.168.1.213])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8FFxeuR017722
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 17:59:41 +0200
Message-ID: <4AAFB9EC.2060401@net-m.de>
Date: Tue, 15 Sep 2009 17:59:40 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <A0B170DD0B3640CB85D24DDE2A8F56E4@VEGA>
In-Reply-To: <A0B170DD0B3640CB85D24DDE2A8F56E4@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Tue, 15 Sep 2009 17:59:41 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9807/Tue Sep 15 14:43:15 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Uwe,

already done. See my last message.

Cheers,
Thomas

Uwe Schindler wrote:
> On 2.9. NIOFS is only used, if you use FSDirectory.open() instead of
> FSDirectory.getDirectory (Deprecated). Can you compare when you use instead
> of FSDirectory.open() the direct ctor of SimpleFSDir vs. NIOFSDir vs.
> MMapDir and compare?
> 
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
> 
>> -----Original Message-----
>> From: Mark Miller [mailto:markrmiller@gmail.com]
>> Sent: Tuesday, September 15, 2009 5:30 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>
>> Thomas Becker wrote:
>>> Hey Mark,
>>>
>>> yes. I'm running the app on unix. You see the difference between 2.9 and
>> 2.4 here:
>>> http://ankeschwarzer.de/tmp/graph.jpg
>>>
>> Right - I know your measurements showed a difference (and will keep that
>> in mind) - but the profiling results then seem
>> oddly similar.
>>
>>> 2.4 responds much quicker thus increasing throughput severly. I'm having
>> a
>>> single segment only:
>>>
>>> -rw-r--r-- 1 asuser asgroup         20 Sep  9 16:40 segments.gen
>>> -rw-r--r-- 1 asuser asgroup        294 Sep  9 16:44 segments_1o
>>> -rw-r--r-- 1 asuser asgroup 2810603184 Sep  9 16:44 _7c.cfs
>>>
>>> The FileChannel.read hotspot is indeed strange. Especially if taking
>> into
>>> account that the index is lying on a tmpfs (in memory). And 2.4 should
>> be using
>>> NIOFSDirectory as well?! Will check that.
>>>
>> 2.4 did not use NIOFSDirectory by default - you would have had to
>> manually specified it. Now its used by default if its detects a non
>> Windows OS.
>>
>> Any particular reason your profiling output does not show invocations?
>> Its not essential most likely, but I've found it to be helpful in
>> comparisons.
>>
>> We are about to release 2.9, and its been such a long haul, I'd hate to
>> see a release with an unknown performance trap.
>>
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>> Thanks a lot for your support!
>>>
>>> Cheers,
>>> Thomas
>>>
>>> Mark Miller wrote:
>>>
>>>> A few quick notes -
>>>>
>>>> Lucene 2.9 old api doesn't appear much worse than Lucene 2.4?
>>>>
>>>> You save a lot with the new Intern impl, because thats not a hotspot
>>>> anymore. But then,
>>>> RandomAccessFile seeks end up being a lot more of the pie. They look
>>>> fairly similar in speed overall?
>>>>
>>>> It looks like the major bottleneck with 2.9 new api is that its using
>>>> NIOFSDirectory (your on unix I guess, and it now
>>>> defaults to that on non Windows os's), and that appears to be a real
>>>> killer for you. Its taking half the time for its
>>>> reads.  ???
>>>>
>>>> No conclusions yet, but I'm looking it over. Some other guys will come
>>>> in with some ideas as well.
>>>>
>>>> Do confirm that those profiling results are on a single segment though.
>>>>
>>>> - Mark
>>>>
>>>>
>>>> Mark Miller wrote:
>>>>
>>>>> Thomas Becker wrote:
>>>>>
>>>>>
>>>>>> Here's the results of profiling 10 different search requests:
>>>>>>
>>>>>> http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
>>>>>> http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
>>>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi.png
>>>>>>
>>>>>> But you already gave me a good hint. The index being used is an old
>> one build
>>>>>> with lucene 2.4. I will now try a freshly build 2.9 index and see if
>> performance
>>>>>> improves. Maybe that already solves the issue...stupid me...
>>>>>>
>>>>>>
>>>>>>
>>>>> That shouldn't be an issue unless there is some odd bug.
>>>>>
>>>>>
>>>>>
>>>>>> We're updating the index every 30 min. at the moment and it gets
>> optimized after
>>>>>> each update.
>>>>>>
>>>>>>
>>>>>>
>>>>> So this profiling is on an optimized index (eg a single segment) ?
>>>>> That would be odd indeed, and possibly point to some of the scoring
>> changes.
>>>>>
>>>>>
>>>>>> Mark Miller wrote:
>>>>>>
>>>>>>
>>>>>>
>>>>>>> Thomas Becker wrote:
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> Hey Mark,
>>>>>>>>
>>>>>>>> thanks for your reply. Will do. Results will follow in a couple of
>> minutes.
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>> Thanks, awesome.
>>>>>>>
>>>>>>> Also, how many segments (approx) are in your index? If there are a
>> lot,
>>>>>>> have you/can you try the same tests on an optimized index? Don't
>> want to
>>>>>>> get ahead of the profiling results, but just to continue the info
>> loop.
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42347-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 16:02:07 2009
Return-Path: <java-user-return-42347-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43743 invoked from network); 15 Sep 2009 16:02:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 16:02:07 -0000
Received: (qmail 2179 invoked by uid 500); 15 Sep 2009 16:02:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2094 invoked by uid 500); 15 Sep 2009 16:02:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2084 invoked by uid 99); 15 Sep 2009 16:02:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:02:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [67.195.15.187] (HELO web111510.mail.gq1.yahoo.com) (67.195.15.187)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 15 Sep 2009 16:01:53 +0000
Received: (qmail 66495 invoked by uid 60001); 15 Sep 2009 16:00:21 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253030421; bh=txX4cfRqd2IrY1iKFgq9Thyf1w6JbaflGwiFe/ceweo=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=xSTWEMMvOn32XfzcggJNnLx2rBIXPSjxWxM9GjZ3lkyaGckmfqnhr+ITOiN/Q5gJMxmQcCK9la03hwdTaS54tV74F65k9wKqCQpn6jvxbigfFtDFvKxHwKFX/x3VjBbTYHTBKyoh2zeKlux8ao469Bux/4DUTFNU6LZfMXTvFS0=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=peeLnO3LXM1JzuL7PTyaBMaozQgE2DsNt49owVTSBHr6f6gsufVCEvaZb+KAmT7D86rCsM++NUbZl8k8IsEEcz0q18fJlILh+rLyOZS1SuYl/5d61ZW+6ICu6QQbruQ+1FvDnEqFXjHFX0i2Z/bXUShuHJYmpPXimssg0FK+Pz4=;
Message-ID: <675179.66375.qm@web111510.mail.gq1.yahoo.com>
X-YMail-OSG: heIxNqkVM1lhF1uFP4Gl4lAY_kILrXgalzd6Oq10LHm7yFw4Vt5DXykiJ10GNy_eprwSgo58kHDbHeM9MX6fPVY1J0u8tIpcWuHoG_MBTowa0Uw5.6kvT7nEv_DVTHMcciamL3NQhDwgrYGfuMzApnIATTd6_Ku4GHQsvTjmTsTyogPdLMMPo4RWEhCfj7jfWSMBOs2EK9u6bUfovlUDS2mRNIhnJnXzt2ZbMGEhAcvEeG2i8vP02gQ3EBZziYnSDm9dV2nLX8YhGoVZzkB_1DyKhyyzUa7qQXhi2ZgT3pyhmPK0bO3N
Received: from [123.114.248.230] by web111510.mail.gq1.yahoo.com via HTTP; Tue, 15 Sep 2009 09:00:21 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.347.2
References: <309714.59761.qm@web111503.mail.gq1.yahoo.com> <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com>
Date: Tue, 15 Sep 2009 09:00:21 -0700 (PDT)
From: Kerang Lv <lvkrnewer@yahoo.com>
Subject: Re: Run your Lucene Applications on Google AppEngine with GAELucene
To: java-user@lucene.apache.org
In-Reply-To: <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

>I think I will try this today evening.
Remember to update your local project from the svn, I fixed some mistakes just now. I apologize for my negligence.

>I think we should put this as one of component in lucene-contrib. What do you say?
Yes, that's a good news.



----- Original Message ----
From: Allahbaksh Mohammedali Asadullah <Allahbaksh_Asadullah@infosys.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Sent: Tuesday, September 15, 2009 12:39:16 PM
Subject: RE: Run your Lucene Applications on Google AppEngine with GAELucene


Hi,
This is great news and good work. I think I will try this today evening. I think we should put this as one of component in lucene-contrib. What do you say? Committer and owner please comment.
Regards,
Allahbaksh



-----Original Message-----
From: Kerang Lv [mailto:lvkrnewer@yahoo.com] 
Sent: Monday, September 14, 2009 9:34 PM
To: java-user@lucene.apache.org
Subject: Run your Lucene Applications on Google AppEngine with GAELucene

Hi Lucene users,

Enlightened by the discussion "Can I run Lucene in google app engine? [http://www.nabble.com/Can-I-run-Lucene-in-google-app-engine--td23017742.html], I implemented a google datastore based Lucene component, GAELucene, which can help you to run search applications on google app engine.

The main clazz of GAELucene include: 
    * GAEDirectory - a read only Directory based on google datastore. 
    * GAEFile - stands for an index file, the file's byte content will be splited into multi GAEFileContent. 
    * GAEFileContent - stands for a segment of index file. 
    * GAECategory - the identifier of different indices. 
    * GAEIndexInput - a memory-resident IndexInput? implementation like the RAMInputStream. 
    * GAEIndexReader - wrapper for IndexReader? that cached in GAEIndexReaderPool 
    * GAEIndexReaderPool - pool for GAEIndexReader 

The following code snippet demonstrates the use of GAELucene do searching: 
  Query queryObject = parserQuery(request);
  GAEIndexReaderPool readerPool =GAEIndexReaderPool.getInstance();
  GAEIndexReader indexReader = readerPool.borrowReader(INDEX_CATEGORY_DEMO);
  IndexSearcher searcher =newIndexSearcher(indexReader);
  Hits hits = searcher.search(queryObject);
  readerPool.returnReader(indexReader);

You can find morere 'http://code.google.com/p/gaelucene/'



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42348-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 16:15:26 2009
Return-Path: <java-user-return-42348-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47854 invoked from network); 15 Sep 2009 16:15:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 16:15:26 -0000
Received: (qmail 25601 invoked by uid 500); 15 Sep 2009 16:15:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25534 invoked by uid 500); 15 Sep 2009 16:15:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25524 invoked by uid 99); 15 Sep 2009 16:15:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:15:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [67.195.15.139] (HELO web111502.mail.gq1.yahoo.com) (67.195.15.139)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 15 Sep 2009 16:15:12 +0000
Received: (qmail 37328 invoked by uid 60001); 15 Sep 2009 16:13:51 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253031231; bh=oJHTB8sZB+8lHLnGc8jeJXu7IWB5XKLLkHKWfow/eQg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=O3vmNsNxao9ZWOLXlb3X61EWLmtLLBgxMdSrA5CvjuXe7PWHJ0kRTGy23fbdhWHG1s9Ih+JX04qVsg/ilwQZsM1R3oYjmzK9z3+a2SKZnXLIYga+wA+okbxQYDLOLV/H1/CDROJPztufQ1Yd3ZAXE7RhruKPVnwaV42UVp+3VtI=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=BGTJ5u7tcnL8QWiEodO8QQshAYiNZPWrQ5XoMn/anl/kP6qs19jI9HzYjR2t7flLWZ1r65wC7T27c1LSmx0CFkxX0P5O8/noPfK3F3mh8rX/vT9QZZLqyMB9lkpCLPhcmPlsW/jSKECPvfC67LCCX9eTxJxMNMO+FcwPODPaZgw=;
Message-ID: <18320.37082.qm@web111502.mail.gq1.yahoo.com>
X-YMail-OSG: 5x6aciIVM1nhEQ3YjL5LIfA13ib6pxlITj9h_oERh6A5_5MaE47U2LlW7MY85qTDadCfvOXrE4UWwA7lyuhqd_Dm.Xot41Up9RAt4irCxPh6BoII0aQAbkpO_6ReqWI0U53BQKyZqnX4yyvtzZbdTlGm4KnA5c4HbT2TrhiOz2Tx7g7gpUnt_gwA4Wse_2LEp7dBPX1L5ifYNticOeALZ_x8.j5_MH4LeyKjzF7m..TzuUrQoncOpfO_dxplP6wNbFIH2hErPzVEB0eGciy2f_IrbSKBXHmdMcQ4p6ekpvk9KYhsrU4e
Received: from [123.114.248.230] by web111502.mail.gq1.yahoo.com via HTTP; Tue, 15 Sep 2009 09:13:50 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.347.2
References: <309714.59761.qm@web111503.mail.gq1.yahoo.com> <7af3bac90909150305t6583e36aidc2bb63584665f76@mail.gmail.com>
Date: Tue, 15 Sep 2009 09:13:50 -0700 (PDT)
From: Kerang Lv <lvkrnewer@yahoo.com>
Subject: Re: Run your Lucene Applications on Google AppEngine with GAELucene
To: java-user@lucene.apache.org
In-Reply-To: <7af3bac90909150305t6583e36aidc2bb63584665f76@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

>Do you plan to support in memory indexes using the memcache api?
I'm afraid not, I prefer to do indexing on another machine before I got a plan that can finish indexing within 30s.



----- Original Message ----
From: Erdinc Yilmazel <erdincyilmazel@gmail.com>
To: java-user@lucene.apache.org
Sent: Tuesday, September 15, 2009 6:05:15 PM
Subject: Re: Run your Lucene Applications on Google AppEngine with GAELucene

This is great news! Are you happy with the the performance of the google
data store? Do you plan to support in memory indexes using the memcache api?

Thanks

On Mon, Sep 14, 2009 at 5:04 PM, Kerang Lv <lvkrnewer@yahoo.com> wrote:

> Hi Lucene users,
>
> Enlightened by the discussion "Can I run Lucene in google app engine? [
> http://www.nabble.com/Can-I-run-Lucene-in-google-app-engine--td23017742.html],
> I implemented a google datastore based Lucene component, GAELucene, which
> can help you to run search applications on google app engine.
>
> The main clazz of GAELucene include:
>    * GAEDirectory - a read only Directory based on google datastore.
>    * GAEFile - stands for an index file, the file's byte content will be
> splited into multi GAEFileContent.
>    * GAEFileContent - stands for a segment of index file.
>    * GAECategory - the identifier of different indices.
>    * GAEIndexInput - a memory-resident IndexInput? implementation like the
> RAMInputStream.
>    * GAEIndexReader - wrapper for IndexReader? that cached in
> GAEIndexReaderPool
>    * GAEIndexReaderPool - pool for GAEIndexReader
>
> The following code snippet demonstrates the use of GAELucene do searching:
>  Query queryObject = parserQuery(request);
>  GAEIndexReaderPool readerPool =GAEIndexReaderPool.getInstance();
>  GAEIndexReader indexReader = readerPool.borrowReader(INDEX_CATEGORY_DEMO);
>  IndexSearcher searcher =newIndexSearcher(indexReader);
>  Hits hits = searcher.search(queryObject);
>  readerPool.returnReader(indexReader);
>
> You can find more here 'http://code.google.com/p/gaelucene/'
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42349-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 16:37:53 2009
Return-Path: <java-user-return-42349-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56618 invoked from network); 15 Sep 2009 16:37:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 16:37:53 -0000
Received: (qmail 72264 invoked by uid 500); 15 Sep 2009 16:37:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72186 invoked by uid 500); 15 Sep 2009 16:37:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72176 invoked by uid 99); 15 Sep 2009 16:37:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:37:50 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:37:38 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 3EF3DD36003
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 18:37:18 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ua59fnniDsX9 for <java-user@lucene.apache.org>;
	Tue, 15 Sep 2009 18:37:09 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 69776D36002
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 18:37:09 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Tue, 15 Sep 2009 18:37:09 +0200
Message-ID: <5985A0861800491EAFFCD4B0B61351A0@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Aco2GXul2PObEFLySi2I2p3X/zVCMQACNhNA
In-Reply-To: <4AAFB2EB.4020403@gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Maybe Linux has some problems with NIO on tmpfs/other ramdisks. What Linux
do you use, 64bit or 32bit JVM and kernel, ram fs type?

If you have 64 bit and you stored your index in Linux tmpfs (not the old RAM
fs), the fastest would be MMapDirectory, as the tmpfs RAM can be directly
used when mapped into the JVM address space.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Mark Miller [mailto:markrmiller@gmail.com]
> Sent: Tuesday, September 15, 2009 5:30 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
> 
> Thomas Becker wrote:
> > Hey Mark,
> >
> > yes. I'm running the app on unix. You see the difference between 2.9 and
> 2.4 here:
> >
> > http://ankeschwarzer.de/tmp/graph.jpg
> >
> Right - I know your measurements showed a difference (and will keep that
> in mind) - but the profiling results then seem
> oddly similar.
> 
> > 2.4 responds much quicker thus increasing throughput severly. I'm having
> a
> > single segment only:
> >
> > -rw-r--r-- 1 asuser asgroup         20 Sep  9 16:40 segments.gen
> > -rw-r--r-- 1 asuser asgroup        294 Sep  9 16:44 segments_1o
> > -rw-r--r-- 1 asuser asgroup 2810603184 Sep  9 16:44 _7c.cfs
> >
> > The FileChannel.read hotspot is indeed strange. Especially if taking
> into
> > account that the index is lying on a tmpfs (in memory). And 2.4 should
> be using
> > NIOFSDirectory as well?! Will check that.
> >
> 2.4 did not use NIOFSDirectory by default - you would have had to
> manually specified it. Now its used by default if its detects a non
> Windows OS.
> 
> Any particular reason your profiling output does not show invocations?
> Its not essential most likely, but I've found it to be helpful in
> comparisons.
> 
> We are about to release 2.9, and its been such a long haul, I'd hate to
> see a release with an unknown performance trap.
> 
> --
> - Mark
> 
> http://www.lucidimagination.com
> 
> 
> > Thanks a lot for your support!
> >
> > Cheers,
> > Thomas
> >
> > Mark Miller wrote:
> >
> >> A few quick notes -
> >>
> >> Lucene 2.9 old api doesn't appear much worse than Lucene 2.4?
> >>
> >> You save a lot with the new Intern impl, because thats not a hotspot
> >> anymore. But then,
> >> RandomAccessFile seeks end up being a lot more of the pie. They look
> >> fairly similar in speed overall?
> >>
> >> It looks like the major bottleneck with 2.9 new api is that its using
> >> NIOFSDirectory (your on unix I guess, and it now
> >> defaults to that on non Windows os's), and that appears to be a real
> >> killer for you. Its taking half the time for its
> >> reads.  ???
> >>
> >> No conclusions yet, but I'm looking it over. Some other guys will come
> >> in with some ideas as well.
> >>
> >> Do confirm that those profiling results are on a single segment though.
> >>
> >> - Mark
> >>
> >>
> >> Mark Miller wrote:
> >>
> >>> Thomas Becker wrote:
> >>>
> >>>
> >>>> Here's the results of profiling 10 different search requests:
> >>>>
> >>>> http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
> >>>> http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
> >>>> http://ankeschwarzer.de/tmp/lucene_29_newapi.png
> >>>>
> >>>> But you already gave me a good hint. The index being used is an old
> one build
> >>>> with lucene 2.4. I will now try a freshly build 2.9 index and see if
> performance
> >>>> improves. Maybe that already solves the issue...stupid me...
> >>>>
> >>>>
> >>>>
> >>> That shouldn't be an issue unless there is some odd bug.
> >>>
> >>>
> >>>
> >>>> We're updating the index every 30 min. at the moment and it gets
> optimized after
> >>>> each update.
> >>>>
> >>>>
> >>>>
> >>> So this profiling is on an optimized index (eg a single segment) ?
> >>> That would be odd indeed, and possibly point to some of the scoring
> changes.
> >>>
> >>>
> >>>
> >>>> Mark Miller wrote:
> >>>>
> >>>>
> >>>>
> >>>>> Thomas Becker wrote:
> >>>>>
> >>>>>
> >>>>>
> >>>>>> Hey Mark,
> >>>>>>
> >>>>>> thanks for your reply. Will do. Results will follow in a couple of
> minutes.
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>> Thanks, awesome.
> >>>>>
> >>>>> Also, how many segments (approx) are in your index? If there are a
> lot,
> >>>>> have you/can you try the same tests on an optimized index? Don't
> want to
> >>>>> get ahead of the profiling results, but just to continue the info
> loop.
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>
> >>>>
> >>>>
> >>>
> >>>
> >>
> >
> >
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42350-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 16:46:07 2009
Return-Path: <java-user-return-42350-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58649 invoked from network); 15 Sep 2009 16:46:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 16:46:07 -0000
Received: (qmail 85706 invoked by uid 500); 15 Sep 2009 16:46:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85641 invoked by uid 500); 15 Sep 2009 16:46:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85631 invoked by uid 99); 15 Sep 2009 16:46:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:46:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [139.56.8.26] (HELO mail-fw.broadvision.com) (139.56.8.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:45:56 +0000
X-ASG-Debug-ID: 1253033118-624b00b20000-H1Y1KX
X-Barracuda-URL: http://mail-fw.broadvision.com:8000/cgi-bin/mark.cgi
Received: from RW-EX2003.BROADVISION.COM (localhost [127.0.0.1])
	by mail-fw.broadvision.com (Spam Firewall) with ESMTP id C278045552
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 09:45:18 -0700 (PDT)
Received: from RW-EX2003.BROADVISION.COM (rw-ex2003.broadvision.com [10.10.160.33]) by mail-fw.broadvision.com with ESMTP id eLAIIHO1XFPSVjyl for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 09:45:18 -0700 (PDT)
X-ASG-Whitelist: Client
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: Concurrent indexing thread/process safety issue - can we have document-lock instead of directory-lock in future?
Subject: Concurrent indexing thread/process safety issue - can we have document-lock instead of directory-lock in future?
Date: Tue, 15 Sep 2009 09:45:18 -0700
Message-ID: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151FE13@rw-ex2003.BROADVISION.COM>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Concurrent indexing thread/process safety issue - can we have document-lock instead of directory-lock in future?
Thread-Index: Aco2I+iQm2OHHw3cRSirXUgi6zQTyA==
From: "Zhang, Lisheng" <Lisheng.Zhang@BroadVision.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: rw-ex2003.broadvision.com[10.10.160.33]
X-Barracuda-Start-Time: 1253033118
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at broadvision.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I read through the lucene thread/process safety issue for concurrent
indexing, my understanding is that each indexing through IndexWriter
will lock the whole index directory.

Now we need to index a community blog where many people add/update,
so queuing all those indexing requests would be a performance burden.

In RDB we can have record-locking instead of page-locking, I am =
wondering
whether it is possible in future we can have document-locking instead of
directory-locking for lucene indexing, which would be a performance =
boost?

Thanks very much for helps, Lisheng

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42351-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 16:47:25 2009
Return-Path: <java-user-return-42351-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59001 invoked from network); 15 Sep 2009 16:47:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 16:47:25 -0000
Received: (qmail 89173 invoked by uid 500); 15 Sep 2009 16:47:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89083 invoked by uid 500); 15 Sep 2009 16:47:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89073 invoked by uid 99); 15 Sep 2009 16:47:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:47:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 16:47:10 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1253617fgg.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 09:45:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=9eLpt6o3TsSROp4XWMsBLV7TNz1XhN5Tz97LvFyEarc=;
        b=Sp7NkJM53Vt/2QL2D3OZHxRb6j6QHLLktLNra3V9wv5pTPgN6sPsM7c3glhvQPp7cc
         t9eLXRn+ZsbF7b72akb1lT6NVwjNPqL+qWkEBrZ4pkrmSOe3tHiUfU0BMiNuvKWQqdLL
         ML0FGUlRe4I6z+NeEgn0n2J775eyxgvTqqAso=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=vZl+ImK2EMnrOBmLBO0K6IHmptAOZx17UzM60GC5rPrkNE0S9WFmj2bq9/Ey5xPeE5
         D2leNmupzC7Dq6j4fHxG/+fO0XjIcAYcufTEzNgD7M2e1AllF4ALlglqgyVje3UOByPU
         JllrDcBBiouhRiRz07ot44a5wR+S+hFWKFl+Y=
Received: by 10.86.184.35 with SMTP id h35mr6427491fgf.18.1253033148979;
        Tue, 15 Sep 2009 09:45:48 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id d4sm282977fga.28.2009.09.15.09.45.44
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 09:45:45 -0700 (PDT)
Message-ID: <4AAFC4B8.9040608@gmail.com>
Date: Tue, 15 Sep 2009 12:45:44 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <5985A0861800491EAFFCD4B0B61351A0@VEGA>
In-Reply-To: <5985A0861800491EAFFCD4B0B61351A0@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - with
SeparateFile all 4 of my cores are immediately pinned and remain so.
With ChannelFile, all 4 cores hover 20-30%.

It would appear it may not be a good idea to use NIOFSDirectory on ramdisks.

Even still though - it looks like you have a further issue - your Lucene
2.9 old-api results don't use it, and are still not good.

-- 
- Mark

http://www.lucidimagination.com


Uwe Schindler wrote:
> Maybe Linux has some problems with NIO on tmpfs/other ramdisks. What Linux
> do you use, 64bit or 32bit JVM and kernel, ram fs type?
>
> If you have 64 bit and you stored your index in Linux tmpfs (not the old RAM
> fs), the fastest would be MMapDirectory, as the tmpfs RAM can be directly
> used when mapped into the JVM address space.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>   
>> -----Original Message-----
>> From: Mark Miller [mailto:markrmiller@gmail.com]
>> Sent: Tuesday, September 15, 2009 5:30 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>
>> Thomas Becker wrote:
>>     
>>> Hey Mark,
>>>
>>> yes. I'm running the app on unix. You see the difference between 2.9 and
>>>       
>> 2.4 here:
>>     
>>> http://ankeschwarzer.de/tmp/graph.jpg
>>>
>>>       
>> Right - I know your measurements showed a difference (and will keep that
>> in mind) - but the profiling results then seem
>> oddly similar.
>>
>>     
>>> 2.4 responds much quicker thus increasing throughput severly. I'm having
>>>       
>> a
>>     
>>> single segment only:
>>>
>>> -rw-r--r-- 1 asuser asgroup         20 Sep  9 16:40 segments.gen
>>> -rw-r--r-- 1 asuser asgroup        294 Sep  9 16:44 segments_1o
>>> -rw-r--r-- 1 asuser asgroup 2810603184 Sep  9 16:44 _7c.cfs
>>>
>>> The FileChannel.read hotspot is indeed strange. Especially if taking
>>>       
>> into
>>     
>>> account that the index is lying on a tmpfs (in memory). And 2.4 should
>>>       
>> be using
>>     
>>> NIOFSDirectory as well?! Will check that.
>>>
>>>       
>> 2.4 did not use NIOFSDirectory by default - you would have had to
>> manually specified it. Now its used by default if its detects a non
>> Windows OS.
>>
>> Any particular reason your profiling output does not show invocations?
>> Its not essential most likely, but I've found it to be helpful in
>> comparisons.
>>
>> We are about to release 2.9, and its been such a long haul, I'd hate to
>> see a release with an unknown performance trap.
>>
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>     
>>> Thanks a lot for your support!
>>>
>>> Cheers,
>>> Thomas
>>>
>>> Mark Miller wrote:
>>>
>>>       
>>>> A few quick notes -
>>>>
>>>> Lucene 2.9 old api doesn't appear much worse than Lucene 2.4?
>>>>
>>>> You save a lot with the new Intern impl, because thats not a hotspot
>>>> anymore. But then,
>>>> RandomAccessFile seeks end up being a lot more of the pie. They look
>>>> fairly similar in speed overall?
>>>>
>>>> It looks like the major bottleneck with 2.9 new api is that its using
>>>> NIOFSDirectory (your on unix I guess, and it now
>>>> defaults to that on non Windows os's), and that appears to be a real
>>>> killer for you. Its taking half the time for its
>>>> reads.  ???
>>>>
>>>> No conclusions yet, but I'm looking it over. Some other guys will come
>>>> in with some ideas as well.
>>>>
>>>> Do confirm that those profiling results are on a single segment though.
>>>>
>>>> - Mark
>>>>
>>>>
>>>> Mark Miller wrote:
>>>>
>>>>         
>>>>> Thomas Becker wrote:
>>>>>
>>>>>
>>>>>           
>>>>>> Here's the results of profiling 10 different search requests:
>>>>>>
>>>>>> http://ankeschwarzer.de/tmp/lucene_24_oldapi.png
>>>>>> http://ankeschwarzer.de/tmp/lucene_29_oldapi.png
>>>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi.png
>>>>>>
>>>>>> But you already gave me a good hint. The index being used is an old
>>>>>>             
>> one build
>>     
>>>>>> with lucene 2.4. I will now try a freshly build 2.9 index and see if
>>>>>>             
>> performance
>>     
>>>>>> improves. Maybe that already solves the issue...stupid me...
>>>>>>
>>>>>>
>>>>>>
>>>>>>             
>>>>> That shouldn't be an issue unless there is some odd bug.
>>>>>
>>>>>
>>>>>
>>>>>           
>>>>>> We're updating the index every 30 min. at the moment and it gets
>>>>>>             
>> optimized after
>>     
>>>>>> each update.
>>>>>>
>>>>>>
>>>>>>
>>>>>>             
>>>>> So this profiling is on an optimized index (eg a single segment) ?
>>>>> That would be odd indeed, and possibly point to some of the scoring
>>>>>           
>> changes.
>>     
>>>>>
>>>>>           
>>>>>> Mark Miller wrote:
>>>>>>
>>>>>>
>>>>>>
>>>>>>             
>>>>>>> Thomas Becker wrote:
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>>>> Hey Mark,
>>>>>>>>
>>>>>>>> thanks for your reply. Will do. Results will follow in a couple of
>>>>>>>>                 
>> minutes.
>>     
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>>>>> Thanks, awesome.
>>>>>>>
>>>>>>> Also, how many segments (approx) are in your index? If there are a
>>>>>>>               
>> lot,
>>     
>>>>>>> have you/can you try the same tests on an optimized index? Don't
>>>>>>>               
>> want to
>>     
>>>>>>> get ahead of the profiling results, but just to continue the info
>>>>>>>               
>> loop.
>>     
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>>
>>>>>>             
>>>>>           
>>>       
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42352-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 17:17:07 2009
Return-Path: <java-user-return-42352-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71013 invoked from network); 15 Sep 2009 17:17:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 17:17:07 -0000
Received: (qmail 33400 invoked by uid 500); 15 Sep 2009 17:17:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33326 invoked by uid 500); 15 Sep 2009 17:17:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33316 invoked by uid 99); 15 Sep 2009 17:17:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:17:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:16:53 +0000
Received: by fg-out-1718.google.com with SMTP id d23so872502fga.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 10:15:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=KBRuRD9MFwP30VyS9iHV8MNAc+L4r6qtHKcz03LwORw=;
        b=GXkaRMP7kFOU7u2ygne1/dHrqCyp70iosicQCpfCEa86oABiz5fnZ+tNOGYJpzMT/o
         bdEgWyXyUEx9B/RbyABK5btkyv94PNXkiHllov047Mmv21kHJS8kdGyitQzsxTO7viin
         D2Z2ctv6ReAL8rKH/FeRWZDwowvDkUHwDkB4U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=SVb3ZavFyRENyilSRwVn7CjgLC1IEfWieFgZm1ATmVfCRS9cQTqB7q6fjDI3bhGW+t
         lD6nHslWNUzZAZLT0qay2ozHNNQOaY8wUaZb1Nc+1XP7tGO76TDf2MXKq7FSaZsJZYQi
         jF195hlb8c3+MqDQfyz1Nt6y2TmeJeiAE7tjY=
Received: by 10.86.249.22 with SMTP id w22mr366860fgh.1.1253034932965;
        Tue, 15 Sep 2009 10:15:32 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id l12sm208676fgb.23.2009.09.15.10.15.31
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 10:15:31 -0700 (PDT)
Message-ID: <4AAFCBB2.8090601@gmail.com>
Date: Tue, 15 Sep 2009 13:15:30 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <5985A0861800491EAFFCD4B0B61351A0@VEGA> <4AAFC4B8.9040608@gmail.com>
In-Reply-To: <4AAFC4B8.9040608@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Mark Miller wrote:
> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - with
> SeparateFile all 4 of my cores are immediately pinned and remain so.
> With ChannelFile, all 4 cores hover 20-30%.
>
> It would appear it may not be a good idea to use NIOFSDirectory on ramdisks.
>
> Even still though - it looks like you have a further issue - your Lucene
> 2.9 old-api results don't use it, and are still not good.
>
>   
The quick results:

ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
size=1G,nr_inodes=200k,mode=01777

config: impl=SeparateFile serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295611, ms=173550, MB/sec=1683.7899579371938

config: impl=ChannelFile serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295361, ms=1377768, MB/sec=212.09793463050383


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42353-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 17:27:21 2009
Return-Path: <java-user-return-42353-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75510 invoked from network); 15 Sep 2009 17:27:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 17:27:21 -0000
Received: (qmail 51070 invoked by uid 500); 15 Sep 2009 17:27:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50996 invoked by uid 500); 15 Sep 2009 17:27:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50986 invoked by uid 99); 15 Sep 2009 17:27:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:27:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:27:06 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 4F77FD36003
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 19:26:16 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id XveBDCgmfkSw for <java-user@lucene.apache.org>;
	Tue, 15 Sep 2009 19:26:06 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id F0427D36002
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 19:26:05 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <5985A0861800491EAFFCD4B0B61351A0@VEGA> <4AAFC4B8.9040608@gmail.com> <4AAFCBB2.8090601@gmail.com>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Tue, 15 Sep 2009 19:26:05 +0200
Message-ID: <020FFC0B85B44457BA5D38315A91422C@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
Thread-Index: Aco2KGaEkeuns6IUTeaF/CMnOlsvEgAASfMQ
In-Reply-To: <4AAFCBB2.8090601@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

How does a conventional file system compare?

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Mark Miller [mailto:markrmiller@gmail.com]
> Sent: Tuesday, September 15, 2009 7:15 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
> 
> Mark Miller wrote:
> > Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - with
> > SeparateFile all 4 of my cores are immediately pinned and remain so.
> > With ChannelFile, all 4 cores hover 20-30%.
> >
> > It would appear it may not be a good idea to use NIOFSDirectory on
> ramdisks.
> >
> > Even still though - it looks like you have a further issue - your Lucene
> > 2.9 old-api results don't use it, and are still not good.
> >
> >
> The quick results:
> 
> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
> size=1G,nr_inodes=200k,mode=01777
> 
> config: impl=SeparateFile serial=false nThreads=4 iterations=100
> bufsize=1024 poolsize=2 filelen=730554368
> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
> 
> config: impl=ChannelFile serial=false nThreads=4 iterations=100
> bufsize=1024 poolsize=2 filelen=730554368
> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
> 
> 
> --
> - Mark
> 
> http://www.lucidimagination.com
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42354-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 17:30:20 2009
Return-Path: <java-user-return-42354-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75894 invoked from network); 15 Sep 2009 17:30:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 17:30:20 -0000
Received: (qmail 54033 invoked by uid 500); 15 Sep 2009 17:30:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53954 invoked by uid 500); 15 Sep 2009 17:30:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53944 invoked by uid 99); 15 Sep 2009 17:30:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:30:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:30:08 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 6AE7671C5AA; Tue, 15 Sep 2009 10:29:17 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 6783571C545
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 10:29:17 -0700 (PDT)
Date: Tue, 15 Sep 2009 10:29:17 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: Lucene User <java-user@lucene.apache.org>
Subject: Re: NumberFormatException when creating field cache
In-Reply-To: <4AA871A8.3070307@teamware.com>
Message-ID: <Pine.LNX.4.64.0909151025410.27546@radix.cryptio.net>
References: <4AA871A8.3070307@teamware.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Would it be useful to allow some sort of data tolerance when creating these
: caches?  At least now the only solution is to delete that Document.  Perhaps
: the values could then be returned as 0 in the Parser implementations for
: numeric failures.

picking an artibtrary number wouldn't be very general purpose.  it would 
hide errors.

clients that want more tollerant parsing behavior are free to provide 
their own parser...
http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/FieldCache.IntParser.html




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42355-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 17:38:00 2009
Return-Path: <java-user-return-42355-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78617 invoked from network); 15 Sep 2009 17:38:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 17:38:00 -0000
Received: (qmail 71057 invoked by uid 500); 15 Sep 2009 17:37:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70978 invoked by uid 500); 15 Sep 2009 17:37:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70968 invoked by uid 99); 15 Sep 2009 17:37:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:37:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:37:47 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 4D9A571C5AA; Tue, 15 Sep 2009 10:37:27 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 495ED71C545
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 10:37:27 -0700 (PDT)
Date: Tue, 15 Sep 2009 10:37:27 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: RE: New "Stream closed" exception with Java 6
In-Reply-To: <802289754.4941252573953010.JavaMail.root@mail.uk.scalix.com>
Message-ID: <Pine.LNX.4.64.0909151029590.27546@radix.cryptio.net>
References: <802289754.4941252573953010.JavaMail.root@mail.uk.scalix.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org

: "it's possibly you just have a simple bug where you are  closing the reader before you pass it to Lucene, 
: 
:       or maybe you are mistakenly adding the same field twice
: 
: (or in two different documents)"
: 
: Are you saying that if I were attempting to delete a doc and then add it 
: again (e.g. update), but for some reason the delete didn't work, I would 
: get a "Stream closed" exception?

Uh... no.  I didn't say anything about delets, or updates.  I'm talking 
about the java.io.Reader class.  AS i recall (not looking at it right now) 
Your stack trace showed that when lucene tried to access a an 
InputStreamReader from a Field in your document it was already closed.  
that could happen if you did something like this...

   File myFileOnDisk = new File(path);
   Reader fileContents = new InputStreamReader(new FileInputStream(myFileOnDisk));
   fileContents.close();
   doc.addField(new Field("field name", fileContents));

...but there are lots of other ways it could happen too, it's impossible 
to list all the ways it might happen without knowing where exactly that 
InputStreamReader is coming from, and where the underlying INputStream 
is coming from, and what code has refrences to either of them between the 
time it's created and the time Lucene finally attempts to read from it.

: careful about your assumptions ... you could get this same type of 
: exception even with only one thread, the stream that's being closed isn't 
: internal to Lucene, it's the InputStreamReader you supplied as the value 
: of some Field.  it's possibly you just have a simple bug where you are 
: closing hte reader before you pass it to Lucene, or maybe you are 
: mistakenly adding the saame field twice (or in two different documents)



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42356-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 17:46:37 2009
Return-Path: <java-user-return-42356-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83869 invoked from network); 15 Sep 2009 17:46:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 17:46:37 -0000
Received: (qmail 90960 invoked by uid 500); 15 Sep 2009 17:46:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90896 invoked by uid 500); 15 Sep 2009 17:46:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90886 invoked by uid 99); 15 Sep 2009 17:46:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:46:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 17:46:25 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id D6C9F71C5C3; Tue, 15 Sep 2009 10:46:04 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id BB28971C545
	for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 10:46:04 -0700 (PDT)
Date: Tue, 15 Sep 2009 10:46:04 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Field with reader limitation arbitrary
In-Reply-To: <5e76f3840909141303x7da19b6bmb66f31de9da6fef1@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0909151039280.27546@radix.cryptio.net>
References: <5e76f3840909141303x7da19b6bmb66f31de9da6fef1@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Someone has made the decision that we will not be interested in
: storing files read using a Reader (at least not with these
: constructors).
: This is rather arbitrary.

No, it was not arbitrary at all.

The javadocs there are not a "decree" of what shall or shan't be 
supported, they are an explanation of how the constructor works so that 
there isn't any confusion.

The *reason* why the code works that way, is because when Lucene 
processes Fields that use a Reader, it doesn't buffer the Reader so it 
can't store the full contents of that Reader. the *reason* it doesnt' 
buffer the reader is because then it would have to make very arbitrary 
memory decisions that could easily result in OOM (Readers can in fact be
infinite streams of characters)

clients that want to store the value, need to be able to provide the 
entire value as a String.

: might want to also store files in the index,  having a queue of 1000
: Documents with 1000 Readers to files is vastly preferable to having
: 1000 documents with 1000 (perhaps very large) Strings with all the
: contents of the files. While this is not the best for all cases (#open

You've just pointed out exactly why it's not feasible for Lucene to store 
the contents of the Reader -- it would have to do the exact same thing you 
describe.  The curerent API leaves it up to the client to decide when to 
do this, and what to do if the Reader produces a String bigger then it 
wants to deal with.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42357-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 18:20:16 2009
Return-Path: <java-user-return-42357-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4721 invoked from network); 15 Sep 2009 18:20:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 18:20:15 -0000
Received: (qmail 38910 invoked by uid 500); 15 Sep 2009 18:20:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38785 invoked by uid 500); 15 Sep 2009 18:20:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38748 invoked by uid 99); 15 Sep 2009 18:20:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 18:20:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.153 as permitted sender)
Received: from [72.14.220.153] (HELO fg-out-1718.google.com) (72.14.220.153)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 18:20:00 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1279222fgg.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 11:18:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=7LIqI1Vw+xeBlvc0GxlZIJFC1fiWeSLjgXCAzMF0Rg4=;
        b=Eu9/Xwir1C4kS4yoR4XnpqUppd2da/4AwZXthNAk2SrH9hoZB+R0YqXsd1pOF/Tfys
         jkt95rp4y+SLwdqTOoT6A996O84/xl6sQhm5aPwRjVVvammfMj8FmnNV07QaK5oeAVx5
         HCiOsLg1QK3bAkVTO4KjntL8IniUD2rgLHF4k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=TjUgfJi7y8vd+QjaBm7SZyCSgS0lpLgRgnM7g8UiYuw9WSvkEWg9lcPwhfDksPFXd/
         YM+kAV8auZsxtxTtgln+dKbtQTITMYDUcr/KYAltYU46Ziuwp4fFh8RGnA70+LGvC/SU
         siC85JjYKiWRNq9Exo9loGiy5DMB/7WrhUzsg=
Received: by 10.86.16.9 with SMTP id 9mr6496237fgp.8.1253038719614;
        Tue, 15 Sep 2009 11:18:39 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm508841fge.4.2009.09.15.11.18.37
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 11:18:38 -0700 (PDT)
Message-ID: <4AAFDA7D.8010202@gmail.com>
Date: Tue, 15 Sep 2009 14:18:37 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <5985A0861800491EAFFCD4B0B61351A0@VEGA> <4AAFC4B8.9040608@gmail.com> <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA>
In-Reply-To: <020FFC0B85B44457BA5D38315A91422C@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The results:

config: impl=SeparateFile serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295611, ms=173550, MB/sec=1683.7899579371938

config: impl=ChannelFile serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295361, ms=1377768, MB/sec=212.09793463050383

config: impl=ChannelPread serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295361, ms=632253, MB/sec=462.19115955163517

config: impl=PooledPread serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295361, ms=774664, MB/sec=377.2238637654518

ClassicFile was heading for the same fate as ChannelFile.


I'll have to check what its like on the file system - but it appears
just ridiculously slower. Even with SeparateFile, All 4 cores are bouncing
from 0-12% independently and really favoring the low end of that.
ChannelPread appears no better.

There are results from other OS's/setups in the JIRA issue.

I'm using ext4.

Uwe Schindler wrote:
> How does a conventional file system compare?
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>   
>> -----Original Message-----
>> From: Mark Miller [mailto:markrmiller@gmail.com]
>> Sent: Tuesday, September 15, 2009 7:15 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>
>> Mark Miller wrote:
>>     
>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - with
>>> SeparateFile all 4 of my cores are immediately pinned and remain so.
>>> With ChannelFile, all 4 cores hover 20-30%.
>>>
>>> It would appear it may not be a good idea to use NIOFSDirectory on
>>>       
>> ramdisks.
>>     
>>> Even still though - it looks like you have a further issue - your Lucene
>>> 2.9 old-api results don't use it, and are still not good.
>>>
>>>
>>>       
>> The quick results:
>>
>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
>> size=1G,nr_inodes=200k,mode=01777
>>
>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>> bufsize=1024 poolsize=2 filelen=730554368
>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>
>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>> bufsize=1024 poolsize=2 filelen=730554368
>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>
>>
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42358-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:00:31 2009
Return-Path: <java-user-return-42358-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20103 invoked from network); 15 Sep 2009 19:00:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:00:31 -0000
Received: (qmail 79841 invoked by uid 500); 15 Sep 2009 19:00:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79752 invoked by uid 500); 15 Sep 2009 19:00:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79742 invoked by uid 99); 15 Sep 2009 19:00:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:00:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:00:17 +0000
Received: by ewy28 with SMTP id 28so471691ewy.28
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 11:59:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:date:x-google-sender-auth:message-id:subject:from:to
         :content-type;
        bh=Pvwkc3cHGHrUghdXioaydosdturJEWY3XY/ufL6hkME=;
        b=AIAlC0aCxt2G90peyj9qHZKHZfulVWEjmVcSfHbLyAfq6Ish15VBihPOgiwmpogOjn
         8DpvgCc8hJnYjwXPFa4WfIyo9x7g99zxtbbEaHcSez7eAz07co9hfDQ8Snave0KocIkw
         4nNE6oav9qyjoJk0lhCJBfldFADQp43FBOF1k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=os5u75DsYvdx9+7E7tCuXI4CgXHq331wwWpYIkh7RGnPwjSrZCyIBMgWcgmKQv/E9E
         TtlpMRdkmPnt01mWccFD9Nnj0xqzOIvBrAew2F0TGnEJ2c+Nmwxo9gt/2VQLXMNvSu5d
         733ge/qduHIe1kkRAdqICl9pQfv0zaN4ADWEw=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Received: by 10.216.13.10 with SMTP id a10mr1558873wea.119.1253041197168; Tue, 
	15 Sep 2009 11:59:57 -0700 (PDT)
In-Reply-To: <4AAFDA7D.8010202@gmail.com>
References: <4AAF96E6.7000909@net-m.de> <4AAFAA41.1070103@gmail.com>
	 <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de>
	 <4AAFB2EB.4020403@gmail.com> <5985A0861800491EAFFCD4B0B61351A0@VEGA>
	 <4AAFC4B8.9040608@gmail.com> <4AAFCBB2.8090601@gmail.com>
	 <020FFC0B85B44457BA5D38315A91422C@VEGA> <4AAFDA7D.8010202@gmail.com>
Date: Tue, 15 Sep 2009 14:59:57 -0400
X-Google-Sender-Auth: 9c4a197a9e685bc9
Message-ID: <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
From: Yonik Seeley <yonik.seeley@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

It's been a while since I wrote that benchmarker... is it OK that the
answer is different?  Did you use the same test file?

-Yonik
http://www.lucidimagination.com



On Tue, Sep 15, 2009 at 2:18 PM, Mark Miller <markrmiller@gmail.com> wrote:
> The results:
>
> config: impl=SeparateFile serial=false nThreads=4 iterations=100
> bufsize=1024 poolsize=2 filelen=730554368
> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>
> config: impl=ChannelFile serial=false nThreads=4 iterations=100
> bufsize=1024 poolsize=2 filelen=730554368
> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>
> config: impl=ChannelPread serial=false nThreads=4 iterations=100
> bufsize=1024 poolsize=2 filelen=730554368
> answer=-282295361, ms=632253, MB/sec=462.19115955163517
>
> config: impl=PooledPread serial=false nThreads=4 iterations=100
> bufsize=1024 poolsize=2 filelen=730554368
> answer=-282295361, ms=774664, MB/sec=377.2238637654518
>
> ClassicFile was heading for the same fate as ChannelFile.
>
>
> I'll have to check what its like on the file system - but it appears
> just ridiculously slower. Even with SeparateFile, All 4 cores are bouncing
> from 0-12% independently and really favoring the low end of that.
> ChannelPread appears no better.
>
> There are results from other OS's/setups in the JIRA issue.
>
> I'm using ext4.
>
> Uwe Schindler wrote:
>> How does a conventional file system compare?
>>
>> -----
>> Uwe Schindler
>> H.-H.-Meier-Allee 63, D-28213 Bremen
>> http://www.thetaphi.de
>> eMail: uwe@thetaphi.de
>>
>>
>>> -----Original Message-----
>>> From: Mark Miller [mailto:markrmiller@gmail.com]
>>> Sent: Tuesday, September 15, 2009 7:15 PM
>>> To: java-user@lucene.apache.org
>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>>
>>> Mark Miller wrote:
>>>
>>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - with
>>>> SeparateFile all 4 of my cores are immediately pinned and remain so.
>>>> With ChannelFile, all 4 cores hover 20-30%.
>>>>
>>>> It would appear it may not be a good idea to use NIOFSDirectory on
>>>>
>>> ramdisks.
>>>
>>>> Even still though - it looks like you have a further issue - your Lucene
>>>> 2.9 old-api results don't use it, and are still not good.
>>>>
>>>>
>>>>
>>> The quick results:
>>>
>>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
>>> size=1G,nr_inodes=200k,mode=01777
>>>
>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>> bufsize=1024 poolsize=2 filelen=730554368
>>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>>
>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>> bufsize=1024 poolsize=2 filelen=730554368
>>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>>
>>>
>>> --
>>> - Mark
>>>
>>> http://www.lucidimagination.com
>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42359-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:11:27 2009
Return-Path: <java-user-return-42359-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23991 invoked from network); 15 Sep 2009 19:11:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:11:27 -0000
Received: (qmail 97442 invoked by uid 500); 15 Sep 2009 19:11:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97369 invoked by uid 500); 15 Sep 2009 19:11:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97359 invoked by uid 99); 15 Sep 2009 19:11:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:11:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.198] (HELO mail-yw0-f198.google.com) (209.85.211.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:11:13 +0000
Received: by ywh36 with SMTP id 36so6605287ywh.21
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 12:10:51 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.175.8 with SMTP id x8mr13035119ybe.40.1253041851295; Tue, 
	15 Sep 2009 12:10:51 -0700 (PDT)
In-Reply-To: <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
References: <4AAF96E6.7000909@net-m.de> <4AAFAC95.4050307@gmail.com>
	 <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com>
	 <5985A0861800491EAFFCD4B0B61351A0@VEGA> <4AAFC4B8.9040608@gmail.com>
	 <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA>
	 <4AAFDA7D.8010202@gmail.com>
	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
Date: Tue, 15 Sep 2009 15:10:51 -0400
Message-ID: <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I don't like that the answer is different... but it's really really
odd that it's different-yet-almost-the-same.

Mark, were these 4 results on a normal (ext4) filesystem, or tmpfs?
(Because the top 2 entries of your 4 results match the first set of 2
entries you sent... so I'm thinking these 4 were actually tmpfs not
ext4).

What JRE/OS, linux, kernel versions, and hardware, are you running on?

The gains of SeparateFile over all else are stunning.  And, quite
different from the linux tests I had run under LUCENE-753.  Maybe we
need to revert FSDir.open to return SimpleFSDir again, on non-Windows
hosts.  But then we don't have good concurrency...

Mike

On Tue, Sep 15, 2009 at 2:59 PM, Yonik Seeley
<yonik.seeley@lucidimagination.com> wrote:
> It's been a while since I wrote that benchmarker... is it OK that the
> answer is different? =A0Did you use the same test file?
>
> -Yonik
> http://www.lucidimagination.com
>
>
>
> On Tue, Sep 15, 2009 at 2:18 PM, Mark Miller <markrmiller@gmail.com> wrot=
e:
>> The results:
>>
>> config: impl=3DSeparateFile serial=3Dfalse nThreads=3D4 iterations=3D100
>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>> answer=3D-282295611, ms=3D173550, MB/sec=3D1683.7899579371938
>>
>> config: impl=3DChannelFile serial=3Dfalse nThreads=3D4 iterations=3D100
>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>> answer=3D-282295361, ms=3D1377768, MB/sec=3D212.09793463050383
>>
>> config: impl=3DChannelPread serial=3Dfalse nThreads=3D4 iterations=3D100
>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>> answer=3D-282295361, ms=3D632253, MB/sec=3D462.19115955163517
>>
>> config: impl=3DPooledPread serial=3Dfalse nThreads=3D4 iterations=3D100
>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>> answer=3D-282295361, ms=3D774664, MB/sec=3D377.2238637654518
>>
>> ClassicFile was heading for the same fate as ChannelFile.
>>
>>
>> I'll have to check what its like on the file system - but it appears
>> just ridiculously slower. Even with SeparateFile, All 4 cores are bounci=
ng
>> from 0-12% independently and really favoring the low end of that.
>> ChannelPread appears no better.
>>
>> There are results from other OS's/setups in the JIRA issue.
>>
>> I'm using ext4.
>>
>> Uwe Schindler wrote:
>>> How does a conventional file system compare?
>>>
>>> -----
>>> Uwe Schindler
>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>> http://www.thetaphi.de
>>> eMail: uwe@thetaphi.de
>>>
>>>
>>>> -----Original Message-----
>>>> From: Mark Miller [mailto:markrmiller@gmail.com]
>>>> Sent: Tuesday, September 15, 2009 7:15 PM
>>>> To: java-user@lucene.apache.org
>>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>>>
>>>> Mark Miller wrote:
>>>>
>>>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - wit=
h
>>>>> SeparateFile all 4 of my cores are immediately pinned and remain so.
>>>>> With ChannelFile, all 4 cores hover 20-30%.
>>>>>
>>>>> It would appear it may not be a good idea to use NIOFSDirectory on
>>>>>
>>>> ramdisks.
>>>>
>>>>> Even still though - it looks like you have a further issue - your Luc=
ene
>>>>> 2.9 old-api results don't use it, and are still not good.
>>>>>
>>>>>
>>>>>
>>>> The quick results:
>>>>
>>>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
>>>> size=3D1G,nr_inodes=3D200k,mode=3D01777
>>>>
>>>> config: impl=3DSeparateFile serial=3Dfalse nThreads=3D4 iterations=3D1=
00
>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>>>> answer=3D-282295611, ms=3D173550, MB/sec=3D1683.7899579371938
>>>>
>>>> config: impl=3DChannelFile serial=3Dfalse nThreads=3D4 iterations=3D10=
0
>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>>>> answer=3D-282295361, ms=3D1377768, MB/sec=3D212.09793463050383
>>>>
>>>>
>>>> --
>>>> - Mark
>>>>
>>>> http://www.lucidimagination.com
>>>>
>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42360-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:12:09 2009
Return-Path: <java-user-return-42360-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24757 invoked from network); 15 Sep 2009 19:12:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:12:08 -0000
Received: (qmail 352 invoked by uid 500); 15 Sep 2009 19:12:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 300 invoked by uid 500); 15 Sep 2009 19:12:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 290 invoked by uid 99); 15 Sep 2009 19:12:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:12:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of glen.newton@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:11:56 +0000
Received: by an-out-0708.google.com with SMTP id b2so1539334ana.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 12:10:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=5ahx3YKNYA/CqA4h72xIzbiq0KZDnT/GALz8DfrPDZs=;
        b=E4DwcK7W4uKlARLwbu+OqvROfOrNdTKn/L1hQKfV4eL6/D/KAe99mbVnG/EUCSgS3G
         GIFJzmOYzA2dLj7DGxY+bMCRmYG4r4Ss0wRcbxH1XPnWZIno/mbV4rph4X+9Xr3CzEhu
         f5S2iHjv8ymnm/WOv4I3n6WkSzbYIqLeoXZqE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=kGPwbmCRMuiESPT5EiE2kIOyGLTjLZh69USsTcUTNz5S6HgRkwnR+cDwM6/D+qi0bk
         sYGPhABLfyPPcHj5t3BuzgIXdiuplb79jDS+wNMGuuFcV0AOmov/PBx0STdGedljl2P7
         +U0Bhum6REjTZRQiT8MUcRlOE+TgZEZtY/3ak=
MIME-Version: 1.0
Received: by 10.101.27.20 with SMTP id e20mr7956952anj.137.1253041835278; Tue, 
	15 Sep 2009 12:10:35 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0909151039280.27546@radix.cryptio.net>
References: <5e76f3840909141303x7da19b6bmb66f31de9da6fef1@mail.gmail.com>
	 <Pine.LNX.4.64.0909151039280.27546@radix.cryptio.net>
Date: Tue, 15 Sep 2009 15:10:34 -0400
Message-ID: <5e76f3840909151210x1ca8dd4fo80fa2129cce1c70f@mail.gmail.com>
Subject: Re: Field with reader limitation arbitrary
From: Glen Newton <glen.newton@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

I appreciate your explanation, but I think that the use case I
described merits a deeper exploration:

Scenario 1: 16 threads indexing; queue size = 1000; present api; need to store
In this scenario, there are always 1000 Strings with all the contents
of their respective files.
Averaging 50k per document = 50MB of String objects in memory.

Scenario 2: 16 threads indexing; queue size = 1000; Field constructor
with Reader and Index/Store/Tokenize; need to store
At any one time, there are only 16 Strings with their respective file
contents (i.e. read in at index time); and 984 Readers waiting in the
queue.
Averaging 50k per document = 800k of String objects in memory +
overhead of 984 Readers

Or am I not understanding something in your explanation? My
understanding is that the IndexWriter serializes Document writes, but
does not queue them (explicitly: locking multiple calls that are
waiting is not an explicit queue).

Of course, a change I could make would be to defer populating the
Field from the file Reader until just before it gets indexed, using
the String Field constructor, resulting in the equivalent of #2 above.
But pushing this to the API would be easier.

Thanks,
Glen

2009/9/15 Chris Hostetter <hossman_lucene@fucit.org>:
>
> : Someone has made the decision that we will not be interested in
> : storing files read using a Reader (at least not with these
> : constructors).
> : This is rather arbitrary.
>
> No, it was not arbitrary at all.
>
> The javadocs there are not a "decree" of what shall or shan't be
> supported, they are an explanation of how the constructor works so that
> there isn't any confusion.
>
> The *reason* why the code works that way, is because when Lucene
> processes Fields that use a Reader, it doesn't buffer the Reader so it
> can't store the full contents of that Reader. the *reason* it doesnt'
> buffer the reader is because then it would have to make very arbitrary
> memory decisions that could easily result in OOM (Readers can in fact be
> infinite streams of characters)
>
> clients that want to store the value, need to be able to provide the
> entire value as a String.
>
> : might want to also store files in the index,  having a queue of 1000
> : Documents with 1000 Readers to files is vastly preferable to having
> : 1000 documents with 1000 (perhaps very large) Strings with all the
> : contents of the files. While this is not the best for all cases (#open
>
> You've just pointed out exactly why it's not feasible for Lucene to store
> the contents of the Reader -- it would have to do the exact same thing you
> describe.  The curerent API leaves it up to the client to decide when to
> do this, and what to do if the Reader produces a String bigger then it
> wants to deal with.
>
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 

-

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42361-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:13:44 2009
Return-Path: <java-user-return-42361-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25385 invoked from network); 15 Sep 2009 19:13:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:13:44 -0000
Received: (qmail 5449 invoked by uid 500); 15 Sep 2009 19:13:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5379 invoked by uid 500); 15 Sep 2009 19:13:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5369 invoked by uid 99); 15 Sep 2009 19:13:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:13:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.153 as permitted sender)
Received: from [72.14.220.153] (HELO fg-out-1718.google.com) (72.14.220.153)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:13:30 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1294144fgg.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 12:13:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=Uz57ERdf/qZxgJYP/Cbr8hM0wetM3UL2H27bF/9L2NQ=;
        b=M6qtoUVJRVByRYSnxzx49IxXNBZEXQsqR/k7E8tEqnHfJE1+ldQ/1kZ0swP029hncb
         rUmEJiwt0kIS1PWkv+hFLERdmbJ4yhvpSSIoOyWgcfReQLKdIB1eXnyqpNC3HZsgqeES
         2B/IBBTbw2Uw+vS6WnVFnkp8DMZKpP4vcNpJU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=jYZrW4ChpAW9ut5kjdvgrIJ2Crpeseh1lLsFgqBeIryPIh93N7nLiXrWHFF6YhOjkn
         27ssbi2qpnMIxVEUMSp9+sdLyaZANsIQVUSQlY41FaNnQ/bWk+YXuGDfGDFguLwpMa8X
         ROb1BfKefBE+PPWN+4SqgFKRrhq6Uc1ykP5fM=
Received: by 10.86.220.11 with SMTP id s11mr6596643fgg.47.1253041989748;
        Tue, 15 Sep 2009 12:13:09 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm286194fgg.24.2009.09.15.12.13.08
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 12:13:08 -0700 (PDT)
Message-ID: <4AAFE743.6060508@gmail.com>
Date: Tue, 15 Sep 2009 15:13:07 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAFAA41.1070103@gmail.com>	 <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de>	 <4AAFB2EB.4020403@gmail.com> <5985A0861800491EAFFCD4B0B61351A0@VEGA>	 <4AAFC4B8.9040608@gmail.com> <4AAFCBB2.8090601@gmail.com>	 <020FFC0B85B44457BA5D38315A91422C@VEGA> <4AAFDA7D.8010202@gmail.com> <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
In-Reply-To: <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Its the same test file - everything the same except one file is on local
ext4 hd and the copy is on ramdisk.

I havn't yet looked into what the answer corresponds to. I wonder if the
RAM disk is getting made as ext3?

note:also I give the JVM RAM a bit larger than the file size, and the OS
has plenty of RAM beyond the file size.

Here are two runs on the hardrive/cached side (not ramdisk). Again, a
bit slower than the RAM disk:

config: impl=ChannelPread serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295361, ms=766340, MB/sec=381.3212767179059


config: impl=ClassicFile serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295361, ms=852010, MB/sec=342.9792457835002



Yonik Seeley wrote:
> It's been a while since I wrote that benchmarker... is it OK that the
> answer is different?  Did you use the same test file?
>
> -Yonik
> http://www.lucidimagination.com
>
>
>
> On Tue, Sep 15, 2009 at 2:18 PM, Mark Miller <markrmiller@gmail.com> wrote:
>   
>> The results:
>>
>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>> bufsize=1024 poolsize=2 filelen=730554368
>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>
>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>> bufsize=1024 poolsize=2 filelen=730554368
>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>
>> config: impl=ChannelPread serial=false nThreads=4 iterations=100
>> bufsize=1024 poolsize=2 filelen=730554368
>> answer=-282295361, ms=632253, MB/sec=462.19115955163517
>>
>> config: impl=PooledPread serial=false nThreads=4 iterations=100
>> bufsize=1024 poolsize=2 filelen=730554368
>> answer=-282295361, ms=774664, MB/sec=377.2238637654518
>>
>> ClassicFile was heading for the same fate as ChannelFile.
>>
>>
>> I'll have to check what its like on the file system - but it appears
>> just ridiculously slower. Even with SeparateFile, All 4 cores are bouncing
>> from 0-12% independently and really favoring the low end of that.
>> ChannelPread appears no better.
>>
>> There are results from other OS's/setups in the JIRA issue.
>>
>> I'm using ext4.
>>
>> Uwe Schindler wrote:
>>     
>>> How does a conventional file system compare?
>>>
>>> -----
>>> Uwe Schindler
>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>> http://www.thetaphi.de
>>> eMail: uwe@thetaphi.de
>>>
>>>
>>>       
>>>> -----Original Message-----
>>>> From: Mark Miller [mailto:markrmiller@gmail.com]
>>>> Sent: Tuesday, September 15, 2009 7:15 PM
>>>> To: java-user@lucene.apache.org
>>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>>>
>>>> Mark Miller wrote:
>>>>
>>>>         
>>>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - with
>>>>> SeparateFile all 4 of my cores are immediately pinned and remain so.
>>>>> With ChannelFile, all 4 cores hover 20-30%.
>>>>>
>>>>> It would appear it may not be a good idea to use NIOFSDirectory on
>>>>>
>>>>>           
>>>> ramdisks.
>>>>
>>>>         
>>>>> Even still though - it looks like you have a further issue - your Lucene
>>>>> 2.9 old-api results don't use it, and are still not good.
>>>>>
>>>>>
>>>>>
>>>>>           
>>>> The quick results:
>>>>
>>>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
>>>> size=1G,nr_inodes=200k,mode=01777
>>>>
>>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>>>
>>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>>>
>>>>
>>>> --
>>>> - Mark
>>>>
>>>> http://www.lucidimagination.com
>>>>
>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>         
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>       
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42362-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:18:41 2009
Return-Path: <java-user-return-42362-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26625 invoked from network); 15 Sep 2009 19:18:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:18:41 -0000
Received: (qmail 10717 invoked by uid 500); 15 Sep 2009 19:18:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10643 invoked by uid 500); 15 Sep 2009 19:18:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10630 invoked by uid 99); 15 Sep 2009 19:18:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:18:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:18:27 +0000
Received: by fxm18 with SMTP id 18so3505038fxm.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 12:18:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=CXppd/gzMxX3ONlRn/g6WmgGbvZABs1q5mZKw7Y1Ayk=;
        b=FihgXpgt5XrLryTvn1SMazae+6MXJ7GrGrbwXEYU+sNUmT3oG1dFU2EXTLgThvMJ3V
         hgeJuBwpZfApDj5x5EI2SiEMEGnbtQzaSD0J3f4TSrZ6S2oX6S53nhxdSwrXGnJh6X5A
         wPlBKAcqIVPoMlXl0G8ApXUOUtI5EZu9yVVOk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=XVVAxDpCrD3Bnr+qxeL/zA30ayx02pgOP0DPNMJKq6joljyMHRZJ/VlJU/8a98ABNg
         836gCykwzXSJN+qcMDdw4nUHRMSE1Kue9sg3awjwuTcjcjwuHCXtojbuO3iyEP/qGxe1
         Uyi70selh3SPub/duOrSfBd9S5fXg+EF5BYS8=
Received: by 10.86.220.1 with SMTP id s1mr6542662fgg.50.1253042286374;
        Tue, 15 Sep 2009 12:18:06 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm498908fge.19.2009.09.15.12.18.04
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 12:18:05 -0700 (PDT)
Message-ID: <4AAFE86B.2090509@gmail.com>
Date: Tue, 15 Sep 2009 15:18:03 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAFAC95.4050307@gmail.com>	 <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com>	 <5985A0861800491EAFFCD4B0B61351A0@VEGA> <4AAFC4B8.9040608@gmail.com>	 <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA>	 <4AAFDA7D.8010202@gmail.com>	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com> <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>
In-Reply-To: <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Michael McCandless wrote:
> I don't like that the answer is different... but it's really really
> odd that it's different-yet-almost-the-same.
>
> Mark, were these 4 results on a normal (ext4) filesystem, or tmpfs?
> (Because the top 2 entries of your 4 results match the first set of 2
> entries you sent... so I'm thinking these 4 were actually tmpfs not
> ext4).
>   
Those 4 were tmpfs - I mention ext4 at the end because I had just given
a feel for the hardrive tests and wanted to note it was from ext4 - the
results are def ramdisk though.
> What JRE/OS, linux, kernel versions, and hardware, are you running on?
>   
These are on:
Ubuntu Karmic Koala 9.10, currently updated
java-1.5.0-sun-1.5.0.20
2.6.31-10-generic

RAM: 3.9 Gig
4 core Intel Core2 duo 2.0GHz

Slow 5200 rpm laptop drives.

> The gains of SeparateFile over all else are stunning.  And, quite
> different from the linux tests I had run under LUCENE-753.  Maybe we
> need to revert FSDir.open to return SimpleFSDir again, on non-Windows
> hosts.  But then we don't have good concurrency...
>
> Mike
>
> On Tue, Sep 15, 2009 at 2:59 PM, Yonik Seeley
> <yonik.seeley@lucidimagination.com> wrote:
>   
>> It's been a while since I wrote that benchmarker... is it OK that the
>> answer is different?  Did you use the same test file?
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>>
>>
>> On Tue, Sep 15, 2009 at 2:18 PM, Mark Miller <markrmiller@gmail.com> wrote:
>>     
>>> The results:
>>>
>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>> bufsize=1024 poolsize=2 filelen=730554368
>>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>>
>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>> bufsize=1024 poolsize=2 filelen=730554368
>>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>>
>>> config: impl=ChannelPread serial=false nThreads=4 iterations=100
>>> bufsize=1024 poolsize=2 filelen=730554368
>>> answer=-282295361, ms=632253, MB/sec=462.19115955163517
>>>
>>> config: impl=PooledPread serial=false nThreads=4 iterations=100
>>> bufsize=1024 poolsize=2 filelen=730554368
>>> answer=-282295361, ms=774664, MB/sec=377.2238637654518
>>>
>>> ClassicFile was heading for the same fate as ChannelFile.
>>>
>>>
>>> I'll have to check what its like on the file system - but it appears
>>> just ridiculously slower. Even with SeparateFile, All 4 cores are bouncing
>>> from 0-12% independently and really favoring the low end of that.
>>> ChannelPread appears no better.
>>>
>>> There are results from other OS's/setups in the JIRA issue.
>>>
>>> I'm using ext4.
>>>
>>> Uwe Schindler wrote:
>>>       
>>>> How does a conventional file system compare?
>>>>
>>>> -----
>>>> Uwe Schindler
>>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>>> http://www.thetaphi.de
>>>> eMail: uwe@thetaphi.de
>>>>
>>>>
>>>>         
>>>>> -----Original Message-----
>>>>> From: Mark Miller [mailto:markrmiller@gmail.com]
>>>>> Sent: Tuesday, September 15, 2009 7:15 PM
>>>>> To: java-user@lucene.apache.org
>>>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>>>>
>>>>> Mark Miller wrote:
>>>>>
>>>>>           
>>>>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - with
>>>>>> SeparateFile all 4 of my cores are immediately pinned and remain so.
>>>>>> With ChannelFile, all 4 cores hover 20-30%.
>>>>>>
>>>>>> It would appear it may not be a good idea to use NIOFSDirectory on
>>>>>>
>>>>>>             
>>>>> ramdisks.
>>>>>
>>>>>           
>>>>>> Even still though - it looks like you have a further issue - your Lucene
>>>>>> 2.9 old-api results don't use it, and are still not good.
>>>>>>
>>>>>>
>>>>>>
>>>>>>             
>>>>> The quick results:
>>>>>
>>>>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
>>>>> size=1G,nr_inodes=200k,mode=01777
>>>>>
>>>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>>>>
>>>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>>>>
>>>>>
>>>>> --
>>>>> - Mark
>>>>>
>>>>> http://www.lucidimagination.com
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>           
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>         
>>> --
>>> - Mark
>>>
>>> http://www.lucidimagination.com
>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>       
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42363-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:25:38 2009
Return-Path: <java-user-return-42363-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28646 invoked from network); 15 Sep 2009 19:25:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:25:38 -0000
Received: (qmail 23283 invoked by uid 500); 15 Sep 2009 19:25:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23210 invoked by uid 500); 15 Sep 2009 19:25:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23200 invoked by uid 99); 15 Sep 2009 19:25:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:25:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:25:24 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1297332fgg.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 12:25:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=lAwPSrLWIDzlAD+/sc/6ofuRYMC1YN4QwZGv6vi8U4I=;
        b=wdF0/+UbGiAcj6uftbBdAM8oYs7nIAUkhvJpN4AeaNjoQgmkRljXOUtg8oYZyGPjhx
         0J2mnJRTZTsK47hsmh57RrrXrKoPAlsZM6RwczhdT+nnMveEmk0WPy5AderXLsT3M6Kh
         0tFPG79JOmY7VXbbcmCykQu6V2Gmb8eijXN+4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=B36yNjR/Ah4BmM1P3DM4NpeM8G+aK7Nde34FxSMSxZGCBNF5PlkQvv6SCUaYlykUM2
         5xdEsetkoSbGvZmV4mjicQWsd+vD7se6J9qkitnh3Z9ViwUacTp1h/7q5K7OqMxKdCpA
         94XdTB7kRcEkFPY69wwLFCMrz5Srtn/Rz7zTE=
Received: by 10.86.22.12 with SMTP id 12mr6571457fgv.69.1253042703267;
        Tue, 15 Sep 2009 12:25:03 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id d6sm428426fga.26.2009.09.15.12.25.00
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 12:25:01 -0700 (PDT)
Message-ID: <4AAFEA0C.9080508@gmail.com>
Date: Tue, 15 Sep 2009 15:25:00 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAFAC95.4050307@gmail.com>	 <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com>	 <5985A0861800491EAFFCD4B0B61351A0@VEGA> <4AAFC4B8.9040608@gmail.com>	 <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA>	 <4AAFDA7D.8010202@gmail.com>	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com> <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com> <4AAFE86B.2090509@gmail.com>
In-Reply-To: <4AAFE86B.2090509@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I just really I hadn't sent this one. Here are results from the harddrive:

It looks like its closer to the same speed on the hardrive once
everything is loaded in the system cache (as you'd expect). SeparateFile
was 1200 vs almost 1700 on RAMDISK. ChannelPread looked a lot closer though.


- Mark

Tests from harddisk (filesystem cache warmed):

config: impl=SeparateFile serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282293977, ms=238230, MB/sec=1226.6370616630988

config: impl=ChannelPread serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=730554368
answer=-282295361, ms=766340, MB/sec=381.3212767179059


Mark Miller wrote:
> Michael McCandless wrote:
>   
>> I don't like that the answer is different... but it's really really
>> odd that it's different-yet-almost-the-same.
>>
>> Mark, were these 4 results on a normal (ext4) filesystem, or tmpfs?
>> (Because the top 2 entries of your 4 results match the first set of 2
>> entries you sent... so I'm thinking these 4 were actually tmpfs not
>> ext4).
>>   
>>     
> Those 4 were tmpfs - I mention ext4 at the end because I had just given
> a feel for the hardrive tests and wanted to note it was from ext4 - the
> results are def ramdisk though.
>   
>> What JRE/OS, linux, kernel versions, and hardware, are you running on?
>>   
>>     
> These are on:
> Ubuntu Karmic Koala 9.10, currently updated
> java-1.5.0-sun-1.5.0.20
> 2.6.31-10-generic
>
> RAM: 3.9 Gig
> 4 core Intel Core2 duo 2.0GHz
>
> Slow 5200 rpm laptop drives.
>
>   
>> The gains of SeparateFile over all else are stunning.  And, quite
>> different from the linux tests I had run under LUCENE-753.  Maybe we
>> need to revert FSDir.open to return SimpleFSDir again, on non-Windows
>> hosts.  But then we don't have good concurrency...
>>
>> Mike
>>
>> On Tue, Sep 15, 2009 at 2:59 PM, Yonik Seeley
>> <yonik.seeley@lucidimagination.com> wrote:
>>   
>>     
>>> It's been a while since I wrote that benchmarker... is it OK that the
>>> answer is different?  Did you use the same test file?
>>>
>>> -Yonik
>>> http://www.lucidimagination.com
>>>
>>>
>>>
>>> On Tue, Sep 15, 2009 at 2:18 PM, Mark Miller <markrmiller@gmail.com> wrote:
>>>     
>>>       
>>>> The results:
>>>>
>>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>>>
>>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>>>
>>>> config: impl=ChannelPread serial=false nThreads=4 iterations=100
>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>> answer=-282295361, ms=632253, MB/sec=462.19115955163517
>>>>
>>>> config: impl=PooledPread serial=false nThreads=4 iterations=100
>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>> answer=-282295361, ms=774664, MB/sec=377.2238637654518
>>>>
>>>> ClassicFile was heading for the same fate as ChannelFile.
>>>>
>>>>
>>>> I'll have to check what its like on the file system - but it appears
>>>> just ridiculously slower. Even with SeparateFile, All 4 cores are bouncing
>>>> from 0-12% independently and really favoring the low end of that.
>>>> ChannelPread appears no better.
>>>>
>>>> There are results from other OS's/setups in the JIRA issue.
>>>>
>>>> I'm using ext4.
>>>>
>>>> Uwe Schindler wrote:
>>>>       
>>>>         
>>>>> How does a conventional file system compare?
>>>>>
>>>>> -----
>>>>> Uwe Schindler
>>>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>>>> http://www.thetaphi.de
>>>>> eMail: uwe@thetaphi.de
>>>>>
>>>>>
>>>>>         
>>>>>           
>>>>>> -----Original Message-----
>>>>>> From: Mark Miller [mailto:markrmiller@gmail.com]
>>>>>> Sent: Tuesday, September 15, 2009 7:15 PM
>>>>>> To: java-user@lucene.apache.org
>>>>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>>>>>
>>>>>> Mark Miller wrote:
>>>>>>
>>>>>>           
>>>>>>             
>>>>>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - with
>>>>>>> SeparateFile all 4 of my cores are immediately pinned and remain so.
>>>>>>> With ChannelFile, all 4 cores hover 20-30%.
>>>>>>>
>>>>>>> It would appear it may not be a good idea to use NIOFSDirectory on
>>>>>>>
>>>>>>>             
>>>>>>>               
>>>>>> ramdisks.
>>>>>>
>>>>>>           
>>>>>>             
>>>>>>> Even still though - it looks like you have a further issue - your Lucene
>>>>>>> 2.9 old-api results don't use it, and are still not good.
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>             
>>>>>>>               
>>>>>> The quick results:
>>>>>>
>>>>>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
>>>>>> size=1G,nr_inodes=200k,mode=01777
>>>>>>
>>>>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>>>>>
>>>>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>>>>>
>>>>>>
>>>>>> --
>>>>>> - Mark
>>>>>>
>>>>>> http://www.lucidimagination.com
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> ---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>           
>>>>>>             
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>         
>>>>>           
>>>> --
>>>> - Mark
>>>>
>>>> http://www.lucidimagination.com
>>>>
>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>       
>>>>         
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>     
>>>       
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>   
>>     
>
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42364-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:33:38 2009
Return-Path: <java-user-return-42364-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31837 invoked from network); 15 Sep 2009 19:33:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:33:38 -0000
Received: (qmail 33298 invoked by uid 500); 15 Sep 2009 19:33:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33213 invoked by uid 500); 15 Sep 2009 19:33:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33203 invoked by uid 99); 15 Sep 2009 19:33:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:33:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:33:24 +0000
Received: by fxm18 with SMTP id 18so3515747fxm.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 12:33:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=9vSXXHIfOK9k8UnTKXMMjCkMTazfsTyzs3UhMHYDOjE=;
        b=C+8eBMLHZEzQaN1/O4t7+726DCmadyRci0OiLXEtGQm194u1HAAA9LHE89soI/SLQr
         iR1f+alrQxfY1FtVmQ1mHsWtWIwKLavGZBwUtzWQMBFJDNRynQqM8s4Yw3F3JaaJM+Wg
         nsk3WJOB12VOpLZKIN2opgU2qH3AJJy0JvDy8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=uSHyxb8dF79BAO0iIHrP8nOwVzhqHj+0gFFaCOksULfDoJWI2pN6BhuKMrG6mqCY5C
         HZzTKXeJt33gA8XvbS8rsI/4+uT86c0mdZ1nwvvJkjjQ0Jwhyskbzhryt0pwR3rNgKnY
         nTXCB0qE+NQjzA842LEuKLyvJ9HVOR5t+E08k=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.223.2.199 with SMTP id 7mr2797325fak.34.1253043183481; Tue, 15 
	Sep 2009 12:33:03 -0700 (PDT)
In-Reply-To: <4AAFEA0C.9080508@gmail.com>
References: <4AAF96E6.7000909@net-m.de> <5985A0861800491EAFFCD4B0B61351A0@VEGA>
	 <4AAFC4B8.9040608@gmail.com> <4AAFCBB2.8090601@gmail.com>
	 <020FFC0B85B44457BA5D38315A91422C@VEGA> <4AAFDA7D.8010202@gmail.com>
	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
	 <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>
	 <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com>
Date: Tue, 15 Sep 2009 15:33:03 -0400
X-Google-Sender-Auth: 959e8ed77edeb523
Message-ID: <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com>
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Remember to disable CPU frequency scaling when benchmarking... some
things with IO cause the freq to drop, and when it's CPU bound again
it takes a while for Linux to scale up the freq again.

For example, on my ubuntu box, ChannelFile went from 100MB/sec to
388MB/sec.  This effect probably won't be uniform across
implementations either.

-Yonik
http://www.lucidimagination.com

On Tue, Sep 15, 2009 at 3:25 PM, Mark Miller <markrmiller@gmail.com> wrote:
> I just really I hadn't sent this one. Here are results from the harddrive=
:
>
> It looks like its closer to the same speed on the hardrive once
> everything is loaded in the system cache (as you'd expect). SeparateFile
> was 1200 vs almost 1700 on RAMDISK. ChannelPread looked a lot closer thou=
gh.
>
>
> - Mark
>
> Tests from harddisk (filesystem cache warmed):
>
> config: impl=3DSeparateFile serial=3Dfalse nThreads=3D4 iterations=3D100
> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> answer=3D-282293977, ms=3D238230, MB/sec=3D1226.6370616630988
>
> config: impl=3DChannelPread serial=3Dfalse nThreads=3D4 iterations=3D100
> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> answer=3D-282295361, ms=3D766340, MB/sec=3D381.3212767179059
>
>
> Mark Miller wrote:
>> Michael McCandless wrote:
>>
>>> I don't like that the answer is different... but it's really really
>>> odd that it's different-yet-almost-the-same.
>>>
>>> Mark, were these 4 results on a normal (ext4) filesystem, or tmpfs?
>>> (Because the top 2 entries of your 4 results match the first set of 2
>>> entries you sent... so I'm thinking these 4 were actually tmpfs not
>>> ext4).
>>>
>>>
>> Those 4 were tmpfs - I mention ext4 at the end because I had just given
>> a feel for the hardrive tests and wanted to note it was from ext4 - the
>> results are def ramdisk though.
>>
>>> What JRE/OS, linux, kernel versions, and hardware, are you running on?
>>>
>>>
>> These are on:
>> Ubuntu Karmic Koala 9.10, currently updated
>> java-1.5.0-sun-1.5.0.20
>> 2.6.31-10-generic
>>
>> RAM: 3.9 Gig
>> 4 core Intel Core2 duo 2.0GHz
>>
>> Slow 5200 rpm laptop drives.
>>
>>
>>> The gains of SeparateFile over all else are stunning. =A0And, quite
>>> different from the linux tests I had run under LUCENE-753. =A0Maybe we
>>> need to revert FSDir.open to return SimpleFSDir again, on non-Windows
>>> hosts. =A0But then we don't have good concurrency...
>>>
>>> Mike
>>>
>>> On Tue, Sep 15, 2009 at 2:59 PM, Yonik Seeley
>>> <yonik.seeley@lucidimagination.com> wrote:
>>>
>>>
>>>> It's been a while since I wrote that benchmarker... is it OK that the
>>>> answer is different? =A0Did you use the same test file?
>>>>
>>>> -Yonik
>>>> http://www.lucidimagination.com
>>>>
>>>>
>>>>
>>>> On Tue, Sep 15, 2009 at 2:18 PM, Mark Miller <markrmiller@gmail.com> w=
rote:
>>>>
>>>>
>>>>> The results:
>>>>>
>>>>> config: impl=3DSeparateFile serial=3Dfalse nThreads=3D4 iterations=3D=
100
>>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>>>>> answer=3D-282295611, ms=3D173550, MB/sec=3D1683.7899579371938
>>>>>
>>>>> config: impl=3DChannelFile serial=3Dfalse nThreads=3D4 iterations=3D1=
00
>>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>>>>> answer=3D-282295361, ms=3D1377768, MB/sec=3D212.09793463050383
>>>>>
>>>>> config: impl=3DChannelPread serial=3Dfalse nThreads=3D4 iterations=3D=
100
>>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>>>>> answer=3D-282295361, ms=3D632253, MB/sec=3D462.19115955163517
>>>>>
>>>>> config: impl=3DPooledPread serial=3Dfalse nThreads=3D4 iterations=3D1=
00
>>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>>>>> answer=3D-282295361, ms=3D774664, MB/sec=3D377.2238637654518
>>>>>
>>>>> ClassicFile was heading for the same fate as ChannelFile.
>>>>>
>>>>>
>>>>> I'll have to check what its like on the file system - but it appears
>>>>> just ridiculously slower. Even with SeparateFile, All 4 cores are bou=
ncing
>>>>> from 0-12% independently and really favoring the low end of that.
>>>>> ChannelPread appears no better.
>>>>>
>>>>> There are results from other OS's/setups in the JIRA issue.
>>>>>
>>>>> I'm using ext4.
>>>>>
>>>>> Uwe Schindler wrote:
>>>>>
>>>>>
>>>>>> How does a conventional file system compare?
>>>>>>
>>>>>> -----
>>>>>> Uwe Schindler
>>>>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>>>>> http://www.thetaphi.de
>>>>>> eMail: uwe@thetaphi.de
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>> -----Original Message-----
>>>>>>> From: Mark Miller [mailto:markrmiller@gmail.com]
>>>>>>> Sent: Tuesday, September 15, 2009 7:15 PM
>>>>>>> To: java-user@lucene.apache.org
>>>>>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>>>>>>
>>>>>>> Mark Miller wrote:
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk - =
with
>>>>>>>> SeparateFile all 4 of my cores are immediately pinned and remain s=
o.
>>>>>>>> With ChannelFile, all 4 cores hover 20-30%.
>>>>>>>>
>>>>>>>> It would appear it may not be a good idea to use NIOFSDirectory on
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>> ramdisks.
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>> Even still though - it looks like you have a further issue - your =
Lucene
>>>>>>>> 2.9 old-api results don't use it, and are still not good.
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>> The quick results:
>>>>>>>
>>>>>>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
>>>>>>> size=3D1G,nr_inodes=3D200k,mode=3D01777
>>>>>>>
>>>>>>> config: impl=3DSeparateFile serial=3Dfalse nThreads=3D4 iterations=
=3D100
>>>>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>>>>>>> answer=3D-282295611, ms=3D173550, MB/sec=3D1683.7899579371938
>>>>>>>
>>>>>>> config: impl=3DChannelFile serial=3Dfalse nThreads=3D4 iterations=
=3D100
>>>>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
>>>>>>> answer=3D-282295361, ms=3D1377768, MB/sec=3D212.09793463050383
>>>>>>>
>>>>>>>
>>>>>>> --
>>>>>>> - Mark
>>>>>>>
>>>>>>> http://www.lucidimagination.com
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> -------------------------------------------------------------------=
--
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>> --------------------------------------------------------------------=
-
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>> --
>>>>> - Mark
>>>>>
>>>>> http://www.lucidimagination.com
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>
>>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>>
>>
>
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42365-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:45:33 2009
Return-Path: <java-user-return-42365-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37547 invoked from network); 15 Sep 2009 19:45:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:45:33 -0000
Received: (qmail 50677 invoked by uid 500); 15 Sep 2009 19:45:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50590 invoked by uid 500); 15 Sep 2009 19:45:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50580 invoked by uid 99); 15 Sep 2009 19:45:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:45:30 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:45:18 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 88B21D36003;
	Tue, 15 Sep 2009 21:44:28 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id O20eNq31AcZG; Tue, 15 Sep 2009 21:44:13 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 945A6D36002;
	Tue, 15 Sep 2009 21:44:13 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>,
	<yonik@lucidimagination.com>
References: <4AAF96E6.7000909@net-m.de> <5985A0861800491EAFFCD4B0B61351A0@VEGA> <4AAFC4B8.9040608@gmail.com> <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA> <4AAFDA7D.8010202@gmail.com> <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com> <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com> <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com> <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Tue, 15 Sep 2009 21:44:13 +0200
Message-ID: <5011254AD3D04A418B4BCC2B7D045420@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com>
Thread-Index: Aco2O3LFLC0VdUd1TuuiORvFRc+H4wAAU/Qw
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Now I am completely disturbed. Which numbers come from which filesystem?
Ext4 on HDD, tmpfs (which is a filesystem of its own), ext3 on HDD,...

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: yseeley@gmail.com [mailto:yseeley@gmail.com] On Behalf Of Yonik
> Seeley
> Sent: Tuesday, September 15, 2009 9:33 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>=20
> Remember to disable CPU frequency scaling when benchmarking... some
> things with IO cause the freq to drop, and when it's CPU bound again
> it takes a while for Linux to scale up the freq again.
>=20
> For example, on my ubuntu box, ChannelFile went from 100MB/sec to
> 388MB/sec.  This effect probably won't be uniform across
> implementations either.
>=20
> -Yonik
> http://www.lucidimagination.com
>=20
> On Tue, Sep 15, 2009 at 3:25 PM, Mark Miller <markrmiller@gmail.com>
> wrote:
> > I just really I hadn't sent this one. Here are results from the
> harddrive:
> >
> > It looks like its closer to the same speed on the hardrive once
> > everything is loaded in the system cache (as you'd expect). =
SeparateFile
> > was 1200 vs almost 1700 on RAMDISK. ChannelPread looked a lot closer
> though.
> >
> >
> > - Mark
> >
> > Tests from harddisk (filesystem cache warmed):
> >
> > config: impl=3DSeparateFile serial=3Dfalse nThreads=3D4 =
iterations=3D100
> > bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> > answer=3D-282293977, ms=3D238230, MB/sec=3D1226.6370616630988
> >
> > config: impl=3DChannelPread serial=3Dfalse nThreads=3D4 =
iterations=3D100
> > bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> > answer=3D-282295361, ms=3D766340, MB/sec=3D381.3212767179059
> >
> >
> > Mark Miller wrote:
> >> Michael McCandless wrote:
> >>
> >>> I don't like that the answer is different... but it's really =
really
> >>> odd that it's different-yet-almost-the-same.
> >>>
> >>> Mark, were these 4 results on a normal (ext4) filesystem, or =
tmpfs?
> >>> (Because the top 2 entries of your 4 results match the first set =
of 2
> >>> entries you sent... so I'm thinking these 4 were actually tmpfs =
not
> >>> ext4).
> >>>
> >>>
> >> Those 4 were tmpfs - I mention ext4 at the end because I had just =
given
> >> a feel for the hardrive tests and wanted to note it was from ext4 - =
the
> >> results are def ramdisk though.
> >>
> >>> What JRE/OS, linux, kernel versions, and hardware, are you running =
on?
> >>>
> >>>
> >> These are on:
> >> Ubuntu Karmic Koala 9.10, currently updated
> >> java-1.5.0-sun-1.5.0.20
> >> 2.6.31-10-generic
> >>
> >> RAM: 3.9 Gig
> >> 4 core Intel Core2 duo 2.0GHz
> >>
> >> Slow 5200 rpm laptop drives.
> >>
> >>
> >>> The gains of SeparateFile over all else are stunning. =A0And, =
quite
> >>> different from the linux tests I had run under LUCENE-753. =
=A0Maybe we
> >>> need to revert FSDir.open to return SimpleFSDir again, on =
non-Windows
> >>> hosts. =A0But then we don't have good concurrency...
> >>>
> >>> Mike
> >>>
> >>> On Tue, Sep 15, 2009 at 2:59 PM, Yonik Seeley
> >>> <yonik.seeley@lucidimagination.com> wrote:
> >>>
> >>>
> >>>> It's been a while since I wrote that benchmarker... is it OK that =
the
> >>>> answer is different? =A0Did you use the same test file?
> >>>>
> >>>> -Yonik
> >>>> http://www.lucidimagination.com
> >>>>
> >>>>
> >>>>
> >>>> On Tue, Sep 15, 2009 at 2:18 PM, Mark Miller =
<markrmiller@gmail.com>
> wrote:
> >>>>
> >>>>
> >>>>> The results:
> >>>>>
> >>>>> config: impl=3DSeparateFile serial=3Dfalse nThreads=3D4 =
iterations=3D100
> >>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> >>>>> answer=3D-282295611, ms=3D173550, MB/sec=3D1683.7899579371938
> >>>>>
> >>>>> config: impl=3DChannelFile serial=3Dfalse nThreads=3D4 =
iterations=3D100
> >>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> >>>>> answer=3D-282295361, ms=3D1377768, MB/sec=3D212.09793463050383
> >>>>>
> >>>>> config: impl=3DChannelPread serial=3Dfalse nThreads=3D4 =
iterations=3D100
> >>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> >>>>> answer=3D-282295361, ms=3D632253, MB/sec=3D462.19115955163517
> >>>>>
> >>>>> config: impl=3DPooledPread serial=3Dfalse nThreads=3D4 =
iterations=3D100
> >>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> >>>>> answer=3D-282295361, ms=3D774664, MB/sec=3D377.2238637654518
> >>>>>
> >>>>> ClassicFile was heading for the same fate as ChannelFile.
> >>>>>
> >>>>>
> >>>>> I'll have to check what its like on the file system - but it =
appears
> >>>>> just ridiculously slower. Even with SeparateFile, All 4 cores =
are
> bouncing
> >>>>> from 0-12% independently and really favoring the low end of =
that.
> >>>>> ChannelPread appears no better.
> >>>>>
> >>>>> There are results from other OS's/setups in the JIRA issue.
> >>>>>
> >>>>> I'm using ext4.
> >>>>>
> >>>>> Uwe Schindler wrote:
> >>>>>
> >>>>>
> >>>>>> How does a conventional file system compare?
> >>>>>>
> >>>>>> -----
> >>>>>> Uwe Schindler
> >>>>>> H.-H.-Meier-Allee 63, D-28213 Bremen
> >>>>>> http://www.thetaphi.de
> >>>>>> eMail: uwe@thetaphi.de
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>> -----Original Message-----
> >>>>>>> From: Mark Miller [mailto:markrmiller@gmail.com]
> >>>>>>> Sent: Tuesday, September 15, 2009 7:15 PM
> >>>>>>> To: java-user@lucene.apache.org
> >>>>>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
> >>>>>>>
> >>>>>>> Mark Miller wrote:
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs =
ramdisk -
> with
> >>>>>>>> SeparateFile all 4 of my cores are immediately pinned and =
remain
> so.
> >>>>>>>> With ChannelFile, all 4 cores hover 20-30%.
> >>>>>>>>
> >>>>>>>> It would appear it may not be a good idea to use =
NIOFSDirectory
> on
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>> ramdisks.
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>> Even still though - it looks like you have a further issue - =
your
> Lucene
> >>>>>>>> 2.9 old-api results don't use it, and are still not good.
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>> The quick results:
> >>>>>>>
> >>>>>>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
> >>>>>>> size=3D1G,nr_inodes=3D200k,mode=3D01777
> >>>>>>>
> >>>>>>> config: impl=3DSeparateFile serial=3Dfalse nThreads=3D4 =
iterations=3D100
> >>>>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> >>>>>>> answer=3D-282295611, ms=3D173550, MB/sec=3D1683.7899579371938
> >>>>>>>
> >>>>>>> config: impl=3DChannelFile serial=3Dfalse nThreads=3D4 =
iterations=3D100
> >>>>>>> bufsize=3D1024 poolsize=3D2 filelen=3D730554368
> >>>>>>> answer=3D-282295361, ms=3D1377768, MB/sec=3D212.09793463050383
> >>>>>>>
> >>>>>>>
> >>>>>>> --
> >>>>>>> - Mark
> >>>>>>>
> >>>>>>> http://www.lucidimagination.com
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>> =
------------------------------------------------------------------
> ---
> >>>>>>> To unsubscribe, e-mail: =
java-user-unsubscribe@lucene.apache.org
> >>>>>>> For additional commands, e-mail: =
java-user-help@lucene.apache.org
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>> =
-------------------------------------------------------------------
> --
> >>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>> For additional commands, e-mail: =
java-user-help@lucene.apache.org
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>> --
> >>>>> - Mark
> >>>>>
> >>>>> http://www.lucidimagination.com
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>> =
--------------------------------------------------------------------
> -
> >>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>> For additional commands, e-mail: =
java-user-help@lucene.apache.org
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>> =
---------------------------------------------------------------------
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>>
> >>>>
> >>>>
> >>> =
---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>>
> >>>
> >>
> >>
> >>
> >
> >
> > --
> > - Mark
> >
> > http://www.lucidimagination.com
> >
> >
> >
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42366-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 19:50:20 2009
Return-Path: <java-user-return-42366-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39061 invoked from network); 15 Sep 2009 19:50:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 19:50:20 -0000
Received: (qmail 56908 invoked by uid 500); 15 Sep 2009 19:50:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56845 invoked by uid 500); 15 Sep 2009 19:50:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56835 invoked by uid 99); 15 Sep 2009 19:50:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:50:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 19:50:07 +0000
Received: by bwz10 with SMTP id 10so3497040bwz.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 12:49:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        bh=n5KlY5ApFOw6Pve9Z4ccO+y46EvT3AY9qTpnyDccsx4=;
        b=dayAnyEaSGXlRQ+P2C8Mj5n+krONsF5kJFILcu+mErSG713DKYANn+M6Bxm5DB5JzN
         aD/mDtt4bL7bSlxx0zZHPq4MKHbQ+nSfmqESQ7aBPMsXgCzh9lEe5GTIyk0Tf0JBQAuy
         2AgMuoUmRs+SipHKmtVmdN9p5ZxHje7bkwwGo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=VosTYvL2QLk7o6dZkwONnxrbjCOGNEq3MYro649/ZoEX241wYQKCMOCcQAisvzpEpZ
         8CUyJNdmL5uglp4jXY9pcx0RHj9G5wMH9DKxIH6A8pmqzgJOt43VTvL/bPBqkRmU9tds
         Ck3dWI0jCb+G3XXubH5V4RX5Op1x0Y9PxUuh0=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.223.14.12 with SMTP id e12mr2849856faa.23.1253044186479; Tue, 
	15 Sep 2009 12:49:46 -0700 (PDT)
In-Reply-To: <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com>
References: <4AAF96E6.7000909@net-m.de> <4AAFC4B8.9040608@gmail.com>
	 <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA>
	 <4AAFDA7D.8010202@gmail.com>
	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
	 <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>
	 <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com>
	 <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com>
Date: Tue, 15 Sep 2009 15:49:46 -0400
X-Google-Sender-Auth: 3c26004f452f1b89
Message-ID: <c68e39170909151249i51ddc983w5a7f3f994b458f63@mail.gmail.com>
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Here's my results in my quad core phenom, with ondemand CPU freq
scaling disabled (clocks locked at 3GHz)

Ubuntu 9.04, filesystem=ext4 on 7200RPM IDE drive, testfile=95MB fully cached.

Linux odin 2.6.28-15-generic #49-Ubuntu SMP Tue Aug 18 19:25:34 UTC
2009 x86_64 GNU/Linux
Java(TM) SE Runtime Environment (build 1.6.0_14-b08)
Java HotSpot(TM) 64-Bit Server VM (build 14.0-b16, mixed mode)


config: impl=ClassicFile serial=false nThreads=4 iterations=20
bufsize=1024 poolsize=2 filelen=95610240
answer=1165427971, ms=15610, MB/sec=489.99482383087764

config: impl=SeparateFile serial=false nThreads=4 iterations=20
bufsize=1024 poolsize=2 filelen=95610240
answer=1165427672, ms=4115, MB/sec=1858.7652976913728

config: impl=PooledPread serial=false nThreads=4 iterations=20
bufsize=1024 poolsize=2 filelen=95610240
answer=1165427971, ms=6352, MB/sec=1204.15919395466

config: impl=ChannelFile serial=false nThreads=4 iterations=20
bufsize=1024 poolsize=2 filelen=95610240
answer=1165427971, ms=20347, MB/sec=375.91876935174713

config: impl=ChannelPread serial=false nThreads=4 iterations=20
bufsize=1024 poolsize=2 filelen=95610240
answer=1165427971, ms=5189, MB/sec=1474.0449412218154

config: impl=ChannelTransfer serial=false nThreads=4 iterations=20
bufsize=1024 poolsize=2 filelen=95610240
answer=1165427971, ms=14794, MB/sec=517.021711504664

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42367-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 20:01:52 2009
Return-Path: <java-user-return-42367-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42304 invoked from network); 15 Sep 2009 20:01:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 20:01:52 -0000
Received: (qmail 73761 invoked by uid 500); 15 Sep 2009 20:01:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73708 invoked by uid 500); 15 Sep 2009 20:01:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73698 invoked by uid 99); 15 Sep 2009 20:01:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:01:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:01:38 +0000
Received: by fxm18 with SMTP id 18so3534407fxm.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 13:00:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=s55RYZwjxBXYI6amgzx0nEba/X1bCZHcWF2J3tL2cWk=;
        b=T+hp7CJVxLS/lSNbKWpVuLDlTFNePnC4fcRRRORJV6u1nGvrMp9+KQUEVqoh6TPW6t
         yHmW2C3tzkW9BCL0yg9EbJLB0Clf9p1jLN//Ftw9KS3K01IVDn5S5pjRFawIxL/fGUEr
         7v587EWTC0W3ub7aQEdHZNNHZyKRxSuypDlLU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=ux9tGueWQysIMALtLB+bcj7Qw7hLaiyo0XBEbgJO1FL9rSB1zBlZkDvRbhV5IZea2x
         9b1Tu2XSBHIXVZDdY6B/y5q6adl/jj6chHFN4f1N0+imjoWr2Rm+S+NLdEjbitl3RAmA
         WgIdaZPCifYNklUr+FBxSs0PKtwu4J9Av9f1c=
Received: by 10.86.22.12 with SMTP id 12mr6607012fgv.69.1253044817538;
        Tue, 15 Sep 2009 13:00:17 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm777508fge.4.2009.09.15.13.00.15
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 13:00:16 -0700 (PDT)
Message-ID: <4AAFF24F.10208@gmail.com>
Date: Tue, 15 Sep 2009 16:00:15 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAFC4B8.9040608@gmail.com>	 <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA>	 <4AAFDA7D.8010202@gmail.com>	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>	 <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>	 <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com>	 <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com> <c68e39170909151249i51ddc983w5a7f3f994b458f63@mail.gmail.com>
In-Reply-To: <c68e39170909151249i51ddc983w5a7f3f994b458f63@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I'm jealous of your 4 3.0Ghz to my 2.0Ghz.

I was on dynamic scaling frequency and switched to 2.0Ghz hard.

On ramdisk, my puny 2.0's almost catch you and get a bit over 1800MB/s
with SeparateFile.

I'm smoked on PooledPread and ChannelPread though. Still sub 500 for
both, even
on the ramdisk.

Its an absurd comparison though - everyone knows a jackalope is faster
than a koala.

- Mark

Yonik Seeley wrote:
> Here's my results in my quad core phenom, with ondemand CPU freq
> scaling disabled (clocks locked at 3GHz)
>
> Ubuntu 9.04, filesystem=ext4 on 7200RPM IDE drive, testfile=95MB fully cached.
>
> Linux odin 2.6.28-15-generic #49-Ubuntu SMP Tue Aug 18 19:25:34 UTC
> 2009 x86_64 GNU/Linux
> Java(TM) SE Runtime Environment (build 1.6.0_14-b08)
> Java HotSpot(TM) 64-Bit Server VM (build 14.0-b16, mixed mode)
>
>
> config: impl=ClassicFile serial=false nThreads=4 iterations=20
> bufsize=1024 poolsize=2 filelen=95610240
> answer=1165427971, ms=15610, MB/sec=489.99482383087764
>
> config: impl=SeparateFile serial=false nThreads=4 iterations=20
> bufsize=1024 poolsize=2 filelen=95610240
> answer=1165427672, ms=4115, MB/sec=1858.7652976913728
>
> config: impl=PooledPread serial=false nThreads=4 iterations=20
> bufsize=1024 poolsize=2 filelen=95610240
> answer=1165427971, ms=6352, MB/sec=1204.15919395466
>
> config: impl=ChannelFile serial=false nThreads=4 iterations=20
> bufsize=1024 poolsize=2 filelen=95610240
> answer=1165427971, ms=20347, MB/sec=375.91876935174713
>
> config: impl=ChannelPread serial=false nThreads=4 iterations=20
> bufsize=1024 poolsize=2 filelen=95610240
> answer=1165427971, ms=5189, MB/sec=1474.0449412218154
>
> config: impl=ChannelTransfer serial=false nThreads=4 iterations=20
> bufsize=1024 poolsize=2 filelen=95610240
> answer=1165427971, ms=14794, MB/sec=517.021711504664
>
> -Yonik
> http://www.lucidimagination.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42368-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 20:10:33 2009
Return-Path: <java-user-return-42368-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44550 invoked from network); 15 Sep 2009 20:10:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 20:10:33 -0000
Received: (qmail 84734 invoked by uid 500); 15 Sep 2009 20:10:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84651 invoked by uid 500); 15 Sep 2009 20:10:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84641 invoked by uid 99); 15 Sep 2009 20:10:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:10:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:10:18 +0000
Received: by fxm18 with SMTP id 18so3541424fxm.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 13:09:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :organization:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        bh=ymrNL8NVaN+1+GQ5vq4OLeA5S4rCzL3ifbeP76iSgnc=;
        b=IzeyRemYcqf/c4+LxVRH/fq6mRmGebZzxU0cUkY7B6o8akJ9L/hp3LOyNATkCgmjzc
         qEJIIl67D+GeNvhCCiPz5SyuJ3Gw05Yv4j2q0O/gSlN0qS6ntCWjsw6DqgNOrvdgUoxY
         bPY/kaFStpbrvpA9j0r3bR2d5ntfZSV4xcPzM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:organization:user-agent:mime-version:to
         :subject:references:in-reply-to:content-type
         :content-transfer-encoding;
        b=I7fEqSR+2xSDKKOQjfJlQTVNOjrT0/+9vjjXWfGTXs4fE45CAfNMLxPo/fFNOKyeDL
         WT6tA8zIhuA2RM0OXAmWkVM881H1bX+z6nZGN/yi2JlFXIkNtn33BjJmUI+GvWLjaZ3I
         SIR1yhD4S6DUHyaW74dQR1529iPQNoH0VA9Io=
Received: by 10.86.229.18 with SMTP id b18mr6611815fgh.34.1253045397908;
        Tue, 15 Sep 2009 13:09:57 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e20sm167035fga.0.2009.09.15.13.09.56
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 13:09:57 -0700 (PDT)
Message-ID: <4AAFF493.2070701@lucidimagination.com>
Date: Tue, 15 Sep 2009 16:09:55 -0400
From: Mark Miller <markrmiller@gmail.com>
Organization: Lucid Imagination
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <5985A0861800491EAFFCD4B0B61351A0@VEGA> <4AAFC4B8.9040608@gmail.com> <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA> <4AAFDA7D.8010202@gmail.com> <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com> <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com> <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com> <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com> <5011254AD3D04A418B4BCC2B7D045420@VEGA>
In-Reply-To: <5011254AD3D04A418B4BCC2B7D045420@VEGA>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Disturbed reminds me of the owl from sword in the stone ;)

Thats a great one liner - now I am completely disturbed.

Sorry - I've been known to do that -

The two results that I say specifically are from the harddisk - those
are from the harddisk and are ext4. They are a tad slower than the
ramdisk results.

Everything else is the ramdisk - and I wasn't sure if thats ext4 or ext3
(and my mind hasn't wandered towards finding the answer yet). I didn't
specify when creating it.

- Mark

Uwe Schindler wrote:
> Now I am completely disturbed. Which numbers come from which filesystem?
> Ext4 on HDD, tmpfs (which is a filesystem of its own), ext3 on HDD,...
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>   
>> -----Original Message-----
>> From: yseeley@gmail.com [mailto:yseeley@gmail.com] On Behalf Of Yonik
>> Seeley
>> Sent: Tuesday, September 15, 2009 9:33 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>
>> Remember to disable CPU frequency scaling when benchmarking... some
>> things with IO cause the freq to drop, and when it's CPU bound again
>> it takes a while for Linux to scale up the freq again.
>>
>> For example, on my ubuntu box, ChannelFile went from 100MB/sec to
>> 388MB/sec.  This effect probably won't be uniform across
>> implementations either.
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>> On Tue, Sep 15, 2009 at 3:25 PM, Mark Miller <markrmiller@gmail.com>
>> wrote:
>>     
>>> I just really I hadn't sent this one. Here are results from the
>>>       
>> harddrive:
>>     
>>> It looks like its closer to the same speed on the hardrive once
>>> everything is loaded in the system cache (as you'd expect). SeparateFile
>>> was 1200 vs almost 1700 on RAMDISK. ChannelPread looked a lot closer
>>>       
>> though.
>>     
>>> - Mark
>>>
>>> Tests from harddisk (filesystem cache warmed):
>>>
>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>> bufsize=1024 poolsize=2 filelen=730554368
>>> answer=-282293977, ms=238230, MB/sec=1226.6370616630988
>>>
>>> config: impl=ChannelPread serial=false nThreads=4 iterations=100
>>> bufsize=1024 poolsize=2 filelen=730554368
>>> answer=-282295361, ms=766340, MB/sec=381.3212767179059
>>>
>>>
>>> Mark Miller wrote:
>>>       
>>>> Michael McCandless wrote:
>>>>
>>>>         
>>>>> I don't like that the answer is different... but it's really really
>>>>> odd that it's different-yet-almost-the-same.
>>>>>
>>>>> Mark, were these 4 results on a normal (ext4) filesystem, or tmpfs?
>>>>> (Because the top 2 entries of your 4 results match the first set of 2
>>>>> entries you sent... so I'm thinking these 4 were actually tmpfs not
>>>>> ext4).
>>>>>
>>>>>
>>>>>           
>>>> Those 4 were tmpfs - I mention ext4 at the end because I had just given
>>>> a feel for the hardrive tests and wanted to note it was from ext4 - the
>>>> results are def ramdisk though.
>>>>
>>>>         
>>>>> What JRE/OS, linux, kernel versions, and hardware, are you running on?
>>>>>
>>>>>
>>>>>           
>>>> These are on:
>>>> Ubuntu Karmic Koala 9.10, currently updated
>>>> java-1.5.0-sun-1.5.0.20
>>>> 2.6.31-10-generic
>>>>
>>>> RAM: 3.9 Gig
>>>> 4 core Intel Core2 duo 2.0GHz
>>>>
>>>> Slow 5200 rpm laptop drives.
>>>>
>>>>
>>>>         
>>>>> The gains of SeparateFile over all else are stunning.  And, quite
>>>>> different from the linux tests I had run under LUCENE-753.  Maybe we
>>>>> need to revert FSDir.open to return SimpleFSDir again, on non-Windows
>>>>> hosts.  But then we don't have good concurrency...
>>>>>
>>>>> Mike
>>>>>
>>>>> On Tue, Sep 15, 2009 at 2:59 PM, Yonik Seeley
>>>>> <yonik.seeley@lucidimagination.com> wrote:
>>>>>
>>>>>
>>>>>           
>>>>>> It's been a while since I wrote that benchmarker... is it OK that the
>>>>>> answer is different?  Did you use the same test file?
>>>>>>
>>>>>> -Yonik
>>>>>> http://www.lucidimagination.com
>>>>>>
>>>>>>
>>>>>>
>>>>>> On Tue, Sep 15, 2009 at 2:18 PM, Mark Miller <markrmiller@gmail.com>
>>>>>>             
>> wrote:
>>     
>>>>>>             
>>>>>>> The results:
>>>>>>>
>>>>>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>>>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>>>>>>
>>>>>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>>>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>>>>>>
>>>>>>> config: impl=ChannelPread serial=false nThreads=4 iterations=100
>>>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>>>> answer=-282295361, ms=632253, MB/sec=462.19115955163517
>>>>>>>
>>>>>>> config: impl=PooledPread serial=false nThreads=4 iterations=100
>>>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>>>> answer=-282295361, ms=774664, MB/sec=377.2238637654518
>>>>>>>
>>>>>>> ClassicFile was heading for the same fate as ChannelFile.
>>>>>>>
>>>>>>>
>>>>>>> I'll have to check what its like on the file system - but it appears
>>>>>>> just ridiculously slower. Even with SeparateFile, All 4 cores are
>>>>>>>               
>> bouncing
>>     
>>>>>>> from 0-12% independently and really favoring the low end of that.
>>>>>>> ChannelPread appears no better.
>>>>>>>
>>>>>>> There are results from other OS's/setups in the JIRA issue.
>>>>>>>
>>>>>>> I'm using ext4.
>>>>>>>
>>>>>>> Uwe Schindler wrote:
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>>>> How does a conventional file system compare?
>>>>>>>>
>>>>>>>> -----
>>>>>>>> Uwe Schindler
>>>>>>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>>>>>>> http://www.thetaphi.de
>>>>>>>> eMail: uwe@thetaphi.de
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>>>>>>> -----Original Message-----
>>>>>>>>> From: Mark Miller [mailto:markrmiller@gmail.com]
>>>>>>>>> Sent: Tuesday, September 15, 2009 7:15 PM
>>>>>>>>> To: java-user@lucene.apache.org
>>>>>>>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>>>>>>>>
>>>>>>>>> Mark Miller wrote:
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>                   
>>>>>>>>>> Indeed - I just ran the FileReaderTest on a Linux tmpfs ramdisk -
>>>>>>>>>>                     
>> with
>>     
>>>>>>>>>> SeparateFile all 4 of my cores are immediately pinned and remain
>>>>>>>>>>                     
>> so.
>>     
>>>>>>>>>> With ChannelFile, all 4 cores hover 20-30%.
>>>>>>>>>>
>>>>>>>>>> It would appear it may not be a good idea to use NIOFSDirectory
>>>>>>>>>>                     
>> on
>>     
>>>>>>>>>>
>>>>>>>>>>                     
>>>>>>>>> ramdisks.
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>                   
>>>>>>>>>> Even still though - it looks like you have a further issue - your
>>>>>>>>>>                     
>> Lucene
>>     
>>>>>>>>>> 2.9 old-api results don't use it, and are still not good.
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>
>>>>>>>>>>                     
>>>>>>>>> The quick results:
>>>>>>>>>
>>>>>>>>> ramdisk: sudo mount -t tmpfs tmpfs /tmp/space -o
>>>>>>>>> size=1G,nr_inodes=200k,mode=01777
>>>>>>>>>
>>>>>>>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>>>>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>>>>>> answer=-282295611, ms=173550, MB/sec=1683.7899579371938
>>>>>>>>>
>>>>>>>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>>>>>>>> bufsize=1024 poolsize=2 filelen=730554368
>>>>>>>>> answer=-282295361, ms=1377768, MB/sec=212.09793463050383
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> --
>>>>>>>>> - Mark
>>>>>>>>>
>>>>>>>>> http://www.lucidimagination.com
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>> ------------------------------------------------------------------
>>>>>>>>>                   
>> ---
>>     
>>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>
>>>>>>>>>                   
>>>>>>>> -------------------------------------------------------------------
>>>>>>>>                 
>> --
>>     
>>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>>>>> --
>>>>>>> - Mark
>>>>>>>
>>>>>>> http://www.lucidimagination.com
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>> --------------------------------------------------------------------
>>>>>>>               
>> -
>>     
>>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>> ---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>             
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>
>>>>>           
>>>>
>>>>         
>>> --
>>> - Mark
>>>
>>> http://www.lucidimagination.com
>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>       
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42369-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 20:13:55 2009
Return-Path: <java-user-return-42369-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45301 invoked from network); 15 Sep 2009 20:13:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 20:13:55 -0000
Received: (qmail 91906 invoked by uid 500); 15 Sep 2009 20:13:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91866 invoked by uid 500); 15 Sep 2009 20:13:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91856 invoked by uid 99); 15 Sep 2009 20:13:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:13:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:13:44 +0000
Received: by bwz10 with SMTP id 10so3513253bwz.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 13:13:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        bh=Ni722ADz7f8al1Fl8cZIFfdQBy5sxFZ150AJvXWlDNk=;
        b=X6FLl96k3k1ofdhIAgetDvzisIvpJ9fpUcUYP1oLx3oSn0andWU6gPgm/rE6cP3LHw
         04Izv3aGm44/by9edIX1C6g5QJEr5ccvTupBKQYTd9OA8JKfI8q3THgcZ06ozRbKsFVe
         TY8uxgcuVcVcTqircu03dlgssPwV3dldwnyMc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=VrFeDHIxfnUU/i0UQRvuuBWNbDbuJohf25qyVUs1fZADbvVGdmzTboMsMdO728Bjoe
         FT/XgZHdf67Cs8/3lqOimhcMGe0NcGICRgZsgnlMC5uB+7OYFJtpC9kT+4wF++z0ZxY6
         ywiVufGySv7StYVEFbTtnU8Rxcfg7zbI/N5iw=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.223.4.148 with SMTP id 20mr2887418far.0.1253045603836; Tue, 15 
	Sep 2009 13:13:23 -0700 (PDT)
In-Reply-To: <c68e39170909151312u1c1f6ff7o94eead7acad031fb@mail.gmail.com>
References: <4AAF96E6.7000909@net-m.de> <4AAFDA7D.8010202@gmail.com>
	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
	 <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>
	 <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com>
	 <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com>
	 <c68e39170909151249i51ddc983w5a7f3f994b458f63@mail.gmail.com>
	 <4AAFF24F.10208@gmail.com>
	 <c68e39170909151312u1c1f6ff7o94eead7acad031fb@mail.gmail.com>
Date: Tue, 15 Sep 2009 16:13:23 -0400
X-Google-Sender-Auth: 93c0420c549df132
Message-ID: <c68e39170909151313v594f7204g784ba04fec68895a@mail.gmail.com>
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, Sep 15, 2009 at 4:12 PM, Yonik Seeley
<yonik@lucidimagination.com> wrote:
> Note that when nthreads>1 I sometimes get wrong answers for SimpleFile...

s/SimpleFile/SingleFile/g

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42370-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 20:14:20 2009
Return-Path: <java-user-return-42370-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45409 invoked from network); 15 Sep 2009 20:14:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 20:14:20 -0000
Received: (qmail 93725 invoked by uid 500); 15 Sep 2009 20:14:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93655 invoked by uid 500); 15 Sep 2009 20:14:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93645 invoked by uid 99); 15 Sep 2009 20:14:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:14:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:14:07 +0000
Received: by bwz10 with SMTP id 10so3512814bwz.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 13:12:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        bh=z1uLqZDBiuzjoKUiNEgHoUgS3GjJ3jzPe7OY/MyxDsY=;
        b=DTvEzsQY1KmNYLfToJfdVDRJpvIJ24UuNNv/uAESJ5cXSoXQrNZcTV8nFfbr2KzUNB
         w/hoaQfG23Y778/nVrAi+265AP5PvLvjhk5LBr57hIv/RfF36a4SQkOLMdzgkn+RypSB
         CiJkoW2UJRq+2BjuPpGnRdpxgGh7duNXWx86g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=hRN+1Sfuwxy0phrklABGJ3lRWAILy9vxV/8TbEhlkoOZ7Q1N0s0n3AH+02YI7IfDyT
         twa25L/dy+BkRS7mKYyTeTNXr24jk3CICoVOrhxHKUg8vYve+RxFgZ7Pxbhm+em6JBER
         LmnBzzQTb+5a+jKDgqdSiEuk3Jbt2Uar9bF58=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.223.143.79 with SMTP id t15mr1224832fau.2.1253045566336; Tue, 
	15 Sep 2009 13:12:46 -0700 (PDT)
In-Reply-To: <4AAFF24F.10208@gmail.com>
References: <4AAF96E6.7000909@net-m.de> <020FFC0B85B44457BA5D38315A91422C@VEGA>
	 <4AAFDA7D.8010202@gmail.com>
	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
	 <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>
	 <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com>
	 <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com>
	 <c68e39170909151249i51ddc983w5a7f3f994b458f63@mail.gmail.com>
	 <4AAFF24F.10208@gmail.com>
Date: Tue, 15 Sep 2009 16:12:46 -0400
X-Google-Sender-Auth: e4bca8f4b8119990
Message-ID: <c68e39170909151312u1c1f6ff7o94eead7acad031fb@mail.gmail.com>
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Note that when nthreads>1 I sometimes get wrong answers for SimpleFile...
hopefully it's just a bug in the test... I'll look into it a little.

-Yonik
http://www.lucidimagination.com



On Tue, Sep 15, 2009 at 4:00 PM, Mark Miller <markrmiller@gmail.com> wrote:
> I'm jealous of your 4 3.0Ghz to my 2.0Ghz.
>
> I was on dynamic scaling frequency and switched to 2.0Ghz hard.
>
> On ramdisk, my puny 2.0's almost catch you and get a bit over 1800MB/s
> with SeparateFile.
>
> I'm smoked on PooledPread and ChannelPread though. Still sub 500 for
> both, even
> on the ramdisk.
>
> Its an absurd comparison though - everyone knows a jackalope is faster
> than a koala.
>
> - Mark
>
> Yonik Seeley wrote:
>> Here's my results in my quad core phenom, with ondemand CPU freq
>> scaling disabled (clocks locked at 3GHz)
>>
>> Ubuntu 9.04, filesystem=ext4 on 7200RPM IDE drive, testfile=95MB fully cached.
>>
>> Linux odin 2.6.28-15-generic #49-Ubuntu SMP Tue Aug 18 19:25:34 UTC
>> 2009 x86_64 GNU/Linux
>> Java(TM) SE Runtime Environment (build 1.6.0_14-b08)
>> Java HotSpot(TM) 64-Bit Server VM (build 14.0-b16, mixed mode)
>>
>>
>> config: impl=ClassicFile serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=15610, MB/sec=489.99482383087764
>>
>> config: impl=SeparateFile serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427672, ms=4115, MB/sec=1858.7652976913728
>>
>> config: impl=PooledPread serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=6352, MB/sec=1204.15919395466
>>
>> config: impl=ChannelFile serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=20347, MB/sec=375.91876935174713
>>
>> config: impl=ChannelPread serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=5189, MB/sec=1474.0449412218154
>>
>> config: impl=ChannelTransfer serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=14794, MB/sec=517.021711504664
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42371-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 20:19:38 2009
Return-Path: <java-user-return-42371-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46182 invoked from network); 15 Sep 2009 20:19:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 20:19:38 -0000
Received: (qmail 5010 invoked by uid 500); 15 Sep 2009 20:19:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4972 invoked by uid 500); 15 Sep 2009 20:19:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4962 invoked by uid 99); 15 Sep 2009 20:19:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:19:35 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:19:23 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1311079fgg.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 13:18:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=uC+CTryS/OqstyQkVfBIhVWXYiIhWKlGDzgk0zEv1Ag=;
        b=xhgBQ3hZhpDSYpIRcCdjqLYno3wVYKBBGc+556m+92JNfrJUakDVv0I7hWfsFDOSpQ
         CPUMEsMR7Xh8wmbhJ1jfeSawvuaxuAHyM2fMp1b95JVs23nttDNVmecjWzeUMjOE7uF/
         DNxrDjg1YgS/Nzj4PzuCGmBuMG8XBXcjgDPng=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=L7Djea4+JuWCjJIaCAUYEX4Y4f4LmbmexhMDAP9LPqtPPDispYy46r8VI1WyBQZwg0
         T66cFtokO8Iv7JqdRS27Nm+VaBASae8L4VrUunjqLBG7/I8hoa0m+KR7EG66WF7c2/yZ
         Nq3dubshOpZVzTxLjpPZZsDt3jxg7Ei3Am/B4=
Received: by 10.86.17.27 with SMTP id 27mr6632566fgq.31.1253045883294;
        Tue, 15 Sep 2009 13:18:03 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm680956fgg.29.2009.09.15.13.18.01
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 15 Sep 2009 13:18:01 -0700 (PDT)
Message-ID: <4AAFF678.3050402@gmail.com>
Date: Tue, 15 Sep 2009 16:18:00 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAFC4B8.9040608@gmail.com>	 <4AAFCBB2.8090601@gmail.com> <020FFC0B85B44457BA5D38315A91422C@VEGA>	 <4AAFDA7D.8010202@gmail.com>	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>	 <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>	 <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com>	 <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com> <c68e39170909151249i51ddc983w5a7f3f994b458f63@mail.gmail.com> <4AAFF24F.10208@gmail.com>
In-Reply-To: <4AAFF24F.10208@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Okay - using a smaller file, I get better results. I had about 2+ gig
available to cache the 700mb file, but I probably had fragmentation
issues - I just grabbed the first big file I had.

So its gets a little better for ChannelPread with the smaller file
(approx 160mb vs approx 700mb for the old tests). It goes up a bit over
400MB/sec - but oddly, I lose approx 400MB/sec from my SeparateFile score:


ramdisk results:

config: impl=ChannelPread serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=164956707
answer=-31115427, ms=68940, MB/sec=957.1030287206268

config: impl=SeparateFile serial=false nThreads=4 iterations=100
bufsize=1024 poolsize=2 filelen=164956707
answer=-31115729, ms=45691, MB/sec=1444.106778140115


Mark Miller wrote:
> I'm jealous of your 4 3.0Ghz to my 2.0Ghz.
>
> I was on dynamic scaling frequency and switched to 2.0Ghz hard.
>
> On ramdisk, my puny 2.0's almost catch you and get a bit over 1800MB/s
> with SeparateFile.
>
> I'm smoked on PooledPread and ChannelPread though. Still sub 500 for
> both, even
> on the ramdisk.
>
> Its an absurd comparison though - everyone knows a jackalope is faster
> than a koala.
>
> - Mark
>
> Yonik Seeley wrote:
>   
>> Here's my results in my quad core phenom, with ondemand CPU freq
>> scaling disabled (clocks locked at 3GHz)
>>
>> Ubuntu 9.04, filesystem=ext4 on 7200RPM IDE drive, testfile=95MB fully cached.
>>
>> Linux odin 2.6.28-15-generic #49-Ubuntu SMP Tue Aug 18 19:25:34 UTC
>> 2009 x86_64 GNU/Linux
>> Java(TM) SE Runtime Environment (build 1.6.0_14-b08)
>> Java HotSpot(TM) 64-Bit Server VM (build 14.0-b16, mixed mode)
>>
>>
>> config: impl=ClassicFile serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=15610, MB/sec=489.99482383087764
>>
>> config: impl=SeparateFile serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427672, ms=4115, MB/sec=1858.7652976913728
>>
>> config: impl=PooledPread serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=6352, MB/sec=1204.15919395466
>>
>> config: impl=ChannelFile serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=20347, MB/sec=375.91876935174713
>>
>> config: impl=ChannelPread serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=5189, MB/sec=1474.0449412218154
>>
>> config: impl=ChannelTransfer serial=false nThreads=4 iterations=20
>> bufsize=1024 poolsize=2 filelen=95610240
>> answer=1165427971, ms=14794, MB/sec=517.021711504664
>>
>> -Yonik
>> http://www.lucidimagination.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>   
>>     
>
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42372-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 15 20:21:56 2009
Return-Path: <java-user-return-42372-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46610 invoked from network); 15 Sep 2009 20:21:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Sep 2009 20:21:55 -0000
Received: (qmail 10483 invoked by uid 500); 15 Sep 2009 20:21:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10410 invoked by uid 500); 15 Sep 2009 20:21:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10400 invoked by uid 99); 15 Sep 2009 20:21:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:21:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Sep 2009 20:21:42 +0000
Received: by bwz10 with SMTP id 10so3518244bwz.5
        for <java-user@lucene.apache.org>; Tue, 15 Sep 2009 13:20:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        bh=ukdgO9UoAtuDqZ3cIKCqQxioczZ+rx+lseNVfYWrL3Y=;
        b=D56tF3uiSWef0Y4vVAQvC8COdMn/ZqS/zsNtQ1B4QGh3nbYZMBMvEP33g8N56flurE
         s+M4+dWJn9YSc13Xmqy6RK9Rll6CQk1guTOl3/BR2nXwbvNEuRiIWsTYCxR0adr3Ln0N
         moRcUlKFcykNG6wcv307Aj8w3bBIEyBU7z78c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=xvoEbPY+PIPacZka1dbxI5yE1k3E2oMx4B4gtiWpQmJXTKL/5lOTRWA1M3fpF5dPcX
         F6B7pVJeKCFABz9yfKQlO3q5ocw0LQiM4V5Sd/KC/v3rIHdmfM8bWTB0WDUOJgkLKTSi
         jqyhY2fUr3WWbhTF2Zwo1kschsTJlIg0sh2RA=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.223.2.217 with SMTP id 25mr2769718fak.41.1253046021797; Tue, 
	15 Sep 2009 13:20:21 -0700 (PDT)
In-Reply-To: <c68e39170909151313v594f7204g784ba04fec68895a@mail.gmail.com>
References: <4AAF96E6.7000909@net-m.de>
	 <c68e39170909151159m493c8c80pc6e81e7f021a1c47@mail.gmail.com>
	 <9ac0c6aa0909151210s3c20b9f9mfad6c676d65fd96b@mail.gmail.com>
	 <4AAFE86B.2090509@gmail.com> <4AAFEA0C.9080508@gmail.com>
	 <c68e39170909151233n147ca629p97cf200c5c3cc224@mail.gmail.com>
	 <c68e39170909151249i51ddc983w5a7f3f994b458f63@mail.gmail.com>
	 <4AAFF24F.10208@gmail.com>
	 <c68e39170909151312u1c1f6ff7o94eead7acad031fb@mail.gmail.com>
	 <c68e39170909151313v594f7204g784ba04fec68895a@mail.gmail.com>
Date: Tue, 15 Sep 2009 16:20:21 -0400
X-Google-Sender-Auth: afa913e313c26c86
Message-ID: <c68e39170909151320l62475fdy351ea1af93b64cef@mail.gmail.com>
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

OK, I see the issue - SingleFile doesn't have it's own filepointer.
I'll update the original issue.  (for large files, this shouldn't
change the times any).

-Yonik
http://www.lucidimagination.com

On Tue, Sep 15, 2009 at 4:13 PM, Yonik Seeley
<yonik@lucidimagination.com> wrote:
> On Tue, Sep 15, 2009 at 4:12 PM, Yonik Seeley
> <yonik@lucidimagination.com> wrote:
>> Note that when nthreads>1 I sometimes get wrong answers for SimpleFile...
>
> s/SimpleFile/SingleFile/g
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42373-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 08:53:05 2009
Return-Path: <java-user-return-42373-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60936 invoked from network); 16 Sep 2009 08:53:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 08:53:05 -0000
Received: (qmail 76309 invoked by uid 500); 16 Sep 2009 08:53:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76214 invoked by uid 500); 16 Sep 2009 08:53:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76204 invoked by uid 99); 16 Sep 2009 08:53:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 08:53:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 08:52:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MnqFb-0008UM-EI
	for java-user@lucene.apache.org; Wed, 16 Sep 2009 01:52:31 -0700
Message-ID: <25468423.post@talk.nabble.com>
Date: Wed, 16 Sep 2009 01:52:31 -0700 (PDT)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: Finding duplicate records from a result set
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fayyazuddin@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Dear Fellow Java/Lucene developers:

One annoyance that people have when searching for information online is the
occurance of duplicate records (i.e. multiple sites that carry news feeds
from the SAME news source like reuters or the associated press, and do not
provide any additional pieces of information).  This becomes an issue for
the user, as they would like to sift through all the duplicates and only
search through only the unique hits.  In my application that I am working
on, I realize that this is extremely common.  I have various books in xml
format that contain quotations, of which many are also listed in other
collections (i.e. the narrator, and the text of the quotation are almost
exactly the same.  Because the books have been translated into english by
different authors, the quotations from each collection differ slightly from
one another.  The quotations are being reported by multiple sources).  What
I would like to do in my application, using either Lucene, is to return a
set of results, such that if a user searches for a particular keyword (or
uses multiple keywords), then the result set should list any quote that is
reported from multiple sources only once, and underneath that quote, simply
list all the references from the other collections where it is found,
instead of listing the exact same quote in the result set, multiple times.
 
For example, if John Doe said, "blah blah blah", which is found in the
sources A, B, and C, if a user searched for "blah blah blah", then I want
the result set to show:
 
1. Narrator: John Doe
    Quote: "blah blah blah"
    Reference: A, B, C
 
and NOT like the following:
 
1. Narrator: John Doe
   Quote: "blah blah blah"
   Reference: A
 
2. Narrator: John Doe
   Quote: "blah blah blah"
   Reference: B
 
3. Narrator: John Doe
   Quote: "blah blah blah"
   Reference: C
 
I would imagine that this is a known issue in information retrieval, and I
am wondering if you have been able to solve/address this issue in Java using
Lucene?  What would you advise?  
 
Thanks to everyone for your time and patience.
-- 
View this message in context: http://www.nabble.com/Finding-duplicate-records-from-a-result-set-tp25468423p25468423.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42374-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 09:16:43 2009
Return-Path: <java-user-return-42374-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69221 invoked from network); 16 Sep 2009 09:16:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 09:16:42 -0000
Received: (qmail 5930 invoked by uid 500); 16 Sep 2009 09:16:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5852 invoked by uid 500); 16 Sep 2009 09:16:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5842 invoked by uid 99); 16 Sep 2009 09:16:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 09:16:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.47] (HELO web50206.mail.re2.yahoo.com) (206.190.38.47)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 16 Sep 2009 09:16:28 +0000
Received: (qmail 45719 invoked by uid 60001); 16 Sep 2009 09:16:06 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253092566; bh=q5fyOWyTQ6Jy+VaoaYRQw1KZJI93q37ehBQFqcv9hBY=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=DvWTDg4rye3TmvHenOZ+NLZmpEWp4H4uVe+R2LOBdW6kcg8bZvB2EiUGD/vQ20RlDDVt4O6uE8LeNdB0CHG9GSqKUngg8/3ztQSlNu4CDZ1S6FeewvScpYvAKFwGuQXBlBRWhJE+LYHEnGPYvI+js8k04fqAAFd58g/gB4qlvAU=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=Dfx8nSC4MfzuSaZnhirbNm7G3IRPm0WVXdwV+K3RLZsUJm6brO35dc5JCpkHj7Q+EHP082t9JwTOJfYdTaxoGpKGoO1BlDji8zAK2/D6WCQhmJEWNQzpLbG6f2+zEefeEXv5xZuKBoK2l/0VUOP4t70PstLRM7TbqfPlw+m9KjI=;
Message-ID: <821665.45205.qm@web50206.mail.re2.yahoo.com>
X-YMail-OSG: Wgx_n2YVM1nKSbwOCJoqBR6hF_x6_uOZJMjpQnIEgqH6kz4Jc1qlnLdPJMUOLZNc9DUZXkmaKXiz_x9fk0QcjCevL0JDym3rXp5CBQH8.ML2GffqmsfvRxtVwKLK0qHec_bsv8RmltwfoAqslwJeMmqFOhzE1nagm.2H_3p5MHMOwMgVaw1.2t6XtgUaFONel2NOGT.3V0mZLjaxF8abVFZwu3vYZ8K5uTpXNipXWbnstu0uAVcverL8Wf_tvQDSJp_xkN3gnePvIRQp1TAsZF10jPqOPssF0WoEC8OhQuYHvzmgGv62qg1m9owD1PZ60GQ8AgraluE1QSZ2Qd3hl5ArOADswtUtoSAmXNz33nOngQf.Wyq6.52l.vtme_kN3n_pIoJCwOAdDFw-
Received: from [213.55.95.65] by web50206.mail.re2.yahoo.com via HTTP; Wed, 16 Sep 2009 02:16:06 PDT
X-Mailer: YahooMailClassic/6.1.2 YahooMailWebService/0.7.347.2
Date: Wed, 16 Sep 2009 02:16:06 -0700 (PDT)
From: henok sahilu <henok_sahilu@yahoo.com>
Subject: Re: Finding duplicate records from a result set
To: java-user@lucene.apache.org
In-Reply-To: <25468423.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1372656718-1253092566=:45205"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1372656718-1253092566=:45205
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

i have a thesis work which i have done. it was on lega documents. the XML I=
R systems are very susceptible for producing duplicate or near duplicate co=
ntents (not in concept, but in textual content ).
here is what i did .
i tag each article content in the legal documents, with their status, and t=
heir relationship with other article contents.
=A0and then write a parer that will read this tags and index the contents t=
herein.=20
and write a re-ranking algorithm that works based on the staus information =
of article contents and their relationship.
for example=20
the one that contians an active law will be boosted, because it is the acti=
ve law that prevails in matters.
and some times article are replaced by other articles , in this case rather=
 than presenting both them (which can result in duplicates ) i compare new =
terms used in the process of replacing with the query terms and boost the r=
eplacing article content. or i compare the terms that are exclusively used =
by the old article content with the query terms and boost the old article c=
ontent.=20
the repealed article contents are downwwited by some factor rather than pre=
senting their them along with their other version .=20
this is what i have done to reduce the number of duplicating or near duplic=
ating search results to users.other wise the user can waste considerable ti=
me inspecting which is duplicate and which is not .
i can give u the the abstract and come codes (in java) id u want=20
i think this might help=20
henok=20

--- On Wed, 9/16/09, syedfa <fayyazuddin@gmail.com> wrote:

From: syedfa <fayyazuddin@gmail.com>
Subject: Finding duplicate records from a result set
To: java-user@lucene.apache.org
Date: Wednesday, September 16, 2009, 1:52 AM


Dear Fellow Java/Lucene developers:

One annoyance that people have when searching for information online is the
occurance of duplicate records (i.e. multiple sites that carry news feeds
from the SAME news source like reuters or the associated press, and do not
provide any additional pieces of information).=A0 This becomes an issue for
the user, as they would like to sift through all the duplicates and only
search through only the unique hits.=A0 In my application that I am working
on, I realize that this is extremely common.=A0 I have various books in xml
format that contain quotations, of which many are also listed in other
collections (i.e. the narrator, and the text of the quotation are almost
exactly the same.=A0 Because the books have been translated into english by
different authors, the quotations from each collection differ slightly from
one another.=A0 The quotations are being reported by multiple sources).=A0 =
What
I would like to do in my application, using either Lucene, is to return a
set of results, such that if a user searches for a particular keyword (or
uses multiple keywords), then the result set should list any quote that is
reported from multiple sources only once, and underneath that quote, simply
list all the references from the other collections where it is found,
instead of listing the exact same quote in the result set, multiple times.
=20
For example, if John Doe said, "blah blah blah", which is found in the
sources A, B, and C, if a user searched for "blah blah blah", then I want
the result set to show:
=20
1. Narrator: John Doe
=A0 =A0 Quote: "blah blah blah"
=A0 =A0 Reference: A, B, C
=20
and NOT like the following:
=20
1. Narrator: John Doe
=A0=A0=A0Quote: "blah blah blah"
=A0=A0=A0Reference: A
=20
2. Narrator: John Doe
=A0=A0=A0Quote: "blah blah blah"
=A0=A0=A0Reference: B
=20
3. Narrator: John Doe
=A0=A0=A0Quote: "blah blah blah"
=A0=A0=A0Reference: C
=20
I would imagine that this is a known issue in information retrieval, and I
am wondering if you have been able to solve/address this issue in Java usin=
g
Lucene?=A0 What would you advise?=A0=20
=20
Thanks to everyone for your time and patience.
--=20
View this message in context: http://www.nabble.com/Finding-duplicate-recor=
ds-from-a-result-set-tp25468423p25468423.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-1372656718-1253092566=:45205--

From java-user-return-42375-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 10:05:05 2009
Return-Path: <java-user-return-42375-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83502 invoked from network); 16 Sep 2009 10:05:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 10:05:04 -0000
Received: (qmail 86180 invoked by uid 500); 16 Sep 2009 10:05:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86100 invoked by uid 500); 16 Sep 2009 10:05:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86090 invoked by uid 99); 16 Sep 2009 10:05:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 10:05:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 10:04:51 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MnrNG-0002gb-BB
	for java-user@lucene.apache.org; Wed, 16 Sep 2009 03:04:30 -0700
Message-ID: <25469429.post@talk.nabble.com>
Date: Wed, 16 Sep 2009 03:04:30 -0700 (PDT)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Finding duplicate records from a result set
In-Reply-To: <821665.45205.qm@web50206.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: fayyazuddin@gmail.com
References: <25468423.post@talk.nabble.com> <821665.45205.qm@web50206.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks very much Henok for your reply.  I would be very much interested in
your thesis, and any code that you may provide.  Is your thesis published
online?  Is it in english?  Your approach seems very interesting, and I
would be very interested in looking at the details.  Some ideas I had were
using the cosine similarity approach, or perhaps n-grams, since the
quotations that I am comparing are not as big as an entire document/article=
.

I would be very happy to hear from you.  My email address is
fayyazuddin@gmail.com.

Also, were you able to implement your solution online?  If you can provide
me with you a url, that would be great.

I look forward to hearing from you soon.

Sincerely;
Fayyaz

henok sahilu wrote:
>=20
> i have a thesis work which i have done. it was on lega documents. the XML
> IR systems are very susceptible for producing duplicate or near duplicate
> contents (not in concept, but in textual content ).
> here is what i did .
> i tag each article content in the legal documents, with their status, and
> their relationship with other article contents.
> =C2=A0and then write a parer that will read this tags and index the conte=
nts
> therein.=20
> and write a re-ranking algorithm that works based on the staus informatio=
n
> of article contents and their relationship.
> for example=20
> the one that contians an active law will be boosted, because it is the
> active law that prevails in matters.
> and some times article are replaced by other articles , in this case
> rather than presenting both them (which can result in duplicates ) i
> compare new terms used in the process of replacing with the query terms
> and boost the replacing article content. or i compare the terms that are
> exclusively used by the old article content with the query terms and boos=
t
> the old article content.=20
> the repealed article contents are downwwited by some factor rather than
> presenting their them along with their other version .=20
> this is what i have done to reduce the number of duplicating or near
> duplicating search results to users.other wise the user can waste
> considerable time inspecting which is duplicate and which is not .
> i can give u the the abstract and come codes (in java) id u want=20
> i think this might help=20
> henok=20
>=20
> --- On Wed, 9/16/09, syedfa <fayyazuddin@gmail.com> wrote:
>=20
> From: syedfa <fayyazuddin@gmail.com>
> Subject: Finding duplicate records from a result set
> To: java-user@lucene.apache.org
> Date: Wednesday, September 16, 2009, 1:52 AM
>=20
>=20
> Dear Fellow Java/Lucene developers:
>=20
> One annoyance that people have when searching for information online is
> the
> occurance of duplicate records (i.e. multiple sites that carry news feeds
> from the SAME news source like reuters or the associated press, and do no=
t
> provide any additional pieces of information).=C2=A0 This becomes an issu=
e for
> the user, as they would like to sift through all the duplicates and only
> search through only the unique hits.=C2=A0 In my application that I am wo=
rking
> on, I realize that this is extremely common.=C2=A0 I have various books i=
n xml
> format that contain quotations, of which many are also listed in other
> collections (i.e. the narrator, and the text of the quotation are almost
> exactly the same.=C2=A0 Because the books have been translated into engli=
sh by
> different authors, the quotations from each collection differ slightly
> from
> one another.=C2=A0 The quotations are being reported by multiple sources)=
.=C2=A0
> What
> I would like to do in my application, using either Lucene, is to return a
> set of results, such that if a user searches for a particular keyword (or
> uses multiple keywords), then the result set should list any quote that i=
s
> reported from multiple sources only once, and underneath that quote,
> simply
> list all the references from the other collections where it is found,
> instead of listing the exact same quote in the result set, multiple times=
.
> =20
> For example, if John Doe said, "blah blah blah", which is found in the
> sources A, B, and C, if a user searched for "blah blah blah", then I want
> the result set to show:
> =20
> 1. Narrator: John Doe
> =C2=A0 =C2=A0 Quote: "blah blah blah"
> =C2=A0 =C2=A0 Reference: A, B, C
> =20
> and NOT like the following:
> =20
> 1. Narrator: John Doe
> =C2=A0=C2=A0=C2=A0Quote: "blah blah blah"
> =C2=A0=C2=A0=C2=A0Reference: A
> =20
> 2. Narrator: John Doe
> =C2=A0=C2=A0=C2=A0Quote: "blah blah blah"
> =C2=A0=C2=A0=C2=A0Reference: B
> =20
> 3. Narrator: John Doe
> =C2=A0=C2=A0=C2=A0Quote: "blah blah blah"
> =C2=A0=C2=A0=C2=A0Reference: C
> =20
> I would imagine that this is a known issue in information retrieval, and =
I
> am wondering if you have been able to solve/address this issue in Java
> using
> Lucene?=C2=A0 What would you advise?=C2=A0=20
> =20
> Thanks to everyone for your time and patience.
> --=20
> View this message in context:
> http://www.nabble.com/Finding-duplicate-records-from-a-result-set-tp25468=
423p25468423.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20
>=20
>=20
>=20

--=20
View this message in context: http://www.nabble.com/Finding-duplicate-recor=
ds-from-a-result-set-tp25468423p25469429.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42376-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 12:26:25 2009
Return-Path: <java-user-return-42376-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20135 invoked from network); 16 Sep 2009 12:26:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 12:26:24 -0000
Received: (qmail 57094 invoked by uid 500); 16 Sep 2009 12:26:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57016 invoked by uid 500); 16 Sep 2009 12:26:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56990 invoked by uid 99); 16 Sep 2009 12:26:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 12:26:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of benjamin.pasero@gmail.com designates 209.85.210.194 as permitted sender)
Received: from [209.85.210.194] (HELO mail-yx0-f194.google.com) (209.85.210.194)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 12:26:13 +0000
Received: by yxe32 with SMTP id 32so960565yxe.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 05:25:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=XRttlD/xMFpBopzNNi+D4u5ThxuE+r8wTCO0RCAzrtk=;
        b=qNV9qH9HxCpcg5cC8xkkw5iE6S4Zu9PviCRGi/uE1pM9bIJm+BLiTqc3bE33H8WdZE
         bLtrKcGTm65qoM0b2mbiHskKBeob9wsPpyh2wJoZn/vU/1lZYcCnAOlE1tdyuQCqBKc5
         W4gtn5XDlznUv+hgn3uzcBNbJazJIFn1k+ECE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=Ila5p8RZ4VtvDUdJtEjxeXj9DAtKa/l2b0K3J82aj5F2USgb5JzGQBvuAmOaF6GAKx
         TCbkkWnwKc99WRH6dQv1Eb8nQXrTX28eoYLVc+Lj2bMYFZE69pLBc4agVwAr/5/WrqCs
         QyJFvPrafD47e+0YB3vbgxq3PHiIRm4CeUkqU=
MIME-Version: 1.0
Received: by 10.101.89.5 with SMTP id r5mr8875025anl.69.1253103952022; Wed, 16 
	Sep 2009 05:25:52 -0700 (PDT)
Date: Wed, 16 Sep 2009 14:25:52 +0200
Message-ID: <5381b58f0909160525r6564201frdc8ec31a845b5fc@mail.gmail.com>
Subject: What would be the fastest BooleanQuery possible?
From: Benjamin Pasero <benjamin.pasero@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I am using Lucene not only for smart fulltext searches but also for
getting the results for a DB-like query, where I am not tokenizing the
terms at all. For this query, I am interested in all results and for
that
I am using my own HitCollector.

Now, while profiling I noticed that quite some time is spent in
methods like TermQuery.weight() or BooleanScorer2.score(). Given that
I am interested in all results, I am not interested in any score for
the
results.

Is it possible to run a query where Lucene simply checks if a Document
is a hit or not and completly ignore weighting and scoring? Or is that
an integrated part of the search used to determine if a Document
is a hit or not?

Thanks for helping,
Ben

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42377-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 12:49:19 2009
Return-Path: <java-user-return-42377-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29259 invoked from network); 16 Sep 2009 12:49:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 12:49:19 -0000
Received: (qmail 97494 invoked by uid 500); 16 Sep 2009 12:49:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97423 invoked by uid 500); 16 Sep 2009 12:49:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97413 invoked by uid 99); 16 Sep 2009 12:49:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 12:49:16 +0000
X-ASF-Spam-Status: No, hits=0.4 required=10.0
	tests=DATE_IN_FUTURE_03_06,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.178 as permitted sender)
Received: from [209.85.221.178] (HELO mail-qy0-f178.google.com) (209.85.221.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 12:49:05 +0000
Received: by qyk8 with SMTP id 8so4067266qyk.24
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 05:48:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=OmGGrlLdLpqy6Sqc5WNS8l/ki2mWNQBSqfvFGR4FxjM=;
        b=GFtWZhhqHuQ8QRizca9d9SFAm3tgcMRCVBui+sFgt4BIAO7+wTmA8YoInAfS7detZL
         e+qZQBrETsQK3igr3+fO3Ajjof/1VIzXPywQ6RsOOat1Po7rV2TBVCeh4aj7VykNbe3t
         oAO+UMTBAaOuM5TOoUIjhSKLfBxMh3kJZG0Tg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=rdTF23K+ObKhDixBT0GkGxIkcnWprKotpyF4R2SREt771iddsgkMdhnMV2nymqsw+f
         WXe9niYsGQUpkI9sgT2wvUlNttqZ/SpB5MM2AVzV4WuA7zaTVWqQlSGU4FEFC+cbJLvg
         +0iVc2mMP/uTrgDM1h7KLZ26icwu/fzhi7ILw=
Received: by 10.224.92.194 with SMTP id s2mr7169286qam.383.1253105322669;
        Wed, 16 Sep 2009 05:48:42 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm1446605qwe.5.2009.09.16.05.48.41
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 05:48:41 -0700 (PDT)
Message-ID: <4AB116EC.90104@gmail.com>
Date: Wed, 16 Sep 2009 12:48:44 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: What would be the fastest BooleanQuery possible?
References: <5381b58f0909160525r6564201frdc8ec31a845b5fc@mail.gmail.com>
In-Reply-To: <5381b58f0909160525r6564201frdc8ec31a845b5fc@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

With the new Collector API in Lucene 2.9, you no longer have to compute the
score.

Now a Collector is passed a Scorer if they want to use it, but you can
just ignore it.

-- 
- Mark

http://www.lucidimagination.com



Benjamin Pasero wrote:
> Hi,
>
> I am using Lucene not only for smart fulltext searches but also for
> getting the results for a DB-like query, where I am not tokenizing the
> terms at all. For this query, I am interested in all results and for
> that
> I am using my own HitCollector.
>
> Now, while profiling I noticed that quite some time is spent in
> methods like TermQuery.weight() or BooleanScorer2.score(). Given that
> I am interested in all results, I am not interested in any score for
> the
> results.
>
> Is it possible to run a query where Lucene simply checks if a Document
> is a hit or not and completly ignore weighting and scoring? Or is that
> an integrated part of the search used to determine if a Document
> is a hit or not?
>
> Thanks for helping,
> Ben
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42378-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 13:14:37 2009
Return-Path: <java-user-return-42378-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39219 invoked from network); 16 Sep 2009 13:14:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 13:14:37 -0000
Received: (qmail 53448 invoked by uid 500); 16 Sep 2009 13:14:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53396 invoked by uid 500); 16 Sep 2009 13:14:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53386 invoked by uid 99); 16 Sep 2009 13:14:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 13:14:35 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of benjamin.pasero@gmail.com designates 209.85.210.194 as permitted sender)
Received: from [209.85.210.194] (HELO mail-yx0-f194.google.com) (209.85.210.194)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 13:14:25 +0000
Received: by yxe32 with SMTP id 32so1138yxe.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 06:14:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=rVKqj0kKjS8MmZ7rJYI8x3Q8CV/MfplbHDmAXACrYT8=;
        b=i5s5GT3KW9kN08KhmzYzHOO7fX+78GH1EfGtrpkHb7oaXES8T+w1YhDC+K6ITl1irA
         KnDlL6y2lUmh9iIyshaQNmV04mq0DGMZV+cVBQnjrHKr6I6E/HWVvyN+DWUS5lpA1A1d
         1AfZAe/ER3z8wKJ7jLfTnigucTCl8P8hpG050=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=CFxAeB6YtKYXmkqe2hUzApB2GQvtUz+FcJvunI2LifI7JLEbgvBrXkd0ALZfrkbui8
         MGZM4ua10y94gzPGm6oZxNq61Pmfo2q6XiEysBoJ6fRLas4lq7TMAjA2qYTdwauMJB18
         Fx4Hdxvr4wP5iWMhstkODKAHJlz4MbsOp6rQc=
MIME-Version: 1.0
Received: by 10.101.111.12 with SMTP id o12mr8985400anm.51.1253106844141; Wed, 
	16 Sep 2009 06:14:04 -0700 (PDT)
In-Reply-To: <4AB116EC.90104@gmail.com>
References: <5381b58f0909160525r6564201frdc8ec31a845b5fc@mail.gmail.com>
	 <4AB116EC.90104@gmail.com>
Date: Wed, 16 Sep 2009 15:14:04 +0200
Message-ID: <5381b58f0909160614m385d0c1bt2d59e8f249c46018@mail.gmail.com>
Subject: Re: What would be the fastest BooleanQuery possible?
From: Benjamin Pasero <benjamin.pasero@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Ah wow that sounds great. I am using 2.3.2 though (and have to use it
for now). Anything
in that version that could speed things up?

On Wed, Sep 16, 2009 at 6:48 PM, Mark Miller <markrmiller@gmail.com> wrote:
> With the new Collector API in Lucene 2.9, you no longer have to compute the
> score.
>
> Now a Collector is passed a Scorer if they want to use it, but you can
> just ignore it.
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
> Benjamin Pasero wrote:
>> Hi,
>>
>> I am using Lucene not only for smart fulltext searches but also for
>> getting the results for a DB-like query, where I am not tokenizing the
>> terms at all. For this query, I am interested in all results and for
>> that
>> I am using my own HitCollector.
>>
>> Now, while profiling I noticed that quite some time is spent in
>> methods like TermQuery.weight() or BooleanScorer2.score(). Given that
>> I am interested in all results, I am not interested in any score for
>> the
>> results.
>>
>> Is it possible to run a query where Lucene simply checks if a Document
>> is a hit or not and completly ignore weighting and scoring? Or is that
>> an integrated part of the search used to determine if a Document
>> is a hit or not?
>>
>> Thanks for helping,
>> Ben
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42379-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 13:49:08 2009
Return-Path: <java-user-return-42379-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50378 invoked from network); 16 Sep 2009 13:49:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 13:49:08 -0000
Received: (qmail 15243 invoked by uid 500); 16 Sep 2009 13:49:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15164 invoked by uid 500); 16 Sep 2009 13:49:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15154 invoked by uid 99); 16 Sep 2009 13:49:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 13:49:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of trewig@mufin.com designates 195.214.216.123 as permitted sender)
Received: from [195.214.216.123] (HELO mx3.de.magix.net) (195.214.216.123)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 13:48:57 +0000
Received: from [192.168.1.18] (port=8127)
	by mx3.de.magix.net with esmtpa (Exim 4.69)
	(envelope-from <trewig@mufin.com>)
	id 1Mnus8-0002o1-0M
	for java-user@lucene.apache.org; Wed, 16 Sep 2009 15:48:36 +0200
Message-ID: <4AB0EC9D.3050002@mufin.com>
Date: Wed, 16 Sep 2009 15:48:13 +0200
From: Thomas Rewig <trewig@mufin.com>
Organization: mufin
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Problems with ItemBasedRecommender with Lucene
Content-Type: text/plain; charset=ISO-8859-15; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Exim-Connect-IP: 192.168.1.18
X-SA-Exim-Mail-From: trewig@mufin.com
X-SA-Exim-Scanned: No (on mx3.de.magix.net); SAEximRunCond expanded to false
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

I build a "real time ItemBasedRecommender" based on a users history and 
a (sparse) item similarity matrix with lucene. Some time ago Ted Dunning 
recommended me this approach at the mahout mailing list to create a 
ItemBasedRecommender:

"It is actually very easy to do. The output of the recommendation 
off-line process is generally a sparse matrix of item-item links. Each 
line of this sparse matrix can be considered a document in creating a 
Lucene index. You will have to use a correct analyzer and a line by line 
document segmenter, but that is trivial. Then recommendation is a simple 
query step."

So for 100000 items it works fine - but for 1 million items the Indexing 
fails and I have no idea how to avoid this. Maybe you can give me a hint.

First I create a Item-Item-Similaritymatrix with mahout's taste and in 
the second step I index it. The matrix is sparce because only 
Item-Item-Relations with a high correlation will be saved.

Here are the Code Snippets for this indexing :
       
      CachedRowSetImpl rowSetMainItemList = null; // Mapping of Items
        ArrayList<String> listBelongingItems = null; // Belonging and 
highest correlating Items for a MainItem
        Document aDocument = null;
        Field aField = null;
        Field aField1 = null;
       
        Analyzer aAnalyzer  = new StandardAnalyzer();
        IndexWriter aWriter = new IndexWriter(this.indexDirectory, 
aAnalyzer, true, IndexWriter.MaxFieldLength.UNLIMITED);
       
        aWriter.setRAMBufferSizeMB(48);
       
        rowSetMainItemList = getRowSetItemList(); //get all Items
       
        aField1 = new Field("Item1", "", 
Field.Store.YES,Field.Index.ANALYZED); // reuse this field
       
        while (rowSetMainItemList.next()){
               
            aDocument = new Document();
                   
            aField1.setValue(rowSetMainItemList.getString(1));   
            aDocument.add(aField1);
           
            listBelongingItems = 
getRowSetBelongingItems(rowSetMainItemList.getString(1)); // get the 
most similar Items fpr a Item
            Iterator<String> itrBelongingItems = 
listBelongingItems.iterator();
               
            while (itrBelongingItems.hasNext()){
                   
                String strBelongingItem = (String) itrBelongingItems.next();
                //No reuse of Field possible because of different 
fieldnames:
                aField = new Field(strBelongingItem,"1", 
Field.Store.NO,Field.Index.ANALYZED_NO_NORMS);
                aDocument.add(aField);
            }
               
            aWriter.addDocument(aDocument);   
               
        }
       
        aWriter.optimize();
        aWriter.close();
           
        aAnalyzer.close();
               
Actually the Field of the BelongingItem have to be boosted with the 
MainItem-BelongingItem-Correlation-Value to get accurate 
Recommendations, but here the Index would be about 80 GByte for 6 
million items... without it will only be about 2Gbyte.
But under the condition that only relevant Correlations will be saved in 
the Similaritymatrix the recommendation quality will be good enough.

The item recommendation for a User is a simple BooleanQuery with 
userhistory boosted TermQuerys. Here I search for documents with the 
largest Correspondence regarding the userhistory.  So I  look in which 
Documents the most Fields with the name of a BelongingItem are set (with 
value 1) and recommend the "key"-value which was set in 
aField1("Item"...)   

Whatever, as i mentioned it worked for a Number of 100000 Items.  But if 
there are 1 million items the indexing crash after a while with

Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
        at java.util.HashMap.resize(HashMap.java:462)
        at java.util.HashMap.addEntry(HashMap.java:755)
        at java.util.HashMap.put(HashMap.java:385)
        at java.util.HashSet.add(HashSet.java:200)
        at org.apache.lucene.index.DocInverter.flush(DocInverter.java:66)
        at 
org.apache.lucene.index.DocFieldConsumers.flush(DocFieldConsumers.java:75)
        at 
org.apache.lucene.index.DocFieldProcessor.flush(DocFieldProcessor.java:60)
        at 
org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:574)
        at 
org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:3540)
        at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:3450)
        at 
org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1937)
        at 
org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1895)

if I increase the Java heap space there will be a "OutOfMemoryError: 
/PermGen space" /Exception.
If I increase the PermGen Space -XX:MaxPermSize=1024m the Java heap 
space is still the limiting factor.
I can increase both to the maximum of my system  - 20Gbyte Ram are 
available - but this doesn't solve the problem.

Through indexing the ram-memory consumtion growing steadily until it 
chrashes. It does not matter if I index the data in segments with open 
and close each time the IndexWriter or if I optimize the index 
periodically - the ram-memory consumtion is still growing ...

I think the problem is, that I can't reuse the field aField for my 
approach and it seems the GC doesn't collect it. Extrapolated thats 600 
Million unique fields...

I'm using lucene 2.4.1 and java version "1.6.0_16".

Do anyone have an idea to avoid the growing memory. Or do somebody know 
an other approche for a "realtime Item based Recommender" with Lucene?

Regards

Thomas

-- 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42380-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 14:23:15 2009
Return-Path: <java-user-return-42380-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61136 invoked from network); 16 Sep 2009 14:23:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 14:23:15 -0000
Received: (qmail 91688 invoked by uid 500); 16 Sep 2009 14:23:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91657 invoked by uid 500); 16 Sep 2009 14:23:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91647 invoked by uid 99); 16 Sep 2009 14:23:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 14:23:12 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.178] (HELO mail-yw0-f178.google.com) (209.85.211.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 14:23:01 +0000
Received: by ywh8 with SMTP id 8so8051512ywh.14
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 07:22:40 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.150.63.16 with SMTP id l16mr14815976yba.12.1253110612331; Wed, 
	16 Sep 2009 07:16:52 -0700 (PDT)
In-Reply-To: <5381b58f0909160614m385d0c1bt2d59e8f249c46018@mail.gmail.com>
References: <5381b58f0909160525r6564201frdc8ec31a845b5fc@mail.gmail.com>
	 <4AB116EC.90104@gmail.com>
	 <5381b58f0909160614m385d0c1bt2d59e8f249c46018@mail.gmail.com>
Date: Wed, 16 Sep 2009 10:16:52 -0400
Message-ID: <9ac0c6aa0909160716j15bdf715i580946374a000a25@mail.gmail.com>
Subject: Re: What would be the fastest BooleanQuery possible?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

You could get the Scorer and call next() yourself; this would avoid
scoring.  EG something like this:

      Weight weight = query.weight(searcher);
      Scorer scorer = weight.scorer(searcher.getIndexReader());
      while(scorer.next()) {
        final int docID = scorer.doc();
        /* do something w/ docID */
      }

But note that this code is not generally recommended in 2.9 (since
it's not operating at the segment level).

If your queries contain only SHOULD and up to 32 MUST_NOT clauses,
then calling BooleanQuery.setAllowDocsOutOfOrder should improve
performance since internally it will use BooleanScorer instead of
BooleanScorer2.

Mike

On Wed, Sep 16, 2009 at 9:14 AM, Benjamin Pasero
<benjamin.pasero@gmail.com> wrote:
> Ah wow that sounds great. I am using 2.3.2 though (and have to use it
> for now). Anything
> in that version that could speed things up?
>
> On Wed, Sep 16, 2009 at 6:48 PM, Mark Miller <markrmiller@gmail.com> wrote:
>> With the new Collector API in Lucene 2.9, you no longer have to compute the
>> score.
>>
>> Now a Collector is passed a Scorer if they want to use it, but you can
>> just ignore it.
>>
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>
>> Benjamin Pasero wrote:
>>> Hi,
>>>
>>> I am using Lucene not only for smart fulltext searches but also for
>>> getting the results for a DB-like query, where I am not tokenizing the
>>> terms at all. For this query, I am interested in all results and for
>>> that
>>> I am using my own HitCollector.
>>>
>>> Now, while profiling I noticed that quite some time is spent in
>>> methods like TermQuery.weight() or BooleanScorer2.score(). Given that
>>> I am interested in all results, I am not interested in any score for
>>> the
>>> results.
>>>
>>> Is it possible to run a query where Lucene simply checks if a Document
>>> is a hit or not and completly ignore weighting and scoring? Or is that
>>> an integrated part of the search used to determine if a Document
>>> is a hit or not?
>>>
>>> Thanks for helping,
>>> Ben
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42381-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 14:34:12 2009
Return-Path: <java-user-return-42381-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65252 invoked from network); 16 Sep 2009 14:34:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 14:34:11 -0000
Received: (qmail 21769 invoked by uid 500); 16 Sep 2009 14:34:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21696 invoked by uid 500); 16 Sep 2009 14:34:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21686 invoked by uid 99); 16 Sep 2009 14:34:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 14:34:09 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [132.204.246.20] (HELO chene.dit.umontreal.ca) (132.204.246.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 14:33:57 +0000
Received: from gw-mail.lexum.umontreal.ca (gw-mail.lexum.umontreal.ca [132.204.136.52])
	by chene.dit.umontreal.ca (8.14.1/8.14.1) with ESMTP id n8GEXW1t027700
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 10:33:33 -0400
Received: from [192.168.4.150] (siracusa.lan.lexum.pri [::ffff:192.168.4.150])
  (AUTH: PLAIN shaned, SSL: TLSv1/SSLv3,256bits,AES256-SHA)
  by gw-mail.lexum.umontreal.ca with esmtp; Wed, 16 Sep 2009 10:33:32 -0400
  id 000273A5.4AB0F73C.00003399
Message-ID: <4AB0F73C.5070203@lexum.umontreal.ca>
Date: Wed, 16 Sep 2009 10:33:32 -0400
From: Daniel Shane <shaned@LEXUM.UMontreal.CA>
User-Agent: Thunderbird 2.0.0.19 (X11/20081216)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Run your Lucene Applications on Google AppEngine with GAELucene
References: <309714.59761.qm@web111503.mail.gq1.yahoo.com> <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com>
In-Reply-To: <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-NAI-Spam-Score: 0
X-NAI-Spam-Rules: 1 Rules triggered
	RV3363=0
X-Virus-Checked: Checked by ClamAV on apache.org

I question the performance of such an approach. For lucene to be fast, 
disk access need to be fast, and the transaction stuff with google is 
not that good.

I'll have to test it out to see, but I anticipate a huge performance hit 
compared to lucene running with a real HDD access.

Daniel Shane

Allahbaksh Mohammedali Asadullah wrote:
> Hi,
> This is great news and good work. I think I will try this today evening. I think we should put this as one of component in lucene-contrib. What do you say? Committer and owner please comment.
> Regards,
> Allahbaksh
>  
>  
>  
> -----Original Message-----
> From: Kerang Lv [mailto:lvkrnewer@yahoo.com] 
> Sent: Monday, September 14, 2009 9:34 PM
> To: java-user@lucene.apache.org
> Subject: Run your Lucene Applications on Google AppEngine with GAELucene
>
> Hi Lucene users,
>
> Enlightened by the discussion "Can I run Lucene in google app engine? [http://www.nabble.com/Can-I-run-Lucene-in-google-app-engine--td23017742.html], I implemented a google datastore based Lucene component, GAELucene, which can help you to run search applications on google app engine.
>
> The main clazz of GAELucene include: 
>     * GAEDirectory - a read only Directory based on google datastore. 
>     * GAEFile - stands for an index file, the file's byte content will be splited into multi GAEFileContent. 
>     * GAEFileContent - stands for a segment of index file. 
>     * GAECategory - the identifier of different indices. 
>     * GAEIndexInput - a memory-resident IndexInput? implementation like the RAMInputStream. 
>     * GAEIndexReader - wrapper for IndexReader? that cached in GAEIndexReaderPool 
>     * GAEIndexReaderPool - pool for GAEIndexReader 
>
> The following code snippet demonstrates the use of GAELucene do searching: 
>   Query queryObject = parserQuery(request);
>   GAEIndexReaderPool readerPool =GAEIndexReaderPool.getInstance();
>   GAEIndexReader indexReader = readerPool.borrowReader(INDEX_CATEGORY_DEMO);
>   IndexSearcher searcher =newIndexSearcher(indexReader);
>   Hits hits = searcher.search(queryObject);
>   readerPool.returnReader(indexReader);
>
> You can find morere 'http://code.google.com/p/gaelucene/'
>
>
>
>       
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42382-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 14:57:01 2009
Return-Path: <java-user-return-42382-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71837 invoked from network); 16 Sep 2009 14:57:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 14:57:01 -0000
Received: (qmail 80476 invoked by uid 500); 16 Sep 2009 14:56:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80395 invoked by uid 500); 16 Sep 2009 14:56:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80385 invoked by uid 99); 16 Sep 2009 14:56:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 14:56:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of benjamin.pasero@gmail.com designates 209.85.132.251 as permitted sender)
Received: from [209.85.132.251] (HELO an-out-0708.google.com) (209.85.132.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 14:56:46 +0000
Received: by an-out-0708.google.com with SMTP id b2so1829923ana.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 07:56:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=RH8A4BWkUFl84aCGgHoMxbMAoB13CUnIhObKhePgJ04=;
        b=j+9uvdBquV1Pam7sNdK3eta+YNSScCvfgJfX7vq8M4JFGz4vIUAca4xmJaiY914u3h
         gQDdZvGIe0IZJ7eQhPZUtJ1O+pevu1CiCyn6iCp8K5weEmTDJr1edowK0Kid8Y4GR5iN
         F9BlB5h7BJ+WSkTCXOjwMcirGvuvHl3vCPkhY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=DOlF72rCab3fALVNEgZ4MCzNkzOXYYuRTBmDW6GayQj/B7xM+k9lmavzgeBf/hgEjw
         lG9nRWvrvj5c6EwDMYENxv5ZGnrKYTi8ZWtLdY2KZFanVbpQ4Sx74XqADLBdJs/E5e+M
         Ve311qm/GrIhT4kBW8WZHKc3JyktIUow85Zww=
MIME-Version: 1.0
Received: by 10.101.95.3 with SMTP id x3mr9063113anl.112.1253112611124; Wed, 
	16 Sep 2009 07:50:11 -0700 (PDT)
In-Reply-To: <9ac0c6aa0909160716j15bdf715i580946374a000a25@mail.gmail.com>
References: <5381b58f0909160525r6564201frdc8ec31a845b5fc@mail.gmail.com>
	 <4AB116EC.90104@gmail.com>
	 <5381b58f0909160614m385d0c1bt2d59e8f249c46018@mail.gmail.com>
	 <9ac0c6aa0909160716j15bdf715i580946374a000a25@mail.gmail.com>
Date: Wed, 16 Sep 2009 16:50:11 +0200
Message-ID: <5381b58f0909160750w29fc8c27o2ca8d90fff29ca0@mail.gmail.com>
Subject: Re: What would be the fastest BooleanQuery possible?
From: Benjamin Pasero <benjamin.pasero@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks, I tried this but profiling showed me that I get similar
results. Most time is spent in
- BooleanQuery.createWeight()
- BooleanScorer.next()

If I am not interested in scores, do I still need the heavy weight computat=
ion?

On Wed, Sep 16, 2009 at 4:16 PM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> You could get the Scorer and call next() yourself; this would avoid
> scoring. =A0EG something like this:
>
> =A0 =A0 =A0Weight weight =3D query.weight(searcher);
> =A0 =A0 =A0Scorer scorer =3D weight.scorer(searcher.getIndexReader());
> =A0 =A0 =A0while(scorer.next()) {
> =A0 =A0 =A0 =A0final int docID =3D scorer.doc();
> =A0 =A0 =A0 =A0/* do something w/ docID */
> =A0 =A0 =A0}
>
> But note that this code is not generally recommended in 2.9 (since
> it's not operating at the segment level).
>
> If your queries contain only SHOULD and up to 32 MUST_NOT clauses,
> then calling BooleanQuery.setAllowDocsOutOfOrder should improve
> performance since internally it will use BooleanScorer instead of
> BooleanScorer2.
>
> Mike
>
> On Wed, Sep 16, 2009 at 9:14 AM, Benjamin Pasero
> <benjamin.pasero@gmail.com> wrote:
>> Ah wow that sounds great. I am using 2.3.2 though (and have to use it
>> for now). Anything
>> in that version that could speed things up?
>>
>> On Wed, Sep 16, 2009 at 6:48 PM, Mark Miller <markrmiller@gmail.com> wro=
te:
>>> With the new Collector API in Lucene 2.9, you no longer have to compute=
 the
>>> score.
>>>
>>> Now a Collector is passed a Scorer if they want to use it, but you can
>>> just ignore it.
>>>
>>> --
>>> - Mark
>>>
>>> http://www.lucidimagination.com
>>>
>>>
>>>
>>> Benjamin Pasero wrote:
>>>> Hi,
>>>>
>>>> I am using Lucene not only for smart fulltext searches but also for
>>>> getting the results for a DB-like query, where I am not tokenizing the
>>>> terms at all. For this query, I am interested in all results and for
>>>> that
>>>> I am using my own HitCollector.
>>>>
>>>> Now, while profiling I noticed that quite some time is spent in
>>>> methods like TermQuery.weight() or BooleanScorer2.score(). Given that
>>>> I am interested in all results, I am not interested in any score for
>>>> the
>>>> results.
>>>>
>>>> Is it possible to run a query where Lucene simply checks if a Document
>>>> is a hit or not and completly ignore weighting and scoring? Or is that
>>>> an integrated part of the search used to determine if a Document
>>>> is a hit or not?
>>>>
>>>> Thanks for helping,
>>>> Ben
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42383-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 15:01:08 2009
Return-Path: <java-user-return-42383-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73827 invoked from network); 16 Sep 2009 15:01:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 15:01:08 -0000
Received: (qmail 95989 invoked by uid 500); 16 Sep 2009 15:01:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95955 invoked by uid 500); 16 Sep 2009 15:01:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95945 invoked by uid 99); 16 Sep 2009 15:01:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 15:01:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [67.195.15.145] (HELO web111503.mail.gq1.yahoo.com) (67.195.15.145)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 16 Sep 2009 15:00:53 +0000
Received: (qmail 36423 invoked by uid 60001); 16 Sep 2009 14:53:51 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253112831; bh=Mvf6kmqRE+uyuCP0QpC1NPA9ICjNYmw0cjf9SSr81H0=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=OMiQHPgyZlpK129kFg7ojE+htw4u3NvBBR42RDHj+cAx01SchMHg3YO8+47yBVLDBcBBHTkxCSstVABrKgcAT8PnD3V/BZAT6oU0y13jvtnO1Zdh1y5TEw3Vln4cWfQe39PY/v0PAv7kIU3sNv9hfNeg07TyUjAFtR9v3j5gAHM=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=M9rt/Imo4mV1Jzv7DyIusQloE8tUsehPUL9hT+U56XtoDnuFe7sdfNlxlmbCIPXKltIK2JYeDVsRKHpy9hUx0/fW/7x6a8nbct+o6qq3KvmvqzsmxW0czVTyRCTKRp681VPRoTcKCYFvRAoR1YtoEgAu9qVltBLOrT9qr/LuAvg=;
Message-ID: <858798.36281.qm@web111503.mail.gq1.yahoo.com>
X-YMail-OSG: JyWjXOIVM1k.x1WW9HIdXMV7jGLc4cPvCZE.vlpL6oq3sVBhrmZIejennH4YShOdgbfDztGU1kHzMf0SB6nXGojWvYli9G7ZzVlHZevpBihZ6vQQ4UO1twIsMMnHXeQt7nJ6.AbZOZPTnOBo_e9bn9_zaaZol6JLf4Gr2Io3M6dQT2QdRdYwBKxgtLdkALM8MBFzwEsLYyhPNuBNByoC3K12u9xlpezsAo6BiFz0A.raPclNOTBf6ReSXpBBRDknvYDMr5WUqGdlQHAMIbvD3G86ubgWZz6ZERjQOQ4QFusYhKzpCGvD
Received: from [123.119.68.88] by web111503.mail.gq1.yahoo.com via HTTP; Wed, 16 Sep 2009 07:53:51 PDT
X-Mailer: YahooMailRC/1358.27 YahooMailWebService/0.7.347.2
References: <309714.59761.qm@web111503.mail.gq1.yahoo.com> <68959F25CDEBCB4F917D5A253291D73E0EFC2F6F85@BLRKECMBX06.ad.infosys.com> <4AB0F73C.5070203@lexum.umontreal.ca>
Date: Wed, 16 Sep 2009 07:53:51 -0700 (PDT)
From: Kerang Lv <lvkrnewer@yahoo.com>
Subject: Re: Run your Lucene Applications on Google AppEngine with GAELucene
To: java-user@lucene.apache.org
In-Reply-To: <4AB0F73C.5070203@lexum.umontreal.ca>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Daniel Shane,=0A=0AThe GAEFile/GAEIndexInput was a bit like the RAMFile/=
RAMInputStream, it can hold the file's byte data in memory, so the performa=
nce should be acceptable once most file segments were loaded from the googl=
e datastore.=0A=0AWish your test result.=0A=0A=0A----- Original Message ---=
-=0AFrom: Daniel Shane <shaned@LEXUM.UMontreal.CA>=0ATo: java-user@lucene.a=
pache.org=0ASent: Wednesday, September 16, 2009 10:33:32 PM=0ASubject: Re: =
Run your Lucene Applications on Google AppEngine with GAELucene=0A=0AI ques=
tion the performance of such an approach. For lucene to be fast, disk acces=
s need to be fast, and the transaction stuff with google is not that good.=
=0A=0AI'll have to test it out to see, but I anticipate a huge performance =
hit compared to lucene running with a real HDD access.=0A=0ADaniel Shane=0A=
=0AAllahbaksh Mohammedali Asadullah wrote:=0A> Hi,=0A> This is great news a=
nd good work. I think I will try this today evening. I think we should put =
this as one of component in lucene-contrib. What do you say? Committer and =
owner please comment.=0A> Regards,=0A> Allahbaksh=0A>=A0 =A0 -----Original =
Message-----=0A> From: Kerang Lv [mailto:lvkrnewer@yahoo.com] Sent: Monday,=
 September 14, 2009 9:34 PM=0A> To: java-user@lucene.apache.org=0A> Subject=
: Run your Lucene Applications on Google AppEngine with GAELucene=0A> =0A> =
Hi Lucene users,=0A> =0A> Enlightened by the discussion "Can I run Lucene i=
n google app engine? [http://www.nabble.com/Can-I-run-Lucene-in-google-app-=
engine--td23017742.html], I implemented a google datastore based Lucene com=
ponent, GAELucene, which can help you to run search applications on google =
app engine.=0A> =0A> The main clazz of GAELucene include:=A0 =A0 * GAEDirec=
tory - a read only Directory based on google datastore.=A0 =A0 * GAEFile - =
stands for an index file, the file's byte content will be splited into mult=
i GAEFileContent.=A0 =A0 * GAEFileContent - stands for a segment of index f=
ile.=A0 =A0 * GAECategory - the identifier of different indices.=A0 =A0 * G=
AEIndexInput - a memory-resident IndexInput? implementation like the RAMInp=
utStream.=A0 =A0 * GAEIndexReader - wrapper for IndexReader? that cached in=
 GAEIndexReaderPool=A0 =A0 * GAEIndexReaderPool - pool for GAEIndexReader =
=0A> The following code snippet demonstrates the use of GAELucene do search=
ing:=A0 Query queryObject =3D parserQuery(request);=0A>=A0 GAEIndexReaderPo=
ol readerPool =3DGAEIndexReaderPool.getInstance();=0A>=A0 GAEIndexReader in=
dexReader =3D readerPool.borrowReader(INDEX_CATEGORY_DEMO);=0A>=A0 IndexSea=
rcher searcher =3DnewIndexSearcher(indexReader);=0A>=A0 Hits hits =3D searc=
her.search(queryObject);=0A>=A0 readerPool.returnReader(indexReader);=0A> =
=0A> You can find morere 'http://code.google.com/p/gaelucene/'=0A> =0A> =0A=
> =0A>=A0 =A0 =A0 =0A> ----------------------------------------------------=
-----------------=0A> To unsubscribe, e-mail: java-user-unsubscribe@lucene.=
apache.org=0A> For additional commands, e-mail: java-user-help@lucene.apach=
e.org=0A> =0A> =0A> -------------------------------------------------------=
--------------=0A> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apa=
che.org=0A> For additional commands, e-mail: java-user-help@lucene.apache.o=
rg=0A> =0A>=A0 =0A=0A=0A---------------------------------------------------=
------------------=0ATo unsubscribe, e-mail: java-user-unsubscribe@lucene.a=
pache.org=0AFor additional commands, e-mail: java-user-help@lucene.apache.o=
rg=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42384-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 15:06:44 2009
Return-Path: <java-user-return-42384-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76203 invoked from network); 16 Sep 2009 15:06:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 15:06:43 -0000
Received: (qmail 9422 invoked by uid 500); 16 Sep 2009 15:06:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9376 invoked by uid 500); 16 Sep 2009 15:06:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9366 invoked by uid 99); 16 Sep 2009 15:06:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 15:06:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 15:06:29 +0000
Received: from tbeckers-MacBook.local (dslb-084-062-025-139.pools.arcor-ip.net [84.62.25.139])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8GF63ra001455
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 17:06:04 +0200
Message-ID: <4AB0FEDB.50504@net-m.de>
Date: Wed, 16 Sep 2009 17:06:03 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com>
In-Reply-To: <4AAFB62E.10403@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Wed, 16 Sep 2009 17:06:05 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9810/Wed Sep 16 14:06:23 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Spam-Level: _TESTSCORES(,)_
X-Spam-Checker-Version: SpamAssassin 3.2.4-netm20061016 on extranet1.net-m.de
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-100.7 required=5.0 version=3.2.4-netm20061016

Tests run on tmpfs:
config: impl=SeparateFile serial=false nThreads=4 iterations=100 bufsize=1024
poolsize=2 filelen=18920301
answer=850258539, ms=8090, MB/sec=935.4907787391842
config: impl=ChannelFile serial=false nThreads=4 iterations=100 bufsize=1024
poolsize=2 filelen=18920301
answer=850258903, ms=39444, MB/sec=191.8700030422878
config: impl=ChannelPread serial=false nThreads=4 iterations=100 bufsize=1024
poolsize=2 filelen=18920301
answer=850258903, ms=8504, MB/sec=889.9483066792098
config: impl=PooledPread serial=false nThreads=4 iterations=100 bufsize=1024
poolsize=2 filelen=18920301
answer=850258903, ms=9585, MB/sec=789.5795931142409

I did run some tests now with SimpleFSDirectory and MMapDirectory. Both are
faster than NIOFS and the response times improved. But it's still slower than 2.4.

I'll do some profiling now again and let you know the results.

Thanks again for all the great support to all who've answered.


Mark Miller wrote:
> Can you run the following test on your RAMDISK?
> 
> http://people.apache.org/~markrmiller/FileReadTest.java
> 
> I've taken it from the following issue (in which NIOFSDirectory was
> developed):
> https://issues.apache.org/jira/browse/LUCENE-753
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42385-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 15:06:47 2009
Return-Path: <java-user-return-42385-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76257 invoked from network); 16 Sep 2009 15:06:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 15:06:47 -0000
Received: (qmail 11122 invoked by uid 500); 16 Sep 2009 15:06:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11085 invoked by uid 500); 16 Sep 2009 15:06:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11075 invoked by uid 99); 16 Sep 2009 15:06:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 15:06:44 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.177] (HELO homiemail-a13.g.dreamhost.com) (208.97.132.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 15:06:32 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by homiemail-a13.g.dreamhost.com (Postfix) with ESMTPA id 3E8D76A8073
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 08:06:10 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1076)
Subject: Re: Problems with ItemBasedRecommender with Lucene
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <4AB0EC9D.3050002@mufin.com>
Date: Wed, 16 Sep 2009 11:06:09 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <4001AD6D-7371-4508-AD4B-C0E6BC92D799@apache.org>
References: <4AB0EC9D.3050002@mufin.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1076)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 16, 2009, at 9:48 AM, Thomas Rewig wrote:

> Hello,
>
> I build a "real time ItemBasedRecommender" based on a users history  
> and a (sparse) item similarity matrix with lucene. Some time ago Ted  
> Dunning recommended me this approach at the mahout mailing list to  
> create a ItemBasedRecommender:
>
> "It is actually very easy to do. The output of the recommendation  
> off-line process is generally a sparse matrix of item-item links.  
> Each line of this sparse matrix can be considered a document in  
> creating a Lucene index. You will have to use a correct analyzer and  
> a line by line document segmenter, but that is trivial. Then  
> recommendation is a simple query step."
>
> So for 100000 items it works fine - but for 1 million items the  
> Indexing fails and I have no idea how to avoid this. Maybe you can  
> give me a hint.
>
> First I create a Item-Item-Similaritymatrix with mahout's taste and  
> in the second step I index it. The matrix is sparce because only  
> Item-Item-Relations with a high correlation will be saved.
>
> Here are the Code Snippets for this indexing :
>           CachedRowSetImpl rowSetMainItemList = null; // Mapping of  
> Items
>       ArrayList<String> listBelongingItems = null; // Belonging and  
> highest correlating Items for a MainItem
>       Document aDocument = null;
>       Field aField = null;
>       Field aField1 = null;
>             Analyzer aAnalyzer  = new StandardAnalyzer();
>       IndexWriter aWriter = new IndexWriter(this.indexDirectory,  
> aAnalyzer, true, IndexWriter.MaxFieldLength.UNLIMITED);
>             aWriter.setRAMBufferSizeMB(48);
>             rowSetMainItemList = getRowSetItemList(); //get all Items
>             aField1 = new Field("Item1", "",  
> Field.Store.YES,Field.Index.ANALYZED); // reuse this field
>             while (rowSetMainItemList.next()){
>                         aDocument = new Document();
>                             aField1.setValue 
> (rowSetMainItemList.getString(1));              aDocument.add 
> (aField1);
>                     listBelongingItems = getRowSetBelongingItems 
> (rowSetMainItemList.getString(1)); // get the most similar Items fpr  
> a Item
>           Iterator<String> itrBelongingItems =  
> listBelongingItems.iterator();
>                         while (itrBelongingItems.hasNext()){
>                                 String strBelongingItem = (String)  
> itrBelongingItems.next();
>               //No reuse of Field possible because of different  
> fieldnames:
>               aField = new Field(strBelongingItem,"1",  
> Field.Store.NO,Field.Index.ANALYZED_NO_NORMS);
>               aDocument.add(aField);
>           }
>                         aWriter.addDocument 
> (aDocument);                        }
>             aWriter.optimize();
>       aWriter.close();
>                 aAnalyzer.close();
>              Actually the Field of the BelongingItem have to be  
> boosted with the MainItem-BelongingItem-Correlation-Value to get  
> accurate Recommendations, but here the Index would be about 80 GByte  
> for 6 million items... without it will only be about 2Gbyte.
> But under the condition that only relevant Correlations will be  
> saved in the Similaritymatrix the recommendation quality will be  
> good enough.
>
> The item recommendation for a User is a simple BooleanQuery with  
> userhistory boosted TermQuerys. Here I search for documents with the  
> largest Correspondence regarding the userhistory.  So I  look in  
> which Documents the most Fields with the name of a BelongingItem are  
> set (with value 1) and recommend the "key"-value which was set in  
> aField1("Item"...)
> Whatever, as i mentioned it worked for a Number of 100000 Items.   
> But if there are 1 million items the indexing crash after a while with
>
> Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
>       at java.util.HashMap.resize(HashMap.java:462)
>       at java.util.HashMap.addEntry(HashMap.java:755)
>       at java.util.HashMap.put(HashMap.java:385)
>       at java.util.HashSet.add(HashSet.java:200)
>       at org.apache.lucene.index.DocInverter.flush(DocInverter.java: 
> 66)
>       at org.apache.lucene.index.DocFieldConsumers.flush 
> (DocFieldConsumers.java:75)
>       at org.apache.lucene.index.DocFieldProcessor.flush 
> (DocFieldProcessor.java:60)
>       at org.apache.lucene.index.DocumentsWriter.flush 
> (DocumentsWriter.java:574)
>       at org.apache.lucene.index.IndexWriter.doFlush 
> (IndexWriter.java:3540)
>       at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java: 
> 3450)
>       at org.apache.lucene.index.IndexWriter.addDocument 
> (IndexWriter.java:1937)
>       at org.apache.lucene.index.IndexWriter.addDocument 
> (IndexWriter.java:1895)
>
> if I increase the Java heap space there will be a  
> "OutOfMemoryError: /PermGen space" /Exception.
> If I increase the PermGen Space -XX:MaxPermSize=1024m the Java heap  
> space is still the limiting factor.
> I can increase both to the maximum of my system  - 20Gbyte Ram are  
> available - but this doesn't solve the problem.
>
> Through indexing the ram-memory consumtion growing steadily until it  
> chrashes. It does not matter if I index the data in segments with  
> open and close each time the IndexWriter or if I optimize the index  
> periodically - the ram-memory consumtion is still growing ...
>
> I think the problem is, that I can't reuse the field aField for my  
> approach and it seems the GC doesn't collect it. Extrapolated thats  
> 600 Million unique fields...
>
> I'm using lucene 2.4.1 and java version "1.6.0_16".
>
> Do anyone have an idea to avoid the growing memory. Or do somebody  
> know an other approche for a "realtime Item based Recommender" with  
> Lucene?

You might want to ask on mahout-user, but I'm guessing Ted didn't mean  
a new field for every item-item, but instead to represent them as  
tokens and then create the corresponding appropriate queries (seems  
like payloads may be useful, or function queries).  That to me is the  
only way you would achieve the sparseness savings you are after.

-Grant

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42386-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:11:23 2009
Return-Path: <java-user-return-42386-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98707 invoked from network); 16 Sep 2009 16:11:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:11:23 -0000
Received: (qmail 64308 invoked by uid 500); 16 Sep 2009 16:11:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64249 invoked by uid 500); 16 Sep 2009 16:11:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64239 invoked by uid 99); 16 Sep 2009 16:11:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:11:20 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:11:11 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n8GGAlQo012186
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 17:10:48 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.5.0.13266)
    via ESMTP; Wed, 16 Sep 2009 17:10:47 +0100 (BST)
Date: Wed, 16 Sep 2009 17:10:47 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <1106853926.351253117447482.JavaMail.root@mail.uk.scalix.com>
Subject: RE: New "Stream closed" exception with Java 6 - solved
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Hoss,

It turns out that the cause of the exceptions is in fact adding an item twice - so you were correct right at the start  :-)  I ran a test where I attempt to insert the same item twice and guess what ...  I get a "Stream closed" exception on the 2nd attempt.
Understanding this is a great relief as it means my code structure is OK - I just wasn't handling duplicate requests adequately.

Just a minor point: isn't Lucence in a position to detect the duplicate insertion attempt and flag it with something less vague than "Stream closed"?  :-)

Anyway thanks to you, Mark and Grant for all your help on this - much appreciated.

- Chris

----- Original Message -----
From: Chris Hostetter <hossman_lucene@fucit.org>
Sent: Tue, 15/9/2009 6:37pm
To: java-user@lucene.apache.org
Subject: RE: New "Stream closed" exception with Java 6

: "it's possibly you just have a simple bug where you are  closing the reader before you pass it to Lucene, 
: 
:       or maybe you are mistakenly adding the same field twice
: 
: (or in two different documents)"
: 
: Are you saying that if I were attempting to delete a doc and then add it 
: again (e.g. update), but for some reason the delete didn't work, I would 
: get a "Stream closed" exception?

Uh... no.  I didn't say anything about delets, or updates.  I'm talking 
about the java.io.Reader class.  AS i recall (not looking at it right now) 
Your stack trace showed that when lucene tried to access a an 
InputStreamReader from a Field in your document it was already closed.  
that could happen if you did something like this...

   File myFileOnDisk = new File(path);
   Reader fileContents = new InputStreamReader(new FileInputStream(myFileOnDisk));
   fileContents.close();
   doc.addField(new Field("field name", fileContents));

...but there are lots of other ways it could happen too, it's impossible 
to list all the ways it might happen without knowing where exactly that 
InputStreamReader is coming from, and where the underlying INputStream 
is coming from, and what code has refrences to either of them between the 
time it's created and the time Lucene finally attempts to read from it.

: careful about your assumptions ... you could get this same type of 
: exception even with only one thread, the stream that's being closed isn't 
: internal to Lucene, it's the InputStreamReader you supplied as the value 
: of some Field.  it's possibly you just have a simple bug where you are 
: closing hte reader before you pass it to Lucene, or maybe you are 
: mistakenly adding the saame field twice (or in two different documents)



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42387-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:23:38 2009
Return-Path: <java-user-return-42387-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1917 invoked from network); 16 Sep 2009 16:23:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:23:38 -0000
Received: (qmail 91293 invoked by uid 500); 16 Sep 2009 16:23:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91247 invoked by uid 500); 16 Sep 2009 16:23:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91236 invoked by uid 99); 16 Sep 2009 16:23:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:23:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:23:22 +0000
Received: by fxm18 with SMTP id 18so4173050fxm.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 09:23:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=4KJAnxQokYYXdrYXHFiyIAi3bK8ksxZy3ObAMtM52es=;
        b=oYpGA5EbKIQR2T+MamYarBJcr30EI/i6CNlHcaL9ozzHlhohDCOshe0FeihOu4RCXz
         ampi2R7FdXHdI8wGDVJKFzSkZL6fUViIUoBZ5K5yUfk9XTUWBwr4hReI/c27nq3k1LAy
         9vuJ2aCy+ppahhfVEkK2m3qmks+OAYwBdwnNw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=VmzmsrXpPQQH8koV+VAViLq5ky6BIaMnCYk+aepvkY14DZsyyya76V2RrTreJmEnoZ
         vf6Jwc3qu9jrKU09V+QldlYWrDd7RMVzN0l6H58bopANXBXojqRpYMtbWxlmARjCUlVW
         fgneC7SCKE1zfFuraw2wbO1oLuUtSN6OS1h9A=
Received: by 10.86.231.13 with SMTP id d13mr7541318fgh.41.1253118182100;
        Wed, 16 Sep 2009 09:23:02 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e20sm2594677fga.5.2009.09.16.09.23.00
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 09:23:01 -0700 (PDT)
Message-ID: <4AB110E3.6040004@gmail.com>
Date: Wed, 16 Sep 2009 12:22:59 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de>
In-Reply-To: <4AB0FEDB.50504@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

bq. I'll do some profiling now again and let you know the results.

Great - it will be interesting to see the results. My guess, based on
the 2.9 new api profiling, is that your queries may not be agreeing with
some of the changes somehow. Along with the profiling, can you fill us
in on the query types you are using as well? (eg qualities)

And grab invocations if its possible.

-- 
- Mark

http://www.lucidimagination.com



Thomas Becker wrote:
> Tests run on tmpfs:
> config: impl=SeparateFile serial=false nThreads=4 iterations=100 bufsize=1024
> poolsize=2 filelen=18920301
> answer=850258539, ms=8090, MB/sec=935.4907787391842
> config: impl=ChannelFile serial=false nThreads=4 iterations=100 bufsize=1024
> poolsize=2 filelen=18920301
> answer=850258903, ms=39444, MB/sec=191.8700030422878
> config: impl=ChannelPread serial=false nThreads=4 iterations=100 bufsize=1024
> poolsize=2 filelen=18920301
> answer=850258903, ms=8504, MB/sec=889.9483066792098
> config: impl=PooledPread serial=false nThreads=4 iterations=100 bufsize=1024
> poolsize=2 filelen=18920301
> answer=850258903, ms=9585, MB/sec=789.5795931142409
>
> I did run some tests now with SimpleFSDirectory and MMapDirectory. Both are
> faster than NIOFS and the response times improved. But it's still slower than 2.4.
>
> I'll do some profiling now again and let you know the results.
>
> Thanks again for all the great support to all who've answered.
>
>
> Mark Miller wrote:
>   
>> Can you run the following test on your RAMDISK?
>>
>> http://people.apache.org/~markrmiller/FileReadTest.java
>>
>> I've taken it from the following issue (in which NIOFSDirectory was
>> developed):
>> https://issues.apache.org/jira/browse/LUCENE-753
>>
>>     
>
>   




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42388-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:32:05 2009
Return-Path: <java-user-return-42388-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3750 invoked from network); 16 Sep 2009 16:32:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:32:05 -0000
Received: (qmail 1420 invoked by uid 500); 16 Sep 2009 16:32:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1364 invoked by uid 500); 16 Sep 2009 16:32:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1354 invoked by uid 99); 16 Sep 2009 16:32:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:32:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:31:51 +0000
Received: from tbeckers-MacBook.local (dslb-084-062-025-139.pools.arcor-ip.net [84.62.25.139])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8GGVQxC012542
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:31:26 +0200
Message-ID: <4AB112D6.9010003@net-m.de>
Date: Wed, 16 Sep 2009 18:31:18 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com>
In-Reply-To: <4AB110E3.6040004@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Wed, 16 Sep 2009 18:31:26 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9810/Wed Sep 16 14:06:23 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Spam-Level: _TESTSCORES(,)_
X-Spam-Checker-Version: SpamAssassin 3.2.4-netm20061016 on extranet1.net-m.de
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-100.7 required=5.0 version=3.2.4-netm20061016

New Profiling sessions with invocation counts. A single lucene search request
with huge resultset (169k items).

Quite interesting results though and there's definetly something wrong with luc
2.9 and the way I'm using it. But see yourself:

http://ankeschwarzer.de/tmp/lucene_24_oldapi_singlereq.png
http://ankeschwarzer.de/tmp/lucene_29_oldapi_singlereq.png
and even worse:
http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png

Have to verify that the last one is not by accident more than one request. Will
do the run again and then post the required info.

Mark Miller wrote:
> bq. I'll do some profiling now again and let you know the results.
> 
> Great - it will be interesting to see the results. My guess, based on
> the 2.9 new api profiling, is that your queries may not be agreeing with
> some of the changes somehow. Along with the profiling, can you fill us
> in on the query types you are using as well? (eg qualities)
> 
> And grab invocations if its possible.
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42389-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:34:36 2009
Return-Path: <java-user-return-42389-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4534 invoked from network); 16 Sep 2009 16:34:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:34:36 -0000
Received: (qmail 9623 invoked by uid 500); 16 Sep 2009 16:34:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9563 invoked by uid 500); 16 Sep 2009 16:34:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9553 invoked by uid 99); 16 Sep 2009 16:34:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:34:33 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:34:21 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 3A2C3D36006
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:34:01 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id VMGsC4Mw4y0H for <java-user@lucene.apache.org>;
	Wed, 16 Sep 2009 18:33:51 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id CAC00D36004
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:33:50 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Wed, 16 Sep 2009 18:33:49 +0200
Message-ID: <C7281D64AA0F464394A823C942685090@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AB110E3.6040004@gmail.com>
Thread-Index: Aco26hU8IoczF6O7S4qcYkqua3yJtwAATMDQ
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

How should we proceed? Stop the final artifact build and voting or proceed
with the release of 2.9? We waited so long and for most people it is faster
than slower!

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Mark Miller [mailto:markrmiller@gmail.com]
> Sent: Wednesday, September 16, 2009 6:23 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
> 
> bq. I'll do some profiling now again and let you know the results.
> 
> Great - it will be interesting to see the results. My guess, based on
> the 2.9 new api profiling, is that your queries may not be agreeing with
> some of the changes somehow. Along with the profiling, can you fill us
> in on the query types you are using as well? (eg qualities)
> 
> And grab invocations if its possible.
> 
> --
> - Mark
> 
> http://www.lucidimagination.com
> 
> 
> 
> Thomas Becker wrote:
> > Tests run on tmpfs:
> > config: impl=SeparateFile serial=false nThreads=4 iterations=100
> bufsize=1024
> > poolsize=2 filelen=18920301
> > answer=850258539, ms=8090, MB/sec=935.4907787391842
> > config: impl=ChannelFile serial=false nThreads=4 iterations=100
> bufsize=1024
> > poolsize=2 filelen=18920301
> > answer=850258903, ms=39444, MB/sec=191.8700030422878
> > config: impl=ChannelPread serial=false nThreads=4 iterations=100
> bufsize=1024
> > poolsize=2 filelen=18920301
> > answer=850258903, ms=8504, MB/sec=889.9483066792098
> > config: impl=PooledPread serial=false nThreads=4 iterations=100
> bufsize=1024
> > poolsize=2 filelen=18920301
> > answer=850258903, ms=9585, MB/sec=789.5795931142409
> >
> > I did run some tests now with SimpleFSDirectory and MMapDirectory. Both
> are
> > faster than NIOFS and the response times improved. But it's still slower
> than 2.4.
> >
> > I'll do some profiling now again and let you know the results.
> >
> > Thanks again for all the great support to all who've answered.
> >
> >
> > Mark Miller wrote:
> >
> >> Can you run the following test on your RAMDISK?
> >>
> >> http://people.apache.org/~markrmiller/FileReadTest.java
> >>
> >> I've taken it from the following issue (in which NIOFSDirectory was
> >> developed):
> >> https://issues.apache.org/jira/browse/LUCENE-753
> >>
> >>
> >
> >
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42390-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:39:32 2009
Return-Path: <java-user-return-42390-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5873 invoked from network); 16 Sep 2009 16:39:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:39:32 -0000
Received: (qmail 19941 invoked by uid 500); 16 Sep 2009 16:39:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19882 invoked by uid 500); 16 Sep 2009 16:39:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19871 invoked by uid 99); 16 Sep 2009 16:39:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:39:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:39:17 +0000
Received: from tbeckers-MacBook.local (dslb-084-062-025-139.pools.arcor-ip.net [84.62.25.139])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8GGcbOJ013118
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:38:38 +0200
Message-ID: <4AB1148D.4050304@net-m.de>
Date: Wed, 16 Sep 2009 18:38:37 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <C7281D64AA0F464394A823C942685090@VEGA>
In-Reply-To: <C7281D64AA0F464394A823C942685090@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Wed, 16 Sep 2009 18:38:38 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9810/Wed Sep 16 14:06:23 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Spam-Level: _TESTSCORES(,)_
X-Spam-Checker-Version: SpamAssassin 3.2.4-netm20061016 on extranet1.net-m.de
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-100.7 required=5.0 version=3.2.4-netm20061016

I suggest to find the root cause and then decide about the release. Tomorrow I
will spent the whole working day on the issue if no prio1 pops up.

Sadly I've to leave early today, since I'm moving to a new flat... :(

Uwe Schindler wrote:
> How should we proceed? Stop the final artifact build and voting or proceed
> with the release of 2.9? We waited so long and for most people it is faster
> than slower!
> 
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
> 
> 
>> -----Original Message-----
>> From: Mark Miller [mailto:markrmiller@gmail.com]
>> Sent: Wednesday, September 16, 2009 6:23 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>
>> bq. I'll do some profiling now again and let you know the results.
>>
>> Great - it will be interesting to see the results. My guess, based on
>> the 2.9 new api profiling, is that your queries may not be agreeing with
>> some of the changes somehow. Along with the profiling, can you fill us
>> in on the query types you are using as well? (eg qualities)
>>
>> And grab invocations if its possible.
>>
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>
>> Thomas Becker wrote:
>>> Tests run on tmpfs:
>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>> bufsize=1024
>>> poolsize=2 filelen=18920301
>>> answer=850258539, ms=8090, MB/sec=935.4907787391842
>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>> bufsize=1024
>>> poolsize=2 filelen=18920301
>>> answer=850258903, ms=39444, MB/sec=191.8700030422878
>>> config: impl=ChannelPread serial=false nThreads=4 iterations=100
>> bufsize=1024
>>> poolsize=2 filelen=18920301
>>> answer=850258903, ms=8504, MB/sec=889.9483066792098
>>> config: impl=PooledPread serial=false nThreads=4 iterations=100
>> bufsize=1024
>>> poolsize=2 filelen=18920301
>>> answer=850258903, ms=9585, MB/sec=789.5795931142409
>>>
>>> I did run some tests now with SimpleFSDirectory and MMapDirectory. Both
>> are
>>> faster than NIOFS and the response times improved. But it's still slower
>> than 2.4.
>>> I'll do some profiling now again and let you know the results.
>>>
>>> Thanks again for all the great support to all who've answered.
>>>
>>>
>>> Mark Miller wrote:
>>>
>>>> Can you run the following test on your RAMDISK?
>>>>
>>>> http://people.apache.org/~markrmiller/FileReadTest.java
>>>>
>>>> I've taken it from the following issue (in which NIOFSDirectory was
>>>> developed):
>>>> https://issues.apache.org/jira/browse/LUCENE-753
>>>>
>>>>
>>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42391-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:44:52 2009
Return-Path: <java-user-return-42391-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7320 invoked from network); 16 Sep 2009 16:44:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:44:52 -0000
Received: (qmail 26107 invoked by uid 500); 16 Sep 2009 16:44:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26035 invoked by uid 500); 16 Sep 2009 16:44:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26025 invoked by uid 99); 16 Sep 2009 16:44:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:44:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:44:40 +0000
Received: by ewy28 with SMTP id 28so1348390ewy.28
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 09:44:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        bh=bDCuWc3vz8VH6fyOT2WzZzXOuCp+XjOEAQy1F8F4K2E=;
        b=sO1IVxE10JOKrpoFB7n41APL3R443DAFj+tQ8ofxfw3zuqZwdxsrmwWuzIPq0LGzDD
         EbkoiUaKN/Og8+JLSZBcPT5E6CyP84EfW5no5caXbxC3IeVgU8QaIzPNgEsikbMxIjC7
         LB/70OcpzrAyp2oaqiGgrplLYaKpl0hzF8MIs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=IU4X07KZfaDjdLWHLkCGGCV3BRRsO+yVALFKjTfAWTX0WYRsiLWVzBpJ6YGzJvNht7
         xX/zJjt62725k6XDBoJ2k5rfHk+GRMFIGmProFDkBhnUgBKdZcbVFWAzXkD/w26WuaDp
         oLktRsDpkMlBEiDzYLjJ+Jt1MD5BctlCaWM3U=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.216.51.7 with SMTP id a7mr1671450wec.193.1253119460226; Wed, 
	16 Sep 2009 09:44:20 -0700 (PDT)
In-Reply-To: <C7281D64AA0F464394A823C942685090@VEGA>
References: <4AAF96E6.7000909@net-m.de> <4AAFA800.5040600@net-m.de>
	 <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com>
	 <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com>
	 <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de>
	 <4AB110E3.6040004@gmail.com> <C7281D64AA0F464394A823C942685090@VEGA>
Date: Wed, 16 Sep 2009 12:44:20 -0400
X-Google-Sender-Auth: 720d37088870f084
Message-ID: <c68e39170909160944o7a93647cl7a70c551ae2cff8f@mail.gmail.com>
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Sep 16, 2009 at 12:33 PM, Uwe Schindler <uwe@thetaphi.de> wrote:
> How should we proceed? Stop the final artifact build and voting or proceed
> with the release of 2.9? We waited so long and for most people it is faster
> than slower!

I think we know that 2.9 will not be faster for everyone:
  - Per-segment searching and the new comparatores are a general win,
but will be slower for some people.
  - Query parsing and small document indexing will be somewhat slower
due to the new token APIs (the workarounds for back compatibility) if
token streams aren't reused.

I don't see any indication of any bugs in Lucene in this thread either.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42392-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:45:12 2009
Return-Path: <java-user-return-42392-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7420 invoked from network); 16 Sep 2009 16:45:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:45:12 -0000
Received: (qmail 27883 invoked by uid 500); 16 Sep 2009 16:45:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27796 invoked by uid 500); 16 Sep 2009 16:45:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27786 invoked by uid 99); 16 Sep 2009 16:45:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:45:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:44:57 +0000
Received: by fxm18 with SMTP id 18so4189038fxm.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 09:44:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=1oMLOe3ffAJzo6ldBLUoQmmaIPn8CFLy4LxmBvNs2Gs=;
        b=KsSfk47GQ+P7tLSbX5ilfWeBg+Qe2dg1ZMkYiF3hr8XmTJA+QrbkpDDhek9NBidI6t
         H5kC54vyShPE6VUSYRv38uoGNm+fXWTBUsQ5Tc1Q/gIyjiqesLr4rfAOoKEWwEApLWNv
         nVajvEWrbxF0gLZyi11hXo/OGBxlWyy3FUKr4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=DI1RaJUov/7brHMaHbvYRN70IT0LHNfo3TPIpi2eRzqcEdmjGrcAE7YGaUspiD8Yy0
         s8fz8cS3ZH/1sHMfx2+8bT57Tt+HZ9aSOyncsD/WsrWGAPsjrdc8gs/BYhmWZV1ofSXk
         3bIxteMwPrOT2tnFdsfj9FaSOdFTWLSToxP8I=
Received: by 10.86.230.27 with SMTP id c27mr7670405fgh.63.1253119476953;
        Wed, 16 Sep 2009 09:44:36 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e20sm61517fga.0.2009.09.16.09.44.35
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 09:44:36 -0700 (PDT)
Message-ID: <4AB115F2.2000701@gmail.com>
Date: Wed, 16 Sep 2009 12:44:34 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <C7281D64AA0F464394A823C942685090@VEGA> <4AB1148D.4050304@net-m.de>
In-Reply-To: <4AB1148D.4050304@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I agree - best to find the cause before making a decision. There are
enough smart people in the wings, I can't imagine this should take us
that long. We have solved a good chunk of it already, and have only just
begun chunk two.

-- 
- Mark

http://www.lucidimagination.com



Thomas Becker wrote:
> I suggest to find the root cause and then decide about the release. Tomorrow I
> will spent the whole working day on the issue if no prio1 pops up.
>
> Sadly I've to leave early today, since I'm moving to a new flat... :(
>
> Uwe Schindler wrote:
>   
>> How should we proceed? Stop the final artifact build and voting or proceed
>> with the release of 2.9? We waited so long and for most people it is faster
>> than slower!
>>
>> -----
>> Uwe Schindler
>> H.-H.-Meier-Allee 63, D-28213 Bremen
>> http://www.thetaphi.de
>> eMail: uwe@thetaphi.de
>>
>>
>>     
>>> -----Original Message-----
>>> From: Mark Miller [mailto:markrmiller@gmail.com]
>>> Sent: Wednesday, September 16, 2009 6:23 PM
>>> To: java-user@lucene.apache.org
>>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>>
>>> bq. I'll do some profiling now again and let you know the results.
>>>
>>> Great - it will be interesting to see the results. My guess, based on
>>> the 2.9 new api profiling, is that your queries may not be agreeing with
>>> some of the changes somehow. Along with the profiling, can you fill us
>>> in on the query types you are using as well? (eg qualities)
>>>
>>> And grab invocations if its possible.
>>>
>>> --
>>> - Mark
>>>
>>> http://www.lucidimagination.com
>>>
>>>
>>>
>>> Thomas Becker wrote:
>>>       
>>>> Tests run on tmpfs:
>>>> config: impl=SeparateFile serial=false nThreads=4 iterations=100
>>>>         
>>> bufsize=1024
>>>       
>>>> poolsize=2 filelen=18920301
>>>> answer=850258539, ms=8090, MB/sec=935.4907787391842
>>>> config: impl=ChannelFile serial=false nThreads=4 iterations=100
>>>>         
>>> bufsize=1024
>>>       
>>>> poolsize=2 filelen=18920301
>>>> answer=850258903, ms=39444, MB/sec=191.8700030422878
>>>> config: impl=ChannelPread serial=false nThreads=4 iterations=100
>>>>         
>>> bufsize=1024
>>>       
>>>> poolsize=2 filelen=18920301
>>>> answer=850258903, ms=8504, MB/sec=889.9483066792098
>>>> config: impl=PooledPread serial=false nThreads=4 iterations=100
>>>>         
>>> bufsize=1024
>>>       
>>>> poolsize=2 filelen=18920301
>>>> answer=850258903, ms=9585, MB/sec=789.5795931142409
>>>>
>>>> I did run some tests now with SimpleFSDirectory and MMapDirectory. Both
>>>>         
>>> are
>>>       
>>>> faster than NIOFS and the response times improved. But it's still slower
>>>>         
>>> than 2.4.
>>>       
>>>> I'll do some profiling now again and let you know the results.
>>>>
>>>> Thanks again for all the great support to all who've answered.
>>>>
>>>>
>>>> Mark Miller wrote:
>>>>
>>>>         
>>>>> Can you run the following test on your RAMDISK?
>>>>>
>>>>> http://people.apache.org/~markrmiller/FileReadTest.java
>>>>>
>>>>> I've taken it from the following issue (in which NIOFSDirectory was
>>>>> developed):
>>>>> https://issues.apache.org/jira/browse/LUCENE-753
>>>>>
>>>>>
>>>>>           
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>       
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>     
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42393-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:49:59 2009
Return-Path: <java-user-return-42393-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8787 invoked from network); 16 Sep 2009 16:49:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:49:59 -0000
Received: (qmail 36021 invoked by uid 500); 16 Sep 2009 16:49:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35994 invoked by uid 500); 16 Sep 2009 16:49:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35984 invoked by uid 99); 16 Sep 2009 16:49:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:49:56 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:49:45 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 263B8D36007
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:49:25 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id AOQoE9mUi3ZE for <java-user@lucene.apache.org>;
	Wed, 16 Sep 2009 18:49:16 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id F1D31D36004
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:49:15 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Wed, 16 Sep 2009 18:49:15 +0200
Message-ID: <A061303D20ED4141BC2040931698E120@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AB112D6.9010003@net-m.de>
Thread-Index: Aco260NuoVxAEc9yTMiiygMq6s8LFAAAiYUg
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
> 
> Have to verify that the last one is not by accident more than one request.
> Will
> do the run again and then post the required info.

The last figure shows, that IndexSearcher.searchWithFilter was called twice
in contrast to the first figure, where IndexSearcher.search was called only
once.

Uwe


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42394-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:54:26 2009
Return-Path: <java-user-return-42394-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10059 invoked from network); 16 Sep 2009 16:54:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:54:26 -0000
Received: (qmail 47889 invoked by uid 500); 16 Sep 2009 16:54:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47838 invoked by uid 500); 16 Sep 2009 16:54:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47828 invoked by uid 99); 16 Sep 2009 16:54:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:54:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:54:11 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1551828fgg.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 09:52:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=oeRXckUaxSD56eL0Epv11wPVuLEsPu1LHfeZdNf+HZk=;
        b=Q1xvfS54juG+xob5bAwUBdLO8bK41TUh+DGZjmTiWzgPE73waaXj9s2bJu+HEL+IpF
         043pOBkjAB64idO6k1KKk2kOoQ5eFhNRW8jI56vETFlpc5pONIvrL+UoFoIAk9GLwGDP
         GKcumkzUvJapOpslFrIFrzumtQbR4Tvpkg4Ug=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=uWNeG4L9Zc2Uk2ZFhPo5kfiycs6WJ8SDyFc+KYwfpTPL7HKjzGRhngyQbge+Ys9EBy
         LKBlomgEdSgbq9hbX/MAXr32fvVOG2vRAuMw27gHD5mSKv1WOhnFWfs45a9oQqzksAkD
         KWjdY5bfna9VNhu9eoXR485NIGiZF+bEZE3qM=
Received: by 10.86.169.25 with SMTP id r25mr3872488fge.17.1253119971320;
        Wed, 16 Sep 2009 09:52:51 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e20sm2399833fga.25.2009.09.16.09.52.49
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 09:52:50 -0700 (PDT)
Message-ID: <4AB117E0.3050501@gmail.com>
Date: Wed, 16 Sep 2009 12:52:48 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de>
In-Reply-To: <4AB112D6.9010003@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Very interesting. Something can't be going right here. You are searching
against a single segment, yet, just for example,
while before, DisjunctionSumScorer.advanceAfterCurrent was being called
154,000 times, now its being called 1.3 million times.
Other scoring methods have similar crazy jumps.

Guys that worked on that stuff - any ideas on whats up here?


They both appear to be using BooleanScorer2.

-- 
- Mark

http://www.lucidimagination.com




Thomas Becker wrote:
> New Profiling sessions with invocation counts. A single lucene search request
> with huge resultset (169k items).
>
> Quite interesting results though and there's definetly something wrong with luc
> 2.9 and the way I'm using it. But see yourself:
>
> http://ankeschwarzer.de/tmp/lucene_24_oldapi_singlereq.png
> http://ankeschwarzer.de/tmp/lucene_29_oldapi_singlereq.png
> and even worse:
> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
>
> Have to verify that the last one is not by accident more than one request. Will
> do the run again and then post the required info.
>
> Mark Miller wrote:
>   
>> bq. I'll do some profiling now again and let you know the results.
>>
>> Great - it will be interesting to see the results. My guess, based on
>> the 2.9 new api profiling, is that your queries may not be agreeing with
>> some of the changes somehow. Along with the profiling, can you fill us
>> in on the query types you are using as well? (eg qualities)
>>
>> And grab invocations if its possible.
>>
>>     
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42395-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:55:28 2009
Return-Path: <java-user-return-42395-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10373 invoked from network); 16 Sep 2009 16:55:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:55:27 -0000
Received: (qmail 50851 invoked by uid 500); 16 Sep 2009 16:55:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50771 invoked by uid 500); 16 Sep 2009 16:55:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50758 invoked by uid 99); 16 Sep 2009 16:55:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:55:25 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:55:13 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 7D55FD36006
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:54:23 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ng+BEc53GIpm for <java-user@lucene.apache.org>;
	Wed, 16 Sep 2009 18:54:14 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 64B99D36004
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:54:14 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Wed, 16 Sep 2009 18:54:13 +0200
Message-ID: <4FA107D4A2474911BC14488747D434E2@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Aco260NuoVxAEc9yTMiiygMq6s8LFAAAiYUgAAAf3lA=
In-Reply-To: <A061303D20ED4141BC2040931698E120@VEGA>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

> > http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
> >
> > Have to verify that the last one is not by accident more than one
> request.
> > Will
> > do the run again and then post the required info.
> 
> The last figure shows, that IndexSearcher.searchWithFilter was called
> twice
> in contrast to the first figure, where IndexSearcher.search was called
> only
> once.

I forgot, searchWithFilter it is called per segment in 2.9. If it was only
one search, you must have two segments and therefore no optimized index for
this to be correct?

Uwe


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42396-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:55:33 2009
Return-Path: <java-user-return-42396-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10429 invoked from network); 16 Sep 2009 16:55:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:55:32 -0000
Received: (qmail 52549 invoked by uid 500); 16 Sep 2009 16:55:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52505 invoked by uid 500); 16 Sep 2009 16:55:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52495 invoked by uid 99); 16 Sep 2009 16:55:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:55:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.153 as permitted sender)
Received: from [72.14.220.153] (HELO fg-out-1718.google.com) (72.14.220.153)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:55:18 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1552102fgg.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 09:53:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=QY8Ax8v58ZS5A7J1HtpzraBKVY0M7MJDYs/UMhMX0hc=;
        b=bm27E0TytBu0nLx+nAt7epKbHe2tTOLFTmkV3O4IkhepKxkqskyHeF+QMjiz3+sLVP
         zJ80KPz/o+S/QkHyKsLpm3EbEmNeSpG/5A4GtYG4j01vP1Ab1nJxBw/E0zGre/bc8opV
         3mwrGvlz6DF8fDYy76FTjzRTKYWqiVt2Dy/Ec=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=lQDz5aLDY4v/aZ20BDSaAOhZwPyWotmoQbr27sgUEjqEEFTo/yGRgyNuKT0Y8ta1Fs
         DyZrfrNxL98jyek/Yz+hS5HoKp/9LMkmrsKi3kJna5Kw9cgC/IN7PWFi+MjuM1azLDcZ
         AQy5YeFf4peSjADjBX2LIxWB2SIiUc+aYVKbI=
Received: by 10.86.227.13 with SMTP id z13mr7703027fgg.72.1253120037815;
        Wed, 16 Sep 2009 09:53:57 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e20sm523507fga.20.2009.09.16.09.53.55
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 09:53:56 -0700 (PDT)
Message-ID: <4AB11822.6090909@gmail.com>
Date: Wed, 16 Sep 2009 12:53:54 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA>
In-Reply-To: <A061303D20ED4141BC2040931698E120@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Ah - that explains a bit. Though if you divide by 2, the new one still
appears to overcall each method
in comparison to 2.4.

- Mark

Uwe Schindler wrote:
>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
>>
>> Have to verify that the last one is not by accident more than one request.
>> Will
>> do the run again and then post the required info.
>>     
>
> The last figure shows, that IndexSearcher.searchWithFilter was called twice
> in contrast to the first figure, where IndexSearcher.search was called only
> once.
>
> Uwe
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42397-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:55:48 2009
Return-Path: <java-user-return-42397-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10565 invoked from network); 16 Sep 2009 16:55:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:55:48 -0000
Received: (qmail 54353 invoked by uid 500); 16 Sep 2009 16:55:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54315 invoked by uid 500); 16 Sep 2009 16:55:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54305 invoked by uid 99); 16 Sep 2009 16:55:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:55:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:55:33 +0000
Received: by fxm18 with SMTP id 18so4197133fxm.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 09:55:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=35AGVu7xgvwxpa0PMZhb/xYtewCTNMZTTiJWApS9VCY=;
        b=dWwHtv8y5OGMtn1PyI0S1q+9yK9RZxijm93XyHpuq+Yj+hWle1jhKyRThLtMgnCMw6
         GHfhGUmAafqOczsvphQK7iQX9UOli7dVEsXE70E+tcUY0wcXZgAL+9L6D5R+XoUDpCzt
         P7E8WDgWUPb9yBo+PwzVYL0z6jQ6tMkO5LZRI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=VLQCv8rwDT06t96CvhhTGzpS62ky+zyNTboHMscxrt9xS23jbbY370DDpJlPbSvBSE
         6f5Nx1Tuckx9vI8nK7jhuBLEl8cexnVtkIJ3ugK1VOxOELM1b662CpIbn0nBqvheApC+
         DjXcdBzrVeSHc4FcdwjdAjPOfEJTWty1t4S4E=
Received: by 10.86.187.27 with SMTP id k27mr7633246fgf.11.1253120112731;
        Wed, 16 Sep 2009 09:55:12 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e11sm428762fga.23.2009.09.16.09.55.07
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 09:55:10 -0700 (PDT)
Message-ID: <4AB1186A.6020501@gmail.com>
Date: Wed, 16 Sep 2009 12:55:06 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: What would be the fastest BooleanQuery possible?
References: <5381b58f0909160525r6564201frdc8ec31a845b5fc@mail.gmail.com>	 <4AB116EC.90104@gmail.com>	 <5381b58f0909160614m385d0c1bt2d59e8f249c46018@mail.gmail.com>	 <9ac0c6aa0909160716j15bdf715i580946374a000a25@mail.gmail.com> <5381b58f0909160750w29fc8c27o2ca8d90fff29ca0@mail.gmail.com>
In-Reply-To: <5381b58f0909160750w29fc8c27o2ca8d90fff29ca0@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The Weight is responsible for creating the Scorer for each Query, so I
don't think there is much you can do to get around
it in 2.3.2. Not easily anyway.

The Weight does its work in the constructor because it cannot hold onto
the Searcher do to Serialization requirements.

-- 
- Mark

http://www.lucidimagination.com



Benjamin Pasero wrote:
> Thanks, I tried this but profiling showed me that I get similar
> results. Most time is spent in
> - BooleanQuery.createWeight()
> - BooleanScorer.next()
>
> If I am not interested in scores, do I still need the heavy weight computation?
>
> On Wed, Sep 16, 2009 at 4:16 PM, Michael McCandless
> <lucene@mikemccandless.com> wrote:
>   
>> You could get the Scorer and call next() yourself; this would avoid
>> scoring.  EG something like this:
>>
>>      Weight weight = query.weight(searcher);
>>      Scorer scorer = weight.scorer(searcher.getIndexReader());
>>      while(scorer.next()) {
>>        final int docID = scorer.doc();
>>        /* do something w/ docID */
>>      }
>>
>> But note that this code is not generally recommended in 2.9 (since
>> it's not operating at the segment level).
>>
>> If your queries contain only SHOULD and up to 32 MUST_NOT clauses,
>> then calling BooleanQuery.setAllowDocsOutOfOrder should improve
>> performance since internally it will use BooleanScorer instead of
>> BooleanScorer2.
>>
>> Mike
>>
>> On Wed, Sep 16, 2009 at 9:14 AM, Benjamin Pasero
>> <benjamin.pasero@gmail.com> wrote:
>>     
>>> Ah wow that sounds great. I am using 2.3.2 though (and have to use it
>>> for now). Anything
>>> in that version that could speed things up?
>>>
>>> On Wed, Sep 16, 2009 at 6:48 PM, Mark Miller <markrmiller@gmail.com> wrote:
>>>       
>>>> With the new Collector API in Lucene 2.9, you no longer have to compute the
>>>> score.
>>>>
>>>> Now a Collector is passed a Scorer if they want to use it, but you can
>>>> just ignore it.
>>>>
>>>> --
>>>> - Mark
>>>>
>>>> http://www.lucidimagination.com
>>>>
>>>>
>>>>
>>>> Benjamin Pasero wrote:
>>>>         
>>>>> Hi,
>>>>>
>>>>> I am using Lucene not only for smart fulltext searches but also for
>>>>> getting the results for a DB-like query, where I am not tokenizing the
>>>>> terms at all. For this query, I am interested in all results and for
>>>>> that
>>>>> I am using my own HitCollector.
>>>>>
>>>>> Now, while profiling I noticed that quite some time is spent in
>>>>> methods like TermQuery.weight() or BooleanScorer2.score(). Given that
>>>>> I am interested in all results, I am not interested in any score for
>>>>> the
>>>>> results.
>>>>>
>>>>> Is it possible to run a query where Lucene simply checks if a Document
>>>>> is a hit or not and completly ignore weighting and scoring? Or is that
>>>>> an integrated part of the search used to determine if a Document
>>>>> is a hit or not?
>>>>>
>>>>> Thanks for helping,
>>>>> Ben
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>>>           
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>         
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>       
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42398-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:56:31 2009
Return-Path: <java-user-return-42398-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10796 invoked from network); 16 Sep 2009 16:56:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:56:31 -0000
Received: (qmail 56588 invoked by uid 500); 16 Sep 2009 16:56:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56536 invoked by uid 500); 16 Sep 2009 16:56:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56506 invoked by uid 99); 16 Sep 2009 16:56:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:56:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:56:15 +0000
Received: from tbeckers-MacBook.local (dslb-084-062-025-139.pools.arcor-ip.net [84.62.25.139])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8GGtoOk014359
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:55:51 +0200
Message-ID: <4AB11896.4080901@net-m.de>
Date: Wed, 16 Sep 2009 18:55:50 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com>
In-Reply-To: <4AB110E3.6040004@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Wed, 16 Sep 2009 18:55:51 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9810/Wed Sep 16 14:06:23 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Spam-Level: _TESTSCORES(,)_
X-Spam-Checker-Version: SpamAssassin 3.2.4-netm20061016 on extranet1.net-m.de
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-100.7 required=5.0 version=3.2.4-netm20061016

So here's a debug message showing the query:

2009-09-16 18:53:59,642 [DEBUG] [http-8440-2] [] [2144122] []
service.impl.LuceneBaseService: items search('viewable:(FINDALL 0 1 2 )',
BooleanFilter( +CachingWrapperFilter(QueryWrapperFilter(+issalesallo
wed:true)) +CachingWrapperFilter(QueryWrapperFilter(licenseGroupKeys:lablxrox))
+CachingWrapperFilter(QueryWrapperFilter(+(viewable:1 viewable:2)))
+CachingWrapperFilter(QueryWrapperFilter(+contentReposit
oryIds:146)) +CachingWrapperFilter(QueryWrapperFilter(+contentGroupIds:14554))
-CachingWrapperFilter(QueryWrapperFilter(digitalReleaseDate:{lablxrox20090916 TO
lablxrox99999999} digitalDeleteDate:[lablxro
x19000101 TO lablxrox20090916]))
-CachingWrapperFilter(QueryWrapperFilter(+excludedContractIds:all))
-CachingWrapperFilter(QueryWrapperFilter(+excludedContractIds:2144122))),
<custom:"position": null>, 0,
 16)

By the way, will it make sense to move this into a jira issue? It'll get quite
tough to find the right information already since this thread is growing quite fast.

Mark Miller wrote:
> bq. I'll do some profiling now again and let you know the results.
> 
> Great - it will be interesting to see the results. My guess, based on
> the 2.9 new api profiling, is that your queries may not be agreeing with
> some of the changes somehow. Along with the profiling, can you fill us
> in on the query types you are using as well? (eg qualities)
> 
> And grab invocations if its possible.
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42399-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 16:58:35 2009
Return-Path: <java-user-return-42399-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11619 invoked from network); 16 Sep 2009 16:58:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 16:58:35 -0000
Received: (qmail 61624 invoked by uid 500); 16 Sep 2009 16:58:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61560 invoked by uid 500); 16 Sep 2009 16:58:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61550 invoked by uid 99); 16 Sep 2009 16:58:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:58:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 16:58:21 +0000
Received: from tbeckers-MacBook.local (dslb-084-062-025-139.pools.arcor-ip.net [84.62.25.139])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8GGvfw9014477
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 18:57:42 +0200
Message-ID: <4AB11905.1020800@net-m.de>
Date: Wed, 16 Sep 2009 18:57:41 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA>
In-Reply-To: <A061303D20ED4141BC2040931698E120@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Wed, 16 Sep 2009 18:57:42 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9810/Wed Sep 16 14:06:23 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Spam-Level: _TESTSCORES(,)_
X-Spam-Checker-Version: SpamAssassin 3.2.4-netm20061016 on extranet1.net-m.de
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-100.7 required=5.0 version=3.2.4-netm20061016

This might be a change in my getHitCounts method. I will dig into that by tomorrow.

I'm really sorry, but I've to leave now. Otherwise I'll have other issues.

Uwe Schindler wrote:
>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
>>
>> Have to verify that the last one is not by accident more than one request.
>> Will
>> do the run again and then post the required info.
> 
> The last figure shows, that IndexSearcher.searchWithFilter was called twice
> in contrast to the first figure, where IndexSearcher.search was called only
> once.
> 
> Uwe
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42400-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 17:01:22 2009
Return-Path: <java-user-return-42400-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12724 invoked from network); 16 Sep 2009 17:01:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 17:01:22 -0000
Received: (qmail 66384 invoked by uid 500); 16 Sep 2009 17:01:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66308 invoked by uid 500); 16 Sep 2009 17:01:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66298 invoked by uid 99); 16 Sep 2009 17:01:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:01:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thomas.becker@net-m.de designates 62.214.145.243 as permitted sender)
Received: from [62.214.145.243] (HELO mx1.net-m.de) (62.214.145.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:01:07 +0000
Received: from tbeckers-MacBook.local (dslb-084-062-025-139.pools.arcor-ip.net [84.62.25.139])
	(authenticated bits=0)
	by mx1.net-m.de (8.13.8/8.13.8) with ESMTP id n8GH0RVs014763
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 19:00:27 +0200
Message-ID: <4AB119AB.80709@net-m.de>
Date: Wed, 16 Sep 2009 19:00:27 +0200
From: Thomas Becker <thomas.becker@net-m.de>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA> <4FA107D4A2474911BC14488747D434E2@VEGA>
In-Reply-To: <4FA107D4A2474911BC14488747D434E2@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 8bit
X-Greylist: Sender succeeded SMTP AUTH, not delayed by milter-greylist-4.0 (mx1.net-m.de [192.168.4.13]); Wed, 16 Sep 2009 19:00:28 +0200 (CEST)
X-Virus-Scanned: ClamAV 0.93.3/9810/Wed Sep 16 14:06:23 2009 on nereus.d4.net-m.de
X-Virus-Status: Clean
X-Spam-Level: _TESTSCORES(,)_
X-Spam-Checker-Version: SpamAssassin 3.2.4-netm20061016 on extranet1.net-m.de
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-100.7 required=5.0 version=3.2.4-netm20061016

No it's only a single segment. But two calls. One doing a getHitsCount first and
the other doing the actual search. I'll paste both methods below if someone's
interested.

Will dig into lucene's sources and compare 2.4 search behaviour for my case with
2.9 tomorrow. It was about time to get more into lucene-core sources anyhow. :)

See you tomorrow guys and thanks a lot again! It's a pleasure.

	public int getHitsCount(String query, Filter filter) throws
LuceneServiceException {
		log.debug("getHitsCount('{}, {}')", query, filter);
		if (StringUtils.isBlank(query)) {
			log.warn("getHitsCount: empty lucene query");
			return 0;
		}
		long startTimeMillis = System.currentTimeMillis();
		int count = 0;

		if (indexSearcher == null) {
			return 0;
		}

		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
		Query q = null;
		try {
			q = createQuery(query);
			TopScoreDocCollector tsdc = TopScoreDocCollector.create(1, true);
			indexSearcher.search(q, filter, tsdc);
			count = tsdc.getTotalHits();
			log.info("getHitsCount: count = {}",count);
		} catch (ParseException ex) {
			throw new LuceneServiceException("invalid lucene query:" + query, ex);
		} catch (IOException e) {
			throw new LuceneServiceException(" indexSearcher could be corrupted", e);
		} finally {
			long durationMillis = System.currentTimeMillis() - startTimeMillis;
			if (durationMillis > slowQueryLimit) {
				log.warn("getHitsCount: Slow query: {} ms, query={}", durationMillis, query);
			}
			log.debug("getHitsCount: query took {} ms", durationMillis);
		}
		return count;
	}

	public List<Document> search(String query, Filter filter, Sort sort, int from,
int size) throws LuceneServiceException {
		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] { indexAlias, query,
filter, sort, from, size });
		long startTimeMillis = System.currentTimeMillis();

		List<Document> docs = new ArrayList<Document>();
		if (indexSearcher == null) {
			return docs;
		}
		Query q = null;
		try {
			if (query == null) {
				log.warn("search: lucene query is null...");
				return docs;
			}
			q = createQuery(query);
			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
			if (size < 0 || size > maxNumHits) {
				// set hard limit for numHits
				size = maxNumHits;
				if (log.isDebugEnabled())
					log.debug("search: Size set to hardlimit: {} for query: {} with filter:
{}", new Object[] { size, query, filter });
			}
			TopFieldCollector collector = TopFieldCollector.create(sort, size + from,
true, false, false, true);
			indexSearcher.search(q, filter, collector);
			if(size > collector.getTotalHits())
				size = collector.getTotalHits();
			if (size > 100000)
				log.info("search: size: {} bigger than 100.000 for query: {} with filter:
{}", new Object[] { size, query, filter });
			TopDocs td = collector.topDocs(from, size);
			ScoreDoc[] scoreDocs = td.scoreDocs;
			for (ScoreDoc scoreDoc : scoreDocs) {
				docs.add(indexSearcher.doc(scoreDoc.doc));
			}
		} catch (ParseException e) {
			log.warn("search: ParseException: {}", e.getMessage());
			if (log.isDebugEnabled())
				log.warn("search: ParseException: ", e);
			return Collections.emptyList();
		} catch (IOException e) {
			log.warn("search: IOException: ", e);
			return Collections.emptyList();
		} finally {
			long durationMillis = System.currentTimeMillis() - startTimeMillis;
			if (durationMillis > slowQueryLimit) {
				log.warn("search: Slow query: {} ms, query={}, indexUsed={}",
						new Object[] { durationMillis, query,
indexSearcher.getIndexReader().directory() });
			}
			log.debug("search: query took {} ms", durationMillis);
		}
		return docs;
	}


Uwe Schindler wrote:
>>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
>>>
>>> Have to verify that the last one is not by accident more than one
>> request.
>>> Will
>>> do the run again and then post the required info.
>> The last figure shows, that IndexSearcher.searchWithFilter was called
>> twice
>> in contrast to the first figure, where IndexSearcher.search was called
>> only
>> once.
> 
> I forgot, searchWithFilter it is called per segment in 2.9. If it was only
> one search, you must have two segments and therefore no optimized index for
> this to be correct?
> 
> Uwe
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

-- 
Thomas Becker
Senior JEE Developer

net mobile AG
Zollhof 17
40221 Dsseldorf
GERMANY

Phone:    +49 211 97020-195
Fax:      +49 211 97020-949
Mobile:   +49 173 5146567 (private)
E-Mail:   mailto:thomas.becker@net-m.de
Internet: http://www.net-m.de

Registergericht:  Amtsgericht Dsseldorf, HRB 48022
Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
                 Kai Markus Kulas, Dieter Plassmann
Vorsitzender des
Aufsichtsrates:   Dr. Michael Briem

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42401-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 17:04:48 2009
Return-Path: <java-user-return-42401-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13913 invoked from network); 16 Sep 2009 17:04:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 17:04:48 -0000
Received: (qmail 76557 invoked by uid 500); 16 Sep 2009 17:04:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76485 invoked by uid 500); 16 Sep 2009 17:04:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76471 invoked by uid 99); 16 Sep 2009 17:04:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:04:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:04:33 +0000
Received: by fxm18 with SMTP id 18so4204084fxm.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 10:04:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=7jINqudOXbg1cSbB2HMogmtN/08dE/hPsUd5C0CrXog=;
        b=HVyne7KjjeF4y+hT3xeoLpfdxrlaa1a1U9uZxtyoJ4kzOJyaVGJ07aqI1T5HAJ3FtP
         rTbthWg+2/WnCtlawXeKwsYvAhUx47yM1KloBCSpOlIDdb4nwhoDy0r9Dph1fvJ/rKVf
         YHZM6GT2TZy4rVroNU0CMwAbCLjkOnuPsl2vk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=HVL84zMXeuEHfqiYsewYtklMHQEnZgTjp+22m4K3gdpK7YX0ThfonuyLi9h7xrnwR9
         98n+V9BfGyhvhr+3RIk0K+Xwlhog/8dAWPRJN/KBK1pGieImZ348HNwHkbFq4ipnzh0g
         2Y7ivN82CtbHui1fBcaU+96TAXJNOdZY7d/u4=
Received: by 10.86.158.29 with SMTP id g29mr4048645fge.4.1253120651445;
        Wed, 16 Sep 2009 10:04:11 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm157192fgg.3.2009.09.16.10.04.09
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 10:04:10 -0700 (PDT)
Message-ID: <4AB11A88.6080808@gmail.com>
Date: Wed, 16 Sep 2009 13:04:08 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA> <4FA107D4A2474911BC14488747D434E2@VEGA> <4AB119AB.80709@net-m.de>
In-Reply-To: <4AB119AB.80709@net-m.de>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Something is very odd about this if they both cover the same search and
the environ for both is identical. Even if one search was done twice,
and we divide the numbers for the new api by 2 - its still *very* odd.

With 2.4, ScorerDocQueue.topDoc is called half a million times.
With 2.9, its called over 4 million times.

Huh?

Thomas Becker wrote:
> No it's only a single segment. But two calls. One doing a getHitsCount first and
> the other doing the actual search. I'll paste both methods below if someone's
> interested.
>
> Will dig into lucene's sources and compare 2.4 search behaviour for my case with
> 2.9 tomorrow. It was about time to get more into lucene-core sources anyhow. :)
>
> See you tomorrow guys and thanks a lot again! It's a pleasure.
>
> 	public int getHitsCount(String query, Filter filter) throws
> LuceneServiceException {
> 		log.debug("getHitsCount('{}, {}')", query, filter);
> 		if (StringUtils.isBlank(query)) {
> 			log.warn("getHitsCount: empty lucene query");
> 			return 0;
> 		}
> 		long startTimeMillis = System.currentTimeMillis();
> 		int count = 0;
>
> 		if (indexSearcher == null) {
> 			return 0;
> 		}
>
> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
> 		Query q = null;
> 		try {
> 			q = createQuery(query);
> 			TopScoreDocCollector tsdc = TopScoreDocCollector.create(1, true);
> 			indexSearcher.search(q, filter, tsdc);
> 			count = tsdc.getTotalHits();
> 			log.info("getHitsCount: count = {}",count);
> 		} catch (ParseException ex) {
> 			throw new LuceneServiceException("invalid lucene query:" + query, ex);
> 		} catch (IOException e) {
> 			throw new LuceneServiceException(" indexSearcher could be corrupted", e);
> 		} finally {
> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
> 			if (durationMillis > slowQueryLimit) {
> 				log.warn("getHitsCount: Slow query: {} ms, query={}", durationMillis, query);
> 			}
> 			log.debug("getHitsCount: query took {} ms", durationMillis);
> 		}
> 		return count;
> 	}
>
> 	public List<Document> search(String query, Filter filter, Sort sort, int from,
> int size) throws LuceneServiceException {
> 		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] { indexAlias, query,
> filter, sort, from, size });
> 		long startTimeMillis = System.currentTimeMillis();
>
> 		List<Document> docs = new ArrayList<Document>();
> 		if (indexSearcher == null) {
> 			return docs;
> 		}
> 		Query q = null;
> 		try {
> 			if (query == null) {
> 				log.warn("search: lucene query is null...");
> 				return docs;
> 			}
> 			q = createQuery(query);
> 			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
> 			if (size < 0 || size > maxNumHits) {
> 				// set hard limit for numHits
> 				size = maxNumHits;
> 				if (log.isDebugEnabled())
> 					log.debug("search: Size set to hardlimit: {} for query: {} with filter:
> {}", new Object[] { size, query, filter });
> 			}
> 			TopFieldCollector collector = TopFieldCollector.create(sort, size + from,
> true, false, false, true);
> 			indexSearcher.search(q, filter, collector);
> 			if(size > collector.getTotalHits())
> 				size = collector.getTotalHits();
> 			if (size > 100000)
> 				log.info("search: size: {} bigger than 100.000 for query: {} with filter:
> {}", new Object[] { size, query, filter });
> 			TopDocs td = collector.topDocs(from, size);
> 			ScoreDoc[] scoreDocs = td.scoreDocs;
> 			for (ScoreDoc scoreDoc : scoreDocs) {
> 				docs.add(indexSearcher.doc(scoreDoc.doc));
> 			}
> 		} catch (ParseException e) {
> 			log.warn("search: ParseException: {}", e.getMessage());
> 			if (log.isDebugEnabled())
> 				log.warn("search: ParseException: ", e);
> 			return Collections.emptyList();
> 		} catch (IOException e) {
> 			log.warn("search: IOException: ", e);
> 			return Collections.emptyList();
> 		} finally {
> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
> 			if (durationMillis > slowQueryLimit) {
> 				log.warn("search: Slow query: {} ms, query={}, indexUsed={}",
> 						new Object[] { durationMillis, query,
> indexSearcher.getIndexReader().directory() });
> 			}
> 			log.debug("search: query took {} ms", durationMillis);
> 		}
> 		return docs;
> 	}
>
>
> Uwe Schindler wrote:
>   
>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
>>>>
>>>> Have to verify that the last one is not by accident more than one
>>>>         
>>> request.
>>>       
>>>> Will
>>>> do the run again and then post the required info.
>>>>         
>>> The last figure shows, that IndexSearcher.searchWithFilter was called
>>> twice
>>> in contrast to the first figure, where IndexSearcher.search was called
>>> only
>>> once.
>>>       
>> I forgot, searchWithFilter it is called per segment in 2.9. If it was only
>> one search, you must have two segments and therefore no optimized index for
>> this to be correct?
>>
>> Uwe
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>     
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42402-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 17:10:43 2009
Return-Path: <java-user-return-42402-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15633 invoked from network); 16 Sep 2009 17:10:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 17:10:43 -0000
Received: (qmail 88788 invoked by uid 500); 16 Sep 2009 17:10:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88734 invoked by uid 500); 16 Sep 2009 17:10:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88724 invoked by uid 99); 16 Sep 2009 17:10:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:10:40 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:10:28 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 2E743D36006
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 19:10:08 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id K2cZT6cSUywL for <java-user@lucene.apache.org>;
	Wed, 16 Sep 2009 19:09:57 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 3CE80D36004
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 19:09:57 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB11896.4080901@net-m.de>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Wed, 16 Sep 2009 19:09:57 +0200
Message-ID: <49EC0507BBEB485F823B2D477A34BC0F@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Aco27qh33DF0MnSYQ1agBiUqLaVR3wAARWew
In-Reply-To: <4AB11896.4080901@net-m.de>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

I found one thing in your debug output:

You are using a lot of CachingWrapperFilters around QueryWrapperFilter.
According to http://issues.apache.org/jira/browse/LUCENE-1427,
QueryWrapperFilter does not copy the scorer's doc ids into a OpenBitSet, =
it
instead returns the scorer itself as DocIdSet (which is perfectly legal =
ant
very good, if no caching is involved). The CachingWrapperFilter just =
caches
this DocIdSet, but the result is that the scorer's next/advance methods =
are
executed even if the cache had cached the filter before.

Maybe we need some change to CachingWrapperFilter that caches the =
DocIdSets
as before, but optionally would wrap it into an OpenBitSet, if it is not =
an
instance of OBS.

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Thomas Becker [mailto:thomas.becker@net-m.de]
> Sent: Wednesday, September 16, 2009 6:56 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>=20
> So here's a debug message showing the query:
>=20
> 2009-09-16 18:53:59,642 [DEBUG] [http-8440-2] [] [2144122] []
> service.impl.LuceneBaseService: items search('viewable:(FINDALL 0 1 2 =
)',
> BooleanFilter( +CachingWrapperFilter(QueryWrapperFilter(+issalesallo
> wed:true))
> +CachingWrapperFilter(QueryWrapperFilter(licenseGroupKeys:lablxrox))
> +CachingWrapperFilter(QueryWrapperFilter(+(viewable:1 viewable:2)))
> +CachingWrapperFilter(QueryWrapperFilter(+contentReposit
> oryIds:146))
> +CachingWrapperFilter(QueryWrapperFilter(+contentGroupIds:14554))
> -
> =
CachingWrapperFilter(QueryWrapperFilter(digitalReleaseDate:{lablxrox20090=
9
> 16 TO
> lablxrox99999999} digitalDeleteDate:[lablxro
> x19000101 TO lablxrox20090916]))
> -CachingWrapperFilter(QueryWrapperFilter(+excludedContractIds:all))
> =
-CachingWrapperFilter(QueryWrapperFilter(+excludedContractIds:2144122))),=

> <custom:"position": null>, 0,
>  16)
>=20
> By the way, will it make sense to move this into a jira issue? It'll =
get
> quite
> tough to find the right information already since this thread is =
growing
> quite fast.
>=20
> Mark Miller wrote:
> > bq. I'll do some profiling now again and let you know the results.
> >
> > Great - it will be interesting to see the results. My guess, based =
on
> > the 2.9 new api profiling, is that your queries may not be agreeing =
with
> > some of the changes somehow. Along with the profiling, can you fill =
us
> > in on the query types you are using as well? (eg qualities)
> >
> > And grab invocations if its possible.
> >
>=20
> --
> Thomas Becker
> Senior JEE Developer
>=20
> net mobile AG
> Zollhof 17
> 40221 D=FCsseldorf
> GERMANY
>=20
> Phone:    +49 211 97020-195
> Fax:      +49 211 97020-949
> Mobile:   +49 173 5146567 (private)
> E-Mail:   mailto:thomas.becker@net-m.de
> Internet: http://www.net-m.de
>=20
> Registergericht:  Amtsgericht D=FCsseldorf, HRB 48022
> Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
>                  Kai Markus Kulas, Dieter Plassmann
> Vorsitzender des
> Aufsichtsrates:   Dr. Michael Briem
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42403-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 17:14:46 2009
Return-Path: <java-user-return-42403-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16781 invoked from network); 16 Sep 2009 17:14:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 17:14:46 -0000
Received: (qmail 96911 invoked by uid 500); 16 Sep 2009 17:14:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96823 invoked by uid 500); 16 Sep 2009 17:14:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96813 invoked by uid 99); 16 Sep 2009 17:14:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:14:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:14:31 +0000
Received: by bwz10 with SMTP id 10so4155011bwz.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 10:13:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=4LqFiwGmeWOUx4PziADwesnV1UCUyuhNhcTYcZHwcfc=;
        b=Nv8h1yqwVtV1kmmfo7Abd37Y+MF6WdJkqY26WMDimymR7ggp6KGzCVbfC5S7/fXjfA
         B9ha87AQ5HoBydPLCX8rk2GYYg/RCFZvbWG51/0+w0yE/yXtg2DH+ETDzEtm3bPRAoNw
         ftu5LVQnci+R9kor4Z0rRVYAQjpokSFwja364=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=w78JACuzrQkvxnwxgiQ9TqhS/OoFZG0SS8cdQngCFi0Vy9VtXrxz5yQ5faJHZcqbwz
         UwrzTh04BvvcqV+oiGbRybAvonlVeohNfq3huXmZaDEK7Kf2LwLRwsNi4OvqnEtRkd+h
         kvUW60qJ4VPF1QQb56B4My8vj+lj+2Xyiofjg=
Received: by 10.86.184.35 with SMTP id h35mr7671773fgf.18.1253121191043;
        Wed, 16 Sep 2009 10:13:11 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e11sm480697fga.3.2009.09.16.10.13.08
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 10:13:09 -0700 (PDT)
Message-ID: <4AB11CA3.6080708@gmail.com>
Date: Wed, 16 Sep 2009 13:13:07 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA> <4FA107D4A2474911BC14488747D434E2@VEGA> <4AB119AB.80709@net-m.de> <4AB11A88.6080808@gmail.com>
In-Reply-To: <4AB11A88.6080808@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Notice that while DisjunctionScorer.advance and
DisjuntionScorer.advanceAfterCurrent appear to be called
in 2.9, in 2.4, I am only seeing DisjuntionScorer.advanceAfterCurrent
called.

Can someone explain that?

Mark Miller wrote:
> Something is very odd about this if they both cover the same search and
> the environ for both is identical. Even if one search was done twice,
> and we divide the numbers for the new api by 2 - its still *very* odd.
>
> With 2.4, ScorerDocQueue.topDoc is called half a million times.
> With 2.9, its called over 4 million times.
>
> Huh?
>
> Thomas Becker wrote:
>   
>> No it's only a single segment. But two calls. One doing a getHitsCount first and
>> the other doing the actual search. I'll paste both methods below if someone's
>> interested.
>>
>> Will dig into lucene's sources and compare 2.4 search behaviour for my case with
>> 2.9 tomorrow. It was about time to get more into lucene-core sources anyhow. :)
>>
>> See you tomorrow guys and thanks a lot again! It's a pleasure.
>>
>> 	public int getHitsCount(String query, Filter filter) throws
>> LuceneServiceException {
>> 		log.debug("getHitsCount('{}, {}')", query, filter);
>> 		if (StringUtils.isBlank(query)) {
>> 			log.warn("getHitsCount: empty lucene query");
>> 			return 0;
>> 		}
>> 		long startTimeMillis = System.currentTimeMillis();
>> 		int count = 0;
>>
>> 		if (indexSearcher == null) {
>> 			return 0;
>> 		}
>>
>> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>> 		Query q = null;
>> 		try {
>> 			q = createQuery(query);
>> 			TopScoreDocCollector tsdc = TopScoreDocCollector.create(1, true);
>> 			indexSearcher.search(q, filter, tsdc);
>> 			count = tsdc.getTotalHits();
>> 			log.info("getHitsCount: count = {}",count);
>> 		} catch (ParseException ex) {
>> 			throw new LuceneServiceException("invalid lucene query:" + query, ex);
>> 		} catch (IOException e) {
>> 			throw new LuceneServiceException(" indexSearcher could be corrupted", e);
>> 		} finally {
>> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
>> 			if (durationMillis > slowQueryLimit) {
>> 				log.warn("getHitsCount: Slow query: {} ms, query={}", durationMillis, query);
>> 			}
>> 			log.debug("getHitsCount: query took {} ms", durationMillis);
>> 		}
>> 		return count;
>> 	}
>>
>> 	public List<Document> search(String query, Filter filter, Sort sort, int from,
>> int size) throws LuceneServiceException {
>> 		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] { indexAlias, query,
>> filter, sort, from, size });
>> 		long startTimeMillis = System.currentTimeMillis();
>>
>> 		List<Document> docs = new ArrayList<Document>();
>> 		if (indexSearcher == null) {
>> 			return docs;
>> 		}
>> 		Query q = null;
>> 		try {
>> 			if (query == null) {
>> 				log.warn("search: lucene query is null...");
>> 				return docs;
>> 			}
>> 			q = createQuery(query);
>> 			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>> 			if (size < 0 || size > maxNumHits) {
>> 				// set hard limit for numHits
>> 				size = maxNumHits;
>> 				if (log.isDebugEnabled())
>> 					log.debug("search: Size set to hardlimit: {} for query: {} with filter:
>> {}", new Object[] { size, query, filter });
>> 			}
>> 			TopFieldCollector collector = TopFieldCollector.create(sort, size + from,
>> true, false, false, true);
>> 			indexSearcher.search(q, filter, collector);
>> 			if(size > collector.getTotalHits())
>> 				size = collector.getTotalHits();
>> 			if (size > 100000)
>> 				log.info("search: size: {} bigger than 100.000 for query: {} with filter:
>> {}", new Object[] { size, query, filter });
>> 			TopDocs td = collector.topDocs(from, size);
>> 			ScoreDoc[] scoreDocs = td.scoreDocs;
>> 			for (ScoreDoc scoreDoc : scoreDocs) {
>> 				docs.add(indexSearcher.doc(scoreDoc.doc));
>> 			}
>> 		} catch (ParseException e) {
>> 			log.warn("search: ParseException: {}", e.getMessage());
>> 			if (log.isDebugEnabled())
>> 				log.warn("search: ParseException: ", e);
>> 			return Collections.emptyList();
>> 		} catch (IOException e) {
>> 			log.warn("search: IOException: ", e);
>> 			return Collections.emptyList();
>> 		} finally {
>> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
>> 			if (durationMillis > slowQueryLimit) {
>> 				log.warn("search: Slow query: {} ms, query={}, indexUsed={}",
>> 						new Object[] { durationMillis, query,
>> indexSearcher.getIndexReader().directory() });
>> 			}
>> 			log.debug("search: query took {} ms", durationMillis);
>> 		}
>> 		return docs;
>> 	}
>>
>>
>> Uwe Schindler wrote:
>>   
>>     
>>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
>>>>>
>>>>> Have to verify that the last one is not by accident more than one
>>>>>         
>>>>>           
>>>> request.
>>>>       
>>>>         
>>>>> Will
>>>>> do the run again and then post the required info.
>>>>>         
>>>>>           
>>>> The last figure shows, that IndexSearcher.searchWithFilter was called
>>>> twice
>>>> in contrast to the first figure, where IndexSearcher.search was called
>>>> only
>>>> once.
>>>>       
>>>>         
>>> I forgot, searchWithFilter it is called per segment in 2.9. If it was only
>>> one search, you must have two segments and therefore no optimized index for
>>> this to be correct?
>>>
>>> Uwe
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>     
>>>       
>>   
>>     
>
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42404-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 17:23:17 2009
Return-Path: <java-user-return-42404-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19905 invoked from network); 16 Sep 2009 17:23:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 17:23:17 -0000
Received: (qmail 17388 invoked by uid 500); 16 Sep 2009 17:23:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17345 invoked by uid 500); 16 Sep 2009 17:23:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17335 invoked by uid 99); 16 Sep 2009 17:23:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:23:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.158 as permitted sender)
Received: from [72.14.220.158] (HELO fg-out-1718.google.com) (72.14.220.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:23:01 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1560334fgg.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 10:22:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=2WNAv5rt7tIB352M2iFYkarzIgxTHQRAhyWh6Qrr7h4=;
        b=gCTDshgAgvNwlHlSaXewT4L0XwEKcs5iLkXZEic9wU/fIUcRypmiipanb9ACh66olZ
         hjqR0BmzRir32MoAmzoIJNisx4hmeym5E97Qhyb6asQc2gNqKdcoXRYNRdnssXd5uNA2
         Osoc+WAfWhWshux2Q8nATAbc5Ch5CS1ksNXAY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=uGnK/3b7TFzqE8bo1d+6vHRrroQBSmjayaFfdKJWp8t0IvkZnizQ0s5WuZ9EIheJNI
         Lsg7xqzVG0qwYY+RBFZzcTSBMqPoYe3FjGYfWDfCGbR0z+oEdwALRHki4FbeKd6X+9vV
         /kF7KLWyCM1XFMAHOF1RT4TdF7TeHkt/EJiY8=
Received: by 10.86.228.3 with SMTP id a3mr7653567fgh.51.1253121761561;
        Wed, 16 Sep 2009 10:22:41 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id l19sm11636fgb.2.2009.09.16.10.22.39
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 10:22:40 -0700 (PDT)
Message-ID: <4AB11EDE.2000108@gmail.com>
Date: Wed, 16 Sep 2009 13:22:38 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA> <4FA107D4A2474911BC14488747D434E2@VEGA> <4AB119AB.80709@net-m.de> <4AB11A88.6080808@gmail.com> <4AB11CA3.6080708@gmail.com>
In-Reply-To: <4AB11CA3.6080708@gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Nevermind. I see advance wasn't around in 2.4. This is part of the
DocIdSetIterator changes.

Anyway - either these are just not comparable runs, or there is a major
bug (which seems unlikely).

Just to keep pointing out the obvious:

2.4 calls doc 195,000 times
2.9 calls docId 1.4 million times

That just doesn't jive.

Mark Miller wrote:
> Notice that while DisjunctionScorer.advance and
> DisjuntionScorer.advanceAfterCurrent appear to be called
> in 2.9, in 2.4, I am only seeing DisjuntionScorer.advanceAfterCurrent
> called.
>
> Can someone explain that?
>
> Mark Miller wrote:
>   
>> Something is very odd about this if they both cover the same search and
>> the environ for both is identical. Even if one search was done twice,
>> and we divide the numbers for the new api by 2 - its still *very* odd.
>>
>> With 2.4, ScorerDocQueue.topDoc is called half a million times.
>> With 2.9, its called over 4 million times.
>>
>> Huh?
>>
>> Thomas Becker wrote:
>>   
>>     
>>> No it's only a single segment. But two calls. One doing a getHitsCount first and
>>> the other doing the actual search. I'll paste both methods below if someone's
>>> interested.
>>>
>>> Will dig into lucene's sources and compare 2.4 search behaviour for my case with
>>> 2.9 tomorrow. It was about time to get more into lucene-core sources anyhow. :)
>>>
>>> See you tomorrow guys and thanks a lot again! It's a pleasure.
>>>
>>> 	public int getHitsCount(String query, Filter filter) throws
>>> LuceneServiceException {
>>> 		log.debug("getHitsCount('{}, {}')", query, filter);
>>> 		if (StringUtils.isBlank(query)) {
>>> 			log.warn("getHitsCount: empty lucene query");
>>> 			return 0;
>>> 		}
>>> 		long startTimeMillis = System.currentTimeMillis();
>>> 		int count = 0;
>>>
>>> 		if (indexSearcher == null) {
>>> 			return 0;
>>> 		}
>>>
>>> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>>> 		Query q = null;
>>> 		try {
>>> 			q = createQuery(query);
>>> 			TopScoreDocCollector tsdc = TopScoreDocCollector.create(1, true);
>>> 			indexSearcher.search(q, filter, tsdc);
>>> 			count = tsdc.getTotalHits();
>>> 			log.info("getHitsCount: count = {}",count);
>>> 		} catch (ParseException ex) {
>>> 			throw new LuceneServiceException("invalid lucene query:" + query, ex);
>>> 		} catch (IOException e) {
>>> 			throw new LuceneServiceException(" indexSearcher could be corrupted", e);
>>> 		} finally {
>>> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
>>> 			if (durationMillis > slowQueryLimit) {
>>> 				log.warn("getHitsCount: Slow query: {} ms, query={}", durationMillis, query);
>>> 			}
>>> 			log.debug("getHitsCount: query took {} ms", durationMillis);
>>> 		}
>>> 		return count;
>>> 	}
>>>
>>> 	public List<Document> search(String query, Filter filter, Sort sort, int from,
>>> int size) throws LuceneServiceException {
>>> 		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] { indexAlias, query,
>>> filter, sort, from, size });
>>> 		long startTimeMillis = System.currentTimeMillis();
>>>
>>> 		List<Document> docs = new ArrayList<Document>();
>>> 		if (indexSearcher == null) {
>>> 			return docs;
>>> 		}
>>> 		Query q = null;
>>> 		try {
>>> 			if (query == null) {
>>> 				log.warn("search: lucene query is null...");
>>> 				return docs;
>>> 			}
>>> 			q = createQuery(query);
>>> 			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>>> 			if (size < 0 || size > maxNumHits) {
>>> 				// set hard limit for numHits
>>> 				size = maxNumHits;
>>> 				if (log.isDebugEnabled())
>>> 					log.debug("search: Size set to hardlimit: {} for query: {} with filter:
>>> {}", new Object[] { size, query, filter });
>>> 			}
>>> 			TopFieldCollector collector = TopFieldCollector.create(sort, size + from,
>>> true, false, false, true);
>>> 			indexSearcher.search(q, filter, collector);
>>> 			if(size > collector.getTotalHits())
>>> 				size = collector.getTotalHits();
>>> 			if (size > 100000)
>>> 				log.info("search: size: {} bigger than 100.000 for query: {} with filter:
>>> {}", new Object[] { size, query, filter });
>>> 			TopDocs td = collector.topDocs(from, size);
>>> 			ScoreDoc[] scoreDocs = td.scoreDocs;
>>> 			for (ScoreDoc scoreDoc : scoreDocs) {
>>> 				docs.add(indexSearcher.doc(scoreDoc.doc));
>>> 			}
>>> 		} catch (ParseException e) {
>>> 			log.warn("search: ParseException: {}", e.getMessage());
>>> 			if (log.isDebugEnabled())
>>> 				log.warn("search: ParseException: ", e);
>>> 			return Collections.emptyList();
>>> 		} catch (IOException e) {
>>> 			log.warn("search: IOException: ", e);
>>> 			return Collections.emptyList();
>>> 		} finally {
>>> 			long durationMillis = System.currentTimeMillis() - startTimeMillis;
>>> 			if (durationMillis > slowQueryLimit) {
>>> 				log.warn("search: Slow query: {} ms, query={}, indexUsed={}",
>>> 						new Object[] { durationMillis, query,
>>> indexSearcher.getIndexReader().directory() });
>>> 			}
>>> 			log.debug("search: query took {} ms", durationMillis);
>>> 		}
>>> 		return docs;
>>> 	}
>>>
>>>
>>> Uwe Schindler wrote:
>>>   
>>>     
>>>       
>>>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
>>>>>>
>>>>>> Have to verify that the last one is not by accident more than one
>>>>>>         
>>>>>>           
>>>>>>             
>>>>> request.
>>>>>       
>>>>>         
>>>>>           
>>>>>> Will
>>>>>> do the run again and then post the required info.
>>>>>>         
>>>>>>           
>>>>>>             
>>>>> The last figure shows, that IndexSearcher.searchWithFilter was called
>>>>> twice
>>>>> in contrast to the first figure, where IndexSearcher.search was called
>>>>> only
>>>>> once.
>>>>>       
>>>>>         
>>>>>           
>>>> I forgot, searchWithFilter it is called per segment in 2.9. If it was only
>>>> one search, you must have two segments and therefore no optimized index for
>>>> this to be correct?
>>>>
>>>> Uwe
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>     
>>>>       
>>>>         
>>>   
>>>     
>>>       
>>   
>>     
>
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42405-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 17:29:36 2009
Return-Path: <java-user-return-42405-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21311 invoked from network); 16 Sep 2009 17:29:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 17:29:36 -0000
Received: (qmail 28923 invoked by uid 500); 16 Sep 2009 17:29:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28869 invoked by uid 500); 16 Sep 2009 17:29:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28859 invoked by uid 99); 16 Sep 2009 17:29:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:29:33 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:29:22 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 4D2B3D36006
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 19:28:58 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id CsUd78N8OSQ8 for <java-user@lucene.apache.org>;
	Wed, 16 Sep 2009 19:28:49 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 4C505D36004
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 19:28:49 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA> <4FA107D4A2474911BC14488747D434E2@VEGA> <4AB119AB.80709@net-m.de> <4AB11A88.6080808@gmail.com> <4AB11CA3.6080708@gmail.com> <4AB11EDE.2000108@gmail.com>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Wed, 16 Sep 2009 19:28:49 +0200
Message-ID: <FC0DD4E661314BADAA0D0834526B09EA@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: Aco28mZQsld8xrw2SgGDrVPZeTUXBwAAJwSw
In-Reply-To: <4AB11EDE.2000108@gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

See my mail about the CachingWrapperFilter and QueryWrapperFilter, I think
it explains this behaviour (and Thomas ran some warming queries before).

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Mark Miller [mailto:markrmiller@gmail.com]
> Sent: Wednesday, September 16, 2009 7:23 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
> 
> Nevermind. I see advance wasn't around in 2.4. This is part of the
> DocIdSetIterator changes.
> 
> Anyway - either these are just not comparable runs, or there is a major
> bug (which seems unlikely).
> 
> Just to keep pointing out the obvious:
> 
> 2.4 calls doc 195,000 times
> 2.9 calls docId 1.4 million times
> 
> That just doesn't jive.
> 
> Mark Miller wrote:
> > Notice that while DisjunctionScorer.advance and
> > DisjuntionScorer.advanceAfterCurrent appear to be called
> > in 2.9, in 2.4, I am only seeing DisjuntionScorer.advanceAfterCurrent
> > called.
> >
> > Can someone explain that?
> >
> > Mark Miller wrote:
> >
> >> Something is very odd about this if they both cover the same search and
> >> the environ for both is identical. Even if one search was done twice,
> >> and we divide the numbers for the new api by 2 - its still *very* odd.
> >>
> >> With 2.4, ScorerDocQueue.topDoc is called half a million times.
> >> With 2.9, its called over 4 million times.
> >>
> >> Huh?
> >>
> >> Thomas Becker wrote:
> >>
> >>
> >>> No it's only a single segment. But two calls. One doing a getHitsCount
> first and
> >>> the other doing the actual search. I'll paste both methods below if
> someone's
> >>> interested.
> >>>
> >>> Will dig into lucene's sources and compare 2.4 search behaviour for my
> case with
> >>> 2.9 tomorrow. It was about time to get more into lucene-core sources
> anyhow. :)
> >>>
> >>> See you tomorrow guys and thanks a lot again! It's a pleasure.
> >>>
> >>> 	public int getHitsCount(String query, Filter filter) throws
> >>> LuceneServiceException {
> >>> 		log.debug("getHitsCount('{}, {}')", query, filter);
> >>> 		if (StringUtils.isBlank(query)) {
> >>> 			log.warn("getHitsCount: empty lucene query");
> >>> 			return 0;
> >>> 		}
> >>> 		long startTimeMillis = System.currentTimeMillis();
> >>> 		int count = 0;
> >>>
> >>> 		if (indexSearcher == null) {
> >>> 			return 0;
> >>> 		}
> >>>
> >>> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
> >>> 		Query q = null;
> >>> 		try {
> >>> 			q = createQuery(query);
> >>> 			TopScoreDocCollector tsdc =
> TopScoreDocCollector.create(1, true);
> >>> 			indexSearcher.search(q, filter, tsdc);
> >>> 			count = tsdc.getTotalHits();
> >>> 			log.info("getHitsCount: count = {}",count);
> >>> 		} catch (ParseException ex) {
> >>> 			throw new LuceneServiceException("invalid lucene
query:"
> + query, ex);
> >>> 		} catch (IOException e) {
> >>> 			throw new LuceneServiceException(" indexSearcher
could
> be corrupted", e);
> >>> 		} finally {
> >>> 			long durationMillis = System.currentTimeMillis() -
> startTimeMillis;
> >>> 			if (durationMillis > slowQueryLimit) {
> >>> 				log.warn("getHitsCount: Slow query: {} ms,
> query={}", durationMillis, query);
> >>> 			}
> >>> 			log.debug("getHitsCount: query took {} ms",
> durationMillis);
> >>> 		}
> >>> 		return count;
> >>> 	}
> >>>
> >>> 	public List<Document> search(String query, Filter filter, Sort sort,
> int from,
> >>> int size) throws LuceneServiceException {
> >>> 		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] {
> indexAlias, query,
> >>> filter, sort, from, size });
> >>> 		long startTimeMillis = System.currentTimeMillis();
> >>>
> >>> 		List<Document> docs = new ArrayList<Document>();
> >>> 		if (indexSearcher == null) {
> >>> 			return docs;
> >>> 		}
> >>> 		Query q = null;
> >>> 		try {
> >>> 			if (query == null) {
> >>> 				log.warn("search: lucene query is null...");
> >>> 				return docs;
> >>> 			}
> >>> 			q = createQuery(query);
> >>> 			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
> >>> 			if (size < 0 || size > maxNumHits) {
> >>> 				// set hard limit for numHits
> >>> 				size = maxNumHits;
> >>> 				if (log.isDebugEnabled())
> >>> 					log.debug("search: Size set to
hardlimit: {}
> for query: {} with filter:
> >>> {}", new Object[] { size, query, filter });
> >>> 			}
> >>> 			TopFieldCollector collector =
> TopFieldCollector.create(sort, size + from,
> >>> true, false, false, true);
> >>> 			indexSearcher.search(q, filter, collector);
> >>> 			if(size > collector.getTotalHits())
> >>> 				size = collector.getTotalHits();
> >>> 			if (size > 100000)
> >>> 				log.info("search: size: {} bigger than
100.000 for
> query: {} with filter:
> >>> {}", new Object[] { size, query, filter });
> >>> 			TopDocs td = collector.topDocs(from, size);
> >>> 			ScoreDoc[] scoreDocs = td.scoreDocs;
> >>> 			for (ScoreDoc scoreDoc : scoreDocs) {
> >>> 				docs.add(indexSearcher.doc(scoreDoc.doc));
> >>> 			}
> >>> 		} catch (ParseException e) {
> >>> 			log.warn("search: ParseException: {}",
e.getMessage());
> >>> 			if (log.isDebugEnabled())
> >>> 				log.warn("search: ParseException: ", e);
> >>> 			return Collections.emptyList();
> >>> 		} catch (IOException e) {
> >>> 			log.warn("search: IOException: ", e);
> >>> 			return Collections.emptyList();
> >>> 		} finally {
> >>> 			long durationMillis = System.currentTimeMillis() -
> startTimeMillis;
> >>> 			if (durationMillis > slowQueryLimit) {
> >>> 				log.warn("search: Slow query: {} ms,
query={},
> indexUsed={}",
> >>> 						new Object[] {
durationMillis, query,
> >>> indexSearcher.getIndexReader().directory() });
> >>> 			}
> >>> 			log.debug("search: query took {} ms",
durationMillis);
> >>> 		}
> >>> 		return docs;
> >>> 	}
> >>>
> >>>
> >>> Uwe Schindler wrote:
> >>>
> >>>
> >>>
> >>>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
> >>>>>>
> >>>>>> Have to verify that the last one is not by accident more than one
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>> request.
> >>>>>
> >>>>>
> >>>>>
> >>>>>> Will
> >>>>>> do the run again and then post the required info.
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>> The last figure shows, that IndexSearcher.searchWithFilter was
> called
> >>>>> twice
> >>>>> in contrast to the first figure, where IndexSearcher.search was
> called
> >>>>> only
> >>>>> once.
> >>>>>
> >>>>>
> >>>>>
> >>>> I forgot, searchWithFilter it is called per segment in 2.9. If it was
> only
> >>>> one search, you must have two segments and therefore no optimized
> index for
> >>>> this to be correct?
> >>>>
> >>>> Uwe
> >>>>
> >>>>
> >>>> ---------------------------------------------------------------------
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>>
> >>>>
> >>>>
> >>>
> >>>
> >>>
> >>
> >>
> >
> >
> >
> 
> 
> --
> - Mark
> 
> http://www.lucidimagination.com
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42406-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 17:34:07 2009
Return-Path: <java-user-return-42406-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22147 invoked from network); 16 Sep 2009 17:34:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 17:34:06 -0000
Received: (qmail 33068 invoked by uid 500); 16 Sep 2009 17:34:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32974 invoked by uid 500); 16 Sep 2009 17:34:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32964 invoked by uid 99); 16 Sep 2009 17:34:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:34:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:33:54 +0000
Received: by fg-out-1718.google.com with SMTP id d23so1175692fga.5
        for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 10:33:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=y6EkQK0YmQuWZzRjvQH4XZBEiUOE4NHQi7NFtZXWZ5Q=;
        b=osKICotD5dJ/sU9LYviYRggoJO8yAeDXlejvbXWgnZnrnUr0R28F9v7tomWK5sF7yF
         WbblL9jwryBzjMc6Vb7h1ISkQqk8+pzLZ6ATrHIQtRBGZZ5t490qV6IhkxIPRVlMFm2f
         stl9exxQGraB5Hn1SlcQjo+LhjHWGFl0JDh9Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=vvmRIPWaMRLkwolD4046JeM57q1UaYgXn3gUNuMpkYjUOT/I54ucVD47oDhdQnIK40
         dtvXQhYduRQnsIOaxOMHA5WwcUX89le2mI0s9faqA9OF+ROlfm71QAbvHsoLQF3VIirV
         O0v8RiPtwtsYXO5OEZxTB74Mk+oMMwehD16aQ=
Received: by 10.86.226.5 with SMTP id y5mr1952427fgg.36.1253122411202;
        Wed, 16 Sep 2009 10:33:31 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 4sm162970fge.29.2009.09.16.10.33.29
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 16 Sep 2009 10:33:30 -0700 (PDT)
Message-ID: <4AB12168.5020307@gmail.com>
Date: Wed, 16 Sep 2009 13:33:28 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA> <4FA107D4A2474911BC14488747D434E2@VEGA> <4AB119AB.80709@net-m.de> <4AB11A88.6080808@gmail.com> <4AB11CA3.6080708@gmail.com> <4AB11EDE.2000108@gmail.com> <FC0DD4E661314BADAA0D0834526B09EA@VEGA>
In-Reply-To: <FC0DD4E661314BADAA0D0834526B09EA@VEGA>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Yeah, thanks Uwe - I had read it quickly, but was just rereading and it
was sinking in. I hadn't cross correlated the issues yet.

Makes perfect sense. Very nice catch.

>Maybe we need some change to CachingWrapperFilter that caches the DocIdSets
>as before, but optionally would wrap it into an OpenBitSet, if it is not an
>instance of OBS.

So - do we address this for 2.9. This is a nasty performance trap, is it
not?

We recommend that you use both of these classes together - if it can
work like this though ...

Seems like a bug to me.

- mark

Uwe Schindler wrote:
> See my mail about the CachingWrapperFilter and QueryWrapperFilter, I think
> it explains this behaviour (and Thomas ran some warming queries before).
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>
>   
>> -----Original Message-----
>> From: Mark Miller [mailto:markrmiller@gmail.com]
>> Sent: Wednesday, September 16, 2009 7:23 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>>
>> Nevermind. I see advance wasn't around in 2.4. This is part of the
>> DocIdSetIterator changes.
>>
>> Anyway - either these are just not comparable runs, or there is a major
>> bug (which seems unlikely).
>>
>> Just to keep pointing out the obvious:
>>
>> 2.4 calls doc 195,000 times
>> 2.9 calls docId 1.4 million times
>>
>> That just doesn't jive.
>>
>> Mark Miller wrote:
>>     
>>> Notice that while DisjunctionScorer.advance and
>>> DisjuntionScorer.advanceAfterCurrent appear to be called
>>> in 2.9, in 2.4, I am only seeing DisjuntionScorer.advanceAfterCurrent
>>> called.
>>>
>>> Can someone explain that?
>>>
>>> Mark Miller wrote:
>>>
>>>       
>>>> Something is very odd about this if they both cover the same search and
>>>> the environ for both is identical. Even if one search was done twice,
>>>> and we divide the numbers for the new api by 2 - its still *very* odd.
>>>>
>>>> With 2.4, ScorerDocQueue.topDoc is called half a million times.
>>>> With 2.9, its called over 4 million times.
>>>>
>>>> Huh?
>>>>
>>>> Thomas Becker wrote:
>>>>
>>>>
>>>>         
>>>>> No it's only a single segment. But two calls. One doing a getHitsCount
>>>>>           
>> first and
>>     
>>>>> the other doing the actual search. I'll paste both methods below if
>>>>>           
>> someone's
>>     
>>>>> interested.
>>>>>
>>>>> Will dig into lucene's sources and compare 2.4 search behaviour for my
>>>>>           
>> case with
>>     
>>>>> 2.9 tomorrow. It was about time to get more into lucene-core sources
>>>>>           
>> anyhow. :)
>>     
>>>>> See you tomorrow guys and thanks a lot again! It's a pleasure.
>>>>>
>>>>> 	public int getHitsCount(String query, Filter filter) throws
>>>>> LuceneServiceException {
>>>>> 		log.debug("getHitsCount('{}, {}')", query, filter);
>>>>> 		if (StringUtils.isBlank(query)) {
>>>>> 			log.warn("getHitsCount: empty lucene query");
>>>>> 			return 0;
>>>>> 		}
>>>>> 		long startTimeMillis = System.currentTimeMillis();
>>>>> 		int count = 0;
>>>>>
>>>>> 		if (indexSearcher == null) {
>>>>> 			return 0;
>>>>> 		}
>>>>>
>>>>> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>>>>> 		Query q = null;
>>>>> 		try {
>>>>> 			q = createQuery(query);
>>>>> 			TopScoreDocCollector tsdc =
>>>>>           
>> TopScoreDocCollector.create(1, true);
>>     
>>>>> 			indexSearcher.search(q, filter, tsdc);
>>>>> 			count = tsdc.getTotalHits();
>>>>> 			log.info("getHitsCount: count = {}",count);
>>>>> 		} catch (ParseException ex) {
>>>>> 			throw new LuceneServiceException("invalid lucene
>>>>>           
> query:"
>   
>> + query, ex);
>>     
>>>>> 		} catch (IOException e) {
>>>>> 			throw new LuceneServiceException(" indexSearcher
>>>>>           
> could
>   
>> be corrupted", e);
>>     
>>>>> 		} finally {
>>>>> 			long durationMillis = System.currentTimeMillis() -
>>>>>           
>> startTimeMillis;
>>     
>>>>> 			if (durationMillis > slowQueryLimit) {
>>>>> 				log.warn("getHitsCount: Slow query: {} ms,
>>>>>           
>> query={}", durationMillis, query);
>>     
>>>>> 			}
>>>>> 			log.debug("getHitsCount: query took {} ms",
>>>>>           
>> durationMillis);
>>     
>>>>> 		}
>>>>> 		return count;
>>>>> 	}
>>>>>
>>>>> 	public List<Document> search(String query, Filter filter, Sort sort,
>>>>>           
>> int from,
>>     
>>>>> int size) throws LuceneServiceException {
>>>>> 		log.debug("{} search('{}', {}, {}, {}, {})", new Object[] {
>>>>>           
>> indexAlias, query,
>>     
>>>>> filter, sort, from, size });
>>>>> 		long startTimeMillis = System.currentTimeMillis();
>>>>>
>>>>> 		List<Document> docs = new ArrayList<Document>();
>>>>> 		if (indexSearcher == null) {
>>>>> 			return docs;
>>>>> 		}
>>>>> 		Query q = null;
>>>>> 		try {
>>>>> 			if (query == null) {
>>>>> 				log.warn("search: lucene query is null...");
>>>>> 				return docs;
>>>>> 			}
>>>>> 			q = createQuery(query);
>>>>> 			BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
>>>>> 			if (size < 0 || size > maxNumHits) {
>>>>> 				// set hard limit for numHits
>>>>> 				size = maxNumHits;
>>>>> 				if (log.isDebugEnabled())
>>>>> 					log.debug("search: Size set to
>>>>>           
> hardlimit: {}
>   
>> for query: {} with filter:
>>     
>>>>> {}", new Object[] { size, query, filter });
>>>>> 			}
>>>>> 			TopFieldCollector collector =
>>>>>           
>> TopFieldCollector.create(sort, size + from,
>>     
>>>>> true, false, false, true);
>>>>> 			indexSearcher.search(q, filter, collector);
>>>>> 			if(size > collector.getTotalHits())
>>>>> 				size = collector.getTotalHits();
>>>>> 			if (size > 100000)
>>>>> 				log.info("search: size: {} bigger than
>>>>>           
> 100.000 for
>   
>> query: {} with filter:
>>     
>>>>> {}", new Object[] { size, query, filter });
>>>>> 			TopDocs td = collector.topDocs(from, size);
>>>>> 			ScoreDoc[] scoreDocs = td.scoreDocs;
>>>>> 			for (ScoreDoc scoreDoc : scoreDocs) {
>>>>> 				docs.add(indexSearcher.doc(scoreDoc.doc));
>>>>> 			}
>>>>> 		} catch (ParseException e) {
>>>>> 			log.warn("search: ParseException: {}",
>>>>>           
> e.getMessage());
>   
>>>>> 			if (log.isDebugEnabled())
>>>>> 				log.warn("search: ParseException: ", e);
>>>>> 			return Collections.emptyList();
>>>>> 		} catch (IOException e) {
>>>>> 			log.warn("search: IOException: ", e);
>>>>> 			return Collections.emptyList();
>>>>> 		} finally {
>>>>> 			long durationMillis = System.currentTimeMillis() -
>>>>>           
>> startTimeMillis;
>>     
>>>>> 			if (durationMillis > slowQueryLimit) {
>>>>> 				log.warn("search: Slow query: {} ms,
>>>>>           
> query={},
>   
>> indexUsed={}",
>>     
>>>>> 						new Object[] {
>>>>>           
> durationMillis, query,
>   
>>>>> indexSearcher.getIndexReader().directory() });
>>>>> 			}
>>>>> 			log.debug("search: query took {} ms",
>>>>>           
> durationMillis);
>   
>>>>> 		}
>>>>> 		return docs;
>>>>> 	}
>>>>>
>>>>>
>>>>> Uwe Schindler wrote:
>>>>>
>>>>>
>>>>>
>>>>>           
>>>>>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
>>>>>>>>
>>>>>>>> Have to verify that the last one is not by accident more than one
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>>>>> request.
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>>>> Will
>>>>>>>> do the run again and then post the required info.
>>>>>>>>
>>>>>>>>
>>>>>>>>
>>>>>>>>                 
>>>>>>> The last figure shows, that IndexSearcher.searchWithFilter was
>>>>>>>               
>> called
>>     
>>>>>>> twice
>>>>>>> in contrast to the first figure, where IndexSearcher.search was
>>>>>>>               
>> called
>>     
>>>>>>> only
>>>>>>> once.
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>>               
>>>>>> I forgot, searchWithFilter it is called per segment in 2.9. If it was
>>>>>>             
>> only
>>     
>>>>>> one search, you must have two segments and therefore no optimized
>>>>>>             
>> index for
>>     
>>>>>> this to be correct?
>>>>>>
>>>>>> Uwe
>>>>>>
>>>>>>
>>>>>> ---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>             
>>>>>
>>>>>           
>>>>         
>>>
>>>       
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42407-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 17:38:36 2009
Return-Path: <java-user-return-42407-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23165 invoked from network); 16 Sep 2009 17:38:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 17:38:35 -0000
Received: (qmail 38086 invoked by uid 500); 16 Sep 2009 17:38:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38004 invoked by uid 500); 16 Sep 2009 17:38:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37994 invoked by uid 99); 16 Sep 2009 17:38:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:38:33 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 17:38:23 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id EE7AFD36006
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 19:38:01 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id mbo-ne+sQn2z for <java-user@lucene.apache.org>;
	Wed, 16 Sep 2009 19:37:51 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 02DF3D36004
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 19:37:50 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB112D6.9010003@net-m.de> <A061303D20ED4141BC2040931698E120@VEGA> <4FA107D4A2474911BC14488747D434E2@VEGA> <4AB119AB.80709@net-m.de> <4AB11A88.6080808@gmail.com> <4AB11CA3.6080708@gmail.com> <4AB11EDE.2000108@gmail.com> <FC0DD4E661314BADAA0D0834526B09EA@VEGA> <4AB12168.5020307@gmail.com>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Wed, 16 Sep 2009 19:37:50 +0200
Message-ID: <9B8EBD5077554396AE34BF458D493F41@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AB12168.5020307@gmail.com>
Thread-Index: Aco28+m+N6Au8tzCQZu144j6j4cwcgAACwtQ
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

I am currently preparing a patch for CachingWrapperFilter that has a boolean
ctor parameter (useOpenBitSetCache) and the method getDocIdSet will then do
what QueryWrapperFilter did before LUCENE-1427.

I would not do this in QueryWrapperFilter like before, because it would
slowdown MultiTermQuery if no caching is used and the constantScore/Boolean
rewrite mode is active.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Mark Miller [mailto:markrmiller@gmail.com]
> Sent: Wednesday, September 16, 2009 7:33 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
> 
> Yeah, thanks Uwe - I had read it quickly, but was just rereading and it
> was sinking in. I hadn't cross correlated the issues yet.
> 
> Makes perfect sense. Very nice catch.
> 
> >Maybe we need some change to CachingWrapperFilter that caches the
> DocIdSets
> >as before, but optionally would wrap it into an OpenBitSet, if it is not
> an
> >instance of OBS.
> 
> So - do we address this for 2.9. This is a nasty performance trap, is it
> not?
> 
> We recommend that you use both of these classes together - if it can
> work like this though ...
> 
> Seems like a bug to me.
> 
> - mark
> 
> Uwe Schindler wrote:
> > See my mail about the CachingWrapperFilter and QueryWrapperFilter, I
> think
> > it explains this behaviour (and Thomas ran some warming queries before).
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> >
> >
> >> -----Original Message-----
> >> From: Mark Miller [mailto:markrmiller@gmail.com]
> >> Sent: Wednesday, September 16, 2009 7:23 PM
> >> To: java-user@lucene.apache.org
> >> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
> >>
> >> Nevermind. I see advance wasn't around in 2.4. This is part of the
> >> DocIdSetIterator changes.
> >>
> >> Anyway - either these are just not comparable runs, or there is a major
> >> bug (which seems unlikely).
> >>
> >> Just to keep pointing out the obvious:
> >>
> >> 2.4 calls doc 195,000 times
> >> 2.9 calls docId 1.4 million times
> >>
> >> That just doesn't jive.
> >>
> >> Mark Miller wrote:
> >>
> >>> Notice that while DisjunctionScorer.advance and
> >>> DisjuntionScorer.advanceAfterCurrent appear to be called
> >>> in 2.9, in 2.4, I am only seeing DisjuntionScorer.advanceAfterCurrent
> >>> called.
> >>>
> >>> Can someone explain that?
> >>>
> >>> Mark Miller wrote:
> >>>
> >>>
> >>>> Something is very odd about this if they both cover the same search
> and
> >>>> the environ for both is identical. Even if one search was done twice,
> >>>> and we divide the numbers for the new api by 2 - its still *very*
> odd.
> >>>>
> >>>> With 2.4, ScorerDocQueue.topDoc is called half a million times.
> >>>> With 2.9, its called over 4 million times.
> >>>>
> >>>> Huh?
> >>>>
> >>>> Thomas Becker wrote:
> >>>>
> >>>>
> >>>>
> >>>>> No it's only a single segment. But two calls. One doing a
> getHitsCount
> >>>>>
> >> first and
> >>
> >>>>> the other doing the actual search. I'll paste both methods below if
> >>>>>
> >> someone's
> >>
> >>>>> interested.
> >>>>>
> >>>>> Will dig into lucene's sources and compare 2.4 search behaviour for
> my
> >>>>>
> >> case with
> >>
> >>>>> 2.9 tomorrow. It was about time to get more into lucene-core sources
> >>>>>
> >> anyhow. :)
> >>
> >>>>> See you tomorrow guys and thanks a lot again! It's a pleasure.
> >>>>>
> >>>>> 	public int getHitsCount(String query, Filter filter) throws
> >>>>> LuceneServiceException {
> >>>>> 		log.debug("getHitsCount('{}, {}')", query, filter);
> >>>>> 		if (StringUtils.isBlank(query)) {
> >>>>> 			log.warn("getHitsCount: empty lucene
query");
> >>>>> 			return 0;
> >>>>> 		}
> >>>>> 		long startTimeMillis = System.currentTimeMillis();
> >>>>> 		int count = 0;
> >>>>>
> >>>>> 		if (indexSearcher == null) {
> >>>>> 			return 0;
> >>>>> 		}
> >>>>>
> >>>>> 		BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
> >>>>> 		Query q = null;
> >>>>> 		try {
> >>>>> 			q = createQuery(query);
> >>>>> 			TopScoreDocCollector tsdc =
> >>>>>
> >> TopScoreDocCollector.create(1, true);
> >>
> >>>>> 			indexSearcher.search(q, filter, tsdc);
> >>>>> 			count = tsdc.getTotalHits();
> >>>>> 			log.info("getHitsCount: count = {}",count);
> >>>>> 		} catch (ParseException ex) {
> >>>>> 			throw new LuceneServiceException("invalid
lucene
> >>>>>
> > query:"
> >
> >> + query, ex);
> >>
> >>>>> 		} catch (IOException e) {
> >>>>> 			throw new LuceneServiceException("
indexSearcher
> >>>>>
> > could
> >
> >> be corrupted", e);
> >>
> >>>>> 		} finally {
> >>>>> 			long durationMillis =
System.currentTimeMillis() -
> >>>>>
> >> startTimeMillis;
> >>
> >>>>> 			if (durationMillis > slowQueryLimit) {
> >>>>> 				log.warn("getHitsCount: Slow query:
{} ms,
> >>>>>
> >> query={}", durationMillis, query);
> >>
> >>>>> 			}
> >>>>> 			log.debug("getHitsCount: query took {} ms",
> >>>>>
> >> durationMillis);
> >>
> >>>>> 		}
> >>>>> 		return count;
> >>>>> 	}
> >>>>>
> >>>>> 	public List<Document> search(String query, Filter filter,
Sort
> sort,
> >>>>>
> >> int from,
> >>
> >>>>> int size) throws LuceneServiceException {
> >>>>> 		log.debug("{} search('{}', {}, {}, {}, {})", new
> Object[] {
> >>>>>
> >> indexAlias, query,
> >>
> >>>>> filter, sort, from, size });
> >>>>> 		long startTimeMillis = System.currentTimeMillis();
> >>>>>
> >>>>> 		List<Document> docs = new ArrayList<Document>();
> >>>>> 		if (indexSearcher == null) {
> >>>>> 			return docs;
> >>>>> 		}
> >>>>> 		Query q = null;
> >>>>> 		try {
> >>>>> 			if (query == null) {
> >>>>> 				log.warn("search: lucene query is
null...");
> >>>>> 				return docs;
> >>>>> 			}
> >>>>> 			q = createQuery(query);
> >>>>>
BooleanQuery.setMaxClauseCount(MAXCLAUSECOUNT);
> >>>>> 			if (size < 0 || size > maxNumHits) {
> >>>>> 				// set hard limit for numHits
> >>>>> 				size = maxNumHits;
> >>>>> 				if (log.isDebugEnabled())
> >>>>> 					log.debug("search: Size set
to
> >>>>>
> > hardlimit: {}
> >
> >> for query: {} with filter:
> >>
> >>>>> {}", new Object[] { size, query, filter });
> >>>>> 			}
> >>>>> 			TopFieldCollector collector =
> >>>>>
> >> TopFieldCollector.create(sort, size + from,
> >>
> >>>>> true, false, false, true);
> >>>>> 			indexSearcher.search(q, filter, collector);
> >>>>> 			if(size > collector.getTotalHits())
> >>>>> 				size = collector.getTotalHits();
> >>>>> 			if (size > 100000)
> >>>>> 				log.info("search: size: {} bigger
than
> >>>>>
> > 100.000 for
> >
> >> query: {} with filter:
> >>
> >>>>> {}", new Object[] { size, query, filter });
> >>>>> 			TopDocs td = collector.topDocs(from, size);
> >>>>> 			ScoreDoc[] scoreDocs = td.scoreDocs;
> >>>>> 			for (ScoreDoc scoreDoc : scoreDocs) {
> >>>>>
docs.add(indexSearcher.doc(scoreDoc.doc));
> >>>>> 			}
> >>>>> 		} catch (ParseException e) {
> >>>>> 			log.warn("search: ParseException: {}",
> >>>>>
> > e.getMessage());
> >
> >>>>> 			if (log.isDebugEnabled())
> >>>>> 				log.warn("search: ParseException: ",
e);
> >>>>> 			return Collections.emptyList();
> >>>>> 		} catch (IOException e) {
> >>>>> 			log.warn("search: IOException: ", e);
> >>>>> 			return Collections.emptyList();
> >>>>> 		} finally {
> >>>>> 			long durationMillis =
System.currentTimeMillis() -
> >>>>>
> >> startTimeMillis;
> >>
> >>>>> 			if (durationMillis > slowQueryLimit) {
> >>>>> 				log.warn("search: Slow query: {} ms,
> >>>>>
> > query={},
> >
> >> indexUsed={}",
> >>
> >>>>> 						new Object[] {
> >>>>>
> > durationMillis, query,
> >
> >>>>> indexSearcher.getIndexReader().directory() });
> >>>>> 			}
> >>>>> 			log.debug("search: query took {} ms",
> >>>>>
> > durationMillis);
> >
> >>>>> 		}
> >>>>> 		return docs;
> >>>>> 	}
> >>>>>
> >>>>>
> >>>>> Uwe Schindler wrote:
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>>>>> http://ankeschwarzer.de/tmp/lucene_29_newapi_mmap_singlereq.png
> >>>>>>>>
> >>>>>>>> Have to verify that the last one is not by accident more than one
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>> request.
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>> Will
> >>>>>>>> do the run again and then post the required info.
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>> The last figure shows, that IndexSearcher.searchWithFilter was
> >>>>>>>
> >> called
> >>
> >>>>>>> twice
> >>>>>>> in contrast to the first figure, where IndexSearcher.search was
> >>>>>>>
> >> called
> >>
> >>>>>>> only
> >>>>>>> once.
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>> I forgot, searchWithFilter it is called per segment in 2.9. If it
> was
> >>>>>>
> >> only
> >>
> >>>>>> one search, you must have two segments and therefore no optimized
> >>>>>>
> >> index for
> >>
> >>>>>> this to be correct?
> >>>>>>
> >>>>>> Uwe
> >>>>>>
> >>>>>>
> >>>>>> -------------------------------------------------------------------
> --
> >>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>
> >>>>>
> >>>>
> >>>
> >>>
> >> --
> >> - Mark
> >>
> >> http://www.lucidimagination.com
> >>
> >>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> 
> 
> --
> - Mark
> 
> http://www.lucidimagination.com
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42408-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 16 18:09:29 2009
Return-Path: <java-user-return-42408-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36319 invoked from network); 16 Sep 2009 18:09:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Sep 2009 18:09:29 -0000
Received: (qmail 88803 invoked by uid 500); 16 Sep 2009 18:09:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88738 invoked by uid 500); 16 Sep 2009 18:09:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88727 invoked by uid 99); 16 Sep 2009 18:09:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 18:09:26 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Sep 2009 18:09:16 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 667F2D36007
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 20:08:55 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id ZR2D9DvDemPw for <java-user@lucene.apache.org>;
	Wed, 16 Sep 2009 20:08:46 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 78BA5D36006
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 20:08:46 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4AAF96E6.7000909@net-m.de> <4AAF9700.9010509@net-m.de> <4AAF98D1.5010207@net-m.de> <4AAF9B03.1040708@gmail.com> <4AAF9F17.2030307@net-m.de> <4AAFA0EA.2090300@gmail.com> <4AAFA800.5040600@net-m.de> <4AAFAA41.1070103@gmail.com> <4AAFAC95.4050307@gmail.com> <4AAFB183.4070006@net-m.de> <4AAFB2EB.4020403@gmail.com> <4AAFB62E.10403@gmail.com> <4AB0FEDB.50504@net-m.de> <4AB110E3.6040004@gmail.com> <4AB11896.4080901@net-m.de>
Subject: RE: lucene 2.9.0RC4 slower than 2.4.1?
Date: Wed, 16 Sep 2009 20:08:46 +0200
Message-ID: <FE237B6777D749549FF0ABF12C8EA9F9@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AB11896.4080901@net-m.de>
Thread-Index: Aco27qh33DF0MnSYQ1agBiUqLaVR3wACdVGg
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Thomas,

I think we found the root of the problem. We opened
https://issues.apache.org/jira/browse/LUCENE-1911 .

Could you please try the attached patch, if it solves your problems? It =
has
to do with the work of CachingWrapperFilter and QueryWrapperFilter =
together,
which changed in 2.9.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Thomas Becker [mailto:thomas.becker@net-m.de]
> Sent: Wednesday, September 16, 2009 6:56 PM
> To: java-user@lucene.apache.org
> Subject: Re: lucene 2.9.0RC4 slower than 2.4.1?
>=20
> So here's a debug message showing the query:
>=20
> 2009-09-16 18:53:59,642 [DEBUG] [http-8440-2] [] [2144122] []
> service.impl.LuceneBaseService: items search('viewable:(FINDALL 0 1 2 =
)',
> BooleanFilter( +CachingWrapperFilter(QueryWrapperFilter(+issalesallo
> wed:true))
> +CachingWrapperFilter(QueryWrapperFilter(licenseGroupKeys:lablxrox))
> +CachingWrapperFilter(QueryWrapperFilter(+(viewable:1 viewable:2)))
> +CachingWrapperFilter(QueryWrapperFilter(+contentReposit
> oryIds:146))
> +CachingWrapperFilter(QueryWrapperFilter(+contentGroupIds:14554))
> -
> =
CachingWrapperFilter(QueryWrapperFilter(digitalReleaseDate:{lablxrox20090=
9
> 16 TO
> lablxrox99999999} digitalDeleteDate:[lablxro
> x19000101 TO lablxrox20090916]))
> -CachingWrapperFilter(QueryWrapperFilter(+excludedContractIds:all))
> =
-CachingWrapperFilter(QueryWrapperFilter(+excludedContractIds:2144122))),=

> <custom:"position": null>, 0,
>  16)
>=20
> By the way, will it make sense to move this into a jira issue? It'll =
get
> quite
> tough to find the right information already since this thread is =
growing
> quite fast.
>=20
> Mark Miller wrote:
> > bq. I'll do some profiling now again and let you know the results.
> >
> > Great - it will be interesting to see the results. My guess, based =
on
> > the 2.9 new api profiling, is that your queries may not be agreeing =
with
> > some of the changes somehow. Along with the profiling, can you fill =
us
> > in on the query types you are using as well? (eg qualities)
> >
> > And grab invocations if its possible.
> >
>=20
> --
> Thomas Becker
> Senior JEE Developer
>=20
> net mobile AG
> Zollhof 17
> 40221 D=FCsseldorf
> GERMANY
>=20
> Phone:    +49 211 97020-195
> Fax:      +49 211 97020-949
> Mobile:   +49 173 5146567 (private)
> E-Mail:   mailto:thomas.becker@net-m.de
> Internet: http://www.net-m.de
>=20
> Registergericht:  Amtsgericht D=FCsseldorf, HRB 48022
> Vorstand:         Theodor Niehues (Vorsitzender), Frank Hartmann,
>                  Kai Markus Kulas, Dieter Plassmann
> Vorsitzender des
> Aufsichtsrates:   Dr. Michael Briem
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42409-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 04:26:02 2009
Return-Path: <java-user-return-42409-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85258 invoked from network); 17 Sep 2009 04:26:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 04:26:02 -0000
Received: (qmail 75955 invoked by uid 500); 17 Sep 2009 04:25:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75833 invoked by uid 500); 17 Sep 2009 04:25:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75823 invoked by uid 99); 17 Sep 2009 04:25:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 04:25:58 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO homiemail-a12.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 04:25:49 +0000
Received: from [10.0.1.2] (72-254-100-91.client.stsn.net [72.254.100.91])
	by homiemail-a12.g.dreamhost.com (Postfix) with ESMTPA id D10EE714058
	for <java-user@lucene.apache.org>; Wed, 16 Sep 2009 21:25:27 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1076)
Subject: Re: Getting payload data in search results
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <7B2F9411AE05FE44B327EF6BC4FD7A53012155565A43@LLE2K7-BE01.mitll.ad.local>
Date: Wed, 16 Sep 2009 21:25:26 -0700
Content-Transfer-Encoding: 7bit
Message-Id: <341ED4A2-E58C-405C-AB44-B136CE5C5704@apache.org>
References: <7B2F9411AE05FE44B327EF6BC4FD7A53012155565A43@LLE2K7-BE01.mitll.ad.local>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1076)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 14, 2009, at 2:42 PM, Sherrill, Delsey wrote:

> I think I have a problem that would benefit from the new term  
> payload feature, but I'm not sure.  Every example of payload usage  
> that I can find factors them into the scoring, but doesn't return  
> them with the search results.
>
> In my case, I don't need the payload to affect scoring, but I do  
> need to get a list for each search result containing all the  
> payloads for terms in that document that matched the query.
>
> Let's say I have the following two documents, divided into chunks as  
> shown, and the chunk ids are added as payloads on each term:
>
> DocA, chunk1: "blue blue red orange"
> DocA, chunk2: "purple orange"
>
> DocB, chunk3: "blue orange blue"
> DocB, chunk4: "orange green red"
> DocB, chunk5: "blue red purple"
>
> The desired results of a search for "blue" would then be:
>
> DocB, some score, (chunk3, chunk5)
> DocA, some lower score, (chunk1)
>
> Are payloads the right answer here?  Is there perhaps some other way  
> to get the chunk ids into my search results?

Seems like it should work.

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42410-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 12:07:39 2009
Return-Path: <java-user-return-42410-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21634 invoked from network); 17 Sep 2009 12:07:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 12:07:39 -0000
Received: (qmail 97591 invoked by uid 500); 17 Sep 2009 12:07:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97540 invoked by uid 500); 17 Sep 2009 12:07:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97530 invoked by uid 99); 17 Sep 2009 12:07:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 12:07:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of trewig@mufin.com designates 195.214.216.123 as permitted sender)
Received: from [195.214.216.123] (HELO mx3.de.magix.net) (195.214.216.123)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 12:07:24 +0000
Received: from [192.168.1.18] (port=14089)
	by mx3.de.magix.net with esmtpa (Exim 4.69)
	(envelope-from <trewig@mufin.com>)
	id 1MoFlP-0007AH-DX
	for java-user@lucene.apache.org; Thu, 17 Sep 2009 14:07:03 +0200
Message-ID: <4AB2264F.3050707@mufin.com>
Date: Thu, 17 Sep 2009 14:06:39 +0200
From: Thomas Rewig <trewig@mufin.com>
Organization: mufin
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Problems with ItemBasedRecommender with Lucene
References: <4AB0EC9D.3050002@mufin.com> <4001AD6D-7371-4508-AD4B-C0E6BC92D799@apache.org>
In-Reply-To: <4001AD6D-7371-4508-AD4B-C0E6BC92D799@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Exim-Connect-IP: 192.168.1.18
X-SA-Exim-Mail-From: trewig@mufin.com
X-SA-Exim-Scanned: No (on mx3.de.magix.net); SAEximRunCond expanded to false
X-Virus-Checked: Checked by ClamAV on apache.org

Oh, I overlooked the simplest way to do that. You're right, tokens are 
the key to this problem. It works pretty well.
It would be perfect if I use payloads. I read your advice 
http://www.lucidimagination.com/blog/category/payloads/.

You store the payloads with your PayLoadAnalyzer in this way:

    //Store both position and offset information
    Field text = new Field("body", DOCS[i], Field.Store.NO, 
Field.Index.ANALYZED);

Is there a chance to use

    Field.Index.ANALYZED_NO_NORMS

because otherwise my index would be much to big or are normes necessary 
for Payloads?

You use Lucene 2.9 is there a way to do this with Lucene 2.4.1 because I 
can't find e.g. the "PayloadEncoder" or do I have to wait for the release?

Regards Thomas
>
> You might want to ask on mahout-user, but I'm guessing Ted didn't mean 
> a new field for every item-item, but instead to represent them as 
> tokens and then create the corresponding appropriate queries (seems 
> like payloads may be useful, or function queries).  That to me is the 
> only way you would achieve the sparseness savings you are after.
>
> -Grant
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids) 
> using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>> Hello,
>>
>> I build a "real time ItemBasedRecommender" based on a users history 
>> and a (sparse) item similarity matrix with lucene. Some time ago Ted 
>> Dunning recommended me this approach at the mahout mailing list to 
>> create a ItemBasedRecommender:
>>
>> "It is actually very easy to do. The output of the recommendation 
>> off-line process is generally a sparse matrix of item-item links. 
>> Each line of this sparse matrix can be considered a document in 
>> creating a Lucene index. You will have to use a correct analyzer and 
>> a line by line document segmenter, but that is trivial. Then 
>> recommendation is a simple query step."
>>
>> So for 100000 items it works fine - but for 1 million items the 
>> Indexing fails and I have no idea how to avoid this. Maybe you can 
>> give me a hint.
>>
>> First I create a Item-Item-Similaritymatrix with mahout's taste and 
>> in the second step I index it. The matrix is sparce because only 
>> Item-Item-Relations with a high correlation will be saved.
>>
>> Here are the Code Snippets for this indexing :
>>           CachedRowSetImpl rowSetMainItemList = null; // Mapping of 
>> Items
>>       ArrayList<String> listBelongingItems = null; // Belonging and 
>> highest correlating Items for a MainItem
>>       Document aDocument = null;
>>       Field aField = null;
>>       Field aField1 = null;
>>             Analyzer aAnalyzer  = new StandardAnalyzer();
>>       IndexWriter aWriter = new IndexWriter(this.indexDirectory, 
>> aAnalyzer, true, IndexWriter.MaxFieldLength.UNLIMITED);
>>             aWriter.setRAMBufferSizeMB(48);
>>             rowSetMainItemList = getRowSetItemList(); //get all Items
>>             aField1 = new Field("Item1", "", 
>> Field.Store.YES,Field.Index.ANALYZED); // reuse this field
>>             while (rowSetMainItemList.next()){
>>                         aDocument = new Document();
>>                             
>> aField1.setValue(rowSetMainItemList.getString(1));              
>> aDocument.add(aField1);
>>                     listBelongingItems = 
>> getRowSetBelongingItems(rowSetMainItemList.getString(1)); // get the 
>> most similar Items fpr a Item
>>           Iterator<String> itrBelongingItems = 
>> listBelongingItems.iterator();
>>                         while (itrBelongingItems.hasNext()){
>>                                 String strBelongingItem = (String) 
>> itrBelongingItems.next();
>>               //No reuse of Field possible because of different 
>> fieldnames:
>>               aField = new Field(strBelongingItem,"1", 
>> Field.Store.NO,Field.Index.ANALYZED_NO_NORMS);
>>               aDocument.add(aField);
>>           }
>>                         
>> aWriter.addDocument(aDocument);                        }
>>             aWriter.optimize();
>>       aWriter.close();
>>                 aAnalyzer.close();
>>              Actually the Field of the BelongingItem have to be 
>> boosted with the MainItem-BelongingItem-Correlation-Value to get 
>> accurate Recommendations, but here the Index would be about 80 GByte 
>> for 6 million items... without it will only be about 2Gbyte.
>> But under the condition that only relevant Correlations will be saved 
>> in the Similaritymatrix the recommendation quality will be good enough.
>>
>> The item recommendation for a User is a simple BooleanQuery with 
>> userhistory boosted TermQuerys. Here I search for documents with the 
>> largest Correspondence regarding the userhistory.  So I  look in 
>> which Documents the most Fields with the name of a BelongingItem are 
>> set (with value 1) and recommend the "key"-value which was set in 
>> aField1("Item"...)
>> Whatever, as i mentioned it worked for a Number of 100000 Items.  But 
>> if there are 1 million items the indexing crash after a while with
>>
>> Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
>>       at java.util.HashMap.resize(HashMap.java:462)
>>       at java.util.HashMap.addEntry(HashMap.java:755)
>>       at java.util.HashMap.put(HashMap.java:385)
>>       at java.util.HashSet.add(HashSet.java:200)
>>       at org.apache.lucene.index.DocInverter.flush(DocInverter.java:66)
>>       at 
>> org.apache.lucene.index.DocFieldConsumers.flush(DocFieldConsumers.java:75) 
>>
>>       at 
>> org.apache.lucene.index.DocFieldProcessor.flush(DocFieldProcessor.java:60) 
>>
>>       at 
>> org.apache.lucene.index.DocumentsWriter.flush(DocumentsWriter.java:574)
>>       at 
>> org.apache.lucene.index.IndexWriter.doFlush(IndexWriter.java:3540)
>>       at 
>> org.apache.lucene.index.IndexWriter.flush(IndexWriter.java:3450)
>>       at 
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1937)
>>       at 
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1895)
>>
>> if I increase the Java heap space there will be a "OutOfMemoryError: 
>> /PermGen space" /Exception.
>> If I increase the PermGen Space -XX:MaxPermSize=1024m the Java heap 
>> space is still the limiting factor.
>> I can increase both to the maximum of my system  - 20Gbyte Ram are 
>> available - but this doesn't solve the problem.
>>
>> Through indexing the ram-memory consumtion growing steadily until it 
>> chrashes. It does not matter if I index the data in segments with 
>> open and close each time the IndexWriter or if I optimize the index 
>> periodically - the ram-memory consumtion is still growing ...
>>
>> I think the problem is, that I can't reuse the field aField for my 
>> approach and it seems the GC doesn't collect it. Extrapolated thats 
>> 600 Million unique fields...
>>
>> I'm using lucene 2.4.1 and java version "1.6.0_16".
>>
>> Do anyone have an idea to avoid the growing memory. Or do somebody 
>> know an other approche for a "realtime Item based Recommender" with 
>> Lucene?



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42411-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 13:08:21 2009
Return-Path: <java-user-return-42411-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47480 invoked from network); 17 Sep 2009 13:08:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 13:08:21 -0000
Received: (qmail 66861 invoked by uid 500); 17 Sep 2009 13:08:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66759 invoked by uid 500); 17 Sep 2009 13:08:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66749 invoked by uid 99); 17 Sep 2009 13:08:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 13:08:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO homiemail-a15.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 13:08:06 +0000
Received: from [10.9.245.248] (72-254-61-56.client.stsn.net [72.254.61.56])
	by homiemail-a15.g.dreamhost.com (Postfix) with ESMTPA id 35DC976C06A
	for <java-user@lucene.apache.org>; Thu, 17 Sep 2009 06:07:42 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1076)
Subject: Re: Problems with ItemBasedRecommender with Lucene
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <4AB2264F.3050707@mufin.com>
Date: Thu, 17 Sep 2009 06:07:40 -0700
Content-Transfer-Encoding: 7bit
Message-Id: <CC30FE82-6646-4CE8-8359-CC4209DFE404@apache.org>
References: <4AB0EC9D.3050002@mufin.com> <4001AD6D-7371-4508-AD4B-C0E6BC92D799@apache.org> <4AB2264F.3050707@mufin.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1076)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 17, 2009, at 5:06 AM, Thomas Rewig wrote:

> Oh, I overlooked the simplest way to do that. You're right, tokens  
> are the key to this problem. It works pretty well.
> It would be perfect if I use payloads. I read your advice http://www.lucidimagination.com/blog/category/payloads/ 
> .
>
> You store the payloads with your PayLoadAnalyzer in this way:
>
>   //Store both position and offset information
>   Field text = new Field("body", DOCS[i], Field.Store.NO,  
> Field.Index.ANALYZED);
>
> Is there a chance to use
>
>   Field.Index.ANALYZED_NO_NORMS

I don't see why not.

>
> because otherwise my index would be much to big or are normes  
> necessary for Payloads?
>
> You use Lucene 2.9 is there a way to do this with Lucene 2.4.1  
> because I can't find e.g. the "PayloadEncoder" or do I have to wait  
> for the release?

I'd bet that patch wouldn't be too hard to backport, since it lives in  
contrib/analyzers.  All it does anyway is give a generic notion to  
adding a payload based on a data type.  Payloads are in 2.4.1 and all  
they are is a byte array, so it should be easy enough to write a  
simple Token Filter that does what you want.

>
> Regards Thomas
>>
>> You might want to ask on mahout-user, but I'm guessing Ted didn't  
>> mean a new field for every item-item, but instead to represent them  
>> as tokens and then create the corresponding appropriate queries  
>> (seems like payloads may be useful, or function queries).  That to  
>> me is the only way you would achieve the sparseness savings you are  
>> after.
>>
>> -Grant
>>
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>>
>> Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
>> using Solr/Lucene:
>> http://www.lucidimagination.com/search
>>
>>> Hello,
>>>
>>> I build a "real time ItemBasedRecommender" based on a users  
>>> history and a (sparse) item similarity matrix with lucene. Some  
>>> time ago Ted Dunning recommended me this approach at the mahout  
>>> mailing list to create a ItemBasedRecommender:
>>>
>>> "It is actually very easy to do. The output of the recommendation  
>>> off-line process is generally a sparse matrix of item-item links.  
>>> Each line of this sparse matrix can be considered a document in  
>>> creating a Lucene index. You will have to use a correct analyzer  
>>> and a line by line document segmenter, but that is trivial. Then  
>>> recommendation is a simple query step."
>>>
>>> So for 100000 items it works fine - but for 1 million items the  
>>> Indexing fails and I have no idea how to avoid this. Maybe you can  
>>> give me a hint.
>>>
>>> First I create a Item-Item-Similaritymatrix with mahout's taste  
>>> and in the second step I index it. The matrix is sparce because  
>>> only Item-Item-Relations with a high correlation will be saved.
>>>
>>> Here are the Code Snippets for this indexing :
>>>          CachedRowSetImpl rowSetMainItemList = null; // Mapping of  
>>> Items
>>>      ArrayList<String> listBelongingItems = null; // Belonging and  
>>> highest correlating Items for a MainItem
>>>      Document aDocument = null;
>>>      Field aField = null;
>>>      Field aField1 = null;
>>>            Analyzer aAnalyzer  = new StandardAnalyzer();
>>>      IndexWriter aWriter = new IndexWriter(this.indexDirectory,  
>>> aAnalyzer, true, IndexWriter.MaxFieldLength.UNLIMITED);
>>>            aWriter.setRAMBufferSizeMB(48);
>>>            rowSetMainItemList = getRowSetItemList(); //get all Items
>>>            aField1 = new Field("Item1", "",  
>>> Field.Store.YES,Field.Index.ANALYZED); // reuse this field
>>>            while (rowSetMainItemList.next()){
>>>                        aDocument = new Document();
>>>                            aField1.setValue 
>>> (rowSetMainItemList.getString(1));              aDocument.add 
>>> (aField1);
>>>                    listBelongingItems = getRowSetBelongingItems 
>>> (rowSetMainItemList.getString(1)); // get the most similar Items  
>>> fpr a Item
>>>          Iterator<String> itrBelongingItems =  
>>> listBelongingItems.iterator();
>>>                        while (itrBelongingItems.hasNext()){
>>>                                String strBelongingItem = (String)  
>>> itrBelongingItems.next();
>>>              //No reuse of Field possible because of different  
>>> fieldnames:
>>>              aField = new Field(strBelongingItem,"1",  
>>> Field.Store.NO,Field.Index.ANALYZED_NO_NORMS);
>>>              aDocument.add(aField);
>>>          }
>>>                        aWriter.addDocument 
>>> (aDocument);                        }
>>>            aWriter.optimize();
>>>      aWriter.close();
>>>                aAnalyzer.close();
>>>             Actually the Field of the BelongingItem have to be  
>>> boosted with the MainItem-BelongingItem-Correlation-Value to get  
>>> accurate Recommendations, but here the Index would be about 80  
>>> GByte for 6 million items... without it will only be about 2Gbyte.
>>> But under the condition that only relevant Correlations will be  
>>> saved in the Similaritymatrix the recommendation quality will be  
>>> good enough.
>>>
>>> The item recommendation for a User is a simple BooleanQuery with  
>>> userhistory boosted TermQuerys. Here I search for documents with  
>>> the largest Correspondence regarding the userhistory.  So I  look  
>>> in which Documents the most Fields with the name of a  
>>> BelongingItem are set (with value 1) and recommend the "key"-value  
>>> which was set in aField1("Item"...)
>>> Whatever, as i mentioned it worked for a Number of 100000 Items.   
>>> But if there are 1 million items the indexing crash after a while  
>>> with
>>>
>>> Exception in thread "main" java.lang.OutOfMemoryError: Java heap  
>>> space
>>>      at java.util.HashMap.resize(HashMap.java:462)
>>>      at java.util.HashMap.addEntry(HashMap.java:755)
>>>      at java.util.HashMap.put(HashMap.java:385)
>>>      at java.util.HashSet.add(HashSet.java:200)
>>>      at org.apache.lucene.index.DocInverter.flush(DocInverter.java: 
>>> 66)
>>>      at org.apache.lucene.index.DocFieldConsumers.flush 
>>> (DocFieldConsumers.java:75)
>>>      at org.apache.lucene.index.DocFieldProcessor.flush 
>>> (DocFieldProcessor.java:60)
>>>      at org.apache.lucene.index.DocumentsWriter.flush 
>>> (DocumentsWriter.java:574)
>>>      at org.apache.lucene.index.IndexWriter.doFlush 
>>> (IndexWriter.java:3540)
>>>      at org.apache.lucene.index.IndexWriter.flush(IndexWriter.java: 
>>> 3450)
>>>      at org.apache.lucene.index.IndexWriter.addDocument 
>>> (IndexWriter.java:1937)
>>>      at org.apache.lucene.index.IndexWriter.addDocument 
>>> (IndexWriter.java:1895)
>>>
>>> if I increase the Java heap space there will be a  
>>> "OutOfMemoryError: /PermGen space" /Exception.
>>> If I increase the PermGen Space -XX:MaxPermSize=1024m the Java  
>>> heap space is still the limiting factor.
>>> I can increase both to the maximum of my system  - 20Gbyte Ram are  
>>> available - but this doesn't solve the problem.
>>>
>>> Through indexing the ram-memory consumtion growing steadily until  
>>> it chrashes. It does not matter if I index the data in segments  
>>> with open and close each time the IndexWriter or if I optimize the  
>>> index periodically - the ram-memory consumtion is still growing ...
>>>
>>> I think the problem is, that I can't reuse the field aField for my  
>>> approach and it seems the GC doesn't collect it. Extrapolated  
>>> thats 600 Million unique fields...
>>>
>>> I'm using lucene 2.4.1 and java version "1.6.0_16".
>>>
>>> Do anyone have an idea to avoid the growing memory. Or do somebody  
>>> know an other approche for a "realtime Item based Recommender"  
>>> with Lucene?
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42412-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 13:50:46 2009
Return-Path: <java-user-return-42412-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61789 invoked from network); 17 Sep 2009 13:50:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 13:50:46 -0000
Received: (qmail 36628 invoked by uid 500); 17 Sep 2009 13:50:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36556 invoked by uid 500); 17 Sep 2009 13:50:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36546 invoked by uid 99); 17 Sep 2009 13:50:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 13:50:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of savvas.andreas.moysidis@googlemail.com designates 209.85.220.218 as permitted sender)
Received: from [209.85.220.218] (HELO mail-fx0-f218.google.com) (209.85.220.218)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 13:50:33 +0000
Received: by fxm18 with SMTP id 18so44190fxm.5
        for <java-user@lucene.apache.org>; Thu, 17 Sep 2009 06:50:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=9ucowL7t/SigPrED0H1K4SFd8fZAnWKujIxdiTopwtc=;
        b=U8vacOwyVZmnIq36+s/qHoZbUfzTpDFBQbGtfUD7ABpsbrlMdpnrqbUW95gtzs9BtM
         tvyQuIqKNxRQQqQofrd2Xb08jt+iMfCEv5ZqeW4gEkfg+0Q6Zm1f1B0sfYHTGzah3XkZ
         /EFIyrb5JXIzOw7osIWARESV1DzS5t8BSsRZI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=jlM8jeYSRtBTdDlfWOMopU6wbYzLZKW3KsoTadupl/mAY8F6ZTcy20S/vnkgTjqM9W
         EnEWpDLAGpOk3fBkEqZ6ofB8iRv48biiRauv9mRYGvqainBUqdf+IqeYX9XZNXZdAqib
         rNm6OgmI7j5D8lfIxt+wzVs6cByvP0SYCEdgg=
MIME-Version: 1.0
Received: by 10.86.158.5 with SMTP id g5mr607743fge.32.1253195411533; Thu, 17 
	Sep 2009 06:50:11 -0700 (PDT)
In-Reply-To: <359a92830909150655q67ca5ab1v151cff002b13bed7@mail.gmail.com>
References: <1253002790.7551.20.camel@bohr>
	 <359a92830909150655q67ca5ab1v151cff002b13bed7@mail.gmail.com>
Date: Thu, 17 Sep 2009 14:50:11 +0100
Message-ID: <eac5aec20909170650q1b42d7c6t75887a370a545201@mail.gmail.com>
Subject: Re: Displaying search result data - stored fields vs external source
From: Savvas-Andreas Moysidis <savvas.andreas.moysidis@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636025af156b4990473c64b3f
X-Virus-Checked: Checked by ClamAV on apache.org

--001636025af156b4990473c64b3f
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: quoted-printable

Hello ,

I would also prefer to store the content in the index because, as Erick
points out this leads to a more simplified design but also because it allow=
s
me to preserve the relevance sort.



If you store only  the item id in the index then when extracting all the
other required data from  supposedly a database, you will probably execute =
a
=93*select * from item where id in (id_1,id_2,id_3...)*=94

which will probably not retain your relevance sort. So unless you sort by a
business field or apply some kind of convoluted sort strategy which maps to
your original Lucene ResultSet you will have lost your ranking.



Cheers,

savvas


2009/9/15 Erick Erickson <erickerickson@gmail.com>

> Categorically I store everything in the index unless/until I *know* it
> doesn'twork. With some things, it's easy to know from the outset, like if=
 I
> have
> 20T of data to store.
>
> First, storing fields has minimal impact on the search speed, the stored
> text
> isn't interleaved with the search tokens, so they're pretty much disjoint=
.
>
> Second, any scheme storing data separately is inherently more complex
> and difficult to maintain. From the eXtreme Programming folks "Do the
> simplest thing that could possibly work".
>
> Third, there isn't much work in trying it and seeing. I mean you have to
> write
> the retrieval code, and if you encapsulate fetching the data you can swit=
ch
> it out later if it comes to that pretty easily. So you don't lose much at
> all
> by "just trying it" <G>..
>
> HTH
> Erick
>
> On Tue, Sep 15, 2009 at 4:19 AM, Joel Halbert <joel@su3analytics.com>
> wrote:
>
> > Hi,
> >
> > When using Lucene I always consider two approaches to displaying search
> > result data to users:
> >
> > 1. Store any fields that we index and display to users in the Lucene
> > Documents themselves. When we perform a search simply retrieve the data
> > to be displayed from the Lucence documents themselves.
> >
> > or
> >
> > 2. Index fields in Lucene but reference data to be displayed from
> > another source, such as a database. So, when searching I would search
> > for documents then use a (stored) reference key on the documents to the=
n
> > lookup the display fields to display from another source e.g. a
> > database.
> >
> > With regards to the number and size of stored fields I am looking at
> > indexing and displaying approximately 4 relatively small fields for eac=
h
> > document (e.g.  name, age, short description, URL ~ approx 500bytes in
> > total). In any query about 10 hits will be displayed to the user.
> > Approximately 10 million documents to index and search.
> >
> > I am interested the differences in both approaches with regards to:
> >
> > 1) Indexing time performance (how long it might take to index with and
> > without stored fields)
> > 2) Search time performance (total time taken to search for matching
> > documents and then display fields to users)
> >
> > I am less interested in differences arising from
> > maintainability/increased storage requirements.
> >
> > I would be interested to see what others  think of using each approach.
> >
> > Cheers,
> > Joel
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--001636025af156b4990473c64b3f--

From java-user-return-42413-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 14:26:23 2009
Return-Path: <java-user-return-42413-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75572 invoked from network); 17 Sep 2009 14:26:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 14:26:23 -0000
Received: (qmail 8145 invoked by uid 500); 17 Sep 2009 14:26:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8072 invoked by uid 500); 17 Sep 2009 14:26:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8062 invoked by uid 99); 17 Sep 2009 14:26:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 14:26:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mathias.bank@gmail.com designates 209.85.219.228 as permitted sender)
Received: from [209.85.219.228] (HELO mail-ew0-f228.google.com) (209.85.219.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 14:26:11 +0000
Received: by ewy28 with SMTP id 28so464275ewy.28
        for <java-user@lucene.apache.org>; Thu, 17 Sep 2009 07:25:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=lAfRwKOtfYou2ADLJ5Fl92TUT8b7EpUFknwwK4Ogkj8=;
        b=afSnAzwfyq4bCmmeB1CKz2tPkx+qqLYJU4qt3KIZgnYig9g0d8YI319kCSXj6r4eKx
         0TZ3QCBMXZGiWQFRpMz+B5X8r/PXVhQZGqyrqixE9F52FEFirGSWCoDnkzEFaJOtl+rl
         BnTZmUsA4Er1Rf0TCDThENS4HxVaE9hU44nD4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=ELNhfzkisPRulcgvGzT9fhSr+asIpUD0wKIqZCPZYmP3EiZF/meCTzKyjXdFLAuh+2
         U29GlaDAdBcw07ciJPiHYU9Rp75g9mqJK2e4WOnzZ5QmxPr4dpVxhPR9Sd3jd6vyhqP5
         8fQJvDu0KFEA0zNWW06zoHElQREN/worbOf+s=
MIME-Version: 1.0
Received: by 10.216.1.11 with SMTP id 11mr177905wec.147.1253197551011; Thu, 17 
	Sep 2009 07:25:51 -0700 (PDT)
In-Reply-To: <001636c5bc3f125c870473c6c8d4@google.com>
References: <f18c9dde0909150813la8557ecj143f85179dc7df95@mail.gmail.com>
	 <001636c5bc3f125c870473c6c8d4@google.com>
Date: Thu, 17 Sep 2009 16:25:50 +0200
Message-ID: <53480e280909170725y2d302842u4e65b5d20ef92bef@mail.gmail.com>
Subject: Re: Counting search results
From: Mathias Bank <mathias.bank@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

I have tried your method, but it doesn't work.

set will be null after applying

BitSet set =3D filter.bits(reader);

I haven't found any reason for this.

Additionally, the bits method is deprecated and it is mentioned to use
"getDocIdSet". But this set does only provide an iterator, no hash
checks are possible.

Are there any other possibilities to improve speed?

Mathias


Am 15.09.2009 17:13 schrieb Simon Willnauer <simon.willnauer@googlemail.com=
>:
> Hmm, so if you wanna use the Filter to narrow down the search results
>
> you could use it in the while loop like this:
>
>
>
> BitSet set =3D filter.bits(reader);
>
> =C2=A0int numDocs
>
> TermDocs termDocs =3D reader.termDocs(new Term("myField", "myTerm"));
>
> while (termDocs.next()) {
>
> =C2=A0if(set.get(termDocs.doc()))
>
> =C2=A0 =C2=A0numDocs++;
>
> }
>
>
>
> would that help?
>
>
>
> simon
>
> >>
>
> On Tue, Sep 15, 2009 at 5:01 PM, Mathias Bank mathias.bank@gmail.com> wro=
te:
>
> > Hello,
>
> >
>
> > This seams to be a similar solution like:
>
> >
>
> > Term t =3D new Term(fieldname, term);
>
> > int count =3D searcher.docFreq(t);
>
> >
>
> > The problem is, that in this situation it is not possible to apply a
>
> > filter object. If I don't wanna use this filter object, I would have
>
> > to use a complex search query, wich is - again - very slow. So,
>
> > unfortunatelly, your solution does not help.
>
> >
>
> > Mathias
>
> >
>
> > 2009/9/15 Simon Willnauer simon.willnauer@googlemail.com>:
>
> >> Did you try:
>
> >> int numDocs
>
> >> TermDocs termDocs =3D reader.termDocs(new Term("myField", "myTerm"));
>
> >> while (termDocs.next()) { numDocs++; }
>
> >>
>
> >> simon
>
> >>
>
> >> On Tue, Sep 15, 2009 at 2:19 PM, Mathias Bank mathias.bank@gmail.com> =
wrote:
>
> >>> Hello,
>
> >>>
>
> >>> I'm trying to find the number of documents for a specific term to
>
> >>> create text statistics. I'm not interested in ordering the results or
>
> >>> even recieving the first result. I just need the number of results.
>
> >>>
>
> >>> Currently, I'm trying to do this by using the lucene searcher class:
>
> >>>
>
> >>> IndexSearcher searcher =3D new IndexSearcher(reader);
>
> >>> String queryString =3D fieldname+":" + term;
>
> >>> QueryParser parser =3D new QueryParser(fieldname, new GermanAnalyzer(=
));
>
> >>> TopDocs d =3D searcher.search(parser.parse(queryString), filter, 1);
>
> >>> int count =3D d.totalHits;
>
> >>>
>
> >>> The problem is, that there is a large index (optimized) with > 8 mio.
>
> >>> entries. One search could return a large number of search results (> =
1
>
> >>> mio). Currently these search tasks take more than 15 secunds.
>
> >>>
>
> >>> The question is: is there any way to get the number of search results
>
> >>> faster? I think, that it could be optimized by not using a Weight
>
> >>> object (order is not interesting), but I haven't seen a way to do
>
> >>> this.
>
> >>>
>
> >>> I hope, someone has already solved this problem.
>
> >>>
>
> >>> Mathias
>
> >>>
>
> >>> ---------------------------------------------------------------------
>
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
> >>>
>
> >>>
>
> >>
>
> >> ---------------------------------------------------------------------
>
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>
> >>
>
> >>
>
> >
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42414-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 16:30:55 2009
Return-Path: <java-user-return-42414-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15667 invoked from network); 17 Sep 2009 16:30:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 16:30:55 -0000
Received: (qmail 18383 invoked by uid 500); 17 Sep 2009 16:30:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18294 invoked by uid 500); 17 Sep 2009 16:30:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18284 invoked by uid 99); 17 Sep 2009 16:30:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 16:30:52 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [149.8.64.32] (HELO mclmx2.mail.saic.com) (149.8.64.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 16:30:41 +0000
Received: from 0015-its-sbg02.saic.com ([149.8.64.21] [149.8.64.21]) by mclmx2.mail.saic.com with ESMTP id BT-MMP-11201079 for java-user@lucene.apache.org; Thu, 17 Sep 2009 12:30:06 -0400
X-AuditID: 9508407d-b7b7aae0000075c6-b3-4ab2640e2b4d
Received: from mclmx.mail.saic.com (mcl-sixl-nat.saic.com [149.8.64.21])
	by  (Symantec Brightmail Gateway) with SMTP id 04.44.30150.E0462BA4; Thu, 17 Sep 2009 12:30:06 -0400 (EDT)
Received: from sc2xfe1.emainc.com ([149.8.64.21] [149.8.64.21]) by mclmx.mail.saic.com with ESMTP id BT-MMP-2327197 for java-user@lucene.apache.org; Thu, 17 Sep 2009 12:30:06 -0400
Received: from sc1exc2.corp.emainc.com ([10.36.152.47]) by sc2xfe1.emainc.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 17 Sep 2009 12:33:25 -0400
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA37B4.93EE5FA8"
Subject: How to perform a phrase "begins with" query?
Date: Thu, 17 Sep 2009 12:29:59 -0400
Message-Id: <5B20DEF02611534DB08854076CE825D8037FA3B6@sc1exc2.corp.emainc.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: How to perform a phrase "begins with" query?
Thread-Index: Aco3tBlFk+ixHjxfRrma0TDLyIHI7w==
From: <Paul_Murdoch@emainc.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 17 Sep 2009 16:33:25.0314 (UTC) FILETIME=[942DA220:01CA37B4]
X-Brightmail-Tracker: AAAAAA==
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA37B4.93EE5FA8
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi all,

=20

Since you can't (and it doesn't make sense to) use wildcards in phrase
queries, how do you construct a query to get results for phrases that
begin with a certain set of terms?  Here are some theoretical
examples...

=20

Example 1 - I have an index where each document contains the contents of
short stories.  I want to return each document that begins with the
words "Once upon a time".  I know this in not valid Lucene syntax, but
what I would like to do is query for "Once upon a time"*

=20

Example 2 - I have an index where each document contains numbered test
results....say test 1 - test 5000.  I want to return each document where
the test starts with the number 5.  So the query here would be (again I
know this isn't valid) something like "test 5"*

=20

How can this be accomplished?

=20

Thanks

Paul =20

=20


------_=_NextPart_001_01CA37B4.93EE5FA8--

From java-user-return-42415-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 17:13:39 2009
Return-Path: <java-user-return-42415-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29041 invoked from network); 17 Sep 2009 17:13:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 17:13:39 -0000
Received: (qmail 1678 invoked by uid 500); 17 Sep 2009 17:13:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1612 invoked by uid 500); 17 Sep 2009 17:13:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1602 invoked by uid 99); 17 Sep 2009 17:13:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 17:13:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.15] (HELO web52905.mail.re2.yahoo.com) (206.190.49.15)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 17 Sep 2009 17:13:26 +0000
Received: (qmail 74995 invoked by uid 60001); 17 Sep 2009 17:13:03 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253207583; bh=XVO0d/PPdILvzDseNVnxfPyl1RLCju/7oXbZZ+nrRwI=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=WjjiwCO+jGewS2dreKJmw9zKLrSht20bqV+k1F8iu91FslkL0UHYzj1bDd6v+PYOHgv6cBuxJ5YhJCFeKPMpro+/8QEMI5+T5KzwgCB4DnXZ5vdHFk+YpR+jIJqAZabTf+qPN/QisAIPz1nWDcW/8R9ycXDOqd4uoBjwom0LS/w=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=jXiBQ6t1goikjc6gE09ON4B/vaufSVCUgEMUw/ys8GUVbWw+cwZAOS6Xz7kstyThjgIthhV1mBoabhwNM9dvPr3IZcx05+RdOmumBUWvz5LL7nk/EwZbIRhf35XnDhCTgrhm8/INBg8S6moeA8QdCgxgItITvROB1WEX17n3Vb4=;
Message-ID: <185624.74747.qm@web52905.mail.re2.yahoo.com>
X-YMail-OSG: qKZ6UegVM1lhYo974ZHdLePmA.m994Kjj4ssMbNOTBdxop4z5P_UYcJeu9OjysGz9KkvvJDXCsKg2iAPjkHBxRppwWbrBf.l_xS3o75qPEswuwCKlGg7QPCCgnPCJsuaOWu3Vsg2_TKM74cnGrwpm2Vzt9DlwuFygM32TQfHqYgA_Wf4IRu98xF0A2HrHXzQKwuXViO65jRmvnSQbSUayMUDn5WH212igoL6FESNjZFyM5qJ2v45d2yseUoP1In25xogKMrFkiW6elCaT.CntShj46psR2K97WhJXa3kZB.7B8Oy8LxL8Ho.X9Ux5N8C1RGoIJs-
Received: from [78.165.19.67] by web52905.mail.re2.yahoo.com via HTTP; Thu, 17 Sep 2009 10:13:02 PDT
X-Mailer: YahooMailClassic/7.0.14 YahooMailWebService/0.7.347.2
Date: Thu, 17 Sep 2009 10:13:02 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: How to perform a phrase "begins with" query?
To: java-user@lucene.apache.org
In-Reply-To: <5B20DEF02611534DB08854076CE825D8037FA3B6@sc1exc2.corp.emainc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

> Since you can't (and it doesn't make sense to) use=0A> wildcards in phras=
e=0A> queries, how do you construct a query to get results for=0A> phrases =
that begin with a certain set of terms?=A0 =0A> Here are some theoretical e=
xamples...=0A> =0A> =0A> Example 1 - I have an index where each document co=
ntains=0A> the contents of=0A> short stories.=A0 I want to return each docu=
ment that=0A> begins with the=0A> words "Once upon a time".=A0 I know this =
in not valid=0A> Lucene syntax, but=0A> what I would like to do is query fo=
r "Once upon a time"*=0A=0AYou are trying to retrieve documents begins with=
 "Once upon a time", right? You want your phrase in the beginning of the do=
cument. You can retrieve them using SpanQuery family programmatically.=0A=
=0AI am not sure about the value of (int end) in SpanFirstQuery constructor=
 but it will be something like that:=0A=0As1 =3D new SpanTermQuery(new Term=
("story","once"));=0As2 =3D new SpanTermQuery(new Term("story","upon"));=0A=
s3 =3D new SpanTermQuery(new Term("story","time"));=0A=0As4 =3D new SpanNea=
rQuery([s1,s2,s3], 0, true);=0A=0As5 =3D new SpanFirstQuery(s4, 3);=0A=0ANo=
te that you need to use analyzed text of terms in this approach.=0A=0AHope =
this helps.=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42416-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 18:38:56 2009
Return-Path: <java-user-return-42416-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75674 invoked from network); 17 Sep 2009 18:38:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 18:38:56 -0000
Received: (qmail 38700 invoked by uid 500); 17 Sep 2009 18:38:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38619 invoked by uid 500); 17 Sep 2009 18:38:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38607 invoked by uid 99); 17 Sep 2009 18:38:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 18:38:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 18:38:45 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 565FB71C8B4; Thu, 17 Sep 2009 11:38:24 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 54AFA71C882
	for <java-user@lucene.apache.org>; Thu, 17 Sep 2009 11:38:24 -0700 (PDT)
Date: Thu, 17 Sep 2009 11:38:24 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: RE: New "Stream closed" exception with Java 6 - solved
In-Reply-To: <1106853926.351253117447482.JavaMail.root@mail.uk.scalix.com>
Message-ID: <Pine.LNX.4.64.0909171133470.16295@radix.cryptio.net>
References: <1106853926.351253117447482.JavaMail.root@mail.uk.scalix.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: It turns out that the cause of the exceptions is in fact adding an item 
: twice - so you were correct right at the start :-)  I ran a test where I 

glad to see it all worked out.

: Just a minor point: isn't Lucence in a position to detect the duplicate 
: insertion attempt and flag it with something less vague than "Stream 
: closed"?  :-)

not really ... adding a document multiple times is a perfectly legal use 
case, adding a document with a "Reader" based field where the reader is 
already closed ... that's not legal (And Lucene doesn't really have any 
way of knowing if the Reader is closed because *it* closed it.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42417-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 22:32:34 2009
Return-Path: <java-user-return-42417-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9215 invoked from network); 17 Sep 2009 22:32:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 22:32:33 -0000
Received: (qmail 90192 invoked by uid 500); 17 Sep 2009 22:32:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90114 invoked by uid 500); 17 Sep 2009 22:32:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90104 invoked by uid 99); 17 Sep 2009 22:32:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 22:32:30 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL,UNPARSEABLE_RELAY
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [77.238.184.38] (HELO smtp106.mail.ukl.yahoo.com) (77.238.184.38)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 17 Sep 2009 22:32:21 +0000
Received: (qmail 4025 invoked from network); 17 Sep 2009 22:31:59 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:From:Mime-Version:Content-Type:Subject:Date:In-Reply-To:To:References:Message-Id:X-Mailer;
  b=IPet0yGITYfhY8XzKF/84YxrCtasD9lOFgJTCg8Y30A7faOigCZGgFK/a+5ReAdSRJn4cvi0s5fPvJFkmhnJqKV9aX4SK5renbg2v1uQsPBcLWBtUqEhovFPkGthNP/LS5Y7lCJgaKTAv1Z+6NIRIf6XPz+XtbZlYrsQ1Q6IbEg=  ;
Received: from i-194-106-34-5.freedom2surf.net (markharw00d@194.106.34.5 with plain)
        by smtp106.mail.ukl.yahoo.com with SMTP; 17 Sep 2009 22:31:59 +0000 GMT
X-Yahoo-SMTP: rdTGKYaswBBzjeOz17cOw.4gNsDMDjs6
X-YMail-OSG: DtDgrY0VM1klkagEdWmoqEBPThJBkaqeWiwfqcZdg1Jvu3ZjMayg7JJjU0bRUIqTuJuGVooVAq1jIYTu9FSAZzsk3lJfCOsJz0LaRsrq6ogERbugexHaEBs0bICX3D4s2eh3d7uvF7Ie5IFb2PrYidsw6uPH4wO5ADTbe3Viyc6JNAWWlAjHj2mz7PLv_Ik_ds66MRs3v2WpN_slUzUhkvvRVANhfYvsANuW6T3kUBdnhGeaaNlbbjJCz8Jd8wCgofKJ3ccrB5aVvN1tvS5fIhw.9gXOR.vOsvYrwI6m
X-Yahoo-Newman-Property: ymail-3
From: Mark Harwood <markharw00d@yahoo.co.uk>
Mime-Version: 1.0 (Apple Message framework v1075.2)
Content-Type: multipart/alternative; boundary=Apple-Mail-8-41610731
Subject: Re: How to perform a phrase "begins with" query?
Date: Thu, 17 Sep 2009 23:31:57 +0100
In-Reply-To: <5B20DEF02611534DB08854076CE825D8037FA3B6@sc1exc2.corp.emainc.com>
To: java-user@lucene.apache.org
References: <5B20DEF02611534DB08854076CE825D8037FA3B6@sc1exc2.corp.emainc.com>
Message-Id: <81608FC2-D067-40F0-8C57-E7DFDD6F6395@yahoo.co.uk>
X-Mailer: Apple Mail (2.1075.2)
X-Virus-Checked: Checked by ClamAV on apache.org

--Apple-Mail-8-41610731
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=us-ascii;
	format=flowed

> Since you can't (and it doesn't make sense to) use wildcards in phrase
> queries,


You can with this:  http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/misc/src/java/org/apache/lucene/queryParser/complexPhrase/

Discussion here: http://tinyurl.com/lrnage

Cheers,
  Mark
--Apple-Mail-8-41610731--

From java-user-return-42418-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 22:48:35 2009
Return-Path: <java-user-return-42418-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12663 invoked from network); 17 Sep 2009 22:48:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 22:48:35 -0000
Received: (qmail 2661 invoked by uid 500); 17 Sep 2009 22:48:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2584 invoked by uid 500); 17 Sep 2009 22:48:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2574 invoked by uid 99); 17 Sep 2009 22:48:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 22:48:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 22:48:22 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id E3BB371C6DF; Thu, 17 Sep 2009 15:48:00 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 51A6971C678
	for <java-user@lucene.apache.org>; Thu, 17 Sep 2009 15:47:59 -0700 (PDT)
Date: Thu, 17 Sep 2009 15:47:59 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Combining hits from multiple documents into a single hit
In-Reply-To: <20090908173025.jxlkm2mw8ogw844s@adrianbanks.co.uk>
Message-ID: <Pine.LNX.4.64.0909171515160.24400@radix.cryptio.net>
References: <20090908173025.jxlkm2mw8ogw844s@adrianbanks.co.uk>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


Assuming i understand you correctly, then...
  1. properties only exist as part of a single article (no articles share 
a complex property) 
  2. you don't have any need to ever return searchese on 
properties, they exist just to add in searching for articles.

IF that's correct, then the idea i would try is to only index 1 document 
per article, with all of the text included, and use payloads to annotate 
which text is securred by which property.  Then use SpanQueries to search 
for your docs, and in a custom HitCollector check the matching spans for 
each doc to get the corrisponding property, and test that 
<user/doc/property> tripple agaisnt your security mechanism -- if any 
fail, skip that doc.


It's not something i've ever tried (or thought through very hard) but 
based on other comments i've seen from people about payloads it sounds 
like it should work pretty well and give you decent scores.


: [I originally posted this to the Lucene.net mailing list,but it was suggested
: that I might have more luck here]
: 
: I am trying to get a particular search to work and it is proving problematic.
: The actual source data is quite complex but can be summarised by the following
: example:
: 
: I have articles that are indexed so that they can be searched. Each article
: also has multiple properties associated with it which are also indexed and
: searchable. When users search, they can get hits in either the main article or
: the associated properties. Regardless of where a hit is achieved, the article
: is returned as a search hit (ie. the properties are never a hit in their own
: right).
: 
: Now for the complexity:
: 
: Each property has security on it, which means that for any given user, they
: may or may not be able to see the property. If a user cannot see a property,
: they obviously do not get a search hit in it. This security check is
: proprietary and cannot be done using the typical mechanism of storing a role
: in the index alongside the other fields in the document.
: 
: I currently have a index that contains the articles and properties indexed
: separately (ie. an article is indexed as a document, and each property has its
: own document). When a search happens, a hit in article A or a hit in any of
: the properties of article A should be classed as hit for article A alone, with
: the scores combined.
: 
: Whether or not a user can see a property is not based on the property itself,
: but on the value of the property. I cannot therefore put the extra security
: conditions into the query upfront as I don't know the value to filter by.
: 
: As an example:
: 
: +---------+------------+------------+
: | Article | Property 1 | Property 2 |
: +---------+------------+------------+
: |    A    |     X      |     J      |
: |    B    |     Y      |     K      |
: |    C    |     Z      |     L      |
: +---------+------------+------------+
: 
: If a user can see everything, then searching for "B and Y" will return a
: single search result for article B.
: 
: If another user cannot see a property if its value contains Y, then searching
: for "B and Y" will return no hits.
: 
: I have no way of knowing what values a user can and cannot see upfront. They
: only way to tell is to perform the security check (currently done at the time
: of filtering a hit from a field in the document), which I obviously cannot do
: for every possible data value for each user.
: 
: To achieve this originally, Lucene v1.3 was modified to allow this to happen
: by changing BooleanQuery to have a custom Scorer that could apply the logic of
: the security check and the combination of two hits in different documents
: being classed as a hit in a single document. I am trying to upgrade this
: version to the latest (v2.3.2 - I am using Lucene.Net), but ideally without
: having to modify Lucene in any way.
: 
: An additional problem occurs if I do an AND search. If an article contains the
: word foo and one of its properties contains the word bar, then searching for
: "foo AND bar" will return the article as a hit. My current code deals with
: this inside the custom Scorer.
: 
: Any ideas how/if this can be done?
: 
: I am thinking along the lines of using a custom HitCollector and passing that
: into the search, but when doing the boolean search "foo AND bar", execution
: never reaches my HitCollector as the ConjunctionScorer filters out all of the
: results from the sub-queries before getting there.
: 
: Thanks,
: 
: Adrian
: 
: 
: 
: ---------------------------------------------------------------------
: To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
: For additional commands, e-mail: java-user-help@lucene.apache.org



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42419-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 17 22:59:55 2009
Return-Path: <java-user-return-42419-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16256 invoked from network); 17 Sep 2009 22:59:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Sep 2009 22:59:55 -0000
Received: (qmail 16713 invoked by uid 500); 17 Sep 2009 22:59:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16632 invoked by uid 500); 17 Sep 2009 22:59:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16622 invoked by uid 99); 17 Sep 2009 22:59:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 22:59:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 17 Sep 2009 22:59:42 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id A809B71C831; Thu, 17 Sep 2009 15:59:19 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id A3DFE71C82D
	for <java-user@lucene.apache.org>; Thu, 17 Sep 2009 15:59:19 -0700 (PDT)
Date: Thu, 17 Sep 2009 15:59:19 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Filtering question/advice
In-Reply-To: <6f4104d80909090016i577d87ajb96e8de84db59834@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0909171553030.24400@radix.cryptio.net>
References: <6f4104d80909040217yd24a342t22232a9b4f217fbb@mail.gmail.com> 
 <6f4104d80909040238i877609ev65a2f284c07a99df@mail.gmail.com> 
 <Pine.LNX.4.64.0909081521040.26698@radix.cryptio.net>
 <6f4104d80909090016i577d87ajb96e8de84db59834@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


FWWI: a test case with multiple asserts is more useful if you clarify 
where it failes ... ie: show us the failure message, or put a comment on 
athe line of the assert that fails.

i didn't run your testcase, but skimming it a few things jumpt out at me 
that might explain whatever problem you are seeing...

:        Field uw1 = new Field("uw-refernce", "hello", Field.Store.NO,
: Field.Index.ANALYZED);
:        Field uw2 = new Field("uw-refernce", "bye", Field.Store.NO,
: Field.Index.ANALYZED);
		...
:        layerDocumentA = new Document();
:        layerDocumentA.add(uw1);
:        layerDocumentA.add(uw1);

...did you really mean to add uw1 twice? or did you mean to add uw2 as 
well (it's never used)...

:     public void testUWBCanSeeResultIfSearchTermMatchesOnSomethingElse()
: throws Exception {
		...
:         UnderwriterReferenceFilter filter = new
: UnderwriterReferenceFilter();

...you never set any properties on this Filter before you use it. reading 
it's implementation, that should cause an IllegalArgumentException.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42420-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 18 16:44:04 2009
Return-Path: <java-user-return-42420-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49287 invoked from network); 18 Sep 2009 16:44:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Sep 2009 16:44:04 -0000
Received: (qmail 29018 invoked by uid 500); 18 Sep 2009 16:44:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28833 invoked by uid 500); 18 Sep 2009 16:44:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28814 invoked by uid 99); 18 Sep 2009 16:44:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 16:44:01 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 16:43:48 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n8IGhJFe016164
	for <java-user@lucene.apache.org>; Fri, 18 Sep 2009 17:43:19 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.5.0.13292)
    via ESMTP; Fri, 18 Sep 2009 17:43:18 +0100 (BST)
Date: Fri, 18 Sep 2009 17:43:18 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <1901609532.1881253292198611.JavaMail.root@mail.uk.scalix.com>
Subject: RE: New "Stream closed" exception with Java 6 - solved
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----=_Part_30_817989197.1253292198608"
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

------=_Part_30_817989197.1253292198608
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline

Hoss,

> not really ... adding a document multiple times is a perfectly legal use 
> case, adding a document with a "Reader" based field where the reader is 
> already closed ... that's not legal (And Lucene doesn't really have any 
> way of knowing if the Reader is closed because *it* closed it.
>
Now I am confused, I must be missing something fundamental.  I take no action that I am aware of which closes the Reader, so how is it happening?  The attached code demonstrates the exception - please can you advise on what is happening under the covers?  :-)  

Thanks again,

- Chris


----- Original Message -----
From: Chris Hostetter <hossman_lucene@fucit.org>
Sent: Thu, 17/9/2009 7:38pm
To: java-user@lucene.apache.org
Subject: RE: New "Stream closed" exception with Java 6 - solved


: It turns out that the cause of the exceptions is in fact adding an item 
: twice - so you were correct right at the start :-)  I ran a test where I 

glad to see it all worked out.

: Just a minor point: isn't Lucence in a position to detect the duplicate 
: insertion attempt and flag it with something less vague than "Stream 
: closed"?  :-)

not really ... adding a document multiple times is a perfectly legal use 
case, adding a document with a "Reader" based field where the reader is 
already closed ... that's not legal (And Lucene doesn't really have any 
way of knowing if the Reader is closed because *it* closed it.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



------=_Part_30_817989197.1253292198608
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
------=_Part_30_817989197.1253292198608--

From java-user-return-42421-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 18 16:58:42 2009
Return-Path: <java-user-return-42421-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53156 invoked from network); 18 Sep 2009 16:58:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Sep 2009 16:58:42 -0000
Received: (qmail 49802 invoked by uid 500); 18 Sep 2009 16:58:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49764 invoked by uid 500); 18 Sep 2009 16:58:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49753 invoked by uid 99); 18 Sep 2009 16:58:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 16:58:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 16:58:30 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 8750371C84F; Fri, 18 Sep 2009 09:58:09 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 8595E71C84E
	for <java-user@lucene.apache.org>; Fri, 18 Sep 2009 09:58:09 -0700 (PDT)
Date: Fri, 18 Sep 2009 09:58:09 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: RE: New "Stream closed" exception with Java 6 - solved
In-Reply-To: <1901609532.1881253292198611.JavaMail.root@mail.uk.scalix.com>
Message-ID: <Pine.LNX.4.64.0909180953300.32068@radix.cryptio.net>
References: <1901609532.1881253292198611.JavaMail.root@mail.uk.scalix.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: > not really ... adding a document multiple times is a perfectly legal use 
: > case, adding a document with a "Reader" based field where the reader is 
: > already closed ... that's not legal (And Lucene doesn't really have any 
: > way of knowing if the Reader is closed because *it* closed it.

: Now I am confused, I must be missing something fundamental.  I take no 
: action that I am aware of which closes the Reader, so how is it 
: happening?  The attached code demonstrates the exception - please can 
: you advise on what is happening under the covers?  :-)

sorry for confusing you ... i should have said there are *some* use cases 
where adding the same document twice is legal -- but documents contain 
Fields that specify a reader are not one of those cases -- IndexWriter
consumes and closes the Reader to get the tokens for indexing, and the 
next time you re-add that same Document, the Reader is already closed.

My point was in response to your question about why IndexWRiter doesn't 
give you a different error about duplicate documents: it can't because 
there are *other* cases where indexing the same doc over and over is fine 
(docs that just contain simple strings).  All IndexWRiter kows when it 
sees a closed Reader is that it's closed, and it can't read from it -- it 
has no way of knowing *why* it's closed.  (trying to keep track of ever 
Reader IndexWriter ever closed would be an intractable problem)


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42422-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 18 21:56:51 2009
Return-Path: <java-user-return-42422-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40520 invoked from network); 18 Sep 2009 21:56:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Sep 2009 21:56:51 -0000
Received: (qmail 22362 invoked by uid 500); 18 Sep 2009 21:56:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22215 invoked by uid 500); 18 Sep 2009 21:56:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22130 invoked by uid 99); 18 Sep 2009 21:56:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 21:56:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erik.hatcher@gmail.com designates 209.85.221.192 as permitted sender)
Received: from [209.85.221.192] (HELO mail-qy0-f192.google.com) (209.85.221.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 21:56:34 +0000
Received: by qyk30 with SMTP id 30so1169518qyk.5
        for <multiple recipients>; Fri, 18 Sep 2009 14:56:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :content-type:content-transfer-encoding:mime-version:subject:date
         :x-mailer;
        bh=Rwwsg691Z0qHPGw0/zLZPGZxB8CaXw4vGQGjnykeyfs=;
        b=CPJyp0bKCeDgXrkh/KIc6Hft0jQUWw6D9IANxdluZLZKdz0PTfKb9hZyOkurP6AsR6
         8XmxYkJW3Ob8VIZRol6tr2H09R+c8H7116W3g8tcqoYDMuYYRwW8NQRbBHK57NVcSJ4W
         zBkirSQWrMrZI4dZDYeGM3fnlDs1ujRwJXFXE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:content-transfer-encoding
         :mime-version:subject:date:x-mailer;
        b=pBADOULXtoz3+HQ/hjMxYSKuHGq6vMYouuydz5I01QwVmqcyFCX6Z329sUc/BFMoNi
         jZNDIQEKhJJz/22+aVlxWiTIN0g4Da5SNEJlyg2FEmpCBDc+joXNSLImtZca0s4Zb2sx
         2DIjPTDHI1/iz4M57DRKqPdpY5GxFvX+a4T8E=
Received: by 10.224.59.168 with SMTP id l40mr1882751qah.90.1253310973151;
        Fri, 18 Sep 2009 14:56:13 -0700 (PDT)
Received: from ?10.0.1.14? (va-71-51-2-147.dhcp.embarqhsd.net [71.51.2.147])
        by mx.google.com with ESMTPS id 4sm229534qwe.25.2009.09.18.14.56.11
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 18 Sep 2009 14:56:12 -0700 (PDT)
Message-Id: <92558FC2-47CF-4162-A68F-CFEF8EB074D7@gmail.com>
From: Erik Hatcher <erik.hatcher@gmail.com>
To: solr-user@lucene.apache.org,
 java-user@lucene.apache.org,
 general@lucene.apache.org,
 lucene-net-user@incubator.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Free Webinar - Apache Lucene 2.9: Technical Overview of New Features
Date: Fri, 18 Sep 2009 17:56:10 -0400
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Free Webinar: Apache Lucene 2.9: Discover the Powerful New Features
-------------------------------------------------------------------

Join us for a free and in-depth technical webinar with Grant  
Ingersoll, co-founder of Lucid Imagination and chair of the Apache  
Lucene PMC.

Thursday, September 24th 2009
11:00AM - 12 NOON PDT / 2:00 - 3:00PM EDT
Click on the link below to sign up
http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP

Lucene 2.9 offers a rich set of new features and performance  
improvements alongside plentiful fixes and optimizations. If you are a  
Java developer building search applications with the Lucene search  
library, this webinar provides the insights you need to harness this  
important update to Apache Lucene.

Grant will present and discuss key technical features and innovations  
including:
o Real time/Per segment searching and caching
o Built in numeric range support with trie structure for speed and  
simplified programming
o Reduced search latency and improved index efficiency

Join us for a free webinar.
Thursday, September 24th 2009
11:00 AM - NOON PDT / 2:00 - 3:00 PM EDT
http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42423-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 18 22:06:10 2009
Return-Path: <java-user-return-42423-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42506 invoked from network); 18 Sep 2009 22:06:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Sep 2009 22:06:10 -0000
Received: (qmail 34442 invoked by uid 500); 18 Sep 2009 22:06:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34338 invoked by uid 500); 18 Sep 2009 22:06:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34311 invoked by uid 99); 18 Sep 2009 22:06:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 22:06:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [216.46.96.108] (HELO smtp22.equifax.com) (216.46.96.108)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 22:05:54 +0000
Received: from postoffice20.equifax.com ( [192.168.4.40])
	by smtp22.equifax.com (Symantec Mail Security) with SMTP id C9.3D.03121.CC504BA4; Fri, 18 Sep 2009 18:12:28 -0400 (EDT)
Received: from wetcisdlppsmtp1.eis.equifax.com ( [172.18.152.141])
	by  (Symantec Mail Security) with SMTP id 98.47.20903.64404BA4; Fri, 18 Sep 2009 18:05:58 -0400 (EDT)
X-AuditID: 0a010140-b7bacae000000c31-b6-4ab405ccf397
Received: from noteswetc12.fin.equifax.com ( [172.18.113.62])
	by  (Symantec Mail Security) with SMTP id 97.47.20903.54404BA4; Fri, 18 Sep 2009 18:05:58 -0400 (EDT)
X-Notes-Item: 1;
 name=DragAndDrop
X-Notes-Item: 1;
 name=R5track
X-Notes-Item: CN=Aravind Yarram/OU=ATL/OU=NA/O=Equifax;
 name=$AltPrincipal
X-Notes-Item: 1;
 name=$SMTPKeepNotesItems
X-Notes-Item: 1;
 name=WebDateTimeInit
X-Notes-Item: 1;
 name=$PublicAccess
X-Notes-Item: Thu, 24 Sep 2009 15:00:00 -0400;
 type=400; name=$NoPurge
X-Notes-Item: =?UTF-8?B?U2VuZCBSZXF1ZXN0IGJ5IE5vdGVzIENsaWVudCBvbiBBcmF2aW5k?=
 =?UTF-8?B?IFlhcnJhbS9BVEwvTkEvRXF1aWZheChSZWxlYXNlIDcuMC4yfA==?=
 =?UTF-8?B?U2VwdGVtYmVyIDI2LCAyMDA2KSBhdCAwOS8xOC8yMDA5IDA2OjAzOjQ4IFBN?=,
	=?UTF-8?B?UHJlcGFyZSBSZXF1ZXN0IGJ5IE5vdGVzIENsaWVudCBvbiBBcmF2aW5k?=
 =?UTF-8?B?IFlhcnJhbS9BVEwvTkEvRXF1aWZheChSZWxlYXNlIDcuMC4yfA==?=
 =?UTF-8?B?U2VwdGVtYmVyIDI2LCAyMDA2KSBhdCAwOS8xOC8yMDA5IDA2OjAzOjQ4IFBN?=,
	=?UTF-8?B?Q1MgTm90aWNlIGNvbnZlcnRlZCB0byBpQ2FsZW5kYXIgZm9ybWF0IGJ5?=
 =?UTF-8?B?IFJvdXRlciBvbiBOb3Rlc1dFVEMxMi9GaW5hbmNpYWwvRXF1aWZheCg=?=
 =?UTF-8?B?UmVsZWFzZSA3LjAuMkZQMSBIRjk0fEZlYnJ1YXJ5IDI4LCAyMDA3KSBhdA==?=
 =?UTF-8?B?IDA5LzE4LzIwMDkgMDY6MDU6MzUgUE0=?=;
 type=501; name=$CSTrack
X-Notes-Item: erik.hatcher@gmail.com,
	general@lucene.apache.org,
	java-user@lucene.apache.org,
	lucene-net-user@incubator.apache.org,
	solr-user@lucene.apache.org;
 type=501; flags=44; name=RequiredAttendees
X-Notes-Item: erik.hatcher@gmail.com,
	general@lucene.apache.org,
	java-user@lucene.apache.org,
	lucene-net-user@incubator.apache.org,
	solr-user@lucene.apache.org;
 type=501; flags=44; name=AltRequiredNames
X-Notes-Item: .,
	.,
	.,
	.,
	.;
 type=501; flags=44; name=INetRequiredNames
X-Notes-Item: .,
	.,
	.,
	.,
	.;
 type=501; flags=44; name=StorageRequiredNames
X-Notes-Item: Fri, 18 Sep 2009 18:03:48 -0400;
 type=400; name=OriginalModTime
X-Notes-Item: 3;
 name=$ExpandGroups
X-Notes-Item: ;
 name=Logo
X-Notes-Item: en-US;
 name=$FromPreferredLanguage
X-Notes-Item: ;
 flags=44; name=OnlinePlace
X-Notes-Item: CN=Aravind Yarram/OU=ATL/OU=NA/O=Equifax;
 flags=44; name=AltChair
X-Notes-Item: 1;
 name=Alarms
Subject: Invitation: Free Webinar - Apache Lucene 2.9: Technical Overview of New
 Features (Sep 24 02:00 PM EDT)
X-Notes-Item: 1;
 name=MeetingType
X-Notes-Item: ;
 flags=44; name=Presenters
X-Notes-Item: ;
 flags=44; name=OnlinePlaceToReserve
X-Notes-Item: ;
 name=AudioVideoFlags
X-Notes-Item: ;
 name=SendAttachments
X-Notes-Item: ;
 name=SchedulerSwitcher
X-Notes-Item: D2DCDC;
 name=$BorderColor
To: erik.hatcher@gmail.com,
	general@lucene.apache.org,
	java-user@lucene.apache.org,
	lucene-net-user@incubator.apache.org,
	solr-user@lucene.apache.org
X-Notes-Item: ;
 flags=45; name=INetCopyTo
X-Notes-Item: ;
 flags=44; name=INetBlindCopyTo
X-Notes-Item: .,
	.,
	.,
	.,
	.;
 type=501; name=$StorageTo
X-Mailer: Lotus Notes Release 7.0.2 September 26, 2006
Message-ID: <OFE3143EC4.F95E2C65-ON85257635.0079297D-85257635.007932B2@equifax.com>
From: Aravind.Yarram@equifax.com
Date: Fri, 18 Sep 2009 18:03:48 -0400
X-Notes-Item: 0;
 name=Encrypt
X-Notes-Item: ;
 name=RoutingState
X-Notes-Item: ;
 name=DeadFailureReason
X-Notes-Item: CN=Aravind Yarram/OU=ATL/OU=NA/O=Equifax,
	CN=NotesWETC12/OU=Financial/O=Equifax;
 type=501; flags=44; name=$UpdatedBy
X-Notes-Item: Fri, 18 Sep 2009 18:03:48 -0400;
 type=400; name=$Revisions
X-Notes-Item: equifax.com;
 name=FromDomain
X-Notes-Item: 25;
 type=300; name=$Hops
MIME-Version: 1.0
X-Notes-Item: Memo;
 name=Form
X-Notes-Item: 1;
 name=$NoteContainsIcal
X-Notes-Item: 1;
 name=$NoteHasNativeMIME
X-Notes-Item: CN=Aravind Yarram/OU=ATL/OU=NA/O=Equifax;
 name=OriginalFrom
X-MIMETrack: Serialize by Router on NotesWETC12/Financial/Equifax(Release 7.0.2FP1 HF94|February
 28, 2007) at 09/18/2009 06:05:35 PM,
	Serialize complete at 09/18/2009 06:05:35 PM
Content-Type: multipart/mixed; boundary="=_mixed E3143EC4F95E2C65852576350079297D_="
X-Brightmail-Tracker: AAAAAQAAAZE=
X-CFilter-Loop: Reflected
X-Tracking: EFXStRiNg0123456789
X-Virus-Checked: Checked by ClamAV on apache.org

--=_mixed E3143EC4F95E2C65852576350079297D_=
Content-Type: multipart/related; boundary="=_related E3143EC4F95E2C65852576350079297D_="


--=_related E3143EC4F95E2C65852576350079297D_=
Content-Type: multipart/alternative; boundary="=_alternative E3143EC4F95E2C65852576350079297D_="


--=_alternative E3143EC4F95E2C65852576350079297D_=
Content-Type: text/plain; charset=US-ASCII




__________________

Free Webinar: Apache Lucene 2.9: Discover the Powerful New Features
-------------------------------------------------------------------

Join us for a free and in-depth technical webinar with Grant
Ingersoll, co-founder of Lucid Imagination and chair of the Apache
Lucene PMC.

Thursday, September 24th 2009
11:00AM - 12 NOON PDT / 2:00 - 3:00PM EDT
Click on the link below to sign up
http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP

Lucene 2.9 offers a rich set of new features and performance
improvements alongside plentiful fixes and optimizations. If you are a
Java developer building search applications with the Lucene search
library, this webinar provides the insights you need to harness this
important update to Apache Lucene.

Grant will present and discuss key technical features and innovations
including:
o Real time/Per segment searching and caching
o Built in numeric range support with trie structure for speed and
simplified programming
o Reduced search latency and improved index efficiency

Join us for a free webinar.
Thursday, September 24th 2009
11:00 AM - NOON PDT / 2:00 - 3:00 PM EDT
http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


--=_alternative E3143EC4F95E2C65852576350079297D_=
Content-Type: text/html; charset=US-ASCII
Content-Disposition: inline

<html><body><b><font size="2">Description</font></b>
<p><br>
<br>
<font size="2">__________________</font><br>
<br>
<tt><font size="2">Free Webinar: Apache Lucene 2.9: Discover the Powerful New Features<br>
</font></tt><tt><font size="2">-------------------------------------------------------------------<br>
</font></tt><br>
<tt><font size="2">Join us for a free and in-depth technical webinar with Grant<br>
</font></tt><tt><font size="2">Ingersoll, co-founder of Lucid Imagination and chair of the Apache<br>
</font></tt><tt><font size="2">Lucene PMC.<br>
</font></tt><br>
<tt><font size="2">Thursday, September 24th 2009<br>
</font></tt><tt><font size="2">11:00AM - 12 NOON PDT / 2:00 - 3:00PM EDT<br>
</font></tt><tt><font size="2">Click on the link below to sign up<br>
</font></tt><tt><font size="2"><a href="http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP">http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP</a><br>
</font></tt><br>
<tt><font size="2">Lucene 2.9 offers a rich set of new features and performance<br>
</font></tt><tt><font size="2">improvements alongside plentiful fixes and optimizations. If you are a<br>
</font></tt><tt><font size="2">Java developer building search applications with the Lucene search<br>
</font></tt><tt><font size="2">library, this webinar provides the insights you need to harness this<br>
</font></tt><tt><font size="2">important update to Apache Lucene.<br>
</font></tt><br>
<tt><font size="2">Grant will present and discuss key technical features and innovations<br>
</font></tt><tt><font size="2">including:<br>
</font></tt><tt><font size="2">o Real time/Per segment searching and caching<br>
</font></tt><tt><font size="2">o Built in numeric range support with trie structure for speed and<br>
</font></tt><tt><font size="2">simplified programming<br>
</font></tt><tt><font size="2">o Reduced search latency and improved index efficiency<br>
</font></tt><br>
<tt><font size="2">Join us for a free webinar.<br>
</font></tt><tt><font size="2">Thursday, September 24th 2009<br>
</font></tt><tt><font size="2">11:00 AM - NOON PDT / 2:00 - 3:00 PM EDT<br>
</font></tt><tt><font size="2"><a href="http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP">http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP</a><br>
</font></tt><br>
<tt><font size="2">---------------------------------------------------------------------<br>
</font></tt><tt><font size="2">To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org<br>
</font></tt><tt><font size="2">For additional commands, e-mail: java-user-help@lucene.apache.org<br>
</font></tt><br>
<br>
</body></html>

--=_alternative E3143EC4F95E2C65852576350079297D_=
Content-Type: text/calendar; method="REQUEST"; charset="UTF-8"

BEGIN:VCALENDAR
X-LOTUS-CHARSET:UTF-8
VERSION:2.0
PRODID:-//Lotus Development Corporation//NONSGML Notes 7.0//EN
METHOD:REQUEST
BEGIN:VTIMEZONE
TZID:Eastern
BEGIN:STANDARD
DTSTART:19501105T020000
TZOFFSETFROM:-0400
TZOFFSETTO:-0500
RRULE:FREQ=YEARLY;BYMINUTE=0;BYHOUR=2;BYDAY=1SU;BYMONTH=11
END:STANDARD
BEGIN:DAYLIGHT
DTSTART:19500312T020000
TZOFFSETFROM:-0500
TZOFFSETTO:-0400
RRULE:FREQ=YEARLY;BYMINUTE=0;BYHOUR=2;BYDAY=2SU;BYMONTH=3
END:DAYLIGHT
END:VTIMEZONE
BEGIN:VEVENT
DTSTART;TZID="Eastern":20090924T140000
DTEND;TZID="Eastern":20090924T150000
TRANSP:OPAQUE
DTSTAMP:20090918T220348Z
SEQUENCE:0
ATTENDEE;ROLE=CHAIR;PARTSTAT=ACCEPTED
 ;CN="Aravind Yarram/ATL/NA/Equifax";RSVP=FALSE
 :mailto:Aravind.Yarram@equifax.com
ATTENDEE;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE
 :mailto:erik.hatcher@gmail.com
ATTENDEE;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE
 :mailto:general@lucene.apache.org
ATTENDEE;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE
 :mailto:java-user@lucene.apache.org
ATTENDEE;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE
 :mailto:lucene-net-user@incubator.apache.org
ATTENDEE;ROLE=REQ-PARTICIPANT;PARTSTAT=NEEDS-ACTION;RSVP=TRUE
 :mailto:solr-user@lucene.apache.org
CLASS:PUBLIC
DESCRIPTION;ALTREP="CID:<FFFF__=0ABBFCA6DFEAAFED8f9e8a93df93@equifax.com>":_
 _________________\n\nFree Webinar: Apache Lucene 2.9
 : Discover the Powerful New Features\n--------------------------------
 -----------------------------------\n\nJoin us for a free and in-depth
  technical webinar with Grant\nIngersoll\, co-founder of Lucid Imagina
 tion and chair of the Apache\nLucene PMC.\n\nThursday\, September 24th
  2009\n11:00AM - 12 NOON PDT / 2:00 - 3
 :00PM EDT\nClick on the link below to sign up\nhttp
 ://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP\n\nLuce
 ne 2.9 offers a rich set of new features and performance\nimprovements
  alongside plentiful fixes and optimizations. If you are a\nJava devel
 oper building search applications with the Lucene search\nlibrary\, th
 is webinar provides the insights you need to harness this\nimportant u
 pdate to Apache Lucene.\n\nGrant will present and discuss key technica
 l features and innovations\nincluding
 :\no Real time/Per segment searching and caching\no Built in numeric r
 ange support with trie structure for speed and\nsimplified programming
 \no Reduced search latency and improved index efficiency\n\nJoin us fo
 r a free webinar.\nThursday\, September 24th 2009\n11
 :00 AM - NOON PDT / 2:00 - 3:00 PM EDT\nhttp
 ://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP\n\n----
 -----------------------------------------------------------------\nTo 
 unsubscribe\, e-mail
 : java-user-unsubscribe@lucene.apache.org\nFor additional commands\, e
 -mail: java-user-help@lucene.apache.org\n\n
SUMMARY:Free Webinar - Apache Lucene 2.9
 : Technical Overview of New Features
ORGANIZER;CN="Aravind Yarram/ATL/NA/Equifax";SENT-BY="mailto
 :Aravind.Yarram@equifax.com":mailto:Aravind.Yarram@equifax.com
UID:E3143EC4F95E2C65852576350079297D-Lotus_Notes_Generated
X-LOTUS-BROADCAST:FALSE
X-LOTUS-UPDATE-SEQ:1
X-LOTUS-UPDATE-WISL:$S:1;$L:1;$B:1;$R:1;$E:1;$M:1;$W:1;$O:1
X-LOTUS-NOTESVERSION:2
X-LOTUS-NOTICETYPE:I
X-LOTUS-APPTTYPE:3
X-LOTUS-CHILD_UID:E3143EC4F95E2C65852576350079297D
END:VEVENT
END:VCALENDAR

--=_alternative E3143EC4F95E2C65852576350079297D_=--
--=_related E3143EC4F95E2C65852576350079297D_=
Content-Type: text/html; charset=US-ASCII
Content-Disposition: inline
Content-ID: <FFFF__=0ABBFCA6DFEAAFED8f9e8a93df93@equifax.com>

<html><body><br>
<br>
<font size="2">__________________</font><br>
<br>
<tt><font size="2">Free Webinar: Apache Lucene 2.9: Discover the Powerful New Features<br>
</font></tt><tt><font size="2">-------------------------------------------------------------------<br>
</font></tt><br>
<tt><font size="2">Join us for a free and in-depth technical webinar with Grant<br>
</font></tt><tt><font size="2">Ingersoll, co-founder of Lucid Imagination and chair of the Apache<br>
</font></tt><tt><font size="2">Lucene PMC.<br>
</font></tt><br>
<tt><font size="2">Thursday, September 24th 2009<br>
</font></tt><tt><font size="2">11:00AM - 12 NOON PDT / 2:00 - 3:00PM EDT<br>
</font></tt><tt><font size="2">Click on the link below to sign up<br>
</font></tt><tt><font size="2"><a href="http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP">http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP</a><br>
</font></tt><br>
<tt><font size="2">Lucene 2.9 offers a rich set of new features and performance<br>
</font></tt><tt><font size="2">improvements alongside plentiful fixes and optimizations. If you are a<br>
</font></tt><tt><font size="2">Java developer building search applications with the Lucene search<br>
</font></tt><tt><font size="2">library, this webinar provides the insights you need to harness this<br>
</font></tt><tt><font size="2">important update to Apache Lucene.<br>
</font></tt><br>
<tt><font size="2">Grant will present and discuss key technical features and innovations<br>
</font></tt><tt><font size="2">including:<br>
</font></tt><tt><font size="2">o Real time/Per segment searching and caching<br>
</font></tt><tt><font size="2">o Built in numeric range support with trie structure for speed and<br>
</font></tt><tt><font size="2">simplified programming<br>
</font></tt><tt><font size="2">o Reduced search latency and improved index efficiency<br>
</font></tt><br>
<tt><font size="2">Join us for a free webinar.<br>
</font></tt><tt><font size="2">Thursday, September 24th 2009<br>
</font></tt><tt><font size="2">11:00 AM - NOON PDT / 2:00 - 3:00 PM EDT<br>
</font></tt><tt><font size="2"><a href="http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP">http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP</a><br>
</font></tt><br>
<tt><font size="2">---------------------------------------------------------------------<br>
</font></tt><tt><font size="2">To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org<br>
</font></tt><tt><font size="2">For additional commands, e-mail: java-user-help@lucene.apache.org<br>
</font></tt></body></html>
--=_related E3143EC4F95E2C65852576350079297D_=--

--=_mixed E3143EC4F95E2C65852576350079297D_=
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--=_mixed E3143EC4F95E2C65852576350079297D_=--

From java-user-return-42424-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 18 22:25:01 2009
Return-Path: <java-user-return-42424-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45525 invoked from network); 18 Sep 2009 22:25:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Sep 2009 22:25:01 -0000
Received: (qmail 54605 invoked by uid 500); 18 Sep 2009 22:24:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54552 invoked by uid 500); 18 Sep 2009 22:24:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54542 invoked by uid 99); 18 Sep 2009 22:24:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 22:24:58 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mdufrasne@nvidia.com designates 216.228.112.145 as permitted sender)
Received: from [216.228.112.145] (HELO hqemgate03.nvidia.com) (216.228.112.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Sep 2009 22:24:49 +0000
Received: from hqnvupgp02.nvidia.com (Not Verified[172.17.98.15]) by hqemgate03.nvidia.com
	id <B4ab409040001>; Fri, 18 Sep 2009 15:26:12 -0700
Received: from hqemhub01.nvidia.com ([172.17.108.22])
  by hqnvupgp02.nvidia.com (PGP Universal service);
  Fri, 18 Sep 2009 15:24:27 -0700
X-PGP-Universal: processed;
	by hqnvupgp02.nvidia.com on Fri, 18 Sep 2009 15:24:27 -0700
Received: from HQMAIL04.nvidia.com ([172.17.200.17]) by hqemhub01.nvidia.com
 ([172.17.98.26]) with mapi; Fri, 18 Sep 2009 15:24:27 -0700
From: Matt Dufrasne <mdufrasne@nvidia.com>
To: "'java-user@lucene.apache.org'" <java-user@lucene.apache.org>
Date: Fri, 18 Sep 2009 15:24:27 -0700
Subject: Accepted: Invitation: Free Webinar - Apache Lucene 2.9: Technical
 Overview of New Features (Sep 24 02:00 PM EDT)
Thread-Topic: Invitation: Free Webinar - Apache Lucene 2.9: Technical
 Overview of New Features (Sep 24 02:00 PM EDT)
Thread-Index: Aco4rGZ5iJHhoBRyTLKNuFW749ETlgAAl9LwAAAArOA=
Message-ID: <1BEF4F56914145408DFAD4EEA44E8C421057FC5FAB@HQMAIL04.nvidia.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_002_1BEF4F56914145408DFAD4EEA44E8C421057FC5FABHQMAIL04nvidi_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_002_1BEF4F56914145408DFAD4EEA44E8C421057FC5FABHQMAIL04nvidi_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

DQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KVGhpcyBlbWFpbCBtZXNzYWdlIGlzIGZvciB0
aGUgc29sZSB1c2Ugb2YgdGhlIGludGVuZGVkIHJlY2lwaWVudChzKSBhbmQgbWF5IGNvbnRhaW4N
CmNvbmZpZGVudGlhbCBpbmZvcm1hdGlvbi4gIEFueSB1bmF1dGhvcml6ZWQgcmV2aWV3LCB1c2Us
IGRpc2Nsb3N1cmUgb3IgZGlzdHJpYnV0aW9uDQppcyBwcm9oaWJpdGVkLiAgSWYgeW91IGFyZSBu
b3QgdGhlIGludGVuZGVkIHJlY2lwaWVudCwgcGxlYXNlIGNvbnRhY3QgdGhlIHNlbmRlciBieQ0K
cmVwbHkgZW1haWwgYW5kIGRlc3Ryb3kgYWxsIGNvcGllcyBvZiB0aGUgb3JpZ2luYWwgbWVzc2Fn
ZS4NCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQo=

--_002_1BEF4F56914145408DFAD4EEA44E8C421057FC5FABHQMAIL04nvidi_
Content-Type: text/calendar; charset="utf-8"; method=REPLY
Content-Transfer-Encoding: base64

QkVHSU46VkNBTEVOREFSDQpNRVRIT0Q6UkVQTFkNClBST0RJRDpNaWNyb3NvZnQgRXhjaGFuZ2Ug
U2VydmVyIDIwMDcNClZFUlNJT046Mi4wDQpCRUdJTjpWVElNRVpPTkUNClRaSUQ6UGFjaWZpYyBT
dGFuZGFyZCBUaW1lDQpCRUdJTjpTVEFOREFSRA0KRFRTVEFSVDoxNjAxMDEwMVQwMjAwMDANClRa
T0ZGU0VURlJPTTotMDcwMA0KVFpPRkZTRVRUTzotMDgwMA0KUlJVTEU6RlJFUT1ZRUFSTFk7SU5U
RVJWQUw9MTtCWURBWT0xU1U7QllNT05USD0xMQ0KRU5EOlNUQU5EQVJEDQpCRUdJTjpEQVlMSUdI
VA0KRFRTVEFSVDoxNjAxMDEwMVQwMjAwMDANClRaT0ZGU0VURlJPTTotMDgwMA0KVFpPRkZTRVRU
TzotMDcwMA0KUlJVTEU6RlJFUT1ZRUFSTFk7SU5URVJWQUw9MTtCWURBWT0yU1U7QllNT05USD0z
DQpFTkQ6REFZTElHSFQNCkVORDpWVElNRVpPTkUNCkJFR0lOOlZFVkVOVA0KQVRURU5ERUU7UEFS
VFNUQVQ9QUNDRVBURUQ7Q049TWF0dCBEdWZyYXNuZTpNQUlMVE86bWR1ZnJhc25lQG52aWRpYS5j
b20NCkNPTU1FTlQ7TEFOR1VBR0U9ZW4tVVM6DQpTVU1NQVJZO0xBTkdVQUdFPWVuLVVTOkFjY2Vw
dGVkOiBJbnZpdGF0aW9uOiBGcmVlIFdlYmluYXIgLSBBcGFjaGUgTHVjZW5lIDINCiAuOTogVGVj
aG5pY2FsIE92ZXJ2aWV3IG9mIE5ldyBGZWF0dXJlcyAoU2VwIDI0IDAyOjAwIFBNIEVEVCkNCkRU
U1RBUlQ7VFpJRD1QYWNpZmljIFN0YW5kYXJkIFRpbWU6MjAwOTA5MjRUMTEwMDAwDQpEVEVORDtU
WklEPVBhY2lmaWMgU3RhbmRhcmQgVGltZToyMDA5MDkyNFQxMjAwMDANClVJRDpFMzE0M0VDNEY5
NUUyQzY1ODUyNTc2MzUwMDc5Mjk3RC1Mb3R1c19Ob3Rlc19HZW5lcmF0ZWQNCkNMQVNTOlBVQkxJ
Qw0KUFJJT1JJVFk6NQ0KRFRTVEFNUDoyMDA5MDkxOFQyMjI0MjdaDQpUUkFOU1A6T1BBUVVFDQpT
VEFUVVM6Q09ORklSTUVEDQpTRVFVRU5DRTowDQpMT0NBVElPTjtMQU5HVUFHRT1lbi1VUzoNClgt
TUlDUk9TT0ZULUNETy1BUFBULVNFUVVFTkNFOjANClgtTUlDUk9TT0ZULUNETy1PV05FUkFQUFRJ
RDotMQ0KWC1NSUNST1NPRlQtQ0RPLUJVU1lTVEFUVVM6QlVTWQ0KWC1NSUNST1NPRlQtQ0RPLUlO
VEVOREVEU1RBVFVTOkJVU1kNClgtTUlDUk9TT0ZULUNETy1BTExEQVlFVkVOVDpGQUxTRQ0KWC1N
SUNST1NPRlQtQ0RPLUlNUE9SVEFOQ0U6MQ0KWC1NSUNST1NPRlQtQ0RPLUlOU1RUWVBFOjANCkVO
RDpWRVZFTlQNCkVORDpWQ0FMRU5EQVINCg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NClRo
aXMgZW1haWwgbWVzc2FnZSBpcyBmb3IgdGhlIHNvbGUgdXNlIG9mIHRoZSBpbnRlbmRlZCByZWNp
cGllbnQocykgYW5kIG1heSBjb250YWluDQpjb25maWRlbnRpYWwgaW5mb3JtYXRpb24uICBBbnkg
dW5hdXRob3JpemVkIHJldmlldywgdXNlLCBkaXNjbG9zdXJlIG9yIGRpc3RyaWJ1dGlvbg0KaXMg
cHJvaGliaXRlZC4gIElmIHlvdSBhcmUgbm90IHRoZSBpbnRlbmRlZCByZWNpcGllbnQsIHBsZWFz
ZSBjb250YWN0IHRoZSBzZW5kZXIgYnkNCnJlcGx5IGVtYWlsIGFuZCBkZXN0cm95IGFsbCBjb3Bp
ZXMgb2YgdGhlIG9yaWdpbmFsIG1lc3NhZ2UuDQotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0K

--_002_1BEF4F56914145408DFAD4EEA44E8C421057FC5FABHQMAIL04nvidi_--

From java-user-return-42425-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 19 07:39:50 2009
Return-Path: <java-user-return-42425-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41620 invoked from network); 19 Sep 2009 07:39:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Sep 2009 07:39:50 -0000
Received: (qmail 9851 invoked by uid 500); 19 Sep 2009 07:39:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9749 invoked by uid 500); 19 Sep 2009 07:39:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9739 invoked by uid 99); 19 Sep 2009 07:39:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 19 Sep 2009 07:39:48 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aditya.kulkarni@gmail.com designates 209.85.222.183 as permitted sender)
Received: from [209.85.222.183] (HELO mail-pz0-f183.google.com) (209.85.222.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 19 Sep 2009 07:39:38 +0000
Received: by pzk13 with SMTP id 13so1366663pzk.29
        for <java-user@lucene.apache.org>; Sat, 19 Sep 2009 00:39:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:from:to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :x-mailer:thread-index:content-language;
        bh=ufd78jE/55G+djSB4wZP6q+JszMvyRrFyzFLbwrdCvg=;
        b=cGoxYhk/AhFZqe0yV6s3uvU0DHcs5EfUtASTQWZcJOdj5e75c5s+qcsbauclMQS8MY
         nLRlK1WVXdA5QAgYc3eR3b/6HOTUMw1zqvWsGIN2dTxa0xlfmr1vVro2iMRu/6aNpstP
         Gkm5jLgvah8cA/MMilh57K80timM5bWPXPur8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=from:to:subject:date:message-id:mime-version:content-type
         :content-transfer-encoding:x-mailer:thread-index:content-language;
        b=TrkcZEJRInKfuuwu4CzYf6VBSNk2x9Girk2E/GvXxFQZS+LQKlJaf3x4Xviz0HCcKI
         Q3YYIfj6oWqEfqoXkitv8rfM4jyRxxQaO0AuHN5MKa/DayN5OkbH+HfSCHtGxL9Fuk8u
         +QpcRu3YGvQDAAlJgDdlHZItegt26BRG69YZ4=
Received: by 10.115.81.24 with SMTP id i24mr4084676wal.194.1253345958126;
        Sat, 19 Sep 2009 00:39:18 -0700 (PDT)
Received: from Aditya ([121.246.214.218])
        by mx.google.com with ESMTPS id 22sm1464176pxi.10.2009.09.19.00.39.15
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 19 Sep 2009 00:39:16 -0700 (PDT)
From: "Aditya" <aditya.kulkarni@gmail.com>
To: <java-user@lucene.apache.org>
Subject: Accepted: Free Webinar - Apache Lucene 2.9: Technical Overview of New Features
Date: Sat, 19 Sep 2009 13:09:09 +0530
Message-ID: <4ab48aa4.161bf30a.3104.685b@mx.google.com>
MIME-Version: 1.0
Content-Type: text/calendar; method=REPLY;
	charset="UTF-8"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Aco4rDnggHZY/qZATq60GkWo272fNQAQOGcgAAPKk9A=
Content-Language: en-us
X-Virus-Checked: Checked by ClamAV on apache.org

BEGIN:VCALENDAR
PRODID:-//Microsoft Corporation//Outlook 12.0 MIMEDIR//EN
VERSION:2.0
METHOD:REPLY
X-MS-OLK-FORCEINSPECTOROPEN:TRUE
BEGIN:VEVENT
ATTENDEE;PARTSTAT=ACCEPTED:mailto:aditya.kulkarni@gmail.com
CLASS:PUBLIC
CREATED:20090919T073908Z
DTEND:20090924T190000Z
DTSTAMP:20090919T073908Z
DTSTART:20090924T180000Z
LAST-MODIFIED:20090919T073908Z
PRIORITY:5
SEQUENCE:0
SUMMARY:Accepted: Free Webinar - Apache Lucene 2.9: Technical Overview of N
	ew Features
TRANSP:OPAQUE
UID:E3143EC4F95E2C65852576350079297D-Lotus_Notes_Generated
X-MICROSOFT-CDO-BUSYSTATUS:BUSY
X-MICROSOFT-CDO-IMPORTANCE:1
X-MS-OLK-AUTOFILLLOCATION:TRUE
X-MS-OLK-CONFTYPE:0
END:VEVENT
END:VCALENDAR


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42426-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 19 16:59:46 2009
Return-Path: <java-user-return-42426-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32942 invoked from network); 19 Sep 2009 16:59:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Sep 2009 16:59:46 -0000
Received: (qmail 86050 invoked by uid 500); 19 Sep 2009 16:59:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85987 invoked by uid 500); 19 Sep 2009 16:59:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85977 invoked by uid 99); 19 Sep 2009 16:59:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 19 Sep 2009 16:59:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.186 as permitted sender)
Received: from [209.85.221.186] (HELO mail-qy0-f186.google.com) (209.85.221.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 19 Sep 2009 16:59:32 +0000
Received: by qyk16 with SMTP id 16so1512169qyk.20
        for <java-user@lucene.apache.org>; Sat, 19 Sep 2009 09:59:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to
         :organization:user-agent:mime-version:to:subject:x-enigmail-version
         :content-type:content-transfer-encoding;
        bh=bd9KfH5jbtKTROnRYUF5lRIaTkqWrJ84/kYo3XSlt3s=;
        b=SZAFajObwR/NDse1qPTQZNTRh82ZM0c86NIfYFhe/7qCQtTpNusFXBoZ7biVNT7W53
         aebqkJHABTLbVcpMXU+MEpx5Oy1+dzZpMs9t0K1vzxLYI6yNR6tTi5n7XPB5PJQhfqPb
         qJdMJzgzkdKhJnaZGcxlrnqkCTRlMWibG+Wjo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:organization:user-agent:mime-version
         :to:subject:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=X+fH7deg1KUTodQTnA4WmBKRVYKGam8MYncQlnZvoARC0cNkyb90eHhyvICSLCCpDO
         hZwvohFSzd8MgXOOaI5xXenMgC+8PJ5x6VOunxlZHhsRUgDDZU1en9CgPJMWKh+R3YuZ
         hmnO8d75NdovswZwUTfjh8L5J88zgPXkzlk6w=
Received: by 10.224.123.169 with SMTP id p41mr2314465qar.344.1253379551319;
        Sat, 19 Sep 2009 09:59:11 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 2sm2847938qwi.12.2009.09.19.09.59.10
        (version=SSLv3 cipher=RC4-MD5);
        Sat, 19 Sep 2009 09:59:10 -0700 (PDT)
Message-ID: <4AB50DE1.3080407@apache.org>
Date: Sat, 19 Sep 2009 12:59:13 -0400
From: Mark Miller <markrmiller@gmail.com>
Reply-To: markrmiller@apache.org
Organization: Apache
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene 2.9 RC5 now available for testing
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hello Lucene users,

On behalf of the Lucene dev community (a growing community far larger
than just the committers) I would like to announce the fifth (and
hopefully last) release candidate for Lucene 2.9.

Please download and check it out - take it for a spin and kick the
tires. If all goes well, we hope to release the final version of
Lucene 2.9 very shortly.

The following issues were addressed since the last release candidate:
LUCENE-1919 - Fix analysis back compat break.
LUCENE-1918 - fix corner cases (resulting in exceptions) when passing
ParallelReader to IndexWriter.addIndexes
LUCENE-1913 - FastVectorHighlighter: AIOOBE occurs if one PhraseQuery
is contained by another PhraseQuery
LUCENE-1911 - Add a new DocIdSet.isCacheable() method that defaults to
false, but is true for some DocIdSet impls, that are effective and use
no disk I/O during iteration (OpenBitSet, SortedVIntList, DocIdBitSet,
EMPTY_DOCIDSET, some FieldCache filter impls). CachingWrapperFilter
now copies all DocIdSets, which are not cacheable, into an
OpenBitSetDISI for caching.
LUCENE-1912 - fix issue when 2 or more terms are concatenated in
fast-vector-highlighter
LUCENE-1908 - Scoring documentation imrovements in Similarity javadocs.
LUCENE-1872 - Javadocs updates of Numeric*

While we generally try and maintain full backwards compatibility
between major versions, Lucene 2.9 has a variety of breaks that are
spelled out in the 'Changes in backwards compatibility policy' section
of CHANGES.txt.

We recommend that you recompile your application with Lucene 2.9
rather than attempting to drop it in. This will alert you to any
issues you may have to fix if you are affected by one of the backward
compatibility breaks. As always, its a really good idea to thoroughly
read CHANGES.txt before upgrading. Also, remember that this is a
release candidate, and not the final Lucene 2.9 release.

Lucene 2.9 comes with a bevy of new features, including:

  * Per segment searching and caching (can lead to much faster reopen
    among other things)

  * Near real-time search capabilities added to IndexWriter

  * New Query types

  * Smarter, more scalable multi-term queries (wildcard, range, etc)

  * A freshly optimized Collector/Scorer API

  * Improved Unicode support and the addition of Collation contrib

  * A new Attribute based TokenStream API

  * A new QueryParser framework in contrib with a core QueryParser
    replacement impl included.

  * Scoring is now optional when sorting by Field, or using a custom
    Collector, gaining sizable performance when scores are not
    required.

  * New analyzers (PersianAnalyzer, ArabicAnalyzer,
    SmartChineseAnalyzer)

  * New fast-vector-highlighter

  * Lucene now includes high-performance handling of numeric fields.
    Such fields are indexed with a trie structure, enabling simple to
    use and much faster numeric range searching without having to
    externally pre-process numeric values into textual values.

  ---

And many, many more features, bug fixes, optimizations, and various
improvements. You can find the full list of changes here:

HTML version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Changes.html

Text version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CHANGES.txt

Many changes have also occurred in Lucene's Contrib area:

HTML version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/Contrib-Changes.html

Text version:
http://people.apache.org/~markrmiller/staging-area/lucene2.9changes/CONTRIB-CHANGES.txt


Download release candidate 5 here:
http://people.apache.org/~markrmiller/staging-area/lucene2.9rc5/

Be sure to report back with any issues you find!

Thanks,

Mark Miller
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkq1Dd0ACgkQ0DU3IV7ywDlFNACeOtjmjUBX/OOlPdIVZzdn8WcY
dEkAnAxzUEC4CDexEzIH3pdOjYa+kCHu
=Zn2F
-----END PGP SIGNATURE-----


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42427-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 19 20:36:14 2009
Return-Path: <java-user-return-42427-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65250 invoked from network); 19 Sep 2009 20:36:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Sep 2009 20:36:14 -0000
Received: (qmail 72304 invoked by uid 500); 19 Sep 2009 20:36:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72229 invoked by uid 500); 19 Sep 2009 20:36:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72219 invoked by uid 99); 19 Sep 2009 20:36:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 19 Sep 2009 20:36:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of office@florian-klingler.at designates 82.192.1.228 as permitted sender)
Received: from [82.192.1.228] (HELO mail.florian-klingler.at) (82.192.1.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 19 Sep 2009 20:36:02 +0000
Received: from zcs.florian-klingler.at (zcs.florian-klingler.at [172.16.1.100])
	by mail.florian-klingler.at (Postfix) with ESMTP id 928D85AE17F
	for <java-user@lucene.apache.org>; Sat, 19 Sep 2009 22:35:41 +0200 (CEST)
Received: from localhost (localhost.localdomain [127.0.0.1])
	by zcs.florian-klingler.at (Postfix) with ESMTP id 747C9103441A
	for <java-user@lucene.apache.org>; Sat, 19 Sep 2009 22:35:41 +0200 (CEST)
X-Virus-Scanned: amavisd-new at zcs.florian-klingler.at
Received: from zcs.florian-klingler.at ([127.0.0.1])
	by localhost (zcs.florian-klingler.at [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id PP0Cyr9z9Efk for <java-user@lucene.apache.org>;
	Sat, 19 Sep 2009 22:35:40 +0200 (CEST)
Received: from zcs.florian-klingler.at (zcs.florian-klingler.at [172.16.1.100])
	by zcs.florian-klingler.at (Postfix) with ESMTP id 9B3941034419
	for <java-user@lucene.apache.org>; Sat, 19 Sep 2009 22:35:40 +0200 (CEST)
Date: Sat, 19 Sep 2009 22:35:40 +0200 (CEST)
From: Florian Klingler <office@florian-klingler.at>
To: java-user@lucene.apache.org
Message-ID: <21845561.3731253392540525.JavaMail.root@zcs.florian-klingler.at>
Subject: Lucene search in URL
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Originating-IP: [192.168.1.106]
X-Mailer: Zimbra 6.0.0_GA_1802.UBUNTU8 (ZimbraWebClient - FF3.0 (Linux)/6.0.0_GA_1802.UBUNTU8)
X-Virus-Checked: Checked by ClamAV on apache.org

Dear List,

I'm working on a project where i have to check a Blacklist of URL's with Lucene. (about 500.000)
Is it possible to search for a URL in a hierarchical context?

for Example:
Blacklist entry: "en.wikipedia.org/wiki/production_code"

"en.wikipedia.org/wiki/production_code/test" should match
"en.wikipedia.org/wiki/test" should not match


Thank you very much,
Florian Klingler

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42428-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 19 22:01:16 2009
Return-Path: <java-user-return-42428-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73864 invoked from network); 19 Sep 2009 22:01:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Sep 2009 22:01:16 -0000
Received: (qmail 96344 invoked by uid 500); 19 Sep 2009 22:01:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96259 invoked by uid 500); 19 Sep 2009 22:01:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96249 invoked by uid 99); 19 Sep 2009 22:01:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 19 Sep 2009 22:01:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.18] (HELO web52908.mail.re2.yahoo.com) (206.190.49.18)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 19 Sep 2009 22:01:01 +0000
Received: (qmail 44840 invoked by uid 60001); 19 Sep 2009 22:00:40 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253397640; bh=38AHE+uU+TBbWDiI/L9lOQFAlT2Udre/JKHL1UGa0fc=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=QRF70dmQ95ugRw0GDuNZMlZ+cK7FHxT4gs9HhiKazXRbZ8sveKW5KIR2qkBdYMMHR7BlHLP4CF6IfekDPpL7a2tYTjDHs9IahlKCvwXSH6L5A0j3BdGwHp1kcS8vWsQLru6Jr/P6/POH890ytG2N6zyP7DD/SbFJUCr+9Hk0iqI=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=opGDoS1sr7MHbgvIIMhIW2FJbbqWbGUDBQvOKkMNXRLI7AnBqwqiuQFmK9sL656pTizNv5STO5AVJmFAqH0x9hpr/t3kN3AhVgJ7PlJqcxELqeHwN+FnRp+mQCG1NbfCe8EmEzg6sPGrfIS58Eog4H97murL1AeZx833aBgMXEk=;
Message-ID: <69152.38456.qm@web52908.mail.re2.yahoo.com>
X-YMail-OSG: Vff7ddwVM1mGlDkiHtsKvdRTw2WTiDtN.s7iDOatADLfuPbxFb2iw8D1Dye0xsrNMCO2a59rXskpmyuV5hEOZgC4MyUlO0s1a.M5fgtwJpxNU5Gw9fPWoi4zo2K4j3VpkNFJmltflFKeuBg1DD1pB4twl4EhWUORr_l2yZtCu.SwOQjPfWRWwloEmlTADEJo4XAznGe_hKBo68_4x15rmhLaXhR3dp8dr8SgxpYX6Br52JCdgKi3mLvEPEVAKPe8v8_oMA9ovsf6qJ4bhA7U.EpHIfo6HZxcv4IlwWOnyqpAA4dDrzpnfrAdcoYBa.acaUmFV2KmJN0XwJy4QEzdtcKsfRdUXTTVHXa.rcXq4_B4oA--
Received: from [78.165.19.67] by web52908.mail.re2.yahoo.com via HTTP; Sat, 19 Sep 2009 15:00:40 PDT
X-Mailer: YahooMailClassic/7.0.14 YahooMailWebService/0.7.347.2
Date: Sat, 19 Sep 2009 15:00:40 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Lucene search in URL
To: java-user@lucene.apache.org
In-Reply-To: <21845561.3731253392540525.JavaMail.root@zcs.florian-klingler.at>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> Dear List,
> 
> I'm working on a project where i have to check a Blacklist
> of URL's with Lucene. (about 500.000)
> Is it possible to search for a URL in a hierarchical
> context?
> 
> for Example:
> Blacklist entry: "en.wikipedia.org/wiki/production_code"
> 
> "en.wikipedia.org/wiki/production_code/test" should match
> "en.wikipedia.org/wiki/test" should not match

If any substring (0 to n) of your query matches a document completely than that query should match, right? Thats what I understand from your examples.

You can achieve this bu using two different analyzers for index and query time.

query analyzer:

KeywordTokenizer
EdgeNGramTokenFilter (side = EdgeNGramTokenFilter.Side.FRONT , mingram = 1, maxgram=512)

index analyzer:

KeywordTokenizer

The index analyzer comes out-of-the-box: org.apache.lucene.analysis.KeywordAnalyzer
But you need to write query analyzer.

If you want case-insensitive search you can add LowercaseFilter to both of your analyzers. 

By using this, your black list urls will be indexed verbatim. (one token)

Your query "en.wikipedia.org/wiki/production_code/test" 
will be broken in to these pieces and one of them will match your document:

e 
en 
en. 
en.w 
en.wi 
en.wik 
en.wiki 
en.wikip 
en.wikipe 
en.wikiped 
en.wikipedi 
en.wikipedia 
en.wikipedia. 
en.wikipedia.o 
en.wikipedia.or 
en.wikipedia.org 
en.wikipedia.org/ 
en.wikipedia.org/w 
en.wikipedia.org/wi 
en.wikipedia.org/wik 
en.wikipedia.org/wiki 
en.wikipedia.org/wiki/ 
en.wikipedia.org/wiki/p 
en.wikipedia.org/wiki/pr 
en.wikipedia.org/wiki/pro 
en.wikipedia.org/wiki/prod 
en.wikipedia.org/wiki/produ 
en.wikipedia.org/wiki/produc 
en.wikipedia.org/wiki/product 
en.wikipedia.org/wiki/producti 
en.wikipedia.org/wiki/productio 
en.wikipedia.org/wiki/production 
en.wikipedia.org/wiki/production_ 
en.wikipedia.org/wiki/production_c 
en.wikipedia.org/wiki/production_co 
en.wikipedia.org/wiki/production_cod 
* en.wikipedia.org/wiki/production_code  // this is your document a match
en.wikipedia.org/wiki/production_code/ 
en.wikipedia.org/wiki/production_code/t 
en.wikipedia.org/wiki/production_code/te 
en.wikipedia.org/wiki/production_code/tes 
en.wikipedia.org/wiki/production_code/test 

The none of the pieces of the query "en.wikipedia.org/wiki/test" will match your document.

Hope this helps.


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42429-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 20 04:58:56 2009
Return-Path: <java-user-return-42429-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19879 invoked from network); 20 Sep 2009 04:58:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Sep 2009 04:58:56 -0000
Received: (qmail 8245 invoked by uid 500); 20 Sep 2009 04:58:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8158 invoked by uid 500); 20 Sep 2009 04:58:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8148 invoked by uid 99); 20 Sep 2009 04:58:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 04:58:54 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.216.174 as permitted sender)
Received: from [209.85.216.174] (HELO mail-px0-f174.google.com) (209.85.216.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 04:58:44 +0000
Received: by pxi4 with SMTP id 4so1681852pxi.23
        for <java-user@lucene.apache.org>; Sat, 19 Sep 2009 21:58:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uvXOjhFvJak4+RkLQIL6fI7sWTSG9SduxTCh/y4jeWg=;
        b=RYRtRzjRgjELo+upGd8jwUscKj+M1ZcHElBGlbVMQs0aznC9N+PPe1csQLUnRISG2X
         NYeCZDDtxs06+9PqRDPfJo2fil4zSbXs04nQ+de9EgiZkeu0yw9SMWURWR41v4CxDHGq
         fnN9S8GJ7RHcodG5pcUOxQsYYpdwT1MepwdcE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=tZCOSZECUrjjByLCnIjZi/e5LbNOTQFkCxumHaiVHza9nZ8E1tyt9PSjTuaNAIODxc
         fitgt4Ug5TWyIbMoOREHYo15wlf4VnV6a1flD8e/xcpRWtOtJ+hV/AwWJUfMeXl82BLj
         cIHvL99ngPActarOB/B+Nw7SA/90uY4JMVhG0=
MIME-Version: 1.0
Received: by 10.115.103.27 with SMTP id f27mr5736526wam.205.1253422704283; 
	Sat, 19 Sep 2009 21:58:24 -0700 (PDT)
In-Reply-To: <69152.38456.qm@web52908.mail.re2.yahoo.com>
References: <21845561.3731253392540525.JavaMail.root@zcs.florian-klingler.at>
	 <69152.38456.qm@web52908.mail.re2.yahoo.com>
Date: Sun, 20 Sep 2009 10:28:24 +0530
Message-ID: <867513fe0909192158v7cd8f71bmac7a008737d32448@mail.gmail.com>
Subject: Re: Lucene search in URL
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64ccbb20ad1ec0473fb371a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64ccbb20ad1ec0473fb371a
Content-Type: text/plain; charset=ISO-8859-1

Hi Florian,
Perhaps you might run into issues with using an ngram. How I see it is that
you need tokenized urls and need to run an exact search using a keyword
tokenizer on the search string.
You could try this. I am assuming it'll work.
so something like
en.wikipedia.org/wiki/production_code/test
gets tokenized as
[en] [wikipedia] [org] [wiki[ [production_code] [test]

so an exact search for any set of subsequent (while maintaining the order)
would get you the result. And yes, you might want to look at your tokenizers
a little bit.

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Sun, Sep 20, 2009 at 3:30 AM, AHMET ARSLAN <iorixxx@yahoo.com> wrote:

> > Dear List,
> >
> > I'm working on a project where i have to check a Blacklist
> > of URL's with Lucene. (about 500.000)
> > Is it possible to search for a URL in a hierarchical
> > context?
> >
> > for Example:
> > Blacklist entry: "en.wikipedia.org/wiki/production_code"
> >
> > "en.wikipedia.org/wiki/production_code/test" should match
> > "en.wikipedia.org/wiki/test" should not match
>
> If any substring (0 to n) of your query matches a document completely than
> that query should match, right? Thats what I understand from your examples.
>
> You can achieve this bu using two different analyzers for index and query
> time.
>
> query analyzer:
>
> KeywordTokenizer
> EdgeNGramTokenFilter (side = EdgeNGramTokenFilter.Side.FRONT , mingram = 1,
> maxgram=512)
>
> index analyzer:
>
> KeywordTokenizer
>
> The index analyzer comes out-of-the-box:
> org.apache.lucene.analysis.KeywordAnalyzer
> But you need to write query analyzer.
>
> If you want case-insensitive search you can add LowercaseFilter to both of
> your analyzers.
>
> By using this, your black list urls will be indexed verbatim. (one token)
>
> Your query "en.wikipedia.org/wiki/production_code/test"
> will be broken in to these pieces and one of them will match your document:
>
> e
> en
> en.
> en.w
> en.wi
> en.wik
> en.wiki
> en.wikip
> en.wikipe
> en.wikiped
> en.wikipedi
> en.wikipedia
> en.wikipedia.
> en.wikipedia.o
> en.wikipedia.or
> en.wikipedia.org
> en.wikipedia.org/
> en.wikipedia.org/w
> en.wikipedia.org/wi
> en.wikipedia.org/wik
> en.wikipedia.org/wiki
> en.wikipedia.org/wiki/
> en.wikipedia.org/wiki/p
> en.wikipedia.org/wiki/pr
> en.wikipedia.org/wiki/pro
> en.wikipedia.org/wiki/prod
> en.wikipedia.org/wiki/produ
> en.wikipedia.org/wiki/produc
> en.wikipedia.org/wiki/product
> en.wikipedia.org/wiki/producti
> en.wikipedia.org/wiki/productio
> en.wikipedia.org/wiki/production
> en.wikipedia.org/wiki/production_
> en.wikipedia.org/wiki/production_c
> en.wikipedia.org/wiki/production_co
> en.wikipedia.org/wiki/production_cod
> * en.wikipedia.org/wiki/production_code  // this is your document a match
> en.wikipedia.org/wiki/production_code/
> en.wikipedia.org/wiki/production_code/t
> en.wikipedia.org/wiki/production_code/te
> en.wikipedia.org/wiki/production_code/tes
> en.wikipedia.org/wiki/production_code/test
>
> The none of the pieces of the query "en.wikipedia.org/wiki/test" will
> match your document.
>
> Hope this helps.
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64ccbb20ad1ec0473fb371a--

From java-user-return-42430-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 20 08:11:08 2009
Return-Path: <java-user-return-42430-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43748 invoked from network); 20 Sep 2009 08:11:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Sep 2009 08:11:08 -0000
Received: (qmail 45983 invoked by uid 500); 20 Sep 2009 08:11:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45908 invoked by uid 500); 20 Sep 2009 08:11:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45898 invoked by uid 99); 20 Sep 2009 08:11:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 08:11:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of office@florian-klingler.at designates 82.192.1.228 as permitted sender)
Received: from [82.192.1.228] (HELO mail.florian-klingler.at) (82.192.1.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 08:10:56 +0000
Received: from zcs.florian-klingler.at (zcs.florian-klingler.at [172.16.1.100])
	by mail.florian-klingler.at (Postfix) with ESMTP id 9761D5AE017
	for <java-user@lucene.apache.org>; Sun, 20 Sep 2009 10:10:34 +0200 (CEST)
Received: from localhost (localhost.localdomain [127.0.0.1])
	by zcs.florian-klingler.at (Postfix) with ESMTP id 7C212103443E
	for <java-user@lucene.apache.org>; Sun, 20 Sep 2009 10:10:34 +0200 (CEST)
X-Virus-Scanned: amavisd-new at zcs.florian-klingler.at
Received: from zcs.florian-klingler.at ([127.0.0.1])
	by localhost (zcs.florian-klingler.at [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 8TDSnGaqD93Q for <java-user@lucene.apache.org>;
	Sun, 20 Sep 2009 10:10:33 +0200 (CEST)
Received: from zcs.florian-klingler.at (zcs.florian-klingler.at [172.16.1.100])
	by zcs.florian-klingler.at (Postfix) with ESMTP id B560A1034440
	for <java-user@lucene.apache.org>; Sun, 20 Sep 2009 10:10:33 +0200 (CEST)
Date: Sun, 20 Sep 2009 10:10:33 +0200 (CEST)
From: Florian Klingler <office@florian-klingler.at>
To: java-user@lucene.apache.org
Message-ID: <18113133.3811253434233510.JavaMail.root@zcs.florian-klingler.at>
In-Reply-To: <867513fe0909192158v7cd8f71bmac7a008737d32448@mail.gmail.com>
Subject: Re: Lucene search in URL
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Originating-IP: [192.168.1.101]
X-Mailer: Zimbra 6.0.0_GA_1802.UBUNTU8 (ZimbraWebClient - FF3.0 (Linux)/6.0.0_GA_1802.UBUNTU8)
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for all the Answers,


I'll now try to implement this.
But i have another question now:

Is there a possibility in Lucene to do a Exact Search with
Tokenized text?

Like: "en.wikipedia.org/wiki/production_code" is Tokenized in
"en.wikipedia.org"
"wiki"
"production"
"code"
with Standardanalyzer.

And a search will match iff(and only if) all the Tokens match?
Like "en.wikipedia.org/wiki/production_code" matches
"en.wikipedia.org" does not match.


The Purpose of this is following:
I have a Blacklist of URLs.
If i want to access a URL the Domain is searched in Lucene. (fast)
If there is a match, following will be searched (a bit slowlier)
"en.wikipedia.org/wiki" -> does not match
"en.wikipedia.org/wiki/production" -> does not match
* "en.wikipedia.org/wiki/production_code" -> Matches, so the URL and all su=
bURLs are blocked.

So my Question is, is there a possibility to specify an Query to serch only=
 for exact Document-Matches.


Thanks very much,
Florian Klingler

----- Urspr=C3=BCngliche Mail -----
Von: "Anshum" <anshumg@gmail.com>
An: java-user@lucene.apache.org
Gesendet: Sonntag, 20. September 2009 06:58:24
Betreff: Re: Lucene search in URL

Hi Florian,
Perhaps you might run into issues with using an ngram. How I see it is that
you need tokenized urls and need to run an exact search using a keyword
tokenizer on the search string.
You could try this. I am assuming it'll work.
so something like
en.wikipedia.org/wiki/production_code/test
gets tokenized as
[en] [wikipedia] [org] [wiki[ [production_code] [test]

so an exact search for any set of subsequent (while maintaining the order)
would get you the result. And yes, you might want to look at your tokenizer=
s
a little bit.

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Sun, Sep 20, 2009 at 3:30 AM, AHMET ARSLAN <iorixxx@yahoo.com> wrote:

> > Dear List,
> >
> > I'm working on a project where i have to check a Blacklist
> > of URL's with Lucene. (about 500.000)
> > Is it possible to search for a URL in a hierarchical
> > context?
> >
> > for Example:
> > Blacklist entry: "en.wikipedia.org/wiki/production_code"
> >
> > "en.wikipedia.org/wiki/production_code/test" should match
> > "en.wikipedia.org/wiki/test" should not match
>
> If any substring (0 to n) of your query matches a document completely tha=
n
> that query should match, right? Thats what I understand from your example=
s.
>
> You can achieve this bu using two different analyzers for index and query
> time.
>
> query analyzer:
>
> KeywordTokenizer
> EdgeNGramTokenFilter (side =3D EdgeNGramTokenFilter.Side.FRONT , mingram =
=3D 1,
> maxgram=3D512)
>
> index analyzer:
>
> KeywordTokenizer
>
> The index analyzer comes out-of-the-box:
> org.apache.lucene.analysis.KeywordAnalyzer
> But you need to write query analyzer.
>
> If you want case-insensitive search you can add LowercaseFilter to both o=
f
> your analyzers.
>
> By using this, your black list urls will be indexed verbatim. (one token)
>
> Your query "en.wikipedia.org/wiki/production_code/test"
> will be broken in to these pieces and one of them will match your documen=
t:
>
> e
> en
> en.
> en.w
> en.wi
> en.wik
> en.wiki
> en.wikip
> en.wikipe
> en.wikiped
> en.wikipedi
> en.wikipedia
> en.wikipedia.
> en.wikipedia.o
> en.wikipedia.or
> en.wikipedia.org
> en.wikipedia.org/
> en.wikipedia.org/w
> en.wikipedia.org/wi
> en.wikipedia.org/wik
> en.wikipedia.org/wiki
> en.wikipedia.org/wiki/
> en.wikipedia.org/wiki/p
> en.wikipedia.org/wiki/pr
> en.wikipedia.org/wiki/pro
> en.wikipedia.org/wiki/prod
> en.wikipedia.org/wiki/produ
> en.wikipedia.org/wiki/produc
> en.wikipedia.org/wiki/product
> en.wikipedia.org/wiki/producti
> en.wikipedia.org/wiki/productio
> en.wikipedia.org/wiki/production
> en.wikipedia.org/wiki/production_
> en.wikipedia.org/wiki/production_c
> en.wikipedia.org/wiki/production_co
> en.wikipedia.org/wiki/production_cod
> * en.wikipedia.org/wiki/production_code  // this is your document a match
> en.wikipedia.org/wiki/production_code/
> en.wikipedia.org/wiki/production_code/t
> en.wikipedia.org/wiki/production_code/te
> en.wikipedia.org/wiki/production_code/tes
> en.wikipedia.org/wiki/production_code/test
>
> The none of the pieces of the query "en.wikipedia.org/wiki/test" will
> match your document.
>
> Hope this helps.
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42431-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 20 10:14:46 2009
Return-Path: <java-user-return-42431-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55033 invoked from network); 20 Sep 2009 10:14:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Sep 2009 10:14:46 -0000
Received: (qmail 74822 invoked by uid 500); 20 Sep 2009 10:14:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74739 invoked by uid 500); 20 Sep 2009 10:14:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74729 invoked by uid 99); 20 Sep 2009 10:14:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 10:14:44 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.15] (HELO web52905.mail.re2.yahoo.com) (206.190.49.15)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 20 Sep 2009 10:14:32 +0000
Received: (qmail 61112 invoked by uid 60001); 20 Sep 2009 10:14:11 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253441651; bh=j+vG13HgVOnBDlSVQjJGkdjsco406sTDnbwCSul3ADs=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=UvPRdvNUNQCDwf82/KpyykBkVAubrBdR51hskAcmdtVMKndF00LXt7hNxIexBPoqEL6d4/tHN18GxzOifsYxjeNebjOQIfu4n5ecvnga+U/lhPz752JaJ5jsCDzgZh0mP0DycwrozuKE3d2cQfq+TkIOx27JSDkGjLciogbO2ck=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=1ewc8HcfaD+cps0vvGG2gjaRNHT7wCtBYnBxskf13DWCcY5d+BAcz+eU0HpG0MWe2BY6HeLEcxZFju0p3YZznBbMtD7XcEgOem/pKco8xuhnseWeCjnWhPTULN3vbNd7hRMsnc/4bxq7KBQjDirjEPWpUyQ71mvm5hQPBhuTDqc=;
Message-ID: <528354.60338.qm@web52905.mail.re2.yahoo.com>
X-YMail-OSG: MriB7coVM1nR9fdqUdfay_Mvo8Z4pCX3FsdJMUBx72Gbse7Xbmd9WLsQ6314wYPiPxnNn5uFrFFMIdkdo.oWHNPNH0L2i5E_mEQUp5koSc5LHzs2lvRdYDLoVieLa8m7rQ6ZG6.8zXd9msY5WOz9TH0nRdIdWXnARxILGhreb.aMdgDSX9vNUxWDbk5jkSjSAJZ2QWgZFT5anWCSIKsbEEW4SVereat6wVjSj7HHxgJ4mudDF85qRd34KI50c1dTAZB6yao_kVVr0_tpUeL.HTdxkDltwte49XiRAk7PTI9UOnPT6IVIZJR3IRqeXMYUqMhPsrGRK6lhYM0nuE0oMrhmCmOlHUEEmaEu1.ND7II4W1xqvSKkE5Z76VrBZxycVwHuedAHjg--
Received: from [78.165.19.67] by web52905.mail.re2.yahoo.com via HTTP; Sun, 20 Sep 2009 03:14:11 PDT
X-Mailer: YahooMailClassic/7.0.14 YahooMailWebService/0.7.347.2
Date: Sun, 20 Sep 2009 03:14:11 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Lucene search in URL
To: java-user@lucene.apache.org
In-Reply-To: <18113133.3811253434233510.JavaMail.root@zcs.florian-klingler.at>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> Is there a possibility in Lucene to do a Exact Search with
> Tokenized text?
> 
> Like: "en.wikipedia.org/wiki/production_code" is Tokenized
> in
> "en.wikipedia.org"
> "wiki"
> "production"
> "code"
> with Standardanalyzer.
> 
> And a search will match iff(and only if) all the Tokens
> match?
> Like "en.wikipedia.org/wiki/production_code" matches
> "en.wikipedia.org" does not match.
> 
> 
> The Purpose of this is following:
> I have a Blacklist of URLs.
> If i want to access a URL the Domain is searched in Lucene.
> (fast)
> If there is a match, following will be searched (a bit
> slowlier)
> "en.wikipedia.org/wiki" -> does not match
> "en.wikipedia.org/wiki/production" -> does not match
> * "en.wikipedia.org/wiki/production_code" -> Matches, so
> the URL and all subURLs are blocked.
> 
> So my Question is, is there a possibility to specify an
> Query to serch only for exact Document-Matches.
> 

Document : "en.wikipedia.org/wiki/production_code"

Query 1  : "en.wikipedia.org/wiki/production_code/test"  should match
Query 2  : "en.wikipedia.org/wiki/test"                  should not match
Query 3  : "en.wikipedia.org/wiki/production"            should not match

In my proposed solution Query 3 will also match. And you don't want that. 

Am I correct?

So we cannot use letter based NGrams. We need token based Ngrams (aka Shingle)

Regarding your question "search will match iff(and only if) all the Tokens match?"
1-) all tokens in the query : Yes by setting default operator to AND.
2-) all tokens in the document: AFAIK There is no such mechanism.

You want a document match if all tokens in the document match query terms.
IMO to simulate this you need to store docs using keywordanalyzer, and manipulate queries. Since you store document as a string, exact match is guaranteed.

Query 1:

en.wikipedia.org
en.wikipedia.org/wiki
*en.wikipedia.org/wiki/production_code     [match]
en.wikipedia.org/wiki/production_code/test

Query 2: 

en.wikipedia.org
en.wikipedia.org/wiki
en.wikipedia.org/wiki/test

Query 3:

en.wikipedia.org
en.wikipedia.org/wiki
en.wikipedia.org/wiki/production

In this scenario only Q1 matches. Index analyzer is same keyword analyzer.

QueryAnalyzer:

1-) Extension of CharTokenizer that breaks only at '/' character 

protected boolean isTokenChar(char c) {
        return !(c == '/');
    }

2-) Modified ShingleFilter that uses '/' as TokenSeperator with  maxShingleSize=512

public static final String TOKEN_SEPARATOR = "/";

In this configuration only Q1 match but this query analyzer produces unnecessary tokens: For Q1 it produces 10 tokens: 

en.wikipedia.org word
en.wikipedia.org/wiki shingle
en.wikipedia.org/wiki/production_code shingle
en.wikipedia.org/wiki/production_code/test shingle
wiki word
wiki/production_code shingle
wiki/production_code/test shingle
production_code word
production_code/test shingle
test word

You need only first 4, the rest are not harmfull but unnecessary. May be you can modify this filter to output first n tokens only.

Hope this helps.

P.S. I didn't see any methods to change TOKEN_SEPARATOR in ShingleFilter.



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42432-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 20 10:22:47 2009
Return-Path: <java-user-return-42432-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55446 invoked from network); 20 Sep 2009 10:22:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Sep 2009 10:22:47 -0000
Received: (qmail 77131 invoked by uid 500); 20 Sep 2009 10:22:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77049 invoked by uid 500); 20 Sep 2009 10:22:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77039 invoked by uid 99); 20 Sep 2009 10:22:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 10:22:44 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.222.190 as permitted sender)
Received: from [209.85.222.190] (HELO mail-pz0-f190.google.com) (209.85.222.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 10:22:33 +0000
Received: by pzk28 with SMTP id 28so1891724pzk.5
        for <java-user@lucene.apache.org>; Sun, 20 Sep 2009 03:22:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=QW6bLURnxvuUDRVjKcfubX5d3kb0tou4saS1a3j2ZCY=;
        b=Kyn5SvxFmaJwVpqPzmt0IZT3XFbr5Lvonc8baZ2ilP//3pzgmVt/lT8M5AVX6CR4h7
         a8ITY1djqZqGW3GAezPsuaUBmAmkzeBMr6BVcr9LdC0zjpJ6ifVpmUAOBfEFdwn1KO0v
         2l5+6atdleUxne0jYx7iHqkklx7Ut7ZKCKKjY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=eYmfn4GUo8kAg2W1suyFzDdtKORSj1RhAB8ZBJZ+8KaDHv4IWdvcklf86MqxQYZdG/
         xD3vT0OWlFfaAvb7usiRmH/FWukgl4dFRaEkZN88GXl4QS88tfOY8GNwwJoPWEAeHLdr
         MHI2pxaVX7uvr0jDIKIhCfpbFWnXPhXFDnnjE=
MIME-Version: 1.0
Received: by 10.115.67.30 with SMTP id u30mr6182756wak.119.1253442131548; Sun, 
	20 Sep 2009 03:22:11 -0700 (PDT)
In-Reply-To: <18113133.3811253434233510.JavaMail.root@zcs.florian-klingler.at>
References: <867513fe0909192158v7cd8f71bmac7a008737d32448@mail.gmail.com>
	 <18113133.3811253434233510.JavaMail.root@zcs.florian-klingler.at>
Date: Sun, 20 Sep 2009 15:52:11 +0530
Message-ID: <867513fe0909200322x407e49cfh406615a4c2655590@mail.gmail.com>
Subject: Re: Lucene search in URL
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64e4bdcff5aa10473ffbc85
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64e4bdcff5aa10473ffbc85
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

HI Florian,
A token would get you a hit on being searched i.e. if you search for any of
the tokens from the document you'd get the document as a hit.
Also, exact searches work by considering positions.
if you search for "A B". All documents having A and B as adjacent terms (in
that order) would be picked up.
Hope that helps!

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Sun, Sep 20, 2009 at 1:40 PM, Florian Klingler <
office@florian-klingler.at> wrote:

> Thanks for all the Answers,
>
>
> I'll now try to implement this.
> But i have another question now:
>
> Is there a possibility in Lucene to do a Exact Search with
> Tokenized text?
>
> Like: "en.wikipedia.org/wiki/production_code" is Tokenized in
> "en.wikipedia.org"
> "wiki"
> "production"
> "code"
> with Standardanalyzer.
>
> And a search will match iff(and only if) all the Tokens match?
> Like "en.wikipedia.org/wiki/production_code" matches
> "en.wikipedia.org" does not match.
>
>
> The Purpose of this is following:
> I have a Blacklist of URLs.
> If i want to access a URL the Domain is searched in Lucene. (fast)
> If there is a match, following will be searched (a bit slowlier)
> "en.wikipedia.org/wiki" -> does not match
> "en.wikipedia.org/wiki/production" -> does not match
> * "en.wikipedia.org/wiki/production_code" -> Matches, so the URL and all
> subURLs are blocked.
>
> So my Question is, is there a possibility to specify an Query to serch on=
ly
> for exact Document-Matches.
>
>
> Thanks very much,
> Florian Klingler
>
> ----- Urspr=FCngliche Mail -----
> Von: "Anshum" <anshumg@gmail.com>
> An: java-user@lucene.apache.org
> Gesendet: Sonntag, 20. September 2009 06:58:24
> Betreff: Re: Lucene search in URL
>
> Hi Florian,
> Perhaps you might run into issues with using an ngram. How I see it is th=
at
> you need tokenized urls and need to run an exact search using a keyword
> tokenizer on the search string.
> You could try this. I am assuming it'll work.
> so something like
> en.wikipedia.org/wiki/production_code/test
> gets tokenized as
> [en] [wikipedia] [org] [wiki[ [production_code] [test]
>
> so an exact search for any set of subsequent (while maintaining the order=
)
> would get you the result. And yes, you might want to look at your
> tokenizers
> a little bit.
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>
>
> On Sun, Sep 20, 2009 at 3:30 AM, AHMET ARSLAN <iorixxx@yahoo.com> wrote:
>
> > > Dear List,
> > >
> > > I'm working on a project where i have to check a Blacklist
> > > of URL's with Lucene. (about 500.000)
> > > Is it possible to search for a URL in a hierarchical
> > > context?
> > >
> > > for Example:
> > > Blacklist entry: "en.wikipedia.org/wiki/production_code"
> > >
> > > "en.wikipedia.org/wiki/production_code/test" should match
> > > "en.wikipedia.org/wiki/test" should not match
> >
> > If any substring (0 to n) of your query matches a document completely
> than
> > that query should match, right? Thats what I understand from your
> examples.
> >
> > You can achieve this bu using two different analyzers for index and que=
ry
> > time.
> >
> > query analyzer:
> >
> > KeywordTokenizer
> > EdgeNGramTokenFilter (side =3D EdgeNGramTokenFilter.Side.FRONT , mingra=
m =3D
> 1,
> > maxgram=3D512)
> >
> > index analyzer:
> >
> > KeywordTokenizer
> >
> > The index analyzer comes out-of-the-box:
> > org.apache.lucene.analysis.KeywordAnalyzer
> > But you need to write query analyzer.
> >
> > If you want case-insensitive search you can add LowercaseFilter to both
> of
> > your analyzers.
> >
> > By using this, your black list urls will be indexed verbatim. (one toke=
n)
> >
> > Your query "en.wikipedia.org/wiki/production_code/test"
> > will be broken in to these pieces and one of them will match your
> document:
> >
> > e
> > en
> > en.
> > en.w
> > en.wi
> > en.wik
> > en.wiki
> > en.wikip
> > en.wikipe
> > en.wikiped
> > en.wikipedi
> > en.wikipedia
> > en.wikipedia.
> > en.wikipedia.o
> > en.wikipedia.or
> > en.wikipedia.org
> > en.wikipedia.org/
> > en.wikipedia.org/w
> > en.wikipedia.org/wi
> > en.wikipedia.org/wik
> > en.wikipedia.org/wiki
> > en.wikipedia.org/wiki/
> > en.wikipedia.org/wiki/p
> > en.wikipedia.org/wiki/pr
> > en.wikipedia.org/wiki/pro
> > en.wikipedia.org/wiki/prod
> > en.wikipedia.org/wiki/produ
> > en.wikipedia.org/wiki/produc
> > en.wikipedia.org/wiki/product
> > en.wikipedia.org/wiki/producti
> > en.wikipedia.org/wiki/productio
> > en.wikipedia.org/wiki/production
> > en.wikipedia.org/wiki/production_
> > en.wikipedia.org/wiki/production_c
> > en.wikipedia.org/wiki/production_co
> > en.wikipedia.org/wiki/production_cod
> > * en.wikipedia.org/wiki/production_code  // this is your document a
> match
> > en.wikipedia.org/wiki/production_code/
> > en.wikipedia.org/wiki/production_code/t
> > en.wikipedia.org/wiki/production_code/te
> > en.wikipedia.org/wiki/production_code/tes
> > en.wikipedia.org/wiki/production_code/test
> >
> > The none of the pieces of the query "en.wikipedia.org/wiki/test" will
> > match your document.
> >
> > Hope this helps.
> >
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64e4bdcff5aa10473ffbc85--

From java-user-return-42433-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 20 22:15:07 2009
Return-Path: <java-user-return-42433-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56855 invoked from network); 20 Sep 2009 22:15:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Sep 2009 22:15:06 -0000
Received: (qmail 50477 invoked by uid 500); 20 Sep 2009 22:15:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50381 invoked by uid 500); 20 Sep 2009 22:15:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50371 invoked by uid 99); 20 Sep 2009 22:15:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 22:15:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of office@florian-klingler.at designates 82.192.1.228 as permitted sender)
Received: from [82.192.1.228] (HELO mail.florian-klingler.at) (82.192.1.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 22:14:53 +0000
Received: from zcs.florian-klingler.at (zcs.florian-klingler.at [172.16.1.100])
	by mail.florian-klingler.at (Postfix) with ESMTP id 8AA095AE194
	for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 00:14:27 +0200 (CEST)
Received: from localhost (localhost.localdomain [127.0.0.1])
	by zcs.florian-klingler.at (Postfix) with ESMTP id 60FB01034482
	for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 00:14:27 +0200 (CEST)
X-Virus-Scanned: amavisd-new at zcs.florian-klingler.at
Received: from zcs.florian-klingler.at ([127.0.0.1])
	by localhost (zcs.florian-klingler.at [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id uz8PigRy4bdX for <java-user@lucene.apache.org>;
	Mon, 21 Sep 2009 00:14:25 +0200 (CEST)
Received: from zcs.florian-klingler.at (zcs.florian-klingler.at [172.16.1.100])
	by zcs.florian-klingler.at (Postfix) with ESMTP id B66C81034491
	for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 00:14:25 +0200 (CEST)
Date: Mon, 21 Sep 2009 00:14:25 +0200 (CEST)
From: Florian Klingler <office@florian-klingler.at>
To: java-user@lucene.apache.org
Message-ID: <14382951.3941253484865200.JavaMail.root@zcs.florian-klingler.at>
In-Reply-To: <17032685.3921253484632700.JavaMail.root@zcs.florian-klingler.at>
Subject: Re: Lucene search in URL
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Originating-IP: [192.168.1.106]
X-Mailer: Zimbra 6.0.0_GA_1802.UBUNTU8 (ZimbraWebClient - FF3.0 (Linux)/6.0.0_GA_1802.UBUNTU8)
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for all the Help.

I've now implemented a modified Version of Ahmet Arslan's Idea and it works=
.

i've splitted up the url in 2 parts: domain and path (with URL.getHost() an=
d URL.getPath()).
Add these two Fields to Lucene with Keywordanalyzer().

To Search for a URL i check, if the domain matches.
if yes, i split the path with path.split(/);
then i costruct a path, for example:

Blacklist-Entry: en.wikipedia.org/wiki/production_code

URL to test =3D en.wikipedia.org/wiki/production_code/test
search =3D * "domain: en.wikipedia.org" matches, so we search with path
search =3D "domain: en.wikipedia.org path: /wiki"
search =3D * "domain: en.wikipedia.org path: /wiki/production_code" matches
search =3D "domain: en.wikipedia.org path: /wiki/production_code/test"

if i reach a match, i can stop the iteration and return a true.

if all iterations pass and there isn't a match, then i return a false.

The Performance shoudn't be too bad, because it's a linear complexity.

I'll post the java methods if anyone is interested.

Thanks,
Florian Klingler

----- Urspr=C3=BCngliche Mail -----
Von: "Anshum" <anshumg@gmail.com>
An: java-user@lucene.apache.org
Gesendet: Sonntag, 20. September 2009 12:22:11
Betreff: Re: Lucene search in URL

HI Florian,
A token would get you a hit on being searched i.e. if you search for any of
the tokens from the document you'd get the document as a hit.
Also, exact searches work by considering positions.
if you search for "A B". All documents having A and B as adjacent terms (in
that order) would be picked up.
Hope that helps!

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Sun, Sep 20, 2009 at 1:40 PM, Florian Klingler <
office@florian-klingler.at> wrote:

> Thanks for all the Answers,
>
>
> I'll now try to implement this.
> But i have another question now:
>
> Is there a possibility in Lucene to do a Exact Search with
> Tokenized text?
>
> Like: "en.wikipedia.org/wiki/production_code" is Tokenized in
> "en.wikipedia.org"
> "wiki"
> "production"
> "code"
> with Standardanalyzer.
>
> And a search will match iff(and only if) all the Tokens match?
> Like "en.wikipedia.org/wiki/production_code" matches
> "en.wikipedia.org" does not match.
>
>
> The Purpose of this is following:
> I have a Blacklist of URLs.
> If i want to access a URL the Domain is searched in Lucene. (fast)
> If there is a match, following will be searched (a bit slowlier)
> "en.wikipedia.org/wiki" -> does not match
> "en.wikipedia.org/wiki/production" -> does not match
> * "en.wikipedia.org/wiki/production_code" -> Matches, so the URL and all
> subURLs are blocked.
>
> So my Question is, is there a possibility to specify an Query to serch on=
ly
> for exact Document-Matches.
>
>
> Thanks very much,
> Florian Klingler
>
> ----- Urspr=C3=BCngliche Mail -----
> Von: "Anshum" <anshumg@gmail.com>
> An: java-user@lucene.apache.org
> Gesendet: Sonntag, 20. September 2009 06:58:24
> Betreff: Re: Lucene search in URL
>
> Hi Florian,
> Perhaps you might run into issues with using an ngram. How I see it is th=
at
> you need tokenized urls and need to run an exact search using a keyword
> tokenizer on the search string.
> You could try this. I am assuming it'll work.
> so something like
> en.wikipedia.org/wiki/production_code/test
> gets tokenized as
> [en] [wikipedia] [org] [wiki[ [production_code] [test]
>
> so an exact search for any set of subsequent (while maintaining the order=
)
> would get you the result. And yes, you might want to look at your
> tokenizers
> a little bit.
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>
>
> On Sun, Sep 20, 2009 at 3:30 AM, AHMET ARSLAN <iorixxx@yahoo.com> wrote:
>
> > > Dear List,
> > >
> > > I'm working on a project where i have to check a Blacklist
> > > of URL's with Lucene. (about 500.000)
> > > Is it possible to search for a URL in a hierarchical
> > > context?
> > >
> > > for Example:
> > > Blacklist entry: "en.wikipedia.org/wiki/production_code"
> > >
> > > "en.wikipedia.org/wiki/production_code/test" should match
> > > "en.wikipedia.org/wiki/test" should not match
> >
> > If any substring (0 to n) of your query matches a document completely
> than
> > that query should match, right? Thats what I understand from your
> examples.
> >
> > You can achieve this bu using two different analyzers for index and que=
ry
> > time.
> >
> > query analyzer:
> >
> > KeywordTokenizer
> > EdgeNGramTokenFilter (side =3D EdgeNGramTokenFilter.Side.FRONT , mingra=
m =3D
> 1,
> > maxgram=3D512)
> >
> > index analyzer:
> >
> > KeywordTokenizer
> >
> > The index analyzer comes out-of-the-box:
> > org.apache.lucene.analysis.KeywordAnalyzer
> > But you need to write query analyzer.
> >
> > If you want case-insensitive search you can add LowercaseFilter to both
> of
> > your analyzers.
> >
> > By using this, your black list urls will be indexed verbatim. (one toke=
n)
> >
> > Your query "en.wikipedia.org/wiki/production_code/test"
> > will be broken in to these pieces and one of them will match your
> document:
> >
> > e
> > en
> > en.
> > en.w
> > en.wi
> > en.wik
> > en.wiki
> > en.wikip
> > en.wikipe
> > en.wikiped
> > en.wikipedi
> > en.wikipedia
> > en.wikipedia.
> > en.wikipedia.o
> > en.wikipedia.or
> > en.wikipedia.org
> > en.wikipedia.org/
> > en.wikipedia.org/w
> > en.wikipedia.org/wi
> > en.wikipedia.org/wik
> > en.wikipedia.org/wiki
> > en.wikipedia.org/wiki/
> > en.wikipedia.org/wiki/p
> > en.wikipedia.org/wiki/pr
> > en.wikipedia.org/wiki/pro
> > en.wikipedia.org/wiki/prod
> > en.wikipedia.org/wiki/produ
> > en.wikipedia.org/wiki/produc
> > en.wikipedia.org/wiki/product
> > en.wikipedia.org/wiki/producti
> > en.wikipedia.org/wiki/productio
> > en.wikipedia.org/wiki/production
> > en.wikipedia.org/wiki/production_
> > en.wikipedia.org/wiki/production_c
> > en.wikipedia.org/wiki/production_co
> > en.wikipedia.org/wiki/production_cod
> > * en.wikipedia.org/wiki/production_code  // this is your document a
> match
> > en.wikipedia.org/wiki/production_code/
> > en.wikipedia.org/wiki/production_code/t
> > en.wikipedia.org/wiki/production_code/te
> > en.wikipedia.org/wiki/production_code/tes
> > en.wikipedia.org/wiki/production_code/test
> >
> > The none of the pieces of the query "en.wikipedia.org/wiki/test" will
> > match your document.
> >
> > Hope this helps.
> >
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42434-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 20 22:20:45 2009
Return-Path: <java-user-return-42434-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57831 invoked from network); 20 Sep 2009 22:20:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Sep 2009 22:20:45 -0000
Received: (qmail 53066 invoked by uid 500); 20 Sep 2009 22:20:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52978 invoked by uid 500); 20 Sep 2009 22:20:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52967 invoked by uid 99); 20 Sep 2009 22:20:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 22:20:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of office@florian-klingler.at designates 82.192.1.228 as permitted sender)
Received: from [82.192.1.228] (HELO mail.florian-klingler.at) (82.192.1.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 22:20:33 +0000
Received: from zcs.florian-klingler.at (zcs.florian-klingler.at [172.16.1.100])
	by mail.florian-klingler.at (Postfix) with ESMTP id 826E35AE194
	for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 00:20:11 +0200 (CEST)
Received: from localhost (localhost.localdomain [127.0.0.1])
	by zcs.florian-klingler.at (Postfix) with ESMTP id 78223103441D
	for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 00:20:11 +0200 (CEST)
X-Virus-Scanned: amavisd-new at zcs.florian-klingler.at
Received: from zcs.florian-klingler.at ([127.0.0.1])
	by localhost (zcs.florian-klingler.at [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id qpPhiQmNtW06 for <java-user@lucene.apache.org>;
	Mon, 21 Sep 2009 00:20:10 +0200 (CEST)
Received: from zcs.florian-klingler.at (zcs.florian-klingler.at [172.16.1.100])
	by zcs.florian-klingler.at (Postfix) with ESMTP id 64EEB1034495
	for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 00:20:10 +0200 (CEST)
Date: Mon, 21 Sep 2009 00:20:10 +0200 (CEST)
From: Florian Klingler <office@florian-klingler.at>
To: java-user@lucene.apache.org
Message-ID: <15224515.3991253485210250.JavaMail.root@zcs.florian-klingler.at>
In-Reply-To: <22153854.3971253484975888.JavaMail.root@zcs.florian-klingler.at>
Subject: Re: Lucene search in URL
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Originating-IP: [192.168.1.106]
X-Mailer: Zimbra 6.0.0_GA_1802.UBUNTU8 (ZimbraWebClient - FF3.0 (Linux)/6.0.0_GA_1802.UBUNTU8)
X-Virus-Checked: Checked by ClamAV on apache.org

Here are the Java Methods:

public void addDomain(ListType listtype, String domain) throws CorruptIndex=
Exception, IOException {
=09=09this.add(listtype, URIType.Domain, domain, null);
=09}
=09
=09public void addURL(ListType listtype, String url) throws CorruptIndexExc=
eption, IOException {
=09=09URL parsed_url =3D new URL(url);
=09=09this.add(listtype, URIType.URL, parsed_url.getHost(), parsed_url.getP=
ath());
=09}
=09
=09public boolean matchBlacklistDomain(String domain) throws ParseException=
, IOException {
=09=09return this.search(ListType.Blacklist, URIType.Domain, domain, null);=
=09
=09}
=09
=09public boolean matchBlacklistURL(String domain, String path) throws Pars=
eException, IOException {=09
=09=09if(this.search(ListType.Blacklist, URIType.URL, domain, null)) {
=09=09=09String[] dirs =3D path.split("/");
=09=09=09String search_path =3D "";
=09=09=09for(String dir: dirs) {
=09=09=09=09if(dir.length()=3D=3D0) {
=09=09=09=09=09continue;
=09=09=09=09}
=09=09=09=09search_path =3D search_path+"/"+dir;
=09=09=09=09if(this.search(ListType.Blacklist, URIType.URL, domain, search_=
path)) {
=09=09=09=09=09return true;
=09=09=09=09}
=09=09=09}
=09=09}
=09=09return false;
=09}
=09
=09
=09private void add(ListType listtype, URIType uritype, String domain, Stri=
ng path) throws CorruptIndexException, IOException {
=09=09
=09=09this.listtype.setValue(listtype.toString());
=09=09this.uritype.setValue(uritype.toString());
=09=09this.domain.setValue(domain);
=09=09this.path.setValue(path);
=09=09
=09=09this.writer.addDocument(this.document);
=09}
=09

=09private boolean search(ListType listtype, URIType uritype, String domain=
, String path) throws ParseException, IOException {
=09=09
=09=09//System.err.println("Searching Domain: "+domain);
=09=09//System.err.println("Searching PATH: "+path);
=09=09
=09=09BooleanFilter bool =3D new BooleanFilter();
=09=09
=09=09TermsFilter term1 =3D new TermsFilter();
=09=09term1.addTerm(new Term("listtype", listtype.toString()));
=09=09TermsFilter term2 =3D new TermsFilter();
=09=09term2.addTerm(new Term("uritype", uritype.toString()));
=09=09bool.add(new FilterClause(term1, BooleanClause.Occur.MUST));
=09=09bool.add(new FilterClause(term2, BooleanClause.Occur.MUST));

=09=09BooleanQuery booleanQuery =3D new BooleanQuery();
=09=09
=09=09QueryParser queryParserDomain =3D new QueryParser("domain", this.anal=
yzer);
=09=09Query queryDomain =3D queryParserDomain.parse(domain);
=09=09booleanQuery.add(queryDomain, BooleanClause.Occur.MUST);
=09=09
=09=09if(path!=3Dnull) {
=09=09=09QueryParser queryParserPath =3D new QueryParser("path", this.analy=
zer);
=09=09=09Query queryPath =3D queryParserPath.parse(path);
=09=09=09booleanQuery.add(queryPath, BooleanClause.Occur.MUST);
=09=09}
=09=09
=09=09TopDocs hits =3D searcher.search(booleanQuery, bool, 1);
=09=09return hits.totalHits>0;
=09}


Florian Klingler

----- Urspr=C3=BCngliche Mail -----
Von: "Florian Klingler" <office@florian-klingler.at>
An: java-user@lucene.apache.org
Gesendet: Montag, 21. September 2009 00:14:25
Betreff: Re: Lucene search in URL

Thanks for all the Help.

I've now implemented a modified Version of Ahmet Arslan's Idea and it works=
.

i've splitted up the url in 2 parts: domain and path (with URL.getHost() an=
d URL.getPath()).
Add these two Fields to Lucene with Keywordanalyzer().
Hope that helps!
To Search for a URL i check, if the domain matches.
if yes, i split the path with path.split(/);
then i costruct a path, for example:

Blacklist-Entry: en.wikipedia.org/wiki/production_code

URL to test =3D en.wikipedia.org/wiki/production_code/test
search =3D * "domain: en.wikipedia.org" matches, so we search with path
search =3D "domain: en.wikipedia.org path: /wiki"
search =3D * "domain: en.wikipedia.org path: /wiki/production_code" matches
search =3D "domain: en.wikipedia.org path: /wiki/production_code/test"

if i reach a match, i can stop the iteration and return a true.

if all iterations pass and there isn't a match, then i return a false.

The Performance shoudn't be too bad, because it's a linear complexity.

I'll post the java methods if anyone is interested.

Thanks,
Florian Klingler

----- Urspr=C3=BCngliche Mail -----
Von: "Anshum" <anshumg@gmail.com>
An: java-user@lucene.apache.org
Gesendet: Sonntag, 20. September 2009 12:22:11
Betreff: Re: Lucene search in URL

HI Florian,
A token would get you a hit on being searched i.e. if you search for any of
the tokens from the document you'd get the document as a hit.
Also, exact searches work by considering positions.
if you search for "A B". All documents having A and B as adjacent terms (in
that order) would be picked up.
Hope that helps!

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Sun, Sep 20, 2009 at 1:40 PM, Florian Klingler <
office@florian-klingler.at> wrote:

> Thanks for all the Answers,
>
>
> I'll now try to implement this.
> But i have another question now:
>
> Is there a possibility in Lucene to do a Exact Search with
> Tokenized text?
>
> Like: "en.wikipedia.org/wiki/production_code" is Tokenized in
> "en.wikipedia.org"
> "wiki"
> "production"
> "code"
> with Standardanalyzer.
>
> And a search will match iff(and only if) all the Tokens match?
> Like "en.wikipedia.org/wiki/production_code" matches
> "en.wikipedia.org" does not match.
>
>
> The Purpose of this is following:
> I have a Blacklist of URLs.
> If i want to access a URL the Domain is searched in Lucene. (fast)
> If there is a match, following will be searched (a bit slowlier)
> "en.wikipedia.org/wiki" -> does not match
> "en.wikipedia.org/wiki/production" -> does not match
> * "en.wikipedia.org/wiki/production_code" -> Matches, so the URL and all
> subURLs are blocked.
>
> So my Question is, is there a possibility to specify an Query to serch on=
ly
> for exact Document-Matches.
>
>
> Thanks very much,
> Florian Klingler
>
> ----- Urspr=C3=BCngliche Mail -----
> Von: "Anshum" <anshumg@gmail.com>
> An: java-user@lucene.apache.org
> Gesendet: Sonntag, 20. September 2009 06:58:24
> Betreff: Re: Lucene search in URL
>
> Hi Florian,
> Perhaps you might run into issues with using an ngram. How I see it is th=
at
> you need tokenized urls and need to run an exact search using a keyword
> tokenizer on the search string.
> You could try this. I am assuming it'll work.
> so something like
> en.wikipedia.org/wiki/production_code/test
> gets tokenized as
> [en] [wikipedia] [org] [wiki[ [production_code] [test]
>
> so an exact search for any set of subsequent (while maintaining the order=
)
> would get you the result. And yes, you might want to look at your
> tokenizers
> a little bit.
>
> --
> Anshum Gupta
> Naukri Labs!
> http://ai-cafe.blogspot.com
>
> The facts expressed here belong to everybody, the opinions to me. The
> distinction is yours to draw............
>
>
> On Sun, Sep 20, 2009 at 3:30 AM, AHMET ARSLAN <iorixxx@yahoo.com> wrote:
>
> > > Dear List,
> > >
> > > I'm working on a project where i have to check a Blacklist
> > > of URL's with Lucene. (about 500.000)
> > > Is it possible to search for a URL in a hierarchical
> > > context?
> > >
> > > for Example:
> > > Blacklist entry: "en.wikipedia.org/wiki/production_code"
> > >
> > > "en.wikipedia.org/wiki/production_code/test" should match
> > > "en.wikipedia.org/wiki/test" should not match
> >
> > If any substring (0 to n) of your query matches a document completely
> than
> > that query should match, right? Thats what I understand from your
> examples.
> >
> > You can achieve this bu using two different analyzers for index and que=
ry
> > time.
> >
> > query analyzer:
> >
> > KeywordTokenizer
> > EdgeNGramTokenFilter (side =3D EdgeNGramTokenFilter.Side.FRONT , mingra=
m =3D
> 1,
> > maxgram=3D512)
> >
> > index analyzer:
> >
> > KeywordTokenizer
> >
> > The index analyzer comes out-of-the-box:
> > org.apache.lucene.analysis.KeywordAnalyzer
> > But you need to write query analyzer.
> >
> > If you want case-insensitive search you can add LowercaseFilter to both
> of
> > your analyzers.
> >
> > By using this, your black list urls will be indexed verbatim. (one toke=
n)
> >
> > Your query "en.wikipedia.org/wiki/production_code/test"
> > will be broken in to these pieces and one of them will match your
> document:
> >
> > e
> > en
> > en.
> > en.w
> > en.wi
> > en.wik
> > en.wiki
> > en.wikip
> > en.wikipe
> > en.wikiped
> > en.wikipedi
> > en.wikipedia
> > en.wikipedia.
> > en.wikipedia.o
> > en.wikipedia.or
> > en.wikipedia.org
> > en.wikipedia.org/
> > en.wikipedia.org/w
> > en.wikipedia.org/wi
> > en.wikipedia.org/wik
> > en.wikipedia.org/wiki
> > en.wikipedia.org/wiki/
> > en.wikipedia.org/wiki/p
> > en.wikipedia.org/wiki/pr
> > en.wikipedia.org/wiki/pro
> > en.wikipedia.org/wiki/prod
> > en.wikipedia.org/wiki/produ
> > en.wikipedia.org/wiki/produc
> > en.wikipedia.org/wiki/product
> > en.wikipedia.org/wiki/producti
> > en.wikipedia.org/wiki/productio
> > en.wikipedia.org/wiki/production
> > en.wikipedia.org/wiki/production_
> > en.wikipedia.org/wiki/production_c
> > en.wikipedia.org/wiki/production_co
> > en.wikipedia.org/wiki/production_cod
> > * en.wikipedia.org/wiki/production_code  // this is your document a
> match
> > en.wikipedia.org/wiki/production_code/
> > en.wikipedia.org/wiki/production_code/t
> > en.wikipedia.org/wiki/production_code/te
> > en.wikipedia.org/wiki/production_code/tes
> > en.wikipedia.org/wiki/production_code/test
> >
> > The none of the pieces of the query "en.wikipedia.org/wiki/test" will
> > match your document.
> >
> > Hope this helps.
> >
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42435-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 20 23:13:07 2009
Return-Path: <java-user-return-42435-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64335 invoked from network); 20 Sep 2009 23:13:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Sep 2009 23:13:07 -0000
Received: (qmail 80436 invoked by uid 500); 20 Sep 2009 23:13:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80341 invoked by uid 500); 20 Sep 2009 23:13:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80331 invoked by uid 99); 20 Sep 2009 23:13:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Sep 2009 23:13:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.21] (HELO web52911.mail.re2.yahoo.com) (206.190.49.21)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 20 Sep 2009 23:12:52 +0000
Received: (qmail 42098 invoked by uid 60001); 20 Sep 2009 23:12:29 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253488349; bh=99CeFUeRG0z3PONC8FKCQabtk7Bg4Kw+rPYjIYsiM4Y=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=X5PywlMPR7XlKmhwuZLbO7TxILRzhJZfgsSWBDa+UdhoyaUyG5FvuOvEQ5kQ6QKwPmkvlK4tQeZU8TziaVkXXSeG8KL3OQRQ7MIx0dQGENOOmqvsp5TEtPVZ4bsafo7dxflxDWB3FlpmeG4stnOtvJ0ocBzY0blbMXKxcj6z8bY=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=I2cW+YAnJiB7Y0ZydLOyXd8SK+0cCX2MceZIhiq24wq6Xeojr3cp8l7L1UaoKdg3BH5th9kXSOTD9CP+hwGyAi42VYm/6+AMXBh2VfsyHcvH+Qfc9XiE01H7F+NjgUk4QT5RYBoE+tuyD77nEDhVJKZ8W8lbawCZoRSdohsvhlw=;
Message-ID: <780089.40817.qm@web52911.mail.re2.yahoo.com>
X-YMail-OSG: MPs7bvgVM1mVjWQ0aj6_bofD076PP7TLELLTFmbTG4.qodshEUSlq_knHFTWozfvsknkjH7_aKdacSaW9KE43CSFHhLUdgYRwCLXNXonMkkUE1VWbVolC0.48aNIg3re6ZsOnJRu9lMY2ZOmGwOs5EMevzxgvg9MTWQZ4ajgG7iXkKHu6zqrKLwMXzHRbqQm6d8AOOaTs2Ju3YyfB9_YPVzQWVnCu78z0uFfoIuk7wlJUEn9gUFOAfpdJtkCyTVhtG3oswjJHtoOf7QnMeJFDZJboDVRIwlwrYsgRibif0xX9VNDzbUKSxeK2AHI8gZHyEprR0CsMGgxW3MbUQVu1Tk_bJrLDaq_tMlTWBc-
Received: from [78.165.19.67] by web52911.mail.re2.yahoo.com via HTTP; Sun, 20 Sep 2009 16:12:29 PDT
X-Mailer: YahooMailClassic/7.0.14 YahooMailWebService/0.7.347.2
Date: Sun, 20 Sep 2009 16:12:29 -0700 (PDT)
From: AHMET ARSLAN <iorixxx@yahoo.com>
Subject: Re: Lucene search in URL
To: java-user@lucene.apache.org
In-Reply-To: <14382951.3941253484865200.JavaMail.root@zcs.florian-klingler.at>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> Thanks for all the Help.
> 
> I've now implemented a modified Version of Ahmet Arslan's
> Idea and it works.

Great to hear that! 

Doing query iteration programatically will be faster than making it with ShingleFilter.

Since you don't care about scores, you can enhance your search time complexity. You need only Boolean Retrieval (true or false) so can omit term freq. and length norm. and index time boosting etc in your fields.

Field.setOmitNorms(true)
Field.setOmitTermFreqAndPositions(true) 
Using Field.Index.ANALYZED_NO_NORMS in constructor.

Secondly there is a discussion about disabling score calculation completely. It is stated that:

"As of 2.9 (not yet released) the new Collector API allows you to skip
scoring entirely and just collect the doc IDs matching the query." [1].

If you made these modifications, your search will be even faster and storage space - required in the index - will decrease.

[1] http://osdir.com/ml/java-user.lucene.apache.org/2009-07/msg00073.html


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42436-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 21 04:48:03 2009
Return-Path: <java-user-return-42436-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28571 invoked from network); 21 Sep 2009 04:48:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Sep 2009 04:48:03 -0000
Received: (qmail 38482 invoked by uid 500); 21 Sep 2009 04:48:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38376 invoked by uid 500); 21 Sep 2009 04:48:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38366 invoked by uid 99); 21 Sep 2009 04:48:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Sep 2009 04:48:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of KishoreV@coreobjects.com designates 67.89.120.9 as permitted sender)
Received: from [67.89.120.9] (HELO colaex01.coreobjects.com) (67.89.120.9)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Sep 2009 04:47:52 +0000
Received: from copuex01.coreobjects.com (192.168.11.18) by
 colaex01.coreobjects.com (192.168.1.16) with Microsoft SMTP Server (TLS) id
 8.1.393.1; Sun, 20 Sep 2009 21:47:31 -0700
Received: from copuex01.coreobjects.com ([192.168.11.18]) by
 copuex01.coreobjects.com ([192.168.11.18]) with mapi; Mon, 21 Sep 2009
 10:17:28 +0530
From: "Kishore AVK. Veleti" <KishoreV@coreobjects.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 21 Sep 2009 10:17:27 +0530
Subject: Accepted: Free Webinar - Apache Lucene 2.9: Technical Overview of
 New Features
Thread-Topic: Free Webinar - Apache Lucene 2.9: Technical Overview of New
 Features
Thread-Index: AQHKOKxCaDYPhWiQaUOAMJekPd76X5DgewIQgAAA4lA=
Message-ID: <0A7DFB2ABE8FE648A3EACCC61093457EBF0E160BC5@copuex01.coreobjects.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_002_0A7DFB2ABE8FE648A3EACCC61093457EBF0E160BC5copuex01coreo_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_002_0A7DFB2ABE8FE648A3EACCC61093457EBF0E160BC5copuex01coreo_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64


--_002_0A7DFB2ABE8FE648A3EACCC61093457EBF0E160BC5copuex01coreo_
Content-Type: text/calendar; charset="utf-8"; method=REPLY
Content-Transfer-Encoding: base64

QkVHSU46VkNBTEVOREFSDQpNRVRIT0Q6UkVQTFkNClBST0RJRDpNaWNyb3NvZnQgRXhjaGFuZ2Ug
U2VydmVyIDIwMDcNClZFUlNJT046Mi4wDQpCRUdJTjpWVElNRVpPTkUNClRaSUQ6SW5kaWEgU3Rh
bmRhcmQgVGltZQ0KQkVHSU46U1RBTkRBUkQNCkRUU1RBUlQ6MTYwMTAxMDFUMDAwMDAwDQpUWk9G
RlNFVEZST006KzA1MzANClRaT0ZGU0VUVE86KzA1MzANCkVORDpTVEFOREFSRA0KQkVHSU46REFZ
TElHSFQNCkRUU1RBUlQ6MTYwMTAxMDFUMDAwMDAwDQpUWk9GRlNFVEZST006KzA1MzANClRaT0ZG
U0VUVE86KzA1MzANCkVORDpEQVlMSUdIVA0KRU5EOlZUSU1FWk9ORQ0KQkVHSU46VkVWRU5UDQpB
VFRFTkRFRTtQQVJUU1RBVD1BQ0NFUFRFRDtDTj1LaXNob3JlIEFWSy4gVmVsZXRpOk1BSUxUTzpL
aXNob3JlVkBjb3Jlb2JqZWMNCiB0cy5jb20NCkNPTU1FTlQ6DQpTVU1NQVJZOkFjY2VwdGVkOiBG
cmVlIFdlYmluYXIgLSBBcGFjaGUgTHVjZW5lIDIuOTogVGVjaG5pY2FsIE92ZXJ2aWV3IG9mIE4N
CiBldyBGZWF0dXJlcw0KRFRTVEFSVDtUWklEPUluZGlhIFN0YW5kYXJkIFRpbWU6MjAwOTA5MjRU
MjMzMDAwDQpEVEVORDtUWklEPUluZGlhIFN0YW5kYXJkIFRpbWU6MjAwOTA5MjVUMDAzMDAwDQpV
SUQ6RTMxNDNFQzRGOTVFMkM2NTg1MjU3NjM1MDA3OTI5N0QtTG90dXNfTm90ZXNfR2VuZXJhdGVk
DQpDTEFTUzpQVUJMSUMNClBSSU9SSVRZOjUNCkRUU1RBTVA6MjAwOTA5MjFUMDQ0NzI3Wg0KVFJB
TlNQOk9QQVFVRQ0KU1RBVFVTOkNPTkZJUk1FRA0KU0VRVUVOQ0U6MA0KTE9DQVRJT046DQpYLU1J
Q1JPU09GVC1DRE8tQVBQVC1TRVFVRU5DRTowDQpYLU1JQ1JPU09GVC1DRE8tT1dORVJBUFBUSUQ6
LTENClgtTUlDUk9TT0ZULUNETy1CVVNZU1RBVFVTOkJVU1kNClgtTUlDUk9TT0ZULUNETy1JTlRF
TkRFRFNUQVRVUzpCVVNZDQpYLU1JQ1JPU09GVC1DRE8tQUxMREFZRVZFTlQ6RkFMU0UNClgtTUlD
Uk9TT0ZULUNETy1JTVBPUlRBTkNFOjENClgtTUlDUk9TT0ZULUNETy1JTlNUVFlQRTowDQpFTkQ6
VkVWRU5UDQpFTkQ6VkNBTEVOREFSDQo=

--_002_0A7DFB2ABE8FE648A3EACCC61093457EBF0E160BC5copuex01coreo_--

From java-user-return-42437-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 21 09:06:24 2009
Return-Path: <java-user-return-42437-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77443 invoked from network); 21 Sep 2009 09:06:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Sep 2009 09:06:24 -0000
Received: (qmail 9931 invoked by uid 500); 21 Sep 2009 09:06:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9863 invoked by uid 500); 21 Sep 2009 09:06:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9853 invoked by uid 99); 21 Sep 2009 09:06:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Sep 2009 09:06:21 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=MISSING_MIMEOLE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Chris.Bamford@scalix.com designates 82.111.253.243 as permitted sender)
Received: from [82.111.253.243] (HELO mail.uk.scalix.com) (82.111.253.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Sep 2009 09:06:12 +0000
Received: from mail.uk.scalix.com (localhost.localdomain [127.0.0.1])
	by mail.uk.scalix.com (8.13.8/8.13.8) with ESMTP id n8L95nRA021430
	for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 10:05:50 +0100
Received: from mail.uk.scalix.com (mail.uk.scalix.com [10.11.108.216])
    by mail.uk.scalix.com (Scalix SMTP Relay 11.5.0.13292)
    via ESMTP; Mon, 21 Sep 2009 10:05:49 +0100 (BST)
Date: Mon, 21 Sep 2009 10:05:49 +0100
From: Chris Bamford <Chris.Bamford@scalix.com>
To: java-user@lucene.apache.org
Message-ID: <1086591381.2221253523949384.JavaMail.root@mail.uk.scalix.com>
In-Reply-To: <Pine.LNX.4.64.0909180953300.32068@radix.cryptio.net>
Subject: RE: New "Stream closed" exception with Java 6 - solved
X-MSMail-Priority: medium
x-scalix-Hops: 1
X-Mailer: Scalix 11.4.5.12178
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Disposition: inline
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on mail.uk.scalix.com
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=5.0 tests=AWL,BAYES_00,MISSING_MIMEOLE
	autolearn=ham version=3.2.5

Understood.  Thanks Hoss.

- Chris


----- Original Message -----
From: Chris Hostetter <hossman_lucene@fucit.org>
Sent: Fri, 18/9/2009 5:58pm
To: java-user@lucene.apache.org
Subject: RE: New "Stream closed" exception with Java 6 - solved


: > not really ... adding a document multiple times is a perfectly legal use 
: > case, adding a document with a "Reader" based field where the reader is 
: > already closed ... that's not legal (And Lucene doesn't really have any 
: > way of knowing if the Reader is closed because *it* closed it.

: Now I am confused, I must be missing something fundamental.  I take no 
: action that I am aware of which closes the Reader, so how is it 
: happening?  The attached code demonstrates the exception - please can 
: you advise on what is happening under the covers?  :-)

sorry for confusing you ... i should have said there are *some* use cases 
where adding the same document twice is legal -- but documents contain 
Fields that specify a reader are not one of those cases -- IndexWriter
consumes and closes the Reader to get the tokens for indexing, and the 
next time you re-add that same Document, the Reader is already closed.

My point was in response to your question about why IndexWRiter doesn't 
give you a different error about duplicate documents: it can't because 
there are *other* cases where indexing the same doc over and over is fine 
(docs that just contain simple strings).  All IndexWRiter kows when it 
sees a closed Reader is that it's closed, and it can't read from it -- it 
has no way of knowing *why* it's closed.  (trying to keep track of ever 
Reader IndexWriter ever closed would be an intractable problem)


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42438-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 21 14:32:38 2009
Return-Path: <java-user-return-42438-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84864 invoked from network); 21 Sep 2009 14:32:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Sep 2009 14:32:38 -0000
Received: (qmail 99653 invoked by uid 500); 21 Sep 2009 14:32:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99562 invoked by uid 500); 21 Sep 2009 14:32:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99552 invoked by uid 99); 21 Sep 2009 14:32:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Sep 2009 14:32:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mindas@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Sep 2009 14:32:25 +0000
Received: by bwz10 with SMTP id 10so2170943bwz.5
        for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 07:32:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=U+C5wHPJC9ueYakurlFOWaUNPDKHegyfJvsNdBMzWuM=;
        b=G6fRFnad0iG5zmKw//LusuQmB9P6UF0ITWi4hkSUxkudlxO1TbUFubjF+BRF3SZbSw
         pjk3Df3Bv9yRQbpKilZhU87KlPI2/PKvF6+VvMWdwNr7E6wWh5lBWQuxi+AmYSnOPZbv
         sK336dpETBbNxPS0kRJM9o5g0kNch1X0CP3Y8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=eucVfbXoCjkRqwLuouZEAx7k82fK+1G5MN3t1aQjrVpMp7mlwMzFYomimz6YWemLIk
         f5dIMD1bAjLcdoVPRo9FHpgD9L/WuMQfNWxZoV3V5WtvW3dP8VqLzPjcV3iJ+kZAkrcI
         o9wXr2uJHZ61tEuCCpezo4DTvKXETleFm2ojQ=
MIME-Version: 1.0
Received: by 10.239.141.142 with SMTP id c14mr386960hba.1.1253543525149; Mon, 
	21 Sep 2009 07:32:05 -0700 (PDT)
Date: Mon, 21 Sep 2009 15:32:05 +0100
Message-ID: <a4d7dcf50909210732y510b2d9am7a14a2875092b364@mail.gmail.com>
Subject: Memory consumed by IndexSearcher
From: =?ISO-8859-13?Q?Mindaugas_=DEak=F0auskas?= <mindas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I was wondering what would be sensible amount of memory IndexSearcher
can consume? In my application we do retain reference to it for
quicker searches; however I have become a bit worried for it being a
memory hog. We are using Lucene 2.4.0 on 8 CPU Linux SMP box; JVM is
Sun's 1.6.0_14 64-Bit Server VM.

I am asking because I have ended up with IndexSearcher having Retained
size [1] of 145M. All of this memory is being eaten by
IndexSearcher::reader::subReaders[]. The reader is MultiSegmentReader
and all subReaders are SegmentReader. My memory dump showed subReaders
array having size of 37 SegmentReaders, 2 to 5 M each. I can send
YouKit screenshot if anyone's interested.

All of that should be viewed in the light of index size on the disk,
which is only 22M.

I appreciate that all of this memory can be used for legitimate
purposes; however is there a way to know when does it go over sensible
limit? Can there be a "sensible" limit at all? Also, is it possible to
set the physical boundary the IndexSearcher would never go over?

Thanks in advance for all answers.

Regards,
Mindaugas

[1] http://www.yourkit.com/docs/80/help/sizes.jsp

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42439-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 21 22:18:25 2009
Return-Path: <java-user-return-42439-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33500 invoked from network); 21 Sep 2009 22:18:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Sep 2009 22:18:25 -0000
Received: (qmail 79715 invoked by uid 500); 21 Sep 2009 22:18:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79638 invoked by uid 500); 21 Sep 2009 22:18:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79628 invoked by uid 99); 21 Sep 2009 22:18:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Sep 2009 22:18:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of azlist1@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Sep 2009 22:18:13 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1206453fgg.5
        for <java-user@lucene.apache.org>; Mon, 21 Sep 2009 15:17:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=F2al+9oxIZNM1sOlKum78P4DDEvrPjAYPKvnKjbsjp4=;
        b=xQpe/Z7veUua2tHopGm4dH16r4QJqg284/f1ilNpXFdM+zDJSmY+hwXChNDMghsHnA
         95Kypybvt3iattNy0TwB/Th3EljFRAm89Jt0E19gy5m3RBUZKxWN85rcPxHo3smQyRD8
         5A5Niqs1o4wBWWfmPE1gstqCTWVjbSoycSoT4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=Gor8U1KC2OEn3Cockp9zdIxRp/NZA08tyF/Hy3NqxONSZ6vN0KSBYohUoM8dKxOJ4u
         PPJxo5jNLs8T/OjX22Tr+JcBMRfeW8Z/7X8JyNSu4RgHOArpz7YAELIab9+N2gaJKAq/
         I6ApvJJVVJu5YK8ysQwpi4hQMdcC+vr/V0q+k=
MIME-Version: 1.0
Received: by 10.86.17.29 with SMTP id 29mr199130fgq.38.1253571473574; Mon, 21 
	Sep 2009 15:17:53 -0700 (PDT)
Date: Tue, 22 Sep 2009 00:17:53 +0200
Message-ID: <76c1202b0909211517g77b3e53ck6ffcaa6a21018d2@mail.gmail.com>
Subject: Filtering query results based on relevance/acuracy
From: Alex <azlist1@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00c09ffb4c71620ba804741ddaf1
X-Virus-Checked: Checked by ClamAV on apache.org

--00c09ffb4c71620ba804741ddaf1
Content-Type: text/plain; charset=ISO-8859-1

Hi,

I'm, a total newbie with lucene and trying to understand how to achieve my
(complicated) goals. So what I'm doing is yet totally experimental for me
but is probably extremely trivial for the experts in this list :)

I use lucene and Hibernate Search to index locations by their name, type,
etc ...
The LocationType is an Object that has it's "name" field indexed both
tokenized and untokenized.

The following LocationType names are indexed
"Restaurant"
"Mexican Restaurant"
"Chinese Restaurant"
"Greek Restaurant"
etc...

Considering the following query  :

"Mexican Restaurant"

I systematically get all the entries as a result, most certainly because the
"Restaurant" keyword is present in all of them.
I'm trying to have a finer grained result set.
Obviously for "Mexican Restaurant" I want the "Mexican Restaurant" entry as
a result but NOT "Chinese Restaurant" nor "Greek Restaurant" as they are
irrelevant. But maybe "Restaurant" itself should be returned with a lower
wight/score or maybe it shouldn't ... im not sure about this one.

1)
How can I do that ?

Here is the code I use for querying :


String[] typeFields = {"name", "tokenized_name"};
        Map<String,Float> boostPerField = new HashMap<String,Float>(2);
        boostPerField.put( "name", (float) 4);
        boostPerField.put( "tokenized_name", (float) 2);


        QueryParser parser = new MultiFieldQueryParser(
                typeFields ,
                new StandardAnalyzer(),
                boostPerField
                );

        org.apache.lucene.search.Query luceneQuery;

        try {
            luceneQuery = parser.parse(queryString);
        }
        catch (ParseException e) {
            throw new RuntimeException("Unable to parse query: " +
queryString, e);
        }





I guess that there is a way to filter out results that have a score below a
given threshold or a way to filter out results based on score gap or
anything similar. But I have no idea on how to do this...


What is the best way to achieve what I want?

Thank you for your help !

Cheers,

Alex

--00c09ffb4c71620ba804741ddaf1--

From java-user-return-42440-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 22 04:56:41 2009
Return-Path: <java-user-return-42440-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11853 invoked from network); 22 Sep 2009 04:56:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Sep 2009 04:56:41 -0000
Received: (qmail 92555 invoked by uid 500); 22 Sep 2009 04:56:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92435 invoked by uid 500); 22 Sep 2009 04:56:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92315 invoked by uid 99); 22 Sep 2009 04:56:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Sep 2009 04:56:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 209.85.132.247 as permitted sender)
Received: from [209.85.132.247] (HELO an-out-0708.google.com) (209.85.132.247)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Sep 2009 04:56:32 +0000
Received: by an-out-0708.google.com with SMTP id b2so1521762ana.5
        for <multiple recipients>; Mon, 21 Sep 2009 21:56:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=h4ZKXSzogDt3/tNfFiOfJQJvTIvFcvaj3Xh0W68lUj8=;
        b=lInfQmFA3Vd3sfF6b66RTqseCFwJuEZMTHBPy6oX6VyvMgCwSVjOnLwzpM+TmoWPTk
         O7yATN73rTD52mj0t5taWUb4frK6wLsSkrfhpSzFxryPwPIbUjodQHzKDcy4yYfl4JaR
         73E0urEVMzRTFRHh2GGfsfaUG+WOgJTfLdCFY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=j9M7WBzhfjGGVkcNYEXxhX2Wkz1pyuexXQjllrJpuEescFBsaoFsBUDaotY4bpD3eF
         RuziVS/O5W+OU/gFnVVeZyk3wUS1TZ1TxnMxU5JPfqxwwUSUoN4ViFigd04rWk/ZN/gl
         7D3A2dVo8bAo0A2yYIKp0XTEhJJmjhF2OTIAo=
MIME-Version: 1.0
Received: by 10.101.196.13 with SMTP id y13mr506118anp.148.1253595371096; Mon, 
	21 Sep 2009 21:56:11 -0700 (PDT)
Date: Tue, 22 Sep 2009 12:56:11 +0800
Message-ID: <8837fb770909212156s13645f84tbee15ee3bd2d5aef@mail.gmail.com>
Subject: 2.9 NRT w.r.t. sorting and field cache
From: John Wang <john.wang@gmail.com>
To: java-dev@lucene.apache.org, java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e68ee0b5c94cc30474236aca
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e68ee0b5c94cc30474236aca
Content-Type: text/plain; charset=ISO-8859-1

Looking at the code, seems there is a disconnect between how/when field
cache is loaded when IndexWriter.getReader() is called.

Is FieldCache updated? Otherwise, are we reloading FieldCache for each
reader instance?

Seems for operations that lazy loads field cache, e.g. sorting, this has a
significant performance issue.

Please advise.

Thanks

-John

--0016e68ee0b5c94cc30474236aca--

From java-user-return-42441-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 22 12:17:24 2009
Return-Path: <java-user-return-42441-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25057 invoked from network); 22 Sep 2009 12:17:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Sep 2009 12:17:24 -0000
Received: (qmail 52001 invoked by uid 500); 22 Sep 2009 12:17:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51955 invoked by uid 500); 22 Sep 2009 12:17:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51945 invoked by uid 99); 22 Sep 2009 12:17:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Sep 2009 12:17:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.58] (HELO web50304.mail.re2.yahoo.com) (206.190.38.58)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 22 Sep 2009 12:17:10 +0000
Received: (qmail 56312 invoked by uid 60001); 22 Sep 2009 12:16:48 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1253621808; bh=b+zrny2Oyw4OwPYKomxS2AkeCdmDPo05UvVR/R3MAW0=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=lMuRDVoLFEGk57nni+7QlIvJY583/QEj7+8q1RwaBq+4s9LmzF5zq22G40H2tRt6eL+oOTTc1Jz82V15h6rXBDIwPz1zEQlHuaznUHvrPejWffWuKTtYn+5tzFcZcBxkmjM7squ8v40G7CLCerTYT3qAtazVE2+T7DqKo4tRKAc=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=UQfbwyO7uxSQa8Rrclqk1u8okV+iXfZorORszg6EL55esSZigHqP2fvpjC0mzz5C072J+41b8tJZtvQDYhiIjZv80lvdBPNKv6f4kncCU6rUApTayr5e20pNV8SYjTUtVPD01lrIvbW33zMuQ1TGxBObL0ewsubTGhVibgCjI0Y=;
Message-ID: <783159.56216.qm@web50304.mail.re2.yahoo.com>
X-YMail-OSG: FyQ3W1AVM1mRJKA4TYZHgLen0SJeQ7E831lGALRnPe9vxGjgTMyqxen_3gbFN7FtyS6r13dP_h7AISd4xZvZk8o04tKYjeguK3QDZnvNUj_.AWtRnzbO6PaGGmK2lUWjCyQUURo2eaRm3jT0b1JXKtAIRUJWvIsi5VQu8HVqWPcw8a0IR.DvA47QNoCn_1ZiHqj.sV2DFa8X3.JYJ_ojM7UM4spe8nsDTETX85AoiZSTpG77x46aMPQDar8tLfxS5QIZl9ihTJ5f3vkQCy6.hVv8JxKw07mtsD7Bn5SOBYZSHc1S_3sIsDIT69DzMgjVXHjJkyPEoACPTizdifocOTf5rvbat_UJQETsez5qZ2U-
Received: from [74.73.30.215] by web50304.mail.re2.yahoo.com via HTTP; Tue, 22 Sep 2009 05:16:48 PDT
X-Mailer: YahooMailRC/157.18 YahooMailWebService/0.7.347.2
References: <76c1202b0909211517g77b3e53ck6ffcaa6a21018d2@mail.gmail.com>
Date: Tue, 22 Sep 2009 05:16:48 -0700 (PDT)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Filtering query results based on relevance/acuracy
To: java-user@lucene.apache.org
In-Reply-To: <76c1202b0909211517g77b3e53ck6ffcaa6a21018d2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Alex,

If I understand you correctly, all you have to do is either make sure that query is run as a phrase query (with quotes around the it), or as a term query where both terms are required (with plus sign in front of each term, no space).


As for detecting score gap and such, you could do that with a custom Collector.

Otis --
Sematext is hiring -- http://sematext.com/about/jobs.html?mls
Lucene, Solr, Nutch, Katta, Hadoop, HBase, UIMA, NLP, NER, IR



----- Original Message ----
> From: Alex <azlist1@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Monday, September 21, 2009 6:17:53 PM
> Subject: Filtering query results based on relevance/acuracy
> 
> Hi,
> 
> I'm, a total newbie with lucene and trying to understand how to achieve my
> (complicated) goals. So what I'm doing is yet totally experimental for me
> but is probably extremely trivial for the experts in this list :)
> 
> I use lucene and Hibernate Search to index locations by their name, type,
> etc ...
> The LocationType is an Object that has it's "name" field indexed both
> tokenized and untokenized.
> 
> The following LocationType names are indexed
> "Restaurant"
> "Mexican Restaurant"
> "Chinese Restaurant"
> "Greek Restaurant"
> etc...
> 
> Considering the following query  :
> 
> "Mexican Restaurant"
> 
> I systematically get all the entries as a result, most certainly because the
> "Restaurant" keyword is present in all of them.
> I'm trying to have a finer grained result set.
> Obviously for "Mexican Restaurant" I want the "Mexican Restaurant" entry as
> a result but NOT "Chinese Restaurant" nor "Greek Restaurant" as they are
> irrelevant. But maybe "Restaurant" itself should be returned with a lower
> wight/score or maybe it shouldn't ... im not sure about this one.
> 
> 1)
> How can I do that ?
> 
> Here is the code I use for querying :
> 
> 
> String[] typeFields = {"name", "tokenized_name"};
>         MapboostPerField = new HashMap(2);
>         boostPerField.put( "name", (float) 4);
>         boostPerField.put( "tokenized_name", (float) 2);
> 
> 
>         QueryParser parser = new MultiFieldQueryParser(
>                 typeFields ,
>                 new StandardAnalyzer(),
>                 boostPerField
>                 );
> 
>         org.apache.lucene.search.Query luceneQuery;
> 
>         try {
>             luceneQuery = parser.parse(queryString);
>         }
>         catch (ParseException e) {
>             throw new RuntimeException("Unable to parse query: " +
> queryString, e);
>         }
> 
> 
> 
> 
> 
> I guess that there is a way to filter out results that have a score below a
> given threshold or a way to filter out results based on score gap or
> anything similar. But I have no idea on how to do this...
> 
> 
> What is the best way to achieve what I want?
> 
> Thank you for your help !
> 
> Cheers,
> 
> Alex


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42442-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 22 17:59:09 2009
Return-Path: <java-user-return-42442-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46560 invoked from network); 22 Sep 2009 17:59:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Sep 2009 17:59:08 -0000
Received: (qmail 49138 invoked by uid 500); 22 Sep 2009 17:59:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49055 invoked by uid 500); 22 Sep 2009 17:59:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49037 invoked by uid 99); 22 Sep 2009 17:59:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Sep 2009 17:59:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of karl.wettin@gmail.com designates 209.85.219.219 as permitted sender)
Received: from [209.85.219.219] (HELO mail-ew0-f219.google.com) (209.85.219.219)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Sep 2009 17:58:54 +0000
Received: by ewy19 with SMTP id 19so1335132ewy.28
        for <java-user@lucene.apache.org>; Tue, 22 Sep 2009 10:58:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=urz18dcBcK4s44q8J5qIqGCmYK82wJLUJ2KSBrDATys=;
        b=iqMdG+C9JsAzBEmnur61ML08EO56PXoV/jzntWX4jx1TGmr7utGk5JqvuTqcjRtSnI
         rZ/Y8Uziz1i60z11pLuwrJKl/G4iTKheI6nr3AIUW0gYd0MG6VUX5CD94F1yQGX5rn7q
         03AuNQLFJtSd5p3ZPxhdnu52/Acf36Su3wOUE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=oy0DJ7oPZJsgV8XTenEG27IVrC61kejfvY2tQUG34dQ4Luhz9zwrj77EnPeS+zURsZ
         SuM6vnke31CKehr5PYy5QA9gN98PpZ531L1T3PO6WDqHCLNEj63wsT/MhLL72tkXG3Lx
         c+aI5WA/YxPlh8vWnPdVv69NLMdL6cMovFqi4=
Received: by 10.211.132.36 with SMTP id j36mr1393014ebn.51.1253642314428;
        Tue, 22 Sep 2009 10:58:34 -0700 (PDT)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 24sm435874eyx.43.2009.09.22.10.58.32
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 22 Sep 2009 10:58:33 -0700 (PDT)
Message-Id: <1A565AA1-7C96-432C-B9AB-E7D20EFC65BB@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <a4d7dcf50909210732y510b2d9am7a14a2875092b364@mail.gmail.com>
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Memory consumed by IndexSearcher
Date: Tue, 22 Sep 2009 19:58:31 +0200
References: <a4d7dcf50909210732y510b2d9am7a14a2875092b364@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Mindaugas,

it is - as you sort of point out - the readers associated with your =20
searcher that consumes the memory, and not so much the searcher it =20
self. Thing that consume the most memory is probably field norms (8 =20
bits per field and document unless omitted) and flyweighted terms =20
(String#interal), things you can't really do that much about.

But it is hard to say for sure when you've said so little about what =20
your index really looks like. How many fields, do you use norms, how =20
many documents do you have, how many unique terms are there, etc?

Another thing that can consume a lot of memory is sorting. Not sure if =20=

that data is bound to the searcher or not though.



     karl

21 sep 2009 kl. 16.32 skrev Mindaugas =8Eak=9Aauskas:

> Hi,
>
> I was wondering what would be sensible amount of memory IndexSearcher
> can consume? In my application we do retain reference to it for
> quicker searches; however I have become a bit worried for it being a
> memory hog. We are using Lucene 2.4.0 on 8 CPU Linux SMP box; JVM is
> Sun's 1.6.0_14 64-Bit Server VM.
>
> I am asking because I have ended up with IndexSearcher having Retained
> size [1] of 145M. All of this memory is being eaten by
> IndexSearcher::reader::subReaders[]. The reader is MultiSegmentReader
> and all subReaders are SegmentReader. My memory dump showed subReaders
> array having size of 37 SegmentReaders, 2 to 5 M each. I can send
> YouKit screenshot if anyone's interested.
>
> All of that should be viewed in the light of index size on the disk,
> which is only 22M.
>
> I appreciate that all of this memory can be used for legitimate
> purposes; however is there a way to know when does it go over sensible
> limit? Can there be a "sensible" limit at all? Also, is it possible to
> set the physical boundary the IndexSearcher would never go over?
>
> Thanks in advance for all answers.
>
> Regards,
> Mindaugas
>
> [1] http://www.yourkit.com/docs/80/help/sizes.jsp
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42443-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 23 00:43:06 2009
Return-Path: <java-user-return-42443-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86887 invoked from network); 23 Sep 2009 00:43:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Sep 2009 00:43:06 -0000
Received: (qmail 71045 invoked by uid 500); 23 Sep 2009 00:43:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70964 invoked by uid 500); 23 Sep 2009 00:43:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70954 invoked by uid 99); 23 Sep 2009 00:43:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 23 Sep 2009 00:43:03 +0000
X-ASF-Spam-Status: No, hits=-19.0 required=10.0
	tests=ENV_AND_HDR_SPF_MATCH,RCVD_IN_DNSWL_MED,SPF_PASS,USER_IN_DEF_SPF_WL
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of alanho@amazon.com designates 72.21.198.25 as permitted sender)
Received: from [72.21.198.25] (HELO smtp-fw-4101.amazon.com) (72.21.198.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 23 Sep 2009 00:42:55 +0000
X-IronPort-AV: E=Sophos;i="4.44,434,1249257600"; 
   d="scan'208";a="247743754"
Received: from smtp-in-4103.sea5.amazon.com ([10.248.183.17])
  by smtp-border-fw-out-4101.iad4.amazon.com with ESMTP/TLS/DHE-RSA-AES256-SHA; 23 Sep 2009 00:42:34 +0000
Received: from ex-hub-4104.ant.amazon.com (ex-hub-4104.sea5.amazon.com [10.248.163.25])
	by smtp-in-4103.sea5.amazon.com (8.12.11/8.12.11) with ESMTP id n8N0gX85023369
	(version=TLSv1/SSLv3 cipher=RC4-MD5 bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Wed, 23 Sep 2009 00:42:33 GMT
Received: from EX-SEA5-D.ant.amazon.com ([10.248.163.29]) by
 ex-hub-4104.ant.amazon.com ([10.248.163.25]) with mapi; Tue, 22 Sep 2009
 17:42:33 -0700
From: "Ho, Alan" <alanho@amazon.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 22 Sep 2009 17:40:57 -0700
Subject: Declined: Invitation: Free Webinar - Apache Lucene 2.9: Technical
 Overview of New Features (Sep 24 02:00 PM EDT)
Thread-Topic: Invitation: Free Webinar - Apache Lucene 2.9: Technical
 Overview of New Features (Sep 24 02:00 PM EDT)
Thread-Index: Aco4rDqnW/aF9iD6Quioyb/PD29UJAABELzwAM2BmoA=
Message-ID: <4D25F22093241741BC1D0EEBC2DBB1DA01B950A226@EX-SEA5-D.ant.amazon.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-cr-hashedpuzzle: gI0= A5df BV46 BeOf Bwz/ ChQX FPXN Fsan HdM/ ID3x IVQR
 JMqB JQOw Jr91 KnV0
 Kz5K;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{781F60EE-580C-41EC-BBD1-4C5326E09C14};YQBsAGEAbgBoAG8AQABhAG0AYQB6AG8AbgAuAGMAbwBtAA==;Wed,
 23 Sep 2009 00:40:57
 GMT;RABlAGMAbABpAG4AZQBkADoAIABJAG4AdgBpAHQAYQB0AGkAbwBuADoAIABGAHIAZQBlACAAVwBlAGIAaQBuAGEAcgAgAC0AIABBAHAAYQBjAGgAZQAgAEwAdQBjAGUAbgBlACAAMgAuADkAOgAgAFQAZQBjAGgAbgBpAGMAYQBsACAATwB2AGUAcgB2AGkAZQB3ACAAbwBmACAATgBlAHcAIABGAGUAYQB0AHUAcgBlAHMAIAAoAFMAZQBwACAAMgA0ACAAMAAyADoAMAAwACAAUABNACAARQBEAFQAKQA=
x-cr-puzzleid: {781F60EE-580C-41EC-BBD1-4C5326E09C14}
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_002_4D25F22093241741BC1D0EEBC2DBB1DA01B950A226EXSEA5Dantama_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_002_4D25F22093241741BC1D0EEBC2DBB1DA01B950A226EXSEA5Dantama_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64


--_002_4D25F22093241741BC1D0EEBC2DBB1DA01B950A226EXSEA5Dantama_
Content-Type: text/calendar; charset="utf-8"; method=REPLY
Content-Transfer-Encoding: base64

QkVHSU46VkNBTEVOREFSDQpNRVRIT0Q6UkVQTFkNClBST0RJRDpNaWNyb3NvZnQgRXhjaGFuZ2Ug
U2VydmVyIDIwMDcNClZFUlNJT046Mi4wDQpCRUdJTjpWVElNRVpPTkUNClRaSUQ6UGFjaWZpYyBT
dGFuZGFyZCBUaW1lDQpCRUdJTjpTVEFOREFSRA0KRFRTVEFSVDoxNjAxMDEwMVQwMjAwMDANClRa
T0ZGU0VURlJPTTotMDcwMA0KVFpPRkZTRVRUTzotMDgwMA0KUlJVTEU6RlJFUT1ZRUFSTFk7SU5U
RVJWQUw9MTtCWURBWT0xU1U7QllNT05USD0xMQ0KRU5EOlNUQU5EQVJEDQpCRUdJTjpEQVlMSUdI
VA0KRFRTVEFSVDoxNjAxMDEwMVQwMjAwMDANClRaT0ZGU0VURlJPTTotMDgwMA0KVFpPRkZTRVRU
TzotMDcwMA0KUlJVTEU6RlJFUT1ZRUFSTFk7SU5URVJWQUw9MTtCWURBWT0yU1U7QllNT05USD0z
DQpFTkQ6REFZTElHSFQNCkVORDpWVElNRVpPTkUNCkJFR0lOOlZFVkVOVA0KQVRURU5ERUU7UEFS
VFNUQVQ9REVDTElORUQ7Q049IkhvLCBBbGFuIjpNQUlMVE86YWxhbmhvQGFtYXpvbi5jb20NCkNP
TU1FTlQ7TEFOR1VBR0U9ZW4tVVM6DQpTVU1NQVJZO0xBTkdVQUdFPWVuLVVTOkRlY2xpbmVkOiBJ
bnZpdGF0aW9uOiBGcmVlIFdlYmluYXIgLSBBcGFjaGUgTHVjZW5lIDINCiAuOTogVGVjaG5pY2Fs
IE92ZXJ2aWV3IG9mIE5ldyBGZWF0dXJlcyAoU2VwIDI0IDAyOjAwIFBNIEVEVCkNCkRUU1RBUlQ7
VFpJRD1QYWNpZmljIFN0YW5kYXJkIFRpbWU6MjAwOTA5MjRUMTEwMDAwDQpEVEVORDtUWklEPVBh
Y2lmaWMgU3RhbmRhcmQgVGltZToyMDA5MDkyNFQxMjAwMDANClVJRDpFMzE0M0VDNEY5NUUyQzY1
ODUyNTc2MzUwMDc5Mjk3RC1Mb3R1c19Ob3Rlc19HZW5lcmF0ZWQNCkNMQVNTOlBVQkxJQw0KUFJJ
T1JJVFk6NQ0KRFRTVEFNUDoyMDA5MDkyM1QwMDQwNTdaDQpUUkFOU1A6T1BBUVVFDQpTVEFUVVM6
Q09ORklSTUVEDQpTRVFVRU5DRTowDQpMT0NBVElPTjtMQU5HVUFHRT1lbi1VUzoNClgtTUlDUk9T
T0ZULUNETy1BUFBULVNFUVVFTkNFOjANClgtTUlDUk9TT0ZULUNETy1PV05FUkFQUFRJRDotMQ0K
WC1NSUNST1NPRlQtQ0RPLUJVU1lTVEFUVVM6QlVTWQ0KWC1NSUNST1NPRlQtQ0RPLUlOVEVOREVE
U1RBVFVTOkJVU1kNClgtTUlDUk9TT0ZULUNETy1BTExEQVlFVkVOVDpGQUxTRQ0KWC1NSUNST1NP
RlQtQ0RPLUlNUE9SVEFOQ0U6MQ0KWC1NSUNST1NPRlQtQ0RPLUlOU1RUWVBFOjANCkVORDpWRVZF
TlQNCkVORDpWQ0FMRU5EQVINCg==

--_002_4D25F22093241741BC1D0EEBC2DBB1DA01B950A226EXSEA5Dantama_--

From java-user-return-42444-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 23 15:56:18 2009
Return-Path: <java-user-return-42444-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51638 invoked from network); 23 Sep 2009 15:56:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Sep 2009 15:56:18 -0000
Received: (qmail 33736 invoked by uid 500); 23 Sep 2009 15:56:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33666 invoked by uid 500); 23 Sep 2009 15:56:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33655 invoked by uid 99); 23 Sep 2009 15:56:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 23 Sep 2009 15:56:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mindas@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 23 Sep 2009 15:56:06 +0000
Received: by fxm2 with SMTP id 2so729134fxm.28
        for <java-user@lucene.apache.org>; Wed, 23 Sep 2009 08:55:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=BCXiTS1nJVT41IoIbq7SFO3g4URjjkOp4bmEU2MNQlQ=;
        b=JEYqCm5/hDsURuC8KmqU+yCYR56gUQJZN3ZvFFl3+iax65LWCI4xnjaRUrZiBoW9Og
         t6V+4KDN1DGo9yAy7PZiLwbqCt6GS9ZckT2Vt97FMrmqR5ob+TbEeNIi2BnfGSIZ1wBJ
         us1jhvxRrBOQ/X3JFF5EPieo7RH+qwB3T9VnM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=noYzHySNuXgFcpELNjc4/Z8Lo1Z3nx/lSk2cLVWdYtzdnDK1xVkKruviw/12aF9zML
         ZFRHTNnBoBmLmA2FsSe3LGf1kjLqOxxqiIXTtbxq1W1EvT2XvagAurSThx06A7Kt4Zv9
         AmECTsW7bDLz+ChFD9EphBgRl1S8eTqyI6ghs=
MIME-Version: 1.0
Received: by 10.239.182.150 with SMTP id q22mr221755hbg.73.1253721346311; Wed, 
	23 Sep 2009 08:55:46 -0700 (PDT)
In-Reply-To: <1A565AA1-7C96-432C-B9AB-E7D20EFC65BB@gmail.com>
References: <a4d7dcf50909210732y510b2d9am7a14a2875092b364@mail.gmail.com>
	 <1A565AA1-7C96-432C-B9AB-E7D20EFC65BB@gmail.com>
Date: Wed, 23 Sep 2009 16:55:46 +0100
Message-ID: <a4d7dcf50909230855n29500e3ej3958f380408c7e0@mail.gmail.com>
Subject: Re: Memory consumed by IndexSearcher
From: =?ISO-8859-13?Q?Mindaugas_=DEak=F0auskas?= <mindas@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Karl,

On Tue, Sep 22, 2009 at 6:58 PM, Karl Wettin <karl.wettin@gmail.com> wrote:
> <..> Thing that
> consume the most memory is probably field norms (8 bits per field and
> document unless omitted) and flyweighted terms (String#interal), things you
> can't really do that much about.

I was kind of hinting on the resource planning. Every decent
enterprise application, apart from other things, has to provide its
memory requirements, and my point was - if it uses memory, how much of
it needs to be allocated? What are the boundaries?

> But it is hard to say for sure when you've said so little about what your
> index really looks like.

> How many fields,
80

> do you use norms
yes

> how many documents do you have
786

> how many unique terms are there, etc?
Luke says:
Has deletions? / Optimized? Yes (1614) / No
Index format: -7 (Lucene 2.4)
Index functionality: lock-less, single norms, shared doc
store,checksum,del count, omitTf
TermInfos index divisor: 1
Directory implementation: org.apache.lucene.store.FSDirectory

Hope this helps.

Regards,
Mindaugas

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42445-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 23 16:47:51 2009
Return-Path: <java-user-return-42445-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69519 invoked from network); 23 Sep 2009 16:47:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Sep 2009 16:47:51 -0000
Received: (qmail 12483 invoked by uid 500); 23 Sep 2009 16:47:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12398 invoked by uid 500); 23 Sep 2009 16:47:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12388 invoked by uid 99); 23 Sep 2009 16:47:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 23 Sep 2009 16:47:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 209.85.219.219 as permitted sender)
Received: from [209.85.219.219] (HELO mail-ew0-f219.google.com) (209.85.219.219)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 23 Sep 2009 16:47:40 +0000
Received: by ewy19 with SMTP id 19so896910ewy.28
        for <java-user@lucene.apache.org>; Wed, 23 Sep 2009 09:47:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=EkOmaIytvT29IfYoce9AH3T76HVkx1vjOtO5KjnU1CA=;
        b=DPNIq9XvU70ynvuysF34XLFFwczzR/wfPtSV0cJ0f+hw/YuiyQ624BCVZFJdu4aD63
         QiDlyzoBBkP+NzLYZzp3j+xL18K19JEUiDEz8SHWbC8VDnrfYLVAWf9kpKYfbbo8qjg2
         RYoFlc6hxI5mY9uS+IszDoFbsJ0jpRcoWRbYI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=ZXT2VDEepLxKY4BXkDXAhispyZrKH+iev3neWv1at8c9sfssKYOjOy4N0h37LFW5IX
         43AK7+EBZZ/T8MmwEEJ7U4MQEzPQF/NIncBuEYC76aZFzO3f/fr9wiULrGa2zJm+h8F+
         NGfmRJkOdbS7n+eaKuCtgiy4UXMSETE29enn0=
Received: by 10.211.174.10 with SMTP id b10mr2893510ebp.39.1253724438682;
        Wed, 23 Sep 2009 09:47:18 -0700 (PDT)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 28sm356984eye.6.2009.09.23.09.47.17
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 23 Sep 2009 09:47:18 -0700 (PDT)
Message-Id: <C6B81135-3CE7-4967-9D2C-7CF4E4D56483@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <a4d7dcf50909230855n29500e3ej3958f380408c7e0@mail.gmail.com>
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Memory consumed by IndexSearcher
Date: Wed, 23 Sep 2009 18:47:17 +0200
References: <a4d7dcf50909210732y510b2d9am7a14a2875092b364@mail.gmail.com> <1A565AA1-7C96-432C-B9AB-E7D20EFC65BB@gmail.com> <a4d7dcf50909230855n29500e3ej3958f380408c7e0@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


23 sep 2009 kl. 17.55 skrev Mindaugas =8Eak=9Aauskas:
>>
> Luke says:
> Has deletions? / Optimized? Yes (1614) / No

Very quick response, try optimizing your index and see what happends.

I'll get back to you unless someone beats me to it.


      karl=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42446-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 04:18:39 2009
Return-Path: <java-user-return-42446-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46358 invoked from network); 24 Sep 2009 04:18:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 04:18:38 -0000
Received: (qmail 68070 invoked by uid 500); 24 Sep 2009 04:18:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67923 invoked by uid 500); 24 Sep 2009 04:18:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67911 invoked by uid 99); 24 Sep 2009 04:18:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 04:18:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of karl.wettin@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 04:18:23 +0000
Received: by ey-out-2122.google.com with SMTP id 22so293634eye.3
        for <java-user@lucene.apache.org>; Wed, 23 Sep 2009 21:18:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=p3vi3yElSho9cjmBd0jReCObzPuZ7PSIRSS8qO0UcrQ=;
        b=J5yMjA+NjXVktXO1Nfd0DUX3ZNY63kZoX9J4wfAAYkrLG6V0VZPoUoVuSsTNTRMnBL
         cCIupTAMtgqtK3anmRc/GDrGfbi6ZREsbOAyqewziu4NrSsKavgtqf6eH6EPXYOY46SI
         pcjlViEWDMIlduoybuiSsTcaLgDNtjZ7ZgECs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=ZG27cnABrjZEWUa8LJfa5r2utzm7BrzfsJ6YzrEshPBXXvCokrTvKR/OL/x/v9YqOh
         eva58RPKNQ60nt3f1uL5PeWdGHw3bpOZWfbKtNdAnOb2xeIDJeda5A2HsNaUwKy1P8Sz
         8/f82vK7ZKLQTF2j0SB3Ei9sGRXyjtWiEUh8Y=
Received: by 10.211.132.28 with SMTP id j28mr3566690ebn.95.1253765883750;
        Wed, 23 Sep 2009 21:18:03 -0700 (PDT)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 7sm1005020eyg.37.2009.09.23.21.18.02
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 23 Sep 2009 21:18:02 -0700 (PDT)
Message-Id: <D4BF19C7-895D-4AD6-A471-3267E1FFE297@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <a4d7dcf50909230855n29500e3ej3958f380408c7e0@mail.gmail.com>
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Memory consumed by IndexSearcher
Date: Thu, 24 Sep 2009 06:18:01 +0200
References: <a4d7dcf50909210732y510b2d9am7a14a2875092b364@mail.gmail.com> <1A565AA1-7C96-432C-B9AB-E7D20EFC65BB@gmail.com> <a4d7dcf50909230855n29500e3ej3958f380408c7e0@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


23 sep 2009 kl. 17.55 skrev Mindaugas =8Eak=9Aauskas:
>
> I was kind of hinting on the resource planning. Every decent
> enterprise application, apart from other things, has to provide its
> memory requirements, and my point was - if it uses memory, how much of
> it needs to be allocated? What are the boundaries?

There is no function available, if that is what you are asking for? =20
How much memory your search application will consume depends on how =20
you have built you index and what features you are using.
>
>> How many fields,
> 80
>
>> do you use norms
> yes
>
>> how many documents do you have
> 786

This is a rather small index. I'm surprised it takes 145MB RAM if the =20=

file size of the index is 22MB. Is this really from just opening an =20
FSDirectory? Or is it a RAMDirectory? My guess is the latter. If so, =20
did you then benchmark using FSDirectory instead? OS level FS cache =20
does a pretty good job. This is sort of leaving your question, but if =20=

you have been using a RAMDirectory to gain speed, then your index is =20
probably small enough to make use of InstantiatedIndex.

> Luke says:
> Has deletions? / Optimized? Yes (1614) / No

This says that you have quite some overhead of deleted documents, some =20=

2x of the available data in your index is just sitting around for no =20
use. Thus if you are using a RAMDirectory you should be able to cut =20
the amount of memory consumed to 1/3 by optimizing the index.

You still haven't said that much about your application though so I'm =20=

just guessing what the problem might be.


      karl=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42447-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 15:18:10 2009
Return-Path: <java-user-return-42447-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89563 invoked from network); 24 Sep 2009 15:18:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 15:18:10 -0000
Received: (qmail 59700 invoked by uid 500); 24 Sep 2009 15:18:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59610 invoked by uid 500); 24 Sep 2009 15:18:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59599 invoked by uid 99); 24 Sep 2009 15:18:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 15:18:07 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [82.132.130.169] (HELO mail.o2.co.uk) (82.132.130.169)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 15:17:57 +0000
Received: from [192.168.60.116] (188.220.58.136) by mail.o2.co.uk (8.0.013.3) (authenticated as joelhalbert)
        id 4A4B4FF01D825112 for java-user@lucene.apache.org; Thu, 24 Sep 2009 16:36:15 +0100
Subject: metrics for index ~100M docs
From: Joel Halbert <joel@su3analytics.com>
To: Lucene Users <java-user@lucene.apache.org>
Content-Type: text/plain
Organization: SU3 Analytics
Date: Thu, 24 Sep 2009 16:17:27 +0100
Message-Id: <1253805447.9486.30.camel@bohr>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.3.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Does anyone know of any recent metrics & stats on building out an index
of  ~100mm documents (each doc approx 5k). I'm looking for approx stats
on time to build, time to query and infrastructure requirements (number
of machines & spec) to reasonably support an index of such a size.

Thanks, 
Joel


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42448-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 16:29:43 2009
Return-Path: <java-user-return-42448-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11444 invoked from network); 24 Sep 2009 16:29:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 16:29:43 -0000
Received: (qmail 95388 invoked by uid 500); 24 Sep 2009 16:29:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95329 invoked by uid 500); 24 Sep 2009 16:29:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95319 invoked by uid 99); 24 Sep 2009 16:29:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 16:29:40 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.186 as permitted sender)
Received: from [209.85.223.186] (HELO mail-iw0-f186.google.com) (209.85.223.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 16:29:32 +0000
Received: by iwn16 with SMTP id 16so1144554iwn.29
        for <java-user@lucene.apache.org>; Thu, 24 Sep 2009 09:29:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=VHUc3vWFgQo2ZjeQfH7s4nf2zcgUmeoOCZUucuCg6Zw=;
        b=OswkXmm3BneyVX8RXNQYAAnntFYThxMPEQGdu9M7n0INeKPj7U2ur40DBoeKOAcCvi
         J92p+94zi4sXm4qpa2VIWQgMPIMwmJ0Ut99Ikd/KJTKgP/rYxe9RsdP2EwgldSvNXOCx
         STcnhRQK6an/9YQHRL/+SK8QHVCDFOeUk6Jdo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=uSVQHEKLT6TlNTnSPd1Vu8yKM76UHTyr3jyleI8KmRUzkjd4cOgRklQZFGqgLt+goY
         QKit73Nbd9rKd0giFgtePpQs38DO7AAHuObzZkwbINsmw4hUDO/btX0QWw88DE3VtPgt
         6trZVAnq50O87iL6F3cAgxoPU18R9bLnqWO8E=
MIME-Version: 1.0
Received: by 10.231.125.28 with SMTP id w28mr7627232ibr.50.1253809752219; Thu, 
	24 Sep 2009 09:29:12 -0700 (PDT)
In-Reply-To: <1253805447.9486.30.camel@bohr>
References: <1253805447.9486.30.camel@bohr>
Date: Thu, 24 Sep 2009 12:29:12 -0400
Message-ID: <359a92830909240929v6ba2d83cn6f888c89d1c12c7a@mail.gmail.com>
Subject: Re: metrics for index ~100M docs
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e645b8cae5a21804745554cf
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e645b8cae5a21804745554cf
Content-Type: text/plain; charset=ISO-8859-1

It's really hard to say anything meaningful here. How many fields? Whatkind
of sorting to you intend to do? How complex are the queries you
expect?

And even if you have meaningful answers to the above,
then "it depends" (tm).

Then you could go to SOLR (which is built on Lucene) to handle
distributed searching and a host of other infrastructure issues.

There are certainly Lucene installations out there that are much larger
than you're considering if that helps.

But you can create a small test app *very* quickly that'll help you
answer this for your local set of conditions, which might be a good
place to start.

Don't forget the "powered by" section of the Wiki for some ideas:
http://wiki.apache.org/lucene-java/PoweredBy

<http://wiki.apache.org/lucene-java/PoweredBy>Best
Erick

On Thu, Sep 24, 2009 at 11:17 AM, Joel Halbert <joel@su3analytics.com>wrote:

> Hi,
>
> Does anyone know of any recent metrics & stats on building out an index
> of  ~100mm documents (each doc approx 5k). I'm looking for approx stats
> on time to build, time to query and infrastructure requirements (number
> of machines & spec) to reasonably support an index of such a size.
>
> Thanks,
> Joel
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e645b8cae5a21804745554cf--

From java-user-return-42449-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 16:34:36 2009
Return-Path: <java-user-return-42449-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12977 invoked from network); 24 Sep 2009 16:34:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 16:34:36 -0000
Received: (qmail 5365 invoked by uid 500); 24 Sep 2009 16:34:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5304 invoked by uid 500); 24 Sep 2009 16:34:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5294 invoked by uid 99); 24 Sep 2009 16:34:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 16:34:33 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [82.132.130.151] (HELO mail.o2.co.uk) (82.132.130.151)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 16:34:23 +0000
Received: from [192.168.60.116] (188.220.58.136) by mail.o2.co.uk (8.0.013.3) (authenticated as joelhalbert)
        id 4AA8797304B8657D for java-user@lucene.apache.org; Thu, 24 Sep 2009 17:33:55 +0100
Subject: Re: metrics for index ~100M docs
From: Joel Halbert <joel@su3analytics.com>
To: java-user@lucene.apache.org
In-Reply-To: <359a92830909240929v6ba2d83cn6f888c89d1c12c7a@mail.gmail.com>
References: <1253805447.9486.30.camel@bohr>
	 <359a92830909240929v6ba2d83cn6f888c89d1c12c7a@mail.gmail.com>
Content-Type: text/plain
Organization: SU3 Analytics
Date: Thu, 24 Sep 2009 17:33:57 +0100
Message-Id: <1253810037.9486.39.camel@bohr>
Mime-Version: 1.0
X-Mailer: Evolution 2.22.3.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I found this thread pretty useful:

http://markmail.org/search/?q=Re%3A+Scaling+out%2Fup+or+a+mix#query:Re%
3A%20Scaling%20out%2Fup%20or%20a%20mix+page:1+mid:x4ymuplegomuth7n
+state:results

-----Original Message-----
From: Erick Erickson <erickerickson@gmail.com>
Reply-To: java-user@lucene.apache.org
To: java-user@lucene.apache.org
Subject: Re: metrics for index ~100M docs
Date: Thu, 24 Sep 2009 12:29:12 -0400

It's really hard to say anything meaningful here. How many fields? Whatkind
of sorting to you intend to do? How complex are the queries you
expect?

And even if you have meaningful answers to the above,
then "it depends" (tm).

Then you could go to SOLR (which is built on Lucene) to handle
distributed searching and a host of other infrastructure issues.

There are certainly Lucene installations out there that are much larger
than you're considering if that helps.

But you can create a small test app *very* quickly that'll help you
answer this for your local set of conditions, which might be a good
place to start.

Don't forget the "powered by" section of the Wiki for some ideas:
http://wiki.apache.org/lucene-java/PoweredBy

<http://wiki.apache.org/lucene-java/PoweredBy>Best
Erick

On Thu, Sep 24, 2009 at 11:17 AM, Joel Halbert <joel@su3analytics.com>wrote:

> Hi,
>
> Does anyone know of any recent metrics & stats on building out an index
> of  ~100mm documents (each doc approx 5k). I'm looking for approx stats
> on time to build, time to query and infrastructure requirements (number
> of machines & spec) to reasonably support an index of such a size.
>
> Thanks,
> Joel
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42450-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 16:49:54 2009
Return-Path: <java-user-return-42450-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16809 invoked from network); 24 Sep 2009 16:49:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 16:49:54 -0000
Received: (qmail 27188 invoked by uid 500); 24 Sep 2009 16:49:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27119 invoked by uid 500); 24 Sep 2009 16:49:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27109 invoked by uid 99); 24 Sep 2009 16:49:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 16:49:52 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ctignor@thinkmap.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 16:49:44 +0000
Received: by fxm2 with SMTP id 2so1630512fxm.28
        for <java-user@lucene.apache.org>; Thu, 24 Sep 2009 09:49:22 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.57.66 with SMTP id b2mr1390986fah.33.1253810961594; Thu, 
	24 Sep 2009 09:49:21 -0700 (PDT)
Date: Thu, 24 Sep 2009 12:49:21 -0400
Message-ID: <6f287d1b0909240949q330d0fa8t1b7a575a91a8abb2@mail.gmail.com>
Subject: Getting Payload data from BooleanQuery results
From: Christopher Tignor <ctignor@thinkmap.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001517473434fb3b6d0474559cd8
X-Virus-Checked: Checked by ClamAV on apache.org

--001517473434fb3b6d0474559cd8
Content-Type: text/plain; charset=ISO-8859-1

Hello,

I have indexed documents with two fields, "ARTICLE" for an article of text
and "PUB_DATE" for the article's publication date.

Given a specific single word, I want to search my index for all documents
that contain this word within the last two weeks, and have them sorted by
date:

TermQuery tq = new TermQuery(new Term("ARTICLE",mySearchWord));
Calendar cal = Calendar.getInstance();
// Date of last two weeks
cal.add(Calendar.DATE, -14);
ConstantScoreRangeQuery csrq = new
ConstantScoreRangeQuery("PUB_DATE",DateTools.dateToString(cal.getTime(),DateTools.Resolution.HOUR),null,true,true);
BooleanQuery bq = new BooleanQuery();
bq.add(tq, BooleanClause.Occur.MUST);
bq.add(csrq, BooleanClause.Occur.MUST);
TopFieldDocs docs = searcher.search(bq, null, 10, new Sort("PUB_DATE"));

My goal now is to search through the recovered documents an obtain the Term
instances (each term position) within each document and retrieve the payload
data associated with each Term instance.

The trouble I am having is in getting access to the TermPositions following
such a query.
If I only needed to query on a single term (without my date restriction), I
could easily do (and have done) this:

SpanTermQuery query = new SpanTermQuery(new Term("ARTICLE",mySearchWord));
TermSpans spans = (TermSpans) query.getSpans(indexReader);
tp = spans.getPositions();

and then iterate over each position calling

tp.getPayload(dataBuffer,0);

for example.

But alas, I cannot seem to get access to any TermPositions from my above
BooleanQuery.
I have looked into the contributed SpanExtractorClass but
ConstantScoreRangeQuery seems unsupported
and I am at a loos as to how to best use Spans here.

Any help appreciated,

C>T>

-- 
TH!NKMAP

Christopher Tignor | Senior Software Architect
155 Spring Street NY, NY 10012
p.212-285-8600 x385 f.212-285-8999

--001517473434fb3b6d0474559cd8--

From java-user-return-42451-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 17:12:02 2009
Return-Path: <java-user-return-42451-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23342 invoked from network); 24 Sep 2009 17:12:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 17:12:02 -0000
Received: (qmail 63828 invoked by uid 500); 24 Sep 2009 17:11:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63747 invoked by uid 500); 24 Sep 2009 17:11:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63737 invoked by uid 99); 24 Sep 2009 17:11:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 17:11:59 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [150.148.0.65] (HELO ironport4.fda.gov) (150.148.0.65)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 17:11:50 +0000
X-SBRS: None
X-MID: 147968183
Received: from fmd3tj002.fda.gov ([10.160.10.77])
  by ironport4.fda.gov with ESMTP; 24 Sep 2009 13:11:21 -0400
Received: from FMD3VS012.fda.gov ([10.160.10.61]) by FMD3TJ002.fda.gov with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 24 Sep 2009 13:11:21 -0400
X-MIMEOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: metrics for index ~100M docs
Date: Thu, 24 Sep 2009 13:11:21 -0400
Message-ID: <F8A04958BB57B64096F9BE6B95725643081E3B4C@FMD3VS012.fda.gov>
In-Reply-To: <1253805447.9486.30.camel@bohr>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: metrics for index ~100M docs
Thread-index: Aco9KjpVeOsFwrzSRr6U9YWweC8bwAAD3otA
References: <1253805447.9486.30.camel@bohr>
From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 24 Sep 2009 17:11:21.0246 (UTC) FILETIME=[09A18BE0:01CA3D3A]
X-Virus-Checked: Checked by ClamAV on apache.org

=20
Hi Joel,

With approx. 100K doc size, on dual-quad core machine, (3.0Ghz) -
Windows platform, we have an average 1000 docs/sec. This includes text
extraction from PDF docs.=20

Hope this helps.

Sincerely,
Sithu D Sudarsan


-----Original Message-----
From: Joel Halbert [mailto:joel@su3analytics.com]=20
Sent: Thursday, September 24, 2009 11:17 AM
To: Lucene Users
Subject: metrics for index ~100M docs

Hi,

Does anyone know of any recent metrics & stats on building out an index
of  ~100mm documents (each doc approx 5k). I'm looking for approx stats
on time to build, time to query and infrastructure requirements (number
of machines & spec) to reasonably support an index of such a size.

Thanks,=20
Joel


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42452-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 17:50:20 2009
Return-Path: <java-user-return-42452-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32825 invoked from network); 24 Sep 2009 17:50:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 17:50:20 -0000
Received: (qmail 24496 invoked by uid 500); 24 Sep 2009 17:50:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24430 invoked by uid 500); 24 Sep 2009 17:50:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24420 invoked by uid 99); 24 Sep 2009 17:50:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 17:50:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 17:50:07 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MqsRu-0003PI-Uw
	for java-user@lucene.apache.org; Thu, 24 Sep 2009 10:49:46 -0700
Message-ID: <25578017.post@talk.nabble.com>
Date: Thu, 24 Sep 2009 10:49:46 -0700 (PDT)
From: coldserenity <muntyanu.roman@gmail.com>
To: java-user@lucene.apache.org
Subject: Search with wild-cards by words with forward-slash ("/")
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: muntyanu.roman@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,
  
    I've been searching the forum and found several more or less relevant
topic listed below.
        
http://www.nabble.com/Parsing-text-containing-forward-slash-and-wildcard-td13541503.html#a13541503
http://www.nabble.com/Parsing-text-containing-forward-slash-and-wildcard-td13541503.html#a13541503 
        
http://www.nabble.com/Search-that-supports-all-valid-characters-in-a-Unix-filename-td11495983.html
http://www.nabble.com/Search-that-supports-all-valid-characters-in-a-Unix-filename-td11495983.html 
        
http://www.nabble.com/Payloads%2C-Tokenizers%2C-and-Filters.--Oh-My!-td13806662.html
http://www.nabble.com/Payloads%2C-Tokenizers%2C-and-Filters.--Oh-My!-td13806662.html 
    However they did not help me much and that's why I've decided to start a
separate topic.

    Basically what I need to do, is to be able to search '/' (forward slash)
symbol much the same as any alpha-numeric symbol AND with using wildcards.
E.g. if I have following records in my index
      1 |  /cat1
      2 |  /cat1/test
      3 |  /cat1/tea
      4 |  /cat2/test
    Search by
      /cat1* - will return records 1, 2, 3
      /cat1/test - will return record 2
      /cat1/t* - will return records 2, 3
      /cat1/t - will return no records

    I use Lucene with Compass. The searched property is indexed as
"untokenized".
    I have tried using StandardAnalyzer and KeywordAnalyzer but got the
following in the 

    Results from testing
org.apache.lucene.analysis.standard.StandardAnalyzer
        Search string:             rootKey:/cat1/te*
        Rewritten search string:   rootKey:/cat1/te*
        Found results          :   0

        Search string:             rootKey:/cat1/test
        Rewritten search string:   rootKey:"cat1 test"
        Found results          :   1

        Search string:             rootKey:/cat1/te
        Rewritten search string:   rootKey:"cat1 te"
        Found results          :   0

    Results from testing org.apache.lucene.analysis.KeywordAnalyzer
        Search string:             rootKey:/cat1/te
        Rewritten search string:   rootKey:/cat1/te
        Found results          :   0

        Search string:             rootKey:/cat1/te*
        Rewritten search string:   rootKey:/cat1/te*
        Found results          :   0

    So it looks like Lucene internally replaces the '/' with whitespace when
searching however I did not find any "replace symbol" code in the source
code of StandardAnalyzer, neither I had much luck in finding that place
during debugging the Lucene sources.
    
    With that all said, I would appreciate any hint on how this task could
be accomplished.
    
Regards,
  Roman
-- 
View this message in context: http://www.nabble.com/Search-with-wild-cards-by-words-with-forward-slash-%28%22-%22%29-tp25578017p25578017.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42453-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 18:10:10 2009
Return-Path: <java-user-return-42453-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38432 invoked from network); 24 Sep 2009 18:10:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 18:10:10 -0000
Received: (qmail 52043 invoked by uid 500); 24 Sep 2009 18:10:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51984 invoked by uid 500); 24 Sep 2009 18:10:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51974 invoked by uid 99); 24 Sep 2009 18:10:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 18:10:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.223.186 as permitted sender)
Received: from [209.85.223.186] (HELO mail-iw0-f186.google.com) (209.85.223.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 18:09:58 +0000
Received: by iwn16 with SMTP id 16so7990iwn.29
        for <java-user@lucene.apache.org>; Thu, 24 Sep 2009 11:09:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=k04JIcVmv4qi36x55D/kPlbdKFZqidAukzmk9tFZPg0=;
        b=YLeiS0+cNbZgRJ4hZXu9PqCPEj8qT5PguQds7wQ+KC9pRZ9wPY6rhmOzaXasOdJ169
         dnG3acMDX+c3g8xi7Huc41zqYxg6gtyRQ1h7cqgiwWwkh3WyGqSDN2nqnytGjN3wt0cn
         0KuRGLYq/jAU0kRfQLPZa6QIc8S/bwUhud5qE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=cRshBoa0eRwV8rWOheszhPoe40xjtu6Lck61lBCUAoJ2F0f6rZh7MEWPC4sxNWUTV5
         hyJ7VFB3+PNgg/3Oq1wLcnOlGBHFGfvhuSN3m+Ry4K3qJBOBQpecMhOsmNnS60H1j9LO
         GOA4/NmgcCkRD4mNA81VRAIwtNrmMG7dGhRgg=
MIME-Version: 1.0
Received: by 10.231.25.199 with SMTP id a7mr7823176ibc.51.1253815776414; Thu, 
	24 Sep 2009 11:09:36 -0700 (PDT)
In-Reply-To: <25578017.post@talk.nabble.com>
References: <25578017.post@talk.nabble.com>
Date: Thu, 24 Sep 2009 14:09:36 -0400
Message-ID: <359a92830909241109q68c1579bydae8e497d084db2@mail.gmail.com>
Subject: Re: Search with wild-cards by words with forward-slash ("/")
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001517741218f78b4f047456bb81
X-Virus-Checked: Checked by ClamAV on apache.org

--001517741218f78b4f047456bb81
Content-Type: text/plain; charset=ISO-8859-1

First, really think about getting a copy of Luke to help you investigate
what'sactually in your index, it's invaluable. It'll also let you try
running queries
through different analyzers and seeing the results.

But I think you're a bit fuzzy on what analyzers do. Their primary purpose
is to break the incoming stream up into *tokens*. By indexing
untokenized, you're bypassing processing by the analyzers. Further,
when indexing and searching with *different* analyzers, all hell breaks
loose unless you know *exactly* what you're doing <G>...

Lucene isn't "replacing the / with a space". Instead, StandardAnalyzer
treats most non-alphanum characters as delimiters, so what's happening
on search is cat/test is being broken up into "cat" and "test" as
separate tokens. The '/' is just completely lost.

Try this (sorry, I haven't got a handy test bed at the moment, so this is
from very rusty memory). Index and search with WhitespaceAnalyzer
(watch out, this will be case sensitive but that can be fixed pretty
easily). And index things tokenized, then try your searches.


KeywordAnalyzer is deliberately stupid. It's intended for fields that should
not be altered in any way. Besides, you're searching with one analyzer
and indexing with another I think. See the caution above.

HTH
Erick

On Thu, Sep 24, 2009 at 1:49 PM, coldserenity <muntyanu.roman@gmail.com>wrote:

>
> Hello,
>
>    I've been searching the forum and found several more or less relevant
> topic listed below.
>
>
> http://www.nabble.com/Parsing-text-containing-forward-slash-and-wildcard-td13541503.html#a13541503
>
> http://www.nabble.com/Parsing-text-containing-forward-slash-and-wildcard-td13541503.html#a13541503
>
>
> http://www.nabble.com/Search-that-supports-all-valid-characters-in-a-Unix-filename-td11495983.html
>
> http://www.nabble.com/Search-that-supports-all-valid-characters-in-a-Unix-filename-td11495983.html
>
>
> http://www.nabble.com/Payloads%2C-Tokenizers%2C-and-Filters.--Oh-My!-td13806662.html
>
> http://www.nabble.com/Payloads%2C-Tokenizers%2C-and-Filters.--Oh-My!-td13806662.html
>    However they did not help me much and that's why I've decided to start a
> separate topic.
>
>    Basically what I need to do, is to be able to search '/' (forward slash)
> symbol much the same as any alpha-numeric symbol AND with using wildcards.
> E.g. if I have following records in my index
>      1 |  /cat1
>      2 |  /cat1/test
>      3 |  /cat1/tea
>      4 |  /cat2/test
>    Search by
>      /cat1* - will return records 1, 2, 3
>      /cat1/test - will return record 2
>      /cat1/t* - will return records 2, 3
>      /cat1/t - will return no records
>
>    I use Lucene with Compass. The searched property is indexed as
> "untokenized".
>    I have tried using StandardAnalyzer and KeywordAnalyzer but got the
> following in the
>
>    Results from testing
> org.apache.lucene.analysis.standard.StandardAnalyzer
>        Search string:             rootKey:/cat1/te*
>        Rewritten search string:   rootKey:/cat1/te*
>        Found results          :   0
>
>        Search string:             rootKey:/cat1/test
>        Rewritten search string:   rootKey:"cat1 test"
>        Found results          :   1
>
>        Search string:             rootKey:/cat1/te
>        Rewritten search string:   rootKey:"cat1 te"
>        Found results          :   0
>
>    Results from testing org.apache.lucene.analysis.KeywordAnalyzer
>        Search string:             rootKey:/cat1/te
>        Rewritten search string:   rootKey:/cat1/te
>        Found results          :   0
>
>        Search string:             rootKey:/cat1/te*
>        Rewritten search string:   rootKey:/cat1/te*
>        Found results          :   0
>
>    So it looks like Lucene internally replaces the '/' with whitespace when
> searching however I did not find any "replace symbol" code in the source
> code of StandardAnalyzer, neither I had much luck in finding that place
> during debugging the Lucene sources.
>
>    With that all said, I would appreciate any hint on how this task could
> be accomplished.
>
> Regards,
>  Roman
> --
> View this message in context:
> http://www.nabble.com/Search-with-wild-cards-by-words-with-forward-slash-%28%22-%22%29-tp25578017p25578017.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001517741218f78b4f047456bb81--

From java-user-return-42454-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 18:56:33 2009
Return-Path: <java-user-return-42454-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57332 invoked from network); 24 Sep 2009 18:56:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 18:56:33 -0000
Received: (qmail 10429 invoked by uid 500); 24 Sep 2009 18:56:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10375 invoked by uid 500); 24 Sep 2009 18:56:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10359 invoked by uid 99); 24 Sep 2009 18:56:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 18:56:29 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aminmc@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 18:56:20 +0000
Received: by ey-out-2122.google.com with SMTP id 22so419462eye.3
        for <java-user@lucene.apache.org>; Thu, 24 Sep 2009 11:55:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=qR306AKu1hw1qHNEFsnl/u5dMJa6iU9xfPoz0EFNBQM=;
        b=yCGU4BGpaMYupuTFT/A01qFYV1tUMXL+xq6A8qUh29NDb1ViemLYioBtRyp1CJckv+
         J0kgo9sR9McTwRzL5DQ2IURbQ4bRHMljI+ysqK6J/7GQGd+EQzWrBjKNF3Axv4gFc+hz
         xSyU2nhUPQZgLGXau5Ev6J96BEDOHNpndkSws=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=bVG9ZeV7umo6VfbOWO4m7VN8D3TxwsVZeOoFP/Ihr++krmkeRuJTkMpqaBbTpNskCG
         ZI2xoXIDTXdjP/TAhqQRSrIoAFPyQyPJjOAai6zqGmasWZCF7JYJB7vVVKwOkGf7mXde
         aWolFMQFHAvq6Voh09tQE9mGEkRTVm9VBXvI0=
MIME-Version: 1.0
Received: by 10.216.15.7 with SMTP id e7mr798791wee.202.1253818557340; Thu, 24 
	Sep 2009 11:55:57 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0909171553030.24400@radix.cryptio.net>
References: <6f4104d80909040217yd24a342t22232a9b4f217fbb@mail.gmail.com>
	 <6f4104d80909040238i877609ev65a2f284c07a99df@mail.gmail.com>
	 <Pine.LNX.4.64.0909081521040.26698@radix.cryptio.net>
	 <6f4104d80909090016i577d87ajb96e8de84db59834@mail.gmail.com>
	 <Pine.LNX.4.64.0909171553030.24400@radix.cryptio.net>
Date: Thu, 24 Sep 2009 19:55:57 +0100
Message-ID: <6f4104d80909241155i4b749d83r6f822f1531c55d6@mail.gmail.com>
Subject: Re: Filtering question/advice
From: Amin Mohammed-Coleman <aminmc@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f6cb76b91d840474576155
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f6cb76b91d840474576155
Content-Type: text/plain; charset=ISO-8859-1

Hi
Sorry for not getting back to you.  Been swamped with stuff and work and
home.  Just managed to check my lucene emails!

You are right i made some silly mistakes with the testcase and have updated
accordingly.  The test is still failing but the properties are set
correctly:

public class UnderwriterReferenceTest {
    private Directory directory;
    private Analyzer analyzer;
    private IndexSearcher indexSearcher;
    private IndexWriter indexWriter;
    private Document layerDocumentA;


    @Before
    public void setUp() throws Exception {
        directory = new RAMDirectory();
        analyzer = new StandardAnalyzer();
        indexWriter = new IndexWriter(directory, analyzer,
IndexWriter.MaxFieldLength.UNLIMITED);

    }

   @Before
   public void setUpDocumentsForIndexing() throws Exception {

       Field uw1 = new Field("uw-refernce", "hello", Field.Store.NO,
Field.Index.ANALYZED);
       Field uw2 = new Field("uw-refernce", "bye", Field.Store.NO,
Field.Index.ANALYZED);


       Field uw1UWA = new Field("uw-uwa", "hello", Field.Store.NO,
Field.Index.ANALYZED);
       Field uw2UWB = new Field("uw-uwb", "bye", Field.Store.NO,
Field.Index.ANALYZED);


       layerDocumentA = new Document();
       layerDocumentA.add(uw1);
       layerDocumentA.add(uw2);
       layerDocumentA.add(uw1UWA);
       layerDocumentA.add(uw2UWB);
   }


    @Test
    public void
testUWBCannotSeeResultIfUWReferenceIsSearchThatDoesNotBelongToUWB() throws
Exception {
        indexWriter.addDocument(layerDocumentA);
        indexWriter.commit();
        indexWriter.close();

        indexSearcher = new IndexSearcher(directory);

        UnderwriterReferenceFilter filter = new
UnderwriterReferenceFilter();
        filter.setUwId("uwb");
        filter.setTermValue("hello");

        QueryParser queryParser = new QueryParser("uw-refernce", analyzer);
        Query q = queryParser.parse("hello");
        long start = System.currentTimeMillis();
        TopDocs topDocs = indexSearcher.search(q, filter, 100);
        long end = System.currentTimeMillis();
        System.out.println("Total time taken to search = " + (end - start) +
" milli seconds");
        System.out.println("Total results returned = " + topDocs.totalHits);
        assertNotNull(topDocs);
        assertEquals(0, topDocs.totalHits);
    }


    @Test
    public void
testUWACanSeeResultIfUWReferenceIsSearchThatDoesBelongToUWA() throws
Exception {
        indexWriter.addDocument(layerDocumentA);
        indexWriter.commit();
        indexWriter.close();

        indexSearcher = new IndexSearcher(directory);

        UnderwriterReferenceFilter filter = new
UnderwriterReferenceFilter();
        filter.setUwId("uwa");
        filter.setTermValue("hello");

        QueryParser queryParser = new QueryParser("uw-refernce", analyzer);
        Query q = queryParser.parse("hello");
        long start = System.currentTimeMillis();
        TopDocs topDocs = indexSearcher.search(q, filter, 100);
        long end = System.currentTimeMillis();
        System.out.println("Total time taken to search = " + (end - start) +
" milli seconds");
        System.out.println("Total results returned = " + topDocs.totalHits);
        assertNotNull(topDocs);
        assertEquals(1, topDocs.totalHits);
    }

    @Test
    public void testUWBCanSeeResultIfSearchTermMatchesOnSomethingElse()
throws Exception {

        Field data = new Field("data", "hello", Field.Store.NO,
Field.Index.ANALYZED);
        layerDocumentA.add(data);
        indexWriter.addDocument(layerDocumentA);
        indexWriter.commit();
        indexWriter.close();

        indexSearcher = new IndexSearcher(directory);



        UnderwriterReferenceFilter filter = new
UnderwriterReferenceFilter();
        filter.setTermValue("hello");
        filter.setUwId("uwb");

        MultiFieldQueryParser queryParser = new MultiFieldQueryParser(new
String[]{"uw-refernce", "data"}, analyzer);
        queryParser.enable_tracing();
        Query q = queryParser.parse("hello");
        long start = System.currentTimeMillis();



        TopDocs topDocs = indexSearcher.search(q, filter, 100);
        long end = System.currentTimeMillis();
        System.out.println("Total time taken to search = " + (end - start) +
" milli seconds");
        System.out.println("Total results returned = " + topDocs.totalHits);
        assertNotNull(topDocs);
        assertEquals(1, topDocs.totalHits);

    }

   private class UnderwriterReferenceFilter extends Filter {

    private String uwId;
    private String termValue;

    public void setTermValue(String termValue) {
       this.termValue = termValue;
    }

    public void setUwId(String uwId) {
        this.uwId = uwId;
    }

    @Override
    public DocIdSet getDocIdSet(org.apache.lucene.index.IndexReader reader)
throws java.io.IOException  {
        if (uwId == null || "".equals(uwId)) {
            throw new IllegalArgumentException("uwidnot set for filtering");
        }

        OpenBitSet bitSet = new OpenBitSet( reader.maxDoc());
        Term term = new Term("uw-"+uwId, termValue);
        TermDocs termDocs = reader.termDocs( term );
        while ( termDocs.next() ) {
            bitSet.set( termDocs.doc() );
        }

        return bitSet;

    }
   }

}


I did the test using the grouping mechanism that you mentioned which worked
however I just wanted to know whether the same can be achieved with filters.


Thanks again!

Amin

On Thu, Sep 17, 2009 at 11:59 PM, Chris Hostetter
<hossman_lucene@fucit.org>wrote:

>
> FWWI: a test case with multiple asserts is more useful if you clarify
> where it failes ... ie: show us the failure message, or put a comment on
> athe line of the assert that fails.
>
> i didn't run your testcase, but skimming it a few things jumpt out at me
> that might explain whatever problem you are seeing...
>
> :        Field uw1 = new Field("uw-refernce", "hello", Field.Store.NO,
> : Field.Index.ANALYZED);
> :        Field uw2 = new Field("uw-refernce", "bye", Field.Store.NO,
> : Field.Index.ANALYZED);
>                 ...
> :        layerDocumentA = new Document();
> :        layerDocumentA.add(uw1);
> :        layerDocumentA.add(uw1);
>
> ...did you really mean to add uw1 twice? or did you mean to add uw2 as
> well (it's never used)...
>
> :     public void testUWBCanSeeResultIfSearchTermMatchesOnSomethingElse()
> : throws Exception {
>                ...
> :         UnderwriterReferenceFilter filter = new
> : UnderwriterReferenceFilter();
>
> ...you never set any properties on this Filter before you use it. reading
> it's implementation, that should cause an IllegalArgumentException.
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--001485f6cb76b91d840474576155--

From java-user-return-42455-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 19:22:41 2009
Return-Path: <java-user-return-42455-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65875 invoked from network); 24 Sep 2009 19:22:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 19:22:41 -0000
Received: (qmail 46201 invoked by uid 500); 24 Sep 2009 19:22:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46130 invoked by uid 500); 24 Sep 2009 19:22:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46120 invoked by uid 99); 24 Sep 2009 19:22:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 19:22:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 19:22:30 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id D34DA71C848; Thu, 24 Sep 2009 12:22:09 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id D156D71C835
	for <java-user@lucene.apache.org>; Thu, 24 Sep 2009 12:22:09 -0700 (PDT)
Date: Thu, 24 Sep 2009 12:22:09 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Getting Payload data from BooleanQuery results
In-Reply-To: <6f287d1b0909240949q330d0fa8t1b7a575a91a8abb2@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.0909241221150.28775@radix.cryptio.net>
References: <6f287d1b0909240949q330d0fa8t1b7a575a91a8abb2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: But alas, I cannot seem to get access to any TermPositions from my above
: BooleanQuery.

I would suggest refactoring your "date" restriction into a Filter (there's 
fairly easy to use Filter that wraps a Query) and then execute a 
SPanTermQuery just as you describe.


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42456-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 20:04:46 2009
Return-Path: <java-user-return-42456-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77112 invoked from network); 24 Sep 2009 20:04:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 20:04:46 -0000
Received: (qmail 8120 invoked by uid 500); 24 Sep 2009 20:04:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8058 invoked by uid 500); 24 Sep 2009 20:04:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8041 invoked by uid 99); 24 Sep 2009 20:04:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 20:04:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of aatamer@casebank.com designates 216.191.86.230 as permitted sender)
Received: from [216.191.86.230] (HELO starbuck.casebank.com) (216.191.86.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 20:04:32 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA3D52.73C373D9"
Subject: help with DictionaryFilter replacing an acronym token with multiple tokens
Date: Thu, 24 Sep 2009 16:06:06 -0400
Message-ID: <896FB6B92BDE6641A3A6BF5130A7F96C34A83B@starbuck.casebank.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: help with DictionaryFilter replacing an acronym token with multiple tokens
Thread-Index: Aco9UnNPk7YJmXZeS8S1a+5BQmsQPw==
From: "Allen  Atamer" <aatamer@casebank.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA3D52.73C373D9
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hello List members,

=20

Please help me to fix a problem in my DictionaryFilter class.  It is
used to map acronyms, abbreviations, synonyms, etc. to one common root
word/phrase for easy searching.  For example, "temp" is an abbreviation
for "temperature".  One-to-one substitutions work without problem in
this code.  However one-to-many substitution isn't working properly.
For example, the search term "lop" is converted to "low oil pressure".
However, in the database, instances of "lop" are not being converted.
I need Lucene search to pick up both.  Right now my search term "lop"
only picks up documents with "low oil pressure" in them.

=20

The log trace of the indexer is as follows:

2009-09-24 15:40:32,774 [     main] DEBUG DictionaryFilter  -  NEWTOKEN
[low] , start:17, end:19

2009-09-24 15:40:32,774 [     main] DEBUG DictionaryFilter  -  NEWTOKEN
[oil] , start:20, end:22

2009-09-24 15:40:32,774 [     main] DEBUG DictionaryFilter  -  NEWTOKEN
[pressure] , start:23, end:30

2009-09-24 15:40:32,774 [     main] INFO  AnalyzerUtils  - [fault]
[mnemonics] [lop] [sdn]

=20

So you can see the DictionaryFilter makes the substitutions, but the
Analyzer doesn't keep the new tokens. When I scan through the terms with
AnalyzerUtils, the original token [lop] is still there! =20

=20

Please help.  Thank you.

=20

Below is the logic for DictionaryFilter.next():

=20

    public Token next()

        throws java.io.IOException {

        if (!tokenQueue.isEmpty()) {

            return (Token) tokenQueue.pop();

        }

=20

        Token reusableToken =3D new Token();

        Token token =3D input.next(reusableToken);

=20

        if ((dictionary =3D=3D null) || (token =3D=3D null) || =
!processField) {

            return token;

        }

=20

        TermData t =3D (TermData) dictionary.get(token.term());

=20

        if (t !=3D null && t.getTeach() !=3D null) {

                  Token result =3D processTeachToken(t.getTeach(), =
token);

                  token =3D null;

                  return result;

            } else if (t !=3D null) {=20

                  // return original because there's nothing better to
go on.

                  return token;

            }

            ... // other logic related to spell-checking

      }

=20

And here's the processTeachToken() function, which is where the
substitution happens:

=20

    private Token processTeachToken(String teachString, Token original)
{

        StringTokenizer tokenizer =3D new StringTokenizer(teachString, "
");

=20

        int start =3D original.startOffset();

        int positionIncrement =3D original.getPositionIncrement();

=20

        while (tokenizer.hasMoreTokens()) {

            String partToken =3D tokenizer.nextToken();

=20

            if (partToken.equals("")) {

                  throw new RuntimeException("TextClassifier failed");

            }

=20

//          Token newToken =3D new Token(partToken, start,

//          (start + partToken.length()) - 1);

                  Token newToken =3D new Token(start, (start +
partToken.length()) - 1);

//                newToken.setTermLength(partToken.length());

                  LuceneUtils.copyTermBuffer(newToken, partToken);

            log.debug(" NEWTOKEN [" + partToken + "] , start:"

                + newToken.startOffset() + ", end:" +
newToken.endOffset());

            newToken.setPositionIncrement(positionIncrement);

            tokenQueue.push(newToken);

            start +=3D partToken.length();

            positionIncrement++;

        }

=20

        Token result =3D (Token) tokenQueue.pop();

=20

        return result;

    }

=20

LuceneUtils.copyTermBuffer:

=20

      public static void copyTermBuffer(Token term, String copyTerm) {

        if (term.termBuffer().length < copyTerm.length()) {

                  term.resizeTermBuffer(copyTerm.length());

            }

           =20

        term.setTermLength(copyTerm.length());

=20

            char [] termBuffer =3D term.termBuffer();

            for (int i =3D 0; i < copyTerm.length(); i++) {

                  termBuffer[i] =3D copyTerm.charAt(i);

            }

      }


------_=_NextPart_001_01CA3D52.73C373D9--

From java-user-return-42457-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 21:52:31 2009
Return-Path: <java-user-return-42457-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53919 invoked from network); 24 Sep 2009 21:52:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 21:52:31 -0000
Received: (qmail 15195 invoked by uid 500); 24 Sep 2009 21:52:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15133 invoked by uid 500); 24 Sep 2009 21:52:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15123 invoked by uid 99); 24 Sep 2009 21:52:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 21:52:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ctignor@thinkmap.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 21:52:20 +0000
Received: by bwz10 with SMTP id 10so1764158bwz.5
        for <java-user@lucene.apache.org>; Thu, 24 Sep 2009 14:51:58 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.223.29.193 with SMTP id r1mr1567972fac.29.1253829118257; Thu, 
	24 Sep 2009 14:51:58 -0700 (PDT)
In-Reply-To: <Pine.LNX.4.64.0909241221150.28775@radix.cryptio.net>
References: <6f287d1b0909240949q330d0fa8t1b7a575a91a8abb2@mail.gmail.com>
	 <Pine.LNX.4.64.0909241221150.28775@radix.cryptio.net>
Date: Thu, 24 Sep 2009 17:51:58 -0400
Message-ID: <6f287d1b0909241451k6cdaa24dq74a4ca63840d8df8@mail.gmail.com>
Subject: Re: Getting Payload data from BooleanQuery results
From: Christopher Tignor <ctignor@thinkmap.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151747b76e33eb87047459d74b
X-Virus-Checked: Checked by ClamAV on apache.org

--00151747b76e33eb87047459d74b
Content-Type: text/plain; charset=ISO-8859-1

thanks for the tip.

I don't see a way to integrate the QueryWrapperFilter (or any Filter) into
SpanTermQuery.getSpans(indexReader) however.
I can use a SpanQuery with an IndexSearcher as per susual but that leaves me
back where I started.  Any thoughts?

Also,  I will need to sort these results by date so that the most recent,
say 5 are returned...

thanks again,

C>T>

On Thu, Sep 24, 2009 at 3:22 PM, Chris Hostetter
<hossman_lucene@fucit.org>wrote:

>
> : But alas, I cannot seem to get access to any TermPositions from my above
> : BooleanQuery.
>
> I would suggest refactoring your "date" restriction into a Filter (there's
> fairly easy to use Filter that wraps a Query) and then execute a
> SPanTermQuery just as you describe.
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
TH!NKMAP

Christopher Tignor | Senior Software Architect
155 Spring Street NY, NY 10012
p.212-285-8600 x385 f.212-285-8999

--00151747b76e33eb87047459d74b--

From java-user-return-42458-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 21:55:18 2009
Return-Path: <java-user-return-42458-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55198 invoked from network); 24 Sep 2009 21:55:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 21:55:18 -0000
Received: (qmail 21162 invoked by uid 500); 24 Sep 2009 21:55:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21081 invoked by uid 500); 24 Sep 2009 21:55:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21071 invoked by uid 99); 24 Sep 2009 21:55:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 21:55:15 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [150.148.0.65] (HELO ironport4.fda.gov) (150.148.0.65)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 21:55:06 +0000
X-SBRS: None
X-MID: 148014095
Received: from fmd3tj001.fda.gov ([10.160.10.76])
  by ironport4.fda.gov with ESMTP; 24 Sep 2009 17:54:40 -0400
Received: from FMD3VS012.fda.gov ([10.160.10.61]) by FMD3TJ001.fda.gov with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 24 Sep 2009 17:54:40 -0400
X-MIMEOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: metrics for index ~100M docs ... Correction 
Date: Thu, 24 Sep 2009 17:54:39 -0400
Message-ID: <F8A04958BB57B64096F9BE6B95725643081E3B50@FMD3VS012.fda.gov>
In-Reply-To: <F8A04958BB57B64096F9BE6B95725643081E3B4C@FMD3VS012.fda.gov>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: metrics for index ~100M docs ... Correction 
Thread-index: Aco9KjpVeOsFwrzSRr6U9YWweC8bwAAD3otAAAnoTUA=
References: <1253805447.9486.30.camel@bohr> <F8A04958BB57B64096F9BE6B95725643081E3B4C@FMD3VS012.fda.gov>
From: "Sudarsan, Sithu D." <Sithu.Sudarsan@fda.hhs.gov>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 24 Sep 2009 21:54:40.0237 (UTC) FILETIME=[9DD1B9D0:01CA3D61]
X-Virus-Checked: Checked by ClamAV on apache.org

=20
Hi Joel,

Couple of quick points.

1. The metric for indexing only.=20

2. It is 1000 docs/minute  (sorry for the earlier 1000/sec goof up)

3. Regarding search/query, it depends on many parameters... (similarity,
proximity, synonym look up etc.)

Sincerely,
Sithu D Sudarsan

-----Original Message-----
From: Sudarsan, Sithu D. [mailto:Sithu.Sudarsan@fda.hhs.gov]=20
Sent: Thursday, September 24, 2009 1:11 PM
To: java-user@lucene.apache.org
Subject: RE: metrics for index ~100M docs

=20
Hi Joel,

With approx. 100K doc size, on dual-quad core machine, (3.0Ghz) -
Windows platform, we have an average 1000 docs/sec. This includes text
extraction from PDF docs.=20

Hope this helps.

Sincerely,
Sithu D Sudarsan


-----Original Message-----
From: Joel Halbert [mailto:joel@su3analytics.com]=20
Sent: Thursday, September 24, 2009 11:17 AM
To: Lucene Users
Subject: metrics for index ~100M docs

Hi,

Does anyone know of any recent metrics & stats on building out an index
of  ~100mm documents (each doc approx 5k). I'm looking for approx stats
on time to build, time to query and infrastructure requirements (number
of machines & spec) to reasonably support an index of such a size.

Thanks,=20
Joel


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42459-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 22:01:43 2009
Return-Path: <java-user-return-42459-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57381 invoked from network); 24 Sep 2009 22:01:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 22:01:43 -0000
Received: (qmail 30600 invoked by uid 500); 24 Sep 2009 22:01:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30491 invoked by uid 500); 24 Sep 2009 22:01:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30469 invoked by uid 99); 24 Sep 2009 22:01:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 22:01:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mmasters@gmail.com designates 209.85.219.219 as permitted sender)
Received: from [209.85.219.219] (HELO mail-ew0-f219.google.com) (209.85.219.219)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 22:01:28 +0000
Received: by ewy19 with SMTP id 19so2101156ewy.28
        for <multiple recipients>; Thu, 24 Sep 2009 15:01:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:cc:content-type;
        bh=+WH1042bcmuptr6OJHe3nWpU534hlS8DsLGJSibscio=;
        b=Onz2myg7hhg2Ngs4afxmTyM7+vcZus4vXOZQ0sEPAOud8dgZ/4aGvh9WZvqDaIe4r1
         qm0gsbayqvl2Zy+Cgg/RaoFJPmhPa5KfVRi64vAGxJaaVY956LMNvio4bYnBAV3UTUQN
         8FGWjEXnhaVpdAEjN9CbOo5WPhYJjd74U98YI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        b=TYlWC20vfKbilNBXcLLCI43icBekwn4vrmR8JsZKVvZ3Ryy89anwwKHcG3gnLc9cJE
         hY1DsWAMVH2z5If8Hj/xCdGxoBjYbgUPFVysFCuPdRFxdeO+qYze3Vtjls4SVieYbdX8
         mHtuKjTSk/nZjp0ULtHF0KdYQ/rh/Pn1IqVaI=
MIME-Version: 1.0
Received: by 10.216.49.199 with SMTP id x49mr907944web.133.1253829667678; Thu, 
	24 Sep 2009 15:01:07 -0700 (PDT)
In-Reply-To: <92558FC2-47CF-4162-A68F-CFEF8EB074D7@gmail.com>
References: <92558FC2-47CF-4162-A68F-CFEF8EB074D7@gmail.com>
Date: Thu, 24 Sep 2009 16:01:07 -0600
Message-ID: <5b8626350909241501lb189c5cq53f088e27c8634a8@mail.gmail.com>
Subject: Re: Free Webinar - Apache Lucene 2.9: Technical Overview of New 
	Features
From: Michael Masters <mmasters@gmail.com>
To: java-user@lucene.apache.org
Cc: solr-user@lucene.apache.org, general@lucene.apache.org, 
	lucene-net-user@incubator.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Has anyone received a link with the slides from the presentation yet?

-Mike



On Fri, Sep 18, 2009 at 3:56 PM, Erik Hatcher <erik.hatcher@gmail.com> wrote:
> Free Webinar: Apache Lucene 2.9: Discover the Powerful New Features
> -------------------------------------------------------------------
>
> Join us for a free and in-depth technical webinar with Grant Ingersoll,
> co-founder of Lucid Imagination and chair of the Apache Lucene PMC.
>
> Thursday, September 24th 2009
> 11:00AM - 12 NOON PDT / 2:00 - 3:00PM EDT
> Click on the link below to sign up
> http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP
>
> Lucene 2.9 offers a rich set of new features and performance improvements
> alongside plentiful fixes and optimizations. If you are a Java developer
> building search applications with the Lucene search library, this webinar
> provides the insights you need to harness this important update to Apache
> Lucene.
>
> Grant will present and discuss key technical features and innovations
> including:
> o Real time/Per segment searching and caching
> o Built in numeric range support with trie structure for speed and
> simplified programming
> o Reduced search latency and improved index efficiency
>
> Join us for a free webinar.
> Thursday, September 24th 2009
> 11:00 AM - NOON PDT / 2:00 - 3:00 PM EDT
> http://www.eventsvc.com/lucidimagination/092409?trk=WR-SEP2009B-AP
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42460-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 23:26:43 2009
Return-Path: <java-user-return-42460-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74563 invoked from network); 24 Sep 2009 23:26:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 23:26:43 -0000
Received: (qmail 31730 invoked by uid 500); 24 Sep 2009 23:26:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31613 invoked by uid 500); 24 Sep 2009 23:26:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31298 invoked by uid 99); 24 Sep 2009 23:26:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 23:26:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HS_INDEX_PARAM,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of bradfordstephens@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 23:26:23 +0000
Received: by ywh26 with SMTP id 26so361466ywh.29
        for <multiple recipients>; Thu, 24 Sep 2009 16:26:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lhw/JskPmyHSmF7FknL4/QatKQP7sw1daxHLPclmS3I=;
        b=mUTkej/xsoxioziXFVDIFaDOSfAo5faOpZcTd3C8ADSoL0fLF5s/mhQJdv4JpM1Eg3
         a/5B4cKyU6MVHjUpPioRya2E2APoVOzJvwbf7stxrgQPMyppBIUsrCkyVFdfPJMFjQQk
         RB8nulL8+KsMMKR2G0CY2bfDNy0lzNPA/gx70=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=VEV7vjpOATTnyXbfMOnqG6NNt/OGibFMqP4G+pe2eYcZf9KfIHeAOTg8sxi/p7FUaT
         qb6EE5ghTD+jC4BIiuPDSOH+bHy/AnObgvimhMiD2CaId9lruRw8FoOmg7Rap/r39yi+
         /P053an2z2MAntOXQVH2Xb3ZzdBVNuJGtlNS8=
MIME-Version: 1.0
Received: by 10.91.17.39 with SMTP id u39mr321220agi.30.1253834762012; Thu, 24 
	Sep 2009 16:26:02 -0700 (PDT)
In-Reply-To: <860544ed0909141135y3e4c83a7mfd350e083e51ad11@mail.gmail.com>
References: <860544ed0909141135y3e4c83a7mfd350e083e51ad11@mail.gmail.com>
Date: Thu, 24 Sep 2009 16:26:01 -0700
Message-ID: <860544ed0909241626j468d1e74g3be2d9e7cb012328@mail.gmail.com>
Subject: Re: Seattle / PNW Hadoop/Lucene/HBase Meetup, Wed Sep 30th
From: Bradford Stephens <bradfordstephens@gmail.com>
To: core-user@hadoop.apache.org, java-user@lucene.apache.org, 
	solr-user@lucene.apache.org, hbase-user@hadoop.apache.org
Content-Type: multipart/alternative; boundary=00163646da8098c89504745b2747
X-Virus-Checked: Checked by ClamAV on apache.org

--00163646da8098c89504745b2747
Content-Type: text/plain; charset=ISO-8859-1

Friendly Reminder! One week to go.

On Mon, Sep 14, 2009 at 11:35 AM, Bradford Stephens <
bradfordstephens@gmail.com> wrote:

> Greetings,
>
> It's time for another Hadoop/Lucene/Apache"Cloud"  Stack meetup!
> This month it'll be on Wednesday, the 30th, at 6:45 pm.
>
> We should have a few interesting guests this time around -- someone from
> Facebook may be stopping by to talk about Hive :)
>
> We've had great attendance in the past few months, let's keep it up! I'm
> always
> amazed by the things I learn from everyone.
>
> We're back at the University of Washington, Allen Computer Science
> Center (not Computer Engineering)
> Map: http://www.washington.edu/home/maps/?CSE
>
> Room: 303 -or- the Entry level. If there are changes, signs will be posted.
>
> More Info:
>
> The meetup is about 2 hours (and there's usually food): we'll have two
> in-depth talks of 15-20
> minutes each, and then several "lightning talks" of 5 minutes. If no
> one offers, We'll then have discussion and 'social time'.  we'll just
> have general discussion. Let net know if you're interested in speaking
> or attending. We'd like to focus on education, so every presentation
> *needs* to ask some questions at the end. We can talk about these
> after the presentations, and I'll record what we've learned in a wiki
> and share that with the rest of us.
>
> Contact: Bradford Stephens, 904-415-3009, bradfordstephens@gmail.com
>
> Cheers,
> Bradford
> --
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science
>



-- 
http://www.roadtofailure.com -- The Fringes of Scalability, Social Media,
and Computer Science

--00163646da8098c89504745b2747--

From java-user-return-42461-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Sep 24 23:45:41 2009
Return-Path: <java-user-return-42461-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77677 invoked from network); 24 Sep 2009 23:45:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Sep 2009 23:45:41 -0000
Received: (qmail 50629 invoked by uid 500); 24 Sep 2009 23:45:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50572 invoked by uid 500); 24 Sep 2009 23:45:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50562 invoked by uid 99); 24 Sep 2009 23:45:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 23:45:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.195 as permitted sender)
Received: from [209.85.221.195] (HELO mail-qy0-f195.google.com) (209.85.221.195)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 24 Sep 2009 23:45:27 +0000
Received: by qyk33 with SMTP id 33so1861950qyk.29
        for <java-user@lucene.apache.org>; Thu, 24 Sep 2009 16:45:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=/wcf6Vr2xJrZic9BB0SU2lAl9IMw1AbBJWSL9vdiN+E=;
        b=Bnz8ijbNzFRIl9tRNAYa5NetXDUyA1gQy5A+/7beOZA/oZFs+hVawpM2KGUYszuUDN
         pxok3BNFhkwW6orx68amCPvdnU+KXLK6p5cZY/MjoD2y1yMKZib8kwyhVlAKFkkbhQjU
         gyN7MO8A1n4jBfZ53BzwbgDUKWrtbAbFlvcXk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=A7lbWWK8gSKWrGNUCH9C7hngTbGY0V2VFInJsk9DUUzHoxJpDwC5Toi3Bqo35rVM8a
         rnCk9uHwHYT4U9sXdwnX8AYigZtu8PD31AvfaD/4TlemHl7wAfYjk9KBnicQTaz8qHDK
         w1E4wVWU4yfo2a8+krk/xVebAZfM113nkf3G0=
Received: by 10.224.86.165 with SMTP id s37mr3933180qal.266.1253835906186;
        Thu, 24 Sep 2009 16:45:06 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm671735qwf.17.2009.09.24.16.45.05
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 24 Sep 2009 16:45:05 -0700 (PDT)
Message-ID: <4ABC0483.8000305@gmail.com>
Date: Thu, 24 Sep 2009 19:45:07 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Getting Payload data from BooleanQuery results
References: <6f287d1b0909240949q330d0fa8t1b7a575a91a8abb2@mail.gmail.com>	 <Pine.LNX.4.64.0909241221150.28775@radix.cryptio.net> <6f287d1b0909241451k6cdaa24dq74a4ca63840d8df8@mail.gmail.com>
In-Reply-To: <6f287d1b0909241451k6cdaa24dq74a4ca63840d8df8@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I should beef up that spans extractor - it can actually work on the
constantscore multi term queries (the base ones that now have a constant
score mode in 2.9), just like the Highlighter does. That class really
belongs in contrib probably.

You can use the filter and the spanquery to get the results, then do
your getSpans call on those results to get the positions (the same way
you might have used the span extractor, or that the highlighter works -
a doc at a time on the already matching docs).

-- 
- Mark

http://www.lucidimagination.com



Christopher Tignor wrote:
> thanks for the tip.
>
> I don't see a way to integrate the QueryWrapperFilter (or any Filter) into
> SpanTermQuery.getSpans(indexReader) however.
> I can use a SpanQuery with an IndexSearcher as per susual but that leaves me
> back where I started.  Any thoughts?
>
> Also,  I will need to sort these results by date so that the most recent,
> say 5 are returned...
>
> thanks again,
>
> C>T>
>
> On Thu, Sep 24, 2009 at 3:22 PM, Chris Hostetter
> <hossman_lucene@fucit.org>wrote:
>
>   
>> : But alas, I cannot seem to get access to any TermPositions from my above
>> : BooleanQuery.
>>
>> I would suggest refactoring your "date" restriction into a Filter (there's
>> fairly easy to use Filter that wraps a Query) and then execute a
>> SPanTermQuery just as you describe.
>>
>>
>> -Hoss
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>
>   





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42462-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 12:19:08 2009
Return-Path: <java-user-return-42462-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36288 invoked from network); 25 Sep 2009 12:19:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 12:19:08 -0000
Received: (qmail 63782 invoked by uid 500); 25 Sep 2009 12:19:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63709 invoked by uid 500); 25 Sep 2009 12:19:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63699 invoked by uid 99); 25 Sep 2009 12:19:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 12:19:05 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.202] (HELO homiemail-a11.g.dreamhost.com) (208.97.132.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 12:18:55 +0000
Received: from [10.0.0.77] (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
	by homiemail-a11.g.dreamhost.com (Postfix) with ESMTPA id A2A1219407D
	for <java-user@lucene.apache.org>; Fri, 25 Sep 2009 05:18:34 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii; format=flowed; delsp=yes
Mime-Version: 1.0 (Apple Message framework v1076)
Subject: Re: Getting Payload data from BooleanQuery results
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <6f287d1b0909241451k6cdaa24dq74a4ca63840d8df8@mail.gmail.com>
Date: Fri, 25 Sep 2009 08:18:33 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <E671F4F4-3A85-4268-82D5-027EF4073BB9@apache.org>
References: <6f287d1b0909240949q330d0fa8t1b7a575a91a8abb2@mail.gmail.com> <Pine.LNX.4.64.0909241221150.28775@radix.cryptio.net> <6f287d1b0909241451k6cdaa24dq74a4ca63840d8df8@mail.gmail.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1076)
X-Virus-Checked: Checked by ClamAV on apache.org

Yeah, it probably makes sense to add getSpans(IR, Filter)

On Sep 24, 2009, at 5:51 PM, Christopher Tignor wrote:

> thanks for the tip.
>
> I don't see a way to integrate the QueryWrapperFilter (or any  
> Filter) into
> SpanTermQuery.getSpans(indexReader) however.
> I can use a SpanQuery with an IndexSearcher as per susual but that  
> leaves me
> back where I started.  Any thoughts?
>
> Also,  I will need to sort these results by date so that the most  
> recent,
> say 5 are returned...
>
> thanks again,
>
> C>T>
>
> On Thu, Sep 24, 2009 at 3:22 PM, Chris Hostetter
> <hossman_lucene@fucit.org>wrote:
>
>>
>> : But alas, I cannot seem to get access to any TermPositions from  
>> my above
>> : BooleanQuery.
>>
>> I would suggest refactoring your "date" restriction into a Filter  
>> (there's
>> fairly easy to use Filter that wraps a Query) and then execute a
>> SPanTermQuery just as you describe.
>>
>>
>> -Hoss
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> -- 
> TH!NKMAP
>
> Christopher Tignor | Senior Software Architect
> 155 Spring Street NY, NY 10012
> p.212-285-8600 x385 f.212-285-8999

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem (Lucene/Solr/Nutch/Mahout/Tika/Droids)  
using Solr/Lucene:
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42463-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 16:08:48 2009
Return-Path: <java-user-return-42463-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32242 invoked from network); 25 Sep 2009 16:08:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 16:08:48 -0000
Received: (qmail 16425 invoked by uid 500); 25 Sep 2009 16:08:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16281 invoked by uid 500); 25 Sep 2009 16:08:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16187 invoked by uid 99); 25 Sep 2009 16:08:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 16:08:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 16:08:31 +0000
Received: by fg-out-1718.google.com with SMTP id 16so905517fgg.5
        for <multiple recipients>; Fri, 25 Sep 2009 09:08:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:reply-to
         :organization:user-agent:mime-version:to:subject:x-enigmail-version
         :content-type:content-transfer-encoding;
        bh=cGvSYNLYJ5BoYCCYtgXkCWo8/7VqMvkXqKmAwzRQPAs=;
        b=wqTFR9yZxJTEArY/HwqQb216ZDKt4YAGDXM1bvdAnSrzAnpMBRCkHD50e7YSW54UiN
         w77r6kI3HTqDvlkBqlOgNgSeOstg69wBAqO/N9ZfllckE+V08enoyb1NFMk9G4QRngHF
         /n5DpGdLDhpAykn3Y2Y01Q5hYEaDflJnVgDDI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:reply-to:organization:user-agent:mime-version
         :to:subject:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=MyAk3hjMrJmPWxp3tyaQzVo+FQVZ8Is2w/rNEH4oFJRLvbFeZM7KJtyDtLqwuhbcyj
         7s8epa2CsyarEi+W00XzHzbxggUn8tGd6BqqJXh6g0d2Db8+LO/tDkEUghEwbfNLHxEH
         IlB014luMrocQl2OhtlK3ZIsmWcxiPFhh0j7Q=
Received: by 10.86.214.34 with SMTP id m34mr1153893fgg.6.1253894891681;
        Fri, 25 Sep 2009 09:08:11 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 3sm72146fge.23.2009.09.25.09.08.09
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 25 Sep 2009 09:08:10 -0700 (PDT)
Message-ID: <4ABCEAE9.4010407@apache.org>
Date: Fri, 25 Sep 2009 12:08:09 -0400
From: Mark Miller <markrmiller@gmail.com>
Reply-To: markrmiller@apache.org
Organization: Apache
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: general@lucene.apache.org, 
 "java-dev@lucene.apache.org" <java-dev@lucene.apache.org>,
 java-user@lucene.apache.org, announce@apache.org
Subject: The Release of Lucene 2.9
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Hello Lucene users,

On behalf of the Lucene dev community (a growing community far larger
than just the committers) I would like to announce the release of
Lucene 2.9.

While we generally try and maintain full backwards compatibility
between major versions, Lucene 2.9 has a variety of breaks that are
spelled out in the 'Changes in backwards compatibility policy' section
of CHANGES.txt.

We recommend that you recompile your application with Lucene 2.9
rather than attempting to drop it in. This will alert you to any
issues you may have to fix if you are affected by one of the backward
compatibility breaks. As always, its a really good idea to thoroughly
read CHANGES.txt before upgrading.

Lucene 2.9 comes with a bevy of new features, including:

  * Per segment searching and caching (can lead to much faster reopen
    among other things)

  * Near real-time search capabilities added to IndexWriter

  * New Query types

  * Smarter, more scalable multi-term queries (wildcard, range, etc)

  * A freshly optimized Collector/Scorer API

  * Improved Unicode support and the addition of Collation contrib

  * A new Attribute based TokenStream API

  * A new QueryParser framework in contrib with a core QueryParser
    replacement impl included.

  * Scoring is now optional when sorting by Field, or using a custom
    Collector, gaining sizable performance when scores are not
    required.

  * New analyzers (PersianAnalyzer, ArabicAnalyzer,
    SmartChineseAnalyzer)

  * New fast-vector-highlighter for large documents

  * Lucene now includes high-performance handling of numeric fields.
    Such fields are indexed with a trie structure, enabling simple to
    use and much faster numeric range searching without having to
    externally pre-process numeric values into textual values.

  ---

And many, many more features, bug fixes, optimizations, and various
improvements. You can find the full list of changes here:

http://lucene.apache.org/java/2_9_0/changes/Changes.html


Many changes have also occurred in Lucene's Contrib area:

http://lucene.apache.org/java/2_9_0/changes/Contrib-Changes.html


Binary and source distributions are available at
http://www.apache.org/dyn/closer.cgi/lucene/java/

Lucene artifacts are also available in the Maven2 repository at
http://repo1.maven.org/maven2/org/apache/lucene/

The Next Release:

The next release will be Lucene 3.0. This should come along shortly,
and will
remove all of the deprecated code in Lucene 2.9. Lucene 3.0 will also
be the
first release to move from Java 1.4 to Java 1.5 as a requirement.


Thanks,

Mark Miller
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iQIcBAEBCgAGBQJKvOroAAoJEBMFmEzrAZn4ZPQP/jJQYUuaaZt3uhAeZ2zp7X/W
0mNtesKgGbuN3NJ1cQHWgd+JfpBMOBRmHY60VNsPLuhO1P6et0P8zdv0raxFKcgN
jljNDLRfpytaGU5/M+owA9Kfg6te3FiaG9gsTte9WL/ZznGnFUQPHm0LtqhwuZvA
kLPepRZvBwLzhI4DclpMl+qudv/MaF2TZpwY8+0s12/mjdQbwjdm3+qPaLG27Hfo
ls/WuDbZimvrmR69KXduDSasLGupgEiTdnXL+b6hLVC+KLbB2XmgqlLYPmfhm/eI
RV70aXoc3cyRSyIaxz+JbMyNNBni3fMdVb7eZ5j6E9CLP4FnthEkewRCUu8Ukzw6
99ypi4TUdWO3MkbeMeXzyyM0Fsgzneghhkzji+x6LRyWJ18gLHtrjbuLWKzlXOTg
AtbMKx8ovzdg8gR5ZHzY8uwKSDr7FgxaJgw0nQQTK5tzRx0/pgOWJ58fhOYQVuZA
srER41xlqy3wDZ0sxdBpy99uAci1vbrwpCYYGNxhPFP1NohLKnByvRyw4jdOBSfO
vW30gjzyMraDPjrHX+2yyT4cZ6Rx2nChL50aLkjx3HgIY7bBIx8Sh5Rzkyxr5Xxa
7r3yjR4dtyrfEqh6DCk6qaOzFs20K9SA5HeKIX3WA5lzN1gynyLEUhG9T6r+4CQO
WqfDiGlv4r4y6+krVmRQ
=U1D6
-----END PGP SIGNATURE-----


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42464-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 17:12:33 2009
Return-Path: <java-user-return-42464-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50960 invoked from network); 25 Sep 2009 17:12:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 17:12:33 -0000
Received: (qmail 52217 invoked by uid 500); 25 Sep 2009 17:12:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52161 invoked by uid 500); 25 Sep 2009 17:12:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52151 invoked by uid 99); 25 Sep 2009 17:12:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:12:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of abgrilo@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:12:21 +0000
Received: by fxm2 with SMTP id 2so2445890fxm.28
        for <java-user@lucene.apache.org>; Fri, 25 Sep 2009 10:12:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=aeDKMzrDEI/T674EKLkDyjzm0PL4lU655VFo9vLxLg0=;
        b=ltuwycp5Rwmh6cCzIMFKAnk9/bSF1kA6rQ9ESvkDisuydXgDOhGNd1Qv/t6veA/e6O
         YiVOyeSdE44vhjatVX3H6UBucnOMNAdku+IydZoOdRyQos2Bd2/2zfPlgE9GWFdi+eUI
         kJ3bCVHgCVbU/hGB/jL4lRF/b821Xt+B1uGio=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=i+qo2wTVzor6EWtf1X9ouPbusddyLsCB91R19eWmsK1db7nvMarpYQefjt093QGhmE
         G4LNGo6xF1Yh5zDYS0m4RXiOVWEYSrXaNdzU8ZM6xHclj5jM2C2xq2bGoxR1obFrRQ0L
         pWi8QhuXRpeCmk45S5Gjfd1ccHBwNS/6S82JY=
MIME-Version: 1.0
Received: by 10.204.156.18 with SMTP id u18mr316972bkw.102.1253898719471; Fri, 
	25 Sep 2009 10:11:59 -0700 (PDT)
Date: Fri, 25 Sep 2009 14:11:59 -0300
Message-ID: <14f35510909251011u5f6a036w5323f34f32c6a292@mail.gmail.com>
Subject: Search with whitespaces
From: Alex Bredariol Grilo <abgrilo@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015175cabdec2286b04746a0b21
X-Virus-Checked: Checked by ClamAV on apache.org

--0015175cabdec2286b04746a0b21
Content-Type: text/plain; charset=ISO-8859-1

Hi,
I'm new to Lucene and I'm trying to do some stuff with Lucene but I have
some problems.

I have some documents, in which some contain the word notebook written
separated,  e.g. "some dummy words note book other dummy words". And I'd
like that when I search notebook, these documents could be found and I'd
like to do it for a general case, like trying to search the words joining
the word before or after.

How could I do that? Is there an analyzer which tokenize like that?

Thank you


Alex

--0015175cabdec2286b04746a0b21--

From java-user-return-42465-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 17:34:29 2009
Return-Path: <java-user-return-42465-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63964 invoked from network); 25 Sep 2009 17:34:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 17:34:29 -0000
Received: (qmail 98054 invoked by uid 500); 25 Sep 2009 17:34:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97984 invoked by uid 500); 25 Sep 2009 17:34:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97974 invoked by uid 99); 25 Sep 2009 17:34:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:34:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [139.56.8.26] (HELO mail-fw.broadvision.com) (139.56.8.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:34:17 +0000
X-ASG-Debug-ID: 1253900035-6c1701640000-H1Y1KX
X-Barracuda-URL: http://mail-fw.broadvision.com:8000/cgi-bin/mark.cgi
Received: from RW-EX2003.BROADVISION.COM (localhost [127.0.0.1])
	by mail-fw.broadvision.com (Spam Firewall) with ESMTP id 963C08E14B
	for <java-user@lucene.apache.org>; Fri, 25 Sep 2009 10:33:55 -0700 (PDT)
Received: from RW-EX2003.BROADVISION.COM (rw-ex2003.broadvision.com [10.10.160.33]) by mail-fw.broadvision.com with ESMTP id 8Io6iEYJE8sUvZBp for <java-user@lucene.apache.org>; Fri, 25 Sep 2009 10:33:55 -0700 (PDT)
X-ASG-Whitelist: Client
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: RE: Search with whitespaces
Subject: RE: Search with whitespaces
Date: Fri, 25 Sep 2009 10:33:55 -0700
Message-ID: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151FE6B@rw-ex2003.BROADVISION.COM>
In-Reply-To: <14f35510909251011u5f6a036w5323f34f32c6a292@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Search with whitespaces
Thread-Index: Aco+A19DMmdW3IqaQ4qOCDxYSe8iBQAArEKQ
From: "Zhang, Lisheng" <Lisheng.Zhang@BroadVision.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: rw-ex2003.broadvision.com[10.10.160.33]
X-Barracuda-Start-Time: 1253900035
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at broadvision.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Simplest way is to add one condition (assuming field is f1):

f1:notebook f1:"note book"

which means (notebook OR "note book"), 2nd condition is phrase
search.

Best regards, Lisheng

-----Original Message-----
From: Alex Bredariol Grilo [mailto:abgrilo@gmail.com]
Sent: Friday, September 25, 2009 10:12 AM
To: java-user@lucene.apache.org
Subject: Search with whitespaces


Hi,
I'm new to Lucene and I'm trying to do some stuff with Lucene but I have
some problems.

I have some documents, in which some contain the word notebook written
separated,  e.g. "some dummy words note book other dummy words". And I'd
like that when I search notebook, these documents could be found and I'd
like to do it for a general case, like trying to search the words =
joining
the word before or after.

How could I do that? Is there an analyzer which tokenize like that?

Thank you


Alex

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42466-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 17:38:42 2009
Return-Path: <java-user-return-42466-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65047 invoked from network); 25 Sep 2009 17:38:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 17:38:41 -0000
Received: (qmail 6095 invoked by uid 500); 25 Sep 2009 17:38:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6032 invoked by uid 500); 25 Sep 2009 17:38:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6022 invoked by uid 99); 25 Sep 2009 17:38:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:38:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of abgrilo@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:38:31 +0000
Received: by bwz10 with SMTP id 10so2337279bwz.5
        for <java-user@lucene.apache.org>; Fri, 25 Sep 2009 10:38:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=y5/81j90l6oUZaDLAoH1arE1T2oeIUz6dj0XvkayO2g=;
        b=QerYov018Igo8XlP81gsfZaNN11Zj2/KmocfW1p9bzceLMWwkTdgOyaW+ZKZTjH0fc
         ia2umoZWPlPTqYzD2sRIbhBZr0bhzn2MFLY2L1PlHcyXuVCE+axmu7GmBQjMa9UmWtBC
         ZbM9NxNm3wkAL8Xf3gW3XELxk6GtCigKZAiZs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=V5fUjzi3gmLLwTpx2gpnUlSTQF+EkcRsxG9S/GFm/SSmrxmlYtAu0afNSY8PJvedhS
         lXw9Ms3FkDAYsbAG0GTlQfwnMVviuvvNeNg2+kjyOv/BMml/coGNFHYr0GR5M7yXVa8v
         R4Amt2SCokv5rk2628EdLkvz0++wP6RyqShaU=
MIME-Version: 1.0
Received: by 10.204.160.65 with SMTP id m1mr320007bkx.193.1253900289149; Fri, 
	25 Sep 2009 10:38:09 -0700 (PDT)
In-Reply-To: <ED081AC9AEEE0248BBCCDE9989AAE3FC0151FE6B@rw-ex2003.BROADVISION.COM>
References: <14f35510909251011u5f6a036w5323f34f32c6a292@mail.gmail.com>
	 <ED081AC9AEEE0248BBCCDE9989AAE3FC0151FE6B@rw-ex2003.BROADVISION.COM>
Date: Fri, 25 Sep 2009 14:38:09 -0300
Message-ID: <14f35510909251038t114626a0red4f4c49606ada22@mail.gmail.com>
Subject: Re: Search with whitespaces
From: Alex Bredariol Grilo <abgrilo@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015175cd1325189f204746a691c
X-Virus-Checked: Checked by ClamAV on apache.org

--0015175cd1325189f204746a691c
Content-Type: text/plain; charset=ISO-8859-1

Yes, but I'd like to do it in a generic way. I wouldn't like to search if my
query contains the word "notebook".
Thank you

On Fri, Sep 25, 2009 at 2:33 PM, Zhang, Lisheng <
Lisheng.Zhang@broadvision.com> wrote:

> Hi,
>
> Simplest way is to add one condition (assuming field is f1):
>
> f1:notebook f1:"note book"
>
> which means (notebook OR "note book"), 2nd condition is phrase
> search.
>
> Best regards, Lisheng
>
> -----Original Message-----
> From: Alex Bredariol Grilo [mailto:abgrilo@gmail.com]
> Sent: Friday, September 25, 2009 10:12 AM
> To: java-user@lucene.apache.org
> Subject: Search with whitespaces
>
>
> Hi,
> I'm new to Lucene and I'm trying to do some stuff with Lucene but I have
> some problems.
>
> I have some documents, in which some contain the word notebook written
> separated,  e.g. "some dummy words note book other dummy words". And I'd
> like that when I search notebook, these documents could be found and I'd
> like to do it for a general case, like trying to search the words joining
> the word before or after.
>
> How could I do that? Is there an analyzer which tokenize like that?
>
> Thank you
>
>
> Alex
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Alex

--0015175cd1325189f204746a691c--

From java-user-return-42467-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 17:41:41 2009
Return-Path: <java-user-return-42467-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66179 invoked from network); 25 Sep 2009 17:41:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 17:41:41 -0000
Received: (qmail 9923 invoked by uid 500); 25 Sep 2009 17:41:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9854 invoked by uid 500); 25 Sep 2009 17:41:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9844 invoked by uid 99); 25 Sep 2009 17:41:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:41:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of klaus.teller@gmx.net designates 213.165.64.20 as permitted sender)
Received: from [213.165.64.20] (HELO mail.gmx.net) (213.165.64.20)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 25 Sep 2009 17:41:29 +0000
Received: (qmail 12629 invoked by uid 0); 25 Sep 2009 17:41:07 -0000
Received: from 69.159.202.128 by www128.gmx.net with HTTP;
 Fri, 25 Sep 2009 19:41:06 +0200 (CEST)
Content-Type: text/plain; charset="us-ascii"
Date: Fri, 25 Sep 2009 19:41:07 +0200
From: "Klaus Teller" <klaus.teller@gmx.net>
Message-ID: <20090925174107.301340@gmx.net>
MIME-Version: 1.0
Subject: Concurrent Indexing and Searching
To: java-user@lucene.apache.org
X-Authenticated: #20247638
X-Flags: 0001
X-Mailer: WWW-Mail 6100 (Global Message Exchange)
X-Priority: 3
X-Provags-ID: V01U2FsdGVkX18SwrlFuV0Sosw6VIEshTdj9xTJqR1Xp6hWW/JpCG
 Kjlm9psy5P/zENcgwwQSBT0Yxi+UZtU6CSyw== 
Content-Transfer-Encoding: 7bit
X-GMX-UID: 1WTVB40UbHIhfyTMDTU0sgsiJihyapAB
X-FuHaFi: 0.72
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I've read that it is possible to update the index while another thread has a reader open. 

Now let's say the reader is trying to reopen the index (using its reopen method) and at the very same time, the write its committing its 500MB changes to the index. My question is, what happens in this situation? What index does the reader end up having if it tries to open the index while the writer is modifying it?

Any feedback will be much appreciated,

Klaus.
-- 
Jetzt kostenlos herunterladen: Internet Explorer 8 und Mozilla Firefox 3.5 -
sicherer, schneller und einfacher! http://portal.gmx.net/de/go/chbrowser

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42468-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 17:42:53 2009
Return-Path: <java-user-return-42468-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66491 invoked from network); 25 Sep 2009 17:42:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 17:42:53 -0000
Received: (qmail 12304 invoked by uid 500); 25 Sep 2009 17:42:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12242 invoked by uid 500); 25 Sep 2009 17:42:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12232 invoked by uid 99); 25 Sep 2009 17:42:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:42:50 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.132.250 as permitted sender)
Received: from [209.85.132.250] (HELO an-out-0708.google.com) (209.85.132.250)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 17:42:42 +0000
Received: by an-out-0708.google.com with SMTP id b2so1006484ana.5
        for <java-user@lucene.apache.org>; Fri, 25 Sep 2009 10:42:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=cJ1NiawsWgPgBA5oY7J1XVuY7lbNQ/J0pO2cz5mUULo=;
        b=SBo1uLEIS9KFsXFg/T8KLTeyVwE3xRqRdlqNqDOX3PZ0HTfqwIIVjmLea7tIV8tVdT
         Q1260478KgHQ54MS8oVKFrL0KUhHVUGFEvCdjLtJjzAMLY2ldc8thoApdgtkX2hSFG/s
         HVLqphfrwvRQHd0qteBoEr9fctqIRJrDzq3TU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=MGeiGsDgPPY0S8ycSJwuH7zyKxWqS8zbsuK9SrW0UzhEok63yPgRAbzkNI+MohS10Y
         i0heqbIerhSDtFHc065o+gjgQTaRu37EyDiWn1iNvnp7pux/PHrLw9Lu0PI8ZG5v6YHz
         pqooiJHAiDuBqPVjsn0xtNkLGZlx7VX/N3GmQ=
MIME-Version: 1.0
Received: by 10.100.24.37 with SMTP id 37mr510704anx.45.1253900542071; Fri, 25 
	Sep 2009 10:42:22 -0700 (PDT)
In-Reply-To: <14f35510909251038t114626a0red4f4c49606ada22@mail.gmail.com>
References: <14f35510909251011u5f6a036w5323f34f32c6a292@mail.gmail.com>
	 <ED081AC9AEEE0248BBCCDE9989AAE3FC0151FE6B@rw-ex2003.BROADVISION.COM>
	 <14f35510909251038t114626a0red4f4c49606ada22@mail.gmail.com>
Date: Fri, 25 Sep 2009 13:42:22 -0400
Message-ID: <8f0ad1f30909251042w233220f6md6705ffd6715cc6d@mail.gmail.com>
Subject: Re: Search with whitespaces
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e646916a64d60d04746a7889
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e646916a64d60d04746a7889
Content-Type: text/plain; charset=UTF-8

i might suggest the shingle package in lucene's contrib for this case.

> like to do it for a general case, like trying to search the words joining
> > the word before or after.
> >
> > How could I do that? Is there an analyzer which tokenize like that?
> >
> > Thank you
> >
> >
> > Alex
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> --
> Alex
>



-- 
Robert Muir
rcmuir@gmail.com

--0016e646916a64d60d04746a7889--

From java-user-return-42469-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 18:13:26 2009
Return-Path: <java-user-return-42469-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76611 invoked from network); 25 Sep 2009 18:13:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 18:13:26 -0000
Received: (qmail 68663 invoked by uid 500); 25 Sep 2009 18:13:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68603 invoked by uid 500); 25 Sep 2009 18:13:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68593 invoked by uid 99); 25 Sep 2009 18:13:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 18:13:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.221.195 as permitted sender)
Received: from [209.85.221.195] (HELO mail-qy0-f195.google.com) (209.85.221.195)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 18:13:14 +0000
Received: by qyk33 with SMTP id 33so2468622qyk.29
        for <java-user@lucene.apache.org>; Fri, 25 Sep 2009 11:12:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=Tu2BVU0mf+0Dhmr6B3nBpAYVKQwmvIKAcM3uhrNFv48=;
        b=mJibE4J38uVpbAon4zDY7fxn4I7BC4ixkcDifQ2tg7w0dcKsOS0zBdWw8U7ZVKFItp
         /fgE7B9sypTIc49nPQ6IuU4Arh4Zb1DhCSWFlexTbb9inYrWt5vUluWM7FlSF05S0lvS
         kPqsUMXqdtzPEh8oXKp+Z4v64XuKRUY0q7Tno=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=KOmoVpUi4mXdnnkFqx8ASoLNgY5XwCyl9woufTB6jcPEHU3kxMmPtnibBoEdfx0lx9
         qAuqrXZklG4hQmj87WstDuV3r4ICaDByU57D0ucJYfStcRQPI/xT8JbAwD2Rx+gEqbmC
         dXqoUQi/VwX/5I9ai8Pzvaq0CuEyv2kMXJTpI=
MIME-Version: 1.0
Received: by 10.224.117.203 with SMTP id s11mr536953qaq.332.1253902373138; 
	Fri, 25 Sep 2009 11:12:53 -0700 (PDT)
In-Reply-To: <20090925174107.301340@gmx.net>
References: <20090925174107.301340@gmx.net>
Date: Fri, 25 Sep 2009 11:12:52 -0700
Message-ID: <85d3c3b60909251112h728c96cejb15e781146038dde@mail.gmail.com>
Subject: Re: Concurrent Indexing and Searching
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

It depends on whether or not the commit completes before the
reopen. Lucene 2.9 adds an IndexWriter.getReader method that
will always return with the latest modifications to your index.

So if you're adding many documents, you can at anytime, call
IW.getReader and you will be able to search the changes made to
that point. This is not different than reopen except getReader
does not require a commit.

On Fri, Sep 25, 2009 at 10:41 AM, Klaus Teller <klaus.teller@gmx.net> wrote=
:
> Hi,
>
> I've read that it is possible to update the index while another thread ha=
s a reader open.
>
> Now let's say the reader is trying to reopen the index (using its reopen =
method) and at the very same time, the write its committing its 500MB chang=
es to the index. My question is, what happens in this situation? What index=
 does the reader end up having if it tries to open the index while the writ=
er is modifying it?
>
> Any feedback will be much appreciated,
>
> Klaus.
> --
> Jetzt kostenlos herunterladen: Internet Explorer 8 und Mozilla Firefox 3.=
5 -
> sicherer, schneller und einfacher! http://portal.gmx.net/de/go/chbrowser
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42470-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Sep 25 18:18:09 2009
Return-Path: <java-user-return-42470-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77648 invoked from network); 25 Sep 2009 18:18:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Sep 2009 18:18:08 -0000
Received: (qmail 77369 invoked by uid 500); 25 Sep 2009 18:18:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77298 invoked by uid 500); 25 Sep 2009 18:18:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77288 invoked by uid 99); 25 Sep 2009 18:18:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 18:18:06 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jake.mannix@gmail.com designates 209.85.217.226 as permitted sender)
Received: from [209.85.217.226] (HELO mail-gx0-f226.google.com) (209.85.217.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 25 Sep 2009 18:17:56 +0000
Received: by gxk26 with SMTP id 26so945666gxk.11
        for <java-user@lucene.apache.org>; Fri, 25 Sep 2009 11:17:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Wq/Oan3VBCqyM0s8vSzr6+0+xgTEeSSy0Lv4wyIxSKs=;
        b=GqLMFtYhTSMu8EWfp4fW8np9/qfrgTwKe5M5hU0p4IBXw8VyxNeLh1pH7ColcIhRnV
         gev+7idZtXFyX51ZSXQhiYb51DyYnZgE4j+cxkHSdkMVv6L8BpcylD4jPLl7FAWC80mj
         NooGfwSSIu99KjaUl7OQtYwkf0kmWBY3AC8Rc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=s/n/gSZrMMhogMURgbss+ityt39FxG4f03skJ5Zl40lSujYpkBGTjrJdzODs8ZyFEe
         ZixwjJhsld0gXliZvUZmwP/6IOI5wvTsggJ8DAzehk15Skgm4qTLzLEZsgNvoO/hmVzz
         Qcgt5i16QNauWL2hqyRqFASLaPTm7hiHQZWns=
MIME-Version: 1.0
Received: by 10.90.121.17 with SMTP id t17mr899131agc.57.1253902654792; Fri, 
	25 Sep 2009 11:17:34 -0700 (PDT)
In-Reply-To: <20090925174107.301340@gmx.net>
References: <20090925174107.301340@gmx.net>
Date: Fri, 25 Sep 2009 11:17:34 -0700
Message-ID: <4b124c310909251117tbaae255sfcd604b6d9e96c4d@mail.gmail.com>
Subject: Re: Concurrent Indexing and Searching
From: Jake Mannix <jake.mannix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163628403452660804746af6b7
X-Virus-Checked: Checked by ClamAV on apache.org

--00163628403452660804746af6b7
Content-Type: text/plain; charset=ISO-8859-1

Hi Klaus,

  If you've really still got 500MB of changes to your index since the last
time you commit()'ed, then the call to commit() will be costly and take a
while to complete.  If in another thread, you reopen() an IndexReader
pointing to that index, it will only see changes since the most recently
*completed* commit.  Just as it can be costly to commit() after too small of
a batch size (making many small segments and requiring frequent merges),
making too infrequent commit()'s is costly from the standpoint of searcher
visibility of changes.

  If you want faster turnaround from addDocument() to query visibility,
using the Lucene 2.9 IndexWriter.getReader() method can speed things up in
this regard, but this method hasn't been tested under heavy (rapid) indexing
and query loads as of yet.  Another alternative for realtime searching is to
use Zoie (Apache licensed realtime search built on top of lucene:
http://zoie.googlecode.com ), which we use at LinkedIn for immediate
searcher visibility to documents added under high throughput and heavy query
load.

  -jake

On Fri, Sep 25, 2009 at 10:41 AM, Klaus Teller <klaus.teller@gmx.net> wrote:

> Hi,
>
> I've read that it is possible to update the index while another thread has
> a reader open.
>
> Now let's say the reader is trying to reopen the index (using its reopen
> method) and at the very same time, the write its committing its 500MB
> changes to the index. My question is, what happens in this situation? What
> index does the reader end up having if it tries to open the index while the
> writer is modifying it?
>
> Any feedback will be much appreciated,
>
> Klaus.
> --
> Jetzt kostenlos herunterladen: Internet Explorer 8 und Mozilla Firefox 3.5
> -
> sicherer, schneller und einfacher! http://portal.gmx.net/de/go/chbrowser
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00163628403452660804746af6b7--

From java-user-return-42471-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 07:37:22 2009
Return-Path: <java-user-return-42471-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52805 invoked from network); 26 Sep 2009 07:37:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 07:37:22 -0000
Received: (qmail 90282 invoked by uid 500); 26 Sep 2009 07:37:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90206 invoked by uid 500); 26 Sep 2009 07:37:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90196 invoked by uid 99); 26 Sep 2009 07:37:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 07:37:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [195.186.19.64] (HELO mail18.bluewin.ch) (195.186.19.64)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 07:37:09 +0000
X-FXIT-IP: IPv4[85.2.146.8] Epoch[1253950608]
Received: from [85.2.146.8] ([85.2.146.8:24076] helo=[192.168.1.35])
	by mail18.bluewin.ch (envelope-from <mat.hess@bluewin.ch>)
	(ecelerity 2.2.2.41 r(31179/31189)) with ESMTP
	id 34/B6-11120-F84CDBA4; Sat, 26 Sep 2009 07:36:48 +0000
Message-ID: <4ABDC477.2000409@bluewin.ch>
Date: Sat, 26 Sep 2009 09:36:23 +0200
From: Matthias Hess <mat.hess@bluewin.ch>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Storing a Lucene Index on a SAN Storage: good idea?
Content-Type: text/plain; charset=ISO-8859-15; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello

We are currently implementing our first Lucene project. We are building 
an application which will index public Records on the internet, about 
200'000 documents, each document is about 150 k in size. Our customer 
would like to store the Lucene index on a SAN disk.
We recommended the use of high speed local disks, but our customer would 
prefer SAN for their better managability.

Does anybody have good or bad experiences with SAN disks?
Are there parameters like #read operations, data read rate or whatever, 
which must be met to have a performance which rivals a good "local disk"?

Thanks for sharing your ideas and opinions!

Kind Regards
Matthias Hess

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42472-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 09:22:22 2009
Return-Path: <java-user-return-42472-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63137 invoked from network); 26 Sep 2009 09:22:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 09:22:22 -0000
Received: (qmail 21795 invoked by uid 500); 26 Sep 2009 09:22:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21709 invoked by uid 500); 26 Sep 2009 09:22:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21699 invoked by uid 99); 26 Sep 2009 09:22:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 09:22:19 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.82.104.178] (HELO web24705.mail.ird.yahoo.com) (212.82.104.178)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 26 Sep 2009 09:22:10 +0000
Received: (qmail 20694 invoked by uid 60001); 26 Sep 2009 09:21:47 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1253956907; bh=L+oYRLPP+rusXoXzKm8qdE6G0wbxkxgxuOLIAlOnMUE=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=HwjalfYy9K0+Xy0qCajeqjsVpxV7en5ub3ZduauWd+kXEfG3nCdTWvwg6qjmOkVwYIKqv8DKl53lhAN2K2BTzR14m3Ciw/Eqi3rAYbR653t03dYnWC3+bni8cCqDs/zDmFR2RDuMDlALAZOfbv40DZZMrjnOBwMG3DQQFf22Y1k=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=VUfLnrty8vXmh4wFPy9rMGW9d3sEuzAv7xubNhmXj3gEHNqUtK5u3W4QgEarRtzAq/sLYp40QY5rzJF4kjHpA++uIt63N7lXlv6zEJJUwJCxjQ+9D5vGKVH7lFgeJKVvvypr96h/zpVW3xSpeW3CpX/bysVZ9JTsAm0KH3hi6Vg=;
Message-ID: <530630.20671.qm@web24705.mail.ird.yahoo.com>
X-YMail-OSG: OSE8mzkVM1mH3eaUr7Z3AfBBdhFkHKMmHB.ZIFu5EJsWySxb5rbGKZGmTZq0ohdBJaujFVX1dXwMLFG0uSlkM90Wd7US46LrpnThCZW1Guxp5fJ7oHqE0IdIulQxVH9nwDFv9Wh.tfnbJWXxtb0w20ADW_SCPTm8nrKzQLcKJTaOPK4fM2hCbpAU8VPbjYtkG2gilw1DdBMFxnKpUxFWOunl83qEUS4Vix0yxvgbFS1o3L1hJ9ht8mp4aRg4R9cTPcUHQnfiHnhhLVQ8t2ysU9hZkMwORh.qWg36HLofL6.573UrBd0Rcz54OWOQDmWE39IKcV8-
Received: from [87.248.121.165] by web24705.mail.ird.yahoo.com via HTTP; Sat, 26 Sep 2009 09:21:47 GMT
X-Mailer: YahooMailWebService/0.7.347.3
Date: Sat, 26 Sep 2009 09:21:47 +0000 (GMT)
From: Mark Harwood <markharw00d@yahoo.co.uk>
Subject: Re: Storing a Lucene Index on a SAN Storage: good idea?
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I have a client with 700 million doc index running on a SAN. The performanc=
e is v good but this obviously depends on your choice of  SAN config. In th=
is environment I have multiple search servers happily hitting the same phys=
ical lucene index on the SAN. The servers negotiate with each other via zoo=
keeper to elect a server with write responsibilities.=0A=0AOne advantage of=
 this approach over local disks is that index replication is relatively eas=
y (replication is effectively being handled by SAN's internal striping mech=
anisms). Index replica synching as seen in Solr relies on careful shuffling=
 of (hopefully) small segments of lucene indexes between servers across the=
 network with mechanisms for dealing with server/network failures. Alternat=
ive local index synching approaches rely on replica servers independently b=
uilding their own indexes from source data.=0ABoth of these replication str=
ategies are arguably more fallible than a hardware-based striping mechanism=
 in a sophisticated SAN.  =0A  =0AHowever the disadvantage with a SAN is th=
e potential for the SAN to become a bottleneck or single point of failure (=
hardware or app-level index corruption). I'm sure high-end SAN vendors can =
talk up their ability to hot deploy extra disks to boost performance if nee=
ded and sophisticated failover mechanisms but these get expensive. =0A=0AIf=
 your client has invested significantly in a SAN and is pushing you to use =
it my experience is that this can work but benchmarking vs local disk is ke=
y.  =0A=0ACheers=0AMark=0A=0A=0AOn 26 Sep 2009, at 08:36, Matthias Hess <ma=
t.hess@bluewin.ch> wrote:=0A=0AHello=0A=0AWe are currently implementing our=
 first Lucene project. We are building an application which will index publ=
ic Records on the internet, about 200'000 documents, each document is about=
 150 k in size. Our customer would like to store the Lucene index on a SAN =
disk.=0AWe recommended the use of high speed local disks, but our customer =
would prefer SAN for their better managability.=0A=0ADoes anybody have good=
 or bad experiences with SAN disks?=0AAre there parameters like #read opera=
tions, data read rate or whatever, which must be met to have a performance =
which rivals a good "local disk"?=0A=0AThanks for sharing your ideas and op=
inions!=0A=0AKind Regards=0AMatthias Hess=0A=0A----------------------------=
-----------------------------------------=0ATo unsubscribe, e-mail: java-us=
er-unsubscribe@lucene.apache.org=0AFor additional commands, e-mail: java-us=
er-help@lucene.apache.org=0A=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42473-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 11:11:34 2009
Return-Path: <java-user-return-42473-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75613 invoked from network); 26 Sep 2009 11:11:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 11:11:34 -0000
Received: (qmail 50762 invoked by uid 500); 26 Sep 2009 11:11:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50684 invoked by uid 500); 26 Sep 2009 11:11:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50674 invoked by uid 99); 26 Sep 2009 11:11:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 11:11:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of pengyu.ut@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 11:11:23 +0000
Received: by fxm2 with SMTP id 2so2831847fxm.28
        for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 04:11:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=KAoqL8gpQWZx0iEQPvGPvavlBnqbv7TylS/CGxGfHww=;
        b=d27/E601G9JibSqWeSrWWf67unIEDftwQ7asjM+SOSYiPplD36KIM01UaCHlYPNjMd
         R/s9lkHaODsDRdv0BlOv06vdW2hSTGG5Cy0BkWMeTbEFiWvYBs/6Qnpr5rHF6RQlVPWQ
         GxG2okVThcTBCNkDQJtQvslDwdJk2h6RJiYbU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=eoZlKkZR1rzUVAEoYgoE/NGdzWQuBnusV8zp6b69K/AUMarhE41HD6wo/TcvKP3h0E
         nQdQTidZAG0Njypfg+hOahEJXeZv8KUvaMYhyLM5uCuQ4oD9OgRLKBd9r1ipatWk4lfI
         kN+XQAG2AvIWpnqjoumHbcJsWb9WAyGNCIUxE=
MIME-Version: 1.0
Received: by 10.103.48.28 with SMTP id a28mr425904muk.128.1253963462560; Sat, 
	26 Sep 2009 04:11:02 -0700 (PDT)
Date: Sat, 26 Sep 2009 06:11:02 -0500
Message-ID: <366c6f340909260411y4d5360bfld1104d509bb37ae4@mail.gmail.com>
Subject: Where to download lucene-analyzers and lucene-highlighter?
From: Peng Yu <pengyu.ut@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I don't see where I can download lucene-analyzers.jar and
lucene-highlighter.jar? Can somebody show me?

Regards,
Peng

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42474-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 11:20:16 2009
Return-Path: <java-user-return-42474-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76342 invoked from network); 26 Sep 2009 11:20:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 11:20:16 -0000
Received: (qmail 54799 invoked by uid 500); 26 Sep 2009 11:20:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54716 invoked by uid 500); 26 Sep 2009 11:20:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54703 invoked by uid 99); 26 Sep 2009 11:20:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 11:20:13 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [82.132.130.150] (HELO mail.o2.co.uk) (82.132.130.150)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 11:20:04 +0000
Received: from localhost (94.195.77.205) by mail.o2.co.uk (8.0.013.3) (authenticated as joelhalbert)
        id 4AA880450561F7A1 for java-user@lucene.apache.org; Sat, 26 Sep 2009 12:19:35 +0100
Date: Sat, 26 Sep 2009 12:19:40 +0100 (BST)
From: Joel Halbert <joel@su3analytics.com>
To: java-user@lucene.apache.org
Message-ID: <9075997.621253963978969.JavaMail.joel@bohr>
In-Reply-To: <366c6f340909260411y4d5360bfld1104d509bb37ae4@mail.gmail.com>
Subject: Re: Where to download lucene-analyzers and lucene-highlighter?
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Peng - they are both within the contrib dir in your lucene package dowload e.g

lucene-2.4.0/contrib/highlighter/*.jar
lucene-2.4.0/contrib/analyzers/*.jar

----- Original Message -----
From: "Peng Yu" <pengyu.ut@gmail.com>
To: java-user@lucene.apache.org
Sent: Saturday, 26 September, 2009 12:11:02 GMT +00:00 GMT Britain, Ireland, Portugal
Subject: Where to download lucene-analyzers and lucene-highlighter?

Hi,

I don't see where I can download lucene-analyzers.jar and
lucene-highlighter.jar? Can somebody show me?

Regards,
Peng

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42475-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 12:03:05 2009
Return-Path: <java-user-return-42475-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79788 invoked from network); 26 Sep 2009 12:03:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 12:03:04 -0000
Received: (qmail 68074 invoked by uid 500); 26 Sep 2009 12:03:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67996 invoked by uid 500); 26 Sep 2009 12:03:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67986 invoked by uid 99); 26 Sep 2009 12:03:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:03:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of pengyu.ut@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:02:54 +0000
Received: by fxm2 with SMTP id 2so2846443fxm.28
        for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 05:02:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=yP8La40Zi1R3yW64IPwJIwzsvbWdtqEOia93V01Uxk0=;
        b=QDW3bt4Ky7tft8IqOQHWGhWfGHOZt9/Q7wmF3RcvrUEevmBeTv9lCFWz+BLXa9osZC
         4f3/d73b91xti8HyBU435D+9T4BrJAVX3Vwsg6Agh7OBEjyQZI58HqQgjDqpPnpeFWMG
         EtPJWMbemSqIAyg/IhtPKTwk8puPQMH02sRa8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=RWgSFj3hSCupABrbM37FigYDiqzKxMOeaBqwoCmEr0C4jPkdWPCg4DLwH39t41T2Ey
         /lgdAixocHyGHVwPqXTLrfjIk+dLyk6aA2NcYGcsMLOwIzIQWpUrEgdgYtWkivoASRLB
         NWmI9remgsIyC3u4vb3o2IRWWi4Qn4NGA28kA=
MIME-Version: 1.0
Received: by 10.102.211.35 with SMTP id j35mr454476mug.35.1253966553260; Sat, 
	26 Sep 2009 05:02:33 -0700 (PDT)
In-Reply-To: <9075997.621253963978969.JavaMail.joel@bohr>
References: <366c6f340909260411y4d5360bfld1104d509bb37ae4@mail.gmail.com>
	 <9075997.621253963978969.JavaMail.joel@bohr>
Date: Sat, 26 Sep 2009 07:02:33 -0500
Message-ID: <366c6f340909260502j5bec9069s682aa2421ef5b7d1@mail.gmail.com>
Subject: Re: Where to download lucene-analyzers and lucene-highlighter?
From: Peng Yu <pengyu.ut@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I am wondering how I should install the .jar files. I don't find an
install script. Shall I manually copy them to some directory? Which
directory should they be copied to?

Also, I have to go to each subdir in contrib to compile the .jar file

 (for f in compgen -d; do cd $d; ant; cd -; done)

Should there be a command in the distribution to make the compilation
step simple?

Regards,
Peng

On Sat, Sep 26, 2009 at 6:19 AM, Joel Halbert <joel@su3analytics.com> wrote:
> Hi Peng - they are both within the contrib dir in your lucene package dowload e.g
>
> lucene-2.4.0/contrib/highlighter/*.jar
> lucene-2.4.0/contrib/analyzers/*.jar
>
> ----- Original Message -----
> From: "Peng Yu" <pengyu.ut@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Saturday, 26 September, 2009 12:11:02 GMT +00:00 GMT Britain, Ireland, Portugal
> Subject: Where to download lucene-analyzers and lucene-highlighter?
>
> Hi,
>
> I don't see where I can download lucene-analyzers.jar and
> lucene-highlighter.jar? Can somebody show me?
>
> Regards,
> Peng
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42476-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 12:11:03 2009
Return-Path: <java-user-return-42476-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80498 invoked from network); 26 Sep 2009 12:11:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 12:11:02 -0000
Received: (qmail 72092 invoked by uid 500); 26 Sep 2009 12:11:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72010 invoked by uid 500); 26 Sep 2009 12:11:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72000 invoked by uid 99); 26 Sep 2009 12:11:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:11:00 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:10:49 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 2D30945ECC2
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:10:29 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Kw8ylpYmAPgZ for <java-user@lucene.apache.org>;
	Sat, 26 Sep 2009 14:10:19 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 0BB6345EC53
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:10:18 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <366c6f340909260411y4d5360bfld1104d509bb37ae4@mail.gmail.com> <9075997.621253963978969.JavaMail.joel@bohr> <366c6f340909260502j5bec9069s682aa2421ef5b7d1@mail.gmail.com>
Subject: RE: Where to download lucene-analyzers and lucene-highlighter?
Date: Sat, 26 Sep 2009 14:10:18 +0200
Message-ID: <AB9AA83BA4E54F7CBD2EFF7279B1749E@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <366c6f340909260502j5bec9069s682aa2421ef5b7d1@mail.gmail.com>
Thread-Index: Aco+oVT8q4xtPISiT8mB963jspx0egAAOo0A
X-Virus-Checked: Checked by ClamAV on apache.org

"Ant build-contrib" from the main directory.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Peng Yu [mailto:pengyu.ut@gmail.com]
> Sent: Saturday, September 26, 2009 2:03 PM
> To: java-user@lucene.apache.org
> Subject: Re: Where to download lucene-analyzers and lucene-highlighter?
> 
> Hi,
> 
> I am wondering how I should install the .jar files. I don't find an
> install script. Shall I manually copy them to some directory? Which
> directory should they be copied to?
> 
> Also, I have to go to each subdir in contrib to compile the .jar file
> 
>  (for f in compgen -d; do cd $d; ant; cd -; done)
> 
> Should there be a command in the distribution to make the compilation
> step simple?
> 
> Regards,
> Peng
> 
> On Sat, Sep 26, 2009 at 6:19 AM, Joel Halbert <joel@su3analytics.com>
> wrote:
> > Hi Peng - they are both within the contrib dir in your lucene package
> dowload e.g
> >
> > lucene-2.4.0/contrib/highlighter/*.jar
> > lucene-2.4.0/contrib/analyzers/*.jar
> >
> > ----- Original Message -----
> > From: "Peng Yu" <pengyu.ut@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Saturday, 26 September, 2009 12:11:02 GMT +00:00 GMT Britain,
> Ireland, Portugal
> > Subject: Where to download lucene-analyzers and lucene-highlighter?
> >
> > Hi,
> >
> > I don't see where I can download lucene-analyzers.jar and
> > lucene-highlighter.jar? Can somebody show me?
> >
> > Regards,
> > Peng
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42477-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 12:16:56 2009
Return-Path: <java-user-return-42477-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80920 invoked from network); 26 Sep 2009 12:16:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 12:16:56 -0000
Received: (qmail 74201 invoked by uid 500); 26 Sep 2009 12:16:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74109 invoked by uid 500); 26 Sep 2009 12:16:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74097 invoked by uid 99); 26 Sep 2009 12:16:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:16:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of pengyu.ut@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:16:44 +0000
Received: by fxm2 with SMTP id 2so2850659fxm.28
        for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 05:16:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=6Zh51lcOS2hmmGoBK9rviClLY3OdeA0tpuxSR9rVtDU=;
        b=egtyR+KeK5KjkItxhASyKcNNeafPa85WYCw7NGw7Xpi4LasSSaBF2qK0J9cjFeHw5g
         H860se0DbPFhF6Q3xLC3/4tF2oDfp8WSgEN/LzE9dG3+/8/mYt0VBYWDGwBJyWVqFMWH
         n/LBQnedXPXywbDFdpt55Z/GFl1SNtCdWgwQg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=ekFgMzhHsLV7T9MBnLfOShNPSxc2gXvahms5irAzeHW8B/71SZKYGUuI8sOSpeXbJb
         HvvuAC6j/N75T+j0K0m6eZxFsC9fKvcJ6aKVotOXlZCbS8VciaNCo47MnQcQHi3vEjg2
         1m+gWjMR/bRfBjm1ylryNga4lh+YzkPybVZXg=
MIME-Version: 1.0
Received: by 10.102.211.35 with SMTP id j35mr458131mug.35.1253967382753; Sat, 
	26 Sep 2009 05:16:22 -0700 (PDT)
In-Reply-To: <AB9AA83BA4E54F7CBD2EFF7279B1749E@VEGA>
References: <366c6f340909260411y4d5360bfld1104d509bb37ae4@mail.gmail.com>
	 <9075997.621253963978969.JavaMail.joel@bohr>
	 <366c6f340909260502j5bec9069s682aa2421ef5b7d1@mail.gmail.com>
	 <AB9AA83BA4E54F7CBD2EFF7279B1749E@VEGA>
Date: Sat, 26 Sep 2009 07:16:22 -0500
Message-ID: <366c6f340909260516g6a4a11ceg1aceaafbf0769cc5@mail.gmail.com>
Subject: Re: Where to download lucene-analyzers and lucene-highlighter?
From: Peng Yu <pengyu.ut@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

How to install the compiled files?

On Sat, Sep 26, 2009 at 7:10 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
> "Ant build-contrib" from the main directory.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>> -----Original Message-----
>> From: Peng Yu [mailto:pengyu.ut@gmail.com]
>> Sent: Saturday, September 26, 2009 2:03 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Where to download lucene-analyzers and lucene-highlighter?
>>
>> Hi,
>>
>> I am wondering how I should install the .jar files. I don't find an
>> install script. Shall I manually copy them to some directory? Which
>> directory should they be copied to?
>>
>> Also, I have to go to each subdir in contrib to compile the .jar file
>>
>> =A0(for f in compgen -d; do cd $d; ant; cd -; done)
>>
>> Should there be a command in the distribution to make the compilation
>> step simple?
>>
>> Regards,
>> Peng
>>
>> On Sat, Sep 26, 2009 at 6:19 AM, Joel Halbert <joel@su3analytics.com>
>> wrote:
>> > Hi Peng - they are both within the contrib dir in your lucene package
>> dowload e.g
>> >
>> > lucene-2.4.0/contrib/highlighter/*.jar
>> > lucene-2.4.0/contrib/analyzers/*.jar
>> >
>> > ----- Original Message -----
>> > From: "Peng Yu" <pengyu.ut@gmail.com>
>> > To: java-user@lucene.apache.org
>> > Sent: Saturday, 26 September, 2009 12:11:02 GMT +00:00 GMT Britain,
>> Ireland, Portugal
>> > Subject: Where to download lucene-analyzers and lucene-highlighter?
>> >
>> > Hi,
>> >
>> > I don't see where I can download lucene-analyzers.jar and
>> > lucene-highlighter.jar? Can somebody show me?
>> >
>> > Regards,
>> > Peng
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42478-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 12:20:23 2009
Return-Path: <java-user-return-42478-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83145 invoked from network); 26 Sep 2009 12:20:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 12:20:23 -0000
Received: (qmail 77538 invoked by uid 500); 26 Sep 2009 12:20:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77450 invoked by uid 500); 26 Sep 2009 12:20:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77439 invoked by uid 99); 26 Sep 2009 12:20:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:20:21 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:20:11 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 315D9D36002
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:19:49 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 3ztJk7TnWmQH for <java-user@lucene.apache.org>;
	Sat, 26 Sep 2009 14:19:39 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 0602FD36001
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:19:38 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <366c6f340909260411y4d5360bfld1104d509bb37ae4@mail.gmail.com> <9075997.621253963978969.JavaMail.joel@bohr> <366c6f340909260502j5bec9069s682aa2421ef5b7d1@mail.gmail.com> <AB9AA83BA4E54F7CBD2EFF7279B1749E@VEGA> <366c6f340909260516g6a4a11ceg1aceaafbf0769cc5@mail.gmail.com>
Subject: RE: Where to download lucene-analyzers and lucene-highlighter?
Date: Sat, 26 Sep 2009 14:19:38 +0200
Message-ID: <B977BA3BE87D43FCBA970C134E06CE77@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <366c6f340909260516g6a4a11ceg1aceaafbf0769cc5@mail.gmail.com>
Thread-Index: Aco+o0O0arVoYa9nTkCsZsctjtpFpgAACmig
X-Virus-Checked: Checked by ClamAV on apache.org

It depends what to do with them The JAR file are the artifact and you =
should
place them, where you need them (e.g. into the lib folder of you =
application
you program around Lucene).

There is no install procedure, because Lucene is a library and not a
program.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Peng Yu [mailto:pengyu.ut@gmail.com]
> Sent: Saturday, September 26, 2009 2:16 PM
> To: java-user@lucene.apache.org
> Subject: Re: Where to download lucene-analyzers and =
lucene-highlighter?
>=20
> How to install the compiled files?
>=20
> On Sat, Sep 26, 2009 at 7:10 AM, Uwe Schindler <uwe@thetaphi.de> =
wrote:
> > "Ant build-contrib" from the main directory.
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> >> -----Original Message-----
> >> From: Peng Yu [mailto:pengyu.ut@gmail.com]
> >> Sent: Saturday, September 26, 2009 2:03 PM
> >> To: java-user@lucene.apache.org
> >> Subject: Re: Where to download lucene-analyzers and =
lucene-highlighter?
> >>
> >> Hi,
> >>
> >> I am wondering how I should install the .jar files. I don't find an
> >> install script. Shall I manually copy them to some directory? Which
> >> directory should they be copied to?
> >>
> >> Also, I have to go to each subdir in contrib to compile the .jar =
file
> >>
> >> =A0(for f in compgen -d; do cd $d; ant; cd -; done)
> >>
> >> Should there be a command in the distribution to make the =
compilation
> >> step simple?
> >>
> >> Regards,
> >> Peng
> >>
> >> On Sat, Sep 26, 2009 at 6:19 AM, Joel Halbert =
<joel@su3analytics.com>
> >> wrote:
> >> > Hi Peng - they are both within the contrib dir in your lucene =
package
> >> dowload e.g
> >> >
> >> > lucene-2.4.0/contrib/highlighter/*.jar
> >> > lucene-2.4.0/contrib/analyzers/*.jar
> >> >
> >> > ----- Original Message -----
> >> > From: "Peng Yu" <pengyu.ut@gmail.com>
> >> > To: java-user@lucene.apache.org
> >> > Sent: Saturday, 26 September, 2009 12:11:02 GMT +00:00 GMT =
Britain,
> >> Ireland, Portugal
> >> > Subject: Where to download lucene-analyzers and =
lucene-highlighter?
> >> >
> >> > Hi,
> >> >
> >> > I don't see where I can download lucene-analyzers.jar and
> >> > lucene-highlighter.jar? Can somebody show me?
> >> >
> >> > Regards,
> >> > Peng
> >> >
> >> > =
---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >> > =
---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >>
> >> =
---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42479-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 12:25:10 2009
Return-Path: <java-user-return-42479-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84113 invoked from network); 26 Sep 2009 12:25:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 12:25:10 -0000
Received: (qmail 82388 invoked by uid 500); 26 Sep 2009 12:25:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82294 invoked by uid 500); 26 Sep 2009 12:25:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82284 invoked by uid 99); 26 Sep 2009 12:25:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:25:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of pengyu.ut@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:24:58 +0000
Received: by fxm2 with SMTP id 2so2853295fxm.28
        for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 05:24:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=tBUtWf8CkmGyigFsEkQwy6h5tYn+XYpw5sqv299MLsU=;
        b=r4eDii2V7TxzSadpso21IHVNcT7gy5ugOZs3ET/JXW3wf3coP/uXIT2J2JF6MvRDYo
         YD2FeowXxjggaZreZxkO4wzQU99KUYt4xDtrsbX8Sd+GXOavtW54b6VhEAm96z5Gb4Xy
         HmrFbZfIQdLKdw5gPz5VNg4S2VChJv8ldzb8g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=nbdqC9boUoy4SEnHOZ1f9TRxiq/gTL+wAUCVd1W/CLONsSqwtixq0dkx7+fi06MBvT
         PlcMOmU4RDHYRnPvBZHpn3VOrRrFxm5wEn4NghwwOpfNJGmy3gnnuSSDhEugjJ748zzf
         i2BcF3jhQYT4/XYzmLViGi6Wn02H+T/ucC9U0=
MIME-Version: 1.0
Received: by 10.103.78.17 with SMTP id f17mr457206mul.7.1253967876661; Sat, 26 
	Sep 2009 05:24:36 -0700 (PDT)
In-Reply-To: <B977BA3BE87D43FCBA970C134E06CE77@VEGA>
References: <366c6f340909260411y4d5360bfld1104d509bb37ae4@mail.gmail.com>
	 <9075997.621253963978969.JavaMail.joel@bohr>
	 <366c6f340909260502j5bec9069s682aa2421ef5b7d1@mail.gmail.com>
	 <AB9AA83BA4E54F7CBD2EFF7279B1749E@VEGA>
	 <366c6f340909260516g6a4a11ceg1aceaafbf0769cc5@mail.gmail.com>
	 <B977BA3BE87D43FCBA970C134E06CE77@VEGA>
Date: Sat, 26 Sep 2009 07:24:36 -0500
Message-ID: <366c6f340909260524u378685d5o47d6f8777124e1@mail.gmail.com>
Subject: Re: Where to download lucene-analyzers and lucene-highlighter?
From: Peng Yu <pengyu.ut@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Is there a default library fold? For example, GCC libraries by default
go to /lib, although I can put them anywhere I want if it is really
necessary.

Did you mean that there is not a default location to install the lucene lib=
rary?

On Sat, Sep 26, 2009 at 7:19 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
> It depends what to do with them The JAR file are the artifact and you sho=
uld
> place them, where you need them (e.g. into the lib folder of you applicat=
ion
> you program around Lucene).
>
> There is no install procedure, because Lucene is a library and not a
> program.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>
>> -----Original Message-----
>> From: Peng Yu [mailto:pengyu.ut@gmail.com]
>> Sent: Saturday, September 26, 2009 2:16 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Where to download lucene-analyzers and lucene-highlighter?
>>
>> How to install the compiled files?
>>
>> On Sat, Sep 26, 2009 at 7:10 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
>> > "Ant build-contrib" from the main directory.
>> >
>> > -----
>> > Uwe Schindler
>> > H.-H.-Meier-Allee 63, D-28213 Bremen
>> > http://www.thetaphi.de
>> > eMail: uwe@thetaphi.de
>> >
>> >> -----Original Message-----
>> >> From: Peng Yu [mailto:pengyu.ut@gmail.com]
>> >> Sent: Saturday, September 26, 2009 2:03 PM
>> >> To: java-user@lucene.apache.org
>> >> Subject: Re: Where to download lucene-analyzers and lucene-highlighte=
r?
>> >>
>> >> Hi,
>> >>
>> >> I am wondering how I should install the .jar files. I don't find an
>> >> install script. Shall I manually copy them to some directory? Which
>> >> directory should they be copied to?
>> >>
>> >> Also, I have to go to each subdir in contrib to compile the .jar file
>> >>
>> >> =A0(for f in compgen -d; do cd $d; ant; cd -; done)
>> >>
>> >> Should there be a command in the distribution to make the compilation
>> >> step simple?
>> >>
>> >> Regards,
>> >> Peng
>> >>
>> >> On Sat, Sep 26, 2009 at 6:19 AM, Joel Halbert <joel@su3analytics.com>
>> >> wrote:
>> >> > Hi Peng - they are both within the contrib dir in your lucene packa=
ge
>> >> dowload e.g
>> >> >
>> >> > lucene-2.4.0/contrib/highlighter/*.jar
>> >> > lucene-2.4.0/contrib/analyzers/*.jar
>> >> >
>> >> > ----- Original Message -----
>> >> > From: "Peng Yu" <pengyu.ut@gmail.com>
>> >> > To: java-user@lucene.apache.org
>> >> > Sent: Saturday, 26 September, 2009 12:11:02 GMT +00:00 GMT Britain,
>> >> Ireland, Portugal
>> >> > Subject: Where to download lucene-analyzers and lucene-highlighter?
>> >> >
>> >> > Hi,
>> >> >
>> >> > I don't see where I can download lucene-analyzers.jar and
>> >> > lucene-highlighter.jar? Can somebody show me?
>> >> >
>> >> > Regards,
>> >> > Peng
>> >> >
>> >> > -------------------------------------------------------------------=
--
>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >
>> >> >
>> >> > -------------------------------------------------------------------=
--
>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >
>> >> >
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42480-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 12:29:20 2009
Return-Path: <java-user-return-42480-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84803 invoked from network); 26 Sep 2009 12:29:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 12:29:20 -0000
Received: (qmail 86062 invoked by uid 500); 26 Sep 2009 12:29:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85964 invoked by uid 500); 26 Sep 2009 12:29:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85954 invoked by uid 99); 26 Sep 2009 12:29:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:29:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:29:06 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 71307D36002
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:28:46 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id keRrCqWSlqRV for <java-user@lucene.apache.org>;
	Sat, 26 Sep 2009 14:28:36 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 46203D36001
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:28:36 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <366c6f340909260411y4d5360bfld1104d509bb37ae4@mail.gmail.com> <9075997.621253963978969.JavaMail.joel@bohr> <366c6f340909260502j5bec9069s682aa2421ef5b7d1@mail.gmail.com> <AB9AA83BA4E54F7CBD2EFF7279B1749E@VEGA> <366c6f340909260516g6a4a11ceg1aceaafbf0769cc5@mail.gmail.com> <B977BA3BE87D43FCBA970C134E06CE77@VEGA> <366c6f340909260524u378685d5o47d6f8777124e1@mail.gmail.com>
Subject: RE: Where to download lucene-analyzers and lucene-highlighter?
Date: Sat, 26 Sep 2009 14:28:35 +0200
Message-ID: <99D8FD93165C4AD8BFFDC070F07F8D38@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <366c6f340909260524u378685d5o47d6f8777124e1@mail.gmail.com>
Thread-Index: Aco+pHC1y7e2nG8QSUmB+i9I3tX4wgAAB1wQ
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Peng,

We are here in Java world not in GCC world. Java Jars must be in the
classpath of your application and there is no default one. These are
questions, you should better ask in a Java beginner's forum :-)

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Peng Yu [mailto:pengyu.ut@gmail.com]
> Sent: Saturday, September 26, 2009 2:25 PM
> To: java-user@lucene.apache.org
> Subject: Re: Where to download lucene-analyzers and =
lucene-highlighter?
>=20
> Is there a default library fold? For example, GCC libraries by default
> go to /lib, although I can put them anywhere I want if it is really
> necessary.
>=20
> Did you mean that there is not a default location to install the =
lucene
> library?
>=20
> On Sat, Sep 26, 2009 at 7:19 AM, Uwe Schindler <uwe@thetaphi.de> =
wrote:
> > It depends what to do with them The JAR file are the artifact and =
you
> should
> > place them, where you need them (e.g. into the lib folder of you
> application
> > you program around Lucene).
> >
> > There is no install procedure, because Lucene is a library and not a
> > program.
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> >
> >> -----Original Message-----
> >> From: Peng Yu [mailto:pengyu.ut@gmail.com]
> >> Sent: Saturday, September 26, 2009 2:16 PM
> >> To: java-user@lucene.apache.org
> >> Subject: Re: Where to download lucene-analyzers and =
lucene-highlighter?
> >>
> >> How to install the compiled files?
> >>
> >> On Sat, Sep 26, 2009 at 7:10 AM, Uwe Schindler <uwe@thetaphi.de> =
wrote:
> >> > "Ant build-contrib" from the main directory.
> >> >
> >> > -----
> >> > Uwe Schindler
> >> > H.-H.-Meier-Allee 63, D-28213 Bremen
> >> > http://www.thetaphi.de
> >> > eMail: uwe@thetaphi.de
> >> >
> >> >> -----Original Message-----
> >> >> From: Peng Yu [mailto:pengyu.ut@gmail.com]
> >> >> Sent: Saturday, September 26, 2009 2:03 PM
> >> >> To: java-user@lucene.apache.org
> >> >> Subject: Re: Where to download lucene-analyzers and lucene-
> highlighter?
> >> >>
> >> >> Hi,
> >> >>
> >> >> I am wondering how I should install the .jar files. I don't find =
an
> >> >> install script. Shall I manually copy them to some directory? =
Which
> >> >> directory should they be copied to?
> >> >>
> >> >> Also, I have to go to each subdir in contrib to compile the .jar
> file
> >> >>
> >> >> =A0(for f in compgen -d; do cd $d; ant; cd -; done)
> >> >>
> >> >> Should there be a command in the distribution to make the
> compilation
> >> >> step simple?
> >> >>
> >> >> Regards,
> >> >> Peng
> >> >>
> >> >> On Sat, Sep 26, 2009 at 6:19 AM, Joel Halbert
> <joel@su3analytics.com>
> >> >> wrote:
> >> >> > Hi Peng - they are both within the contrib dir in your lucene
> package
> >> >> dowload e.g
> >> >> >
> >> >> > lucene-2.4.0/contrib/highlighter/*.jar
> >> >> > lucene-2.4.0/contrib/analyzers/*.jar
> >> >> >
> >> >> > ----- Original Message -----
> >> >> > From: "Peng Yu" <pengyu.ut@gmail.com>
> >> >> > To: java-user@lucene.apache.org
> >> >> > Sent: Saturday, 26 September, 2009 12:11:02 GMT +00:00 GMT
> Britain,
> >> >> Ireland, Portugal
> >> >> > Subject: Where to download lucene-analyzers and lucene-
> highlighter?
> >> >> >
> >> >> > Hi,
> >> >> >
> >> >> > I don't see where I can download lucene-analyzers.jar and
> >> >> > lucene-highlighter.jar? Can somebody show me?
> >> >> >
> >> >> > Regards,
> >> >> > Peng
> >> >> >
> >> >> > =
------------------------------------------------------------------
> ---
> >> >> > To unsubscribe, e-mail: =
java-user-unsubscribe@lucene.apache.org
> >> >> > For additional commands, e-mail: =
java-user-help@lucene.apache.org
> >> >> >
> >> >> >
> >> >> > =
------------------------------------------------------------------
> ---
> >> >> > To unsubscribe, e-mail: =
java-user-unsubscribe@lucene.apache.org
> >> >> > For additional commands, e-mail: =
java-user-help@lucene.apache.org
> >> >> >
> >> >> >
> >> >>
> >> >> =
--------------------------------------------------------------------
> -
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail: =
java-user-help@lucene.apache.org
> >> >
> >> >
> >> >
> >> > =
---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >>
> >> =
---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> > =
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42481-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 12:41:56 2009
Return-Path: <java-user-return-42481-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87920 invoked from network); 26 Sep 2009 12:41:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 12:41:56 -0000
Received: (qmail 94347 invoked by uid 500); 26 Sep 2009 12:41:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94271 invoked by uid 500); 26 Sep 2009 12:41:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94261 invoked by uid 99); 26 Sep 2009 12:41:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:41:54 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 12:41:43 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 74B1745E22D
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:41:23 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 6HdQzB+8Y3d8 for <java-user@lucene.apache.org>;
	Sat, 26 Sep 2009 14:41:13 +0200 (CEST)
Received: from VEGA (port-83-236-62-3.dynamic.qsc.de [83.236.62.3])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 71859D36001
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:41:13 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4ABDC477.2000409@bluewin.ch>
Subject: RE: Storing a Lucene Index on a SAN Storage: good idea?
Date: Sat, 26 Sep 2009 14:41:13 +0200
Message-ID: <5D14DC11CA104457885BA3D46E5FDA06@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
In-Reply-To: <4ABDC477.2000409@bluewin.ch>
Thread-Index: Aco+i/qlCLGCDIegRPCLHYZuArQSngAGbqDg
X-Virus-Checked: Checked by ClamAV on apache.org

If it's only 200,000 documents, I think the index will not be very big (a
few Gigabytes), especially, if the documents indexed are 150 kiB raw size
documents like PDFs or DOCs that have much binary overhead not indexed. Most
times the number of distinct terms is low. Index size is most times a lot
smaller than the original documents. If you also store the original doc
contents in the index, it get's bigger, but the time to access the same like
if they are normal files on the SAN.

This config would also run on my laptop :-) I think, the index will
completely be in memory after some time and so there is no difference
between SAN/local HDDs.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Matthias Hess [mailto:mat.hess@bluewin.ch]
> Sent: Saturday, September 26, 2009 9:36 AM
> To: java-user@lucene.apache.org
> Subject: Storing a Lucene Index on a SAN Storage: good idea?
> 
> Hello
> 
> We are currently implementing our first Lucene project. We are building
> an application which will index public Records on the internet, about
> 200'000 documents, each document is about 150 k in size. Our customer
> would like to store the Lucene index on a SAN disk.
> We recommended the use of high speed local disks, but our customer would
> prefer SAN for their better managability.
> 
> Does anybody have good or bad experiences with SAN disks?
> Are there parameters like #read operations, data read rate or whatever,
> which must be met to have a performance which rivals a good "local disk"?
> 
> Thanks for sharing your ideas and opinions!
> 
> Kind Regards
> Matthias Hess
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42482-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 13:48:23 2009
Return-Path: <java-user-return-42482-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1758 invoked from network); 26 Sep 2009 13:48:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 13:48:23 -0000
Received: (qmail 21977 invoked by uid 500); 26 Sep 2009 13:48:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21898 invoked by uid 500); 26 Sep 2009 13:48:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21887 invoked by uid 99); 26 Sep 2009 13:48:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 13:48:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.123.65.155] (HELO mail2.acquiremedia.com) (209.123.65.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 13:48:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail2.acquiremedia.com (Postfix) with ESMTP id 7439F5AC078
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 09:47:50 -0400 (EDT)
X-Virus-Scanned: amavisd-new at mmu.acquiremedia.com
Received: from mail2.acquiremedia.com ([127.0.0.1])
	by localhost (mail.mmu.acquiremedia.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id y7LxesS2LnfU for <java-user@lucene.apache.org>;
	Sat, 26 Sep 2009 09:47:49 -0400 (EDT)
Received: from exchange.mmu.acquiremedia.com (exchange.mmu.acquiremedia.com [10.10.40.251])
	by mail2.acquiremedia.com (Postfix) with ESMTP
	for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 09:47:49 -0400 (EDT)
Received: from exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) by
 exchange.windows.mmu.acquiremedia.com ([10.10.40.251]) with mapi; Sat, 26 Sep
 2009 09:47:49 -0400
From: Dan OConnor <doconnor@acquiremedia.com>
To: "'java-user@lucene.apache.org'" <java-user@lucene.apache.org>
Date: Sat, 26 Sep 2009 09:47:48 -0400
Subject: Re: Storing a Lucene Index on a SAN Storage: good idea?
Thread-Topic: Storing a Lucene Index on a SAN Storage: good idea?
Thread-Index: Aco+i/qlCLGCDIegRPCLHYZuArQSngAGbqDgAAKOYu4=
Message-ID: <24098ED350C76D46A4FDBD81B51BE0E903F043455D@exchange.windows.mmu.acquiremedia.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

DQoNCldlIGhhdmUgdHdvIGluc3RhbmNlcyBvZiBhIHNlYXJjaCBzeXN0ZW0gY29udGFpbmluZyA0
MCBtaWxsaW9uIGRvY3VtZW50cyAtIGlkZW50aWNhbCBqdm0gdmVyc2lvbnMsIGx1Y2VuZSBqYXJz
LCBhbmQgb3VyIGNvZGUuIE9uZSBpcyBydW5uaW5nIG9uIGxvY2FsIGRpc2tzLiBUaGUgb3RoZXIg
aXMgb24gYSBTQU4uIFRoZSBpbnN0YW5jZSBvbiBsb2NhbCBkaXNrcyBjb25zaXN0ZW50bHkgZmFy
IG91dHBlcmZvcm1zIHRoZSBTQU4gaW5zdGFuY2UuDQoNCkFuZCBJJ2Qgc2Vjb25kIFV3ZSdzIHNl
bnRpbWVudHMuIEFuIGluZGV4IG9mIG9ubHkgMjAwLDAwMCBkb2N1bWVudHMgd2lsbCBiZSByZWxh
dGl2ZWx5IHNtYWxsIGFuZCBhcmUgYSBncmVhdCBjYW5kaWRhdGUgZm9yIGxvY2FsIGRpc2tzLiAN
Cg0KUmVnYXJkcywNCkRhbg0KDQogDQoNCi0tLS0tIE9yaWdpbmFsIE1lc3NhZ2UgLS0tLS0NCkZy
b206IFV3ZSBTY2hpbmRsZXIgPHV3ZUB0aGV0YXBoaS5kZT4NClRvOiBqYXZhLXVzZXJAbHVjZW5l
LmFwYWNoZS5vcmcgPGphdmEtdXNlckBsdWNlbmUuYXBhY2hlLm9yZz4NClNlbnQ6IFNhdCBTZXAg
MjYgMDg6NDE6MTMgMjAwOQpTdWJqZWN0OiBSRTogU3RvcmluZyBhIEx1Y2VuZSBJbmRleCBvbiBh
IFNBTiBTdG9yYWdlOiBnb29kIGlkZWE/DQoNCklmIGl0J3Mgb25seSAyMDAsMDAwIGRvY3VtZW50
cywgSSB0aGluayB0aGUgaW5kZXggd2lsbCBub3QgYmUgdmVyeSBiaWcgKGENCmZldyBHaWdhYnl0
ZXMpLCBlc3BlY2lhbGx5LCBpZiB0aGUgZG9jdW1lbnRzIGluZGV4ZWQgYXJlIDE1MCBraUIgcmF3
IHNpemUNCmRvY3VtZW50cyBsaWtlIFBERnMgb3IgRE9DcyB0aGF0IGhhdmUgbXVjaCBiaW5hcnkg
b3ZlcmhlYWQgbm90IGluZGV4ZWQuIE1vc3QNCnRpbWVzIHRoZSBudW1iZXIgb2YgZGlzdGluY3Qg
dGVybXMgaXMgbG93LiBJbmRleCBzaXplIGlzIG1vc3QgdGltZXMgYSBsb3QNCnNtYWxsZXIgdGhh
biB0aGUgb3JpZ2luYWwgZG9jdW1lbnRzLiBJZiB5b3UgYWxzbyBzdG9yZSB0aGUgb3JpZ2luYWwg
ZG9jDQpjb250ZW50cyBpbiB0aGUgaW5kZXgsIGl0IGdldCdzIGJpZ2dlciwgYnV0IHRoZSB0aW1l
IHRvIGFjY2VzcyB0aGUgc2FtZSBsaWtlDQppZiB0aGV5IGFyZSBub3JtYWwgZmlsZXMgb24gdGhl
IFNBTi4NCg0KVGhpcyBjb25maWcgd291bGQgYWxzbyBydW4gb24gbXkgbGFwdG9wIDotKSBJIHRo
aW5rLCB0aGUgaW5kZXggd2lsbA0KY29tcGxldGVseSBiZSBpbiBtZW1vcnkgYWZ0ZXIgc29tZSB0
aW1lIGFuZCBzbyB0aGVyZSBpcyBubyBkaWZmZXJlbmNlDQpiZXR3ZWVuIFNBTi9sb2NhbCBIRERz
Lg0KDQotLS0tLQ0KVXdlIFNjaGluZGxlcg0KSC4tSC4tTWVpZXItQWxsZWUgNjMsIEQtMjgyMTMg
QnJlbWVuDQpodHRwOi8vd3d3LnRoZXRhcGhpLmRlDQplTWFpbDogdXdlQHRoZXRhcGhpLmRlDQoN
Cg0KPiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0tLQ0KPiBGcm9tOiBNYXR0aGlhcyBIZXNzIFtt
YWlsdG86bWF0Lmhlc3NAYmx1ZXdpbi5jaF0NCj4gU2VudDogU2F0dXJkYXksIFNlcHRlbWJlciAy
NiwgMjAwOSA5OjM2IEFNDQo+IFRvOiBqYXZhLXVzZXJAbHVjZW5lLmFwYWNoZS5vcmcNCj4gU3Vi
amVjdDogU3RvcmluZyBhIEx1Y2VuZSBJbmRleCBvbiBhIFNBTiBTdG9yYWdlOiBnb29kIGlkZWE/
DQo+IA0KPiBIZWxsbw0KPiANCj4gV2UgYXJlIGN1cnJlbnRseSBpbXBsZW1lbnRpbmcgb3VyIGZp
cnN0IEx1Y2VuZSBwcm9qZWN0LiBXZSBhcmUgYnVpbGRpbmcNCj4gYW4gYXBwbGljYXRpb24gd2hp
Y2ggd2lsbCBpbmRleCBwdWJsaWMgUmVjb3JkcyBvbiB0aGUgaW50ZXJuZXQsIGFib3V0DQo+IDIw
MCcwMDAgZG9jdW1lbnRzLCBlYWNoIGRvY3VtZW50IGlzIGFib3V0IDE1MCBrIGluIHNpemUuIE91
ciBjdXN0b21lcg0KPiB3b3VsZCBsaWtlIHRvIHN0b3JlIHRoZSBMdWNlbmUgaW5kZXggb24gYSBT
QU4gZGlzay4NCj4gV2UgcmVjb21tZW5kZWQgdGhlIHVzZSBvZiBoaWdoIHNwZWVkIGxvY2FsIGRp
c2tzLCBidXQgb3VyIGN1c3RvbWVyIHdvdWxkDQo+IHByZWZlciBTQU4gZm9yIHRoZWlyIGJldHRl
ciBtYW5hZ2FiaWxpdHkuDQo+IA0KPiBEb2VzIGFueWJvZHkgaGF2ZSBnb29kIG9yIGJhZCBleHBl
cmllbmNlcyB3aXRoIFNBTiBkaXNrcz8NCj4gQXJlIHRoZXJlIHBhcmFtZXRlcnMgbGlrZSAjcmVh
ZCBvcGVyYXRpb25zLCBkYXRhIHJlYWQgcmF0ZSBvciB3aGF0ZXZlciwNCj4gd2hpY2ggbXVzdCBi
ZSBtZXQgdG8gaGF2ZSBhIHBlcmZvcm1hbmNlIHdoaWNoIHJpdmFscyBhIGdvb2QgImxvY2FsIGRp
c2siPw0KPiANCj4gVGhhbmtzIGZvciBzaGFyaW5nIHlvdXIgaWRlYXMgYW5kIG9waW5pb25zIQ0K
PiANCj4gS2luZCBSZWdhcmRzDQo+IE1hdHRoaWFzIEhlc3MNCj4gDQo+IC0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0K
PiBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVjZW5lLmFw
YWNoZS5vcmcNCj4gRm9yIGFkZGl0aW9uYWwgY29tbWFuZHMsIGUtbWFpbDogamF2YS11c2VyLWhl
bHBAbHVjZW5lLmFwYWNoZS5vcmcNCg0KDQoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KVG8gdW5zdWJzY3JpYmUs
IGUtbWFpbDogamF2YS11c2VyLXVuc3Vic2NyaWJlQGx1Y2VuZS5hcGFjaGUub3JnDQpGb3IgYWRk
aXRpb25hbCBjb21tYW5kcywgZS1tYWlsOiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9y
Zw0KDQo=


From java-user-return-42483-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Sep 26 21:22:37 2009
Return-Path: <java-user-return-42483-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66541 invoked from network); 26 Sep 2009 21:22:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Sep 2009 21:22:37 -0000
Received: (qmail 22475 invoked by uid 500); 26 Sep 2009 21:22:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22387 invoked by uid 500); 26 Sep 2009 21:22:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22377 invoked by uid 99); 26 Sep 2009 21:22:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 21:22:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of azlist1@gmail.com designates 72.14.220.157 as permitted sender)
Received: from [72.14.220.157] (HELO fg-out-1718.google.com) (72.14.220.157)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 26 Sep 2009 21:22:25 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1136532fgg.5
        for <java-user@lucene.apache.org>; Sat, 26 Sep 2009 14:22:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=1Nf7HbUESQXdSqt4IrRAhOz0JWL/1LHtkV79acl71dw=;
        b=HKlYI1Zaybt3kDt9Yms/VuseW3Dc5WPzaqAjQ6guKGv6jp2oO/TV/xyh7w/JmjQRNC
         myi/gRmGIuLjL12FPaN1krk+1b04CVHPx6UrAiCUFvtuomtfkPMPeTy9hlLNnpeOu7L8
         P7AwMBOdd7Lsnb+mcUz/BT7z3fgqXKn8QPlAo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=KleJQGna/2tYKvJqJjpKTLzXxEEYBDvxMEFGIsxxYL9RKteGvnSqO+a4gSDik5KPCB
         PSfgUsbs8OUlAE1AqtRzf5hk4Y7ZXUmATy5EmH51xBsk2Nh7kCxZ7ml9ATy0M+12Te6g
         IY0spreiJJEzOH6nrWvVrgH1YgbjEVoQs6+5M=
MIME-Version: 1.0
Received: by 10.86.13.36 with SMTP id 36mr2146481fgm.25.1254000124938; Sat, 26 
	Sep 2009 14:22:04 -0700 (PDT)
In-Reply-To: <783159.56216.qm@web50304.mail.re2.yahoo.com>
References: <76c1202b0909211517g77b3e53ck6ffcaa6a21018d2@mail.gmail.com>
	 <783159.56216.qm@web50304.mail.re2.yahoo.com>
Date: Sat, 26 Sep 2009 23:22:04 +0200
Message-ID: <76c1202b0909261422x1f27aeeesb1deda6a2bf522f3@mail.gmail.com>
Subject: Re: Filtering query results based on relevance/acuracy
From: Alex <azlist1@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636025c26fecda1047481a754
X-Virus-Checked: Checked by ClamAV on apache.org

--001636025c26fecda1047481a754
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hi Otis and thank your for helping me out.

Sorry for the late reply.



Although a Phrase query or TermQuery  would be perfectly suited in some
cases, this will not work in my case.

Basically my application's search feature is a single field "=E0 la Google"
and the user can be looking for a lot of different things...

For example the user can search for
"Chinese Restaurant in New York USA"
or maybe just
"Chinese Restaurant"  (which should be understood as "nearby Chinese
Restaurant"
or maybe
"Chinese Retaurant at 12 Main St. New York"
or
"1223 Main Street New York"



So basically I will get many different query structures depending on the
user's intent/meaning/logic and I think I need to figure out a good analysi=
s
algorithm to get Locations as acurately as possible.

As a first step in my algo I am trying to isolate/identify a potential
LocationType from the query string.
So my idea was to separate each words and use them to query my Index for
LocationTypes that would best match what's included in the query.
I could then get the best matching LocationTypes based on how it scored
against the luicene query and then move on to the next step of my algo whic=
h
would try to find another potential feature of the query such as the
presence of a Country name or City name etc ....

That's why a phrase query would not be appropriate here as this would mean
that the entire query string would be used and would most of the times
return no relevant LocationTypes.

Once I have analysed the query string and isolated the various features
(LocationType, City Name, Country Name , Address .... ) I could maybe creat=
e
a Boolean Query where I would use all that was fetched earlier


So basically I'm not sure what feature of Lucene I should use here in the
first step of the algo to only find the most relevant LocationTypes and
filter out the ones that are not relevant enough.


Any help and any thoughts on my approach greatly appreciated.


Thanks in advance.

Cheers,

Alex.

--001636025c26fecda1047481a754--

From java-user-return-42484-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 27 10:10:18 2009
Return-Path: <java-user-return-42484-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63095 invoked from network); 27 Sep 2009 10:10:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Sep 2009 10:10:18 -0000
Received: (qmail 72181 invoked by uid 500); 27 Sep 2009 10:10:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72099 invoked by uid 500); 27 Sep 2009 10:10:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72089 invoked by uid 99); 27 Sep 2009 10:10:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 27 Sep 2009 10:10:16 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of petite_abeille@mac.com designates 17.148.16.92 as permitted sender)
Received: from [17.148.16.92] (HELO asmtpout017.mac.com) (17.148.16.92)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 27 Sep 2009 10:10:04 +0000
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Received: from [192.168.1.34] ([92.104.14.51])
 by asmtp017.mac.com (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec
 16 2008; 32bit)) with ESMTPSA id <0KQM00KIKK7AE810@asmtp017.mac.com> for
 java-user@lucene.apache.org; Sun, 27 Sep 2009 03:09:43 -0700 (PDT)
Message-id: <08A9EED5-FA7A-40B6-A1AF-629090D6FE17@mac.com>
From: Petite Abeille <petite_abeille@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <4ABDC477.2000409@bluewin.ch>
Subject: Re: Storing a Lucene Index on a SAN Storage: good idea?
Date: Sun, 27 Sep 2009 12:09:09 +0200
References: <4ABDC477.2000409@bluewin.ch>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 26, 2009, at 9:36 AM, Matthias Hess wrote:

> Does anybody have good or bad experiences with SAN disks?

Yea, make sure that your "high end" SAN doesn't end up storing your  
files on one physical disk :P

In short, a SAN can be fiendishly difficult to setup properly,  
specially if it has to be shared among different applications with  
different needs and wants. Too much of a good thing in general. Not  
worth the price, the complexity, nor the pain.

A decent alternative to a SAN would be something like a couple of  
dedicated Sun Thor (aka Sun Fire X4540 Server):

http://www.sun.com/servers/x64/x4540/

This gives you 48 disks to transparently spread you load across in a  
rather compact, simple package. Very handy for IO intensive systems.

As always, YMMV.

Cheers,

--
PA.
http://alt.textdrive.com/nanoki/




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42485-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 27 17:08:03 2009
Return-Path: <java-user-return-42485-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17722 invoked from network); 27 Sep 2009 17:08:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Sep 2009 17:08:03 -0000
Received: (qmail 33303 invoked by uid 500); 27 Sep 2009 17:08:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33229 invoked by uid 500); 27 Sep 2009 17:08:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33219 invoked by uid 99); 27 Sep 2009 17:08:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 27 Sep 2009 17:08:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jjl@panix.com designates 166.84.1.73 as permitted sender)
Received: from [166.84.1.73] (HELO mail2.panix.com) (166.84.1.73)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 27 Sep 2009 17:07:50 +0000
Received: from mailbackend.panix.com (mailbackend.panix.com [166.84.1.89])
	by mail2.panix.com (Postfix) with ESMTP id B493238E4B
	for <java-user@lucene.apache.org>; Sun, 27 Sep 2009 13:07:29 -0400 (EDT)
Received: from [192.168.1.2] (pool-74-97-160-234.prvdri.east.verizon.net [74.97.160.234])
	by mailbackend.panix.com (Postfix) with ESMTP id 66D75341C2
	for <java-user@lucene.apache.org>; Sun, 27 Sep 2009 13:07:29 -0400 (EDT)
Mime-Version: 1.0
Message-Id: <p0624080bc6e53da660bb@[192.168.1.2]>
In-Reply-To: <530630.20671.qm@web24705.mail.ird.yahoo.com>
References: <530630.20671.qm@web24705.mail.ird.yahoo.com>
Date: Sun, 27 Sep 2009 13:07:13 -0400
To: java-user@lucene.apache.org
From: "J.J. Larrea" <jjl@panix.com>
Subject: Re: Storing a Lucene Index on a SAN Storage: good idea?
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello Matthias Hess.

I agree with Mark's comments re: SANs having some advantages, and the need for benchmarking.

My client has for several years been running Solr/Lucene on virtual Linux hosts with no local storage other than the boot and swap partitions; all other storage is on a pair of Fibre Channel-connected SANs. The public deployment site runs on 4 load-balanced application hosts hitting on 2 load-balanced search servers, sharing the same SAN-resident indexes which are also referenced by pre-deployment testing vHosts. 

One of the indexes has ~40M small simple documents and is ~30Gb, the other has ~3M large complex documents and is ~15Gb.  No write operations are done on these indexes: They are constructed, optimized, tested, on an offline production site, then moved to the public deployment site SAN.

I was initially incredulous that it could be possible a virtualized/SANized configuration could not introduce significant performance problems.  When an outside consultancy also recommended we "physicalize" our configuration, I was able to obtain the resources to have a dedicated search server with local storage configured and load-tested against the virtual search servers.

While there was indeed a measurable performance hit, which as one might expect took the form of a broader distribution of request latencies, the mean time was if I recall only 15%-20% worse for the virtualized/SAN configuration.  This was adjudged to be a reasonable price to pay for the savings in rack-space, server hardware purchase and maintenance costs, and simplicity in managing the server farm.  It was also surpassed by other performance bottlenecks which had an even greater impact, which we have been addressing over time.  So we stuck with the virtualized configuration and not looked back.  Had we seen a 50% speed difference, it would have been a different story.  If we had 10M hits a day on the search server, it might have been a different story.  If SAN reliability had unfavorably impacted our uptime average, it would have been different.

I should note that our particular application does not use hit-scoring, but does use field-value sorting and extensive faceting, which to a certain extent reduces the impact of index disk latency as a performance factor in overall request latency, since sort/facet data is one-time loaded into virtual memory and so becomes localized, and the time for these operations can exceed the actual index search time especially when scoring is not involved.

My overall conclusion that there is no universal formula for whether the performance impact is sufficient to rule it out for a specific application with specific performance requirements in a specific business environment.  The best approach may be to prototype the system using SAN-based shared indexes, benchmark it to see if performance is acceptable, borderline, or unacceptable, then benchmark against local disk as one component of the optimization process.

- J.J. Larrea

At 9:21 AM +0000 9/26/09, Mark Harwood wrote:
>I have a client with 700 million doc index running on a SAN. The performance is v good but this obviously depends on your choice of  SAN config. In this environment I have multiple search servers happily hitting the same physical lucene index on the SAN. The servers negotiate with each other via zookeeper to elect a server with write responsibilities. One advantage of this approach over local disks is that index replication is relatively easy (replication is effectively being handled by SAN's internal striping mechanisms). Index replica synching as seen in Solr relies on careful shuffling of (hopefully) small segments of lucene indexes between servers across the network with mechanisms for dealing with server/network failures. Alternative local index synching approaches rely on replica servers independently building their own indexes from source data. Both of these replication strategies are arguably more fallible than a hardware-based striping mechanism in a sophisticated S
 AN.    However the disadvantage with a SAN is the potential for the SAN to become a bottleneck or single point of failure (hardware or app-level index corruption). I'm sure high-end SAN vendors can talk up their ability to hot deploy extra disks to boost performance if needed and sophisticated failover mechanisms but these get expensive. If your client has invested significantly in a SAN and is pushing you to use it my experience is that this can work but benchmarking vs local disk is key.  Cheers Mark On 26 Sep 2009, at 08:36, Matthias Hess <mat.hess@bluewin.ch> wrote: Hello We are currently implementing our first Lucene project. We are building an application which will index public Records on the internet, about 200'000 documents, each document is about 150 k in size. Our customer would like to store the Lucene index on a SAN disk. We recommended the use of high speed local disks, but our customer would prefer SAN for their better managability. Does anybody have good or b
 ad experiences with SAN disks? Are there parameters like #read operations, data read rate or whatever, which must be met to have a performance which rivals a good "local disk"? Thanks for sharing your ideas and opinions! Kind Regards Matthias Hess

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42486-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Sep 27 17:50:53 2009
Return-Path: <java-user-return-42486-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24727 invoked from network); 27 Sep 2009 17:50:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Sep 2009 17:50:53 -0000
Received: (qmail 65378 invoked by uid 500); 27 Sep 2009 17:50:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65311 invoked by uid 500); 27 Sep 2009 17:50:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65299 invoked by uid 99); 27 Sep 2009 17:50:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 27 Sep 2009 17:50:51 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of petite_abeille@mac.com designates 17.148.16.97 as permitted sender)
Received: from [17.148.16.97] (HELO asmtpout022.mac.com) (17.148.16.97)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 27 Sep 2009 17:50:41 +0000
MIME-version: 1.0
Content-transfer-encoding: 7BIT
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Received: from [192.168.1.34] ([92.104.14.51])
 by asmtp022.mac.com (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec
 16 2008; 32bit)) with ESMTPSA id <0KQN008K35J1SW20@asmtp022.mac.com> for
 java-user@lucene.apache.org; Sun, 27 Sep 2009 10:50:21 -0700 (PDT)
Message-id: <E0C37416-45FF-4332-BBD4-B49FF28C0AD5@mac.com>
From: Petite Abeille <petite_abeille@mac.com>
To: java-user@lucene.apache.org
In-reply-to: <p0624080bc6e53da660bb@[192.168.1.2]>
Subject: Re: Storing a Lucene Index on a SAN Storage: good idea?
Date: Sun, 27 Sep 2009 19:49:48 +0200
References: <530630.20671.qm@web24705.mail.ird.yahoo.com>
 <p0624080bc6e53da660bb@[192.168.1.2]>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


On Sep 27, 2009, at 7:07 PM, J.J. Larrea wrote:

> While there was indeed a measurable performance hit, which as one  
> might expect took the form of a broader distribution of request  
> latencies, the mean time was if I recall only 15%-20% worse for the  
> virtualized/SAN configuration.  This was adjudged to be a reasonable  
> price to pay for the savings in rack-space, server hardware purchase  
> and maintenance costs, and simplicity in managing the server farm.   
> It was also surpassed by other performance bottlenecks which had an  
> even greater impact, which we have been addressing over time.  So we  
> stuck with the virtualized configuration and not looked back.  Had  
> we seen a 50% speed difference, it would have been a different  
> story.  If we had 10M hits a day on the search server, it might have  
> been a different story.  If SAN reliability had unfavorably impacted  
> our uptime average, it would have been different.

Right... As a counter example, moving a system from the SAN to local  
storage boosted IO throughput from 200 MBps (megabytes per second) to  
over 1,600 MBps. But, as always, YMMV.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42487-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 08:28:49 2009
Return-Path: <java-user-return-42487-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73957 invoked from network); 28 Sep 2009 08:28:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 08:28:49 -0000
Received: (qmail 23905 invoked by uid 500); 28 Sep 2009 08:28:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23818 invoked by uid 500); 28 Sep 2009 08:28:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23808 invoked by uid 99); 28 Sep 2009 08:28:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 08:28:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 08:28:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MsBai-00025c-W7
	for java-user@lucene.apache.org; Mon, 28 Sep 2009 01:28:16 -0700
Message-ID: <25641688.post@talk.nabble.com>
Date: Mon, 28 Sep 2009 01:28:16 -0700 (PDT)
From: coldserenity <muntyanu.roman@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Search with wild-cards by words with forward-slash ("/")
In-Reply-To: <359a92830909241109q68c1579bydae8e497d084db2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: muntyanu.roman@gmail.com
References: <25578017.post@talk.nabble.com> <359a92830909241109q68c1579bydae8e497d084db2@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hello Eric, 

  Thank you for help. We did use Luke and all the examples I've provided are
from there.
  The issue has been unexpectedly solved :)

  As I've already mentioned, we use Lucene with Compass and following
configuration was used to specify the field as "untokenized" 
         <property name="path" managed-id-index="not_analyzed">
            <meta-data>rootKey</meta-data>
            <meta-data>path</meta-data>
        </property>
  Changing it to the following prevented Lucene from seeing the "rootKey" as
a set of tokens split by '/' character.
        <property name="path">
            <meta-data index="not_analyzed">rootKey</meta-data> <!--
not_analyzed: tell compass that the field is untokenized -->
        </property>
  So the problem was in how we configured Compass. 
  
  To conclude, our solution to this problem is: "Set field as 'untokenized'
and use StandardAnalyzer".

  Again, thanks for your help!

Regards,
  Roman
  

-- 
View this message in context: http://www.nabble.com/Search-with-wild-cards-by-words-with-forward-slash-%28%22-%22%29-tp25578017p25641688.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42488-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 11:07:30 2009
Return-Path: <java-user-return-42488-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7363 invoked from network); 28 Sep 2009 11:07:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 11:07:30 -0000
Received: (qmail 79728 invoked by uid 500); 28 Sep 2009 11:07:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79635 invoked by uid 500); 28 Sep 2009 11:07:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79625 invoked by uid 99); 28 Sep 2009 11:07:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 11:07:27 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erdincyilmazel@gmail.com designates 209.85.220.221 as permitted sender)
Received: from [209.85.220.221] (HELO mail-fx0-f221.google.com) (209.85.220.221)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 11:07:19 +0000
Received: by fxm21 with SMTP id 21so5545fxm.9
        for <java-user@lucene.apache.org>; Mon, 28 Sep 2009 04:06:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=qg48TG+6PWBX7G8lzu7p5R10kI4flO/x5MQmhEmTE4Y=;
        b=JZnOeguUr+F2evo3V7RWYVeuPjVl8yxcAP6bqMrRNh+iwhVXNUjXQ4YO625EFCDN+2
         DpHp68D/DING2JtRhlc5CSoFmZYNWVXG09RkOTuJHGsCOpP4zsnLzvGKSkzR7GBMT+Yt
         84aujLv45VAeT3FqogGcrFHQmbY9j6JiH0Fq8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=DP2QfiJHE29gGGp3nQfP0Hz6eocRmQZCgMbPkvbooF2EiI1JvBAc1uy3PbClhLhQyr
         zO+CCYexGaSOt+QWii6432qjWDiPcidh2MZnjN2DL0JbRI0Y7ilopTJ9p0mPOs4/VE9B
         v1MHqHz8Es406sw/gdiW08lPATm+Hflgj3CdU=
MIME-Version: 1.0
Received: by 10.223.22.4 with SMTP id l4mr681218fab.37.1254136018299; Mon, 28 
	Sep 2009 04:06:58 -0700 (PDT)
Date: Mon, 28 Sep 2009 12:06:58 +0100
Message-ID: <7af3bac90909280406m7779a10cn99cd3baf9e41a9a5@mail.gmail.com>
Subject: LegthFilter
From: Erdinc Yilmazel <erdincyilmazel@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151747b74adeec640474a14b0a
X-Virus-Checked: Checked by ClamAV on apache.org

--00151747b74adeec640474a14b0a
Content-Type: text/plain; charset=ISO-8859-1

Sorry if this is a stupid question. I want my index to contain terms that
are at least 4 characters long. So I wrote a simple analyzer and  applied
the LengthFilter. When I open the index and get a TermEnum from the
directory, I can still see terms that are less than 4 characters... What do
you think is wrong? I am using lucene 2.9.0.
The analyzer code:

   @Override
   public TokenStream tokenStream(String fieldName, Reader reader) {
      StandardTokenizer tokenStream = new StandardTokenizer(reader, true);
      TokenStream result = new StandardFilter(tokenStream);
      result = new LengthFilter(result, 4, 20);
      result = new LowerCaseFilter(result);
      result = new StopFilter(false, result, stopSet);
      return result;
   }

Erdinc

--00151747b74adeec640474a14b0a--

From java-user-return-42489-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 16:59:40 2009
Return-Path: <java-user-return-42489-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16970 invoked from network); 28 Sep 2009 16:59:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 16:59:40 -0000
Received: (qmail 7802 invoked by uid 500); 28 Sep 2009 16:59:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7714 invoked by uid 500); 28 Sep 2009 16:59:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7702 invoked by uid 99); 28 Sep 2009 16:59:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 16:59:38 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 16:59:28 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MsJZ5-0008Vx-Hr
	for java-user@lucene.apache.org; Mon, 28 Sep 2009 09:59:07 -0700
Message-ID: <25649045.post@talk.nabble.com>
Date: Mon, 28 Sep 2009 09:59:07 -0700 (PDT)
From: John Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: PrefixQuery vs wildcardquery
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,

Is there any benefit of using one or other for "start with query"?


Regards
-- 
View this message in context: http://www.nabble.com/PrefixQuery-vs-wildcardquery-tp25649045p25649045.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42490-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 17:00:10 2009
Return-Path: <java-user-return-42490-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18208 invoked from network); 28 Sep 2009 17:00:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 17:00:09 -0000
Received: (qmail 10758 invoked by uid 500); 28 Sep 2009 17:00:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10707 invoked by uid 500); 28 Sep 2009 17:00:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10697 invoked by uid 99); 28 Sep 2009 17:00:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 17:00:07 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 16:59:58 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MsJZa-00005V-1w
	for java-user@lucene.apache.org; Mon, 28 Sep 2009 09:59:38 -0700
Message-ID: <25649045.post@talk.nabble.com>
Date: Mon, 28 Sep 2009 09:59:38 -0700 (PDT)
From: John Seer <pulsphoto@yahoo.com>
To: java-user@lucene.apache.org
Subject: PrefixQuery vs wildcardquery
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: pulsphoto@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,

Is there any benefit of using one or other for "start with query"?

Which one is faster?  


Regards
-- 
View this message in context: http://www.nabble.com/PrefixQuery-vs-wildcardquery-tp25649045p25649045.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42491-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 17:07:42 2009
Return-Path: <java-user-return-42491-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24537 invoked from network); 28 Sep 2009 17:07:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 17:07:42 -0000
Received: (qmail 19561 invoked by uid 500); 28 Sep 2009 17:07:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19481 invoked by uid 500); 28 Sep 2009 17:07:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19470 invoked by uid 99); 28 Sep 2009 17:07:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 17:07:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 72.14.220.154 as permitted sender)
Received: from [72.14.220.154] (HELO fg-out-1718.google.com) (72.14.220.154)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 17:07:30 +0000
Received: by fg-out-1718.google.com with SMTP id d23so772135fga.5
        for <java-user@lucene.apache.org>; Mon, 28 Sep 2009 10:07:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=+E325IxuQIY428nOMIoYl78reXsI5SD8xrGHvVozRmY=;
        b=B+yJE/0VgM579hzLRFbCdneGXfX9wdnL+NHVhvQr1iKWtot8n+qGLEZB568U7McHaW
         NXixUXFeZXsSotXucFnhtKeC2pQNovT6CNeiLzwVDZVH4qYQevtdTWKsm3FgsWSOP35R
         4kCSn/jcI3q7Ha1yRaXjk4xD7H7quVHzsmJhw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=G+6UGxMFa0hzkqcTph38UaNPifA47VoTIwqmRTbyvKgt4zfzNine/BEmdglgT43OMK
         leF+CphaoRdCvYqvn5w1oLQPfIXt4StQBoKzRyOUlp7FmwAYxcPm0ka3rJZRQHWd6Io0
         YzfiaJdkPREJOR4rGKetGoQvHsDB6yyXgNAWg=
Received: by 10.86.184.35 with SMTP id h35mr3566912fgf.18.1254157628841;
        Mon, 28 Sep 2009 10:07:08 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 3sm140858fge.13.2009.09.28.10.06.58
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 28 Sep 2009 10:06:59 -0700 (PDT)
Message-ID: <4AC0ED31.2090501@gmail.com>
Date: Mon, 28 Sep 2009 13:06:57 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: PrefixQuery vs wildcardquery
References: <25649045.post@talk.nabble.com>
In-Reply-To: <25649045.post@talk.nabble.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

John Seer wrote:
> Hello,
>
> Is there any benefit of using one or other for "start with query"?
>
> Which one is faster?  
>
>
> Regards
>   
Prefix query is a bit more efficient - not sure what it turns into
realworld, but prefix just checks if the term's start with the prefix -
wildcard has a bit more complicated check to do (there could be a
wildcard anywhere in the term that must be checked for). I'd be
surprised if it was a huge difference, but if there are a lot of terms
to check, it could.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42492-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 17:23:56 2009
Return-Path: <java-user-return-42492-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31175 invoked from network); 28 Sep 2009 17:23:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 17:23:55 -0000
Received: (qmail 37886 invoked by uid 500); 28 Sep 2009 17:23:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37804 invoked by uid 500); 28 Sep 2009 17:23:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37793 invoked by uid 99); 28 Sep 2009 17:23:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 17:23:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 17:23:44 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MsJwZ-0001fT-Uk
	for java-user@lucene.apache.org; Mon, 28 Sep 2009 10:23:23 -0700
Message-ID: <25649399.post@talk.nabble.com>
Date: Mon, 28 Sep 2009 10:23:23 -0700 (PDT)
From: entdeveloper <cameron.developer@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: PrefixQuery vs wildcardquery
In-Reply-To: <25649045.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: cameron.developer@gmail.com
References: <25649045.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org



John Seer wrote:
> 
> Hello,
> 
> Is there any benefit of using one or other for "start with query"?
> 
> Which one is faster?  
> 
> 
> Regards
> 

It seems that you've answered your own question. If you want a "start with
query", this is exactly what a PrefixQuery is for. WildcardQuery gives you
more flexibility, but if you don't need it, then PrefixQuery should get the
job done.
-- 
View this message in context: http://www.nabble.com/PrefixQuery-vs-wildcardquery-tp25649045p25649399.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42493-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 19:05:35 2009
Return-Path: <java-user-return-42493-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74413 invoked from network); 28 Sep 2009 19:05:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 19:05:35 -0000
Received: (qmail 9850 invoked by uid 500); 28 Sep 2009 19:05:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9780 invoked by uid 500); 28 Sep 2009 19:05:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9770 invoked by uid 99); 28 Sep 2009 19:05:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 19:05:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 19:05:23 +0000
Received: by fxm2 with SMTP id 2so4044751fxm.28
        for <java-user@lucene.apache.org>; Mon, 28 Sep 2009 12:05:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type;
        bh=LvS+z7nB99lpYw8hrFSB5fOxhumAbAKtefqvKhCspvg=;
        b=DJ8ZdEtru1C5QdwHCFkwGytn8BWtEIJ5NcW+ILBkljeXHRTcQYVRM4oxHwV+rMjhBq
         bdcHsS82p9WEVZ2MkQunmNETuVgUMh3F7AQXp9QZCilRtLAb/Sa+ce4Nki+qQ9CsI565
         qFk5C4yIrDWVACIX6jG2Ohzu4DOHObIECLIwM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type;
        b=HMI3biBk6fMMvrOM0VDgcWDuDKaQy0D3+f0+LtzhVkR2bQbrj+sAgfjvE32nFM9Abn
         1T6Y5anoPLNuZAWhSuzOPmTQ5UFgTmPn62ggNy+6JweKvEUIdYYfS27G6dz9EOQZeZWw
         fyZtO5Y9vp+1VC/1jhqSIP20snLguhnhecXnI=
MIME-Version: 1.0
Received: by 10.239.145.13 with SMTP id q13mr359526hba.125.1254164701228; Mon, 
	28 Sep 2009 12:05:01 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <25649399.post@talk.nabble.com>
References: <25649045.post@talk.nabble.com> <25649399.post@talk.nabble.com>
Date: Mon, 28 Sep 2009 21:05:01 +0200
Message-ID: <f18c9dde0909281205n33ef87b9i344792760a26ba2b@mail.gmail.com>
Subject: Re: PrefixQuery vs wildcardquery
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Depending on your usecase you might want to use the PrefixFilter
instead of PrefixQuery which can be way more efficient than a query.
With a filter you have the possibility to cache it very easily and you
are not exposed to issued related to the length of the prefix. If you
have a very short prefix and in turn lots of terms matching that
prefix you might run into problems with TooManyBooleanClauses
expections. The downside is that a filter will not contribute to the
score of a document.
Just wanna point you to it if it is an alternative.

simon

On Mon, Sep 28, 2009 at 7:23 PM, entdeveloper
<cameron.developer@gmail.com> wrote:
>
>
> John Seer wrote:
>>
>> Hello,
>>
>> Is there any benefit of using one or other for "start with query"?
>>
>> Which one is faster?
>>
>>
>> Regards
>>
>
> It seems that you've answered your own question. If you want a "start with
> query", this is exactly what a PrefixQuery is for. WildcardQuery gives you
> more flexibility, but if you don't need it, then PrefixQuery should get the
> job done.
> --
> View this message in context: http://www.nabble.com/PrefixQuery-vs-wildcardquery-tp25649045p25649399.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42494-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 19:19:04 2009
Return-Path: <java-user-return-42494-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80747 invoked from network); 28 Sep 2009 19:19:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 19:19:04 -0000
Received: (qmail 32346 invoked by uid 500); 28 Sep 2009 19:19:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32270 invoked by uid 500); 28 Sep 2009 19:19:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32260 invoked by uid 99); 28 Sep 2009 19:19:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 19:19:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 19:18:50 +0000
Received: by bwz10 with SMTP id 10so3905651bwz.5
        for <java-user@lucene.apache.org>; Mon, 28 Sep 2009 12:18:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=xL+EFWMGnL9pRr7spc+DMgerY0A+v6OogcihGl/zD+I=;
        b=pPHq9wPav3FiO0mGpPcE2aNBo0XV3Ehp5BJq4BU35mqzE7xSqUMJcI5/rd1bJC2IEu
         2L9wLkS2HaBAT1vvv5NxYrcJZKn6SyU8Bmq0qCFc0t6ceMri3nuiZg/zmmuckTBJXkGy
         nOBFV/XGETKR2omaKvnN5Mo+q6khuH3HYRCqA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=msVa/+2HzRsP1ro96tETvZLDjAMeAk0dE5vvyI0S+xZ6BoQNTyEg0WAWMzRZle8KVT
         90Wd/2Yk88cZ2v/i2ds3iE/G4TjyLn8qL7qQAUCnTICCRgy/jrbOU57M1ifDO8hWrajR
         ZhKG6oPhl8i77INYRURmA3i+ofYpF3ikGcnwI=
MIME-Version: 1.0
Received: by 10.239.168.135 with SMTP id k7mr316481hbe.99.1254165510395; Mon, 
	28 Sep 2009 12:18:30 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <7af3bac90909280406m7779a10cn99cd3baf9e41a9a5@mail.gmail.com>
References: <7af3bac90909280406m7779a10cn99cd3baf9e41a9a5@mail.gmail.com>
Date: Mon, 28 Sep 2009 21:18:30 +0200
Message-ID: <f18c9dde0909281218v69b3d7d8j1d70e77f3b29ec72@mail.gmail.com>
Subject: Re: LegthFilter
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I don't see a reason why this shoul not work though. are you sure you
have indexed all fields with this analyzer or do you iterate over
terms of another field not being analyzed with the an analyzer using
the length filter?!

simon

On Mon, Sep 28, 2009 at 1:06 PM, Erdinc Yilmazel
<erdincyilmazel@gmail.com> wrote:
> Sorry if this is a stupid question. I want my index to contain terms that
> are at least 4 characters long. So I wrote a simple analyzer and =C2=A0ap=
plied
> the LengthFilter. When I open the index and get a TermEnum from the
> directory, I can still see terms that are less than 4 characters... What =
do
> you think is wrong? I am using lucene 2.9.0.
> The analyzer code:
>
> =C2=A0 @Override
> =C2=A0 public TokenStream tokenStream(String fieldName, Reader reader) {
> =C2=A0 =C2=A0 =C2=A0StandardTokenizer tokenStream =3D new StandardTokeniz=
er(reader, true);
> =C2=A0 =C2=A0 =C2=A0TokenStream result =3D new StandardFilter(tokenStream=
);
> =C2=A0 =C2=A0 =C2=A0result =3D new LengthFilter(result, 4, 20);
> =C2=A0 =C2=A0 =C2=A0result =3D new LowerCaseFilter(result);
> =C2=A0 =C2=A0 =C2=A0result =3D new StopFilter(false, result, stopSet);
> =C2=A0 =C2=A0 =C2=A0return result;
> =C2=A0 }
>
> Erdinc
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42495-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 21:19:13 2009
Return-Path: <java-user-return-42495-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18567 invoked from network); 28 Sep 2009 21:19:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 21:19:13 -0000
Received: (qmail 4137 invoked by uid 500); 28 Sep 2009 21:19:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4075 invoked by uid 500); 28 Sep 2009 21:19:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4065 invoked by uid 99); 28 Sep 2009 21:19:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 21:19:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.221.195 as permitted sender)
Received: from [209.85.221.195] (HELO mail-qy0-f195.google.com) (209.85.221.195)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 21:19:00 +0000
Received: by qyk33 with SMTP id 33so4350162qyk.29
        for <java-user@lucene.apache.org>; Mon, 28 Sep 2009 14:18:39 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:x-mailer
         :mime-version:subject:date:references;
        bh=hesLTKIpwi5bH55DQneNLMvNSshcEdEiAOCKXk/YUMQ=;
        b=dp1wMuRAj8J2urSklwCUrmdgIbWsxSVyxAojCSAZmrAuuZV8xwVZ7kwLOBXtjC68Np
         W05N5jbAi6jpKnZNjHkVnBl250p8b5ROrv+c1WOc5mKCCgoJRj8Xh0tI0lmxdmw8C4V5
         3IMIF9QxJqoz8E2sTPFHVuC33W0U7sqAjZ7tk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:x-mailer:mime-version:subject:date
         :references;
        b=Suwfy5slJqD6ZwGWkik3kNYxzurVsYwJ911RaMc8EBrnicb7OwCH4eEEecos54E9os
         kMNDSb5A8GiGM+uHAQYhYac4O2OPY6IiEy2HkvaU/QRbDm080sDh7G4h4ieF06/+XPOp
         KvWRazLxfV/khxxdt0f8jVD/uztU/C+lwQPCI=
Received: by 10.224.73.37 with SMTP id o37mr3158641qaj.252.1254172718326;
        Mon, 28 Sep 2009 14:18:38 -0700 (PDT)
Received: from ?10.206.115.254? (mobile-166-137-132-024.mycingular.net [166.137.132.24])
        by mx.google.com with ESMTPS id 7sm171795qwb.51.2009.09.28.14.18.36
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 28 Sep 2009 14:18:37 -0700 (PDT)
Message-Id: <ECF0D484-1F5A-4F62-86B0-9E739BFF7A6F@gmail.com>
From: Mark Miller <markrmiller@gmail.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
In-Reply-To: <f18c9dde0909281205n33ef87b9i344792760a26ba2b@mail.gmail.com>
Content-Type: text/plain;
	charset=us-ascii;
	format=flowed;
	delsp=yes
Content-Transfer-Encoding: 7bit
X-Mailer: iPhone Mail (7A400)
Mime-Version: 1.0 (iPhone Mail 7A400)
Subject: Re: PrefixQuery vs wildcardquery
Date: Mon, 28 Sep 2009 17:18:28 -0400
References: <25649045.post@talk.nabble.com> <25649399.post@talk.nabble.com> <f18c9dde0909281205n33ef87b9i344792760a26ba2b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Though in 2.9 this is not much of a concern - the multi term queries  
are smart - if it matches few enough terms it will rewrite to a  
constant score booleanquery - if it matches a lot of terms it will  
rewrite to a constantscore query - using a filter underneath. So  
maxclause issues should no longer be an issue.

- Mark

http://www.lucidimagination.com (mobile)

On Sep 28, 2009, at 3:05 PM, Simon Willnauer <simon.willnauer@googlemail.com 
 > wrote:

> Depending on your usecase you might want to use the PrefixFilter
> instead of PrefixQuery which can be way more efficient than a query.
> With a filter you have the possibility to cache it very easily and you
> are not exposed to issued related to the length of the prefix. If you
> have a very short prefix and in turn lots of terms matching that
> prefix you might run into problems with TooManyBooleanClauses
> expections. The downside is that a filter will not contribute to the
> score of a document.
> Just wanna point you to it if it is an alternative.
>
> simon
>
> On Mon, Sep 28, 2009 at 7:23 PM, entdeveloper
> <cameron.developer@gmail.com> wrote:
>>
>>
>> John Seer wrote:
>>>
>>> Hello,
>>>
>>> Is there any benefit of using one or other for "start with query"?
>>>
>>> Which one is faster?
>>>
>>>
>>> Regards
>>>
>>
>> It seems that you've answered your own question. If you want a  
>> "start with
>> query", this is exactly what a PrefixQuery is for. WildcardQuery  
>> gives you
>> more flexibility, but if you don't need it, then PrefixQuery should  
>> get the
>> job done.
>> --
>> View this message in context: http://www.nabble.com/PrefixQuery-vs-wildcardquery-tp25649045p25649399.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42496-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 21:50:37 2009
Return-Path: <java-user-return-42496-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27322 invoked from network); 28 Sep 2009 21:50:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 21:50:37 -0000
Received: (qmail 37847 invoked by uid 500); 28 Sep 2009 21:50:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37770 invoked by uid 500); 28 Sep 2009 21:50:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37760 invoked by uid 99); 28 Sep 2009 21:50:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 21:50:35 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 21:50:25 +0000
Received: by bwz10 with SMTP id 10so4009099bwz.5
        for <java-user@lucene.apache.org>; Mon, 28 Sep 2009 14:50:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type;
        bh=hcn2ELtN9zU2Twj15unuj4L+FCvNYy61hjACHqkYDBU=;
        b=aulRvX7FXEr6OE4KP93ldQk4D3q6QGuAyw1CJtYI1GuTFMPFXYApKuWTvT/HPu5CuC
         ZebSDoF+DaYjf4hh+zUaAIhGt6DjkeBI6zzwG742RGG3d3kGPk1VH+UNewo5u+XpRI3v
         6Z+nnWa09MfIRtax5+rRl+9CJzxWE/nJI0nRk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type;
        b=RC4yFBNpIzYIhm4gs8G5iFTgXUm70rx8nk3NMNjIqzMF/4oIUJsjhNdEC87ydQLCtK
         YuS3fB3VmWXUmGoizJyiLnFn2026Oqk5fruPqN7cJOGlvGdhJ6OAbExRtebBi66uffu+
         n7uiMhMTNfz4zBLYUfxxFo83nmQKOlp+zZsyY=
MIME-Version: 1.0
Received: by 10.239.158.7 with SMTP id s7mr409316hbc.53.1254174603801; Mon, 28 
	Sep 2009 14:50:03 -0700 (PDT)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <ECF0D484-1F5A-4F62-86B0-9E739BFF7A6F@gmail.com>
References: <25649045.post@talk.nabble.com> <25649399.post@talk.nabble.com>
	 <f18c9dde0909281205n33ef87b9i344792760a26ba2b@mail.gmail.com>
	 <ECF0D484-1F5A-4F62-86B0-9E739BFF7A6F@gmail.com>
Date: Mon, 28 Sep 2009 23:50:03 +0200
Message-ID: <f18c9dde0909281450m61b7d647v925c046878c5b4dd@mail.gmail.com>
Subject: Re: PrefixQuery vs wildcardquery
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
X-Virus-Checked: Checked by ClamAV on apache.org

Ha!  I need to get used to the fact that 2.9 is out there already :)
Thanks mark for the addition.

simon

On Mon, Sep 28, 2009 at 11:18 PM, Mark Miller <markrmiller@gmail.com> wrote:
> Though in 2.9 this is not much of a concern - the multi term queries are
> smart - if it matches few enough terms it will rewrite to a constant score
> booleanquery - if it matches a lot of terms it will rewrite to a
> constantscore query - using a filter underneath. So maxclause issues should
> no longer be an issue.
>
> - Mark
>
> http://www.lucidimagination.com (mobile)
>
> On Sep 28, 2009, at 3:05 PM, Simon Willnauer
> <simon.willnauer@googlemail.com> wrote:
>
>> Depending on your usecase you might want to use the PrefixFilter
>> instead of PrefixQuery which can be way more efficient than a query.
>> With a filter you have the possibility to cache it very easily and you
>> are not exposed to issued related to the length of the prefix. If you
>> have a very short prefix and in turn lots of terms matching that
>> prefix you might run into problems with TooManyBooleanClauses
>> expections. The downside is that a filter will not contribute to the
>> score of a document.
>> Just wanna point you to it if it is an alternative.
>>
>> simon
>>
>> On Mon, Sep 28, 2009 at 7:23 PM, entdeveloper
>> <cameron.developer@gmail.com> wrote:
>>>
>>>
>>> John Seer wrote:
>>>>
>>>> Hello,
>>>>
>>>> Is there any benefit of using one or other for "start with query"?
>>>>
>>>> Which one is faster?
>>>>
>>>>
>>>> Regards
>>>>
>>>
>>> It seems that you've answered your own question. If you want a "start
>>> with
>>> query", this is exactly what a PrefixQuery is for. WildcardQuery gives
>>> you
>>> more flexibility, but if you don't need it, then PrefixQuery should get
>>> the
>>> job done.
>>> --
>>> View this message in context:
>>> http://www.nabble.com/PrefixQuery-vs-wildcardquery-tp25649045p25649399.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42497-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 23:34:14 2009
Return-Path: <java-user-return-42497-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46273 invoked from network); 28 Sep 2009 23:34:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 23:34:14 -0000
Received: (qmail 17921 invoked by uid 500); 28 Sep 2009 23:34:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17813 invoked by uid 500); 28 Sep 2009 23:34:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17794 invoked by uid 99); 28 Sep 2009 23:34:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 23:34:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HS_INDEX_PARAM,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bradfordstephens@gmail.com designates 209.85.211.188 as permitted sender)
Received: from [209.85.211.188] (HELO mail-yw0-f188.google.com) (209.85.211.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 23:33:59 +0000
Received: by ywh26 with SMTP id 26so3819112ywh.29
        for <multiple recipients>; Mon, 28 Sep 2009 16:33:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=5oyl5+X45wdNEhaK3dKbNc64NYM9x2azca1ER/d1SjM=;
        b=GB9z/5oiV1h1XojzFkHtAlch+xiMhIs05Rl0qaHSJ72Wi/SG99zT/KKEWrBF8T9gtp
         34C8waR9CNOeZev5G2j+TqPcr4NWWsX26qdlH/XK9KLzUp0NRyTJVrgpkdX5/ufGY6eC
         t7uzoJ/yASeUmQgnyG7FwsGFNZK2siB/zVIvQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=TDQU7MHyfzcxdNsIiGTudUhrbE+M3YFnMXTdD3Yv2TCbGrpVkYasyPAGRWWYAPIJ4H
         ZIiDAN7IeI4YT4pu7HcL349cRvo33srJVtciy8nw5WLcdL7ATPdrvR+iDDo+p0C35ah2
         q8IgRTbllX0w09CG6o2bNJ+DeW+s8+YV5P/Ag=
MIME-Version: 1.0
Received: by 10.91.122.6 with SMTP id z6mr3271513agm.38.1254180818220; Mon, 28 
	Sep 2009 16:33:38 -0700 (PDT)
In-Reply-To: <860544ed0909141135y3e4c83a7mfd350e083e51ad11@mail.gmail.com>
References: <860544ed0909141135y3e4c83a7mfd350e083e51ad11@mail.gmail.com>
Date: Mon, 28 Sep 2009 16:33:38 -0700
Message-ID: <860544ed0909281633g6304ff8fh2c1809794ca27fbb@mail.gmail.com>
Subject: Re: Seattle / PNW Hadoop/Lucene/HBase Meetup, Wed Sep 30th
From: Bradford Stephens <bradfordstephens@gmail.com>
To: core-user@hadoop.apache.org, java-user@lucene.apache.org, 
	solr-user@lucene.apache.org, hbase-user@hadoop.apache.org
Content-Type: multipart/alternative; boundary=0016e64601942775ab0474abbac8
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64601942775ab0474abbac8
Content-Type: text/plain; charset=ISO-8859-1

Hello everyone!
Don't forget that the Meetup is THIS Wednesday! I'm looking forward to
hearing about Hive from the Facebook team ... and there might be a few other
interesting talks as well. Here's the details in the wiki:
http://wiki.apache.org/hadoop/PNW_Hadoop_%2B_Apache_Cloud_Stack_User_Group

Cheers,
Bradford

On Mon, Sep 14, 2009 at 11:35 AM, Bradford Stephens <
bradfordstephens@gmail.com> wrote:

> Greetings,
>
> It's time for another Hadoop/Lucene/Apache"Cloud"  Stack meetup!
> This month it'll be on Wednesday, the 30th, at 6:45 pm.
>
> We should have a few interesting guests this time around -- someone from
> Facebook may be stopping by to talk about Hive :)
>
> We've had great attendance in the past few months, let's keep it up! I'm
> always
> amazed by the things I learn from everyone.
>
> We're back at the University of Washington, Allen Computer Science
> Center (not Computer Engineering)
> Map: http://www.washington.edu/home/maps/?CSE
>
> Room: 303 -or- the Entry level. If there are changes, signs will be posted.
>
> More Info:
>
> The meetup is about 2 hours (and there's usually food): we'll have two
> in-depth talks of 15-20
> minutes each, and then several "lightning talks" of 5 minutes. If no
> one offers, We'll then have discussion and 'social time'.  we'll just
> have general discussion. Let net know if you're interested in speaking
> or attending. We'd like to focus on education, so every presentation
> *needs* to ask some questions at the end. We can talk about these
> after the presentations, and I'll record what we've learned in a wiki
> and share that with the rest of us.
>
> Contact: Bradford Stephens, 904-415-3009, bradfordstephens@gmail.com
>
> Cheers,
> Bradford
> --
> http://www.roadtofailure.com -- The Fringes of Scalability, Social
> Media, and Computer Science
>



-- 
http://www.roadtofailure.com -- The Fringes of Scalability, Social Media,
and Computer Science

--0016e64601942775ab0474abbac8--

From java-user-return-42498-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Sep 28 23:40:38 2009
Return-Path: <java-user-return-42498-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47138 invoked from network); 28 Sep 2009 23:40:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Sep 2009 23:40:38 -0000
Received: (qmail 27543 invoked by uid 500); 28 Sep 2009 23:40:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27467 invoked by uid 500); 28 Sep 2009 23:40:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27457 invoked by uid 99); 28 Sep 2009 23:40:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 23:40:36 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erdincyilmazel@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Sep 2009 23:40:26 +0000
Received: by fxm2 with SMTP id 2so4219180fxm.28
        for <java-user@lucene.apache.org>; Mon, 28 Sep 2009 16:40:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=pQEMuC7Cpd3vpu0wyh9NGz4Ynvkhojms37EGSx8t78Q=;
        b=xbnFoeiRjRGj532WGqrYQ5QHDvHDbtvTmCXPVsWXnqRhAOQ8E//FhS4eRPuKvgXan0
         3xw+wNyKgrlyRIee3axpvGlPwxbc4pwn5wQO1eBMXzj7Z6j0VWcg96vR4H5MFiET/uAx
         TSx9tBX1Y9XeqKgErTwS33U2g763EapeedUnU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=uAMkEUSkEnNNB3EVGZj13yYLLCXXOh0+PPCgNC+07SMeQbdM+naVEbRDhdKV84Rw57
         kkwF8idyI9/iIr8jT7CBVXo3Cx3P8Vz6fjOajNpygu7F+1hxxPjV6qLivJHHpQPz8Ep8
         LRu+KFSmUAimHqM5sG4nKBrnOa98DCwNa26mk=
MIME-Version: 1.0
Received: by 10.223.24.87 with SMTP id u23mr1001051fab.81.1254181206266; Mon, 
	28 Sep 2009 16:40:06 -0700 (PDT)
In-Reply-To: <f18c9dde0909281218v69b3d7d8j1d70e77f3b29ec72@mail.gmail.com>
References: <7af3bac90909280406m7779a10cn99cd3baf9e41a9a5@mail.gmail.com>
	 <f18c9dde0909281218v69b3d7d8j1d70e77f3b29ec72@mail.gmail.com>
Date: Tue, 29 Sep 2009 00:40:06 +0100
Message-ID: <7af3bac90909281640p2abe58ffj5d66a412d6bcaacc@mail.gmail.com>
Subject: Re: LegthFilter
From: Erdinc Yilmazel <erdincyilmazel@gmail.com>
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
Content-Type: multipart/alternative; boundary=000e0cd1e1744893f30474abd161
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd1e1744893f30474abd161
Content-Type: text/plain; charset=ISO-8859-1

Thanks Simon, It turned out to be a simple mistake that I made... I was
creating an index with the LengthFilter applied, however reading from
another index directory because of a configuration error on my ide. (The
working directory paths were wrong in Run configs...)
Sorry about wasting your time.

Thanks again,

Erdinc


On Mon, Sep 28, 2009 at 8:18 PM, Simon Willnauer <
simon.willnauer@googlemail.com> wrote:

> I don't see a reason why this shoul not work though. are you sure you
> have indexed all fields with this analyzer or do you iterate over
> terms of another field not being analyzed with the an analyzer using
> the length filter?!
>
> simon
>
> On Mon, Sep 28, 2009 at 1:06 PM, Erdinc Yilmazel
> <erdincyilmazel@gmail.com> wrote:
> > Sorry if this is a stupid question. I want my index to contain terms that
> > are at least 4 characters long. So I wrote a simple analyzer and  applied
> > the LengthFilter. When I open the index and get a TermEnum from the
> > directory, I can still see terms that are less than 4 characters... What
> do
> > you think is wrong? I am using lucene 2.9.0.
> > The analyzer code:
> >
> >   @Override
> >   public TokenStream tokenStream(String fieldName, Reader reader) {
> >      StandardTokenizer tokenStream = new StandardTokenizer(reader, true);
> >      TokenStream result = new StandardFilter(tokenStream);
> >      result = new LengthFilter(result, 4, 20);
> >      result = new LowerCaseFilter(result);
> >      result = new StopFilter(false, result, stopSet);
> >      return result;
> >   }
> >
> > Erdinc
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd1e1744893f30474abd161--

From java-user-return-42499-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 01:02:28 2009
Return-Path: <java-user-return-42499-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76783 invoked from network); 29 Sep 2009 01:02:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 01:02:28 -0000
Received: (qmail 89896 invoked by uid 500); 29 Sep 2009 01:02:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89820 invoked by uid 500); 29 Sep 2009 01:02:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89809 invoked by uid 99); 29 Sep 2009 01:02:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 01:02:26 +0000
X-ASF-Spam-Status: No, hits=1.1 required=10.0
	tests=FORGED_HOTMAIL_RCVD2,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 01:02:17 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1MsR6K-0006a7-2V
	for java-user@lucene.apache.org; Mon, 28 Sep 2009 18:01:56 -0700
Message-ID: <25655337.post@talk.nabble.com>
Date: Mon, 28 Sep 2009 18:01:56 -0700 (PDT)
From: shaoxianyang <ysxsusan@hotmail.com>
To: java-user@lucene.apache.org
Subject: IndexSearcher close() and search() called concurrently by different
 threads?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ysxsusan@hotmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I am new to Lucene.  Hope the question is not too naive.

>From Lucene FAQ, i know that IndexSearcher instance shall be shared by
threads, rather than opening one for each thread.  However, after index
rebuild, we need to create a new IndexSearcher instance, and call close() on
the old indexSearcher instance.   Here is the pseudo code:


public class SearchEngine {

  private IndexSearcher iSearcher = null;

  public void setIndexSearcher(IndexSearcher searcher) {
          this.iSearcher.close();
          this.iSearcher = searcher;
     
  }


  public void search() {

     iSearcher search();
  }


}

As you can see, after index rebuild, one thread wants to call
SearchEngine.setIndexSearcher to instantiate a new IndexSearcher.  Before
that, it also needs to clean up the resource of the old IndexSearcher by
calling close().    At the same time, another thread is in the middle of
search of the old indexSearcher object.  

That is why I am concerned whether I might get some weird exception by
calling searcher.close() and searcher.search() concurrently by different
threads.   Will that be a problem?  Or lucene takes care of the
synchronization between close() and search(), or that does not need any
synchronization at all?  Bottom line is that I don't want to do
synchronization between close() and search().


Or is there more elegant way of passing a new IndexSearcher after index
rebuild without any resource leak?
-- 
View this message in context: http://www.nabble.com/IndexSearcher-close%28%29-and-search%28%29-called-concurrently-by-different-threads--tp25655337p25655337.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42500-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 05:26:52 2009
Return-Path: <java-user-return-42500-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32086 invoked from network); 29 Sep 2009 05:26:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 05:26:52 -0000
Received: (qmail 38675 invoked by uid 500); 29 Sep 2009 05:26:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38599 invoked by uid 500); 29 Sep 2009 05:26:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38589 invoked by uid 99); 29 Sep 2009 05:26:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 05:26:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of vik.list.nutch@gmail.com designates 209.85.211.182 as permitted sender)
Received: from [209.85.211.182] (HELO mail-yw0-f182.google.com) (209.85.211.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 05:26:40 +0000
Received: by ywh12 with SMTP id 12so5049865ywh.21
        for <java-user@lucene.apache.org>; Mon, 28 Sep 2009 22:26:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type
         :content-transfer-encoding;
        bh=DM0wRPOpzY3w4zqALTyZMvu5PilnasAiwfyylcxHslo=;
        b=Pi8WuFup5EDYTDhlTYyQ3RBSyv/e37XH10RpCFz2A21M53KluXZ738Z+BG3caGWAFt
         IgDBexxTt1OE/NsYehWhpIJnvyOXoJdNxgRIIiu9CthVIAJDKr102L/oOLGRuWjJn0f6
         xpT3TAqJ9bG5aTuG1W3GRNvf+29o8r+cgTqdk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type:content-transfer-encoding;
        b=vUUEI/kByr4h1eso+mAeYkWdlXtE5ELKUrnb5a6qf47ha24JHFBnkXfamtgBbo5mcX
         NRmtALMM7BA/oSvM7gdV94w4LFh/Vl3PmpBCVZZkC9l2cPvSFZI0jVs+jPXtA98smiji
         wfYJ4JEodisekY1A/KLrOo/d9hwnyYnUJyZRk=
Received: by 10.101.131.17 with SMTP id i17mr4052123ann.30.1254201979904;
        Mon, 28 Sep 2009 22:26:19 -0700 (PDT)
Received: from rescomp-08-125572.Stanford.EDU (rescomp-08-125572.Stanford.EDU [128.12.142.244])
        by mx.google.com with ESMTPS id 21sm2142302yxe.9.2009.09.28.22.26.18
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 28 Sep 2009 22:26:19 -0700 (PDT)
Message-ID: <4AC19A79.4070106@gmail.com>
Date: Mon, 28 Sep 2009 22:26:17 -0700
From: Viksit Gaur <vik.list.nutch@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Fuzzy phrase matching using SpanQuery?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

I'm trying to achieve the following, and wondered if I could get 
feedback on how best to achieve it.

Given an example phrase P - "Squeamish Ossifrage Monster", I'd like to 
search a corpus such that in a list of results,

- Docs with all 3 words in the phrase are ranked at the top

- Docs with atleast 2 of the words in that order are ranked next
-- (Say, "Ossifrage Monster" and "Squeamish Ossifrage" but not 
"Squeamish Monster")

- Docs with only one of the words come next
-- Is there a way to put these into one result set, and the first 2 
kinds in another?

The naive solution of course would be to take a phrase P, and then 
separate out all its terms (Pt_1, Pt_2, Pt_3) and then do those 3 
searches manually - seems like a colossal waste.

Is this possible with SpanQuery in some way? I also came across an 
article somewhere which said that QueryParser doesn't support SpanQuery 
- in which case, what would be the best way to actually implement this?

Cheers
Viksit

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42501-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 07:15:36 2009
Return-Path: <java-user-return-42501-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55672 invoked from network); 29 Sep 2009 07:15:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 07:15:35 -0000
Received: (qmail 22375 invoked by uid 500); 29 Sep 2009 07:15:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22285 invoked by uid 500); 29 Sep 2009 07:15:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22275 invoked by uid 99); 29 Sep 2009 07:15:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 07:15:33 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of azlist1@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 07:15:25 +0000
Received: by fg-out-1718.google.com with SMTP id 16so1629389fgg.5
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 00:15:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=cDLYLObWoQzpd2n9PA3F0gSjP+CATNFz78ogmkYZvEk=;
        b=li2IMKiInZqG6Jo7T3lLtX+lC2ew+RcWDLFmaacvYPaPJRJRXVBFwnRYDuy7rgQ2Z+
         PxYCmDZeLZ6HkBasJhotqv1h993NtvnR9Ey4jHTMzm4227K9sVx2mhSbI0JHsGw2rEDO
         m15DRjB4H9meaOxjQ6JOMOBHPSljGoVyfUcpI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=DjRk7r7U9++JNRjuvExCi+CmH6vxRTf8nCVTfC2AGIbnp4OPAgJy7XunYU4aheABQ6
         PBPEB0QhGsMQTaM+mOiXFx98BMbFpGyAEgYWYIWthwaXAdp6hgbiiA4de+BB3CnSo2gS
         sRm/JlH+IFFfgl+8LLvjJktpcU/VgvPawE1jI=
MIME-Version: 1.0
Received: by 10.86.231.5 with SMTP id d5mr3993800fgh.53.1254208503866; Tue, 29 
	Sep 2009 00:15:03 -0700 (PDT)
In-Reply-To: <76c1202b0909261422x1f27aeeesb1deda6a2bf522f3@mail.gmail.com>
References: <76c1202b0909211517g77b3e53ck6ffcaa6a21018d2@mail.gmail.com>
	 <783159.56216.qm@web50304.mail.re2.yahoo.com>
	 <76c1202b0909261422x1f27aeeesb1deda6a2bf522f3@mail.gmail.com>
Date: Tue, 29 Sep 2009 09:15:03 +0200
Message-ID: <76c1202b0909290015h1e4e8105nc90d91883c156d23@mail.gmail.com>
Subject: Re: Filtering query results based on relevance/acuracy
From: Alex <azlist1@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00148531a4a258e7f00474b22c42
X-Virus-Checked: Checked by ClamAV on apache.org

--00148531a4a258e7f00474b22c42
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

anybody can help ?

On Sat, Sep 26, 2009 at 11:22 PM, Alex <azlist1@gmail.com> wrote:

> Hi Otis and thank your for helping me out.
>
> Sorry for the late reply.
>
>
>
> Although a Phrase query or TermQuery  would be perfectly suited in some
> cases, this will not work in my case.
>
> Basically my application's search feature is a single field "=E0 la Googl=
e"
> and the user can be looking for a lot of different things...
>
> For example the user can search for
> "Chinese Restaurant in New York USA"
> or maybe just
> "Chinese Restaurant"  (which should be understood as "nearby Chinese
> Restaurant"
> or maybe
> "Chinese Retaurant at 12 Main St. New York"
> or
> "1223 Main Street New York"
>
>
>
> So basically I will get many different query structures depending on the
> user's intent/meaning/logic and I think I need to figure out a good analy=
sis
> algorithm to get Locations as acurately as possible.
>
> As a first step in my algo I am trying to isolate/identify a potential
> LocationType from the query string.
> So my idea was to separate each words and use them to query my Index for
> LocationTypes that would best match what's included in the query.
> I could then get the best matching LocationTypes based on how it scored
> against the luicene query and then move on to the next step of my algo wh=
ich
> would try to find another potential feature of the query such as the
> presence of a Country name or City name etc ....
>
> That's why a phrase query would not be appropriate here as this would mea=
n
> that the entire query string would be used and would most of the times
> return no relevant LocationTypes.
>
> Once I have analysed the query string and isolated the various features
> (LocationType, City Name, Country Name , Address .... ) I could maybe cre=
ate
> a Boolean Query where I would use all that was fetched earlier
>
>
> So basically I'm not sure what feature of Lucene I should use here in the
> first step of the algo to only find the most relevant LocationTypes and
> filter out the ones that are not relevant enough.
>
>
> Any help and any thoughts on my approach greatly appreciated.
>
>
> Thanks in advance.
>
> Cheers,
>
> Alex.
>
>
>

--00148531a4a258e7f00474b22c42--

From java-user-return-42502-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 14:28:58 2009
Return-Path: <java-user-return-42502-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90611 invoked from network); 29 Sep 2009 14:28:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 14:28:58 -0000
Received: (qmail 30339 invoked by uid 500); 29 Sep 2009 14:28:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30289 invoked by uid 500); 29 Sep 2009 14:28:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30279 invoked by uid 99); 29 Sep 2009 14:28:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 14:28:54 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.216.180 as permitted sender)
Received: from [209.85.216.180] (HELO mail-px0-f180.google.com) (209.85.216.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 14:28:45 +0000
Received: by pxi10 with SMTP id 10so5593379pxi.20
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 07:28:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=vcODxDHhp+qrD7Kty40/3ImWb6k/cSuzr2pE0nQ8cvY=;
        b=K9oPSxc9NGCpF1wzqZt9HdPLE5fW9XiO6rvD97KdUBuh+aoAIOV3jH7RsQXwZh1ugD
         +kINjT9rRCsWv/ilGUwkWOkZbR8QvlddG80lUkpf4KpKuDLkLtRt3QVvSbrvM1vKaCx/
         JM3SECkN/I+wxzTRaoO57QhAIOWSmEi4gXhak=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=WL3yovUN1Ob4dl12NwYw7oOAch8sJF0hTgLh1P/19n081qHvNCHORofsXmfXvZvxoM
         GTfGLeCASnjwbXA6x/jEO5+d5JEomWd8ICWMzd9NxxWhYptFO10x56wFixue2Y9yHiyN
         O+hpbxx0TDUOPQhe68N6nqXEgySXSqP9NDLNY=
MIME-Version: 1.0
Received: by 10.114.164.17 with SMTP id m17mr8221626wae.3.1254234503584; Tue, 
	29 Sep 2009 07:28:23 -0700 (PDT)
In-Reply-To: <4AC19A79.4070106@gmail.com>
References: <4AC19A79.4070106@gmail.com>
Date: Tue, 29 Sep 2009 19:58:23 +0530
Message-ID: <867513fe0909290728vb5a4224qf5e82badfc1cfd59@mail.gmail.com>
Subject: Re: Fuzzy phrase matching using SpanQuery?
From: Anshum <anshumg@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016367f92ae0d1dac0474b83af4
X-Virus-Checked: Checked by ClamAV on apache.org

--0016367f92ae0d1dac0474b83af4
Content-Type: text/plain; charset=ISO-8859-1

Hi Viksit,
Why don't you try breaking the query and running a boolean boost query.
Building something like
("A B C"~1000)^100 OR ("A B"~1000 OR "B C"~1000 OR "A C"~1000)^10 OR (A OR B
OR C)

Though this is not a fool proof way to do it and a manual merge is the right
way.
Also, I remember a similar question being posted in the past. You might want
to have a look @ the archives.

--
Anshum Gupta
Naukri Labs!
http://ai-cafe.blogspot.com

The facts expressed here belong to everybody, the opinions to me. The
distinction is yours to draw............


On Tue, Sep 29, 2009 at 10:56 AM, Viksit Gaur <vik.list.nutch@gmail.com>wrote:

> Hi all,
>
> I'm trying to achieve the following, and wondered if I could get feedback
> on how best to achieve it.
>
> Given an example phrase P - "Squeamish Ossifrage Monster", I'd like to
> search a corpus such that in a list of results,
>
> - Docs with all 3 words in the phrase are ranked at the top
>
> - Docs with atleast 2 of the words in that order are ranked next
> -- (Say, "Ossifrage Monster" and "Squeamish Ossifrage" but not "Squeamish
> Monster")
>
> - Docs with only one of the words come next
> -- Is there a way to put these into one result set, and the first 2 kinds
> in another?
>
> The naive solution of course would be to take a phrase P, and then separate
> out all its terms (Pt_1, Pt_2, Pt_3) and then do those 3 searches manually -
> seems like a colossal waste.
>
> Is this possible with SpanQuery in some way? I also came across an article
> somewhere which said that QueryParser doesn't support SpanQuery - in which
> case, what would be the best way to actually implement this?
>
> Cheers
> Viksit
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016367f92ae0d1dac0474b83af4--

From java-user-return-42503-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 15:07:00 2009
Return-Path: <java-user-return-42503-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6906 invoked from network); 29 Sep 2009 15:07:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 15:07:00 -0000
Received: (qmail 13393 invoked by uid 500); 29 Sep 2009 15:06:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13327 invoked by uid 500); 29 Sep 2009 15:06:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13312 invoked by uid 99); 29 Sep 2009 15:06:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 15:06:57 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.167.82.89] (HELO p3plsmtpa01-09.prod.phx3.secureserver.net) (72.167.82.89)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 29 Sep 2009 15:06:47 +0000
Received: (qmail 9128 invoked from network); 29 Sep 2009 15:06:23 -0000
Received: from unknown (81.219.54.251)
  by p3plsmtpa01-09.prod.phx3.secureserver.net (72.167.82.89) with ESMTP; 29 Sep 2009 15:06:22 -0000
Message-ID: <4AC22260.5010202@getopt.org>
Date: Tue, 29 Sep 2009 17:06:08 +0200
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: [ANN] Luke 0.9.9 release
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,

I'm happy to announce the new release of Luke - the Lucene Index Toolbox.

Binaries and sources are available for download at the usual place:

	http://www.getopt.org/luke/
	http://www.getopt.org/luke/lukeall-0.9.9.jar
	http://www.getopt.org/luke/luke-0.9.9/luke-src-0.9.9.tgz
	http://www.getopt.org/luke/luke-0.9.9/luke-src-0.9.9.zip

I decided to at least partially synchronize the release numbers with 
Lucene release numbers. Next version of Luke, which will include Lucene 
3.0, will become a 1.0 release! :)

Changes in v. 0.9.9:
====================

This release upgrades to Lucene 2.9.0 jars.

New features and improvements:
------------------------------
* Luke can now open multiple indexes found in subdirectories one level 
below the selected directory.

* Added Hadoop Plugin for working with indexes on Hadoop file systems. 
This uses Hadoop 0.19.2 and dependencies released with this release of 
Hadoop. The plugin uses partial local caching to speed up some operations.

* Term counts and percentages are calculated in a background thread, so 
the opening of large indexes should be a little faster. Also, this 
operation is skipped for indexes accessed over slow IO (such as HDFS).

* Added More Like This query builder from current document (or its 
selected fields).

* Search time is now monitored using System.nanoTime, and the last 
search time is preserved in the UI.

* Search can be now repeated N times to get a better estimate of average 
search time. Note: the measured time involves only the search(), not the 
retrieval of documents.

* AnalyzerTool plugin now uses and illustrates the new token Attribute API.

* Nearly all uses of deprecated Lucene API are replaced with the new API.

Bug fixes:
----------
* Fix a counter-intuitive behavior where in the Open dialog Luke chops 
off the last path element from previously used index path.

* Fix XMLExporter entity escaping, and add a missing quote in term 
vector size.

* Fix a long-standing Thinlet bug related to tabbedpane with many tabs - 
now tabs don't "overflow" the tabbedpane area thus corrupting the 
display of surrounding components.

I'd like to thank people who reported problems and suggested 
improvements: Craig Stires, Phil Whelan, Andrea Habringer, Benjamin 
Beckmann, George Herson, Daniel Noll, Mike McCandless, Chris Pimlott and 
others.

Enjoy! :)

-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42504-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 15:26:14 2009
Return-Path: <java-user-return-42504-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12788 invoked from network); 29 Sep 2009 15:26:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 15:26:14 -0000
Received: (qmail 56712 invoked by uid 500); 29 Sep 2009 15:26:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56640 invoked by uid 500); 29 Sep 2009 15:26:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56629 invoked by uid 99); 29 Sep 2009 15:26:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 15:26:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erdincyilmazel@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 15:26:00 +0000
Received: by bwz10 with SMTP id 10so4526875bwz.5
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 08:25:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=sEKuN6l/BCQkpUPXXcFcJRwJYYEwd582JpUSnW8lUiY=;
        b=EqWz8kpt+g3nNOpJHanD5GFKBffj2P5gauLI6tgrPa2PQPXtN/gezdvd+jaR6ZNy39
         r8gZFklzvGzynCvOU4oV7R5lFXw2sc6CaEhzvMtyQa27HuJD3Mr+oMaBwTspfHz33h1Q
         1hCk58RVoMlhwwOU9cd+bK6i9l3uzFZoJqWvk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=jRe4VdX96so36nH4WSher2kRIr43Be1G7utzVM0d+w3Z9pNBBmadDPM8wQE5zTU3kO
         UpwX7zxO+zVnVD/i3eXyvfZ9+vIfMaLeKf77cFMMMFGE7vDW89r59piLILXciEF98jmU
         pZHgDmkp1kexkz6eE2ETfXQ4LimQ3Cw1ce4Y8=
MIME-Version: 1.0
Received: by 10.223.17.144 with SMTP id s16mr1286847faa.41.1254237939844; Tue, 
	29 Sep 2009 08:25:39 -0700 (PDT)
In-Reply-To: <4AC22260.5010202@getopt.org>
References: <4AC22260.5010202@getopt.org>
Date: Tue, 29 Sep 2009 16:25:39 +0100
Message-ID: <7af3bac90909290825g78926857vf24d0bfba253c897@mail.gmail.com>
Subject: Re: [ANN] Luke 0.9.9 release
From: Erdinc Yilmazel <erdincyilmazel@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151744857cde45f60474b906d0
X-Virus-Checked: Checked by ClamAV on apache.org

--00151744857cde45f60474b906d0
Content-Type: text/plain; charset=ISO-8859-1

Thanks!

On Tue, Sep 29, 2009 at 4:06 PM, Andrzej Bialecki <ab@getopt.org> wrote:

> Hi all,
>
> I'm happy to announce the new release of Luke - the Lucene Index Toolbox.
>
> Binaries and sources are available for download at the usual place:
>
>        http://www.getopt.org/luke/
>        http://www.getopt.org/luke/lukeall-0.9.9.jar
>        http://www.getopt.org/luke/luke-0.9.9/luke-src-0.9.9.tgz
>        http://www.getopt.org/luke/luke-0.9.9/luke-src-0.9.9.zip
>
> I decided to at least partially synchronize the release numbers with Lucene
> release numbers. Next version of Luke, which will include Lucene 3.0, will
> become a 1.0 release! :)
>
> Changes in v. 0.9.9:
> ====================
>
> This release upgrades to Lucene 2.9.0 jars.
>
> New features and improvements:
> ------------------------------
> * Luke can now open multiple indexes found in subdirectories one level
> below the selected directory.
>
> * Added Hadoop Plugin for working with indexes on Hadoop file systems. This
> uses Hadoop 0.19.2 and dependencies released with this release of Hadoop.
> The plugin uses partial local caching to speed up some operations.
>
> * Term counts and percentages are calculated in a background thread, so the
> opening of large indexes should be a little faster. Also, this operation is
> skipped for indexes accessed over slow IO (such as HDFS).
>
> * Added More Like This query builder from current document (or its selected
> fields).
>
> * Search time is now monitored using System.nanoTime, and the last search
> time is preserved in the UI.
>
> * Search can be now repeated N times to get a better estimate of average
> search time. Note: the measured time involves only the search(), not the
> retrieval of documents.
>
> * AnalyzerTool plugin now uses and illustrates the new token Attribute API.
>
> * Nearly all uses of deprecated Lucene API are replaced with the new API.
>
> Bug fixes:
> ----------
> * Fix a counter-intuitive behavior where in the Open dialog Luke chops off
> the last path element from previously used index path.
>
> * Fix XMLExporter entity escaping, and add a missing quote in term vector
> size.
>
> * Fix a long-standing Thinlet bug related to tabbedpane with many tabs -
> now tabs don't "overflow" the tabbedpane area thus corrupting the display of
> surrounding components.
>
> I'd like to thank people who reported problems and suggested improvements:
> Craig Stires, Phil Whelan, Andrea Habringer, Benjamin Beckmann, George
> Herson, Daniel Noll, Mike McCandless, Chris Pimlott and others.
>
> Enjoy! :)
>
> --
> Best regards,
> Andrzej Bialecki     <><
>  ___. ___ ___ ___ _ _   __________________________________
> [__ || __|__/|__||\/|  Information Retrieval, Semantic Web
> ___|||__||  \|  ||  |  Embedded Unix, System Integration
> http://www.sigram.com  Contact: info at sigram dot com
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00151744857cde45f60474b906d0--

From java-user-return-42505-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 15:31:26 2009
Return-Path: <java-user-return-42505-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15680 invoked from network); 29 Sep 2009 15:31:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 15:31:26 -0000
Received: (qmail 74047 invoked by uid 500); 29 Sep 2009 15:31:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73993 invoked by uid 500); 29 Sep 2009 15:31:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73983 invoked by uid 99); 29 Sep 2009 15:31:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 15:31:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of draganj@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 15:31:15 +0000
Received: by fxm2 with SMTP id 2so4718331fxm.28
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 08:30:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=jQc24P+sUjsuQ/4Y5+sUvGsdj+pAqwwm1XdZzmrHBKo=;
        b=OSsLxXUBEEJfANSe3iOrkK4ZxRqKUPF/7O2dwbtmzp68rPMSPttbeEm18mNaKOamw5
         qnIzYcISZGKPtXHn3q9KyeLvzC9JmxdnOWxB9AtSEK6agHzq+0ujxrQB8H1/3RJAdoeo
         Ty/xPTOGtWpMt2/JC47MSEZ7j9FUvs5SjH6GU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=Lm1yEogCJql2cnGBWxUg/2cnF0m604YYxo+WHMSs1JJzZs0a9zGXG+34XfW52io5MT
         5C/6M0nwZmi5xFzRePMfp5dqRTjqSszipT3DlkT5jIRUxRr4y76aaicrq4dVHYnIyONp
         sgMbJ6QDpeUhyXglt7BS4D5sOxXWsFQmLTWvo=
MIME-Version: 1.0
Received: by 10.239.139.132 with SMTP id t4mr396020hbt.88.1254238254930; Tue, 
	29 Sep 2009 08:30:54 -0700 (PDT)
Date: Tue, 29 Sep 2009 16:30:54 +0100
Message-ID: <ef921eda0909290830w462586efo782009645faf1d98@mail.gmail.com>
Subject: Filtering on two date fields simultaneously
From: Dragan Jotanovic <draganj@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi, I was thinking a long time how to implement this kind of
functionality but couldn't figure out anything appropriate.
In my lucene document, I have two date fields: start and end date.
As a search input I have current date (NOW).
I need to display all documents for which current date is between
start and end dates.

I know that this could be performed by two RangeQuery-es, ie.
startDate:{19700101 to NOW} AND endDate:{NOW to 29990101}
but since the index could be very large, performance would not be very good.
RangeFilter is not a good idea as well, since I would have to filter
on two fields (or maybe it would with ChainedFilter?).

Does anyone know which approach would be the best in this kind of
situation, performance wise?

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42506-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 16:39:45 2009
Return-Path: <java-user-return-42506-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47743 invoked from network); 29 Sep 2009 16:39:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 16:39:45 -0000
Received: (qmail 1046 invoked by uid 500); 29 Sep 2009 16:39:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 993 invoked by uid 500); 29 Sep 2009 16:39:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 983 invoked by uid 99); 29 Sep 2009 16:39:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 16:39:42 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of abgrilo@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 16:39:33 +0000
Received: by bwz10 with SMTP id 10so4588804bwz.5
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 09:39:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=PooEfPNAMghcSMeEiWcUzZbFUcUN6TT1Oxa+1WFzW1o=;
        b=r/Ky5BTgv7b15ys70DGEdZ9vwFhTjFSAZKOH8B6bpJNWSsO6s3H9KG8nHHCM+xCWyv
         rLv58N9LwiY2qAx/1iGAUWCQmZGnAaD2nBpaFaGneO0XYHARn3tMzTRtMJBCRbYQmlO7
         xiCJHSCU2uU69Vbc3gGTSPc+TzxeiHxiqOik0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=uzCK6r8Jr26P9x+RWJ21tZrkJf9vqHu55P9CXQfPFCQTIr3J2vURJqTkL0N5zMt7hF
         A4Uj9PNPaPzQAWzFzk5RIdorKTGI0EHK5kw1WC/6K2a1y/0cAX/Mx4Ai6VdtOkI91buY
         MfsqsQY3CIbcbNpYT17clRd8EYmPGSVL1sR6o=
MIME-Version: 1.0
Received: by 10.204.7.92 with SMTP id c28mr4335017bkc.170.1254242352260; Tue, 
	29 Sep 2009 09:39:12 -0700 (PDT)
In-Reply-To: <8f0ad1f30909251042w233220f6md6705ffd6715cc6d@mail.gmail.com>
References: <14f35510909251011u5f6a036w5323f34f32c6a292@mail.gmail.com>
	 <ED081AC9AEEE0248BBCCDE9989AAE3FC0151FE6B@rw-ex2003.BROADVISION.COM>
	 <14f35510909251038t114626a0red4f4c49606ada22@mail.gmail.com>
	 <8f0ad1f30909251042w233220f6md6705ffd6715cc6d@mail.gmail.com>
Date: Tue, 29 Sep 2009 13:39:12 -0300
Message-ID: <14f35510909290939o428237d4vc8fff44cbb0a24fd@mail.gmail.com>
Subject: Re: Search with whitespaces
From: Alex Bredariol Grilo <abgrilo@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151758858cde68ee0474ba0d87
X-Virus-Checked: Checked by ClamAV on apache.org

--00151758858cde68ee0474ba0d87
Content-Type: text/plain; charset=ISO-8859-1

To use ShingleFilter, I'd like to change its TOKEN_SEPARATOR, but it's
final. Furthermore, I tryed to compile its source code but the compiler
isn't finding some methods like addAtribute.
Does someone know how could I do that?

Alex

On Fri, Sep 25, 2009 at 2:42 PM, Robert Muir <rcmuir@gmail.com> wrote:

> i might suggest the shingle package in lucene's contrib for this case.
>
> > like to do it for a general case, like trying to search the words joining
> > > the word before or after.
> > >
> > > How could I do that? Is there an analyzer which tokenize like that?
> > >
> > > Thank you
> > >
> > >
> > > Alex
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
> >
> > --
> > Alex
> >
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>



-- 
Alex

--00151758858cde68ee0474ba0d87--

From java-user-return-42507-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 17:01:54 2009
Return-Path: <java-user-return-42507-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58121 invoked from network); 29 Sep 2009 17:01:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 17:01:54 -0000
Received: (qmail 41067 invoked by uid 500); 29 Sep 2009 17:01:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40953 invoked by uid 500); 29 Sep 2009 17:01:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40925 invoked by uid 99); 29 Sep 2009 17:01:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 17:01:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of stachoo@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 17:01:37 +0000
Received: by ey-out-2122.google.com with SMTP id 22so1276268eye.3
        for <multiple recipients>; Tue, 29 Sep 2009 10:01:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        bh=So5iw6vEgVZYty1QuMQqYVBbTz9cRJQXU9klehK29Yo=;
        b=dOpeNRYYSTzDI+AupB0N/r1SyvOfsVoRA1eNEA833zW3DWC0j2OJfI8TTj4ju3I+fO
         /PIsoRKzitVvBsBZp498NO6oB5f3bx8uIRMDWqWjwQo9q6xAfhLnOujUZkq8wBBZqous
         tsNHf3yUyjiejkAvo6Uj+oNphHVt0PZdrRxhY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:date:x-google-sender-auth:message-id:subject
         :from:to:content-type;
        b=QlOE2dcHoSvz+tPv2LD3ZwSCEF+HmMsXgscNBn1LVv3yDs82DWS0o7gyEpeWKIrere
         Anxocq+7MdD3Ib/+pHuv/d/pS7CbrqoPtPC9ulzADz8lVg59sTxtzJAIUDR4sdmBdxPR
         wA20zHfcAAyiZEaN1e/P+gSnM85v4XoyILCBE=
MIME-Version: 1.0
Sender: stachoo@gmail.com
Received: by 10.216.86.132 with SMTP id w4mr1109464wee.87.1254243673969; Tue, 
	29 Sep 2009 10:01:13 -0700 (PDT)
Date: Tue, 29 Sep 2009 19:01:13 +0200
X-Google-Sender-Auth: ea033cbc7dcb4108
Message-ID: <5af106d60909291001j2fe016b2mdbb69112699a9e56@mail.gmail.com>
Subject: [ANN] Carrot2 version 3.1.0 released
From: Stanislaw Osinski <stanislaw@osinski.name>
To: lucene-user <java-user@lucene.apache.org>, solr-user@lucene.apache.org, 
	nutch-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d77ed3a6151e0474ba5c3e
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d77ed3a6151e0474ba5c3e
Content-Type: text/plain; charset=ISO-8859-1

Dear All,

[Apologies for cross-posting.]

This is just to let you know that we've released version 3.1.0 of Carrot2
Search Results Clustering Engine.

The 3.1.0 release comes with:

* Experimental support for clustering Chinese Simplified content (based on
Lucene's Smart Chinese Analyzer)
* Document Clustering Workbench usability improvements
* Suffix Tree Clustering algorithm rewritten for better performance and
clustering quality
* Apache Solr clustering plugin (to be available in Solr 1.4, Grant's blog
post:
http://www.lucidimagination.com/blog/2009/09/28/solrs-new-clustering-capabilities/
)

Release notes:
http://project.carrot2.org/release-3.1.0-notes.html

On-line demo:
http://search.carrot2.org

Download:
http://download.carrot2.org

Project website:
http://project.carrot2.org


Thanks,

Staszek

--
Stanislaw Osinski, http://carrot2.org

--0016e6d77ed3a6151e0474ba5c3e--

From java-user-return-42508-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 17:46:12 2009
Return-Path: <java-user-return-42508-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77914 invoked from network); 29 Sep 2009 17:46:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 17:46:12 -0000
Received: (qmail 5919 invoked by uid 500); 29 Sep 2009 17:46:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5850 invoked by uid 500); 29 Sep 2009 17:46:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5840 invoked by uid 99); 29 Sep 2009 17:46:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 17:46:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of marcelo.ochoa@gmail.com designates 209.85.222.197 as permitted sender)
Received: from [209.85.222.197] (HELO mail-pz0-f197.google.com) (209.85.222.197)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 17:45:59 +0000
Received: by pzk35 with SMTP id 35so5387036pzk.29
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 10:45:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=wWJ7CLzOi+u6ZCgYIvcvTOlMDCytvq6fN7UlalmiM6s=;
        b=WX/uhUCF7lcai4oqqAhOQzJmj9pffFFBuu+tyX13zmykjjExTcdP2c+m0/7YwNzSxN
         YS+H06yQj7akmv2G8E2yTLPXP1Ls0Z9Aii8vR92l4wS561WLe/KztvafJrxbwrzV9UH6
         Mes1rwxrAjLe0ibacg3fbfhXmzEHLbDmmmWnE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=xo2lUuk2Q2BKlBc8OOOGiZ5CEdDjSK1/1+pAQshf2cbT2V1RGTlzdsNkOs3wjK5O+Z
         dEYuBlp9oilIhnwScBlV8u8qKfDiqZQcG5/RNexTU7WvCx09MOPI1dJQSKH+fqNzODsS
         tNoDNQIg2vY7ChURk1AGR+tmusODr0C6X7mxE=
MIME-Version: 1.0
Received: by 10.114.44.14 with SMTP id r14mr8527309war.196.1254246337789; Tue, 
	29 Sep 2009 10:45:37 -0700 (PDT)
Date: Tue, 29 Sep 2009 17:45:37 +0000
Message-ID: <126142c0909291045x7f4ecad7kd7cb14369d51c112@mail.gmail.com>
Subject: ANN: New release of Lucene Domain Index for Oracle
From: Marcelo Ochoa <marcelo.ochoa@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All:
   A new binary distribution of Lucene Domain Index (2.9.0.1.0) for
Oracle 10g/11g has been released.
   Lucene Domain Index is integration of Lucene Project running inside
the Oracle JVM and integrated to the SQL layer by adding a new index
type.
   This new version uses latest Lucene 2.9.0 core libraries and
introduces some of the changes on API.
   Here complete list of changes:
     * Tested with Oracle 11gR2, 11gR1 and 10.2 databases.
     * DefaultUserDataStore do a SAX parsing to get text nodes and
attributes from an XMLType value.
     * A SimpleLRUCache is used to load rowids and his associated
Lucene doc id, this reduce memory consumption when querying very big
tables. A new parameter has been added, CachedRowIdSize by default
10000 to control the size of the LRU cache.
     * Lucene Domain Index core was updated to use TopFieldCollector
and to avoid computation time when lscore() is not used.
     * Two new parameter has been added NormalizeScore which control
when to track the Max Score and PreserveDocIdOrder when querying, both
parameters are consequence of new Lucene Collector API and boost the
performance when querying.
     * A table alias L$MT is defined for the master table associated
to the index to be used in complex queries associating columns from
master tables and columns from dependant tables.
Full documentation is at:
      http://docs.google.com/View?id=ddgw7sjp_54fgj9kg
Download for Oracle 10g/11g:
      http://sourceforge.net/projects/dbprism/files/ojvm/2.9.0.1.0/lucene-ojvm-bin-10g-2.9.0.1.0.zip/download
      http://sourceforge.net/projects/dbprism/files/ojvm/2.9.0.1.0/lucene-ojvm-bin-11g-2.9.0.1.0.zip/download
    Best regards, Marcelo.
-- 
Marcelo F. Ochoa
http://marceloochoa.blogspot.com/
http://marcelo.ochoa.googlepages.com/home
______________
Want to integrate Lucene and Oracle?
http://marceloochoa.blogspot.com/2007/09/running-lucene-inside-your-oracle-jvm.html
Is Oracle 11g REST ready?
http://marceloochoa.blogspot.com/2008/02/is-oracle-11g-rest-ready.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42509-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 22:17:07 2009
Return-Path: <java-user-return-42509-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81747 invoked from network); 29 Sep 2009 22:17:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 22:17:07 -0000
Received: (qmail 80947 invoked by uid 500); 29 Sep 2009 22:17:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80895 invoked by uid 500); 29 Sep 2009 22:17:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80885 invoked by uid 99); 29 Sep 2009 22:17:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 22:17:05 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 22:16:55 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 07E6C76C99
	for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 18:16:34 -0400 (EDT)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Tue, 29 Sep 2009 18:16:34 -0400
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=h4mZuu4DE7cn+tW9fm0TwsOu6YM=; b=RndxJ7j4OaCWtzZiBy9D3l66qqXQKtqdPpdOpqWvJvvQl/uX8pJS3yJmDJNpMTeT5LNNP+b5inm90xVrnNWAfkAON2IiBnNvCQKtdQx3zp9p8yLYUemqqK2tEI5KpUVEaqRl5b6uIU4m3BBMTwXIGBCFFkz/p90Kalx6y7gGQL8=
X-Sasl-enc: 8w3MDYLApavS2ZNAw9aUnrVA5WXSNaCFuDn18h+7At9z 1254262593
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 5ADEC5F80E
	for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 18:16:33 -0400 (EDT)
Message-ID: <4AC28740.9010906@fastmail.fm>
Date: Tue, 29 Sep 2009 23:16:32 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Problem searching non analyzed fields
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I  use the same Analyzer for both creating an index and searching 
however I'm having a problem with some fields that I added with 
Field.Index.NOT_ANALYZED, how can I enforce they are also search without 
being analysed.

I did this for some fields containg Guids and products codes because I 
didn't want them modifying/tokenizing at all and it works fine for 
Guids, however one of these fields contains Amazon Id of B00004Y6O9 and 
I think when I search for this it fails because the analyzer I'm using  
lowercases all text and nowhere do I specify when parsing not to use the 
analyzer when searching, but of course its not getting lowercased when 
added to the index.

code extract:
IndexSearcher is = IndexSearcher(IndexReader.open(new NIOFSDirectory(new 
File(indexDir + '/' + indexName + '/'), null), true));
QueryParser qp = new QueryParser(defaultFields.get(0), analyzer);
TopScoreDocCollector collector = TopScoreDocCollector.create(offset + 
limit, true);
searcher.search(parser.parse(query), collector);

So how do I tell the parser not to analyse some fields, Im guessing the 
idea  is to subclass the QueryParser  but how, or should I be using 
Field.Index.ANALYZED when adding to the index

thanks Paul



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42510-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 22:24:00 2009
Return-Path: <java-user-return-42510-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83006 invoked from network); 29 Sep 2009 22:24:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 22:24:00 -0000
Received: (qmail 94915 invoked by uid 500); 29 Sep 2009 22:23:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94848 invoked by uid 500); 29 Sep 2009 22:23:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94838 invoked by uid 99); 29 Sep 2009 22:23:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 22:23:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.210.192 as permitted sender)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 22:23:50 +0000
Received: by yxe30 with SMTP id 30so7876753yxe.29
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 15:23:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=2NSmn3fEhhfqK2kb0C3Tf+CklQIhE0fVn/tFwoWADZM=;
        b=x2QntvYXSjOK3OgJTs+DzNz2W5MP452odYJpAtc+pwB0qF90mZi1bBBtbRtwmO3wHu
         x6xawIKiUhL2xB9W1MDYZrc15HKQ+H3+gPeq5xGHENCoktivav7QPg3cPWBcTf7kfeg4
         DQ37zV3Sf8olqbTu4eYrppFKuzcsWSgK/Kbzg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=pMaHpeEkpiD4aM2lQtlOVGJKWPtqvpPjvQaFGmUOiDNmXhI6Ynhp+tZ+XGdXvSyr9A
         5QdcllU1dneS5l0OMWZfJfHgyFK5getjY7L1NWY3tIrCOvFdH2N27NhnVd8Gx3JdLewv
         glWEqooVMdIE3SmKLLWPbLY9VSOnqzhEQVFLg=
MIME-Version: 1.0
Received: by 10.101.9.4 with SMTP id m4mr5261297ani.7.1254263009671; Tue, 29 
	Sep 2009 15:23:29 -0700 (PDT)
In-Reply-To: <4AC28740.9010906@fastmail.fm>
References: <4AC28740.9010906@fastmail.fm>
Date: Tue, 29 Sep 2009 18:23:29 -0400
Message-ID: <8f0ad1f30909291523ud565609wd543dc228aa2f297@mail.gmail.com>
Subject: Re: Problem searching non analyzed fields
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636b2b138257c010474bedd8a
X-Virus-Checked: Checked by ClamAV on apache.org

--001636b2b138257c010474bedd8a
Content-Type: text/plain; charset=UTF-8

try checking out PerFieldAnalyzerWrapper, so you can specify how each field
is handled, i.e. some fields with KeywordAnalyzer, other fields with
StandardAnalyzer, etc.

On Tue, Sep 29, 2009 at 6:16 PM, Paul Taylor <paul_t100@fastmail.fm> wrote:

> I  use the same Analyzer for both creating an index and searching however
> I'm having a problem with some fields that I added with
> Field.Index.NOT_ANALYZED, how can I enforce they are also search without
> being analysed.
>
> I did this for some fields containg Guids and products codes because I
> didn't want them modifying/tokenizing at all and it works fine for Guids,
> however one of these fields contains Amazon Id of B00004Y6O9 and I think
> when I search for this it fails because the analyzer I'm using  lowercases
> all text and nowhere do I specify when parsing not to use the analyzer when
> searching, but of course its not getting lowercased when added to the index.
>
> code extract:
> IndexSearcher is = IndexSearcher(IndexReader.open(new NIOFSDirectory(new
> File(indexDir + '/' + indexName + '/'), null), true));
> QueryParser qp = new QueryParser(defaultFields.get(0), analyzer);
> TopScoreDocCollector collector = TopScoreDocCollector.create(offset +
> limit, true);
> searcher.search(parser.parse(query), collector);
>
> So how do I tell the parser not to analyse some fields, Im guessing the
> idea  is to subclass the QueryParser  but how, or should I be using
> Field.Index.ANALYZED when adding to the index
>
> thanks Paul
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Robert Muir
rcmuir@gmail.com

--001636b2b138257c010474bedd8a--

From java-user-return-42511-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 22:39:36 2009
Return-Path: <java-user-return-42511-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86428 invoked from network); 29 Sep 2009 22:39:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 22:39:36 -0000
Received: (qmail 13247 invoked by uid 500); 29 Sep 2009 22:39:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13161 invoked by uid 500); 29 Sep 2009 22:39:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13150 invoked by uid 99); 29 Sep 2009 22:39:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 22:39:34 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 22:39:22 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 57B0D45ED6A;
	Wed, 30 Sep 2009 00:39:02 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id UvOCvG11OywK; Wed, 30 Sep 2009 00:38:52 +0200 (CEST)
Received: from VEGA (unknown [82.113.121.127])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 727AED36001;
	Wed, 30 Sep 2009 00:38:51 +0200 (CEST)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>,
	<paul_t100@fastmail.fm>
References: <4AC28740.9010906@fastmail.fm>
Subject: RE: Problem searching non analyzed fields
Date: Wed, 30 Sep 2009 00:38:46 +0200
Message-ID: <370849CBEFDD469B975A58FF6F985829@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <4AC28740.9010906@fastmail.fm>
Thread-Index: AcpBUp4nq2AsHVEfStSTOeN78gYZYgAAhwXw
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hallo,

If you do not analyze fields during indexing, you cannot really use
QueryParser on the search side (because the QueryParser itsself always
analyzes the entered query string).

If you added some fields using NOT_ANALYZED, just use a simple "new
TermQuery(new Term(field, term))" to search for them. This is simplier and
does not analyze. If you are creating such queries programmatically and have
special "id" fields, it is the classical case for TermQueries.

Or, as Robert said, use an Analyzer, but use a special one, not corrupting
your ASINs.

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Paul Taylor [mailto:paul_t100@fastmail.fm]
> Sent: Wednesday, September 30, 2009 12:17 AM
> To: java-user@lucene.apache.org
> Subject: Problem searching non analyzed fields
> 
> I  use the same Analyzer for both creating an index and searching
> however I'm having a problem with some fields that I added with
> Field.Index.NOT_ANALYZED, how can I enforce they are also search without
> being analysed.
> 
> I did this for some fields containg Guids and products codes because I
> didn't want them modifying/tokenizing at all and it works fine for
> Guids, however one of these fields contains Amazon Id of B00004Y6O9 and
> I think when I search for this it fails because the analyzer I'm using
> lowercases all text and nowhere do I specify when parsing not to use the
> analyzer when searching, but of course its not getting lowercased when
> added to the index.
> 
> code extract:
> IndexSearcher is = IndexSearcher(IndexReader.open(new NIOFSDirectory(new
> File(indexDir + '/' + indexName + '/'), null), true));
> QueryParser qp = new QueryParser(defaultFields.get(0), analyzer);
> TopScoreDocCollector collector = TopScoreDocCollector.create(offset +
> limit, true);
> searcher.search(parser.parse(query), collector);
> 
> So how do I tell the parser not to analyse some fields, Im guessing the
> idea  is to subclass the QueryParser  but how, or should I be using
> Field.Index.ANALYZED when adding to the index
> 
> thanks Paul
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42512-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Sep 29 23:02:14 2009
Return-Path: <java-user-return-42512-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92626 invoked from network); 29 Sep 2009 23:02:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Sep 2009 23:02:13 -0000
Received: (qmail 35950 invoked by uid 500); 29 Sep 2009 23:02:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35885 invoked by uid 500); 29 Sep 2009 23:02:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35875 invoked by uid 99); 29 Sep 2009 23:02:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 23:02:11 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.211.182 as permitted sender)
Received: from [209.85.211.182] (HELO mail-yw0-f182.google.com) (209.85.211.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Sep 2009 23:02:03 +0000
Received: by ywh12 with SMTP id 12so5647256ywh.21
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 16:01:42 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=3OoBpUCitFG6eqYtC4eOZjDi/NRf8RduIZ/Xg3t8qsM=;
        b=H+/yvF0MmKDTU2FrjOhrxdx3fhshcFHAYdh39oKfAN+54Mgg0KMnuTac+dhGatNOXJ
         X/gF80DpJbip+CnfAQcVqXsXlVhwUj7AdfssKkl0yvVJvqwoO3KXcDYTaK+67lTiM68y
         K2TWmpA19vLwwmYbUp6lYW86eFrWMy2u1I76w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=u6ZvAfaAJ7CMUkm53zxJUKiwp4LxcXcszqeV/+GYtKg5ptpD/K1pepYJ6oR1yhjRA/
         FLHoSTwtvdyWz/vlky61PzXzuMUUQrpXIsJAPdpsL6o42KZ/3SnFaXsw+6su0sOy7LLh
         5Yrlznd821JmneeNkuHvgj9eCV4do/3bbEtnk=
MIME-Version: 1.0
Received: by 10.100.62.1 with SMTP id k1mr5176384ana.106.1254265302711; Tue, 
	29 Sep 2009 16:01:42 -0700 (PDT)
In-Reply-To: <14f35510909290939o428237d4vc8fff44cbb0a24fd@mail.gmail.com>
References: <14f35510909251011u5f6a036w5323f34f32c6a292@mail.gmail.com>
	 <ED081AC9AEEE0248BBCCDE9989AAE3FC0151FE6B@rw-ex2003.BROADVISION.COM>
	 <14f35510909251038t114626a0red4f4c49606ada22@mail.gmail.com>
	 <8f0ad1f30909251042w233220f6md6705ffd6715cc6d@mail.gmail.com>
	 <14f35510909290939o428237d4vc8fff44cbb0a24fd@mail.gmail.com>
Date: Tue, 29 Sep 2009 19:01:42 -0400
Message-ID: <8f0ad1f30909291601m3ec54ee2mf5a64e690c046766@mail.gmail.com>
Subject: Re: Search with whitespaces
From: Robert Muir <rcmuir@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00c09f8fe6bed27e870474bf658c
X-Virus-Checked: Checked by ClamAV on apache.org

--00c09f8fe6bed27e870474bf658c
Content-Type: text/plain; charset=UTF-8

Alex, to fix your compile problem, check to see if you have lucene 2.9 core
in your classpath.
The analyzers contrib depends upon this.

If you fix it so you can change TOKEN_SEPARATOR, maybe you want to submit a
patch? :)

On Tue, Sep 29, 2009 at 12:39 PM, Alex Bredariol Grilo <abgrilo@gmail.com>wrote:

> To use ShingleFilter, I'd like to change its TOKEN_SEPARATOR, but it's
> final. Furthermore, I tryed to compile its source code but the compiler
> isn't finding some methods like addAtribute.
> Does someone know how could I do that?
>
> Alex
>
> On Fri, Sep 25, 2009 at 2:42 PM, Robert Muir <rcmuir@gmail.com> wrote:
>
> > i might suggest the shingle package in lucene's contrib for this case.
> >
> > > like to do it for a general case, like trying to search the words
> joining
> > > > the word before or after.
> > > >
> > > > How could I do that? Is there an analyzer which tokenize like that?
> > > >
> > > > Thank you
> > > >
> > > >
> > > > Alex
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > >
> > >
> > > --
> > > Alex
> > >
> >
> >
> >
> > --
> > Robert Muir
> > rcmuir@gmail.com
> >
>
>
>
> --
> Alex
>



-- 
Robert Muir
rcmuir@gmail.com

--00c09f8fe6bed27e870474bf658c--

From java-user-return-42513-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 00:38:07 2009
Return-Path: <java-user-return-42513-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19093 invoked from network); 30 Sep 2009 00:38:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 00:38:07 -0000
Received: (qmail 8804 invoked by uid 500); 30 Sep 2009 00:38:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8705 invoked by uid 500); 30 Sep 2009 00:38:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8695 invoked by uid 99); 30 Sep 2009 00:38:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 00:38:05 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ihasmax@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 00:37:57 +0000
Received: by fxm2 with SMTP id 2so5107960fxm.28
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 17:37:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=ekyDlXW/WK/0n6ckUS3hvTfjcto1panYIx15/YVtht4=;
        b=bitJkeq9Io0+hOK44uplB/mXO2tFj6qPz8hwlrhpYIJTUKTUoZ/GAIyJH1U32n+AID
         GVwtcU46VEpXS69h2zKFlKngILpMGmLjzUo4WK/jvCg4ZlLKMWn4lnxjhLalvq6er0SS
         M5NgyLB4sD/OihUIFXZxRFI9w3lxy51CYwU9c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=YVLyb1PxFuRDO6hYPtIBJccQ5HACiu8VJhk247ce1TTMarCulEEng9O4itn5g0PI6X
         PhhFjuRPbHEpsPberYPIr6X5UTzX3AgdE8jR+AlPIX2ePvBpV4G0nHkkmNIymqpLZ9ti
         DB1mDHb5Yemh2KLWM5tfbARQyYc3hd3WfUZxs=
MIME-Version: 1.0
Received: by 10.103.78.7 with SMTP id f7mr2021561mul.95.1254271055583; Tue, 29 
	Sep 2009 17:37:35 -0700 (PDT)
Date: Tue, 29 Sep 2009 19:37:35 -0500
Message-ID: <3836ec640909291737k9cc14c5v88b7beae5ec5459@mail.gmail.com>
Subject: TopDocCollector limits
From: Max Lynch <ihasmax@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163645907ab85af10474c0bc61
X-Virus-Checked: Checked by ClamAV on apache.org

--00163645907ab85af10474c0bc61
Content-Type: text/plain; charset=ISO-8859-1

Hi,
I am developing a search system that doesn't do pagination (searches are run
in the background and machine analyzed).  However, TopDocCollector makes me
put a limit on how many results I want back.  For my system, each result
found is important.  How can I make it collect every result found?

Thanks.

--00163645907ab85af10474c0bc61--

From java-user-return-42514-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 00:40:41 2009
Return-Path: <java-user-return-42514-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19697 invoked from network); 30 Sep 2009 00:40:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 00:40:40 -0000
Received: (qmail 13140 invoked by uid 500); 30 Sep 2009 00:40:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13067 invoked by uid 500); 30 Sep 2009 00:40:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13057 invoked by uid 99); 30 Sep 2009 00:40:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 00:40:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 00:40:27 +0000
Received: by qw-out-2122.google.com with SMTP id 5so2032311qwi.53
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 17:40:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=NyJle9PI6iDrCm4oMxFptt8dN4N9ARZPZRbxEE6E1mk=;
        b=ejkP//OdXsxBAU8dkR4w+YXUapWkVIlItI/OrG6hmEzgS638SylVD31QedYfmjS8CP
         JRtq83MtrYDKbSI4wvDyTvnmrTJZvYgxPz8jqNgjXAcM1GcOO/zE/Rtx5hqLwiFtA9cL
         HQr462Kwz1RNEPmb1/2MYZHwmqqtNE4T2FRdo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=n67LUwt+DrJcmXukOKrp0jax8nwC9ZO6gcA79WBWgAn8QWGCL9V0otFtCmnr4yEz3P
         qvB/YQMoCgQYUCR/w9jV5D82ji+QSn64dZGgpV8FGp2irKiIHgyt47kd0DrV27/eXHfk
         GTG5wrQHelvpCCmRKZcnnJCIwgr20IykUAFwM=
Received: by 10.224.101.132 with SMTP id c4mr4711953qao.377.1254271206529;
        Tue, 29 Sep 2009 17:40:06 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 7sm164881qwb.21.2009.09.29.17.40.04
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 29 Sep 2009 17:40:05 -0700 (PDT)
Message-ID: <4AC2A8E8.4090209@gmail.com>
Date: Tue, 29 Sep 2009 20:40:08 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: TopDocCollector limits
References: <3836ec640909291737k9cc14c5v88b7beae5ec5459@mail.gmail.com>
In-Reply-To: <3836ec640909291737k9cc14c5v88b7beae5ec5459@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Max Lynch wrote:
> Hi,
> I am developing a search system that doesn't do pagination (searches are run
> in the background and machine analyzed).  However, TopDocCollector makes me
> put a limit on how many results I want back.  For my system, each result
> found is important.  How can I make it collect every result found?
>
> Thanks.
>
>   
You would want to use a Collector in 2.9 or HitCollector < 2.9 most likely.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42515-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 03:55:18 2009
Return-Path: <java-user-return-42515-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93353 invoked from network); 30 Sep 2009 03:55:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 03:55:18 -0000
Received: (qmail 34107 invoked by uid 500); 30 Sep 2009 03:55:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34021 invoked by uid 500); 30 Sep 2009 03:55:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34011 invoked by uid 99); 30 Sep 2009 03:55:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 03:55:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ihasmax@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 03:55:04 +0000
Received: by bwz10 with SMTP id 10so4964688bwz.5
        for <java-user@lucene.apache.org>; Tue, 29 Sep 2009 20:54:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=2/zlJDLf/bda24v9GtgWAuizRQHHlqzfSUV2TbJKauA=;
        b=Mykec2RtZshM0pKYc2XZpJQ2s7WMeBmWgXibVSKFYZ4I2BMW/NWObilH9928zcsYUD
         z/WuDLppAKBfvV/PAMH9wRsVeTqNX6B93FBesGyRv7sNQ0PTIy9IBkTarjgC+sTnvWBU
         9Wdiz8j6EYJT4Pr6tnV/bGqE4+77R0JlJ706s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=LjVenWLvIDYWi1ipZdcqbUW0zp38a3y0vSGLkMe7EZ+aDAuQTsbrUWdA5g/jsB25UZ
         X3UTNgi+m9UCvyZXkx/eWpu89Ksw5rZlMC3MBVpqWBG+m2A3GSpHq9ycj6b5bOcbEi+o
         Xgs8JuPDs3QGMpEPny8NYf7cys5oePfvG0dhg=
MIME-Version: 1.0
Received: by 10.103.126.33 with SMTP id d33mr2102985mun.109.1254282883920; 
	Tue, 29 Sep 2009 20:54:43 -0700 (PDT)
Date: Tue, 29 Sep 2009 22:54:43 -0500
Message-ID: <3836ec640909292054h4e92715bq1ae1b373f79ebf30@mail.gmail.com>
Subject: Whitespace/Standard Analyzer and punctuation
From: Max Lynch <ihasmax@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e65b3ffcbe734b0474c37d7f
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e65b3ffcbe734b0474c37d7f
Content-Type: text/plain; charset=ISO-8859-1

I would like my searches to match "John Smith" when John Smith is in a
document, but not separated with punctuation.  For example, when I was using
StandardAnalyzer, "John. Smith" was matching, which is wrong for me.  Right
now I am using WhitespaceAnalyzer but instead searching for "John Smith"
"John Smith." "John Smith," etc., which seems like a dumb thing to be
doing.  Can I separate the punctuation but keep the analyzer aware of where
the punctuation occurred in my matching term?

Thanks.

--0016e65b3ffcbe734b0474c37d7f--

From java-user-return-42516-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 08:56:18 2009
Return-Path: <java-user-return-42516-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80807 invoked from network); 30 Sep 2009 08:56:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 08:56:18 -0000
Received: (qmail 91447 invoked by uid 500); 30 Sep 2009 08:56:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91375 invoked by uid 500); 30 Sep 2009 08:56:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91365 invoked by uid 99); 30 Sep 2009 08:56:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 08:56:16 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 08:56:07 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 3A7877E11F
	for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 04:55:46 -0400 (EDT)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Wed, 30 Sep 2009 04:55:46 -0400
X-Sasl-enc: xTK6gVFxY0jI0jZON2p09BkJkxNjiiRbJGdc3QDBXYKl 1254300945
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id AE9FD1072
	for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 04:55:45 -0400 (EDT)
Message-ID: <4AC31D11.7040502@fastmail.fm>
Date: Wed, 30 Sep 2009 09:55:45 +0100
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Problem searching non analyzed fields
References: <4AC28740.9010906@fastmail.fm> <8f0ad1f30909291523ud565609wd543dc228aa2f297@mail.gmail.com>
In-Reply-To: <8f0ad1f30909291523ud565609wd543dc228aa2f297@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Robert Muir wrote:
> try checking out PerFieldAnalyzerWrapper, so you can specify how each field
> is handled, i.e. some fields with KeywordAnalyzer, other fields with
> StandardAnalyzer, etc.
Thanks, yes actually I realize these fields do need some analysis 
because I want to the search to be case insensitive, so Im going to 
create my own analyzer like KeywordAnalyzer but with additional 
LowercaseFilter, and then  use with PerFieldAnalyserWrapper as suggested.

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42517-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 09:28:07 2009
Return-Path: <java-user-return-42517-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92709 invoked from network); 30 Sep 2009 09:28:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 09:28:07 -0000
Received: (qmail 40149 invoked by uid 500); 30 Sep 2009 09:28:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40077 invoked by uid 500); 30 Sep 2009 09:28:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40067 invoked by uid 99); 30 Sep 2009 09:28:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 09:28:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 09:27:55 +0000
Received: by ey-out-2122.google.com with SMTP id 22so1407182eye.3
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 02:27:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=7BhoOZdkYjgiMSSza+pKs2X+y3RqfQNBkQU9N8Nqqcw=;
        b=a2dU6rfJNfp0HnGO3dOnxcofHeT4ca0Kimgo+vQI01BkiG5MHXty1AH5CwOne6pJQy
         seosyELj+MpCvwsjAA16AAIAMrykzK5RxiBZ/OwqGsdt5SZfoVbnUb9ddJ3neDLxhcs9
         hixsUOODHapgEg9vCw0k6M6YgI73EIeqwHvYE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=H1RcPxqR2OvaztbFtKSuu1wTp+kjkkMXk9+zWm/WnNpRcWneUn9pNVZxtbwvOYWCtF
         Y7acrqLOnzFtKblzZUxw/kAijOblkqyqlVkTZJp90MDmi+rOOXCParKywo3NSskySOP1
         KcaWm7E/ae/XTxGuITX+7yz6ju3gNmvY2Mpg8=
Received: by 10.210.32.28 with SMTP id f28mr5970906ebf.25.1254302854308;
        Wed, 30 Sep 2009 02:27:34 -0700 (PDT)
Received: from ?192.168.1.9? (h60n1fls33o272.telia.com [217.210.38.60])
        by mx.google.com with ESMTPS id 7sm2094971eyb.44.2009.09.30.02.27.32
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 30 Sep 2009 02:27:33 -0700 (PDT)
Message-Id: <DA82602E-727E-4F8A-B947-5BA2D481BE11@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <3836ec640909292054h4e92715bq1ae1b373f79ebf30@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Whitespace/Standard Analyzer and punctuation
Date: Wed, 30 Sep 2009 11:27:30 +0200
References: <3836ec640909292054h4e92715bq1ae1b373f79ebf30@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

You could look in to modifying the standard tokenizer lexer code to  
handle punctuation (there is a patch in the isssue tracker for the old  
javacc grammer to handle punctuation) and there is also the Gate NLP  
project which has a fairly nice sentence splitter you might find  
useful. Add a whole bunch of position increment between your sentences  
and limit your searches to how much distance you allow for a hit.

I hope this helps.


        karl


30 sep 2009 kl. 05.54 skrev Max Lynch:

> I would like my searches to match "John Smith" when John Smith is in a
> document, but not separated with punctuation.  For example, when I  
> was using
> StandardAnalyzer, "John. Smith" was matching, which is wrong for  
> me.  Right
> now I am using WhitespaceAnalyzer but instead searching for "John  
> Smith"
> "John Smith." "John Smith," etc., which seems like a dumb thing to be
> doing.  Can I separate the punctuation but keep the analyzer aware  
> of where
> the punctuation occurred in my matching term?
>
> Thanks.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42518-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 09:44:01 2009
Return-Path: <java-user-return-42518-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96880 invoked from network); 30 Sep 2009 09:44:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 09:44:01 -0000
Received: (qmail 66589 invoked by uid 500); 30 Sep 2009 09:43:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66529 invoked by uid 500); 30 Sep 2009 09:43:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66519 invoked by uid 99); 30 Sep 2009 09:43:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 09:43:58 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [217.146.182.39] (HELO web27107.mail.ukl.yahoo.com) (217.146.182.39)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 30 Sep 2009 09:43:49 +0000
Received: (qmail 29288 invoked by uid 60001); 30 Sep 2009 09:43:26 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1254303806; bh=W4qOxpLVVJqHW+Rsxz0uQmpcwlyU+7Ncx+iWXtyAs3A=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=0oDtA4eIIqHAMjVRn51+H6Ly+ihPfwnF+PsmyNeV4Dbrq0xMEppySLBWvErQuLQ8pdlPCqzoYtqb3us7nxWLCY6AhlbNG9NuMtBTLwhxq55FZPH8MeI7ryw+Jav0nFN1JVKlGqlZzpFtQdOk5sWJCW0N8GNTUKVO1qg90GhrTM8=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=mm62Snyo9Nc2zADZjP3kZ/lJ0xNZ0swIMrJNffgIF8Wwk4omJ4k4dEmovXvUmhFHHMiLvQlxQNvQt6v6iBylXbCfGNR2Ip4ygFkiE2riyXJDlf4Nm6VKp/iErgWk8vUOn/IoMN6TOtIBJNVfipgptF3v+R0j6LA5PUpin+PMIY0=;
Message-ID: <519397.28615.qm@web27107.mail.ukl.yahoo.com>
X-YMail-OSG: mbYmzD0VM1nPUWJBkuen1QD3CwFlf5tjGv6zTHKLV6VEdVep0zmf_xsA6tvL5RQLtkvm3MtkpvofCTiGOhVGXirQ0cyEUagkigplM.POkN5DQAIL3kjMSsQpQgDhxv9dMapBdkm2yVoJsR.0.Nhj.Mfj5LMX90Q0BoprOR_aV0_tlxO96DBnQqNN_Du7e3zMmPSpcTqGNPYDn3xGJbSfL_l_UioGJlXMS2NxzDUNHCPTchas2aeiskjQzYG1UAQNxw_JIMLavYOwpSxV5CIk0lMmiVPusBgMiMuQAleQKJbI_djZzDhyS9.Vwayqs4t8VVvg
Received: from [88.128.90.166] by web27107.mail.ukl.yahoo.com via HTTP; Wed, 30 Sep 2009 09:43:26 GMT
X-Mailer: YahooMailRC/157.18 YahooMailWebService/0.7.347.3
References: <782167355.1253969596054.JavaMail.jira@brutus>
Date: Wed, 30 Sep 2009 09:43:26 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: TSDC, TopFieldCollector & co
To: java-user@lucene.apache.org
In-Reply-To: <782167355.1253969596054.JavaMail.jira@brutus>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All, =0A=0AWhat is the best way to achieve the following and what are th=
e differences, if I say "I do not normalize scores, so I do not need max sc=
ore tracking, I do not care if hits are returned in doc id order, or any ot=
her order. I need only to get maxDocs *best scoring* documents":=0A=0AOPTIO=
N 1:=0ATopDocs top =3D ixSearcher.search(q, filter, maxDocs);=0A=0AOPTION 2=
:=0A   final TopScoreDocCollector tfc =3D TopScoreDocCollector.create(maxDo=
cs, false);=0A    ixSearcher.search(q, filter, tfc);=0A    TopDocs top =3D =
tfc.topDocs();=0A=0A=0AOPTION 3:    =0A    final TopFieldCollector tfc =3D =
TopFieldCollector.create(Sort.RELEVANCE, maxDocs, =0A        false  /* fill=
Fields */,=0A        true   /* trackDocScores */,=0A        false   /* trac=
kMaxScore */,=0A        false  /* docsInOrder */);=0A=0A    ixSearcher.sear=
ch(q.weight(ixSearcher),filter, tfc);=0A    TopDocs top =3D tfc.topDocs();=
=0A=0A=0Awhat are the pros and cons?=0AIf I read javadoc correctly, =0A- OP=
TION 1 tracks max score and delivers doc Ids in order (suboptimal performan=
ce for my case)   =0A- OPTION 2 I do not know abut max score tracking, but =
doc Ids are not required to be in order=0A- OPTION 3 looks like exactly wha=
t I want, but one performance comment in javadoc about Sort.RELEVANCE made =
me think if that is the fastest way? =0A=0AWhat would be recommended here, =
any other options to achieve the fastest search with above defined conditio=
ns (no max score tracking and doc id order irrelevant)?  OPTIN2 looks nice,=
 but as said, I am not sure about max score tracking?=0A=0AThanks,=0Aeks=0A=
=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42519-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 10:30:32 2009
Return-Path: <java-user-return-42519-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9552 invoked from network); 30 Sep 2009 10:30:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 10:30:32 -0000
Received: (qmail 16564 invoked by uid 500); 30 Sep 2009 10:30:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16488 invoked by uid 500); 30 Sep 2009 10:30:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16477 invoked by uid 99); 30 Sep 2009 10:30:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 10:30:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of iron9light@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 10:30:20 +0000
Received: by fxm2 with SMTP id 2so5348691fxm.28
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 03:30:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=8APaTR4mhTjeqhrblMU3ix/yjxp6a0UBBwB2HFs43hE=;
        b=i5L/KyhGv9HHFaLMiyOxD6QzEX1x8+FnsiPq/NWqWVpxA5ixm1Av0tb2ZDnVIKeu7Q
         VT6oszC89R9mX6M2xj+8sNOtDxhcgwYjUICWTOGfp7V2L1iCdqNQhPY6n402LmUTq5SF
         HIAKJqe7MGVBXG38MvCoc+SP3t++ez0DbD/64=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=pbICWWB9qkkZg5jaNnLT77xdZJWLfCsyzHzKnparlkQWbtoBHYwIjX8TdTPMHXbFqf
         VVef4KbYmqiOwo1sKl94RLNXjFNixhOp5OlJXuL8Sr+Vpl0Qui9LUYnzhtkkfRa7bqIA
         sVq2y9MUaWsbdIXrWMXhQvgckf/jbrKUpzq8o=
MIME-Version: 1.0
Received: by 10.239.170.20 with SMTP id q20mr467016hbe.152.1254306598826; Wed, 
	30 Sep 2009 03:29:58 -0700 (PDT)
Date: Wed, 30 Sep 2009 19:29:58 +0900
Message-ID: <893c4af60909300329u1511b49dl44affc66024d3338@mail.gmail.com>
Subject: How does the term infos file (.tis) works?
From: iron light <iron9light@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f2776843359c0474c9031e
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f2776843359c0474c9031e
Content-Type: text/plain; charset=UTF-8

I try to traverse all the term text in one tis files. And it failed. the
code is below.
Does I misunderstand something?
The source code (especial the index namespace) is very complicated for me.
Is there any more document about the design and something can help me
understand the source?

Thanks.

    public static void main(String[] args) throws IOException {
        File path = new File("../../wiki/index").getCanonicalFile();
        FSDirectory directory = FSDirectory.open(path);
        IndexInput input = directory.openInput("_1ck.tis");
        System.out.println(input.readInt());
        System.out.println(input.readLong());
        System.out.println(input.readInt());
        System.out.println(input.readInt());
        System.out.println(input.readInt());

        String text = "";
        for(int i = 0; i < 10; ++i){
            TermInfo termInfo = new TermInfo(input);
            text = text.substring(0, termInfo.term.prefixLength) +
termInfo.term.suffix;
            System.out.println(text);
        }
    }

    private static class Term {
        public int prefixLength;
        public String suffix;
        public int fieldNum;
        Term(IndexInput input) throws IOException {
            this.prefixLength = input.readVInt();
            this.suffix = input.readString();
            this.fieldNum = input.readVInt();
        }
    }

    private static class TermInfo {
        public Term term;
        public int docFreq, freqDelta, proxDelta, skipDelta;
        TermInfo(IndexInput input) throws IOException {
            this.term = new Term(input);
            this.docFreq = input.readVInt();
            this.freqDelta = input.readVInt();
            this.proxDelta = input.readVInt();
            this.skipDelta = input.readVInt();
        }
    }

--001485f2776843359c0474c9031e--

From java-user-return-42520-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 10:57:46 2009
Return-Path: <java-user-return-42520-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14312 invoked from network); 30 Sep 2009 10:57:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 10:57:46 -0000
Received: (qmail 51814 invoked by uid 500); 30 Sep 2009 10:57:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51721 invoked by uid 500); 30 Sep 2009 10:57:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51710 invoked by uid 99); 30 Sep 2009 10:57:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 10:57:44 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.182.38] (HELO web27106.mail.ukl.yahoo.com) (217.146.182.38)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 30 Sep 2009 10:57:33 +0000
Received: (qmail 40914 invoked by uid 60001); 30 Sep 2009 10:57:11 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1254308231; bh=r730jD+2wyCrLmfjeHmWWR9654JG1xLvsXJaSPAoXp4=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=zA7kBwN+NNLmI37GT8tmgTlTrbzqZ5Um1OZz9xJepy0DCwGD5D1SwHyHrDXWl4Vb0uUDTabLFMR5RyqQtCF+a+iB7C+qHh93wvn3k6i0SfDfYqGxsCXcNUylggRA7P4SVBeVwVSJbgYzyZpLJIomKYrzhGQBq6/SKzqzTt14Oho=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=2WzRBLbQ+eHZcgJMUVsoTM6KUQ606cscy8lXY0Sxb401Jlr4Y2r9W84J5Lo+One5CxEvTZ7Eo+KIbwLPQYn5ndF2me1esUPnWT6oAn6WcKv2ddfHOMSjV70NMqltLCJwp/x7aFSY03ktOdsLcnxawZAVnFZiCtNTmKNiAa49lj4=;
Message-ID: <321621.40786.qm@web27106.mail.ukl.yahoo.com>
X-YMail-OSG: OTey9yIVM1m_bu8.D1IqM14JkNYbiKvbpkds6blz.1RS.XhUWPA_1xyNaziiEuhx9Kgyoto8KiEnzqkK.gCu1nKZiHuhtBidVMZNTVtJ0jC_n6vhoZg10HhDQ892R9o5JFHs4m.lO_8KOQYxwEKFvFpDGxuJihatIQIAJRizFURDxXsTRevXmlPr4EkylxunzGD2bi39xEPEok0ueM.iOcpxGTHNfG3M9ho7YDeJKvrU0kyqScUJu5cJpBvMshGA4T3H.JP_K_sHnqCR6XlEGV_o9m8eIUwhic0wsTSLF9PhiaqK8kwlqBrH1Vz9npjO7trr10_viT0Zq76xA.mUbdl6n2JKFCoIYCTEeIw-
Received: from [88.128.90.166] by web27106.mail.ukl.yahoo.com via HTTP; Wed, 30 Sep 2009 10:57:11 GMT
X-Mailer: YahooMailRC/157.18 YahooMailWebService/0.7.347.3
References: <782167355.1253969596054.JavaMail.jira@brutus> <519397.28615.qm@web27107.mail.ukl.yahoo.com>
Date: Wed, 30 Sep 2009 10:57:11 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: Re: TSDC, TopFieldCollector & co
To: java-user@lucene.apache.org
In-Reply-To: <519397.28615.qm@web27107.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

and another question, is it somehow possible to reuse TopScoreDocCollector =
instance? =0A=0AJavadoc in create(...) warns about allocating full array. =
=0A=0A<p><b>NOTE</b>: The instances returned by this method=0A   * pre-allo=
cate a full array of length=0A   * <code>numHits</code>, and fill the array=
 with sentinel=0A   * objects.=0A =0A=0A=0A=0A=0A=0A----- Original Message =
----=0A> From: eks dev <eksdev@yahoo.co.uk>=0A> To: java-user@lucene.apache=
.org=0A> Sent: Wednesday, 30 September, 2009 11:43:26=0A> Subject: TSDC, To=
pFieldCollector & co=0A> =0A> Hi All, =0A> =0A> What is the best way to ach=
ieve the following and what are the differences, if I =0A> say "I do not no=
rmalize scores, so I do not need max score tracking, I do not =0A> care if =
hits are returned in doc id order, or any other order. I need only to =0A> =
get maxDocs *best scoring* documents":=0A> =0A> OPTION 1:=0A> TopDocs top =
=3D ixSearcher.search(q, filter, maxDocs);=0A> =0A> OPTION 2:=0A>    final =
TopScoreDocCollector tfc =3D TopScoreDocCollector.create(maxDocs, false);=
=0A>     ixSearcher.search(q, filter, tfc);=0A>     TopDocs top =3D tfc.top=
Docs();=0A> =0A> =0A> OPTION 3:    =0A>     final TopFieldCollector tfc =3D=
 TopFieldCollector.create(Sort.RELEVANCE, =0A> maxDocs, =0A>         false =
 /* fillFields */,=0A>         true   /* trackDocScores */,=0A>         fal=
se   /* trackMaxScore */,=0A>         false  /* docsInOrder */);=0A> =0A>  =
   ixSearcher.search(q.weight(ixSearcher),filter, tfc);=0A>     TopDocs top=
 =3D tfc.topDocs();=0A> =0A> =0A> what are the pros and cons?=0A> If I read=
 javadoc correctly, =0A> - OPTION 1 tracks max score and delivers doc Ids i=
n order (suboptimal =0A> performance for my case)  =0A> - OPTION 2 I do not=
 know abut max score tracking, but doc Ids are not required =0A> to be in o=
rder=0A> - OPTION 3 looks like exactly what I want, but one performance com=
ment in =0A> javadoc about Sort.RELEVANCE made me think if that is the fast=
est way? =0A> =0A> What would be recommended here, any other options to ach=
ieve the fastest search =0A> with above defined conditions (no max score tr=
acking and doc id order =0A> irrelevant)?  OPTIN2 looks nice, but as said, =
I am not sure about max score =0A> tracking?=0A> =0A> Thanks,=0A> eks=0A> =
=0A> =0A> =0A> =0A> -------------------------------------------------------=
--------------=0A> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apa=
che.org=0A> For additional commands, e-mail: java-user-help@lucene.apache.o=
rg=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42521-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 14:57:57 2009
Return-Path: <java-user-return-42521-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96759 invoked from network); 30 Sep 2009 14:57:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 14:57:56 -0000
Received: (qmail 21718 invoked by uid 500); 30 Sep 2009 14:57:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21662 invoked by uid 500); 30 Sep 2009 14:57:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21652 invoked by uid 99); 30 Sep 2009 14:57:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 14:57:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 14:57:44 +0000
Received: by fxm2 with SMTP id 2so5560094fxm.28
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 07:57:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=YXhcMWwog4LXn3tyeRWeBAbl9ORlIjPbhVvZ5iadAcA=;
        b=tpsBZLQsFJzFblOglaWhCt/HX2QisxzqybA8SlZpcjc/F3L5RapP4RSJMkeYdAFzLS
         A6soQiecrg5wp8fT0Aw5mh0SmleT18Jh20o+G4TSBfI3z7TBu+EKyGgC6lwZxwOyMG90
         3M5c7sAYszF4MvXN1N7f5a772btL5Skq8PaPU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=BDOUpLl2m+ZFtBJba/5EgNp+kug+C2J9V6clXWp4TJiHShrvZxUvRKlAAVFRD6X+Wx
         kI0NeTcDZwyX3xZzNTR3xU2jky0SCsVuAChG+/2n+ner1kpCOsPs4uAM1EDFIf1aP2b+
         CRLzD30KgT3Y0xlvRseJOtJPUZQZmWL7MrkO4=
Received: by 10.86.226.5 with SMTP id y5mr52902fgg.36.1254322642548;
        Wed, 30 Sep 2009 07:57:22 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 12sm72086fgg.8.2009.09.30.07.57.18
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 30 Sep 2009 07:57:19 -0700 (PDT)
Message-ID: <4AC371CD.8060601@gmail.com>
Date: Wed, 30 Sep 2009 10:57:17 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: TSDC, TopFieldCollector & co
References: <782167355.1253969596054.JavaMail.jira@brutus> <519397.28615.qm@web27107.mail.ukl.yahoo.com>
In-Reply-To: <519397.28615.qm@web27107.mail.ukl.yahoo.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

If you want relevance sorting (Sort.Score not Sort.Relevance right?),
I'd think you want to use TopScoreDocCollector, not TopFieldCollector.
The only reason to use relevance with TopFieldCollector is if you you
are doing a nth sort with a field sort as well.

You don't really need to worry about things like turning off the max
score tracking here - its just going to be the first doc on the queue.

You also do want to specify whether or not to collect docs in order if
you care about performance:

  public static TopScoreDocCollector create(int numHits, boolean
docsScoredInOrder)

ie:

TopScoreDocCollector.create(nDocs, !weight.scoresDocsOutOfOrder());

Which means you just want option 1.

-- 
- Mark

http://www.lucidimagination.com



eks dev wrote:
> Hi All, 
>
> What is the best way to achieve the following and what are the differences, if I say "I do not normalize scores, so I do not need max score tracking, I do not care if hits are returned in doc id order, or any other order. I need only to get maxDocs *best scoring* documents":
>
> OPTION 1:
> TopDocs top = ixSearcher.search(q, filter, maxDocs);
>
> OPTION 2:
>    final TopScoreDocCollector tfc = TopScoreDocCollector.create(maxDocs, false);
>     ixSearcher.search(q, filter, tfc);
>     TopDocs top = tfc.topDocs();
>
>
> OPTION 3:    
>     final TopFieldCollector tfc = TopFieldCollector.create(Sort.RELEVANCE, maxDocs, 
>         false  /* fillFields */,
>         true   /* trackDocScores */,
>         false   /* trackMaxScore */,
>         false  /* docsInOrder */);
>
>     ixSearcher.search(q.weight(ixSearcher),filter, tfc);
>     TopDocs top = tfc.topDocs();
>
>
> what are the pros and cons?
> If I read javadoc correctly, 
> - OPTION 1 tracks max score and delivers doc Ids in order (suboptimal performance for my case)   
> - OPTION 2 I do not know abut max score tracking, but doc Ids are not required to be in order
> - OPTION 3 looks like exactly what I want, but one performance comment in javadoc about Sort.RELEVANCE made me think if that is the fastest way? 
>
> What would be recommended here, any other options to achieve the fastest search with above defined conditions (no max score tracking and doc id order irrelevant)?  OPTIN2 looks nice, but as said, I am not sure about max score tracking?
>
> Thanks,
> eks
>
>
>       
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42522-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 15:13:11 2009
Return-Path: <java-user-return-42522-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1218 invoked from network); 30 Sep 2009 15:13:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 15:13:11 -0000
Received: (qmail 54401 invoked by uid 500); 30 Sep 2009 15:13:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54326 invoked by uid 500); 30 Sep 2009 15:13:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54316 invoked by uid 99); 30 Sep 2009 15:13:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 15:13:08 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.219 as permitted sender)
Received: from [209.85.219.219] (HELO mail-ew0-f219.google.com) (209.85.219.219)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 15:12:59 +0000
Received: by ewy19 with SMTP id 19so6595071ewy.28
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 08:12:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=JHe5stFkiyNxuNl+DkPbcGvHgiSui75AFxiy04QDUWg=;
        b=bFf5/ktZQ5MevObvGtKIv/rJEPkv/hW7IaYNwcW4QnsRau1E7i6N3HQG6GC/isXRc4
         08Gg4RdP8+3UmRqIA7VglOXUn8OpO5zj4NiBFBSBhePQChHPVcH8sbOxCWCaIn4fMsVw
         6+FKSeTNKE4pGz9r9bL7MPZ2vejJdM8G+N9C4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=bGZ7oGb+l2q7BkeEFFG9R+wC5FiBf4P8ZgMsFTkwhZsqpgz3DAlotSsqnro46lT3A0
         9pbGbdB61OA2s8uNR4zkmsaOhc389mfEIftqlEHitWTu3s9GaDRXucVylvHCPTynseu1
         6OJpT0Fkdmf9mIwdlnMbICTHf03sIvGc4kOFQ=
MIME-Version: 1.0
Received: by 10.216.86.195 with SMTP id w45mr1350943wee.82.1254323558240; Wed, 
	30 Sep 2009 08:12:38 -0700 (PDT)
In-Reply-To: <4AC371CD.8060601@gmail.com>
References: <782167355.1253969596054.JavaMail.jira@brutus>
	 <519397.28615.qm@web27107.mail.ukl.yahoo.com>
	 <4AC371CD.8060601@gmail.com>
Date: Wed, 30 Sep 2009 17:12:38 +0200
Message-ID: <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>
Subject: Re: TSDC, TopFieldCollector & co
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d7e06c1f53310474ccf68a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d7e06c1f53310474ccf68a
Content-Type: text/plain; charset=ISO-8859-1

I agree. If you need sort-by-score, it's better to use the "fast" search
methods. IndexSearcher will create the appropriate TSDC instance for you,
based on the Query that was passed.

If you need to create multiple Collectors and pass a kind of Multi-Collector
to IndexSearcher, then you should create TSDC according to Mark's example
above.

Shai

On Wed, Sep 30, 2009 at 4:57 PM, Mark Miller <markrmiller@gmail.com> wrote:

> If you want relevance sorting (Sort.Score not Sort.Relevance right?),
> I'd think you want to use TopScoreDocCollector, not TopFieldCollector.
> The only reason to use relevance with TopFieldCollector is if you you
> are doing a nth sort with a field sort as well.
>
> You don't really need to worry about things like turning off the max
> score tracking here - its just going to be the first doc on the queue.
>
> You also do want to specify whether or not to collect docs in order if
> you care about performance:
>
>  public static TopScoreDocCollector create(int numHits, boolean
> docsScoredInOrder)
>
> ie:
>
> TopScoreDocCollector.create(nDocs, !weight.scoresDocsOutOfOrder());
>
> Which means you just want option 1.
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
> eks dev wrote:
> > Hi All,
> >
> > What is the best way to achieve the following and what are the
> differences, if I say "I do not normalize scores, so I do not need max score
> tracking, I do not care if hits are returned in doc id order, or any other
> order. I need only to get maxDocs *best scoring* documents":
> >
> > OPTION 1:
> > TopDocs top = ixSearcher.search(q, filter, maxDocs);
> >
> > OPTION 2:
> >    final TopScoreDocCollector tfc = TopScoreDocCollector.create(maxDocs,
> false);
> >     ixSearcher.search(q, filter, tfc);
> >     TopDocs top = tfc.topDocs();
> >
> >
> > OPTION 3:
> >     final TopFieldCollector tfc =
> TopFieldCollector.create(Sort.RELEVANCE, maxDocs,
> >         false  /* fillFields */,
> >         true   /* trackDocScores */,
> >         false   /* trackMaxScore */,
> >         false  /* docsInOrder */);
> >
> >     ixSearcher.search(q.weight(ixSearcher),filter, tfc);
> >     TopDocs top = tfc.topDocs();
> >
> >
> > what are the pros and cons?
> > If I read javadoc correctly,
> > - OPTION 1 tracks max score and delivers doc Ids in order (suboptimal
> performance for my case)
> > - OPTION 2 I do not know abut max score tracking, but doc Ids are not
> required to be in order
> > - OPTION 3 looks like exactly what I want, but one performance comment in
> javadoc about Sort.RELEVANCE made me think if that is the fastest way?
> >
> > What would be recommended here, any other options to achieve the fastest
> search with above defined conditions (no max score tracking and doc id order
> irrelevant)?  OPTIN2 looks nice, but as said, I am not sure about max score
> tracking?
> >
> > Thanks,
> > eks
> >
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d7e06c1f53310474ccf68a--

From java-user-return-42523-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 15:13:14 2009
Return-Path: <java-user-return-42523-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1273 invoked from network); 30 Sep 2009 15:13:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 15:13:14 -0000
Received: (qmail 54633 invoked by uid 500); 30 Sep 2009 15:13:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54562 invoked by uid 500); 30 Sep 2009 15:13:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54461 invoked by uid 99); 30 Sep 2009 15:13:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 15:13:09 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jibojohn@mac.com designates 17.148.16.89 as permitted sender)
Received: from [17.148.16.89] (HELO asmtpout014.mac.com) (17.148.16.89)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 15:12:58 +0000
MIME-version: 1.0
Content-type: multipart/alternative;
 boundary="Boundary_(ID_NE4vcXRIP6rlqFdAJOGjhg)"
Received: from [17.151.87.106] by asmtp014.mac.com
 (Sun Java(tm) System Messaging Server 6.3-8.01 (built Dec 16 2008; 32bit))
 with ESMTPSA id <0KQS00J63I90YF90@asmtp014.mac.com> for
 java-user@lucene.apache.org; Wed, 30 Sep 2009 08:12:37 -0700 (PDT)
Message-id: <7D5102B9-C676-4210-A2DB-3BE1A14B1D33@mac.com>
From: Jibo John <jibojohn@mac.com>
To: java-user@lucene.apache.org
Subject: Results of setting LogMergePolicy "calibrateSizeByDeletes=true"
Date: Wed, 30 Sep 2009 08:12:36 -0700
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

--Boundary_(ID_NE4vcXRIP6rlqFdAJOGjhg)
Content-type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-transfer-encoding: 7BIT

Hello,

I am in the process of  trying out the lucene patch LUCENE-1634,  
however I'm not getting the expected behavior.
I  see that the segments are not getting merged even after all the  
documents are deleted from it.

Because of this, the index size really grows to a huge number. The  
expected  index size is 50- 60 GB, however, it went past beyond 115 GB  
and is still growing.

Any pointers will be helpful.

Thanks,
-Jibo


--Boundary_(ID_NE4vcXRIP6rlqFdAJOGjhg)--

From java-user-return-42524-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 15:27:05 2009
Return-Path: <java-user-return-42524-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5698 invoked from network); 30 Sep 2009 15:27:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 15:27:05 -0000
Received: (qmail 83205 invoked by uid 500); 30 Sep 2009 15:27:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83146 invoked by uid 500); 30 Sep 2009 15:27:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83136 invoked by uid 99); 30 Sep 2009 15:27:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 15:27:02 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.182.33] (HELO web27101.mail.ukl.yahoo.com) (217.146.182.33)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 30 Sep 2009 15:26:51 +0000
Received: (qmail 83882 invoked by uid 60001); 30 Sep 2009 15:26:29 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1254324389; bh=DtQEfp782MP8D9IV7Pap6I75zeKZOVy2+z7UNnBgZ7c=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=bGlZvokobQMa7YK4zHl/AkH+KZRGzXk0vTQWpzbyeRWI07B+Syqsg4+GbDzYrZPLHL4i0x+D7nZ7h1M5QBKRCTe5wVFZnk5TJnOb6RTWpbGruolvTg8xq1wEnOY9jIfE0cP8ldrL4uHfVca4DCXjZiL6xkvi6zLWJrr7rWRkJqI=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=B4gPBhJXNLoYhx0rq2wTPKjyabthjAtC4iD0Yq0tGbk63kKuKvCK7XTJOlsxrR96qvG29LxBazoJqKNYapQXL9UtEuIUmfjNASHg0tykdyTDXN0ICx7NBv6ngwU02wbbSBQ0NYltqoUr9rqbOeelZfSQBz1Uppm+fJdPgYc7BX0=;
Message-ID: <455745.54107.qm@web27101.mail.ukl.yahoo.com>
X-YMail-OSG: rpjNbd4VM1lRQ7Y75WE7MdtYFhtb.vs2BAl2O.4PFMGdpVAGvic8sx6Xe0dtRyBHStwySOkPB85ZCFZYPT2yyNLatRi3KlyjucUdZ6R6kQKOYrksI_vRuXddOn34YtVLKertGqw9J9vaNVKWf_yrvBCFJR79jnmuJM36MCsYCHm0uCIruU1bu147r6wk6rmCBbpQmb4XCxgvDxej2RiGxMxM4x0uAhSKr8E4wAeobCtLQFUTHQJM9cx3akJKEozzDJSUIYqtmBgpoI2PbZuvQhycKouv14L_PIaLBrxwkZvSgzrPIOMBdb5lNKpy_4W5dGg.UxyB.MFEcA2yHwMMsSig9WvfAk3.TsrfKCCRclbNF9AlB8E-
Received: from [80.187.213.166] by web27101.mail.ukl.yahoo.com via HTTP; Wed, 30 Sep 2009 15:26:29 GMT
X-Mailer: YahooMailRC/157.18 YahooMailWebService/0.7.347.3
References: <782167355.1253969596054.JavaMail.jira@brutus>  <519397.28615.qm@web27107.mail.ukl.yahoo.com>  <4AC371CD.8060601@gmail.com> <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>
Date: Wed, 30 Sep 2009 15:26:29 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: Re: TSDC, TopFieldCollector & co
To: java-user@lucene.apache.org
In-Reply-To: <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Mark, Shai,=0AI was getting confused by so many possibilities to do =
the "almost the same thing" ;)=0A=0ABut have figured it out by peeking into=
 BoolenQuery code that decides if "out of order" should be used..., BQ will=
 pick the right TSDC ... I like it, option 1 it is minimum user code.=0A=0A=
Cheers, eks=0A=0A=0A=0A----- Original Message ----=0A> From: Shai Erera <se=
rera@gmail.com>=0A> To: java-user@lucene.apache.org=0A> Sent: Wednesday, 30=
 September, 2009 17:12:38=0A> Subject: Re: TSDC, TopFieldCollector & co=0A>=
 =0A> I agree. If you need sort-by-score, it's better to use the "fast" sea=
rch=0A> methods. IndexSearcher will create the appropriate TSDC instance fo=
r you,=0A> based on the Query that was passed.=0A> =0A> If you need to crea=
te multiple Collectors and pass a kind of Multi-Collector=0A> to IndexSearc=
her, then you should create TSDC according to Mark's example=0A> above.=0A>=
 =0A> Shai=0A> =0A> On Wed, Sep 30, 2009 at 4:57 PM, Mark Miller wrote:=0A>=
 =0A> > If you want relevance sorting (Sort.Score not Sort.Relevance right?=
),=0A> > I'd think you want to use TopScoreDocCollector, not TopFieldCollec=
tor.=0A> > The only reason to use relevance with TopFieldCollector is if yo=
u you=0A> > are doing a nth sort with a field sort as well.=0A> >=0A> > You=
 don't really need to worry about things like turning off the max=0A> > sco=
re tracking here - its just going to be the first doc on the queue.=0A> >=
=0A> > You also do want to specify whether or not to collect docs in order =
if=0A> > you care about performance:=0A> >=0A> >  public static TopScoreDoc=
Collector create(int numHits, boolean=0A> > docsScoredInOrder)=0A> >=0A> > =
ie:=0A> >=0A> > TopScoreDocCollector.create(nDocs, !weight.scoresDocsOutOfO=
rder());=0A> >=0A> > Which means you just want option 1.=0A> >=0A> > --=0A>=
 > - Mark=0A> >=0A> > http://www.lucidimagination.com=0A> >=0A> >=0A> >=0A>=
 > eks dev wrote:=0A> > > Hi All,=0A> > >=0A> > > What is the best way to a=
chieve the following and what are the=0A> > differences, if I say "I do not=
 normalize scores, so I do not need max score=0A> > tracking, I do not care=
 if hits are returned in doc id order, or any other=0A> > order. I need onl=
y to get maxDocs *best scoring* documents":=0A> > >=0A> > > OPTION 1:=0A> >=
 > TopDocs top =3D ixSearcher.search(q, filter, maxDocs);=0A> > >=0A> > > O=
PTION 2:=0A> > >    final TopScoreDocCollector tfc =3D TopScoreDocCollector=
.create(maxDocs,=0A> > false);=0A> > >     ixSearcher.search(q, filter, tfc=
);=0A> > >     TopDocs top =3D tfc.topDocs();=0A> > >=0A> > >=0A> > > OPTIO=
N 3:=0A> > >     final TopFieldCollector tfc =3D=0A> > TopFieldCollector.cr=
eate(Sort.RELEVANCE, maxDocs,=0A> > >         false  /* fillFields */,=0A> =
> >         true   /* trackDocScores */,=0A> > >         false   /* trackMa=
xScore */,=0A> > >         false  /* docsInOrder */);=0A> > >=0A> > >     i=
xSearcher.search(q.weight(ixSearcher),filter, tfc);=0A> > >     TopDocs top=
 =3D tfc.topDocs();=0A> > >=0A> > >=0A> > > what are the pros and cons?=0A>=
 > > If I read javadoc correctly,=0A> > > - OPTION 1 tracks max score and d=
elivers doc Ids in order (suboptimal=0A> > performance for my case)=0A> > >=
 - OPTION 2 I do not know abut max score tracking, but doc Ids are not=0A> =
> required to be in order=0A> > > - OPTION 3 looks like exactly what I want=
, but one performance comment in=0A> > javadoc about Sort.RELEVANCE made me=
 think if that is the fastest way?=0A> > >=0A> > > What would be recommende=
d here, any other options to achieve the fastest=0A> > search with above de=
fined conditions (no max score tracking and doc id order=0A> > irrelevant)?=
  OPTIN2 looks nice, but as said, I am not sure about max score=0A> > track=
ing?=0A> > >=0A> > > Thanks,=0A> > > eks=0A> > >=0A> > >=0A> > >=0A> > >=0A=
> > > ---------------------------------------------------------------------=
=0A> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A=
> > > For additional commands, e-mail: java-user-help@lucene.apache.org=0A>=
 > >=0A> > >=0A> >=0A> >=0A> >=0A> >=0A> > --------------------------------=
-------------------------------------=0A> > To unsubscribe, e-mail: java-us=
er-unsubscribe@lucene.apache.org=0A> > For additional commands, e-mail: jav=
a-user-help@lucene.apache.org=0A> >=0A> >=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42525-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 15:27:34 2009
Return-Path: <java-user-return-42525-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5794 invoked from network); 30 Sep 2009 15:27:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 15:27:34 -0000
Received: (qmail 85009 invoked by uid 500); 30 Sep 2009 15:27:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84933 invoked by uid 500); 30 Sep 2009 15:27:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84923 invoked by uid 99); 30 Sep 2009 15:27:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 15:27:31 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [217.146.182.33] (HELO web27101.mail.ukl.yahoo.com) (217.146.182.33)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 30 Sep 2009 15:27:21 +0000
Received: (qmail 83940 invoked by uid 60001); 30 Sep 2009 15:26:59 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1254324419; bh=DtQEfp782MP8D9IV7Pap6I75zeKZOVy2+z7UNnBgZ7c=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=LX4ifC2+sSjHidoF7tVNtNpu+L5bJLE+n3D1Rgn9+9ei+FPDX9mjs4QrIqUwidp7449b9mdIZHKB15uMLiNYu0DDkuMxczWc2lAk6CoapwMyXsD5Vxgw5JsMZIrS5y9F1hjRsspRWdvVBZ1SOFmdAph2tdqqH7KPoNvfqLUQy00=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=4Bl/5uL3cm9sJ8LB+qmoQJqKM1n3uqfdCytCyu0xnl3qm8+VBxBdApgPvBLJzmTdhDzA50TU/gPU6aGkET8v7P6pBfWAUkEBtKE1oLy0haH3qLAcl2wEJkzsOW4tg2WSUesnIuUMknLbcJYCi6F2qNWhRg5/h/nY45gqZ7RrjEE=;
Message-ID: <566291.83932.qm@web27101.mail.ukl.yahoo.com>
X-YMail-OSG: ie8wsVcVM1nFme54zjbDxbRF2Gs0BFLUWDOPoj.M41BEd4UyGVNjXfu_V5NDXNe_.I0mbnfwkQdnDcxKZ4a.LujhUcI.ct.xa.qj2d1RJIDlSmjSZmzJjmochSP9BpS.WlZ5vwf7KPAyUt4fFqLl_qIcppP94bhJnLBSMv3p_FLLNMmtvfU0csZxtRutkoPzX0OqGpIx8TRdOWXmljrHaCuX1PPFjTULroT7cHVyh1Ume..sl0djYwe5aaKwtMMbID5VnLdyFWFDBSh.WEBZiiOCiUo.QFQXGWnomEy7qaBcq4s7QjJR2Ni47igeI7zzFa5pA1rxk1bdHMOacmpPlOM3aYLUJrA0bJZVSK6pvUiWlm1Nj0U-
Received: from [80.187.213.166] by web27101.mail.ukl.yahoo.com via HTTP; Wed, 30 Sep 2009 15:26:59 GMT
X-Mailer: YahooMailRC/157.18 YahooMailWebService/0.7.347.3
References: <782167355.1253969596054.JavaMail.jira@brutus>  <519397.28615.qm@web27107.mail.ukl.yahoo.com>  <4AC371CD.8060601@gmail.com> <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>
Date: Wed, 30 Sep 2009 15:26:59 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: Re: TSDC, TopFieldCollector & co
To: java-user@lucene.apache.org
In-Reply-To: <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Mark, Shai,=0AI was getting confused by so many possibilities to do =
the "almost the same thing" ;)=0A=0ABut have figured it out by peeking into=
 BoolenQuery code that decides if "out of order" should be used..., BQ will=
 pick the right TSDC ... I like it, option 1 it is minimum user code.=0A=0A=
Cheers, eks=0A=0A=0A=0A----- Original Message ----=0A> From: Shai Erera <se=
rera@gmail.com>=0A> To: java-user@lucene.apache.org=0A> Sent: Wednesday, 30=
 September, 2009 17:12:38=0A> Subject: Re: TSDC, TopFieldCollector & co=0A>=
 =0A> I agree. If you need sort-by-score, it's better to use the "fast" sea=
rch=0A> methods. IndexSearcher will create the appropriate TSDC instance fo=
r you,=0A> based on the Query that was passed.=0A> =0A> If you need to crea=
te multiple Collectors and pass a kind of Multi-Collector=0A> to IndexSearc=
her, then you should create TSDC according to Mark's example=0A> above.=0A>=
 =0A> Shai=0A> =0A> On Wed, Sep 30, 2009 at 4:57 PM, Mark Miller wrote:=0A>=
 =0A> > If you want relevance sorting (Sort.Score not Sort.Relevance right?=
),=0A> > I'd think you want to use TopScoreDocCollector, not TopFieldCollec=
tor.=0A> > The only reason to use relevance with TopFieldCollector is if yo=
u you=0A> > are doing a nth sort with a field sort as well.=0A> >=0A> > You=
 don't really need to worry about things like turning off the max=0A> > sco=
re tracking here - its just going to be the first doc on the queue.=0A> >=
=0A> > You also do want to specify whether or not to collect docs in order =
if=0A> > you care about performance:=0A> >=0A> >  public static TopScoreDoc=
Collector create(int numHits, boolean=0A> > docsScoredInOrder)=0A> >=0A> > =
ie:=0A> >=0A> > TopScoreDocCollector.create(nDocs, !weight.scoresDocsOutOfO=
rder());=0A> >=0A> > Which means you just want option 1.=0A> >=0A> > --=0A>=
 > - Mark=0A> >=0A> > http://www.lucidimagination.com=0A> >=0A> >=0A> >=0A>=
 > eks dev wrote:=0A> > > Hi All,=0A> > >=0A> > > What is the best way to a=
chieve the following and what are the=0A> > differences, if I say "I do not=
 normalize scores, so I do not need max score=0A> > tracking, I do not care=
 if hits are returned in doc id order, or any other=0A> > order. I need onl=
y to get maxDocs *best scoring* documents":=0A> > >=0A> > > OPTION 1:=0A> >=
 > TopDocs top =3D ixSearcher.search(q, filter, maxDocs);=0A> > >=0A> > > O=
PTION 2:=0A> > >    final TopScoreDocCollector tfc =3D TopScoreDocCollector=
.create(maxDocs,=0A> > false);=0A> > >     ixSearcher.search(q, filter, tfc=
);=0A> > >     TopDocs top =3D tfc.topDocs();=0A> > >=0A> > >=0A> > > OPTIO=
N 3:=0A> > >     final TopFieldCollector tfc =3D=0A> > TopFieldCollector.cr=
eate(Sort.RELEVANCE, maxDocs,=0A> > >         false  /* fillFields */,=0A> =
> >         true   /* trackDocScores */,=0A> > >         false   /* trackMa=
xScore */,=0A> > >         false  /* docsInOrder */);=0A> > >=0A> > >     i=
xSearcher.search(q.weight(ixSearcher),filter, tfc);=0A> > >     TopDocs top=
 =3D tfc.topDocs();=0A> > >=0A> > >=0A> > > what are the pros and cons?=0A>=
 > > If I read javadoc correctly,=0A> > > - OPTION 1 tracks max score and d=
elivers doc Ids in order (suboptimal=0A> > performance for my case)=0A> > >=
 - OPTION 2 I do not know abut max score tracking, but doc Ids are not=0A> =
> required to be in order=0A> > > - OPTION 3 looks like exactly what I want=
, but one performance comment in=0A> > javadoc about Sort.RELEVANCE made me=
 think if that is the fastest way?=0A> > >=0A> > > What would be recommende=
d here, any other options to achieve the fastest=0A> > search with above de=
fined conditions (no max score tracking and doc id order=0A> > irrelevant)?=
  OPTIN2 looks nice, but as said, I am not sure about max score=0A> > track=
ing?=0A> > >=0A> > > Thanks,=0A> > > eks=0A> > >=0A> > >=0A> > >=0A> > >=0A=
> > > ---------------------------------------------------------------------=
=0A> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A=
> > > For additional commands, e-mail: java-user-help@lucene.apache.org=0A>=
 > >=0A> > >=0A> >=0A> >=0A> >=0A> >=0A> > --------------------------------=
-------------------------------------=0A> > To unsubscribe, e-mail: java-us=
er-unsubscribe@lucene.apache.org=0A> > For additional commands, e-mail: jav=
a-user-help@lucene.apache.org=0A> >=0A> >=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42526-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 16:11:38 2009
Return-Path: <java-user-return-42526-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23477 invoked from network); 30 Sep 2009 16:11:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 16:11:38 -0000
Received: (qmail 71614 invoked by uid 500); 30 Sep 2009 16:11:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71557 invoked by uid 500); 30 Sep 2009 16:11:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71547 invoked by uid 99); 30 Sep 2009 16:11:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 16:11:35 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.219 as permitted sender)
Received: from [209.85.219.219] (HELO mail-ew0-f219.google.com) (209.85.219.219)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 16:11:26 +0000
Received: by ewy19 with SMTP id 19so6657407ewy.28
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 09:11:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=da4hmp6bFmlrN2XjnatcxH7xSFN0L6fOM1o8VrIfTtk=;
        b=dibgZ7mV4vAbSTJb5wBuzoTeqY1q14IqC8fs8MFwpFnGxBEOwKRElSj5lSxzHUEPnr
         MGPNTbbs590CGfQfqPZ+gQlSulbj8OiS2FYKJcp/J4kR8KrOOXt7myqrotIvDdvqu6Bh
         EBGunn6lm0JHpASqGWNCx9CkfHLT5yxnWz9wQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=htB0iUOxRvq9yYQQX3hgvC+0b3SpdWYlrr1CPbu6w2p8OBCzVFABWtTwmkzBRcFEN6
         VkFmuz3fVLu9fPjxCPwMJpV8cqKNwSoJ4X9DqUykCPmxvNSVHzHgCls7NAxRkjl7lPPE
         1qLXFoodifv1bZt0+OhRRKWYyN7qNSq9NZ2es=
MIME-Version: 1.0
Received: by 10.216.4.4 with SMTP id 4mr1332563wei.163.1254327063911; Wed, 30 
	Sep 2009 09:11:03 -0700 (PDT)
In-Reply-To: <566291.83932.qm@web27101.mail.ukl.yahoo.com>
References: <782167355.1253969596054.JavaMail.jira@brutus>
	 <519397.28615.qm@web27107.mail.ukl.yahoo.com>
	 <4AC371CD.8060601@gmail.com>
	 <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>
	 <566291.83932.qm@web27101.mail.ukl.yahoo.com>
Date: Wed, 30 Sep 2009 18:11:03 +0200
Message-ID: <786fde50909300911u3a4a6218y25d560c738906327@mail.gmail.com>
Subject: Re: TSDC, TopFieldCollector & co
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64c1bc4139e600474cdc7d4
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64c1bc4139e600474cdc7d4
Content-Type: text/plain; charset=ISO-8859-1

BTW eks, you asked about reusing TSDC. PQ has a clear() method, so it can be
reused. Only currently it's final and nullifies the array. We'll need to
un-final it, and then override in HitQueue to just reset the ScoreDoc
instances to be sentinels again. And of course add a reset() method to TSDC.

On Wed, Sep 30, 2009 at 5:26 PM, eks dev <eksdev@yahoo.co.uk> wrote:

> Thanks Mark, Shai,
> I was getting confused by so many possibilities to do the "almost the same
> thing" ;)
>
> But have figured it out by peeking into BoolenQuery code that decides if
> "out of order" should be used..., BQ will pick the right TSDC ... I like it,
> option 1 it is minimum user code.
>
> Cheers, eks
>
>
>
> ----- Original Message ----
> > From: Shai Erera <serera@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Wednesday, 30 September, 2009 17:12:38
> > Subject: Re: TSDC, TopFieldCollector & co
> >
> > I agree. If you need sort-by-score, it's better to use the "fast" search
> > methods. IndexSearcher will create the appropriate TSDC instance for you,
> > based on the Query that was passed.
> >
> > If you need to create multiple Collectors and pass a kind of
> Multi-Collector
> > to IndexSearcher, then you should create TSDC according to Mark's example
> > above.
> >
> > Shai
> >
> > On Wed, Sep 30, 2009 at 4:57 PM, Mark Miller wrote:
> >
> > > If you want relevance sorting (Sort.Score not Sort.Relevance right?),
> > > I'd think you want to use TopScoreDocCollector, not TopFieldCollector.
> > > The only reason to use relevance with TopFieldCollector is if you you
> > > are doing a nth sort with a field sort as well.
> > >
> > > You don't really need to worry about things like turning off the max
> > > score tracking here - its just going to be the first doc on the queue.
> > >
> > > You also do want to specify whether or not to collect docs in order if
> > > you care about performance:
> > >
> > >  public static TopScoreDocCollector create(int numHits, boolean
> > > docsScoredInOrder)
> > >
> > > ie:
> > >
> > > TopScoreDocCollector.create(nDocs, !weight.scoresDocsOutOfOrder());
> > >
> > > Which means you just want option 1.
> > >
> > > --
> > > - Mark
> > >
> > > http://www.lucidimagination.com
> > >
> > >
> > >
> > > eks dev wrote:
> > > > Hi All,
> > > >
> > > > What is the best way to achieve the following and what are the
> > > differences, if I say "I do not normalize scores, so I do not need max
> score
> > > tracking, I do not care if hits are returned in doc id order, or any
> other
> > > order. I need only to get maxDocs *best scoring* documents":
> > > >
> > > > OPTION 1:
> > > > TopDocs top = ixSearcher.search(q, filter, maxDocs);
> > > >
> > > > OPTION 2:
> > > >    final TopScoreDocCollector tfc =
> TopScoreDocCollector.create(maxDocs,
> > > false);
> > > >     ixSearcher.search(q, filter, tfc);
> > > >     TopDocs top = tfc.topDocs();
> > > >
> > > >
> > > > OPTION 3:
> > > >     final TopFieldCollector tfc =
> > > TopFieldCollector.create(Sort.RELEVANCE, maxDocs,
> > > >         false  /* fillFields */,
> > > >         true   /* trackDocScores */,
> > > >         false   /* trackMaxScore */,
> > > >         false  /* docsInOrder */);
> > > >
> > > >     ixSearcher.search(q.weight(ixSearcher),filter, tfc);
> > > >     TopDocs top = tfc.topDocs();
> > > >
> > > >
> > > > what are the pros and cons?
> > > > If I read javadoc correctly,
> > > > - OPTION 1 tracks max score and delivers doc Ids in order (suboptimal
> > > performance for my case)
> > > > - OPTION 2 I do not know abut max score tracking, but doc Ids are not
> > > required to be in order
> > > > - OPTION 3 looks like exactly what I want, but one performance
> comment in
> > > javadoc about Sort.RELEVANCE made me think if that is the fastest way?
> > > >
> > > > What would be recommended here, any other options to achieve the
> fastest
> > > search with above defined conditions (no max score tracking and doc id
> order
> > > irrelevant)?  OPTIN2 looks nice, but as said, I am not sure about max
> score
> > > tracking?
> > > >
> > > > Thanks,
> > > > eks
> > > >
> > > >
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > >
> > >
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64c1bc4139e600474cdc7d4--

From java-user-return-42527-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 17:44:31 2009
Return-Path: <java-user-return-42527-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64420 invoked from network); 30 Sep 2009 17:44:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 17:44:31 -0000
Received: (qmail 11721 invoked by uid 500); 30 Sep 2009 17:44:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11656 invoked by uid 500); 30 Sep 2009 17:44:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11646 invoked by uid 99); 30 Sep 2009 17:44:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 17:44:29 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ihasmax@gmail.com designates 209.85.218.214 as permitted sender)
Received: from [209.85.218.214] (HELO mail-bw0-f214.google.com) (209.85.218.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 17:44:20 +0000
Received: by bwz10 with SMTP id 10so5470373bwz.5
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 10:43:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=1dj7a7ZnsAPdwpEZhQu42RYyWr/eLDK08zneBer+lIM=;
        b=TzRgQycxw8a5/oJHKElgL7RCQnoAvxk289jlR/kH88bSmr/oalahaJloAfBIfyWXa8
         qpwAq4tLGhqtTYfxhZVOCF4br8V61iL0KiR25B94SljEN+Ptz9uX5s3R2s5lpDa/xScW
         cnC804PKNFC5eNhauouRRTgxEESmP1nCijMJ8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=BOUaKQly4eALL63RtQFLhxGOjWKvg7QmaBR6fP04pOC7fPFZLbQmYQpgMyFn7hJZdE
         nXzKKhzej1tCtyr19eS1S47OjU8VoHv5FlYG4iw0XAp+JaNDVAb4cJQjxtmTNAjNGG+Q
         v0yblggkfrKY6QpEWk+EP9SvJn7U7pPlXkoJo=
MIME-Version: 1.0
Received: by 10.103.78.22 with SMTP id f22mr43172mul.14.1254332638778; Wed, 30 
	Sep 2009 10:43:58 -0700 (PDT)
In-Reply-To: <4AC2A8E8.4090209@gmail.com>
References: <3836ec640909291737k9cc14c5v88b7beae5ec5459@mail.gmail.com>
	 <4AC2A8E8.4090209@gmail.com>
Date: Wed, 30 Sep 2009 12:43:58 -0500
Message-ID: <3836ec640909301043h595262ecj24ada846a6740136@mail.gmail.com>
Subject: Re: TopDocCollector limits
From: Max Lynch <ihasmax@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e65aedce5d57370474cf135d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e65aedce5d57370474cf135d
Content-Type: text/plain; charset=ISO-8859-1

Thanks Mark that's exactly what I need.  How does the performance of
processing each document in the collect method of HitCollector compare to
looping through the Hits in the deprecated Hits class?

On Tue, Sep 29, 2009 at 7:40 PM, Mark Miller <markrmiller@gmail.com> wrote:

> Max Lynch wrote:
> > Hi,
> > I am developing a search system that doesn't do pagination (searches are
> run
> > in the background and machine analyzed).  However, TopDocCollector makes
> me
> > put a limit on how many results I want back.  For my system, each result
> > found is important.  How can I make it collect every result found?
> >
> > Thanks.
> >
> >
> You would want to use a Collector in 2.9 or HitCollector < 2.9 most likely.
>
> --
> - Mark
>
> http://www.lucidimagination.com
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e65aedce5d57370474cf135d--

From java-user-return-42528-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 17:48:22 2009
Return-Path: <java-user-return-42528-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65220 invoked from network); 30 Sep 2009 17:48:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 17:48:22 -0000
Received: (qmail 16453 invoked by uid 500); 30 Sep 2009 17:48:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16398 invoked by uid 500); 30 Sep 2009 17:48:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16388 invoked by uid 99); 30 Sep 2009 17:48:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 17:48:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 17:48:08 +0000
Received: by fxm2 with SMTP id 2so5721690fxm.28
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 10:47:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=FKEpuoMQJW282dQl0g/PZMQESMHSz7ipp6w2IaaEqD0=;
        b=lWzq9k39peYGque5yu3wBfe3GWOBclnv2Su0bMgcJ0LjgW4lBMN2PxPpLauHyEBbP+
         gyDOdvVpKiAhvP2auqoQjAVFMPQvL02RJpWvQ76tvYX8WYSkNzl/xBlJ4AcC0b+NpvPd
         7mXyjTy14tjfqR49PKLZVrGG5i7Jl5QMwvy7k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=R0/E7ygThvKo8duLl7YZ0nj+yUMOtn1sjH6DOqgtSUONqFar4lr6efd8edCb8zDaW5
         iiZduKvcFGs9Bsgu40sZX+SlXC6hsLYO1ecGOfaW43CFVRbQ94pwZ55/RRyr8Pe/veLH
         XP4UOLAYNx/84LSKncS6KucgxIEk27FvB9Gmc=
Received: by 10.86.227.1 with SMTP id z1mr213892fgg.56.1254332868237;
        Wed, 30 Sep 2009 10:47:48 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id e11sm174127fga.3.2009.09.30.10.47.46
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 30 Sep 2009 10:47:47 -0700 (PDT)
Message-ID: <4AC399C1.1030308@gmail.com>
Date: Wed, 30 Sep 2009 13:47:45 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: TopDocCollector limits
References: <3836ec640909291737k9cc14c5v88b7beae5ec5459@mail.gmail.com>	 <4AC2A8E8.4090209@gmail.com> <3836ec640909301043h595262ecj24ada846a6740136@mail.gmail.com>
In-Reply-To: <3836ec640909301043h595262ecj24ada846a6740136@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Way the heck better - Hits is horrible for that. It caches like 100 hits
and then keeps searching when you exhaust the cache (been I while since
I've looked at the exact numbers). Its horribly inefficient for checking
every hit.

Hits will end up using a Collector anyway - and then throw a speed trap
for what you want on top of it. Part of why we deprecated it. To much
misuse.

Max Lynch wrote:
> Thanks Mark that's exactly what I need.  How does the performance of
> processing each document in the collect method of HitCollector compare to
> looping through the Hits in the deprecated Hits class?
>
> On Tue, Sep 29, 2009 at 7:40 PM, Mark Miller <markrmiller@gmail.com> wrote:
>
>   
>> Max Lynch wrote:
>>     
>>> Hi,
>>> I am developing a search system that doesn't do pagination (searches are
>>>       
>> run
>>     
>>> in the background and machine analyzed).  However, TopDocCollector makes
>>>       
>> me
>>     
>>> put a limit on how many results I want back.  For my system, each result
>>> found is important.  How can I make it collect every result found?
>>>
>>> Thanks.
>>>
>>>
>>>       
>> You would want to use a Collector in 2.9 or HitCollector < 2.9 most likely.
>>
>> --
>> - Mark
>>
>> http://www.lucidimagination.com
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>   


-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42529-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 18:42:29 2009
Return-Path: <java-user-return-42529-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97689 invoked from network); 30 Sep 2009 18:42:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 18:42:29 -0000
Received: (qmail 86872 invoked by uid 500); 30 Sep 2009 18:42:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86794 invoked by uid 500); 30 Sep 2009 18:42:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86784 invoked by uid 99); 30 Sep 2009 18:42:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 18:42:26 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.182.33] (HELO web27101.mail.ukl.yahoo.com) (217.146.182.33)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 30 Sep 2009 18:42:14 +0000
Received: (qmail 69803 invoked by uid 60001); 30 Sep 2009 18:41:52 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1254336112; bh=i2OJ2OUXhLvTpcf/zpSW9sYQyrk6ACyQShaOKQ7XDRo=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=hyTv5RirH4q134UJJ98uw4nmB6Dave4i460WntZsKrB2kwqp8YOTNhkPZ5qV+asylOnce+mZ0ZYsBK/5u2o91lOI2qA8k6lXzOfADUzKyo4n/hHKHi47ngTq0omYwAslXalmGoUvpjz1h/E6ehAFqGGB8c6iTaJV2HIeemA270c=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=e182kvJr/e4iEiq1rXKvf8e3WmdA/rUMdLvRGasP1Ns4KtUfbODojPCNgf7JBmiQMzCrSORkNZskBQOx8e833oc/NoxP5SXnKsLunuj8PcZFd0GZwrikYeBJshjlIEDv1+EV1kmgJwIgAsqMZww41t6sfh4SMbelK3wp9q6mcKw=;
Message-ID: <47674.69618.qm@web27101.mail.ukl.yahoo.com>
X-YMail-OSG: 9Q7n5aMVM1mG_Whdfttg__.ZeJ_jUSfzIwTmr.F0ZUnseN_sn9Qs4nFO4rhlaBsZSC3U1CCCKdFmpavpyw7H7A8BWa4WBLHB1mqZRBal4nTSpq7KNbWEKaUsW4pLMykP2CGy7rJxmOvpjMEck809D2irnzVI2kuusqDsz9ipsnuo2IWL2aGgwqoshOl19RlPevrRfW9NLTcHfk4qZrGegspQ0oMw4MfLVuB1pi_RuxqBjAVkGqdReIeakbbU14_wQEKZFP1jgasdPOuyGf6gse7mgPyptiEv6oQJbCY9u6.jBJDGPKD0mt1Tl8DBqN._8Fb16GrR4LHrFT2UDKYsQlIFhLbfkq7adubo3aqX8UFFZ6b6hIM-
Received: from [79.240.220.145] by web27101.mail.ukl.yahoo.com via HTTP; Wed, 30 Sep 2009 18:41:51 GMT
X-Mailer: YahooMailRC/157.18 YahooMailWebService/0.7.347.3
References: <782167355.1253969596054.JavaMail.jira@brutus>  <519397.28615.qm@web27107.mail.ukl.yahoo.com>  <4AC371CD.8060601@gmail.com>  <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>  <566291.83932.qm@web27101.mail.ukl.yahoo.com> <786fde50909300911u3a4a6218y25d560c738906327@mail.gmail.com>
Date: Wed, 30 Sep 2009 18:41:51 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: Re: TSDC, TopFieldCollector & co
To: java-user@lucene.apache.org
In-Reply-To: <786fde50909300911u3a4a6218y25d560c738906327@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

> BTW eks, you asked about reusing TSDC.=0A=0Ayeah, it is normally not a bi=
g deal to allocate everything again, but these arrays are not necessarily s=
mall, I guess it would make sense to open this possibility. =0A=0Ado you th=
ink where would be better to add reset(),  TSDC or to Collector?=0A=0AI wou=
ld even suggest to change clear method to become clear(Object sentinel) to =
PQ instead... or to add such a method (backwards compatibility) ...=0A=0AAn=
other question:=0ALooking at the code in PQ, it was not really clear to me =
why sentinels have to be allocated maxSize times in initialize method? I am=
 talking about:=0A=0A    // If sentinel objects are supported, populate the=
 queue with them=0A    Object sentinel =3D getSentinelObject();=0A    if (s=
entinel !=3D null) {=0A      heap[1] =3D sentinel;=0A      for (int i =3D 2=
; i < heap.length; i++) {=0A        heap[i] =3D getSentinelObject(); //Why =
not simply heap[i] =3D sentinel;  =0A      }=0A      size =3D maxSize;=0A  =
  }=0A=0A  getSentinelObject() creates new object every time (HitQueue)=0A=
=0Aare these objects mutable?=0A=0A=0A=0A=0A=0A=0A=0A----- Original Message=
 ----=0A> From: Shai Erera <serera@gmail.com>=0A> To: java-user@lucene.apac=
he.org=0A> Sent: Wednesday, 30 September, 2009 18:11:03=0A> Subject: Re: TS=
DC, TopFieldCollector & co=0A> =0A> BTW eks, you asked about reusing TSDC. =
PQ has a clear() method, so it can be=0A> reused. Only currently it's final=
 and nullifies the array. We'll need to=0A> un-final it, and then override =
in HitQueue to just reset the ScoreDoc=0A> instances to be sentinels again.=
 And of course add a reset() method to TSDC.=0A> =0A> On Wed, Sep 30, 2009 =
at 5:26 PM, eks dev wrote:=0A> =0A> > Thanks Mark, Shai,=0A> > I was gettin=
g confused by so many possibilities to do the "almost the same=0A> > thing"=
 ;)=0A> >=0A> > But have figured it out by peeking into BoolenQuery code th=
at decides if=0A> > "out of order" should be used..., BQ will pick the righ=
t TSDC ... I like it,=0A> > option 1 it is minimum user code.=0A> >=0A> > C=
heers, eks=0A> >=0A> >=0A> >=0A> > ----- Original Message ----=0A> > > From=
: Shai Erera =0A> > > To: java-user@lucene.apache.org=0A> > > Sent: Wednesd=
ay, 30 September, 2009 17:12:38=0A> > > Subject: Re: TSDC, TopFieldCollecto=
r & co=0A> > >=0A> > > I agree. If you need sort-by-score, it's better to u=
se the "fast" search=0A> > > methods. IndexSearcher will create the appropr=
iate TSDC instance for you,=0A> > > based on the Query that was passed.=0A>=
 > >=0A> > > If you need to create multiple Collectors and pass a kind of=
=0A> > Multi-Collector=0A> > > to IndexSearcher, then you should create TSD=
C according to Mark's example=0A> > > above.=0A> > >=0A> > > Shai=0A> > >=
=0A> > > On Wed, Sep 30, 2009 at 4:57 PM, Mark Miller wrote:=0A> > >=0A> > =
> > If you want relevance sorting (Sort.Score not Sort.Relevance right?),=
=0A> > > > I'd think you want to use TopScoreDocCollector, not TopFieldColl=
ector.=0A> > > > The only reason to use relevance with TopFieldCollector is=
 if you you=0A> > > > are doing a nth sort with a field sort as well.=0A> >=
 > >=0A> > > > You don't really need to worry about things like turning off=
 the max=0A> > > > score tracking here - its just going to be the first doc=
 on the queue.=0A> > > >=0A> > > > You also do want to specify whether or n=
ot to collect docs in order if=0A> > > > you care about performance:=0A> > =
> >=0A> > > >  public static TopScoreDocCollector create(int numHits, boole=
an=0A> > > > docsScoredInOrder)=0A> > > >=0A> > > > ie:=0A> > > >=0A> > > >=
 TopScoreDocCollector.create(nDocs, !weight.scoresDocsOutOfOrder());=0A> > =
> >=0A> > > > Which means you just want option 1.=0A> > > >=0A> > > > --=0A=
> > > > - Mark=0A> > > >=0A> > > > http://www.lucidimagination.com=0A> > > =
>=0A> > > >=0A> > > >=0A> > > > eks dev wrote:=0A> > > > > Hi All,=0A> > > =
> >=0A> > > > > What is the best way to achieve the following and what are =
the=0A> > > > differences, if I say "I do not normalize scores, so I do not=
 need max=0A> > score=0A> > > > tracking, I do not care if hits are returne=
d in doc id order, or any=0A> > other=0A> > > > order. I need only to get m=
axDocs *best scoring* documents":=0A> > > > >=0A> > > > > OPTION 1:=0A> > >=
 > > TopDocs top =3D ixSearcher.search(q, filter, maxDocs);=0A> > > > >=0A>=
 > > > > OPTION 2:=0A> > > > >    final TopScoreDocCollector tfc =3D=0A> > =
TopScoreDocCollector.create(maxDocs,=0A> > > > false);=0A> > > > >     ixSe=
archer.search(q, filter, tfc);=0A> > > > >     TopDocs top =3D tfc.topDocs(=
);=0A> > > > >=0A> > > > >=0A> > > > > OPTION 3:=0A> > > > >     final TopF=
ieldCollector tfc =3D=0A> > > > TopFieldCollector.create(Sort.RELEVANCE, ma=
xDocs,=0A> > > > >         false  /* fillFields */,=0A> > > > >         tru=
e   /* trackDocScores */,=0A> > > > >         false   /* trackMaxScore */,=
=0A> > > > >         false  /* docsInOrder */);=0A> > > > >=0A> > > > >    =
 ixSearcher.search(q.weight(ixSearcher),filter, tfc);=0A> > > > >     TopDo=
cs top =3D tfc.topDocs();=0A> > > > >=0A> > > > >=0A> > > > > what are the =
pros and cons?=0A> > > > > If I read javadoc correctly,=0A> > > > > - OPTIO=
N 1 tracks max score and delivers doc Ids in order (suboptimal=0A> > > > pe=
rformance for my case)=0A> > > > > - OPTION 2 I do not know abut max score =
tracking, but doc Ids are not=0A> > > > required to be in order=0A> > > > >=
 - OPTION 3 looks like exactly what I want, but one performance=0A> > comme=
nt in=0A> > > > javadoc about Sort.RELEVANCE made me think if that is the f=
astest way?=0A> > > > >=0A> > > > > What would be recommended here, any oth=
er options to achieve the=0A> > fastest=0A> > > > search with above defined=
 conditions (no max score tracking and doc id=0A> > order=0A> > > > irrelev=
ant)?  OPTIN2 looks nice, but as said, I am not sure about max=0A> > score=
=0A> > > > tracking?=0A> > > > >=0A> > > > > Thanks,=0A> > > > > eks=0A> > =
> > >=0A> > > > >=0A> > > > >=0A> > > > >=0A> > > > > ---------------------=
------------------------------------------------=0A> > > > > To unsubscribe=
, e-mail: java-user-unsubscribe@lucene.apache.org=0A> > > > > For additiona=
l commands, e-mail: java-user-help@lucene.apache.org=0A> > > > >=0A> > > > =
>=0A> > > >=0A> > > >=0A> > > >=0A> > > >=0A> > > > -----------------------=
----------------------------------------------=0A> > > > To unsubscribe, e-=
mail: java-user-unsubscribe@lucene.apache.org=0A> > > > For additional comm=
ands, e-mail: java-user-help@lucene.apache.org=0A> > > >=0A> > > >=0A> >=0A=
> >=0A> >=0A> >=0A> >=0A> > -----------------------------------------------=
----------------------=0A> > To unsubscribe, e-mail: java-user-unsubscribe@=
lucene.apache.org=0A> > For additional commands, e-mail: java-user-help@luc=
ene.apache.org=0A> >=0A> >=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42530-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 18:54:55 2009
Return-Path: <java-user-return-42530-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7704 invoked from network); 30 Sep 2009 18:54:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 18:54:55 -0000
Received: (qmail 11350 invoked by uid 500); 30 Sep 2009 18:54:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11293 invoked by uid 500); 30 Sep 2009 18:54:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11283 invoked by uid 99); 30 Sep 2009 18:54:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 18:54:53 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.182.36] (HELO web27104.mail.ukl.yahoo.com) (217.146.182.36)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 30 Sep 2009 18:54:42 +0000
Received: (qmail 29766 invoked by uid 60001); 30 Sep 2009 18:53:21 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1254336801; bh=fQSdLQzOm4lmJimVZ1A3yVFiwnnoGHnTNUY8FfblmPE=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=zJOjhrAqb6RtZslDPuiH+FHMzGNhzrOX/OWKaqX5QFW/jePe51h+tQvexL+JFfxjpIP9msnSDqaIjJYON6ob7/Y9Qgmdf9VxjBdU/eFPHeueYLxbslJY6SgYExjyOr5WX+2hDBj33ND4V4Kswb0dzxhDGBC6PDob/hnaZV8H7eA=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=S8DV7rHWjxkzaJIFCGwSRTGf6ENFAiNSlzEE54YpUUbk58Q5pkomKjOZGF2ZayCLT4KWUZ3fkAFE41bREj2P/AEsKGHwgPLsnxZbFKhU5/2zun3MG7G0MvOfSTbD1URYTxmdUbEkUwxucngEXZdZzB3z9W4KD08l0Pz6X/CAssg=;
Message-ID: <298572.28894.qm@web27104.mail.ukl.yahoo.com>
X-YMail-OSG: sme5YP4VM1l0xWC9esbDIZitQYquNhXwhezvRidCcrxwmNmmqDvbBEt3
Received: from [79.240.220.145] by web27104.mail.ukl.yahoo.com via HTTP; Wed, 30 Sep 2009 18:53:20 GMT
X-Mailer: YahooMailRC/157.18 YahooMailWebService/0.7.347.3
References: <782167355.1253969596054.JavaMail.jira@brutus>  <519397.28615.qm@web27107.mail.ukl.yahoo.com>  <4AC371CD.8060601@gmail.com>  <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>  <566291.83932.qm@web27101.mail.ukl.yahoo.com> <786fde50909300911u3a4a6218y25d560c738906327@mail.gmail.com> <47674.69618.qm@web27101.mail.ukl.yahoo.com>
Date: Wed, 30 Sep 2009 18:53:20 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: Re: TSDC, TopFieldCollector & co
To: java-user@lucene.apache.org
In-Reply-To: <47674.69618.qm@web27101.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

forget the question about initialize(), reading javadoc before asking alrea=
dy answered questions helps a lot, sorry for the noise.  ...NOTE in getSent=
inelObject() javadoc...=0A=0A=0A=0A----- Original Message ----=0A> From: ek=
s dev <eksdev@yahoo.co.uk>=0A> To: java-user@lucene.apache.org=0A> Sent: We=
dnesday, 30 September, 2009 20:41:51=0A> Subject: Re: TSDC, TopFieldCollect=
or & co=0A> =0A> > BTW eks, you asked about reusing TSDC.=0A> =0A> yeah, it=
 is normally not a big deal to allocate everything again, but these =0A> ar=
rays are not necessarily small, I guess it would make sense to open this =
=0A> possibility. =0A> =0A> do you think where would be better to add reset=
(),  TSDC or to Collector?=0A> =0A> I would even suggest to change clear me=
thod to become clear(Object sentinel) to =0A> PQ instead... or to add such =
a method (backwards compatibility) ...=0A> =0A> Another question:=0A> Looki=
ng at the code in PQ, it was not really clear to me why sentinels have to =
=0A> be allocated maxSize times in initialize method? I am talking about:=
=0A> =0A>     // If sentinel objects are supported, populate the queue with=
 them=0A>     Object sentinel =3D getSentinelObject();=0A>     if (sentinel=
 !=3D null) {=0A>       heap[1] =3D sentinel;=0A>       for (int i =3D 2; i=
 < heap.length; i++) {=0A>         heap[i] =3D getSentinelObject(); //Why n=
ot simply heap[i] =3D sentinel;  =0A>       }=0A>       size =3D maxSize;=
=0A>     }=0A> =0A>   getSentinelObject() creates new object every time (Hi=
tQueue)=0A> =0A> are these objects mutable?=0A> =0A> =0A> =0A> =0A> =0A> =
=0A> =0A> ----- Original Message ----=0A> > From: Shai Erera =0A> > To: jav=
a-user@lucene.apache.org=0A> > Sent: Wednesday, 30 September, 2009 18:11:03=
=0A> > Subject: Re: TSDC, TopFieldCollector & co=0A> > =0A> > BTW eks, you =
asked about reusing TSDC. PQ has a clear() method, so it can be=0A> > reuse=
d. Only currently it's final and nullifies the array. We'll need to=0A> > u=
n-final it, and then override in HitQueue to just reset the ScoreDoc=0A> > =
instances to be sentinels again. And of course add a reset() method to TSDC=
.=0A> > =0A> > On Wed, Sep 30, 2009 at 5:26 PM, eks dev wrote:=0A> > =0A> >=
 > Thanks Mark, Shai,=0A> > > I was getting confused by so many possibiliti=
es to do the "almost the same=0A> > > thing" ;)=0A> > >=0A> > > But have fi=
gured it out by peeking into BoolenQuery code that decides if=0A> > > "out =
of order" should be used..., BQ will pick the right TSDC ... I like it,=0A>=
 > > option 1 it is minimum user code.=0A> > >=0A> > > Cheers, eks=0A> > >=
=0A> > >=0A> > >=0A> > > ----- Original Message ----=0A> > > > From: Shai E=
rera =0A> > > > To: java-user@lucene.apache.org=0A> > > > Sent: Wednesday, =
30 September, 2009 17:12:38=0A> > > > Subject: Re: TSDC, TopFieldCollector =
& co=0A> > > >=0A> > > > I agree. If you need sort-by-score, it's better to=
 use the "fast" search=0A> > > > methods. IndexSearcher will create the app=
ropriate TSDC instance for you,=0A> > > > based on the Query that was passe=
d.=0A> > > >=0A> > > > If you need to create multiple Collectors and pass a=
 kind of=0A> > > Multi-Collector=0A> > > > to IndexSearcher, then you shoul=
d create TSDC according to Mark's example=0A> > > > above.=0A> > > >=0A> > =
> > Shai=0A> > > >=0A> > > > On Wed, Sep 30, 2009 at 4:57 PM, Mark Miller w=
rote:=0A> > > >=0A> > > > > If you want relevance sorting (Sort.Score not S=
ort.Relevance right?),=0A> > > > > I'd think you want to use TopScoreDocCol=
lector, not TopFieldCollector.=0A> > > > > The only reason to use relevance=
 with TopFieldCollector is if you you=0A> > > > > are doing a nth sort with=
 a field sort as well.=0A> > > > >=0A> > > > > You don't really need to wor=
ry about things like turning off the max=0A> > > > > score tracking here - =
its just going to be the first doc on the queue.=0A> > > > >=0A> > > > > Yo=
u also do want to specify whether or not to collect docs in order if=0A> > =
> > > you care about performance:=0A> > > > >=0A> > > > >  public static To=
pScoreDocCollector create(int numHits, boolean=0A> > > > > docsScoredInOrde=
r)=0A> > > > >=0A> > > > > ie:=0A> > > > >=0A> > > > > TopScoreDocCollector=
.create(nDocs, !weight.scoresDocsOutOfOrder());=0A> > > > >=0A> > > > > Whi=
ch means you just want option 1.=0A> > > > >=0A> > > > > --=0A> > > > > - M=
ark=0A> > > > >=0A> > > > > http://www.lucidimagination.com=0A> > > > >=0A>=
 > > > >=0A> > > > >=0A> > > > > eks dev wrote:=0A> > > > > > Hi All,=0A> >=
 > > > >=0A> > > > > > What is the best way to achieve the following and wh=
at are the=0A> > > > > differences, if I say "I do not normalize scores, so=
 I do not need max=0A> > > score=0A> > > > > tracking, I do not care if hit=
s are returned in doc id order, or any=0A> > > other=0A> > > > > order. I n=
eed only to get maxDocs *best scoring* documents":=0A> > > > > >=0A> > > > =
> > OPTION 1:=0A> > > > > > TopDocs top =3D ixSearcher.search(q, filter, ma=
xDocs);=0A> > > > > >=0A> > > > > > OPTION 2:=0A> > > > > >    final TopSco=
reDocCollector tfc =3D=0A> > > TopScoreDocCollector.create(maxDocs,=0A> > >=
 > > false);=0A> > > > > >     ixSearcher.search(q, filter, tfc);=0A> > > >=
 > >     TopDocs top =3D tfc.topDocs();=0A> > > > > >=0A> > > > > >=0A> > >=
 > > > OPTION 3:=0A> > > > > >     final TopFieldCollector tfc =3D=0A> > > =
> > TopFieldCollector.create(Sort.RELEVANCE, maxDocs,=0A> > > > > >        =
 false  /* fillFields */,=0A> > > > > >         true   /* trackDocScores */=
,=0A> > > > > >         false   /* trackMaxScore */,=0A> > > > > >         =
false  /* docsInOrder */);=0A> > > > > >=0A> > > > > >     ixSearcher.searc=
h(q.weight(ixSearcher),filter, tfc);=0A> > > > > >     TopDocs top =3D tfc.=
topDocs();=0A> > > > > >=0A> > > > > >=0A> > > > > > what are the pros and =
cons?=0A> > > > > > If I read javadoc correctly,=0A> > > > > > - OPTION 1 t=
racks max score and delivers doc Ids in order (suboptimal=0A> > > > > perfo=
rmance for my case)=0A> > > > > > - OPTION 2 I do not know abut max score t=
racking, but doc Ids are not=0A> > > > > required to be in order=0A> > > > =
> > - OPTION 3 looks like exactly what I want, but one performance=0A> > > =
comment in=0A> > > > > javadoc about Sort.RELEVANCE made me think if that i=
s the fastest way?=0A> > > > > >=0A> > > > > > What would be recommended he=
re, any other options to achieve the=0A> > > fastest=0A> > > > > search wit=
h above defined conditions (no max score tracking and doc id=0A> > > order=
=0A> > > > > irrelevant)?  OPTIN2 looks nice, but as said, I am not sure ab=
out max=0A> > > score=0A> > > > > tracking?=0A> > > > > >=0A> > > > > > Tha=
nks,=0A> > > > > > eks=0A> > > > > >=0A> > > > > >=0A> > > > > >=0A> > > > =
> >=0A> > > > > > ---------------------------------------------------------=
------------=0A> > > > > > To unsubscribe, e-mail: java-user-unsubscribe@lu=
cene.apache.org=0A> > > > > > For additional commands, e-mail: java-user-he=
lp@lucene.apache.org=0A> > > > > >=0A> > > > > >=0A> > > > >=0A> > > > >=0A=
> > > > >=0A> > > > >=0A> > > > > -----------------------------------------=
----------------------------=0A> > > > > To unsubscribe, e-mail: java-user-=
unsubscribe@lucene.apache.org=0A> > > > > For additional commands, e-mail: =
java-user-help@lucene.apache.org=0A> > > > >=0A> > > > >=0A> > >=0A> > >=0A=
> > >=0A> > >=0A> > >=0A> > > ---------------------------------------------=
------------------------=0A> > > To unsubscribe, e-mail: java-user-unsubscr=
ibe@lucene.apache.org=0A> > > For additional commands, e-mail: java-user-he=
lp@lucene.apache.org=0A> > >=0A> > >=0A> =0A> =0A> =0A> =0A> =0A> ---------=
------------------------------------------------------------=0A> To unsubsc=
ribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A> For additional co=
mmands, e-mail: java-user-help@lucene.apache.org=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42531-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 19:03:54 2009
Return-Path: <java-user-return-42531-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11446 invoked from network); 30 Sep 2009 19:03:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 19:03:54 -0000
Received: (qmail 25510 invoked by uid 500); 30 Sep 2009 19:03:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25447 invoked by uid 500); 30 Sep 2009 19:03:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25437 invoked by uid 99); 30 Sep 2009 19:03:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 19:03:52 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 19:03:40 +0000
Received: by ey-out-2122.google.com with SMTP id 22so1516519eye.3
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 12:02:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=yri2Ep5o1sNUwkEc7YxY9lVZvL+WQSzRgPsKWw7jOOs=;
        b=iEOOTH5y/9FAKEB7bh77vVVJdq5uL2D/lS8ve9X+oquh2O2fgJyzFzHrgOuELqbYkf
         gqeJfXRREhESpBKlG4KAy9MNwbqHuruR/8OerlySEJGnUGT2+29oUwk37bdmfIkShwEJ
         X9hs51TgP5HGMECh1C43D/P8DtZogX+Hwobh8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=DCB7UIOYQuW35W8Lkeipz+lcPlLjE0CILKPeV96THs3ZAtg/etX6/fmUEzRX4Al2ic
         ceed0yA3FeRHO1LCzyVE/vMWfMFolmL6riAGcijwv5lqV4CdeY3f+jaZGPLzwhJFuCBH
         VpL6ETJDVewxIEC13I/GuoddjsqKfPFAkc3qI=
MIME-Version: 1.0
Received: by 10.216.1.199 with SMTP id 49mr45392wed.23.1254337340125; Wed, 30 
	Sep 2009 12:02:20 -0700 (PDT)
In-Reply-To: <47674.69618.qm@web27101.mail.ukl.yahoo.com>
References: <782167355.1253969596054.JavaMail.jira@brutus>
	 <519397.28615.qm@web27107.mail.ukl.yahoo.com>
	 <4AC371CD.8060601@gmail.com>
	 <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>
	 <566291.83932.qm@web27101.mail.ukl.yahoo.com>
	 <786fde50909300911u3a4a6218y25d560c738906327@mail.gmail.com>
	 <47674.69618.qm@web27101.mail.ukl.yahoo.com>
Date: Wed, 30 Sep 2009 21:02:19 +0200
Message-ID: <786fde50909301202h7c9518dahed12fa11e03b372d@mail.gmail.com>
Subject: Re: TSDC, TopFieldCollector & co
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00163646dc629636fd0474d02b3b
X-Virus-Checked: Checked by ClamAV on apache.org

--00163646dc629636fd0474d02b3b
Content-Type: text/plain; charset=ISO-8859-1

I was half way through answering the second part when I noticed your second
update :).

I don't know about adding reset() to Collector. It makes sense "for
completeness" in case other Collectors can be reset() as well. But reset()
is a delicate method. It needs to be used cautiously. E.g., if you ask for
100 results, and then want to ask for just 10/20/40, a user might be tempted
to think he can call reset() and it will work. But reset() can be called
only if you want to ask for 100 results again, at least if we don't want to
complicate anything in the code. That's why I think it better exist on TSDC
w/ the proper documentation. If anything, reset() is a TSDC-related
operation (or TopDocsCollector). If I have my own Collector, its reset()
method signature might need to be different, not to speak about
documentation.

About clear(Object sentinel) - is it still a question (now that you
understood getSentinelValue())? I think we should not make it final anyway.
It restricts PQ extensions unnecessarily ...

Shai

On Wed, Sep 30, 2009 at 8:41 PM, eks dev <eksdev@yahoo.co.uk> wrote:

> > BTW eks, you asked about reusing TSDC.
>
> yeah, it is normally not a big deal to allocate everything again, but these
> arrays are not necessarily small, I guess it would make sense to open this
> possibility.
>
> do you think where would be better to add reset(),  TSDC or to Collector?
>
> I would even suggest to change clear method to become clear(Object
> sentinel) to PQ instead... or to add such a method (backwards compatibility)
> ...
>
> Another question:
> Looking at the code in PQ, it was not really clear to me why sentinels have
> to be allocated maxSize times in initialize method? I am talking about:
>
>    // If sentinel objects are supported, populate the queue with them
>    Object sentinel = getSentinelObject();
>    if (sentinel != null) {
>      heap[1] = sentinel;
>      for (int i = 2; i < heap.length; i++) {
>        heap[i] = getSentinelObject(); //Why not simply heap[i] = sentinel;
>      }
>      size = maxSize;
>    }
>
>  getSentinelObject() creates new object every time (HitQueue)
>
> are these objects mutable?
>
>
>
>
>
>
>
> ----- Original Message ----
> > From: Shai Erera <serera@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Wednesday, 30 September, 2009 18:11:03
> > Subject: Re: TSDC, TopFieldCollector & co
> >
> > BTW eks, you asked about reusing TSDC. PQ has a clear() method, so it can
> be
> > reused. Only currently it's final and nullifies the array. We'll need to
> > un-final it, and then override in HitQueue to just reset the ScoreDoc
> > instances to be sentinels again. And of course add a reset() method to
> TSDC.
> >
> > On Wed, Sep 30, 2009 at 5:26 PM, eks dev wrote:
> >
> > > Thanks Mark, Shai,
> > > I was getting confused by so many possibilities to do the "almost the
> same
> > > thing" ;)
> > >
> > > But have figured it out by peeking into BoolenQuery code that decides
> if
> > > "out of order" should be used..., BQ will pick the right TSDC ... I
> like it,
> > > option 1 it is minimum user code.
> > >
> > > Cheers, eks
> > >
> > >
> > >
> > > ----- Original Message ----
> > > > From: Shai Erera
> > > > To: java-user@lucene.apache.org
> > > > Sent: Wednesday, 30 September, 2009 17:12:38
> > > > Subject: Re: TSDC, TopFieldCollector & co
> > > >
> > > > I agree. If you need sort-by-score, it's better to use the "fast"
> search
> > > > methods. IndexSearcher will create the appropriate TSDC instance for
> you,
> > > > based on the Query that was passed.
> > > >
> > > > If you need to create multiple Collectors and pass a kind of
> > > Multi-Collector
> > > > to IndexSearcher, then you should create TSDC according to Mark's
> example
> > > > above.
> > > >
> > > > Shai
> > > >
> > > > On Wed, Sep 30, 2009 at 4:57 PM, Mark Miller wrote:
> > > >
> > > > > If you want relevance sorting (Sort.Score not Sort.Relevance
> right?),
> > > > > I'd think you want to use TopScoreDocCollector, not
> TopFieldCollector.
> > > > > The only reason to use relevance with TopFieldCollector is if you
> you
> > > > > are doing a nth sort with a field sort as well.
> > > > >
> > > > > You don't really need to worry about things like turning off the
> max
> > > > > score tracking here - its just going to be the first doc on the
> queue.
> > > > >
> > > > > You also do want to specify whether or not to collect docs in order
> if
> > > > > you care about performance:
> > > > >
> > > > >  public static TopScoreDocCollector create(int numHits, boolean
> > > > > docsScoredInOrder)
> > > > >
> > > > > ie:
> > > > >
> > > > > TopScoreDocCollector.create(nDocs, !weight.scoresDocsOutOfOrder());
> > > > >
> > > > > Which means you just want option 1.
> > > > >
> > > > > --
> > > > > - Mark
> > > > >
> > > > > http://www.lucidimagination.com
> > > > >
> > > > >
> > > > >
> > > > > eks dev wrote:
> > > > > > Hi All,
> > > > > >
> > > > > > What is the best way to achieve the following and what are the
> > > > > differences, if I say "I do not normalize scores, so I do not need
> max
> > > score
> > > > > tracking, I do not care if hits are returned in doc id order, or
> any
> > > other
> > > > > order. I need only to get maxDocs *best scoring* documents":
> > > > > >
> > > > > > OPTION 1:
> > > > > > TopDocs top = ixSearcher.search(q, filter, maxDocs);
> > > > > >
> > > > > > OPTION 2:
> > > > > >    final TopScoreDocCollector tfc =
> > > TopScoreDocCollector.create(maxDocs,
> > > > > false);
> > > > > >     ixSearcher.search(q, filter, tfc);
> > > > > >     TopDocs top = tfc.topDocs();
> > > > > >
> > > > > >
> > > > > > OPTION 3:
> > > > > >     final TopFieldCollector tfc =
> > > > > TopFieldCollector.create(Sort.RELEVANCE, maxDocs,
> > > > > >         false  /* fillFields */,
> > > > > >         true   /* trackDocScores */,
> > > > > >         false   /* trackMaxScore */,
> > > > > >         false  /* docsInOrder */);
> > > > > >
> > > > > >     ixSearcher.search(q.weight(ixSearcher),filter, tfc);
> > > > > >     TopDocs top = tfc.topDocs();
> > > > > >
> > > > > >
> > > > > > what are the pros and cons?
> > > > > > If I read javadoc correctly,
> > > > > > - OPTION 1 tracks max score and delivers doc Ids in order
> (suboptimal
> > > > > performance for my case)
> > > > > > - OPTION 2 I do not know abut max score tracking, but doc Ids are
> not
> > > > > required to be in order
> > > > > > - OPTION 3 looks like exactly what I want, but one performance
> > > comment in
> > > > > javadoc about Sort.RELEVANCE made me think if that is the fastest
> way?
> > > > > >
> > > > > > What would be recommended here, any other options to achieve the
> > > fastest
> > > > > search with above defined conditions (no max score tracking and doc
> id
> > > order
> > > > > irrelevant)?  OPTIN2 looks nice, but as said, I am not sure about
> max
> > > score
> > > > > tracking?
> > > > > >
> > > > > > Thanks,
> > > > > > eks
> > > > > >
> > > > > >
> > > > > >
> > > > > >
> > > > > >
> ---------------------------------------------------------------------
> > > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > > For additional commands, e-mail:
> java-user-help@lucene.apache.org
> > > > > >
> > > > > >
> > > > >
> > > > >
> > > > >
> > > > >
> > > > >
> ---------------------------------------------------------------------
> > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > > >
> > > > >
> > >
> > >
> > >
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00163646dc629636fd0474d02b3b--

From java-user-return-42532-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 19:50:38 2009
Return-Path: <java-user-return-42532-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24903 invoked from network); 30 Sep 2009 19:50:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 19:50:38 -0000
Received: (qmail 87440 invoked by uid 500); 30 Sep 2009 19:50:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87387 invoked by uid 500); 30 Sep 2009 19:50:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87377 invoked by uid 99); 30 Sep 2009 19:50:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 19:50:36 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.182.40] (HELO web27108.mail.ukl.yahoo.com) (217.146.182.40)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 30 Sep 2009 19:50:24 +0000
Received: (qmail 50752 invoked by uid 60001); 30 Sep 2009 19:50:02 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1254340201; bh=y7mJ7xj0IjBnqTW8dYCdRr4uBjzlMfHJFIGukk3A0Rc=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=xOoDB8GmiWk4ofdOoHJKOgRzh2AETUMIwDtJcmi26HzflKkvGllN1meh+bfYGSYOMNm6UmtxqlU7qW3RSGzJaUEiZSjuwsGaZBlyBomF6po9qPlQwpsmqXXTzHvQM3SmRofsG30nlzK2wa3LpsEXzFPR29RFdkzWxXUDkLD2KeM=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=JxYrhiiOF91aP6ihKFgIhnTPGVmCv6gnYKsLGpU641HsWJP/ndLi2foQUbZfMbJ74by8koVk7YDCT/y0jK1cRvjIhrF8CIrxwLC69WZF2Wn2w0pruHAjBTSpLHf2J3atoLo16QtbTqh3h3V4x0J4SLHNYzmpzEao+Ojpa6q4g7U=;
Message-ID: <909054.50362.qm@web27108.mail.ukl.yahoo.com>
X-YMail-OSG: .b2FDgkVM1nT88Qkjj0tXPF2U9hkHSJ6JL9K6uuQKxcImdbGm2mGUyyOl8ks00cMUbGtK8S9Cpo.EwauGLtHAOpMcw58O8v9BMgIhC6Y0ngYJLQIdnwE6k_5j41RqTKCsSAb8C5j2_fMVY78qDqI5J1FnUvRA2dbsYxh4ZQWGtNbBB.1AP.SVIfsbQfP5jiylCXDMoOsHCot1y3gHqAOk8wY1beYS2QAVQP42upLdAxBJDQQZJvvf7j7kd3g4efGPzqyPhYFLTNv7ipn3SRG7d3FjYEyHRWgP66gBOvHokLQzDvUa5Pmp.6jnEGFwdowDNhLlwlCnATrNhtTzbf.jRulPXJBqsYTeAtkKB.oiPTxaMqL7ak-
Received: from [79.240.220.145] by web27108.mail.ukl.yahoo.com via HTTP; Wed, 30 Sep 2009 19:50:01 GMT
X-Mailer: YahooMailRC/157.18 YahooMailWebService/0.7.347.3
References: <782167355.1253969596054.JavaMail.jira@brutus>  <519397.28615.qm@web27107.mail.ukl.yahoo.com>  <4AC371CD.8060601@gmail.com>  <786fde50909300812l7fe50099g544314ff796fae76@mail.gmail.com>  <566291.83932.qm@web27101.mail.ukl.yahoo.com>  <786fde50909300911u3a4a6218y25d560c738906327@mail.gmail.com>  <47674.69618.qm@web27101.mail.ukl.yahoo.com> <786fde50909301202h7c9518dahed12fa11e03b372d@mail.gmail.com>
Date: Wed, 30 Sep 2009 19:50:01 +0000 (GMT)
From: eks dev <eksdev@yahoo.co.uk>
Subject: Re: TSDC, TopFieldCollector & co
To: java-user@lucene.apache.org
In-Reply-To: <786fde50909301202h7c9518dahed12fa11e03b372d@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

About clear(Object sentinel) - is it still a question =0A=0Ano, it is not. =
Makes no sense with mutable elements :)=0A=0A=0A=0A----- Original Message -=
---=0A> From: Shai Erera <serera@gmail.com>=0A> To: java-user@lucene.apache=
.org=0A> Sent: Wednesday, 30 September, 2009 21:02:19=0A> Subject: Re: TSDC=
, TopFieldCollector & co=0A> =0A> I was half way through answering the seco=
nd part when I noticed your second=0A> update :).=0A> =0A> I don't know abo=
ut adding reset() to Collector. It makes sense "for=0A> completeness" in ca=
se other Collectors can be reset() as well. But reset()=0A> is a delicate m=
ethod. It needs to be used cautiously. E.g., if you ask for=0A> 100 results=
, and then want to ask for just 10/20/40, a user might be tempted=0A> to th=
ink he can call reset() and it will work. But reset() can be called=0A> onl=
y if you want to ask for 100 results again, at least if we don't want to=0A=
> complicate anything in the code. That's why I think it better exist on TS=
DC=0A> w/ the proper documentation. If anything, reset() is a TSDC-related=
=0A> operation (or TopDocsCollector). If I have my own Collector, its reset=
()=0A> method signature might need to be different, not to speak about=0A> =
documentation.=0A> =0A> About clear(Object sentinel) - is it still a questi=
on (now that you=0A> understood getSentinelValue())? I think we should not =
make it final anyway.=0A> It restricts PQ extensions unnecessarily ...=0A> =
=0A> Shai=0A> =0A> On Wed, Sep 30, 2009 at 8:41 PM, eks dev wrote:=0A> =0A>=
 > > BTW eks, you asked about reusing TSDC.=0A> >=0A> > yeah, it is normall=
y not a big deal to allocate everything again, but these=0A> > arrays are n=
ot necessarily small, I guess it would make sense to open this=0A> > possib=
ility.=0A> >=0A> > do you think where would be better to add reset(),  TSDC=
 or to Collector?=0A> >=0A> > I would even suggest to change clear method t=
o become clear(Object=0A> > sentinel) to PQ instead... or to add such a met=
hod (backwards compatibility)=0A> > ...=0A> >=0A> > Another question:=0A> >=
 Looking at the code in PQ, it was not really clear to me why sentinels hav=
e=0A> > to be allocated maxSize times in initialize method? I am talking ab=
out:=0A> >=0A> >    // If sentinel objects are supported, populate the queu=
e with them=0A> >    Object sentinel =3D getSentinelObject();=0A> >    if (=
sentinel !=3D null) {=0A> >      heap[1] =3D sentinel;=0A> >      for (int =
i =3D 2; i < heap.length; i++) {=0A> >        heap[i] =3D getSentinelObject=
(); //Why not simply heap[i] =3D sentinel;=0A> >      }=0A> >      size =3D=
 maxSize;=0A> >    }=0A> >=0A> >  getSentinelObject() creates new object ev=
ery time (HitQueue)=0A> >=0A> > are these objects mutable?=0A> >=0A> >=0A> =
>=0A> >=0A> >=0A> >=0A> >=0A> > ----- Original Message ----=0A> > > From: S=
hai Erera =0A> > > To: java-user@lucene.apache.org=0A> > > Sent: Wednesday,=
 30 September, 2009 18:11:03=0A> > > Subject: Re: TSDC, TopFieldCollector &=
 co=0A> > >=0A> > > BTW eks, you asked about reusing TSDC. PQ has a clear()=
 method, so it can=0A> > be=0A> > > reused. Only currently it's final and n=
ullifies the array. We'll need to=0A> > > un-final it, and then override in=
 HitQueue to just reset the ScoreDoc=0A> > > instances to be sentinels agai=
n. And of course add a reset() method to=0A> > TSDC.=0A> > >=0A> > > On Wed=
, Sep 30, 2009 at 5:26 PM, eks dev wrote:=0A> > >=0A> > > > Thanks Mark, Sh=
ai,=0A> > > > I was getting confused by so many possibilities to do the "al=
most the=0A> > same=0A> > > > thing" ;)=0A> > > >=0A> > > > But have figure=
d it out by peeking into BoolenQuery code that decides=0A> > if=0A> > > > "=
out of order" should be used..., BQ will pick the right TSDC ... I=0A> > li=
ke it,=0A> > > > option 1 it is minimum user code.=0A> > > >=0A> > > > Chee=
rs, eks=0A> > > >=0A> > > >=0A> > > >=0A> > > > ----- Original Message ----=
=0A> > > > > From: Shai Erera=0A> > > > > To: java-user@lucene.apache.org=
=0A> > > > > Sent: Wednesday, 30 September, 2009 17:12:38=0A> > > > > Subje=
ct: Re: TSDC, TopFieldCollector & co=0A> > > > >=0A> > > > > I agree. If yo=
u need sort-by-score, it's better to use the "fast"=0A> > search=0A> > > > =
> methods. IndexSearcher will create the appropriate TSDC instance for=0A> =
> you,=0A> > > > > based on the Query that was passed.=0A> > > > >=0A> > > =
> > If you need to create multiple Collectors and pass a kind of=0A> > > > =
Multi-Collector=0A> > > > > to IndexSearcher, then you should create TSDC a=
ccording to Mark's=0A> > example=0A> > > > > above.=0A> > > > >=0A> > > > >=
 Shai=0A> > > > >=0A> > > > > On Wed, Sep 30, 2009 at 4:57 PM, Mark Miller =
wrote:=0A> > > > >=0A> > > > > > If you want relevance sorting (Sort.Score =
not Sort.Relevance=0A> > right?),=0A> > > > > > I'd think you want to use T=
opScoreDocCollector, not=0A> > TopFieldCollector.=0A> > > > > > The only re=
ason to use relevance with TopFieldCollector is if you=0A> > you=0A> > > > =
> > are doing a nth sort with a field sort as well.=0A> > > > > >=0A> > > >=
 > > You don't really need to worry about things like turning off the=0A> >=
 max=0A> > > > > > score tracking here - its just going to be the first doc=
 on the=0A> > queue.=0A> > > > > >=0A> > > > > > You also do want to specif=
y whether or not to collect docs in order=0A> > if=0A> > > > > > you care a=
bout performance:=0A> > > > > >=0A> > > > > >  public static TopScoreDocCol=
lector create(int numHits, boolean=0A> > > > > > docsScoredInOrder)=0A> > >=
 > > >=0A> > > > > > ie:=0A> > > > > >=0A> > > > > > TopScoreDocCollector.c=
reate(nDocs, !weight.scoresDocsOutOfOrder());=0A> > > > > >=0A> > > > > > W=
hich means you just want option 1.=0A> > > > > >=0A> > > > > > --=0A> > > >=
 > > - Mark=0A> > > > > >=0A> > > > > > http://www.lucidimagination.com=0A>=
 > > > > >=0A> > > > > >=0A> > > > > >=0A> > > > > > eks dev wrote:=0A> > >=
 > > > > Hi All,=0A> > > > > > >=0A> > > > > > > What is the best way to ac=
hieve the following and what are the=0A> > > > > > differences, if I say "I=
 do not normalize scores, so I do not need=0A> > max=0A> > > > score=0A> > =
> > > > tracking, I do not care if hits are returned in doc id order, or=0A=
> > any=0A> > > > other=0A> > > > > > order. I need only to get maxDocs *be=
st scoring* documents":=0A> > > > > > >=0A> > > > > > > OPTION 1:=0A> > > >=
 > > > TopDocs top =3D ixSearcher.search(q, filter, maxDocs);=0A> > > > > >=
 >=0A> > > > > > > OPTION 2:=0A> > > > > > >    final TopScoreDocCollector =
tfc =3D=0A> > > > TopScoreDocCollector.create(maxDocs,=0A> > > > > > false)=
;=0A> > > > > > >     ixSearcher.search(q, filter, tfc);=0A> > > > > > >   =
  TopDocs top =3D tfc.topDocs();=0A> > > > > > >=0A> > > > > > >=0A> > > > =
> > > OPTION 3:=0A> > > > > > >     final TopFieldCollector tfc =3D=0A> > >=
 > > > TopFieldCollector.create(Sort.RELEVANCE, maxDocs,=0A> > > > > > >   =
      false  /* fillFields */,=0A> > > > > > >         true   /* trackDocSc=
ores */,=0A> > > > > > >         false   /* trackMaxScore */,=0A> > > > > >=
 >         false  /* docsInOrder */);=0A> > > > > > >=0A> > > > > > >     i=
xSearcher.search(q.weight(ixSearcher),filter, tfc);=0A> > > > > > >     Top=
Docs top =3D tfc.topDocs();=0A> > > > > > >=0A> > > > > > >=0A> > > > > > >=
 what are the pros and cons?=0A> > > > > > > If I read javadoc correctly,=
=0A> > > > > > > - OPTION 1 tracks max score and delivers doc Ids in order=
=0A> > (suboptimal=0A> > > > > > performance for my case)=0A> > > > > > > -=
 OPTION 2 I do not know abut max score tracking, but doc Ids are=0A> > not=
=0A> > > > > > required to be in order=0A> > > > > > > - OPTION 3 looks lik=
e exactly what I want, but one performance=0A> > > > comment in=0A> > > > >=
 > javadoc about Sort.RELEVANCE made me think if that is the fastest=0A> > =
way?=0A> > > > > > >=0A> > > > > > > What would be recommended here, any ot=
her options to achieve the=0A> > > > fastest=0A> > > > > > search with abov=
e defined conditions (no max score tracking and doc=0A> > id=0A> > > > orde=
r=0A> > > > > > irrelevant)?  OPTIN2 looks nice, but as said, I am not sure=
 about=0A> > max=0A> > > > score=0A> > > > > > tracking?=0A> > > > > > >=0A=
> > > > > > > Thanks,=0A> > > > > > > eks=0A> > > > > > >=0A> > > > > > >=
=0A> > > > > > >=0A> > > > > > >=0A> > > > > > >=0A> > --------------------=
-------------------------------------------------=0A> > > > > > > To unsubs=
cribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A> > > > > > > For =
additional commands, e-mail:=0A> > java-user-help@lucene.apache.org=0A> > >=
 > > > >=0A> > > > > > >=0A> > > > > >=0A> > > > > >=0A> > > > > >=0A> > > =
> > >=0A> > > > > >=0A> > -------------------------------------------------=
--------------------=0A> > > > > > To unsubscribe, e-mail: java-user-unsubs=
cribe@lucene.apache.org=0A> > > > > > For additional commands, e-mail: java=
-user-help@lucene.apache.org=0A> > > > > >=0A> > > > > >=0A> > > >=0A> > > =
>=0A> > > >=0A> > > >=0A> > > >=0A> > > > ---------------------------------=
------------------------------------=0A> > > > To unsubscribe, e-mail: java=
-user-unsubscribe@lucene.apache.org=0A> > > > For additional commands, e-ma=
il: java-user-help@lucene.apache.org=0A> > > >=0A> > > >=0A> >=0A> >=0A> >=
=0A> >=0A> >=0A> > --------------------------------------------------------=
-------------=0A> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.ap=
ache.org=0A> > For additional commands, e-mail: java-user-help@lucene.apach=
e.org=0A> >=0A> >=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42533-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 20:11:31 2009
Return-Path: <java-user-return-42533-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30662 invoked from network); 30 Sep 2009 20:11:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 20:11:31 -0000
Received: (qmail 3803 invoked by uid 500); 30 Sep 2009 20:11:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3732 invoked by uid 500); 30 Sep 2009 20:11:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3722 invoked by uid 99); 30 Sep 2009 20:11:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 20:11:29 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ssmith@mainstreamdata.com designates 209.63.42.201 as permitted sender)
Received: from [209.63.42.201] (HELO nexus1.mainstreamdata.com) (209.63.42.201)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 20:11:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by nexus1.mainstreamdata.com (Postfix) with ESMTP id 43C191A011
	for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 14:10:58 -0600 (MDT)
X-Virus-Scanned: Debian amavisd-new at nexus1.mainstreamdata.com
Received: from nexus1.mainstreamdata.com ([127.0.0.1])
	by localhost (nexus1.mainstreamdata.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id kG8Pp18daXiR for <java-user@lucene.apache.org>;
	Wed, 30 Sep 2009 14:10:52 -0600 (MDT)
Received: from exchange.slc.mainstreamdata.com (exchange.slc.mainstreamdata.com [10.2.1.132])
	by nexus1.mainstreamdata.com (Postfix) with ESMTP id 20CBA1601C
	for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 14:10:52 -0600 (MDT)
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA420A.1BE2AE75"
Subject: Highlighting phrases in 2.9
Date: Wed, 30 Sep 2009 14:10:51 -0600
Message-ID: <55F9EF953014514EB6BEE1F5198CEEB405BA30BA@exchange.slc.mainstreamdata.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Highlighting phrases in 2.9
Thread-Index: AcpCChucSPqN1srPTm+1lP/NjUo2Ew==
From: "Scott Smith" <ssmith@mainstreamdata.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA420A.1BE2AE75
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: quoted-printable

I've been looking at the changes I have to make in my code to go from
2.4.1 to 2.9.  One of the features I have is to highlight query hits in
documents which meet the search criteria.   If the query has a phrase,
then I need to highlight the phrase, but not isolated words from the
phrase which also happen to be in the document.

=20

In 2.4.1, I do this using the SimpleHTMLFormatter, the NullFragmenter
and the SpanScorer.  It looks like highlighter had a major overhaul in
2.9 and that SpanScorer is now the wrong scorer to use (it's been moved
out of the highlighter).   I also found some JIRA's that seem to imply
that SpanScorer is now used by default, but I don't see anything in the
javadocs that say this is the case.=20

=20

Do I just need to remove the SpanScorer completely and assume that the
highlighter takes care of that for me? =20

=20

Can someone suggest what I need to do or point me to some documentation?



------_=_NextPart_001_01CA420A.1BE2AE75--

From java-user-return-42534-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 21:26:24 2009
Return-Path: <java-user-return-42534-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94360 invoked from network); 30 Sep 2009 21:26:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 21:26:24 -0000
Received: (qmail 82994 invoked by uid 500); 30 Sep 2009 21:26:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82927 invoked by uid 500); 30 Sep 2009 21:26:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82917 invoked by uid 99); 30 Sep 2009 21:26:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 21:26:22 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.182] (HELO mail-yw0-f182.google.com) (209.85.211.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 21:26:12 +0000
Received: by ywh12 with SMTP id 12so6423137ywh.21
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 14:25:51 -0700 (PDT)
MIME-Version: 1.0
Sender: felipe@goshme.com
Received: by 10.150.104.15 with SMTP id b15mr784149ybc.100.1254345951255; Wed, 
	30 Sep 2009 14:25:51 -0700 (PDT)
Date: Wed, 30 Sep 2009 18:25:51 -0300
X-Google-Sender-Auth: b6ec395cdb00b0e1
Message-ID: <c4e715d70909301425y61ada82byd8064bbfb503750b@mail.gmail.com>
Subject: Implement SpanScorer on 2.9 lucene lib!
From: Felipe Lobo <felipe@jusbrasil.com.br>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd48a4ed99b9a0474d22c7d
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd48a4ed99b9a0474d22c7d
Content-Type: text/plain; charset=ISO-8859-1

Hi, i updated my lucene lib to 2.9.0 and i'm trying to instanciate the
spanscorer but the constructor is protected.
I looked in the javadoc of lucene and saw 2 subclasses of it
(PayloadNearQuery.PayloadNearSpanScorer,
PayloadTermQuery.PayloadTermWeight.PayloadTermSpanScorer).
Using this classes is the best way of implementing spanscorer??
I was using queryscorer but after update to the new lib the highlither
stopped hightlithing my wildcard queries, and i'm rewriting.

Thanks,
-- 
Felipe Lobo
www.jusbrasil.com.br

--000e0cd48a4ed99b9a0474d22c7d--

From java-user-return-42535-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 21:40:22 2009
Return-Path: <java-user-return-42535-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99114 invoked from network); 30 Sep 2009 21:40:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 21:40:22 -0000
Received: (qmail 1363 invoked by uid 500); 30 Sep 2009 21:40:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1299 invoked by uid 500); 30 Sep 2009 21:40:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1289 invoked by uid 99); 30 Sep 2009 21:40:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 21:40:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 21:40:05 +0000
Received: by fxm2 with SMTP id 2so5916306fxm.28
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 14:38:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=xDo3hoxoABuZsk8iij5mCMuGLNHJqF5A4rRlUsoDXLY=;
        b=nkdcPD6BSw3IwleLsPg9CXwnNgLp8YBwNAp7t/RHGDwDxfrVYyakpPJeioXQ+m3QK0
         v5XL6pzyI0kllgHmhtAzUWU89NXsytjAqzRHSthhC7lzY7o5yDlsT91tH/mjk13GraYj
         0TFJzYnIs7X4Wuf4MJRFD9UrhoAns44QIbahs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=cWImwtk2GQlsL1WVZRwfPcsxeRuYQDQxlkJYShuBFOzvwA0y/dZ3wEwveGS7SZlo/c
         8sP6pwOzgjkZ0zVC4jO23bGJObqI/BUkbDkqolFxrXyHDqoPHh7E4iEiSkYZFTxiCkJF
         Em4qtr3rPvqSYjdWr1Nm4GCSr3JSp3lrBGETg=
Received: by 10.86.227.13 with SMTP id z13mr407845fgg.72.1254346725028;
        Wed, 30 Sep 2009 14:38:45 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 12sm1576fgg.8.2009.09.30.14.38.42
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 30 Sep 2009 14:38:43 -0700 (PDT)
Message-ID: <4AC3CFE2.6030508@gmail.com>
Date: Wed, 30 Sep 2009 17:38:42 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Implement SpanScorer on 2.9 lucene lib!
References: <c4e715d70909301425y61ada82byd8064bbfb503750b@mail.gmail.com>
In-Reply-To: <c4e715d70909301425y61ada82byd8064bbfb503750b@mail.gmail.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Felipe Lobo wrote:
> Hi, i updated my lucene lib to 2.9.0 and i'm trying to instanciate the
> spanscorer but the constructor is protected.
> I looked in the javadoc of lucene and saw 2 subclasses of it
> (PayloadNearQuery.PayloadNearSpanScorer,
> PayloadTermQuery.PayloadTermWeight.PayloadTermSpanScorer).
> Using this classes is the best way of implementing spanscorer??
> I was using queryscorer but after update to the new lib the highlither
> stopped hightlithing my wildcard queries, and i'm rewriting.
>
> Thanks,
>   
Checkout contrib CHANGES.

The SpanScorer is now the QueryScorer - if you want to highlight
wildcard queries, you should no longer rewrite on your own.

If you want the old behavior, use TermQueryScorer instead.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42536-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 21:41:26 2009
Return-Path: <java-user-return-42536-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99263 invoked from network); 30 Sep 2009 21:41:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 21:41:26 -0000
Received: (qmail 3266 invoked by uid 500); 30 Sep 2009 21:41:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3199 invoked by uid 500); 30 Sep 2009 21:41:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3189 invoked by uid 99); 30 Sep 2009 21:41:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 21:41:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.220.206 as permitted sender)
Received: from [209.85.220.206] (HELO mail-fx0-f206.google.com) (209.85.220.206)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 21:41:13 +0000
Received: by fxm2 with SMTP id 2so5917088fxm.28
        for <java-user@lucene.apache.org>; Wed, 30 Sep 2009 14:39:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=7MRqhl8dJbYPgHrrySY7hVaX5KTm11AEG/UTtCElWU4=;
        b=i59spiaJP38CnzkabF3dCqX5GVb9UnurtS7BW5LID4GFH7ihArUrsEngsxwjQul8Si
         afj/+6xGWq28DBcVZp5wuFtLOEcg0lKMJws0cPRYTzvzRQ8EjHU9B6x3Id/TU0iKzDjk
         dhcvqS7MDzF6FocryB0bTDreCWycXbj4LBjnw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=jOmi7sM5HIkDtVq2WnI9uXB8mYvLyyglMS+VzAFD3BEO2miZkkqA+GhHcyqeL24aV4
         ZI+0OaNVcMetDgv+ULU2YZ5oVEO/C8PKoKePiEZ02pzoy80wBuqYzCaOFemzEKnUHJCQ
         9xmn2BRY0m7/XJRB4+ZMUjqO32KpVMOYJd4ic=
Received: by 10.86.247.18 with SMTP id u18mr444623fgh.43.1254346792616;
        Wed, 30 Sep 2009 14:39:52 -0700 (PDT)
Received: from ?192.168.1.108? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id l19sm139693fgb.27.2009.09.30.14.39.50
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 30 Sep 2009 14:39:51 -0700 (PDT)
Message-ID: <4AC3D026.7050101@gmail.com>
Date: Wed, 30 Sep 2009 17:39:50 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Highlighting phrases in 2.9
References: <55F9EF953014514EB6BEE1F5198CEEB405BA30BA@exchange.slc.mainstreamdata.com>
In-Reply-To: <55F9EF953014514EB6BEE1F5198CEEB405BA30BA@exchange.slc.mainstreamdata.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Scott Smith wrote:
> I've been looking at the changes I have to make in my code to go from
> 2.4.1 to 2.9.  One of the features I have is to highlight query hits in
> documents which meet the search criteria.   If the query has a phrase,
> then I need to highlight the phrase, but not isolated words from the
> phrase which also happen to be in the document.
>
>  
>
> In 2.4.1, I do this using the SimpleHTMLFormatter, the NullFragmenter
> and the SpanScorer.  It looks like highlighter had a major overhaul in
> 2.9 and that SpanScorer is now the wrong scorer to use (it's been moved
> out of the highlighter).   I also found some JIRA's that seem to imply
> that SpanScorer is now used by default, but I don't see anything in the
> javadocs that say this is the case. 
>
>  
>
> Do I just need to remove the SpanScorer completely and assume that the
> highlighter takes care of that for me?  
>
>  
>
> Can someone suggest what I need to do or point me to some documentation?
>
>
>
>   
The QueryScorer is now what the SpanScorer was - if you want what was
the QueryScorer before, use the TermQueryScorer.
If you want what was the SpanScorer, use the QueryScorer.

-- 
- Mark

http://www.lucidimagination.com




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-42537-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Sep 30 22:39:06 2009
Return-Path: <java-user-return-42537-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19184 invoked from network); 30 Sep 2009 22:39:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Sep 2009 22:39:06 -0000
Received: (qmail 82576 invoked by uid 500); 30 Sep 2009 22:39:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82476 invoked by uid 500); 30 Sep 2009 22:39:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82400 invoked by uid 99); 30 Sep 2009 22:39:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 22:39:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erik.hatcher@gmail.com designates 209.85.219.219 as permitted sender)
Received: from [209.85.219.219] (HELO mail-ew0-f219.google.com) (209.85.219.219)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Sep 2009 22:38:48 +0000
Received: by ewy19 with SMTP id 19so7007932ewy.28
        for <multiple recipients>; Wed, 30 Sep 2009 15:37:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :content-type:content-transfer-encoding:mime-version:subject:date
         :x-mailer;
        bh=7gH5S1NrVNe2XOZ0rQV2L4atL7L6XtyUjVj8R7rOQV8=;
        b=yBmRGdvUBFem3hUcMdwuT0DASbnDZtMulSUkwgY5/g0GgZy+9EJ4B4vv0oibVrfnzI
         mMZRZ+VVenOBgI1LFjME5wItWaMdxlqqFwRjQuKvBYwDhaaM8hMTv6VfAnx/RQMSPOYO
         YdSOJFjZmrtuCkjrLXLbNDbFN569lZD1RO2RE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:content-transfer-encoding
         :mime-version:subject:date:x-mailer;
        b=XgmPe/2YR0fb2qPRf7If8++4nOP5qYm0pDax5BFskpYzwSFuBoRPjx3EWW5ETtXCwd
         c2F9jtq5rH0CIR8i+KAaNnhqCHq6/M8FU5CGGK+R7t64VbzN38qo8R0WfmDS/j6R5sRJ
         TrDdHIQ7lI+h6a4TAA6qhupNpI1y1pUJ63F+o=
Received: by 10.216.38.201 with SMTP id a51mr89210web.57.1254350248756;
        Wed, 30 Sep 2009 15:37:28 -0700 (PDT)
Received: from ?10.100.100.248? ([207.179.4.183])
        by mx.google.com with ESMTPS id 10sm59580eyd.2.2009.09.30.15.37.26
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 30 Sep 2009 15:37:28 -0700 (PDT)
Message-Id: <04EF81D9-AF6B-43D8-9ACC-1E48E7C1C70A@gmail.com>
From: Erik Hatcher <erik.hatcher@gmail.com>
To: solr-user@lucene.apache.org,
 general@lucene.apache.org,
 java-user@lucene.apache.org
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v936)
Subject: =?WINDOWS-1252?Q?Webinar:_Apache_Solr_1.4_=96_Faster,_Easier,_an?=
 =?WINDOWS-1252?Q?d_More_Versatile_than_Ever?=
Date: Wed, 30 Sep 2009 15:37:24 -0700
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Excuse the cross-posting and gratuitous marketing :)

	Erik


My company, Lucid Imagination, is sponsoring a free and in-depth =20
technical webinar with Erik Hatcher, one of our co-founders as Lucid =20
Imagination, as well as co-author of Lucene in Action, and Lucene/Solr =20=

PMC member and committer. Sign up here: =
http://www.eventsvc.com/lucidimagination/100909?trk=3DWR-OCT2009-AP

Friday, October 9th 2009
10:00AM =96 11:00AM PDT / 1:00 =96 2:00PM EDT

If you=92ve got a lot of data to tame in a variety of formats, there=92s =
=20
no better, deeper, faster platform to build your search application =20
with than Solr. Apache Solr 1.4 expands the power and versatility of =20
the leading open source search server, with its convenient web-=20
services interfaces and well-packaged server implementation. Erik will =20=

present and discuss key features and innovations of Solr 1.4, =20
covering, among others:

   * Faster, more streamlined document and query processing
   * New powerful search methods including multi-select faceting, =20
deduplication and numeric range handling
   * Simplified, powerful, highly-scalable deployment improvements =20
with new Java server infrastructure

Sign up for the free webinar at
http://www.eventsvc.com/lucidimagination/100909?trk=3DWR-OCT2009-AP

About the presenter:
Erik Hatcher, is the co-author of =93Lucene in Action=94 as well as co-=20=

author of =93Java Development with Ant=94. Erik has been an active =
member =20
of the Lucene community =96 a leading Lucene and Solr committer, member =20=

of the Lucene Project Management Committee, member of the Apache =20
Software Foundation as well as a frequent invited speaker at various =20
industry events.=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


