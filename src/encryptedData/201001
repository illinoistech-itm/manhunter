From java-user-return-44324-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 01 11:53:31 2010
Return-Path: <java-user-return-44324-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27701 invoked from network); 1 Jan 2010 11:53:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 1 Jan 2010 11:53:31 -0000
Received: (qmail 55470 invoked by uid 500); 1 Jan 2010 11:53:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55386 invoked by uid 500); 1 Jan 2010 11:53:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55376 invoked by uid 99); 1 Jan 2010 11:53:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 01 Jan 2010 11:53:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 01 Jan 2010 11:53:20 +0000
Received: by yxe30 with SMTP id 30so15297988yxe.29
        for <java-user@lucene.apache.org>; Fri, 01 Jan 2010 03:52:58 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.125.3 with SMTP id x3mr29749575ybc.28.1262346778787; Fri, 
	01 Jan 2010 03:52:58 -0800 (PST)
In-Reply-To: <29a597d20912310934l1c5d9309i9232d7b3f8afc366@mail.gmail.com>
References: <29a597d20912301221k55f33b8w4029faf283cb8a14@mail.gmail.com>
	 <9ac0c6aa0912310445lf8abb6ah7a2893f891e92642@mail.gmail.com>
	 <29a597d20912310911n4788f6ect679e7dd6810e318a@mail.gmail.com>
	 <29a597d20912310934l1c5d9309i9232d7b3f8afc366@mail.gmail.com>
Date: Fri, 1 Jan 2010 06:52:58 -0500
Message-ID: <9ac0c6aa1001010352n7a6c12f0h1e1de413975fca8f@mail.gmail.com>
Subject: Re: Lucene 2.9: IOException from IndexReader.reopen() - Real time 
	search
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Dec 31, 2009 at 12:34 PM, Kumaravel Kandasami
<kumaravel.kandasami@gmail.com> wrote:
> Identified the problem.
>
> reader.close() was not getting called in a specific logic flow.

Phew :)  Thanks for bringing closure.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44325-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 02 11:58:19 2010
Return-Path: <java-user-return-44325-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88983 invoked from network); 2 Jan 2010 11:58:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Jan 2010 11:58:19 -0000
Received: (qmail 32220 invoked by uid 500); 2 Jan 2010 11:58:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32130 invoked by uid 500); 2 Jan 2010 11:58:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32120 invoked by uid 99); 2 Jan 2010 11:58:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 02 Jan 2010 11:58:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.15] (HELO web52905.mail.re2.yahoo.com) (206.190.49.15)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 02 Jan 2010 11:58:06 +0000
Received: (qmail 94434 invoked by uid 60001); 2 Jan 2010 11:57:44 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262433464; bh=9K5rjSaAnoBBNC44KCFw4zSDAcaXolhj2s/qtjEGhcQ=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=aHxVuh7SFEtkMpqLUqztiGMQ1qnzr0/TzCEN9CcA4p2gId8wWyQGLa1kdorQRjS772X96YPKTqHfR8T+JStN8odZ5V+/VLCROgffvrF1YZTVSfMV1lZ84pIkvP0rlTejv521JrvhCisiVYuPD9hSpcF2EazEMdAFBE2ZlPpl9e0=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=yPiZ2EXGvX7E+QL1JZhx66ZpHiNnCdh1Tpp985nwOTn1GlE07DoYKTZIL8zrqbzW+vV0+p8b1qmRxDjQeljIc5CedhRtlfhWqBRyi8QCXdtpiAYD26NK75SDLr7yeQawxFnDlL7NtHIbhyLgq9G29hCxH6YyWGaGuu+TSItsjIo=;
Message-ID: <678109.86020.qm@web52905.mail.re2.yahoo.com>
X-YMail-OSG: 89hHf6IVM1ku5VClF8nAFKSVMCzsOWqb57vHe0oPCppDE7ML8BfdUqQx_b50s8UZt1N_I6yqJTULtCdQvrELrX8NLRVGXbNXi1gDtBTHjdtm8qUoUaH4dnjFLKXAohPC0UUjVBPD4yDOBPfqtcNWhhWKrS7Am6S8Go6bwiyrGczVvHpvOEyD7NCepuMdMSNUsA9d2NfO8GEdBk.O4LW3Xi6ly_2YGKgGz67eKqFq2Bq0si2J63X9C5D6iN0ATyHC_XvPoXxKVMYMp101w1AUyKR2Z9rH4Inf_Jx8TZ3lrmm9_biicaGyK06xGA--
Received: from [78.168.189.135] by web52905.mail.re2.yahoo.com via HTTP; Sat, 02 Jan 2010 03:57:44 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Sat, 2 Jan 2010 03:57:44 -0800 (PST)
From: Ahmet Arslan <iorixxx@yahoo.com>
Subject: ShingleFilter with outputUnigrams=false
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

I am using lucene 2.9.1 and I was trying to understand the ShingleFilter and wrote the code below.

String test = "please divide this sentence";
Tokenizer wsTokenizer = new WhitespaceTokenizer(new StringReader(test));
ShingleFilter filter = new ShingleFilter(wsTokenizer, 3);
filter.setOutputUnigrams(false);
        
TermAttribute termAtt = (TermAttribute) filter.getAttribute(TermAttribute.class);

while (filter.incrementToken())            System.out.println(termAtt.term());

I noticed that if I set outputUnigrams to false it gives me the same output for maxShingleSize=2 and maxShingleSize=3.

please divide 
divide this 
this sentence 

when i set maxShingleSize to 4 output is:

please divide 
please divide this sentence 
divide this 
this sentence 

I was expecting the output as follows with maxShingleSize=3 and outputUnigrams=false :

please divide this 
divide this sentence 

Am I missing something or this is the expected behavior?

I checked source code of ShingleFilterTest (lucene 3.0.0) and see that TRI_GRAM_TOKENS are tested with only outputUnigrams=true but not with outputUnigrams=false.


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44326-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 02 19:03:09 2010
Return-Path: <java-user-return-44326-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18217 invoked from network); 2 Jan 2010 19:03:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Jan 2010 19:03:09 -0000
Received: (qmail 32608 invoked by uid 500); 2 Jan 2010 19:03:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32526 invoked by uid 500); 2 Jan 2010 19:03:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32516 invoked by uid 99); 2 Jan 2010 19:03:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 02 Jan 2010 19:03:06 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of kumanan@gmail.com designates 209.85.223.195 as permitted sender)
Received: from [209.85.223.195] (HELO mail-iw0-f195.google.com) (209.85.223.195)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 02 Jan 2010 19:02:57 +0000
Received: by iwn33 with SMTP id 33so1915034iwn.29
        for <java-user@lucene.apache.org>; Sat, 02 Jan 2010 11:02:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:date:message-id
         :subject:from:to:content-type;
        bh=+7HznkPrDKFf9Z25lOkQu9TdxZVOt38ailyMiZyaNeg=;
        b=SplfEEWRZOjR3ZRC9CGkr5H7ijV6MaNyooul6x3ECq+a96QEMxUz3fJvBgEJpbcM41
         6ar2/yK239FCPLbzvr0ifbiXZYtIB2YRpYqz6Mrto994SYyNgC1Mr5yd7UYVijqLlJvq
         M+pJFGtadhSSVo+eLo3f0GgFDpctuVIMqxQ4U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:reply-to:date:message-id:subject:from:to:content-type;
        b=D6itqn6s8GrgtC9dVNjUYQeYHwHGkxt6GVtdveIz6YJcyzEuXyQyugnIUq6dNgUbxz
         09ETnpO/pDaG3nqYRMdZ78WC5deZ9zOiq1Yk538hicMoE6TUZ3PekhnnYaPVJijklBIH
         bSXntfDk7wlorQJig9bvAClEulWrz38N2yuz4=
MIME-Version: 1.0
Received: by 10.231.153.69 with SMTP id j5mr2123803ibw.33.1262458955783; Sat, 
	02 Jan 2010 11:02:35 -0800 (PST)
Reply-To: kumanan@kumanan.com
Date: Sat, 2 Jan 2010 11:02:35 -0800
Message-ID: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com>
Subject: NumericRangeQuery performance with 1/2 billion documents in the index
From: Kumanan <kumanan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636d33c7c9a5e69047c33213b
X-Virus-Checked: Checked by ClamAV on apache.org

--001636d33c7c9a5e69047c33213b
Content-Type: text/plain; charset=ISO-8859-1

Hi,

We have an index with 500 million documents in the index. Index size is 104
GB and 4 GB RAM for the search server.

When we try to do NumericRangeQuery on document_date field, it takes around
7-10 seconds. Is this expected for this size index?

Here is how I index that field.

            documentDateTimeField = new NumericField(DOCUMENT_DATE_TIME, 1,
Field.Store.NO, true);
            documentDateTimeField.setOmitNorms(true);
            documentDateTimeField.setOmitTermFreqAndPositions(true);

            if(scoreDetails.getDocumentDate() != null) {

 documentDateTimeField.setLongValue(scoreDetails.getDocumentDate().getTime());
            } else {
                documentDateTimeField.setIntValue(0);
            }
            doc.add(documentDateTimeField);

Here is how I construct the range query.

                    Long begin = esq.getBeginDate().getTime();
                    Long end = esq.getEndDate().getTime();

                    NumericRangeQuery rangeQuery =
NumericRangeQuery.newLongRange(WordSentenceDocumentFields.DOCUMENT_DATE_TIME,
                            1, begin, end,
                            esq.isBeginDateInclusive(),
esq.isEndDateInclusive());

                    BooleanQuery bq = new BooleanQuery();
                    bq.add(query, BooleanClause.Occur.MUST);
                    bq.add(rangeQuery, BooleanClause.Occur.MUST);

                    query = bq;

Am I doing something wrong?

Thanks
Kumanan

--001636d33c7c9a5e69047c33213b--

From java-user-return-44327-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 02 21:47:00 2010
Return-Path: <java-user-return-44327-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61712 invoked from network); 2 Jan 2010 21:47:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Jan 2010 21:47:00 -0000
Received: (qmail 8442 invoked by uid 500); 2 Jan 2010 21:46:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8362 invoked by uid 500); 2 Jan 2010 21:46:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8352 invoked by uid 99); 2 Jan 2010 21:46:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 02 Jan 2010 21:46:57 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 02 Jan 2010 21:46:48 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 0E70B45F355;
	Sat,  2 Jan 2010 22:46:25 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id LhbuJjwLdxTD; Sat,  2 Jan 2010 22:46:10 +0100 (CET)
Received: from VEGA (dslb-088-065-074-035.pools.arcor-ip.net [88.65.74.35])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 7E57245F317;
	Sat,  2 Jan 2010 22:46:10 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>,
	<kumanan@kumanan.com>
References: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com>
Subject: RE: NumericRangeQuery performance with 1/2 billion documents in the index
Date: Sat, 2 Jan 2010 22:46:13 +0100
Message-ID: <0A449590474F47BC91C5A63780386725@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcqL3kKbk7IxfLpaSWiK7WCYOhVO1gAFb19A
In-Reply-To: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579

The information you gave us is a little spare.
- What JVM do you use, what processor,...
- How many documents match the query? NRQ is very fast, but if your range
hits e.g. one third of all documents, the hit collection of 166 mill docs
also takes lots of time. 7 seconds is normal for this case. Even with 50 mio
docs in the result range, collection would take in the seconds area for most
cpus.
- Why do you index and query with precision step 1? I would first try 6 or 4
with long fields. With too low precSteps, queries get slower because you
have a very, very large term index (64 terms per value!) and your query has
to reposition the term index very often.
- Why do you index NULL values as an integer (not long!) field with value 0?
Those fiels are useless for your query and will never match any range on
LONG values. So why not simply remove them? They also produce lots of terms
with precStep=1 (32 terms).

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Kumanan [mailto:kumanan@gmail.com]
> Sent: Saturday, January 02, 2010 8:03 PM
> To: java-user@lucene.apache.org
> Subject: NumericRangeQuery performance with 1/2 billion documents in the
> index
> 
> Hi,
> 
> We have an index with 500 million documents in the index. Index size is
> 104
> GB and 4 GB RAM for the search server.
> 
> When we try to do NumericRangeQuery on document_date field, it takes
> around
> 7-10 seconds. Is this expected for this size index?
> 
> Here is how I index that field.
> 
>             documentDateTimeField = new NumericField(DOCUMENT_DATE_TIME,
> 1,
> Field.Store.NO, true);
>             documentDateTimeField.setOmitNorms(true);
>             documentDateTimeField.setOmitTermFreqAndPositions(true);
> 
>             if(scoreDetails.getDocumentDate() != null) {
> 
> 
> documentDateTimeField.setLongValue(scoreDetails.getDocumentDate().getTime(
> ));
>             } else {
>                 documentDateTimeField.setIntValue(0);
>             }
>             doc.add(documentDateTimeField);
> 
> Here is how I construct the range query.
> 
>                     Long begin = esq.getBeginDate().getTime();
>                     Long end = esq.getEndDate().getTime();
> 
>                     NumericRangeQuery rangeQuery =
> NumericRangeQuery.newLongRange(WordSentenceDocumentFields.DOCUMENT_DATE_TI
> ME,
>                             1, begin, end,
>                             esq.isBeginDateInclusive(),
> esq.isEndDateInclusive());
> 
>                     BooleanQuery bq = new BooleanQuery();
>                     bq.add(query, BooleanClause.Occur.MUST);
>                     bq.add(rangeQuery, BooleanClause.Occur.MUST);
> 
>                     query = bq;
> 
> Am I doing something wrong?
> 
> Thanks
> Kumanan


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44328-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 02 21:53:16 2010
Return-Path: <java-user-return-44328-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64494 invoked from network); 2 Jan 2010 21:53:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 2 Jan 2010 21:53:16 -0000
Received: (qmail 16827 invoked by uid 500); 2 Jan 2010 21:53:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16756 invoked by uid 500); 2 Jan 2010 21:53:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16746 invoked by uid 99); 2 Jan 2010 21:53:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 02 Jan 2010 21:53:14 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 02 Jan 2010 21:53:05 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 7EA2345F460
	for <java-user@lucene.apache.org>; Sat,  2 Jan 2010 22:52:44 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 5uLHlozS+7xQ for <java-user@lucene.apache.org>;
	Sat,  2 Jan 2010 22:52:34 +0100 (CET)
Received: from VEGA (dslb-088-065-074-035.pools.arcor-ip.net [88.65.74.35])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 1491345F459
	for <java-user@lucene.apache.org>; Sat,  2 Jan 2010 22:52:34 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com> <0A449590474F47BC91C5A63780386725@VEGA>
Subject: RE: NumericRangeQuery performance with 1/2 billion documents in the index
Date: Sat, 2 Jan 2010 22:52:37 +0100
Message-ID: <2996059FE9FC4DA581FD5BA6D75A9CEE@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcqL3kKbk7IxfLpaSWiK7WCYOhVO1gAFb19AAABvHXA=
In-Reply-To: <0A449590474F47BC91C5A63780386725@VEGA>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579

I forgot:
- How did you measure query time?
- Did you warm your index reader?
- omit tf and norms is not needed for numeric fields, it is disabled by
default

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Uwe Schindler [mailto:uwe@thetaphi.de]
> Sent: Saturday, January 02, 2010 10:46 PM
> To: java-user@lucene.apache.org; kumanan@kumanan.com
> Subject: RE: NumericRangeQuery performance with 1/2 billion documents in
> the index
> 
> The information you gave us is a little spare.
> - What JVM do you use, what processor,...
> - How many documents match the query? NRQ is very fast, but if your range
> hits e.g. one third of all documents, the hit collection of 166 mill docs
> also takes lots of time. 7 seconds is normal for this case. Even with 50
> mio
> docs in the result range, collection would take in the seconds area for
> most
> cpus.
> - Why do you index and query with precision step 1? I would first try 6 or
> 4
> with long fields. With too low precSteps, queries get slower because you
> have a very, very large term index (64 terms per value!) and your query
> has
> to reposition the term index very often.
> - Why do you index NULL values as an integer (not long!) field with value
> 0?
> Those fiels are useless for your query and will never match any range on
> LONG values. So why not simply remove them? They also produce lots of
> terms
> with precStep=1 (32 terms).
> 
> Uwe
> 
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
> 
> > -----Original Message-----
> > From: Kumanan [mailto:kumanan@gmail.com]
> > Sent: Saturday, January 02, 2010 8:03 PM
> > To: java-user@lucene.apache.org
> > Subject: NumericRangeQuery performance with 1/2 billion documents in the
> > index
> >
> > Hi,
> >
> > We have an index with 500 million documents in the index. Index size is
> > 104
> > GB and 4 GB RAM for the search server.
> >
> > When we try to do NumericRangeQuery on document_date field, it takes
> > around
> > 7-10 seconds. Is this expected for this size index?
> >
> > Here is how I index that field.
> >
> >             documentDateTimeField = new NumericField(DOCUMENT_DATE_TIME,
> > 1,
> > Field.Store.NO, true);
> >             documentDateTimeField.setOmitNorms(true);
> >             documentDateTimeField.setOmitTermFreqAndPositions(true);
> >
> >             if(scoreDetails.getDocumentDate() != null) {
> >
> >
> >
> documentDateTimeField.setLongValue(scoreDetails.getDocumentDate().getTime(
> > ));
> >             } else {
> >                 documentDateTimeField.setIntValue(0);
> >             }
> >             doc.add(documentDateTimeField);
> >
> > Here is how I construct the range query.
> >
> >                     Long begin = esq.getBeginDate().getTime();
> >                     Long end = esq.getEndDate().getTime();
> >
> >                     NumericRangeQuery rangeQuery =
> >
> NumericRangeQuery.newLongRange(WordSentenceDocumentFields.DOCUMENT_DATE_TI
> > ME,
> >                             1, begin, end,
> >                             esq.isBeginDateInclusive(),
> > esq.isEndDateInclusive());
> >
> >                     BooleanQuery bq = new BooleanQuery();
> >                     bq.add(query, BooleanClause.Occur.MUST);
> >                     bq.add(rangeQuery, BooleanClause.Occur.MUST);
> >
> >                     query = bq;
> >
> > Am I doing something wrong?
> >
> > Thanks
> > Kumanan
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44329-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 03 03:24:20 2010
Return-Path: <java-user-return-44329-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44958 invoked from network); 3 Jan 2010 03:24:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Jan 2010 03:24:20 -0000
Received: (qmail 38443 invoked by uid 500); 3 Jan 2010 03:24:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38350 invoked by uid 500); 3 Jan 2010 03:24:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38340 invoked by uid 99); 3 Jan 2010 03:24:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 03:24:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of kumanan@gmail.com designates 209.85.223.195 as permitted sender)
Received: from [209.85.223.195] (HELO mail-iw0-f195.google.com) (209.85.223.195)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 03:24:08 +0000
Received: by iwn33 with SMTP id 33so2037025iwn.29
        for <java-user@lucene.apache.org>; Sat, 02 Jan 2010 19:23:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type;
        bh=A3uXH3szihrLL2FmgjbIckU+mf5iWqNk6lIbvlFIYSM=;
        b=aysMW/PeyAW22dSuVpwKSg6HN7kBAhSNXMTEB5ovrZGsifhRsHpp8BLnMY5k+h7iCU
         sbrL/eY++/qDWqbBKtxXtWr6ATRPDUD3mpA3M0pATRKhDYyyjHrodUohh9ARH1xk3Kb7
         AUxOcX26gS+4jWrw/ZTxTka+TWKzcuONSRJI8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type;
        b=nKabbCXn5A47AtXxyOGVSzN2QX8kLvQhfpAAPV4m68jwu0/w+8r1KK2Yt6NYyJrRMy
         sxKIjlLmonkuxgchjrJg+42PIcsy6U+4DRXoQHYVo77W54VrqfnYaKg4r2veS2/98e3F
         EsXu2X89mccyScUp3EUlSiOz2T29utRRzgoik=
MIME-Version: 1.0
Received: by 10.231.122.103 with SMTP id k39mr9320477ibr.10.1262489027196; 
	Sat, 02 Jan 2010 19:23:47 -0800 (PST)
Reply-To: kumanan@kumanan.com
In-Reply-To: <2996059FE9FC4DA581FD5BA6D75A9CEE@VEGA>
References: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com>
	 <0A449590474F47BC91C5A63780386725@VEGA>
	 <2996059FE9FC4DA581FD5BA6D75A9CEE@VEGA>
Date: Sat, 2 Jan 2010 19:23:47 -0800
Message-ID: <c037c58e1001021923tc743833w5eb92571edc73c8c@mail.gmail.com>
Subject: Re: NumericRangeQuery performance with 1/2 billion documents in the 
	index
From: Kumanan <kumanan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6460848ffb742047c3a210a

--0016e6460848ffb742047c3a210a
Content-Type: text/plain; charset=ISO-8859-1

Uwe,

Thank you for your response.

Here is some more information.

CPU - We use 2 processor Quad Core intel CPU. (not sure about the particular
model. I will find out)

JVM - OpenJDK 64-Bit Server VM (build 1.6.0-b09, mixed mode)

OS - Linux

The index resides on a SAN.

You are right. The number of matches seems to affect the response time a
lot.

10 million matches takes about 10 seconds

3.7 million matches takes about 4 seconds

I do warm up the index by running around 100 different searches including
range queries.

I measure the query time in the following way

long start = System.currentTimeInMillis()
search();
System.out.println("search time " + (System.currentTimeInMillis() - start));

and running the range query from our UI and monitoring the log. I ran the
same query several times (at least 20 times) from the UI and it consistently
takes between 3-4 seconds for 3.7 million matches.

>>- Why do you index and query with precision step 1? I would first try 6 or
4
>>with long fields. With too low precSteps, queries get slower because you
>>have a very, very large term index (64 terms per value!) and your query
has
>>to reposition the term index very often.

I didn't realize lower precision values might affect search speed for a
large index. I got the impression that lower value is always better if I can
afford the extra hard disk space. I will change it to 6.

>>Why do you index NULL values as an integer (not long!) field with value 0?
>>Those fiels are useless for your query and will never match any range on
>>LONG values. So why not simply remove them? They also produce lots of
terms
>>with precStep=1 (32 terms).

It is a bug which I didn't realize until now. For some reason, I thought I
had to provide exactly one value per document (even for null) for range
queries to work. I will change the code to not set the value in the field
for null.

I will make these changes and see if there is any improvement.

> - How many documents match the query? NRQ is very fast, but if your range
> hits e.g. one third of all documents, the hit collection of 166 mill docs
> also takes lots of time. 7 seconds is normal for this case. Even with 50
> mio
> docs in the result range, collection would take in the seconds area for
> most
> cpus.

This is interesting. I observed the following.

Searches on just the default field (TermQuery) is faster even if there are
millions of matches. However, if I do a boolean query involving another
field such as "pearl AND author:joe" the query is very slow for the same
number of matches.  Our range query is also part of a BooleanQuery such as
"pearl AND docdate:[<begin-val> TO <end-val>]".

Is there any way to address this performance issue with lots of matches in
BooleanQuery?

Thanks again,
Kumanan

On Sat, Jan 2, 2010 at 1:52 PM, Uwe Schindler <uwe@thetaphi.de> wrote:

> I forgot:
> - How did you measure query time?
> - Did you warm your index reader?
> - omit tf and norms is not needed for numeric fields, it is disabled by
> default
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>
> > -----Original Message-----
> > From: Uwe Schindler [mailto:uwe@thetaphi.de]
> > Sent: Saturday, January 02, 2010 10:46 PM
> > To: java-user@lucene.apache.org; kumanan@kumanan.com
> > Subject: RE: NumericRangeQuery performance with 1/2 billion documents in
> > the index
> >
> > The information you gave us is a little spare.
> > - What JVM do you use, what processor,...
> > - How many documents match the query? NRQ is very fast, but if your range
> > hits e.g. one third of all documents, the hit collection of 166 mill docs
> > also takes lots of time. 7 seconds is normal for this case. Even with 50
> > mio
> > docs in the result range, collection would take in the seconds area for
> > most
> > cpus.
> > - Why do you index and query with precision step 1? I would first try 6
> or
> > 4
> > with long fields. With too low precSteps, queries get slower because you
> > have a very, very large term index (64 terms per value!) and your query
> > has
> > to reposition the term index very often.
> > - Why do you index NULL values as an integer (not long!) field with value
> > 0?
> > Those fiels are useless for your query and will never match any range on
> > LONG values. So why not simply remove them? They also produce lots of
> > terms
> > with precStep=1 (32 terms).
> >
> > Uwe
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> > > -----Original Message-----
> > > From: Kumanan [mailto:kumanan@gmail.com]
> > > Sent: Saturday, January 02, 2010 8:03 PM
> > > To: java-user@lucene.apache.org
> > > Subject: NumericRangeQuery performance with 1/2 billion documents in
> the
> > > index
> > >
> > > Hi,
> > >
> > > We have an index with 500 million documents in the index. Index size is
> > > 104
> > > GB and 4 GB RAM for the search server.
> > >
> > > When we try to do NumericRangeQuery on document_date field, it takes
> > > around
> > > 7-10 seconds. Is this expected for this size index?
> > >
> > > Here is how I index that field.
> > >
> > >             documentDateTimeField = new
> NumericField(DOCUMENT_DATE_TIME,
> > > 1,
> > > Field.Store.NO, true);
> > >             documentDateTimeField.setOmitNorms(true);
> > >             documentDateTimeField.setOmitTermFreqAndPositions(true);
> > >
> > >             if(scoreDetails.getDocumentDate() != null) {
> > >
> > >
> > >
> >
> documentDateTimeField.setLongValue(scoreDetails.getDocumentDate().getTime(
> > > ));
> > >             } else {
> > >                 documentDateTimeField.setIntValue(0);
> > >             }
> > >             doc.add(documentDateTimeField);
> > >
> > > Here is how I construct the range query.
> > >
> > >                     Long begin = esq.getBeginDate().getTime();
> > >                     Long end = esq.getEndDate().getTime();
> > >
> > >                     NumericRangeQuery rangeQuery =
> > >
> >
> NumericRangeQuery.newLongRange(WordSentenceDocumentFields.DOCUMENT_DATE_TI
> > > ME,
> > >                             1, begin, end,
> > >                             esq.isBeginDateInclusive(),
> > > esq.isEndDateInclusive());
> > >
> > >                     BooleanQuery bq = new BooleanQuery();
> > >                     bq.add(query, BooleanClause.Occur.MUST);
> > >                     bq.add(rangeQuery, BooleanClause.Occur.MUST);
> > >
> > >                     query = bq;
> > >
> > > Am I doing something wrong?
> > >
> > > Thanks
> > > Kumanan
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6460848ffb742047c3a210a--

From java-user-return-44330-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 03 08:13:12 2010
Return-Path: <java-user-return-44330-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4285 invoked from network); 3 Jan 2010 08:13:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Jan 2010 08:13:11 -0000
Received: (qmail 13152 invoked by uid 500); 3 Jan 2010 08:13:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13057 invoked by uid 500); 3 Jan 2010 08:13:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13046 invoked by uid 99); 3 Jan 2010 08:13:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 08:13:08 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 08:12:57 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 36AD445F319;
	Sun,  3 Jan 2010 09:12:36 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id sRNaqvyG0vYm; Sun,  3 Jan 2010 09:12:25 +0100 (CET)
Received: from VEGA (dslb-088-065-067-235.pools.arcor-ip.net [88.65.67.235])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 2F33945F317;
	Sun,  3 Jan 2010 09:12:25 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>,
	<kumanan@kumanan.com>
References: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com> <0A449590474F47BC91C5A63780386725@VEGA> <2996059FE9FC4DA581FD5BA6D75A9CEE@VEGA> <c037c58e1001021923tc743833w5eb92571edc73c8c@mail.gmail.com>
Subject: RE: NumericRangeQuery performance with 1/2 billion documents in the index
Date: Sun, 3 Jan 2010 09:12:28 +0100
Message-ID: <9D5C2E3F17EE4A6EA4216FB0764EF78C@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <c037c58e1001021923tc743833w5eb92571edc73c8c@mail.gmail.com>
Thread-Index: AcqMJE15U63uCeMbTDy/jh5W1hWKLAAJ6sbA
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Kumanan,

Just for completeness:
Have you tried out how long the NRQ takes without the BooleanQuery? If it is
also fast, then there is indeed a problem with the BQ.

You measure the time that the search method needs to e.g. return the n top
matching docs? Or do you iterate over all results?

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Kumanan [mailto:kumanan@gmail.com]
> Sent: Sunday, January 03, 2010 4:24 AM
> To: java-user@lucene.apache.org
> Subject: Re: NumericRangeQuery performance with 1/2 billion documents in
> the index
> 
> Uwe,
> 
> Thank you for your response.
> 
> Here is some more information.
> 
> CPU - We use 2 processor Quad Core intel CPU. (not sure about the
> particular
> model. I will find out)
> 
> JVM - OpenJDK 64-Bit Server VM (build 1.6.0-b09, mixed mode)
> 
> OS - Linux
> 
> The index resides on a SAN.
> 
> You are right. The number of matches seems to affect the response time a
> lot.
> 
> 10 million matches takes about 10 seconds
> 
> 3.7 million matches takes about 4 seconds
> 
> I do warm up the index by running around 100 different searches including
> range queries.
> 
> I measure the query time in the following way
> 
> long start = System.currentTimeInMillis()
> search();
> System.out.println("search time " + (System.currentTimeInMillis() -
> start));
> 
> and running the range query from our UI and monitoring the log. I ran the
> same query several times (at least 20 times) from the UI and it
> consistently
> takes between 3-4 seconds for 3.7 million matches.
> 
> >>- Why do you index and query with precision step 1? I would first try 6
> or
> 4
> >>with long fields. With too low precSteps, queries get slower because you
> >>have a very, very large term index (64 terms per value!) and your query
> has
> >>to reposition the term index very often.
> 
> I didn't realize lower precision values might affect search speed for a
> large index. I got the impression that lower value is always better if I
> can
> afford the extra hard disk space. I will change it to 6.
> 
> >>Why do you index NULL values as an integer (not long!) field with value
> 0?
> >>Those fiels are useless for your query and will never match any range on
> >>LONG values. So why not simply remove them? They also produce lots of
> terms
> >>with precStep=1 (32 terms).
> 
> It is a bug which I didn't realize until now. For some reason, I thought I
> had to provide exactly one value per document (even for null) for range
> queries to work. I will change the code to not set the value in the field
> for null.
> 
> I will make these changes and see if there is any improvement.
> 
> > - How many documents match the query? NRQ is very fast, but if your
> range
> > hits e.g. one third of all documents, the hit collection of 166 mill
> docs
> > also takes lots of time. 7 seconds is normal for this case. Even with 50
> > mio
> > docs in the result range, collection would take in the seconds area for
> > most
> > cpus.
> 
> This is interesting. I observed the following.
> 
> Searches on just the default field (TermQuery) is faster even if there are
> millions of matches. However, if I do a boolean query involving another
> field such as "pearl AND author:joe" the query is very slow for the same
> number of matches.  Our range query is also part of a BooleanQuery such as
> "pearl AND docdate:[<begin-val> TO <end-val>]".
> 
> Is there any way to address this performance issue with lots of matches in
> BooleanQuery?
> 
> Thanks again,
> Kumanan
> 
> On Sat, Jan 2, 2010 at 1:52 PM, Uwe Schindler <uwe@thetaphi.de> wrote:
> 
> > I forgot:
> > - How did you measure query time?
> > - Did you warm your index reader?
> > - omit tf and norms is not needed for numeric fields, it is disabled by
> > default
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> >
> > > -----Original Message-----
> > > From: Uwe Schindler [mailto:uwe@thetaphi.de]
> > > Sent: Saturday, January 02, 2010 10:46 PM
> > > To: java-user@lucene.apache.org; kumanan@kumanan.com
> > > Subject: RE: NumericRangeQuery performance with 1/2 billion documents
> in
> > > the index
> > >
> > > The information you gave us is a little spare.
> > > - What JVM do you use, what processor,...
> > > - How many documents match the query? NRQ is very fast, but if your
> range
> > > hits e.g. one third of all documents, the hit collection of 166 mill
> docs
> > > also takes lots of time. 7 seconds is normal for this case. Even with
> 50
> > > mio
> > > docs in the result range, collection would take in the seconds area
> for
> > > most
> > > cpus.
> > > - Why do you index and query with precision step 1? I would first try
> 6
> > or
> > > 4
> > > with long fields. With too low precSteps, queries get slower because
> you
> > > have a very, very large term index (64 terms per value!) and your
> query
> > > has
> > > to reposition the term index very often.
> > > - Why do you index NULL values as an integer (not long!) field with
> value
> > > 0?
> > > Those fiels are useless for your query and will never match any range
> on
> > > LONG values. So why not simply remove them? They also produce lots of
> > > terms
> > > with precStep=1 (32 terms).
> > >
> > > Uwe
> > >
> > > -----
> > > Uwe Schindler
> > > H.-H.-Meier-Allee 63, D-28213 Bremen
> > > http://www.thetaphi.de
> > > eMail: uwe@thetaphi.de
> > >
> > > > -----Original Message-----
> > > > From: Kumanan [mailto:kumanan@gmail.com]
> > > > Sent: Saturday, January 02, 2010 8:03 PM
> > > > To: java-user@lucene.apache.org
> > > > Subject: NumericRangeQuery performance with 1/2 billion documents in
> > the
> > > > index
> > > >
> > > > Hi,
> > > >
> > > > We have an index with 500 million documents in the index. Index size
> is
> > > > 104
> > > > GB and 4 GB RAM for the search server.
> > > >
> > > > When we try to do NumericRangeQuery on document_date field, it takes
> > > > around
> > > > 7-10 seconds. Is this expected for this size index?
> > > >
> > > > Here is how I index that field.
> > > >
> > > >             documentDateTimeField = new
> > NumericField(DOCUMENT_DATE_TIME,
> > > > 1,
> > > > Field.Store.NO, true);
> > > >             documentDateTimeField.setOmitNorms(true);
> > > >             documentDateTimeField.setOmitTermFreqAndPositions(true);
> > > >
> > > >             if(scoreDetails.getDocumentDate() != null) {
> > > >
> > > >
> > > >
> > >
> >
> documentDateTimeField.setLongValue(scoreDetails.getDocumentDate().getTime(
> > > > ));
> > > >             } else {
> > > >                 documentDateTimeField.setIntValue(0);
> > > >             }
> > > >             doc.add(documentDateTimeField);
> > > >
> > > > Here is how I construct the range query.
> > > >
> > > >                     Long begin = esq.getBeginDate().getTime();
> > > >                     Long end = esq.getEndDate().getTime();
> > > >
> > > >                     NumericRangeQuery rangeQuery =
> > > >
> > >
> >
> NumericRangeQuery.newLongRange(WordSentenceDocumentFields.DOCUMENT_DATE_TI
> > > > ME,
> > > >                             1, begin, end,
> > > >                             esq.isBeginDateInclusive(),
> > > > esq.isEndDateInclusive());
> > > >
> > > >                     BooleanQuery bq = new BooleanQuery();
> > > >                     bq.add(query, BooleanClause.Occur.MUST);
> > > >                     bq.add(rangeQuery, BooleanClause.Occur.MUST);
> > > >
> > > >                     query = bq;
> > > >
> > > > Am I doing something wrong?
> > > >
> > > > Thanks
> > > > Kumanan
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44331-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 03 12:34:33 2010
Return-Path: <java-user-return-44331-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56272 invoked from network); 3 Jan 2010 12:34:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Jan 2010 12:34:33 -0000
Received: (qmail 6910 invoked by uid 500); 3 Jan 2010 12:34:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6852 invoked by uid 500); 3 Jan 2010 12:34:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6842 invoked by uid 99); 3 Jan 2010 12:34:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 12:34:31 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of luocan19826164@sohu.com designates 220.181.26.195 as permitted sender)
Received: from [220.181.26.195] (HELO smtp.sohu.com) (220.181.26.195)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 12:34:20 +0000
Received: from 85737ec54efc4e1 (unknown [116.24.94.136])
	by smtp.sohu.com (Postfix) with ESMTP id A091E851DE2
	for <java-user@lucene.apache.org>; Sun,  3 Jan 2010 20:33:56 +0800 (CST)
From: "luocanrao" <luocan19826164@sohu.com>
To: <java-user@lucene.apache.org>
Subject: about optimize() quetion ,Looking forward to hearing from you soon! Thank you in advance!
Date: Sun, 3 Jan 2010 20:33:57 +0800
Message-ID: <000301ca8c71$0555c2a0$100147e0$@com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0004_01CA8CB4.137902A0"
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqMcQSGA8uWepDoQDmVXLZj7U6BVw==
Content-Language: zh-cn
X-SOHU-Antispam-Bayes: 0
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0004_01CA8CB4.137902A0
Content-Type: text/plain;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable

If some but not all readers re-open while an

optimize is underway, this will cause > 2X temporary

space to be consumed as those new readers will then

hold open the partially optimized segments at that

time.  It is best not to re-open readers while optimize is running  =20

=20

my question is:

1=A1=A2if  the readers do not call re-open, segment file the readers =
will see is
after merged or before merged when optimize() done=20

2=A1=A2when old segment file on disk is removed,if old segment files are =
removed
after optimize() done at once,

How can the readers see the old data on the disk.=20

=20

=20


------=_NextPart_000_0004_01CA8CB4.137902A0--


From java-user-return-44332-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 03 14:04:30 2010
Return-Path: <java-user-return-44332-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90580 invoked from network); 3 Jan 2010 14:04:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Jan 2010 14:04:30 -0000
Received: (qmail 49769 invoked by uid 500); 3 Jan 2010 14:04:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49706 invoked by uid 500); 3 Jan 2010 14:04:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49696 invoked by uid 99); 3 Jan 2010 14:04:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 14:04:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 14:04:19 +0000
Received: by ey-out-2122.google.com with SMTP id 9so2672288eyd.3
        for <java-user@lucene.apache.org>; Sun, 03 Jan 2010 06:03:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=uF3gk9DOzKKIDoBI1gq0ngcwCLVrpuNLFajeyXAq5C8=;
        b=RVkpXCNkaqHsLQpdHSGnWEKG7WYxWpXVDnZIUZuaMVtapFM5a9QrZk6jjTB60Ue4PC
         0tgrcDeYZKu9iUOPQ5wzCQKAqcBf4PSaTtK/KLlwnb+kdy3LdXsJ2i1+Zk8WMZyC1W54
         wJMXO2NpSAt+ir9ZIK1+2+sXwRu4kH4NFLdxM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=ZClD+egGspDfq3CCpYahQu4A3I8B/Ml2Dy2bseeI2+g4fz8cobrAbGz8ZSmmpx0nWv
         zxe2IMVLquKuI6xGw/aVALXwrgJ5HYY5gJV1Uf43CkfG8TLT+raurZ9a0To8qaq2Awtb
         hXa3cxBPFgL4BOz73botgvsnR8fUhKmKAhxrg=
Received: by 10.213.41.196 with SMTP id p4mr14752583ebe.45.1262527438365;
        Sun, 03 Jan 2010 06:03:58 -0800 (PST)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 5sm35097258eyh.24.2010.01.03.06.03.57
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 03 Jan 2010 06:03:57 -0800 (PST)
Message-Id: <7B4B5571-5060-440E-9510-020F1E728B10@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <000301ca8c71$0555c2a0$100147e0$@com>
Content-Type: text/plain; charset=GB2312; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: about optimize() quetion ,Looking forward to hearing from you soon! Thank you in advance!
Date: Sun, 3 Jan 2010 15:03:56 +0100
References: <000301ca8c71$0555c2a0$100147e0$@com>
X-Mailer: Apple Mail (2.936)


3 jan 2010 kl. 13.33 skrev luocanrao:

> 1=A1=A2if  the readers do not call re-open, segment file the readers =
will =20
> see is
> after merged or before merged when optimize() done
>
> 2=A1=A2when old segment file on disk is removed,if old segment files =
are =20
> removed
> after optimize() done at once,
>
> How can the readers see the old data on the disk.


I'm just guessing now.

Afaik the files are not removed until open readers are closed. But =20
perhaps they are. In that case any open file deleted on most modern FS =20=

will be deleted but still accessable from the file handler that keeps =20=

the file open. In the case of an FS that does not handle this an =20
exception will be thrown and the old files will then, according to my =20=

guess, be deleted the next time you open the index and there is no lock.

My question to you is if there is a problem with the current behaviour =20=

or if you're just curios?


        karl=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44333-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 03 15:33:13 2010
Return-Path: <java-user-return-44333-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24778 invoked from network); 3 Jan 2010 15:33:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Jan 2010 15:33:13 -0000
Received: (qmail 86347 invoked by uid 500); 3 Jan 2010 15:33:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86260 invoked by uid 500); 3 Jan 2010 15:33:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86250 invoked by uid 99); 3 Jan 2010 15:33:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 15:33:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 15:33:02 +0000
Received: by ewy25 with SMTP id 25so17866377ewy.5
        for <java-user@lucene.apache.org>; Sun, 03 Jan 2010 07:32:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:cc:content-type;
        bh=Oe1uYBeDiJ/zQs96PbYl6+xxLcRvdFkQxCqgWc4IO5M=;
        b=jRL7A1oH+4Z3qy2lT2DA7Pxt6ndHlCRVfYchtxc/Jk+uYMZ2aeuQ6LtuUxEhMNGanc
         94+WF7BWi0vSnTPlCLrCBwEn0H/UIPFN83bSHPlkvFRfGnxQWkqc7NnDdThQgIqNFQAx
         p4DVDwoSKvEid5YbCNFEDt/T1lObA7TY7U2d0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        b=bwolCpNwNp2gcx2f8LAIKtKbZADNBOCGCwvlA72eeVBfNXT+cGEcOg7OjI3YQUHLCc
         To+7OeXGMPVwo11t0Tq9Y4LhD1HbSf8IFIVktTeGSxZOC77+RrLRbw6Htl+5Md2uW/ig
         AW1dZlKKwoZImSY71JihA48Er0cZj8awwRmZ0=
MIME-Version: 1.0
Received: by 10.216.85.133 with SMTP id u5mr4617536wee.91.1262532761499; Sun, 
	03 Jan 2010 07:32:41 -0800 (PST)
In-Reply-To: <9D5C2E3F17EE4A6EA4216FB0764EF78C@VEGA>
References: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com>
	 <0A449590474F47BC91C5A63780386725@VEGA>
	 <2996059FE9FC4DA581FD5BA6D75A9CEE@VEGA>
	 <c037c58e1001021923tc743833w5eb92571edc73c8c@mail.gmail.com>
	 <9D5C2E3F17EE4A6EA4216FB0764EF78C@VEGA>
Date: Sun, 3 Jan 2010 10:32:41 -0500
Message-ID: <c68e39171001030732m77364001g641e23ecddda3f04@mail.gmail.com>
Subject: Re: NumericRangeQuery performance with 1/2 billion documents in the 
	index
From: Yonik Seeley <yseeley@gmail.com>
To: java-user@lucene.apache.org
Cc: kumanan@kumanan.com
Content-Type: text/plain; charset=ISO-8859-1

Perhaps this is just a huge index, and not enough of it can be cached in RAM.
Adding additional clauses to a boolean query incrementally destroys locality.

104GB of index and 4GB of RAM means you're going to be hitting the
disk constantly.  You need more hardware - if you're requirements are
low (low query volume, high query latency of a few seconds OK) then
you can probably get away with a single box... just either get  a SSD
or get more RAM (like 32G or more).

If you want higher query volumes or consistent sub-second search,
you're going to have to go distributed.
Roll your own or look at Solr.

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44334-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 03 15:42:42 2010
Return-Path: <java-user-return-44334-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27040 invoked from network); 3 Jan 2010 15:42:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Jan 2010 15:42:42 -0000
Received: (qmail 94209 invoked by uid 500); 3 Jan 2010 15:42:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94120 invoked by uid 500); 3 Jan 2010 15:42:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94110 invoked by uid 99); 3 Jan 2010 15:42:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 15:42:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 15:42:31 +0000
Received: by ewy25 with SMTP id 25so17871666ewy.5
        for <java-user@lucene.apache.org>; Sun, 03 Jan 2010 07:42:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=67eaIleiJRRaz1aIhvF2KjVlrvipwPOvggxIfIe953U=;
        b=bKjmSXUgvOkv0D0ZgXyW9DjBSjtkKVHsq+EenFRA1yJdlta8fODvmvKKyllPAJ/Zq9
         ekkv/UW4x1mvCwnG7q+6UUlUm1XJizGaWJZQoQoDaAxqtWi9fC9Yxi3PZDOz+YXI0Bj0
         0u0W+rMoeSemnMHQl+YR6blAg0WzmK/cxJTJc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=TS1X7yFPPKnyYy36f0Ei+STsg1tCLBlMjYRJwjp+6wBzDG6f4Su89cvlUo5ysq1dSm
         8hGILZRJnk2N5sJwS5jDU7lR35MbRjIl36FWG1MfTd4yUkwHR9fE01DvQE9HvJ4wDLzP
         ntQ0uBcyTnS5Ogcff1iCe7qCxCFM+ABzWV04E=
Received: by 10.213.107.16 with SMTP id z16mr12104433ebo.47.1262533330087;
        Sun, 03 Jan 2010 07:42:10 -0800 (PST)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 24sm35257355eyx.30.2010.01.03.07.42.09
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 03 Jan 2010 07:42:09 -0800 (PST)
Message-Id: <BFB846AC-6E9E-49E3-AC12-17C5DE1910B3@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <c68e39171001030732m77364001g641e23ecddda3f04@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: NumericRangeQuery performance with 1/2 billion documents in the index
Date: Sun, 3 Jan 2010 16:42:08 +0100
References: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com> <0A449590474F47BC91C5A63780386725@VEGA> <2996059FE9FC4DA581FD5BA6D75A9CEE@VEGA> <c037c58e1001021923tc743833w5eb92571edc73c8c@mail.gmail.com> <9D5C2E3F17EE4A6EA4216FB0764EF78C@VEGA> <c68e39171001030732m77364001g641e23ecddda3f04@mail.gmail.com>
X-Mailer: Apple Mail (2.936)


3 jan 2010 kl. 16.32 skrev Yonik Seeley:

> Perhaps this is just a huge index, and not enough of it can be  
> cached in RAM.
> Adding additional clauses to a boolean query incrementally destroys  
> locality.
>
> 104GB of index and 4GB of RAM means you're going to be hitting the
> disk constantly.  You need more hardware - if you're requirements are
> low (low query volume, high query latency of a few seconds OK) then
> you can probably get away with a single box... just either get  a SSD
> or get more RAM (like 32G or more).
>
> If you want higher query volumes or consistent sub-second search,
> you're going to have to go distributed.
> Roll your own or look at Solr.

I'm not sure I agree.

A 104GB index says nothing about the date field. And it says nothing  
about the range of the query.

If you ask me then what really is needed is some statistics about how  
many terms the date field contains and how wide the range query is.


      karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44335-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 03 16:03:42 2010
Return-Path: <java-user-return-44335-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33545 invoked from network); 3 Jan 2010 16:03:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Jan 2010 16:03:42 -0000
Received: (qmail 15542 invoked by uid 500); 3 Jan 2010 16:03:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15451 invoked by uid 500); 3 Jan 2010 16:03:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15441 invoked by uid 99); 3 Jan 2010 16:03:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 16:03:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 16:03:31 +0000
Received: by ewy25 with SMTP id 25so17884527ewy.5
        for <java-user@lucene.apache.org>; Sun, 03 Jan 2010 08:03:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:reply-to:received
         :in-reply-to:references:date:x-google-sender-auth:message-id:subject
         :from:to:content-type:content-transfer-encoding;
        bh=n8pM5yBpl1r8QwEi15eJuNOd15XsIRi1u5qjbx1EoRY=;
        b=xKJRPNStld3PCJraWno/DsjC3OUtt+WHqAGCG93D8t+EaFfgpzO4sppjvraNGUGCu/
         U8ehIBFXgkzuPrJHG8ocrYwsYfy+ayHilyYKBb8Gt9w49NLkH/1AGB59wyVGhGZJPZm7
         GutAltjDGC/+ptbsHmupQhrvhEpS6S1kB1cHk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:reply-to:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        b=wrI8x42pcVDd4vAgjbre1YTpv47NcBpJz0kmvNPXcjWLpxAs2NIqYpnYnvPPTelNJi
         4F3BWxikKBZJlXB8KLquI3siKGMtW/BlNtxUkY2XWOsK5AeDhznru5xci1UhKNbHXEAA
         uKJYFPmvRRPXWz0OAbL5sUUFFy0VElEdD4++U=
MIME-Version: 1.0
Sender: yseeley@gmail.com
Reply-To: yonik@lucidimagination.com
Received: by 10.216.91.5 with SMTP id g5mr8213348wef.168.1262534591065; Sun, 
	03 Jan 2010 08:03:11 -0800 (PST)
In-Reply-To: <BFB846AC-6E9E-49E3-AC12-17C5DE1910B3@gmail.com>
References: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com>
	 <0A449590474F47BC91C5A63780386725@VEGA>
	 <2996059FE9FC4DA581FD5BA6D75A9CEE@VEGA>
	 <c037c58e1001021923tc743833w5eb92571edc73c8c@mail.gmail.com>
	 <9D5C2E3F17EE4A6EA4216FB0764EF78C@VEGA>
	 <c68e39171001030732m77364001g641e23ecddda3f04@mail.gmail.com>
	 <BFB846AC-6E9E-49E3-AC12-17C5DE1910B3@gmail.com>
Date: Sun, 3 Jan 2010 11:03:11 -0500
X-Google-Sender-Auth: 8ea59b11afc050de
Message-ID: <c68e39171001030803g7e570db2n870b37edbe2bc7c0@mail.gmail.com>
Subject: Re: NumericRangeQuery performance with 1/2 billion documents in the 
	index
From: Yonik Seeley <yonik@lucidimagination.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Sun, Jan 3, 2010 at 10:42 AM, Karl Wettin <karl.wettin@gmail.com> wrote:
>
> 3 jan 2010 kl. 16.32 skrev Yonik Seeley:
>
>> Perhaps this is just a huge index, and not enough of it can be cached in
>> RAM.
>> Adding additional clauses to a boolean query incrementally destroys
>> locality.
>>
>> 104GB of index and 4GB of RAM means you're going to be hitting the
>> disk constantly. =A0You need more hardware - if you're requirements are
>> low (low query volume, high query latency of a few seconds OK) then
>> you can probably get away with a single box... just either get =A0a SSD
>> or get more RAM (like 32G or more).
>>
>> If you want higher query volumes or consistent sub-second search,
>> you're going to have to go distributed.
>> Roll your own or look at Solr.
>
> I'm not sure I agree.
>
> A 104GB index says nothing about the date field. And it says nothing abou=
t
> the range of the query.

Given that there are 500M docs, one can make an educated guess that
much of this 104GB is index and not just stored fields.  IMO, it's
simply too many docs and too big of a ratio between RAM and index size
for "good" query performance.  But I don't think we've heard what the
requirements for this index are.

A quick "ls -l" of the index directory would be revealing though.

-Yonik
http://www.lucidimagination.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44336-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 03 17:42:11 2010
Return-Path: <java-user-return-44336-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61853 invoked from network); 3 Jan 2010 17:42:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 3 Jan 2010 17:42:11 -0000
Received: (qmail 66746 invoked by uid 500); 3 Jan 2010 17:42:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66658 invoked by uid 500); 3 Jan 2010 17:42:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66646 invoked by uid 99); 3 Jan 2010 17:42:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 17:42:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of karl.wettin@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 03 Jan 2010 17:42:00 +0000
Received: by ewy25 with SMTP id 25so17947247ewy.5
        for <java-user@lucene.apache.org>; Sun, 03 Jan 2010 09:41:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=f2d7VzD+dAJ72AeU266M2W6s4WOM7zWM8hP7A+wz13E=;
        b=MJEGG5L7iZ08W+TNrWqYGXi8ZHoA3Gvn0gdwMauDfyKRjn1a5Qzoj1bVb10l8NYYhh
         yzExJZNKXv9HTuqioW79oHGIu0XnPduzZZ73R2NozyNZtHvJI/MWepmqWJr/B+bvE37H
         guD5KC1FpqM6efdCiMT1d7CikcE4oGoNOsKqI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=G6Obt1F/CE3KBcnF75Tp7yX5i/kgMhqNXV25BCvnItyvVsw1RPvcEn792RpA2Umzjk
         AwgeEyFhOmph2VoHdeemKMUhHrAruDnTyjSPoN6ZouY7j5Tjp3Fgr57r3MdSXUl5/IQ3
         ea5qf8roxlqQfPVwyJGCkgEPEFqaIbmq0zVBg=
Received: by 10.213.97.27 with SMTP id j27mr11011962ebn.64.1262540499615;
        Sun, 03 Jan 2010 09:41:39 -0800 (PST)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 28sm35378370eyg.28.2010.01.03.09.41.38
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 03 Jan 2010 09:41:38 -0800 (PST)
Message-Id: <B5C2C026-8A9D-4FAD-816C-05E6907CB56B@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <359a92830912301719x23055fecp7110b5334c263151@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Copy and augment an indexed Document
Date: Sun, 3 Jan 2010 18:41:37 +0100
References: <84fb38e30912301408x9cc6e14leb6b5490db8ad640@mail.gmail.com> <359a92830912301719x23055fecp7110b5334c263151@mail.gmail.com>
X-Mailer: Apple Mail (2.936)


31 dec 2009 kl. 02.19 skrev Erick Erickson:

> It is possible to reconstruct a document from the terms, but
> it's a lossy process. Luke does this (you can see from the
> UI, and the code is available). There's no utility that I know
> of to make this easy.

http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/misc/src/java/org/apache/lucene/index/TermVectorAccessor.java

      karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44337-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 04 05:22:30 2010
Return-Path: <java-user-return-44337-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74025 invoked from network); 4 Jan 2010 05:22:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Jan 2010 05:22:30 -0000
Received: (qmail 7933 invoked by uid 500); 4 Jan 2010 05:22:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7828 invoked by uid 500); 4 Jan 2010 05:22:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7818 invoked by uid 99); 4 Jan 2010 05:22:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 05:22:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.60] (HELO web50306.mail.re2.yahoo.com) (206.190.38.60)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 04 Jan 2010 05:22:18 +0000
Received: (qmail 49807 invoked by uid 60001); 4 Jan 2010 05:21:56 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262582516; bh=F9eh/DUHe359p3CwncMLaYI8PLqhjbQDL86xlcmLfVQ=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=p665IR2OirDt5TtTSYSMXEBDiqGXqboNUuU93N126EuJCSE57P7rIoC0A+mEC9ftUATlCNTTwnG/Ob4ARGxdUvBDotXjrXILIj+gXwhCu/Y428uS5ZeIwD4YJlKAqVl8YFRCAq1IpbkVYZXlm/n/U5Z/sYbLrZYmNRr0c8Afd6U=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=XdsMVfqZK2dSkiquL5i7imNRXbIUdWSCxJqZqop/ffrQ7EcL3dxsSjcjS4i9RNth5CWTKmOqMx5ynYpV4k9CsNeO2kU87YgOG7CzMKtdKpryWlhewwhXNFYhIorBgE0n+dJKbbOl+4QyMa0px/ufdGhxoWjVDoCEpKO9sbpUgVA=;
Message-ID: <441763.49641.qm@web50306.mail.re2.yahoo.com>
X-YMail-OSG: p_vIYE0VM1m6esvWafThT4R3lmuD6J9sKvo78irjwlZ3qJand0VmrxPjjeebtKlgrc29wsDbldHNv.M2a6LxNvktT4ta024lPvN4_eS3gFtWoUmrgwKvD02lmW8X4gn6IBHrpuPwC733A.Gk3Qp6IstU8CSFCNYTqjDM2oEh__P8dVGO0UNlqNLxz.rLyK2N0vXwFu4tKiJ8q65fdkaUlhlW2EcfeDyR7jzYUjbihbEqpvbLpdE8XG74CL7gOL8StYIpi.mzXXpNJ9r99CVMyE33IzAOOWgidz73LsuxXdKEjOv5cbupmgz2DD3vEjDDU_R03u2MBTklEXHOVbgCNXgcuzqRj4feX0RBJYf2gpURWbeF8nK13QPajsHGSXayrWWe3wy4HI2GRp6qCKdXBfZyvbBtODrkfm7sL9736DNJdqjgpkgO
Received: from [74.72.161.151] by web50306.mail.re2.yahoo.com via HTTP; Sun, 03 Jan 2010 21:21:56 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <200912141539.35382.wzzelfzzel@abas.de>
Date: Sun, 3 Jan 2010 21:21:56 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: NGramTokenizer stops working after about 1000 terms
To: java-user@lucene.apache.org
In-Reply-To: <200912141539.35382.wzzelfzzel@abas.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

This actually rings a bell for me... have a look at Lucene's JIRA, I think this was reported as a bug once and perhaps has been fixed.


Note that Lucene in Action 2 has a case study that talks about searching source code.  You may find that study interesting.
 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Stefan Trcek <wzzelfzzel@abas.de>
> To: java-user@lucene.apache.org
> Sent: Mon, December 14, 2009 9:39:34 AM
> Subject: NGramTokenizer stops working after about 1000 terms
> 
> Hello
> 
> For a source code (git repo) search engine I choose to use an ngram 
> analyzer for substring search (something like "git blame").
> 
> This worked fine except it didn't find some strings. I tracked it down 
> to the analyzer. When the ngram analyzer yielded about 1000 terms it 
> stopped yielding more terms, seem to be at most (1024 - ngram_length) 
> terms. When I use StandardAnalyzer it works as expected.
> Is this a bug or did I miss a limit?
> 
> Tested with lucene-2.9.1 and 3.0, this is the core routine I use:
> 
> public static class NGramAnalyzer5 extends Analyzer {
>     public TokenStream tokenStream(String fieldName, Reader reader) {
>         return new NGramTokenizer(reader, 5, 5);
>     }
> }
> 
> public static String[] analyzeString(Analyzer analyzer,
>             String fieldName, String string) throws IOException {
>     Listoutput = new ArrayList();
>     TokenStream tokenStream = analyzer.tokenStream(fieldName,
>             new StringReader(string));
>     TermAttribute termAtt = (TermAttribute)tokenStream.addAttribute(
>             TermAttribute.class);
>     tokenStream.reset();
>     while (tokenStream.incrementToken()) {
>         output.add(termAtt.term());
>     }
>     tokenStream.end();
>     tokenStream.close();
>     return output.toArray(new String[0]);
> }  
> 
> The complete example is attached. "in.txt" must be in "." and is plain 
> ASCII.
> 
> Stefan
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44338-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 04 09:08:04 2010
Return-Path: <java-user-return-44338-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7753 invoked from network); 4 Jan 2010 09:08:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Jan 2010 09:08:03 -0000
Received: (qmail 1343 invoked by uid 500); 4 Jan 2010 08:06:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1272 invoked by uid 500); 4 Jan 2010 08:06:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1262 invoked by uid 99); 4 Jan 2010 08:06:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 08:06:01 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 08:05:51 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id C455445F475;
	Mon,  4 Jan 2010 09:05:30 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id F9h9lbh6TDNu; Mon,  4 Jan 2010 09:05:20 +0100 (CET)
Received: from VEGA (dslb-088-065-119-088.pools.arcor-ip.net [88.65.119.88])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id A8A0345F46D;
	Mon,  4 Jan 2010 09:05:20 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>,
	"'Michael McCandless'" <lucene@mikemccandless.com>
Subject: Hudson again stuck in [junit] Testsuite: org.apache.lucene.benchmark.byTask.TestPerfTasksLogic
Date: Mon, 4 Jan 2010 09:05:24 +0100
Message-ID: <8670A6DB4842495AB5CCFDB874C0CA58@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
Thread-Index: AcqNFKs2pReKVzzsQhSPM/kyTXmnQg==
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Just for info. Maybe we can this time get a stack trace.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44339-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 04 11:37:39 2010
Return-Path: <java-user-return-44339-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66396 invoked from network); 4 Jan 2010 11:37:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Jan 2010 11:37:39 -0000
Received: (qmail 91148 invoked by uid 500); 4 Jan 2010 11:37:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91065 invoked by uid 500); 4 Jan 2010 11:37:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91055 invoked by uid 99); 4 Jan 2010 11:37:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 11:37:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.193] (HELO mail-yx0-f193.google.com) (209.85.210.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 11:37:26 +0000
Received: by yxe31 with SMTP id 31so14680347yxe.21
        for <java-user@lucene.apache.org>; Mon, 04 Jan 2010 03:37:05 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.29.20 with SMTP id g20mr13487477ybj.189.1262605025455; 
	Mon, 04 Jan 2010 03:37:05 -0800 (PST)
In-Reply-To: <8670A6DB4842495AB5CCFDB874C0CA58@VEGA>
References: <8670A6DB4842495AB5CCFDB874C0CA58@VEGA>
Date: Mon, 4 Jan 2010 06:37:05 -0500
Message-ID: <9ac0c6aa1001040337oc7f14e4mbdfb805b47114218@mail.gmail.com>
Subject: Re: Hudson again stuck in [junit] Testsuite: org.apache.lucene.benchmark.byTask.TestPerfTasksLogic
From: Michael McCandless <lucene@mikemccandless.com>
To: Uwe Schindler <uwe@thetaphi.de>
Cc: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

I just kill -QUIT'd it.  It's again in the TestBGSearchTaskThreads...
somehow the lower priority is not carrying through to the search
threads.  I'll dig.

Mike

On Mon, Jan 4, 2010 at 3:05 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
> Just for info. Maybe we can this time get a stack trace.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44340-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 04 11:55:05 2010
Return-Path: <java-user-return-44340-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70449 invoked from network); 4 Jan 2010 11:55:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Jan 2010 11:55:05 -0000
Received: (qmail 19041 invoked by uid 500); 4 Jan 2010 11:54:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18965 invoked by uid 500); 4 Jan 2010 11:54:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18738 invoked by uid 99); 4 Jan 2010 11:54:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 11:54:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.193] (HELO mail-yx0-f193.google.com) (209.85.210.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 11:54:51 +0000
Received: by yxe31 with SMTP id 31so14688530yxe.21
        for <java-user@lucene.apache.org>; Mon, 04 Jan 2010 03:54:29 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.78.1 with SMTP id a1mr35009758ybb.39.1262606069341; Mon, 
	04 Jan 2010 03:54:29 -0800 (PST)
In-Reply-To: <5271079120438103509@unknownmsgid>
References: <5271079120438103509@unknownmsgid>
Date: Mon, 4 Jan 2010 06:54:29 -0500
Message-ID: <9ac0c6aa1001040354t3cc69636g2dee0a9e3619d1b2@mail.gmail.com>
Subject: Re: Bug on doc parameter in CustomScoreQuery.customScore()
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Alas, this is a bug in CustomScoreQuery.  I've opened this:

  https://issues.apache.org/jira/browse/LUCENE-2190

With Lucene 2.9, we now search one segment at a time.  So the rollback
to 0 that you're seeing is in fact due to a new segment being
searched.  We need to fix CustomScoreQuery to notify the subclass when
it switches to a new segment.

Mike

On Mon, Dec 28, 2009 at 9:21 PM, Paul chez Jamespot
<paul.giraudon@jamespot.com> wrote:
> Hello,
>
>
>
> I'm trying to use the doc parameter to build a customScore, but the 'doc'
> value seems to be different from the global 'docId' when the index is not
> optimized.
>
>
>
>
>
> Basically, I create a DateScoreQuery passing the IndexReader and the fiel=
d
> containing the timestamp (as long)
>
> And I use the FieldCache to access the timestamp value.
>
>
>
>
>
> public class DateScoreQuery extends CustomScoreQuery {
>
> =A0 =A0 =A0private IndexReader ir;
>
> =A0 =A0 =A0private String fld;
>
>
>
> =A0 =A0 =A0public DateScoreQuery(Query subQuery, =A0IndexReader indexRead=
er, String
> fieldTimeStamp) {
>
> =A0 =A0 =A0 =A0 =A0 =A0super(subQuery);
>
> =A0 =A0 =A0 =A0 =A0 =A0ir =3D indexReader;
>
> =A0 =A0 =A0 =A0 =A0 =A0fld=3DfieldTimeStamp;
>
> =A0 =A0 =A0}
>
>
>
> =A0 =A0 =A0public float customScore(int doc, float subQueryScore, float
> valSrcScore) {
>
>
>
> =A0 =A0 =A0 =A0 =A0 =A0long[] timeStamps;
>
> =A0 =A0 =A0 =A0 =A0 =A0try {
>
> timeStamps =3D FieldCache.DEFAULT.getLongs(ir, fld);
>
> }catch(IOException e){.}
>
> =A0 =A0 =A0 =A0 =A0 =A0long docTimeStamp =3D timeStamps[doc];
>
> =A0 =A0 =A0 =A0 =A0 =A0return subQueryScore * timeRatio(docTimeStamp);
>
> =A0 =A0 =A0 =A0}
>
> .
>
> }
>
>
>
> When the index is not optimized, customScore(doc) is never called for hig=
h
> values doc.
>
> Instead, when I debug, I can see doc values looping =A0through cycles.
>
>
>
>
>
> After index optimization, returned values seemed to be correct.
>
>
>
>
>
> Paul Giraudon
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44341-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 04 12:13:00 2010
Return-Path: <java-user-return-44341-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74119 invoked from network); 4 Jan 2010 12:13:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Jan 2010 12:13:00 -0000
Received: (qmail 38215 invoked by uid 500); 4 Jan 2010 12:12:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38137 invoked by uid 500); 4 Jan 2010 12:12:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38124 invoked by uid 99); 4 Jan 2010 12:12:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 12:12:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.193] (HELO mail-yx0-f193.google.com) (209.85.210.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 12:12:48 +0000
Received: by yxe31 with SMTP id 31so14697591yxe.21
        for <java-user@lucene.apache.org>; Mon, 04 Jan 2010 04:12:27 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.95.25 with SMTP id x25mr10558562ybl.33.1262607147423; Mon, 
	04 Jan 2010 04:12:27 -0800 (PST)
In-Reply-To: <9ac0c6aa1001040337oc7f14e4mbdfb805b47114218@mail.gmail.com>
References: <8670A6DB4842495AB5CCFDB874C0CA58@VEGA>
	 <9ac0c6aa1001040337oc7f14e4mbdfb805b47114218@mail.gmail.com>
Date: Mon, 4 Jan 2010 07:12:27 -0500
Message-ID: <9ac0c6aa1001040412k5ab65b55y3918d991bb166d34@mail.gmail.com>
Subject: Re: Hudson again stuck in [junit] Testsuite: org.apache.lucene.benchmark.byTask.TestPerfTasksLogic
From: Michael McCandless <lucene@mikemccandless.com>
To: Uwe Schindler <uwe@thetaphi.de>
Cc: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

OK I've disabled this test for now, and killed the build.

Mike

On Mon, Jan 4, 2010 at 6:37 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> I just kill -QUIT'd it. =A0It's again in the TestBGSearchTaskThreads...
> somehow the lower priority is not carrying through to the search
> threads. =A0I'll dig.
>
> Mike
>
> On Mon, Jan 4, 2010 at 3:05 AM, Uwe Schindler <uwe@thetaphi.de> wrote:
>> Just for info. Maybe we can this time get a stack trace.
>>
>> -----
>> Uwe Schindler
>> H.-H.-Meier-Allee 63, D-28213 Bremen
>> http://www.thetaphi.de
>> eMail: uwe@thetaphi.de
>>
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44342-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 04 18:38:16 2010
Return-Path: <java-user-return-44342-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29765 invoked from network); 4 Jan 2010 18:38:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Jan 2010 18:38:16 -0000
Received: (qmail 68974 invoked by uid 500); 4 Jan 2010 18:38:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68917 invoked by uid 500); 4 Jan 2010 18:38:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68907 invoked by uid 99); 4 Jan 2010 18:38:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 18:38:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of kumanan@gmail.com designates 209.85.223.195 as permitted sender)
Received: from [209.85.223.195] (HELO mail-iw0-f195.google.com) (209.85.223.195)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 18:38:02 +0000
Received: by iwn33 with SMTP id 33so2806238iwn.29
        for <java-user@lucene.apache.org>; Mon, 04 Jan 2010 10:37:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:date:x-google-sender-auth:message-id:subject:from:to
         :content-type;
        bh=gtBRh7XQu3h8mwl4Gz/BtvRNkcks7ajU5qQW0DuHnbE=;
        b=hyZLbTVm0c3YrKexUoWS8IC/V0RLbvwI08WYwk1eAZ9MK409Juad8qFfeMKrPJRzx/
         1PCOtyVAKk4nfTTGSRZyuO2p227hxYdPD0Gxis5uJgLF4WMopiur7xvTlLBtoSY9qHTh
         gOXLfyDxXocq2ufqK4Aq+A8ZgEV0oWB3aBEu4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:date
         :x-google-sender-auth:message-id:subject:from:to:content-type;
        b=P7FtJuHeew63JsUpZ/n76poFUXq0H2tquigOtm7Nu9bt0HIpRW3StsLgJ703UG8TqA
         mUnFQl1p+xc3mtNRUblv9kKZUfEf0N5RN+G3GX8pjUDZpp8mp08y7+pzli9DSMw6R5/q
         3wmrALW04hbV3OhpBgvaiqTcXvDr0DGHEUvzo=
MIME-Version: 1.0
Sender: kumanan@gmail.com
Received: by 10.231.148.3 with SMTP id n3mr526254ibv.25.1262630260585; Mon, 04 
	Jan 2010 10:37:40 -0800 (PST)
In-Reply-To: <9D5C2E3F17EE4A6EA4216FB0764EF78C@VEGA>
References: <c037c58e1001021102w56de9402p879583d6be2d4e92@mail.gmail.com>
	 <0A449590474F47BC91C5A63780386725@VEGA>
	 <2996059FE9FC4DA581FD5BA6D75A9CEE@VEGA>
	 <c037c58e1001021923tc743833w5eb92571edc73c8c@mail.gmail.com>
	 <9D5C2E3F17EE4A6EA4216FB0764EF78C@VEGA>
Date: Mon, 4 Jan 2010 10:37:40 -0800
X-Google-Sender-Auth: 81fa0eacd09810a0
Message-ID: <c037c58e1001041037u76bf22d6g63fb83c91647e799@mail.gmail.com>
Subject: Re: NumericRangeQuery performance with 1/2 billion documents in the 
	index
From: Kumanan Rajamanikkam <kumanan@kumanan.com>
To: Uwe Schindler <uwe@thetaphi.de>, java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f452202a35a5047c5b043b
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f452202a35a5047c5b043b
Content-Type: text/plain; charset=ISO-8859-1

Hi Uwe,

I implemented the changes you suggested. The index size reduced a lot
because of the higher precision value but the range query performance is
still slow especially for lots of matches. Also, I am indexing two fields
now docdatetime (keep the time portion with msec precision) and docdate
(ignore the time portion) . I tested with docdate field thinking it might
fare better than docdatetime field. Please let me know if this is not true.

I am using BigDate to convert Date to int
http://mindprod.com/jgloss/bigdate.html

>>Have you tried out how long the NRQ takes without the BooleanQuery? If it
is
>>also fast, then there is indeed a problem with the BQ

Jan 1, 2009 TO Today

NumericRangeQuery -> docdate:[14245 TO 14613]

matches -> 298813828 documents
search time -> consistently above 9 seconds

BooleanQuery -> metadata AND docdate:[14245 TO 14613]

matches -> 1173 documents
search time -> consistently above 5 seconds

June 1, 2009 TO Today

NumericRangeQuery -> docdate:[14396 TO 14613]

matches -> 15498012 documents
search time -> consistently between 500 - 600 milliseconds

BooleanQuery -> metadata AND docdate:[14396 TO 14613]

matches -> 96 documents
search time -> consistently between 300 - 350 milliseconds

Here is my new code:

Indexing:

documentDateField = new NumericField(DOCUMENT_DATE, 4);
if(scoreDetails.getDocumentDate() != null) {
  documentDateField.setIntValue(getDateAsInt(scoreDetails.getDocumentDate()));
  doc.add(documentDateField);
}

Search:
                   Integer begin = getDateAsInt(esq.getBeginDate());
                    Integer end = getDateAsInt(esq.getEndDate());

                    NumericRangeQuery rangeQuery =
NumericRangeQuery.newIntRange(WordSentenceDocumentFields.DOCUMENT_DATE,
                            4, begin, end,
                            esq.isBeginDateInclusive(),
esq.isEndDateInclusive());

                    BooleanQuery bq = new BooleanQuery();
                    bq.add(query, BooleanClause.Occur.MUST);
                    bq.add(rangeQuery, BooleanClause.Occur.MUST);

                    query = bq;


Please let me know if you see anything wrong in my code or if the
performance numbers is not what you'd expect.

>>You measure the time that the search method needs to e.g. return the n top
>>matching docs? Or do you iterate over all results?

The times above are just for returning the top "10" matching docs.

Iterating the results costs me an extra 20 msec (at most) per result for
this index.

Thank you,
Kumanan

On Sun, Jan 3, 2010 at 12:12 AM, Uwe Schindler <uwe@thetaphi.de> wrote:

> Hi Kumanan,
>
> Just for completeness:
> Have you tried out how long the NRQ takes without the BooleanQuery? If it
> is
> also fast, then there is indeed a problem with the BQ.
>
> You measure the time that the search method needs to e.g. return the n top
> matching docs? Or do you iterate over all results?
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
> > -----Original Message-----
> > From: Kumanan [mailto:kumanan@gmail.com]
> > Sent: Sunday, January 03, 2010 4:24 AM
> > To: java-user@lucene.apache.org
> > Subject: Re: NumericRangeQuery performance with 1/2 billion documents in
> > the index
> >
> > Uwe,
> >
> > Thank you for your response.
> >
> > Here is some more information.
> >
> > CPU - We use 2 processor Quad Core intel CPU. (not sure about the
> > particular
> > model. I will find out)
> >
> > JVM - OpenJDK 64-Bit Server VM (build 1.6.0-b09, mixed mode)
> >
> > OS - Linux
> >
> > The index resides on a SAN.
> >
> > You are right. The number of matches seems to affect the response time a
> > lot.
> >
> > 10 million matches takes about 10 seconds
> >
> > 3.7 million matches takes about 4 seconds
> >
> > I do warm up the index by running around 100 different searches including
> > range queries.
> >
> > I measure the query time in the following way
> >
> > long start = System.currentTimeInMillis()
> > search();
> > System.out.println("search time " + (System.currentTimeInMillis() -
> > start));
> >
> > and running the range query from our UI and monitoring the log. I ran the
> > same query several times (at least 20 times) from the UI and it
> > consistently
> > takes between 3-4 seconds for 3.7 million matches.
> >
> > >>- Why do you index and query with precision step 1? I would first try 6
> > or
> > 4
> > >>with long fields. With too low precSteps, queries get slower because
> you
> > >>have a very, very large term index (64 terms per value!) and your query
> > has
> > >>to reposition the term index very often.
> >
> > I didn't realize lower precision values might affect search speed for a
> > large index. I got the impression that lower value is always better if I
> > can
> > afford the extra hard disk space. I will change it to 6.
> >
> > >>Why do you index NULL values as an integer (not long!) field with value
> > 0?
> > >>Those fiels are useless for your query and will never match any range
> on
> > >>LONG values. So why not simply remove them? They also produce lots of
> > terms
> > >>with precStep=1 (32 terms).
> >
> > It is a bug which I didn't realize until now. For some reason, I thought
> I
> > had to provide exactly one value per document (even for null) for range
> > queries to work. I will change the code to not set the value in the field
> > for null.
> >
> > I will make these changes and see if there is any improvement.
> >
> > > - How many documents match the query? NRQ is very fast, but if your
> > range
> > > hits e.g. one third of all documents, the hit collection of 166 mill
> > docs
> > > also takes lots of time. 7 seconds is normal for this case. Even with
> 50
> > > mio
> > > docs in the result range, collection would take in the seconds area for
> > > most
> > > cpus.
> >
> > This is interesting. I observed the following.
> >
> > Searches on just the default field (TermQuery) is faster even if there
> are
> > millions of matches. However, if I do a boolean query involving another
> > field such as "pearl AND author:joe" the query is very slow for the same
> > number of matches.  Our range query is also part of a BooleanQuery such
> as
> > "pearl AND docdate:[<begin-val> TO <end-val>]".
> >
> > Is there any way to address this performance issue with lots of matches
> in
> > BooleanQuery?
> >
> > Thanks again,
> > Kumanan
> >
> > On Sat, Jan 2, 2010 at 1:52 PM, Uwe Schindler <uwe@thetaphi.de> wrote:
> >
> > > I forgot:
> > > - How did you measure query time?
> > > - Did you warm your index reader?
> > > - omit tf and norms is not needed for numeric fields, it is disabled by
> > > default
> > >
> > > -----
> > > Uwe Schindler
> > > H.-H.-Meier-Allee 63, D-28213 Bremen
> > > http://www.thetaphi.de
> > > eMail: uwe@thetaphi.de
> > >
> > >
> > > > -----Original Message-----
> > > > From: Uwe Schindler [mailto:uwe@thetaphi.de]
> > > > Sent: Saturday, January 02, 2010 10:46 PM
> > > > To: java-user@lucene.apache.org; kumanan@kumanan.com
> > > > Subject: RE: NumericRangeQuery performance with 1/2 billion documents
> > in
> > > > the index
> > > >
> > > > The information you gave us is a little spare.
> > > > - What JVM do you use, what processor,...
> > > > - How many documents match the query? NRQ is very fast, but if your
> > range
> > > > hits e.g. one third of all documents, the hit collection of 166 mill
> > docs
> > > > also takes lots of time. 7 seconds is normal for this case. Even with
> > 50
> > > > mio
> > > > docs in the result range, collection would take in the seconds area
> > for
> > > > most
> > > > cpus.
> > > > - Why do you index and query with precision step 1? I would first try
> > 6
> > > or
> > > > 4
> > > > with long fields. With too low precSteps, queries get slower because
> > you
> > > > have a very, very large term index (64 terms per value!) and your
> > query
> > > > has
> > > > to reposition the term index very often.
> > > > - Why do you index NULL values as an integer (not long!) field with
> > value
> > > > 0?
> > > > Those fiels are useless for your query and will never match any range
> > on
> > > > LONG values. So why not simply remove them? They also produce lots of
> > > > terms
> > > > with precStep=1 (32 terms).
> > > >
> > > > Uwe
> > > >
> > > > -----
> > > > Uwe Schindler
> > > > H.-H.-Meier-Allee 63, D-28213 Bremen
> > > > http://www.thetaphi.de
> > > > eMail: uwe@thetaphi.de
> > > >
> > > > > -----Original Message-----
> > > > > From: Kumanan [mailto:kumanan@gmail.com]
> > > > > Sent: Saturday, January 02, 2010 8:03 PM
> > > > > To: java-user@lucene.apache.org
> > > > > Subject: NumericRangeQuery performance with 1/2 billion documents
> in
> > > the
> > > > > index
> > > > >
> > > > > Hi,
> > > > >
> > > > > We have an index with 500 million documents in the index. Index
> size
> > is
> > > > > 104
> > > > > GB and 4 GB RAM for the search server.
> > > > >
> > > > > When we try to do NumericRangeQuery on document_date field, it
> takes
> > > > > around
> > > > > 7-10 seconds. Is this expected for this size index?
> > > > >
> > > > > Here is how I index that field.
> > > > >
> > > > >             documentDateTimeField = new
> > > NumericField(DOCUMENT_DATE_TIME,
> > > > > 1,
> > > > > Field.Store.NO, true);
> > > > >             documentDateTimeField.setOmitNorms(true);
> > > > >
> documentDateTimeField.setOmitTermFreqAndPositions(true);
> > > > >
> > > > >             if(scoreDetails.getDocumentDate() != null) {
> > > > >
> > > > >
> > > > >
> > > >
> > >
> >
> documentDateTimeField.setLongValue(scoreDetails.getDocumentDate().getTime(
> > > > > ));
> > > > >             } else {
> > > > >                 documentDateTimeField.setIntValue(0);
> > > > >             }
> > > > >             doc.add(documentDateTimeField);
> > > > >
> > > > > Here is how I construct the range query.
> > > > >
> > > > >                     Long begin = esq.getBeginDate().getTime();
> > > > >                     Long end = esq.getEndDate().getTime();
> > > > >
> > > > >                     NumericRangeQuery rangeQuery =
> > > > >
> > > >
> > >
> >
> NumericRangeQuery.newLongRange(WordSentenceDocumentFields.DOCUMENT_DATE_TI
> > > > > ME,
> > > > >                             1, begin, end,
> > > > >                             esq.isBeginDateInclusive(),
> > > > > esq.isEndDateInclusive());
> > > > >
> > > > >                     BooleanQuery bq = new BooleanQuery();
> > > > >                     bq.add(query, BooleanClause.Occur.MUST);
> > > > >                     bq.add(rangeQuery, BooleanClause.Occur.MUST);
> > > > >
> > > > >                     query = bq;
> > > > >
> > > > > Am I doing something wrong?
> > > > >
> > > > > Thanks
> > > > > Kumanan
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
>
>

--001485f452202a35a5047c5b043b--

From java-user-return-44343-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 04 21:33:25 2010
Return-Path: <java-user-return-44343-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83488 invoked from network); 4 Jan 2010 21:33:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Jan 2010 21:33:25 -0000
Received: (qmail 43320 invoked by uid 500); 4 Jan 2010 21:33:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43242 invoked by uid 500); 4 Jan 2010 21:33:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43232 invoked by uid 99); 4 Jan 2010 21:33:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 21:33:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of aseldawy@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 21:33:12 +0000
Received: by bwz22 with SMTP id 22so9758398bwz.5
        for <java-user@lucene.apache.org>; Mon, 04 Jan 2010 13:32:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=jzglZX/Phyr1I2deEYmJSXZvdRk/jKPDj1ous54qNkI=;
        b=Hs/RTvPnpJgN2e4VpSGmrA8Eslp0moH0K0YDp1yeQoxZy0TKnPx3yzqrDWpsSHzZ5w
         9GaSilMyZfO1Je9At18SeECJZSEwXfF1VG7oKX1Lkn++OGITxUZMZA5umUDr3hN3kSqW
         rPor+tu0k7wSyc+uQpcCc3Ncb705RX3aOLwd8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=ZOSG8dxTD8NLB3JlsIBN4lcgoJnxopD5EQ47VyBsya5rE+iC7zbrHL16KEMzmdROGn
         lTzei6M4TLmQlzr65w+C6CzerKwE59iqbIr833EFeEfNzsIs3Dg6ZTECa+mHlVqReSon
         hg9ML5g5MypEt4olgX4ZvFvpSFz/y9KI9wqkA=
MIME-Version: 1.0
Received: by 10.204.27.14 with SMTP id g14mr1416762bkc.15.1262640772176; Mon, 
	04 Jan 2010 13:32:52 -0800 (PST)
In-Reply-To: <B118C2248D6F44058427E261C7A76D10@VEGA>
References: <e5de07e90912271249g25a0f8e4u49c3fb03d3ecd458@mail.gmail.com> 
	<Pine.LNX.4.64.0912271923370.12519@radix.cryptio.net> <7054C18D96924AA187F6D3A3FBDFC8DB@VEGA> 
	<6B18B9E94727414D87F8F7E91EBC5F90@VEGA> <e5de07e90912300256h4bca5993wf1349c71833152d6@mail.gmail.com> 
	<B118C2248D6F44058427E261C7A76D10@VEGA>
From: Ahmed El-dawy <aseldawy@gmail.com>
Date: Mon, 4 Jan 2010 23:32:32 +0200
Message-ID: <e5de07e91001041332x6d0d9521x496b9d68058c68a6@mail.gmail.com>
Subject: Re: Using the new tokenizer API from a jar file
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000325557b22b45d11047c5d7699
X-Virus-Checked: Checked by ClamAV on apache.org

--000325557b22b45d11047c5d7699
Content-Type: text/plain; charset=UTF-8

Sorry for this delay. I was having a silly problem compiling solr but I
figured it out.
I tested it and it worked correctly. Thanks

On Wed, Dec 30, 2009 at 8:31 PM, Uwe Schindler <uwe@thetaphi.de> wrote:

> That would be good, if you could test it!
>
> Please checkout Lucene 2.9 branch from svn
> (http://svn.apache.org/repos/asf/lucene/java/branches/lucene_2_9), compile
> the whole package (at least lucene-core.jar) and then replace the lucene
> jar
> files in solr's lib folder.
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>
> > -----Original Message-----
> > From: Ahmed El-dawy [mailto:aseldawy@gmail.com]
> > Sent: Wednesday, December 30, 2009 11:56 AM
> > To: java-user@lucene.apache.org
> > Cc: solr-user@lucene.apache.org
> > Subject: Re: Using the new tokenizer API from a jar file
> >
> > Thanks all for your interest, especially Uwe. I asked this question on
> > solr-user at the beginning but I got no reply. That's why I re-asked the
> > question at java-user.
> > Thanks for your efforts. I will try it now.
> >
> > On Mon, Dec 28, 2009 at 12:02 PM, Uwe Schindler <uwe@thetaphi.de> wrote:
> >
> > > I opened https://issues.apache.org/jira/browse/LUCENE-2182 about this
> > > problem and already have a fix.
> > >
> > > This is really a bug. The solution is simple because you have to load
> > the
> > > IMPL class using the same classloader as the passed in interface. The
> > > default for Class.forName is the classloader of AttributeSource.class,
> > > which
> > > is the wrong one.
> > >
> > > -----
> > > Uwe Schindler
> > > H.-H.-Meier-Allee 63, D-28213 Bremen
> > > http://www.thetaphi.de
> > > eMail: uwe@thetaphi.de
> > >
> > > > -----Original Message-----
> > > > From: Uwe Schindler [mailto:uwe@thetaphi.de]
> > > > Sent: Monday, December 28, 2009 9:20 AM
> > > > To: java-user@lucene.apache.org
> > > > Cc: solr-user@lucene.apache.org
> > > > Subject: RE: Using the new tokenizer API from a jar file
> > > >
> > > > The question on this list was ok,as it shows a minor problem of using
> > the
> > > > new TokenStream API with Solr.
> > > >
> > > > His plugin was loaded correctly, because if Lucene says, that it
> > cannot
> > > > find
> > > > the *Impl class, it was able to load the interface class before ->
> the
> > > JAR
> > > > file is "visible" to the JVM.
> > > >
> > > > The problem is the following and has to do with classloaders:
> > > >
> > > > 1. We have different class loaders for different places in Solr. Solr
> > > uses
> > > > for plugins a SolrResourceLoader that searches for JAR files in the
> > local
> > > > lib folder before handling over to the webapp's classloader.
> > > >
> > > > 2. Initially, the lucene JAR is loaded by the Webapp's class loader
> > > >
> > > > 3. If a AttributeImpl is placed into a jar file e.g. in the plugin
> > folder
> > > > of
> > > > solr (the lib folder where solr loads all resources, stop words,...),
> > the
> > > > loading mechanism inside AttributeSource.DEFAULT_ATTRIBUTE_FACTORY is
> > > > unable
> > > > to locate the class file, because Class.forName() always uses the
> > class'
> > > > classloader and not the global/thread one's. So AttributeSource will
> > only
> > > > find the class file if it is in the *same* directory as the lucene-
> > > > core.jar
> > > > file (WEB-INF/lib) and so accessible by the webapp's class loader.
> > > >
> > > > A good introduction about the problem is this one:
> > > >
> > >
> >
> http://www.theserverside.com/tt/articles/content/dm_classForname/DynLoad.p
> > > > df
> > > >
> > > > The problem is here described for the JVM extensions folder but also
> > > > applies
> > > > to solr, because it has another classloader for plugins.
> > > >
> > > > A solution to fix this would be in lucene to use the thread's context
> > > > class
> > > > loader in AttributeSource.DEFAULT_ATTRIBUTE_FACTORY, but I strongly
> > > > discourage this, as it would break the whole AttributeSource
> > > functionality
> > > > if you add two different attributes with same class names from
> > different
> > > > class loaders to the AttributeSource.
> > > >
> > > > The only solution to the problem is placing the JAR file inside the
> > > > WEB-INF/lib folder where lucene-core.jar is. Plugins in Solr cannot
> > > define
> > > > own attribute implementations. Alternatively he could try to force
> > > preload
> > > > the class by calling Class.forName in his plugin initialization code
> > on
> > > > the
> > > > Impl class. But I am not sure if this works (as Java handles classes
> > from
> > > > different classloaders different).
> > > >
> > > > Uwe
> > > >
> > > > -----
> > > > Uwe Schindler
> > > > H.-H.-Meier-Allee 63, D-28213 Bremen
> > > > http://www.thetaphi.de
> > > > eMail: uwe@thetaphi.de
> > > >
> > > > > -----Original Message-----
> > > > > From: Chris Hostetter [mailto:hossman_lucene@fucit.org]
> > > > > Sent: Monday, December 28, 2009 4:27 AM
> > > > > To: java-user@lucene.apache.org
> > > > > Subject: Re: Using the new tokenizer API from a jar file
> > > > >
> > > > >
> > > > > : I tried to use it with solr and the problems began. It's always
> > > > telling
> > > > > me
> > > > > : that it cannot find the class GlossAttributeImpl. I think the
> > problem
> > > > is
> > > > > : that my jar file is added to the class path at run time not from
> > the
> > > > > command
> > > > > : line. Do you have a good solution or workaround?
> > > > >
> > > > > You're likely to get mmore helpful answers from other people in the
> > > Solr
> > > > > User community (solr-user@lucene.a.o)
> > > > >
> > > > > As long as you put your jar in the "lib" directory under your solr
> > home
> > > > > (or refrence it using a <lib/> directive in your solrconfig.xml)
> > Solr's
> > > > > plugin loader will take care of hte classloading for you.
> > > > >
> > > > > if you are confident you have your jar in the correct place, please
> > > > email
> > > > > solr-user with the ClassNotFound stack trace from your solr logs,
> as
> > > > well
> > > > > as hierarchy  of files from your solr home (ie: the output of "find
> > .")
> > > > >
> > > > >
> > > > > -Hoss
> > > > >
> > > > >
> > > > >
> --------------------------------------------------------------------
> > -
> > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
> >
> > --
> > regards,
> > Ahmed Saad
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
regards,
Ahmed Saad

--000325557b22b45d11047c5d7699--

From java-user-return-44344-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 04 21:44:33 2010
Return-Path: <java-user-return-44344-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89146 invoked from network); 4 Jan 2010 21:44:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 4 Jan 2010 21:44:33 -0000
Received: (qmail 56255 invoked by uid 500); 4 Jan 2010 21:44:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56190 invoked by uid 500); 4 Jan 2010 21:44:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56180 invoked by uid 99); 4 Jan 2010 21:44:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 21:44:30 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 04 Jan 2010 21:44:21 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id C13BB45F48D
	for <java-user@lucene.apache.org>; Mon,  4 Jan 2010 22:43:57 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id rBSKcmqbnEId for <java-user@lucene.apache.org>;
	Mon,  4 Jan 2010 22:43:47 +0100 (CET)
Received: from VEGA (dslb-088-065-087-177.pools.arcor-ip.net [88.65.87.177])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id DEC2B45F486
	for <java-user@lucene.apache.org>; Mon,  4 Jan 2010 22:43:46 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <e5de07e90912271249g25a0f8e4u49c3fb03d3ecd458@mail.gmail.com> <Pine.LNX.4.64.0912271923370.12519@radix.cryptio.net> <7054C18D96924AA187F6D3A3FBDFC8DB@VEGA> <6B18B9E94727414D87F8F7E91EBC5F90@VEGA> <e5de07e90912300256h4bca5993wf1349c71833152d6@mail.gmail.com> <B118C2248D6F44058427E261C7A76D10@VEGA> <e5de07e91001041332x6d0d9521x496b9d68058c68a6@mail.gmail.com>
Subject: RE: Using the new tokenizer API from a jar file
Date: Mon, 4 Jan 2010 22:43:46 +0100
Message-ID: <0056F07879EB4DB6987CA41E8A67695B@VEGA>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <e5de07e91001041332x6d0d9521x496b9d68058c68a6@mail.gmail.com>
Thread-Index: AcqNhZVjh1rx7ykxQEi5T/851kOMeAAAPV4A
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579

Thanks for checking this out!

So my research was fine and I fixed it the intuitive and in my opinion
"correct way" (not with such hacks like using the thread's class loader you
see so often in the internet, but which are contraprodutive because they
often break the Java security model or break class re-loading on webapp
refresh in various app servers).

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Ahmed El-dawy [mailto:aseldawy@gmail.com]
> Sent: Monday, January 04, 2010 10:33 PM
> To: java-user@lucene.apache.org
> Subject: Re: Using the new tokenizer API from a jar file
> 
> Sorry for this delay. I was having a silly problem compiling solr but I
> figured it out.
> I tested it and it worked correctly. Thanks
> 
> On Wed, Dec 30, 2009 at 8:31 PM, Uwe Schindler <uwe@thetaphi.de> wrote:
> 
> > That would be good, if you could test it!
> >
> > Please checkout Lucene 2.9 branch from svn
> > (http://svn.apache.org/repos/asf/lucene/java/branches/lucene_2_9),
> compile
> > the whole package (at least lucene-core.jar) and then replace the lucene
> > jar
> > files in solr's lib folder.
> >
> > Uwe
> >
> > -----
> > Uwe Schindler
> > H.-H.-Meier-Allee 63, D-28213 Bremen
> > http://www.thetaphi.de
> > eMail: uwe@thetaphi.de
> >
> >
> > > -----Original Message-----
> > > From: Ahmed El-dawy [mailto:aseldawy@gmail.com]
> > > Sent: Wednesday, December 30, 2009 11:56 AM
> > > To: java-user@lucene.apache.org
> > > Cc: solr-user@lucene.apache.org
> > > Subject: Re: Using the new tokenizer API from a jar file
> > >
> > > Thanks all for your interest, especially Uwe. I asked this question on
> > > solr-user at the beginning but I got no reply. That's why I re-asked
> the
> > > question at java-user.
> > > Thanks for your efforts. I will try it now.
> > >
> > > On Mon, Dec 28, 2009 at 12:02 PM, Uwe Schindler <uwe@thetaphi.de>
> wrote:
> > >
> > > > I opened https://issues.apache.org/jira/browse/LUCENE-2182 about
> this
> > > > problem and already have a fix.
> > > >
> > > > This is really a bug. The solution is simple because you have to
> load
> > > the
> > > > IMPL class using the same classloader as the passed in interface.
> The
> > > > default for Class.forName is the classloader of
> AttributeSource.class,
> > > > which
> > > > is the wrong one.
> > > >
> > > > -----
> > > > Uwe Schindler
> > > > H.-H.-Meier-Allee 63, D-28213 Bremen
> > > > http://www.thetaphi.de
> > > > eMail: uwe@thetaphi.de
> > > >
> > > > > -----Original Message-----
> > > > > From: Uwe Schindler [mailto:uwe@thetaphi.de]
> > > > > Sent: Monday, December 28, 2009 9:20 AM
> > > > > To: java-user@lucene.apache.org
> > > > > Cc: solr-user@lucene.apache.org
> > > > > Subject: RE: Using the new tokenizer API from a jar file
> > > > >
> > > > > The question on this list was ok,as it shows a minor problem of
> using
> > > the
> > > > > new TokenStream API with Solr.
> > > > >
> > > > > His plugin was loaded correctly, because if Lucene says, that it
> > > cannot
> > > > > find
> > > > > the *Impl class, it was able to load the interface class before ->
> > the
> > > > JAR
> > > > > file is "visible" to the JVM.
> > > > >
> > > > > The problem is the following and has to do with classloaders:
> > > > >
> > > > > 1. We have different class loaders for different places in Solr.
> Solr
> > > > uses
> > > > > for plugins a SolrResourceLoader that searches for JAR files in
> the
> > > local
> > > > > lib folder before handling over to the webapp's classloader.
> > > > >
> > > > > 2. Initially, the lucene JAR is loaded by the Webapp's class
> loader
> > > > >
> > > > > 3. If a AttributeImpl is placed into a jar file e.g. in the plugin
> > > folder
> > > > > of
> > > > > solr (the lib folder where solr loads all resources, stop
> words,...),
> > > the
> > > > > loading mechanism inside AttributeSource.DEFAULT_ATTRIBUTE_FACTORY
> is
> > > > > unable
> > > > > to locate the class file, because Class.forName() always uses the
> > > class'
> > > > > classloader and not the global/thread one's. So AttributeSource
> will
> > > only
> > > > > find the class file if it is in the *same* directory as the
> lucene-
> > > > > core.jar
> > > > > file (WEB-INF/lib) and so accessible by the webapp's class loader.
> > > > >
> > > > > A good introduction about the problem is this one:
> > > > >
> > > >
> > >
> >
> http://www.theserverside.com/tt/articles/content/dm_classForname/DynLoad.p
> > > > > df
> > > > >
> > > > > The problem is here described for the JVM extensions folder but
> also
> > > > > applies
> > > > > to solr, because it has another classloader for plugins.
> > > > >
> > > > > A solution to fix this would be in lucene to use the thread's
> context
> > > > > class
> > > > > loader in AttributeSource.DEFAULT_ATTRIBUTE_FACTORY, but I
> strongly
> > > > > discourage this, as it would break the whole AttributeSource
> > > > functionality
> > > > > if you add two different attributes with same class names from
> > > different
> > > > > class loaders to the AttributeSource.
> > > > >
> > > > > The only solution to the problem is placing the JAR file inside
> the
> > > > > WEB-INF/lib folder where lucene-core.jar is. Plugins in Solr
> cannot
> > > > define
> > > > > own attribute implementations. Alternatively he could try to force
> > > > preload
> > > > > the class by calling Class.forName in his plugin initialization
> code
> > > on
> > > > > the
> > > > > Impl class. But I am not sure if this works (as Java handles
> classes
> > > from
> > > > > different classloaders different).
> > > > >
> > > > > Uwe
> > > > >
> > > > > -----
> > > > > Uwe Schindler
> > > > > H.-H.-Meier-Allee 63, D-28213 Bremen
> > > > > http://www.thetaphi.de
> > > > > eMail: uwe@thetaphi.de
> > > > >
> > > > > > -----Original Message-----
> > > > > > From: Chris Hostetter [mailto:hossman_lucene@fucit.org]
> > > > > > Sent: Monday, December 28, 2009 4:27 AM
> > > > > > To: java-user@lucene.apache.org
> > > > > > Subject: Re: Using the new tokenizer API from a jar file
> > > > > >
> > > > > >
> > > > > > : I tried to use it with solr and the problems began. It's
> always
> > > > > telling
> > > > > > me
> > > > > > : that it cannot find the class GlossAttributeImpl. I think the
> > > problem
> > > > > is
> > > > > > : that my jar file is added to the class path at run time not
> from
> > > the
> > > > > > command
> > > > > > : line. Do you have a good solution or workaround?
> > > > > >
> > > > > > You're likely to get mmore helpful answers from other people in
> the
> > > > Solr
> > > > > > User community (solr-user@lucene.a.o)
> > > > > >
> > > > > > As long as you put your jar in the "lib" directory under your
> solr
> > > home
> > > > > > (or refrence it using a <lib/> directive in your solrconfig.xml)
> > > Solr's
> > > > > > plugin loader will take care of hte classloading for you.
> > > > > >
> > > > > > if you are confident you have your jar in the correct place,
> please
> > > > > email
> > > > > > solr-user with the ClassNotFound stack trace from your solr
> logs,
> > as
> > > > > well
> > > > > > as hierarchy  of files from your solr home (ie: the output of
> "find
> > > .")
> > > > > >
> > > > > >
> > > > > > -Hoss
> > > > > >
> > > > > >
> > > > > >
> > --------------------------------------------------------------------
> > > -
> > > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > > For additional commands, e-mail: java-user-
> help@lucene.apache.org
> > > > >
> > > > >
> > > > >
> > > > > ------------------------------------------------------------------
> ---
> > > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > > >
> > > > --------------------------------------------------------------------
> -
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > >
> > >
> > > --
> > > regards,
> > > Ahmed Saad
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> 
> 
> --
> regards,
> Ahmed Saad


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44345-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 00:35:51 2010
Return-Path: <java-user-return-44345-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53629 invoked from network); 5 Jan 2010 00:35:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 00:35:51 -0000
Received: (qmail 38882 invoked by uid 500); 5 Jan 2010 00:35:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38808 invoked by uid 500); 5 Jan 2010 00:35:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38798 invoked by uid 99); 5 Jan 2010 00:35:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 00:35:48 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [198.147.195.5] (HELO flicker.bmc.com) (198.147.195.5)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 05 Jan 2010 00:35:40 +0000
Received: by flicker.bmc.com (Postfix, from userid 13749)
	id 272CF1E9F83; Mon,  4 Jan 2010 17:35:47 -0700 (MST)
Received: from PHX-HTPRD-02.adprod.bmc.com (phx-htprd-02.adprod.bmc.com [172.24.32.8])
	by flicker.bmc.com (Postfix) with ESMTP id 1E21C1E9F7A
	for <java-user@lucene.apache.org>; Mon,  4 Jan 2010 17:35:47 -0700 (MST)
Received: from PHXCCRPRD02.adprod.bmc.com ([172.24.32.181]) by
 PHX-HTPRD-02.adprod.bmc.com ([172.24.32.8]) with mapi; Mon, 4 Jan 2010
 18:34:48 -0600
From: "Baldwin, David" <David_Baldwin@bmc.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 4 Jan 2010 18:34:46 -0600
Subject: much memory overhead does Tika generally require
Thread-Topic: much memory overhead does Tika generally require
Thread-Index: AcqNnuGrmKLJzXbbTTa1vNUuVdY56A==
Message-ID: <0CC1676F11AD0249A6A2FC201AADFC114A346CE15F@PHXCCRPRD02.adprod.bmc.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_0CC1676F11AD0249A6A2FC201AADFC114A346CE15FPHXCCRPRD02ad_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_0CC1676F11AD0249A6A2FC201AADFC114A346CE15FPHXCCRPRD02ad_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

I need to get a handle on how much memory Tika needs to token-ize different=
=3D  file types.  In other words, I need to find information on required ov=
erhe=3D ad (including copies of buffers made if applicable) so that I can p=
roduce s=3D ome kind of guidelines for memory possibly needed by users of t=
he product I=3D  am working on which uses lucene/tika.



Now I realize that there is a lot of context that can be provided, I want t=
=3D o find out first, if anyone knows of already existing data/metrics on t=
his.


--_000_0CC1676F11AD0249A6A2FC201AADFC114A346CE15FPHXCCRPRD02ad_--


From java-user-return-44346-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 01:41:12 2010
Return-Path: <java-user-return-44346-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77765 invoked from network); 5 Jan 2010 01:41:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 01:41:11 -0000
Received: (qmail 75548 invoked by uid 500); 5 Jan 2010 01:41:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75466 invoked by uid 500); 5 Jan 2010 01:41:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75456 invoked by uid 99); 5 Jan 2010 01:41:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 01:41:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gsiasf@gmail.com designates 209.85.210.193 as permitted sender)
Received: from [209.85.210.193] (HELO mail-yx0-f193.google.com) (209.85.210.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 01:41:00 +0000
Received: by yxe31 with SMTP id 31so15326269yxe.21
        for <java-user@lucene.apache.org>; Mon, 04 Jan 2010 17:40:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:sender:content-type
         :mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=xNRjIBr8lKsFzS4I+UfWNtOkoLGcQTzvzYw6xJllT2k=;
        b=lpEuzy/4j1Jkrgy9b8Ca72lktDcMYC3I+C1qgn9V9TceN3Ts6KreCiveSAy7kBMTPg
         JEbPPIvZb1TSfPhp/+HcOspJhnHuEun6avFtzXI2FcxfiD7JYFxxpt4DwYBvYJ0b1WGd
         U0qsoY7zNMjL0xTe9/BEJ+J3lX+NIfKeC3kug=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=sender:content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        b=MdJm+JesLrfN0mNyhBXEeqFl3569FSj5luTZ3FyWx6+ar/1PJPTRT5RMMXjEeaWEdY
         iMI4ardh9NT8xTHiw+XbCvAX4LP3PxfmPw9r8KHjzaL96kzMsfciG8aoc90MYuwd399/
         3fRiXmv8n+g8IMpKiT+Mt36/KhJ9PZ5UuU4ag=
Received: by 10.100.1.16 with SMTP id 16mr17958924ana.146.1262655639974;
        Mon, 04 Jan 2010 17:40:39 -0800 (PST)
Received: from ?10.0.0.77? (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
        by mx.google.com with ESMTPS id 22sm6425140ywh.30.2010.01.04.17.40.39
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 04 Jan 2010 17:40:39 -0800 (PST)
Sender: Grant Ingersoll <gsiasf@gmail.com>
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: much memory overhead does Tika generally require
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <0CC1676F11AD0249A6A2FC201AADFC114A346CE15F@PHXCCRPRD02.adprod.bmc.com>
Date: Mon, 4 Jan 2010 20:40:38 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <FE62E552-5C41-409F-AC56-20F5A48CF1C4@apache.org>
References: <0CC1676F11AD0249A6A2FC201AADFC114A346CE15F@PHXCCRPRD02.adprod.bmc.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)

Probably best to ask on tika-user@lucene.apache.org


On Jan 4, 2010, at 7:34 PM, Baldwin, David wrote:

> I need to get a handle on how much memory Tika needs to token-ize =
different=3D  file types.  In other words, I need to find information on =
required overhe=3D ad (including copies of buffers made if applicable) =
so that I can produce s=3D ome kind of guidelines for memory possibly =
needed by users of the product I=3D  am working on which uses =
lucene/tika.
>=20
>=20
>=20
> Now I realize that there is a lot of context that can be provided, I =
want t=3D o find out first, if anyone knows of already existing =
data/metrics on this.
>=20

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem using Solr/Lucene: =
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44347-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 04:56:16 2010
Return-Path: <java-user-return-44347-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31374 invoked from network); 5 Jan 2010 04:56:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 04:56:16 -0000
Received: (qmail 58524 invoked by uid 500); 5 Jan 2010 04:56:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58452 invoked by uid 500); 5 Jan 2010 04:56:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58440 invoked by uid 99); 5 Jan 2010 04:56:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 04:56:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 04:56:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NS1SL-0004rp-0n
	for java-user@lucene.apache.org; Mon, 04 Jan 2010 20:55:45 -0800
Message-ID: <27023764.post@talk.nabble.com>
Date: Mon, 4 Jan 2010 20:55:45 -0800 (PST)
From: sqzaman <sqzaman@gmail.com>
To: java-user@lucene.apache.org
Subject: Single "A" parsing problem
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sqzaman@gmail.com


hi
i am using Java Lucene 2.9.1
my problem is When i parse the folowing query
name: zaman AND name:15 name:A
just last "A" skiped after parsing
i found
query = (+name: zaman +name:15)

why A is missing

can anybody tell me the reason?

need quick feedback
-- 
View this message in context: http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27023764.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44348-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 05:36:16 2010
Return-Path: <java-user-return-44348-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44575 invoked from network); 5 Jan 2010 05:36:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 05:36:16 -0000
Received: (qmail 78533 invoked by uid 500); 5 Jan 2010 05:36:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78456 invoked by uid 500); 5 Jan 2010 05:36:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78446 invoked by uid 99); 5 Jan 2010 05:36:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 05:36:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ppuffinburger@tlcdelivers.com designates 12.131.0.144 as permitted sender)
Received: from [12.131.0.144] (HELO mx.tlcdelivers.com) (12.131.0.144)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 05 Jan 2010 05:36:04 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mx.tlcdelivers.com (Postfix) with ESMTP id 57C3B4EA802F
	for <java-user@lucene.apache.org>; Tue,  5 Jan 2010 00:35:43 -0500 (EST)
X-Virus-Scanned: amavisd-new at wsl-mx1.tlcdelivers.com
Received: from mx.tlcdelivers.com ([127.0.0.1])
	by localhost (mx.tlcdelivers.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id YV7THjhGmIQd for <java-user@lucene.apache.org>;
	Tue,  5 Jan 2010 00:31:28 -0500 (EST)
Received: from [10.0.1.5] (c-24-126-29-85.hsd1.wv.comcast.net [24.126.29.85])
	by mx.tlcdelivers.com (Postfix) with ESMTP id 33F734EA8012
	for <java-user@lucene.apache.org>; Tue,  5 Jan 2010 00:31:28 -0500 (EST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Single "A" parsing problem
From: Philip Puffinburger <ppuffinburger@tlcdelivers.com>
In-Reply-To: <27023764.post@talk.nabble.com>
Date: Tue, 5 Jan 2010 00:31:27 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <F20AB8EF-E200-49E2-8FC9-67C68FB78C10@tlcdelivers.com>
References: <27023764.post@talk.nabble.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org

I'm going to take a guess that you are using the StandardAnalyzer or =
another analyzer that removes stop words.   'a' is a stop word so is =
removed.

On Jan 4, 2010, at 11:55 PM, sqzaman wrote:

>=20
> hi
> i am using Java Lucene 2.9.1
> my problem is When i parse the folowing query
> name: zaman AND name:15 name:A
> just last "A" skiped after parsing
> i found
> query =3D (+name: zaman +name:15)
>=20
> why A is missing
>=20
> can anybody tell me the reason?
>=20
> need quick feedback
> --=20
> View this message in context: =
http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27023764.h=
tml
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44349-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 05:41:24 2010
Return-Path: <java-user-return-44349-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48296 invoked from network); 5 Jan 2010 05:41:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 05:41:24 -0000
Received: (qmail 83510 invoked by uid 500); 5 Jan 2010 05:41:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83432 invoked by uid 500); 5 Jan 2010 05:41:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83422 invoked by uid 99); 5 Jan 2010 05:41:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 05:41:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 05:41:13 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NS2A0-0007vx-9Z
	for java-user@lucene.apache.org; Mon, 04 Jan 2010 21:40:52 -0800
Message-ID: <27024026.post@talk.nabble.com>
Date: Mon, 4 Jan 2010 21:40:52 -0800 (PST)
From: sqzaman <sqzaman@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Single "A" parsing problem
In-Reply-To: <F20AB8EF-E200-49E2-8FC9-67C68FB78C10@tlcdelivers.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sqzaman@gmail.com
References: <27023764.post@talk.nabble.com> <F20AB8EF-E200-49E2-8FC9-67C68FB78C10@tlcdelivers.com>
X-Virus-Checked: Checked by ClamAV on apache.org




Philip Puffinburger wrote:
> 
> I'm going to take a guess that you are using the StandardAnalyzer or
> another analyzer that removes stop words.   'a' is a stop word so is
> removed.
> 
> On Jan 4, 2010, at 11:55 PM, sqzaman wrote:
> 
>> 
>> hi
>> i am using Java Lucene 2.9.1
>> my problem is When i parse the folowing query
>> name: zaman AND name:15 name:A
>> just last "A" skiped after parsing
>> i found
>> query = (+name: zaman +name:15)
>> 
>> why A is missing
>> 
>> can anybody tell me the reason?
>> 
>> need quick feedback
>> -- 
>> View this message in context:
>> http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27023764.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

hi
yes i am using standard analyzer
please tell me how i can solve this problem

best regards
sqzaman

-- 
View this message in context: http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27024026.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44350-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 05:54:24 2010
Return-Path: <java-user-return-44350-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54131 invoked from network); 5 Jan 2010 05:54:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 05:54:23 -0000
Received: (qmail 98382 invoked by uid 500); 5 Jan 2010 05:54:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98298 invoked by uid 500); 5 Jan 2010 05:54:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98288 invoked by uid 99); 5 Jan 2010 05:54:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 05:54:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ppuffinburger@tlcdelivers.com designates 12.131.0.144 as permitted sender)
Received: from [12.131.0.144] (HELO mx.tlcdelivers.com) (12.131.0.144)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 05 Jan 2010 05:54:12 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mx.tlcdelivers.com (Postfix) with ESMTP id 4BD374EA802F
	for <java-user@lucene.apache.org>; Tue,  5 Jan 2010 00:53:51 -0500 (EST)
X-Virus-Scanned: amavisd-new at wsl-mx1.tlcdelivers.com
Received: from mx.tlcdelivers.com ([127.0.0.1])
	by localhost (mx.tlcdelivers.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id gKWbGuqHMQfy for <java-user@lucene.apache.org>;
	Tue,  5 Jan 2010 00:53:47 -0500 (EST)
Received: from [10.0.1.5] (c-24-126-29-85.hsd1.wv.comcast.net [24.126.29.85])
	by mx.tlcdelivers.com (Postfix) with ESMTP id 117DC4EA8012
	for <java-user@lucene.apache.org>; Tue,  5 Jan 2010 00:53:47 -0500 (EST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Single "A" parsing problem
From: Philip Puffinburger <ppuffinburger@tlcdelivers.com>
In-Reply-To: <27024026.post@talk.nabble.com>
Date: Tue, 5 Jan 2010 00:53:46 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <0E6B1F7D-9C31-41E6-80F7-337BBE116B5D@tlcdelivers.com>
References: <27023764.post@talk.nabble.com> <F20AB8EF-E200-49E2-8FC9-67C68FB78C10@tlcdelivers.com> <27024026.post@talk.nabble.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)

That depends on what you are trying to do.  =20

You could create the StandardAnalyzer and pass in your own stop word =
set, but that would use that stop word set for all your analyzed fields. =
  =20

There is a PerFieldAnalyzerWrapper (I think that is the name) where you =
can set up different analyzers per field.   =20

In a project that I work on we wrote our own analyzer that looks at the =
field and applies different filters based on the field (some use stop =
words, some stem, etc).   So our note fields use stop words and stem, =
while our name fields don't.

On Jan 5, 2010, at 12:40 AM, sqzaman wrote:

>=20
>=20
>=20
> Philip Puffinburger wrote:
>>=20
>> I'm going to take a guess that you are using the StandardAnalyzer or
>> another analyzer that removes stop words.   'a' is a stop word so is
>> removed.
>>=20
>> On Jan 4, 2010, at 11:55 PM, sqzaman wrote:
>>=20
>>>=20
>>> hi
>>> i am using Java Lucene 2.9.1
>>> my problem is When i parse the folowing query
>>> name: zaman AND name:15 name:A
>>> just last "A" skiped after parsing
>>> i found
>>> query =3D (+name: zaman +name:15)
>>>=20
>>> why A is missing
>>>=20
>>> can anybody tell me the reason?
>>>=20
>>> need quick feedback
>>> --=20
>>> View this message in context:
>>> =
http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27023764.h=
tml
>>> Sent from the Lucene - Java Users mailing list archive at =
Nabble.com.
>>>=20
>>>=20
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>=20
>>=20
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>=20
>>=20
>=20
> hi
> yes i am using standard analyzer
> please tell me how i can solve this problem
>=20
> best regards
> sqzaman
>=20
> --=20
> View this message in context: =
http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27024026.h=
tml
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44351-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 08:15:31 2010
Return-Path: <java-user-return-44351-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 337 invoked from network); 5 Jan 2010 08:15:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 08:15:30 -0000
Received: (qmail 88499 invoked by uid 500); 5 Jan 2010 08:15:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88433 invoked by uid 500); 5 Jan 2010 08:15:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88423 invoked by uid 99); 5 Jan 2010 08:15:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 08:15:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 08:15:20 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NS4ZA-0001Ob-0e
	for java-user@lucene.apache.org; Tue, 05 Jan 2010 00:15:00 -0800
Message-ID: <27025020.post@talk.nabble.com>
Date: Tue, 5 Jan 2010 00:15:00 -0800 (PST)
From: sqzaman <sqzaman@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Single "A" parsing problem
In-Reply-To: <0E6B1F7D-9C31-41E6-80F7-337BBE116B5D@tlcdelivers.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sqzaman@gmail.com
References: <27023764.post@talk.nabble.com> <F20AB8EF-E200-49E2-8FC9-67C68FB78C10@tlcdelivers.com> <27024026.post@talk.nabble.com> <0E6B1F7D-9C31-41E6-80F7-337BBE116B5D@tlcdelivers.com>




Philip Puffinburger wrote:
> 
> That depends on what you are trying to do.   
> 
> You could create the StandardAnalyzer and pass in your own stop word set,
> but that would use that stop word set for all your analyzed fields.    
> 
> There is a PerFieldAnalyzerWrapper (I think that is the name) where you
> can set up different analyzers per field.    
> 
> In a project that I work on we wrote our own analyzer that looks at the
> field and applies different filters based on the field (some use stop
> words, some stem, etc).   So our note fields use stop words and stem,
> while our name fields don't.
> 
> On Jan 5, 2010, at 12:40 AM, sqzaman wrote:
> 
>> 
>> 
>> 
>> Philip Puffinburger wrote:
>>> 
>>> I'm going to take a guess that you are using the StandardAnalyzer or
>>> another analyzer that removes stop words.   'a' is a stop word so is
>>> removed.
>>> 
>>> On Jan 4, 2010, at 11:55 PM, sqzaman wrote:
>>> 
>>>> 
>>>> hi
>>>> i am using Java Lucene 2.9.1
>>>> my problem is When i parse the folowing query
>>>> name: zaman AND name:15 name:A
>>>> just last "A" skiped after parsing
>>>> i found
>>>> query = (+name: zaman +name:15)
>>>> 
>>>> why A is missing
>>>> 
>>>> can anybody tell me the reason?
>>>> 
>>>> need quick feedback
>>>> -- 
>>>> View this message in context:
>>>> http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27023764.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>> 
>>>> 
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>> 
>>> 
>>> 
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> 
>>> 
>>> 
>> 
>> hi
>> yes i am using standard analyzer
>> please tell me how i can solve this problem
>> 
>> best regards
>> sqzaman
>> 
>> -- 
>> View this message in context:
>> http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27024026.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
hi
thank u very much for your reply
can tell me how can i create instance for the following analyzer which will
not stop my 'A' or some other character
Analyzer analyzer = new StandardAnalyzer(Version.LUCENE_CURRENT)

give me an example

thanks in advance
sqzaman
 

-- 
View this message in context: http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27025020.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44352-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 12:44:56 2010
Return-Path: <java-user-return-44352-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3296 invoked from network); 5 Jan 2010 12:44:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 12:44:55 -0000
Received: (qmail 85668 invoked by uid 500); 5 Jan 2010 12:44:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85609 invoked by uid 500); 5 Jan 2010 12:44:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85599 invoked by uid 99); 5 Jan 2010 12:44:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 12:44:53 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 12:44:43 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id C3920C8D47
	for <java-user@lucene.apache.org>; Tue,  5 Jan 2010 07:44:22 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute2.internal (MEProxy); Tue, 05 Jan 2010 07:44:22 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=PoFFJ2mxRfoe+H6dkwU08JA7O7s=; b=YWBgiYnNGulYzCBSvBwXHG3XZ9NuX98Ve6HIFkAoTdoMGJUAmKFXjeLVYCxZwhPGvPF+n7BHQAD+55FgRTrhCizcMArJtE1oSUWABBr8jSQRFiMunbLmYhoBboPzNXzQy1ug6mxSiLCzZ0ZC1DBofMS2R47mn4w6Axt2lnR9/2o=
X-Sasl-enc: Pf3QTSJzJa8a85/MPpvIWua0YvA5GTgeWc3RdWUfhIhv 1262695462
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 1650A4A6C33
	for <java-user@lucene.apache.org>; Tue,  5 Jan 2010 07:44:21 -0500 (EST)
Message-ID: <4B433425.5090908@fastmail.fm>
Date: Tue, 05 Jan 2010 12:44:21 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Performance Results on changing the way fields are stored
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

So currently in my index I index and store a number of small fields, I 
need both so I can search on the fields, then I use the stored versions 
to generate the output document (which is either an XML or JSON 
representation), because I read stored and index fields are dealt with 
completely seperately I tried another tact only storing one field which 
was a serialized version of the output documentation. This solves a 
couple of issues I was having but I was disappointed that both the size 
of the index increased and the index build  time increased, I thought 
that if all the stored data was held in one field that the resultant 
index would be smaller, and I didn't expect index time to increase by as 
much as it did. I was also suprised that Java serilaization was slower 
and used more space than both JSON and XML serialization.

Results as Follows

Type:                                                             Time : 
Index Size
Only indexed  no norms                              
                                       105   : 38 MB
Only indexed                                       
                                               111   : 43 MB
Same fields written as Indexed and Stored  (current Situation)           
115   : 83 MB
Fields Indexed, One JAXB classed Stored using JSON Marshalling 140   : 
115 MB
Fields Indexed, One JAXB classed Stored using XML Marshalling  189   : 
198 MB
Fields Indexed, One JAXB classed Stored using Java Serialization   305   
: 485 MB

Are these results to be expected, could anybody suggest anything else I 
could do


Paul




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44353-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 12:52:51 2010
Return-Path: <java-user-return-44353-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5539 invoked from network); 5 Jan 2010 12:52:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 12:52:51 -0000
Received: (qmail 96589 invoked by uid 500); 5 Jan 2010 12:52:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96507 invoked by uid 500); 5 Jan 2010 12:52:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96497 invoked by uid 99); 5 Jan 2010 12:52:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 12:52:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 12:52:39 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NS8tW-0003vX-UZ
	for java-user@lucene.apache.org; Tue, 05 Jan 2010 04:52:18 -0800
Message-ID: <27026604.post@talk.nabble.com>
Date: Tue, 5 Jan 2010 04:52:18 -0800 (PST)
From: sqzaman <sqzaman@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Single "A" parsing problem
In-Reply-To: <27025020.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sqzaman@gmail.com
References: <27023764.post@talk.nabble.com> <F20AB8EF-E200-49E2-8FC9-67C68FB78C10@tlcdelivers.com> <27024026.post@talk.nabble.com> <0E6B1F7D-9C31-41E6-80F7-337BBE116B5D@tlcdelivers.com> <27025020.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org




sqzaman wrote:
> 
> 
> 
> Philip Puffinburger wrote:
>> 
>> That depends on what you are trying to do.   
>> 
>> You could create the StandardAnalyzer and pass in your own stop word set,
>> but that would use that stop word set for all your analyzed fields.    
>> 
>> There is a PerFieldAnalyzerWrapper (I think that is the name) where you
>> can set up different analyzers per field.    
>> 
>> In a project that I work on we wrote our own analyzer that looks at the
>> field and applies different filters based on the field (some use stop
>> words, some stem, etc).   So our note fields use stop words and stem,
>> while our name fields don't.
>> 
>> On Jan 5, 2010, at 12:40 AM, sqzaman wrote:
>> 
>>> 
>>> 
>>> 
>>> Philip Puffinburger wrote:
>>>> 
>>>> I'm going to take a guess that you are using the StandardAnalyzer or
>>>> another analyzer that removes stop words.   'a' is a stop word so is
>>>> removed.
>>>> 
>>>> On Jan 4, 2010, at 11:55 PM, sqzaman wrote:
>>>> 
>>>>> 
>>>>> hi
>>>>> i am using Java Lucene 2.9.1
>>>>> my problem is When i parse the folowing query
>>>>> name: zaman AND name:15 name:A
>>>>> just last "A" skiped after parsing
>>>>> i found
>>>>> query = (+name: zaman +name:15)
>>>>> 
>>>>> why A is missing
>>>>> 
>>>>> can anybody tell me the reason?
>>>>> 
>>>>> need quick feedback
>>>>> -- 
>>>>> View this message in context:
>>>>> http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27023764.html
>>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>> 
>>>>> 
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>> 
>>>> 
>>>> 
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>> 
>>>> 
>>>> 
>>> 
>>> hi
>>> yes i am using standard analyzer
>>> please tell me how i can solve this problem
>>> 
>>> best regards
>>> sqzaman
>>> 
>>> -- 
>>> View this message in context:
>>> http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27024026.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>> 
>>> 
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> 
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
>> 
>> 
> hi
> thank u very much for your reply
> can tell me how can i create instance for the following analyzer which
> will not stop my 'A' or some other character
> Analyzer analyzer = new StandardAnalyzer(Version.LUCENE_CURRENT)
> 
> give me an example
> 
> thanks in advance
> sqzaman
>  
> 
> 
Hi Philip
thank u very much for helping me a lot
i have solved my problem

best regards
zaman

-- 
View this message in context: http://old.nabble.com/Single-%22A%22-parsing-problem-tp27023764p27026604.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44354-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 13:32:20 2010
Return-Path: <java-user-return-44354-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19735 invoked from network); 5 Jan 2010 13:32:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 13:32:20 -0000
Received: (qmail 37717 invoked by uid 500); 5 Jan 2010 13:32:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37658 invoked by uid 500); 5 Jan 2010 13:32:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37648 invoked by uid 99); 5 Jan 2010 13:32:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 13:32:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of BArmstrong@dymaxion.ca designates 24.222.19.49 as permitted sender)
Received: from [24.222.19.49] (HELO ntex.dymaxion.ca) (24.222.19.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 13:32:09 +0000
Received: from bgpc.dymaxion.ca ([24.222.19.4]) by ntex.dymaxion.ca with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 5 Jan 2010 09:31:48 -0400
Received: from localhost ([127.0.0.1])
	by bgpc.dymaxion.ca with esmtp (Exim 4.69)
	(envelope-from <BArmstrong@dymaxion.ca>)
	id 1NS9Vk-0006SH-3V
	for java-user@lucene.apache.org; Tue, 05 Jan 2010 09:31:48 -0400
Message-ID: <4B433F43.8040803@dymaxion.ca>
Date: Tue, 05 Jan 2010 09:31:47 -0400
From: Ben Armstrong <BArmstrong@dymaxion.ca>
User-Agent: Mozilla-Thunderbird 2.0.0.22 (X11/20090701)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Solr/Lucene on OpenVMS, filesystem-specific issues
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 05 Jan 2010 13:31:48.0323 (UTC) FILETIME=[6E814330:01CA8E0B]

I am trying to get Solr 1.4.0 to work on OpenVMS V8.3 Alpha with Java 
1.5.0-6.p1.

I see at least one other user has attempted to make Lucene work on 
OpenVMS before, but ran into problems which appear to remain unresolved:

http://www.lucidimagination.com/search/document/8f4a752f43f34c6a/indexer_crashes_with_hit_exception_during_merge#8e9ea1db106e9cea

To test Solr, I just unpacked the zip archive for Solr 1.4.0 with "unzip 
-2" (using the Info-zip 3.0 version of zip, this converts filenames to 
ODS-2 filesystem syntax) and attempt to run it in a process in a "SET 
PROCESS/PARSE=TRADITIONAL" context (again, this is for ODS-2 filesystem 
compatibility).  Then, with JAVA$FILENAME_CONTROLS defined to -1 (see 
http://h18012.www1.hp.com/java/documentation/1.5.0/ovms/docs/user_guide.html#unix_style 
for details) I try to run the Solr example from the [.example] 
directory.  All seems to start out well, but then it stack dumps, 
apparently trying to parse the segment number from a segment filename.  
Here is the complete output:

A:..OLR-1_4_0.EXAMPLE> java -jar start.jar

2010-01-05 09:14:31.417::INFO:  Logging to STDERR via org.mortbay.log.StdErrLog
2010-01-05 09:14:33.033::INFO:  jetty-6.1.3
Jan 5, 2010 9:14:41 AM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: JNDI not configured for solr (NoInitialContextEx)
Jan 5, 2010 9:14:41 AM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: solr home defaulted to 'solr/' (could not find system property or JNDI)
Jan 5, 2010 9:14:41 AM org.apache.solr.core.SolrResourceLoader <init>
INFO: Solr home set to 'solr/'
Jan 5, 2010 9:14:43 AM org.apache.solr.servlet.SolrDispatchFilter init
INFO: SolrDispatchFilter.init()
Jan 5, 2010 9:14:43 AM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: JNDI not configured for solr (NoInitialContextEx)
Jan 5, 2010 9:14:43 AM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: solr home defaulted to 'solr/' (could not find system property or JNDI)
Jan 5, 2010 9:14:43 AM org.apache.solr.core.CoreContainer$Initializer initialize
INFO: looking for solr.xml: /dsa0/bg/apache-solr-1_4_0/example/solr/solr.xml
Jan 5, 2010 9:14:43 AM org.apache.solr.core.SolrResourceLoader <init>
INFO: Solr home set to 'solr/'
Jan 5, 2010 9:14:43 AM org.apache.solr.core.SolrConfig initLibs
INFO: Adding specified lib dirs to ClassLoader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/asm-3_1.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/bcmail-jdk14-136.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/bcprov-jdk14-136.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/commons-codec-1_3.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/commons-compress-1_0.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/commons-io-1_4.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/commons-lang-2_1.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/commons-logging-1_1_1.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/dom4j-1_6_1.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/fontbox-0_1_0.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/geronimo-stax-api_1_0_spec-1_0.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/icu4j-3_8.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/jempbox-0_2_0.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/log4j-1_2_14.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/nekohtml-1_9_9.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/ooxml-schemas-1_0.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/pdfbox-0_7_3.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/poi-3_5-beta6.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/poi-ooxml-3_5-beta6.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/poi-scratchpad-3_5-beta6.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/tika-core-0_4.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/tika-parsers-0_4.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/xercesimpl-2_8_1.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/xml-apis-1_0_b2.jar' to classloader
Jan 5, 2010 9:14:44 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/extraction/lib/xmlbeans-2_3_0.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/dist/apache-solr-cell-1_4_0.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/dist/apache-solr-clustering-1_4_0.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/clustering/lib/carrot2-mini-3_1_0.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/clustering/lib/commons-lang-2_4.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/clustering/lib/ehcache-1_6_2.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/clustering/lib/google-collections-1_0-rc2.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/clustering/lib/jackson-core-asl-0_9_9-6.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/clustering/lib/jackson-mapper-asl-0_9_9-6.jar' to classloader
Jan 5, 2010 9:14:45 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding 'file:/dsa0/bg/apache-solr-1_4_0/contrib/clustering/lib/log4j-1_2_14.jar' to classloader
Jan 5, 2010 9:14:48 AM org.apache.solr.core.SolrConfig <init>
INFO: Loaded SolrConfig: solrconfig.xml
Jan 5, 2010 9:14:48 AM org.apache.solr.core.SolrCore <init>
INFO: Opening new SolrCore at solr/, dataDir=./solr/data/
Jan 5, 2010 9:14:48 AM org.apache.solr.schema.IndexSchema readSchema
INFO: Reading Solr Schema
Jan 5, 2010 9:14:48 AM org.apache.solr.schema.IndexSchema readSchema
INFO: Schema name=example
Jan 5, 2010 9:14:48 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created string: org.apache.solr.schema.StrField
Jan 5, 2010 9:14:48 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created boolean: org.apache.solr.schema.BoolField
Jan 5, 2010 9:14:48 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created binary: org.apache.solr.schema.BinaryField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created int: org.apache.solr.schema.TrieIntField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created float: org.apache.solr.schema.TrieFloatField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created long: org.apache.solr.schema.TrieLongField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created double: org.apache.solr.schema.TrieDoubleField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created tint: org.apache.solr.schema.TrieIntField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created tfloat: org.apache.solr.schema.TrieFloatField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created tlong: org.apache.solr.schema.TrieLongField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created tdouble: org.apache.solr.schema.TrieDoubleField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created date: org.apache.solr.schema.TrieDateField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created tdate: org.apache.solr.schema.TrieDateField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created pint: org.apache.solr.schema.IntField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created plong: org.apache.solr.schema.LongField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created pfloat: org.apache.solr.schema.FloatField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created pdouble: org.apache.solr.schema.DoubleField
Jan 5, 2010 9:14:49 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created pdate: org.apache.solr.schema.DateField
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created sint: org.apache.solr.schema.SortableIntField
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created slong: org.apache.solr.schema.SortableLongField
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created sfloat: org.apache.solr.schema.SortableFloatField
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created sdouble: org.apache.solr.schema.SortableDoubleField
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created random: org.apache.solr.schema.RandomSortField
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created text_ws: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.SynonymFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.StopFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WordDelimiterFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.SnowballPorterFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.StopFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WordDelimiterFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.SnowballPorterFilterFactory
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created text: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:50 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.SynonymFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.StopFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WordDelimiterFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.SnowballPorterFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.RemoveDuplicatesTokenFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created textTight: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.SynonymFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.StopFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WordDelimiterFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.StopFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WordDelimiterFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created textgen: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.SynonymFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.StopFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WordDelimiterFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.StopFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WordDelimiterFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.ReversedWildcardFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created text_rev: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.KeywordTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.TrimFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.PatternReplaceFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created alphaOnlySort: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.StandardTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.DoubleMetaphoneFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created phonetic: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.WhitespaceTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.DelimitedPayloadTokenFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created payloads: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.KeywordTokenizerFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created null: org.apache.solr.analysis.LowerCaseFilterFactory
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created lowercase: org.apache.solr.schema.TextField
Jan 5, 2010 9:14:51 AM org.apache.solr.util.plugin.AbstractPluginLoader load
INFO: created ignored: org.apache.solr.schema.StrField
Jan 5, 2010 9:14:52 AM org.apache.solr.schema.IndexSchema readSchema
INFO: default search field is text
Jan 5, 2010 9:14:52 AM org.apache.solr.schema.IndexSchema readSchema
INFO: query parser default operator is OR
Jan 5, 2010 9:14:52 AM org.apache.solr.schema.IndexSchema readSchema
INFO: unique key field: id
Jan 5, 2010 9:14:52 AM org.apache.solr.core.JmxMonitoredMap <init>
INFO: No JMX servers found, not exposing Solr information with JMX.
Jan 5, 2010 9:14:52 AM org.apache.solr.core.SolrCore initListeners
INFO: Added SolrEventListener: org.apache.solr.core.QuerySenderListener{queries=[]}
Jan 5, 2010 9:14:52 AM org.apache.solr.core.SolrCore initListeners
INFO: Added SolrEventListener: org.apache.solr.core.QuerySenderListener{queries=[{q=solr rocks,start=0,rows=10}, {q=static firstSearcher warming query from sol
rconfig.xml}]}
Jan 5, 2010 9:14:52 AM org.apache.solr.request.XSLTResponseWriter init
INFO: xsltCacheLifetimeSeconds=5
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created standard: solr.SearchHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created dismax: solr.SearchHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created partitioned: solr.SearchHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /spell: solr.SearchHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created tvrh: org.apache.solr.handler.component.SearchHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: adding lazy requestHandler: org.apache.solr.handler.extraction.ExtractingRequestHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /update/extract: org.apache.solr.handler.extraction.ExtractingRequestHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /terms: org.apache.solr.handler.component.SearchHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: adding lazy requestHandler: solr.SearchHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /elevate: solr.SearchHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /update: solr.XmlUpdateRequestHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /update/javabin: solr.BinaryUpdateRequestHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /analysis/document: solr.DocumentAnalysisRequestHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /analysis/field: solr.FieldAnalysisRequestHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: adding lazy requestHandler: solr.CSVRequestHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /update/csv: solr.CSVRequestHandler
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /admin/: org.apache.solr.handler.admin.AdminHandlers
Jan 5, 2010 9:14:53 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /admin/ping: PingRequestHandler
Jan 5, 2010 9:14:54 AM org.apache.solr.core.RequestHandlers initHandlersFromConfig
INFO: created /debug/dump: solr.DumpRequestHandler
Jan 5, 2010 9:14:54 AM org.apache.solr.servlet.SolrDispatchFilter init
SEVERE: Could not start SOLR. Check solr/home property
java.lang.RuntimeException: java.lang.NumberFormatException: For input string: "1."
        at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:1068)
        at org.apache.solr.core.SolrCore.<init>(SolrCore.java:579)
        at org.apache.solr.core.CoreContainer$Initializer.initialize(CoreContainer.java:137)
        at org.apache.solr.servlet.SolrDispatchFilter.init(SolrDispatchFilter.java:83)
        at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:99)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:594)
        at org.mortbay.jetty.servlet.Context.startContext(Context.java:139)
        at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1218)
        at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:500)
        at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:448)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:147)
        at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:161)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:147)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:117)
        at org.mortbay.jetty.Server.doStart(Server.java:210)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.xml.XmlConfiguration.main(XmlConfiguration.java:929)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:592)
        at org.mortbay.start.Main.invokeMain(Main.java:183)
        at org.mortbay.start.Main.start(Main.java:497)
        at org.mortbay.start.Main.main(Main.java:115)
Caused by: java.lang.NumberFormatException: For input string: "1."
        at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
        at java.lang.Long.parseLong(Long.java:412)
        at org.apache.lucene.index.SegmentInfos.generationFromSegmentsFileName(SegmentInfos.java:197)
        at org.apache.lucene.index.SegmentInfos.getCurrentSegmentGeneration(SegmentInfos.java:132)
        at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:588)
        at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:69)
        at org.apache.lucene.index.IndexReader.open(IndexReader.java:476)
        at org.apache.lucene.index.IndexReader.open(IndexReader.java:403)
        at org.apache.solr.core.StandardIndexReaderFactory.newReader(StandardIndexReaderFactory.java:38)
        at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:1057)
        ... 27 more
Jan 5, 2010 9:14:54 AM org.apache.solr.common.SolrException log
SEVERE: java.lang.RuntimeException: java.lang.NumberFormatException: For input string: "1."
        at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:1068)
        at org.apache.solr.core.SolrCore.<init>(SolrCore.java:579)
        at org.apache.solr.core.CoreContainer$Initializer.initialize(CoreContainer.java:137)
        at org.apache.solr.servlet.SolrDispatchFilter.init(SolrDispatchFilter.java:83)
        at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:99)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:594)
        at org.mortbay.jetty.servlet.Context.startContext(Context.java:139)
        at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1218)
        at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:500)
        at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:448)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:147)
        at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:161)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:147)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:117)
        at org.mortbay.jetty.Server.doStart(Server.java:210)
        at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:40)
        at org.mortbay.xml.XmlConfiguration.main(XmlConfiguration.java:929)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:592)
        at org.mortbay.start.Main.invokeMain(Main.java:183)
        at org.mortbay.start.Main.start(Main.java:497)
        at org.mortbay.start.Main.main(Main.java:115)
Caused by: java.lang.NumberFormatException: For input string: "1."
        at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
        at java.lang.Long.parseLong(Long.java:412)
        at org.apache.lucene.index.SegmentInfos.generationFromSegmentsFileName(SegmentInfos.java:197)
        at org.apache.lucene.index.SegmentInfos.getCurrentSegmentGeneration(SegmentInfos.java:132)
        at org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.java:588)
        at org.apache.lucene.index.DirectoryReader.open(DirectoryReader.java:69)
        at org.apache.lucene.index.IndexReader.open(IndexReader.java:476)
        at org.apache.lucene.index.IndexReader.open(IndexReader.java:403)
        at org.apache.solr.core.StandardIndexReaderFactory.newReader(StandardIndexReaderFactory.java:38)
        at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:1057)
        ... 27 more

Jan 5, 2010 9:14:54 AM org.apache.solr.servlet.SolrDispatchFilter init
INFO: SolrDispatchFilter.init() done
Jan 5, 2010 9:14:54 AM org.apache.solr.servlet.SolrServlet init
INFO: SolrServlet.init()
Jan 5, 2010 9:14:54 AM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: JNDI not configured for solr (NoInitialContextEx)
Jan 5, 2010 9:14:54 AM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: solr home defaulted to 'solr/' (could not find system property or JNDI)
Jan 5, 2010 9:14:54 AM org.apache.solr.servlet.SolrServlet init
INFO: SolrServlet.init() done
Jan 5, 2010 9:14:54 AM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: JNDI not configured for solr (NoInitialContextEx)
Jan 5, 2010 9:14:54 AM org.apache.solr.core.SolrResourceLoader locateSolrHome
INFO: solr home defaulted to 'solr/' (could not find system property or JNDI)
Jan 5, 2010 9:14:54 AM org.apache.solr.servlet.SolrUpdateServlet init
INFO: SolrUpdateServlet.init() done
2010-01-05 09:14:55.170::INFO:  Started SocketConnector @ 0.0.0.0:8983



If Lucene would consider the segment number to end at a final period 
instead of scanning to the end of the string, then I could get past this 
error.

I looked at the other possible JAVA$FILENAME_CONTROLS and none of them 
address this particular issue.  The "multi-dot-in-file" controls have to 
do with which side of the filename any additional dots end up in.  On a 
VMS filesystem, whether it is ODS-2 or ODS-5, at least one dot 
separating the filename and the extension is mandatory.  If there are 
additional dots in the filename, they need to be either mangled (as in 
the case of ODS-2, usually by replacing them with underscores) or else 
they need to be quoted as "^." (as in the case of ODS-5).  I believe the 
"Support multi dot in file, keeping last" and "keeping first" controls 
just govern where the mandatory (unquoted, unmangled) dot goes.  And in 
any event, these only affect multi-dot filenames, e.g. "extra.dot.dat", 
not extensionless files, e.g. "segment_1.", so for Lucene to work on 
VMS, it needs to accommodate for this filesystem-specific oddity.

I don't know what the user who was trying to build indices (cited above) 
actually ran into.  I haven't attempted to build any indices myself, 
yet.  But it might be related somehow to my problem.  Can someone help 
us to support Lucene on OpenVMS?  I'm hoping there aren't too many more 
of these little filesystem quirks to iron out ...

Thanks,
Ben Armstrong









---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44355-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 14:44:18 2010
Return-Path: <java-user-return-44355-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58663 invoked from network); 5 Jan 2010 14:44:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 14:44:17 -0000
Received: (qmail 23913 invoked by uid 500); 5 Jan 2010 14:44:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23845 invoked by uid 500); 5 Jan 2010 14:44:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23834 invoked by uid 99); 5 Jan 2010 14:44:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 14:44:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mario-fa@infonet.com.br designates 200.241.52.11 as permitted sender)
Received: from [200.241.52.11] (HELO estancia.infonet.com.br) (200.241.52.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 14:44:06 +0000
Received: (qmail 14527 invoked from network); 5 Jan 2010 14:31:55 -0000
Received: by simscan 1.4.0 ppid: 14198, pid: 14362, t: 4.1056s
         scanners: clamav: 0.95.2/m:51/d:9721 spam: 3.2.5
X-Spam-Checker-Version: SpamAssassin 3.2.5 (2008-06-10) on
	estancia.infonet.com.br
X-Spam-Level: 
Received: from unknown (HELO titanium) (Usuario-Autenticado:mario-fa@[187.90.14.34])
          (envelope-sender <mario-fa@infonet.com.br>)
          by 200.241.52.11 (qmail-ldap-1.03) with SMTP
          for <java-user@lucene.apache.org>; 5 Jan 2010 14:31:51 -0000
From: =?iso-8859-1?B?TeFyaW8gQW5kcuk=?= <mario-fa@infonet.com.br>
To: <java-user@lucene.apache.org>
References: <27023764.post@talk.nabble.com> <F20AB8EF-E200-49E2-8FC9-67C68FB78C10@tlcdelivers.com> <27024026.post@talk.nabble.com> <0E6B1F7D-9C31-41E6-80F7-337BBE116B5D@tlcdelivers.com> <27025020.post@talk.nabble.com> <27026604.post@talk.nabble.com>
In-Reply-To: <27026604.post@talk.nabble.com>
Subject: Problem with PhraseQuery
Date: Tue, 5 Jan 2010 12:43:34 -0200
Message-ID: <001501ca8e15$77e31a70$67a94f50$@com.br>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqOBFy3QiaPM3SSTDyDma84+8W3AQADS4xA
Content-Language: pt-br
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-2.5 required=8.0 tests=BAYES_00,RDNS_NONE
	autolearn=no version=3.2.5

Hi,
I need search by phrase containing a particular sequence of terms , then =
I
am using Java Lucene 3.0, more specifically the PhraseQuery.=20
I'm using the code below, but does not work(PhraseQuery). Only does work
when I use the QueryParser:
Is there some problem or how can I use the PhraseQuery in Lucene 3.0?=20
public class Main1 {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) throws IOException,
ParseException=20
    {
    StandardAnalyzer analyzer =3D new
StandardAnalyzer(Version.LUCENE_CURRENT);

    // 1. create the index
    Directory index =3D new RAMDirectory();

    IndexWriter w =3D new IndexWriter(index, analyzer, true,
IndexWriter.MaxFieldLength.UNLIMITED);

    addDoc(w, "Lucene in Action for about ten days here in brazil =
kkkkkkk
eeeeeeee nnnn xxxx tttt dddd jjjjjjj k");
    addDoc(w, "Lucene for Dummies");
    addDoc(w, "Lucene for Dummies");
    addDoc(w, "Managing Gigabytes");

    w.close();

    // 2. query   =20
    //Query q =3D new QueryParser(Version.LUCENE_CURRENT, "title",
analyzer).parse(querystr);

    PhraseQuery q =3D new PhraseQuery();
    q.setSlop(1);
    q.add(new Term("title","Lucene"));=20
    q.add(new Term("title","for"));
=20
   =20
    // 3. search
    int hitsPerPage =3D 20;
    IndexSearcher searcher =3D new IndexSearcher(index, true);
    TopScoreDocCollector collector =3D
TopScoreDocCollector.create(hitsPerPage, true);
    searcher.search(q, collector);
    ScoreDoc[] hits =3D collector.topDocs().scoreDocs;

    // 4. display results
    System.out.println("Found " + hits.length + " hits.");
    for(int i=3D0;i<hits.length;++i) {
      int docId =3D hits[i].doc;
      Document d =3D searcher.doc(docId);
      System.out.println((i + 1) + ". " + d.get("title"));
    }
 =20
    searcher.close();
  }

  private static void addDoc(IndexWriter w, String value) throws =
IOException
{
    Document doc =3D new Document();
    doc.add(new Field("title", value, Field.Store.YES,
Field.Index.ANALYZED));
    w.addDocument(doc);
  }
    =20
    }

---------------------------------------------------------------------
M=E1rio Andr=E9
Instituto Federal de Educa=E7=E3o, Ci=EAncia e Tecnologia de Sergipe - =
IFS
Mestrando em MCC - Universidade Federal de Alagoas - UFAL
http://www.marioandre.com.br/
Skype: mario-fa
-------------------------------------------------------------------------=
---
----------



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44356-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 15:41:13 2010
Return-Path: <java-user-return-44356-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78839 invoked from network); 5 Jan 2010 15:41:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 15:41:13 -0000
Received: (qmail 256 invoked by uid 500); 5 Jan 2010 15:41:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 143 invoked by uid 500); 5 Jan 2010 15:41:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 133 invoked by uid 99); 5 Jan 2010 15:41:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 15:41:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 15:41:01 +0000
Received: by bwz22 with SMTP id 22so10214521bwz.5
        for <java-user@lucene.apache.org>; Tue, 05 Jan 2010 07:40:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=V9kE87INdVGpjt9/NdtaWsg5YfzWIhk/1Nzo01phesk=;
        b=MXpsXf7hH6dZo9f+wnDy3PVYsi++Lqc1Hl0ITAqN0HA4Rhbw8hqvPJTFAJmZkMUj9T
         1i1BhGo+xaxW+NNp0PKK9CT6b5bzx2ymePFOR3qD751u4hmrV2OOUTAkAiQesxb9Q40K
         0tSk9LoUHTrjwhoFl4VK6e2x8nK7nQ+X1hyVk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=SQrhmI+yhYDQO7x2FVZPRsQ3l4e0HaHfUHa9AWFg+wu77qlQ/pmwhfsJHP+RI11qXW
         bIAKJvbEtgne+G8GYWEkL9QYk7QPU+c8wZLsFGJt4cMv9fPSonV0wjMfvWz8JZ0lkHXO
         QjvCJCC0g367Ntywc0KpsuFZABK805ldMkamQ=
MIME-Version: 1.0
Received: by 10.239.139.4 with SMTP id r4mr865161hbr.199.1262706039629; Tue, 
	05 Jan 2010 07:40:39 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <001501ca8e15$77e31a70$67a94f50$@com.br>
References: <27023764.post@talk.nabble.com>
	 <F20AB8EF-E200-49E2-8FC9-67C68FB78C10@tlcdelivers.com>
	 <27024026.post@talk.nabble.com>
	 <0E6B1F7D-9C31-41E6-80F7-337BBE116B5D@tlcdelivers.com>
	 <27025020.post@talk.nabble.com> <27026604.post@talk.nabble.com>
	 <001501ca8e15$77e31a70$67a94f50$@com.br>
Date: Tue, 5 Jan 2010 16:40:39 +0100
Message-ID: <f18c9dde1001050740x59051575j65af24da962f25c7@mail.gmail.com>
Subject: Re: Problem with PhraseQuery
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi Andre,

you are using StandardAnalyzer for indexing but you search with an
un-analyzed string "Lucene" (q.add(new Term("title","Lucene"));)
If you pass this string to the query parser your query string will be
analyzed (will most likely result in a lowercased string). The
analyzed query will then match and retrieve your documents. try to
search :

>    PhraseQuery q =3D new PhraseQuery();
>    q.setSlop(1);
>    q.add(new Term("title","lucene"));
>    q.add(new Term("title","for"));

simon
.

2010/1/5 M=C3=A1rio Andr=C3=A9 <mario-fa@infonet.com.br>:
> Hi,
> I need search by phrase containing a particular sequence of terms , then =
I
> am using Java Lucene 3.0, more specifically the PhraseQuery.
> I'm using the code below, but does not work(PhraseQuery). Only does work
> when I use the QueryParser:
> Is there some problem or how can I use the PhraseQuery in Lucene 3.0?
> public class Main1 {
>
> =C2=A0 =C2=A0/**
> =C2=A0 =C2=A0 * @param args the command line arguments
> =C2=A0 =C2=A0 */
> =C2=A0 =C2=A0public static void main(String[] args) throws IOException,
> ParseException
> =C2=A0 =C2=A0{
> =C2=A0 =C2=A0StandardAnalyzer analyzer =3D new
> StandardAnalyzer(Version.LUCENE_CURRENT);
>
> =C2=A0 =C2=A0// 1. create the index
> =C2=A0 =C2=A0Directory index =3D new RAMDirectory();
>
> =C2=A0 =C2=A0IndexWriter w =3D new IndexWriter(index, analyzer, true,
> IndexWriter.MaxFieldLength.UNLIMITED);
>
> =C2=A0 =C2=A0addDoc(w, "Lucene in Action for about ten days here in brazi=
l kkkkkkk
> eeeeeeee nnnn xxxx tttt dddd jjjjjjj k");
> =C2=A0 =C2=A0addDoc(w, "Lucene for Dummies");
> =C2=A0 =C2=A0addDoc(w, "Lucene for Dummies");
> =C2=A0 =C2=A0addDoc(w, "Managing Gigabytes");
>
> =C2=A0 =C2=A0w.close();
>
> =C2=A0 =C2=A0// 2. query
> =C2=A0 =C2=A0//Query q =3D new QueryParser(Version.LUCENE_CURRENT, "title=
",
> analyzer).parse(querystr);
>
> =C2=A0 =C2=A0PhraseQuery q =3D new PhraseQuery();
> =C2=A0 =C2=A0q.setSlop(1);
> =C2=A0 =C2=A0q.add(new Term("title","Lucene"));
> =C2=A0 =C2=A0q.add(new Term("title","for"));
>
>
> =C2=A0 =C2=A0// 3. search
> =C2=A0 =C2=A0int hitsPerPage =3D 20;
> =C2=A0 =C2=A0IndexSearcher searcher =3D new IndexSearcher(index, true);
> =C2=A0 =C2=A0TopScoreDocCollector collector =3D
> TopScoreDocCollector.create(hitsPerPage, true);
> =C2=A0 =C2=A0searcher.search(q, collector);
> =C2=A0 =C2=A0ScoreDoc[] hits =3D collector.topDocs().scoreDocs;
>
> =C2=A0 =C2=A0// 4. display results
> =C2=A0 =C2=A0System.out.println("Found " + hits.length + " hits.");
> =C2=A0 =C2=A0for(int i=3D0;i<hits.length;++i) {
> =C2=A0 =C2=A0 =C2=A0int docId =3D hits[i].doc;
> =C2=A0 =C2=A0 =C2=A0Document d =3D searcher.doc(docId);
> =C2=A0 =C2=A0 =C2=A0System.out.println((i + 1) + ". " + d.get("title"));
> =C2=A0 =C2=A0}
>
> =C2=A0 =C2=A0searcher.close();
> =C2=A0}
>
> =C2=A0private static void addDoc(IndexWriter w, String value) throws IOEx=
ception
> {
> =C2=A0 =C2=A0Document doc =3D new Document();
> =C2=A0 =C2=A0doc.add(new Field("title", value, Field.Store.YES,
> Field.Index.ANALYZED));
> =C2=A0 =C2=A0w.addDocument(doc);
> =C2=A0}
>
> =C2=A0 =C2=A0}
>
> ---------------------------------------------------------------------
> M=C3=A1rio Andr=C3=A9
> Instituto Federal de Educa=C3=A7=C3=A3o, Ci=C3=AAncia e Tecnologia de Ser=
gipe - IFS
> Mestrando em MCC - Universidade Federal de Alagoas - UFAL
> http://www.marioandre.com.br/
> Skype: mario-fa
> -------------------------------------------------------------------------=
---
> ----------
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44357-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 15:58:28 2010
Return-Path: <java-user-return-44357-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84598 invoked from network); 5 Jan 2010 15:58:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 15:58:28 -0000
Received: (qmail 20246 invoked by uid 500); 5 Jan 2010 15:58:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20188 invoked by uid 500); 5 Jan 2010 15:58:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20178 invoked by uid 99); 5 Jan 2010 15:58:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 15:58:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of BArmstrong@dymaxion.ca designates 24.222.19.49 as permitted sender)
Received: from [24.222.19.49] (HELO ntex.dymaxion.ca) (24.222.19.49)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 15:58:16 +0000
Received: from bgpc.dymaxion.ca ([24.222.19.4]) by ntex.dymaxion.ca with Microsoft SMTPSVC(6.0.3790.3959);
	 Tue, 5 Jan 2010 11:57:55 -0400
Received: from localhost ([127.0.0.1])
	by bgpc.dymaxion.ca with esmtp (Exim 4.69)
	(envelope-from <BArmstrong@dymaxion.ca>)
	id 1NSBn8-000775-VB
	for java-user@lucene.apache.org; Tue, 05 Jan 2010 11:57:55 -0400
Message-ID: <4B436182.6000207@dymaxion.ca>
Date: Tue, 05 Jan 2010 11:57:54 -0400
From: Ben Armstrong <BArmstrong@dymaxion.ca>
User-Agent: Mozilla-Thunderbird 2.0.0.22 (X11/20090701)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Solr/Lucene on OpenVMS, filesystem-specific issues
References: <4B433F43.8040803@dymaxion.ca>
In-Reply-To: <4B433F43.8040803@dymaxion.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 05 Jan 2010 15:57:55.0165 (UTC) FILETIME=[D7F330D0:01CA8E1F]

Ben Armstrong wrote:
> I am trying to get Solr 1.4.0 to work on OpenVMS V8.3 Alpha with Java 
> 1.5.0-6.p1.
...
> If Lucene would consider the segment number to end at a final period 
> instead of scanning to the end of the string, then I could get past 
> this error.
>
> I looked at the other possible JAVA$FILENAME_CONTROLS and none of them 
> address this particular issue.  The "multi-dot-in-file" controls have 
> to do with which side of the filename any additional dots end up in.  
> On a VMS filesystem, whether it is ODS-2 or ODS-5, at least one dot 
> separating the filename and the extension is mandatory.  If there are 
> additional dots in the filename, they need to be either mangled (as in 
> the case of ODS-2, usually by replacing them with underscores) or else 
> they need to be quoted as "^." (as in the case of ODS-5).  I believe 
> the "Support multi dot in file, keeping last" and "keeping first" 
> controls just govern where the mandatory (unquoted, unmangled) dot 
> goes.  And in any event, these only affect multi-dot filenames, e.g. 
> "extra.dot.dat", not extensionless files, e.g. "segment_1.", so for 
> Lucene to work on VMS, it needs to accommodate for this 
> filesystem-specific oddity.

This morning, I discussed with rjent and ThetaPh1 on #lucene @ 
irc.freenode.net about this problem and they made some helpful 
suggestions.  Here is a summary of what they told me:

Is there no way to switch off the mandatory period in VMS?  [No.]

Lucene should not change for this bogus behaviour.

Can you use another platform?  [No, not easily.]

Get your jvm vendor to support filename mangling properly.  [OK, I will 
ask HP, but this will take time.]

In the meantime, try a VMSFSdirectory wrapper that extends 
SimpleFSDirectory and rewrite all methods using filenames and pass 
through a rewrite method.

Maybe there is some open source filename mangler/demangler already?  [I 
will look.]

If all else fails, there may be contrib/db stores in berkeley db that 
might work if you don't want to write code.



So, I would like to thank #lucene again for their helpful suggestions.  
I will ask both HP and the OpenVMS support community for further 
assistance based on this advice.

Ben



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44358-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 16:09:41 2010
Return-Path: <java-user-return-44358-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89711 invoked from network); 5 Jan 2010 16:09:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 16:09:41 -0000
Received: (qmail 39773 invoked by uid 500); 5 Jan 2010 16:09:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39685 invoked by uid 500); 5 Jan 2010 16:09:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39675 invoked by uid 99); 5 Jan 2010 16:09:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 16:09:39 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 16:09:30 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id E3E71C9A49
	for <java-user@lucene.apache.org>; Tue,  5 Jan 2010 11:09:06 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Tue, 05 Jan 2010 11:09:07 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=Hqb9lu2UbCbFBimDLDN718QjaNA=; b=d5y4gADF2mxt8BKnHTUMO/aYwMgCeOYH8nzcarcSNbYIKi2OgPh5rF7GwWzxhpWaq1PEfwpD1pXKv1qSZDXhqXgUfBiHIFLzvV6hRXmawqFHYtsWZXTm0ZXpR+HbKAO05AqzTu/oPAmYIKPwsmS8p3xujpWeemCwDdJ/IFlhVqE=
X-Sasl-enc: YtUbuwWU4R1QNsPNKRyK2IstQ8hoiDd6wOQahCkv8qdm 1262707733
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 1DCAC4A6F72
	for <java-user@lucene.apache.org>; Tue,  5 Jan 2010 11:08:52 -0500 (EST)
Message-ID: <4B436414.90403@fastmail.fm>
Date: Tue, 05 Jan 2010 16:08:52 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: How do you check a field has been indexed correctly if not stored
 ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit


In my junittest code, I check the index has been created okay by 
checking the value of various fields that have been indexed (and stored)
    i.e assertEquals("Farming Incident", 
doc.getField(ArtistIndexField.ARTIST.getName()).stringValue());
But if I'm only indexing the field , but not storing it the value isnt 
held, what else could i check instead

thanks Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44359-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 16:24:26 2010
Return-Path: <java-user-return-44359-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94580 invoked from network); 5 Jan 2010 16:24:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 16:24:26 -0000
Received: (qmail 59209 invoked by uid 500); 5 Jan 2010 16:24:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59123 invoked by uid 500); 5 Jan 2010 16:24:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59113 invoked by uid 99); 5 Jan 2010 16:24:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 16:24:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 16:24:15 +0000
Received: by bwz22 with SMTP id 22so10259892bwz.5
        for <java-user@lucene.apache.org>; Tue, 05 Jan 2010 08:23:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=HqBPyxj+Z3ILVYgO89+7PB2OjAC9wXqCBkrs0w/gaqA=;
        b=Et0ttS5d7v7dy089Dxi8mNmb3Tra9RT51AOW96Wxi1uKAufptuBGEIMjuGZPKqNg09
         BsmQyi98FoHvIKexkBZGrHtA2OV9umC2lMS+yba95ukfS+nPuMTr9iYT7DeZf8REof/6
         QjLDxtDe+/8B7MxBlahk3WYdxYA7MaHqykoRo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=a3R9sYlpg11rCJIb385f4Az0W7LRE5DIxdgjeBQrvOID+9bFfQagpJvXFmmk/5TfBn
         RHvGUET8wgZmuIuQx4TsgtGUiEmSlQhB78F4Ck+78UjaD43aMzJgfpDRgzsysUpqkHfx
         bVuWjxu4E6998w9qhu2WG58gQ+3ddy0pOVJGo=
MIME-Version: 1.0
Received: by 10.239.185.13 with SMTP id a13mr214427hbh.201.1262708633642; Tue, 
	05 Jan 2010 08:23:53 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <4B436414.90403@fastmail.fm>
References: <4B436414.90403@fastmail.fm>
Date: Tue, 5 Jan 2010 17:23:53 +0100
Message-ID: <f18c9dde1001050823y7546328td34d82073aa1d39a@mail.gmail.com>
Subject: Re: How do you check a field has been indexed correctly if not stored 
	?
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Would indexReader#termDocs() help? You get all docs containing a
specific term - that way you could iterate in reverse order though.

simon

On Tue, Jan 5, 2010 at 5:08 PM, Paul Taylor <paul_t100@fastmail.fm> wrote:
>
> In my junittest code, I check the index has been created okay by checking
> the value of various fields that have been indexed (and stored)
> =C2=A0 i.e assertEquals("Farming Incident",
> doc.getField(ArtistIndexField.ARTIST.getName()).stringValue());
> But if I'm only indexing the field , but not storing it the value isnt he=
ld,
> what else could i check instead
>
> thanks Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44360-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 16:24:50 2010
Return-Path: <java-user-return-44360-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94718 invoked from network); 5 Jan 2010 16:24:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 16:24:50 -0000
Received: (qmail 61030 invoked by uid 500); 5 Jan 2010 16:24:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60947 invoked by uid 500); 5 Jan 2010 16:24:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60937 invoked by uid 99); 5 Jan 2010 16:24:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 16:24:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 16:24:39 +0000
Received: by ewy25 with SMTP id 25so20128591ewy.5
        for <java-user@lucene.apache.org>; Tue, 05 Jan 2010 08:24:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=kxh/Z4fuK5b7f8vAykyaRkaA3JqsbiQ/R0+2MsDLju8=;
        b=CfZRnm6z4URvZdC43SAuz9Nmk5XjDUqCjnX48m3FAO9D7JwEoBME26BSlkv/Z2V477
         0fu1eU33xTPB43YJkDyy0dNZ6t7YEjZToOYF2eWmBis0sRs/KE0tBupjHGBhXF0W/2XV
         tgx2pYdL9fEOgS/dV3LcPp4O/nv081V+Wc/38=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=R5Hu/yTinJ0IRJBhMpR1zhY1+SvPnAanLv+7yOONLqVy3imfD4u182gHVtWvyALBwN
         J4uBUkiVfqxMleGH5DiIDab+82zNjZkPGz1V32ZoRGSDK+hIXCaUKeCZgKOInT6A46Ju
         dFfg+xksSbu0V8PeyM7/rQ5ydcmDyZ1B2CSd8=
MIME-Version: 1.0
Received: by 10.216.85.68 with SMTP id t46mr7217236wee.114.1262708659411; Tue, 
	05 Jan 2010 08:24:19 -0800 (PST)
In-Reply-To: <4B436414.90403@fastmail.fm>
References: <4B436414.90403@fastmail.fm>
Date: Tue, 5 Jan 2010 11:24:19 -0500
Message-ID: <359a92831001050824r704d67d7h242b3f24623b6806@mail.gmail.com>
Subject: Re: How do you check a field has been indexed correctly if not stored 
	?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=0016e6d645a8195d06047c6d459f
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d645a8195d06047c6d459f
Content-Type: text/plain; charset=ISO-8859-1

One way to handle this is to run some searches and check to see
if the number of matched documents is what you expect.

You could also use some of the TermDocs to inspect your
index to see if things are what you expect.

You could knock yourself out and look at things like
TermPositionVector and TermFreqVector and see if the
terms you're interested in are in the positions you expect.

But I've been satisfied with just doing the first option, run a search
and see if you get exactly what you expect.....

HTH
Erick

On Tue, Jan 5, 2010 at 11:08 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:

>
> In my junittest code, I check the index has been created okay by checking
> the value of various fields that have been indexed (and stored)
>   i.e assertEquals("Farming Incident",
> doc.getField(ArtistIndexField.ARTIST.getName()).stringValue());
> But if I'm only indexing the field , but not storing it the value isnt
> held, what else could i check instead
>
> thanks Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d645a8195d06047c6d459f--

From java-user-return-44361-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 16:52:28 2010
Return-Path: <java-user-return-44361-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2566 invoked from network); 5 Jan 2010 16:52:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 16:52:28 -0000
Received: (qmail 97098 invoked by uid 500); 5 Jan 2010 16:52:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97055 invoked by uid 500); 5 Jan 2010 16:52:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97045 invoked by uid 99); 5 Jan 2010 16:52:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 16:52:25 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 16:52:15 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id CFE88C97F9;
	Tue,  5 Jan 2010 11:51:54 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Tue, 05 Jan 2010 11:51:54 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=Q/iS+jsET+XTTa1BKG8gV56w4fA=; b=PX26aZVpudu9T8A3tRBjmJT78vn2jUBAuWsn+oevJ3Yp8gDHezq1dz56eGiHs/S+A43zjvWfFSSWXhWDtUhtb/5BBof/dFJrNcDlcNivU46AhUPqcR1hlwk+3mDSdS5QdIau2qiwpVeORO9WsWOV4ZJhmlJsKv+v8nO5oGEDC0M=
X-Sasl-enc: ysH8H5ht0GHuNTgqcYIBZ00UZZoRgoTk+YTauiVGWbhq 1262710314
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 2A23A4A7060;
	Tue,  5 Jan 2010 11:51:54 -0500 (EST)
Message-ID: <4B436E29.9020606@fastmail.fm>
Date: Tue, 05 Jan 2010 16:51:53 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: Erick Erickson <erickerickson@gmail.com>, 
 java-user@lucene.apache.org
Subject: Re: How do you check a field has been indexed correctly if not stored
 	?
References: <4B436414.90403@fastmail.fm> <359a92831001050824r704d67d7h242b3f24623b6806@mail.gmail.com>
In-Reply-To: <359a92831001050824r704d67d7h242b3f24623b6806@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Erick Erickson wrote:
> One way to handle this is to run some searches and check to see
> if the number of matched documents is what you expect.
Yes it works fine at the moment, but I'm trying to write junit tests to 
protect against changes in the future, is there nothing simple I can code

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44362-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 17:02:23 2010
Return-Path: <java-user-return-44362-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5442 invoked from network); 5 Jan 2010 17:02:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 17:02:23 -0000
Received: (qmail 15733 invoked by uid 500); 5 Jan 2010 17:02:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15676 invoked by uid 500); 5 Jan 2010 17:02:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15664 invoked by uid 99); 5 Jan 2010 17:02:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 17:02:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of farhang@gmail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 17:02:13 +0000
Received: by fg-out-1718.google.com with SMTP id 19so2114189fgg.5
        for <java-user@lucene.apache.org>; Tue, 05 Jan 2010 09:01:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=T99x87A+Op/NR2tIQHT8TA6BljX0nONMCZF9HEfR5hk=;
        b=HCkANuD7wnqkuzpKQIn0y+Bag084mjuJX6NdkqttTVO8jkcfvsLHqm7j7/VAcxdQSh
         hVJ2K5cFlVj1j+WmLE3yEvpVqm0OTYXLhSxBF6ukDMMiYmMpYjuZ8g6KyXfvcU39CEgq
         E3Q7seLACSB6qytvOPwyTLqvelIzgpCLt9NG8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=sVh8nnGM9b2Qi3HesmTs4ZwCXDDIsOvAS2dABLe5IASZxG9dNC7v4VR9yLmEWOM4tv
         6QqZZBvxJZSE/nxbgOxhxO8eAKvAZh0RLXaNtZx6dWGY9vMPbPlfdgbvfynxXWuWr7RM
         GLokw9lZmJ2cQ6q8jjD3GIyVNK2uy8GWuNSzo=
MIME-Version: 1.0
Received: by 10.216.162.130 with SMTP id y2mr357042wek.56.1262710909351; Tue, 
	05 Jan 2010 09:01:49 -0800 (PST)
Date: Tue, 5 Jan 2010 10:01:49 -0700
Message-ID: <b0f7deba1001050901u405d25ffm32187b0eb49c1739@mail.gmail.com>
Subject: Switching from Store.YES to Store.NO
From: Babak Farhang <farhang@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1

Hi,

A review of the requirements of the project I'm working on has led us
to conclude that going forward we don't need Lucene to store certain
field values--just index.  Owing to the large size of the data, we
can't really afford to reindex everything, (Going forward, we plan to
treat these fields as if they were never stored.) Which brings up my
question.  What effect, if any, does switching to Store.NO have when
existing documents in the index already use Store.YES for that field?
Will the change take effect for the new docs added to the index?  Are
there any side-effects to consider?

Also, more generally, since the Lucene API does not guard against
changing the document "schema" as the index is being built, I imagine
the effects of such mid-stream "schema" changes might be documented
somewhere.  Please share, if you know of such a document.

Regards,
-Babak

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44363-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 20:00:38 2010
Return-Path: <java-user-return-44363-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78862 invoked from network); 5 Jan 2010 20:00:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 20:00:38 -0000
Received: (qmail 52585 invoked by uid 500); 5 Jan 2010 20:00:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52521 invoked by uid 500); 5 Jan 2010 20:00:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52511 invoked by uid 99); 5 Jan 2010 20:00:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 20:00:36 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 20:00:26 +0000
Received: by ywh14 with SMTP id 14so15467911ywh.20
        for <java-user@lucene.apache.org>; Tue, 05 Jan 2010 12:00:05 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.162.18 with SMTP id k18mr38468631ybe.155.1262721605157; 
	Tue, 05 Jan 2010 12:00:05 -0800 (PST)
In-Reply-To: <b0f7deba1001050901u405d25ffm32187b0eb49c1739@mail.gmail.com>
References: <b0f7deba1001050901u405d25ffm32187b0eb49c1739@mail.gmail.com>
Date: Tue, 5 Jan 2010 15:00:05 -0500
Message-ID: <9ac0c6aa1001051200v224a8ad3p5dcb1bc00807bcd9@mail.gmail.com>
Subject: Re: Switching from Store.YES to Store.NO
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Making that switch is fine.

The change will not be retroactive, ie, all previously indexed docs
with Store.YES will continue to store their fields.  But new docs
won't store their fields if you specify Store.NO.

I don't think this (what happens when certain schema changes happen
mid-indexing) is well documented, in general.

Mike

On Tue, Jan 5, 2010 at 12:01 PM, Babak Farhang <farhang@gmail.com> wrote:
> Hi,
>
> A review of the requirements of the project I'm working on has led us
> to conclude that going forward we don't need Lucene to store certain
> field values--just index. =A0Owing to the large size of the data, we
> can't really afford to reindex everything, (Going forward, we plan to
> treat these fields as if they were never stored.) Which brings up my
> question. =A0What effect, if any, does switching to Store.NO have when
> existing documents in the index already use Store.YES for that field?
> Will the change take effect for the new docs added to the index? =A0Are
> there any side-effects to consider?
>
> Also, more generally, since the Lucene API does not guard against
> changing the document "schema" as the index is being built, I imagine
> the effects of such mid-stream "schema" changes might be documented
> somewhere. =A0Please share, if you know of such a document.
>
> Regards,
> -Babak
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44364-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 05 23:08:35 2010
Return-Path: <java-user-return-44364-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47589 invoked from network); 5 Jan 2010 23:08:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 5 Jan 2010 23:08:35 -0000
Received: (qmail 410 invoked by uid 500); 5 Jan 2010 23:08:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 345 invoked by uid 500); 5 Jan 2010 23:08:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 335 invoked by uid 99); 5 Jan 2010 23:08:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 23:08:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of farhang@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 05 Jan 2010 23:08:24 +0000
Received: by ewy25 with SMTP id 25so20565365ewy.5
        for <java-user@lucene.apache.org>; Tue, 05 Jan 2010 15:08:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=4faONTddzfFCQ8oev7gT9Z7KZ0ptM8n/4sf0EVBNJEg=;
        b=j2TDTxAyBb+Lb1LD9gJ6sObNNYtEultnUnCl5fwZDAipx7BnboEUPylDy/ZS1HvUK6
         uUo3BtSIlqgH5qzQkFvAqvexArAKJPbv+cs3BSHAOjdB3Q5mQmmdGY18PMxhnHIltPof
         BtV8E4Pd7XEdFYrPc4U7D7rhkgKkeIjntjqIM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=eF617NB2QMMkskxjxjPqdmrUsBvrNkVoq4wmgq7h1xNfIutF4EuuLjbbdn+EqEr1i1
         ShEFw14AGmYjAR/ZVZL+8ewUtP5awtQEDhV3MGegZE3dG33Bp1PkR/S2UdIrubR9+/DC
         zRPRrnJoj38vfPNug1855lqurVvatH4RNB28E=
MIME-Version: 1.0
Received: by 10.216.88.202 with SMTP id a52mr1904222wef.101.1262732883288; 
	Tue, 05 Jan 2010 15:08:03 -0800 (PST)
In-Reply-To: <9ac0c6aa1001051200v224a8ad3p5dcb1bc00807bcd9@mail.gmail.com>
References: <b0f7deba1001050901u405d25ffm32187b0eb49c1739@mail.gmail.com>
	 <9ac0c6aa1001051200v224a8ad3p5dcb1bc00807bcd9@mail.gmail.com>
Date: Tue, 5 Jan 2010 16:08:03 -0700
Message-ID: <b0f7deba1001051508o1192065cv3dc1a2283c0e2853@mail.gmail.com>
Subject: Re: Switching from Store.YES to Store.NO
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Thanks!

On Tue, Jan 5, 2010 at 1:00 PM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> Making that switch is fine.
>
> The change will not be retroactive, ie, all previously indexed docs
> with Store.YES will continue to store their fields. =A0But new docs
> won't store their fields if you specify Store.NO.
>
> I don't think this (what happens when certain schema changes happen
> mid-indexing) is well documented, in general.
>
> Mike
>
> On Tue, Jan 5, 2010 at 12:01 PM, Babak Farhang <farhang@gmail.com> wrote:
>> Hi,
>>
>> A review of the requirements of the project I'm working on has led us
>> to conclude that going forward we don't need Lucene to store certain
>> field values--just index. =A0Owing to the large size of the data, we
>> can't really afford to reindex everything, (Going forward, we plan to
>> treat these fields as if they were never stored.) Which brings up my
>> question. =A0What effect, if any, does switching to Store.NO have when
>> existing documents in the index already use Store.YES for that field?
>> Will the change take effect for the new docs added to the index? =A0Are
>> there any side-effects to consider?
>>
>> Also, more generally, since the Lucene API does not guard against
>> changing the document "schema" as the index is being built, I imagine
>> the effects of such mid-stream "schema" changes might be documented
>> somewhere. =A0Please share, if you know of such a document.
>>
>> Regards,
>> -Babak
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44365-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 06 06:29:54 2010
Return-Path: <java-user-return-44365-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68742 invoked from network); 6 Jan 2010 06:29:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Jan 2010 06:29:54 -0000
Received: (qmail 63388 invoked by uid 500); 6 Jan 2010 06:29:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63333 invoked by uid 500); 6 Jan 2010 06:29:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63323 invoked by uid 99); 6 Jan 2010 06:29:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 06:29:51 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of chris.lu@gmail.com designates 209.85.217.215 as permitted sender)
Received: from [209.85.217.215] (HELO mail-gx0-f215.google.com) (209.85.217.215)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 06:29:41 +0000
Received: by gxk7 with SMTP id 7so12239056gxk.12
        for <java-user@lucene.apache.org>; Tue, 05 Jan 2010 22:29:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type;
        bh=xAwJp4jTcmx94qpf/XyYK6kbWYXzu8TduxWWU4Jsj8E=;
        b=rBakiM+QmUMf6aQKKxHRwlMzCWJeu70Ic/+3E0lVOkz+p/YXXaAOBAuP4kZ5lDX5Gs
         PRSaCJdqIMq85E81kaXZgiUc8OhsdwdUdxgBfvgUhiaqa0tf4ZlHNsPTHrS8WyVHsKhW
         lRAsuE6x8YrGIDp/Cn5RBJNFYSlS+DNGp+15o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type;
        b=hUu61gv388ObwgUrCUXPJTEc2zZh+875a1r08BSDb/NQrE2xMxyOzP6zpnLrO6Gf47
         x5ahK5CPHbpaROCQDtzGMh5iiaTq+sUzyjGJGyBpFHD0hwtkhhzJ4OT7iMMUSKeQ8cA2
         Wc+0QJt+QGuInczCogSLFwpGg2vU9J3Dni0q8=
Received: by 10.150.76.6 with SMTP id y6mr39511494yba.60.1262759359330;
        Tue, 05 Jan 2010 22:29:19 -0800 (PST)
Received: from ?192.168.1.100? (c-71-202-137-93.hsd1.ca.comcast.net [71.202.137.93])
        by mx.google.com with ESMTPS id 35sm8206578yxh.33.2010.01.05.22.29.16
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 05 Jan 2010 22:29:17 -0800 (PST)
Message-ID: <4B442D77.9030006@gmail.com>
Date: Tue, 05 Jan 2010 22:28:07 -0800
From: Chris Lu <chris.lu@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Switching from Store.YES to Store.NO
References: <b0f7deba1001050901u405d25ffm32187b0eb49c1739@mail.gmail.com> <9ac0c6aa1001051200v224a8ad3p5dcb1bc00807bcd9@mail.gmail.com>
In-Reply-To: <9ac0c6aa1001051200v224a8ad3p5dcb1bc00807bcd9@mail.gmail.com>
Content-Type: multipart/alternative;
 boundary="------------020308000001020703050609"
X-Virus-Checked: Checked by ClamAV on apache.org

--------------020308000001020703050609
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Just curious, will it be adjusted during indexing when merging segments?

Thanks!

--
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes: http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
DBSight customer, a shopping comparison site, (anonymous per request) got 2.6 Million Euro funding!


Michael McCandless wrote:
> Making that switch is fine.
>
> The change will not be retroactive, ie, all previously indexed docs
> with Store.YES will continue to store their fields.  But new docs
> won't store their fields if you specify Store.NO.
>
> I don't think this (what happens when certain schema changes happen
> mid-indexing) is well documented, in general.
>
> Mike
>
> On Tue, Jan 5, 2010 at 12:01 PM, Babak Farhang <farhang@gmail.com> wrote:
>   
>> Hi,
>>
>> A review of the requirements of the project I'm working on has led us
>> to conclude that going forward we don't need Lucene to store certain
>> field values--just index.  Owing to the large size of the data, we
>> can't really afford to reindex everything, (Going forward, we plan to
>> treat these fields as if they were never stored.) Which brings up my
>> question.  What effect, if any, does switching to Store.NO have when
>> existing documents in the index already use Store.YES for that field?
>> Will the change take effect for the new docs added to the index?  Are
>> there any side-effects to consider?
>>
>> Also, more generally, since the Lucene API does not guard against
>> changing the document "schema" as the index is being built, I imagine
>> the effects of such mid-stream "schema" changes might be documented
>> somewhere.  Please share, if you know of such a document.
>>
>> Regards,
>> -Babak
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   

--------------020308000001020703050609--

From java-user-return-44366-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 06 06:51:06 2010
Return-Path: <java-user-return-44366-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83236 invoked from network); 6 Jan 2010 06:51:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Jan 2010 06:51:06 -0000
Received: (qmail 80457 invoked by uid 500); 6 Jan 2010 06:51:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80388 invoked by uid 500); 6 Jan 2010 06:51:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80378 invoked by uid 99); 6 Jan 2010 06:51:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 06:51:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of farhang@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 06:50:56 +0000
Received: by ey-out-2122.google.com with SMTP id 9so3372412eyd.3
        for <java-user@lucene.apache.org>; Tue, 05 Jan 2010 22:50:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=NBr+Ni2s2JEJI9G3/x3rRt8MPKwl2tcHCdQVF7Pc/pM=;
        b=Gr3wuPPoLInUYQg+ZQ35T8OXASM4tj+58G44hekQSEgd6dT7nyRY5ESFEfb3nK9pO7
         69m1xncQpWl5/Hr/APl+LWxhklAFvyP33CawlxngoUx4+gTTu7WqNCwFchrqaUHTtosD
         UZxt6AYJG5AojE+vSb1c0IA2fEwUajq1vMGIc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=os6PSYocfE+TjbTdq3JH0eGCcnrlMeXWu1lldnI+7S7Wz1RNuxLHmiQMeuoN1Mii7Y
         jK3PQ5mTdrmPX0+PXCId9kag1RnwWdRFAocBmeAsFHxtgZ+KRTszWfj5Ue3pmZfJw1Sg
         tHb06EfPhA1k0OeJdxhCuYZpdd1kB7NoxnBL8=
MIME-Version: 1.0
Received: by 10.216.91.69 with SMTP id g47mr10389005wef.167.1262760634297; 
	Tue, 05 Jan 2010 22:50:34 -0800 (PST)
In-Reply-To: <4B442D77.9030006@gmail.com>
References: <b0f7deba1001050901u405d25ffm32187b0eb49c1739@mail.gmail.com>
	 <9ac0c6aa1001051200v224a8ad3p5dcb1bc00807bcd9@mail.gmail.com>
	 <4B442D77.9030006@gmail.com>
Date: Tue, 5 Jan 2010 23:50:34 -0700
Message-ID: <b0f7deba1001052250v1b5ff08at3d4c82c1cd5596ec@mail.gmail.com>
Subject: Re: Switching from Store.YES to Store.NO
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

I'm curious (:-)) about what do you mean by *adjusted*? Also, not sure
I have the nomenclature here right, but isn't indexing functionally
separate from merging segments? (You *index* to a segment which may,
or may not, be later *merged* with other segments, no?)

On Tue, Jan 5, 2010 at 11:28 PM, Chris Lu <chris.lu@gmail.com> wrote:
> Just curious, will it be adjusted during indexing when merging segments?
>
> Thanks!
>
> --
> Chris Lu
> -------------------------
> Instant Scalable Full-Text Search On Any Database/Application
> site: http://www.dbsight.net
> demo: http://search.dbsight.com
> Lucene Database Search in 3 minutes:
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> DBSight customer, a shopping comparison site, (anonymous per request) got
> 2.6 Million Euro funding!
>
>
> Michael McCandless wrote:
>>
>> Making that switch is fine.
>>
>> The change will not be retroactive, ie, all previously indexed docs
>> with Store.YES will continue to store their fields.  But new docs
>> won't store their fields if you specify Store.NO.
>>
>> I don't think this (what happens when certain schema changes happen
>> mid-indexing) is well documented, in general.
>>
>> Mike
>>
>> On Tue, Jan 5, 2010 at 12:01 PM, Babak Farhang <farhang@gmail.com> wrote:
>>
>>>
>>> Hi,
>>>
>>> A review of the requirements of the project I'm working on has led us
>>> to conclude that going forward we don't need Lucene to store certain
>>> field values--just index.  Owing to the large size of the data, we
>>> can't really afford to reindex everything, (Going forward, we plan to
>>> treat these fields as if they were never stored.) Which brings up my
>>> question.  What effect, if any, does switching to Store.NO have when
>>> existing documents in the index already use Store.YES for that field?
>>> Will the change take effect for the new docs added to the index?  Are
>>> there any side-effects to consider?
>>>
>>> Also, more generally, since the Lucene API does not guard against
>>> changing the document "schema" as the index is being built, I imagine
>>> the effects of such mid-stream "schema" changes might be documented
>>> somewhere.  Please share, if you know of such a document.
>>>
>>> Regards,
>>> -Babak
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44367-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 06 10:21:44 2010
Return-Path: <java-user-return-44367-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36194 invoked from network); 6 Jan 2010 10:21:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Jan 2010 10:21:43 -0000
Received: (qmail 49198 invoked by uid 500); 6 Jan 2010 10:21:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49128 invoked by uid 500); 6 Jan 2010 10:21:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49118 invoked by uid 99); 6 Jan 2010 10:21:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 10:21:41 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 10:21:31 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 86126C96C3
	for <java-user@lucene.apache.org>; Wed,  6 Jan 2010 05:21:10 -0500 (EST)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute1.internal (MEProxy); Wed, 06 Jan 2010 05:21:10 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=Xwtx8ospp/m2SkeMtwWLasymiVc=; b=VNcEqst4ZkUiyq9YtRTqMxX2IUUct6imQcjFOEHqjHiB/KLYYQId/5t+UCeqrEGR0CMrZ71DMAZLIcTtxJb76FoZQ/e1F8s3UJUwTltZr1LR/e1Z1sQePXL6TKPQ98Asrd+OTRhbHsfRH0HOexn9wcTGdpFhGx7UhYY80jmw/fQ=
X-Sasl-enc: jKTy3i6TCxIaUIYQcvp+VUPESKgSJUzxtANokxDtrG4Z 1262773270
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 122B12A8C7
	for <java-user@lucene.apache.org>; Wed,  6 Jan 2010 05:21:09 -0500 (EST)
Message-ID: <4B446415.3080602@fastmail.fm>
Date: Wed, 06 Jan 2010 10:21:09 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: How do you check a field has been indexed correctly if not stored
 	?
References: <4B436414.90403@fastmail.fm> <f18c9dde1001050823y7546328td34d82073aa1d39a@mail.gmail.com>
In-Reply-To: <f18c9dde1001050823y7546328td34d82073aa1d39a@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Simon Willnauer wrote:
> Would indexReader#termDocs() help? You get all docs containing a
> specific term - that way you could iterate in reverse order though.
>
> simon

Thanks, almost if I do this I can determine that a document exists  with 
a term with a particular value works

 TermDocs termDocs = ir.termDocs(new 
Term(ArtistIndexField.ARTIST_ID.getName(),"4302e264-1cf0-4d1f-aca7-2a6f89e34b36"));
 termDocs.next();
 assertEquals(1,termDocs.freq());

but this doesnt work

 TermDocs termDocs = ir.termDocs(new 
Term(ArtistIndexField.ARTIST_ID.getName()));
 termDocs.next();
 assertEquals(1,termDocs.freq());

which is what I really want, i.e that document has a term for this fieldname

(In any test there is only ever one document)

Paul



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44368-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 06 12:02:18 2010
Return-Path: <java-user-return-44368-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72852 invoked from network); 6 Jan 2010 12:02:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Jan 2010 12:02:17 -0000
Received: (qmail 82144 invoked by uid 500); 6 Jan 2010 12:02:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82091 invoked by uid 500); 6 Jan 2010 12:02:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82081 invoked by uid 99); 6 Jan 2010 12:02:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 12:02:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 12:02:06 +0000
Received: by yxe3 with SMTP id 3so15869639yxe.20
        for <java-user@lucene.apache.org>; Wed, 06 Jan 2010 04:01:44 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.165.17 with SMTP id n17mr28841920ybe.321.1262779304124; 
	Wed, 06 Jan 2010 04:01:44 -0800 (PST)
In-Reply-To: <b0f7deba1001052250v1b5ff08at3d4c82c1cd5596ec@mail.gmail.com>
References: <b0f7deba1001050901u405d25ffm32187b0eb49c1739@mail.gmail.com>
	 <9ac0c6aa1001051200v224a8ad3p5dcb1bc00807bcd9@mail.gmail.com>
	 <4B442D77.9030006@gmail.com>
	 <b0f7deba1001052250v1b5ff08at3d4c82c1cd5596ec@mail.gmail.com>
Date: Wed, 6 Jan 2010 07:01:44 -0500
Message-ID: <9ac0c6aa1001060401h4bd4af09ta08ca7b07a2eb5a@mail.gmail.com>
Subject: Re: Switching from Store.YES to Store.NO
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

This is a good question...

Merging will not alter the previously stored fields -- it will just
carry them forward to the next segment.

So any docs that have stored fields will retain them through merging.

(And, yes, merging is done "under the hood", separately from "indexing").

This is in contrast to other things.  EG, if you try to disable norms
on your fields, merging will sneakily turn norms back on, whenever a
segment containing "old" docs that have norms enabled is merged with
segments that had turned norms off.  You must fully re-index to
succeed in turning norms off.

Mike

On Wed, Jan 6, 2010 at 1:50 AM, Babak Farhang <farhang@gmail.com> wrote:
> I'm curious (:-)) about what do you mean by *adjusted*? Also, not sure
> I have the nomenclature here right, but isn't indexing functionally
> separate from merging segments? (You *index* to a segment which may,
> or may not, be later *merged* with other segments, no?)
>
> On Tue, Jan 5, 2010 at 11:28 PM, Chris Lu <chris.lu@gmail.com> wrote:
>> Just curious, will it be adjusted during indexing when merging segments?
>>
>> Thanks!
>>
>> --
>> Chris Lu
>> -------------------------
>> Instant Scalable Full-Text Search On Any Database/Application
>> site: http://www.dbsight.net
>> demo: http://search.dbsight.com
>> Lucene Database Search in 3 minutes:
>> http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Search_=
in_3_minutes
>> DBSight customer, a shopping comparison site, (anonymous per request) go=
t
>> 2.6 Million Euro funding!
>>
>>
>> Michael McCandless wrote:
>>>
>>> Making that switch is fine.
>>>
>>> The change will not be retroactive, ie, all previously indexed docs
>>> with Store.YES will continue to store their fields. =A0But new docs
>>> won't store their fields if you specify Store.NO.
>>>
>>> I don't think this (what happens when certain schema changes happen
>>> mid-indexing) is well documented, in general.
>>>
>>> Mike
>>>
>>> On Tue, Jan 5, 2010 at 12:01 PM, Babak Farhang <farhang@gmail.com> wrot=
e:
>>>
>>>>
>>>> Hi,
>>>>
>>>> A review of the requirements of the project I'm working on has led us
>>>> to conclude that going forward we don't need Lucene to store certain
>>>> field values--just index. =A0Owing to the large size of the data, we
>>>> can't really afford to reindex everything, (Going forward, we plan to
>>>> treat these fields as if they were never stored.) Which brings up my
>>>> question. =A0What effect, if any, does switching to Store.NO have when
>>>> existing documents in the index already use Store.YES for that field?
>>>> Will the change take effect for the new docs added to the index? =A0Ar=
e
>>>> there any side-effects to consider?
>>>>
>>>> Also, more generally, since the Lucene API does not guard against
>>>> changing the document "schema" as the index is being built, I imagine
>>>> the effects of such mid-stream "schema" changes might be documented
>>>> somewhere. =A0Please share, if you know of such a document.
>>>>
>>>> Regards,
>>>> -Babak
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44369-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 06 14:01:37 2010
Return-Path: <java-user-return-44369-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22454 invoked from network); 6 Jan 2010 14:01:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Jan 2010 14:01:37 -0000
Received: (qmail 26199 invoked by uid 500); 6 Jan 2010 14:01:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26129 invoked by uid 500); 6 Jan 2010 14:01:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26118 invoked by uid 99); 6 Jan 2010 14:01:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 14:01:35 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=HTML_FONT_FACE_BAD,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 14:01:28 +0000
Received: by fxm2 with SMTP id 2so15106844fxm.5
        for <java-user@lucene.apache.org>; Wed, 06 Jan 2010 06:01:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=r3YYgnbu50I3HtX+DPM3u7BIoeaQVtLNOMOPl9gMHkc=;
        b=w8YupG9pRA1srbPZ4Nl9q0ZGpoO2W0JSl56bPkNa/Qmk94jyo14IIEQT7DbtFAE1eh
         74VTyYXeJT7gfkVOt1YWympEH84XekzLkLN+ak+xIxgY/4Mqr8Zpf9h3gPgsepLV4kEZ
         R9R6TOCJrOU0/mXHIESjJlIfi7YpuT2PNw/JQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=i1p/19apcgoK2fqicMRSWpHGba9rGQDnyajW9o6YDG14G+bLjbWkivJezvlQiQbSiD
         E/Skz5vSpc0PG3QxTiCjW81ARH/ZFVavgigtKO2PPtF8X68rVgqeRFmNJOh+SK4ms5VX
         eXVeTQHsK8mTas2mONS5SEA3QID29TOSgv3r4=
MIME-Version: 1.0
Received: by 10.216.90.67 with SMTP id d45mr432877wef.42.1262786466825; Wed, 
	06 Jan 2010 06:01:06 -0800 (PST)
In-Reply-To: <4B446415.3080602@fastmail.fm>
References: <4B436414.90403@fastmail.fm>
	 <f18c9dde1001050823y7546328td34d82073aa1d39a@mail.gmail.com>
	 <4B446415.3080602@fastmail.fm>
Date: Wed, 6 Jan 2010 09:01:06 -0500
Message-ID: <359a92831001060601g4e6b67c3vc026ddaff842a4a6@mail.gmail.com>
Subject: Re: How do you check a field has been indexed correctly if not stored 
	?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=0016e6d7df78c84492047c7f6243

--0016e6d7df78c84492047c7f6243
Content-Type: text/plain; charset=ISO-8859-1

I think you're looking for

IndexReader.terms(new Term(ArtistIndexField.ARTIST_ID.getName(), ""));

NOTE: the empty string is important. You're effectively positioning
your TermEnum at the first term in the index.

This works in your case without much checking since there
is exactly one document in the index.

Take a bit of care that the Term you get back has the field
equal to the one you care about (ArtistIndexField.ARTIST_ID.getName())
since termenums will merrily carry on to the next field..... This
bit of the JavaDocs is easily overlooked:
" If the given term does not exist, the enumeration
is positioned at the first term greater than the supplied term."
which, if there were no terms for the indicated field would
be the *next* field.....

HTH
Erick


On Wed, Jan 6, 2010 at 5:21 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:

> Simon Willnauer wrote:
>
>> Would indexReader#termDocs() help? You get all docs containing a
>> specific term - that way you could iterate in reverse order though.
>>
>> simon
>>
>
> Thanks, almost if I do this I can determine that a document exists  with a
> term with a particular value works
>
> TermDocs termDocs = ir.termDocs(new
> Term(ArtistIndexField.ARTIST_ID.getName(),"4302e264-1cf0-4d1f-aca7-2a6f89e34b36"));
> termDocs.next();
> assertEquals(1,termDocs.freq());
>
> but this doesnt work
>
> TermDocs termDocs = ir.termDocs(new
> Term(ArtistIndexField.ARTIST_ID.getName()));
> termDocs.next();
> assertEquals(1,termDocs.freq());
>
> which is what I really want, i.e that document has a term for this
> fieldname
>
> (In any test there is only ever one document)
>
>
> Paul
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d7df78c84492047c7f6243--

From java-user-return-44370-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 06 21:49:36 2010
Return-Path: <java-user-return-44370-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10240 invoked from network); 6 Jan 2010 21:49:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 6 Jan 2010 21:49:36 -0000
Received: (qmail 48457 invoked by uid 500); 6 Jan 2010 21:49:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48377 invoked by uid 500); 6 Jan 2010 21:49:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48367 invoked by uid 99); 6 Jan 2010 21:49:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 21:49:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gsiasf@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 06 Jan 2010 21:49:23 +0000
Received: by yxe3 with SMTP id 3so16356456yxe.20
        for <java-user@lucene.apache.org>; Wed, 06 Jan 2010 13:49:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:sender:content-type
         :mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=uFHAN6vznzpSKQpc6ENc5fFk+GEY0wniw0afK+0LzD8=;
        b=nNcdmycvEyBu0GWkNBsk6cvvSOIsJWxHBXevmNOVHwM6n3L8SjWpSlwG1/rRnKn2I5
         SaaNsv7LH0+gkmHMRIyRF/Z6MIduZsRhiKrvLR9TFeztE+MB4sHBQB2Jyk86ff0EpOdv
         Ijw4Xz5Qsx5AioGv2mpewf3UYX0Esy2pp0Xo4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=sender:content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        b=V12XtQHLkAYPi00GBZZkX4UL7hnkbYB/EMwYyG5Ws6uQAaXEzi/OQbdyXT1Uh6kaBl
         c4/kO2S391PZueew4ugH92UyaRa+QIGjEUDF9bE/xRbchOyr87yJjFq2CVpQI5CBO7uJ
         eWFgT2vFVKKUHAwlHvuStn3Exzkcl7tMW7Xr8=
Received: by 10.100.70.9 with SMTP id s9mr15145614ana.160.1262814542201;
        Wed, 06 Jan 2010 13:49:02 -0800 (PST)
Received: from ?10.0.0.77? (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
        by mx.google.com with ESMTPS id 15sm9808403gxk.8.2010.01.06.13.49.01
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 06 Jan 2010 13:49:01 -0800 (PST)
Sender: Grant Ingersoll <gsiasf@gmail.com>
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Performance Results on changing the way fields are stored
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <4B433425.5090908@fastmail.fm>
Date: Wed, 6 Jan 2010 16:49:00 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <486CFF0E-7B40-4750-BAA2-C46B1B8ED4BB@apache.org>
References: <4B433425.5090908@fastmail.fm>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org


On Jan 5, 2010, at 7:44 AM, Paul Taylor wrote:

> So currently in my index I index and store a number of small fields, I =
need both so I can search on the fields, then I use the stored versions =
to generate the output document (which is either an XML or JSON =
representation), because I read stored and index fields are dealt with =
completely seperately I tried another tact only storing one field which =
was a serialized version of the output documentation. This solves a =
couple of issues I was having but I was disappointed that both the size =
of the index increased and the index build  time increased, I thought =
that if all the stored data was held in one field that the resultant =
index would be smaller, and I didn't expect index time to increase by as =
much as it did. I was also suprised that Java serilaization was slower =
and used more space than both JSON and XML serialization.
>=20
> Results as Follows
>=20
> Type:                                                             Time =
: Index Size
> Only indexed  no norms                                                 =
                   105   : 38 MB
> Only indexed                                                           =
                          111   : 43 MB
> Same fields written as Indexed and Stored  (current Situation)         =
  115   : 83 MB
> Fields Indexed, One JAXB classed Stored using JSON Marshalling 140   : =
115 MB
> Fields Indexed, One JAXB classed Stored using XML Marshalling  189   : =
198 MB
> Fields Indexed, One JAXB classed Stored using Java Serialization   305 =
  : 485 MB

How much more verbose are these than the "raw" content?  Even as terse =
as JSON is, it is still verbose compared to a binary format, and XML =
Marshalling and Java Serialization will be even more.  Given that you =
are likely only displaying 10 or so at a time, I'd think it would be =
much more efficient to only store the minimal amount needed to recreate =
the docs in the current result set. =20

I've also seen people have success simply storing a key in Lucene that =
is then used for lookup in something like Memcachedb, Tokyo Cabinet or =
one of the many other key-value stores.

-Grant


--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem using Solr/Lucene: =
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44371-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 08:33:01 2010
Return-Path: <java-user-return-44371-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88981 invoked from network); 7 Jan 2010 08:33:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 08:33:01 -0000
Received: (qmail 57957 invoked by uid 500); 7 Jan 2010 08:32:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57894 invoked by uid 500); 7 Jan 2010 08:32:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57884 invoked by uid 99); 7 Jan 2010 08:32:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 08:32:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 08:32:50 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NSnnC-0002fr-Cu
	for java-user@lucene.apache.org; Thu, 07 Jan 2010 00:32:30 -0800
Message-ID: <27056573.post@talk.nabble.com>
Date: Thu, 7 Jan 2010 00:32:30 -0800 (PST)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Is there a way to limit the size of an index?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com


Hi all,

According to the FAQ, "An even more complex and optimal solution: 
Write a version of FSDirectory that, when a file exceeds 2GB, creates a
subdirectory and represents the file as a series of files."

Is that solution implemented already? If not, can you guide me please how
can I achieve that? Is this solution requires changes in the Reader as well?

Thanks.


-- 
View this message in context: http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27056573.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44372-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 10:35:06 2010
Return-Path: <java-user-return-44372-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32762 invoked from network); 7 Jan 2010 10:35:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 10:35:06 -0000
Received: (qmail 79700 invoked by uid 500); 7 Jan 2010 10:35:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79639 invoked by uid 500); 7 Jan 2010 10:35:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79629 invoked by uid 99); 7 Jan 2010 10:35:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 10:35:04 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 10:34:54 +0000
Received: by ywh14 with SMTP id 14so16984540ywh.20
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 02:34:32 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.76.30 with SMTP id y30mr439338yba.104.1262860471863; Thu, 
	07 Jan 2010 02:34:31 -0800 (PST)
In-Reply-To: <27056573.post@talk.nabble.com>
References: <27056573.post@talk.nabble.com>
Date: Thu, 7 Jan 2010 05:34:31 -0500
Message-ID: <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

I don't think this is implemented [yet] today.  You'd have to
implement the Directory, IndexInput and IndexOutput classes, to make
this work.

Do you have a hard 2GB limit on index files?  Setting
maxMergeDocs/Size (via LogByteSizeMergePolicy) lets you approximately
limit the size...

Mike

On Thu, Jan 7, 2010 at 3:32 AM, Dvora <barak.yaish@gmail.com> wrote:
>
> Hi all,
>
> According to the FAQ, "An even more complex and optimal solution:
> Write a version of FSDirectory that, when a file exceeds 2GB, creates a
> subdirectory and represents the file as a series of files."
>
> Is that solution implemented already? If not, can you guide me please how
> can I achieve that? Is this solution requires changes in the Reader as well?
>
> Thanks.
>
>
> --
> View this message in context: http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27056573.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44373-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 11:24:57 2010
Return-Path: <java-user-return-44373-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48881 invoked from network); 7 Jan 2010 11:24:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 11:24:57 -0000
Received: (qmail 35807 invoked by uid 500); 7 Jan 2010 11:24:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35726 invoked by uid 500); 7 Jan 2010 11:24:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35716 invoked by uid 99); 7 Jan 2010 11:24:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 11:24:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 11:24:45 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NSqTZ-0007Rh-17
	for java-user@lucene.apache.org; Thu, 07 Jan 2010 03:24:25 -0800
Message-ID: <27058014.post@talk.nabble.com>
Date: Thu, 7 Jan 2010 03:24:25 -0800 (PST)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is there a way to limit the size of an index?
In-Reply-To: <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
References: <27056573.post@talk.nabble.com> <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks for the reply.

Can you please add some detailed explanations? I'm trying to upload Lucene
index to Google App Engine, and the files size must not exceed 10MB.



Michael McCandless-2 wrote:
> 
> I don't think this is implemented [yet] today.  You'd have to
> implement the Directory, IndexInput and IndexOutput classes, to make
> this work.
> 

-- 
View this message in context: http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27058014.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44374-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 11:32:51 2010
Return-Path: <java-user-return-44374-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50861 invoked from network); 7 Jan 2010 11:32:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 11:32:51 -0000
Received: (qmail 51101 invoked by uid 500); 7 Jan 2010 11:32:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51042 invoked by uid 500); 7 Jan 2010 11:32:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51032 invoked by uid 99); 7 Jan 2010 11:32:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 11:32:48 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 11:32:40 +0000
Received: by ywh14 with SMTP id 14so17016404ywh.20
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 03:32:19 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.1.1 with SMTP id d1mr7383987ybi.130.1262863933591; Thu, 07 
	Jan 2010 03:32:13 -0800 (PST)
In-Reply-To: <27058014.post@talk.nabble.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
Date: Thu, 7 Jan 2010 06:32:13 -0500
Message-ID: <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Is the creation of the index in your control?  If so, try something like th=
is:

  ((LogByteSizeMergePolicy) writer.getMergePolicy()).setMaxMergeMB(1.0));

(NOTE: not tested).  This works because [currently]
LogByteSizeMergePolicy is the default for IndexWriter.  Would be safer
to create your own LogByteSizeMergePolicy and set it on the writer...

This tells the IndexWriter NOT to merge any segment that's over 1.0 MB
in size.  With a default merge factor of 10, this should "generally"
mean you don't get a segment over 10MB, though it may not be a hard
guarantee (you can lower the 1.0 if you still see a segment over 10
MB).

Implementing a custom directory that splits files @ 10 MB is also
possible, but is a good amount more work.  You'd have to have your
IndexOutput write to the separate 10 MB sized files, then make an
IndexInput that "pretends" they are one file.

Mike

On Thu, Jan 7, 2010 at 6:24 AM, Dvora <barak.yaish@gmail.com> wrote:
>
> Thanks for the reply.
>
> Can you please add some detailed explanations? I'm trying to upload Lucen=
e
> index to Google App Engine, and the files size must not exceed 10MB.
>
>
>
> Michael McCandless-2 wrote:
>>
>> I don't think this is implemented [yet] today. =A0You'd have to
>> implement the Directory, IndexInput and IndexOutput classes, to make
>> this work.
>>
>
> --
> View this message in context: http://old.nabble.com/Is-there-a-way-to-lim=
it-the-size-of-an-index--tp27056573p27058014.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44375-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 12:14:21 2010
Return-Path: <java-user-return-44375-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58376 invoked from network); 7 Jan 2010 12:14:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 12:14:21 -0000
Received: (qmail 93663 invoked by uid 500); 7 Jan 2010 12:14:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93584 invoked by uid 500); 7 Jan 2010 12:14:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93574 invoked by uid 99); 7 Jan 2010 12:14:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 12:14:19 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of naamakraus@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 12:14:12 +0000
Received: by pwi11 with SMTP id 11so8106816pwi.5
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 04:13:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:from:date:message-id
         :subject:to:content-type;
        bh=/x716XXLk4p1KSshBXKplBagZXhZoD3lA28Gy4Frn1M=;
        b=wu1LwYdfCmsH91Wm6zZYkEAKwPeYBI6V4zJwYcw2Til225jnAgKSatEJa696jntc7O
         ElRuZNqSHEK0GXOaWBpgcI+JzpEz6FU6pP8h5JnOps4jh4eWFBvWNSi5PXDvesWH2L8/
         NXJC356Uo/rE4r9O/rZLnnpsTjESjIgXrf4zY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        b=hbWOy7v06+RqA1yx9M2a0fheWGqplfZWXHwtvpMQWpdumQgHQ2qpXfYP7EwKElfTY0
         aJ7y7qYRlKb29Zb13SOcTkwxVceFnNZVvtpx97PiN0XMDsIZmpzEjeEaOR7VrA68wLcX
         N6v7rnpNxRiWo21QaUmgO9+xlRGZNkcYJEXcs=
MIME-Version: 1.0
Received: by 10.140.58.7 with SMTP id g7mr18320099rva.98.1262866432059; Thu, 
	07 Jan 2010 04:13:52 -0800 (PST)
From: Naama Kraus <naamakraus@gmail.com>
Date: Thu, 7 Jan 2010 14:13:32 +0200
Message-ID: <643aa4871001070413x7629dc2ao5661a18880fcadc4@mail.gmail.com>
Subject: Problems with IndexWriter#commit() on Linux
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636b2ac5014eb95047c92010d

--001636b2ac5014eb95047c92010d
Content-Type: text/plain; charset=ISO-8859-1

Hi,

I am using IndexWriter#commit() methods in my program to commit document
additions to the index. I do that once in a while, after a bunch of
documents were added. Since my indexing process is long, I want to make sure
I don't loose too many additions in case of a crash.
When running on Windows, things work as expected. But when running my code
on Linux, seems like commit() has no effect. If I kill my program and then
restart it, I don't see documents that I added and then committed (they are
not returned by a search operation).
I am running Lucene 3.0.0

Can anyone help ?

Thanks, Naama

-- 
"If you want your children to be intelligent, read them fairy tales. If you
want them to be more intelligent, read them more fairy tales."
"What really interests me is whether God had any choice in the creation of
the world."
(Albert Einstein)

--001636b2ac5014eb95047c92010d--

From java-user-return-44376-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 12:47:17 2010
Return-Path: <java-user-return-44376-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71012 invoked from network); 7 Jan 2010 12:47:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 12:47:17 -0000
Received: (qmail 24872 invoked by uid 500); 7 Jan 2010 12:47:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24817 invoked by uid 500); 7 Jan 2010 12:47:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24807 invoked by uid 99); 7 Jan 2010 12:47:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 12:47:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [140.203.201.100] (HELO mx1.nuigalway.ie) (140.203.201.100)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 12:47:06 +0000
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: AggBAJJmRUsKhJ0L/2dsb2JhbAAI0WWEMAQ
X-IronPort-AV: E=Sophos;i="4.49,235,1262563200"; 
   d="scan'208";a="123182174"
Received: from unknown (HELO EVS1.ac.nuigalway.ie) ([10.132.157.11])
  by mx1.nuigalway.ie with ESMTP; 07 Jan 2010 12:46:45 +0000
Received: from EVS1.ac.nuigalway.ie ([10.132.157.14]) by EVS1.ac.nuigalway.ie with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 7 Jan 2010 12:46:44 +0000
Received: from [192.168.0.11] ([10.132.157.22]) by EVS1.ac.nuigalway.ie over TLS secured channel with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 7 Jan 2010 12:46:44 +0000
Message-ID: <4B45D7A8.9010603@deri.org>
Date: Thu, 07 Jan 2010 13:46:32 +0100
From: Renaud Delbru <renaud.delbru@deri.org>
User-Agent: Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.8pre) Gecko/20091228 Lightning/1.0pre Shredder/3.0.1pre
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IndexingChain and TermHash
References: <4AF45CF0.2020105@deri.org>	 <9ac0c6aa0911061009r771021a3i55f849209353fa2c@mail.gmail.com>	 <4AF46C19.2090306@deri.org>	 <9ac0c6aa0911140522o31b05ff6idd6ec1ffd303b423@mail.gmail.com>	 <4B014579.9080807@deri.org> <9ac0c6aa0911160501k682c79gdb3be8111c4c6f9f@mail.gmail.com>
In-Reply-To: <9ac0c6aa0911160501k682c79gdb3be8111c4c6f9f@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-OriginalArrivalTime: 07 Jan 2010 12:46:44.0636 (UTC) FILETIME=[77CEDDC0:01CA8F97]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Michael,

I have started to look at the PFOR codec. However, when I include the 
codec files inside the flex_1458 branch, it misses the 
org.apache.lucene.util.pfor.PFor class which is the core of the codec. 
Where can I find this class ?

Thanks,
Regards
-- 
Renaud Delbru

On 16/11/09 14:01, Michael McCandless wrote:
> Yes, the branch is here:
>
>      https://svn.apache.org/repos/asf/lucene/java/branches/flex_1458
>
> Mark (Miller) periodically re-sync's it to trunk.
>
> All tests should pass, and if you create a new Codec, please share the
> experience!
>
> There are not yet many Codecs in existence... the branch has the
> "standard" codec (closest to Lucene's current index format, but makes
> some compelling improvements to the terms dict), a "pulsing" codec
> (which inlines low-freq terms into the terms dict), an intblock codec
> (an abstract base for building int-block codecs).  There's also the
> PForDelta codec, attached to LUCENE-1410, which subclasses the
> intblock codec and uses PForDelta encoding.  It's probably best to
> peek at these example codecs for inspiration on how to build yours.
>
> Mike
>
> On Mon, Nov 16, 2009 at 7:28 AM, Renaud Delbru<renaud.delbru@deri.org>  wrote:
>    
>> Hi Michael,
>>
>> I see there is already a huge amount of work already done in LUCENE-1458. Is
>> there a way to checkout the corresponding branch, and start to use it ? At
>> least, to see if I can extend it and create my own Codec.
>> I have started on my side to abstract the indexing chain of Lucene 2.9, in
>> order to be able to plug my own chain, but I have the impression that you've
>> done something similar already (with the codec abstraction). Would be a pity
>> to lose my time doing something less convenient that your appraoch.
>>
>> Thanks.
>> --
>> Renaud Delbru
>>
>> On 14/11/09 13:22, Michael McCandless wrote:
>>      
>>> On Fri, Nov 6, 2009 at 1:34 PM, Renaud Delbru<renaud.delbru@deri.org>
>>>   wrote:
>>>
>>>        
>>>> Hi Michael,
>>>>
>>>> Thanks for the quick fix. I have tested it (indexing multiple documents +
>>>> searching), and it seems to work.
>>>>
>>>> On 06/11/09 18:09, Michael McCandless wrote:
>>>>
>>>>          
>>>>> To be honest, you are sort of forging new territory here :)
>>>>>
>>>>>
>>>>>            
>>>> I think so too, not an easy task ;o). I have seen that you have tried to
>>>> make modular the indexing chain of Lucene (DocumentsWriter). I still try
>>>> to
>>>> have a good understanding of the default indexing, but I would like to
>>>> see
>>>> how it is easy (or difficult) to modify the format of the postings. From
>>>> my
>>>> current understanding, it seems that only the consumer at the end of this
>>>> chain (FreqProxTermsWriter and its consumer FormatPostingsFieldsWriter)
>>>> has
>>>> to be changed to a certain extend.
>>>>
>>>>          
>>> Right, those two classes do the writing of the postings, currently.
>>>
>>> But with flexible indexing (LUCENE-1458), still in progress, we hope
>>> to make it more easily pluggable, the codec that actually reads&
>>> writes the postings.
>>>
>>> Mike
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>        
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>      
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>    


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44377-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 12:57:18 2010
Return-Path: <java-user-return-44377-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72588 invoked from network); 7 Jan 2010 12:57:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 12:57:18 -0000
Received: (qmail 39810 invoked by uid 500); 7 Jan 2010 12:57:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39728 invoked by uid 500); 7 Jan 2010 12:57:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39718 invoked by uid 99); 7 Jan 2010 12:57:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 12:57:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 12:57:08 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NSrux-00063t-LH
	for java-user@lucene.apache.org; Thu, 07 Jan 2010 04:56:47 -0800
Message-ID: <27059555.post@talk.nabble.com>
Date: Thu, 7 Jan 2010 04:56:47 -0800 (PST)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is there a way to limit the size of an index?
In-Reply-To: <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: barak.yaish@gmail.com
References: <27056573.post@talk.nabble.com> <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com> <27058014.post@talk.nabble.com> <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>


Yep, this seems to work :-) Thanks!

The other way of Directory custom implementation seems interesting, and I
would like try it (at least as an oppurtunity to know Lucene better) - is
there a simple guide describing how to that? Perhaps some other similar
Directory implementations?


Michael McCandless-2 wrote:
>=20
> Is the creation of the index in your control?  If so, try something like
> this:
>=20
>   ((LogByteSizeMergePolicy) writer.getMergePolicy()).setMaxMergeMB(1.0));
>=20
> (NOTE: not tested).  This works because [currently]
> LogByteSizeMergePolicy is the default for IndexWriter.  Would be safer
> to create your own LogByteSizeMergePolicy and set it on the writer...
>=20
> This tells the IndexWriter NOT to merge any segment that's over 1.0 MB
> in size.  With a default merge factor of 10, this should "generally"
> mean you don't get a segment over 10MB, though it may not be a hard
> guarantee (you can lower the 1.0 if you still see a segment over 10
> MB).
>=20
> Implementing a custom directory that splits files @ 10 MB is also
> possible, but is a good amount more work.  You'd have to have your
> IndexOutput write to the separate 10 MB sized files, then make an
> IndexInput that "pretends" they are one file.
>=20
> Mike
>=20
> On Thu, Jan 7, 2010 at 6:24 AM, Dvora <barak.yaish@gmail.com> wrote:
>>
>> Thanks for the reply.
>>
>> Can you please add some detailed explanations? I'm trying to upload
>> Lucene
>> index to Google App Engine, and the files size must not exceed 10MB.
>>
>>
>>
>> Michael McCandless-2 wrote:
>>>
>>> I don't think this is implemented [yet] today. =C2=A0You'd have to
>>> implement the Directory, IndexInput and IndexOutput classes, to make
>>> this work.
>>>
>>
>> --
>> View this message in context:
>> http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27=
056573p27058014.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/Is-there-a-way-to-limit=
-the-size-of-an-index--tp27056573p27059555.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44378-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 13:37:44 2010
Return-Path: <java-user-return-44378-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86362 invoked from network); 7 Jan 2010 13:37:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 13:37:44 -0000
Received: (qmail 89192 invoked by uid 500); 7 Jan 2010 13:37:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89113 invoked by uid 500); 7 Jan 2010 13:37:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89103 invoked by uid 99); 7 Jan 2010 13:37:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 13:37:42 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 13:37:35 +0000
Received: by ey-out-2122.google.com with SMTP id 9so3718080eyd.3
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 05:37:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=X8HgMhDxSM4I7pPC1zKwghXXiv4D7siZmkxKONjUQ3g=;
        b=ZzJQSBMEwCVR2TCKktfR0KZL0q4UycqyWFsa3S6LZu6PuGvom9HbzKPzNfct0yJlJ6
         x/qVr5/NkpLp27HlzhrE1EP+VTR/505OBFA3VUOEAA7DePg0VHSp3OUxNu8wcRE9Jt3w
         2/wiwCcI7xa6ApSHEYLufLru4G8rVqtUkNauE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=LihP4AFIB+0mxZX1cnbrNWcKadB8q2cl9URnYzdjN9msEW3PI9Jy1YugRpGAbjLFY2
         oE4nvrFVv1Zz9vfVO5btOsmznrUceV3HmWRkR5S7zorkVkzHLRrAoN8EOE5U8TN9a/sS
         6e455xRzsHrxpSW4lZ1LIVX/RlvzmSpuBy1ko=
MIME-Version: 1.0
Received: by 10.216.87.80 with SMTP id x58mr1975139wee.92.1262871434445; Thu, 
	07 Jan 2010 05:37:14 -0800 (PST)
In-Reply-To: <643aa4871001070413x7629dc2ao5661a18880fcadc4@mail.gmail.com>
References: <643aa4871001070413x7629dc2ao5661a18880fcadc4@mail.gmail.com>
Date: Thu, 7 Jan 2010 08:37:14 -0500
Message-ID: <359a92831001070537o205957e7nd3d14a0797f5d4ab@mail.gmail.com>
Subject: Re: Problems with IndexWriter#commit() on Linux
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d624693f44a5047c932b81

--0016e6d624693f44a5047c932b81
Content-Type: text/plain; charset=ISO-8859-1

Several questions:
1> are the index files larger after you kill your process?
    Or have the timestamps changed?
2> are you absolutely sure that your indexer, when you
     add documents, is pointing at the same directory your
     search is pointing to?
3> Have you gotten a copy of Luke and examined your index
     to see if, perhaps, your documents aren't being added the
     way you think they are?

Erick

On Thu, Jan 7, 2010 at 7:13 AM, Naama Kraus <naamakraus@gmail.com> wrote:

> Hi,
>
> I am using IndexWriter#commit() methods in my program to commit document
> additions to the index. I do that once in a while, after a bunch of
> documents were added. Since my indexing process is long, I want to make
> sure
> I don't loose too many additions in case of a crash.
> When running on Windows, things work as expected. But when running my code
> on Linux, seems like commit() has no effect. If I kill my program and then
> restart it, I don't see documents that I added and then committed (they are
> not returned by a search operation).
> I am running Lucene 3.0.0
>
> Can anyone help ?
>
> Thanks, Naama
>
> --
> "If you want your children to be intelligent, read them fairy tales. If you
> want them to be more intelligent, read them more fairy tales."
> "What really interests me is whether God had any choice in the creation of
> the world."
> (Albert Einstein)
>

--0016e6d624693f44a5047c932b81--

From java-user-return-44379-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 13:42:16 2010
Return-Path: <java-user-return-44379-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88689 invoked from network); 7 Jan 2010 13:42:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 13:42:15 -0000
Received: (qmail 93361 invoked by uid 500); 7 Jan 2010 13:42:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93277 invoked by uid 500); 7 Jan 2010 13:42:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93267 invoked by uid 99); 7 Jan 2010 13:42:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 13:42:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 13:42:06 +0000
Received: by yxe3 with SMTP id 3so16923300yxe.20
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 05:41:45 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.9.39 with SMTP id 39mr1273144ybi.35.1262871705538; Thu, 07 
	Jan 2010 05:41:45 -0800 (PST)
In-Reply-To: <27059555.post@talk.nabble.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27059555.post@talk.nabble.com>
Date: Thu, 7 Jan 2010 08:41:45 -0500
Message-ID: <9ac0c6aa1001070541q55856b15h8152688463d72091@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Thu, Jan 7, 2010 at 7:56 AM, Dvora <barak.yaish@gmail.com> wrote:

> Yep, this seems to work :-) Thanks!

Super!

> The other way of Directory custom implementation seems interesting, and I
> would like try it (at least as an oppurtunity to know Lucene better) - is
> there a simple guide describing how to that? Perhaps some other similar
> Directory implementations?

I would start by looking @ FSDirectory/SimpleFSDirectory's source
code.  They are simple wrappers around the corresponding java io APIs.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44380-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 13:44:16 2010
Return-Path: <java-user-return-44380-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89516 invoked from network); 7 Jan 2010 13:44:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 13:44:16 -0000
Received: (qmail 632 invoked by uid 500); 7 Jan 2010 13:44:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 555 invoked by uid 500); 7 Jan 2010 13:44:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 545 invoked by uid 99); 7 Jan 2010 13:44:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 13:44:13 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 13:44:05 +0000
Received: by ywh14 with SMTP id 14so17099272ywh.20
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 05:43:44 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.89.40 with SMTP id r40mr32241196ybl.157.1262871823225; 
	Thu, 07 Jan 2010 05:43:43 -0800 (PST)
In-Reply-To: <4B45D7A8.9010603@deri.org>
References: <4AF45CF0.2020105@deri.org>
	 <9ac0c6aa0911061009r771021a3i55f849209353fa2c@mail.gmail.com>
	 <4AF46C19.2090306@deri.org>
	 <9ac0c6aa0911140522o31b05ff6idd6ec1ffd303b423@mail.gmail.com>
	 <4B014579.9080807@deri.org>
	 <9ac0c6aa0911160501k682c79gdb3be8111c4c6f9f@mail.gmail.com>
	 <4B45D7A8.9010603@deri.org>
Date: Thu, 7 Jan 2010 08:43:41 -0500
Message-ID: <9ac0c6aa1001070543s48ada8f4rdad4899e79aa316c@mail.gmail.com>
Subject: Re: IndexingChain and TermHash
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

LUCENE-1410 has the PFor impl, that the PFor codec needs.

Mike

On Thu, Jan 7, 2010 at 7:46 AM, Renaud Delbru <renaud.delbru@deri.org> wrot=
e:
> Hi Michael,
>
> I have started to look at the PFOR codec. However, when I include the cod=
ec
> files inside the flex_1458 branch, it misses the
> org.apache.lucene.util.pfor.PFor class which is the core of the codec. Wh=
ere
> can I find this class ?
>
> Thanks,
> Regards
> --
> Renaud Delbru
>
> On 16/11/09 14:01, Michael McCandless wrote:
>>
>> Yes, the branch is here:
>>
>> =A0 =A0 https://svn.apache.org/repos/asf/lucene/java/branches/flex_1458
>>
>> Mark (Miller) periodically re-sync's it to trunk.
>>
>> All tests should pass, and if you create a new Codec, please share the
>> experience!
>>
>> There are not yet many Codecs in existence... the branch has the
>> "standard" codec (closest to Lucene's current index format, but makes
>> some compelling improvements to the terms dict), a "pulsing" codec
>> (which inlines low-freq terms into the terms dict), an intblock codec
>> (an abstract base for building int-block codecs). =A0There's also the
>> PForDelta codec, attached to LUCENE-1410, which subclasses the
>> intblock codec and uses PForDelta encoding. =A0It's probably best to
>> peek at these example codecs for inspiration on how to build yours.
>>
>> Mike
>>
>> On Mon, Nov 16, 2009 at 7:28 AM, Renaud Delbru<renaud.delbru@deri.org>
>> =A0wrote:
>>
>>>
>>> Hi Michael,
>>>
>>> I see there is already a huge amount of work already done in LUCENE-145=
8.
>>> Is
>>> there a way to checkout the corresponding branch, and start to use it ?
>>> At
>>> least, to see if I can extend it and create my own Codec.
>>> I have started on my side to abstract the indexing chain of Lucene 2.9,
>>> in
>>> order to be able to plug my own chain, but I have the impression that
>>> you've
>>> done something similar already (with the codec abstraction). Would be a
>>> pity
>>> to lose my time doing something less convenient that your appraoch.
>>>
>>> Thanks.
>>> --
>>> Renaud Delbru
>>>
>>> On 14/11/09 13:22, Michael McCandless wrote:
>>>
>>>>
>>>> On Fri, Nov 6, 2009 at 1:34 PM, Renaud Delbru<renaud.delbru@deri.org>
>>>> =A0wrote:
>>>>
>>>>
>>>>>
>>>>> Hi Michael,
>>>>>
>>>>> Thanks for the quick fix. I have tested it (indexing multiple documen=
ts
>>>>> +
>>>>> searching), and it seems to work.
>>>>>
>>>>> On 06/11/09 18:09, Michael McCandless wrote:
>>>>>
>>>>>
>>>>>>
>>>>>> To be honest, you are sort of forging new territory here :)
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>> I think so too, not an easy task ;o). I have seen that you have tried
>>>>> to
>>>>> make modular the indexing chain of Lucene (DocumentsWriter). I still
>>>>> try
>>>>> to
>>>>> have a good understanding of the default indexing, but I would like t=
o
>>>>> see
>>>>> how it is easy (or difficult) to modify the format of the postings.
>>>>> From
>>>>> my
>>>>> current understanding, it seems that only the consumer at the end of
>>>>> this
>>>>> chain (FreqProxTermsWriter and its consumer FormatPostingsFieldsWrite=
r)
>>>>> has
>>>>> to be changed to a certain extend.
>>>>>
>>>>>
>>>>
>>>> Right, those two classes do the writing of the postings, currently.
>>>>
>>>> But with flexible indexing (LUCENE-1458), still in progress, we hope
>>>> to make it more easily pluggable, the codec that actually reads&
>>>> writes the postings.
>>>>
>>>> Mike
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44381-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 15:13:36 2010
Return-Path: <java-user-return-44381-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25132 invoked from network); 7 Jan 2010 15:13:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 15:13:36 -0000
Received: (qmail 25899 invoked by uid 500); 7 Jan 2010 15:13:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25837 invoked by uid 500); 7 Jan 2010 15:13:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25827 invoked by uid 99); 7 Jan 2010 15:13:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 15:13:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 15:13:25 +0000
Received: by qyk41 with SMTP id 41so8480870qyk.29
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 07:13:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :content-type:content-transfer-encoding:mime-version:subject:date
         :x-mailer;
        bh=L8KwyoApAF5mPckogN0FvSn2jm6K1eFAVZLzrcUw5LQ=;
        b=SG50Op6QS867QmSdWe/eiYN0B6uoO4xbI8hpGIH1G/W5MpsUn5DP0u+SmVhpME4F0n
         u5WRiiNVGzqZjmBKJp9+hG6J99YJoSixWSccPC9CmNarm4Pn+iG1rZ1TltGB6k6KkNA9
         aVCM9JGXlk71DIWjd0eKFPhVOTjOUrPRmtAi8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:content-type:content-transfer-encoding
         :mime-version:subject:date:x-mailer;
        b=B1vStnqg8ZZcm9MF8arBgpHDxTkCvA1lH/au6Sg6b8aPzvCwofeLJwn49MWQCkipos
         7B9Kp45M+FfD0p9L/porzQzfvdQKKPV5SGO1QI+5NPS0tLi9t/R7p1P3C//8Ta+yVTjI
         RWcac1WdLuOIlX9h2C9cVlY4mSpXWqYK9gHRY=
Received: by 10.224.78.23 with SMTP id i23mr886837qak.321.1262877183131;
        Thu, 07 Jan 2010 07:13:03 -0800 (PST)
Received: from ?192.168.1.7? ([66.92.161.165])
        by mx.google.com with ESMTPS id 8sm13558276qwj.13.2010.01.07.07.13.01
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 07 Jan 2010 07:13:02 -0800 (PST)
Message-Id: <58B5F7E8-F5D1-47EB-B1F8-864ABFC27DFA@gmail.com>
From: Ryan McKinley <ryantxu@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: R-Tree in lucene thoughts?
Date: Thu, 7 Jan 2010 10:13:00 -0500
X-Mailer: Apple Mail (2.936)

I'm getting back into the spatial search stuff and wanted to get some  
feedback before starting down any path...

I'm building an app, where I need R-tree like functionality -- that is  
search for all items within some extent / that touch some extent.  If  
anyone has ideas for how this could map to tokens, that would be  
great... but i don't know of anything yet.

Currently, I index an extent as "XMin XMax YMin YMax", then have a  
custom filter that loads an in memory R-Tree for each Reader from the  
FieldCache.  This works great, but the memory requirements get big as  
the number of documents gets large.  Also it takes a while to warm up.

With the new flexible indexing stuff, would it be possible to natively  
write an rtree to disk in the index process?  Somehow using the lucene  
doc id?  Alternatively, I can look at writing the spatial index to  
some other format (perhaps http://hatbox.sourceforge.net/) and then  
try to keep lucene doc ids in sync with application ids.

Any thoughts on what may be possible?

It looks like Lucy has considered something similar:
http://www.lucidimagination.com/search/document/75ac07b7e2d6160d/pluggable_indexreader_was_real_time_updates


thanks
ryan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44382-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 15:42:25 2010
Return-Path: <java-user-return-44382-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31488 invoked from network); 7 Jan 2010 15:42:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 15:42:25 -0000
Received: (qmail 62614 invoked by uid 500); 7 Jan 2010 15:42:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62541 invoked by uid 500); 7 Jan 2010 15:42:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62531 invoked by uid 99); 7 Jan 2010 15:42:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 15:42:22 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of naamakraus@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 15:42:14 +0000
Received: by pwi11 with SMTP id 11so8227927pwi.5
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 07:41:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=Y0ppOm8ekIgMpHyw/kDQfKbsxYM75TG0b1zgBSdCk74=;
        b=HUNJK40Ie1uNnbgXDovjg+nd4gto7EVAE6xOkUBcG9CTqcokGqs95v7VrKOXLZwf20
         VHLJRHBLO62HQZZ/LjJC+9Wit0T2/7s7N8DtkdvTmIpcsz/ow6fp4RTXzb4dBW96dEQW
         tPVD2Qxmua8/sPLfE1l82anivD6tgNgIqIoLQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=vNhuCMwG7+haFSRR8aFeezh2ed2OZX0WCVVbJuMTjQX54++eCXheIJbxRxdchVeFsq
         y906aBuvxMprCd8fFKR9KAihiQd4Wxw2qGN0ZkgkPBCIaMRVcvvCd4OL0Pk0BRFx3pn9
         JymgJh9zxsdA1ivQVQw5qX9YLeBbeWS3n4Nt4=
MIME-Version: 1.0
Received: by 10.141.101.2 with SMTP id d2mr3064704rvm.122.1262878913137; Thu, 
	07 Jan 2010 07:41:53 -0800 (PST)
In-Reply-To: <359a92831001070537o205957e7nd3d14a0797f5d4ab@mail.gmail.com>
References: <643aa4871001070413x7629dc2ao5661a18880fcadc4@mail.gmail.com> 
	<359a92831001070537o205957e7nd3d14a0797f5d4ab@mail.gmail.com>
From: Naama Kraus <naamakraus@gmail.com>
Date: Thu, 7 Jan 2010 17:41:33 +0200
Message-ID: <643aa4871001070741t13a8a24coa4a92057bd4e27a7@mail.gmail.com>
Subject: Re: Problems with IndexWriter#commit() on Linux
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd13922030d58047c94e95d
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd13922030d58047c94e95d
Content-Type: text/plain; charset=ISO-8859-1

Thanks dor the input.

1. While the process is running, I do see the index files growing on disk
and the time stamps changing. Should I see a change in size right after
killing the process, is that what you mean ?
2. Yes, same directory is being used for indexing and search.
3. Didn't try Luke, good idea. Though I wonder, the same code runs well on
Windows.

Naama

On Thu, Jan 7, 2010 at 3:37 PM, Erick Erickson <erickerickson@gmail.com>wrote:

> Several questions:
> 1> are the index files larger after you kill your process?
>    Or have the timestamps changed?
> 2> are you absolutely sure that your indexer, when you
>     add documents, is pointing at the same directory your
>     search is pointing to?
> 3> Have you gotten a copy of Luke and examined your index
>     to see if, perhaps, your documents aren't being added the
>     way you think they are?
>
> Erick
>
> On Thu, Jan 7, 2010 at 7:13 AM, Naama Kraus <naamakraus@gmail.com> wrote:
>
> > Hi,
> >
> > I am using IndexWriter#commit() methods in my program to commit document
> > additions to the index. I do that once in a while, after a bunch of
> > documents were added. Since my indexing process is long, I want to make
> > sure
> > I don't loose too many additions in case of a crash.
> > When running on Windows, things work as expected. But when running my
> code
> > on Linux, seems like commit() has no effect. If I kill my program and
> then
> > restart it, I don't see documents that I added and then committed (they
> are
> > not returned by a search operation).
> > I am running Lucene 3.0.0
> >
> > Can anyone help ?
> >
> > Thanks, Naama
> >
> > --
> > "If you want your children to be intelligent, read them fairy tales. If
> you
> > want them to be more intelligent, read them more fairy tales."
> > "What really interests me is whether God had any choice in the creation
> of
> > the world."
> > (Albert Einstein)
> >
>



-- 
"If you want your children to be intelligent, read them fairy tales. If you
want them to be more intelligent, read them more fairy tales."
"What really interests me is whether God had any choice in the creation of
the world."
(Albert Einstein)

--000e0cd13922030d58047c94e95d--

From java-user-return-44383-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:05:08 2010
Return-Path: <java-user-return-44383-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38591 invoked from network); 7 Jan 2010 16:05:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:05:08 -0000
Received: (qmail 92325 invoked by uid 500); 7 Jan 2010 16:05:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92283 invoked by uid 500); 7 Jan 2010 16:05:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92222 invoked by uid 99); 7 Jan 2010 16:05:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:05:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:04:55 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NSuqh-0006tb-5P
	for java-user@lucene.apache.org; Thu, 07 Jan 2010 08:04:35 -0800
Message-ID: <27062291.post@talk.nabble.com>
Date: Thu, 7 Jan 2010 08:04:35 -0800 (PST)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is there a way to limit the size of an index?
In-Reply-To: <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
References: <27056573.post@talk.nabble.com> <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com> <27058014.post@talk.nabble.com> <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Can you explain how the combination of merge factor and max merge size
control the size of files?

For example, if one would like to limit the files size to 3,4 or 7MB - how
these parameters values can be predicted?



Michael McCandless-2 wrote:
> 
> 
> This tells the IndexWriter NOT to merge any segment that's over 1.0 MB
> in size.  With a default merge factor of 10, this should "generally"
> mean you don't get a segment over 10MB, though it may not be a hard
> guarantee (you can lower the 1.0 if you still see a segment over 10
> MB).
> 
> 

-- 
View this message in context: http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27062291.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44384-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:23:40 2010
Return-Path: <java-user-return-44384-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43586 invoked from network); 7 Jan 2010 16:23:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:23:40 -0000
Received: (qmail 26018 invoked by uid 500); 7 Jan 2010 16:23:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25949 invoked by uid 500); 7 Jan 2010 16:23:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25939 invoked by uid 99); 7 Jan 2010 16:23:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:23:38 +0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.146.193.99] (HELO mx.billiger.de) (62.146.193.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:23:30 +0000
Received: from solute-exc2k7.solute.ka (norad.solute-gmbh.de [145.253.139.66])
	by mx.billiger.de (Postfix) with ESMTPS id 3F70A812A37
	for <java-user@lucene.apache.org>; Thu,  7 Jan 2010 17:23:11 +0100 (CET)
Received: from solute-exc2k7.solute.ka ([10.1.1.3]) by solute-exc2k7.solute.ka
 ([10.1.1.3]) with mapi; Thu, 7 Jan 2010 17:23:09 +0100
From: Yuliya Palchaninava <yp@solute.de>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 7 Jan 2010 17:23:08 +0100
Subject: Lucene 2.9 and 3.0: Optimized index is thrice as large as the not
 optimized index
Thread-Topic: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not optimized index
Thread-Index: AcqPtbLNobRvWrIBSuKC0oVqpuAhiw==
Message-ID: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
Accept-Language: en-US, de-DE
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, de-DE
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi,

According to the api documentation: "In general, once the optimize complete=
s, the total size of the index will be less than the size of the starting i=
ndex. It could be quite a bit smaller (if there were many pending deletes) =
or just slightly smaller". In our case the index becomes not smaller but la=
rger, namely thrice as large.=20

The not optimized index doesn't contain compressed fields, what could have =
caused the growth of the index due to the otimization. So we cannot explain=
 what happens.

Does someone have an explanation for the index growth due to the optimizati=
on?

Thanks,
Yuliya


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44385-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:35:41 2010
Return-Path: <java-user-return-44385-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46404 invoked from network); 7 Jan 2010 16:35:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:35:41 -0000
Received: (qmail 51022 invoked by uid 500); 7 Jan 2010 16:35:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50956 invoked by uid 500); 7 Jan 2010 16:35:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50946 invoked by uid 99); 7 Jan 2010 16:35:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:35:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.59] (HELO web50305.mail.re2.yahoo.com) (206.190.38.59)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 07 Jan 2010 16:35:28 +0000
Received: (qmail 68203 invoked by uid 60001); 7 Jan 2010 16:35:07 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262882106; bh=HfD3jnIIG5Ub4+yYIPuTRgC3rEAaORCWZ3M0TItp/7c=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=Tuzlb2vSG8YQf0Cnoe5BFirO9a/6cNXgPUhuL8d4/CZLvnb8OZu/rj50lxeK9781sWoiHKagxRttnmMOool55TEbGm4YYfhQvaFPc7sHAz+VI4WJAV7RgahPGW2g4UAu+hTT+S8MvJtt9eO7WxrVpQPM34/fpHpbcrBMF26xVbM=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=oOqlmZ5Ap/5zhOKlwbWBHv/hzGcsRp+uQrARv5T8y7XIzp7vS6qlIUObpVf/i1KEE2nnb20g7z5VtVCeuDAsxDMDoupv4KN3Ec8Bl+wtiKt8FkbFih16G4KuCzdIjjSTKgWqdlyXyqN4Ylk8vbql77SLDOTe7xGbUaA5gyYmwQ0=;
Message-ID: <943192.67571.qm@web50305.mail.re2.yahoo.com>
X-YMail-OSG: GsTwjEoVM1mhefKMh.XxQbnp1lsHmMxyic3l3tQ5x6L2_qWAX2c9fOHL0JjOZN7kK7IkVTO.xX7XPMhjS7GZulh7js80v2HmblxarpUcy.13diSzXRZ7FMS5yZprkCY7eEo19pBRZmN.0y0VzukZ06fH.lApD5h8THezoElsMXuKqEFT6.MrcOtsjMJSUQivtaTuhbqPtbD01a8X.XDPjaIQy02y..FoR4ET8mQKygpe.I0woWGx3K64C1WIzF3FtvCSrnQk_btDl_I5CpKS.XTyQpWQ89tdHp27RmHlgFsqJTQGDUjyfXu8iGWAIXw84veFtfU7pAyweSKqi9tP.787Ps2dL1BaWAQ9ddlxdwQKGSQyZPisxLilncDjy8YWLgWEXmNx07Ew6OlTc5UEiqCMeFAgVsNgwYSuFepxzNWEpeL.qQct
Received: from [167.206.188.3] by web50305.mail.re2.yahoo.com via HTTP; Thu, 07 Jan 2010 08:35:06 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
Date: Thu, 7 Jan 2010 08:35:06 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Lucene 2.9 and 3.0: Optimized index is thrice as large as the not optimized index
To: java-user@lucene.apache.org
In-Reply-To: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Yuliya,

The index *directory* will be larger *while* you are optimizing.  After the optimization is completed successfully, the index directory will be smaller.  It is possible that your index directory is large(r) because you have some left-over segments (e.g. from some earlier failed/interrupted optimizations) that are not really a part of the index.  After optimizing, you should have only 1 segment, so if you see more than 1 segment, look at the ones with older timestamps.  Those can be (re)moved.

 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Yuliya Palchaninava <yp@solute.de>
> To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
> Sent: Thu, January 7, 2010 11:23:08 AM
> Subject: Lucene 2.9 and 3.0: Optimized index is thrice as large as the not optimized index
> 
> Hi,
> 
> According to the api documentation: "In general, once the optimize completes, 
> the total size of the index will be less than the size of the starting index. It 
> could be quite a bit smaller (if there were many pending deletes) or just 
> slightly smaller". In our case the index becomes not smaller but larger, namely 
> thrice as large. 
> 
> The not optimized index doesn't contain compressed fields, what could have 
> caused the growth of the index due to the otimization. So we cannot explain what 
> happens.
> 
> Does someone have an explanation for the index growth due to the optimization?
> 
> Thanks,
> Yuliya
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44386-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:36:14 2010
Return-Path: <java-user-return-44386-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46542 invoked from network); 7 Jan 2010 16:36:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:36:13 -0000
Received: (qmail 52958 invoked by uid 500); 7 Jan 2010 16:36:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52886 invoked by uid 500); 7 Jan 2010 16:36:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52876 invoked by uid 99); 7 Jan 2010 16:36:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:36:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:36:02 +0000
Received: by fxm2 with SMTP id 2so16257068fxm.5
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 08:35:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=P3oLpfuH08UthHHasRayJevaOtUQZ6JvLFqD/XlInVU=;
        b=vKWqXTmWZ5v0ab/T3b9WviMGifjddSgb/vPVeUcgj42H97iRanqY74dj/IW1rI39uW
         gGwedcqflbVMIUljeOWOBt1T3QhLwI933ml/gdcvJv4VP9eo+5rzuhOK8PaKrFoMfubs
         5onjckkBVvFOiF2rnkQy6AySj7WE3BNNDk2XA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=XGOaXckWHsaslan2JwW5f1aZ4yxw/qmTbsjfeF5VO0xe5OCwRViXWXRu0NOBukY2P3
         0tb51e0DRieKSbMudxeWKt+sgiRaVeFFlPB0//gTWJWPkw/bojrqsPcIoXgTJ3wFJFhv
         bbSPvPHTKxCVSVmYGSXR/uv8BO/jgkC5HkkCY=
MIME-Version: 1.0
Received: by 10.239.192.81 with SMTP id d17mr522788hbi.16.1262882140505; Thu, 
	07 Jan 2010 08:35:40 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
Date: Thu, 7 Jan 2010 17:35:40 +0100
Message-ID: <f18c9dde1001070835x4122aa84r16d8eca3da06e6fd@mail.gmail.com>
Subject: Re: Lucene 2.9 and 3.0: Optimized index is thrice as large as the not 
	optimized index
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Do you have a reader open on the index which was opened before your
your index was optimized? Maybe there is a reader around holding on
the references to the merged segments.

simon

On Thu, Jan 7, 2010 at 5:23 PM, Yuliya Palchaninava <yp@solute.de> wrote:
> Hi,
>
> According to the api documentation: "In general, once the optimize comple=
tes, the total size of the index will be less than the size of the starting=
 index. It could be quite a bit smaller (if there were many pending deletes=
) or just slightly smaller". In our case the index becomes not smaller but =
larger, namely thrice as large.
>
> The not optimized index doesn't contain compressed fields, what could hav=
e caused the growth of the index due to the otimization. So we cannot expla=
in what happens.
>
> Does someone have an explanation for the index growth due to the optimiza=
tion?
>
> Thanks,
> Yuliya
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44387-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:43:55 2010
Return-Path: <java-user-return-44387-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49053 invoked from network); 7 Jan 2010 16:43:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:43:55 -0000
Received: (qmail 70901 invoked by uid 500); 7 Jan 2010 16:43:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70846 invoked by uid 500); 7 Jan 2010 16:43:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70836 invoked by uid 99); 7 Jan 2010 16:43:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:43:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.59] (HELO web50305.mail.re2.yahoo.com) (206.190.38.59)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 07 Jan 2010 16:43:42 +0000
Received: (qmail 72264 invoked by uid 60001); 7 Jan 2010 16:43:22 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262882601; bh=vYk/k9qiG6RAb80o3T3xFRgQzJ2GXgVRzataFUwRFIA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=C0488ALb6dr3gXuCCUP9R4K38jez2OnHFanDzAgT5gIDW8nf5o3cYfJldFL+H86TnMsqueopH1EcFSjwvKTroCHD9A7awFcfWIIs7E96yRm3wBD96KCHRr3V985EHRqM60Wuvn8kGfFAhM8MqP46tFxoC/raKRDYVsADk6HSiQA=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=y+emPyGK6dLAdF05XFecyrv0Ph+fj8RM5GCnkxjYWYXgJJr/P4849+MMYTCZi7DIhiCMArDMncNroO5fSJJe1d4fo2b1o8yjasO8jEmRVgGqxR9JgmrIlZXQceap8OEw0mwDTLW6/3bB1pO8XrWopJXgTfRDrTO+Uo6MmBNXN1I=;
Message-ID: <990723.71606.qm@web50305.mail.re2.yahoo.com>
X-YMail-OSG: J2CvVtgVM1lFNTwSv7MNbD9uqmWiYbPgAvcXKQgfC5TfSROIeZXqSCzRR6C44o4EAK2Ee53by3AXBEJVqFGnoXXar3lWbWGem0oM4EesJqZmBX5S5lC2Sh3f4ze8pge8jN24FtacYRPxrHCSkng9UvFzuBPrPQFb6a7vYm3Vsv__UdoYQPgsrReew2_KBYksu7bg9yA9uJeHNkZ.G8ARDMQl1CeALp.FyV5rw.g4C4AD6siRuGaeIMzXnJRKZ1G_Cht3lqcFKRmyXr3kzE1Y.Kmx3UKi_CX80U9MrmpGbCg290yp9hYGjBXiu_tEis57jn8lqgCgOj0h105uLTUEnC19_zn6LAgEL3lS3hgs15ALrhsN.7509hPR1_DDdK6WqDIaa2.Xcemy7uQDa.a7SdY.XKCRPeswQsBBeDfidMtHKQ9hE3iT9pTAbeXr9vJxl7T7IbCTRtEcY3Sbd0kcCM.GfNtffOUPNw6UMs.4btyP
Received: from [167.206.188.3] by web50305.mail.re2.yahoo.com via HTTP; Thu, 07 Jan 2010 08:43:21 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <4B433425.5090908@fastmail.fm>
Date: Thu, 7 Jan 2010 08:43:21 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Performance Results on changing the way fields are stored
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
In-Reply-To: <4B433425.5090908@fastmail.fm>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

You could try Avro instead of JSON/XML/Java Serialization.  It's compact (and new).

http://hadoop.apache.org/avro/

 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Paul Taylor <paul_t100@fastmail.fm>
> To: java-user@lucene.apache.org
> Sent: Tue, January 5, 2010 7:44:21 AM
> Subject: Performance Results on changing the way fields are stored
> 
> So currently in my index I index and store a number of small fields, I need both 
> so I can search on the fields, then I use the stored versions to generate the 
> output document (which is either an XML or JSON representation), because I read 
> stored and index fields are dealt with completely seperately I tried another 
> tact only storing one field which was a serialized version of the output 
> documentation. This solves a couple of issues I was having but I was 
> disappointed that both the size of the index increased and the index build  time 
> increased, I thought that if all the stored data was held in one field that the 
> resultant index would be smaller, and I didn't expect index time to increase by 
> as much as it did. I was also suprised that Java serilaization was slower and 
> used more space than both JSON and XML serialization.
> 
> Results as Follows
> 
> Type:                                                             Time : Index 
> Size
> Only indexed  no norms                                                          
>           105   : 38 MB
> Only indexed                                                                    
>                  111   : 43 MB
> Same fields written as Indexed and Stored  (current Situation)           115   : 
> 83 MB
> Fields Indexed, One JAXB classed Stored using JSON Marshalling 140   : 115 MB
> Fields Indexed, One JAXB classed Stored using XML Marshalling  189   : 198 MB
> Fields Indexed, One JAXB classed Stored using Java Serialization   305   : 485 
> MB
> 
> Are these results to be expected, could anybody suggest anything else I could do
> 
> 
> Paul
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44388-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:51:03 2010
Return-Path: <java-user-return-44388-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51517 invoked from network); 7 Jan 2010 16:51:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:51:03 -0000
Received: (qmail 83567 invoked by uid 500); 7 Jan 2010 16:51:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83499 invoked by uid 500); 7 Jan 2010 16:51:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83489 invoked by uid 99); 7 Jan 2010 16:51:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:51:01 +0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.146.193.99] (HELO mx.billiger.de) (62.146.193.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:50:52 +0000
Received: from solute-exc2k7.solute.ka (norad.solute-gmbh.de [145.253.139.66])
	by mx.billiger.de (Postfix) with ESMTPS id 47A428152D7
	for <java-user@lucene.apache.org>; Thu,  7 Jan 2010 17:50:33 +0100 (CET)
Received: from solute-exc2k7.solute.ka ([10.1.1.3]) by solute-exc2k7.solute.ka
 ([10.1.1.3]) with mapi; Thu, 7 Jan 2010 17:50:31 +0100
From: Yuliya Palchaninava <yp@solute.de>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 7 Jan 2010 17:50:29 +0100
Subject: AW: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not optimized index
Thread-Topic: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not optimized index
Thread-Index: AcqPt3PCF5rX1s0HTl2wRSWUFdBb6gAAShUg
Message-ID: <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
 <943192.67571.qm@web50305.mail.re2.yahoo.com>
In-Reply-To: <943192.67571.qm@web50305.mail.re2.yahoo.com>
Accept-Language: en-US, de-DE
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, de-DE
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Otis,

thanks for the answer.=20

Unfortunatelly the index *directory* remains larger *after" the optimizatio=
n.
In our case the otimization was/is completed successfully and, as you say,
there is only one segment in the directory.

Some other ideas?

Thanks,
Yuliya

> -----Urspr=FCngliche Nachricht-----
> Von: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]=20
> Gesendet: Donnerstag, 7. Januar 2010 17:35
> An: java-user@lucene.apache.org
> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice as=20
> large as the not optimized index
>=20
> Yuliya,
>=20
> The index *directory* will be larger *while* you are=20
> optimizing.  After the optimization is completed=20
> successfully, the index directory will be smaller.  It is=20
> possible that your index directory is large(r) because you=20
> have some left-over segments (e.g. from some earlier=20
> failed/interrupted optimizations) that are not really a part=20
> of the index.  After optimizing, you should have only 1=20
> segment, so if you see more than 1 segment, look at the ones=20
> with older timestamps.  Those can be (re)moved.
>=20
>  Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>=20
>=20
>=20
> ----- Original Message ----
> > From: Yuliya Palchaninava <yp@solute.de>
> > To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
> > Sent: Thu, January 7, 2010 11:23:08 AM
> > Subject: Lucene 2.9 and 3.0: Optimized index is thrice as=20
> large as the=20
> > not optimized index
> >=20
> > Hi,
> >=20
> > According to the api documentation: "In general, once the optimize=20
> > completes, the total size of the index will be less than=20
> the size of=20
> > the starting index. It could be quite a bit smaller (if there were=20
> > many pending deletes) or just slightly smaller". In our=20
> case the index=20
> > becomes not smaller but larger, namely thrice as large.
> >=20
> > The not optimized index doesn't contain compressed fields,=20
> what could=20
> > have caused the growth of the index due to the otimization. So we=20
> > cannot explain what happens.
> >=20
> > Does someone have an explanation for the index growth due=20
> to the optimization?
> >=20
> > Thanks,
> > Yuliya
> >=20
> >=20
> >=20
> ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
> =

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44389-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:51:44 2010
Return-Path: <java-user-return-44389-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51859 invoked from network); 7 Jan 2010 16:51:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:51:44 -0000
Received: (qmail 87629 invoked by uid 500); 7 Jan 2010 16:51:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87538 invoked by uid 500); 7 Jan 2010 16:51:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87528 invoked by uid 99); 7 Jan 2010 16:51:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:51:42 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:51:34 +0000
Received: by ey-out-2122.google.com with SMTP id 9so3764382eyd.3
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 08:51:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=7Ouj1qPZmw+dqAEotuSVm8pPb/YYwNLbVzeaVVQtc8k=;
        b=a4eT64DgChhMb1zJ8pI9TqHwsWuq0t3TO7WNAtBjsF0+kntt+TAOQfYU/VniFbPzXQ
         jZa4OsMhqpYxWMu/HdEPSRdmGcKJeewlAz1L3sRDKdvx9nG+INYdSdIKjg5N3mqdsnhW
         KI7CROUA1503U9kGr6Hb9UkM2PbWm2hawhP3o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=v8S/S8GI6ZnSOHajCCpmMDI9DSD7OGhx08xQZ9jkM9S0O52QwLciU+jl8/8A+Iu9b5
         0WCiiOV/v8h0IAzZ/Bdb2k+O6cF/jiILhqhMXv6+a9R810sRQfnBBthkpnNnWWonkyMm
         HmUojK0tiA1d7ygEQ7v6BG0Gbjd6uGssiP6Tg=
MIME-Version: 1.0
Received: by 10.216.87.80 with SMTP id x58mr2053057wee.92.1262883073560; Thu, 
	07 Jan 2010 08:51:13 -0800 (PST)
In-Reply-To: <643aa4871001070741t13a8a24coa4a92057bd4e27a7@mail.gmail.com>
References: <643aa4871001070413x7629dc2ao5661a18880fcadc4@mail.gmail.com>
	 <359a92831001070537o205957e7nd3d14a0797f5d4ab@mail.gmail.com>
	 <643aa4871001070741t13a8a24coa4a92057bd4e27a7@mail.gmail.com>
Date: Thu, 7 Jan 2010 11:51:13 -0500
Message-ID: <359a92831001070851s1c9c562fjf05925af1402fa3d@mail.gmail.com>
Subject: Re: Problems with IndexWriter#commit() on Linux
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d62469fe125f047c95e020
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d62469fe125f047c95e020
Content-Type: text/plain; charset=ISO-8859-1

Can you show us the code where you commit?

And how do you kill your process? Kill -9 is...er...harsh....

Yeah, I'm wondering whether the index file size *stays*
changed after you kill you process. If it keeps its
growing on every run (after you kill your process
multiple times), then I'd suspect that you aren't
adding documents like you think you are. Perhaps
different fields, different analyzers, etc.

Luke should show you the largest document by ID,
as well as document counts. Comparing changes
in the document count and the max doc ID should
tell you something...

Is it possible that you are updating existing docs
rather than adding new ones?

Best
Erick

On Thu, Jan 7, 2010 at 10:41 AM, Naama Kraus <naamakraus@gmail.com> wrote:

> Thanks dor the input.
>
> 1. While the process is running, I do see the index files growing on disk
> and the time stamps changing. Should I see a change in size right after
> killing the process, is that what you mean ?
> 2. Yes, same directory is being used for indexing and search.
> 3. Didn't try Luke, good idea. Though I wonder, the same code runs well on
> Windows.
>
> Naama
>
> On Thu, Jan 7, 2010 at 3:37 PM, Erick Erickson <erickerickson@gmail.com
> >wrote:
>
> > Several questions:
> > 1> are the index files larger after you kill your process?
> >    Or have the timestamps changed?
> > 2> are you absolutely sure that your indexer, when you
> >     add documents, is pointing at the same directory your
> >     search is pointing to?
> > 3> Have you gotten a copy of Luke and examined your index
> >     to see if, perhaps, your documents aren't being added the
> >     way you think they are?
> >
> > Erick
> >
> > On Thu, Jan 7, 2010 at 7:13 AM, Naama Kraus <naamakraus@gmail.com>
> wrote:
> >
> > > Hi,
> > >
> > > I am using IndexWriter#commit() methods in my program to commit
> document
> > > additions to the index. I do that once in a while, after a bunch of
> > > documents were added. Since my indexing process is long, I want to make
> > > sure
> > > I don't loose too many additions in case of a crash.
> > > When running on Windows, things work as expected. But when running my
> > code
> > > on Linux, seems like commit() has no effect. If I kill my program and
> > then
> > > restart it, I don't see documents that I added and then committed (they
> > are
> > > not returned by a search operation).
> > > I am running Lucene 3.0.0
> > >
> > > Can anyone help ?
> > >
> > > Thanks, Naama
> > >
> > > --
> > > "If you want your children to be intelligent, read them fairy tales. If
> > you
> > > want them to be more intelligent, read them more fairy tales."
> > > "What really interests me is whether God had any choice in the creation
> > of
> > > the world."
> > > (Albert Einstein)
> > >
> >
>
>
>
> --
> "If you want your children to be intelligent, read them fairy tales. If you
> want them to be more intelligent, read them more fairy tales."
> "What really interests me is whether God had any choice in the creation of
> the world."
> (Albert Einstein)
>

--0016e6d62469fe125f047c95e020--

From java-user-return-44390-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:53:15 2010
Return-Path: <java-user-return-44390-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52541 invoked from network); 7 Jan 2010 16:53:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:53:15 -0000
Received: (qmail 92326 invoked by uid 500); 7 Jan 2010 16:53:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92245 invoked by uid 500); 7 Jan 2010 16:53:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92234 invoked by uid 99); 7 Jan 2010 16:53:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:53:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.55] (HELO web50301.mail.re2.yahoo.com) (206.190.38.55)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 07 Jan 2010 16:53:02 +0000
Received: (qmail 91608 invoked by uid 60001); 7 Jan 2010 16:52:41 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262883161; bh=F2ER9jAoh8geaV31PLt+Xu0P66NjIypz4GteXa//YrM=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=vGzL/CzguPl9sYBz/fP5voZAPqwrDGmnzdq4/S4rR+Tm+MsKm2F7m2+HpfaeJN+AKKOjSxeXWGFIvMSrmsLDrH8Rg00D1lMCOR03KDnla8xorcC/jqEsa7aPdOg0S8FvWEFTOHcjXgelgpgN4hYjN3zgpkdYctzR0CsGRUhN4gM=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=NSt1cz2FsX8qpOHEYkxwSSQ/bRlUJAiJQ/3So5eCeq+1AojS1m8V2oY6xPqWPUDPRxthpkwM7VhEyCJMsY7sPB+LlQjErMQRRiBe3MYZQA+oeUARUFKMdrV+R5h363WMWmdkmslzYyHO0DdrkvwKJcMRqKN/Spdo1x8t0vBpFHw=;
Message-ID: <681888.91576.qm@web50301.mail.re2.yahoo.com>
X-YMail-OSG: htTsTpUVM1m8PRr7KdkXpaJDhTT4.bhZvrvbq98YZw6VCyL4i4hHPtZywjLpeCpN6Dr.Lt6_dwWZ2kIorxK_LCy_P2M7PTCL1ClTFKAAEN9DraCSQLCIJnIkxuvDklp85H99s6mPNXdBIcMTHoSPDl9MTGsXPla2yGGBSGOGv7KwPv4gGcMziz0_TH0tWAGtPM18.0BLpQXcDg6xlC72qDipgE7jC8U8QAH6EQ.VfsPSSlVPkqRwREUqqJhcuKSiHRHu6pPul8JIocgj_XrTweygDe2BBuDRdDugYGE97T5G0Nfhj0m8p2d8UbviPPg6T9TTtClrD_SUH7qifQltYHu3KLV7CFWDDSQx.iW9iiaOtosWHNncW2_UHhPT7N.tSxvScGROPtU54A0NiWzZcfdmZaVvSvfrUt5MG3apODkieWmO5FaT
Received: from [167.206.188.3] by web50301.mail.re2.yahoo.com via HTTP; Thu, 07 Jan 2010 08:52:41 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka> <943192.67571.qm@web50305.mail.re2.yahoo.com> <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
Date: Thu, 7 Jan 2010 08:52:41 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: AW: Lucene 2.9 and 3.0: Optimized index is thrice as large as the not optimized index
To: java-user@lucene.apache.org
In-Reply-To: <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Maybe you can paste a directory listing before optimization and after optim=
ization?=0A=0A Otis=0A--=0ASematext -- http://sematext.com/ -- Solr - Lucen=
e - Nutch=0A=0A=0A=0A----- Original Message ----=0A> From: Yuliya Palchanin=
ava <yp@solute.de>=0A> To: "java-user@lucene.apache.org" <java-user@lucene.=
apache.org>=0A> Sent: Thu, January 7, 2010 11:50:29 AM=0A> Subject: AW: Luc=
ene 2.9 and 3.0: Optimized index is thrice as large as the not optimized in=
dex=0A> =0A> Otis,=0A> =0A> thanks for the answer. =0A> =0A> Unfortunatelly=
 the index *directory* remains larger *after" the optimization.=0A> In our =
case the otimization was/is completed successfully and, as you say,=0A> the=
re is only one segment in the directory.=0A> =0A> Some other ideas?=0A> =0A=
> Thanks,=0A> Yuliya=0A> =0A> > -----Urspr=FCngliche Nachricht-----=0A> > V=
on: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com] =0A> > Gesendet: D=
onnerstag, 7. Januar 2010 17:35=0A> > An: java-user@lucene.apache.org=0A> >=
 Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice as =0A> > large=
 as the not optimized index=0A> > =0A> > Yuliya,=0A> > =0A> > The index *di=
rectory* will be larger *while* you are =0A> > optimizing.  After the optim=
ization is completed =0A> > successfully, the index directory will be small=
er.  It is =0A> > possible that your index directory is large(r) because yo=
u =0A> > have some left-over segments (e.g. from some earlier =0A> > failed=
/interrupted optimizations) that are not really a part =0A> > of the index.=
  After optimizing, you should have only 1 =0A> > segment, so if you see mo=
re than 1 segment, look at the ones =0A> > with older timestamps.  Those ca=
n be (re)moved.=0A> > =0A> >  Otis=0A> > --=0A> > Sematext -- http://semate=
xt.com/ -- Solr - Lucene - Nutch=0A> > =0A> > =0A> > =0A> > ----- Original =
Message ----=0A> > > From: Yuliya Palchaninava =0A> > > To: "java-user@luce=
ne.apache.org" =0A> > > Sent: Thu, January 7, 2010 11:23:08 AM=0A> > > Subj=
ect: Lucene 2.9 and 3.0: Optimized index is thrice as =0A> > large as the =
=0A> > > not optimized index=0A> > > =0A> > > Hi,=0A> > > =0A> > > Accordin=
g to the api documentation: "In general, once the optimize =0A> > > complet=
es, the total size of the index will be less than =0A> > the size of =0A> >=
 > the starting index. It could be quite a bit smaller (if there were =0A> =
> > many pending deletes) or just slightly smaller". In our =0A> > case the=
 index =0A> > > becomes not smaller but larger, namely thrice as large.=0A>=
 > > =0A> > > The not optimized index doesn't contain compressed fields, =
=0A> > what could =0A> > > have caused the growth of the index due to the o=
timization. So we =0A> > > cannot explain what happens.=0A> > > =0A> > > Do=
es someone have an explanation for the index growth due =0A> > to the optim=
ization?=0A> > > =0A> > > Thanks,=0A> > > Yuliya=0A> > > =0A> > > =0A> > > =
=0A> > --------------------------------------------------------------------=
-=0A> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=
=0A> > > For additional commands, e-mail: java-user-help@lucene.apache.org=
=0A> > =0A> > =0A> > ------------------------------------------------------=
---------------=0A> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.=
apache.org=0A> > For additional commands, e-mail: java-user-help@lucene.apa=
che.org=0A> > =0A> > =0A> -------------------------------------------------=
--------------------=0A> To unsubscribe, e-mail: java-user-unsubscribe@luce=
ne.apache.org=0A> For additional commands, e-mail: java-user-help@lucene.ap=
ache.org=0A

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44391-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 16:58:14 2010
Return-Path: <java-user-return-44391-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53521 invoked from network); 7 Jan 2010 16:58:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 16:58:14 -0000
Received: (qmail 2132 invoked by uid 500); 7 Jan 2010 16:58:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2065 invoked by uid 500); 7 Jan 2010 16:58:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2055 invoked by uid 99); 7 Jan 2010 16:58:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:58:11 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 16:58:03 +0000
Received: by ywh14 with SMTP id 14so17279430ywh.20
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 08:57:42 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.1.1 with SMTP id d1mr7944312ybi.130.1262883462156; Thu, 07 
	Jan 2010 08:57:42 -0800 (PST)
In-Reply-To: <359a92831001070851s1c9c562fjf05925af1402fa3d@mail.gmail.com>
References: <643aa4871001070413x7629dc2ao5661a18880fcadc4@mail.gmail.com>
	 <359a92831001070537o205957e7nd3d14a0797f5d4ab@mail.gmail.com>
	 <643aa4871001070741t13a8a24coa4a92057bd4e27a7@mail.gmail.com>
	 <359a92831001070851s1c9c562fjf05925af1402fa3d@mail.gmail.com>
Date: Thu, 7 Jan 2010 11:57:42 -0500
Message-ID: <9ac0c6aa1001070857i6de5c499m9611dc979f6c6110@mail.gmail.com>
Subject: Re: Problems with IndexWriter#commit() on Linux
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

kill -9 is harsh, but, perfectly fine from Lucene's standpoint.
Likewise if the OS or JVM crashes, power is suddenly lost, the index
will just fallback to the last successful commit.  What will cause
corruption is if you have bit errors happening somewhere in the
machine... or if two writers are accidentally allowed to be open on
one index... then you're in trouble.

What IO system (filesystem & hardware) are you using on Linux?
Boiling down to a smallish test case can help to isolate the
problem...

Mike

On Thu, Jan 7, 2010 at 11:51 AM, Erick Erickson <erickerickson@gmail.com> w=
rote:
> Can you show us the code where you commit?
>
> And how do you kill your process? Kill -9 is...er...harsh....
>
> Yeah, I'm wondering whether the index file size *stays*
> changed after you kill you process. If it keeps its
> growing on every run (after you kill your process
> multiple times), then I'd suspect that you aren't
> adding documents like you think you are. Perhaps
> different fields, different analyzers, etc.
>
> Luke should show you the largest document by ID,
> as well as document counts. Comparing changes
> in the document count and the max doc ID should
> tell you something...
>
> Is it possible that you are updating existing docs
> rather than adding new ones?
>
> Best
> Erick
>
> On Thu, Jan 7, 2010 at 10:41 AM, Naama Kraus <naamakraus@gmail.com> wrote=
:
>
>> Thanks dor the input.
>>
>> 1. While the process is running, I do see the index files growing on dis=
k
>> and the time stamps changing. Should I see a change in size right after
>> killing the process, is that what you mean ?
>> 2. Yes, same directory is being used for indexing and search.
>> 3. Didn't try Luke, good idea. Though I wonder, the same code runs well =
on
>> Windows.
>>
>> Naama
>>
>> On Thu, Jan 7, 2010 at 3:37 PM, Erick Erickson <erickerickson@gmail.com
>> >wrote:
>>
>> > Several questions:
>> > 1> are the index files larger after you kill your process?
>> > =A0 =A0Or have the timestamps changed?
>> > 2> are you absolutely sure that your indexer, when you
>> > =A0 =A0 add documents, is pointing at the same directory your
>> > =A0 =A0 search is pointing to?
>> > 3> Have you gotten a copy of Luke and examined your index
>> > =A0 =A0 to see if, perhaps, your documents aren't being added the
>> > =A0 =A0 way you think they are?
>> >
>> > Erick
>> >
>> > On Thu, Jan 7, 2010 at 7:13 AM, Naama Kraus <naamakraus@gmail.com>
>> wrote:
>> >
>> > > Hi,
>> > >
>> > > I am using IndexWriter#commit() methods in my program to commit
>> document
>> > > additions to the index. I do that once in a while, after a bunch of
>> > > documents were added. Since my indexing process is long, I want to m=
ake
>> > > sure
>> > > I don't loose too many additions in case of a crash.
>> > > When running on Windows, things work as expected. But when running m=
y
>> > code
>> > > on Linux, seems like commit() has no effect. If I kill my program an=
d
>> > then
>> > > restart it, I don't see documents that I added and then committed (t=
hey
>> > are
>> > > not returned by a search operation).
>> > > I am running Lucene 3.0.0
>> > >
>> > > Can anyone help ?
>> > >
>> > > Thanks, Naama
>> > >
>> > > --
>> > > "If you want your children to be intelligent, read them fairy tales.=
 If
>> > you
>> > > want them to be more intelligent, read them more fairy tales."
>> > > "What really interests me is whether God had any choice in the creat=
ion
>> > of
>> > > the world."
>> > > (Albert Einstein)
>> > >
>> >
>>
>>
>>
>> --
>> "If you want your children to be intelligent, read them fairy tales. If =
you
>> want them to be more intelligent, read them more fairy tales."
>> "What really interests me is whether God had any choice in the creation =
of
>> the world."
>> (Albert Einstein)
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44392-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 17:00:13 2010
Return-Path: <java-user-return-44392-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54192 invoked from network); 7 Jan 2010 17:00:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 17:00:13 -0000
Received: (qmail 6680 invoked by uid 500); 7 Jan 2010 17:00:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6624 invoked by uid 500); 7 Jan 2010 17:00:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6614 invoked by uid 99); 7 Jan 2010 17:00:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 17:00:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.217.225] (HELO mail-gx0-f225.google.com) (209.85.217.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 17:00:02 +0000
Received: by gxk25 with SMTP id 25so1910353gxk.5
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 08:59:41 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.255.5 with SMTP id c5mr1762143ybi.193.1262883580837; Thu, 
	07 Jan 2010 08:59:40 -0800 (PST)
In-Reply-To: <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
	 <943192.67571.qm@web50305.mail.re2.yahoo.com>
	 <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
Date: Thu, 7 Jan 2010 11:59:40 -0500
Message-ID: <9ac0c6aa1001070859q3363ac1k68786a0165999219@mail.gmail.com>
Subject: Re: Lucene 2.9 and 3.0: Optimized index is thrice as large as the not 
	optimized index
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Do your documents have many different indexed fields?  If you do, and
norms are enabled, that could be the cause (norms are not stored
sparsely).

But: what actual sizes are we talking about?

Mike

On Thu, Jan 7, 2010 at 11:50 AM, Yuliya Palchaninava <yp@solute.de> wrote:
> Otis,
>
> thanks for the answer.
>
> Unfortunatelly the index *directory* remains larger *after" the optimizat=
ion.
> In our case the otimization was/is completed successfully and, as you say=
,
> there is only one segment in the directory.
>
> Some other ideas?
>
> Thanks,
> Yuliya
>
>> -----Urspr=FCngliche Nachricht-----
>> Von: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]
>> Gesendet: Donnerstag, 7. Januar 2010 17:35
>> An: java-user@lucene.apache.org
>> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice as
>> large as the not optimized index
>>
>> Yuliya,
>>
>> The index *directory* will be larger *while* you are
>> optimizing. =A0After the optimization is completed
>> successfully, the index directory will be smaller. =A0It is
>> possible that your index directory is large(r) because you
>> have some left-over segments (e.g. from some earlier
>> failed/interrupted optimizations) that are not really a part
>> of the index. =A0After optimizing, you should have only 1
>> segment, so if you see more than 1 segment, look at the ones
>> with older timestamps. =A0Those can be (re)moved.
>>
>> =A0Otis
>> --
>> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>>
>>
>>
>> ----- Original Message ----
>> > From: Yuliya Palchaninava <yp@solute.de>
>> > To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
>> > Sent: Thu, January 7, 2010 11:23:08 AM
>> > Subject: Lucene 2.9 and 3.0: Optimized index is thrice as
>> large as the
>> > not optimized index
>> >
>> > Hi,
>> >
>> > According to the api documentation: "In general, once the optimize
>> > completes, the total size of the index will be less than
>> the size of
>> > the starting index. It could be quite a bit smaller (if there were
>> > many pending deletes) or just slightly smaller". In our
>> case the index
>> > becomes not smaller but larger, namely thrice as large.
>> >
>> > The not optimized index doesn't contain compressed fields,
>> what could
>> > have caused the growth of the index due to the otimization. So we
>> > cannot explain what happens.
>> >
>> > Does someone have an explanation for the index growth due
>> to the optimization?
>> >
>> > Thanks,
>> > Yuliya
>> >
>> >
>> >
>> ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44393-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 17:03:18 2010
Return-Path: <java-user-return-44393-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55077 invoked from network); 7 Jan 2010 17:03:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 17:03:18 -0000
Received: (qmail 14600 invoked by uid 500); 7 Jan 2010 17:03:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14540 invoked by uid 500); 7 Jan 2010 17:03:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14530 invoked by uid 99); 7 Jan 2010 17:03:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 17:03:15 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 17:03:07 +0000
Received: by ywh14 with SMTP id 14so17284652ywh.20
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 09:02:46 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.1.1 with SMTP id d1mr7955202ybi.130.1262883766288; Thu, 07 
	Jan 2010 09:02:46 -0800 (PST)
In-Reply-To: <27062291.post@talk.nabble.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27062291.post@talk.nabble.com>
Date: Thu, 7 Jan 2010 12:02:46 -0500
Message-ID: <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Merge factor controls how many segments are merged at once.  The default is=
 10.

The maxMergeMB setting sets the max size for a given segment to be
included in a merge.

Roughly, the upper bound on merged segments is the sum of their sizes.

So the rough upper bound on any segment's size is mergeFactor * maxMergeMB.

Mike

On Thu, Jan 7, 2010 at 11:04 AM, Dvora <barak.yaish@gmail.com> wrote:
>
> Can you explain how the combination of merge factor and max merge size
> control the size of files?
>
> For example, if one would like to limit the files size to 3,4 or 7MB - ho=
w
> these parameters values can be predicted?
>
>
>
> Michael McCandless-2 wrote:
>>
>>
>> This tells the IndexWriter NOT to merge any segment that's over 1.0 MB
>> in size. =A0With a default merge factor of 10, this should "generally"
>> mean you don't get a segment over 10MB, though it may not be a hard
>> guarantee (you can lower the 1.0 if you still see a segment over 10
>> MB).
>>
>>
>
> --
> View this message in context: http://old.nabble.com/Is-there-a-way-to-lim=
it-the-size-of-an-index--tp27056573p27062291.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44394-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 17:21:59 2010
Return-Path: <java-user-return-44394-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61957 invoked from network); 7 Jan 2010 17:21:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 17:21:59 -0000
Received: (qmail 50581 invoked by uid 500); 7 Jan 2010 17:21:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50533 invoked by uid 500); 7 Jan 2010 17:21:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50523 invoked by uid 99); 7 Jan 2010 17:21:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 17:21:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.116.39.62] (HELO rectangular.com) (68.116.39.62)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 17:21:48 +0000
Received: from marvin by rectangular.com with local (Exim 4.63)
	(envelope-from <marvin@rectangular.com>)
	id 1NSw32-0003E9-MZ
	for java-user@lucene.apache.org; Thu, 07 Jan 2010 09:21:24 -0800
Date: Thu, 7 Jan 2010 09:21:24 -0800
To: java-user@lucene.apache.org
Subject: Re: R-Tree in lucene thoughts?
Message-ID: <20100107172124.GA12307@rectangular.com>
References: <58B5F7E8-F5D1-47EB-B1F8-864ABFC27DFA@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <58B5F7E8-F5D1-47EB-B1F8-864ABFC27DFA@gmail.com>
User-Agent: Mutt/1.5.13 (2006-08-11)
From: Marvin Humphrey <marvin@rectangular.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Jan 07, 2010 at 10:13:00AM -0500, Ryan McKinley wrote:
> With the new flexible indexing stuff, would it be possible to natively
> write an rtree to disk in the index process? 

The question I'd have is, how would you handle interleaving of hits from
different segments?  Meaning, if you have a priority queue with 10 slots, 10
hits from one segment, and 10 hits from another segment, how do you determine
which his win and which fall out the bottom of the queue?

> It looks like Lucy has considered something similar:
> http://www.lucidimagination.com/search/document/75ac07b7e2d6160d/pluggable_indexreader_was_real_time_updates

Yes.  That post is from last spring; since then, a prototype of the Lucy
pluggable IndexReader design has been implemented in KinoSearch, so you could
write such a component today.

Marvin Humphrey


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44395-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 18:04:07 2010
Return-Path: <java-user-return-44395-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83209 invoked from network); 7 Jan 2010 18:04:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 18:04:07 -0000
Received: (qmail 42120 invoked by uid 500); 7 Jan 2010 18:04:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42045 invoked by uid 500); 7 Jan 2010 18:04:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42035 invoked by uid 99); 7 Jan 2010 18:04:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 18:04:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ryantxu@gmail.com designates 209.85.221.203 as permitted sender)
Received: from [209.85.221.203] (HELO mail-qy0-f203.google.com) (209.85.221.203)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 18:03:55 +0000
Received: by qyk41 with SMTP id 41so8572366qyk.29
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 10:03:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=yGURqiekxzpD+QO5fT6J5qLHsRLTeP2d4VOnNcv94lg=;
        b=hu9jDTTItg+Kn/c/tvqSWiH+thfDjoS7xTysBzKkLwxA0CSxXTpsmkHqliPwDQ4gTi
         b7UDl9Bcb/yXgxi2Ft5xHMcQhgIBLjkjlnnI5Xn2W0GA8iO27dXI4N/h/2resXYDHkNq
         Q94/Sb/OtsiaQ7c9EXBPzpEtwe2/0ipHODEv4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=HtWx7pmtoYaaqS0Jq4zcxPlMBJO7UJK8xd5xdOUkB5JHZVRfJrSmqSqdDNdT0Ysnt0
         6nzQr6XCAv3G13JSWpqUoYWcZQj1Jr0i2JRRBVKEL2Dw1K9JZkz1hJGPLlPI9Mqaaq44
         ZaOwfyPsqdcQB8dGXxKSwITlPXzq1Xv9FCrsg=
Received: by 10.224.95.156 with SMTP id d28mr13722953qan.66.1262887410351;
        Thu, 07 Jan 2010 10:03:30 -0800 (PST)
Received: from ?192.168.1.7? ([66.92.161.165])
        by mx.google.com with ESMTPS id 7sm9280669qwf.14.2010.01.07.10.03.29
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 07 Jan 2010 10:03:29 -0800 (PST)
Message-Id: <75B60573-72C9-4AB4-99B4-71F7EC41E083@gmail.com>
From: Ryan McKinley <ryantxu@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <20100107172124.GA12307@rectangular.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: R-Tree in lucene thoughts?
Date: Thu, 7 Jan 2010 13:03:27 -0500
References: <58B5F7E8-F5D1-47EB-B1F8-864ABFC27DFA@gmail.com> <20100107172124.GA12307@rectangular.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


On Jan 7, 2010, at 12:21 PM, Marvin Humphrey wrote:

> On Thu, Jan 07, 2010 at 10:13:00AM -0500, Ryan McKinley wrote:
>> With the new flexible indexing stuff, would it be possible to  
>> natively
>> write an rtree to disk in the index process?
>
> The question I'd have is, how would you handle interleaving of hits  
> from
> different segments?  Meaning, if you have a priority queue with 10  
> slots, 10
> hits from one segment, and 10 hits from another segment, how do you  
> determine
> which his win and which fall out the bottom of the queue?

(I am not familiar enough with the segment internals, so I may be way  
off base...)

Perhaps each segment has its own r-tree.  For each query, the r-tree  
would only be used to say if something could be in the results, it  
does not contribute to the score, so I don't think interleaving would  
be any different then how it currently works (without knowing how it  
currently works)  Potentially, the node depth could influence the  
score, but lets ignore that for now :)


ryan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44396-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 18:35:51 2010
Return-Path: <java-user-return-44396-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5042 invoked from network); 7 Jan 2010 18:35:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 18:35:51 -0000
Received: (qmail 96897 invoked by uid 500); 7 Jan 2010 18:35:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96823 invoked by uid 500); 7 Jan 2010 18:35:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96813 invoked by uid 99); 7 Jan 2010 18:35:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 18:35:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.116.39.62] (HELO rectangular.com) (68.116.39.62)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 18:35:42 +0000
Received: from marvin by rectangular.com with local (Exim 4.63)
	(envelope-from <marvin@rectangular.com>)
	id 1NSxCb-0003Id-5k
	for java-user@lucene.apache.org; Thu, 07 Jan 2010 10:35:21 -0800
Date: Thu, 7 Jan 2010 10:35:21 -0800
To: java-user@lucene.apache.org
Subject: Re: R-Tree in lucene thoughts?
Message-ID: <20100107183521.GA12641@rectangular.com>
References: <58B5F7E8-F5D1-47EB-B1F8-864ABFC27DFA@gmail.com> <20100107172124.GA12307@rectangular.com> <75B60573-72C9-4AB4-99B4-71F7EC41E083@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <75B60573-72C9-4AB4-99B4-71F7EC41E083@gmail.com>
User-Agent: Mutt/1.5.13 (2006-08-11)
From: Marvin Humphrey <marvin@rectangular.com>

On Thu, Jan 07, 2010 at 01:03:27PM -0500, Ryan McKinley wrote:

> Perhaps each segment has its own r-tree.  For each query, the r-tree  would
> only be used to say if something could be in the results, it  does not
> contribute to the score, so I don't think interleaving would  be any
> different then how it currently works (without knowing how it  currently
> works)  Potentially, the node depth could influence the  score, but lets
> ignore that for now :)

Yes, if the results of the r-tree search are only for filtering, it wouldn't
matter.  If they are used to contribute to a score, interleaving is also easy,
because you just compare scores and the higher score wins.

It's only important if you wanted to, say, sort by distance.

Marvin Humphrey


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44397-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 19:24:07 2010
Return-Path: <java-user-return-44397-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23404 invoked from network); 7 Jan 2010 19:24:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 19:24:07 -0000
Received: (qmail 75526 invoked by uid 500); 7 Jan 2010 19:24:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75480 invoked by uid 500); 7 Jan 2010 19:24:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75470 invoked by uid 99); 7 Jan 2010 19:24:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 19:24:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.57] (HELO web50303.mail.re2.yahoo.com) (206.190.38.57)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 07 Jan 2010 19:23:54 +0000
Received: (qmail 38818 invoked by uid 60001); 7 Jan 2010 19:23:32 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262892212; bh=JVbSo2RYj4M+vXciiYv7I+J8nmWQVdbqGig6TKEiipA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=bimaPnLN/MFT8sUP6e5XJSkobZWpriAY4sf1hk8cBXRTu5+flIfnw0Kjx61wsM3qCcjaPWBlyyXh40GnIhTuyFjVinu2jRiTK4bmA2v8uPnGg70nkkr7qudehjRv+mC2e3ltPCa6BNBOzOBmaFWimOuQQ7YcMkYKkqjzC6JzAlY=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=iyd1To1HcVKekGeN5AExK3mn3CZzaey0CfV9fdSNqQHHDmcoCirtiIgxPOtvxbd1Q1LjCozHKPoStSBjS5020cjzeoNoeo0SaAp1zWNG+PPCo/oMwFEOZ7TyccU9s56Z6fD1dnT+hkvqf+wgQRQpgxK1wiKafj2moccpH178E9g=;
Message-ID: <633637.37238.qm@web50303.mail.re2.yahoo.com>
X-YMail-OSG: O_urahUVM1lg3l.YdB5zEZqivAbwCXhKFelNYEX3L41mRdwGN46TsmvW.Db2besoh4WjM3xb19q4_zKY0wwIbrJkAzRmo16bViowuKEAZjHoG.4z.CpwipAsWoDi6T189EO9MMJYbikjugOLSy4hmVxwoiOrYpFbOCn97iFcCjMaHzfc9DfuIuob.Vt4A3bO8.4.a3B2rEMuJVEXDQIEBBHHOf4rL9XUPljyhoQNGy_Vf4mfgrnM8Yvmfj_x0bmI4jsT.S8e0nGAgqkeInSZ7iBBUXRXzWSrP4DF7hZgB_lGG68St5eim_G1fAVA6Ftyu2q6dQBNPmpIC.9EPqLS0gz3J1.mAAv28c7QxI4ReNx6.jCNtRQ7X8eAao3GuMNtLXQOpvJ6p9uHp_KL256QX5xU91O6xoroAQiXIAUi556YajFnsjBmzzmJeLwAJBa4meP6GbERs4dshjAqdvuvpAMCja4gc33mB4qtk.lJxSDQZkvoj1fUAWv7tt6KIBPgJJwDsuNjBUOu98iEzyULIIfM0NgLkaDe53cUzsJhyn5GwndEw43FxbmgWn9L1JxGJ.wNsln9T_Ju7vj0q6naY34bGdW3xOKXJbvC9NvhWBhev9jl4BXGo4nRLSYzXUUAP_zKGKDPHV1typugcNkSwOHnBiiUW8FvD5RxP..maKb3HBpKaOx8KhYBGCj290uo_BGCdQMquC35OYas
Received: from [167.206.188.3] by web50303.mail.re2.yahoo.com via HTTP; Thu, 07 Jan 2010 11:23:32 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <27056573.post@talk.nabble.com>  <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>  <27058014.post@talk.nabble.com>  <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>  <27062291.post@talk.nabble.com> <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
Date: Thu, 7 Jan 2010 11:23:32 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Is there a way to limit the size of an index?
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> Merge factor controls how many segments are merged at once.  The default is 10.
> 
> The maxMergeMB setting sets the max size for a given segment to be
> included in a merge.

I wonder if renaming that to maxSegSizeMergeMB would make it more obvious what this does?

Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch

> Roughly, the upper bound on merged segments is the sum of their sizes.
> 
> So the rough upper bound on any segment's size is mergeFactor * maxMergeMB.
> 
> Mike
> 
> On Thu, Jan 7, 2010 at 11:04 AM, Dvora wrote:
> >
> > Can you explain how the combination of merge factor and max merge size
> > control the size of files?
> >
> > For example, if one would like to limit the files size to 3,4 or 7MB - how
> > these parameters values can be predicted?
> >
> >
> >
> > Michael McCandless-2 wrote:
> >>
> >>
> >> This tells the IndexWriter NOT to merge any segment that's over 1.0 MB
> >> in size.  With a default merge factor of 10, this should "generally"
> >> mean you don't get a segment over 10MB, though it may not be a hard
> >> guarantee (you can lower the 1.0 if you still see a segment over 10
> >> MB).
> >>
> >>
> >
> > --
> > View this message in context: 
> http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27062291.html
> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44398-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 19:28:47 2010
Return-Path: <java-user-return-44398-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24823 invoked from network); 7 Jan 2010 19:28:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 19:28:46 -0000
Received: (qmail 83742 invoked by uid 500); 7 Jan 2010 19:28:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83634 invoked by uid 500); 7 Jan 2010 19:28:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83624 invoked by uid 99); 7 Jan 2010 19:28:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 19:28:44 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 19:28:36 +0000
Received: by ywh14 with SMTP id 14so17424519ywh.20
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 11:28:15 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.165.17 with SMTP id n17mr31927581ybe.321.1262892495163; 
	Thu, 07 Jan 2010 11:28:15 -0800 (PST)
In-Reply-To: <633637.37238.qm@web50303.mail.re2.yahoo.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27062291.post@talk.nabble.com>
	 <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
	 <633637.37238.qm@web50303.mail.re2.yahoo.com>
Date: Thu, 7 Jan 2010 14:28:15 -0500
Message-ID: <9ac0c6aa1001071128x98f8888x66cb751ca7eef9a@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Jan 7, 2010 at 2:23 PM, Otis Gospodnetic
<otis_gospodnetic@yahoo.com> wrote:
>> Merge factor controls how many segments are merged at once. =A0The defau=
lt is 10.
>>
>> The maxMergeMB setting sets the max size for a given segment to be
>> included in a merge.
>
> I wonder if renaming that to maxSegSizeMergeMB would make it more obvious=
 what this does?

Well... that setting is already in LogByteSizeMergePolicy (not
IndexWriter), so I think in that context it's pretty clear?

Though I'd love to find a better name that conveys that the size
limitation applies to the segments *being* merged, not to the
resulting merged segment.  maxStartingSegSizeMB?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44399-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 19:28:53 2010
Return-Path: <java-user-return-44399-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24876 invoked from network); 7 Jan 2010 19:28:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 19:28:53 -0000
Received: (qmail 85430 invoked by uid 500); 7 Jan 2010 19:28:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85374 invoked by uid 500); 7 Jan 2010 19:28:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85364 invoked by uid 99); 7 Jan 2010 19:28:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 19:28:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of kaykay.unique@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 19:28:40 +0000
Received: by bwz22 with SMTP id 22so11913592bwz.5
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 11:28:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=yruxqMqdxK+0GTVaesy416a2S+Dy0pu9NmEGNmwVI/Q=;
        b=Dbuu6lxLEsBvnOc73ta/4DJ4uFPxWBd5eJ7VMUofqt8UOlNdGKBKfcI9cZuuQB2KJb
         GmMTOLzzYsp3V90KBPeZgtGjFWcy3Shz6JpDR2X505kWZswZf9V17RETabz0LM4TpV+n
         flz8CZGWOUzgxyzWTTfeTGSwRQ5prb/zZP8zA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=MLylbpCBlDDGXjFZsJkMZBdbWPxHOayLBwzUXscTZd2SSk0HqSnE6JELHphkg+xy/R
         Ed3yQyXfZp5QvzySW6Q4z4EEIM/iWC3R7Rz/pBOHJ6N7vYxKbcYybgRiKHD+BxdJK+2Q
         EvXxwTywXmE5m4oN5TSnaH9ChweBI7eGujT/c=
Received: by 10.204.8.81 with SMTP id g17mr1275763bkg.200.1262892499917;
        Thu, 07 Jan 2010 11:28:19 -0800 (PST)
Received: from KayKayVoldeMort.local ([38.99.42.113])
        by mx.google.com with ESMTPS id 15sm7460555bwz.12.2010.01.07.11.28.17
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 07 Jan 2010 11:28:18 -0800 (PST)
Message-ID: <4B463662.9010202@gmail.com>
Date: Thu, 07 Jan 2010 11:30:42 -0800
From: Kay Kay <kaykay.unique@gmail.com>
User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.1.5) Gecko/20091204 Thunderbird/3.0
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Is there a way to limit the size of an index?
References: <27056573.post@talk.nabble.com>  <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>  <27058014.post@talk.nabble.com>  <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>  <27062291.post@talk.nabble.com> <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com> <633637.37238.qm@web50303.mail.re2.yahoo.com>
In-Reply-To: <633637.37238.qm@web50303.mail.re2.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 1/7/10 11:23 AM, Otis Gospodnetic wrote:
>> Merge factor controls how many segments are merged at once.  The default is 10.
>>
>> The maxMergeMB setting sets the max size for a given segment to be
>> included in a merge.
>>      
> I wonder if renaming that to maxSegSizeMergeMB would make it more obvious what this does?
>    

Personally, +1 on the new naming , as it seems self explanatory than 
maxMergeMB .

> Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>    
>> Roughly, the upper bound on merged segments is the sum of their sizes.
>>
>> So the rough upper bound on any segment's size is mergeFactor * maxMergeMB.
>>
>> Mike
>>
>> On Thu, Jan 7, 2010 at 11:04 AM, Dvora wrote:
>>      
>>> Can you explain how the combination of merge factor and max merge size
>>> control the size of files?
>>>
>>> For example, if one would like to limit the files size to 3,4 or 7MB - how
>>> these parameters values can be predicted?
>>>
>>>
>>>
>>> Michael McCandless-2 wrote:
>>>        
>>>>
>>>> This tells the IndexWriter NOT to merge any segment that's over 1.0 MB
>>>> in size.  With a default merge factor of 10, this should "generally"
>>>> mean you don't get a segment over 10MB, though it may not be a hard
>>>> guarantee (you can lower the 1.0 if you still see a segment over 10
>>>> MB).
>>>>
>>>>
>>>>          
>>> --
>>> View this message in context:
>>>        
>> http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27062291.html
>>      
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>        
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>      
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>    


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44400-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 19:49:11 2010
Return-Path: <java-user-return-44400-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30430 invoked from network); 7 Jan 2010 19:49:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 19:49:11 -0000
Received: (qmail 29094 invoked by uid 500); 7 Jan 2010 19:49:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29050 invoked by uid 500); 7 Jan 2010 19:49:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29040 invoked by uid 99); 7 Jan 2010 19:49:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 19:49:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.62] (HELO web50308.mail.re2.yahoo.com) (206.190.38.62)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 07 Jan 2010 19:49:00 +0000
Received: (qmail 86884 invoked by uid 60001); 7 Jan 2010 19:48:39 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262893719; bh=X64ixudOL1yBkr/zc+Zp0xykNzpvDDJ1kqVPQr4FCxA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=BhxWjhW2SyL674Lj9vZucJ3JTaaY0dBUi8zlZ00Fi0bIocsqnCK6KN3GWJQUjipbQzn36XGax87DrY2B4v8ohv1RK08sARYExBf//iRjZ8nPhox1QtrfjQcMzX57dSnnLsg/1G2hgWzXpMqwZ1E5zfTcM/VUUiatsP0O+ZavM4Q=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=waIRt+ktZ7ixJUCFJiBCYs+CREatN2iSYe96P+khWTjo+LcJiNpkkYdwBhRjzBYoU3R5mTe+kQAK0S7tej8jF4xIsNK8yAgo2x6WGa3v/BaEGLD/LEM1lInpsW3OAGOJV1BiS08aSsVIvYvJutjmFFr8CjbAOOhjYiVEBw+1etE=;
Message-ID: <91417.86714.qm@web50308.mail.re2.yahoo.com>
X-YMail-OSG: kaeTuaQVM1lT97J.LXFpSxAzvjBY4bRIcEFvoQUnVHNOLoJsTH2fXNOq67V.JckfvEnkqYlGqj5JDIHgLnEfsHxrsnF3xJTjFztgyc9NoVUt5mY4maAmMtKpXczmzbuPcQvj2JUzYiA1J9HAzHcbzGPYxZdw6fP9H6EFh_5XKBqspKLbrXD1VgiII1gyDAyFjSCo6r3cA0WuFHB_TjmFLxyZzrsM3ba9owAFg_4xNquQv3_oGKBALG859DulIIhJtp_D0KAot_KYY_V6aa5uCJ5fSTMpabBi.17rEKS.T55IMwfz0x_IYLt7Iz_rfJcSkEaneZZ4bmAat7WHoDSHnJG23RNr0n4bfeHDrbVPXdXSEqkWXki4xA4C9hnT22Zb73YB3kBpLI4nZCkFSLfWPy4n1ck_8yQ7cEJW5qYH1o0CKHWypHSAcrQAHJCB
Received: from [167.206.188.3] by web50308.mail.re2.yahoo.com via HTTP; Thu, 07 Jan 2010 11:48:38 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <27056573.post@talk.nabble.com>  <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>  <27058014.post@talk.nabble.com>  <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>  <27062291.post@talk.nabble.com>  <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>  <633637.37238.qm@web50303.mail.re2.yahoo.com> <9ac0c6aa1001071128x98f8888x66cb751ca7eef9a@mail.gmail.com>
Date: Thu, 7 Jan 2010 11:48:38 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Is there a way to limit the size of an index?
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa1001071128x98f8888x66cb751ca7eef9a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Sure, sounds good, maybe even drop "ing".

 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Michael McCandless <lucene@mikemccandless.com>
> To: java-user@lucene.apache.org
> Sent: Thu, January 7, 2010 2:28:15 PM
> Subject: Re: Is there a way to limit the size of an index?
> 
> On Thu, Jan 7, 2010 at 2:23 PM, Otis Gospodnetic
> wrote:
> >> Merge factor controls how many segments are merged at once.  The default is 
> 10.
> >>
> >> The maxMergeMB setting sets the max size for a given segment to be
> >> included in a merge.
> >
> > I wonder if renaming that to maxSegSizeMergeMB would make it more obvious what 
> this does?
> 
> Well... that setting is already in LogByteSizeMergePolicy (not
> IndexWriter), so I think in that context it's pretty clear?
> 
> Though I'd love to find a better name that conveys that the size
> limitation applies to the segments *being* merged, not to the
> resulting merged segment.  maxStartingSegSizeMB?
> 
> Mike
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44401-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 20:55:16 2010
Return-Path: <java-user-return-44401-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45924 invoked from network); 7 Jan 2010 20:55:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 20:55:15 -0000
Received: (qmail 19722 invoked by uid 500); 7 Jan 2010 20:55:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19647 invoked by uid 500); 7 Jan 2010 20:55:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19637 invoked by uid 99); 7 Jan 2010 20:55:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 20:55:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yanivby@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 20:55:04 +0000
Received: by bwz22 with SMTP id 22so11970553bwz.5
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 12:54:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=saVdQ7/Fu2uOn7EEiTE+6tnGOVfiXIfavYjB1QpENyY=;
        b=rvTVzaeEnz8/vpCPdDRRggJpv8FUPon8uLG4tTAgKxfJGxkdrRKOEcfRq/TWMA6w/m
         dauqItid3dqxepagY9k4OzUhQpt2Mzeh7h2WxnSLcBJQM77+Fov3FvgkDxZZJe5gYkAY
         ziCgYsn39flArGNCgY+/nRHPsOMx1J3NQTeVs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=CnPCbRD5YFNMzEzGFR1SCjx5O9Yxn5EyI1o2NzWP1BMCNiuIUrU1rz1YUGlLpvNAaZ
         OLQUZ2vdmY03sb9PHWBbrDFOzu3xynfTm9K+v7wbZrBDH4DHIrCBnq2FY3eHFdgkvqzr
         uaBJiPg68zIrZ7vwk5SV5FJOM0jwwfP3a4m3o=
MIME-Version: 1.0
Received: by 10.204.6.82 with SMTP id 18mr3715982bky.65.1262897682635; Thu, 07 
	Jan 2010 12:54:42 -0800 (PST)
In-Reply-To: <d483d31b1001070628j495cc18dka6a4da7687a71ec0@mail.gmail.com>
References: <d483d31b1001070628j495cc18dka6a4da7687a71ec0@mail.gmail.com>
From: Yaniv Ben Yosef <yanivby@gmail.com>
Date: Thu, 7 Jan 2010 22:54:22 +0200
Message-ID: <d483d31b1001071254w6d50eb02r5a65b7ed087a0b07@mail.gmail.com>
Subject: Implementing filtering based on multiple fields
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c19e0c2dc15047c994761

--0015174c19e0c2dc15047c994761
Content-Type: text/plain; charset=ISO-8859-1

Hi,

I'm very new to Lucene. In fact, I'm at the beginning of an evaluation
phase, trying to figure whether Lucene is the right fit for my needs.
The project I'm involved in requires something similar to the Google Custom
Search Engine <http://www.google.com/cse/> (CSE). In CSE, each user can
define a set (could be a large set) of websites, and limit the search to
only those websites. So for example, I can create a CSE that searches all
web pages on cnn.com, msnbc.com and nytimes.com only.
I am trying to understand whether and how I can do something similar in
Lucene.

The FAQ hints about this possibility
here<http://wiki.apache.org/lucene-java/LuceneFAQ#How_can_I_search_over_multiple_fields.3F>,
but it mentions a class that no longer exists in 3.0 (QueryFilter), and is
very laconic about the suggested options. Also I'm not sure how well it will
perform in my use case (or even if it fits at all).
I thought about creating a separate index for each user or CSE. However, my
system should be able to handle tens of thousands of concurrent users. I
haven't done any analysis yet on how this will affect CPU, RAM, I/O and
storage size, but was wondering if any of you experienced Lucene
users/developers think it's a good direction.
If that's not a good idea, what would be a good strategy here?

Any help will be much appreciated,
Yaniv

--0015174c19e0c2dc15047c994761--

From java-user-return-44402-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 22:09:51 2010
Return-Path: <java-user-return-44402-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77470 invoked from network); 7 Jan 2010 22:09:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 22:09:51 -0000
Received: (qmail 40537 invoked by uid 500); 7 Jan 2010 22:09:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40462 invoked by uid 500); 7 Jan 2010 22:09:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40452 invoked by uid 99); 7 Jan 2010 22:09:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 22:09:49 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of naamakraus@gmail.com designates 209.85.222.176 as permitted sender)
Received: from [209.85.222.176] (HELO mail-pz0-f176.google.com) (209.85.222.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 22:09:42 +0000
Received: by pzk6 with SMTP id 6so710338pzk.29
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 14:09:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=GmNuMx9O5So41iaBvyIc9MSHXWYKJCBG7WS4oc4+pDo=;
        b=TDS/OptDsjaIcbccIg/GPd+Euyu1oWQCudBy5DBYYTiZyT1yVOM/z5F5cQkUoO21tU
         9S6x6ubvW9iZmNlaB/7AtCJKcQMUgaoYzkAYEMV38UZsZgMJWlm+t2M6NzMV/4sT8soz
         64wo4e+KkQCPLB+EdeWyhhdn9rBYifqQQzORk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=KDlhW1ojVpdtHc7Hyie4R+3RhL8mKk/HFkMXqxRXYy+NPzxL74soRqG2RDqdqZx8kG
         PgPbeGT9KfzVEQLHfGoCOKR3IF6NwFzkXRkD/ud/aZGgZe1/EfFy8uWYHcIOiVyylWYb
         qRQa5woS6I2g/9SbhwjxnDQgsUMW7LLVxHGzU=
MIME-Version: 1.0
Received: by 10.141.14.15 with SMTP id r15mr4307533rvi.15.1262902162183; Thu, 
	07 Jan 2010 14:09:22 -0800 (PST)
In-Reply-To: <9ac0c6aa1001070857i6de5c499m9611dc979f6c6110@mail.gmail.com>
References: <643aa4871001070413x7629dc2ao5661a18880fcadc4@mail.gmail.com> 
	<359a92831001070537o205957e7nd3d14a0797f5d4ab@mail.gmail.com> 
	<643aa4871001070741t13a8a24coa4a92057bd4e27a7@mail.gmail.com> 
	<359a92831001070851s1c9c562fjf05925af1402fa3d@mail.gmail.com> 
	<9ac0c6aa1001070857i6de5c499m9611dc979f6c6110@mail.gmail.com>
From: Naama Kraus <naamakraus@gmail.com>
Date: Fri, 8 Jan 2010 00:09:02 +0200
Message-ID: <643aa4871001071409n5e7a95bdr973fa4e1e48602b8@mail.gmail.com>
Subject: Re: Problems with IndexWriter#commit() on Linux
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd1145cc35668047c9a5294

--000e0cd1145cc35668047c9a5294
Content-Type: text/plain; charset=ISO-8859-1

Thanks all for the hints, I'll get back to my code and do some additional
checks.
Naama

On Thu, Jan 7, 2010 at 6:57 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> kill -9 is harsh, but, perfectly fine from Lucene's standpoint.
> Likewise if the OS or JVM crashes, power is suddenly lost, the index
> will just fallback to the last successful commit.  What will cause
> corruption is if you have bit errors happening somewhere in the
> machine... or if two writers are accidentally allowed to be open on
> one index... then you're in trouble.
>
> What IO system (filesystem & hardware) are you using on Linux?
> Boiling down to a smallish test case can help to isolate the
> problem...
>
> Mike
>
> On Thu, Jan 7, 2010 at 11:51 AM, Erick Erickson <erickerickson@gmail.com>
> wrote:
> > Can you show us the code where you commit?
> >
> > And how do you kill your process? Kill -9 is...er...harsh....
> >
> > Yeah, I'm wondering whether the index file size *stays*
> > changed after you kill you process. If it keeps its
> > growing on every run (after you kill your process
> > multiple times), then I'd suspect that you aren't
> > adding documents like you think you are. Perhaps
> > different fields, different analyzers, etc.
> >
> > Luke should show you the largest document by ID,
> > as well as document counts. Comparing changes
> > in the document count and the max doc ID should
> > tell you something...
> >
> > Is it possible that you are updating existing docs
> > rather than adding new ones?
> >
> > Best
> > Erick
> >
> > On Thu, Jan 7, 2010 at 10:41 AM, Naama Kraus <naamakraus@gmail.com>
> wrote:
> >
> >> Thanks dor the input.
> >>
> >> 1. While the process is running, I do see the index files growing on
> disk
> >> and the time stamps changing. Should I see a change in size right after
> >> killing the process, is that what you mean ?
> >> 2. Yes, same directory is being used for indexing and search.
> >> 3. Didn't try Luke, good idea. Though I wonder, the same code runs well
> on
> >> Windows.
> >>
> >> Naama
> >>
> >> On Thu, Jan 7, 2010 at 3:37 PM, Erick Erickson <erickerickson@gmail.com
> >> >wrote:
> >>
> >> > Several questions:
> >> > 1> are the index files larger after you kill your process?
> >> >    Or have the timestamps changed?
> >> > 2> are you absolutely sure that your indexer, when you
> >> >     add documents, is pointing at the same directory your
> >> >     search is pointing to?
> >> > 3> Have you gotten a copy of Luke and examined your index
> >> >     to see if, perhaps, your documents aren't being added the
> >> >     way you think they are?
> >> >
> >> > Erick
> >> >
> >> > On Thu, Jan 7, 2010 at 7:13 AM, Naama Kraus <naamakraus@gmail.com>
> >> wrote:
> >> >
> >> > > Hi,
> >> > >
> >> > > I am using IndexWriter#commit() methods in my program to commit
> >> document
> >> > > additions to the index. I do that once in a while, after a bunch of
> >> > > documents were added. Since my indexing process is long, I want to
> make
> >> > > sure
> >> > > I don't loose too many additions in case of a crash.
> >> > > When running on Windows, things work as expected. But when running
> my
> >> > code
> >> > > on Linux, seems like commit() has no effect. If I kill my program
> and
> >> > then
> >> > > restart it, I don't see documents that I added and then committed
> (they
> >> > are
> >> > > not returned by a search operation).
> >> > > I am running Lucene 3.0.0
> >> > >
> >> > > Can anyone help ?
> >> > >
> >> > > Thanks, Naama
> >> > >
> >> > > --
> >> > > "If you want your children to be intelligent, read them fairy tales.
> If
> >> > you
> >> > > want them to be more intelligent, read them more fairy tales."
> >> > > "What really interests me is whether God had any choice in the
> creation
> >> > of
> >> > > the world."
> >> > > (Albert Einstein)
> >> > >
> >> >
> >>
> >>
> >>
> >> --
> >> "If you want your children to be intelligent, read them fairy tales. If
> you
> >> want them to be more intelligent, read them more fairy tales."
> >> "What really interests me is whether God had any choice in the creation
> of
> >> the world."
> >> (Albert Einstein)
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
"If you want your children to be intelligent, read them fairy tales. If you
want them to be more intelligent, read them more fairy tales."
"What really interests me is whether God had any choice in the creation of
the world."
(Albert Einstein)

--000e0cd1145cc35668047c9a5294--

From java-user-return-44403-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 22:22:11 2010
Return-Path: <java-user-return-44403-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81653 invoked from network); 7 Jan 2010 22:22:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 22:22:11 -0000
Received: (qmail 56989 invoked by uid 500); 7 Jan 2010 22:22:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56916 invoked by uid 500); 7 Jan 2010 22:22:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56906 invoked by uid 99); 7 Jan 2010 22:22:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 22:22:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 22:22:00 +0000
Received: by pxi16 with SMTP id 16so4624696pxi.29
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 14:21:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=L5S6dXXGUncvc70pKUyGTvuxO0NG0XNc7P3xcZXcQiI=;
        b=FY0jBcri2uJ/dfCj+dghf+oLIk0Tzyvb/WZDK/KzuFnO7/QDRsD/GHbV9NSQNgazq9
         qRa0WkadsLBC/xKMvN+0lyXiPidC2QUYd9QkFO1Pp5R9Qp2FC0YGpL5XgcdFVZv6JFFx
         2k1NObLMqN7kboNadHkYA/6l0FLVzjHaBE/Cw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=WYPhxT/PLNL6NB9mYObXjMRMYRxxs90Hj0qDBBWZwvID+ql+RPpxamcyE9j1VoJ06Z
         BV+Cgniphxu9xki4n/7uFjuQiUA/+uhcvy7DNoEn47EJYwjr3CnoUxYZOSV4XgaXTeZX
         lwfL/zHvoYkIheon3tQ3flDXqrjPja3u9l8iY=
MIME-Version: 1.0
Received: by 10.140.251.9 with SMTP id y9mr3351514rvh.277.1262902900427; Thu, 
	07 Jan 2010 14:21:40 -0800 (PST)
In-Reply-To: <633637.37238.qm@web50303.mail.re2.yahoo.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27062291.post@talk.nabble.com>
	 <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
	 <633637.37238.qm@web50303.mail.re2.yahoo.com>
Date: Thu, 7 Jan 2010 14:21:40 -0800
Message-ID: <85d3c3b61001071421k60412b15j768bdd6a5a6b35d9@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

The naming is unclear, when I looked at this I had to thumb
through the code a fair bit before discerning if it was the
input segments or the output segment of a merge (it's the
former). Though I find the current functionality somewhat odd
because it will inherently exceed the given size with a merge,
which is uncontrollable, making the exact setting somewhat
arbitrary... What was the original use case?

On Thu, Jan 7, 2010 at 11:23 AM, Otis Gospodnetic
<otis_gospodnetic@yahoo.com> wrote:
>> Merge factor controls how many segments are merged at once. =A0The defau=
lt is 10.
>>
>> The maxMergeMB setting sets the max size for a given segment to be
>> included in a merge.
>
> I wonder if renaming that to maxSegSizeMergeMB would make it more obvious=
 what this does?
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>> Roughly, the upper bound on merged segments is the sum of their sizes.
>>
>> So the rough upper bound on any segment's size is mergeFactor * maxMerge=
MB.
>>
>> Mike
>>
>> On Thu, Jan 7, 2010 at 11:04 AM, Dvora wrote:
>> >
>> > Can you explain how the combination of merge factor and max merge size
>> > control the size of files?
>> >
>> > For example, if one would like to limit the files size to 3,4 or 7MB -=
 how
>> > these parameters values can be predicted?
>> >
>> >
>> >
>> > Michael McCandless-2 wrote:
>> >>
>> >>
>> >> This tells the IndexWriter NOT to merge any segment that's over 1.0 M=
B
>> >> in size. =A0With a default merge factor of 10, this should "generally=
"
>> >> mean you don't get a segment over 10MB, though it may not be a hard
>> >> guarantee (you can lower the 1.0 if you still see a segment over 10
>> >> MB).
>> >>
>> >>
>> >
>> > --
>> > View this message in context:
>> http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27=
056573p27062291.html
>> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44404-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 22:35:40 2010
Return-Path: <java-user-return-44404-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87715 invoked from network); 7 Jan 2010 22:35:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 22:35:39 -0000
Received: (qmail 75229 invoked by uid 500); 7 Jan 2010 22:35:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75147 invoked by uid 500); 7 Jan 2010 22:35:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75137 invoked by uid 99); 7 Jan 2010 22:35:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 22:35:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.59] (HELO web50305.mail.re2.yahoo.com) (206.190.38.59)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 07 Jan 2010 22:35:27 +0000
Received: (qmail 67372 invoked by uid 60001); 7 Jan 2010 22:35:06 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262903706; bh=mJT8QGeJBnE+9QgiSI8nM4ybg8o54+cJiolAjd+3b18=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=218CZ9Vjyn4F2jdO+F/aE4HFCJokR4uxfEgtAAiUWyETJgFv+DAMVYOxPlIFl+IFwHal7CZxHEK6Cs1FI0DdSnTnEIxPlEkiFEeLKyeVh9PLidTqpsPDUjjFIGVbmgIUS9gUSXqkYTE3iv+5Mitw/H+3wVKG4y96a1sjDpjrC5o=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=nDlzfRnRK8BD9UOMZSaD2R/em7C+pQb3JlpywG3kLXPq+Jl/lAWVSKuRg28de4ef9P8F3bRYLK6nwr0BuoByxsq4+TGFJ06ZBjohDff0nyh8+aCfJRPNp6B4XDTA+pMpKRHK3pd7IZrtFwj6DGQvt4qrndX62WB0/qax4J4A+VY=;
Message-ID: <164574.66783.qm@web50305.mail.re2.yahoo.com>
X-YMail-OSG: n2TBRpUVM1m28LWuqJaLHgFh4h6wBsB4Vt1pAmmGR.B6JJJHRNALzMAiGlUZtNeUCcaXi861lfeAkdnklIa.hM4n2dt3WvGNvEX_oBDr6.yXSvCSBzPbFoU0L_7YOra3sLDggeXPENgommgHBKJGA65G_cHIgc.DvgawffL4_HL4ywjP8xR4rS6sdhq0Kyc.sl.YYfoz7e1h8ktUSKR__47DmXCiMqOZvsih5TJs1IZD3aXcCkzfx9gR3YzS70At5k103fbpJHJOhwcwhWr8csr1VKu26SPuK8e9jcVNiqvprn1Jc.qelUxm3mPDpIaqIN5NdESqfG0JV1CQvuh.xm8O89VC371cI0dMOQRR3mmsLPg4sKDH_.2kDxrHd.aOJscKNiNIxYlTCfOHkoDVwvtyXDf.mP7NkJFbF46ECrqybGGzlf65Elegu.ahkwiAtTFfFK9ysoSkekHxtCcE0q1ejVG8c6rgE_vHn928EFdQG.KfLpRc1O.d5fg7wMuCEr6QRH0-
Received: from [167.206.188.3] by web50305.mail.re2.yahoo.com via HTTP; Thu, 07 Jan 2010 14:35:01 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <d483d31b1001070628j495cc18dka6a4da7687a71ec0@mail.gmail.com> <d483d31b1001071254w6d50eb02r5a65b7ed087a0b07@mail.gmail.com>
Date: Thu, 7 Jan 2010 14:35:01 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Implementing filtering based on multiple fields
To: java-user@lucene.apache.org
In-Reply-To: <d483d31b1001071254w6d50eb02r5a65b7ed087a0b07@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

For something like CSE, I think you want to isolate users and their data/indices.

I'd look at Bixo or Nutch or Droids ==> Lucene or Solr

Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Yaniv Ben Yosef <yanivby@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thu, January 7, 2010 3:54:22 PM
> Subject: Implementing filtering based on multiple fields
> 
> Hi,
> 
> I'm very new to Lucene. In fact, I'm at the beginning of an evaluation
> phase, trying to figure whether Lucene is the right fit for my needs.
> The project I'm involved in requires something similar to the Google Custom
> Search Engine (CSE). In CSE, each user can
> define a set (could be a large set) of websites, and limit the search to
> only those websites. So for example, I can create a CSE that searches all
> web pages on cnn.com, msnbc.com and nytimes.com only.
> I am trying to understand whether and how I can do something similar in
> Lucene.
> 
> The FAQ hints about this possibility
> here,
> but it mentions a class that no longer exists in 3.0 (QueryFilter), and is
> very laconic about the suggested options. Also I'm not sure how well it will
> perform in my use case (or even if it fits at all).
> I thought about creating a separate index for each user or CSE. However, my
> system should be able to handle tens of thousands of concurrent users. I
> haven't done any analysis yet on how this will affect CPU, RAM, I/O and
> storage size, but was wondering if any of you experienced Lucene
> users/developers think it's a good direction.
> If that's not a good idea, what would be a good strategy here?
> 
> Any help will be much appreciated,
> Yaniv


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44405-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 07 23:56:13 2010
Return-Path: <java-user-return-44405-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11025 invoked from network); 7 Jan 2010 23:56:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 7 Jan 2010 23:56:13 -0000
Received: (qmail 47274 invoked by uid 500); 7 Jan 2010 23:56:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47189 invoked by uid 500); 7 Jan 2010 23:56:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47179 invoked by uid 99); 7 Jan 2010 23:56:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 23:56:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yanivby@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 07 Jan 2010 23:55:59 +0000
Received: by bwz22 with SMTP id 22so12061586bwz.5
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 15:55:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=rOwQ5b4k5Ayme3cfo1NbKts6n+nIBDCjI9EJZC+KNko=;
        b=HqBLZFAPZCRTIbGBLS891yFT6V7mBA9Szxpr/0V2unmslONhEi+eRIDFUx8ETDqh0J
         eGZtDTlFc4prMYIVPoqI4NepbWJlpmsOnifyAG1cjzIqF/KELjVU+xaeOasyKI7M73og
         gQeah5mG2KA5xaS86E3rNO4Eq7DFY8/con5dY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=WMqz9x9kVRdKKxItH6eQRBoVckqnJzNkAiaZ7wVND2Koovtie6NhB505+kOPCEvWQt
         wkBMirXuFKfTTgZDpdRnv/K5J/VP92livzgIHgNk+5HvRI59j1GhX/NXGXWg5QAy35T9
         /n9/M5fQOL8FRzPkvymPUBll8yPYMd/gPjLkU=
MIME-Version: 1.0
Received: by 10.204.6.24 with SMTP id 24mr1690624bkx.25.1262908538420; Thu, 07 
	Jan 2010 15:55:38 -0800 (PST)
In-Reply-To: <164574.66783.qm@web50305.mail.re2.yahoo.com>
References: <d483d31b1001070628j495cc18dka6a4da7687a71ec0@mail.gmail.com> 
	<d483d31b1001071254w6d50eb02r5a65b7ed087a0b07@mail.gmail.com> 
	<164574.66783.qm@web50305.mail.re2.yahoo.com>
From: Yaniv Ben Yosef <yanivby@gmail.com>
Date: Fri, 8 Jan 2010 01:55:18 +0200
Message-ID: <d483d31b1001071555hb2fcb91obf7d40defbb6f53a@mail.gmail.com>
Subject: Re: Implementing filtering based on multiple fields
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0015174c0e9ad0fea7047c9bce0d
X-Virus-Checked: Checked by ClamAV on apache.org

--0015174c0e9ad0fea7047c9bce0d
Content-Type: text/plain; charset=ISO-8859-1

Thanks Otis.

If I understand correctly - Bixo, Nutch and Droids are technologies to use
for crawling the web and building an index. My project is actually about
indexing a large database, where you can think of every row as a web page,
and a particular column is the equivalent of a web site. (I didn't mention
that in the previous post because I didn't want to complicate my question,
and it seems equivalent to Google CSE given that Lucene can use virtually
any input for indexing, AFAIK)
Therefore I'm not sure if the frameworks you've mentioned are applicable to
my project as they seem to be related to web page indexing, but perhaps I'm
missing something.
Also, what did you mean about isolating users and their data/indices. Did
you mean that I should create a separate index per user?

Thanks again!

On Fri, Jan 8, 2010 at 12:35 AM, Otis Gospodnetic <
otis_gospodnetic@yahoo.com> wrote:

> For something like CSE, I think you want to isolate users and their
> data/indices.
>
> I'd look at Bixo or Nutch or Droids ==> Lucene or Solr
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>
>
> ----- Original Message ----
> > From: Yaniv Ben Yosef <yanivby@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Thu, January 7, 2010 3:54:22 PM
> > Subject: Implementing filtering based on multiple fields
> >
> > Hi,
> >
> > I'm very new to Lucene. In fact, I'm at the beginning of an evaluation
> > phase, trying to figure whether Lucene is the right fit for my needs.
> > The project I'm involved in requires something similar to the Google
> Custom
> > Search Engine (CSE). In CSE, each user can
> > define a set (could be a large set) of websites, and limit the search to
> > only those websites. So for example, I can create a CSE that searches all
> > web pages on cnn.com, msnbc.com and nytimes.com only.
> > I am trying to understand whether and how I can do something similar in
> > Lucene.
> >
> > The FAQ hints about this possibility
> > here,
> > but it mentions a class that no longer exists in 3.0 (QueryFilter), and
> is
> > very laconic about the suggested options. Also I'm not sure how well it
> will
> > perform in my use case (or even if it fits at all).
> > I thought about creating a separate index for each user or CSE. However,
> my
> > system should be able to handle tens of thousands of concurrent users. I
> > haven't done any analysis yet on how this will affect CPU, RAM, I/O and
> > storage size, but was wondering if any of you experienced Lucene
> > users/developers think it's a good direction.
> > If that's not a good idea, what would be a good strategy here?
> >
> > Any help will be much appreciated,
> > Yaniv
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0015174c0e9ad0fea7047c9bce0d--

From java-user-return-44406-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 00:09:16 2010
Return-Path: <java-user-return-44406-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13796 invoked from network); 8 Jan 2010 00:09:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 00:09:16 -0000
Received: (qmail 59060 invoked by uid 500); 8 Jan 2010 00:09:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58971 invoked by uid 500); 8 Jan 2010 00:09:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58956 invoked by uid 99); 8 Jan 2010 00:09:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 00:09:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 08 Jan 2010 00:09:03 +0000
Received: (qmail 252 invoked by uid 60001); 8 Jan 2010 00:08:41 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262909321; bh=cX3kx3GAHypOiDiI1aGLYgglyAvxXcxqKdU/goKAw1o=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=zS4L8TsyBG5aL6KojivgY1Tvqj02XbdRc61frrZGRVGzA+h3fjZ20ESNsxLUzi4fjSLl8ybf5yGoGCMESjZITFZ6RWiRM+A5O6jI5OTMyscOcTOVQ5OJHaXxaPfo15LfMploruoVPg2GiU4R1kqRXVZdWH8/clRQWdxDz6p2tos=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=K6Sa3s2SiVrcov4fbK6+Cly8JRJkWPDThNe63J22CrCngHXYBhrAXWGyyLjjswZeiNCVo7RQY0GcIjbVq6Ea6ZyB6spZQzTHEnSBYzjVJqhxISogoePtb8IdL0W0nMvEn/6DMDrvao4JSi/ZLOz4Y98vopzJ1OI0FMNup7lSglM=;
Message-ID: <769800.190.qm@web50307.mail.re2.yahoo.com>
X-YMail-OSG: 0KmOTVcVM1lkpl029wSTyTaTIiAfabZ_YOe9yJNKwHxCf8VjG5gpQZTTLk2SrAZQhk6vEYS_vtUz.U326ZNReIgfrEnzEsq05Rx6gMVdMi_VG6RLItSjc.vCJqxKtO9w1oLZjh9IQ3gpMJs_UgbDOa1oaLu9CrmDdeigfCv4WQuo61N55mrm7AVNEnIL1jdA.Dic7OsPL6MiRKoLKuSnu8Fiz0uwx5gA7FY7cobCs8jQASZcj4wWfb3DBByoK4UUVdJ4JGX8e02_nJGRfLwBRBhRo3TYI8y.10m_X5BkUsbk0xwbouBZlLDaTjOex9fIcF7ZxiSUIxHfpcJRgy6eZjKdOekKA834VSXOdSXSHVXN4X3rH8cmgKEzyJkEOhTpLXbD1PC_8XG3a9mE.x7N1rJfFHduUxbMPoCqfk2dvbJnnfNekj3B.l1uXohlaZfFd__TMq4T4m2i5.xsl9RKzVbdkaOaWJE2mWF8njTJDl6Kbod_vo_9HykDLn2ohLkETqoWkyxpVTqB_FXW6DdSn_E0bfWVcIpplLk-
Received: from [167.206.188.3] by web50307.mail.re2.yahoo.com via HTTP; Thu, 07 Jan 2010 16:08:41 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <d483d31b1001070628j495cc18dka6a4da7687a71ec0@mail.gmail.com>  <d483d31b1001071254w6d50eb02r5a65b7ed087a0b07@mail.gmail.com>  <164574.66783.qm@web50305.mail.re2.yahoo.com> <d483d31b1001071555hb2fcb91obf7d40defbb6f53a@mail.gmail.com>
Date: Thu, 7 Jan 2010 16:08:41 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Implementing filtering based on multiple fields
To: java-user@lucene.apache.org
In-Reply-To: <d483d31b1001071555hb2fcb91obf7d40defbb6f53a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Ah, well, masking it didn't help.  Yes, ignore Bixo, Nutch, and Droids then.
Consider DataImportHandler from Solr or wait a bit for Lucene Connectors Framework to materialize.  Or use LuSql, or DbSight, or Sematext's Database Indexer.

Yes, I was suggesting a separate index for each user.  That's what Simpy uses and has some 200K indices on 1 box.... and I think dozens of QPS without any caching, if I remember correctly.  Load is under 1.0.

Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Yaniv Ben Yosef <yanivby@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thu, January 7, 2010 6:55:18 PM
> Subject: Re: Implementing filtering based on multiple fields
> 
> Thanks Otis.
> 
> If I understand correctly - Bixo, Nutch and Droids are technologies to use
> for crawling the web and building an index. My project is actually about
> indexing a large database, where you can think of every row as a web page,
> and a particular column is the equivalent of a web site. (I didn't mention
> that in the previous post because I didn't want to complicate my question,
> and it seems equivalent to Google CSE given that Lucene can use virtually
> any input for indexing, AFAIK)
> Therefore I'm not sure if the frameworks you've mentioned are applicable to
> my project as they seem to be related to web page indexing, but perhaps I'm
> missing something.
> Also, what did you mean about isolating users and their data/indices. Did
> you mean that I should create a separate index per user?
> 
> Thanks again!
> 
> On Fri, Jan 8, 2010 at 12:35 AM, Otis Gospodnetic <
> otis_gospodnetic@yahoo.com> wrote:
> 
> > For something like CSE, I think you want to isolate users and their
> > data/indices.
> >
> > I'd look at Bixo or Nutch or Droids ==> Lucene or Solr
> >
> > Otis
> > --
> > Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> >
> >
> >
> > ----- Original Message ----
> > > From: Yaniv Ben Yosef 
> > > To: java-user@lucene.apache.org
> > > Sent: Thu, January 7, 2010 3:54:22 PM
> > > Subject: Implementing filtering based on multiple fields
> > >
> > > Hi,
> > >
> > > I'm very new to Lucene. In fact, I'm at the beginning of an evaluation
> > > phase, trying to figure whether Lucene is the right fit for my needs.
> > > The project I'm involved in requires something similar to the Google
> > Custom
> > > Search Engine (CSE). In CSE, each user can
> > > define a set (could be a large set) of websites, and limit the search to
> > > only those websites. So for example, I can create a CSE that searches all
> > > web pages on cnn.com, msnbc.com and nytimes.com only.
> > > I am trying to understand whether and how I can do something similar in
> > > Lucene.
> > >
> > > The FAQ hints about this possibility
> > > here,
> > > but it mentions a class that no longer exists in 3.0 (QueryFilter), and
> > is
> > > very laconic about the suggested options. Also I'm not sure how well it
> > will
> > > perform in my use case (or even if it fits at all).
> > > I thought about creating a separate index for each user or CSE. However,
> > my
> > > system should be able to handle tens of thousands of concurrent users. I
> > > haven't done any analysis yet on how this will affect CPU, RAM, I/O and
> > > storage size, but was wondering if any of you experienced Lucene
> > > users/developers think it's a good direction.
> > > If that's not a good idea, what would be a good strategy here?
> > >
> > > Any help will be much appreciated,
> > > Yaniv
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44407-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 06:23:00 2010
Return-Path: <java-user-return-44407-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9085 invoked from network); 8 Jan 2010 06:23:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 06:23:00 -0000
Received: (qmail 10352 invoked by uid 500); 8 Jan 2010 06:22:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10260 invoked by uid 500); 8 Jan 2010 06:22:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10250 invoked by uid 99); 8 Jan 2010 06:22:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 06:22:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of farhang@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 06:22:48 +0000
Received: by ewy25 with SMTP id 25so23459169ewy.5
        for <java-user@lucene.apache.org>; Thu, 07 Jan 2010 22:22:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=cNYgTM5H+E2Fm4yfqw0B8tfC+CywlKcgI/SjzU7EIkM=;
        b=dqFap545T2bxAxs/NCyDx14N24IiZO51AuqBb1VWvzU0KhiIJacr2CKfliOloOL813
         dP6kGD+t2TDEeEOvcSOPVoJVf+zUPWrENCulpMM7uGhjWkH5Rl/yFKrOQRCekkQb3Vtv
         uGQ3S3jMegHm4ILB545Yr8tN5ah+V3PcpbhAk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=qL6hlv9f7CnZc2x+oHI+rkqT8g8CxgNIIU+dKa2cxhZvt+4+u7Mt85QMt7vKOflK+y
         T+mjNGy5txTaImZA2GnJ2zG5E4Lr1HSUvgW7f14u3YotC0F006YoQxyP7ng4TZltKSqw
         /p5f0o/8lisf8y2IZITE/FzFT1Sl9guBg6VBg=
MIME-Version: 1.0
Received: by 10.216.91.73 with SMTP id g51mr1921085wef.68.1262931747939; Thu, 
	07 Jan 2010 22:22:27 -0800 (PST)
In-Reply-To: <85d3c3b61001071421k60412b15j768bdd6a5a6b35d9@mail.gmail.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27062291.post@talk.nabble.com>
	 <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
	 <633637.37238.qm@web50303.mail.re2.yahoo.com>
	 <85d3c3b61001071421k60412b15j768bdd6a5a6b35d9@mail.gmail.com>
Date: Thu, 7 Jan 2010 23:22:27 -0700
Message-ID: <b0f7deba1001072222w6f517f70q95cf5c0c60efd628@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

>> I wonder if renaming that to maxSegSizeMergeMB would make it more obvious what this does?

How about using the *able* moniker to make it clear we're referring to
the size of the to-be-merged segment, not the resultant merged
segment? I.e. naming it something like "maxMergeableSegSizeMB" ..

On Thu, Jan 7, 2010 at 3:21 PM, Jason Rutherglen
<jason.rutherglen@gmail.com> wrote:
> The naming is unclear, when I looked at this I had to thumb
> through the code a fair bit before discerning if it was the
> input segments or the output segment of a merge (it's the
> former). Though I find the current functionality somewhat odd
> because it will inherently exceed the given size with a merge,
> which is uncontrollable, making the exact setting somewhat
> arbitrary... What was the original use case?
>
> On Thu, Jan 7, 2010 at 11:23 AM, Otis Gospodnetic
> <otis_gospodnetic@yahoo.com> wrote:
>>> Merge factor controls how many segments are merged at once.  The default is 10.
>>>
>>> The maxMergeMB setting sets the max size for a given segment to be
>>> included in a merge.
>>
>> I wonder if renaming that to maxSegSizeMergeMB would make it more obvious what this does?
>>
>> Otis
>> --
>> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>>
>>> Roughly, the upper bound on merged segments is the sum of their sizes.
>>>
>>> So the rough upper bound on any segment's size is mergeFactor * maxMergeMB.
>>>
>>> Mike
>>>
>>> On Thu, Jan 7, 2010 at 11:04 AM, Dvora wrote:
>>> >
>>> > Can you explain how the combination of merge factor and max merge size
>>> > control the size of files?
>>> >
>>> > For example, if one would like to limit the files size to 3,4 or 7MB - how
>>> > these parameters values can be predicted?
>>> >
>>> >
>>> >
>>> > Michael McCandless-2 wrote:
>>> >>
>>> >>
>>> >> This tells the IndexWriter NOT to merge any segment that's over 1.0 MB
>>> >> in size.  With a default merge factor of 10, this should "generally"
>>> >> mean you don't get a segment over 10MB, though it may not be a hard
>>> >> guarantee (you can lower the 1.0 if you still see a segment over 10
>>> >> MB).
>>> >>
>>> >>
>>> >
>>> > --
>>> > View this message in context:
>>> http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27062291.html
>>> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>> >
>>> >
>>> > ---------------------------------------------------------------------
>>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >
>>> >
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44408-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 07:09:13 2010
Return-Path: <java-user-return-44408-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24701 invoked from network); 8 Jan 2010 07:09:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 07:09:12 -0000
Received: (qmail 39483 invoked by uid 500); 8 Jan 2010 07:09:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39421 invoked by uid 500); 8 Jan 2010 07:09:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39411 invoked by uid 99); 8 Jan 2010 07:09:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 07:09:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.163.179.220] (HELO web36106.mail.mud.yahoo.com) (66.163.179.220)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 08 Jan 2010 07:09:01 +0000
Received: (qmail 44743 invoked by uid 60001); 8 Jan 2010 07:08:40 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262934520; bh=U5ED/ia+AvhWibCJn5cp1e89kDpsSNqKAoQ4v2S9Hl8=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=51FRPyXY/VBa5w7UV7b5+LKgyHdz7v9DDv8sEpy48uCqFw1qYi+HYFLDQ8gEK/PtLutImiBnL0rmdr9ucWRHCY4oXtCcPsdRsLg8WTCqt8Uxl1Z0r2PpnkALIcgri2j/kZ3DE8HJALyOGBavh5VMVmWj02nAk8mGZg630z8v3WM=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=ctzBv/4uU9KEQXQR73whXya0Zss2v0InxOTIVrAd12DrDcRXbRWMz4h7yvk+Qw3PKuI/iK/xBgtdxbZB6ME0KZ8X/niWNGBTEwnTnIHgj/zohIBcAlXv+V4g1jpn4kTkLaXo2GEyhjSOK+7K9Rgp+L0G28Ky30AqqOtyHqDf2uw=;
Message-ID: <347682.43740.qm@web36106.mail.mud.yahoo.com>
X-YMail-OSG: Hnk3h6cVM1nWjoGVgkt1fGFP8m7jyXhUL4xB56GMuE7ZaBWAUwU5D5hmHtYfH7P1MEswcOI6sNAmS_QHWKVCceP6utG0mlAwqibRfVdrc30U5Qy9o5e_e8puJ8nNHTTV9TxVJ_dRFfpSM9br43WU3FahHnPI.ywu2UjfIqC25x0LcfIjsiLBG1_R41o7pCzeaXgCoE4Fk0IrB56ym_JJUVqeUDhtfhj0kSFXe_b7u31Zk08Tx6yeHZu.T9n3JCYMz3H6oYst8ef5TVzrsy7D_wUuuXVSW8P7Ok2462PwRRGXx2XkwxHmjSRPyKUAziyUAn7GUVNLMEgn6gY8XkkVCexFYbZYhtWAES.l8dzStZLZtMXblLS7J5u5iKSz55xTbEai3VTTnvGKFrjd1SnR1lTDYDdkeyyR7BHWWAlZ0kA8U7t6qoaXHxO4QssGYj_KMKjmf1MCQYT4TyESo3LYn_CV091X9kQUDDQtHiIF9axMuDe6KnvXpHCO7GVfdjcx1pIwqsw1Iv0b8dmnAVAJuUV2U4dK2DcuPHdpn7s9oHiZx7OCVdrhshGsmO2YWEfs_2oQAf.6lCjphAUtL6Qw.Nz2SlECqHLAFnNDQuM2b8XAraXTXBDAlk92wjqIfiwXW3IdG4dGjM_YysRy3tutntHQgGG6MA9ZRyRz1HquAjYK_wXeKjRXHhg-
Received: from [203.126.190.28] by web36106.mail.mud.yahoo.com via HTTP; Thu, 07 Jan 2010 23:08:40 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Thu, 7 Jan 2010 23:08:40 -0800 (PST)
From: <jyzhou817@yahoo.com>
Subject: a complete solution for building a website search with lucene
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-406780861-1262934520=:43740"

--0-406780861-1262934520=:43740
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

Hi ,

I am new in Lucene.=20

To build a web search function, it need to have a backendc indexing functio=
n. But, before that, should run a Crawler? because Lucene index based on Ht=
ml documents, while Crawler can change the website pages to Html documents.=
 Am i right?=20

If so, please anyone suggest to me a Crawler? like Nutch?
Thanks
Zhou

=0A=0A=0A      New Email names for you! =0AGet the Email name you&#39;ve al=
ways wanted on the new @ymail and @rocketmail. =0AHurry before someone else=
 does!=0Ahttp://mail.promotions.yahoo.com/newdomains/sg/
--0-406780861-1262934520=:43740--

From java-user-return-44409-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 08:28:12 2010
Return-Path: <java-user-return-44409-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41806 invoked from network); 8 Jan 2010 08:28:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 08:28:12 -0000
Received: (qmail 18593 invoked by uid 500); 8 Jan 2010 08:28:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18527 invoked by uid 500); 8 Jan 2010 08:28:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18517 invoked by uid 99); 8 Jan 2010 08:28:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 08:28:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [134.96.191.147] (HELO smtp.dfki.de) (134.96.191.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 08:28:01 +0000
Received: from smtp.dfki.de (localhost [127.0.0.1])
	by imss.7 (Postfix) with ESMTP id 67DE431650
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 09:27:38 +0100 (CET)
Received: from mail.dfki.de (lnv-104.sb.dfki.de [134.96.191.146])
	by smtp.dfki.de (Postfix) with ESMTP id 4EC5B313AC
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 09:27:38 +0100 (CET)
Received: from bledsoe.dfki.uni-sb.de (bledsoe.dfki.uni-sb.de [134.96.184.151])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.dfki.de (Postfix) with ESMTPSA id 3B2FF31117
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 09:27:38 +0100 (CET)
Message-Id: <8849CBD0-43CF-4D38-AB19-5A2B851EF7B7@activemath.org>
From: Paul Libbrecht <paul@activemath.org>
To: java-user@lucene.apache.org
In-Reply-To: <347682.43740.qm@web36106.mail.mud.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: a complete solution for building a website search with lucene
Date: Fri, 8 Jan 2010 09:27:37 +0100
References: <347682.43740.qm@web36106.mail.mud.yahoo.com>
X-Mailer: Apple Mail (2.936)

Zhou,

Lucene is a back-end library, it's very useful for developer but it is =20=

not a complete site-search-engine.
A lucene-based site-search-engine is Nutch, it does crawl.
Solr also provides functions close to these with a large amount of =20
thoughts on flexible integration; crawling methods are rather based on =20=

feeds or other acquisition methods (see DIH for example).

paul




Le 08-janv.-10 =E0 08:08, <jyzhou817@yahoo.com> a =E9crit :

> Hi ,
>
> I am new in Lucene.
>
> To build a web search function, it need to have a backendc indexing =20=

> function. But, before that, should run a Crawler? because Lucene =20
> index based on Html documents, while Crawler can change the website =20=

> pages to Html documents. Am i right?
>
> If so, please anyone suggest to me a Crawler? like Nutch?
> Thanks
> Zhou
>
>
>
>
>      New Email names for you!
> Get the Email name you&#39;ve always wanted on the new @ymail and =20
> @rocketmail.
> Hurry before someone else does!
> http://mail.promotions.yahoo.com/newdomains/sg/


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44410-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 09:07:21 2010
Return-Path: <java-user-return-44410-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48395 invoked from network); 8 Jan 2010 09:07:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 09:07:21 -0000
Received: (qmail 49228 invoked by uid 500); 8 Jan 2010 09:07:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49140 invoked by uid 500); 8 Jan 2010 09:07:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49130 invoked by uid 99); 8 Jan 2010 09:07:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 09:07:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [193.50.192.7] (HELO eiger.univ-valenciennes.fr) (193.50.192.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 09:07:11 +0000
Received: from [193.50.195.115] (pcinfogest21.univ-valenciennes.fr [193.50.195.115])
	by eiger.univ-valenciennes.fr (Postfix) with ESMTP id 30B683EA86
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 10:05:39 +0100 (CET)
Message-ID: <4B46F552.5080302@univ-valenciennes.fr>
Date: Fri, 08 Jan 2010 10:05:22 +0100
From: Yannick Caillaux <yannick.caillaux@univ-valenciennes.fr>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Question about relevance
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-UvhcEiger-MailScanner-Information: Please contact the ISP for more information
X-UvhcEiger-MailScanner: Found to be clean
X-UvhcEiger-MailScanner-SpamScore: ss
X-UvhcEiger-MailScanner-From: yannick.caillaux@univ-valenciennes.fr
X-Old-Spam-Status: No

Hi,

I index 2 documents. the first contains the word "Wallis" in the title 
field. The second has the same title but "Wallis" is replaced by "Wall".
I execute the query : "title:wallis"
During the search, "Wallis" is cut by the FrenchAnalyzer and becomes 
"wall". So the two documents are results for the search.

My problem is : the two results have the same relevance.
I thought that the document containing "Wallis" would have better 
relevance because I search for the word "wallis" and not "wall".

Relevance is calculated from the searched word (wallis) or from the 
analyzed word (wall)? Is there any solution to get better relevance for 
the result "wallis" ?
For information i'm in lucene 2.3.2.

Thanks

Yannick



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44411-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 09:42:59 2010
Return-Path: <java-user-return-44411-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61157 invoked from network); 8 Jan 2010 09:42:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 09:42:59 -0000
Received: (qmail 85502 invoked by uid 500); 8 Jan 2010 09:42:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85415 invoked by uid 500); 8 Jan 2010 09:42:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85405 invoked by uid 99); 8 Jan 2010 09:42:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 09:42:57 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of leon800219@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 09:42:50 +0000
Received: by pwi11 with SMTP id 11so8815171pwi.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 01:42:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=a2E1mW/6qoaFxdorq8M47lWsvek6vc68dihjDXwcB3Q=;
        b=GFk+PRPiuSBQfw0K8d4UuW5MBd3C7A/nOYrqcB5tabzkQfAy17TS2tB+Q113S/aaYC
         DWpEREi+N6xvhkF20v1S2VymZd7xue1DCXTuGciFEp30Y71dvWhTt6gd8H6673jRTmrE
         OJr3y1PvrzFCn9oCc92nV0ojnloTDzc7Bi1gQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=TvaRlWyXYtqQhyvGnwVpnJ0YVo6YiuGlOw/ICzKdMPbV1/y9rUacut3jcLcxJXYvMt
         tw92mM4W+RlB9PU92GS+6BUGmI/8irGQacb5lgEdbZZLBJa5XZLYfbzWjmDWMSuM366P
         AoYNjZshx00IeA/tfp7xVvhAwqnMeezQq7gCY=
MIME-Version: 1.0
Received: by 10.114.237.28 with SMTP id k28mr2413366wah.98.1262943750208; Fri, 
	08 Jan 2010 01:42:30 -0800 (PST)
In-Reply-To: <3a1a1b2b1001072220w2b83effbi74a0359483d37618@mail.gmail.com>
References: <3a1a1b2b1001072220w2b83effbi74a0359483d37618@mail.gmail.com>
Date: Fri, 8 Jan 2010 17:42:30 +0800
Message-ID: <3a1a1b2b1001080142s405b6ad4v65c61e67bd3c6bb1@mail.gmail.com>
Subject: *Only* the matching whole sentence highlighted
From: Li Leon <leon800219@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64b93329a6a48047ca40158

--0016e64b93329a6a48047ca40158
Content-Type: text/plain; charset=ISO-8859-1

Hi all,

I was able to get a whole sentence(including stop words) highlighted with
"StandardAnalyzer" and an empty stop words String[].

The current issue I'm having is that not only the whole sentence got
highlighted but those tokens partially match with the sentence also
highlighted. I tried to use "PhraseQuery" with the appropriate slop to make
only the intended sentence highlighted, but ended up with exception like
below.

My question is - is this a valid direction to go?


Exception in thread "main" java.lang.NoClassDefFoundError:
org/apache/lucene/index/memory/MemoryIndex
 at
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getReaderForField(WeightedSpanTermExtractor.java:361)
 at
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extractWeightedSpanTerms(WeightedSpanTermExtractor.java:282)
 at
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extract(WeightedSpanTermExtractor.java:149)
 at
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getWeightedSpanTerms(WeightedSpanTermExtractor.java:414)
 at
org.apache.lucene.search.highlight.QueryScorer.initExtractor(QueryScorer.java:216)
 at
org.apache.lucene.search.highlight.QueryScorer.init(QueryScorer.java:184)
 at
org.apache.lucene.search.highlight.Highlighter.getBestTextFragments(Highlighter.java:226)
 at
org.apache.lucene.search.highlight.Highlighter.getBestFragments(Highlighter.java:184)
 at
org.apache.lucene.search.highlight.Highlighter.getBestFragments(Highlighter.java:488)
 at Hightlight.main(Hightlight.java:161)




Thanks,

--0016e64b93329a6a48047ca40158--

From java-user-return-44412-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 10:04:16 2010
Return-Path: <java-user-return-44412-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71021 invoked from network); 8 Jan 2010 10:04:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 10:04:16 -0000
Received: (qmail 28039 invoked by uid 500); 8 Jan 2010 10:04:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27954 invoked by uid 500); 8 Jan 2010 10:04:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27944 invoked by uid 99); 8 Jan 2010 10:04:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:04:14 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.163.179.222] (HELO web36108.mail.mud.yahoo.com) (66.163.179.222)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 08 Jan 2010 10:04:04 +0000
Received: (qmail 95397 invoked by uid 60001); 8 Jan 2010 10:03:41 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1262945021; bh=Lhv2uHEUIrH4MuA75lzw1W+Bk7vrX7TMGJN++O9vBl8=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=mJ46QmU58Ww9AIXAdoNgOQGncaouPbXwCFgxrNKANeVIKn32ePw4+gPJ/1O5eX7ABKITrQq/2O3fGrJPq9AyuZOwd9YCwWa6th5E9Y2bJchVXfGcd9dTvzYcHdKNs3pamFJLgomMW2zm0ZdUXWJbv4hLLftHQkQ6GYc5d5+Rj7s=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=Q/K27jdMX3oF2EE1CDBTNXXAcokKkqZAwC1q2fzFFiZc5JowMi1EQqikTMa5ZOc6Vaan+RF0Vp+g0q54K0zN6tydG8Sc7hz3EBAOXCf0cZovbN0K6SrV3Ft00xaPmMPNbUjJVr4NHpMb2OZ7W4hVtdAUn+VjUehuoEDyijrkROk=;
Message-ID: <470573.94266.qm@web36108.mail.mud.yahoo.com>
X-YMail-OSG: c.o3t7IVM1kdLEzlN6pOf9TbFt5M0dT0gRN2mWoPY5LEBgMdxckMl0pwuGbgHyB.rW_._tF7CDF8KURpA2VvpRwxI5B4G18LxvD4jySUSy1tMFPzGL0JNRx6FWM49aZHfO00HRTeI05gulbfl8_Pt4j5ZNaN9QtesXUwmks8BrNwf_3ZxV3EoXABJlE1jqjXpuDBhJb9JrOzo.32UcdN8LJ2FVXxq72hFedLQLrmv6ee1TnGE7AeyE2UIQvTGHmMcpYxeuxfvFp3uc0nUIjfNhANDZKAyMspBPATBG0aNPGq..IqxkIy5XWiSd6O1R3cdv1T.nonhsfVrJhA2puoA0wS_rwRRxkpSIF9RIlu1ZWfozVEfvVHJXap.22X1YtNc_TeO1ncLsvBNX51Z54wAyC1I_l.gf3pb7KqFMDLbBlXSQAEC1q9hKfY8Lwjk6qFWOj46uY0wBuHBq4kia7i1dUYtm0czvJj9iG431.Czfv1XN8KzqUW3B59Cm4QZ6ikOZWQR.PCQFBWuiQiRZIz_pkIZDiR7ML_iBHfRchdK4sThIyFctUAlxjJ4fEXstjqzfpwlHXVfdwwbfKHuboOjMvV2KY.QK1yFHJbDZyAdLvUwUODj7vCaIVZdX.YBkwEkInm5Q--
Received: from [203.126.190.28] by web36108.mail.mud.yahoo.com via HTTP; Fri, 08 Jan 2010 02:03:41 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Fri, 8 Jan 2010 02:03:41 -0800 (PST)
From: <jyzhou817@yahoo.com>
Subject: Re: a complete solution for building a website search with lucene
To: java-user@lucene.apache.org
In-Reply-To: <8849CBD0-43CF-4D38-AB19-5A2B851EF7B7@activemath.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-482585114-1262945021=:94266"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-482585114-1262945021=:94266
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Hi Paul,

Thanks.=20
Use Nutch to do crawling. and integrate Lucene to the web application, so t=
hat can do search online.

BTW, Nutch seems to have only Linux version, what my development is on Wind=
ows. Am i right?

Zhou

--- On Fri, 8/1/10, Paul Libbrecht <paul@activemath.org> wrote:

From: Paul Libbrecht <paul@activemath.org>
Subject: Re: a complete solution for building a website search with lucene
To: java-user@lucene.apache.org
Date: Friday, 8 January, 2010, 4:27 PM

Zhou,

Lucene is a back-end library, it's very useful for developer but it is not =
a complete site-search-engine.
A lucene-based site-search-engine is Nutch, it does crawl.
Solr also provides functions close to these with a large amount of thoughts=
 on flexible integration; crawling methods are rather based on feeds or oth=
er acquisition methods (see DIH for example).

paul




Le 08-janv.-10 =E0 08:08, <jyzhou817@yahoo.com> a =E9crit :

> Hi ,
>=20
> I am new in Lucene.
>=20
> To build a web search function, it need to have a backendc indexing funct=
ion. But, before that, should run a Crawler? because Lucene index based on =
Html documents, while Crawler can change the website pages to Html document=
s. Am i right?
>=20
> If so, please anyone suggest to me a Crawler? like Nutch?
> Thanks
> Zhou
>=20
>=20
>=20
>=20
>=A0 =A0 =A0 New Email names for you!
> Get the Email name you've always wanted on the new @ymail and @rocketmail=
.
> Hurry before someone else does!
> http://mail.promotions.yahoo.com/newdomains/sg/


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      New Email names for you! =0AGet the Email name you&#39;ve al=
ways wanted on the new @ymail and @rocketmail. =0AHurry before someone else=
 does!=0Ahttp://mail.promotions.yahoo.com/newdomains/sg/
--0-482585114-1262945021=:94266--

From java-user-return-44413-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 10:12:05 2010
Return-Path: <java-user-return-44413-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74592 invoked from network); 8 Jan 2010 10:12:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 10:12:04 -0000
Received: (qmail 42636 invoked by uid 500); 8 Jan 2010 10:12:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42564 invoked by uid 500); 8 Jan 2010 10:12:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42554 invoked by uid 99); 8 Jan 2010 10:12:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:12:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:11:51 +0000
Received: by fxm2 with SMTP id 2so16913568fxm.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 02:11:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=/IXq6R92FMAjcXTUxgKH+zdX3B/SkCs/jh4+oP6hy1Y=;
        b=KjbkLxRkSy2qoO6VvVT0XBIh05ZRobL3hdzPVHPEYVoNoNgTPeovqiUIusTMVxcVbD
         mHrlJm3PaHIVokXDJE4O9VGsDG+JoGkTC7NywBDzWwsoki366FcsnJcmAXzm+UFGk/i1
         SUL83NXikLZXOLbtmFBjK0qwNP5aAD57FmwdU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=AxlpmloLUSS7uZOtRqrn6T+hQ7PjR+ZSs0egZIFJWDi9nVnjVug5inkH5O6paSF7ox
         RsoiIac3wTLoNDaNOopKWcfj6imP902ytiYTAxvTy67zOuitRw2/SoXnWfjTqG4oLRkh
         v+XIBH0KFq/N7nUkswHv/JMpg/OUkK8YAdTCg=
MIME-Version: 1.0
Received: by 10.239.144.100 with SMTP id n36mr242016hba.19.1262945491414; Fri, 
	08 Jan 2010 02:11:31 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <3a1a1b2b1001080142s405b6ad4v65c61e67bd3c6bb1@mail.gmail.com>
References: <3a1a1b2b1001072220w2b83effbi74a0359483d37618@mail.gmail.com>
	 <3a1a1b2b1001080142s405b6ad4v65c61e67bd3c6bb1@mail.gmail.com>
Date: Fri, 8 Jan 2010 11:11:31 +0100
Message-ID: <f18c9dde1001080211n2b665665h784ea6a7c82e4314@mail.gmail.com>
Subject: Re: *Only* the matching whole sentence highlighted
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

You need contrib-memory.jar in your classpath to use MemoryIndex.

simon

On Fri, Jan 8, 2010 at 10:42 AM, Li Leon <leon800219@gmail.com> wrote:
> Hi all,
>
> I was able to get a whole sentence(including stop words) highlighted with
> "StandardAnalyzer" and an empty stop words String[].
>
> The current issue I'm having is that not only the whole sentence got
> highlighted but those tokens partially match with the sentence also
> highlighted. I tried to use "PhraseQuery" with the appropriate slop to ma=
ke
> only the intended sentence highlighted, but ended up with exception like
> below.
>
> My question is - is this a valid direction to go?
>
>
> Exception in thread "main" java.lang.NoClassDefFoundError:
> org/apache/lucene/index/memory/MemoryIndex
> =C2=A0at
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getReaderFor=
Field(WeightedSpanTermExtractor.java:361)
> =C2=A0at
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extractWeigh=
tedSpanTerms(WeightedSpanTermExtractor.java:282)
> =C2=A0at
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extract(Weig=
htedSpanTermExtractor.java:149)
> =C2=A0at
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getWeightedS=
panTerms(WeightedSpanTermExtractor.java:414)
> =C2=A0at
> org.apache.lucene.search.highlight.QueryScorer.initExtractor(QueryScorer.=
java:216)
> =C2=A0at
> org.apache.lucene.search.highlight.QueryScorer.init(QueryScorer.java:184)
> =C2=A0at
> org.apache.lucene.search.highlight.Highlighter.getBestTextFragments(Highl=
ighter.java:226)
> =C2=A0at
> org.apache.lucene.search.highlight.Highlighter.getBestFragments(Highlight=
er.java:184)
> =C2=A0at
> org.apache.lucene.search.highlight.Highlighter.getBestFragments(Highlight=
er.java:488)
> =C2=A0at Hightlight.main(Hightlight.java:161)
>
>
>
>
> Thanks,
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44414-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 10:17:23 2010
Return-Path: <java-user-return-44414-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77984 invoked from network); 8 Jan 2010 10:17:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 10:17:23 -0000
Received: (qmail 50960 invoked by uid 500); 8 Jan 2010 10:17:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50883 invoked by uid 500); 8 Jan 2010 10:17:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50873 invoked by uid 99); 8 Jan 2010 10:17:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:17:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:17:13 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NTBtk-0006SP-Vd
	for java-user@lucene.apache.org; Fri, 08 Jan 2010 02:16:52 -0800
Message-ID: <27073866.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 02:16:52 -0800 (PST)
From: hrishim <smarthrish@yahoo.co.in>
To: java-user@lucene.apache.org
Subject: Term Frequency for phrases
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: smarthrish@yahoo.co.in


Hi .
I have phrases like brain natriuretic peptide indexed as a single token
using Lucene.
When I calculate the term frequency for the same  the count is 0 since the
tokens from the text are indexed separately i.e. brain , natriuretic ,
peptide.
Is there a way to solve this problem and get the term frequency for the
entire phrase ?

Regards,
Hrishi
-- 
View this message in context: http://old.nabble.com/Term-Frequency-for-phrases-tp27073866p27073866.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44415-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 10:17:30 2010
Return-Path: <java-user-return-44415-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78100 invoked from network); 8 Jan 2010 10:17:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 10:17:30 -0000
Received: (qmail 53248 invoked by uid 500); 8 Jan 2010 10:17:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53200 invoked by uid 500); 8 Jan 2010 10:17:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53190 invoked by uid 99); 8 Jan 2010 10:17:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:17:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yanivby@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:17:18 +0000
Received: by bwz22 with SMTP id 22so12227581bwz.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 02:16:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=+3Kvk1mVB9L2I66zUtlGo9mgofJij7pahxuu5i98C74=;
        b=gM66wQovsjZ/+FS+2AJu3en/BKed/MYa0QGWMlTamLYurn7sYEuPMAI2gZ895ItHz0
         ACnorLNzpHJ/xbR4S6VQU64j+xjW15huBxfo/RdGVNbEBgHkTHFr3coYKOARu6CtgPTV
         vp9eOhsextdU3Rfp4K4K6kNi9KsOKjCeCIdps=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=dbf34WANJO9sk07MSMm9RIx6PLdZ96AKB/7N30hIBnVrTVD8Mhj4bmj+KWQ1WtG7PD
         +ppPDJ22tXi2/90yA0jrTso7F09rsFIyf9Sf+e8fRXzqluww+oqkJDs0J6RqOLKB4sms
         D+4qVbwjRzxGq8sIVLjzKJtoxxGj5pT/UirSU=
MIME-Version: 1.0
Received: by 10.204.0.69 with SMTP id 5mr269712bka.173.1262945817160; Fri, 08 
	Jan 2010 02:16:57 -0800 (PST)
In-Reply-To: <769800.190.qm@web50307.mail.re2.yahoo.com>
References: <d483d31b1001070628j495cc18dka6a4da7687a71ec0@mail.gmail.com> 
	<d483d31b1001071254w6d50eb02r5a65b7ed087a0b07@mail.gmail.com> 
	<164574.66783.qm@web50305.mail.re2.yahoo.com> <d483d31b1001071555hb2fcb91obf7d40defbb6f53a@mail.gmail.com> 
	<769800.190.qm@web50307.mail.re2.yahoo.com>
From: Yaniv Ben Yosef <yanivby@gmail.com>
Date: Fri, 8 Jan 2010 12:16:37 +0200
Message-ID: <d483d31b1001080216m566d2698m6e7bb0f2586c6446@mail.gmail.com>
Subject: Re: Implementing filtering based on multiple fields
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00151750e336cd6d9e047ca47c2c

--00151750e336cd6d9e047ca47c2c
Content-Type: text/plain; charset=ISO-8859-1

Thanks Otis, that's very helpful.

On Fri, Jan 8, 2010 at 2:08 AM, Otis Gospodnetic <otis_gospodnetic@yahoo.com
> wrote:

> Ah, well, masking it didn't help.  Yes, ignore Bixo, Nutch, and Droids
> then.
> Consider DataImportHandler from Solr or wait a bit for Lucene Connectors
> Framework to materialize.  Or use LuSql, or DbSight, or Sematext's Database
> Indexer.
>
> Yes, I was suggesting a separate index for each user.  That's what Simpy
> uses and has some 200K indices on 1 box.... and I think dozens of QPS
> without any caching, if I remember correctly.  Load is under 1.0.
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>
>
> ----- Original Message ----
> > From: Yaniv Ben Yosef <yanivby@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Thu, January 7, 2010 6:55:18 PM
> > Subject: Re: Implementing filtering based on multiple fields
> >
> > Thanks Otis.
> >
> > If I understand correctly - Bixo, Nutch and Droids are technologies to
> use
> > for crawling the web and building an index. My project is actually about
> > indexing a large database, where you can think of every row as a web
> page,
> > and a particular column is the equivalent of a web site. (I didn't
> mention
> > that in the previous post because I didn't want to complicate my
> question,
> > and it seems equivalent to Google CSE given that Lucene can use virtually
> > any input for indexing, AFAIK)
> > Therefore I'm not sure if the frameworks you've mentioned are applicable
> to
> > my project as they seem to be related to web page indexing, but perhaps
> I'm
> > missing something.
> > Also, what did you mean about isolating users and their data/indices. Did
> > you mean that I should create a separate index per user?
> >
> > Thanks again!
> >
> > On Fri, Jan 8, 2010 at 12:35 AM, Otis Gospodnetic <
> > otis_gospodnetic@yahoo.com> wrote:
> >
> > > For something like CSE, I think you want to isolate users and their
> > > data/indices.
> > >
> > > I'd look at Bixo or Nutch or Droids ==> Lucene or Solr
> > >
> > > Otis
> > > --
> > > Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> > >
> > >
> > >
> > > ----- Original Message ----
> > > > From: Yaniv Ben Yosef
> > > > To: java-user@lucene.apache.org
> > > > Sent: Thu, January 7, 2010 3:54:22 PM
> > > > Subject: Implementing filtering based on multiple fields
> > > >
> > > > Hi,
> > > >
> > > > I'm very new to Lucene. In fact, I'm at the beginning of an
> evaluation
> > > > phase, trying to figure whether Lucene is the right fit for my needs.
> > > > The project I'm involved in requires something similar to the Google
> > > Custom
> > > > Search Engine (CSE). In CSE, each user can
> > > > define a set (could be a large set) of websites, and limit the search
> to
> > > > only those websites. So for example, I can create a CSE that searches
> all
> > > > web pages on cnn.com, msnbc.com and nytimes.com only.
> > > > I am trying to understand whether and how I can do something similar
> in
> > > > Lucene.
> > > >
> > > > The FAQ hints about this possibility
> > > > here,
> > > > but it mentions a class that no longer exists in 3.0 (QueryFilter),
> and
> > > is
> > > > very laconic about the suggested options. Also I'm not sure how well
> it
> > > will
> > > > perform in my use case (or even if it fits at all).
> > > > I thought about creating a separate index for each user or CSE.
> However,
> > > my
> > > > system should be able to handle tens of thousands of concurrent
> users. I
> > > > haven't done any analysis yet on how this will affect CPU, RAM, I/O
> and
> > > > storage size, but was wondering if any of you experienced Lucene
> > > > users/developers think it's a good direction.
> > > > If that's not a good idea, what would be a good strategy here?
> > > >
> > > > Any help will be much appreciated,
> > > > Yaniv
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00151750e336cd6d9e047ca47c2c--

From java-user-return-44416-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 10:21:06 2010
Return-Path: <java-user-return-44416-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80329 invoked from network); 8 Jan 2010 10:21:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 10:21:06 -0000
Received: (qmail 61194 invoked by uid 500); 8 Jan 2010 10:21:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61121 invoked by uid 500); 8 Jan 2010 10:21:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61111 invoked by uid 99); 8 Jan 2010 10:21:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:21:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:20:56 +0000
Received: by yxe3 with SMTP id 3so17804846yxe.20
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 02:20:34 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.102.5 with SMTP id z5mr44214637ybb.160.1262946034449; Fri, 
	08 Jan 2010 02:20:34 -0800 (PST)
In-Reply-To: <27073866.post@talk.nabble.com>
References: <27073866.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 05:20:34 -0500
Message-ID: <9ac0c6aa1001080220l2a2897e6wa69b3ed0c1cb09d0@mail.gmail.com>
Subject: Re: Term Frequency for phrases
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Issue a PhraseQuery and count how many hits came back?  Is that too
slow?  If so, you could detect all phrases during indexing and add
them as tokens to the index?

Mike

On Fri, Jan 8, 2010 at 5:16 AM, hrishim <smarthrish@yahoo.co.in> wrote:
>
> Hi .
> I have phrases like brain natriuretic peptide indexed as a single token
> using Lucene.
> When I calculate the term frequency for the same =A0the count is 0 since =
the
> tokens from the text are indexed separately i.e. brain , natriuretic ,
> peptide.
> Is there a way to solve this problem and get the term frequency for the
> entire phrase ?
>
> Regards,
> Hrishi
> --
> View this message in context: http://old.nabble.com/Term-Frequency-for-ph=
rases-tp27073866p27073866.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44417-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 10:27:20 2010
Return-Path: <java-user-return-44417-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83501 invoked from network); 8 Jan 2010 10:27:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 10:27:20 -0000
Received: (qmail 70966 invoked by uid 500); 8 Jan 2010 10:27:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70897 invoked by uid 500); 8 Jan 2010 10:27:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70887 invoked by uid 99); 8 Jan 2010 10:27:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:27:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.217.225] (HELO mail-gx0-f225.google.com) (209.85.217.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:27:11 +0000
Received: by gxk25 with SMTP id 25so2634207gxk.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 02:26:50 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.235.5 with SMTP id i5mr6157560ybh.271.1262946407602; Fri, 
	08 Jan 2010 02:26:47 -0800 (PST)
In-Reply-To: <b0f7deba1001072222w6f517f70q95cf5c0c60efd628@mail.gmail.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27062291.post@talk.nabble.com>
	 <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
	 <633637.37238.qm@web50303.mail.re2.yahoo.com>
	 <85d3c3b61001071421k60412b15j768bdd6a5a6b35d9@mail.gmail.com>
	 <b0f7deba1001072222w6f517f70q95cf5c0c60efd628@mail.gmail.com>
Date: Fri, 8 Jan 2010 05:26:47 -0500
Message-ID: <9ac0c6aa1001080226g4e39e848yf311ef42177577e@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Fri, Jan 8, 2010 at 1:22 AM, Babak Farhang <farhang@gmail.com> wrote:
>>> I wonder if renaming that to maxSegSizeMergeMB would make it more obvious what this does?
>
> How about using the *able* moniker to make it clear we're referring to
> the size of the to-be-merged segment, not the resultant merged
> segment? I.e. naming it something like "maxMergeableSegSizeMB" ..

I like this the best so far!  It's clear that it applies to the
segments to-be-merged, not the final merged segments.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44418-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 10:35:48 2010
Return-Path: <java-user-return-44418-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87242 invoked from network); 8 Jan 2010 10:35:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 10:35:48 -0000
Received: (qmail 87543 invoked by uid 500); 8 Jan 2010 10:35:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87477 invoked by uid 500); 8 Jan 2010 10:35:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87467 invoked by uid 99); 8 Jan 2010 10:35:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 10:35:46 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.176.43] (HELO web26506.mail.ukl.yahoo.com) (217.146.176.43)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 08 Jan 2010 10:35:34 +0000
Received: (qmail 75165 invoked by uid 60001); 8 Jan 2010 10:35:11 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.fr; s=s1024; t=1262946911; bh=i56Uh2Xc0Fv6pEYkoURvLDPLEFBlDZfP3sD0fZfSM2k=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=0+vdz12Q2Bf1D6O4RKzJCEEE/5Afywhw0nLMha9Sg/xDg5mVgfLg1pZYse4+ey7tLpSeogCcQGMYtH7SydHItqJppx9p0gvr9giaHhTDtHjLqskVJT++T7k8UXW+FjgGrz+32cZV+Sen6l1KCM3PfbcxF84QoYlUVBqDx83pvQo=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=Fj6uTYP4o4eaZo1lCdOZGXMhBpL6eslxs0r3OZG0yVSdeViPUem3za3EJ1zdp5zPJqB+alPY9ZNJiPLsPnkDN4amgh5hqSMqpn3kXySk0dAzIW5pua1LWQqUP28D5GpItYEMAs9q4phPQvAMc7r+qmxjGU7ZSKqBMgaVQ18/OdA=;
Message-ID: <394936.36675.qm@web26506.mail.ukl.yahoo.com>
X-YMail-OSG: cL_X24gVM1m9MSoaTgnKXBq7Xn71S6RoiXGfKbnrH.aamxCbzH.akyxoVzSO2Ug1c12pFdjGELElw1.ZH0OdufDfmgr6Dz8XPchNDvmk7_AnnCWWp_z_gIE3UMXGwTGu3l9BBGYS23Yfmtgo8brOtVkYe0TnUCvAOQq.EW25PEcdqku7cU0I3bGLgJ9HB42CFbkkV8gUaoluL9xg5iuQDt11iIHWcXhwhXRK5jtspzeM.tZ7wMHpNyntexpg2VJZYSmsz7Sk4S__T2mLUF2Zjh27l01arsYh
Received: from [193.49.212.209] by web26506.mail.ukl.yahoo.com via HTTP; Fri, 08 Jan 2010 10:35:11 GMT
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Fri, 8 Jan 2010 10:35:11 +0000 (GMT)
From: legrand thomas <thomaslegrand14@yahoo.fr>
Subject: Concurrent access IndexReader / IndexWriter - FileNotFoundException
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-159465710-1262946911=:36675"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-159465710-1262946911=:36675
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

I often get a FileNotFoundException when my single IndexWriter commits whil=
e the IndexReader also tries to read. My application is multithreaded (Tomc=
at uses the business APIs); I firstly thought the read/write access was thr=
ead-safe but I probably forget something.

=A0Please help me to understand my mistakes:

- When should I close the IndexWriter ? Each time I add/update a document o=
r never ?
- Should my java commit/read methods be synchronized ?
- Should I lock the directory and what's the best way to do it ?=20

I referred to the Lucene FAQ ("why do I sometimes get a FileNotFoundExcepti=
on when I search and update my index at the same time?") but I did not disa=
ble any locking for processes searching or updating the index.

I use lucene-2.4.1.

Thanks in advance,
Tom
=0A=0A=0A      
--0-159465710-1262946911=:36675--

From java-user-return-44419-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 11:03:12 2010
Return-Path: <java-user-return-44419-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94377 invoked from network); 8 Jan 2010 11:03:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 11:03:12 -0000
Received: (qmail 14187 invoked by uid 500); 8 Jan 2010 11:03:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14098 invoked by uid 500); 8 Jan 2010 11:03:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14088 invoked by uid 99); 8 Jan 2010 11:03:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 11:03:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erik.hatcher@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 11:03:00 +0000
Received: by qw-out-2122.google.com with SMTP id 5so2051642qwi.53
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 03:02:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=TAYloNSy1Dw/+HLWJMgkg+32EvL2zPCqmK2SQmyaUnA=;
        b=HFB9Gjr1T/uy68RHWgQMajNwA7DBOgkKynHb1TjJuO4UsUjmvT9fmlq9/0Q2376t9L
         KqBLgPcVeA80onXVbft4CR9/83ijfkYZhRLQF8UAtFxuMr2wW39C8607bxbZRugDabNM
         C/4QawYY2qWrkxyAQlUfjPqkLJAioIKjb8rd0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=GHMZ6Foar96SVPeVcrIArtFDMCfM3R/F2/ReV2pZH7Jn2NDxJV3kdKFQZ1MvN1WsDf
         TLG4o9oNWB3AuBFriJugB15YOuw9SEMloAyXjTfhUaDjB0PwHmegaAD4oSeIicClxoYJ
         6yvESnSwU6cDvo7rxuViXzMlbQN2ZS/lcbn98=
Received: by 10.224.72.195 with SMTP id n3mr14421869qaj.79.1262948559776;
        Fri, 08 Jan 2010 03:02:39 -0800 (PST)
Received: from ?10.0.1.69? (va-76-1-144-146.dhcp.embarqhsd.net [76.1.144.146])
        by mx.google.com with ESMTPS id 8sm62129908qwj.53.2010.01.08.03.02.38
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 08 Jan 2010 03:02:38 -0800 (PST)
Message-Id: <6618AD96-0591-4BD6-970E-C7E3F69A6A6D@gmail.com>
From: Erik Hatcher <erik.hatcher@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <4B46F552.5080302@univ-valenciennes.fr>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Question about relevance
Date: Fri, 8 Jan 2010 06:02:36 -0500
References: <4B46F552.5080302@univ-valenciennes.fr>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

One technique I've seen commonly used is to index both stemmed and  
unstemmed fields, and during search query both and boost the unstemmed  
field matches higher.

	Erik

On Jan 8, 2010, at 4:05 AM, Yannick Caillaux wrote:

> Hi,
>
> I index 2 documents. the first contains the word "Wallis" in the  
> title field. The second has the same title but "Wallis" is replaced  
> by "Wall".
> I execute the query : "title:wallis"
> During the search, "Wallis" is cut by the FrenchAnalyzer and becomes  
> "wall". So the two documents are results for the search.
>
> My problem is : the two results have the same relevance.
> I thought that the document containing "Wallis" would have better  
> relevance because I search for the word "wallis" and not "wall".
>
> Relevance is calculated from the searched word (wallis) or from the  
> analyzed word (wall)? Is there any solution to get better relevance  
> for the result "wallis" ?
> For information i'm in lucene 2.3.2.
>
> Thanks
>
> Yannick
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44420-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 12:01:24 2010
Return-Path: <java-user-return-44420-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12864 invoked from network); 8 Jan 2010 12:01:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 12:01:23 -0000
Received: (qmail 72319 invoked by uid 500); 8 Jan 2010 12:01:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72269 invoked by uid 500); 8 Jan 2010 12:01:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72259 invoked by uid 99); 8 Jan 2010 12:01:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 12:01:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 12:01:14 +0000
Received: by yxe3 with SMTP id 3so17858913yxe.20
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 04:00:51 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.16.3 with SMTP id t3mr2810284ybi.264.1262952051155; Fri, 
	08 Jan 2010 04:00:51 -0800 (PST)
In-Reply-To: <394936.36675.qm@web26506.mail.ukl.yahoo.com>
References: <394936.36675.qm@web26506.mail.ukl.yahoo.com>
Date: Fri, 8 Jan 2010 07:00:51 -0500
Message-ID: <9ac0c6aa1001080400m7918fc6ahe7c7880cb62b3d4c@mail.gmail.com>
Subject: Re: Concurrent access IndexReader / IndexWriter - 
	FileNotFoundException
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Normally, this (using an IndexReader, [re-]opening a new IndexReader
while an IndexWriter is committing) is perfectly fine.  The reader
searches the point-in-time snapshot of the index as of when it was
opened.

But: what filesystem are you using?  NFS presents challenges, for example.

Mike

On Fri, Jan 8, 2010 at 5:35 AM, legrand thomas <thomaslegrand14@yahoo.fr> w=
rote:
> Hi,
>
> I often get a FileNotFoundException when my single IndexWriter commits wh=
ile the IndexReader also tries to read. My application is multithreaded (To=
mcat uses the business APIs); I firstly thought the read/write access was t=
hread-safe but I probably forget something.
>
> =A0Please help me to understand my mistakes:
>
> - When should I close the IndexWriter ? Each time I add/update a document=
 or never ?
> - Should my java commit/read methods be synchronized ?
> - Should I lock the directory and what's the best way to do it ?
>
> I referred to the Lucene FAQ ("why do I sometimes get a FileNotFoundExcep=
tion when I search and update my index at the same time?") but I did not di=
sable any locking for processes searching or updating the index.
>
> I use lucene-2.4.1.
>
> Thanks in advance,
> Tom
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44421-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 12:56:29 2010
Return-Path: <java-user-return-44421-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34296 invoked from network); 8 Jan 2010 12:56:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 12:56:29 -0000
Received: (qmail 40515 invoked by uid 500); 8 Jan 2010 12:56:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40440 invoked by uid 500); 8 Jan 2010 12:56:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40430 invoked by uid 99); 8 Jan 2010 12:56:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 12:56:27 +0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [62.146.193.99] (HELO mx.billiger.de) (62.146.193.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 12:56:16 +0000
Received: from solute-exc2k7.solute.ka (norad.solute-gmbh.de [145.253.139.66])
	by mx.billiger.de (Postfix) with ESMTPS id 3A7E385F996
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 13:55:58 +0100 (CET)
Received: from solute-exc2k7.solute.ka ([10.1.1.3]) by solute-exc2k7.solute.ka
 ([10.1.1.3]) with mapi; Fri, 8 Jan 2010 13:55:55 +0100
From: Yuliya Palchaninava <yp@solute.de>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 8 Jan 2010 13:55:55 +0100
Subject: AW: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not 	optimized index
Thread-Topic: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not 	optimized index
Thread-Index: AcqPuuFsZwpsqdm6S/an2UDxqFXEVQApDACA
Message-ID: <0523297188849D479C16D5657F665769BB5CED4872@solute-exc2k7.solute.ka>
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
	 <943192.67571.qm@web50305.mail.re2.yahoo.com>
	 <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
 <9ac0c6aa1001070859q3363ac1k68786a0165999219@mail.gmail.com>
In-Reply-To: <9ac0c6aa1001070859q3363ac1k68786a0165999219@mail.gmail.com>
Accept-Language: en-US, de-DE
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, de-DE
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Michael.

You are probably wright.

Not optimized size is 4.1G, optimized index is about 15G.

Yes, our documents do have many different indexed fields and norms are enab=
led.
Nr of fields: 559
Nr of documents: 20845906
Nr of terms: 25615389

Could you please give me a more detailled explanation, how the storage of n=
orms effects the size of an index.
What do you mean exactly with "norms are not stored sparsely"?

Thanks,
Yuliya

> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]=20
> Gesendet: Donnerstag, 7. Januar 2010 18:00
> An: java-user@lucene.apache.org
> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice as=20
> large as the not optimized index
>=20
> Do your documents have many different indexed fields?  If you=20
> do, and norms are enabled, that could be the cause (norms are=20
> not stored sparsely).
>=20
> But: what actual sizes are we talking about?
>=20
> Mike
>=20
> On Thu, Jan 7, 2010 at 11:50 AM, Yuliya Palchaninava=20
> <yp@solute.de> wrote:
> > Otis,
> >
> > thanks for the answer.
> >
> > Unfortunatelly the index *directory* remains larger *after"=20
> the optimization.
> > In our case the otimization was/is completed successfully=20
> and, as you=20
> > say, there is only one segment in the directory.
> >
> > Some other ideas?
> >
> > Thanks,
> > Yuliya
> >
> >> -----Urspr=FCngliche Nachricht-----
> >> Von: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]
> >> Gesendet: Donnerstag, 7. Januar 2010 17:35
> >> An: java-user@lucene.apache.org
> >> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice=20
> as large=20
> >> as the not optimized index
> >>
> >> Yuliya,
> >>
> >> The index *directory* will be larger *while* you are optimizing. =A0
> >> After the optimization is completed successfully, the=20
> index directory=20
> >> will be smaller. =A0It is possible that your index directory is=20
> >> large(r) because you have some left-over segments (e.g. from some=20
> >> earlier failed/interrupted optimizations) that are not=20
> really a part=20
> >> of the index. =A0After optimizing, you should have only 1=20
> segment, so=20
> >> if you see more than 1 segment, look at the ones with older=20
> >> timestamps. =A0Those can be (re)moved.
> >>
> >> =A0Otis
> >> --
> >> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> >>
> >>
> >>
> >> ----- Original Message ----
> >> > From: Yuliya Palchaninava <yp@solute.de>
> >> > To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
> >> > Sent: Thu, January 7, 2010 11:23:08 AM
> >> > Subject: Lucene 2.9 and 3.0: Optimized index is thrice as
> >> large as the
> >> > not optimized index
> >> >
> >> > Hi,
> >> >
> >> > According to the api documentation: "In general, once=20
> the optimize=20
> >> > completes, the total size of the index will be less than
> >> the size of
> >> > the starting index. It could be quite a bit smaller (if=20
> there were=20
> >> > many pending deletes) or just slightly smaller". In our
> >> case the index
> >> > becomes not smaller but larger, namely thrice as large.
> >> >
> >> > The not optimized index doesn't contain compressed fields,
> >> what could
> >> > have caused the growth of the index due to the=20
> otimization. So we=20
> >> > cannot explain what happens.
> >> >
> >> > Does someone have an explanation for the index growth due
> >> to the optimization?
> >> >
> >> > Thanks,
> >> > Yuliya
> >> >
> >> >
> >> >
> >>=20
> ---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >>=20
> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >=20
> ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
> =

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44422-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 13:38:58 2010
Return-Path: <java-user-return-44422-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51845 invoked from network); 8 Jan 2010 13:38:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 13:38:58 -0000
Received: (qmail 98312 invoked by uid 500); 8 Jan 2010 13:38:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98226 invoked by uid 500); 8 Jan 2010 13:38:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98216 invoked by uid 99); 8 Jan 2010 13:38:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 13:38:55 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.225] (HELO mail-gx0-f225.google.com) (209.85.217.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 13:38:45 +0000
Received: by mail-gx0-f225.google.com with SMTP id 25so2739257gxk.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 05:38:24 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.235.5 with SMTP id i5mr6462470ybh.271.1262957904243; Fri, 
	08 Jan 2010 05:38:24 -0800 (PST)
In-Reply-To: <0523297188849D479C16D5657F665769BB5CED4872@solute-exc2k7.solute.ka>
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
	 <943192.67571.qm@web50305.mail.re2.yahoo.com>
	 <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
	 <9ac0c6aa1001070859q3363ac1k68786a0165999219@mail.gmail.com>
	 <0523297188849D479C16D5657F665769BB5CED4872@solute-exc2k7.solute.ka>
Date: Fri, 8 Jan 2010 08:38:24 -0500
Message-ID: <9ac0c6aa1001080538k11bd56f9n1a6b7eaa86cba1be@mail.gmail.com>
Subject: Re: Lucene 2.9 and 3.0: Optimized index is thrice as large as the not 
	optimized index
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Lucene stores 1 byte (disk and RAM, when searching that field) per
document for any field that has norms enabled, even for documents that
do not contain that field.

In your case, that's ~20 MB per field (once optimize is done), times
559 fields =3D ~11TB of storage.

You should index these fields with Field.Index.ANALYZED_NO_NORMS to
turn off norms.  But, this means field/doc boosting, and the normal
length boosting Lucene normally does (shorter documents get a better
score), will be silently disabled.  Also: you must fully re-index from
scratch, otherwise the norms will turn themselves back on when
segments merge together.

Mike

On Fri, Jan 8, 2010 at 7:55 AM, Yuliya Palchaninava <yp@solute.de> wrote:
> Thanks Michael.
>
> You are probably wright.
>
> Not optimized size is 4.1G, optimized index is about 15G.
>
> Yes, our documents do have many different indexed fields and norms are en=
abled.
> Nr of fields: 559
> Nr of documents: 20845906
> Nr of terms: 25615389
>
> Could you please give me a more detailled explanation, how the storage of=
 norms effects the size of an index.
> What do you mean exactly with "norms are not stored sparsely"?
>
> Thanks,
> Yuliya
>
>> -----Urspr=FCngliche Nachricht-----
>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Gesendet: Donnerstag, 7. Januar 2010 18:00
>> An: java-user@lucene.apache.org
>> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice as
>> large as the not optimized index
>>
>> Do your documents have many different indexed fields? =A0If you
>> do, and norms are enabled, that could be the cause (norms are
>> not stored sparsely).
>>
>> But: what actual sizes are we talking about?
>>
>> Mike
>>
>> On Thu, Jan 7, 2010 at 11:50 AM, Yuliya Palchaninava
>> <yp@solute.de> wrote:
>> > Otis,
>> >
>> > thanks for the answer.
>> >
>> > Unfortunatelly the index *directory* remains larger *after"
>> the optimization.
>> > In our case the otimization was/is completed successfully
>> and, as you
>> > say, there is only one segment in the directory.
>> >
>> > Some other ideas?
>> >
>> > Thanks,
>> > Yuliya
>> >
>> >> -----Urspr=FCngliche Nachricht-----
>> >> Von: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]
>> >> Gesendet: Donnerstag, 7. Januar 2010 17:35
>> >> An: java-user@lucene.apache.org
>> >> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice
>> as large
>> >> as the not optimized index
>> >>
>> >> Yuliya,
>> >>
>> >> The index *directory* will be larger *while* you are optimizing.
>> >> After the optimization is completed successfully, the
>> index directory
>> >> will be smaller. =A0It is possible that your index directory is
>> >> large(r) because you have some left-over segments (e.g. from some
>> >> earlier failed/interrupted optimizations) that are not
>> really a part
>> >> of the index. =A0After optimizing, you should have only 1
>> segment, so
>> >> if you see more than 1 segment, look at the ones with older
>> >> timestamps. =A0Those can be (re)moved.
>> >>
>> >> =A0Otis
>> >> --
>> >> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>> >>
>> >>
>> >>
>> >> ----- Original Message ----
>> >> > From: Yuliya Palchaninava <yp@solute.de>
>> >> > To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
>> >> > Sent: Thu, January 7, 2010 11:23:08 AM
>> >> > Subject: Lucene 2.9 and 3.0: Optimized index is thrice as
>> >> large as the
>> >> > not optimized index
>> >> >
>> >> > Hi,
>> >> >
>> >> > According to the api documentation: "In general, once
>> the optimize
>> >> > completes, the total size of the index will be less than
>> >> the size of
>> >> > the starting index. It could be quite a bit smaller (if
>> there were
>> >> > many pending deletes) or just slightly smaller". In our
>> >> case the index
>> >> > becomes not smaller but larger, namely thrice as large.
>> >> >
>> >> > The not optimized index doesn't contain compressed fields,
>> >> what could
>> >> > have caused the growth of the index due to the
>> otimization. So we
>> >> > cannot explain what happens.
>> >> >
>> >> > Does someone have an explanation for the index growth due
>> >> to the optimization?
>> >> >
>> >> > Thanks,
>> >> > Yuliya
>> >> >
>> >> >
>> >> >
>> >>
>> ---------------------------------------------------------------------
>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >>
>> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44423-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 13:55:49 2010
Return-Path: <java-user-return-44423-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60968 invoked from network); 8 Jan 2010 13:55:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 13:55:48 -0000
Received: (qmail 19202 invoked by uid 500); 8 Jan 2010 13:55:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19139 invoked by uid 500); 8 Jan 2010 13:55:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19129 invoked by uid 99); 8 Jan 2010 13:55:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 13:55:46 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 13:55:38 +0000
Received: by ewy25 with SMTP id 25so23843336ewy.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 05:55:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ReW66g14Uq4QG/anwgLCK2DryHP0M6QCAuLTnZ14U4I=;
        b=CB9EGWzey+jzxhDnsODX+ftYTR7iQDgAtXX2AMN24om1Oz7Q3M8uXZskiDY0cHZ8X3
         CnDTvQiv2/ciECVIXmhFdS3lXj7nCtIhxlHltpKbPXWwv0E6oiT6u8nEOZ9QyclfBHaz
         RZBudKlrnYW5IzwcGe5JoW8XmfGLtogkmnd4M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=gMll84wKn/Q8XbwFBCKOCnD9RyXff6plZQbkPOybqsN7JbSZeupix/ONKuNm0+GMHw
         3JCaZJJcwxfVO5E/sW+vf7b3TbkwnRc61heItBQhP93kOr4pJItNh/pidgbdIOA4tqWr
         ZAlrYhIvIemol8BbV5f2muvgD7AQUePwR8GGg=
MIME-Version: 1.0
Received: by 10.216.88.75 with SMTP id z53mr974365wee.46.1262958916723; Fri, 
	08 Jan 2010 05:55:16 -0800 (PST)
In-Reply-To: <27073866.post@talk.nabble.com>
References: <27073866.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 08:55:16 -0500
Message-ID: <359a92831001080555o233db8cdia82586cdc9b08a44@mail.gmail.com>
Subject: Re: Term Frequency for phrases
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6da7d7d98e60c047ca789fe

--0016e6da7d7d98e60c047ca789fe
Content-Type: text/plain; charset=ISO-8859-1

On a quick read, your statements are contradictory....

<<<I have phrases like brain natriuretic peptide indexed as a single
token>>>

<<<When I calculate the term frequency for the same  the count is 0 since
the
tokens from the text are indexed separately i.e. brain , natriuretic ,
peptide.>>>

Either "brain natriuretic peptide" is a single token/term or it's not....

Are you sure you're not confusing indexing and storing? What
analyzer are you using at index time?

Erick

On Fri, Jan 8, 2010 at 5:16 AM, hrishim <smarthrish@yahoo.co.in> wrote:

>
> Hi .
> I have phrases like brain natriuretic peptide indexed as a single token
> using Lucene.
> When I calculate the term frequency for the same  the count is 0 since the
> tokens from the text are indexed separately i.e. brain , natriuretic ,
> peptide.
> Is there a way to solve this problem and get the term frequency for the
> entire phrase ?
>
> Regards,
> Hrishi
> --
> View this message in context:
> http://old.nabble.com/Term-Frequency-for-phrases-tp27073866p27073866.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6da7d7d98e60c047ca789fe--

From java-user-return-44424-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 14:00:49 2010
Return-Path: <java-user-return-44424-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63303 invoked from network); 8 Jan 2010 14:00:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 14:00:49 -0000
Received: (qmail 28306 invoked by uid 500); 8 Jan 2010 14:00:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28237 invoked by uid 500); 8 Jan 2010 14:00:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28227 invoked by uid 99); 8 Jan 2010 14:00:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 14:00:47 +0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [62.146.193.99] (HELO mx.billiger.de) (62.146.193.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 14:00:36 +0000
Received: from solute-exc2k7.solute.ka (norad.solute-gmbh.de [145.253.139.66])
	by mx.billiger.de (Postfix) with ESMTPS id 6439785F996
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 15:00:18 +0100 (CET)
Received: from solute-exc2k7.solute.ka ([10.1.1.3]) by solute-exc2k7.solute.ka
 ([10.1.1.3]) with mapi; Fri, 8 Jan 2010 15:00:16 +0100
From: Yuliya Palchaninava <yp@solute.de>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 8 Jan 2010 15:00:16 +0100
Subject: AW: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not 	optimized index
Thread-Topic: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not 	optimized index
Thread-Index: AcqQZ/ColQx/tO1BSsiWHfbRk1+7ogAAKh9g
Message-ID: <0523297188849D479C16D5657F665769BB5CED4874@solute-exc2k7.solute.ka>
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
	 <943192.67571.qm@web50305.mail.re2.yahoo.com>
	 <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
	 <9ac0c6aa1001070859q3363ac1k68786a0165999219@mail.gmail.com>
	 <0523297188849D479C16D5657F665769BB5CED4872@solute-exc2k7.solute.ka>
 <9ac0c6aa1001080538k11bd56f9n1a6b7eaa86cba1be@mail.gmail.com>
In-Reply-To: <9ac0c6aa1001080538k11bd56f9n1a6b7eaa86cba1be@mail.gmail.com>
Accept-Language: en-US, de-DE
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, de-DE
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Mike,

thanks a lot!

That's exactly what we'll do.

Actually we have a lot of dynamic fields which are not analyzed and not inv=
olved in field/document boosting, so we can disable norms on these fields w=
ithout problems.=20

Thanks again.

Yuliya
=20

> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]=20
> Gesendet: Freitag, 8. Januar 2010 14:38
> An: java-user@lucene.apache.org
> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice as=20
> large as the not optimized index
>=20
> Lucene stores 1 byte (disk and RAM, when searching that=20
> field) per document for any field that has norms enabled,=20
> even for documents that do not contain that field.
>=20
> In your case, that's ~20 MB per field (once optimize is done), times
> 559 fields =3D ~11TB of storage.
>=20
> You should index these fields with=20
> Field.Index.ANALYZED_NO_NORMS to turn off norms.  But, this=20
> means field/doc boosting, and the normal length boosting=20
> Lucene normally does (shorter documents get a better score),=20
> will be silently disabled.  Also: you must fully re-index=20
> from scratch, otherwise the norms will turn themselves back=20
> on when segments merge together.
>=20
> Mike
>=20
> On Fri, Jan 8, 2010 at 7:55 AM, Yuliya Palchaninava=20
> <yp@solute.de> wrote:
> > Thanks Michael.
> >
> > You are probably wright.
> >
> > Not optimized size is 4.1G, optimized index is about 15G.
> >
> > Yes, our documents do have many different indexed fields=20
> and norms are enabled.
> > Nr of fields: 559
> > Nr of documents: 20845906
> > Nr of terms: 25615389
> >
> > Could you please give me a more detailled explanation, how=20
> the storage of norms effects the size of an index.
> > What do you mean exactly with "norms are not stored sparsely"?
> >
> > Thanks,
> > Yuliya
> >
> >> -----Urspr=FCngliche Nachricht-----
> >> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> >> Gesendet: Donnerstag, 7. Januar 2010 18:00
> >> An: java-user@lucene.apache.org
> >> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice=20
> as large=20
> >> as the not optimized index
> >>
> >> Do your documents have many different indexed fields? =A0If=20
> you do, and=20
> >> norms are enabled, that could be the cause (norms are not stored=20
> >> sparsely).
> >>
> >> But: what actual sizes are we talking about?
> >>
> >> Mike
> >>
> >> On Thu, Jan 7, 2010 at 11:50 AM, Yuliya Palchaninava=20
> <yp@solute.de>=20
> >> wrote:
> >> > Otis,
> >> >
> >> > thanks for the answer.
> >> >
> >> > Unfortunatelly the index *directory* remains larger *after"
> >> the optimization.
> >> > In our case the otimization was/is completed successfully
> >> and, as you
> >> > say, there is only one segment in the directory.
> >> >
> >> > Some other ideas?
> >> >
> >> > Thanks,
> >> > Yuliya
> >> >
> >> >> -----Urspr=FCngliche Nachricht-----
> >> >> Von: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]
> >> >> Gesendet: Donnerstag, 7. Januar 2010 17:35
> >> >> An: java-user@lucene.apache.org
> >> >> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice
> >> as large
> >> >> as the not optimized index
> >> >>
> >> >> Yuliya,
> >> >>
> >> >> The index *directory* will be larger *while* you are optimizing.
> >> >> After the optimization is completed successfully, the
> >> index directory
> >> >> will be smaller. =A0It is possible that your index directory is
> >> >> large(r) because you have some left-over segments (e.g.=20
> from some=20
> >> >> earlier failed/interrupted optimizations) that are not
> >> really a part
> >> >> of the index. =A0After optimizing, you should have only 1
> >> segment, so
> >> >> if you see more than 1 segment, look at the ones with older=20
> >> >> timestamps. =A0Those can be (re)moved.
> >> >>
> >> >> =A0Otis
> >> >> --
> >> >> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> >> >>
> >> >>
> >> >>
> >> >> ----- Original Message ----
> >> >> > From: Yuliya Palchaninava <yp@solute.de>
> >> >> > To: "java-user@lucene.apache.org"=20
> <java-user@lucene.apache.org>
> >> >> > Sent: Thu, January 7, 2010 11:23:08 AM
> >> >> > Subject: Lucene 2.9 and 3.0: Optimized index is thrice as
> >> >> large as the
> >> >> > not optimized index
> >> >> >
> >> >> > Hi,
> >> >> >
> >> >> > According to the api documentation: "In general, once
> >> the optimize
> >> >> > completes, the total size of the index will be less than
> >> >> the size of
> >> >> > the starting index. It could be quite a bit smaller (if
> >> there were
> >> >> > many pending deletes) or just slightly smaller". In our
> >> >> case the index
> >> >> > becomes not smaller but larger, namely thrice as large.
> >> >> >
> >> >> > The not optimized index doesn't contain compressed fields,
> >> >> what could
> >> >> > have caused the growth of the index due to the
> >> otimization. So we
> >> >> > cannot explain what happens.
> >> >> >
> >> >> > Does someone have an explanation for the index growth due
> >> >> to the optimization?
> >> >> >
> >> >> > Thanks,
> >> >> > Yuliya
> >> >> >
> >> >> >
> >> >> >
> >> >>
> >>=20
> ---------------------------------------------------------------------
> >> >> > To unsubscribe, e-mail:=20
> java-user-unsubscribe@lucene.apache.org
> >> >> > For additional commands, e-mail:=20
> >> >> > java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >>
> >>=20
> ---------------------------------------------------------------------
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail:=20
> java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >
> >>=20
> ---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >>
> >>=20
> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >=20
> ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
> =

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44425-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 14:45:00 2010
Return-Path: <java-user-return-44425-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84093 invoked from network); 8 Jan 2010 14:44:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 14:44:59 -0000
Received: (qmail 7822 invoked by uid 500); 8 Jan 2010 14:44:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7735 invoked by uid 500); 8 Jan 2010 14:44:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7725 invoked by uid 99); 8 Jan 2010 14:44:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 14:44:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gsiasf@gmail.com designates 209.85.211.184 as permitted sender)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 14:44:47 +0000
Received: by ywh14 with SMTP id 14so18148844ywh.20
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 06:44:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:sender:content-type
         :mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=qBm9GGz9Q9I81bQ+XLzt+yt6bAhxloe+DuL7Ea5o6dg=;
        b=gJ8njrIk/cbOHI9vkXeb4dP+DQyBxoybnJxXiOt6LBYHrvX+bn/Zvbp7XisUw2JX2N
         7TCQ3GdgoJRECs5OOhr2mGDZS67+RnOJ/NEqH/2HWnkeboqJiyOdP9++2KSdsX9zCcSK
         0peeR0TwJFjY94Nqp4vzuyc3pq5Dq9FoUrm4k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=sender:content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        b=NjJNSSyNiAuzuOI+qqDOGGjLiZdKPIXiH+f7VYoJ3+5TAghHvDLrgfNTKaagowpRlm
         VkTTZkCr2785RzBFoDRc+MxrVjJZTT0JjOq3L9jcobHmC/YRA6D96FHHIbJ64HEaaimr
         4H1Vhm+FaQtUOIUNLwbNK3Xm2YcZOZSt47gfY=
Received: by 10.150.44.12 with SMTP id r12mr19433072ybr.211.1262961862200;
        Fri, 08 Jan 2010 06:44:22 -0800 (PST)
Received: from ?10.0.0.77? (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
        by mx.google.com with ESMTPS id 23sm9329410yxe.0.2010.01.08.06.44.20
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 08 Jan 2010 06:44:21 -0800 (PST)
Sender: Grant Ingersoll <gsiasf@gmail.com>
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Term Frequency for phrases
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <27073866.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 09:44:20 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <364FF9D9-77B0-4DA4-8CB6-57303934B731@apache.org>
References: <27073866.post@talk.nabble.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org

When do you detect that they are phrases?  During indexing or during =
search?

On Jan 8, 2010, at 5:16 AM, hrishim wrote:

>=20
> Hi .
> I have phrases like brain natriuretic peptide indexed as a single =
token
> using Lucene.
> When I calculate the term frequency for the same  the count is 0 since =
the
> tokens from the text are indexed separately i.e. brain , natriuretic ,
> peptide.
> Is there a way to solve this problem and get the term frequency for =
the
> entire phrase ?
>=20
> Regards,
> Hrishi
> --=20
> View this message in context: =
http://old.nabble.com/Term-Frequency-for-phrases-tp27073866p27073866.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem using Solr/Lucene: =
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44426-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 17:38:15 2010
Return-Path: <java-user-return-44426-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38845 invoked from network); 8 Jan 2010 17:38:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 17:38:15 -0000
Received: (qmail 39817 invoked by uid 500); 8 Jan 2010 17:38:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39761 invoked by uid 500); 8 Jan 2010 17:38:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39751 invoked by uid 99); 8 Jan 2010 17:38:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 17:38:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 17:38:03 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NTImM-0000L2-0K
	for java-user@lucene.apache.org; Fri, 08 Jan 2010 09:37:42 -0800
Message-ID: <27079648.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 09:37:42 -0800 (PST)
From: hrishim <smarthrish@yahoo.co.in>
To: java-user@lucene.apache.org
Subject: Re: Term Frequency for phrases
In-Reply-To: <364FF9D9-77B0-4DA4-8CB6-57303934B731@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: smarthrish@yahoo.co.in
References: <27073866.post@talk.nabble.com> <364FF9D9-77B0-4DA4-8CB6-57303934B731@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org


@All : Elaborating the problem

The phrase is being indexed as a single token ...
I have a Gene tag in the xml document which is like
<Gene>brain natriuretic peptide </Gene>
This phrase is  present in the abstract text for the given document .
 
Code is as :

doc.add(new Field("Gene", geneName, Field.Store.YES,
Field.Index.ANALYZED,Field.TermVector.YES));

doc.add(new Field("Token", abstractText.toString().toLowerCase(),
Field.Store.YES, Field.Index.ANALYZED,Field.TermVector.YES));

When I retrieve all tokens as well as genes for a given doc and calculate
the tf for each of these , 
a null exception is thrown . Term = brain natriuretic peptide 

TermDocs termDocs = indexReader.termDocs(term);
termDocs.next();
double tf = termDocs.freq();

Regards,
Hrishi


Grant Ingersoll-6 wrote:
> 
> When do you detect that they are phrases?  During indexing or during
> search?
> 
> On Jan 8, 2010, at 5:16 AM, hrishim wrote:
> 
>> 
>> Hi .
>> I have phrases like brain natriuretic peptide indexed as a single token
>> using Lucene.
>> When I calculate the term frequency for the same  the count is 0 since
>> the
>> tokens from the text are indexed separately i.e. brain , natriuretic ,
>> peptide.
>> Is there a way to solve this problem and get the term frequency for the
>> entire phrase ?
>> 
>> Regards,
>> Hrishi
>> -- 
>> View this message in context:
>> http://old.nabble.com/Term-Frequency-for-phrases-tp27073866p27073866.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
> 
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
> 
> Search the Lucene ecosystem using Solr/Lucene:
> http://www.lucidimagination.com/search
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://old.nabble.com/Term-Frequency-for-phrases-tp27073866p27079648.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44427-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 17:51:31 2010
Return-Path: <java-user-return-44427-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46291 invoked from network); 8 Jan 2010 17:51:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 17:51:31 -0000
Received: (qmail 63135 invoked by uid 500); 8 Jan 2010 17:51:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63079 invoked by uid 500); 8 Jan 2010 17:51:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63069 invoked by uid 99); 8 Jan 2010 17:51:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 17:51:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 17:51:19 +0000
Received: by pxi16 with SMTP id 16so5227208pxi.29
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 09:50:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=17Vl8W4p8Gndj5bFxbTCDKAuKZcSjRYU/f6UARbzOzY=;
        b=rY0iVuaYXwdGZvn3EfLeZ+zmoTCZVDVNWOHcqXRy/ohdC54jG7EKaTeU0WluSMJbEk
         6OKQBExgcRo9oFuWz6gDGF691/vuTwm3puNQFPfNM9EU29QFCImA2FXSDVnMgUAkfLI5
         ECa5CI00SfEdELQC3eIsasxJEe5K6OZ31MFLU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=T1nf7TaBSCBPZVTejVz/rHfXK1FJNdmIBt23ZfOrRJDXt1akoQZddNuCj0/ba3sPkC
         tVcJ3RipABEJqHLfJ/MFU9ThpPuDeOPTYiLRmdKayk0mSQ3cw1ffilWN+cheLaBiXmHc
         hEsPbQTqFSBZhXZLqYUBAD44f3Q9G8nOEMZYI=
MIME-Version: 1.0
Received: by 10.140.88.31 with SMTP id l31mr5918333rvb.267.1262973057795; Fri, 
	08 Jan 2010 09:50:57 -0800 (PST)
In-Reply-To: <27079648.post@talk.nabble.com>
References: <27073866.post@talk.nabble.com>
	 <364FF9D9-77B0-4DA4-8CB6-57303934B731@apache.org>
	 <27079648.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 09:50:57 -0800
Message-ID: <85d3c3b61001080950g51b64c1u8fb105ebae8b9e3a@mail.gmail.com>
Subject: Re: Term Frequency for phrases
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I'm not going to go into too much code level detail, however I'd index
the phrases using tri-gram shingles, and as uni-grams.  I think
this'll give you the results you're looking for.  You'll be able to
quickly recall the count of a given phrase aka tri-gram such as
"blue_shorts_burough"

On Fri, Jan 8, 2010 at 9:37 AM, hrishim <smarthrish@yahoo.co.in> wrote:
>
> @All : Elaborating the problem
>
> The phrase is being indexed as a single token ...
> I have a Gene tag in the xml document which is like
> <Gene>brain natriuretic peptide </Gene>
> This phrase is =A0present in the abstract text for the given document .
>
> Code is as :
>
> doc.add(new Field("Gene", geneName, Field.Store.YES,
> Field.Index.ANALYZED,Field.TermVector.YES));
>
> doc.add(new Field("Token", abstractText.toString().toLowerCase(),
> Field.Store.YES, Field.Index.ANALYZED,Field.TermVector.YES));
>
> When I retrieve all tokens as well as genes for a given doc and calculate
> the tf for each of these ,
> a null exception is thrown . Term =3D brain natriuretic peptide
>
> TermDocs termDocs =3D indexReader.termDocs(term);
> termDocs.next();
> double tf =3D termDocs.freq();
>
> Regards,
> Hrishi
>
>
> Grant Ingersoll-6 wrote:
>>
>> When do you detect that they are phrases? =A0During indexing or during
>> search?
>>
>> On Jan 8, 2010, at 5:16 AM, hrishim wrote:
>>
>>>
>>> Hi .
>>> I have phrases like brain natriuretic peptide indexed as a single token
>>> using Lucene.
>>> When I calculate the term frequency for the same =A0the count is 0 sinc=
e
>>> the
>>> tokens from the text are indexed separately i.e. brain , natriuretic ,
>>> peptide.
>>> Is there a way to solve this problem and get the term frequency for the
>>> entire phrase ?
>>>
>>> Regards,
>>> Hrishi
>>> --
>>> View this message in context:
>>> http://old.nabble.com/Term-Frequency-for-phrases-tp27073866p27073866.ht=
ml
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> --------------------------
>> Grant Ingersoll
>> http://www.lucidimagination.com/
>>
>> Search the Lucene ecosystem using Solr/Lucene:
>> http://www.lucidimagination.com/search
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://old.nabble.com/Term-Frequency-for-ph=
rases-tp27073866p27079648.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44428-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 18:09:03 2010
Return-Path: <java-user-return-44428-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56628 invoked from network); 8 Jan 2010 18:09:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 18:09:03 -0000
Received: (qmail 91824 invoked by uid 500); 8 Jan 2010 18:09:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91748 invoked by uid 500); 8 Jan 2010 18:09:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91738 invoked by uid 99); 8 Jan 2010 18:09:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 18:09:00 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 18:08:50 +0000
Received: by ewy25 with SMTP id 25so24123847ewy.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 10:08:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=eHzUtn/nX75/n0SLmxPteMNYWbllVXW8m+/mTy+8NJ8=;
        b=beVux2Tqoi2zZfBvG22l6LK/OtNDnYdmNqPoYWo9UxQjD9fC0wpU/9CMTc6hIGG/qc
         ZQZgNCLe/9OxfOm1YWY6ZiT5K/yrs8phon4K7c7KbYwCAjyV28MfTLtB8ROicrYHOs1+
         NEzkwEGB/hHPZTaIXdeVHJepdR/dcOiVTcM18=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=iZSx/p6kI12OCowj7Ryuw7G4uvil6eZj4IB2ZFR2dTJ/wyKtptMpLsdxcNC4gKFhDz
         d2xyf0rmD0WQBzkbpc1qfbg0IIHIgCtvUGRgBfu1ktdIR5HQkgbpk91LYY/8IglKefb2
         vLDm5H21GmX20lwWbWdljzjotZina6SMIHcGY=
MIME-Version: 1.0
Received: by 10.216.89.8 with SMTP id b8mr808185wef.180.1262974110566; Fri, 08 
	Jan 2010 10:08:30 -0800 (PST)
In-Reply-To: <27079648.post@talk.nabble.com>
References: <27073866.post@talk.nabble.com>
	 <364FF9D9-77B0-4DA4-8CB6-57303934B731@apache.org>
	 <27079648.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 13:08:30 -0500
Message-ID: <359a92831001081008x4371a41m5f9f10ffdbda2250@mail.gmail.com>
Subject: Re: Term Frequency for phrases
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d7e6a33889d8047cab13b4
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d7e6a33889d8047cab13b4
Content-Type: text/plain; charset=ISO-8859-1

What are the associated Analyzers for your Gene and Token?
Because if they're NOT something akin to KeywordAnalyzer, you
have a problem. Specifically, most of the "regular" tokenizers will
break this stream up into three separate terms,
"brain", "natriuetic", and "peptide". If that's the case,  there is no
single term in your index "brain natriuetic peptide".

I'm assuming that your high-level task is to answer "how many times
does the phrase 'brain natriuetic peptide' appear in the index (or maybe
doc)", right?

I really recommend that you get a copy of Luke and examine what's
actually in your index, it's invaluable.....

See Jason's e-mail for another approach....

HTH
Erick


On Fri, Jan 8, 2010 at 12:37 PM, hrishim <smarthrish@yahoo.co.in> wrote:

>
> @All : Elaborating the problem
>
> The phrase is being indexed as a single token ...
> I have a Gene tag in the xml document which is like
> <Gene>brain natriuretic peptide </Gene>
> This phrase is  present in the abstract text for the given document .
>
> Code is as :
>
> doc.add(new Field("Gene", geneName, Field.Store.YES,
> Field.Index.ANALYZED,Field.TermVector.YES));
>
> doc.add(new Field("Token", abstractText.toString().toLowerCase(),
> Field.Store.YES, Field.Index.ANALYZED,Field.TermVector.YES));
>
> When I retrieve all tokens as well as genes for a given doc and calculate
> the tf for each of these ,
> a null exception is thrown . Term = brain natriuretic peptide
>
> TermDocs termDocs = indexReader.termDocs(term);
> termDocs.next();
> double tf = termDocs.freq();
>
> Regards,
> Hrishi
>
>
> Grant Ingersoll-6 wrote:
> >
> > When do you detect that they are phrases?  During indexing or during
> > search?
> >
> > On Jan 8, 2010, at 5:16 AM, hrishim wrote:
> >
> >>
> >> Hi .
> >> I have phrases like brain natriuretic peptide indexed as a single token
> >> using Lucene.
> >> When I calculate the term frequency for the same  the count is 0 since
> >> the
> >> tokens from the text are indexed separately i.e. brain , natriuretic ,
> >> peptide.
> >> Is there a way to solve this problem and get the term frequency for the
> >> entire phrase ?
> >>
> >> Regards,
> >> Hrishi
> >> --
> >> View this message in context:
> >>
> http://old.nabble.com/Term-Frequency-for-phrases-tp27073866p27073866.html
> >> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >
> > --------------------------
> > Grant Ingersoll
> > http://www.lucidimagination.com/
> >
> > Search the Lucene ecosystem using Solr/Lucene:
> > http://www.lucidimagination.com/search
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
>
> --
> View this message in context:
> http://old.nabble.com/Term-Frequency-for-phrases-tp27073866p27079648.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d7e6a33889d8047cab13b4--

From java-user-return-44429-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 18:48:38 2010
Return-Path: <java-user-return-44429-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81747 invoked from network); 8 Jan 2010 18:48:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 18:48:38 -0000
Received: (qmail 58990 invoked by uid 500); 8 Jan 2010 18:48:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58931 invoked by uid 500); 8 Jan 2010 18:48:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58921 invoked by uid 99); 8 Jan 2010 18:48:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 18:48:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 18:48:29 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id F288771C23A; Fri,  8 Jan 2010 10:48:08 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id ED5C871C22F
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 10:48:08 -0800 (PST)
Date: Fri, 8 Jan 2010 10:48:08 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: ShingleFilter with outputUnigrams=false
In-Reply-To: <678109.86020.qm@web52905.mail.re2.yahoo.com>
Message-ID: <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net>
References: <678109.86020.qm@web52905.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


: I am using lucene 2.9.1 and I was trying to understand the ShingleFilter and wrote the code below.
	...
: I was expecting the output as follows with maxShingleSize=3 and outputUnigrams=false :
	...
: Am I missing something or this is the expected behavior?

I'm not very familiar with ShingleFilter, and i'n not 100% sure i 
understand the example you describe, but it *seems* like there may be a 
bug here ... the easieest way to verify that is if you could tweak your 
example code into the form of a (failing) JUnit test and open a new Jira 
issue -- then other devs (who know more about SHingleFilter) could look at 
it and either verify that there is a bug, or point out what's invalid 
about hte test.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44430-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 19:54:27 2010
Return-Path: <java-user-return-44430-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99256 invoked from network); 8 Jan 2010 19:54:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 19:54:26 -0000
Received: (qmail 65237 invoked by uid 500); 8 Jan 2010 19:54:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65167 invoked by uid 500); 8 Jan 2010 19:54:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65157 invoked by uid 99); 8 Jan 2010 19:54:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 19:54:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 19:54:14 +0000
Received: by fxm2 with SMTP id 2so17439991fxm.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 11:53:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=5iBVKt+lB2qugkLzfPsUSm5ZJI+vo4ruBoyF/6hrb6U=;
        b=jsz/LhPTbiL8CLqDe1oQ2FlAAbQNriAkiHrsLFMkn7IERk6/zbuEn0kkPNycI+bhZW
         ay4fXcAT/WFKQ8dLuk8z83RmzzV5JwZoObjAHktUB+vKGSmG2K1BxoHK+iFkyISdu6Qn
         kKW++L/CXqAQMSi9aehNLNak3oFL+DQakSlRg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=Yme9dEjS55FJuqRgfzGD1sph/IzmSx+YPO/BBoJPTT/FzbnVqymf+hcWS95146nBcJ
         FlB4hgs2Eo19VAPL2PGNfUNr5Tr3WVMRKdcM5UbdcjkSxUJSSxfkfi04TRYzyiisZFpR
         MOg5Tk9WDkNCrDLxeDRRP/L0LeOKNta2+esZs=
MIME-Version: 1.0
Received: by 10.239.187.211 with SMTP id m19mr986129hbh.10.1262980433816; Fri, 
	08 Jan 2010 11:53:53 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net>
References: <678109.86020.qm@web52905.mail.re2.yahoo.com>
	 <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net>
Date: Fri, 8 Jan 2010 20:53:53 +0100
Message-ID: <f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com>
Subject: Re: ShingleFilter with outputUnigrams=false
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

This is truly a bug. The outputUnigram internally only works if you
request bi-grams.
If the outputUnigram is set to false the filter increment the
shingleposition by one and therefore skips every even shingle. The
position should only be incremented if shingleBufferPosition %
maxShingle =3D=3D 0

I have a test and the fix - will open an issue soon.

simon

On Fri, Jan 8, 2010 at 7:48 PM, Chris Hostetter
<hossman_lucene@fucit.org> wrote:
>
> : I am using lucene 2.9.1 and I was trying to understand the ShingleFilte=
r and wrote the code below.
> =C2=A0 =C2=A0 =C2=A0 =C2=A0...
> : I was expecting the output as follows with maxShingleSize=3D3 and outpu=
tUnigrams=3Dfalse :
> =C2=A0 =C2=A0 =C2=A0 =C2=A0...
> : Am I missing something or this is the expected behavior?
>
> I'm not very familiar with ShingleFilter, and i'n not 100% sure i
> understand the example you describe, but it *seems* like there may be a
> bug here ... the easieest way to verify that is if you could tweak your
> example code into the form of a (failing) JUnit test and open a new Jira
> issue -- then other devs (who know more about SHingleFilter) could look a=
t
> it and either verify that there is a bug, or point out what's invalid
> about hte test.
>
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44431-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 20:02:11 2010
Return-Path: <java-user-return-44431-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3396 invoked from network); 8 Jan 2010 20:02:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 20:02:11 -0000
Received: (qmail 80944 invoked by uid 500); 8 Jan 2010 20:02:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80852 invoked by uid 500); 8 Jan 2010 20:02:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80842 invoked by uid 99); 8 Jan 2010 20:02:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 20:02:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 20:02:01 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id 26D0E508D9; Fri,  8 Jan 2010 12:01:40 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-131-31-rndf-esr-3.dynamic.isadsl.co.za [196.210.131.31])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 46AAD508D4
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 12:01:38 -0800 (PST)
Message-ID: <4B478F1F.6050406@stimulussoft.com>
Date: Fri, 08 Jan 2010 22:01:35 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Search query problem
References: <678109.86020.qm@web52905.mail.re2.yahoo.com>	 <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net> <f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com>
In-Reply-To: <f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-1.6 required=2.0 tests=ALL_TRUSTED,AWL,BAYES_00,
	FH_DATE_PAST_20XX autolearn=no version=3.2.4

Hi There

We are trying to search for the exact word "Lowe's" across a large set 
of indexed data. Our results include everything with "low" in it. Thus, 
we are receiving a much larger data set that we expected. The data is 
indexing using the analyzer:
            TokenStream result = new StandardTokenizer(reader);
            result = new StandardFilter(result);
            result = new LowerCaseFilter(result);
            result = new StopFilter(result, stopTable);
            result = new PorterStemFilter(result);
            return result;

Thanks

Jamie






---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44432-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 20:07:52 2010
Return-Path: <java-user-return-44432-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4733 invoked from network); 8 Jan 2010 20:07:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 20:07:51 -0000
Received: (qmail 92149 invoked by uid 500); 8 Jan 2010 20:07:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92068 invoked by uid 500); 8 Jan 2010 20:07:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92057 invoked by uid 99); 8 Jan 2010 20:07:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 20:07:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of will.murnane@gmail.com designates 209.85.210.173 as permitted sender)
Received: from [209.85.210.173] (HELO mail-yx0-f173.google.com) (209.85.210.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 20:07:41 +0000
Received: by yxe3 with SMTP id 3so18259183yxe.20
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 12:07:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=DP1pN182559nivPfR+3yo6QcNuX4DpHVIPTCnWz3x10=;
        b=TeYCmtlCadbxOwSU0oE7dSD7AKdVAo+mjgwe/BIkNv/duxpqn5W5P14mPWhLt5pg0x
         YojNl2mPnPfUe+y3xUWJtxgB8vh0/oYbYBBP5lJSmauxHjuNU681NOwgwvAVLVbGfzqj
         G6YJ/1xEpUordYfW3HXOS0MIs2v1jTT1V5cNU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=EnmHF8wo/C2yKpz+nZhw4LAix0W8fkvvEEAT7LVMu/Gep2NbV2QzPd3w2+0B9q+6wJ
         oLcd/yUS6ndT5L2kUJgzE21HMcEwHFo78rPLkVnsdbMiADPNJMyjXz8XcXhaf7jllnO8
         0I5hSOnfwyEoE5msIxVmmiokvwiiaNcbkRpuI=
MIME-Version: 1.0
Received: by 10.100.76.9 with SMTP id y9mr40910817ana.53.1262981240870; Fri, 
	08 Jan 2010 12:07:20 -0800 (PST)
In-Reply-To: <4B478F1F.6050406@stimulussoft.com>
References: <678109.86020.qm@web52905.mail.re2.yahoo.com>
	 <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net>
	 <f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com>
	 <4B478F1F.6050406@stimulussoft.com>
Date: Fri, 8 Jan 2010 15:07:20 -0500
Message-ID: <27b05b491001081207r19da50f2r6ec9904179ce2c12@mail.gmail.com>
Subject: Re: Search query problem
From: Will Murnane <will.murnane@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Fri, Jan 8, 2010 at 15:01, Jamie <jamie@stimulussoft.com> wrote:
> Hi There
>
> We are trying to search for the exact word "Lowe's" across a large set of
> indexed data. Our results include everything with "low" in it. Thus, we a=
re
> receiving a much larger data set that we expected. The data is indexing
> using the analyzer:
> =A0 =A0 =A0 =A0 =A0 TokenStream result =3D new StandardTokenizer(reader);
> =A0 =A0 =A0 =A0 =A0 result =3D new StandardFilter(result);
> =A0 =A0 =A0 =A0 =A0 result =3D new LowerCaseFilter(result);
> =A0 =A0 =A0 =A0 =A0 result =3D new StopFilter(result, stopTable);
> =A0 =A0 =A0 =A0 =A0 result =3D new PorterStemFilter(result);
PorterStemFilter is changing Lowe to low.  Change your tokenizer so
that Lowe's is tokenized as a single token, and that should avoid it.

Will

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44433-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 20:12:05 2010
Return-Path: <java-user-return-44433-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5532 invoked from network); 8 Jan 2010 20:12:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 20:12:05 -0000
Received: (qmail 1780 invoked by uid 500); 8 Jan 2010 20:12:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1740 invoked by uid 500); 8 Jan 2010 20:12:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1730 invoked by uid 99); 8 Jan 2010 20:12:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 20:12:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 20:11:55 +0000
Received: by fxm2 with SMTP id 2so17454319fxm.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 12:11:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=yfvHNXfRYMynTZKgiMiVIRUe7QA6NG0qGgRdq3vSE7A=;
        b=CiKPHNeIWuKmlykeOjpmLaiX5/CPDhOkZrYsr99obpb00Lnd/4G/dHUJ6MJs2GFR9i
         J8cLjNtqFYheDAynpxn5tA9Eb9jfjDXNRr79YFs7yepytKoIjW2ceCf1CTDw/QhxloeF
         bfyW/GJrLDHQqwqTXVAE7L4sgW4SCLCBwzyCw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=V3HP8jLzH/qYmSzSphuSz/yHDtLTx+WUSLf9bWyj5vU5AKca2YDOqs0glOluysdJge
         1F5u7DzNpedT/N3TY/i6LGaWHYERwALodDx/GH3glIxgxnsPPWSWZJWVWZRLJpGrxn5m
         4+w36z+PEuKYjQZ5GMpLu8kiur5NMr336XnXU=
MIME-Version: 1.0
Received: by 10.223.74.144 with SMTP id u16mr4660067faj.21.1262981495111; Fri, 
	08 Jan 2010 12:11:35 -0800 (PST)
In-Reply-To: <4B478F1F.6050406@stimulussoft.com>
References: <678109.86020.qm@web52905.mail.re2.yahoo.com> <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net> 
	<f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com> 
	<4B478F1F.6050406@stimulussoft.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 8 Jan 2010 20:11:15 +0000
Message-ID: <8c4e68611001081211if0620cao4a3cef2bdb81c694@mail.gmail.com>
Subject: Re: Search query problem
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Looks like PorterStemFilter converts "Lowe's" to low.  Not very surprising.

Options include

.  Drop the stemming

.  Index stemmed and non-stemmed variants and search both, maybe
boosting the non-stemmed variant.

If you really want exact matches only, you may also/instead want
untokenized fields.  Apostrophes etc can be a problem.  Look into what
analyzers do and use Luke to see what is indexed.

--
Ian.


On Fri, Jan 8, 2010 at 8:01 PM, Jamie <jamie@stimulussoft.com> wrote:
> Hi There
>
> We are trying to search for the exact word "Lowe's" across a large set of
> indexed data. Our results include everything with "low" in it. Thus, we a=
re
> receiving a much larger data set that we expected. The data is indexing
> using the analyzer:
> =A0 =A0 =A0 =A0 =A0 TokenStream result =3D new StandardTokenizer(reader);
> =A0 =A0 =A0 =A0 =A0 result =3D new StandardFilter(result);
> =A0 =A0 =A0 =A0 =A0 result =3D new LowerCaseFilter(result);
> =A0 =A0 =A0 =A0 =A0 result =3D new StopFilter(result, stopTable);
> =A0 =A0 =A0 =A0 =A0 result =3D new PorterStemFilter(result);
> =A0 =A0 =A0 =A0 =A0 return result;
>
> Thanks
>
> Jamie
>
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44434-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 21:28:37 2010
Return-Path: <java-user-return-44434-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23687 invoked from network); 8 Jan 2010 21:28:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 21:28:37 -0000
Received: (qmail 94606 invoked by uid 500); 8 Jan 2010 21:28:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94573 invoked by uid 500); 8 Jan 2010 21:28:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94563 invoked by uid 99); 8 Jan 2010 21:28:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 21:28:35 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 21:28:26 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id 41E56508D9; Fri,  8 Jan 2010 13:28:05 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-131-31-rndf-esr-3.dynamic.isadsl.co.za [196.210.131.31])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 0B561508D4
	for <java-user@lucene.apache.org>; Fri,  8 Jan 2010 13:28:03 -0800 (PST)
Message-ID: <4B47A35E.60004@stimulussoft.com>
Date: Fri, 08 Jan 2010 23:27:58 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Search query problem
References: <678109.86020.qm@web52905.mail.re2.yahoo.com> <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net> 	<f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com> 	<4B478F1F.6050406@stimulussoft.com> <8c4e68611001081211if0620cao4a3cef2bdb81c694@mail.gmail.com>
In-Reply-To: <8c4e68611001081211if0620cao4a3cef2bdb81c694@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-1.6 required=2.0 tests=ALL_TRUSTED,AWL,BAYES_00,
	FH_DATE_PAST_20XX autolearn=no version=3.2.4

Hi Ian / Will

Thanks. Surely, the Porter Stemmer should not stem proper noun's. i.e. 
it could check the capitalization of the first letter of a word and 
whether or not the word is the start of sentence. If so, it could choose 
not apply any stemming. Or am I completely out of whack?

Jamie


Ian Lea wrote:
> Looks like PorterStemFilter converts "Lowe's" to low.  Not very surprising.
>
> Options include
>
> .  Drop the stemming
>
> .  Index stemmed and non-stemmed variants and search both, maybe
> boosting the non-stemmed variant.
>
> If you really want exact matches only, you may also/instead want
> untokenized fields.  Apostrophes etc can be a problem.  Look into what
> analyzers do and use Luke to see what is indexed.
>
> --
> Ian.
>
>
> On Fri, Jan 8, 2010 at 8:01 PM, Jamie <jamie@stimulussoft.com> wrote:
>   
>> Hi There
>>
>> We are trying to search for the exact word "Lowe's" across a large set of
>> indexed data. Our results include everything with "low" in it. Thus, we are
>> receiving a much larger data set that we expected. The data is indexing
>> using the analyzer:
>>           TokenStream result = new StandardTokenizer(reader);
>>           result = new StandardFilter(result);
>>           result = new LowerCaseFilter(result);
>>           result = new StopFilter(result, stopTable);
>>           result = new PorterStemFilter(result);
>>           return result;
>>
>> Thanks
>>
>> Jamie
>>
>>
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
Stimulus Software - MailArchiva
Email Archiving And Compliance
USA Tel: +1-713-343-8824 ext 100
UK Tel: +44-20-80991035 ext 100
Email:  jamie@stimulussoft.com
Web: http://www.mailarchiva.com
To receive MailArchiva Enterprise Edition product announcements, send a message to: <mailarchiva-enterprise-edition-subscribe@stimulussoft.com>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44435-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 21:29:42 2010
Return-Path: <java-user-return-44435-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24395 invoked from network); 8 Jan 2010 21:29:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 21:29:42 -0000
Received: (qmail 97661 invoked by uid 500); 8 Jan 2010 21:29:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97597 invoked by uid 500); 8 Jan 2010 21:29:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97587 invoked by uid 99); 8 Jan 2010 21:29:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 21:29:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 72.14.220.153 as permitted sender)
Received: from [72.14.220.153] (HELO fg-out-1718.google.com) (72.14.220.153)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 21:29:29 +0000
Received: by fg-out-1718.google.com with SMTP id 19so3385657fgg.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 13:29:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=d6nnBKk5oFiGAgoBlZlW+tgkzjcjAx8JTdT7viBXG4c=;
        b=rRuMMrTDOxt7jzETgPg48vqWsYjNfvGozP7xzdJeS6hM56XGwQ5GIqh/+qPhK6e2xm
         ORMjEmWZjJE6plMyRf+O1/Vio4l5HjX/WNnTQ5SRtvgtjr5kKpsM9E390gCI4SULgb0K
         rCASLMwiaOsnuZIJCMHkz8oYSQnRu4RjSKkJo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=rZD57teZfgQvZv1ZyiApb2OZKmmgECpSSWiSzyxBaqnAV3ESAm2nWuk4MEZzo7fFDz
         7I6/wiIuhRjZeeNeertOZnJgSLYW6C9QcpDK/y/MhdvMxQdOnzUI8nDc/TpbPvlPezfT
         1ecEsz+DJbvsFzEMv1sDQz3mOLCN7oEmVLl/c=
MIME-Version: 1.0
Received: by 10.239.199.199 with SMTP id i7mr333824hbj.204.1262986148992; Fri, 
	08 Jan 2010 13:29:08 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com>
References: <678109.86020.qm@web52905.mail.re2.yahoo.com>
	 <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net>
	 <f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com>
Date: Fri, 8 Jan 2010 22:29:08 +0100
Message-ID: <f18c9dde1001081329n4dd470caudb7e5b7488dcb913@mail.gmail.com>
Subject: Re: ShingleFilter with outputUnigrams=false
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

You can find the issue for this here
https://issues.apache.org/jira/browse/LUCENE-2199

On Fri, Jan 8, 2010 at 8:53 PM, Simon Willnauer
<simon.willnauer@googlemail.com> wrote:
> This is truly a bug. The outputUnigram internally only works if you
> request bi-grams.
> If the outputUnigram is set to false the filter increment the
> shingleposition by one and therefore skips every even shingle. The
> position should only be incremented if shingleBufferPosition %
> maxShingle =3D=3D 0
>
> I have a test and the fix - will open an issue soon.
>
> simon
>
> On Fri, Jan 8, 2010 at 7:48 PM, Chris Hostetter
> <hossman_lucene@fucit.org> wrote:
>>
>> : I am using lucene 2.9.1 and I was trying to understand the ShingleFilt=
er and wrote the code below.
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0...
>> : I was expecting the output as follows with maxShingleSize=3D3 and outp=
utUnigrams=3Dfalse :
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0...
>> : Am I missing something or this is the expected behavior?
>>
>> I'm not very familiar with ShingleFilter, and i'n not 100% sure i
>> understand the example you describe, but it *seems* like there may be a
>> bug here ... the easieest way to verify that is if you could tweak your
>> example code into the form of a (failing) JUnit test and open a new Jira
>> issue -- then other devs (who know more about SHingleFilter) could look =
at
>> it and either verify that there is a bug, or point out what's invalid
>> about hte test.
>>
>>
>>
>> -Hoss
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44436-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 08 21:39:37 2010
Return-Path: <java-user-return-44436-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31533 invoked from network); 8 Jan 2010 21:39:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 8 Jan 2010 21:39:37 -0000
Received: (qmail 12063 invoked by uid 500); 8 Jan 2010 21:39:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11995 invoked by uid 500); 8 Jan 2010 21:39:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11985 invoked by uid 99); 8 Jan 2010 21:39:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 21:39:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of will.murnane@gmail.com designates 209.85.211.184 as permitted sender)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 08 Jan 2010 21:39:28 +0000
Received: by ywh14 with SMTP id 14so18507842ywh.20
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 13:39:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=7LKylj0V7mOj8Mlqz8NR5QT97WzPvCNyqlLQeuIzW4o=;
        b=chMs/tXdBIkhhYO7rJOpDlX1CE/bQBVv+ouFKmUcGiQSg4TyHHlTgFxjVSQr28wlaq
         ZRubTSpxQoJRVTHJtfbxHCk+b0xQ+K01gAU4Zy+oOg88tO2L3+3OXBch3R+Q25ZlAe82
         UcnGUylppAZI79z7Vbs9+FCQmcggXsxUB4ooU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=thLrb0zyE+VTKPdgFwTLaqLZg0nsES/Aoiokhm5FhFLMCffSBYXARvwz8FXOpa0FNF
         TJHEyVLATeVU35iw0UpmKUS2ID6NRJC9BWmqodLQBd56uEHGCX3bAKn0kBbtKTn2GjHR
         KXcBz0no5krkeUkC1rO43txF+HZsEpE/JMSN4=
MIME-Version: 1.0
Received: by 10.100.76.9 with SMTP id y9mr41058031ana.53.1262986747370; Fri, 
	08 Jan 2010 13:39:07 -0800 (PST)
In-Reply-To: <4B47A35E.60004@stimulussoft.com>
References: <678109.86020.qm@web52905.mail.re2.yahoo.com>
	 <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net>
	 <f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com>
	 <4B478F1F.6050406@stimulussoft.com>
	 <8c4e68611001081211if0620cao4a3cef2bdb81c694@mail.gmail.com>
	 <4B47A35E.60004@stimulussoft.com>
Date: Fri, 8 Jan 2010 16:39:07 -0500
Message-ID: <27b05b491001081339l47d67ce4j7f3d6c7e663fcd70@mail.gmail.com>
Subject: Re: Search query problem
From: Will Murnane <will.murnane@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Fri, Jan 8, 2010 at 16:27, Jamie <jamie@stimulussoft.com> wrote:
> Hi Ian / Will
>
> Thanks. Surely, the Porter Stemmer should not stem proper noun's. i.e. it
> could check the capitalization of the first letter of a word and whether or
> not the word is the start of sentence. If so, it could choose not apply any
> stemming. Or am I completely out of whack?
Look again: you're downcasing the terms before the Porter filter ever
sees them (which is, AIUI, necessary).  You might do well to combine
the tokenizing and downcasing step with some heuristic to find proper
nouns and not downcase or stem them.

Will

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44437-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 00:05:25 2010
Return-Path: <java-user-return-44437-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86115 invoked from network); 9 Jan 2010 00:05:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 00:05:25 -0000
Received: (qmail 43883 invoked by uid 500); 9 Jan 2010 00:05:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43791 invoked by uid 500); 9 Jan 2010 00:05:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43781 invoked by uid 99); 9 Jan 2010 00:05:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 00:05:22 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 00:05:14 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NTOp3-0005AJ-Pj
	for java-user@lucene.apache.org; Fri, 08 Jan 2010 16:04:53 -0800
Message-ID: <27084145.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 16:04:53 -0800 (PST)
From: LucasMeadows <meadowsld@yahoo.com>
To: java-user@lucene.apache.org
Subject: Indexing pages and chapters of a book
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: meadowsld@yahoo.com


I have a large number of text files (books) that I am trying to make
searchable with Lucene 2.3.2.

I would like search results to display the page and chapter in which a match
with the search term occurred.

My question is whether it is possible to add structural data (xml perhaps)
to the files so that they can be indexed in a way that captures the
relationship of the terms to the pages and chapters that contain them.

Many thanks in advance!
-- 
View this message in context: http://old.nabble.com/Indexing-pages-and-chapters-of-a-book-tp27084145p27084145.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44438-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 03:18:42 2010
Return-Path: <java-user-return-44438-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43416 invoked from network); 9 Jan 2010 03:18:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 03:18:42 -0000
Received: (qmail 22656 invoked by uid 500); 9 Jan 2010 03:18:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22496 invoked by uid 500); 9 Jan 2010 03:18:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22486 invoked by uid 99); 9 Jan 2010 03:18:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 03:18:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 03:18:31 +0000
Received: by ey-out-2122.google.com with SMTP id 4so273337eyf.5
        for <java-user@lucene.apache.org>; Fri, 08 Jan 2010 19:18:10 -0800 (PST)
MIME-Version: 1.0
Received: by 10.216.90.196 with SMTP id e46mr1226960wef.194.1263007089946; 
	Fri, 08 Jan 2010 19:18:09 -0800 (PST)
In-Reply-To: <27084145.post@talk.nabble.com>
References: <27084145.post@talk.nabble.com>
Date: Fri, 8 Jan 2010 22:18:09 -0500
Message-ID: <359a92831001081918h428870afr29a4d9f7bcd57da8@mail.gmail.com>
Subject: Re: Indexing pages and chapters of a book
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6dab0cdf1f149047cb2c0dd

--0016e6dab0cdf1f149047cb2c0dd
Content-Type: text/plain; charset=ISO-8859-1

Sure, you can add any data to any document that you want,
probably stored but not indexed in this case. It could even
be a serialized Java object. Or an XML packet or a
stringized map. Or... whatever suits your fancy. If it's not
indexed, only stored it'll make your index larger but have
a negligible impact on search performance.

The trick is getting token offsets to put in your meta data.
You'll have to get the term positions and store them, but
it's do-able.

 HTH
Erick

On Fri, Jan 8, 2010 at 7:04 PM, LucasMeadows <meadowsld@yahoo.com> wrote:

>
> I have a large number of text files (books) that I am trying to make
> searchable with Lucene 2.3.2.
>
> I would like search results to display the page and chapter in which a
> match
> with the search term occurred.
>
> My question is whether it is possible to add structural data (xml perhaps)
> to the files so that they can be indexed in a way that captures the
> relationship of the terms to the pages and chapters that contain them.
>
> Many thanks in advance!
> --
> View this message in context:
> http://old.nabble.com/Indexing-pages-and-chapters-of-a-book-tp27084145p27084145.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6dab0cdf1f149047cb2c0dd--

From java-user-return-44439-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 04:21:22 2010
Return-Path: <java-user-return-44439-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50635 invoked from network); 9 Jan 2010 04:21:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 04:21:22 -0000
Received: (qmail 45171 invoked by uid 500); 9 Jan 2010 04:21:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45035 invoked by uid 500); 9 Jan 2010 04:21:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45025 invoked by uid 99); 9 Jan 2010 04:21:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 04:21:19 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.59] (HELO web50305.mail.re2.yahoo.com) (206.190.38.59)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 09 Jan 2010 04:21:10 +0000
Received: (qmail 56166 invoked by uid 60001); 9 Jan 2010 04:20:48 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263010848; bh=bWFxhhZfnEmDU3Gtbu4WTf1It6kKhdIBEntGvj6h05g=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=qj98xAPiPFx2xHNWpOnp8UBQrWdAnhCVK+XYZ1ZPtj+x4wrTGdTgF3E0/8TSeXN36K95/Nyyq7vvi6c8mUWZMHkfJdn6fxA4YXvCg2lHtP1NcGq2rUT9a/mMhADBTWQfe3LRCku4Jjf2CDbidamrT4jl4xrvajxrxliKMiQ/9S0=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=gqREqP1MZL/tsMRvKXR3v1ER0YYp9a186FRT4eACNgrTPQbRhvMIlJPQXFH3eM4Q1HrJKx0WrrLoE7DfVQa1iGbdwiohy94nSrtOg7Cni8BFDpuuPb5IubTmEA8U7i8qtB/q+/eDMyMyOhsch7Vb7fphQIUIyYoDFffVuIsGu+s=;
Message-ID: <589222.56161.qm@web50305.mail.re2.yahoo.com>
X-YMail-OSG: eCSTS5EVM1lC2HOCW01YmcCjm8udBCR6hWEAgDcz_OAUsnO3ySgjLz9KmABHb6Z3JEZzNzCSobWAaUb4r.ySvNEZaKX7byHGwm7EQpn0cS3qh1MNFOyg3PIiUL0CgSBONgkvMbFqtQQLHqAqP65EcuvpvZs.y8_5tOFGfO9fYLaEcSSE2UcNnzMVcdEWM8eEv8iqMShZR6jcsDw7G.VzqQKSQmY_WI99qRG1kN41TbIws8dWj7BFR1_vY06j5idmUQRaKdngnPEMg8NUSVRf_QgzmPYztIjdTYL4ptd3w015.iK02xdBcxG8YhRkZD8VLhrCkJ3n848mElYk9nATkgbuLjWBvdO4t3LiAnMcc7gxMKAKiqvkSBDrV_JnAT7352Od7YZKxHb2vJ9MUOvnC_ptLr2nSrJNwWl5wWGeYD5icMmzbbWjZeGpddePQa_xEan5OaIApfIvbN3JI.q.yxxYHDU1PbPzHNsnhZVtlKaZwaJPIG.ca2j7tCYChvjnEdDbztsczEantnB.2eIKNGGuxXLyYAiq1FJKJxzB
Received: from [74.72.161.151] by web50305.mail.re2.yahoo.com via HTTP; Fri, 08 Jan 2010 20:20:48 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <470573.94266.qm@web36108.mail.mud.yahoo.com>
Date: Fri, 8 Jan 2010 20:20:48 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: a complete solution for building a website search with lucene
To: java-user@lucene.apache.org
In-Reply-To: <470573.94266.qm@web36108.mail.mud.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Nutch is written in Java, so Nutch itself *should* work on other non-Linux =
OSs that the JVM supports.=0ABut it does contain some shell scripts, as doe=
s Hadoop that Nutch uses.  Oh, I guess Windows people run it under Cygwin?=
=0A Otis=0A--=0ASematext -- http://sematext.com/ -- Solr - Lucene - Nutch=
=0A=0A=0A=0A----- Original Message ----=0A> From: "jyzhou817@yahoo.com" <jy=
zhou817@yahoo.com>=0A> To: java-user@lucene.apache.org=0A> Sent: Fri, Janua=
ry 8, 2010 5:03:41 AM=0A> Subject: Re: a complete solution for building a w=
ebsite search with lucene=0A> =0A> Hi Paul,=0A> =0A> Thanks. =0A> Use Nutch=
 to do crawling. and integrate Lucene to the web application, so that =0A> =
can do search online.=0A> =0A> BTW, Nutch seems to have only Linux version,=
 what my development is on Windows. =0A> Am i right?=0A> =0A> Zhou=0A> =0A>=
 --- On Fri, 8/1/10, Paul Libbrecht wrote:=0A> =0A> From: Paul Libbrecht =
=0A> Subject: Re: a complete solution for building a website search with lu=
cene=0A> To: java-user@lucene.apache.org=0A> Date: Friday, 8 January, 2010,=
 4:27 PM=0A> =0A> Zhou,=0A> =0A> Lucene is a back-end library, it's very us=
eful for developer but it is not a =0A> complete site-search-engine.=0A> A =
lucene-based site-search-engine is Nutch, it does crawl.=0A> Solr also prov=
ides functions close to these with a large amount of thoughts on =0A> flexi=
ble integration; crawling methods are rather based on feeds or other =0A> a=
cquisition methods (see DIH for example).=0A> =0A> paul=0A> =0A> =0A> =0A> =
=0A> Le 08-janv.-10 =E0 08:08, a =E9crit :=0A> =0A> > Hi ,=0A> > =0A> > I a=
m new in Lucene.=0A> > =0A> > To build a web search function, it need to ha=
ve a backendc indexing function. =0A> But, before that, should run a Crawle=
r? because Lucene index based on Html =0A> documents, while Crawler can cha=
nge the website pages to Html documents. Am i =0A> right?=0A> > =0A> > If s=
o, please anyone suggest to me a Crawler? like Nutch?=0A> > Thanks=0A> > Zh=
ou=0A> > =0A> > =0A> > =0A> > =0A> >      New Email names for you!=0A> > Ge=
t the Email name you've always wanted on the new @ymail and @rocketmail.=0A=
> > Hurry before someone else does!=0A> > http://mail.promotions.yahoo.com/=
newdomains/sg/=0A> =0A> =0A> ----------------------------------------------=
-----------------------=0A> To unsubscribe, e-mail: java-user-unsubscribe@l=
ucene.apache.org=0A> For additional commands, e-mail: java-user-help@lucene=
.apache.org=0A> =0A> =0A> =0A> =0A>       New Email names for you! =0A> Get=
 the Email name you've always wanted on the new @ymail and @rocketmail. =0A=
> Hurry before someone else does!=0A> http://mail.promotions.yahoo.com/newd=
omains/sg/=0A

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44440-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 09:01:31 2010
Return-Path: <java-user-return-44440-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9473 invoked from network); 9 Jan 2010 09:01:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 09:01:30 -0000
Received: (qmail 27040 invoked by uid 500); 9 Jan 2010 09:01:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26961 invoked by uid 500); 9 Jan 2010 09:01:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26951 invoked by uid 99); 9 Jan 2010 09:01:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 09:01:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 09:01:18 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id D8FAC508D9; Sat,  9 Jan 2010 01:00:57 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-131-31-rndf-esr-3.dynamic.isadsl.co.za [196.210.131.31])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id B3AFF508D4
	for <java-user@lucene.apache.org>; Sat,  9 Jan 2010 01:00:56 -0800 (PST)
Message-ID: <4B4845C2.3060600@stimulussoft.com>
Date: Sat, 09 Jan 2010 11:00:50 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Search query problem
References: <678109.86020.qm@web52905.mail.re2.yahoo.com>	 <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net>	 <f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com>	 <4B478F1F.6050406@stimulussoft.com>	 <8c4e68611001081211if0620cao4a3cef2bdb81c694@mail.gmail.com>	 <4B47A35E.60004@stimulussoft.com> <27b05b491001081339l47d67ce4j7f3d6c7e663fcd70@mail.gmail.com>
In-Reply-To: <27b05b491001081339l47d67ce4j7f3d6c7e663fcd70@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-1.6 required=2.0 tests=ALL_TRUSTED,AWL,BAYES_00,
	FH_DATE_PAST_20XX autolearn=no version=3.2.4

Hi All

Is there another stemmer we can use that is perhaps not as aggressive as 
the Porter Stemmer. i.e. the stemming could remove ing's, er's, but not 
something so significant as to convert ""Lowe's" to "Low"

Thanks

Jamie

Will Murnane wrote:
> On Fri, Jan 8, 2010 at 16:27, Jamie <jamie@stimulussoft.com> wrote:
>   
>> Hi Ian / Will
>>
>> Thanks. Surely, the Porter Stemmer should not stem proper noun's. i.e. it
>> could check the capitalization of the first letter of a word and whether or
>> not the word is the start of sentence. If so, it could choose not apply any
>> stemming. Or am I completely out of whack?
>>     
> Look again: you're downcasing the terms before the Porter filter ever
> sees them (which is, AIUI, necessary).  You might do well to combine
> the tokenizing and downcasing step with some heuristic to find proper
> nouns and not downcase or stem them.
>
> Will
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


-- 
Stimulus Software - MailArchiva
Email Archiving And Compliance
USA Tel: +1-713-343-8824 ext 100
UK Tel: +44-20-80991035 ext 100
Email:  jamie@stimulussoft.com
Web: http://www.mailarchiva.com
To receive MailArchiva Enterprise Edition product announcements, send a message to: <mailarchiva-enterprise-edition-subscribe@stimulussoft.com>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44441-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 10:17:17 2010
Return-Path: <java-user-return-44441-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37244 invoked from network); 9 Jan 2010 10:17:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 10:17:17 -0000
Received: (qmail 60879 invoked by uid 500); 9 Jan 2010 10:17:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60812 invoked by uid 500); 9 Jan 2010 10:17:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60802 invoked by uid 99); 9 Jan 2010 10:17:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 10:17:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 10:17:04 +0000
Received: by fxm2 with SMTP id 2so17743963fxm.5
        for <java-user@lucene.apache.org>; Sat, 09 Jan 2010 02:16:43 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=c82ka7kESRwyN197Oml8uoSNL84oqXyf841AObboymk=;
        b=YNCNaP3YHlUdhxD84PPWDy/n1oXZXjKSP2TkPcVZrk55dmFR93ARC1fgyQ+BFnbM1L
         exSAmrJYv5Vu44LiV9nvihfTEmrTq0WfyQEXqK//7NrATDphM6SUVj4WxUX4lPtOSrEn
         IWYv4rb/gH4XPgVJ4uNFnEduoK4ydU2C8ZPyQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=dLP3zRv+HEy3OCf7nNvfbsYsG6Jrs061k8dxHgZufLc000NgTW4HyEkjWR0cnak2gF
         sUao9PIsogdXJf/ohQUgPgydpa/qJXjDx7kC6qenvjHzUiPbRK/VQkS+cv1I4f7C+Wj+
         xstwtRBIRJbekW1aairX43Lzwpj6xDrhZy7eE=
MIME-Version: 1.0
Received: by 10.239.179.131 with SMTP id d3mr2543277hbg.15.1263032203509; Sat, 
	09 Jan 2010 02:16:43 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <589222.56161.qm@web50305.mail.re2.yahoo.com>
References: <470573.94266.qm@web36108.mail.mud.yahoo.com>
	 <589222.56161.qm@web50305.mail.re2.yahoo.com>
Date: Sat, 9 Jan 2010 11:16:43 +0100
Message-ID: <f18c9dde1001090216p208ea8b6s2d67c1bef6ae8126@mail.gmail.com>
Subject: Re: a complete solution for building a website search with lucene
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I don't know that much about nutch but hadoop shouldn't really run
under windows in production. If you use windows for development this
should not be a big issue.
Oatis is right you should use cygwin together with hadoop. look at
http://wiki.apache.org/hadoop/FAQ for initial info.

simon

On Sat, Jan 9, 2010 at 5:20 AM, Otis Gospodnetic
<otis_gospodnetic@yahoo.com> wrote:
> Nutch is written in Java, so Nutch itself *should* work on other non-Linu=
x OSs that the JVM supports.
> But it does contain some shell scripts, as does Hadoop that Nutch uses. =
=C2=A0Oh, I guess Windows people run it under Cygwin?
> =C2=A0Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>
>
> ----- Original Message ----
>> From: "jyzhou817@yahoo.com" <jyzhou817@yahoo.com>
>> To: java-user@lucene.apache.org
>> Sent: Fri, January 8, 2010 5:03:41 AM
>> Subject: Re: a complete solution for building a website search with luce=
ne
>>
>> Hi Paul,
>>
>> Thanks.
>> Use Nutch to do crawling. and integrate Lucene to the web application, s=
o that
>> can do search online.
>>
>> BTW, Nutch seems to have only Linux version, what my development is on W=
indows.
>> Am i right?
>>
>> Zhou
>>
>> --- On Fri, 8/1/10, Paul Libbrecht wrote:
>>
>> From: Paul Libbrecht
>> Subject: Re: a complete solution for building a website search with luce=
ne
>> To: java-user@lucene.apache.org
>> Date: Friday, 8 January, 2010, 4:27 PM
>>
>> Zhou,
>>
>> Lucene is a back-end library, it's very useful for developer but it is n=
ot a
>> complete site-search-engine.
>> A lucene-based site-search-engine is Nutch, it does crawl.
>> Solr also provides functions close to these with a large amount of thoug=
hts on
>> flexible integration; crawling methods are rather based on feeds or othe=
r
>> acquisition methods (see DIH for example).
>>
>> paul
>>
>>
>>
>>
>> Le 08-janv.-10 =C3=A0 08:08, a =C3=A9crit :
>>
>> > Hi ,
>> >
>> > I am new in Lucene.
>> >
>> > To build a web search function, it need to have a backendc indexing fu=
nction.
>> But, before that, should run a Crawler? because Lucene index based on Ht=
ml
>> documents, while Crawler can change the website pages to Html documents.=
 Am i
>> right?
>> >
>> > If so, please anyone suggest to me a Crawler? like Nutch?
>> > Thanks
>> > Zhou
>> >
>> >
>> >
>> >
>> > =C2=A0 =C2=A0 =C2=A0New Email names for you!
>> > Get the Email name you've always wanted on the new @ymail and @rocketm=
ail.
>> > Hurry before someone else does!
>> > http://mail.promotions.yahoo.com/newdomains/sg/
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>>
>> =C2=A0 =C2=A0 =C2=A0 New Email names for you!
>> Get the Email name you've always wanted on the new @ymail and @rocketmai=
l.
>> Hurry before someone else does!
>> http://mail.promotions.yahoo.com/newdomains/sg/
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44442-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 12:19:59 2010
Return-Path: <java-user-return-44442-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63811 invoked from network); 9 Jan 2010 12:19:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 12:19:59 -0000
Received: (qmail 27176 invoked by uid 500); 9 Jan 2010 12:19:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27077 invoked by uid 500); 9 Jan 2010 12:19:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27067 invoked by uid 99); 9 Jan 2010 12:19:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 12:19:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of shashi.mit@gmail.com designates 209.85.219.224 as permitted sender)
Received: from [209.85.219.224] (HELO mail-ew0-f224.google.com) (209.85.219.224)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 12:19:48 +0000
Received: by ewy24 with SMTP id 24so26796471ewy.6
        for <java-user@lucene.apache.org>; Sat, 09 Jan 2010 04:19:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:from:date:x-google-sender-auth:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=qnQ5PA0ye9QZWHH9ecoWJb4lMzEIRkKViP0Vf83Vwfs=;
        b=lqRUV1aTsbz6+Y8/q7tM1iXL6QGMkx7LJUNhpJ4lcF585mCzJQuPKnXlKe98IuK3EI
         UFnLG5dae6LDKSbkpda5QqRLcBxwtOTVYJWneZYvwsS3EcadVgr72M6e+YEwHwXV4ILK
         wAbhYIisQKk6aaCgdiohUU7agCAZSZWi/eD4I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:from:date
         :x-google-sender-auth:message-id:subject:to:content-type
         :content-transfer-encoding;
        b=Im9IwprY3aWQJkADVOtj5x3ABV4aDntHvLRoRDBjB+a+dbgEDHKbv0HDneZyd6y22B
         DLCoGY+M/KmhxD2n3llJaN9sA5FuF9CmZIyA7yCg/m9F1AsfJUQvrCu6YQzr5Wtyc9j+
         hM4lFr2sguHrr3hqd5UgOWU09Sbpd2Pzje5+o=
MIME-Version: 1.0
Sender: shashi.mit@gmail.com
Received: by 10.216.87.69 with SMTP id x47mr1425123wee.97.1263039567126; Sat, 
	09 Jan 2010 04:19:27 -0800 (PST)
In-Reply-To: <4B4845C2.3060600@stimulussoft.com>
References: <678109.86020.qm@web52905.mail.re2.yahoo.com> <Pine.LNX.4.64.1001081045450.5924@radix.cryptio.net> 
	<f18c9dde1001081153v5966b803jfdd42a9d86c18d99@mail.gmail.com> 
	<4B478F1F.6050406@stimulussoft.com> <8c4e68611001081211if0620cao4a3cef2bdb81c694@mail.gmail.com> 
	<4B47A35E.60004@stimulussoft.com> <27b05b491001081339l47d67ce4j7f3d6c7e663fcd70@mail.gmail.com> 
	<4B4845C2.3060600@stimulussoft.com>
From: Shashi Kant <skant@sloan.mit.edu>
Date: Sat, 9 Jan 2010 07:19:07 -0500
X-Google-Sender-Auth: b935c8a0957243c5
Message-ID: <4d19a3631001090419m54f58037u97c480dbd9604ec2@mail.gmail.com>
Subject: Re: Search query problem
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Couldn't you just mod the PorterStemmer class for your requirements?
(we did and provided it a list of ignore words & phrases specific to
our needs)

On Sat, Jan 9, 2010 at 4:00 AM, Jamie <jamie@stimulussoft.com> wrote:
> Hi All
>
> Is there another stemmer we can use that is perhaps not as aggressive as =
the
> Porter Stemmer. i.e. the stemming could remove ing's, er's, but not
> something so significant as to convert ""Lowe's" to "Low"
>
> Thanks
>
> Jamie
>
> Will Murnane wrote:
>>
>> On Fri, Jan 8, 2010 at 16:27, Jamie <jamie@stimulussoft.com> wrote:
>>
>>>
>>> Hi Ian / Will
>>>
>>> Thanks. Surely, the Porter Stemmer should not stem proper noun's. i.e. =
it
>>> could check the capitalization of the first letter of a word and whethe=
r
>>> or
>>> not the word is the start of sentence. If so, it could choose not apply
>>> any
>>> stemming. Or am I completely out of whack?
>>>
>>
>> Look again: you're downcasing the terms before the Porter filter ever
>> sees them (which is, AIUI, necessary). =A0You might do well to combine
>> the tokenizing and downcasing step with some heuristic to find proper
>> nouns and not downcase or stem them.
>>
>> Will
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
> --
> Stimulus Software - MailArchiva
> Email Archiving And Compliance
> USA Tel: +1-713-343-8824 ext 100
> UK Tel: +44-20-80991035 ext 100
> Email: =A0jamie@stimulussoft.com
> Web: http://www.mailarchiva.com
> To receive MailArchiva Enterprise Edition product announcements, send a
> message to: <mailarchiva-enterprise-edition-subscribe@stimulussoft.com>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44443-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 12:28:40 2010
Return-Path: <java-user-return-44443-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65132 invoked from network); 9 Jan 2010 12:28:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 12:28:40 -0000
Received: (qmail 32597 invoked by uid 500); 9 Jan 2010 12:28:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32500 invoked by uid 500); 9 Jan 2010 12:28:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32488 invoked by uid 99); 9 Jan 2010 12:28:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 12:28:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.15] (HELO web52905.mail.re2.yahoo.com) (206.190.49.15)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 09 Jan 2010 12:28:29 +0000
Received: (qmail 37074 invoked by uid 60001); 9 Jan 2010 12:28:08 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263040087; bh=njnK8lKIrl/XamZXMf/3CHyXzJzG1IHapR64jaZ32ZY=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=bUzHR+Q89cR83eElFwGCQLqesyhOV1LUKYMWASgzXkJpV69T4RV9VPgpTjkZ1L8+TqFJeQgQoiNUIaf9PnXkz987Kri4OBr+mndLL/A3BPduRPCW3S5GqliyG4f39zQ8fJ9oQp9PgU2fe8EVd7B+pffFTTowvn7LPaORA4LImMg=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=ByqRwsMaLykvoXbshuV4c0p5b9/DVH8XoWc/j/rEDR5zzDMIFUXqKAPWu0xNsTeqRbLaxKkKoLh3EIhT5sHlHTBXugpgATL5go0u4zmvFkhedf4NX9F27I/VeR62t/F0Pz6DBeoirxiPokMeLAJ8+Ze579ttRiSho8lL4bCwxTQ=;
Message-ID: <943693.36396.qm@web52905.mail.re2.yahoo.com>
X-YMail-OSG: DIqw9ssVM1lbKDsWQDy5MZCWKvNIXqJEndhOdz4QnWr3iWAFKw7YVNOmpbe8spyNF9YQcNf7_P05xPMDHRq1s0v6yr3ljJBJ7rJoL3gXEp9zAC8RNIPi6OjHL0O3DaoFXMDL0jpf_Vt32oM5c2H4ztVlJ1IkdKMu79j53T.qLTWu9VSxtILf305kdHV3QZmoWiHQD1.QEQGVEsThCNp3ox.k1r4luyfC3L394WyGFsLnHhVmfX2ICjhiUJO_qJmnmlV.lpmCaxscv.rn8j9fXqYZ8dJlgksaQaFPjiGh1Pi2odpeneZ_pB9pUA79HNzM_9u461CsRl3nTq5EHlLIwlaFiuTmPKVRYB7C0SOt9tGLgailPIaHn7X0PGK4hIPZ8J5ErJWt5wpTKw.Uf8kswhgikElOcCRJfkimw.kOL9XI9e322ZIF8rUiPZYMa2aaZ5t1jZqOaZY_.cZjhV3nNCkPGiVNgEtzxCvQbSSiPURoJK7o1_.pRz7SrncBjyHTGJp6cpCh
Received: from [95.15.159.50] by web52905.mail.re2.yahoo.com via HTTP; Sat, 09 Jan 2010 04:28:07 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Sat, 9 Jan 2010 04:28:07 -0800 (PST)
From: Ahmet Arslan <iorixxx@yahoo.com>
Subject: Re: Search query problem
To: java-user@lucene.apache.org
In-Reply-To: <4B4845C2.3060600@stimulussoft.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> Is there another stemmer we can use that is perhaps not as
> aggressive as the Porter Stemmer. 

"KStem is an alternative to Porter for developers looking for a less agressive stemmer. It was written by Bob Krovetz, ported to Lucene by Sergio Guzman-Lara (UMASS Amherst)." [1]

[1]http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters/Kstem?highlight=(kstemmer)

> i.e. the stemming could remove ing's,
> er's, but not 
> something so significant as to convert ""Lowe's" to "Low"

By the way Apostrophes are removed by StandardFilter in your analyzer chain. 


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44444-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 12:56:41 2010
Return-Path: <java-user-return-44444-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82729 invoked from network); 9 Jan 2010 12:56:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 12:56:41 -0000
Received: (qmail 48304 invoked by uid 500); 9 Jan 2010 12:56:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48254 invoked by uid 500); 9 Jan 2010 12:56:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48244 invoked by uid 99); 9 Jan 2010 12:56:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 12:56:39 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.176.44] (HELO web26507.mail.ukl.yahoo.com) (217.146.176.44)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 09 Jan 2010 12:56:27 +0000
Received: (qmail 44894 invoked by uid 60001); 9 Jan 2010 12:56:05 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.fr; s=s1024; t=1263041765; bh=h4JjKy0LtCXTR6KcMku6+Fl/4bh4mlAvVLWM0BUTZic=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=l14IpbefpC6ml/vzTL/O/pL5GsLmWpoGFk0hFeAfYVVlNN9BvDuT5ERZoLpLSSpm0QejTgLNALIClfh7c+8AnzqSLRLarsCKkLlYHiFlcuri5mgREzPeaA2BFJOQ7TEF9TjzJPTqJn+uLrd91SbylyfnXxRF4vLbJvignZtcoos=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=xDrkMtJy0ifMvpepMPw1ws+4wlPPvSys8VtaKfnQbDUTJwCuhVn+KmXmseWBNuNgNjIHYGA4tVGVGCUBlprzcvTSrksAOpfqIADVLq8rR+Ia+yZAViurENhYINPsz/b1Bc37zlllDnqTpBR8Kgb/1pV86L8DQNLdXREIquzjZrk=;
Message-ID: <520750.44264.qm@web26507.mail.ukl.yahoo.com>
X-YMail-OSG: mV6cUs0VM1kVcEVvkTuR7DgZ9mt59catL4altonFJc6jqP4eIWZL82bRe.Zk6ObubyB4zCnJW_DpURJDfk9iT.JbQyqSZxRzPl04OkkgmTvecpvmgTXXesgkV4sOEu9tKv8.F7e.V.6VmzQcd58FbBONWh11ns65egdeMoU9H2us4uErmZPDgmNVJXy.sXjrG.7GZKUa8waMllzvy4HPPtBSd7VG_j_1_4l3ycG2fwB9NfHwQCl8MHWYF3hUzi7zGfTttCl0AwKIbAr1.ZESRW4YErz1.OBAg2_WDinxAI_vaJNoErZCFJdWyKFHinZFIpoHSZc0ZAPj
Received: from [82.66.133.250] by web26507.mail.ukl.yahoo.com via HTTP; Sat, 09 Jan 2010 12:56:05 GMT
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Sat, 9 Jan 2010 12:56:05 +0000 (GMT)
From: legrand thomas <thomaslegrand14@yahoo.fr>
Subject: Re: Concurrent access IndexReader / IndexWriter -  FileNotFoundException
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa1001080400m7918fc6ahe7c7880cb62b3d4c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1648530504-1263041765=:44264"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1648530504-1263041765=:44264
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable



Michael,

The exception only occurs when the writer commits. But but the IndexReader =
can keep on reading.
The searches are performed by the IndexSearcher using the IndexReader.
My filesystem is ext2fs.

I give a few details below about the way I use them; the FNF exception occu=
rs in the "commitIndexWriter" method.

Thanks,
Tom


// both reader and writer and static
protected static IndexWriter mAdIndexWriter=3Dnull;
protected static IndexReader mAdIndexReader=3Dnull;
// misc
protected static IndexSearcher mAdIndexSearcher=3Dnull;
protected static Analyzer mAdIndexAnalyser=3Dnull;


// create the writer once
private void initIndexWriter() throws EncheromaxException {
=A0=A0=A0 Directory adIndexDir=3Dnull;
=A0=A0=A0=20
=A0=A0=A0 // Where is the index ?
=A0=A0=A0 String indexLocation=3DmConfigProperties.getProperty(PropertiesEn=
um.ADVERTISEMENT_INDEX_LOCATION);=A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20

=A0=A0=A0 // Get the ad's analyser
=A0=A0=A0 Analyzer analyser =3D getAdvertisementIndexAnalyser();=20
=A0=A0=A0=20
=A0=A0=A0 // create the writer
=A0=A0=A0 if(mAdIndexWriter=3D=3Dnull){
=A0=A0=A0 =A0=A0=A0 try{
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 adIndexDir=3DFSDirectory.getDirectory(indexLo=
cation);=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 boolean isTheIndexNew=3Dtrue;=A0=A0=A0 =A0=A0=
=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 mAdIndexWriter =3D new IndexWriter(adIndexDir=
, analyser,isTheIndexNew,IndexWriter.MaxFieldLength. UNLIMITED) ;=20
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 /* ... */=A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 }catch(Exception ex){
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 /*...*/
=A0=A0=A0 =A0=A0=A0 }
=A0=A0=A0 }=A0=A0=A0=20
}=A0=A0=A0=20


// get the reader=20
private IndexReader getAdvertisementIndexReader() throws EncheromaxExceptio=
n {
=A0=A0=A0 String indexLocation=3Dnull;
=A0=A0=A0 Directory adIndexDir=3Dnull;
=A0=A0=A0=20
=A0=A0=A0 // Where is the index ?
=A0=A0=A0 try{
=A0=A0=A0 =A0=A0=A0 indexLocation=3DmConfigProperties.getProperty(Propertie=
sEnum.ADVERTISEMENT_INDEX_LOCATION);=A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 adIndexDir=3DFSDirectory.getDirectory(indexLocation);
=A0=A0=A0 }catch(Exception direx){
=A0=A0=A0 =A0=A0=A0 /*...*/
=A0=A0=A0 }
=A0=A0=A0=20
=A0=A0=A0 // create the reader if it doesn't exist yet
=A0=A0=A0 if(mAdIndexReader=3D=3Dnull){
=A0=A0=A0 =A0=A0=A0 try{
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 mAdIndexReader=3D IndexReader.open(adIndexDir=
); =A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 }catch(Exception ex){
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 /*..*/
=A0=A0=A0 =A0=A0=A0 }
=A0=A0=A0 }else{=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 try{
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 /* do we need to re-open it ? */
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 if(mAdIndexReader.isCurrent()=3D=3Dfalse){
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 // synchronize on the reader
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 synchronized(mAdIndexReader){
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 mAdIndexReader=3D IndexRe=
ader.open(adIndexDir);
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 }
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 }
=A0=A0=A0 =A0=A0=A0 }catch(Exception ioex){
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 /*...*/
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 throw new EncheromaxException(CommonErrorEnum=
.INDEX_READER_CREATION_ERROR);
=A0=A0=A0 =A0=A0=A0 }=A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 }
=A0=A0=A0 return mAdIndexReader;
}


// get the searcher when I want to search
private IndexSearcher getAdvertisementIndexSearcher() throws EncheromaxExce=
ption {
=A0=A0=A0 // create the searcher if it doesn't exist yet
=A0=A0=A0 try{
=A0=A0=A0 =A0=A0=A0 if(mAdIndexSearcher=3D=3Dnull){
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 try{
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 mAdIndexSearcher=3D new IndexSearch=
er(getAdvertisementIndexReader());=20
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 }catch(Exception ex){
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 /*...*/
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 }
=A0=A0=A0 =A0=A0=A0 }

=A0=A0=A0 =A0=A0=A0 else if(!mAdIndexSearcher.getIndexReader().isCurrent())=
{
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 synchronized(mAdIndexSearcher){
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 =A0=A0=A0 mAdIndexSearcher=3Dnew IndexSearche=
r(getAdvertisementIndexReader());
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0 }
=A0=A0=A0 =A0=A0=A0 }
=A0=A0=A0 }catch(Exception ioex){
=A0=A0=A0 =A0=A0=A0 /*...*/
=A0=A0=A0 }=A0=A0=A0=20
=A0=A0=A0 return mAdIndexSearcher;
}



// whenever I need to commit
public synchronized void commitIndexWriter() throws EncheromaxException{
=A0=A0=A0 try{=A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 mAdIndexWriter.commit();=A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 }catch(Exception docex){=A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 /* THE FILE NOT FOUND EXCEPTION OCCURS HERE */
=A0=A0=A0 }
}


// add a document
private void addADocument(Document adDoc) throws EncheromaxException{
=A0=A0=A0 try{
=A0=A0=A0 =A0=A0=A0 mAdIndexWriter.addDocument(adDoc, getAdvertisementIndex=
Analyser());
=A0=A0=A0 =A0=A0=A0 commitIndexWriter();=A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 }catch(Exception docex){=A0=A0=A0 =A0=A0=A0 =A0=A0=A0=20
=A0=A0=A0 =A0=A0=A0 /*...*/
=A0=A0=A0 }
}


--- En date de : Ven 8.1.10, Michael McCandless <lucene@mikemccandless.com>=
 a =E9crit :

De: Michael McCandless <lucene@mikemccandless.com>
Objet: Re: Concurrent access IndexReader / IndexWriter -  FileNotFoundExcep=
tion
=C0: java-user@lucene.apache.org
Date: Vendredi 8 Janvier 2010, 13h00

Normally, this (using an IndexReader, [re-]opening a new IndexReader
while an IndexWriter is committing) is perfectly fine.=A0 The reader
searches the point-in-time snapshot of the index as of when it was
opened.

But: what filesystem are you using?=A0 NFS presents challenges, for example=
.

Mike

On Fri, Jan 8, 2010 at 5:35 AM, legrand thomas <thomaslegrand14@yahoo.fr> w=
rote:
> Hi,
>
> I often get a FileNotFoundException when my single IndexWriter commits wh=
ile the IndexReader also tries to read. My application is multithreaded (To=
mcat uses the business APIs); I firstly thought the read/write access was t=
hread-safe but I probably forget something.
>
>  Please help me to understand my mistakes:
>
> - When should I close the IndexWriter ? Each time I add/update a document=
 or never ?
> - Should my java commit/read methods be synchronized ?
> - Should I lock the directory and what's the best way to do it ?
>
> I referred to the Lucene FAQ ("why do I sometimes get a FileNotFoundExcep=
tion when I search and update my index at the same time?") but I did not di=
sable any locking for processes searching or updating the index.
>
> I use lucene-2.4.1.
>
> Thanks in advance,
> Tom
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-1648530504-1263041765=:44264--

From java-user-return-44445-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 13:51:33 2010
Return-Path: <java-user-return-44445-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 739 invoked from network); 9 Jan 2010 13:51:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 13:51:33 -0000
Received: (qmail 89936 invoked by uid 500); 9 Jan 2010 13:51:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89861 invoked by uid 500); 9 Jan 2010 13:51:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89851 invoked by uid 99); 9 Jan 2010 13:51:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 13:51:31 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 13:51:21 +0000
Received: by ywh14 with SMTP id 14so18873551ywh.20
        for <java-user@lucene.apache.org>; Sat, 09 Jan 2010 05:51:00 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.39.34 with SMTP id m34mr2904903ybm.98.1263045060185; Sat, 
	09 Jan 2010 05:51:00 -0800 (PST)
In-Reply-To: <394936.36675.qm@web26506.mail.ukl.yahoo.com>
References: <394936.36675.qm@web26506.mail.ukl.yahoo.com>
Date: Sat, 9 Jan 2010 08:51:00 -0500
Message-ID: <9ac0c6aa1001090551l6214f238ua5ac142f89563253@mail.gmail.com>
Subject: Re: Concurrent access IndexReader / IndexWriter - 
	FileNotFoundException
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Can you post the full FNFE stack trace?

Mike

On Fri, Jan 8, 2010 at 5:35 AM, legrand thomas <thomaslegrand14@yahoo.fr> w=
rote:
> Hi,
>
> I often get a FileNotFoundException when my single IndexWriter commits wh=
ile the IndexReader also tries to read. My application is multithreaded (To=
mcat uses the business APIs); I firstly thought the read/write access was t=
hread-safe but I probably forget something.
>
> =A0Please help me to understand my mistakes:
>
> - When should I close the IndexWriter ? Each time I add/update a document=
 or never ?
> - Should my java commit/read methods be synchronized ?
> - Should I lock the directory and what's the best way to do it ?
>
> I referred to the Lucene FAQ ("why do I sometimes get a FileNotFoundExcep=
tion when I search and update my index at the same time?") but I did not di=
sable any locking for processes searching or updating the index.
>
> I use lucene-2.4.1.
>
> Thanks in advance,
> Tom
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44446-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 15:06:52 2010
Return-Path: <java-user-return-44446-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26151 invoked from network); 9 Jan 2010 15:06:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 15:06:52 -0000
Received: (qmail 41992 invoked by uid 500); 9 Jan 2010 15:06:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41907 invoked by uid 500); 9 Jan 2010 15:06:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41897 invoked by uid 99); 9 Jan 2010 15:06:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 15:06:50 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.176.40] (HELO web26503.mail.ukl.yahoo.com) (217.146.176.40)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 09 Jan 2010 15:06:38 +0000
Received: (qmail 87376 invoked by uid 60001); 9 Jan 2010 15:06:14 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.fr; s=s1024; t=1263049574; bh=6THHNTEDVGrXEEQOxp666degv3e/yp8fpjh1TQ1TPb4=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=4K/26SU3K+H3EJb1dT708zsFnK/3cBu0OnUw3+yLFjhfjuHINeclFeEne6bU9uofbb3cR+ABuYEa7azGpIn+xU+hs4ZCRJKXzmSVUh8mPu6aaBGQMsf2Z44GtlYeVuHSA09qHe0e+6PMJcTAsTLjVAvtp9pbpVzSuIfYVRLZBqI=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=Eq6RLBMgqXP0sckmJp8gLIFodR+16Qu2dT1rrMH36t7grkSeXQeTkFgBPV79KGknWzpkPw0ssf04Ij/FVkKoqOf54Z4Lj1N3zPevFDPYvDUiRFU/NXFxsh0T3+QefQ/tdleeGU5C2HqhHnpsidK1ylg0gn+VUoxYi0xIg+ygRck=;
Message-ID: <344528.87135.qm@web26503.mail.ukl.yahoo.com>
X-YMail-OSG: sA.LuOYVM1nv61S235L6RmwxSjV8rA97INeju7zsItwegujwuy6ElLzZK6PeiPen8Yva1O7y0RenUin202b2Mp73bhgVA5qiIyxbg_sCO1QhGkrUgTgv1PJUGCQDLLv7F3EIN8xE4k6TYLVoxtykAScDEK_KcC9WM3K5CNuaE.MMdfgvFnDrE4ar3sTqfWgAd6117QyUPvtinBz8C14nAfwYirUPvUkdp0gMF5qfD_FcY7UqOUIg_igSSSHbIrD.Ijg32jkN7ODGuJNMoWpSe1dJFlvrR5qM6Y4in6XSDinb_pKRhf8ZoP5yzp1sPX.QNwDMjiNgfM0f
Received: from [82.66.133.250] by web26503.mail.ukl.yahoo.com via HTTP; Sat, 09 Jan 2010 15:06:13 GMT
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Sat, 9 Jan 2010 15:06:13 +0000 (GMT)
From: legrand thomas <thomaslegrand14@yahoo.fr>
Subject: Re: Concurrent access IndexReader / IndexWriter -  FileNotFoundException
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa1001090551l6214f238ua5ac142f89563253@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1746563931-1263049573=:87135"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1746563931-1263049573=:87135
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable


Here are two stack traces: add+remove a document:

Tom

---

Remove a document:

java.io.FileNotFoundException: /home/ia/prod/current-deployment/indexes/adv=
ertisement/_0.cfs (No such file or directory)
=A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.open(Native Method)
=A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.<init>(RandomAccessFile.j=
ava:212)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput$D=
escriptor.<init>(FSDirectory.java:552)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput.<=
init>(FSDirectory.java:582)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory.openInput(FSDi=
rectory.java:488)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.CompoundFileReader.<init>(=
CompoundFileReader.java:70)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.initialize(S=
egmentReader.java:321)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(SegmentR=
eader.java:306)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(SegmentR=
eader.java:236)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.DocumentsWriter.applyDelet=
es(DocumentsWriter.java:915)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.applyDeletes(I=
ndexWriter.java:4339)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.doFlush(IndexW=
riter.java:3579)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.flush(IndexWri=
ter.java:3450)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.prepareCommit(=
IndexWriter.java:3363)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.commit(IndexWr=
iter.java:3408)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementati=
on.AdvertisementManager.commitIndexWriter(AdvertisementManager.java:1728)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementati=
on.AdvertisementManager.removeAdvertisementFromIndex(AdvertisementManager.j=
ava:635)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.api.implementation.admin.ApiAdminBu=
rnAdvertisement.executeRequest(ApiAdminBurnAdvertisement.java:210)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.controller.admin.Rule.doReqFinal(Ru=
le.java:100)
=A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.process(Action.j=
ava:302)
=A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.doPost(Action.ja=
va:87)
=A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServlet=
.java:710)
=A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServlet=
.java:803)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.in=
ternalDoFilter(ApplicationFilterChain.java:269)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.do=
Filter(ApplicationFilterChain.java:188)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.servlet.filter.EncheromaxBeanFilter=
.doFilter(EncheromaxBeanFilter.java:53)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.in=
ternalDoFilter(ApplicationFilterChain.java:215)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.do=
Filter(ApplicationFilterChain.java:188)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardWrapperValve.invo=
ke(StandardWrapperValve.java:213)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardContextValve.invo=
ke(StandardContextValve.java:174)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardHostValve.invoke(=
StandardHostValve.java:127)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.valves.ErrorReportValve.invoke=
(ErrorReportValve.java:117)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardEngineValve.invok=
e(StandardEngineValve.java:108)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.connector.CoyoteAdapter.servic=
e(CoyoteAdapter.java:174)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyo=
teHandler.java:200)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.HandlerRequest.invoke(Handler=
Request.java:283)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.invoke(ChannelS=
ocket.java:773)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.processConnecti=
on(ChannelSocket.java:703)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket$SocketConnectio=
n.runIt(ChannelSocket.java:895)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.tomcat.util.threads.ThreadPool$ControlR=
unnable.run(ThreadPool.java:689)

Add a document:

java.io.FileNotFoundException: /home/ia/prod/current-deployment/indexes/adv=
ertisement/_v.cfs (No such file or directory)
=A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.open(Native Method)
=A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.<init>(RandomAccessFile.j=
ava:212)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput$D=
escriptor.<init>(FSDirectory.java:552)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput.<=
init>(FSDirectory.java:582)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory.openInput(FSDi=
rectory.java:488)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.CompoundFileReader.<init>(=
CompoundFileReader.java:70)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.initialize(S=
egmentReader.java:321)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(SegmentR=
eader.java:306)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(SegmentR=
eader.java:236)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.DocumentsWriter.applyDelet=
es(DocumentsWriter.java:915)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.applyDeletes(I=
ndexWriter.java:4339)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.doFlush(IndexW=
riter.java:3579)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.flush(IndexWri=
ter.java:3450)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.prepareCommit(=
IndexWriter.java:3363)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.commit(IndexWr=
iter.java:3408)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementati=
on.AdvertisementManager.commitIndexWriter(AdvertisementManager.java:1728)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementati=
on.AdvertisementManager.addAdvertisementDocument(AdvertisementManager.java:=
536)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementati=
on.AdvertisementManager.appendFullAdvertisementToIndex(AdvertisementManager=
.java:713)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.api.implementation.ApiFinalizeAdver=
tisement.executeRequest(ApiFinalizeAdvertisement.java:224)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.controller.advertisement.CreateAdve=
rtisement.doReq(CreateAdvertisement.java:294)
=A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Security.doReqFinal(Sec=
urity.java:135)
=A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.process(Action.j=
ava:302)
=A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.doPost(Action.ja=
va:87)
=A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServlet=
.java:710)
=A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServlet=
.java:803)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.in=
ternalDoFilter(ApplicationFilterChain.java:269)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.do=
Filter(ApplicationFilterChain.java:188)
=A0=A0=A0=A0=A0=A0=A0 at com.encheromax.servlet.filter.EncheromaxBeanFilter=
.doFilter(EncheromaxBeanFilter.java:53)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.in=
ternalDoFilter(ApplicationFilterChain.java:215)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.do=
Filter(ApplicationFilterChain.java:188)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardWrapperValve.invo=
ke(StandardWrapperValve.java:213)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardContextValve.invo=
ke(StandardContextValve.java:174)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardHostValve.invoke(=
StandardHostValve.java:127)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.valves.ErrorReportValve.invoke=
(ErrorReportValve.java:117)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardEngineValve.invok=
e(StandardEngineValve.java:108)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.connector.CoyoteAdapter.servic=
e(CoyoteAdapter.java:174)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyo=
teHandler.java:200)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.HandlerRequest.invoke(Handler=
Request.java:283)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.invoke(ChannelS=
ocket.java:773)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.processConnecti=
on(ChannelSocket.java:703)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket$SocketConnectio=
n.runIt(ChannelSocket.java:895)
=A0=A0=A0=A0=A0=A0=A0 at org.apache.tomcat.util.threads.ThreadPool$ControlR=
unnable.run(ThreadPool.java:689)
=A0=A0=A0=A0=A0=A0=A0 at java.lang.Thread.run(Thread.java:619)






--- En date de : Sam 9.1.10, Michael McCandless <lucene@mikemccandless.com>=
 a =E9crit :

De: Michael McCandless <lucene@mikemccandless.com>
Objet: Re: Concurrent access IndexReader / IndexWriter -  FileNotFoundExcep=
tion
=C0: java-user@lucene.apache.org
Date: Samedi 9 Janvier 2010, 14h51

Can you post the full FNFE stack trace?

Mike

On Fri, Jan 8, 2010 at 5:35 AM, legrand thomas <thomaslegrand14@yahoo.fr> w=
rote:
> Hi,
>
> I often get a FileNotFoundException when my single IndexWriter commits wh=
ile the IndexReader also tries to read. My application is multithreaded (To=
mcat uses the business APIs); I firstly thought the read/write access was t=
hread-safe but I probably forget something.
>
>  Please help me to understand my mistakes:
>
> - When should I close the IndexWriter ? Each time I add/update a document=
 or never ?
> - Should my java commit/read methods be synchronized ?
> - Should I lock the directory and what's the best way to do it ?
>
> I referred to the Lucene FAQ ("why do I sometimes get a FileNotFoundExcep=
tion when I search and update my index at the same time?") but I did not di=
sable any locking for processes searching or updating the index.
>
> I use lucene-2.4.1.
>
> Thanks in advance,
> Tom
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-1746563931-1263049573=:87135--

From java-user-return-44447-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 17:54:43 2010
Return-Path: <java-user-return-44447-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67577 invoked from network); 9 Jan 2010 17:54:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 17:54:43 -0000
Received: (qmail 59242 invoked by uid 500); 9 Jan 2010 17:54:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59185 invoked by uid 500); 9 Jan 2010 17:54:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59175 invoked by uid 99); 9 Jan 2010 17:54:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 17:54:40 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 17:54:33 +0000
Received: by ywh14 with SMTP id 14so18971907ywh.20
        for <java-user@lucene.apache.org>; Sat, 09 Jan 2010 09:54:12 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.169.19 with SMTP id r19mr2884931ybe.111.1263059649510; 
	Sat, 09 Jan 2010 09:54:09 -0800 (PST)
In-Reply-To: <344528.87135.qm@web26503.mail.ukl.yahoo.com>
References: <9ac0c6aa1001090551l6214f238ua5ac142f89563253@mail.gmail.com>
	 <344528.87135.qm@web26503.mail.ukl.yahoo.com>
Date: Sat, 9 Jan 2010 12:54:09 -0500
Message-ID: <9ac0c6aa1001090954y7ad5ab0fq8bb3f7590d1e0de0@mail.gmail.com>
Subject: Re: Concurrent access IndexReader / IndexWriter - 
	FileNotFoundException
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Can you double check that you're not creating 2 writers on the same
directory, somehow?

Or: is there any other process that removes files from this directory?

Answering your original questions...: commit/read does not require any
external synchronization or locking.  You should generally keep your
IW open indefinitely and just periodically commit and/or get a new
reader (IndexWriter.getReader()) as needed.

Mike

On Sat, Jan 9, 2010 at 10:06 AM, legrand thomas
<thomaslegrand14@yahoo.fr> wrote:
>
> Here are two stack traces: add+remove a document:
>
> Tom
>
> ---
>
> Remove a document:
>
> java.io.FileNotFoundException: /home/ia/prod/current-deployment/indexes/a=
dvertisement/_0.cfs (No such file or directory)
> =A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.open(Native Method)
> =A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.<init>(RandomAccessFile=
.java:212)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput=
$Descriptor.<init>(FSDirectory.java:552)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput=
.<init>(FSDirectory.java:582)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory.openInput(FS=
Directory.java:488)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.CompoundFileReader.<init=
>(CompoundFileReader.java:70)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.initialize=
(SegmentReader.java:321)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(Segmen=
tReader.java:306)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(Segmen=
tReader.java:236)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.DocumentsWriter.applyDel=
etes(DocumentsWriter.java:915)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.applyDeletes=
(IndexWriter.java:4339)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.doFlush(Inde=
xWriter.java:3579)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.flush(IndexW=
riter.java:3450)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.prepareCommi=
t(IndexWriter.java:3363)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.commit(Index=
Writer.java:3408)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.commitIndexWriter(AdvertisementManager.java:1728)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.removeAdvertisementFromIndex(AdvertisementManager=
.java:635)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.api.implementation.admin.ApiAdmin=
BurnAdvertisement.executeRequest(ApiAdminBurnAdvertisement.java:210)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.controller.admin.Rule.doReqFinal(=
Rule.java:100)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.process(Action=
.java:302)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.doPost(Action.=
java:87)
> =A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServl=
et.java:710)
> =A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServl=
et.java:803)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
internalDoFilter(ApplicationFilterChain.java:269)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
doFilter(ApplicationFilterChain.java:188)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.servlet.filter.EncheromaxBeanFilt=
er.doFilter(EncheromaxBeanFilter.java:53)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
internalDoFilter(ApplicationFilterChain.java:215)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
doFilter(ApplicationFilterChain.java:188)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardWrapperValve.in=
voke(StandardWrapperValve.java:213)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardContextValve.in=
voke(StandardContextValve.java:174)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardHostValve.invok=
e(StandardHostValve.java:127)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.valves.ErrorReportValve.invo=
ke(ErrorReportValve.java:117)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardEngineValve.inv=
oke(StandardEngineValve.java:108)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.connector.CoyoteAdapter.serv=
ice(CoyoteAdapter.java:174)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.server.JkCoyoteHandler.invoke(JkCo=
yoteHandler.java:200)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.HandlerRequest.invoke(Handl=
erRequest.java:283)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.invoke(Channe=
lSocket.java:773)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.processConnec=
tion(ChannelSocket.java:703)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket$SocketConnect=
ion.runIt(ChannelSocket.java:895)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.tomcat.util.threads.ThreadPool$Contro=
lRunnable.run(ThreadPool.java:689)
>
> Add a document:
>
> java.io.FileNotFoundException: /home/ia/prod/current-deployment/indexes/a=
dvertisement/_v.cfs (No such file or directory)
> =A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.open(Native Method)
> =A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.<init>(RandomAccessFile=
.java:212)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput=
$Descriptor.<init>(FSDirectory.java:552)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput=
.<init>(FSDirectory.java:582)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory.openInput(FS=
Directory.java:488)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.CompoundFileReader.<init=
>(CompoundFileReader.java:70)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.initialize=
(SegmentReader.java:321)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(Segmen=
tReader.java:306)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(Segmen=
tReader.java:236)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.DocumentsWriter.applyDel=
etes(DocumentsWriter.java:915)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.applyDeletes=
(IndexWriter.java:4339)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.doFlush(Inde=
xWriter.java:3579)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.flush(IndexW=
riter.java:3450)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.prepareCommi=
t(IndexWriter.java:3363)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.commit(Index=
Writer.java:3408)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.commitIndexWriter(AdvertisementManager.java:1728)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.addAdvertisementDocument(AdvertisementManager.jav=
a:536)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.appendFullAdvertisementToIndex(AdvertisementManag=
er.java:713)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.api.implementation.ApiFinalizeAdv=
ertisement.executeRequest(ApiFinalizeAdvertisement.java:224)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.controller.advertisement.CreateAd=
vertisement.doReq(CreateAdvertisement.java:294)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Security.doReqFinal(S=
ecurity.java:135)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.process(Action=
.java:302)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.doPost(Action.=
java:87)
> =A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServl=
et.java:710)
> =A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServl=
et.java:803)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
internalDoFilter(ApplicationFilterChain.java:269)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
doFilter(ApplicationFilterChain.java:188)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.servlet.filter.EncheromaxBeanFilt=
er.doFilter(EncheromaxBeanFilter.java:53)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
internalDoFilter(ApplicationFilterChain.java:215)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
doFilter(ApplicationFilterChain.java:188)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardWrapperValve.in=
voke(StandardWrapperValve.java:213)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardContextValve.in=
voke(StandardContextValve.java:174)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardHostValve.invok=
e(StandardHostValve.java:127)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.valves.ErrorReportValve.invo=
ke(ErrorReportValve.java:117)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardEngineValve.inv=
oke(StandardEngineValve.java:108)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.connector.CoyoteAdapter.serv=
ice(CoyoteAdapter.java:174)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.server.JkCoyoteHandler.invoke(JkCo=
yoteHandler.java:200)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.HandlerRequest.invoke(Handl=
erRequest.java:283)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.invoke(Channe=
lSocket.java:773)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.processConnec=
tion(ChannelSocket.java:703)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket$SocketConnect=
ion.runIt(ChannelSocket.java:895)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.tomcat.util.threads.ThreadPool$Contro=
lRunnable.run(ThreadPool.java:689)
> =A0=A0=A0=A0=A0=A0=A0 at java.lang.Thread.run(Thread.java:619)
>
>
>
>
>
>
> --- En date de : Sam 9.1.10, Michael McCandless <lucene@mikemccandless.co=
m> a =E9crit :
>
> De: Michael McCandless <lucene@mikemccandless.com>
> Objet: Re: Concurrent access IndexReader / IndexWriter - =A0FileNotFoundE=
xception
> =C0: java-user@lucene.apache.org
> Date: Samedi 9 Janvier 2010, 14h51
>
> Can you post the full FNFE stack trace?
>
> Mike
>
> On Fri, Jan 8, 2010 at 5:35 AM, legrand thomas <thomaslegrand14@yahoo.fr>=
 wrote:
>> Hi,
>>
>> I often get a FileNotFoundException when my single IndexWriter commits w=
hile the IndexReader also tries to read. My application is multithreaded (T=
omcat uses the business APIs); I firstly thought the read/write access was =
thread-safe but I probably forget something.
>>
>> =A0Please help me to understand my mistakes:
>>
>> - When should I close the IndexWriter ? Each time I add/update a documen=
t or never ?
>> - Should my java commit/read methods be synchronized ?
>> - Should I lock the directory and what's the best way to do it ?
>>
>> I referred to the Lucene FAQ ("why do I sometimes get a FileNotFoundExce=
ption when I search and update my index at the same time?") but I did not d=
isable any locking for processes searching or updating the index.
>>
>> I use lucene-2.4.1.
>>
>> Thanks in advance,
>> Tom
>>
>>
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44448-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 19:07:41 2010
Return-Path: <java-user-return-44448-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4224 invoked from network); 9 Jan 2010 19:07:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 19:07:41 -0000
Received: (qmail 18059 invoked by uid 500); 9 Jan 2010 19:07:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17979 invoked by uid 500); 9 Jan 2010 19:07:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17969 invoked by uid 99); 9 Jan 2010 19:07:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 19:07:39 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.146.176.43] (HELO web26506.mail.ukl.yahoo.com) (217.146.176.43)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 09 Jan 2010 19:07:27 +0000
Received: (qmail 16876 invoked by uid 60001); 9 Jan 2010 19:07:06 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.fr; s=s1024; t=1263064026; bh=eDr9nAeX/BZPFohUk/tvGTka6Z5KZdS06Ul7aqQ5EGQ=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=BrMdWS78lrYfkZqKugiTFgBchA0C9TvJGgHSuwKSGCswyajXxuOHHxKqJmsYRj+lmZA237+9S3Cm7T6prgyXYh/AGoEaJgPcTPYskwV6aRr8xI+xCl/DliJbNrupj5O1U9WkvfEX1fTgn0RLF2XL9lOIGxUMiB2ncfZp2m1zRus=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=nUhPhcwYUQeXSAuGdVgK6aHYZcHCzd1pFsS3u+hnrC4XJ1TmcG/2Mfuhtr7zazXyjmN17j96reD1dl+6z/lTF9mr3chPedxcer3ZguW1EJqBYsqNdAj1JYj+q889gc8A3ttOGFcAlWI1ZueNft0ahnc/FCaphnHdXO9LwdetWKA=;
Message-ID: <124324.16760.qm@web26506.mail.ukl.yahoo.com>
X-YMail-OSG: rcgJQPsVM1kud3sh482CyjxkEjFalyet_esKY_KLjVHwKpTKqVsg6234dxCZbO6vMGTZdxCKq4W.gMvDbj.47aqL74CU6DCUg2zmSwp.wI0uBopnPIKnpdqbV4ZmtFErkEt3bIDJXsQt6T7V4PEfCTWLDp7bldOrzUtqE8HqyfDkissQp0iKizvypk8t5XBqJwb4d_tbs0_gQCiIzAp3neIRroeFzhAqS.XFK8sYN7dhhYfht99QhzG05m4jt28fCzyXatzXLRgWl86FjvBLONg48rN.yeSvw3TIKfhNF9Z7UDPZQpiC.4OMUYfxDowRM55GcTxoorvJ
Received: from [82.244.206.195] by web26506.mail.ukl.yahoo.com via HTTP; Sat, 09 Jan 2010 19:07:05 GMT
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Sat, 9 Jan 2010 19:07:05 +0000 (GMT)
From: legrand thomas <thomaslegrand14@yahoo.fr>
Subject: Re: Concurrent access IndexReader / IndexWriter -  FileNotFoundException
To: java-user@lucene.apache.org
In-Reply-To: <9ac0c6aa1001090954y7ad5ab0fq8bb3f7590d1e0de0@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1345017395-1263064025=:16760"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1345017395-1263064025=:16760
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Ok Michael,

Thank you for your answers, I'll check the numbers of writers as no other p=
rocess uses the directory. I'll let you know the way I make it work.

Tom

--- En date de=A0: Sam 9.1.10, Michael McCandless <lucene@mikemccandless.co=
m> a =E9crit=A0:

De: Michael McCandless <lucene@mikemccandless.com>
Objet: Re: Concurrent access IndexReader / IndexWriter -  FileNotFoundExcep=
tion
=C0: java-user@lucene.apache.org
Date: Samedi 9 Janvier 2010, 18h54

Can you double check that you're not creating 2 writers on the same
directory, somehow?

Or: is there any other process that removes files from this directory?

Answering your original questions...: commit/read does not require any
external synchronization or locking.=A0 You should generally keep your
IW open indefinitely and just periodically commit and/or get a new
reader (IndexWriter.getReader()) as needed.

Mike

On Sat, Jan 9, 2010 at 10:06 AM, legrand thomas
<thomaslegrand14@yahoo.fr> wrote:
>
> Here are two stack traces: add+remove a document:
>
> Tom
>
> ---
>
> Remove a document:
>
> java.io.FileNotFoundException: /home/ia/prod/current-deployment/indexes/a=
dvertisement/_0.cfs (No such file or directory)
> =A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.open(Native Method)
> =A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.<init>(RandomAccessFile=
.java:212)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput=
$Descriptor.<init>(FSDirectory.java:552)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput=
.<init>(FSDirectory.java:582)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory.openInput(FS=
Directory.java:488)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.CompoundFileReader.<init=
>(CompoundFileReader.java:70)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.initialize=
(SegmentReader.java:321)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(Segmen=
tReader.java:306)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(Segmen=
tReader.java:236)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.DocumentsWriter.applyDel=
etes(DocumentsWriter.java:915)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.applyDeletes=
(IndexWriter.java:4339)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.doFlush(Inde=
xWriter.java:3579)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.flush(IndexW=
riter.java:3450)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.prepareCommi=
t(IndexWriter.java:3363)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.commit(Index=
Writer.java:3408)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.commitIndexWriter(AdvertisementManager.java:1728)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.removeAdvertisementFromIndex(AdvertisementManager=
.java:635)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.api.implementation.admin.ApiAdmin=
BurnAdvertisement.executeRequest(ApiAdminBurnAdvertisement.java:210)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.controller.admin.Rule.doReqFinal(=
Rule.java:100)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.process(Action=
.java:302)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.doPost(Action.=
java:87)
> =A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServl=
et.java:710)
> =A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServl=
et.java:803)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
internalDoFilter(ApplicationFilterChain.java:269)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
doFilter(ApplicationFilterChain.java:188)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.servlet.filter.EncheromaxBeanFilt=
er.doFilter(EncheromaxBeanFilter.java:53)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
internalDoFilter(ApplicationFilterChain.java:215)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
doFilter(ApplicationFilterChain.java:188)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardWrapperValve.in=
voke(StandardWrapperValve.java:213)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardContextValve.in=
voke(StandardContextValve.java:174)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardHostValve.invok=
e(StandardHostValve.java:127)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.valves.ErrorReportValve.invo=
ke(ErrorReportValve.java:117)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardEngineValve.inv=
oke(StandardEngineValve.java:108)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.connector.CoyoteAdapter.serv=
ice(CoyoteAdapter.java:174)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.server.JkCoyoteHandler.invoke(JkCo=
yoteHandler.java:200)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.HandlerRequest.invoke(Handl=
erRequest.java:283)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.invoke(Channe=
lSocket.java:773)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.processConnec=
tion(ChannelSocket.java:703)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket$SocketConnect=
ion.runIt(ChannelSocket.java:895)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.tomcat.util.threads.ThreadPool$Contro=
lRunnable.run(ThreadPool.java:689)
>
> Add a document:
>
> java.io.FileNotFoundException: /home/ia/prod/current-deployment/indexes/a=
dvertisement/_v.cfs (No such file or directory)
> =A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.open(Native Method)
> =A0=A0=A0=A0=A0=A0=A0 at java.io.RandomAccessFile.<init>(RandomAccessFile=
.java:212)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput=
$Descriptor.<init>(FSDirectory.java:552)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory$FSIndexInput=
.<init>(FSDirectory.java:582)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.store.FSDirectory.openInput(FS=
Directory.java:488)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.CompoundFileReader.<init=
>(CompoundFileReader.java:70)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.initialize=
(SegmentReader.java:321)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(Segmen=
tReader.java:306)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.SegmentReader.get(Segmen=
tReader.java:236)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.DocumentsWriter.applyDel=
etes(DocumentsWriter.java:915)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.applyDeletes=
(IndexWriter.java:4339)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.doFlush(Inde=
xWriter.java:3579)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.flush(IndexW=
riter.java:3450)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.prepareCommi=
t(IndexWriter.java:3363)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.lucene.index.IndexWriter.commit(Index=
Writer.java:3408)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.commitIndexWriter(AdvertisementManager.java:1728)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.addAdvertisementDocument(AdvertisementManager.jav=
a:536)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.business.advertisement.implementa=
tion.AdvertisementManager.appendFullAdvertisementToIndex(AdvertisementManag=
er.java:713)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.api.implementation.ApiFinalizeAdv=
ertisement.executeRequest(ApiFinalizeAdvertisement.java:224)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.controller.advertisement.CreateAd=
vertisement.doReq(CreateAdvertisement.java:294)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Security.doReqFinal(S=
ecurity.java:135)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.process(Action=
.java:302)
> =A0=A0=A0=A0=A0=A0=A0 at net.tmp.fwk.fw1.controller.Action.doPost(Action.=
java:87)
> =A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServl=
et.java:710)
> =A0=A0=A0=A0=A0=A0=A0 at javax.servlet.http.HttpServlet.service(HttpServl=
et.java:803)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
internalDoFilter(ApplicationFilterChain.java:269)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
doFilter(ApplicationFilterChain.java:188)
> =A0=A0=A0=A0=A0=A0=A0 at com.encheromax.servlet.filter.EncheromaxBeanFilt=
er.doFilter(EncheromaxBeanFilter.java:53)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
internalDoFilter(ApplicationFilterChain.java:215)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.ApplicationFilterChain.=
doFilter(ApplicationFilterChain.java:188)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardWrapperValve.in=
voke(StandardWrapperValve.java:213)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardContextValve.in=
voke(StandardContextValve.java:174)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardHostValve.invok=
e(StandardHostValve.java:127)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.valves.ErrorReportValve.invo=
ke(ErrorReportValve.java:117)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.core.StandardEngineValve.inv=
oke(StandardEngineValve.java:108)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.catalina.connector.CoyoteAdapter.serv=
ice(CoyoteAdapter.java:174)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.server.JkCoyoteHandler.invoke(JkCo=
yoteHandler.java:200)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.HandlerRequest.invoke(Handl=
erRequest.java:283)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.invoke(Channe=
lSocket.java:773)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket.processConnec=
tion(ChannelSocket.java:703)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.jk.common.ChannelSocket$SocketConnect=
ion.runIt(ChannelSocket.java:895)
> =A0=A0=A0=A0=A0=A0=A0 at org.apache.tomcat.util.threads.ThreadPool$Contro=
lRunnable.run(ThreadPool.java:689)
> =A0=A0=A0=A0=A0=A0=A0 at java.lang.Thread.run(Thread.java:619)
>
>
>
>
>
>
> --- En date de : Sam 9.1.10, Michael McCandless <lucene@mikemccandless.co=
m> a =E9crit :
>
> De: Michael McCandless <lucene@mikemccandless.com>
> Objet: Re: Concurrent access IndexReader / IndexWriter - =A0FileNotFoundE=
xception
> =C0: java-user@lucene.apache.org
> Date: Samedi 9 Janvier 2010, 14h51
>
> Can you post the full FNFE stack trace?
>
> Mike
>
> On Fri, Jan 8, 2010 at 5:35 AM, legrand thomas <thomaslegrand14@yahoo.fr>=
 wrote:
>> Hi,
>>
>> I often get a FileNotFoundException when my single IndexWriter commits w=
hile the IndexReader also tries to read. My application is multithreaded (T=
omcat uses the business APIs); I firstly thought the read/write access was =
thread-safe but I probably forget something.
>>
>> =A0Please help me to understand my mistakes:
>>
>> - When should I close the IndexWriter ? Each time I add/update a documen=
t or never ?
>> - Should my java commit/read methods be synchronized ?
>> - Should I lock the directory and what's the best way to do it ?
>>
>> I referred to the Lucene FAQ ("why do I sometimes get a FileNotFoundExce=
ption when I search and update my index at the same time?") but I did not d=
isable any locking for processes searching or updating the index.
>>
>> I use lucene-2.4.1.
>>
>> Thanks in advance,
>> Tom
>>
>>
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-1345017395-1263064025=:16760--

From java-user-return-44449-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 09 20:12:47 2010
Return-Path: <java-user-return-44449-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12381 invoked from network); 9 Jan 2010 20:12:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 9 Jan 2010 20:12:47 -0000
Received: (qmail 58139 invoked by uid 500); 9 Jan 2010 20:12:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58056 invoked by uid 500); 9 Jan 2010 20:12:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58046 invoked by uid 99); 9 Jan 2010 20:12:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 20:12:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 09 Jan 2010 20:12:36 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NThfT-0003Jo-4T
	for java-user@lucene.apache.org; Sat, 09 Jan 2010 12:12:15 -0800
Message-ID: <27092361.post@talk.nabble.com>
Date: Sat, 9 Jan 2010 12:12:15 -0800 (PST)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is there a way to limit the size of an index?
In-Reply-To: <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
References: <27056573.post@talk.nabble.com> <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com> <27058014.post@talk.nabble.com> <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com> <27062291.post@talk.nabble.com> <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Well, this rule seems not working...

I tried to create an index of 90k documents, with different merge factors.
Somehow, the files size in the final index were 1MB, or 8MB - nothing in the
middle. Am I missing something? Is the best way to really control the files
size is to implement a custom Directory?



Michael McCandless-2 wrote:
> 
> So the rough upper bound on any segment's size is mergeFactor *
> maxMergeMB.
> 

-- 
View this message in context: http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27092361.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44450-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 10 11:47:25 2010
Return-Path: <java-user-return-44450-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12915 invoked from network); 10 Jan 2010 11:47:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Jan 2010 11:47:25 -0000
Received: (qmail 90114 invoked by uid 500); 10 Jan 2010 11:47:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90054 invoked by uid 500); 10 Jan 2010 11:47:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90044 invoked by uid 99); 10 Jan 2010 11:47:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 11:47:22 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 11:47:14 +0000
Received: by ywh14 with SMTP id 14so19276695ywh.20
        for <java-user@lucene.apache.org>; Sun, 10 Jan 2010 03:46:53 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.234.2 with SMTP id g2mr3543581ybh.199.1263124013172; Sun, 
	10 Jan 2010 03:46:53 -0800 (PST)
In-Reply-To: <27092361.post@talk.nabble.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27062291.post@talk.nabble.com>
	 <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
	 <27092361.post@talk.nabble.com>
Date: Sun, 10 Jan 2010 06:46:53 -0500
Message-ID: <9ac0c6aa1001100346u36f1a69at48200b9fdd2da65d@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

What settings did you use (mergeFactor, maxMergeMB)?

"nothing in the middle" is normal.  Segments sizes are often rather
quantized, for a newly created index.  Ie a bunch of segs will be 1
MB, a bunch ~8, a bunch ~64 (assuming the IW flushes at ~ 1MB and
mergeFactor is 8).

Mike

On Sat, Jan 9, 2010 at 3:12 PM, Dvora <barak.yaish@gmail.com> wrote:
>
> Well, this rule seems not working...
>
> I tried to create an index of 90k documents, with different merge factors.
> Somehow, the files size in the final index were 1MB, or 8MB - nothing in the
> middle. Am I missing something? Is the best way to really control the files
> size is to implement a custom Directory?
>
>
>
> Michael McCandless-2 wrote:
>>
>> So the rough upper bound on any segment's size is mergeFactor *
>> maxMergeMB.
>>
>
> --
> View this message in context: http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27092361.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44451-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 10 12:04:12 2010
Return-Path: <java-user-return-44451-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17180 invoked from network); 10 Jan 2010 12:04:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Jan 2010 12:04:12 -0000
Received: (qmail 3778 invoked by uid 500); 10 Jan 2010 12:04:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3701 invoked by uid 500); 10 Jan 2010 12:04:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3691 invoked by uid 99); 10 Jan 2010 12:04:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 12:04:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 12:04:00 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NTwWC-0007mv-44
	for java-user@lucene.apache.org; Sun, 10 Jan 2010 04:03:40 -0800
Message-ID: <27097693.post@talk.nabble.com>
Date: Sun, 10 Jan 2010 04:03:40 -0800 (PST)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is there a way to limit the size of an index?
In-Reply-To: <9ac0c6aa1001100346u36f1a69at48200b9fdd2da65d@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
References: <27056573.post@talk.nabble.com> <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com> <27058014.post@talk.nabble.com> <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com> <27062291.post@talk.nabble.com> <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com> <27092361.post@talk.nabble.com> <9ac0c6aa1001100346u36f1a69at48200b9fdd2da65d@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Oh, as an excercise I tried to create 6MB files. Using the rule mentioned
before, I set the maxMergeMB to 0.6 (and then 0.62, 06.64... 1.8) and used
the default mergeFactor - I thought that should do for 6MB files... 


Michael McCandless-2 wrote:
> 
> What settings did you use (mergeFactor, maxMergeMB)?
> 
> "nothing in the middle" is normal.  Segments sizes are often rather
> quantized, for a newly created index.  Ie a bunch of segs will be 1
> MB, a bunch ~8, a bunch ~64 (assuming the IW flushes at ~ 1MB and
> mergeFactor is 8).
> 
> Mike
> 
> 

-- 
View this message in context: http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27097693.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44452-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 10 12:11:30 2010
Return-Path: <java-user-return-44452-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18071 invoked from network); 10 Jan 2010 12:11:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Jan 2010 12:11:30 -0000
Received: (qmail 6902 invoked by uid 500); 10 Jan 2010 12:11:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6810 invoked by uid 500); 10 Jan 2010 12:11:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6800 invoked by uid 99); 10 Jan 2010 12:11:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 12:11:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 12:11:19 +0000
Received: by yxe30 with SMTP id 30so23099170yxe.29
        for <java-user@lucene.apache.org>; Sun, 10 Jan 2010 04:10:58 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.39.34 with SMTP id m34mr4078755ybm.98.1263125458034; Sun, 
	10 Jan 2010 04:10:58 -0800 (PST)
In-Reply-To: <27097693.post@talk.nabble.com>
References: <27056573.post@talk.nabble.com>
	 <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com>
	 <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27062291.post@talk.nabble.com>
	 <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
	 <27092361.post@talk.nabble.com>
	 <9ac0c6aa1001100346u36f1a69at48200b9fdd2da65d@mail.gmail.com>
	 <27097693.post@talk.nabble.com>
Date: Sun, 10 Jan 2010 07:10:57 -0500
Message-ID: <9ac0c6aa1001100410v7f471708t515bc0fad0bec12b@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

What did you set your IndexWriter ramBufferSizeMB to?  That controls
how large the initial segments are.

Are you using compound file format?  (that's the default).

Mike

On Sun, Jan 10, 2010 at 7:03 AM, Dvora <barak.yaish@gmail.com> wrote:
>
> Oh, as an excercise I tried to create 6MB files. Using the rule mentioned
> before, I set the maxMergeMB to 0.6 (and then 0.62, 06.64... 1.8) and use=
d
> the default mergeFactor - I thought that should do for 6MB files...
>
>
> Michael McCandless-2 wrote:
>>
>> What settings did you use (mergeFactor, maxMergeMB)?
>>
>> "nothing in the middle" is normal. =A0Segments sizes are often rather
>> quantized, for a newly created index. =A0Ie a bunch of segs will be 1
>> MB, a bunch ~8, a bunch ~64 (assuming the IW flushes at ~ 1MB and
>> mergeFactor is 8).
>>
>> Mike
>>
>>
>
> --
> View this message in context: http://old.nabble.com/Is-there-a-way-to-lim=
it-the-size-of-an-index--tp27056573p27097693.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44453-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 10 12:34:24 2010
Return-Path: <java-user-return-44453-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21360 invoked from network); 10 Jan 2010 12:34:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Jan 2010 12:34:23 -0000
Received: (qmail 15246 invoked by uid 500); 10 Jan 2010 12:34:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15180 invoked by uid 500); 10 Jan 2010 12:34:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15169 invoked by uid 99); 10 Jan 2010 12:34:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 12:34:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 12:34:12 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NTwzP-0001I7-9W
	for java-user@lucene.apache.org; Sun, 10 Jan 2010 04:33:51 -0800
Message-ID: <27097887.post@talk.nabble.com>
Date: Sun, 10 Jan 2010 04:33:51 -0800 (PST)
From: Dvora <barak.yaish@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is there a way to limit the size of an index?
In-Reply-To: <9ac0c6aa1001100410v7f471708t515bc0fad0bec12b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: barak.yaish@gmail.com
References: <27056573.post@talk.nabble.com> <9ac0c6aa1001070234u7333bd2esa57951713d7841ec@mail.gmail.com> <27058014.post@talk.nabble.com> <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com> <27062291.post@talk.nabble.com> <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com> <27092361.post@talk.nabble.com> <9ac0c6aa1001100346u36f1a69at48200b9fdd2da65d@mail.gmail.com> <27097693.post@talk.nabble.com> <9ac0c6aa1001100410v7f471708t515bc0fad0bec12b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I'm storing and reading the documents using Compass, not Lucene directly. I
didn't touch those parameters, so I guess the default values are being used
(I do see cfs files in the index).

How the ramBufferSizeMB parameter affect the files size? What value should I
use in order to have 6MB files?


Michael McCandless-2 wrote:
> 
> What did you set your IndexWriter ramBufferSizeMB to?  That controls
> how large the initial segments are.
> 
> Are you using compound file format?  (that's the default).
> 
> 

-- 
View this message in context: http://old.nabble.com/Is-there-a-way-to-limit-the-size-of-an-index--tp27056573p27097887.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44454-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 10 20:25:05 2010
Return-Path: <java-user-return-44454-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82088 invoked from network); 10 Jan 2010 20:25:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 10 Jan 2010 20:25:05 -0000
Received: (qmail 14128 invoked by uid 500); 10 Jan 2010 20:25:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14039 invoked by uid 500); 10 Jan 2010 20:24:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14019 invoked by uid 99); 10 Jan 2010 20:24:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 20:24:59 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of richard.marr@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 10 Jan 2010 20:24:49 +0000
Received: by bwz22 with SMTP id 22so13289783bwz.5
        for <multiple recipients>; Sun, 10 Jan 2010 12:24:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=Oq7mdug4txE+VZ9OZZXwVLK0fcXbOUOkwOKzIWdTiHs=;
        b=ql7RkyNuv2GWxllLEmjXCljb0XL9gmqwBh05WkZWVgrYNzQudHCSUwuLaSsBYJd+HW
         FCt1eEQZmyEUuKIbgvehgDM3ed6hoRYC21CAwulkDcdu7LIFpTswl1yyPKFhXX842WTS
         aUgQBGvPCIswZ4MQdNCXzvJlm400HKfNrPP6s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=bujPOu5eGx+hYGb/OflUdSjcjIUO1CMeQ8LuW3uM39Pk5EteibJc0WFdglfSp0AhV6
         4l1WS/mDxaiwUD/0XXr7C/4mpqMlCUQja1TRt504WhRWq6r2nDGaJZiDnVcgo4nTHgIu
         dnO9m4lF0NJjB1xnEkCaY8Vt1Kl6dkAXH5ehk=
MIME-Version: 1.0
Received: by 10.204.18.212 with SMTP id x20mr1410524bka.9.1263155068143; Sun, 
	10 Jan 2010 12:24:28 -0800 (PST)
Date: Sun, 10 Jan 2010 20:24:28 +0000
Message-ID: <dba8f29c1001101224u58a37d69m10bb39ea2d98ec05@mail.gmail.com>
Subject: London Search Social - this Tuesday, 12th January
From: Richard Marr <richard.marr@gmail.com>
To: java-user@lucene.apache.org, solr-user@lucene.apache.org, 
	katta-developer@lists.sourceforge.net
Content-Type: text/plain; charset=ISO-8859-1

Hi all,

Apologies for the cross-post. If you're near London on Tuesday the
12th Jan (i.e. this Tuesday) please come along and geek with us over a
beer or two. All experience levels welcome, don't be scared. Details
on the Meetup page below... (please sign up on there if you're
interested in subsequent events).

http://www.meetup.com/london-search-social/

Cheers,

Richard Marr

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44455-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 00:40:02 2010
Return-Path: <java-user-return-44455-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54299 invoked from network); 11 Jan 2010 00:40:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 00:40:01 -0000
Received: (qmail 75924 invoked by uid 500); 11 Jan 2010 00:39:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75818 invoked by uid 500); 11 Jan 2010 00:39:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75808 invoked by uid 99); 11 Jan 2010 00:39:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 00:39:59 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.163.179.222] (HELO web36108.mail.mud.yahoo.com) (66.163.179.222)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 11 Jan 2010 00:39:50 +0000
Received: (qmail 40731 invoked by uid 60001); 11 Jan 2010 00:39:29 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263170369; bh=EXAr5XQMiaBwaoMAobw6xa/muBcmbWd+SDg+CI/Yavw=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=qV3nn337b7sduFMuw3dinJCWC2B4AZu1D3dYuz4Z7naIFuixGNXXXBiBwVmObdb3xAEwmwLetYAngGyIWlPYSDIhQ1UvenJorUsyBWjZZHhFIBNryfh/Yqy9tfUrYgndWg64F+5FzjxVZREFQfrBC4ZvSicdESzMG7p4s1/6ZJo=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=r7Bm1/kASxiK8yoTknUwDgR/rQBQDCktkbGBLlAI7bV7kvuhSOFddKI/Y+52RwnnJWBbkWxkZ6h9Wihq5FfEOIDBwga4dIhE/GbsCX+jxHBQPtn1uisQTwGbamqTxUsa1PQHALOhfWq8iSt1zXAKzr9qPP6f+hamOfvljsZ6HMg=;
Message-ID: <321842.39646.qm@web36108.mail.mud.yahoo.com>
X-YMail-OSG: 35bZcHsVM1k5HGhrlRXxGhjVVnIGT5_5HUqQ7zq9L_ixeZzJ7N7gLJLbXuiYN9OUdjqtXSMur3gHL7HBiPZew7EUe2nrB1WP_cl20.sFIw3EK2MierNacPKFh._4gKV2cqz40flnu1JD4YOBvvLDppJMEwq8kf6e_isI4FhPaYwMTmXag8IK_wwa7OPA74q66nt8xoDyNEQEBxOnW_urmGrEIOadZDWxzb9ztCWSTdstRqV_TmRBKF2n4SV9Ao6IKs2N15xL7UD_WHb8kOSy_.SjuBMYwvhGxOTS5kjIqcPLVzhhtOW96E10fcs8nq29zVq0APzQP9tQCxPpYluyMep.zo8ZQ.d4n3JJU.BaDlTMfEl_XEP.KZ0BKHg3UZYGSzOAhsuzUmna0oD0lA3kXG3zmV0syXvtsVr7TXblIwXHkyI1yNeKKqBahMOGHFWO16wquh6dKnBN.evO2tvzZZl.lJcdPXgeM6VTy_U7MoXsmtCuWbpDBfVe1UkeNjDYA0ip6kHd8n074ANxliCDKq0A7uZEvh7uV0nfY0H9g.5_zx2OaXQfe8vdTa.RAcujek1cZDoZCGqZGBE6CA_X4ykFecnim9d990FNO6vNnVygqlXkGZliUb1WVEJ1wXe5sPl2FYazR0sfHeVJNcWOztG9h0j1lfbWgYvNcAGqyMfXlpqo8fo4vncSastogPKOs19sDyEbh9edqYzTPR9GZ4NL.7UreZq57yJQF3L3VzyfI2BCXogE5hnHTv61Cj2luN2UKpDk5Q--
Received: from [203.126.190.28] by web36108.mail.mud.yahoo.com via HTTP; Sun, 10 Jan 2010 16:39:29 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Sun, 10 Jan 2010 16:39:29 -0800 (PST)
From: <jyzhou817@yahoo.com>
Subject: Re: a complete solution for building a website search with lucene
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
In-Reply-To: <f18c9dde1001090216p208ea8b6s2d67c1bef6ae8126@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-989141664-1263170369=:39646"

--0-989141664-1263170369=:39646
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Thanks.

--- On Sat, 9/1/10, Simon Willnauer <simon.willnauer@googlemail.com> wrote:

From: Simon Willnauer <simon.willnauer@googlemail.com>
Subject: Re: a complete solution for building a website search with lucene
To: java-user@lucene.apache.org
Date: Saturday, 9 January, 2010, 6:16 PM

I don't know that much about nutch but hadoop shouldn't really run
under windows in production. If you use windows for development this
should not be a big issue.
Oatis is right you should use cygwin together with hadoop. look at
http://wiki.apache.org/hadoop/FAQ for initial info.

simon

On Sat, Jan 9, 2010 at 5:20 AM, Otis Gospodnetic
<otis_gospodnetic@yahoo.com> wrote:
> Nutch is written in Java, so Nutch itself *should* work on other non-Linu=
x OSs that the JVM supports.
> But it does contain some shell scripts, as does Hadoop that Nutch uses. =
=A0Oh, I guess Windows people run it under Cygwin?
> =A0Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>
>
> ----- Original Message ----
>> From: "jyzhou817@yahoo.com" <jyzhou817@yahoo.com>
>> To: java-user@lucene.apache.org
>> Sent: Fri, January 8, 2010 5:03:41 AM
>> Subject: Re: a complete solution for building a website search with luce=
ne
>>
>> Hi Paul,
>>
>> Thanks.
>> Use Nutch to do crawling. and integrate Lucene to the web application, s=
o that
>> can do search online.
>>
>> BTW, Nutch seems to have only Linux version, what my development is on W=
indows.
>> Am i right?
>>
>> Zhou
>>
>> --- On Fri, 8/1/10, Paul Libbrecht wrote:
>>
>> From: Paul Libbrecht
>> Subject: Re: a complete solution for building a website search with luce=
ne
>> To: java-user@lucene.apache.org
>> Date: Friday, 8 January, 2010, 4:27 PM
>>
>> Zhou,
>>
>> Lucene is a back-end library, it's very useful for developer but it is n=
ot a
>> complete site-search-engine.
>> A lucene-based site-search-engine is Nutch, it does crawl.
>> Solr also provides functions close to these with a large amount of thoug=
hts on
>> flexible integration; crawling methods are rather based on feeds or othe=
r
>> acquisition methods (see DIH for example).
>>
>> paul
>>
>>
>>
>>
>> Le 08-janv.-10 =E0 08:08, a =E9crit :
>>
>> > Hi ,
>> >
>> > I am new in Lucene.
>> >
>> > To build a web search function, it need to have a backendc indexing fu=
nction.
>> But, before that, should run a Crawler? because Lucene index based on Ht=
ml
>> documents, while Crawler can change the website pages to Html documents.=
 Am i
>> right?
>> >
>> > If so, please anyone suggest to me a Crawler? like Nutch?
>> > Thanks
>> > Zhou
>> >
>> >
>> >
>> >
>> > =A0 =A0 =A0New Email names for you!
>> > Get the Email name you've always wanted on the new @ymail and @rocketm=
ail.
>> > Hurry before someone else does!
>> > http://mail.promotions.yahoo.com/newdomains/sg/
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>>
>> =A0 =A0 =A0 New Email names for you!
>> Get the Email name you've always wanted on the new @ymail and @rocketmai=
l.
>> Hurry before someone else does!
>> http://mail.promotions.yahoo.com/newdomains/sg/
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-989141664-1263170369=:39646--

From java-user-return-44456-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 01:48:30 2010
Return-Path: <java-user-return-44456-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74326 invoked from network); 11 Jan 2010 01:48:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 01:48:30 -0000
Received: (qmail 15710 invoked by uid 500); 11 Jan 2010 01:48:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15605 invoked by uid 500); 11 Jan 2010 01:48:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15595 invoked by uid 99); 11 Jan 2010 01:48:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 01:48:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.163.179.221] (HELO web36107.mail.mud.yahoo.com) (66.163.179.221)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 11 Jan 2010 01:48:17 +0000
Received: (qmail 17667 invoked by uid 60001); 11 Jan 2010 01:47:55 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263174475; bh=Z/kqClpvzbi/7F0wz7YxqWrB8EDVpdjv40wkT/SCrhk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=uH45hu5kYKZnGksPAwmpKDiueIYym4AZxeMo3jSXBgHJUXmar0x/+HqO6Rq0Gri35y0kdztqJisJUVY2BDkWgiCn+VE05MSx2yf+MTBei+MGJMSToPZgfnE27N7VMYhhumlimzy0b2na7IzlGNbk2wq6fB4rsGMcX55SSYaDiW4=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=SXQZLi+5K8WRFzcigre9bZtlNIz1ksa1uBOjSx8LPmDTZy9+//nehJOCjTrj3gfhtD8FmNG5TGvXAJSCsfj4YFg73B2qIc+JqvAsb7l3QiOf8Gza3a1zw/u/7TGKOAJ1+EMwzVniABkXemKXheptIYTK5fwH0WVKjp+iKSZpzNE=;
Message-ID: <109100.17546.qm@web36107.mail.mud.yahoo.com>
X-YMail-OSG: Kh_1RIMVM1lcNKlJp6P5E9DJ2Po9AtUx.EEqHNBpLuKnk4J0yt9zgt_e8oGj9r9YcD74nxnorkOFe.x75arM5RY6ofW2EjZxmNX_sMvYYlnezFlJgCFPLl9zwOQRjpCn7Wn192TPo02FEsY8VKxoYelQrfmOi3AeNL4X3Yen8yg3pvXagCTQVRgPqwMWgoj31N1IipCul2sJpgtWhTyS808rd4hVHQTfY1Bbo04kFsuy.ot.GE5uK.Vf_AYdnfeuz7iwESnbuLuRZttUxK_kkt4cZ9U7_KOZZ_VGjDNYriOP6yCMb1.n2PDmjPDyy8H8H9y4z4adiiG0LDvsd3LQrkYILltjj7XeNEznBweSY7c7NiA6dUcOSJpEm68DJzaPi8zTe5r3Ip9KSqSmbZe4jkCfH9iCFTIcIp_ub4aN.SxJVCm3vOct2n_21i00DzXvYlIn2kd_aSlekuTLyLsVTFwNT8stSFzJ6KoJHJTeT1TOErAfzf5VXkC44wX0wR4af1cegaHp2.hItDOQySjO1udtogEAJIt0OrisX5sG415UBl.gUJBTBBlwEmxRJw7oHwP7MeulN_sA9bfumaCQKOEZWRJjrLdp.eEx4GF6eUtaoXzKKqBmOc7vVseagpqTR4DVRcibc6crZxDjlx.2nIR3AvoV5xt.kOixkwe10ZUzYTp6tvht.y1XNJPgXboUyBj38v06_2aA75gGzlQz9KFpvM4qai4GemIxMG580VVeID0-
Received: from [203.126.190.28] by web36107.mail.mud.yahoo.com via HTTP; Sun, 10 Jan 2010 17:47:55 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Sun, 10 Jan 2010 17:47:55 -0800 (PST)
From: <jyzhou817@yahoo.com>
Subject: Re: a complete solution for building a website search with lucene
To: java-user@lucene.apache.org, simon.willnauer@gmail.com
In-Reply-To: <f18c9dde1001090216p208ea8b6s2d67c1bef6ae8126@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1462442794-1263174475=:17546"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1462442794-1263174475=:17546
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

Have you implemented such web search in your web application development?=
=A0 As detailed as possible. example:=20
1) index: ?
2) search: Lucene

Please do advise.=20

Thanks.


--- On Sat, 9/1/10, Simon Willnauer <simon.willnauer@googlemail.com> wrote:

From: Simon Willnauer <simon.willnauer@googlemail.com>
Subject: Re: a complete solution for building a website search with lucene
To: java-user@lucene.apache.org
Date: Saturday, 9 January, 2010, 6:16 PM

I don't know that much about nutch but hadoop shouldn't really run
under windows in production. If you use windows for development this
should not be a big issue.
Oatis is right you should use cygwin together with hadoop. look at
http://wiki.apache.org/hadoop/FAQ for initial info.

simon

On Sat, Jan 9, 2010 at 5:20 AM, Otis Gospodnetic
<otis_gospodnetic@yahoo.com> wrote:
> Nutch is written in Java, so Nutch itself *should* work on other non-Linu=
x OSs that the JVM supports.
> But it does contain some shell scripts, as does Hadoop that Nutch uses. =
=A0Oh, I guess Windows people run it under Cygwin?
> =A0Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>
>
> ----- Original Message ----
>> From: "jyzhou817@yahoo.com" <jyzhou817@yahoo.com>
>> To: java-user@lucene.apache.org
>> Sent: Fri, January 8, 2010 5:03:41 AM
>> Subject: Re: a complete solution for building a website search with luce=
ne
>>
>> Hi Paul,
>>
>> Thanks.
>> Use Nutch to do crawling. and integrate Lucene to the web application, s=
o that
>> can do search online.
>>
>> BTW, Nutch seems to have only Linux version, what my development is on W=
indows.
>> Am i right?
>>
>> Zhou
>>
>> --- On Fri, 8/1/10, Paul Libbrecht wrote:
>>
>> From: Paul Libbrecht
>> Subject: Re: a complete solution for building a website search with luce=
ne
>> To: java-user@lucene.apache.org
>> Date: Friday, 8 January, 2010, 4:27 PM
>>
>> Zhou,
>>
>> Lucene is a back-end library, it's very useful for developer but it is n=
ot a
>> complete site-search-engine.
>> A lucene-based site-search-engine is Nutch, it does crawl.
>> Solr also provides functions close to these with a large amount of thoug=
hts on
>> flexible integration; crawling methods are rather based on feeds or othe=
r
>> acquisition methods (see DIH for example).
>>
>> paul
>>
>>
>>
>>
>> Le 08-janv.-10 =E0 08:08, a =E9crit :
>>
>> > Hi ,
>> >
>> > I am new in Lucene.
>> >
>> > To build a web search function, it need to have a backendc indexing fu=
nction.
>> But, before that, should run a Crawler? because Lucene index based on Ht=
ml
>> documents, while Crawler can change the website pages to Html documents.=
 Am i
>> right?
>> >
>> > If so, please anyone suggest to me a Crawler? like Nutch?
>> > Thanks
>> > Zhou
>> >
>> >
>> >
>> >
>> > =A0 =A0 =A0New Email names for you!
>> > Get the Email name you've always wanted on the new @ymail and @rocketm=
ail.
>> > Hurry before someone else does!
>> > http://mail.promotions.yahoo.com/newdomains/sg/
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>>
>> =A0 =A0 =A0 New Email names for you!
>> Get the Email name you've always wanted on the new @ymail and @rocketmai=
l.
>> Hurry before someone else does!
>> http://mail.promotions.yahoo.com/newdomains/sg/
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      New Email names for you! =0AGet the Email name you&#39;ve al=
ways wanted on the new @ymail and @rocketmail. =0AHurry before someone else=
 does!=0Ahttp://mail.promotions.yahoo.com/newdomains/sg/
--0-1462442794-1263174475=:17546--

From java-user-return-44457-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 06:12:59 2010
Return-Path: <java-user-return-44457-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54189 invoked from network); 11 Jan 2010 06:12:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 06:12:59 -0000
Received: (qmail 23223 invoked by uid 500); 11 Jan 2010 06:12:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23061 invoked by uid 500); 11 Jan 2010 06:12:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23048 invoked by uid 99); 11 Jan 2010 06:12:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 06:12:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 06:12:47 +0000
Received: by fg-out-1718.google.com with SMTP id 19so3919076fgg.5
        for <java-user@lucene.apache.org>; Sun, 10 Jan 2010 22:12:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type;
        bh=J916Ad5GHgOBRtkVOloN5aKnEID1B1IthGL6n6GlOwA=;
        b=fPmMlzKJFngRr5uySRG4ZTw2UMAIdiCjimCaySmPRW+FsX9fOoexYAUIgYuVEmDuCD
         eZDl/CM2noZyd96VYnsy1RvwBYyEYYsvrbFyZndmTYwDwNijYXIXr4d9JEINI43BjLrI
         gL3+QCDfkvwsUFOph5X1pP4ylIJz99yd5/rbQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type;
        b=jJ/6z17f3YQzWJc9eFdhCTAE6FSzvFrLaj2CYWpWXuP+wiOy8K82NRR3h2ZU8qApqW
         3kPMBk6cOD9KsOu0tIJKZPQd+RAk0FT0Cj2uR+8Zlh5LPIzSLQ34c4faXF/rsTdltG/N
         d6K5l4dvYL+aU2io6tiEjGwo+sIZ63SOgCD5E=
MIME-Version: 1.0
Received: by 10.239.144.100 with SMTP id n36mr613338hba.19.1263190345029; Sun, 
	10 Jan 2010 22:12:25 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <109100.17546.qm@web36107.mail.mud.yahoo.com>
References: <f18c9dde1001090216p208ea8b6s2d67c1bef6ae8126@mail.gmail.com>
	 <109100.17546.qm@web36107.mail.mud.yahoo.com>
Date: Mon, 11 Jan 2010 07:12:24 +0100
Message-ID: <f18c9dde1001102212t31957a60n78d6344a065f8c03@mail.gmail.com>
Subject: Re: a complete solution for building a website search with lucene
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f7249ccc99b9047cdd6b4d

--001485f7249ccc99b9047cdd6b4d
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

You should really look at Nutch.
from the website http://lucene.apache.org/nutch: Nutch is open source
web-search software. It builds on Lucene Java<http://lucene.apache.org/java=
/>,
adding web-specifics, such as a crawler, a link-graph database, parsers for
HTML and other document formats, etc.

sounds like a good place to start, doesn't it :)

simon

On Mon, Jan 11, 2010 at 2:47 AM, <jyzhou817@yahoo.com> wrote:

> Hi,
>
> Have you implemented such web search in your web application development?
> As detailed as possible. example:
> 1) index: ?
> 2) search: Lucene
>
> Please do advise.
>
> Thanks.
>
>
> --- On *Sat, 9/1/10, Simon Willnauer <simon.willnauer@googlemail.com>*wro=
te:
>
>
> From: Simon Willnauer <simon.willnauer@googlemail.com>
> Subject: Re: a complete solution for building a website search with lucen=
e
> To: java-user@lucene.apache.org
> Date: Saturday, 9 January, 2010, 6:16 PM
>
> I don't know that much about nutch but hadoop shouldn't really run
> under windows in production. If you use windows for development this
> should not be a big issue.
> Oatis is right you should use cygwin together with hadoop. look at
> http://wiki.apache.org/hadoop/FAQ for initial info.
>
> simon
>
> On Sat, Jan 9, 2010 at 5:20 AM, Otis Gospodnetic
> <otis_gospodnetic@yahoo.com<http://mc/compose?to=3Dotis_gospodnetic@yahoo=
.com>>
> wrote:
> > Nutch is written in Java, so Nutch itself *should* work on other
> non-Linux OSs that the JVM supports.
> > But it does contain some shell scripts, as does Hadoop that Nutch uses.
>  Oh, I guess Windows people run it under Cygwin?
> >  Otis
> > --
> > Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> >
> >
> >
> > ----- Original Message ----
> >> From: "jyzhou817@yahoo.com <http://mc/compose?to=3Djyzhou817@yahoo.com=
>"
> <jyzhou817@yahoo.com <http://mc/compose?to=3Djyzhou817@yahoo.com>>
> >> To: java-user@lucene.apache.org<http://mc/compose?to=3Djava-user@lucen=
e.apache.org>
> >> Sent: Fri, January 8, 2010 5:03:41 AM
> >> Subject: Re: a complete solution for building a website search with
> lucene
> >>
> >> Hi Paul,
> >>
> >> Thanks.
> >> Use Nutch to do crawling. and integrate Lucene to the web application,
> so that
> >> can do search online.
> >>
> >> BTW, Nutch seems to have only Linux version, what my development is on
> Windows.
> >> Am i right?
> >>
> >> Zhou
> >>
> >> --- On Fri, 8/1/10, Paul Libbrecht wrote:
> >>
> >> From: Paul Libbrecht
> >> Subject: Re: a complete solution for building a website search with
> lucene
> >> To: java-user@lucene.apache.org<http://mc/compose?to=3Djava-user@lucen=
e.apache.org>
> >> Date: Friday, 8 January, 2010, 4:27 PM
> >>
> >> Zhou,
> >>
> >> Lucene is a back-end library, it's very useful for developer but it is
> not a
> >> complete site-search-engine.
> >> A lucene-based site-search-engine is Nutch, it does crawl.
> >> Solr also provides functions close to these with a large amount of
> thoughts on
> >> flexible integration; crawling methods are rather based on feeds or
> other
> >> acquisition methods (see DIH for example).
> >>
> >> paul
> >>
> >>
> >>
> >>
> >> Le 08-janv.-10 =C3=A0 08:08, a =C3=A9crit :
> >>
> >> > Hi ,
> >> >
> >> > I am new in Lucene.
> >> >
> >> > To build a web search function, it need to have a backendc indexing
> function.
> >> But, before that, should run a Crawler? because Lucene index based on
> Html
> >> documents, while Crawler can change the website pages to Html document=
s.
> Am i
> >> right?
> >> >
> >> > If so, please anyone suggest to me a Crawler? like Nutch?
> >> > Thanks
> >> > Zhou
> >> >
> >> >
> >> >
> >> >
> >> >      New Email names for you!
> >> > Get the Email name you've always wanted on the new @ymail and
> @rocketmail.
> >> > Hurry before someone else does!
> >> > http://mail.promotions.yahoo.com/newdomains/sg/
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org<http:/=
/mc/compose?to=3Djava-user-unsubscribe@lucene.apache.org>
> >> For additional commands, e-mail: java-user-help@lucene.apache.org<http=
://mc/compose?to=3Djava-user-help@lucene.apache.org>
> >>
> >>
> >>
> >>
> >>       New Email names for you!
> >> Get the Email name you've always wanted on the new @ymail and
> @rocketmail.
> >> Hurry before someone else does!
> >> http://mail.promotions.yahoo.com/newdomains/sg/
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org<http://=
mc/compose?to=3Djava-user-unsubscribe@lucene.apache.org>
> > For additional commands, e-mail: java-user-help@lucene.apache.org<http:=
//mc/compose?to=3Djava-user-help@lucene.apache.org>
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org<http://mc=
/compose?to=3Djava-user-unsubscribe@lucene.apache.org>
> For additional commands, e-mail: java-user-help@lucene.apache.org<http://=
mc/compose?to=3Djava-user-help@lucene.apache.org>
>
>
> ------------------------------
>  New Email names for you!
> <http://sg.rd.yahoo.com/sg/mail/domainchoice/mail/signature/*http://mail.=
promotions.yahoo.com/newdomains/sg/>
> Get the Email name you've always wanted on the new @ymail and @rocketmail=
.
> Hurry before someone else does!
>

--001485f7249ccc99b9047cdd6b4d--

From java-user-return-44458-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 06:50:53 2010
Return-Path: <java-user-return-44458-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72012 invoked from network); 11 Jan 2010 06:50:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 06:50:53 -0000
Received: (qmail 43526 invoked by uid 500); 11 Jan 2010 06:50:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43438 invoked by uid 500); 11 Jan 2010 06:50:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43428 invoked by uid 99); 11 Jan 2010 06:50:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 06:50:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 06:50:41 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUE6W-00026G-Em
	for java-user@lucene.apache.org; Sun, 10 Jan 2010 22:50:20 -0800
Message-ID: <27106452.post@talk.nabble.com>
Date: Sun, 10 Jan 2010 22:50:20 -0800 (PST)
From: Mohsen Saboorian <mohsens@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Highlighter doesn't highlight wildcard queries after updating
 to 2.9.1/3.0.0
In-Reply-To: <26969989.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: mohsens@gmail.com
References: <26969517.post@talk.nabble.com> <4B3B84C0.3040001@gmail.com> <26969989.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


The problem comes from this method:
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extract(Query,
Map<String, WeightedSpanTerm>)

The query passed to this method is of type
org.apache.lucene.search.ConstantScoreQuery, but it matches non of
'instanceof' checkings in this method, so no WeightedSpanTerm is extracted.

It this a bug?

Thanks,
Mohsen



Mohsen Saboorian wrote:
> 
> Yes I can (though I need some time, since I have my nested custom
> analyzers and filter). I'll try to write a test scenario to reproduce this
> issue.
> 
> For now, can you tell me if these steps are correct for instantiating and
> using highlighter:
> 
> IndexSearcher is = new IndexSearcher(indexReader);
> QueryParser parser = new QueryParser(Version.LUCENE_CURRENT, "myfield",
> analyzer);
> 
> // allow search terms like "*foo" with leading star
> parser.setAllowLeadingWildcard(true);
> query = parser.parse(q);
> BooleanQuery.setMaxClauseCount(maxClauseCount);
> query = query.rewrite(indexReader);
> is.setDefaultFieldSortScoring(true, true);
> 
> // 
> // search code
> // 
> 
> 
> // highlightFormatter is a custom impl, which adds a  around matched term
> Highlighter highlighter = new Highlighter(highlightFormatter, new
> QueryScorer(query));
> 
> TokenStream tokenStream = analyzer.tokenStream("myfield", new
> StringReader("text to search in"));
> String resultStr = highlighter.getBestFragments(tokenStream, "text to
> search in", 100, "...");
> 
> 
> Mohsen
> 
> 
> markrmiller wrote:
>> 
>> Mohsen Saboorian wrote:
>>> After updating to 2.9.x or 3.0, highlighter doesn't work on wildcard
>>> queries
>>> like "abc*". I thought that it would be because of scoring, so I also
>>> set
>>> myIndexSearcher.setDefaultFieldSortScoring(true, true) before searching.
>>> I tested with both QueryScorer and QueryTermScorer.
>>>
>>> In my custom highlightTerm(String originalText, TokenGroup tokenGroup)
>>> method, tokenGroup.getTotalScore() is always <= 0 for these queries.
>>>
>>> Mohsen
>>>   
>> Can you boil the issue down to a unit test?
>> 
>> -- 
>> - Mark
>> 
>> http://www.lucidimagination.com
>> 
>> 
>> 
>> 
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>> 
>> 
>> 
> 
> 

-- 
View this message in context: http://old.nabble.com/Highlighter-doesn%27t-highlight-wildcard-queries-after-updating-to-2.9.1-3.0.0-tp26969517p27106452.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44459-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 07:00:48 2010
Return-Path: <java-user-return-44459-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75415 invoked from network); 11 Jan 2010 07:00:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 07:00:47 -0000
Received: (qmail 51956 invoked by uid 500); 11 Jan 2010 07:00:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51878 invoked by uid 500); 11 Jan 2010 07:00:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51868 invoked by uid 99); 11 Jan 2010 07:00:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 07:00:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of leon800219@gmail.com designates 209.85.222.173 as permitted sender)
Received: from [209.85.222.173] (HELO mail-pz0-f173.google.com) (209.85.222.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 07:00:38 +0000
Received: by pzk3 with SMTP id 3so218042pzk.20
        for <java-user@lucene.apache.org>; Sun, 10 Jan 2010 23:00:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=I1L9fyau8SQtZm4Fk+gq2kQX+2rDSkrHc7vWNxlPOgw=;
        b=S6wMl2fTOY/v6NlNkrNJZ3AOdIcFC1m0vShby0z2+pLc1+w/jGy0Z7EM29GSSWax5q
         dv3nzM/M0knyve4BZZGH0Cu8cZm3Ztjx1VjFShouA2qKI0jQIAIG5czXZvXXKh1fvT60
         kjPy+pupqQNUC/uArZNJeysrF2543RYeegX5g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=InT1HXVT4GztK/mNyyGtUSRVzjYEZ7eCU0LXNiPbrZ2c8y6dT9yO09EV8cyafdEUW1
         WTKrM1lHDRXltBeladNy+/rV/wSTw1ZfwYz/qJOpZYGFdhk/oWvx/Cfm0S/Slmc9mmrW
         r6rvHFANC99+Q1EC78LnRwelNgYK7wlL/1ZV4=
MIME-Version: 1.0
Received: by 10.115.113.6 with SMTP id q6mr9096699wam.55.1263193217776; Sun, 
	10 Jan 2010 23:00:17 -0800 (PST)
Date: Mon, 11 Jan 2010 15:00:17 +0800
Message-ID: <3a1a1b2b1001102300g13d443aw4f1835a483ee3462@mail.gmail.com>
Subject: Highlight the whole sentence instead of the partial matching terms
From: Li Leon <leon800219@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64af4a8073e73047cde1779

--0016e64af4a8073e73047cde1779
Content-Type: text/plain; charset=ISO-8859-1

*Hi all,*
**
*I wanted to use to following code to highlight the whole sentence with
"\"something\"~n" to be parsed.*
**
*The QueryParser part worked well, but when integrated with Highlighter, it
ended up with exception. *
**
*Does anyone have any clue as I'm investigating this.*
**
**
*Thanks,*
**



Exception in thread "main" java.lang.NoClassDefFoundError:
org/apache/lucene/index/memory/MemoryIndex

      at
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getReaderForField(
*WeightedSpanTermExtractor.java:361*)

      at
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extractWeightedSpanTerms(
*WeightedSpanTermExtractor.java:282*)

      at
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extract(*
WeightedSpanTermExtractor.java:149*)

      at
org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getWeightedSpanTerms(
*WeightedSpanTermExtractor.java:414*)

      at org.apache.lucene.search.highlight.QueryScorer.initExtractor(*
QueryScorer.java:216*)

      at org.apache.lucene.search.highlight.QueryScorer.init(*
QueryScorer.java:184*)

      at
org.apache.lucene.search.highlight.Highlighter.getBestTextFragments(*
Highlighter.java:226*)

     at org.apache.lucene.search.highlight.Highlighter.getBestFragments(*
Highlighter.java:184*)

     at org.apache.lucene.search.highlight.Highlighter.getBestFragments(*
Highlighter.java:488*)

      at Hightlight.main(*Hightlight.java:182*)


**
*public* *class* Hightlight {

  *private* *static* *final* String *text* =

    "Giving end users some context around hits from their searches is
friendly and, more important, useful. An useful example is friendly Google
search context.";



  *private* *static* *final* String[] *stopwords* = {};

  *private* *static* IndexSearcher *searcher*;

  *public* *static* *void* main(String[] args) *throws* Exception {



    String filename = args[0];



    String searchText = "\"Giving and\"~11";
#1

    QueryParser parser = *new* QueryParser("f", *new*

            StandardAnalyzer(*stopwords*));

    Query query = parser.parse(searchText);



    SimpleHTMLFormatter formatter =

      *new* SimpleHTMLFormatter("<span class=\"highlight\">",

                              "</span>");



    TokenStream tokens = *new* StandardAnalyzer(*stopwords*)

        .tokenStream("f", *new* StringReader(*text*));



    QueryScorer scorer = *new* QueryScorer(query, "f");



    Highlighter highlighter = *new* Highlighter(formatter, scorer);

    highlighter.setTextFragmenter(

                  *new* NullFragmenter());



    String result =

        highlighter.getBestFragments(tokens, *text*, 3, "...");



    FileWriter writer = *new* FileWriter(filename);

    writer.write("<html>");

    writer.write("<style>\n" +

        ".highlight {\n" +

        " background: yellow;\n" +

        "}\n" +

        "</style>");

    writer.write("<body>");

    writer.write(result);

    writer.write("</body></html>");

    writer.close();

  }

}

--0016e64af4a8073e73047cde1779--

From java-user-return-44460-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 07:34:55 2010
Return-Path: <java-user-return-44460-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80761 invoked from network); 11 Jan 2010 07:34:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 07:34:55 -0000
Received: (qmail 68899 invoked by uid 500); 11 Jan 2010 07:34:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68831 invoked by uid 500); 11 Jan 2010 07:34:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68815 invoked by uid 99); 11 Jan 2010 07:34:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 07:34:52 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of leon800219@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 07:34:43 +0000
Received: by pwi11 with SMTP id 11so1315485pwi.5
        for <java-user@lucene.apache.org>; Sun, 10 Jan 2010 23:34:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=m5RQ+uKt/vjRVxfYQl76GHFLbdZzM4ZALF4Dei6cl4I=;
        b=B8ys1dktpG/vA6iruS+AInVtfg3uweocwvjA+ocYZWhiKOHATsQH6knheF74hO+2Gm
         KgWunLFZ1sOukNmTbObs883dcR8Kwt26d6zn6fxXISvTlzf4i6qKR8UldQu2fJQ+pN0b
         DTPWH+n8yYLmxgEpLKk2QcLrv2IJoY9Olynz8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=tvhzeiUXw5r6o9N3/0q5x+nlNiDpyII4KZ7jvBRGrdnWLU5z599oPvAw4KB7WwyRWN
         qXWlTfGBE6MUhJLbig7lZ88wUzfZvl0VAGCuY96TdBf4L4qmFXEn7DgCnwBjsbT2qdR1
         tab8lS2pbF2SW9vMVe2r7BIn/hlF9c41nYdGs=
MIME-Version: 1.0
Received: by 10.114.23.5 with SMTP id 5mr4323291waw.41.1263195262140; Sun, 10 
	Jan 2010 23:34:22 -0800 (PST)
In-Reply-To: <3a1a1b2b1001102300g13d443aw4f1835a483ee3462@mail.gmail.com>
References: <3a1a1b2b1001102300g13d443aw4f1835a483ee3462@mail.gmail.com>
Date: Mon, 11 Jan 2010 15:34:22 +0800
Message-ID: <3a1a1b2b1001102334y12338141h1ceb4862745021fe@mail.gmail.com>
Subject: Re: Highlight the whole sentence instead of the partial matching 
	terms
From: Li Leon <leon800219@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00504502e8bee1c086047cde90b8
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502e8bee1c086047cde90b8
Content-Type: text/plain; charset=ISO-8859-1

Just figured out, missed "lucene-memory-2.4.1.jar" external jar inclusion.

With that jar included, "\"Giving and\"~11" only got "Giving" & "and"
highlighted but not the whole sentence, any ideas?

Thanks,

2010/1/11 Li Leon <leon800219@gmail.com>

> *Hi all,*
> **
> *I wanted to use to following code to highlight the whole sentence with
> "\"something\"~n" to be parsed.*
> **
> *The QueryParser part worked well, but when integrated with Highlighter,
> it ended up with exception. *
> **
> *Does anyone have any clue as I'm investigating this.*
> **
> **
> *Thanks,*
> **
>
>
>
> Exception in thread "main" java.lang.NoClassDefFoundError:
> org/apache/lucene/index/memory/MemoryIndex
>
>       at
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getReaderForField(
> *WeightedSpanTermExtractor.java:361*)
>
>       at
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extractWeightedSpanTerms(
> *WeightedSpanTermExtractor.java:282*)
>
>       at
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extract(*
> WeightedSpanTermExtractor.java:149*)
>
>       at
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getWeightedSpanTerms(
> *WeightedSpanTermExtractor.java:414*)
>
>       at org.apache.lucene.search.highlight.QueryScorer.initExtractor(*
> QueryScorer.java:216*)
>
>       at org.apache.lucene.search.highlight.QueryScorer.init(*
> QueryScorer.java:184*)
>
>       at
> org.apache.lucene.search.highlight.Highlighter.getBestTextFragments(*
> Highlighter.java:226*)
>
>      at org.apache.lucene.search.highlight.Highlighter.getBestFragments(*
> Highlighter.java:184*)
>
>      at org.apache.lucene.search.highlight.Highlighter.getBestFragments(*
> Highlighter.java:488*)
>
>       at Hightlight.main(*Hightlight.java:182*)
>
>
> **
> *public* *class* Hightlight {
>
>   *private* *static* *final* String *text* =
>
>     "Giving end users some context around hits from their searches is
> friendly and, more important, useful. An useful example is friendly Google
> search context.";
>
>
>
>   *private* *static* *final* String[] *stopwords* = {};
>
>   *private* *static* IndexSearcher *searcher*;
>
>   *public* *static* *void* main(String[] args) *throws* Exception {
>
>
>
>     String filename = args[0];
>
>
>
>     String searchText = "\"Giving and\"~11";
>  #1
>
>     QueryParser parser = *new* QueryParser("f", *new*
>
>             StandardAnalyzer(*stopwords*));
>
>     Query query = parser.parse(searchText);
>
>
>
>     SimpleHTMLFormatter formatter =
>
>       *new* SimpleHTMLFormatter("<span class=\"highlight\">",
>
>                               "</span>");
>
>
>
>     TokenStream tokens = *new* StandardAnalyzer(*stopwords*)
>
>         .tokenStream("f", *new* StringReader(*text*));
>
>
>
>     QueryScorer scorer = *new* QueryScorer(query, "f");
>
>
>
>     Highlighter highlighter = *new* Highlighter(formatter, scorer);
>
>     highlighter.setTextFragmenter(
>
>                   *new* NullFragmenter());
>
>
>
>     String result =
>
>         highlighter.getBestFragments(tokens, *text*, 3, "...");
>
>
>
>     FileWriter writer = *new* FileWriter(filename);
>
>     writer.write("<html>");
>
>     writer.write("<style>\n" +
>
>         ".highlight {\n" +
>
>         " background: yellow;\n" +
>
>         "}\n" +
>
>         "</style>");
>
>     writer.write("<body>");
>
>     writer.write(result);
>
>     writer.write("</body></html>");
>
>     writer.close();
>
>   }
>
> }
>
>
>

--00504502e8bee1c086047cde90b8--

From java-user-return-44461-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 07:38:12 2010
Return-Path: <java-user-return-44461-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81170 invoked from network); 11 Jan 2010 07:38:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 07:38:11 -0000
Received: (qmail 71765 invoked by uid 500); 11 Jan 2010 07:38:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71683 invoked by uid 500); 11 Jan 2010 07:38:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71673 invoked by uid 99); 11 Jan 2010 07:38:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 07:38:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 07:38:00 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUEqJ-0005L2-MP
	for java-user@lucene.apache.org; Sun, 10 Jan 2010 23:37:39 -0800
Message-ID: <27106737.post@talk.nabble.com>
Date: Sun, 10 Jan 2010 23:37:39 -0800 (PST)
From: Mohsen Saboorian <mohsens@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Highlighter doesn't highlight wildcard queries after updating
 to 2.9.1/3.0.0
In-Reply-To: <27106452.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: mohsens@gmail.com
References: <26969517.post@talk.nabble.com> <4B3B84C0.3040001@gmail.com> <26969989.post@talk.nabble.com> <27106452.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


OK, to answer my own question:
I found from the following issue that if I do a query.rewrite(), highlighter
doesn't work.
https://issues.apache.org/jira/browse/LUCENE-1425

I did rewrite() in order to find all matched terms for example in a prefix
query, but as this doesn't work anymore like Lucene 2.3, and returns
nothings renderable, I stopped rewriting and to my surprise, highlighter
worked with prefix, or other queries.

It was also needed to add lucene-memory contrib library (which is referenced
by WeightedSpanTermExtractor) to prevent exception (NCDFE).


Mohsen


Mohsen Saboorian wrote:
> 
> The problem comes from this method:
> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extract(Query,
> Map<String, WeightedSpanTerm>)
> 
> The query passed to this method is of type
> org.apache.lucene.search.ConstantScoreQuery, but it matches non of
> 'instanceof' checkings in this method, so no WeightedSpanTerm is
> extracted.
> 
> It this a bug?
> 
> Thanks,
> Mohsen
> 

-- 
View this message in context: http://old.nabble.com/Highlighter-doesn%27t-highlight-wildcard-queries-after-updating-to-2.9.1-3.0.0-tp26969517p27106737.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44462-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 10:46:26 2010
Return-Path: <java-user-return-44462-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45815 invoked from network); 11 Jan 2010 10:46:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 10:46:26 -0000
Received: (qmail 55448 invoked by uid 500); 11 Jan 2010 10:46:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55392 invoked by uid 500); 11 Jan 2010 10:46:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55382 invoked by uid 99); 11 Jan 2010 10:46:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 10:46:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 10:46:14 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUHmT-0003LW-6d
	for java-user@lucene.apache.org; Mon, 11 Jan 2010 02:45:53 -0800
Message-ID: <27108579.post@talk.nabble.com>
Date: Mon, 11 Jan 2010 02:45:53 -0800 (PST)
From: Mohsen Saboorian <mohsens@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Highlighter doesn't highlight wildcard queries after updating
 to 2.9.1/3.0.0
In-Reply-To: <27106737.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: mohsens@gmail.com
References: <26969517.post@talk.nabble.com> <4B3B84C0.3040001@gmail.com> <26969989.post@talk.nabble.com> <27106452.post@talk.nabble.com> <27106737.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


changing MultiTermRewriteMethod fixed all previous incompatibility issue.
After setting this:
myQueryParser.setMultiTermRewriteMethod(MultiTermQuery.SCORING_BOOLEAN_QUERY_REWRITE);

highlighter get compatible with rewrite, query.rewrite().toString() works as
before and scoring works fine for wildcard queries (as before).

Mohsen


Mohsen Saboorian wrote:
> 
> OK, to answer my own question:
> I found from the following issue that if I do a query.rewrite(),
> highlighter doesn't work.
> https://issues.apache.org/jira/browse/LUCENE-1425
> 
> I did rewrite() in order to find all matched terms for example in a prefix
> query, but as this doesn't work anymore like Lucene 2.3, and returns
> nothings renderable, I stopped rewriting and to my surprise, highlighter
> worked with prefix, or other queries.
> 
> It was also needed to add lucene-memory contrib library (which is
> referenced by WeightedSpanTermExtractor) to prevent exception (NCDFE).
> 
> 
> Mohsen
> 
> 
> Mohsen Saboorian wrote:
>> 
>> The problem comes from this method:
>> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extract(Query,
>> Map<String, WeightedSpanTerm>)
>> 
>> The query passed to this method is of type
>> org.apache.lucene.search.ConstantScoreQuery, but it matches non of
>> 'instanceof' checkings in this method, so no WeightedSpanTerm is
>> extracted.
>> 
>> It this a bug?
>> 
>> Thanks,
>> Mohsen
>> 
> 
> 

-- 
View this message in context: http://old.nabble.com/Highlighter-doesn%27t-highlight-wildcard-queries-after-updating-to-2.9.1-3.0.0-tp26969517p27108579.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44463-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 11:40:50 2010
Return-Path: <java-user-return-44463-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54316 invoked from network); 11 Jan 2010 11:40:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 11:40:50 -0000
Received: (qmail 85853 invoked by uid 500); 11 Jan 2010 11:40:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85782 invoked by uid 500); 11 Jan 2010 11:40:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85772 invoked by uid 99); 11 Jan 2010 11:40:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 11:40:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of sanne.grinovero@gmail.com designates 209.85.219.212 as permitted sender)
Received: from [209.85.219.212] (HELO mail-ew0-f212.google.com) (209.85.219.212)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 11:40:40 +0000
Received: by ewy4 with SMTP id 4so23030615ewy.12
        for <java-user@lucene.apache.org>; Mon, 11 Jan 2010 03:40:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=Cg2LmuYeAFQFOkAUcVF9asdX0m/CFZQkItIWWJHY38I=;
        b=rwIUwjilslWOgNtEiXdP05t98TAB4ly2SaZVDvS3B0c+0/4Mq0YhYtIW6YwOEsQZ2N
         ewi3k4buY42Q92FZkDLOQADONkMXr0sJ1YPkT9gNg+QToNDnoRNdDWA6rwypu51qi8cn
         3utrRGl1ceqkd1xvMeNCSSZwKWuEL5igiDWWw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=wvDIuLkxcxrG5CpwRKQDiKtkciUgcJLT9yjhC3op3MyIteyEMWIzLvJW/cNKneQ7hs
         PzonDsuXPjc96yU1Idd/h1FP3JffNts1hsfWeJfXyB7p91uHmz/1Ll4HDDWdtcIf8y4o
         CgWC3TbLjuoJB2IxZkxChwoT0dnDWcOAlHErY=
MIME-Version: 1.0
Received: by 10.213.43.130 with SMTP id w2mr3295874ebe.89.1263210018114; Mon, 
	11 Jan 2010 03:40:18 -0800 (PST)
In-Reply-To: <3a1a1b2b1001102334y12338141h1ceb4862745021fe@mail.gmail.com>
References: <3a1a1b2b1001102300g13d443aw4f1835a483ee3462@mail.gmail.com> 
	<3a1a1b2b1001102334y12338141h1ceb4862745021fe@mail.gmail.com>
From: Sanne Grinovero <sanne.grinovero@gmail.com>
Date: Mon, 11 Jan 2010 12:39:58 +0100
Message-ID: <50e5f6251001110339p809cc7atdff2725f0801b031@mail.gmail.com>
Subject: Re: Highlight the whole sentence instead of the partial matching 
	terms
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

If you're searching for terms "giving" and "and", it will only
highlight those terms, not the whole sentence.. that's how the
highlighter is meant to work: highlight what the user did query. Also
there's no built-in concept of sentence.

regards,
Sanne

2010/1/11 Li Leon <leon800219@gmail.com>:
> Just figured out, missed "lucene-memory-2.4.1.jar" external jar inclusion=
.
>
> With that jar included, "\"Giving and\"~11" only got "Giving" & "and"
> highlighted but not the whole sentence, any ideas?
>
> Thanks,
>
> 2010/1/11 Li Leon <leon800219@gmail.com>
>
>> *Hi all,*
>> **
>> *I wanted to use to following code to highlight the whole sentence with
>> "\"something\"~n" to be parsed.*
>> **
>> *The QueryParser part worked well, but when integrated with Highlighter,
>> it ended up with exception. *
>> **
>> *Does anyone have any clue as I'm investigating this.*
>> **
>> **
>> *Thanks,*
>> **
>>
>>
>>
>> Exception in thread "main" java.lang.NoClassDefFoundError:
>> org/apache/lucene/index/memory/MemoryIndex
>>
>> =C2=A0 =C2=A0 =C2=A0 at
>> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getReaderFo=
rField(
>> *WeightedSpanTermExtractor.java:361*)
>>
>> =C2=A0 =C2=A0 =C2=A0 at
>> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extractWeig=
htedSpanTerms(
>> *WeightedSpanTermExtractor.java:282*)
>>
>> =C2=A0 =C2=A0 =C2=A0 at
>> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.extract(*
>> WeightedSpanTermExtractor.java:149*)
>>
>> =C2=A0 =C2=A0 =C2=A0 at
>> org.apache.lucene.search.highlight.WeightedSpanTermExtractor.getWeighted=
SpanTerms(
>> *WeightedSpanTermExtractor.java:414*)
>>
>> =C2=A0 =C2=A0 =C2=A0 at org.apache.lucene.search.highlight.QueryScorer.i=
nitExtractor(*
>> QueryScorer.java:216*)
>>
>> =C2=A0 =C2=A0 =C2=A0 at org.apache.lucene.search.highlight.QueryScorer.i=
nit(*
>> QueryScorer.java:184*)
>>
>> =C2=A0 =C2=A0 =C2=A0 at
>> org.apache.lucene.search.highlight.Highlighter.getBestTextFragments(*
>> Highlighter.java:226*)
>>
>> =C2=A0 =C2=A0 =C2=A0at org.apache.lucene.search.highlight.Highlighter.ge=
tBestFragments(*
>> Highlighter.java:184*)
>>
>> =C2=A0 =C2=A0 =C2=A0at org.apache.lucene.search.highlight.Highlighter.ge=
tBestFragments(*
>> Highlighter.java:488*)
>>
>> =C2=A0 =C2=A0 =C2=A0 at Hightlight.main(*Hightlight.java:182*)
>>
>>
>> **
>> *public* *class* Hightlight {
>>
>> =C2=A0 *private* *static* *final* String *text* =3D
>>
>> =C2=A0 =C2=A0 "Giving end users some context around hits from their sear=
ches is
>> friendly and, more important, useful. An useful example is friendly Goog=
le
>> search context.";
>>
>>
>>
>> =C2=A0 *private* *static* *final* String[] *stopwords* =3D {};
>>
>> =C2=A0 *private* *static* IndexSearcher *searcher*;
>>
>> =C2=A0 *public* *static* *void* main(String[] args) *throws* Exception {
>>
>>
>>
>> =C2=A0 =C2=A0 String filename =3D args[0];
>>
>>
>>
>> =C2=A0 =C2=A0 String searchText =3D "\"Giving and\"~11";
>> =C2=A0#1
>>
>> =C2=A0 =C2=A0 QueryParser parser =3D *new* QueryParser("f", *new*
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 StandardAnalyzer(*stopwords*))=
;
>>
>> =C2=A0 =C2=A0 Query query =3D parser.parse(searchText);
>>
>>
>>
>> =C2=A0 =C2=A0 SimpleHTMLFormatter formatter =3D
>>
>> =C2=A0 =C2=A0 =C2=A0 *new* SimpleHTMLFormatter("<span class=3D\"highligh=
t\">",
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 "</span>");
>>
>>
>>
>> =C2=A0 =C2=A0 TokenStream tokens =3D *new* StandardAnalyzer(*stopwords*)
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 .tokenStream("f", *new* StringReader(*text*)=
);
>>
>>
>>
>> =C2=A0 =C2=A0 QueryScorer scorer =3D *new* QueryScorer(query, "f");
>>
>>
>>
>> =C2=A0 =C2=A0 Highlighter highlighter =3D *new* Highlighter(formatter, s=
corer);
>>
>> =C2=A0 =C2=A0 highlighter.setTextFragmenter(
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 *new* Nul=
lFragmenter());
>>
>>
>>
>> =C2=A0 =C2=A0 String result =3D
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 highlighter.getBestFragments(tokens, *text*,=
 3, "...");
>>
>>
>>
>> =C2=A0 =C2=A0 FileWriter writer =3D *new* FileWriter(filename);
>>
>> =C2=A0 =C2=A0 writer.write("<html>");
>>
>> =C2=A0 =C2=A0 writer.write("<style>\n" +
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 ".highlight {\n" +
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 " background: yellow;\n" +
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 "}\n" +
>>
>> =C2=A0 =C2=A0 =C2=A0 =C2=A0 "</style>");
>>
>> =C2=A0 =C2=A0 writer.write("<body>");
>>
>> =C2=A0 =C2=A0 writer.write(result);
>>
>> =C2=A0 =C2=A0 writer.write("</body></html>");
>>
>> =C2=A0 =C2=A0 writer.close();
>>
>> =C2=A0 }
>>
>> }
>>
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44464-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 17:14:35 2010
Return-Path: <java-user-return-44464-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23888 invoked from network); 11 Jan 2010 17:14:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 17:14:35 -0000
Received: (qmail 8756 invoked by uid 500); 11 Jan 2010 17:14:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8669 invoked by uid 500); 11 Jan 2010 17:14:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8659 invoked by uid 99); 11 Jan 2010 17:14:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 17:14:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of benhei@gmail.com designates 209.85.220.212 as permitted sender)
Received: from [209.85.220.212] (HELO mail-fx0-f212.google.com) (209.85.220.212)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 17:14:25 +0000
Received: by fxm4 with SMTP id 4so18156205fxm.12
        for <java-user@lucene.apache.org>; Mon, 11 Jan 2010 09:14:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=oH/s13tU1sn8U2wHfB/UedX5kGRLKpGl/Q9miXCEUqU=;
        b=t2UVxEp5zGJtCKwxZX8D5QpoLPgjKreeHilwfk/QgV5sycUmsxoznKPsQjyx83g5D4
         hynkkKQqP3zqH3EK2C47JyYJYbXFKHIoe3BcjTIJ7MXdsUvbULN8TJiyMoag4P9V/gih
         zWdedfRm83Rc9u+QWXaYDLgH/uWIRmEPIUXpc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=KZ0nqr7ww5SgI/nPD+om5WXaUqFPf3Gd1paKhiKHVXVCZ5D3//HPH4PgUh3l99yoDW
         1PszQIATVeAYOqIZrUlTWnc23XqqMqUrfmh7Syb+iZ0wWljgIGZ3ygmBnsFrvOLDZma5
         Dulsv3+Za7GnmwAP2MB7RDHof7qOQVaPA7JQc=
MIME-Version: 1.0
Received: by 10.223.2.80 with SMTP id 16mr2665568fai.90.1263230044698; Mon, 11 
	Jan 2010 09:14:04 -0800 (PST)
Date: Mon, 11 Jan 2010 18:14:04 +0100
Message-ID: <94095f521001110914qe138944he69aac0b3bb85c52@mail.gmail.com>
Subject: Field creation with TokenStream and stored value
From: Benjamin Heilbrunn <benhei@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hey out there,

in lucene it's not possible to create a Field based on a TokenStream
AND supply a stored value.

Is there a reason why a Field constructor in the form of
   public Field(String name, TokenStream tokenStream, String storedValue)
does not exist?

I am using trees of TeeSinkTokenFilter's for the creation of many
fields, based on a source string.
That's the reason why I can't use the "standardconstructor"
    public Field(String name, String value, Store store, Index index)


Regards
Benjamin

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44465-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 17:56:13 2010
Return-Path: <java-user-return-44465-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48961 invoked from network); 11 Jan 2010 17:56:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 17:56:12 -0000
Received: (qmail 5739 invoked by uid 500); 11 Jan 2010 17:56:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5665 invoked by uid 500); 11 Jan 2010 17:56:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5655 invoked by uid 99); 11 Jan 2010 17:56:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 17:56:10 +0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [62.146.193.99] (HELO mx.billiger.de) (62.146.193.99)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 17:56:00 +0000
Received: from solute-exc2k7.solute.ka (norad.solute-gmbh.de [145.253.139.66])
	by mx.billiger.de (Postfix) with ESMTPS id 8957480A701
	for <java-user@lucene.apache.org>; Mon, 11 Jan 2010 18:55:38 +0100 (CET)
Received: from solute-exc2k7.solute.ka ([10.1.1.3]) by solute-exc2k7.solute.ka
 ([10.1.1.3]) with mapi; Mon, 11 Jan 2010 18:55:36 +0100
From: Yuliya Palchaninava <yp@solute.de>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 11 Jan 2010 18:55:36 +0100
Subject: AW: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not 	optimized index
Thread-Topic: Lucene 2.9 and 3.0: Optimized index is thrice as large as the
 not 	optimized index
Thread-Index: AcqQZ/ColQx/tO1BSsiWHfbRk1+7ogCfR9Yg
Message-ID: <0523297188849D479C16D5657F665769BB5CED487C@solute-exc2k7.solute.ka>
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
	 <943192.67571.qm@web50305.mail.re2.yahoo.com>
	 <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
	 <9ac0c6aa1001070859q3363ac1k68786a0165999219@mail.gmail.com>
	 <0523297188849D479C16D5657F665769BB5CED4872@solute-exc2k7.solute.ka>
 <9ac0c6aa1001080538k11bd56f9n1a6b7eaa86cba1be@mail.gmail.com>
In-Reply-To: <9ac0c6aa1001080538k11bd56f9n1a6b7eaa86cba1be@mail.gmail.com>
Accept-Language: en-US, de-DE
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, de-DE
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks again.

Disabling norms, where it was possible without influencing the search quali=
ty,
has solved the problem:
- The not optimized version of the index has become smaller.
- The optimized index has practically the same size as the not optimized on=
e.

Yuliya

> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]=20
> Gesendet: Freitag, 8. Januar 2010 14:38
> An: java-user@lucene.apache.org
> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice as=20
> large as the not optimized index
>=20
> Lucene stores 1 byte (disk and RAM, when searching that=20
> field) per document for any field that has norms enabled,=20
> even for documents that do not contain that field.
>=20
> In your case, that's ~20 MB per field (once optimize is done), times
> 559 fields =3D ~11TB of storage.
>=20
> You should index these fields with=20
> Field.Index.ANALYZED_NO_NORMS to turn off norms.  But, this=20
> means field/doc boosting, and the normal length boosting=20
> Lucene normally does (shorter documents get a better score),=20
> will be silently disabled.  Also: you must fully re-index=20
> from scratch, otherwise the norms will turn themselves back=20
> on when segments merge together.
>=20
> Mike
>=20
> On Fri, Jan 8, 2010 at 7:55 AM, Yuliya Palchaninava=20
> <yp@solute.de> wrote:
> > Thanks Michael.
> >
> > You are probably wright.
> >
> > Not optimized size is 4.1G, optimized index is about 15G.
> >
> > Yes, our documents do have many different indexed fields=20
> and norms are enabled.
> > Nr of fields: 559
> > Nr of documents: 20845906
> > Nr of terms: 25615389
> >
> > Could you please give me a more detailled explanation, how=20
> the storage of norms effects the size of an index.
> > What do you mean exactly with "norms are not stored sparsely"?
> >
> > Thanks,
> > Yuliya
> >
> >> -----Urspr=FCngliche Nachricht-----
> >> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> >> Gesendet: Donnerstag, 7. Januar 2010 18:00
> >> An: java-user@lucene.apache.org
> >> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice=20
> as large=20
> >> as the not optimized index
> >>
> >> Do your documents have many different indexed fields? =A0If=20
> you do, and=20
> >> norms are enabled, that could be the cause (norms are not stored=20
> >> sparsely).
> >>
> >> But: what actual sizes are we talking about?
> >>
> >> Mike
> >>
> >> On Thu, Jan 7, 2010 at 11:50 AM, Yuliya Palchaninava=20
> <yp@solute.de>=20
> >> wrote:
> >> > Otis,
> >> >
> >> > thanks for the answer.
> >> >
> >> > Unfortunatelly the index *directory* remains larger *after"
> >> the optimization.
> >> > In our case the otimization was/is completed successfully
> >> and, as you
> >> > say, there is only one segment in the directory.
> >> >
> >> > Some other ideas?
> >> >
> >> > Thanks,
> >> > Yuliya
> >> >
> >> >> -----Urspr=FCngliche Nachricht-----
> >> >> Von: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]
> >> >> Gesendet: Donnerstag, 7. Januar 2010 17:35
> >> >> An: java-user@lucene.apache.org
> >> >> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice
> >> as large
> >> >> as the not optimized index
> >> >>
> >> >> Yuliya,
> >> >>
> >> >> The index *directory* will be larger *while* you are optimizing.
> >> >> After the optimization is completed successfully, the
> >> index directory
> >> >> will be smaller. =A0It is possible that your index directory is
> >> >> large(r) because you have some left-over segments (e.g.=20
> from some=20
> >> >> earlier failed/interrupted optimizations) that are not
> >> really a part
> >> >> of the index. =A0After optimizing, you should have only 1
> >> segment, so
> >> >> if you see more than 1 segment, look at the ones with older=20
> >> >> timestamps. =A0Those can be (re)moved.
> >> >>
> >> >> =A0Otis
> >> >> --
> >> >> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> >> >>
> >> >>
> >> >>
> >> >> ----- Original Message ----
> >> >> > From: Yuliya Palchaninava <yp@solute.de>
> >> >> > To: "java-user@lucene.apache.org"=20
> <java-user@lucene.apache.org>
> >> >> > Sent: Thu, January 7, 2010 11:23:08 AM
> >> >> > Subject: Lucene 2.9 and 3.0: Optimized index is thrice as
> >> >> large as the
> >> >> > not optimized index
> >> >> >
> >> >> > Hi,
> >> >> >
> >> >> > According to the api documentation: "In general, once
> >> the optimize
> >> >> > completes, the total size of the index will be less than
> >> >> the size of
> >> >> > the starting index. It could be quite a bit smaller (if
> >> there were
> >> >> > many pending deletes) or just slightly smaller". In our
> >> >> case the index
> >> >> > becomes not smaller but larger, namely thrice as large.
> >> >> >
> >> >> > The not optimized index doesn't contain compressed fields,
> >> >> what could
> >> >> > have caused the growth of the index due to the
> >> otimization. So we
> >> >> > cannot explain what happens.
> >> >> >
> >> >> > Does someone have an explanation for the index growth due
> >> >> to the optimization?
> >> >> >
> >> >> > Thanks,
> >> >> > Yuliya
> >> >> >
> >> >> >
> >> >> >
> >> >>
> >>=20
> ---------------------------------------------------------------------
> >> >> > To unsubscribe, e-mail:=20
> java-user-unsubscribe@lucene.apache.org
> >> >> > For additional commands, e-mail:=20
> >> >> > java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >>
> >>=20
> ---------------------------------------------------------------------
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail:=20
> java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >
> >>=20
> ---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >>
> >>=20
> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >=20
> ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
> =

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44466-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 18:18:04 2010
Return-Path: <java-user-return-44466-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64349 invoked from network); 11 Jan 2010 18:18:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 18:18:04 -0000
Received: (qmail 49383 invoked by uid 500); 11 Jan 2010 18:18:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49306 invoked by uid 500); 11 Jan 2010 18:18:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49296 invoked by uid 99); 11 Jan 2010 18:18:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 18:18:02 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 18:17:53 +0000
Received: by yxe30 with SMTP id 30so24130742yxe.29
        for <java-user@lucene.apache.org>; Mon, 11 Jan 2010 10:17:31 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.127.23 with SMTP id z23mr39943028ybc.179.1263233851601; 
	Mon, 11 Jan 2010 10:17:31 -0800 (PST)
In-Reply-To: <0523297188849D479C16D5657F665769BB5CED487C@solute-exc2k7.solute.ka>
References: <0523297188849D479C16D5657F665769BB5CED486A@solute-exc2k7.solute.ka>
	 <943192.67571.qm@web50305.mail.re2.yahoo.com>
	 <0523297188849D479C16D5657F665769BB5CED486B@solute-exc2k7.solute.ka>
	 <9ac0c6aa1001070859q3363ac1k68786a0165999219@mail.gmail.com>
	 <0523297188849D479C16D5657F665769BB5CED4872@solute-exc2k7.solute.ka>
	 <9ac0c6aa1001080538k11bd56f9n1a6b7eaa86cba1be@mail.gmail.com>
	 <0523297188849D479C16D5657F665769BB5CED487C@solute-exc2k7.solute.ka>
Date: Mon, 11 Jan 2010 13:17:31 -0500
Message-ID: <9ac0c6aa1001111017o7dfb449cib794361b3d7d71f@mail.gmail.com>
Subject: Re: Lucene 2.9 and 3.0: Optimized index is thrice as large as the not 
	optimized index
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Super!  Thanks for bringing closure.

Mike

On Mon, Jan 11, 2010 at 12:55 PM, Yuliya Palchaninava <yp@solute.de> wrote:
> Thanks again.
>
> Disabling norms, where it was possible without influencing the search qua=
lity,
> has solved the problem:
> - The not optimized version of the index has become smaller.
> - The optimized index has practically the same size as the not optimized =
one.
>
> Yuliya
>
>> -----Urspr=FCngliche Nachricht-----
>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Gesendet: Freitag, 8. Januar 2010 14:38
>> An: java-user@lucene.apache.org
>> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice as
>> large as the not optimized index
>>
>> Lucene stores 1 byte (disk and RAM, when searching that
>> field) per document for any field that has norms enabled,
>> even for documents that do not contain that field.
>>
>> In your case, that's ~20 MB per field (once optimize is done), times
>> 559 fields =3D ~11TB of storage.
>>
>> You should index these fields with
>> Field.Index.ANALYZED_NO_NORMS to turn off norms. =A0But, this
>> means field/doc boosting, and the normal length boosting
>> Lucene normally does (shorter documents get a better score),
>> will be silently disabled. =A0Also: you must fully re-index
>> from scratch, otherwise the norms will turn themselves back
>> on when segments merge together.
>>
>> Mike
>>
>> On Fri, Jan 8, 2010 at 7:55 AM, Yuliya Palchaninava
>> <yp@solute.de> wrote:
>> > Thanks Michael.
>> >
>> > You are probably wright.
>> >
>> > Not optimized size is 4.1G, optimized index is about 15G.
>> >
>> > Yes, our documents do have many different indexed fields
>> and norms are enabled.
>> > Nr of fields: 559
>> > Nr of documents: 20845906
>> > Nr of terms: 25615389
>> >
>> > Could you please give me a more detailled explanation, how
>> the storage of norms effects the size of an index.
>> > What do you mean exactly with "norms are not stored sparsely"?
>> >
>> > Thanks,
>> > Yuliya
>> >
>> >> -----Urspr=FCngliche Nachricht-----
>> >> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> >> Gesendet: Donnerstag, 7. Januar 2010 18:00
>> >> An: java-user@lucene.apache.org
>> >> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice
>> as large
>> >> as the not optimized index
>> >>
>> >> Do your documents have many different indexed fields? =A0If
>> you do, and
>> >> norms are enabled, that could be the cause (norms are not stored
>> >> sparsely).
>> >>
>> >> But: what actual sizes are we talking about?
>> >>
>> >> Mike
>> >>
>> >> On Thu, Jan 7, 2010 at 11:50 AM, Yuliya Palchaninava
>> <yp@solute.de>
>> >> wrote:
>> >> > Otis,
>> >> >
>> >> > thanks for the answer.
>> >> >
>> >> > Unfortunatelly the index *directory* remains larger *after"
>> >> the optimization.
>> >> > In our case the otimization was/is completed successfully
>> >> and, as you
>> >> > say, there is only one segment in the directory.
>> >> >
>> >> > Some other ideas?
>> >> >
>> >> > Thanks,
>> >> > Yuliya
>> >> >
>> >> >> -----Urspr=FCngliche Nachricht-----
>> >> >> Von: Otis Gospodnetic [mailto:otis_gospodnetic@yahoo.com]
>> >> >> Gesendet: Donnerstag, 7. Januar 2010 17:35
>> >> >> An: java-user@lucene.apache.org
>> >> >> Betreff: Re: Lucene 2.9 and 3.0: Optimized index is thrice
>> >> as large
>> >> >> as the not optimized index
>> >> >>
>> >> >> Yuliya,
>> >> >>
>> >> >> The index *directory* will be larger *while* you are optimizing.
>> >> >> After the optimization is completed successfully, the
>> >> index directory
>> >> >> will be smaller. =A0It is possible that your index directory is
>> >> >> large(r) because you have some left-over segments (e.g.
>> from some
>> >> >> earlier failed/interrupted optimizations) that are not
>> >> really a part
>> >> >> of the index. =A0After optimizing, you should have only 1
>> >> segment, so
>> >> >> if you see more than 1 segment, look at the ones with older
>> >> >> timestamps. =A0Those can be (re)moved.
>> >> >>
>> >> >> =A0Otis
>> >> >> --
>> >> >> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>> >> >>
>> >> >>
>> >> >>
>> >> >> ----- Original Message ----
>> >> >> > From: Yuliya Palchaninava <yp@solute.de>
>> >> >> > To: "java-user@lucene.apache.org"
>> <java-user@lucene.apache.org>
>> >> >> > Sent: Thu, January 7, 2010 11:23:08 AM
>> >> >> > Subject: Lucene 2.9 and 3.0: Optimized index is thrice as
>> >> >> large as the
>> >> >> > not optimized index
>> >> >> >
>> >> >> > Hi,
>> >> >> >
>> >> >> > According to the api documentation: "In general, once
>> >> the optimize
>> >> >> > completes, the total size of the index will be less than
>> >> >> the size of
>> >> >> > the starting index. It could be quite a bit smaller (if
>> >> there were
>> >> >> > many pending deletes) or just slightly smaller". In our
>> >> >> case the index
>> >> >> > becomes not smaller but larger, namely thrice as large.
>> >> >> >
>> >> >> > The not optimized index doesn't contain compressed fields,
>> >> >> what could
>> >> >> > have caused the growth of the index due to the
>> >> otimization. So we
>> >> >> > cannot explain what happens.
>> >> >> >
>> >> >> > Does someone have an explanation for the index growth due
>> >> >> to the optimization?
>> >> >> >
>> >> >> > Thanks,
>> >> >> > Yuliya
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >>
>> >>
>> ---------------------------------------------------------------------
>> >> >> > To unsubscribe, e-mail:
>> java-user-unsubscribe@lucene.apache.org
>> >> >> > For additional commands, e-mail:
>> >> >> > java-user-help@lucene.apache.org
>> >> >>
>> >> >>
>> >> >>
>> >>
>> ---------------------------------------------------------------------
>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> >> For additional commands, e-mail:
>> java-user-help@lucene.apache.org
>> >> >>
>> >> >>
>> >> >
>> >>
>> ---------------------------------------------------------------------
>> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >
>> >> >
>> >>
>> >>
>> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>> ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44467-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 18:43:17 2010
Return-Path: <java-user-return-44467-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82750 invoked from network); 11 Jan 2010 18:43:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 18:43:17 -0000
Received: (qmail 80972 invoked by uid 500); 11 Jan 2010 18:43:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80903 invoked by uid 500); 11 Jan 2010 18:43:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80891 invoked by uid 99); 11 Jan 2010 18:43:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 18:43:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 18:43:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUPDw-0008Co-4B
	for java-user@lucene.apache.org; Mon, 11 Jan 2010 10:42:44 -0800
Message-ID: <27115515.post@talk.nabble.com>
Date: Mon, 11 Jan 2010 10:42:44 -0800 (PST)
From: Frank Geary <fgeary@acquiremedia.com>
To: java-user@lucene.apache.org
Subject: Index corruption using Lucene 2.4.1 - thread safety issue?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fgeary@acquiremedia.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I'm using Lucene 2.4.1 and am seeing occasional index corruption.  It shows
up when I call MultiSearcher.search().  MultiSearcher.search() throws the
following exception:

ArrayIndexOutOfBoundsException.  The error is: Array index out of range: ###
where ### is a number representing an index into the deletedDocs BitVector
in SegmentTermDocs.  the stack trace is as follows:

2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.util.BitVector.get(BitVector.java:91)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:125)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.index.MultiSegmentReader$MultiTermDocs.next(MultiSegmentReader.java:554)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.FieldCacheImpl$10.createValue(FieldCacheImpl.java:384)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:71)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.FieldCacheImpl.getStringIndex(FieldCacheImpl.java:351)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.FieldSortedHitQueue.comparatorString(FieldSortedHitQueue.java:415)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.FieldSortedHitQueue$1.createValue(FieldSortedHitQueue.java:206)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:71)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.FieldSortedHitQueue.getCachedComparator(FieldSortedHitQueue.java:167)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.FieldSortedHitQueue.<init>(FieldSortedHitQueue.java:55)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.TopFieldDocCollector.<init>(TopFieldDocCollector.java:43)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:122)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.MultiSearcher.search(MultiSearcher.java:232)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
org.apache.lucene.search.Searcher.search(Searcher.java:86)
2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
com.acquiremedia.opens.index.searcher.HybridIndexSearcher.search(HybridIndexSearcher.java:311)
.
.
.

That makes sense, but I'm trying to understand what could be causing the
corruption. 

Here's what I'm doing:

1) I have an IndexWriter created usnig a RAMDirectory.  

2) I have a single thread processing index adds and index deletes.  This
thread is rather simple and calls IndexWriter.addDocument() followed by
IndexWriter.commit() or IndexWriter.deleteDocuments() followed by
IndexWriter.commit().  The commits are done at this point because we want
the documents available for searching immediately.  

3) I also have 4 search threads running at the same time as the index write
thread.  Each time a search thread executes a search it calls
IndexReader.reopen()  on the existing IndexReader for the index created
using the RAMDirectory above, gets an existing index reader for another
on-disk index and then calls MultiSearcher.search() (this brings together
the RamDirectory index and an on-disk index) to execute the search.

It generally works fine, but every few days or so I get the above
ArrayIndexOutOfBoundsException.   My suspicion is that when the
IndexWritert.commit() call happens due to a delete at the exact same time as
the IndexReader.reopen() call happens, the IndexReader has a deleteDocs
BitVector which reflects the delete, but something else internal to the
IndexReader is not reflecting the delete.  

So, I implemented a semaphore mechanism to prevent IndexWriter.commit() from
happening at the same time as IndexReader.reopen().  I only implemented the
semaphores in the delete case because my guess was that an add would be
unlikely to affect the deleteDocs Bit Vector.  Unfortunately, the problem
continues to happen.

I believe I read somewhere that a similar thread saftey issue had been fixed
in Lucene 2.4, but I suspect there may still be an issue in 2.4.1.  

Does anyone have any knowledge or insight into what I may be doing wrong or
how I can correct/avoid the problem?  Upgrading to Lucene 3.0 or using Solr
are not really options for me at least in the short term.

Thanks for any information you can provide!

Frank
-- 
View this message in context: http://old.nabble.com/Index-corruption-using-Lucene-2.4.1---thread-safety-issue--tp27115515p27115515.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44468-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 20:05:05 2010
Return-Path: <java-user-return-44468-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12908 invoked from network); 11 Jan 2010 20:05:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 20:05:04 -0000
Received: (qmail 17026 invoked by uid 500); 11 Jan 2010 20:05:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16945 invoked by uid 500); 11 Jan 2010 20:05:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16935 invoked by uid 99); 11 Jan 2010 20:05:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 20:05:02 +0000
X-ASF-Spam-Status: No, hits=1.1 required=10.0
	tests=FORGED_HOTMAIL_RCVD2,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 20:04:54 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUQV8-0006xv-4I
	for java-user@lucene.apache.org; Mon, 11 Jan 2010 12:04:34 -0800
Message-ID: <27116739.post@talk.nabble.com>
Date: Mon, 11 Jan 2010 12:04:34 -0800 (PST)
From: maxSchlein <m_schlein@hotmail.com>
To: java-user@lucene.apache.org
Subject: Text extraction from ms word doc
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: m_schlein@hotmail.com


I was looking for an option for Text extraction from a word doc. =20

Currently I am using POI; however, when there is a table in the doc, for
each column POI brings back a =15.  The whitespace analyzer is not filterin=
g
out this character.  So whatever word or phrase that is the last word or
phrase within a table column is not found during searching.  That is, if th=
e
word dog is the only word in a column, a search for the word dog would
return nothing because the word that was indexed was "dog=15".

I can create a filter to fix this, using Apache's
StringUtils.isAsciiPrintable, but I would rather not.

Any and all help is welcome and thanked.
--=20
View this message in context: http://old.nabble.com/Text-extraction-from-ms=
-word-doc-tp27116739p27116739.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44469-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 11 21:12:40 2010
Return-Path: <java-user-return-44469-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35545 invoked from network); 11 Jan 2010 21:12:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 11 Jan 2010 21:12:40 -0000
Received: (qmail 18865 invoked by uid 500); 11 Jan 2010 21:12:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18797 invoked by uid 500); 11 Jan 2010 21:12:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18787 invoked by uid 99); 11 Jan 2010 21:12:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 21:12:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of karl.wettin@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 11 Jan 2010 21:12:27 +0000
Received: by ey-out-2122.google.com with SMTP id 9so4721771eyd.3
        for <java-user@lucene.apache.org>; Mon, 11 Jan 2010 13:12:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=utER0xWMtpRk5C/wCBlcReqg5+HpBjBr+Xuv/e83qbA=;
        b=IQXeeBoPvLXc7XKcBHIN0NweQxnMuPFwLxQpf6BG1ayRZdv/7/8ts/R07nM5WB0Na4
         OBvQOuRyWt5tY3qTi64ePFIdv4UePCHMcaslpFCIDy9AIhmZR9/H7SXLNGRknAvQ7NkM
         d3k47iTbVDmqya69mXc4JjA1P6nQeBIhOWxUU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=VGVRogX4JIcFrk3qGklTL+AK/oqCDppgWKzonisa3QFwqF1nmRYlWSFyKgK6T1dM5P
         GBRIUcnAbOkPRS79RZu/3lZiF/9e6gTdiSETPq1lzupImb4MpJ14GwrZZq+VoJVCOBtI
         BS9RdyCka99sdJiH+yNBl+DiiWZmVAAZD9K7c=
Received: by 10.213.42.141 with SMTP id s13mr6733866ebe.37.1263244325906;
        Mon, 11 Jan 2010 13:12:05 -0800 (PST)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 28sm3459370eyg.36.2010.01.11.13.12.04
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 11 Jan 2010 13:12:05 -0800 (PST)
Message-Id: <AD3253AD-EC04-46CF-869A-24DE140BA488@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <27116739.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Text extraction from ms word doc
Date: Mon, 11 Jan 2010 22:12:04 +0100
References: <27116739.post@talk.nabble.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Have you tried antiword?

http://www.winfield.demon.nl/


       karl

11 jan 2010 kl. 21.04 skrev maxSchlein:

>
> I was looking for an option for Text extraction from a word doc.
>
> Currently I am using POI; however, when there is a table in the doc, =20=

> for
> each column POI brings back a =15.  The whitespace analyzer is not =20
> filtering
> out this character.  So whatever word or phrase that is the last =20
> word or
> phrase within a table column is not found during searching.  That =20
> is, if the
> word dog is the only word in a column, a search for the word dog would
> return nothing because the word that was indexed was "dog=15".
>
> I can create a filter to fix this, using Apache's
> StringUtils.isAsciiPrintable, but I would rather not.
>
> Any and all help is welcome and thanked.
> --=20
> View this message in context: =
http://old.nabble.com/Text-extraction-from-ms-word-doc-tp27116739p27116739=
.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44470-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 09:01:47 2010
Return-Path: <java-user-return-44470-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3591 invoked from network); 12 Jan 2010 09:01:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 09:01:47 -0000
Received: (qmail 68775 invoked by uid 500); 12 Jan 2010 09:01:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68557 invoked by uid 500); 12 Jan 2010 09:01:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68547 invoked by uid 99); 12 Jan 2010 09:01:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 09:01:44 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.215] (HELO mail-gx0-f215.google.com) (209.85.217.215)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 09:01:34 +0000
Received: by gxk7 with SMTP id 7so20781264gxk.12
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 01:01:12 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.101.15 with SMTP id y15mr5870457ybb.162.1263286872536; 
	Tue, 12 Jan 2010 01:01:12 -0800 (PST)
In-Reply-To: <27115515.post@talk.nabble.com>
References: <27115515.post@talk.nabble.com>
Date: Tue, 12 Jan 2010 04:01:12 -0500
Message-ID: <9ac0c6aa1001120101o77c9e0b9i74ad0e76b59063ad@mail.gmail.com>
Subject: Re: Index corruption using Lucene 2.4.1 - thread safety issue?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Not good!  Can you post the ###'s from the exception?  How far out of
bounds is the access?

Your usage sounds fine.  Reopen during commit is fine.

Are you sure the exception comes from the reader on the RAMDir and not
your main dir?

How do you periodically move your in-RAM changes to the disk index?

Have you run CheckIndex on your index?  Also, try running with asserts
enabled... it may catch whatever is happening, sooner.

Do you hold open a single IW on the RAMDir, and re-use it?  Or open
and then close?  What about the disk dir?

Mike

On Mon, Jan 11, 2010 at 1:42 PM, Frank Geary <fgeary@acquiremedia.com> wrot=
e:
>
> Hi,
>
> I'm using Lucene 2.4.1 and am seeing occasional index corruption. =A0It s=
hows
> up when I call MultiSearcher.search(). =A0MultiSearcher.search() throws t=
he
> following exception:
>
> ArrayIndexOutOfBoundsException. =A0The error is: Array index out of range=
: ###
> where ### is a number representing an index into the deletedDocs BitVecto=
r
> in SegmentTermDocs. =A0the stack trace is as follows:
>
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.util.BitVector.get(BitVector.java:91)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:125)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.index.MultiSegmentReader$MultiTermDocs.next(MultiSegmen=
tReader.java:554)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.FieldCacheImpl$10.createValue(FieldCacheImpl.jav=
a:384)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:71)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.FieldCacheImpl.getStringIndex(FieldCacheImpl.jav=
a:351)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.FieldSortedHitQueue.comparatorString(FieldSorted=
HitQueue.java:415)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.FieldSortedHitQueue$1.createValue(FieldSortedHit=
Queue.java:206)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:71)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.FieldSortedHitQueue.getCachedComparator(FieldSor=
tedHitQueue.java:167)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.FieldSortedHitQueue.<init>(FieldSortedHitQueue.j=
ava:55)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.TopFieldDocCollector.<init>(TopFieldDocCollector=
.java:43)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:122)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.MultiSearcher.search(MultiSearcher.java:232)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> org.apache.lucene.search.Searcher.search(Searcher.java:86)
> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
> com.acquiremedia.opens.index.searcher.HybridIndexSearcher.search(HybridIn=
dexSearcher.java:311)
> .
> .
> .
>
> That makes sense, but I'm trying to understand what could be causing the
> corruption.
>
> Here's what I'm doing:
>
> 1) I have an IndexWriter created usnig a RAMDirectory.
>
> 2) I have a single thread processing index adds and index deletes. =A0Thi=
s
> thread is rather simple and calls IndexWriter.addDocument() followed by
> IndexWriter.commit() or IndexWriter.deleteDocuments() followed by
> IndexWriter.commit(). =A0The commits are done at this point because we wa=
nt
> the documents available for searching immediately.
>
> 3) I also have 4 search threads running at the same time as the index wri=
te
> thread. =A0Each time a search thread executes a search it calls
> IndexReader.reopen() =A0on the existing IndexReader for the index created
> using the RAMDirectory above, gets an existing index reader for another
> on-disk index and then calls MultiSearcher.search() (this brings together
> the RamDirectory index and an on-disk index) to execute the search.
>
> It generally works fine, but every few days or so I get the above
> ArrayIndexOutOfBoundsException. =A0 My suspicion is that when the
> IndexWritert.commit() call happens due to a delete at the exact same time=
 as
> the IndexReader.reopen() call happens, the IndexReader has a deleteDocs
> BitVector which reflects the delete, but something else internal to the
> IndexReader is not reflecting the delete.
>
> So, I implemented a semaphore mechanism to prevent IndexWriter.commit() f=
rom
> happening at the same time as IndexReader.reopen(). =A0I only implemented=
 the
> semaphores in the delete case because my guess was that an add would be
> unlikely to affect the deleteDocs Bit Vector. =A0Unfortunately, the probl=
em
> continues to happen.
>
> I believe I read somewhere that a similar thread saftey issue had been fi=
xed
> in Lucene 2.4, but I suspect there may still be an issue in 2.4.1.
>
> Does anyone have any knowledge or insight into what I may be doing wrong =
or
> how I can correct/avoid the problem? =A0Upgrading to Lucene 3.0 or using =
Solr
> are not really options for me at least in the short term.
>
> Thanks for any information you can provide!
>
> Frank
> --
> View this message in context: http://old.nabble.com/Index-corruption-usin=
g-Lucene-2.4.1---thread-safety-issue--tp27115515p27115515.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44471-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 11:20:38 2010
Return-Path: <java-user-return-44471-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54657 invoked from network); 12 Jan 2010 11:20:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 11:20:37 -0000
Received: (qmail 56203 invoked by uid 500); 12 Jan 2010 11:20:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56137 invoked by uid 500); 12 Jan 2010 11:20:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56127 invoked by uid 99); 12 Jan 2010 11:20:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 11:20:35 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 11:20:26 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 8C639CBBDF
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 06:20:05 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Tue, 12 Jan 2010 06:20:05 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=37s1odmXljspninfZFuAeJmgYSQ=; b=ij7J77V45DOULd3k4iM9eUle9L2wWd0/BH8psoNlll3d9hFl0N29QV0cm4jzNhYIwKvJ8E8RKw3708P1eIjYx/q65N4f3sRXrN3/bzRwZUtVdq/azOXSV7ODdihI5JtK9Fyd5nrzjuERVZs85ES5P0cmNkl78qe5o9cZ7TSa57A=
X-Sasl-enc: YCy9HGufNrEOb6R4f0PtQSviCHs6HjMoP6YLaC762C7m 1263295205
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 190934AD5F0
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 06:20:04 -0500 (EST)
Message-ID: <4B4C5AE4.4060907@fastmail.fm>
Date: Tue, 12 Jan 2010 11:20:04 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene computes an automatic boost based on the number of tokens
 in the field (shorter fields have a higher boost) ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit



Why is this , and how much is this (in plain english ) please ?

thanks Paul



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44472-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 12:54:24 2010
Return-Path: <java-user-return-44472-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94620 invoked from network); 12 Jan 2010 12:54:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 12:54:24 -0000
Received: (qmail 74705 invoked by uid 500); 12 Jan 2010 12:54:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74646 invoked by uid 500); 12 Jan 2010 12:54:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74636 invoked by uid 99); 12 Jan 2010 12:54:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 12:54:21 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 12:54:11 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id E588DCB658
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 07:53:50 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Tue, 12 Jan 2010 07:53:50 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=oy44p+JfqpS5MbmmQo9j8YE82pI=; b=nlSiQeN0qoKmPE16LXui1kqUVXa07E++I4sxsVnNPx3r9vrvAt0DEhAP+LYj0CC3W4pabvJV4rg927JovAcTJc5K2zNzGcQF1abH7j/xg9d6SLXAkx+20kCCmwrjQFMRogMwAlWnIDChNcZdjuCZFKp+wQXShBSgKfanpVkTU1c=
X-Sasl-enc: uGxkT1zDJufJQoNgJnYTpnwTki1M8UmcrqUEP9ViALun 1263300830
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 63E2A4AC6AF
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 07:53:50 -0500 (EST)
Message-ID: <4B4C70DD.4080501@fastmail.fm>
Date: Tue, 12 Jan 2010 12:53:49 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: NOT_ANALYSED_NO_NORMS should get max field length boost
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Lucene in Action says you can possibly use NOT_ANALYSED_NO_NORMS when 
indexing fields that arent tokenized, but later says norms are used to 
boost fields with less /single term, so matches based on these single 
term fields would miss out on this boost. Is there a way to use 
NOT_ANALYSED_NO_NORMS on these fields will will mean they end up with 
the best boost (1.0 as default) , and then documents that are analysed 
with norms receive a negative boost (<1.0) if they contain more than one 
token.

I'm not using Document or Field boosting, so seems a bit silly for me to 
store all these norms just to say this field contains a single token and 
therefore should get an addtional boost.

Perhaps Im misundersanding this, and this would work as required.


thanks Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44473-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 12:54:38 2010
Return-Path: <java-user-return-44473-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94697 invoked from network); 12 Jan 2010 12:54:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 12:54:38 -0000
Received: (qmail 76471 invoked by uid 500); 12 Jan 2010 12:54:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76400 invoked by uid 500); 12 Jan 2010 12:54:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76390 invoked by uid 99); 12 Jan 2010 12:54:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 12:54:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of benhei@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 12:54:28 +0000
Received: by fxm2 with SMTP id 2so20057822fxm.5
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 04:54:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=lr5l3EfGMg9Sa/peu9cBOHpZb3KvfBQFH6WvP0AwaLw=;
        b=VdbWVxE0KxLps+dg63qkzPSOYDfURUWmrh3qAx4LrG5zuXFHlBFd1AtvQASVDqbqHb
         WUWDRukSuibom5w53tVLzUZHzgnDket4nZoUIf3uyVkrqd0qDnQXxI0tqtDo+Jnsnhoe
         cmWUNo+Ytz6HzOuLZ3UUsK1Jj46VIWLZh/fFI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=aQRd/F9FDh3eEK+mCJc+KDFbk5cxv4hai1rhU1Z3SNZXoUrxnsB+L6D42UQP9t3rib
         SIOtTwQT2wjnWHRB9FJuk6hlpXv6HZAqTz/X9V6JkpCwtDwVwQfE3yZKM91WVFMixqn2
         K8oqnZ/dUS3RlgbXaH71I7xJseEjtDfatDzkk=
MIME-Version: 1.0
Received: by 10.223.2.69 with SMTP id 5mr11070707fai.88.1263300847933; Tue, 12 
	Jan 2010 04:54:07 -0800 (PST)
In-Reply-To: <4B4C5AE4.4060907@fastmail.fm>
References: <4B4C5AE4.4060907@fastmail.fm>
Date: Tue, 12 Jan 2010 13:54:07 +0100
Message-ID: <94095f521001120454s4f0e9b96mfb3456a2afeed7b7@mail.gmail.com>
Subject: Re: Lucene computes an automatic boost based on the number of tokens 
	in the field (shorter fields have a higher boost) ?
From: Benjamin Heilbrunn <benhei@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

This is because matches in short fields (few terms) als typically more
pregnant, than matches in long fields (much terms).

Imagine the case with two fields named "title" and "content"
representing the title and the content of books.
If you match three search terms in a five terms title this is a better
hit than if you match those three search terms in the content of the
book.

The length normalization factor is calculated by your Similarity
implementation in the method
public float lengthNorm(String fieldName, int numTokens)

Does that help you?

2010/1/12 Paul Taylor <paul_t100@fastmail.fm>:
>
>
> Why is this , and how much is this (in plain english ) please ?
>
> thanks Paul
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44474-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 13:17:34 2010
Return-Path: <java-user-return-44474-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6170 invoked from network); 12 Jan 2010 13:17:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 13:17:34 -0000
Received: (qmail 12371 invoked by uid 500); 12 Jan 2010 13:17:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12307 invoked by uid 500); 12 Jan 2010 13:17:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12297 invoked by uid 99); 12 Jan 2010 13:17:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 13:17:32 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 13:17:22 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 7B1B0CB8FC;
	Tue, 12 Jan 2010 08:16:59 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Tue, 12 Jan 2010 08:16:59 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=+oHafwXjNIuZSWbM098NZJJyKbs=; b=qark0ycxqPcd+CeI5VlhwKOO8fsBRhuxrKb/FRtlmDYLPl0huSr8Kvd2/Dn3U25uUYDKc2Jmu9hTsrTHFsouG6UCQYzZJTekJgzR5oGfMi7N/yjWAONGqGBcssqsr448u2kg6Vw4HIn1lOd8Ji4vwZANomMfHAPna3UNdSkls8k=
X-Sasl-enc: 7SDN8YaZQKlYXkdyZ7CxnY4lO6vNHJOYcQd5jW2fKl4w 1263302218
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id AC1214AD6C7;
	Tue, 12 Jan 2010 08:16:58 -0500 (EST)
Message-ID: <4B4C7649.1090305@fastmail.fm>
Date: Tue, 12 Jan 2010 13:16:57 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: Benjamin Heilbrunn <benhei@gmail.com>
CC: java-user@lucene.apache.org
Subject: Re: Lucene computes an automatic boost based on the number of tokens
 	in the field (shorter fields have a higher boost) ?
References: <4B4C5AE4.4060907@fastmail.fm> <94095f521001120454s4f0e9b96mfb3456a2afeed7b7@mail.gmail.com>
In-Reply-To: <94095f521001120454s4f0e9b96mfb3456a2afeed7b7@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Benjamin Heilbrunn wrote:
> This is because matches in short fields (few terms) als typically more
> pregnant, than matches in long fields (much terms).
>
> Imagine the case with two fields named "title" and "content"
> representing the title and the content of books.
> If you match three search terms in a five terms title this is a better
> hit than if you match those three search terms in the content of the
> book.
>
> The length normalization factor is calculated by your Similarity
> implementation in the method
> public float lengthNorm(String fieldName, int numTokens)
>
> Does that help you?
>
>   

Yes, thanks it does I was just getting it, is it base purely on matching 
a field with less terms rather than the percentage of terms in a field 
matched.
i.e If you match three search terms in a five terms field would this be 
better then if you match those four search terms in a six term field.


do you know the answer to my second post.
 i.e what does default lengthNorm return for a single term field, 
(compared to if have no NO NORM whereby assume value 1.0)

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44475-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 13:25:46 2010
Return-Path: <java-user-return-44475-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9700 invoked from network); 12 Jan 2010 13:25:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 13:25:45 -0000
Received: (qmail 26538 invoked by uid 500); 12 Jan 2010 13:25:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26452 invoked by uid 500); 12 Jan 2010 13:25:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26442 invoked by uid 99); 12 Jan 2010 13:25:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 13:25:43 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 13:25:35 +0000
Received: by ewy25 with SMTP id 25so1299065ewy.5
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 05:25:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=0a3Ca11faeD/s+uHg8xvx09+TMfDFNRbGUpZnTXB2j4=;
        b=VIt0fWZXs9IHdxrkm/M8NctRcf2/vca/hNB1ZTWBuFH5D86NMiQS0CDoXJeS26qJqd
         ApK5cTHD8l9bY0f9yWNOkSq7fFsjU/E+GzmDYcjNYNBvhPANGpgM1PvBeeSpg8/s4g1e
         85Qjl546yeA8SgV3zEx29ypf/2X/b5l3uHo+A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=EWuJn4X/xSX7hpoCMHwnZyG82U8HFq77XtJgu3n/Cf7NY5GPPm/KUjKwgBcUcCF8+u
         SkzlVl10tND8KEwYfTaAcSPxAW78C8yOINTA7vJmWZu0YHHk0vxcBFcERsbBq1mkm9Qx
         7j5I/qlOVWlA3kMpOuq+Zrn7ucGmscJNddSxY=
MIME-Version: 1.0
Received: by 10.216.86.137 with SMTP id w9mr2701103wee.104.1263302714962; Tue, 
	12 Jan 2010 05:25:14 -0800 (PST)
In-Reply-To: <4B4C70DD.4080501@fastmail.fm>
References: <4B4C70DD.4080501@fastmail.fm>
Date: Tue, 12 Jan 2010 08:25:14 -0500
Message-ID: <359a92831001120525t3037c3b6q91b77c16b7297f0f@mail.gmail.com>
Subject: Re: NOT_ANALYSED_NO_NORMS should get max field length boost
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=0016e6d7f07e91b1f6047cf79585
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d7f07e91b1f6047cf79585
Content-Type: text/plain; charset=ISO-8859-1

Are you saying that you index the *same* field differently in different
documents? Or do you index the field in question in the same way in
all documents?

I ask because I'm having a hard time following the logic here. A
field that is NOT analyzed is an all-or-none match, i.e.
looking for "paul" in an unanalyzed field "paul taylor" will
not match, so boosting is pretty irrelevant on that field.

If you're analyzing the same field for some documents and not
analyzing it for other documents, I don't know what happens, but
it's probably bad.

Could you boost your *other* fields by less than one to achieve
the same end?

If none of this is relevant, could you explain your use case a little
more?

HTH
Erick

On Tue, Jan 12, 2010 at 7:53 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:

> Lucene in Action says you can possibly use NOT_ANALYSED_NO_NORMS when
> indexing fields that arent tokenized, but later says norms are used to boost
> fields with less /single term, so matches based on these single term fields
> would miss out on this boost. Is there a way to use NOT_ANALYSED_NO_NORMS on
> these fields will will mean they end up with the best boost (1.0 as default)
> , and then documents that are analysed with norms receive a negative boost
> (<1.0) if they contain more than one token.
>
> I'm not using Document or Field boosting, so seems a bit silly for me to
> store all these norms just to say this field contains a single token and
> therefore should get an addtional boost.
>
> Perhaps Im misundersanding this, and this would work as required.
>
>
> thanks Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d7f07e91b1f6047cf79585--

From java-user-return-44476-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 13:28:06 2010
Return-Path: <java-user-return-44476-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11858 invoked from network); 12 Jan 2010 13:28:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 13:28:01 -0000
Received: (qmail 32931 invoked by uid 500); 12 Jan 2010 13:27:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32871 invoked by uid 500); 12 Jan 2010 13:27:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32861 invoked by uid 99); 12 Jan 2010 13:27:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 13:27:59 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 13:27:52 +0000
Received: by ewy25 with SMTP id 25so1301913ewy.5
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 05:27:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=K+gxUn5TnsuaLGt1DzSKUulzFgeDBluIKA2tGuid7i4=;
        b=HbCRA0lc9FfJtewJmWPryOg6gtp6PhZ1Y3NUkIzAZMb6SQFBX9WcT8rrkEtYxdGFyz
         IIJh6lE05p74c27QdmQuUq1L+WRfbobuKdO7nuVVr5IZvqE8lhXNYc8XBuDKVAdV2C7t
         CO1BJUtztpvgzcmX4UXEoPFmUFmzZ8yiHoF9E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ntClnqeMFZ+yQQaq02rotXsxvWfYtcFAnd28dRC24zVh2CELa5onba5D4//UMQ63lV
         GErsFvkze9dHhJbbpxdZjtacTQw80r7k1LereVhLCfOVxupSFeeea01lbNEHkKsmg30t
         5P5ixV3zh+AHJ8W+VGFC8aJbmPvPitJQi2qIg=
MIME-Version: 1.0
Received: by 10.216.89.193 with SMTP id c43mr22095wef.221.1263302850743; Tue, 
	12 Jan 2010 05:27:30 -0800 (PST)
In-Reply-To: <4B4C7649.1090305@fastmail.fm>
References: <4B4C5AE4.4060907@fastmail.fm>
	 <94095f521001120454s4f0e9b96mfb3456a2afeed7b7@mail.gmail.com>
	 <4B4C7649.1090305@fastmail.fm>
Date: Tue, 12 Jan 2010 08:27:30 -0500
Message-ID: <359a92831001120527q4d33bacbm47d406e2f757b571@mail.gmail.com>
Subject: Re: Lucene computes an automatic boost based on the number of tokens 
	in the field (shorter fields have a higher boost) ?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=0016e6d46d7da98e76047cf79d78

--0016e6d46d7da98e76047cf79d78
Content-Type: text/plain; charset=ISO-8859-1

I'd *strongly* recommend getting a copy of Luke, opening your index
with it and playing around. The "explain" tab will show you a *lot*
about how scoring works......

Erick

On Tue, Jan 12, 2010 at 8:16 AM, Paul Taylor <paul_t100@fastmail.fm> wrote:

> Benjamin Heilbrunn wrote:
>
>> This is because matches in short fields (few terms) als typically more
>> pregnant, than matches in long fields (much terms).
>>
>> Imagine the case with two fields named "title" and "content"
>> representing the title and the content of books.
>> If you match three search terms in a five terms title this is a better
>> hit than if you match those three search terms in the content of the
>> book.
>>
>> The length normalization factor is calculated by your Similarity
>> implementation in the method
>> public float lengthNorm(String fieldName, int numTokens)
>>
>> Does that help you?
>>
>>
>>
>
> Yes, thanks it does I was just getting it, is it base purely on matching a
> field with less terms rather than the percentage of terms in a field
> matched.
> i.e If you match three search terms in a five terms field would this be
> better then if you match those four search terms in a six term field.
>
>
> do you know the answer to my second post.
> i.e what does default lengthNorm return for a single term field, (compared
> to if have no NO NORM whereby assume value 1.0)
>
>
> Paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d46d7da98e76047cf79d78--

From java-user-return-44477-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 13:57:32 2010
Return-Path: <java-user-return-44477-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28350 invoked from network); 12 Jan 2010 13:57:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 13:57:32 -0000
Received: (qmail 82232 invoked by uid 500); 12 Jan 2010 13:57:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82185 invoked by uid 500); 12 Jan 2010 13:57:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82175 invoked by uid 99); 12 Jan 2010 13:57:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 13:57:30 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 13:57:21 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 86B5ECC37A;
	Tue, 12 Jan 2010 08:56:58 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Tue, 12 Jan 2010 08:56:58 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=4YmdM2mC8DvJqQV6bRLoIhK1mqE=; b=Heui7tCjQIn5Oxmtpz4tUf7dJfHrV/Zl1UozfgBnDpJGHpq0Tsm7JIf+Z5f7HGRf7iK62I8KhE9d+2ImoS4k/cMHMqbherPGQ/kLoGFePuFKbF1di+z0qf/yVDGRsLOFw/L9QHQWuYkLvg9lDQa4vBy5lWilAU3N+jLE+NEjXV0=
X-Sasl-enc: vDVQeMTMHwY8obb6QaT5XCAJ23Pv1OgPXc68HhhPw9AL 1263304614
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id ED4044AD75D;
	Tue, 12 Jan 2010 08:56:53 -0500 (EST)
Message-ID: <4B4C7FA5.9050406@fastmail.fm>
Date: Tue, 12 Jan 2010 13:56:53 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: Erick Erickson <erickerickson@gmail.com>
CC: java-user@lucene.apache.org
Subject: Re: NOT_ANALYSED_NO_NORMS should get max field length boost
References: <4B4C70DD.4080501@fastmail.fm> <359a92831001120525t3037c3b6q91b77c16b7297f0f@mail.gmail.com>
In-Reply-To: <359a92831001120525t3037c3b6q91b77c16b7297f0f@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Erick Erickson wrote:
> Are you saying that you index the *same* field differently in different
> documents? Or do you index the field in question in the same way in
> all documents?
Same way in all documents
>
> I ask because I'm having a hard time following the logic here. A
> field that is NOT analyzed is an all-or-none match, i.e.
> looking for "paul" in an unanalyzed field "paul taylor" will
> not match, so boosting is pretty irrelevant on that field.
>
But if it does match won't this affect the end score

i.e, consider Doc 1 has unalysed field containing fred and Doc 2 
analysed field contain tom sawyer
and this search unalysedfield:fred OR analysedfield:tom

If it had norms, Doc1 would come first , but without norms they would be 
joint first right ?

>
> Could you boost your *other* fields by less than one to achieve
> the same end?
What are the values, what is the value given to a single field norm boosted

Paul


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44478-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 14:12:33 2010
Return-Path: <java-user-return-44478-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38006 invoked from network); 12 Jan 2010 14:12:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 14:12:33 -0000
Received: (qmail 17431 invoked by uid 500); 12 Jan 2010 14:12:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17380 invoked by uid 500); 12 Jan 2010 14:12:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17370 invoked by uid 99); 12 Jan 2010 14:12:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 14:12:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lucener@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 14:12:18 +0000
Received: by pxi16 with SMTP id 16so7451199pxi.29
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 06:11:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=UuqdIqUdFHJ1BCrcIdqtc4is7VlhsKItA4djb+qFoso=;
        b=SHsDVBnhBoT5VYzuX0D30EC7/dR39CloXqYayt6Fx7emZXqsb3a0/Hy5bOUDywjBzL
         2FUyEaSryfi+13Vd5Ty3m286Mk79Jpqu4Df8Sj5t3Rw1jvnkUBMqTY7/Og6K04MZ9T4O
         VyCLZQdLwqcD6iRBb0bWQugorzrd3ACnKXe/g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=kAcHqSzqYsBOct2TV4Wy8pQxf5CIQlFMjohGJqn9RauND4x+CES/UC971N0plW9rF9
         whtqOCoNp+a6Mkoujrz5OG2SvPg3innGkg+GYrXwCPxXMR/FWgOeE+tTZ29mQDf30Qgm
         CMMqZMLf16Wbe1+h0/WdUKdMk3ss/57BXJSQE=
MIME-Version: 1.0
Received: by 10.115.80.6 with SMTP id h6mr4467626wal.108.1263305517484; Tue, 
	12 Jan 2010 06:11:57 -0800 (PST)
In-Reply-To: <d483d31b1001080216m566d2698m6e7bb0f2586c6446@mail.gmail.com>
References: <d483d31b1001070628j495cc18dka6a4da7687a71ec0@mail.gmail.com>
	 <d483d31b1001071254w6d50eb02r5a65b7ed087a0b07@mail.gmail.com>
	 <164574.66783.qm@web50305.mail.re2.yahoo.com>
	 <d483d31b1001071555hb2fcb91obf7d40defbb6f53a@mail.gmail.com>
	 <769800.190.qm@web50307.mail.re2.yahoo.com>
	 <d483d31b1001080216m566d2698m6e7bb0f2586c6446@mail.gmail.com>
Date: Tue, 12 Jan 2010 09:11:55 -0500
Message-ID: <882004011001120611h4602d647mb1822c1453b8af06@mail.gmail.com>
Subject: Re: Implementing filtering based on multiple fields
From: Lucifer Hammer <lucener@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64dc8fe9cca21047cf83cdf
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64dc8fe9cca21047cf83cdf
Content-Type: text/plain; charset=ISO-8859-1

Why not just add custom terms onto the end of each query for each user?
i.e.  When user X queries for "bananas", and has previously set their
domains to search in cnn, and yahoo, then why not append the following onto
the search query:   "fullText:bananas AND (domain:cnn OR domain:yahoo)"

Off the top of my head there's a few caveats:

1) if the domain list is large, you'll have to deal with the maxbooleans
setting
2) parsing the query can be slow, however, there's a tradeoff between
managing thousands of indexes vs a slight performance hit (Or, you can put
the query together without parsing - depends on how you handle the users
query terms)

This seems like too simple an approach, I'm sure I'm not understanding
something...

LH
On Fri, Jan 8, 2010 at 5:16 AM, Yaniv Ben Yosef <yanivby@gmail.com> wrote:

> Thanks Otis, that's very helpful.
>
> On Fri, Jan 8, 2010 at 2:08 AM, Otis Gospodnetic <
> otis_gospodnetic@yahoo.com
>  > wrote:
>
> > Ah, well, masking it didn't help.  Yes, ignore Bixo, Nutch, and Droids
> > then.
> > Consider DataImportHandler from Solr or wait a bit for Lucene Connectors
> > Framework to materialize.  Or use LuSql, or DbSight, or Sematext's
> Database
> > Indexer.
> >
> > Yes, I was suggesting a separate index for each user.  That's what Simpy
> > uses and has some 200K indices on 1 box.... and I think dozens of QPS
> > without any caching, if I remember correctly.  Load is under 1.0.
> >
> > Otis
> > --
> > Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> >
> >
> >
> > ----- Original Message ----
> > > From: Yaniv Ben Yosef <yanivby@gmail.com>
> > > To: java-user@lucene.apache.org
> > > Sent: Thu, January 7, 2010 6:55:18 PM
> > > Subject: Re: Implementing filtering based on multiple fields
> > >
> > > Thanks Otis.
> > >
> > > If I understand correctly - Bixo, Nutch and Droids are technologies to
> > use
> > > for crawling the web and building an index. My project is actually
> about
> > > indexing a large database, where you can think of every row as a web
> > page,
> > > and a particular column is the equivalent of a web site. (I didn't
> > mention
> > > that in the previous post because I didn't want to complicate my
> > question,
> > > and it seems equivalent to Google CSE given that Lucene can use
> virtually
> > > any input for indexing, AFAIK)
> > > Therefore I'm not sure if the frameworks you've mentioned are
> applicable
> > to
> > > my project as they seem to be related to web page indexing, but perhaps
> > I'm
> > > missing something.
> > > Also, what did you mean about isolating users and their data/indices.
> Did
> > > you mean that I should create a separate index per user?
> > >
> > > Thanks again!
> > >
> > > On Fri, Jan 8, 2010 at 12:35 AM, Otis Gospodnetic <
> > > otis_gospodnetic@yahoo.com> wrote:
> > >
> > > > For something like CSE, I think you want to isolate users and their
> > > > data/indices.
> > > >
> > > > I'd look at Bixo or Nutch or Droids ==> Lucene or Solr
> > > >
> > > > Otis
> > > > --
> > > > Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> > > >
> > > >
> > > >
> > > > ----- Original Message ----
> > > > > From: Yaniv Ben Yosef
> > > > > To: java-user@lucene.apache.org
> > > > > Sent: Thu, January 7, 2010 3:54:22 PM
> > > > > Subject: Implementing filtering based on multiple fields
> > > > >
> > > > > Hi,
> > > > >
> > > > > I'm very new to Lucene. In fact, I'm at the beginning of an
> > evaluation
> > > > > phase, trying to figure whether Lucene is the right fit for my
> needs.
> > > > > The project I'm involved in requires something similar to the
> Google
> > > > Custom
> > > > > Search Engine (CSE). In CSE, each user can
> > > > > define a set (could be a large set) of websites, and limit the
> search
> > to
> > > > > only those websites. So for example, I can create a CSE that
> searches
> > all
> > > > > web pages on cnn.com, msnbc.com and nytimes.com only.
> > > > > I am trying to understand whether and how I can do something
> similar
> > in
> > > > > Lucene.
> > > > >
> > > > > The FAQ hints about this possibility
> > > > > here,
> > > > > but it mentions a class that no longer exists in 3.0 (QueryFilter),
> > and
> > > > is
> > > > > very laconic about the suggested options. Also I'm not sure how
> well
> > it
> > > > will
> > > > > perform in my use case (or even if it fits at all).
> > > > > I thought about creating a separate index for each user or CSE.
> > However,
> > > > my
> > > > > system should be able to handle tens of thousands of concurrent
> > users. I
> > > > > haven't done any analysis yet on how this will affect CPU, RAM, I/O
> > and
> > > > > storage size, but was wondering if any of you experienced Lucene
> > > > > users/developers think it's a good direction.
> > > > > If that's not a good idea, what would be a good strategy here?
> > > > >
> > > > > Any help will be much appreciated,
> > > > > Yaniv
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--0016e64dc8fe9cca21047cf83cdf--

From java-user-return-44479-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 14:49:51 2010
Return-Path: <java-user-return-44479-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56916 invoked from network); 12 Jan 2010 14:49:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 14:49:51 -0000
Received: (qmail 68465 invoked by uid 500); 12 Jan 2010 14:49:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68375 invoked by uid 500); 12 Jan 2010 14:49:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68365 invoked by uid 99); 12 Jan 2010 14:49:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 14:49:48 +0000
X-ASF-Spam-Status: No, hits=-1.8 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Sourabh-931.Mittal@morganstanley.com designates 205.228.53.68 as permitted sender)
Received: from [205.228.53.68] (HELO hqmtaint01.ms.com) (205.228.53.68)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 14:49:39 +0000
Received: from hqmtaint01 (localhost.ms.com [127.0.0.1])
	by hqmtaint01.ms.com (output Postfix) with ESMTP id 9218D88C50E
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 09:49:18 -0500 (EST)
Received: from ny0019as02 (unknown [144.203.210.133])
	by hqmtaint01.ms.com (internal Postfix) with ESMTP id 68EDFB00031
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 09:49:18 -0500 (EST)
Received: from ny0019as02 (localhost [127.0.0.1])
	by ny0019as02 (msa-out Postfix) with ESMTP id 4719E700275
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 09:49:18 -0500 (EST)
Received: from NPWEXGOB01.msad.ms.com (np210c1n1 [10.184.90.162])
	by ny0019as02 (mta-in Postfix) with ESMTP id 43D042B4036
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 09:49:18 -0500 (EST)
Received: from tiwexcat02.msad.ms.com (161.144.143.23) by NPWEXGOB01.msad.ms.com (10.184.90.162) with Microsoft SMTP Server (TLS) id 8.1.393.1; Tue, 12 Jan 2010 09:49:16 -0500
Received: from TIWEXMBX13.msad.ms.com ([161.144.143.14]) by tiwexcat02.msad.ms.com ([161.144.143.23]) with mapi; Tue, 12 Jan 2010 20:19:13 +0530
From: "Mittal, Sourabh" <Sourabh-931.Mittal@morganstanley.com>
To: <java-user@lucene.apache.org>
Date: Tue, 12 Jan 2010 20:19:11 +0530
Subject: 2 directory providers
Content-Transfer-Encoding: 7bit
Thread-Topic: 2 directory providers
thread-index: AcqTlluir0lwBQ8cQ5Ww3Heq0wbmuA==
Message-ID: <1300652D509D7648AE48E69A0CC7E416021DCADAE7@TIWEXMBX13.msad.ms.com>
Accept-Language: en-US
Content-Language: en-US
Content-Class: urn:content-classes:message
Importance: normal
Priority: normal
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.4325
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: multipart/alternative;
	boundary="_000_1300652D509D7648AE48E69A0CC7E416021DCADAE7TIWEXMBX13msa_"
MIME-Version: 1.0
X-Anti-Virus: Kaspersky Anti-Virus for MailServers 5.5.35/RELEASE, bases: 12012010 #3082005, status: clean

--_000_1300652D509D7648AE48E69A0CC7E416021DCADAE7TIWEXMBX13msa_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi,

Is it possible to have 2 directory providers in a application like RAM =
as well as File Directory?

Regards,
Sourabh

-------------------------------------------------------------------------=
-
NOTICE: If received in error, please destroy, and notify sender. Sender =
does not intend to waive confidentiality or privilege. Use of this email =
is prohibited when received in error. We may monitor and store emails to =
the extent permitted by applicable law.

--_000_1300652D509D7648AE48E69A0CC7E416021DCADAE7TIWEXMBX13msa_--

From java-user-return-44480-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 16:02:58 2010
Return-Path: <java-user-return-44480-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81003 invoked from network); 12 Jan 2010 16:02:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 16:02:58 -0000
Received: (qmail 87315 invoked by uid 500); 12 Jan 2010 16:02:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87229 invoked by uid 500); 12 Jan 2010 16:02:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87219 invoked by uid 99); 12 Jan 2010 16:02:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 16:02:55 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 16:02:45 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUjCK-0003xA-M7
	for java-user@lucene.apache.org; Tue, 12 Jan 2010 08:02:24 -0800
Message-ID: <27129835.post@talk.nabble.com>
Date: Tue, 12 Jan 2010 08:02:24 -0800 (PST)
From: Frank Geary <fgeary@acquiremedia.com>
To: java-user@lucene.apache.org
Subject: Re: Index corruption using Lucene 2.4.1 - thread safety issue?
In-Reply-To: <9ac0c6aa1001120101o77c9e0b9i74ad0e76b59063ad@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: fgeary@acquiremedia.com
References: <27115515.post@talk.nabble.com> <9ac0c6aa1001120101o77c9e0b9i74ad0e76b59063ad@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks for the reply Mike.  Your questions were good ones because I realize
now I should have probably used "Corrupt IndexReader" as the subject for
this thread.  Here's my answers:

The number stays the same until the corrupted IndexReader is reopened (if
nothing changes in the IndexReader - and thus we get the same IndexReader
back from reopen - the problem persists).  Then the next time the problem
occurs, after we've gotten at least one non-problematic IndexReader and thu=
s
a few successful searches, the number is different.  For what it's worth my
latest ### was 176.  My assumption has always been that it is most likely t=
o
be 1 beyond the end of the BitVector because each commit() is only changing
the index by adding or deleting one document.  But I don't know for sure.

Yes, I had always expected that reopen during commit would be fine, and my
semaphore code seems to confirm that (unless adds have something very subtl=
e
to do with it).  Any other theories would be very much appreciated.

At first I wasn't sure whether it was the RAMDirectory or the main dir.  Bu=
t
since I now have many examples where the RAMDirectory IndexReader has
changed and the main dir IndexReader has not, then I feel that the
RAMDirectory IndexReader is the problem.  We reopen a new IndexReader every
time we do a search on a RAMDirectory.  For the main dir, we rarely reopen
an IndexReader.  We only reopen the main dir IndexReader when a RAM
Directory is gotten rid of, which happens once the RAM directory indexes
10000 documents.  But here's a typical example where the main dir
IndexReader stays the same throughout the problem:

1) both the RAMDirectory IndexReader and the main dir IndexReader are set
after the last time we got rid of the RAMDirectory which was full with 1000=
0
documents.
2) then we receive about 1077 new documents and add them to the RAMDirector=
y
as well as to the main dir indexes (with a number of deletes scattered
throughout as well).  The RAM directory is commited after every add or
delete and the main dir is not committed at all.
3) then a search comes in, we reopen the RAM Directoy IndexReader, use the
existing main dir IndexReader (which does not reflect any index changes
since step 1) and do the search and get ArrayIndexOutOfBounds so the search
fails (in this case the ### was 208)
4) then we simply go one and get another 4000 adds and deletes in the RAM
directory and main directory.  Again the RAM directory is commited after
every add or delete and the main dir is not committed at all.
5) then the next search comes in, reopens the RAMDirectory IndexReader, use=
s
the existing main dir IndexReader (which does not reflect any index changes
since step 1) and the search works fine!
6) during all that time the main dir IndexReader never got reopened, and th=
e
RAMDirectory IndexReader only got reopened twice - once it was bad and the
next it was OK.

To answer your question about when we periodically move our in-RAM changes
to the disk index (my apologies if this is redundant):
We never move them.  They are duplicated in both the RAM directory and
on-disk directory as they come in.  Then when the RAM directory determines
that it has 10000 documents, we begin writing to a second RAM Directory,
reopen and warmup the on-disk IndexReader and once that new on-disk
IndexReader is ready, we throw away the RAM directory which had 10000
documents (to do this we actually clean out the RAM directory by deleting
all the files it contains and we create a new IndexWriter using that same
RAMDirectory object).  Then we continue writing to that second RAMdirectory
and the on-disk index until the second RAM directory has 10000 documents.=
=20
And repeat.

We have NOT run CheckIndex on the RAM directory mainly because this mostly
happens in our production environment which has very high traffic and I'd
have to write some special code to set aside a bad RAMDirectory index, etc
to run the CheckIndex on it.  Just not an easy thing to do.

I can look into enabling asserts.  That may help.

Finally, for the RAM directory, we must create a new IndexWriter everytime
"clean out" the RAM directory after we reach the 10000 documents limit.  We
clean out the RAM directory by deleting all the files it contains and we
then create a new IndexWriter using that same RAMDirectory object.  If ther=
e
was a reopen for an IndexWriter, we'd use that instead.  For the on-disk
directory, the IndexWriter never changes and we reopen the IndexReader each
time a RAM directory reaches the 10000 document limit.

Any further thoughts or ideas?  Thanks again for your help Mike!

Frank
=20

Michael McCandless-2 wrote:
>=20
> Not good!  Can you post the ###'s from the exception?  How far out of
> bounds is the access?
>=20
> Your usage sounds fine.  Reopen during commit is fine.
>=20
> Are you sure the exception comes from the reader on the RAMDir and not
> your main dir?
>=20
> How do you periodically move your in-RAM changes to the disk index?
>=20
> Have you run CheckIndex on your index?  Also, try running with asserts
> enabled... it may catch whatever is happening, sooner.
>=20
> Do you hold open a single IW on the RAMDir, and re-use it?  Or open
> and then close?  What about the disk dir?
>=20
> Mike
>=20
> On Mon, Jan 11, 2010 at 1:42 PM, Frank Geary <fgeary@acquiremedia.com>
> wrote:
>>
>> Hi,
>>
>> I'm using Lucene 2.4.1 and am seeing occasional index corruption. =C2=A0=
It
>> shows
>> up when I call MultiSearcher.search(). =C2=A0MultiSearcher.search() thro=
ws the
>> following exception:
>>
>> ArrayIndexOutOfBoundsException. =C2=A0The error is: Array index out of r=
ange:
>> ###
>> where ### is a number representing an index into the deletedDocs
>> BitVector
>> in SegmentTermDocs. =C2=A0the stack trace is as follows:
>>
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.util.BitVector.get(BitVector.java:91)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:125)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.index.MultiSegmentReader$MultiTermDocs.next(MultiSegme=
ntReader.java:554)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.FieldCacheImpl$10.createValue(FieldCacheImpl.ja=
va:384)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:71=
)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.FieldCacheImpl.getStringIndex(FieldCacheImpl.ja=
va:351)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.FieldSortedHitQueue.comparatorString(FieldSorte=
dHitQueue.java:415)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.FieldSortedHitQueue$1.createValue(FieldSortedHi=
tQueue.java:206)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:71=
)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.FieldSortedHitQueue.getCachedComparator(FieldSo=
rtedHitQueue.java:167)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.FieldSortedHitQueue.<init>(FieldSortedHitQueue.=
java:55)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.TopFieldDocCollector.<init>(TopFieldDocCollecto=
r.java:43)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:122)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.MultiSearcher.search(MultiSearcher.java:232)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> org.apache.lucene.search.Searcher.search(Searcher.java:86)
>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>> com.acquiremedia.opens.index.searcher.HybridIndexSearcher.search(HybridI=
ndexSearcher.java:311)
>> .
>> .
>> .
>>
>> That makes sense, but I'm trying to understand what could be causing the
>> corruption.
>>
>> Here's what I'm doing:
>>
>> 1) I have an IndexWriter created usnig a RAMDirectory.
>>
>> 2) I have a single thread processing index adds and index deletes. =C2=
=A0This
>> thread is rather simple and calls IndexWriter.addDocument() followed by
>> IndexWriter.commit() or IndexWriter.deleteDocuments() followed by
>> IndexWriter.commit(). =C2=A0The commits are done at this point because w=
e want
>> the documents available for searching immediately.
>>
>> 3) I also have 4 search threads running at the same time as the index
>> write
>> thread. =C2=A0Each time a search thread executes a search it calls
>> IndexReader.reopen() =C2=A0on the existing IndexReader for the index cre=
ated
>> using the RAMDirectory above, gets an existing index reader for another
>> on-disk index and then calls MultiSearcher.search() (this brings togethe=
r
>> the RamDirectory index and an on-disk index) to execute the search.
>>
>> It generally works fine, but every few days or so I get the above
>> ArrayIndexOutOfBoundsException. =C2=A0 My suspicion is that when the
>> IndexWritert.commit() call happens due to a delete at the exact same tim=
e
>> as
>> the IndexReader.reopen() call happens, the IndexReader has a deleteDocs
>> BitVector which reflects the delete, but something else internal to the
>> IndexReader is not reflecting the delete.
>>
>> So, I implemented a semaphore mechanism to prevent IndexWriter.commit()
>> from
>> happening at the same time as IndexReader.reopen(). =C2=A0I only impleme=
nted
>> the
>> semaphores in the delete case because my guess was that an add would be
>> unlikely to affect the deleteDocs Bit Vector. =C2=A0Unfortunately, the p=
roblem
>> continues to happen.
>>
>> I believe I read somewhere that a similar thread saftey issue had been
>> fixed
>> in Lucene 2.4, but I suspect there may still be an issue in 2.4.1.
>>
>> Does anyone have any knowledge or insight into what I may be doing wrong
>> or
>> how I can correct/avoid the problem? =C2=A0Upgrading to Lucene 3.0 or us=
ing
>> Solr
>> are not really options for me at least in the short term.
>>
>> Thanks for any information you can provide!
>>
>> Frank
>> --
>> View this message in context:
>> http://old.nabble.com/Index-corruption-using-Lucene-2.4.1---thread-safet=
y-issue--tp27115515p27115515.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/Index-corruption-using-=
Lucene-2.4.1---thread-safety-issue--tp27115515p27129835.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44481-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 16:16:41 2010
Return-Path: <java-user-return-44481-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85424 invoked from network); 12 Jan 2010 16:16:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 16:16:41 -0000
Received: (qmail 13478 invoked by uid 500); 12 Jan 2010 16:16:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13414 invoked by uid 500); 12 Jan 2010 16:16:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13401 invoked by uid 99); 12 Jan 2010 16:16:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 16:16:38 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=MIME_BASE64_BLANKS,MIME_BASE64_TEXT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of anshumg@gmail.com designates 209.85.211.184 as permitted sender)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 16:16:29 +0000
Received: by ywh14 with SMTP id 14so21085537ywh.20
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 08:16:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:x-rim-org-msg-ref-id
         :message-id:content-transfer-encoding:reply-to:x-priority:references
         :in-reply-to:sensitivity:importance:subject:to:from:date
         :content-type:mime-version;
        bh=5KROSvqojykbjvBZjX0WomTXgYLSx76CWZiHvArX/Tg=;
        b=l+TWgQ7Xct0awrlXPvrFDL0dH5X49gZxidMhj1LX8glXdp+/2HchcgLCIAnWy9RRJH
         gtQpjyOqSFLUjahUWWyk5HKcM6XiQpfG2lgMMfUM6yYznC1DvmmqtoC/sl6I+R2lIJHy
         cxw4z5zi10YJu/LNbR1UJ3N5pEHtPXWBBd7WI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=x-rim-org-msg-ref-id:message-id:content-transfer-encoding:reply-to
         :x-priority:references:in-reply-to:sensitivity:importance:subject:to
         :from:date:content-type:mime-version;
        b=kYOU/SbIASQB+8JbBjXklHIuF6wvGxSxKiwjJeprpVN3n08woveqf1rJlVLxk47INe
         Y6L2mgsnheuqfyu4hxA3c6WCro9WePz7gkiRNew67bhvomNGQ+faeFYdQMLw7XBbV4gx
         dnYIG/sSNg7kzAKPqvKs4USvlxkzEHi3mb3mw=
Received: by 10.90.13.27 with SMTP id 27mr5618362agm.28.1263312968577;
        Tue, 12 Jan 2010 08:16:08 -0800 (PST)
Received: from bda029.bisx.produk.on.blackberry (bda-68-171-237-231.bise.eu.blackberry.com [68.171.237.231])
        by mx.google.com with ESMTPS id 15sm12538907gxk.4.2010.01.12.08.16.07
        (version=SSLv3 cipher=RC4-MD5);
        Tue, 12 Jan 2010 08:16:07 -0800 (PST)
X-rim-org-msg-ref-id:802492870
Message-ID:<802492870-1263312965-cardhu_decombobulator_blackberry.rim.net-672010248-@bda130.bisx.produk.on.blackberry>
Content-Transfer-Encoding: base64
Reply-To: anshumg@gmail.com
X-Priority: Normal
References: <1300652D509D7648AE48E69A0CC7E416021DCADAE7@TIWEXMBX13.msad.ms.com>
In-Reply-To: <1300652D509D7648AE48E69A0CC7E416021DCADAE7@TIWEXMBX13.msad.ms.com>
Sensitivity: Normal
Importance: Normal
Subject: Re: 2 directory providers
To: java-user@lucene.apache.org
From: "anshum.gupta@naukri.com" <anshumg@gmail.com>
Date: Tue, 12 Jan 2010 16:16:03 +0000
Content-Type: text/plain; charset="Windows-1252"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgU291cmFiaCwNCklmIHlvdSBhcmUgdGFsa2luZyBhYm91dCB1c2luZyBtdWx0aXBsZSBkaXJl
Y3RvcnkgaW1wbGVtZW50YXRpb25zLCB0aGVuIHllcyB5b3UgbWF5IGhhdmUgbXVsdGlwbGUgb2Yg
dGhvc2Ugd2l0aG91dCBhbnkgaXNzdWVzLg0KDQpTZW50IGZyb20gQmxhY2tCZXJyea4gb24gQWly
dGVsDQoNCi0tLS0tT3JpZ2luYWwgTWVzc2FnZS0tLS0tDQpGcm9tOiAiTWl0dGFsLCBTb3VyYWJo
IiA8U291cmFiaC05MzEuTWl0dGFsQG1vcmdhbnN0YW5sZXkuY29tPg0KRGF0ZTogVHVlLCAxMiBK
YW4gMjAxMCAyMDoxOToxMSANClRvOiA8amF2YS11c2VyQGx1Y2VuZS5hcGFjaGUub3JnPg0KU3Vi
amVjdDogMiBkaXJlY3RvcnkgcHJvdmlkZXJzDQoNCkhpLA0KDQpJcyBpdCBwb3NzaWJsZSB0byBo
YXZlIDIgZGlyZWN0b3J5IHByb3ZpZGVycyBpbiBhIGFwcGxpY2F0aW9uIGxpa2UgUkFNIGFzIHdl
bGwgYXMgRmlsZSBEaXJlY3Rvcnk/DQoNClJlZ2FyZHMsDQpTb3VyYWJoDQoNCi0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tDQpOT1RJQ0U6IElmIHJlY2VpdmVkIGluIGVycm9yLCBwbGVhc2UgZGVzdHJveSwgYW5k
IG5vdGlmeSBzZW5kZXIuIFNlbmRlciBkb2VzIG5vdCBpbnRlbmQgdG8gd2FpdmUgY29uZmlkZW50
aWFsaXR5IG9yIHByaXZpbGVnZS4gVXNlIG9mIHRoaXMgZW1haWwgaXMgcHJvaGliaXRlZCB3aGVu
IHJlY2VpdmVkIGluIGVycm9yLiBXZSBtYXkgbW9uaXRvciBhbmQgc3RvcmUgZW1haWxzIHRvIHRo
ZSBleHRlbnQgcGVybWl0dGVkIGJ5IGFwcGxpY2FibGUgbGF3Lg0KDQo=



From java-user-return-44482-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 16:42:50 2010
Return-Path: <java-user-return-44482-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92946 invoked from network); 12 Jan 2010 16:42:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 16:42:49 -0000
Received: (qmail 48424 invoked by uid 500); 12 Jan 2010 16:42:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48327 invoked by uid 500); 12 Jan 2010 16:42:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48159 invoked by uid 99); 12 Jan 2010 16:42:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 16:42:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of michael.wechner@wyona.com designates 195.226.6.75 as permitted sender)
Received: from [195.226.6.75] (HELO server1.example.com) (195.226.6.75)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 16:42:35 +0000
Received: from michael-wechners-macbook-pro.local (unknown [195.226.6.66])
	by server1.example.com (Postfix) with ESMTP id 6747610C995;
	Tue, 12 Jan 2010 17:52:57 +0100 (CET)
Message-ID: <4B4CA666.7020109@wyona.com>
Date: Tue, 12 Jan 2010 17:42:14 +0100
From: Michael Wechner <michael.wechner@wyona.com>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org, java-dev@lucene.apache.org
Subject: [JOB] Java/Lucene/Nutch developer in Zurich, Switzerland
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Dear Developers

We are looking for Java/Lucene/Nutch developers with over 2-3 years of 
experience for a
project we are currently working on.

The location is Zurich, Switzerland onsite and the job is as employee or 
contractor.

Please reply me privately with your contact details and experience with 
Lucene/Nutch

Thanks

Michael

michael.wechner@wyona.com, +41 44 272 91 61

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44483-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 17:48:34 2010
Return-Path: <java-user-return-44483-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28058 invoked from network); 12 Jan 2010 17:48:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 17:48:34 -0000
Received: (qmail 62016 invoked by uid 500); 12 Jan 2010 17:48:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61955 invoked by uid 500); 12 Jan 2010 17:48:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61945 invoked by uid 99); 12 Jan 2010 17:48:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 17:48:32 +0000
X-ASF-Spam-Status: No, hits=0.6 required=10.0
	tests=MISSING_HEADERS,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 17:48:23 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id E1A17CC515
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 12:47:58 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Tue, 12 Jan 2010 12:47:58 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:cc:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=G/6x+x9W8ZnhSqgnLny7Zn+884s=; b=C8PqEc0nKNN4I8iNvjS/nVHFoN92doOhd4eNpO7p7KX6R/knsOCF0ZqULKp6N+yY04HNHvXnUpLyotfmNZLHZBd0rIg6aVEVVgCEhE2gAst9MVo5YsirHhNMLMsck6KFTmh/ErjR6cxz+9nsSewwtinPfx0zHoS/GGpv7kP8RQ8=
X-Sasl-enc: y7i9LocA4595kKA5RmKIHLHZ1nt3Saqg3alDV+RUDB8w 1263318478
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 2F8CB4AD999
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 12:47:58 -0500 (EST)
Message-ID: <4B4CB5CD.6030708@fastmail.fm>
Date: Tue, 12 Jan 2010 17:47:57 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
CC: java-user@lucene.apache.org
Subject: Re: NOT_ANALYSED_NO_NORMS should get max field length boost
References: <4B4C70DD.4080501@fastmail.fm> <359a92831001120525t3037c3b6q91b77c16b7297f0f@mail.gmail.com>
In-Reply-To: <359a92831001120525t3037c3b6q91b77c16b7297f0f@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit


> On Tue, Jan 12, 2010 at 7:53 AM, Paul Taylor <paul_t100@fastmail.fm 
> <mailto:paul_t100@fastmail.fm>> wrote:
>
>     Lucene in Action says you can possibly use NOT_ANALYSED_NO_NORMS
>     when indexing fields that arent tokenized, but later says norms
>     are used to boost fields with less /single term, so matches based
>     on these single term fields would miss out on this boost. Is there
>     a way to use NOT_ANALYSED_NO_NORMS on these fields will will mean
>     they end up with the best boost (1.0 as default) , and then
>     documents that are analysed with norms receive a negative boost
>     (<1.0) if they contain more than one token.
>
>     I'm not using Document or Field boosting, so seems a bit silly for
>     me to store all these norms just to say this field contains a
>     single token and therefore should get an addtional boost.
>
>     Perhaps Im misundersanding this, and this would work as required.
>
>
>     thanks Paul
>
FYI Looking at DefaultSimailarity() the lengthNorm is 1/sqrt(numTerms), 
so for one term would equal 1. i.e. the same as not having norms, so 
AFAIK there is no difference after all if not using Document or field 
boosting

Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44484-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 18:30:13 2010
Return-Path: <java-user-return-44484-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54639 invoked from network); 12 Jan 2010 18:30:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 18:30:13 -0000
Received: (qmail 36448 invoked by uid 500); 12 Jan 2010 18:30:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36358 invoked by uid 500); 12 Jan 2010 18:30:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36344 invoked by uid 99); 12 Jan 2010 18:30:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 18:30:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [198.147.195.5] (HELO flicker.bmc.com) (198.147.195.5)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 12 Jan 2010 18:30:04 +0000
Received: by flicker.bmc.com (Postfix, from userid 13749)
	id 39D5D1E6572; Tue, 12 Jan 2010 11:30:35 -0700 (MST)
Received: from PHX-HTPRD-02.adprod.bmc.com (phx-htprd-02.adprod.bmc.com [172.24.32.8])
	by flicker.bmc.com (Postfix) with ESMTP id 318C21E656C
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 11:30:35 -0700 (MST)
Received: from PHXCCRPRD02.adprod.bmc.com ([172.24.32.181]) by
 PHX-HTPRD-02.adprod.bmc.com ([172.24.32.8]) with mapi; Tue, 12 Jan 2010
 12:29:07 -0600
From: "Woolf, Ross" <Ross_Woolf@BMC.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 12 Jan 2010 12:28:22 -0600
Subject: Exception invoking MultiPhraseQuery
Thread-Topic: Exception invoking MultiPhraseQuery
Thread-Index: AcqTpjVSl2cL5SnVQomkCQ8RZTgMHgADiO6A
Message-ID: <492379B6AA909E4FAF672AACCA0EADC24A33B513FA@PHXCCRPRD02.adprod.bmc.com>
References: <4B4CA666.7020109@wyona.com>
In-Reply-To: <4B4CA666.7020109@wyona.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-cr-hashedpuzzle: rjk= AEUx AmOz AwJq BAje Bgg3 B466 C1te GRX8 Gvr+ HAL0
 HsDg H30j H7il IblZ
 JPMn;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{478DC9DC-B5AC-4DDE-A699-C72BED07C93B};cgBvAHMAcwBfAHcAbwBvAGwAZgBAAGIAbQBjAC4AYwBvAG0A;Tue,
 12 Jan 2010 18:28:22
 GMT;RQB4AGMAZQBwAHQAaQBvAG4AIABpAG4AdgBvAGsAaQBuAGcAIABNAHUAbAB0AGkAUABoAHIAYQBzAGUAUQB1AGUAcgB5AA==
x-cr-puzzleid: {478DC9DC-B5AC-4DDE-A699-C72BED07C93B}
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

I can't invoke MultiPhraseQuery.  It produces the error:
com.sun.jdi.InvocationException occurred invoking method

Here is the code:
MultiPhraseQuery mpq =3D new MultiPhraseQuery();

In the eclipse debugger when I try to inspect mpq after instantiating it sh=
ows the error.

I'm on Lucene 2.9.1 with Java 1.5 on Windows XP.  Is MultiPhraseQuery bad i=
n 2.9.1?  Does anyone know how I can find out why it is having the invocati=
on exception?

Thanks


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44485-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 18:43:06 2010
Return-Path: <java-user-return-44485-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66224 invoked from network); 12 Jan 2010 18:43:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 18:43:06 -0000
Received: (qmail 56366 invoked by uid 500); 12 Jan 2010 18:42:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56177 invoked by uid 500); 12 Jan 2010 18:42:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56079 invoked by uid 99); 12 Jan 2010 18:42:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 18:42:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gsiasf@gmail.com designates 209.85.210.192 as permitted sender)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 18:42:48 +0000
Received: by yxe30 with SMTP id 30so25263376yxe.29
        for <multiple recipients>; Tue, 12 Jan 2010 10:42:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:sender:from:content-type
         :content-transfer-encoding:subject:date:message-id:to:mime-version
         :x-mailer;
        bh=M0HiDZUA3lLmmDLR6u7RJWcIoD4pWm1qsXNM09ruP5w=;
        b=sEdncyu3jqMCpJ924O6IotjR6SPSQFb+9WPVHJ8lPStLzljUpeu/cEzvONgYRa336Q
         FlCBWolzeWpZcWY5uswNIhzWhUbbFY7v2XUmNvQn6zCamJOgXgyhs0WeuUgOpcz9G8Ka
         NFadVVZKf/1FNuFZj4E453u+GDMsHiKSfWeUI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=sender:from:content-type:content-transfer-encoding:subject:date
         :message-id:to:mime-version:x-mailer;
        b=nEVbvkC+81QtnrtUPO5aH+Z9anVfkaEO4nfsqbSy7pYOVUP36zh297HHAMz2T3ALKb
         x9aq5mvOEhJmTb71SIdcV5f/pT/HZ3ans+hzEhqzDBVksoZKjmqFPjujV2oHSog9EF3K
         wbMjEU3xE/ck+fGNfHUQFyk0A2Yo2Z7YIOpTU=
Received: by 10.150.81.4 with SMTP id e4mr1634753ybb.345.1263321746271;
        Tue, 12 Jan 2010 10:42:26 -0800 (PST)
Received: from ?10.0.0.77? (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
        by mx.google.com with ESMTPS id 21sm11101766yxe.1.2010.01.12.10.42.25
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 12 Jan 2010 10:42:25 -0800 (PST)
Sender: Grant Ingersoll <gsiasf@gmail.com>
From: Grant Ingersoll <gsingers@apache.org>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: SF Bay Area Lucene Meetup Jan. 21st
Date: Tue, 12 Jan 2010 13:42:24 -0500
Message-Id: <227E503D-86C5-44BA-B830-34C834191925@apache.org>
To: mahout-user@lucene.apache.org,
 solr-user@lucene.apache.org,
 lucene-net-dev@lucene.apache.org,
 java-user@lucene.apache.org,
 tika-user@lucene.apache.org,
 general@lucene.apache.org,
 pylucene-user@lucene.apache.org,
 nutch-user@lucene.apache.org,
 lucy-dev@lucene.apache.org,
 openrelevance-user@lucene.apache.org
Mime-Version: 1.0 (Apple Message framework v1077)
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org

There will be a San Francisco/Bay Area meetup on Jan. 21st at 7:15 PM at =
the "Hacker Dojo" (don't ask me...) location. =20

RSVP and all the details are at =
http://www.meetup.com/SFBay-Lucene-Solr-Meetup/

Hope to see you there,
Grant=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44486-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 18:49:19 2010
Return-Path: <java-user-return-44486-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70271 invoked from network); 12 Jan 2010 18:49:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 18:49:19 -0000
Received: (qmail 74201 invoked by uid 500); 12 Jan 2010 18:49:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74131 invoked by uid 500); 12 Jan 2010 18:49:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74121 invoked by uid 99); 12 Jan 2010 18:49:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 18:49:16 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 18:49:09 +0000
Received: by ewy9 with SMTP id 9so6165599ewy.11
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 10:48:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=bGioc9JWTFWV9umxKJFD1RAZGUW5TUrKtVjkgxwigD8=;
        b=K98GxOSvpzVIxTiV9VnoJnPjkRb73e2pLebAmuBRoNK5UzJlsEENloI/Y+kRsn9lx5
         uF/heMaBC9w1TBNpt8gn5ng3zxF/lh+TciH8aqq4cg9fJBGl7oI8wNm3dAV6XuJWtbCp
         zjbKP9kr8gNGCCXunOHMGLHKl9kr4TLYr4BK4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=VPdfD6/zFrH2QCX4D4RUoUSZx6LKd89llIjOtWEnyBdUZKGpcf1cWc48vg/IrGr42o
         GN4Sf0H7cwWyZGiuxxryT+q9F8YIHD6xMwJapUlm/WhBVDcLFjm0WgXgkb6C7AGwK234
         sCJkvnASdt7kUXAEFMlJRgx9JMrSrOSgGQhkY=
MIME-Version: 1.0
Received: by 10.216.86.137 with SMTP id w9mr2875052wee.104.1263322127199; Tue, 
	12 Jan 2010 10:48:47 -0800 (PST)
In-Reply-To: <492379B6AA909E4FAF672AACCA0EADC24A33B513FA@PHXCCRPRD02.adprod.bmc.com>
References: <4B4CA666.7020109@wyona.com>
	 <492379B6AA909E4FAF672AACCA0EADC24A33B513FA@PHXCCRPRD02.adprod.bmc.com>
Date: Tue, 12 Jan 2010 13:48:47 -0500
Message-ID: <359a92831001121048o59bab46bya712351fb50675e2@mail.gmail.com>
Subject: Re: Exception invoking MultiPhraseQuery
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d7f07ea0ee88047cfc1a96

--0016e6d7f07ea0ee88047cfc1a96
Content-Type: text/plain; charset=ISO-8859-1

I'd try running it outside of Eclipse, and/or checking each and every
of the many configuration options in Eclipse to see if you have an old
jar that Eclipse is using, from jars you've made accessible via the
"java build path" window to projects referenced to......

Alternately, you can look for all the Lucene jars on your machine and
delete (or move) any old ones.

And if none of this helps, can you post the entire stack trace?

HTH
Erick

On Tue, Jan 12, 2010 at 1:28 PM, Woolf, Ross <Ross_Woolf@bmc.com> wrote:

> I can't invoke MultiPhraseQuery.  It produces the error:
> com.sun.jdi.InvocationException occurred invoking method
>
> Here is the code:
> MultiPhraseQuery mpq = new MultiPhraseQuery();
>
> In the eclipse debugger when I try to inspect mpq after instantiating it
> shows the error.
>
> I'm on Lucene 2.9.1 with Java 1.5 on Windows XP.  Is MultiPhraseQuery bad
> in 2.9.1?  Does anyone know how I can find out why it is having the
> invocation exception?
>
> Thanks
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d7f07ea0ee88047cfc1a96--

From java-user-return-44487-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 19:05:52 2010
Return-Path: <java-user-return-44487-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75118 invoked from network); 12 Jan 2010 19:05:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 19:05:52 -0000
Received: (qmail 6433 invoked by uid 500); 12 Jan 2010 19:05:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6351 invoked by uid 500); 12 Jan 2010 19:05:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6341 invoked by uid 99); 12 Jan 2010 19:05:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 19:05:50 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 19:05:40 +0000
Received: by ywh14 with SMTP id 14so21236001ywh.20
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 11:05:18 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.55.28 with SMTP id d28mr6606223yba.335.1263323117993; Tue, 
	12 Jan 2010 11:05:17 -0800 (PST)
In-Reply-To: <27129835.post@talk.nabble.com>
References: <27115515.post@talk.nabble.com>
	 <9ac0c6aa1001120101o77c9e0b9i74ad0e76b59063ad@mail.gmail.com>
	 <27129835.post@talk.nabble.com>
Date: Tue, 12 Jan 2010 14:05:17 -0500
Message-ID: <9ac0c6aa1001121105s5e1b6c55h320e31cf734f1850@mail.gmail.com>
Subject: Re: Index corruption using Lucene 2.4.1 - thread safety issue?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Is it possible that you're not closing the old IW on the RAMDir before
deleting files / re-using it?  Or, any other possible way that two
open writers could accidentally share the same RAMDir?  Do you
override the LockFactory of the RAMDir?

EG with ConcurrentMergeScheduler, it can continue to write files into
the RAMDir.  It's remotely possible (though I think rather unlikely)
that this could lead to the corruption you're seeing.

If you can turn on setInfoStream for all writers you create and
capture & post all output leading to the exception, that could give us
a clue...

You should be able to use IW's deleteAll method to remove all docs
without closing/reopening the writer (oh -- but this is only available
as of 2.9).

You shouldn't have to remove files yourself -- just open a new IW with
create=3Dtrue?

Mike

On Tue, Jan 12, 2010 at 11:02 AM, Frank Geary <fgeary@acquiremedia.com> wro=
te:
>
> Thanks for the reply Mike. =A0Your questions were good ones because I rea=
lize
> now I should have probably used "Corrupt IndexReader" as the subject for
> this thread. =A0Here's my answers:
>
> The number stays the same until the corrupted IndexReader is reopened (if
> nothing changes in the IndexReader - and thus we get the same IndexReader
> back from reopen - the problem persists). =A0Then the next time the probl=
em
> occurs, after we've gotten at least one non-problematic IndexReader and t=
hus
> a few successful searches, the number is different. =A0For what it's wort=
h my
> latest ### was 176. =A0My assumption has always been that it is most like=
ly to
> be 1 beyond the end of the BitVector because each commit() is only changi=
ng
> the index by adding or deleting one document. =A0But I don't know for sur=
e.
>
> Yes, I had always expected that reopen during commit would be fine, and m=
y
> semaphore code seems to confirm that (unless adds have something very sub=
tle
> to do with it). =A0Any other theories would be very much appreciated.
>
> At first I wasn't sure whether it was the RAMDirectory or the main dir. =
=A0But
> since I now have many examples where the RAMDirectory IndexReader has
> changed and the main dir IndexReader has not, then I feel that the
> RAMDirectory IndexReader is the problem. =A0We reopen a new IndexReader e=
very
> time we do a search on a RAMDirectory. =A0For the main dir, we rarely reo=
pen
> an IndexReader. =A0We only reopen the main dir IndexReader when a RAM
> Directory is gotten rid of, which happens once the RAM directory indexes
> 10000 documents. =A0But here's a typical example where the main dir
> IndexReader stays the same throughout the problem:
>
> 1) both the RAMDirectory IndexReader and the main dir IndexReader are set
> after the last time we got rid of the RAMDirectory which was full with 10=
000
> documents.
> 2) then we receive about 1077 new documents and add them to the RAMDirect=
ory
> as well as to the main dir indexes (with a number of deletes scattered
> throughout as well). =A0The RAM directory is commited after every add or
> delete and the main dir is not committed at all.
> 3) then a search comes in, we reopen the RAM Directoy IndexReader, use th=
e
> existing main dir IndexReader (which does not reflect any index changes
> since step 1) and do the search and get ArrayIndexOutOfBounds so the sear=
ch
> fails (in this case the ### was 208)
> 4) then we simply go one and get another 4000 adds and deletes in the RAM
> directory and main directory. =A0Again the RAM directory is commited afte=
r
> every add or delete and the main dir is not committed at all.
> 5) then the next search comes in, reopens the RAMDirectory IndexReader, u=
ses
> the existing main dir IndexReader (which does not reflect any index chang=
es
> since step 1) and the search works fine!
> 6) during all that time the main dir IndexReader never got reopened, and =
the
> RAMDirectory IndexReader only got reopened twice - once it was bad and th=
e
> next it was OK.
>
> To answer your question about when we periodically move our in-RAM change=
s
> to the disk index (my apologies if this is redundant):
> We never move them. =A0They are duplicated in both the RAM directory and
> on-disk directory as they come in. =A0Then when the RAM directory determi=
nes
> that it has 10000 documents, we begin writing to a second RAM Directory,
> reopen and warmup the on-disk IndexReader and once that new on-disk
> IndexReader is ready, we throw away the RAM directory which had 10000
> documents (to do this we actually clean out the RAM directory by deleting
> all the files it contains and we create a new IndexWriter using that same
> RAMDirectory object). =A0Then we continue writing to that second RAMdirec=
tory
> and the on-disk index until the second RAM directory has 10000 documents.
> And repeat.
>
> We have NOT run CheckIndex on the RAM directory mainly because this mostl=
y
> happens in our production environment which has very high traffic and I'd
> have to write some special code to set aside a bad RAMDirectory index, et=
c
> to run the CheckIndex on it. =A0Just not an easy thing to do.
>
> I can look into enabling asserts. =A0That may help.
>
> Finally, for the RAM directory, we must create a new IndexWriter everytim=
e
> "clean out" the RAM directory after we reach the 10000 documents limit. =
=A0We
> clean out the RAM directory by deleting all the files it contains and we
> then create a new IndexWriter using that same RAMDirectory object. =A0If =
there
> was a reopen for an IndexWriter, we'd use that instead. =A0For the on-dis=
k
> directory, the IndexWriter never changes and we reopen the IndexReader ea=
ch
> time a RAM directory reaches the 10000 document limit.
>
> Any further thoughts or ideas? =A0Thanks again for your help Mike!
>
> Frank
>
>
> Michael McCandless-2 wrote:
>>
>> Not good! =A0Can you post the ###'s from the exception? =A0How far out o=
f
>> bounds is the access?
>>
>> Your usage sounds fine. =A0Reopen during commit is fine.
>>
>> Are you sure the exception comes from the reader on the RAMDir and not
>> your main dir?
>>
>> How do you periodically move your in-RAM changes to the disk index?
>>
>> Have you run CheckIndex on your index? =A0Also, try running with asserts
>> enabled... it may catch whatever is happening, sooner.
>>
>> Do you hold open a single IW on the RAMDir, and re-use it? =A0Or open
>> and then close? =A0What about the disk dir?
>>
>> Mike
>>
>> On Mon, Jan 11, 2010 at 1:42 PM, Frank Geary <fgeary@acquiremedia.com>
>> wrote:
>>>
>>> Hi,
>>>
>>> I'm using Lucene 2.4.1 and am seeing occasional index corruption. =A0It
>>> shows
>>> up when I call MultiSearcher.search(). =A0MultiSearcher.search() throws=
 the
>>> following exception:
>>>
>>> ArrayIndexOutOfBoundsException. =A0The error is: Array index out of ran=
ge:
>>> ###
>>> where ### is a number representing an index into the deletedDocs
>>> BitVector
>>> in SegmentTermDocs. =A0the stack trace is as follows:
>>>
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.util.BitVector.get(BitVector.java:91)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:125)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.index.MultiSegmentReader$MultiTermDocs.next(MultiSegm=
entReader.java:554)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.FieldCacheImpl$10.createValue(FieldCacheImpl.j=
ava:384)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:7=
1)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.FieldCacheImpl.getStringIndex(FieldCacheImpl.j=
ava:351)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.FieldSortedHitQueue.comparatorString(FieldSort=
edHitQueue.java:415)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.FieldSortedHitQueue$1.createValue(FieldSortedH=
itQueue.java:206)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:7=
1)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.FieldSortedHitQueue.getCachedComparator(FieldS=
ortedHitQueue.java:167)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.FieldSortedHitQueue.<init>(FieldSortedHitQueue=
.java:55)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.TopFieldDocCollector.<init>(TopFieldDocCollect=
or.java:43)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:122)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.MultiSearcher.search(MultiSearcher.java:232)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> org.apache.lucene.search.Searcher.search(Searcher.java:86)
>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>> com.acquiremedia.opens.index.searcher.HybridIndexSearcher.search(Hybrid=
IndexSearcher.java:311)
>>> .
>>> .
>>> .
>>>
>>> That makes sense, but I'm trying to understand what could be causing th=
e
>>> corruption.
>>>
>>> Here's what I'm doing:
>>>
>>> 1) I have an IndexWriter created usnig a RAMDirectory.
>>>
>>> 2) I have a single thread processing index adds and index deletes. =A0T=
his
>>> thread is rather simple and calls IndexWriter.addDocument() followed by
>>> IndexWriter.commit() or IndexWriter.deleteDocuments() followed by
>>> IndexWriter.commit(). =A0The commits are done at this point because we =
want
>>> the documents available for searching immediately.
>>>
>>> 3) I also have 4 search threads running at the same time as the index
>>> write
>>> thread. =A0Each time a search thread executes a search it calls
>>> IndexReader.reopen() =A0on the existing IndexReader for the index creat=
ed
>>> using the RAMDirectory above, gets an existing index reader for another
>>> on-disk index and then calls MultiSearcher.search() (this brings togeth=
er
>>> the RamDirectory index and an on-disk index) to execute the search.
>>>
>>> It generally works fine, but every few days or so I get the above
>>> ArrayIndexOutOfBoundsException. =A0 My suspicion is that when the
>>> IndexWritert.commit() call happens due to a delete at the exact same ti=
me
>>> as
>>> the IndexReader.reopen() call happens, the IndexReader has a deleteDocs
>>> BitVector which reflects the delete, but something else internal to the
>>> IndexReader is not reflecting the delete.
>>>
>>> So, I implemented a semaphore mechanism to prevent IndexWriter.commit()
>>> from
>>> happening at the same time as IndexReader.reopen(). =A0I only implement=
ed
>>> the
>>> semaphores in the delete case because my guess was that an add would be
>>> unlikely to affect the deleteDocs Bit Vector. =A0Unfortunately, the pro=
blem
>>> continues to happen.
>>>
>>> I believe I read somewhere that a similar thread saftey issue had been
>>> fixed
>>> in Lucene 2.4, but I suspect there may still be an issue in 2.4.1.
>>>
>>> Does anyone have any knowledge or insight into what I may be doing wron=
g
>>> or
>>> how I can correct/avoid the problem? =A0Upgrading to Lucene 3.0 or usin=
g
>>> Solr
>>> are not really options for me at least in the short term.
>>>
>>> Thanks for any information you can provide!
>>>
>>> Frank
>>> --
>>> View this message in context:
>>> http://old.nabble.com/Index-corruption-using-Lucene-2.4.1---thread-safe=
ty-issue--tp27115515p27115515.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://old.nabble.com/Index-corruption-usin=
g-Lucene-2.4.1---thread-safety-issue--tp27115515p27129835.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44488-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 19:09:30 2010
Return-Path: <java-user-return-44488-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76570 invoked from network); 12 Jan 2010 19:09:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 19:09:30 -0000
Received: (qmail 15036 invoked by uid 500); 12 Jan 2010 19:09:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14978 invoked by uid 500); 12 Jan 2010 19:09:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14968 invoked by uid 99); 12 Jan 2010 19:09:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 19:09:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [198.147.195.5] (HELO flicker.bmc.com) (198.147.195.5)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 12 Jan 2010 19:09:20 +0000
Received: by flicker.bmc.com (Postfix, from userid 13749)
	id 86D691E6663; Tue, 12 Jan 2010 12:09:51 -0700 (MST)
Received: from PHX-HTPRD-02.adprod.bmc.com (phx-htprd-02.adprod.bmc.com [172.24.32.8])
	by flicker.bmc.com (Postfix) with ESMTP id 700231E6643
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 12:09:51 -0700 (MST)
Received: from PHXCCRPRD02.adprod.bmc.com ([172.24.32.181]) by
 PHX-HTPRD-02.adprod.bmc.com ([172.24.32.8]) with mapi; Tue, 12 Jan 2010
 13:08:22 -0600
From: "Woolf, Ross" <Ross_Woolf@BMC.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Tue, 12 Jan 2010 13:08:27 -0600
Subject: RE: Exception invoking MultiPhraseQuery
Thread-Topic: Exception invoking MultiPhraseQuery
Thread-Index: AcqTt93jH8/r90LWRNitUYJXTZJTFgAAe9Zg
Message-ID: <492379B6AA909E4FAF672AACCA0EADC24A33B5150C@PHXCCRPRD02.adprod.bmc.com>
References: <4B4CA666.7020109@wyona.com>
	 <492379B6AA909E4FAF672AACCA0EADC24A33B513FA@PHXCCRPRD02.adprod.bmc.com>
 <359a92831001121048o59bab46bya712351fb50675e2@mail.gmail.com>
In-Reply-To: <359a92831001121048o59bab46bya712351fb50675e2@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks, I'll try that.  As for the stack trace
"com.sun.jdi.InvocationException occurred invoking method"

is the total of the error I get.  And I only see this when I select "mpq" i=
n the Variables window and that is displayed instead of showing the mpq obj=
ect.  I've tried catching the exception but it is not catchable.  I only ge=
t the invocation exception displayed and can't inspect mpq.

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Tuesday, January 12, 2010 11:49 AM
To: java-user@lucene.apache.org
Subject: Re: Exception invoking MultiPhraseQuery

I'd try running it outside of Eclipse, and/or checking each and every
of the many configuration options in Eclipse to see if you have an old
jar that Eclipse is using, from jars you've made accessible via the
"java build path" window to projects referenced to......

Alternately, you can look for all the Lucene jars on your machine and
delete (or move) any old ones.

And if none of this helps, can you post the entire stack trace?

HTH
Erick

On Tue, Jan 12, 2010 at 1:28 PM, Woolf, Ross <Ross_Woolf@bmc.com> wrote:

> I can't invoke MultiPhraseQuery.  It produces the error:
> com.sun.jdi.InvocationException occurred invoking method
>
> Here is the code:
> MultiPhraseQuery mpq =3D new MultiPhraseQuery();
>
> In the eclipse debugger when I try to inspect mpq after instantiating it
> shows the error.
>
> I'm on Lucene 2.9.1 with Java 1.5 on Windows XP.  Is MultiPhraseQuery bad
> in 2.9.1?  Does anyone know how I can find out why it is having the
> invocation exception?
>
> Thanks
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44489-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 19:12:29 2010
Return-Path: <java-user-return-44489-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77263 invoked from network); 12 Jan 2010 19:12:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 19:12:29 -0000
Received: (qmail 20147 invoked by uid 500); 12 Jan 2010 19:12:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20058 invoked by uid 500); 12 Jan 2010 19:12:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20039 invoked by uid 99); 12 Jan 2010 19:12:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 19:12:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.62] (HELO web50308.mail.re2.yahoo.com) (206.190.38.62)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 12 Jan 2010 19:12:17 +0000
Received: (qmail 89232 invoked by uid 60001); 12 Jan 2010 19:11:55 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263323515; bh=uIdkuiOJhP8iGE+F0gZkiYEnFB6Hvs5k+wo7emRUMDM=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=BCQCNKEXqtq4p5syykHO0wua/Ic8Sx+/uKtwxbjatBPGTKoObLLX0fzHGtJo62whF6KL+eWzRS1+m1TH2qoVPg6tAEGHdcB15cDZkaMMYTuCDp1XTNcDJp3UQniuhg8hpqjhfukkaV1nE5eaN+Wlb9Ok3UxXQC1svXPxhI3QRGQ=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=fB9pqSHHg+9AbajvyftvgKo08NKNlkGBsRbzmEw4r6QhytTjDkWI3oppU/Vc5gs1KgfLj1h0Eyk6QufppWRnKHgWMtNcqB7fzAbmTFYnoKefHu+vI86mjPl03OyUGBYGR2gBSQ30Usrb2PC7Ke8YUitqAqsXIj+SnyUIBgLcMSM=;
Message-ID: <341176.86906.qm@web50308.mail.re2.yahoo.com>
X-YMail-OSG: oLdFDxcVM1l6C18wFabBm9IOGrZJKLrM62ZXhqRZgpmEajYSQpHMagqXKJQ9u8gIEdqhywDfUf2c2MObTPJZAPrUGiRWo8rAltjUc0pdVV.RvGUfwI5NR.ulHVQYp1hraxweXZov7_Diiwe7AsSNuhPbIXXQ4HoahEDkpPIACnYoGi19hjIYxKNQk_usPHLAsEWmOUg7twOAnQsrmjY0_Jtl6qRKeC4OGkjkL3evDlOZ17JfPg39FidWf92ANosSa_t7JySneYJiEqGTYOnh3ZNJYWz2C0S2P8yve86i_pf3c_aWNhQ0OM.saWxlHgenZNWc2R8pzenu2ki_9Yo8LFZfUh3EPNhTFMZdfWoLQmd8waTXD6Zezel0Vv0RuxEJg4CZed876HwEQ9UpMfAnaGkkwortByb8iM2EuYBFQly6ud2GKyDnaNeEvy5C2VyZvfTAkKPwvstKaKExaS9BdIdJ9ZK0BuD3KMc4uyOijX63pT19xNxOVrxcDT3O4gSFiMVq4B5Mdts.yH4sgI2_qE.mNDOZ
Received: from [167.206.188.3] by web50308.mail.re2.yahoo.com via HTTP; Tue, 12 Jan 2010 11:11:55 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
Date: Tue, 12 Jan 2010 11:11:55 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: NYC Search in the Cloud meetup: Jan 20
To: mahout-user@lucene.apache.org, solr-user@lucene.apache.org,
  lucene-net-user@lucene.apache.org, java-user@lucene.apache.org,
  tika-user@lucene.apache.org, general@lucene.apache.org,
  pylucene-user@lucene.apache.org, nutch-user@lucene.apache.org,
  lucy-dev@lucene.apache.org, openrelevance-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Hello,

If "Search Engine Integration, Deployment and Scaling in the Cloud" sounds interesting to you, and you are going to be in or near New York next Wednesday (Jan 20) evening:

http://www.meetup.com/NYC-Search-and-Discovery/calendar/12238220/

Sorry for dupes to those of you subscribed to multiple @lucene lists.

Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44490-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 20:29:47 2010
Return-Path: <java-user-return-44490-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99722 invoked from network); 12 Jan 2010 20:29:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 20:29:47 -0000
Received: (qmail 20392 invoked by uid 500); 12 Jan 2010 20:29:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20317 invoked by uid 500); 12 Jan 2010 20:29:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20307 invoked by uid 99); 12 Jan 2010 20:29:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 20:29:44 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 20:29:35 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 03C49CB6C8
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 15:29:02 -0500 (EST)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute2.internal (MEProxy); Tue, 12 Jan 2010 15:29:02 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=LErUqLgu8AFZof0EW8sp7YBL9Oc=; b=cLA+BTLLL7gerUWAe/PlMdChk0+J695M9xo8eQvoNedwFzeKIORLlKeBHb0jo7Bpdy7f7bemtZBOdYNIrpniDd2FySY4xaRD42/emdRiXIncR4noRktQf+PRKwmWbS17qRXMp7MJ8m2c+o5YkAcN1mMT6fNQOYtRMkamt0/xplY=
X-Sasl-enc: QcHDG/Q43OsqtK3GNGHLXkP22VG0HsQHpS7mO0u0xHK9 1263328141
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 50F0711317
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 15:29:01 -0500 (EST)
Message-ID: <4B4CDB8C.7030804@fastmail.fm>
Date: Tue, 12 Jan 2010 20:29:00 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Is there any difference in a document between one added field with
 a number of terms and a field added a number of times ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Been doing some analysis with Luke (BTW doesnt work with 
StandardAnalyzer since Version field introduced) and discovered a 
problem with field lenghth boosting for me.

I have a document that represents a recording artist (i.e Madonna, The 
Beatles ectera) it contains an artist and an alias field, the alias 
field contains other names that the artist is maybe known as, and so 
there can be multiple aliases for an artist.

PseudoCode:
(
doc.addField(ArtistIndexField.ARTIST, rs.getString("name"));
for (String alias : aliases.get(artistId)) {
      doc.addField(ArtistIndexField.ALIAS, alias);
}
)

 Im finding that when I search by for the artist by the alias field if 
the value matches an alias in two different documents the document with 
the least number of aliases get the best score because the boost of the 
alias is split between the aliases on the other doc, if I 
ANALYSED_NO_NORMS then both documents return the same score.

The trouble is I don't want to disable norms because I want a match on a 
single field containing less terms to score better than one with more 
scores.

Full example:

http://musicbrainz.org/search/textsearch.html?query=minihamuzu&type=artist&limit=25&adv=on&handlearguments=1
return two results , the second result only has score of 8 because it 
more aliases than the first result, even the alias it matched on was an 
exact single term match.
http://musicbrainz.org/show/artist/aliases.html?artistid=174327

but if I remove norms then the following query (which is currently working)

http://musicbrainz.org/search/textsearch.html?query=%22the+beatles%22&type=artist&limit=25&adv=on&handlearguments=1

would stop working, in that  searching for 'The beatles' would no longer 
score rate artist 'The Beatles' better than 'The Beatles revival Band'

So isn't there any way to recognise that repeated calls to addField() is 
not creating a single field with many terms,but many fields with few terms.

thanks Paul




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44491-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 20:45:16 2010
Return-Path: <java-user-return-44491-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5560 invoked from network); 12 Jan 2010 20:45:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 20:45:16 -0000
Received: (qmail 48798 invoked by uid 500); 12 Jan 2010 20:45:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48705 invoked by uid 500); 12 Jan 2010 20:45:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48695 invoked by uid 99); 12 Jan 2010 20:45:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 20:45:13 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 20:45:03 +0000
Received: by yxe30 with SMTP id 30so25384141yxe.29
        for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 12:44:42 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.251.9 with SMTP id y9mr3967194ybh.226.1263329082283; Tue, 
	12 Jan 2010 12:44:42 -0800 (PST)
In-Reply-To: <4B4CDB8C.7030804@fastmail.fm>
References: <4B4CDB8C.7030804@fastmail.fm>
Date: Tue, 12 Jan 2010 17:44:42 -0300
Message-ID: <c4e715d71001121244u569e8c62ib6a8f7a888767e7a@mail.gmail.com>
Subject: Re: Is there any difference in a document between one added field 
	with a number of terms and a field added a number of times ?
From: Felipe <felipe@goshme.com>
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
Content-Type: multipart/alternative; boundary=000e0cd649762f167e047cfdb9b8
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd649762f167e047cfdb9b8
Content-Type: text/plain; charset=ISO-8859-1

You could change the boost of the field artist to be bigger than the field
alias.
    field.setBoost(artistBoost);


2010/1/12 Paul Taylor <paul_t100@fastmail.fm>

> Been doing some analysis with Luke (BTW doesnt work with StandardAnalyzer
> since Version field introduced) and discovered a problem with field lenghth
> boosting for me.
>
> I have a document that represents a recording artist (i.e Madonna, The
> Beatles ectera) it contains an artist and an alias field, the alias field
> contains other names that the artist is maybe known as, and so there can be
> multiple aliases for an artist.
>
> PseudoCode:
> (
> doc.addField(ArtistIndexField.ARTIST, rs.getString("name"));
> for (String alias : aliases.get(artistId)) {
>     doc.addField(ArtistIndexField.ALIAS, alias);
> }
> )
>
> Im finding that when I search by for the artist by the alias field if the
> value matches an alias in two different documents the document with the
> least number of aliases get the best score because the boost of the alias is
> split between the aliases on the other doc, if I ANALYSED_NO_NORMS then both
> documents return the same score.
>
> The trouble is I don't want to disable norms because I want a match on a
> single field containing less terms to score better than one with more
> scores.
>
> Full example:
>
>
> http://musicbrainz.org/search/textsearch.html?query=minihamuzu&type=artist&limit=25&adv=on&handlearguments=1
> return two results , the second result only has score of 8 because it more
> aliases than the first result, even the alias it matched on was an exact
> single term match.
> http://musicbrainz.org/show/artist/aliases.html?artistid=174327
>
> but if I remove norms then the following query (which is currently working)
>
>
> http://musicbrainz.org/search/textsearch.html?query=%22the+beatles%22&type=artist&limit=25&adv=on&handlearguments=1
>
> would stop working, in that  searching for 'The beatles' would no longer
> score rate artist 'The Beatles' better than 'The Beatles revival Band'
>
> So isn't there any way to recognise that repeated calls to addField() is
> not creating a single field with many terms,but many fields with few terms.
>
> thanks Paul
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Felipe Lobo
www.jusbrasil.com.br

--000e0cd649762f167e047cfdb9b8--

From java-user-return-44492-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 12 20:54:59 2010
Return-Path: <java-user-return-44492-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7720 invoked from network); 12 Jan 2010 20:54:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 12 Jan 2010 20:54:59 -0000
Received: (qmail 58997 invoked by uid 500); 12 Jan 2010 20:54:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58932 invoked by uid 500); 12 Jan 2010 20:54:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58922 invoked by uid 99); 12 Jan 2010 20:54:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 20:54:56 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 12 Jan 2010 20:54:46 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id CE4F5CB97F;
	Tue, 12 Jan 2010 15:54:25 -0500 (EST)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute1.internal (MEProxy); Tue, 12 Jan 2010 15:54:25 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=xnZQ3168tHwx4lKSjOrhM8vkjT8=; b=lnOs3zNUiaNznWaL/mDSZfu5A23CgdI2yi1wpHKPt+ObObwJyXUj+k/nqlEWxzHJWpGfuPh9mSmYE4EKAEIvXbsgeA55HBXPb7FLZ2fHbuoNflTFwhp1ZgAszUW9dgCNKJCjE8n3feRrBDuMJroXh9Xbgk8UAkZ7OnuHsZ4xXhk=
X-Sasl-enc: bgbI6yJAuu5kXDyqTSvwvK2qD/MZFJbNFnNq5Dw8ChuR 1263329665
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id D7E1A3EA51;
	Tue, 12 Jan 2010 15:54:24 -0500 (EST)
Message-ID: <4B4CE17F.2020706@fastmail.fm>
Date: Tue, 12 Jan 2010 20:54:23 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: Felipe <felipe@goshme.com>
CC: java-user@lucene.apache.org
Subject: Re: Is there any difference in a document between one added field
 	with a number of terms and a field added a number of times ?
References: <4B4CDB8C.7030804@fastmail.fm> <c4e715d71001121244u569e8c62ib6a8f7a888767e7a@mail.gmail.com>
In-Reply-To: <c4e715d71001121244u569e8c62ib6a8f7a888767e7a@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Felipe, but you  are missing the point Artist really doesnt come 
into it, my problem is confined to the alias field, forget about artist 
its just detailed to give the complete scenario

Paul

Felipe wrote:
> You could change the boost of the field artist to be bigger than the 
> field alias.
>     field.setBoost(artistBoost);
>
>
> 2010/1/12 Paul Taylor <paul_t100@fastmail.fm 
> <mailto:paul_t100@fastmail.fm>>
>
>     Been doing some analysis with Luke (BTW doesnt work with
>     StandardAnalyzer since Version field introduced) and discovered a
>     problem with field lenghth boosting for me.
>
>     I have a document that represents a recording artist (i.e Madonna,
>     The Beatles ectera) it contains an artist and an alias field, the
>     alias field contains other names that the artist is maybe known
>     as, and so there can be multiple aliases for an artist.
>
>     PseudoCode:
>     (
>     doc.addField(ArtistIndexField.ARTIST, rs.getString("name"));
>     for (String alias : aliases.get(artistId)) {
>         doc.addField(ArtistIndexField.ALIAS, alias);
>     }
>     )
>
>     Im finding that when I search by for the artist by the alias field
>     if the value matches an alias in two different documents the
>     document with the least number of aliases get the best score
>     because the boost of the alias is split between the aliases on the
>     other doc, if I ANALYSED_NO_NORMS then both documents return the
>     same score.
>
>     The trouble is I don't want to disable norms because I want a
>     match on a single field containing less terms to score better than
>     one with more scores.
>
>     Full example:
>
>     http://musicbrainz.org/search/textsearch.html?query=minihamuzu&type=artist&limit=25&adv=on&handlearguments=1
>     <http://musicbrainz.org/search/textsearch.html?query=minihamuzu&type=artist&limit=25&adv=on&handlearguments=1>
>     return two results , the second result only has score of 8 because
>     it more aliases than the first result, even the alias it matched
>     on was an exact single term match.
>     http://musicbrainz.org/show/artist/aliases.html?artistid=174327
>
>     but if I remove norms then the following query (which is currently
>     working)
>
>     http://musicbrainz.org/search/textsearch.html?query=%22the+beatles%22&type=artist&limit=25&adv=on&handlearguments=1
>     <http://musicbrainz.org/search/textsearch.html?query=%22the+beatles%22&type=artist&limit=25&adv=on&handlearguments=1>
>
>     would stop working, in that  searching for 'The beatles' would no
>     longer score rate artist 'The Beatles' better than 'The Beatles
>     revival Band'
>
>     So isn't there any way to recognise that repeated calls to
>     addField() is not creating a single field with many terms,but many
>     fields with few terms.
>
>     thanks Paul
>
>
>
>
>     ---------------------------------------------------------------------
>     To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>     <mailto:java-user-unsubscribe@lucene.apache.org>
>     For additional commands, e-mail: java-user-help@lucene.apache.org
>     <mailto:java-user-help@lucene.apache.org>
>
>
>
>
> -- 
> Felipe Lobo
> www.jusbrasil.com.br <http://www.jusbrasil.com.br>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44493-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 01:42:37 2010
Return-Path: <java-user-return-44493-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25649 invoked from network); 13 Jan 2010 01:42:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 01:42:37 -0000
Received: (qmail 62223 invoked by uid 500); 13 Jan 2010 01:42:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62132 invoked by uid 500); 13 Jan 2010 01:42:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62122 invoked by uid 99); 13 Jan 2010 01:42:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 01:42:34 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 01:42:26 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id DCC2271C1F1; Tue, 12 Jan 2010 17:42:05 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id DABF371C1D4
	for <java-user@lucene.apache.org>; Tue, 12 Jan 2010 17:42:05 -0800 (PST)
Date: Tue, 12 Jan 2010 17:42:05 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: Lucene Users <java-user@lucene.apache.org>
Subject: Supported way to get segment from IndexWriter?
Message-ID: <Pine.LNX.4.64.1001121720120.19492@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed
X-Virus-Checked: Checked by ClamAV on apache.org


A conversation with someone earlier today got me thinking about cranking 
out a patch for SOLR-1559 (in which the goal is to allow for rules do 
dermine the iput to optimize(maxNumSegments) instead of requiring a fixed 
integer value as input)  when i realized that i wasn't certain what 
"approved" methods there might be for deterrmining hte current number of 
segments from an IndexWriter.

I see IndexWriter.getSegmentCount() but it's package protected (with a 
comment that it exists for tests).  So my best guess using only public 
APIs would be something like...

  int numCurrentSegments = -1;
  IndexReader r = writer.getReader();
  try {
    IndexReader[]tmp = r.getSequentialSubReaders();
    numCurrentSegments = null==tmp ? 1 : tmp.length;
  } finally {
    r.close();
  }

Is there a better way?

(My main concern about this approach being that my intuition (which seems 
supported by the javadocs) is that getReader might be a little 
expensive/excesive just to count the segments)

-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44494-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 03:41:51 2010
Return-Path: <java-user-return-44494-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69339 invoked from network); 13 Jan 2010 03:41:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 03:41:50 -0000
Received: (qmail 41845 invoked by uid 500); 13 Jan 2010 03:41:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41719 invoked by uid 500); 13 Jan 2010 03:41:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41709 invoked by uid 99); 13 Jan 2010 03:41:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 03:41:47 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 03:41:39 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUu6h-0007f2-84
	for java-user@lucene.apache.org; Tue, 12 Jan 2010 19:41:19 -0800
Message-ID: <27139147.post@talk.nabble.com>
Date: Tue, 12 Jan 2010 19:41:19 -0800 (PST)
From: zhang99 <second_comet@yahoo.com>
To: java-user@lucene.apache.org
Subject: lucene index file randomly crash and need to reindex
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: second_comet@yahoo.com


how you all deal wich such issue of occasionally need to reindex? what
recommendation do you suggest to minimize this?
-- 
View this message in context: http://old.nabble.com/lucene-index-file-randomly-crash-and-need-to-reindex-tp27139147p27139147.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44495-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 03:52:35 2010
Return-Path: <java-user-return-44495-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72334 invoked from network); 13 Jan 2010 03:52:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 03:52:34 -0000
Received: (qmail 52036 invoked by uid 500); 13 Jan 2010 03:52:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51891 invoked by uid 500); 13 Jan 2010 03:52:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51880 invoked by uid 99); 13 Jan 2010 03:52:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 03:52:31 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.163.179.218] (HELO web36104.mail.mud.yahoo.com) (66.163.179.218)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 13 Jan 2010 03:52:21 +0000
Received: (qmail 18216 invoked by uid 60001); 13 Jan 2010 03:52:00 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263354719; bh=2bRU7VxCnSKO7VUZVNYs1/i/UbdXcJX/gjOp4Tl8prA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=cZl2SUSc5XYCOwWgyYSAsmE5OC9XGtlkJFuX632CjszH4G3EmayKqWGqunKD2BRbn8QxR6pj9tj+eG8sVQxcywSs5sNHbzz6w4ZpXOV1tkiGqRHAZ6y8T0Fcz9BlnZ8deq6Znp3nhGSNLpLt94ACNqWw+gP/n3P+MfCzANLvI7Y=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=1JE+gmc9sVbHumCgfpJTtVvhwxUU4jeeIO3srs1yEGNsxcR48ShSyusdoST9GUfveHCvMEvzGPbrZXBuh2R8TotMVZFl/I2Pv5WepVEVo8dHcIR/bU+Ct/P8jNewp5ZtvbaioVeoSZk4pgz2+lW9CkJQbwDXoZfr8R7SqQumSLE=;
Message-ID: <994707.17853.qm@web36104.mail.mud.yahoo.com>
X-YMail-OSG: sU6fV0MVM1nws3NNN3zArmiMXRz6GYzKZiQPpXcHQMZ_Yd9795kXngX6HfXItWYlA1xxCsmh7NOTMzNo6_2wDyx5TE9NaUTsUnOAv3UxG9SBmdPZen8TZxi62jYE86HuQHM5n76TCBLrHXiS9LjUtmd_YBiFPPUdqEBPyu25Svv2kcYCGAkCVJA8FvY6AFTyVSp1LkJsu_aYFCvDD33FqDENpvp87_bk8Ui3ovFtmFo_2KUaiQ_rC8LO788iPjHr3KZtdsvTwpgJPxaqiajt6SZlD5.14QpiOotIipwkd6hiPF8gpTLSmBIVTsDqm0h2viFHrU7r.Pm4w.758.AlxTYqCIFm5T8aYNyaRFjutafM2kSAxhM4fPe1Qq3Ml37TEMZQM1uePQbheKnBC.Y5Jb2Ekl4HJxi3xy_zUuvnL51ex0A6pHn1AxXVrnT0vVeQ2LCIy1ikGKwWiEKqGWoJXup3xrzY9gjZZXWD3iYTQ9toYAwQpmKsfKCCgNu3xwuaqBbP7jKs5RZwD4t2MnMCAuRkyyUb0IADyZI7TxE2JRco0mVNxFfdu2YDcky9uQE2kJvbXYqLJf63yvTn6TN_N5xXvEKmB48bghuc192hPzWa.EcL_72kJn.sWyAwS_5Va.REKZdLhwFjOhe3HAFOjT1I0VauIJ_aZo9APoSk2_MRhUUl7IDUTRJLLMuXhfprg70JEoO8rfs6GagkRTlPS8TyAk3bOOB1VpttG2HNZoDL50hy
Received: from [203.126.190.28] by web36104.mail.mud.yahoo.com via HTTP; Tue, 12 Jan 2010 19:51:59 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Tue, 12 Jan 2010 19:51:59 -0800 (PST)
From: <jyzhou817@yahoo.com>
Subject: how to follow intranet: configuration in nutch website
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-606289983-1263354719=:17853"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-606289983-1263354719=:17853
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

Hi,

I try to following the instruction from http://lucene.apache.org/nutch/tuto=
rial8.html
.....
Intranet: Configuration=0ATo configure things for intranet crawling you mus=
t:1. Create a directory with a flat file of root urls.  For example, to=0Ac=
rawl the nutch site you might start with a file named=0Aurls/nutch containi=
ng the url of just the Nutch home=0Apage.  All other Nutch pages should be =
reachable from this page.  The=0Aurls/nutch file would thus contain:=0Ahttp=
://lucene.apache.org/nutch/

....

not understand. Can anyone help me out.=20

Thanks.
zhou=0A=0A=0A      New Email addresses available on Yahoo!=0AGet the Email =
name you&#39;ve always wanted on the new @ymail and @rocketmail. =0AHurry b=
efore someone else does!=0Ahttp://mail.promotions.yahoo.com/newdomains/sg/
--0-606289983-1263354719=:17853--

From java-user-return-44496-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 04:08:01 2010
Return-Path: <java-user-return-44496-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75153 invoked from network); 13 Jan 2010 04:08:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 04:08:00 -0000
Received: (qmail 62087 invoked by uid 500); 13 Jan 2010 04:07:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61961 invoked by uid 500); 13 Jan 2010 04:07:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61947 invoked by uid 99); 13 Jan 2010 04:07:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 04:07:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 13 Jan 2010 04:07:48 +0000
Received: (qmail 36736 invoked by uid 60001); 13 Jan 2010 04:07:26 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263355646; bh=K1erBrhLvIPb71MLX/g0lBrVImHQANWHGY4c58k3DnI=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=PvYOgKMbrhWtRODhaT5S9nQIk5NJ6s6D7LrgiBArSRqLP1DnKrbQuaonwz4HmnTQQPQ4tE9wvr7SjGYxToxeuwjf5mMu7N53YzHI9SHVx5r8+8MOYbszIKortg7pKDsyJVuP0kFCjVV/m403bvj0Nw4X2J2wwvzy/Oecah0ihOc=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=NQWXh8+azjNidJjkANnGtcBr3JMI3zyiaI8ZrbImYxkemjwjhQ4vhLkacHRGww/LDTGNs7m/7PKgpXAJrNzTMgDUyncXddcVVbPdaXH8cK/U8H7z6nj0nbhkaKyZkt1W3uXBs2j12fiTZxmcZAqxzM4eQ7ZJivDi1OFbMWrwalo=;
Message-ID: <682977.36627.qm@web50307.mail.re2.yahoo.com>
X-YMail-OSG: 5E1D1WQVM1lcIXrvnLHRsKbtwyMzBLAcr9WFBO.EWl3qvHb8stOkdVmmz4vu_zN67WnH4OQqonm5hJ9NQJp42j5UZ14ZvWcXmeMcRiMFRWtqAi9UqfKN.H1R5uGRHoOh95v4TPpqXLiK2tUe5mzdx.0zyhAvUqmfDsxsJpc1ft0X6Ef3cN9ErOQeDtT2S_xU2NXNwdAPFeUclLmbLPl8TEjXe0eRdJf8.OjVenDF41X7eBEm5tGh7rCYVU7BAmh.ue5U0S8N4.14eoBOBYqE7QH4XzmeO70cxcJBqrgvXoCyzQegO4AGFdbBHdwBaBQj_i7hW8Qun973SBK6PICZSm9vQvY0e.a65Rr.R0A7HHZYj221jbJ9NVETA7Ht29j8fpgjjrCEZja4BNIcrY9pcOq_vZsRTMwrJL1HW7xe84uu5sW0Zcz2pRXTczop1Qg5FcxGyKdQCHwN7tIfybTOHzGITeHsTAMo1sEXiH_QSXtqHIT8Ld4_USsCHT1xZaf6e6yUV6KpWXPOrPPIT9XPlJNSuyOzGflIAE6mDxcxCyi1TzzclwPg2m3FwGxjZz7NM4BHg_lH13Dn_wJzs4QB
Received: from [74.73.1.126] by web50307.mail.re2.yahoo.com via HTTP; Tue, 12 Jan 2010 20:07:26 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <994707.17853.qm@web36104.mail.mud.yahoo.com>
Date: Tue, 12 Jan 2010 20:07:26 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: how to follow intranet: configuration in nutch website
To: java-user@lucene.apache.org
In-Reply-To: <994707.17853.qm@web36104.mail.mud.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Zhou,

Your question will get more attention if you send it to nutch-user@lucene.apache.org list instead.  This list is for Lucene Java.

 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: "jyzhou817@yahoo.com" <jyzhou817@yahoo.com>
> To: java-user@lucene.apache.org
> Sent: Tue, January 12, 2010 10:51:59 PM
> Subject: how to follow intranet: configuration in nutch website
> 
> Hi,
> 
> I try to following the instruction from 
> http://lucene.apache.org/nutch/tutorial8.html
> .....
> Intranet: Configuration
> To configure things for intranet crawling you must:1. Create a directory with a 
> flat file of root urls.  For example, to
> crawl the nutch site you might start with a file named
> urls/nutch containing the url of just the Nutch home
> page.  All other Nutch pages should be reachable from this page.  The
> urls/nutch file would thus contain:
> http://lucene.apache.org/nutch/
> 
> ....
> 
> not understand. Can anyone help me out. 
> 
> Thanks.
> zhou
> 
> 
>       New Email addresses available on Yahoo!
> Get the Email name you've always wanted on the new @ymail and @rocketmail. 
> Hurry before someone else does!
> http://mail.promotions.yahoo.com/newdomains/sg/


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44497-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 04:09:23 2010
Return-Path: <java-user-return-44497-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75431 invoked from network); 13 Jan 2010 04:09:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 04:09:23 -0000
Received: (qmail 65066 invoked by uid 500); 13 Jan 2010 04:09:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64899 invoked by uid 500); 13 Jan 2010 04:09:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64889 invoked by uid 99); 13 Jan 2010 04:09:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 04:09:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.55] (HELO web50301.mail.re2.yahoo.com) (206.190.38.55)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 13 Jan 2010 04:09:11 +0000
Received: (qmail 37622 invoked by uid 60001); 13 Jan 2010 04:08:49 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263355729; bh=dnUz5zsHFreNFy38sAu4i7DbBtsITQTsX6LtCtaUOV8=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=Cuvx5tGIO+NnJKg1j425DwnvRXJ6kYFTTKW6rROu24aMTCQpdGBa1B5KN9IEjtke9OEJ8AkCFFpUXxdNMoKo4TlPfZLrClEoWF4/uriuGtBx9UQZ0pKegCH8lUf79FxZM64cjPhmMi/aKdVALFpn41sjADqF8ogGKj5WhPdovuU=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=poLl3PMi0d4EBlLzT8pvafpnekV8dbsuT+WEVqq7y8+D1/JfiY1J2VzUuu8RhLLEQvS4x3QGIwI5k1ywco+giGbvaVpGivYwvizdF+LDEm4nvgDAHA/k8Psm+7RbBe1KXRtzIb2xCqEAHkuv13zmhCHHvDJ3kxTo5ct4FBHWXec=;
Message-ID: <780007.36595.qm@web50301.mail.re2.yahoo.com>
X-YMail-OSG: 8tqLK0YVM1nY.HL1.0.y8EQ9ItzOTeiReWcmdPVui7rrFC0uSHyfg_fwGntVJ_0cK8VPLzhCe9JoBUyQ0mOmLXiFE8SGO7l8VR_b4LrNyC0BfGT5CiYOcwg8zBO0JpCXVpMrTs677l96NWztlWGf.IShmFVUABycCqbIjtiHf31T1Tp.hMvOkMdrHp.ZRjI36IkS_odz3P18WhlN1tijvt5BPZQXhob2EW_uj0wFbldF5oWEIDzFUmS.FbXPA5uvOxfm8Llhn1nZ9NKBiQnRMGa3Su2gvOmdTATbpmKnWBAMlI9cB_5nEPBeAc9fKYdmRIM1qeqAWPsiEP4Du8apEfRhTmO5WsVPR2f20PJGTC2LOOH7fIpGKz2SEgKqfyPivvplRzo2Tughn1i6yBllpgJZozH7TTidcdDcY5pLtMieH4gTHW4viVKrV.Dp70ANwah0R8N35l.jFkrEDzk7K6k8JbpyICt2FzCQp8iKBJ4.VsXMnvJDojo1mu16WeaxLYBgowHQwz8jAHjILleuP.Gg2pWVRJvyJEZkhwVIhqugHkrX4_M6kqlLw5zPlWfBDqOX_ef2vs1Dfdy3GSmUtQGPCtlbT2NVwGmKRxfrcGs8edasITKYk6KiAYwnUZ50q4rbDtiwnxFQ4J1usyoFwF9uUuYpVatJmoaRNJspKds1jzAeiw.S4WF_YqqWoknkAKx7Pg2NbnxzhiYh8ysHR1Lz0J7B.YpycLk-
Received: from [74.73.1.126] by web50301.mail.re2.yahoo.com via HTTP; Tue, 12 Jan 2010 20:08:49 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <27139147.post@talk.nabble.com>
Date: Tue, 12 Jan 2010 20:08:49 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: lucene index file randomly crash and need to reindex
To: java-user@lucene.apache.org
In-Reply-To: <27139147.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Hi,

Use the latest version of Lucene, obey Lucene's locks, write with 1 IndexWriter, avoid NFS...

 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: zhang99 <second_comet@yahoo.com>
> To: java-user@lucene.apache.org
> Sent: Tue, January 12, 2010 10:41:19 PM
> Subject: lucene index file randomly crash and need to reindex
> 
> 
> how you all deal wich such issue of occasionally need to reindex? what
> recommendation do you suggest to minimize this?
> -- 
> View this message in context: 
> http://old.nabble.com/lucene-index-file-randomly-crash-and-need-to-reindex-tp27139147p27139147.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44498-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 04:53:32 2010
Return-Path: <java-user-return-44498-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83566 invoked from network); 13 Jan 2010 04:53:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 04:53:32 -0000
Received: (qmail 95783 invoked by uid 500); 13 Jan 2010 04:53:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95632 invoked by uid 500); 13 Jan 2010 04:53:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95622 invoked by uid 99); 13 Jan 2010 04:53:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 04:53:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 04:53:21 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUvE4-0006WR-Mj
	for java-user@lucene.apache.org; Tue, 12 Jan 2010 20:53:00 -0800
Message-ID: <27139432.post@talk.nabble.com>
Date: Tue, 12 Jan 2010 20:53:00 -0800 (PST)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: Is it possible to do a PhraseQuery using XML Query Parser?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fayyazuddin@gmail.com


Dear fellow Java developers:

Is it possible to do a PhraseQuery when using the XML Query Parser?  I
checked the documentation for the XML Query Parser, and it has tags for a
multitude of queries, with PhraseQuery absent from the list.  Is it possible
to do a PhraseQuery using the XMLQueryParser, and if not, is there a way to
implement this functionality?  Just wondering.

Thanks in advance to all who reply.

Sincerely;
Fayyaz


-- 
View this message in context: http://old.nabble.com/Is-it-possible-to-do-a-PhraseQuery-using-XML-Query-Parser--tp27139432p27139432.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44499-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 05:46:15 2010
Return-Path: <java-user-return-44499-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2393 invoked from network); 13 Jan 2010 05:46:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 05:46:15 -0000
Received: (qmail 25267 invoked by uid 500); 13 Jan 2010 05:46:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24974 invoked by uid 500); 13 Jan 2010 05:46:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24964 invoked by uid 99); 13 Jan 2010 05:46:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 05:46:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.163.179.218] (HELO web36104.mail.mud.yahoo.com) (66.163.179.218)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 13 Jan 2010 05:46:02 +0000
Received: (qmail 69124 invoked by uid 60001); 13 Jan 2010 05:45:40 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263361540; bh=UkxAa/gm9L9tENd3YX7T3/7BZ6HUqFJQm73h0maBFLc=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=S4UF/iUWm/R8P7ndJwzdp+2TETI88QHBCJ+T+76fEfUSG0MdnMIUvHFqlfG1KaDIhk9xdES+MXKP7uob/R64BXn7eI4OPU/2C6Hkdg8p7e4LnXDBfkZ9ApdRNICOzpfcgonZC5oIQoN5iPfRBZvjEmDWoYZhwn39uGhehQRoKR8=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=ifwpuwZvrK/nv/H+VrLqFLHCPkx23mZglH0WRbvJ8Oy9qZa4ZQaSPito97WBCn3vhGqpEY5wRcZ61EiGhSKoJd4lrqpAZYIAfv20iB66A6DBpkyq/stqLgGdKKkK0qaqavYBVEPR0STqH4d1aQSqJzBdr7gSajCO5mK36q++9yI=;
Message-ID: <184800.68321.qm@web36104.mail.mud.yahoo.com>
X-YMail-OSG: zOzrrRgVM1lCxE9aeH.uJAtBPkF0mIvWIEMgAx_91GlXyLr4o6nR3nQGeot8dQgoCa64xW.lRsduoFk0yQwgTxxOzapuiFKc8GsjtxgsWHF1Ftc_Dm0HLhfr7Z455uqpwxrEdYS978F3byYL.2C3Ob61BmbpKYQiwcaUCQJYcHuzc9vmc6xq2SosWu08F2HoKOC7KOC5WILZ6riIZEDpVvus1ww2ilX4Yrib.Fw1FUqR19QRQg6BZPdI1CKPpRnApxcsA41sxF85aiFDyJYsFBN6cTgVo7szFk2HDQifX1SIfBrmXZq5fLpYmkDdhhCu19jJIiBY.BgAWGRgQP52xktxlXwHXQiO_eHdgIVS00hYqxAS0lN_ULpewvW8uMdZsUoklM2BJLCJUgLs37pTe3MAwx6ivlMEaerh89N4BLF53ZWOrryD_IUYELCbeTweyBnNS0zWg_ttENnBIS7RWhA5XxAGrzSykwWadRF5l0E.AoDysPZD.AuvzKsmpyFnTGkr2YHfO80tTDEf3hSGJSSUxLRFw7gc.JXFQ1Ti1I3oWYbXTotBRM4Gn4IcdfnA2XGw0uN9NPcHDwh.c3HZtsXWttDN.yCESBp1BTIb5QwCCzx4sFQex4ejWz.fHNGCbEj8DAFvzhK5Tcg2HdhhYeu4TSMSTQe3ynrUbpbIquZC6EHbWt1DYLsiEzSAxDPZLt5Jkv7.ti9cB6zHg6l3E4Tf.IUlvvLXpmwx3Yti9j143k1YGpVtJVWPIkCZocxRSUiyfxERQq.UnlBbjA--
Received: from [203.126.190.28] by web36104.mail.mud.yahoo.com via HTTP; Tue, 12 Jan 2010 21:45:39 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Tue, 12 Jan 2010 21:45:39 -0800 (PST)
From: <jyzhou817@yahoo.com>
Subject: Re: how to follow intranet: configuration in nutch website
To: java-user@lucene.apache.org
In-Reply-To: <682977.36627.qm@web50307.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1222978012-1263361539=:68321"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1222978012-1263361539=:68321
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Thanks.

--- On Wed, 13/1/10, Otis Gospodnetic <otis_gospodnetic@yahoo.com> wrote:

From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: how to follow intranet: configuration in nutch website
To: java-user@lucene.apache.org
Date: Wednesday, 13 January, 2010, 12:07 PM

Zhou,

Your question will get more attention if you send it to nutch-user@lucene.a=
pache.org list instead.=A0 This list is for Lucene Java.

 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: "jyzhou817@yahoo.com" <jyzhou817@yahoo.com>
> To: java-user@lucene.apache.org
> Sent: Tue, January 12, 2010 10:51:59 PM
> Subject: how to follow intranet: configuration in nutch website
>=20
> Hi,
>=20
> I try to following the instruction from=20
> http://lucene.apache.org/nutch/tutorial8.html
> .....
> Intranet: Configuration
> To configure things for intranet crawling you must:1. Create a directory =
with a=20
> flat file of root urls.=A0 For example, to
> crawl the nutch site you might start with a file named
> urls/nutch containing the url of just the Nutch home
> page.=A0 All other Nutch pages should be reachable from this page.=A0 The
> urls/nutch file would thus contain:
> http://lucene.apache.org/nutch/
>=20
> ....
>=20
> not understand. Can anyone help me out.=20
>=20
> Thanks.
> zhou
>=20
>=20
>=A0 =A0 =A0=A0=A0New Email addresses available on Yahoo!
> Get the Email name you've always wanted on the new @ymail and @rocketmail=
.=20
> Hurry before someone else does!
> http://mail.promotions.yahoo.com/newdomains/sg/


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

=0A=0A=0A      
--0-1222978012-1263361539=:68321--

From java-user-return-44500-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 06:12:28 2010
Return-Path: <java-user-return-44500-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14168 invoked from network); 13 Jan 2010 06:12:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 06:12:28 -0000
Received: (qmail 47923 invoked by uid 500); 13 Jan 2010 06:12:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47751 invoked by uid 500); 13 Jan 2010 06:12:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47741 invoked by uid 99); 13 Jan 2010 06:12:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 06:12:25 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 06:12:15 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NUwSQ-0002hU-KB
	for java-user@lucene.apache.org; Tue, 12 Jan 2010 22:11:54 -0800
Message-ID: <27139613.post@talk.nabble.com>
Date: Tue, 12 Jan 2010 22:11:54 -0800 (PST)
From: zhang99 <second_comet@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: lucene index file randomly crash and need to reindex
In-Reply-To: <780007.36595.qm@web50301.mail.re2.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: second_comet@yahoo.com
References: <27139147.post@talk.nabble.com> <780007.36595.qm@web50301.mail.re2.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org


what is the longest time you ever keep index file without required to
reindex. i notice even big open source life liferay suffer from this. 
thanks for the tips
-- 
View this message in context: http://old.nabble.com/lucene-index-file-randomly-crash-and-need-to-reindex-tp27139147p27139613.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44501-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 10:23:20 2010
Return-Path: <java-user-return-44501-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6770 invoked from network); 13 Jan 2010 10:23:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 10:23:20 -0000
Received: (qmail 84830 invoked by uid 500); 13 Jan 2010 10:23:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84764 invoked by uid 500); 13 Jan 2010 10:23:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84754 invoked by uid 99); 13 Jan 2010 10:23:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 10:23:18 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 10:23:08 +0000
Received: by ywh14 with SMTP id 14so21816812ywh.20
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 02:22:47 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.47.2 with SMTP id u2mr10023503ybu.245.1263378166845; Wed, 
	13 Jan 2010 02:22:46 -0800 (PST)
In-Reply-To: <27139613.post@talk.nabble.com>
References: <27139147.post@talk.nabble.com>
	 <780007.36595.qm@web50301.mail.re2.yahoo.com>
	 <27139613.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 05:22:46 -0500
Message-ID: <9ac0c6aa1001130222o5cdd157cycd5ab97c6a67d840@mail.gmail.com>
Subject: Re: lucene index file randomly crash and need to reindex
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

If you follow the rules Otis listed, you should never hit index
corruption, unless something is wrong with your hardware.

Or, if you hit an as-yet-undiscovered bug in Lucene ;)

Mike

On Wed, Jan 13, 2010 at 1:11 AM, zhang99 <second_comet@yahoo.com> wrote:
>
> what is the longest time you ever keep index file without required to
> reindex. i notice even big open source life liferay suffer from this.
> thanks for the tips
> --
> View this message in context: http://old.nabble.com/lucene-index-file-randomly-crash-and-need-to-reindex-tp27139147p27139613.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44502-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 10:59:41 2010
Return-Path: <java-user-return-44502-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18305 invoked from network); 13 Jan 2010 10:59:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 10:59:41 -0000
Received: (qmail 40919 invoked by uid 500); 13 Jan 2010 10:59:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40841 invoked by uid 500); 13 Jan 2010 10:59:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40831 invoked by uid 99); 13 Jan 2010 10:59:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 10:59:38 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 10:59:30 +0000
Received: by ywh14 with SMTP id 14so21833391ywh.20
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 02:59:09 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.35.24 with SMTP id i24mr15836856ybi.348.1263380347883; 
	Wed, 13 Jan 2010 02:59:07 -0800 (PST)
In-Reply-To: <Pine.LNX.4.64.1001121720120.19492@radix.cryptio.net>
References: <Pine.LNX.4.64.1001121720120.19492@radix.cryptio.net>
Date: Wed, 13 Jan 2010 05:59:07 -0500
Message-ID: <9ac0c6aa1001130259n76a4fc90mc88cdcdb97454ce3@mail.gmail.com>
Subject: Re: Supported way to get segment from IndexWriter?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Indeed, getReader is an expensive way to get the segment count (it
flushes the current RAM buffer to disk as a new segment).

Since SegmentInfos is now public, you could use SegmentInfos.read to
read the current segments_N file, and then call its .size() method?

But, this will only count as of the last commit... which is probably
not sufficient for SOLR-1559?

We could simply make getSegmentCount public / expert / not only for tests?

Mike

On Tue, Jan 12, 2010 at 8:42 PM, Chris Hostetter
<hossman_lucene@fucit.org> wrote:
>
> A conversation with someone earlier today got me thinking about cranking =
out
> a patch for SOLR-1559 (in which the goal is to allow for rules do dermine
> the iput to optimize(maxNumSegments) instead of requiring a fixed integer
> value as input) =A0when i realized that i wasn't certain what "approved"
> methods there might be for deterrmining hte current number of segments fr=
om
> an IndexWriter.
>
> I see IndexWriter.getSegmentCount() but it's package protected (with a
> comment that it exists for tests). =A0So my best guess using only public =
APIs
> would be something like...
>
> =A0int numCurrentSegments =3D -1;
> =A0IndexReader r =3D writer.getReader();
> =A0try {
> =A0 IndexReader[]tmp =3D r.getSequentialSubReaders();
> =A0 numCurrentSegments =3D null=3D=3Dtmp ? 1 : tmp.length;
> =A0} finally {
> =A0 r.close();
> =A0}
>
> Is there a better way?
>
> (My main concern about this approach being that my intuition (which seems
> supported by the javadocs) is that getReader might be a little
> expensive/excesive just to count the segments)
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44503-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 11:07:53 2010
Return-Path: <java-user-return-44503-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20558 invoked from network); 13 Jan 2010 11:07:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 11:07:53 -0000
Received: (qmail 55629 invoked by uid 500); 13 Jan 2010 11:07:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55577 invoked by uid 500); 13 Jan 2010 11:07:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55567 invoked by uid 99); 13 Jan 2010 11:07:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 11:07:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 11:07:42 +0000
Received: by yxe30 with SMTP id 30so25937291yxe.29
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 03:07:21 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.17.2 with SMTP id u2mr580081ybi.110.1263380840860; Wed, 13 
	Jan 2010 03:07:20 -0800 (PST)
In-Reply-To: <27116739.post@talk.nabble.com>
References: <27116739.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 06:07:20 -0500
Message-ID: <9ac0c6aa1001130307y401aec2y5f03f6909a82af8e@mail.gmail.com>
Subject: Re: Text extraction from ms word doc
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

We could also fix WhitespaceAnalyzer to filter that character out?
(Or you could make your own analyzer to do so...).

You could also try asking on the tika-user list whether Tika has a
solution for mapping "extended" whitespace characters...

Mike

On Mon, Jan 11, 2010 at 3:04 PM, maxSchlein <m_schlein@hotmail.com> wrote:
>
> I was looking for an option for Text extraction from a word doc.
>
> Currently I am using POI; however, when there is a table in the doc, for
> each column POI brings back a =A0. =A0The whitespace analyzer is not filt=
ering
> out this character. =A0So whatever word or phrase that is the last word o=
r
> phrase within a table column is not found during searching. =A0That is, i=
f the
> word dog is the only word in a column, a search for the word dog would
> return nothing because the word that was indexed was "dog ".
>
> I can create a filter to fix this, using Apache's
> StringUtils.isAsciiPrintable, but I would rather not.
>
> Any and all help is welcome and thanked.
> --
> View this message in context: http://old.nabble.com/Text-extraction-from-=
ms-word-doc-tp27116739p27116739.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44504-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 11:21:43 2010
Return-Path: <java-user-return-44504-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23083 invoked from network); 13 Jan 2010 11:21:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 11:21:43 -0000
Received: (qmail 73854 invoked by uid 500); 13 Jan 2010 11:21:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73784 invoked by uid 500); 13 Jan 2010 11:21:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73774 invoked by uid 99); 13 Jan 2010 11:21:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 11:21:41 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.217.215] (HELO mail-gx0-f215.google.com) (209.85.217.215)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 11:21:33 +0000
Received: by gxk7 with SMTP id 7so21846206gxk.12
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 03:21:11 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.17.2 with SMTP id u2mr597929ybi.110.1263381671426; Wed, 13 
	Jan 2010 03:21:11 -0800 (PST)
In-Reply-To: <27097887.post@talk.nabble.com>
References: <27056573.post@talk.nabble.com> <27058014.post@talk.nabble.com>
	 <9ac0c6aa1001070332m604ec9case3ea753633bdd0db@mail.gmail.com>
	 <27062291.post@talk.nabble.com>
	 <9ac0c6aa1001070902y5cb8780coa4ed38f86403bc04@mail.gmail.com>
	 <27092361.post@talk.nabble.com>
	 <9ac0c6aa1001100346u36f1a69at48200b9fdd2da65d@mail.gmail.com>
	 <27097693.post@talk.nabble.com>
	 <9ac0c6aa1001100410v7f471708t515bc0fad0bec12b@mail.gmail.com>
	 <27097887.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 06:21:11 -0500
Message-ID: <9ac0c6aa1001130321u5f818e49u6415862dbb259e37@mail.gmail.com>
Subject: Re: Is there a way to limit the size of an index?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Sun, Jan 10, 2010 at 7:33 AM, Dvora <barak.yaish@gmail.com> wrote:
>
> I'm storing and reading the documents using Compass, not Lucene directly. I
> didn't touch those parameters, so I guess the default values are being used
> (I do see cfs files in the index).

OK.  If your index directory has *.cfs files, then you are using the
default compound file format (I'm not sure whether Compass changes
that default either).

> How the ramBufferSizeMB parameter affect the files size? What value should I
> use in order to have 6MB files?

ramBufferSizeMB controls how big the initially created segments are.
Just how big a segment you get for a given ramBufferMB is very app
dependent, because the RAM efficiency of IndexWriter depends on things
like whether you have many unique terms (= worse RAM efficiency).
Generally larger RAM buffers have better efficiency.

Merging can only create bigger segments from those flushed segments.

So, you have to ensure ramBufferSizeMB is set such that in your use
case it never up and flushes a segment bigger than your 10 MB size
limit.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44505-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 13:06:14 2010
Return-Path: <java-user-return-44505-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56337 invoked from network); 13 Jan 2010 13:06:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 13:06:14 -0000
Received: (qmail 6162 invoked by uid 500); 13 Jan 2010 13:06:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6085 invoked by uid 500); 13 Jan 2010 13:06:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6075 invoked by uid 99); 13 Jan 2010 13:06:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 13:06:12 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 13:06:02 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id E092DCD247
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 08:05:39 -0500 (EST)
Received: from heartbeat2.messagingengine.com ([10.202.2.161])
  by compute1.internal (MEProxy); Wed, 13 Jan 2010 08:05:39 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=BboPHKJTLTSTn2bvdYP7mboCrag=; b=V+KSoVEzeVKTBpNUAfrZEmZb8MtktUejIpfyBRyCvb2ax27byWwQgBB6UiiCsYxnT6EGsfczyaPy7D09mDC+J/WexJS6pq7bbWFn+egPfIpPwQ0h7fOGPxPycHnAeAb+e0Rq8C2oa2vjyp4NNoz04EBTOkI2Fnsp4TGAkVnA/DA=
X-Sasl-enc: G1mU2LeeSlq256oUfU02NGbdkN5q244jUw75kj1Esa0J 1263387938
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 8E7389C39
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 08:05:38 -0500 (EST)
Message-ID: <4B4DC521.6020803@fastmail.fm>
Date: Wed, 13 Jan 2010 13:05:37 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Is there any difference in a document between one added field
 	with a number of terms and a field added a number of times ?
References: <4B4CDB8C.7030804@fastmail.fm> <c4e715d71001121244u569e8c62ib6a8f7a888767e7a@mail.gmail.com> <4B4CE17F.2020706@fastmail.fm>
In-Reply-To: <4B4CE17F.2020706@fastmail.fm>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

So not much help here, (I wonder if its because I posted 3 questions in 
one day) but Ive made some progress in my understaning.

I understand there is only one norm per field and I think Lucene does no 
differentiating between adding the same field a number of times and 
adding mutiple text to the same field. But Ive discovered 
getPositionIncrementGap() to seperate my multiple adds of the same field 
within a doc and I was wondering if they was a way I could use the 
position gap to get DefaultSimailrity.lengthNorm() to be called with 
only the number of tokens within one field passed to it rather than the 
complete terms within the field as a whole.

Paul

Paul Taylor wrote:
> Thanks Felipe, but you  are missing the point Artist really doesnt 
> come into it, my problem is confined to the alias field, forget about 
> artist its just detailed to give the complete scenario
>
> Paul
>
> Felipe wrote:
>> You could change the boost of the field artist to be bigger than the 
>> field alias.
>>     field.setBoost(artistBoost);
>>
>>
>> 2010/1/12 Paul Taylor <paul_t100@fastmail.fm 
>> <mailto:paul_t100@fastmail.fm>>
>>
>>     Been doing some analysis with Luke (BTW doesnt work with
>>     StandardAnalyzer since Version field introduced) and discovered a
>>     problem with field lenghth boosting for me.
>>
>>     I have a document that represents a recording artist (i.e Madonna,
>>     The Beatles ectera) it contains an artist and an alias field, the
>>     alias field contains other names that the artist is maybe known
>>     as, and so there can be multiple aliases for an artist.
>>
>>     PseudoCode:
>>     (
>>     doc.addField(ArtistIndexField.ARTIST, rs.getString("name"));
>>     for (String alias : aliases.get(artistId)) {
>>         doc.addField(ArtistIndexField.ALIAS, alias);
>>     }
>>     )
>>
>>     Im finding that when I search by for the artist by the alias field
>>     if the value matches an alias in two different documents the
>>     document with the least number of aliases get the best score
>>     because the boost of the alias is split between the aliases on the
>>     other doc, if I ANALYSED_NO_NORMS then both documents return the
>>     same score.
>>
>>     The trouble is I don't want to disable norms because I want a
>>     match on a single field containing less terms to score better than
>>     one with more scores.
>>
>>     Full example:
>>
>>     
>> http://musicbrainz.org/search/textsearch.html?query=minihamuzu&type=artist&limit=25&adv=on&handlearguments=1 
>>
>>     
>> <http://musicbrainz.org/search/textsearch.html?query=minihamuzu&type=artist&limit=25&adv=on&handlearguments=1> 
>>
>>     return two results , the second result only has score of 8 because
>>     it more aliases than the first result, even the alias it matched
>>     on was an exact single term match.
>>     http://musicbrainz.org/show/artist/aliases.html?artistid=174327
>>
>>     but if I remove norms then the following query (which is currently
>>     working)
>>
>>     
>> http://musicbrainz.org/search/textsearch.html?query=%22the+beatles%22&type=artist&limit=25&adv=on&handlearguments=1 
>>
>>     
>> <http://musicbrainz.org/search/textsearch.html?query=%22the+beatles%22&type=artist&limit=25&adv=on&handlearguments=1> 
>>
>>
>>     would stop working, in that  searching for 'The beatles' would no
>>     longer score rate artist 'The Beatles' better than 'The Beatles
>>     revival Band'
>>
>>     So isn't there any way to recognise that repeated calls to
>>     addField() is not creating a single field with many terms,but many
>>     fields with few terms.
>>
>>     thanks Paul
>>
>>
>>
>>
>>     
>> ---------------------------------------------------------------------
>>     To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>     <mailto:java-user-unsubscribe@lucene.apache.org>
>>     For additional commands, e-mail: java-user-help@lucene.apache.org
>>     <mailto:java-user-help@lucene.apache.org>
>>
>>
>>
>>
>> -- 
>> Felipe Lobo
>> www.jusbrasil.com.br <http://www.jusbrasil.com.br>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44506-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 13:31:13 2010
Return-Path: <java-user-return-44506-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67280 invoked from network); 13 Jan 2010 13:31:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 13:31:13 -0000
Received: (qmail 42349 invoked by uid 500); 13 Jan 2010 13:31:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42240 invoked by uid 500); 13 Jan 2010 13:31:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42225 invoked by uid 99); 13 Jan 2010 13:31:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 13:31:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of benhei@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 13:31:02 +0000
Received: by fxm2 with SMTP id 2so21163267fxm.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 05:30:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=uiDBDhKBS23foOtC3Gh80EYYQ1HTqtPrXU/z63KiAsI=;
        b=EndZEJ6QjPXOH13buG5J0BeTX4MrU57GxpK9Fm72seY2+6LQmSCTzF44OP3rTXAxyY
         TL7+w2QwJ9VweoiJJACMjaHBwxuKWwxfoL8djiqDPpfhbUBYdSW/m6ICgmrbzxuRf/bs
         FySz+Ew2mYIniQ/PIkYe5LbzartE+fqFqYrCQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=IsruhRwjI5Eb+TKL5FkznecY0PCtX3cx6/fM93d+ORz7+7I4HYYVhcV9sgEYqJfM6y
         9pxd4lt+gPgQQIk+utz391j/HfUYqEoKjWPdOIsz8LOUvapP1qiUmCk6F6KwL8RmVUwW
         RyEvPDo3bXfyAuh8TmfheUbzO29mlEBWBFrOY=
MIME-Version: 1.0
Received: by 10.223.17.19 with SMTP id q19mr2390477faa.75.1263389442559; Wed, 
	13 Jan 2010 05:30:42 -0800 (PST)
In-Reply-To: <94095f521001110914qe138944he69aac0b3bb85c52@mail.gmail.com>
References: <94095f521001110914qe138944he69aac0b3bb85c52@mail.gmail.com>
Date: Wed, 13 Jan 2010 14:30:42 +0100
Message-ID: <94095f521001130530n7690fc5l88c26170679d035b@mail.gmail.com>
Subject: Re: Field creation with TokenStream and stored value
From: Benjamin Heilbrunn <benhei@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry for pushing this thing.

Would it be possible to add the demanded constructor or would it break
anything of lucenes logic?


2010/1/11 Benjamin Heilbrunn <benhei@gmail.com>:
> Hey out there,
>
> in lucene it's not possible to create a Field based on a TokenStream
> AND supply a stored value.
>
> Is there a reason why a Field constructor in the form of
> =A0 public Field(String name, TokenStream tokenStream, String storedValue=
)
> does not exist?
>
> I am using trees of TeeSinkTokenFilter's for the creation of many
> fields, based on a source string.
> That's the reason why I can't use the "standardconstructor"
> =A0 =A0public Field(String name, String value, Store store, Index index)
>
>
> Regards
> Benjamin
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44507-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 13:53:41 2010
Return-Path: <java-user-return-44507-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77599 invoked from network); 13 Jan 2010 13:53:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 13:53:41 -0000
Received: (qmail 67060 invoked by uid 500); 13 Jan 2010 13:53:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66983 invoked by uid 500); 13 Jan 2010 13:53:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66972 invoked by uid 99); 13 Jan 2010 13:53:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 13:53:39 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 13:53:29 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 49C3F45F56C
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 14:53:08 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id XLMwMGdanlMA for <java-user@lucene.apache.org>;
	Wed, 13 Jan 2010 14:52:58 +0100 (CET)
Received: from VEGA (unknown [134.102.249.78])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 494FE45F558
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 14:52:58 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <94095f521001110914qe138944he69aac0b3bb85c52@mail.gmail.com> <94095f521001130530n7690fc5l88c26170679d035b@mail.gmail.com>
In-Reply-To: <94095f521001130530n7690fc5l88c26170679d035b@mail.gmail.com>
Subject: RE: Field creation with TokenStream and stored value
Date: Wed, 13 Jan 2010 14:52:58 +0100
Message-ID: <000001ca9457$b72fcff0$258f6fd0$@de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqUVLPo2kA6nLBWT/WT08xZuEMtswAAuKww
Content-Language: de

Why not simply add the field twice, one time with TokenStream, one time =
stored only? Internally stored/indexed fields are handled like that.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Benjamin Heilbrunn [mailto:benhei@gmail.com]
> Sent: Wednesday, January 13, 2010 2:31 PM
> To: java-user@lucene.apache.org
> Subject: Re: Field creation with TokenStream and stored value
>=20
> Sorry for pushing this thing.
>=20
> Would it be possible to add the demanded constructor or would it break
> anything of lucenes logic?
>=20
>=20
> 2010/1/11 Benjamin Heilbrunn <benhei@gmail.com>:
> > Hey out there,
> >
> > in lucene it's not possible to create a Field based on a TokenStream
> > AND supply a stored value.
> >
> > Is there a reason why a Field constructor in the form of
> >   public Field(String name, TokenStream tokenStream, String
> storedValue)
> > does not exist?
> >
> > I am using trees of TeeSinkTokenFilter's for the creation of many
> > fields, based on a source string.
> > That's the reason why I can't use the "standardconstructor"
> >    public Field(String name, String value, Store store, Index index)
> >
> >
> > Regards
> > Benjamin
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44508-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 14:27:07 2010
Return-Path: <java-user-return-44508-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95903 invoked from network); 13 Jan 2010 14:27:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 14:27:06 -0000
Received: (qmail 44797 invoked by uid 500); 13 Jan 2010 14:27:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44720 invoked by uid 500); 13 Jan 2010 14:27:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44572 invoked by uid 99); 13 Jan 2010 14:27:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 14:27:02 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 14:26:54 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NV4B7-0003SU-MD
	for java-user@lucene.apache.org; Wed, 13 Jan 2010 06:26:33 -0800
Message-ID: <27145825.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 06:26:33 -0800 (PST)
From: Konstantyn Smirnov <injecteer@yahoo.com>
To: java-user@lucene.apache.org
Subject: NullPointerExc in CloseableThreadLocal... (Lucene 3.0.0)
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: injecteer@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi all

Consider the following piece of code:

Searcher s = this.getSearcher()
def hits = s.search( query, filter, params.offset + params.max, sort )

for( hit in hits.scoreDocs[ lower..<upper ] ){
   def obj = binder( s.doc( hit.doc ), hit.doc ) // << here the NPE is
thrown
}

the code *sporadically* throws the following:

        ... 6 more
Caused by: java.lang.NullPointerException
        at
org.apache.lucene.util.CloseableThreadLocal.get(CloseableThreadLocal.java:64)
        at
org.apache.lucene.index.SegmentReader.getFieldsReader(SegmentReader.java:778)
        at
org.apache.lucene.index.SegmentReader.document(SegmentReader.java:879)
        at
org.apache.lucene.index.DirectoryReader.document(DirectoryReader.java:518)
        at
org.apache.lucene.index.IndexReader.document(IndexReader.java:658)
        at
org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:144)
        at SearchableService.asResult(SearchableService.groovy:128)

I assume, that the reason for that could be indexing of a new document/
expungeDeletes() / re-openning the IndexReader. 

Can you elaborate on this? Shall I implement/configure some sort of
time-out?

Thanks in advance

-----
Konstantyn Smirnov, CTO 
http://www.poiradar.ru www.poiradar.ru 
http://www.poiradar.com.ua www.poiradar.com.ua 
http://www.poiradar.com www.poiradar.com 
http://www.poiradar.de www.poiradar.de 
-- 
View this message in context: http://old.nabble.com/NullPointerExc-in-CloseableThreadLocal...-%28Lucene-3.0.0%29-tp27145825p27145825.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44509-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 14:30:14 2010
Return-Path: <java-user-return-44509-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98413 invoked from network); 13 Jan 2010 14:30:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 14:30:14 -0000
Received: (qmail 54080 invoked by uid 500); 13 Jan 2010 14:30:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54024 invoked by uid 500); 13 Jan 2010 14:30:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54014 invoked by uid 99); 13 Jan 2010 14:30:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 14:30:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of benhei@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 14:30:03 +0000
Received: by fxm2 with SMTP id 2so21226006fxm.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 06:29:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=RujGrWWmsujqYelQ8pqkiAcpPKXYQ7reRmcLiZday+k=;
        b=m6l+9ZVVPAF2uDhwc5EFS40JxWhmjfJpATAlJ1u1tOLWbJvqQx/eHrltPi4XO6U4C6
         o5XltUBuvXEpmd8jeMXrX+CZRolvpAxPTASfo/RItoyoub/pK5oxedDh1AguxOy8zIOO
         qQBxZtn31DdS3EwsUdFuHSIoXVcZuYwEO2TCA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=ZzpDEKYF5j7G2i3q9NMakKT1KP2GwQ8bI67g+F8hGXIjRGF4gW09PKz1Fg+StASzbl
         RLPP476HfjvXeHEGr62YtVYP1KgUjocy/LOFhRI4vSAQSqCnl5xX27sBwhYZraJNVXu9
         mLLNGnhyp2YHILwtKlplRCYutI/r0qhXwxFHU=
MIME-Version: 1.0
Received: by 10.223.143.12 with SMTP id s12mr2180521fau.30.1263392981471; Wed, 
	13 Jan 2010 06:29:41 -0800 (PST)
In-Reply-To: <000001ca9457$b72fcff0$258f6fd0$@de>
References: <94095f521001110914qe138944he69aac0b3bb85c52@mail.gmail.com>
	 <94095f521001130530n7690fc5l88c26170679d035b@mail.gmail.com>
	 <000001ca9457$b72fcff0$258f6fd0$@de>
Date: Wed, 13 Jan 2010 15:29:41 +0100
Message-ID: <94095f521001130629l14ce43e4o11e76901288627d7@mail.gmail.com>
Subject: Re: Field creation with TokenStream and stored value
From: Benjamin Heilbrunn <benhei@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Thanks!
Didn't know that it's so easy ;)

2010/1/13 Uwe Schindler <uwe@thetaphi.de>:
> Why not simply add the field twice, one time with TokenStream, one time s=
tored only? Internally stored/indexed fields are handled like that.
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>> -----Original Message-----
>> From: Benjamin Heilbrunn [mailto:benhei@gmail.com]
>> Sent: Wednesday, January 13, 2010 2:31 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Field creation with TokenStream and stored value
>>
>> Sorry for pushing this thing.
>>
>> Would it be possible to add the demanded constructor or would it break
>> anything of lucenes logic?
>>
>>
>> 2010/1/11 Benjamin Heilbrunn <benhei@gmail.com>:
>> > Hey out there,
>> >
>> > in lucene it's not possible to create a Field based on a TokenStream
>> > AND supply a stored value.
>> >
>> > Is there a reason why a Field constructor in the form of
>> > =A0 public Field(String name, TokenStream tokenStream, String
>> storedValue)
>> > does not exist?
>> >
>> > I am using trees of TeeSinkTokenFilter's for the creation of many
>> > fields, based on a source string.
>> > That's the reason why I can't use the "standardconstructor"
>> > =A0 =A0public Field(String name, String value, Store store, Index inde=
x)
>> >
>> >
>> > Regards
>> > Benjamin
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44510-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 14:41:38 2010
Return-Path: <java-user-return-44510-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4044 invoked from network); 13 Jan 2010 14:41:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 14:41:38 -0000
Received: (qmail 90317 invoked by uid 500); 13 Jan 2010 14:41:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90236 invoked by uid 500); 13 Jan 2010 14:41:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90226 invoked by uid 99); 13 Jan 2010 14:41:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 14:41:35 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [64.202.165.44] (HELO smtpauth22.prod.mesa1.secureserver.net) (64.202.165.44)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 13 Jan 2010 14:41:25 +0000
Received: (qmail 26902 invoked from network); 13 Jan 2010 14:41:02 -0000
Received: from unknown (81.219.54.251)
  by smtpauth22.prod.mesa1.secureserver.net (64.202.165.44) with ESMTP; 13 Jan 2010 14:41:01 -0000
Message-ID: <4B4DDB70.6060707@getopt.org>
Date: Wed, 13 Jan 2010 15:40:48 +0100
From: Andrzej Bialecki <ab@getopt.org>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.5) Gecko/20091204 Lightning/1.0b2pre Thunderbird/3.0
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Field creation with TokenStream and stored value
References: <94095f521001110914qe138944he69aac0b3bb85c52@mail.gmail.com>	 <94095f521001130530n7690fc5l88c26170679d035b@mail.gmail.com>	 <000001ca9457$b72fcff0$258f6fd0$@de> <94095f521001130629l14ce43e4o11e76901288627d7@mail.gmail.com>
In-Reply-To: <94095f521001130629l14ce43e4o11e76901288627d7@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

On 2010-01-13 15:29, Benjamin Heilbrunn wrote:
> Thanks!
> Didn't know that it's so easy ;)
>
> 2010/1/13 Uwe Schindler<uwe@thetaphi.de>:
>> Why not simply add the field twice, one time with TokenStream, one time stored only? Internally stored/indexed fields are handled like that.

Actually, you can implement your own Fieldable, and return what you want 
from its methods. You can also use Field constructor that takes the 
stored value, and then use Field.setTokenStream(TokenStream) - it 
doesn't override the stored value.


-- 
Best regards,
Andrzej Bialecki     <><
  ___. ___ ___ ___ _ _   __________________________________
[__ || __|__/|__||\/|  Information Retrieval, Semantic Web
___|||__||  \|  ||  |  Embedded Unix, System Integration
http://www.sigram.com  Contact: info at sigram dot com


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44511-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 16:40:12 2010
Return-Path: <java-user-return-44511-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42684 invoked from network); 13 Jan 2010 16:40:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 16:40:12 -0000
Received: (qmail 43240 invoked by uid 500); 13 Jan 2010 16:40:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43171 invoked by uid 500); 13 Jan 2010 16:40:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43161 invoked by uid 99); 13 Jan 2010 16:40:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 16:40:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [213.86.41.125] (HELO mail.truvo.com) (213.86.41.125)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 16:40:03 +0000
X-ASG-Debug-ID: 1263400780-171f00150000-H1Y1KX
X-Barracuda-URL: http://10.255.0.215:8000/cgi-bin/mark.cgi
Received: from exchq-001.wdnet.org (localhost [127.0.0.1])
	by mail.truvo.com (Spam Firewall) with ESMTP id E854B333CA
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 17:39:40 +0100 (CET)
Received: from exchq-001.wdnet.org (exchq-001.wdnet.org [10.100.10.5]) by mail.truvo.com with ESMTP id NsEMWJ6OhXN8YA3G for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 17:39:40 +0100 (CET)
X-ASG-Whitelist: Client
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA946F.0099B527"
X-ASG-Orig-Subj: Extracting contact data
Subject: Extracting contact data
Date: Wed, 13 Jan 2010 17:39:40 +0100
Message-ID: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Extracting contact data
Thread-Index: AcqUbwCLPvGK1XpkSD+azc6gYihYuA==
From: "Ortelli, Gian Luca" <gianluca.ortelli@truvo.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: exchq-001.wdnet.org[10.100.10.5]
X-Barracuda-Start-Time: 1263400780
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at truvo.com

------_=_NextPart_001_01CA946F.0099B527
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi community,

=20

I have a general understanding of Lucene concepts, and I'm wondering if
it's the right tool for my job:

=20

- I need to extract data like e.g. time intervals ("8am - 12pm"), street
addresses from a set of files. The common issue with this data unit is
that they contain spaces and are not always definable through regexes.

=20

- the extraction must take into consideration the "proximity": for
example, a mail address which is close to the work "Contacts" will
receive a higher rank, since I'm looking for contact data.

=20

Do you think I can get any advantage from building a solution on Lucene?

=20

  Gianluca


------_=_NextPart_001_01CA946F.0099B527--

From java-user-return-44512-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 16:52:50 2010
Return-Path: <java-user-return-44512-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47483 invoked from network); 13 Jan 2010 16:52:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 16:52:50 -0000
Received: (qmail 70994 invoked by uid 500); 13 Jan 2010 16:52:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70912 invoked by uid 500); 13 Jan 2010 16:52:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70902 invoked by uid 99); 13 Jan 2010 16:52:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 16:52:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 16:52:39 +0000
Received: by pxi16 with SMTP id 16so8394084pxi.29
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 08:52:17 -0800 (PST)
MIME-Version: 1.0
Received: by 10.115.101.15 with SMTP id d15mr3083837wam.200.1263401536418; 
	Wed, 13 Jan 2010 08:52:16 -0800 (PST)
In-Reply-To: <27145825.post@talk.nabble.com>
References: <27145825.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 11:52:16 -0500
Message-ID: <9ac0c6aa1001130852y52896135pdbb2c6955fe7c0ce@mail.gmail.com>
Subject: Re: NullPointerExc in CloseableThreadLocal... (Lucene 3.0.0)
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Is it possible you are closing the searcher before / while running
that for loop?

Mike

On Wed, Jan 13, 2010 at 9:26 AM, Konstantyn Smirnov <injecteer@yahoo.com> w=
rote:
>
> Hi all
>
> Consider the following piece of code:
>
> Searcher s =3D this.getSearcher()
> def hits =3D s.search( query, filter, params.offset + params.max, sort )
>
> for( hit in hits.scoreDocs[ lower..<upper ] ){
> =A0 def obj =3D binder( s.doc( hit.doc ), hit.doc ) // << here the NPE is
> thrown
> }
>
> the code *sporadically* throws the following:
>
> =A0 =A0 =A0 =A0... 6 more
> Caused by: java.lang.NullPointerException
> =A0 =A0 =A0 =A0at
> org.apache.lucene.util.CloseableThreadLocal.get(CloseableThreadLocal.java=
:64)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentReader.getFieldsReader(SegmentReader.java:=
778)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.SegmentReader.document(SegmentReader.java:879)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.DirectoryReader.document(DirectoryReader.java:518=
)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.index.IndexReader.document(IndexReader.java:658)
> =A0 =A0 =A0 =A0at
> org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:144)
> =A0 =A0 =A0 =A0at SearchableService.asResult(SearchableService.groovy:128=
)
>
> I assume, that the reason for that could be indexing of a new document/
> expungeDeletes() / re-openning the IndexReader.
>
> Can you elaborate on this? Shall I implement/configure some sort of
> time-out?
>
> Thanks in advance
>
> -----
> Konstantyn Smirnov, CTO
> http://www.poiradar.ru www.poiradar.ru
> http://www.poiradar.com.ua www.poiradar.com.ua
> http://www.poiradar.com www.poiradar.com
> http://www.poiradar.de www.poiradar.de
> --
> View this message in context: http://old.nabble.com/NullPointerExc-in-Clo=
seableThreadLocal...-%28Lucene-3.0.0%29-tp27145825p27145825.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44513-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 17:04:38 2010
Return-Path: <java-user-return-44513-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52296 invoked from network); 13 Jan 2010 17:04:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 17:04:38 -0000
Received: (qmail 14346 invoked by uid 500); 13 Jan 2010 17:04:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14273 invoked by uid 500); 13 Jan 2010 17:04:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14263 invoked by uid 99); 13 Jan 2010 17:04:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 17:04:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of karl.wettin@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 17:04:27 +0000
Received: by ewy9 with SMTP id 9so7326677ewy.11
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 09:04:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=hua0v2m3qDOv+74yQ9RTpWzQduVRy+giN48f4h5BqzA=;
        b=MDKWAhc2OpdKypfRgKFciOpZEkSMUOCnMPXVdcECf6SbhEMYUv5pUSjGbDSO8LuREE
         J0XnmmGJ0TcI8ukJ+LowyKstF+QlrQt9L0ffgcCmolhD10cjxCZwVrMg5SUTdFZl8/GU
         2vWlyXDCQvg7rNjkaEqeuuryrGVlgC9NaNEBE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=WAwsWDeEDeXifbxG6/1GT6USvynvCsTXsMn83BY0cFNlPY7kqCMKJP1Z4Ufr8gdo2s
         6MYENm79mONM+Mg9cNJ7zYgiSwpEk03HhF3SlHB8HaGSD6zPt97pQsrGpVxu6jwhbxVI
         AYCDhfin/fIdslZZStddSH0heeLnr1pj6XRMo=
Received: by 10.213.98.142 with SMTP id q14mr1367029ebn.75.1263402246884;
        Wed, 13 Jan 2010 09:04:06 -0800 (PST)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 7sm1709210eyg.1.2010.01.13.09.04.04
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 13 Jan 2010 09:04:05 -0800 (PST)
Message-Id: <A8D47BC4-2BA0-46DC-9289-B721B88453EC@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Extracting contact data
Date: Wed, 13 Jan 2010 18:04:03 +0100
References: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org

Lucene will probably only be helpful if you know what you are looking  
for, e.g. that you search for a given person, a given street and given  
time intervals.

Is this what you want to do?

If you instead are looking for a way to really extract any person,  
street and time interval that a document is associated with you  
probably want to look for a natural language processing project that  
can do something like semantic part of speech tagging for you.


       karl

13 jan 2010 kl. 17.39 skrev Ortelli, Gian Luca:

> Hi community,
>
>
>
> I have a general understanding of Lucene concepts, and I'm wondering  
> if
> it's the right tool for my job:
>
>
>
> - I need to extract data like e.g. time intervals ("8am - 12pm"),  
> street
> addresses from a set of files. The common issue with this data unit is
> that they contain spaces and are not always definable through regexes.
>
>
>
> - the extraction must take into consideration the "proximity": for
> example, a mail address which is close to the work "Contacts" will
> receive a higher rank, since I'm looking for contact data.
>
>
>
> Do you think I can get any advantage from building a solution on  
> Lucene?
>
>
>
>  Gianluca
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44514-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 17:06:29 2010
Return-Path: <java-user-return-44514-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53216 invoked from network); 13 Jan 2010 17:06:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 17:06:29 -0000
Received: (qmail 18245 invoked by uid 500); 13 Jan 2010 17:06:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18172 invoked by uid 500); 13 Jan 2010 17:06:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18162 invoked by uid 99); 13 Jan 2010 17:06:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 17:06:26 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 17:06:20 +0000
Received: by ey-out-2122.google.com with SMTP id 9so5228833eyd.3
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 09:05:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=u+BaZf/SBFMhDRTFF4VHhe1d9kyl94XduoWu4DE5ldA=;
        b=gyC+hYofs/AvaVl8iDzjCV9TLfepcsb0u34u8VjUwok6+43MyfZiEHdZZw5htGI9Zv
         qQYnvSrbIF2PLy29lz+P41tZBNpqbfEkODgWRcdBUnwc7jfnsPicZ6jnGDF55gPuwqYL
         HchWS7lh4ijMQKu9VjcEVl4UrH6Y5/c0gDWdI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=coxzT1c022rOraPWvHhL+JaQuESd4EFx4sBeHzN3iV1pvlwE2SZ7Z7F+CLu8T/rlK0
         qUZiMteqBs4UXt44WWu0JzftvhAUWP8RuQcfzj+9fEf5gwbyJGYhAWkGxho9g5dqOhkz
         tct6NthLUDXhLnya1GLsfzK7gy0JEtks/FHr8=
MIME-Version: 1.0
Received: by 10.216.86.7 with SMTP id v7mr3852981wee.203.1263402358114; Wed, 
	13 Jan 2010 09:05:58 -0800 (PST)
In-Reply-To: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org>
References: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org>
Date: Wed, 13 Jan 2010 12:05:58 -0500
Message-ID: <359a92831001130905o3477165dg6202efe9c2ea079b@mail.gmail.com>
Subject: Re: Extracting contact data
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d97670c38a6f047d0ec8f4

--0016e6d97670c38a6f047d0ec8f4
Content-Type: text/plain; charset=ISO-8859-1

Before answering, how to you measure "proximity"? You can make
Lucene work with locations (there's an example in Lucene In Action)
readily enough though....

HTH
Erick

On Wed, Jan 13, 2010 at 11:39 AM, Ortelli, Gian Luca <
gianluca.ortelli@truvo.com> wrote:

> Hi community,
>
>
>
> I have a general understanding of Lucene concepts, and I'm wondering if
> it's the right tool for my job:
>
>
>
> - I need to extract data like e.g. time intervals ("8am - 12pm"), street
> addresses from a set of files. The common issue with this data unit is
> that they contain spaces and are not always definable through regexes.
>
>
>
> - the extraction must take into consideration the "proximity": for
> example, a mail address which is close to the work "Contacts" will
> receive a higher rank, since I'm looking for contact data.
>
>
>
> Do you think I can get any advantage from building a solution on Lucene?
>
>
>
>  Gianluca
>
>

--0016e6d97670c38a6f047d0ec8f4--

From java-user-return-44515-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 17:51:37 2010
Return-Path: <java-user-return-44515-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76328 invoked from network); 13 Jan 2010 17:51:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 17:51:37 -0000
Received: (qmail 99570 invoked by uid 500); 13 Jan 2010 17:51:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99519 invoked by uid 500); 13 Jan 2010 17:51:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99460 invoked by uid 99); 13 Jan 2010 17:51:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 17:51:34 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 17:51:26 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NV7N3-0006fi-GT
	for java-user@lucene.apache.org; Wed, 13 Jan 2010 09:51:05 -0800
Message-ID: <27148785.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 09:51:05 -0800 (PST)
From: AlexElba <ramalex1@yahoo.com>
To: java-user@lucene.apache.org
Subject: RangeFilter
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ramalex1@yahoo.com


Hello,

I am currently using lucene 2.4 and have document with 3 fields

id  
name 
rank

and have query and filter when I am trying to use rang filter on rank I am
not getting any result back

RangeFilter rangeFilter = new RangeFilter("rank", "3", "10", true, true);

I have documents which are in this interval 


Any suggestion what am I doing wrong?

Regards




-- 
View this message in context: http://old.nabble.com/RangeFilter-tp27148785p27148785.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44516-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 18:18:18 2010
Return-Path: <java-user-return-44516-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92646 invoked from network); 13 Jan 2010 18:18:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 18:18:17 -0000
Received: (qmail 46762 invoked by uid 500); 13 Jan 2010 18:18:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46707 invoked by uid 500); 13 Jan 2010 18:18:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46697 invoked by uid 99); 13 Jan 2010 18:18:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 18:18:15 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.18.82] (HELO smtp1.syr.edu) (128.230.18.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 18:18:06 +0000
Received: from suex07-hub-01.ad.syr.edu (suex07-hub-01.ad.syr.edu [128.230.108.195])
	by smtp1.syr.edu (8.14.3/8.14.3) with ESMTP id o0DIHiBY027628
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 13:17:45 -0500
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-01.ad.syr.edu ([2002:80e6:6cc3::80e6:6cc3]) with mapi; Wed, 13 Jan
 2010 13:17:44 -0500
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 13 Jan 2010 13:17:43 -0500
Subject: RE: RangeFilter
Thread-Topic: RangeFilter
Thread-Index: AcqUeREQBcBowJcDRSSznMHzZRzcTQAAQUug
Message-ID: <2D127F11DC79714E9B6A43AC9458147F36661C04@suex07-mbx-03.ad.syr.edu>
References: <27148785.post@talk.nabble.com>
In-Reply-To: <27148785.post@talk.nabble.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.8161:2.4.5,1.2.40,4.0.166 definitions=2010-01-13_07:2010-01-05,2010-01-13,2010-01-13 signatures=0
X-Proofpoint-Spam-Reason: safe

Hi AlexElba,

The problem is that Lucene only knows how to handle character strings, not =
numbers.  Lexicographically, "3" > "10", so you get the expected results (n=
othing).

The standard thing to do is transform your numbers into strings that sort a=
s you want them to.  E.g., you can left-pad the "rank" field values with ze=
roes: "03", "04", ..., "10", and then create a RangeFilter over "03" .. "10=
".  You will of course need to left-zero-pad to at least the maximum charac=
ter length of the largest rank.

Facilities to handle this problem are available in NumberTools:

<http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/document/NumberT=
ools.html>

(Note that NumberTools converts longs to base-36 fixed-length padded string=
s.)

More info here:

   <http://wiki.apache.org/lucene-java/SearchNumericalFields>

Steve

On 01/13/2010 at 12:51 PM, AlexElba wrote:
>=20
> Hello,
>=20
> I am currently using lucene 2.4 and have document with 3 fields
>=20
> id
> name
> rank
>=20
> and have query and filter when I am trying to use rang filter on rank I
> am not getting any result back
>=20
> RangeFilter rangeFilter =3D new RangeFilter("rank", "3", "10", true, true=
);
>=20
> I have documents which are in this interval
>=20
>=20
> Any suggestion what am I doing wrong?
>=20
> Regards

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44517-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 18:29:47 2010
Return-Path: <java-user-return-44517-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98916 invoked from network); 13 Jan 2010 18:29:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 18:29:46 -0000
Received: (qmail 62030 invoked by uid 500); 13 Jan 2010 18:29:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61973 invoked by uid 500); 13 Jan 2010 18:29:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61963 invoked by uid 99); 13 Jan 2010 18:29:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 18:29:44 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 18:29:37 +0000
Received: by pwi11 with SMTP id 11so3278520pwi.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 10:29:16 -0800 (PST)
MIME-Version: 1.0
Received: by 10.114.236.23 with SMTP id j23mr7586092wah.164.1263407356178; 
	Wed, 13 Jan 2010 10:29:16 -0800 (PST)
In-Reply-To: <2D127F11DC79714E9B6A43AC9458147F36661C04@suex07-mbx-03.ad.syr.edu>
References: <27148785.post@talk.nabble.com>
	 <2D127F11DC79714E9B6A43AC9458147F36661C04@suex07-mbx-03.ad.syr.edu>
Date: Wed, 13 Jan 2010 13:29:16 -0500
Message-ID: <9ac0c6aa1001131029x7808cdbbra6d1717614b349cb@mail.gmail.com>
Subject: Re: RangeFilter
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Actually, as of Lucene 2.9 (if you can upgrade), you should use
NumericField to index numerics and NumericRangeQuery to do range
search/filter -- it all just works -- no more padding.

Mike

On Wed, Jan 13, 2010 at 1:17 PM, Steven A Rowe <sarowe@syr.edu> wrote:
> Hi AlexElba,
>
> The problem is that Lucene only knows how to handle character strings, no=
t numbers. =A0Lexicographically, "3" > "10", so you get the expected result=
s (nothing).
>
> The standard thing to do is transform your numbers into strings that sort=
 as you want them to. =A0E.g., you can left-pad the "rank" field values wit=
h zeroes: "03", "04", ..., "10", and then create a RangeFilter over "03" ..=
 "10". =A0You will of course need to left-zero-pad to at least the maximum =
character length of the largest rank.
>
> Facilities to handle this problem are available in NumberTools:
>
> <http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/document/Numbe=
rTools.html>
>
> (Note that NumberTools converts longs to base-36 fixed-length padded stri=
ngs.)
>
> More info here:
>
> =A0 <http://wiki.apache.org/lucene-java/SearchNumericalFields>
>
> Steve
>
> On 01/13/2010 at 12:51 PM, AlexElba wrote:
>>
>> Hello,
>>
>> I am currently using lucene 2.4 and have document with 3 fields
>>
>> id
>> name
>> rank
>>
>> and have query and filter when I am trying to use rang filter on rank I
>> am not getting any result back
>>
>> RangeFilter rangeFilter =3D new RangeFilter("rank", "3", "10", true, tru=
e);
>>
>> I have documents which are in this interval
>>
>>
>> Any suggestion what am I doing wrong?
>>
>> Regards
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44518-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 19:24:00 2010
Return-Path: <java-user-return-44518-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21841 invoked from network); 13 Jan 2010 19:24:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 19:24:00 -0000
Received: (qmail 47657 invoked by uid 500); 13 Jan 2010 19:23:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47595 invoked by uid 500); 13 Jan 2010 19:23:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47585 invoked by uid 99); 13 Jan 2010 19:23:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 19:23:57 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 19:23:49 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NV8oS-0003IE-Jp
	for java-user@lucene.apache.org; Wed, 13 Jan 2010 11:23:28 -0800
Message-ID: <27149158.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 11:23:28 -0800 (PST)
From: Konstantyn Smirnov <injecteer@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: NullPointerExc in CloseableThreadLocal... (Lucene 3.0.0)
In-Reply-To: <9ac0c6aa1001130852y52896135pdbb2c6955fe7c0ce@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: injecteer@yahoo.com
References: <27145825.post@talk.nabble.com> <9ac0c6aa1001130852y52896135pdbb2c6955fe7c0ce@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks for the answer Mike

indeed it is possible, but practically...

I start the loop immediately after searcher.search(), and with my index size
of 3 MB, the whole operation takes max 100 ms. Given the rate of like 50
updates - addDocument()/expungeDeletes()/IR.reopen() per day, the
probability is really low, I think, because the update takes also about 100
ms...

Anyway, it would be worth trying some IR reopen lock. Do you have any idea
on that?

-----
Konstantyn Smirnov, CTO 
http://www.poiradar.ru www.poiradar.ru 
http://www.poiradar.com.ua www.poiradar.com.ua 
http://www.poiradar.com www.poiradar.com 
http://www.poiradar.de www.poiradar.de 
-- 
View this message in context: http://old.nabble.com/NullPointerExc-in-CloseableThreadLocal...-%28Lucene-3.0.0%29-tp27145825p27149158.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44519-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 19:31:15 2010
Return-Path: <java-user-return-44519-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23812 invoked from network); 13 Jan 2010 19:31:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 19:31:15 -0000
Received: (qmail 62780 invoked by uid 500); 13 Jan 2010 19:31:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62704 invoked by uid 500); 13 Jan 2010 19:31:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62694 invoked by uid 99); 13 Jan 2010 19:31:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 19:31:12 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.25 as permitted sender)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 19:31:02 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 7A20DCD531
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 14:30:34 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Wed, 13 Jan 2010 14:30:34 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=+2oQbCTAdvrUhNsKBaENDKM+Emg=; b=tb1eYV1DE5smAPseSd5lxelWRN+TKO/PPMcXHGzSAtPwoulWxcrkspnK3PgWL8u6uUUArw4xs3vW/70gAgDXBAoWWEdszqzl40Pbc7/mboGIZZWz4W2Cu6TwX8pTZQFMzPhOXKnH4VXydLLAWONn30f5J/PF85xvuRO1Et4kUg0=
X-Sasl-enc: P8eUYz5Nw26DqeekFSsHGA1XDqvmfol7NWE8BXTpt74x 1263411033
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 91E8D4AE66E
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 14:30:33 -0500 (EST)
Message-ID: <4B4E1F58.4080001@fastmail.fm>
Date: Wed, 13 Jan 2010 19:30:32 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Performance Results on changing the way fields are stored
References: <4B433425.5090908@fastmail.fm> <486CFF0E-7B40-4750-BAA2-C46B1B8ED4BB@apache.org>
In-Reply-To: <486CFF0E-7B40-4750-BAA2-C46B1B8ED4BB@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Grant Ingersoll wrote:
> On Jan 5, 2010, at 7:44 AM, Paul Taylor wrote:
>
>   
>> So currently in my index I index and store a number of small fields, I need both so I can search on the fields, then I use the stored versions to generate the output document (which is either an XML or JSON representation), because I read stored and index fields are dealt with completely seperately I tried another tact only storing one field which was a serialized version of the output documentation. This solves a couple of issues I was having but I was disappointed that both the size of the index increased and the index build  time increased, I thought that if all the stored data was held in one field that the resultant index would be smaller, and I didn't expect index time to increase by as much as it did. I was also suprised that Java serilaization was slower and used more space than both JSON and XML serialization.
>>
>> Results as Follows
>>
>> Type:                                                             Time : Index Size
>> Only indexed  no norms                                                                    105   : 38 MB
>> Only indexed                                                                                     111   : 43 MB
>> Same fields written as Indexed and Stored  (current Situation)           115   : 83 MB
>> Fields Indexed, One JAXB classed Stored using JSON Marshalling 140   : 115 MB
>> Fields Indexed, One JAXB classed Stored using XML Marshalling  189   : 198 MB
>> Fields Indexed, One JAXB classed Stored using Java Serialization   305   : 485 MB
>>     
>
> How much more verbose are these than the "raw" content?  Even as terse as JSON is, it is still verbose compared to a binary format, and XML Marshalling and Java Serialization will be even more.  Given that you are likely only displaying 10 or so at a time, I'd think it would be much more efficient to only store the minimal amount needed to recreate the docs in the current result set.  
>
>   
Yes, in the end I came to the conclusion to just stick with current 
situation except for cases where i have sets of related fields that 
would otherwise nessecitate holding 'placeholder' fields, in which case 
I've used json
> I've also seen people have success simply storing a key in Lucene that is then used for lookup in something like Memcachedb, Tokyo Cabinet or one of the many other key-value stores.
>   
In my situation 90% of the fields stored are also required for 
searching, so they are held in the search index anyway so there is not 
much point moving the stored version into a memcahe

thanks Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44520-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 20:21:58 2010
Return-Path: <java-user-return-44520-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38357 invoked from network); 13 Jan 2010 20:21:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 20:21:58 -0000
Received: (qmail 45345 invoked by uid 500); 13 Jan 2010 20:21:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45252 invoked by uid 500); 13 Jan 2010 20:21:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45242 invoked by uid 99); 13 Jan 2010 20:21:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 20:21:55 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 20:21:47 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NV9iZ-0005J0-5z
	for java-user@lucene.apache.org; Wed, 13 Jan 2010 12:21:27 -0800
Message-ID: <27151315.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 12:21:27 -0800 (PST)
From: AlexElba <ramalex1@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: RangeFilter
In-Reply-To: <9ac0c6aa1001131029x7808cdbbra6d1717614b349cb@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ramalex1@yahoo.com
References: <27148785.post@talk.nabble.com> <2D127F11DC79714E9B6A43AC9458147F36661C04@suex07-mbx-03.ad.syr.edu> <9ac0c6aa1001131029x7808cdbbra6d1717614b349cb@mail.gmail.com>


Thanks Steve.

Mike for now I can not upgrade... 
-- 
View this message in context: http://old.nabble.com/RangeFilter-tp27148785p27151315.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44521-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 21:00:24 2010
Return-Path: <java-user-return-44521-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52545 invoked from network); 13 Jan 2010 21:00:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 21:00:23 -0000
Received: (qmail 9583 invoked by uid 500); 13 Jan 2010 21:00:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9496 invoked by uid 500); 13 Jan 2010 21:00:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9486 invoked by uid 99); 13 Jan 2010 21:00:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:00:21 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of tjkolev@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:00:13 +0000
Received: by fxm2 with SMTP id 2so21646544fxm.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 12:59:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=J+u0hPWNZUPHXRBy/bxUvhhhD4Od1BUZ0NmDQyavp6g=;
        b=hRxdpDCVfuUH+M1LvxvquNMBmQBa0OutsWVcc7klNyxz4L0i7Wiulq9RUtrt9H35R2
         X8FEFTEfHBMCkFR3SuLY152JQxfeIqFL/HVOwH/SzvWHCkcJ2Uh9CwG5iB0Kk91jm14S
         BWFHp35xYYEkgV9fTzCv8pSKVXx95OTDfdM4Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=wYCZEK2Y4X1XMu9U1iwD7sW3LKzRuMhv2Oq4csLdoPNsUdKubzW0dsQD8deqCbflTS
         4EbJtLEVBOQhs2Kjqu6T6D5D/oss+4ZBxp09POnQxiaQyXWjt8MxH6JXlpyYAeVYodEO
         RABwCFBzu5x0XSrt+THAjVSNxuoOkT5LMITok=
MIME-Version: 1.0
Received: by 10.239.183.147 with SMTP id u19mr125547hbg.106.1263416392605; 
	Wed, 13 Jan 2010 12:59:52 -0800 (PST)
Date: Wed, 13 Jan 2010 14:59:52 -0600
Message-ID: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
Subject: Problem: Indexing and searching repeating groups of fields
From: TJ Kolev <tjkolev@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f5cef248e172047d120d8a
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f5cef248e172047d120d8a
Content-Type: text/plain; charset=ISO-8859-1

Greetings,

Let's assume I have to index and search "resume" documents. Two fields are
defined: Language and Years. The fields are associated together in a group
called Experience. A resume document may have 0 or more Experience groups:

Ra{ E1(Java,5); E2(C,2); E3(PHP,3);}
Rb{ E1(Java,2); E2(C,5); E3(VB,1);}

How do I index such documents, and how do I search, so I can formulate a
query like this "Resumes which have (Java,5) and (C,2)" and get back Ra. I
know I can index multiple fields of the same name, and do "(Language:Java
AND Years:5) AND (Language:C AND Years:2)", but in addition to Ra that would
also return Rb, which I don't want. The problem here is that the "grouping"
is lost. I can create fields with compound names (E1Language, E1Years,
E2Language, E2Years, etc), but that helps me none, as I don't know which
group to search. I'd also like to query for "(Language:Java AND Years:5) OR
(Language:C AND Years:2)"

This is a simplified example. Real documents may have 30 - 40 groups, each
one with several fields. Putting all the fields in a group in one index
field won't work as the numeric/date ones should be available for range
searchers.

So far the way I see it is to do my own post processing on the results. The
issue is that text fields will need to be untokenized, or otherwise it would
be difficult to work on the result, and determine what matches.

Thank you.
tjk :)

--001485f5cef248e172047d120d8a--

From java-user-return-44522-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 21:18:32 2010
Return-Path: <java-user-return-44522-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58404 invoked from network); 13 Jan 2010 21:18:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 21:18:32 -0000
Received: (qmail 39092 invoked by uid 500); 13 Jan 2010 21:18:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39038 invoked by uid 500); 13 Jan 2010 21:18:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39028 invoked by uid 99); 13 Jan 2010 21:18:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:18:29 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:18:21 +0000
Received: by ewy9 with SMTP id 9so7602292ewy.11
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 13:18:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=CXG5axHK3rYmHPCJ5B8yF4zQrV92NVrrKhnWZHVbedc=;
        b=Xvm+FHshtPJ8H8oVOOH6x3cf9007CCI6QTWl+mwON3kvs/6pqjS3CpxclVsrKh2q7y
         TSb3AItZ+YwyzxDbFdC4cUYTvlf+qxgmxHRGm8BxODUw0zrUuP+gvx6Ew5jnxKEfSHhA
         LGb0HJgNav6d28S8HEc5l8MF4erXVFX1pSC0Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=CQxjAEinlR8lElO4Fx94mxF06V3gNh1XFLZLvFQUOLPVVtCV4zlIDELsrIQc0CrDxE
         J5bNBGWL3o1Zh90GXvo1YCTTHFq8sU5qxzmYerqcmV1LZXC5sHPHoFmpaw0CTeqFYL6n
         fN5TD/fwKj2lJvSGXc0SvRRW0eU8NxHN1FNF4=
MIME-Version: 1.0
Received: by 10.216.89.14 with SMTP id b14mr754308wef.76.1263417479689; Wed, 
	13 Jan 2010 13:17:59 -0800 (PST)
In-Reply-To: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
References: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
Date: Wed, 13 Jan 2010 16:17:59 -0500
Message-ID: <359a92831001131317s3e176a9bmfa5bbdd99ec192ef@mail.gmail.com>
Subject: Re: Problem: Indexing and searching repeating groups of fields
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d977fd147836047d124ebe
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d977fd147836047d124ebe
Content-Type: text/plain; charset=ISO-8859-1

One approach would be to do this with multi-valued fields. The
idea here is to index all your E fields in the *same* Lucene
field with an increment gap (see getPositionIncrementGap) > 1.

For this example, assume getPositionIncrementGap returns 100.

Then, for your documents you have something like....
doc.add(new Field("experience", "java,5" blah blah));
doc.add(new Field("experience", "C,2" blah blah));
doc.add(new Field("experience", "PHP,3" blah blah));

Then you do proximity searches with a slop of < 100.

The trick is that, the above tokens are positioned (roughly)
1 - java
2 - 5
102 - c
103 - 2
203 - php
204 - 3

Of course you have to override a suitable analyzer to break
your tokens up appropriately.

Now a query (SpanNear? Proximity? your choice) of the
form "java 5"~90 AND "c 2"~90 should only return Ra.

HTH
Erick

On Wed, Jan 13, 2010 at 3:59 PM, TJ Kolev <tjkolev@gmail.com> wrote:

> Greetings,
>
> Let's assume I have to index and search "resume" documents. Two fields are
> defined: Language and Years. The fields are associated together in a group
> called Experience. A resume document may have 0 or more Experience groups:
>
> Ra{ E1(Java,5); E2(C,2); E3(PHP,3);}
> Rb{ E1(Java,2); E2(C,5); E3(VB,1);}
>
> How do I index such documents, and how do I search, so I can formulate a
> query like this "Resumes which have (Java,5) and (C,2)" and get back Ra. I
> know I can index multiple fields of the same name, and do "(Language:Java
> AND Years:5) AND (Language:C AND Years:2)", but in addition to Ra that
> would
> also return Rb, which I don't want. The problem here is that the "grouping"
> is lost. I can create fields with compound names (E1Language, E1Years,
> E2Language, E2Years, etc), but that helps me none, as I don't know which
> group to search. I'd also like to query for "(Language:Java AND Years:5) OR
> (Language:C AND Years:2)"
>
> This is a simplified example. Real documents may have 30 - 40 groups, each
> one with several fields. Putting all the fields in a group in one index
> field won't work as the numeric/date ones should be available for range
> searchers.
>
> So far the way I see it is to do my own post processing on the results. The
> issue is that text fields will need to be untokenized, or otherwise it
> would
> be difficult to work on the result, and determine what matches.
>
> Thank you.
> tjk :)
>

--0016e6d977fd147836047d124ebe--

From java-user-return-44523-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 21:31:23 2010
Return-Path: <java-user-return-44523-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67225 invoked from network); 13 Jan 2010 21:31:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 21:31:23 -0000
Received: (qmail 65584 invoked by uid 500); 13 Jan 2010 21:31:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65494 invoked by uid 500); 13 Jan 2010 21:31:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65484 invoked by uid 99); 13 Jan 2010 21:31:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:31:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of digydigy@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:31:12 +0000
Received: by ey-out-2122.google.com with SMTP id 9so5292494eyd.3
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 13:30:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:from:to:references
         :in-reply-to:subject:date:message-id:mime-version:content-type
         :content-transfer-encoding:x-mailer:content-language:thread-index;
        bh=4UTCgEh/FYvO9GxieSEOqxumh1DiYv9DctzPJF5QyKA=;
        b=EQKoi18FFRRt8DgUz5yKmUaEfep/f9QKM1Vtm9tY0mIaLdU0ghah0LfvddCA+3LU7u
         O7PoNJPw1x5MteCbFm4Om9j6aM8pOrcAOV/34/ZptPgggB1nb+IgL17fnO6/MpM+GEIf
         8MmC1N3OCTHbTR23El4kB/3TzhST35bzL1uBY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:x-mailer:content-language
         :thread-index;
        b=AdZurUIsJiRMnYwY5R7nUUldvFyMDoGRxAOp+iAN0KA3tOW226Urx+59Ikew6zgrGb
         Numu6StuNnmJnxK5DkMukPTqZ8fFIFJ5sUMH2ibfZpFh8ptMqUjdhG0A2XITGyQxIT/V
         quSEy4MCOOMtZQ5oZN7nJyao0Gkw2dXXTeuzM=
Received: by 10.213.62.206 with SMTP id y14mr142299ebh.70.1263418250561;
        Wed, 13 Jan 2010 13:30:50 -0800 (PST)
Received: from NEWPC ([81.213.206.230])
        by mx.google.com with ESMTPS id 16sm2858330ewy.10.2010.01.13.13.30.48
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 13 Jan 2010 13:30:49 -0800 (PST)
From: "Digy" <digydigy@gmail.com>
To: <java-user@lucene.apache.org>
References: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
In-Reply-To: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
Subject: RE: Problem: Indexing and searching repeating groups of fields
Date: Wed, 13 Jan 2010 23:30:31 +0200
Message-ID: <001d01ca9497$a392a630$eab7f290$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
Content-language: tr
Thread-Index: AcqUk2w1bjAnfkXhSnezcYEXPYWOHgABCklA

How about using languages as fieldnames?
Doc1(Ra):
	Java:5
	C:2
	PHP:3
	
Doc2(Rb)
	Java:2
	C:5
	VB:1

Query:Java:5 AND C:2

DIGY

-----Original Message-----
From: TJ Kolev [mailto:tjkolev@gmail.com] 
Sent: Wednesday, January 13, 2010 11:00 PM
To: java-user@lucene.apache.org
Subject: Problem: Indexing and searching repeating groups of fields

Greetings,

Let's assume I have to index and search "resume" documents. Two fields are
defined: Language and Years. The fields are associated together in a group
called Experience. A resume document may have 0 or more Experience groups:

Ra{ E1(Java,5); E2(C,2); E3(PHP,3);}
Rb{ E1(Java,2); E2(C,5); E3(VB,1);}

How do I index such documents, and how do I search, so I can formulate a
query like this "Resumes which have (Java,5) and (C,2)" and get back Ra. I
know I can index multiple fields of the same name, and do "(Language:Java
AND Years:5) AND (Language:C AND Years:2)", but in addition to Ra that would
also return Rb, which I don't want. The problem here is that the "grouping"
is lost. I can create fields with compound names (E1Language, E1Years,
E2Language, E2Years, etc), but that helps me none, as I don't know which
group to search. I'd also like to query for "(Language:Java AND Years:5) OR
(Language:C AND Years:2)"

This is a simplified example. Real documents may have 30 - 40 groups, each
one with several fields. Putting all the fields in a group in one index
field won't work as the numeric/date ones should be available for range
searchers.

So far the way I see it is to do my own post processing on the results. The
issue is that text fields will need to be untokenized, or otherwise it would
be difficult to work on the result, and determine what matches.

Thank you.
tjk :)


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44524-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 21:37:31 2010
Return-Path: <java-user-return-44524-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72225 invoked from network); 13 Jan 2010 21:37:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 21:37:30 -0000
Received: (qmail 85689 invoked by uid 500); 13 Jan 2010 21:37:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85628 invoked by uid 500); 13 Jan 2010 21:37:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85617 invoked by uid 99); 13 Jan 2010 21:37:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:37:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mrtrin@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:37:20 +0000
Received: by qw-out-2122.google.com with SMTP id 5so91788qwd.53
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 13:36:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=7TQx+L3VcFlimC+iepLSq+EbfeRaabGuW3CHAOi0Q0Y=;
        b=Lkj/v/izfFMoJ5U0SJM6z7NenutlIOe2f+yhvgV+bp/nEzezAr4nk9G2Qxc5WaZtFM
         SFA+pqUEzQkFV69Lm0Q4EcFUBot34Mn7VRYSTR+z0uuSBwB5YiyxlWsoV1zfU8/zdwNc
         i/1l7b2Y+sY176ZBd5dno+fmv4P2CjN+DKytM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=A2nD2Afpk0O5VWNXlslR6yP0Q9Y8v01DrlSJ2iOsOKPt5bv2zBNoM3FBkQzwVJowDt
         oLXM1wo4zUxc/kjYo2BEFn6HwykPRIK6mn+pvav8O+c8RgIZu+ul57v/fTR1SHUKdaNM
         SlKX+gqoyoiFNSDRcCV7a8RORp2lu3YczPyOs=
MIME-Version: 1.0
Received: by 10.229.50.12 with SMTP id x12mr573679qcf.76.1263418619354; Wed, 
	13 Jan 2010 13:36:59 -0800 (PST)
Date: Wed, 13 Jan 2010 13:36:59 -0800
Message-ID: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
Subject: Max Segmentation Size when Optimizing Index
From: Trin Chavalittumrong <mrtrin@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001636833de202610c047d12929a
X-Virus-Checked: Checked by ClamAV on apache.org

--001636833de202610c047d12929a
Content-Type: text/plain; charset=ISO-8859-1

Hi,



I am trying to optimize the index which would merge different segment
together. Let say the index folder is 1Gb in total, I need each segmentation
to be no larger than 200Mb. I tried to use *LogByteSizeMergePolicy *and
setMaxMergeMB(100) to ensure no segment after merging would be 200Mb.
However, I still see segment that are larger than 200Mb. I did call
IndexWriter.optimize(20) to make sure there are enough number segmentation
to allow each segment to be under 200Mb.



Can someone let me know if I am using this right? Or any suggestion on how
to tackle this would be helpful.



Thanks,

Trin

--001636833de202610c047d12929a--

From java-user-return-44525-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 21:43:30 2010
Return-Path: <java-user-return-44525-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75571 invoked from network); 13 Jan 2010 21:43:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 21:43:30 -0000
Received: (qmail 97835 invoked by uid 500); 13 Jan 2010 21:43:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97769 invoked by uid 500); 13 Jan 2010 21:43:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97759 invoked by uid 99); 13 Jan 2010 21:43:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:43:28 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FUZZY_VLIUM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:43:21 +0000
Received: by pwi11 with SMTP id 11so3421024pwi.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 13:43:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=skgp0bHZWzD155cdw8Of+chlonFF4xtnQMJb6uD4+zE=;
        b=AjZ97HSoou7GgmguChUlshSPRAA55moEek+pQBywDycXOVjcLCPohJ3OYFP/7nppgt
         deC1tjItmrYvT7czyKID4CoEVzpukjiOXvRYS+d8RpnhQcHkZR9bZz4YWXzfFbypBR46
         CjpNIe7prSgQhtaZKE9+O9PqPR8AuA58UU31E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=VClZexvG/SlX9I3jeNnMi+3xGcX50yOd+ZphVnWmU9ymYsu19kjGI/PI7b8Z6gv8Zc
         gMJOTh4cTPbXAnIniyNisB1234sDtiBAEN9vP+8HbTIRGeDkbhqMqK9NIlKE07wQathF
         HhqMMUz52taX/7OBM912Xf6OwcegiSbrBs31Y=
MIME-Version: 1.0
Received: by 10.141.105.5 with SMTP id h5mr1325510rvm.178.1263418980776; Wed, 
	13 Jan 2010 13:43:00 -0800 (PST)
In-Reply-To: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
Date: Wed, 13 Jan 2010 13:43:00 -0800
Message-ID: <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi Trin,

There was recently a discussion about this, the max size is
for the before merge segments, rather than the resultant merged
segment (if that makes sense). It'd be great if we had a merge
policy that limited the resultant merged segment, though that'd
by a rough approximation at best.

Jason

On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <mrtrin@gmail.com> wrote:
> Hi,
>
>
>
> I am trying to optimize the index which would merge different segment
> together. Let say the index folder is 1Gb in total, I need each segmentation
> to be no larger than 200Mb. I tried to use *LogByteSizeMergePolicy *and
> setMaxMergeMB(100) to ensure no segment after merging would be 200Mb.
> However, I still see segment that are larger than 200Mb. I did call
> IndexWriter.optimize(20) to make sure there are enough number segmentation
> to allow each segment to be under 200Mb.
>
>
>
> Can someone let me know if I am using this right? Or any suggestion on how
> to tackle this would be helpful.
>
>
>
> Thanks,
>
> Trin
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44526-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 21:49:41 2010
Return-Path: <java-user-return-44526-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79550 invoked from network); 13 Jan 2010 21:49:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 21:49:41 -0000
Received: (qmail 6847 invoked by uid 500); 13 Jan 2010 21:49:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6763 invoked by uid 500); 13 Jan 2010 21:49:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6753 invoked by uid 99); 13 Jan 2010 21:49:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:49:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=FUZZY_VLIUM,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mrtrin@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:49:32 +0000
Received: by qw-out-2122.google.com with SMTP id 5so95770qwd.53
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 13:49:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=sGPD3JynFqyvYfUuo+FMtimcV+UKjzSQLIdL3XDIX+E=;
        b=veKmXUbusPt7jLO4XHbXI3QMTvJa1Zka71xH4yqIBUrpJOki/l7Wgv5X9bMWwWPOiA
         7ii6/5Owlpfk640s7l3BYqVFBQEO51elsd5NTRB7GRp+AT/IJBCWO0VvYR2qFOrZIXI9
         GAITPCK70yAsItsSmEc6FCx2P/rvZCcw656xU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ZN1kCn9fTKDjzFPM2PqKYw/eLHTVCKxovLvOmWkt213XLiZHf3Dzrtivq5x7K6tPKC
         ySq4br+FkjZCU5pn+qJWhsliH/VCFhBJbUntsXXi3VSxiXqhcPdxu5OnBEOP8FJ6JZXD
         LjFIFYLuQ9JXNjIlos7SVjutSYwbvrSY14gyY=
MIME-Version: 1.0
Received: by 10.229.68.227 with SMTP id w35mr2701348qci.91.1263419351523; Wed, 
	13 Jan 2010 13:49:11 -0800 (PST)
In-Reply-To: <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
	 <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
Date: Wed, 13 Jan 2010 13:49:11 -0800
Message-ID: <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Trin Chavalittumrong <mrtrin@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00032557b742a6626d047d12bd50

--00032557b742a6626d047d12bd50
Content-Type: text/plain; charset=ISO-8859-1

Thanks, Jason.

Is my understanding correct that LogByteSizeMergePolicy.setMaxMergeMB(100)
will prevent
merging of two segments that is larger than 100 Mb each at the optimizing
time?

If so, why do think would I still see segment that is larger than 200 MB?



On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
jason.rutherglen@gmail.com> wrote:

> Hi Trin,
>
> There was recently a discussion about this, the max size is
> for the before merge segments, rather than the resultant merged
> segment (if that makes sense). It'd be great if we had a merge
> policy that limited the resultant merged segment, though that'd
> by a rough approximation at best.
>
> Jason
>
> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <mrtrin@gmail.com>
> wrote:
> > Hi,
> >
> >
> >
> > I am trying to optimize the index which would merge different segment
> > together. Let say the index folder is 1Gb in total, I need each
> segmentation
> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePolicy *and
> > setMaxMergeMB(100) to ensure no segment after merging would be 200Mb.
> > However, I still see segment that are larger than 200Mb. I did call
> > IndexWriter.optimize(20) to make sure there are enough number
> segmentation
> > to allow each segment to be under 200Mb.
> >
> >
> >
> > Can someone let me know if I am using this right? Or any suggestion on
> how
> > to tackle this would be helpful.
> >
> >
> >
> > Thanks,
> >
> > Trin
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--00032557b742a6626d047d12bd50--

From java-user-return-44527-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 21:52:47 2010
Return-Path: <java-user-return-44527-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81439 invoked from network); 13 Jan 2010 21:52:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 21:52:47 -0000
Received: (qmail 12113 invoked by uid 500); 13 Jan 2010 21:52:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12024 invoked by uid 500); 13 Jan 2010 21:52:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12014 invoked by uid 99); 13 Jan 2010 21:52:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:52:45 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:52:38 +0000
Received: by ewy9 with SMTP id 9so7639039ewy.11
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 13:52:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=tMbYgYJv8B9YXzy8deEHjd61Sqz82flLj6MDAsjXF+g=;
        b=VP18lKSk1zXejSlcIyENGDpzKDg3MX+l4/XRKVyl7rd6R9nF+Y2DSSom5Aoj/TM8QS
         TgJCVMamKlYM91X4nJNy+IjHBGD3uClZGwyTt+4S/bq+abnu37yAZja2VWFhqZS+Zl20
         avZ0XqAjSfGrQlRhCmtJPnUYEOqZOYklG5D3o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=YqWwiTFdkRFzKD0ZCDfuujCAn84oyE+iICI7ABEGo/dh+6giInUI2ivW1YRqz1DRSS
         zdlToxxPJM8GMA+VR8QGnFuQ/I8UyidjTh1+i1yHBDC+uJeFU/yZ7a3eymz+tsP11h2G
         8dyEHvdvrXbQMskQNBraxwT4JXaIjSjlRjZYE=
MIME-Version: 1.0
Received: by 10.216.87.140 with SMTP id y12mr581310wee.4.1263419536958; Wed, 
	13 Jan 2010 13:52:16 -0800 (PST)
In-Reply-To: <001d01ca9497$a392a630$eab7f290$@com>
References: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
	 <001d01ca9497$a392a630$eab7f290$@com>
Date: Wed, 13 Jan 2010 16:52:16 -0500
Message-ID: <359a92831001131352x7d6ea929p1f095c79c6dc58f4@mail.gmail.com>
Subject: Re: Problem: Indexing and searching repeating groups of fields
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d5667ab3e486047d12c87f

--0016e6d5667ab3e486047d12c87f
Content-Type: text/plain; charset=ISO-8859-1

Ooooh, isn't that easier. You just prompted me to think
that you don't even have to do that, just index the pairs as single
tokens (KeywordAnalyzer? but watch out for no case folding)...

On Wed, Jan 13, 2010 at 4:30 PM, Digy <digydigy@gmail.com> wrote:

> How about using languages as fieldnames?
> Doc1(Ra):
>        Java:5
>        C:2
>        PHP:3
>
> Doc2(Rb)
>        Java:2
>        C:5
>        VB:1
>
> Query:Java:5 AND C:2
>
> DIGY
>
> -----Original Message-----
> From: TJ Kolev [mailto:tjkolev@gmail.com]
> Sent: Wednesday, January 13, 2010 11:00 PM
> To: java-user@lucene.apache.org
> Subject: Problem: Indexing and searching repeating groups of fields
>
> Greetings,
>
> Let's assume I have to index and search "resume" documents. Two fields are
> defined: Language and Years. The fields are associated together in a group
> called Experience. A resume document may have 0 or more Experience groups:
>
> Ra{ E1(Java,5); E2(C,2); E3(PHP,3);}
> Rb{ E1(Java,2); E2(C,5); E3(VB,1);}
>
> How do I index such documents, and how do I search, so I can formulate a
> query like this "Resumes which have (Java,5) and (C,2)" and get back Ra. I
> know I can index multiple fields of the same name, and do "(Language:Java
> AND Years:5) AND (Language:C AND Years:2)", but in addition to Ra that
> would
> also return Rb, which I don't want. The problem here is that the "grouping"
> is lost. I can create fields with compound names (E1Language, E1Years,
> E2Language, E2Years, etc), but that helps me none, as I don't know which
> group to search. I'd also like to query for "(Language:Java AND Years:5) OR
> (Language:C AND Years:2)"
>
> This is a simplified example. Real documents may have 30 - 40 groups, each
> one with several fields. Putting all the fields in a group in one index
> field won't work as the numeric/date ones should be available for range
> searchers.
>
> So far the way I see it is to do my own post processing on the results. The
> issue is that text fields will need to be untokenized, or otherwise it
> would
> be difficult to work on the result, and determine what matches.
>
> Thank you.
> tjk :)
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d5667ab3e486047d12c87f--

From java-user-return-44528-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 21:57:48 2010
Return-Path: <java-user-return-44528-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84875 invoked from network); 13 Jan 2010 21:57:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 21:57:48 -0000
Received: (qmail 18589 invoked by uid 500); 13 Jan 2010 21:57:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18517 invoked by uid 500); 13 Jan 2010 21:57:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18507 invoked by uid 99); 13 Jan 2010 21:57:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:57:46 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FUZZY_VLIUM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.216.204 as permitted sender)
Received: from [209.85.216.204] (HELO mail-px0-f204.google.com) (209.85.216.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 21:57:39 +0000
Received: by pxi42 with SMTP id 42so217635pxi.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 13:57:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=AjCo39S+JCwlYAp7JEgUqHxyG7+wEBSWR2sUq7qNwUY=;
        b=l6i7I/cVycGVBtqIV5MfHUdvLgA4WRxgybqDwMPZ2Q7j089PUbdq4q/zQHKD2g++9v
         y8WyBalFr/ZbXuIWjv8QohuD1eM7Ntat/obHsYMMJW3d7R9IW2V2fNRXzxWPuPzjLRAb
         jGN8/tCFDo9kMXclKVxBHrxiOBvueRjIr/XhM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=efxBeeM5UxR76/dJQbd0TZ0olM3ftN2lD7O6CuQKrgcX92Lg3VibNkCnrorYSy3nbP
         y4lH1Z4oeOD8TbTqr/Olq7MmwmoonU6sG8K4PNqrqnTb3lVllQDcO6kWqHqO4U5imNZ8
         9KFfbL2Tq5goysajeV6aKsGEN0Mhqk+aKcWHo=
MIME-Version: 1.0
Received: by 10.141.188.19 with SMTP id q19mr6368099rvp.164.1263419838894; 
	Wed, 13 Jan 2010 13:57:18 -0800 (PST)
In-Reply-To: <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
	 <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
	 <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
Date: Wed, 13 Jan 2010 13:57:18 -0800
Message-ID: <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Oh ok, you're asking about optimizing... I think that's a different
algorithm inside LogMergePolicy.  I think it ignores the maxMergeMB
param.

On Wed, Jan 13, 2010 at 1:49 PM, Trin Chavalittumrong <mrtrin@gmail.com> wrote:
> Thanks, Jason.
>
> Is my understanding correct that LogByteSizeMergePolicy.setMaxMergeMB(100)
> will prevent
> merging of two segments that is larger than 100 Mb each at the optimizing
> time?
>
> If so, why do think would I still see segment that is larger than 200 MB?
>
>
>
> On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
> jason.rutherglen@gmail.com> wrote:
>
>> Hi Trin,
>>
>> There was recently a discussion about this, the max size is
>> for the before merge segments, rather than the resultant merged
>> segment (if that makes sense). It'd be great if we had a merge
>> policy that limited the resultant merged segment, though that'd
>> by a rough approximation at best.
>>
>> Jason
>>
>> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <mrtrin@gmail.com>
>> wrote:
>> > Hi,
>> >
>> >
>> >
>> > I am trying to optimize the index which would merge different segment
>> > together. Let say the index folder is 1Gb in total, I need each
>> segmentation
>> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePolicy *and
>> > setMaxMergeMB(100) to ensure no segment after merging would be 200Mb.
>> > However, I still see segment that are larger than 200Mb. I did call
>> > IndexWriter.optimize(20) to make sure there are enough number
>> segmentation
>> > to allow each segment to be under 200Mb.
>> >
>> >
>> >
>> > Can someone let me know if I am using this right? Or any suggestion on
>> how
>> > to tackle this would be helpful.
>> >
>> >
>> >
>> > Thanks,
>> >
>> > Trin
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44529-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 22:30:12 2010
Return-Path: <java-user-return-44529-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7370 invoked from network); 13 Jan 2010 22:30:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 22:30:12 -0000
Received: (qmail 72925 invoked by uid 500); 13 Jan 2010 22:30:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72865 invoked by uid 500); 13 Jan 2010 22:30:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72855 invoked by uid 99); 13 Jan 2010 22:30:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 22:30:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=FUZZY_VLIUM,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mrtrin@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 22:30:03 +0000
Received: by qw-out-2122.google.com with SMTP id 5so108386qwd.53
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 14:29:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=cBYXOGxWVhcqRb1QhW8+Y+xpMEK89bjo46AfObYrPRM=;
        b=b34IAAwB+Mq6PpIWWaNtmg4ROC99NbaT7JBlFZ3vBed7J8sAmm2Whc2Bt4EQuhqdO7
         Zg07TXzTl6NJKytDHN4EQwC4fj7WwGyydlRSt1hs7PwU+fRCVGdA4pWUZ1GaGUFiyiag
         7m3GG2P3yq8GVDs/DEyAUB0IuKNXGyl7LWlms=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=gf8veY8duEOeFYSJZXfdwsNWKauCP4u1I3esHldqM6FcqWk1BJo/zP6STAAfh4pgz6
         fewzIfs3+c5N2opR4ymrPJJOwFaSPV4VFbv7BCCe1zIKdiMk2lviQVO4GXIhQ591aQLC
         puw2gPzwuDELQbfImiiqBrR7fpF4dBpxPBTT4=
MIME-Version: 1.0
Received: by 10.229.115.8 with SMTP id g8mr1721303qcq.60.1263421781669; Wed, 
	13 Jan 2010 14:29:41 -0800 (PST)
In-Reply-To: <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
	 <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
	 <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
	 <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>
Date: Wed, 13 Jan 2010 14:29:41 -0800
Message-ID: <79015b391001131429p729c967oaa5e4ab770854e@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Trin Chavalittumrong <mrtrin@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0023544708dc7f7833047d134e1f

--0023544708dc7f7833047d134e1f
Content-Type: text/plain; charset=ISO-8859-1

Do you mean MergePolicy is only used during index time and will be ignored
by by the Optimize() process?


On Wed, Jan 13, 2010 at 1:57 PM, Jason Rutherglen <
jason.rutherglen@gmail.com> wrote:

> Oh ok, you're asking about optimizing... I think that's a different
> algorithm inside LogMergePolicy.  I think it ignores the maxMergeMB
> param.
>
> On Wed, Jan 13, 2010 at 1:49 PM, Trin Chavalittumrong <mrtrin@gmail.com>
> wrote:
> > Thanks, Jason.
> >
> > Is my understanding correct that
> LogByteSizeMergePolicy.setMaxMergeMB(100)
> > will prevent
> > merging of two segments that is larger than 100 Mb each at the optimizing
> > time?
> >
> > If so, why do think would I still see segment that is larger than 200 MB?
> >
> >
> >
> > On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
> > jason.rutherglen@gmail.com> wrote:
> >
> >> Hi Trin,
> >>
> >> There was recently a discussion about this, the max size is
> >> for the before merge segments, rather than the resultant merged
> >> segment (if that makes sense). It'd be great if we had a merge
> >> policy that limited the resultant merged segment, though that'd
> >> by a rough approximation at best.
> >>
> >> Jason
> >>
> >> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <mrtrin@gmail.com
> >
> >> wrote:
> >> > Hi,
> >> >
> >> >
> >> >
> >> > I am trying to optimize the index which would merge different segment
> >> > together. Let say the index folder is 1Gb in total, I need each
> >> segmentation
> >> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePolicy
> *and
> >> > setMaxMergeMB(100) to ensure no segment after merging would be 200Mb.
> >> > However, I still see segment that are larger than 200Mb. I did call
> >> > IndexWriter.optimize(20) to make sure there are enough number
> >> segmentation
> >> > to allow each segment to be under 200Mb.
> >> >
> >> >
> >> >
> >> > Can someone let me know if I am using this right? Or any suggestion on
> >> how
> >> > to tackle this would be helpful.
> >> >
> >> >
> >> >
> >> > Thanks,
> >> >
> >> > Trin
> >> >
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0023544708dc7f7833047d134e1f--

From java-user-return-44530-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 22:36:00 2010
Return-Path: <java-user-return-44530-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9243 invoked from network); 13 Jan 2010 22:36:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 22:36:00 -0000
Received: (qmail 86073 invoked by uid 500); 13 Jan 2010 22:35:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86005 invoked by uid 500); 13 Jan 2010 22:35:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85995 invoked by uid 99); 13 Jan 2010 22:35:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 22:35:57 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FUZZY_VLIUM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.222.194 as permitted sender)
Received: from [209.85.222.194] (HELO mail-pz0-f194.google.com) (209.85.222.194)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 22:35:49 +0000
Received: by pzk32 with SMTP id 32so1379269pzk.29
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 14:35:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=L/dgl1zmAc5KMFP6RCZBY83Ni5B+ejBkddZ7toFRkQM=;
        b=n054aTKw+CyzxrLHtnoQsn6j9b4rUwxG1fcHPghOlTGZSjo0sMvsiJ8nTR07EyOJ5T
         sMA/r2PJmLFQzCZC9z1/TvoT8bBwtimY46heV0PZoRGnIdlX9YE9OqliVoTOv7kwm7pI
         mFnHubCy/C6zUyZQsRCyecFzQJupYTTTt+0KI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=GmLLWDEo4Hon613ZNGF5h/lv8dL++loN0WinoJTCzAXOf3ngycbOWF1jWwygo8j2Of
         KX3R57pou2Nq2ohv8ZZ+8+0vFdBX+hnPYkSFyBTP8T+TNAvnRBKHV3gt/2PCGgMQROFE
         +UFCVLsxXmiFv8YVLfLTPLOVZpXBk5oN5bfg4=
MIME-Version: 1.0
Received: by 10.141.107.13 with SMTP id j13mr4710464rvm.172.1263422128476; 
	Wed, 13 Jan 2010 14:35:28 -0800 (PST)
In-Reply-To: <79015b391001131429p729c967oaa5e4ab770854e@mail.gmail.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
	 <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
	 <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
	 <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>
	 <79015b391001131429p729c967oaa5e4ab770854e@mail.gmail.com>
Date: Wed, 13 Jan 2010 14:35:28 -0800
Message-ID: <85d3c3b61001131435j92d28f1j9130abadcd72df3@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

There's a different method in LogMergePolicy that performs the
optimize... Right, so normal merging uses the findMerges method, then
there's a findMergeOptimize (method names could be inaccurate).

On Wed, Jan 13, 2010 at 2:29 PM, Trin Chavalittumrong <mrtrin@gmail.com> wr=
ote:
> Do you mean MergePolicy is only used during index time and will be ignore=
d
> by by the Optimize() process?
>
>
> On Wed, Jan 13, 2010 at 1:57 PM, Jason Rutherglen <
> jason.rutherglen@gmail.com> wrote:
>
>> Oh ok, you're asking about optimizing... I think that's a different
>> algorithm inside LogMergePolicy. =A0I think it ignores the maxMergeMB
>> param.
>>
>> On Wed, Jan 13, 2010 at 1:49 PM, Trin Chavalittumrong <mrtrin@gmail.com>
>> wrote:
>> > Thanks, Jason.
>> >
>> > Is my understanding correct that
>> LogByteSizeMergePolicy.setMaxMergeMB(100)
>> > will prevent
>> > merging of two segments that is larger than 100 Mb each at the optimiz=
ing
>> > time?
>> >
>> > If so, why do think would I still see segment that is larger than 200 =
MB?
>> >
>> >
>> >
>> > On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
>> > jason.rutherglen@gmail.com> wrote:
>> >
>> >> Hi Trin,
>> >>
>> >> There was recently a discussion about this, the max size is
>> >> for the before merge segments, rather than the resultant merged
>> >> segment (if that makes sense). It'd be great if we had a merge
>> >> policy that limited the resultant merged segment, though that'd
>> >> by a rough approximation at best.
>> >>
>> >> Jason
>> >>
>> >> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <mrtrin@gmail.c=
om
>> >
>> >> wrote:
>> >> > Hi,
>> >> >
>> >> >
>> >> >
>> >> > I am trying to optimize the index which would merge different segme=
nt
>> >> > together. Let say the index folder is 1Gb in total, I need each
>> >> segmentation
>> >> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePolicy
>> *and
>> >> > setMaxMergeMB(100) to ensure no segment after merging would be 200M=
b.
>> >> > However, I still see segment that are larger than 200Mb. I did call
>> >> > IndexWriter.optimize(20) to make sure there are enough number
>> >> segmentation
>> >> > to allow each segment to be under 200Mb.
>> >> >
>> >> >
>> >> >
>> >> > Can someone let me know if I am using this right? Or any suggestion=
 on
>> >> how
>> >> > to tackle this would be helpful.
>> >> >
>> >> >
>> >> >
>> >> > Thanks,
>> >> >
>> >> > Trin
>> >> >
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44531-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 22:45:13 2010
Return-Path: <java-user-return-44531-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11451 invoked from network); 13 Jan 2010 22:45:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 22:45:13 -0000
Received: (qmail 99176 invoked by uid 500); 13 Jan 2010 22:45:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99098 invoked by uid 500); 13 Jan 2010 22:45:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99088 invoked by uid 99); 13 Jan 2010 22:45:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 22:45:10 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=FUZZY_VLIUM,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mrtrin@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 22:45:02 +0000
Received: by qw-out-2122.google.com with SMTP id 5so112641qwd.53
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 14:44:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=/i7ttX3vxi3conX6in+ZjcRN2zO8JD1DU5gkLcJtm2Q=;
        b=v8eKxWYi7efiQ/Kv2dl5DufgyRI5JWpftuFwxxkhhzbY+T7ZXkI7Kg7xt24OBsluoj
         RyqXiu45yIKgyhEwpRUxlvvKXkWVwOIF1Q/DiX5OCPijIOJO1Q+Eou9gsDnIoPDKd/T8
         xIbCcOfgz4mdnqtOklUkmWrJF0jsIZs9Dp69o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=TKiqNEhdC0ZuLkzpC7aIQTsoo/58fJxmdbOk7FXxEBwcdaMZjFW41JKmSloa4Wh0Mi
         vAHdqls0T1a9uRLJbcSJWUt5vCc7fwec7e+kEYYwntOoqS5PfQKSCTgdnuGXUw08onQP
         mH3/ICCRy0QNr7cZDCv026X+NtE8g8tnY0/aU=
MIME-Version: 1.0
Received: by 10.229.20.77 with SMTP id e13mr5593639qcb.14.1263422681263; Wed, 
	13 Jan 2010 14:44:41 -0800 (PST)
In-Reply-To: <85d3c3b61001131435j92d28f1j9130abadcd72df3@mail.gmail.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
	 <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
	 <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
	 <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>
	 <79015b391001131429p729c967oaa5e4ab770854e@mail.gmail.com>
	 <85d3c3b61001131435j92d28f1j9130abadcd72df3@mail.gmail.com>
Date: Wed, 13 Jan 2010 14:44:41 -0800
Message-ID: <79015b391001131444j69d898c7t98e6890aa298939e@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Trin Chavalittumrong <mrtrin@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016367f961a1e3c4f047d138489
X-Virus-Checked: Checked by ClamAV on apache.org

--0016367f961a1e3c4f047d138489
Content-Type: text/plain; charset=ISO-8859-1

Seems like optimize() only cares about final number of segments rather than
the size of the segment. Is it so?

On Wed, Jan 13, 2010 at 2:35 PM, Jason Rutherglen <
jason.rutherglen@gmail.com> wrote:

> There's a different method in LogMergePolicy that performs the
> optimize... Right, so normal merging uses the findMerges method, then
> there's a findMergeOptimize (method names could be inaccurate).
>
> On Wed, Jan 13, 2010 at 2:29 PM, Trin Chavalittumrong <mrtrin@gmail.com>
> wrote:
> > Do you mean MergePolicy is only used during index time and will be
> ignored
> > by by the Optimize() process?
> >
> >
> > On Wed, Jan 13, 2010 at 1:57 PM, Jason Rutherglen <
> > jason.rutherglen@gmail.com> wrote:
> >
> >> Oh ok, you're asking about optimizing... I think that's a different
> >> algorithm inside LogMergePolicy.  I think it ignores the maxMergeMB
> >> param.
> >>
> >> On Wed, Jan 13, 2010 at 1:49 PM, Trin Chavalittumrong <mrtrin@gmail.com
> >
> >> wrote:
> >> > Thanks, Jason.
> >> >
> >> > Is my understanding correct that
> >> LogByteSizeMergePolicy.setMaxMergeMB(100)
> >> > will prevent
> >> > merging of two segments that is larger than 100 Mb each at the
> optimizing
> >> > time?
> >> >
> >> > If so, why do think would I still see segment that is larger than 200
> MB?
> >> >
> >> >
> >> >
> >> > On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
> >> > jason.rutherglen@gmail.com> wrote:
> >> >
> >> >> Hi Trin,
> >> >>
> >> >> There was recently a discussion about this, the max size is
> >> >> for the before merge segments, rather than the resultant merged
> >> >> segment (if that makes sense). It'd be great if we had a merge
> >> >> policy that limited the resultant merged segment, though that'd
> >> >> by a rough approximation at best.
> >> >>
> >> >> Jason
> >> >>
> >> >> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <
> mrtrin@gmail.com
> >> >
> >> >> wrote:
> >> >> > Hi,
> >> >> >
> >> >> >
> >> >> >
> >> >> > I am trying to optimize the index which would merge different
> segment
> >> >> > together. Let say the index folder is 1Gb in total, I need each
> >> >> segmentation
> >> >> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePolicy
> >> *and
> >> >> > setMaxMergeMB(100) to ensure no segment after merging would be
> 200Mb.
> >> >> > However, I still see segment that are larger than 200Mb. I did call
> >> >> > IndexWriter.optimize(20) to make sure there are enough number
> >> >> segmentation
> >> >> > to allow each segment to be under 200Mb.
> >> >> >
> >> >> >
> >> >> >
> >> >> > Can someone let me know if I am using this right? Or any suggestion
> on
> >> >> how
> >> >> > to tackle this would be helpful.
> >> >> >
> >> >> >
> >> >> >
> >> >> > Thanks,
> >> >> >
> >> >> > Trin
> >> >> >
> >> >>
> >> >> ---------------------------------------------------------------------
> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >>
> >> >>
> >> >
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016367f961a1e3c4f047d138489--

From java-user-return-44532-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 22:55:07 2010
Return-Path: <java-user-return-44532-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16831 invoked from network); 13 Jan 2010 22:55:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 22:55:07 -0000
Received: (qmail 27648 invoked by uid 500); 13 Jan 2010 22:55:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27572 invoked by uid 500); 13 Jan 2010 22:55:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27311 invoked by uid 99); 13 Jan 2010 22:55:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 22:55:05 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FUZZY_VLIUM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 22:54:59 +0000
Received: by pwi11 with SMTP id 11so3468801pwi.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 14:54:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=c4ZkYrsRjmslPWa/qTHAEW+OrFQA+PEjohedzyL2obI=;
        b=KjTMclEPG1596WxAXy38qScOysML+GmvwFTn0ZeyZTyUu6XZmgpjuHzju5aXngCCdP
         BbvjlC9G8RZeYMhEm39YPTr7qN2bsS7sL1+Lz7IJQilYMxaA+B4i6+mApbwZZF2R6M6G
         Dnt22GGiAVd4fmWvvrR5+nNgREsajP06CEkTs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=fNX1pwyA/GLaWvqnlwvaoUchUJ7zvsjH0/rE4U34DMYAnAxAVnPBkOePBee29Ho2QG
         Zv7bBzQsYI5VzL+ru5qVzL8ZEEVEhGzXbNCqakixBgESq6IdnrmDZ7jfX4yNGMwhUawq
         QNgFGIDFwJrUDNnauIB/ZExnxXzwmbVvCz2I0=
MIME-Version: 1.0
Received: by 10.141.105.5 with SMTP id h5mr1378681rvm.178.1263423278804; Wed, 
	13 Jan 2010 14:54:38 -0800 (PST)
In-Reply-To: <79015b391001131444j69d898c7t98e6890aa298939e@mail.gmail.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
	 <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
	 <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
	 <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>
	 <79015b391001131429p729c967oaa5e4ab770854e@mail.gmail.com>
	 <85d3c3b61001131435j92d28f1j9130abadcd72df3@mail.gmail.com>
	 <79015b391001131444j69d898c7t98e6890aa298939e@mail.gmail.com>
Date: Wed, 13 Jan 2010 14:54:38 -0800
Message-ID: <85d3c3b61001131454t34625cd7tf45560acc2c3abfd@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Yes... You could hack LogMergePolicy to do something else.

I use optimise(numsegments:5) regularly on 80GB indexes, that if
optimized to 1 segment, would thrash the IO excessively.  This works
fine because 15-20GB indexes are plenty large and fast.

On Wed, Jan 13, 2010 at 2:44 PM, Trin Chavalittumrong <mrtrin@gmail.com> wr=
ote:
> Seems like optimize() only cares about final number of segments rather th=
an
> the size of the segment. Is it so?
>
> On Wed, Jan 13, 2010 at 2:35 PM, Jason Rutherglen <
> jason.rutherglen@gmail.com> wrote:
>
>> There's a different method in LogMergePolicy that performs the
>> optimize... Right, so normal merging uses the findMerges method, then
>> there's a findMergeOptimize (method names could be inaccurate).
>>
>> On Wed, Jan 13, 2010 at 2:29 PM, Trin Chavalittumrong <mrtrin@gmail.com>
>> wrote:
>> > Do you mean MergePolicy is only used during index time and will be
>> ignored
>> > by by the Optimize() process?
>> >
>> >
>> > On Wed, Jan 13, 2010 at 1:57 PM, Jason Rutherglen <
>> > jason.rutherglen@gmail.com> wrote:
>> >
>> >> Oh ok, you're asking about optimizing... I think that's a different
>> >> algorithm inside LogMergePolicy. =A0I think it ignores the maxMergeMB
>> >> param.
>> >>
>> >> On Wed, Jan 13, 2010 at 1:49 PM, Trin Chavalittumrong <mrtrin@gmail.c=
om
>> >
>> >> wrote:
>> >> > Thanks, Jason.
>> >> >
>> >> > Is my understanding correct that
>> >> LogByteSizeMergePolicy.setMaxMergeMB(100)
>> >> > will prevent
>> >> > merging of two segments that is larger than 100 Mb each at the
>> optimizing
>> >> > time?
>> >> >
>> >> > If so, why do think would I still see segment that is larger than 2=
00
>> MB?
>> >> >
>> >> >
>> >> >
>> >> > On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
>> >> > jason.rutherglen@gmail.com> wrote:
>> >> >
>> >> >> Hi Trin,
>> >> >>
>> >> >> There was recently a discussion about this, the max size is
>> >> >> for the before merge segments, rather than the resultant merged
>> >> >> segment (if that makes sense). It'd be great if we had a merge
>> >> >> policy that limited the resultant merged segment, though that'd
>> >> >> by a rough approximation at best.
>> >> >>
>> >> >> Jason
>> >> >>
>> >> >> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <
>> mrtrin@gmail.com
>> >> >
>> >> >> wrote:
>> >> >> > Hi,
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >> > I am trying to optimize the index which would merge different
>> segment
>> >> >> > together. Let say the index folder is 1Gb in total, I need each
>> >> >> segmentation
>> >> >> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePoli=
cy
>> >> *and
>> >> >> > setMaxMergeMB(100) to ensure no segment after merging would be
>> 200Mb.
>> >> >> > However, I still see segment that are larger than 200Mb. I did c=
all
>> >> >> > IndexWriter.optimize(20) to make sure there are enough number
>> >> >> segmentation
>> >> >> > to allow each segment to be under 200Mb.
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >> > Can someone let me know if I am using this right? Or any suggest=
ion
>> on
>> >> >> how
>> >> >> > to tackle this would be helpful.
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >> > Thanks,
>> >> >> >
>> >> >> > Trin
>> >> >> >
>> >> >>
>> >> >> ------------------------------------------------------------------=
---
>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >>
>> >> >>
>> >> >
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44533-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 23:05:39 2010
Return-Path: <java-user-return-44533-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21601 invoked from network); 13 Jan 2010 23:05:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 23:05:39 -0000
Received: (qmail 50446 invoked by uid 500); 13 Jan 2010 23:05:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50369 invoked by uid 500); 13 Jan 2010 23:05:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50355 invoked by uid 99); 13 Jan 2010 23:05:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 23:05:36 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=FUZZY_VLIUM,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 13 Jan 2010 23:05:25 +0000
Received: (qmail 93419 invoked by uid 60001); 13 Jan 2010 23:05:04 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263423904; bh=in8VLTI9NcDUNOYtq71dPzSKqLYmslIbrzaaFJ3Bzro=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=jRnpwpKJUtqDhpFsYlfyD0PhOl/LA/oB+Z3gQyzRRnA1lfRWJQKE0bMzitXiHIkH1/vUHdx+kZ219WD4R93K0E/IlUqw6FW5IQzPmb8G0Y3SScuUi3q2qkVQ6TksH7wSnGNvzO98/EaAI1PS92AWngo5zqqbJdfNM5IHmEs6sbw=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=rzPIugpSOBeUYWWqT2sguWPWeXWlGsOyBTEThdDDJwU7fBMUk1YOJxuTLYSZWKcJsBcE+NIYNwQv3Y06p3mAM+owZXzjsAAUBe0NwOxv6lpSfRlKEZa5xthFyfe9Mj6aTip8Axcp+MwMJrlHsdqRcByXPTW62Z4PuurIMirKfEY=;
Message-ID: <520273.93119.qm@web50307.mail.re2.yahoo.com>
X-YMail-OSG: QDv4OsoVM1kXO36wseTQTZ7I12bCn6zq5BDspXBw9kKeTuyAcClTcoTcqeRwz_2iAghpDQaJ0Pz9T3Ck2fnOPz88iS.NV2gz27_BAfFV8Vk7pecYaO4vPb8yNPT6FdTOe4Z1HeHVsCb9wNxlgDX6L1eWvnjUrzvbQXI1XPbIyo4kmBRBeyxc1TmuUHRnRixkkSyZs7tYq8jwVnMAgB9NziNOXBR58ICZLUMDjl5vF_ozmrSN7QPktS8zgBwRmMdyA61GzcV4mtxHGgKZ_FUJemRElNFnnK8Se7U09U_LhL00wW8juOOQThJLIJAbDZ8xIlXWrVoCsmIeFO3mKcHautZ3.K3QlCt5llgigrra1dsMgyPEupBontu_1sQmsDhDEipl4OtT6McRM3OculVZxuuLsQ_qkoF2mOlBFOGjxyVCKNy61ECD
Received: from [167.206.188.3] by web50307.mail.re2.yahoo.com via HTTP; Wed, 13 Jan 2010 15:05:04 PST
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>  <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>  <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>  <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>  <79015b391001131429p729c967oaa5e4ab770854e@mail.gmail.com>  <85d3c3b61001131435j92d28f1j9130abadcd72df3@mail.gmail.com>  <79015b391001131444j69d898c7t98e6890aa298939e@mail.gmail.com> <85d3c3b61001131454t34625cd7tf45560acc2c3abfd@mail.gmail.com>
Date: Wed, 13 Jan 2010 15:05:04 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Max Segmentation Size when Optimizing Index
To: java-user@lucene.apache.org
In-Reply-To: <85d3c3b61001131454t34625cd7tf45560acc2c3abfd@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-2094962347-1263423904=:93119"
X-Virus-Checked: Checked by ClamAV on apache.org

--0-2094962347-1263423904=:93119
Content-Type: text/plain; charset=us-ascii

I think Jason meant "15-20GB segments"?
 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch




________________________________
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Sent: Wed, January 13, 2010 5:54:38 PM
Subject: Re: Max Segmentation Size when Optimizing Index

Yes... You could hack LogMergePolicy to do something else.

I use optimise(numsegments:5) regularly on 80GB indexes, that if
optimized to 1 segment, would thrash the IO excessively.  This works
fine because 15-20GB indexes are plenty large and fast.

On Wed, Jan 13, 2010 at 2:44 PM, Trin Chavalittumrong <mrtrin@gmail.com> wrote:
> Seems like optimize() only cares about final number of segments rather than
> the size of the segment. Is it so?
>
> On Wed, Jan 13, 2010 at 2:35 PM, Jason Rutherglen <
> jason.rutherglen@gmail.com> wrote:
>
>> There's a different method in LogMergePolicy that performs the
>> optimize... Right, so normal merging uses the findMerges method, then
>> there's a findMergeOptimize (method names could be inaccurate).
>>
>> On Wed, Jan 13, 2010 at 2:29 PM, Trin Chavalittumrong <mrtrin@gmail.com>
>> wrote:
>> > Do you mean MergePolicy is only used during index time and will be
>> ignored
>> > by by the Optimize() process?
>> >
>> >
>> > On Wed, Jan 13, 2010 at 1:57 PM, Jason Rutherglen <
>> > jason.rutherglen@gmail.com> wrote:
>> >
>> >> Oh ok, you're asking about optimizing... I think that's a different
>> >> algorithm inside LogMergePolicy.  I think it ignores the maxMergeMB
>> >> param.
>> >>
>> >> On Wed, Jan 13, 2010 at 1:49 PM, Trin Chavalittumrong <mrtrin@gmail.com
>> >
>> >> wrote:
>> >> > Thanks, Jason.
>> >> >
>> >> > Is my understanding correct that
>> >> LogByteSizeMergePolicy.setMaxMergeMB(100)
>> >> > will prevent
>> >> > merging of two segments that is larger than 100 Mb each at the
>> optimizing
>> >> > time?
>> >> >
>> >> > If so, why do think would I still see segment that is larger than 200
>> MB?
>> >> >
>> >> >
>> >> >
>> >> > On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
>> >> > jason.rutherglen@gmail.com> wrote:
>> >> >
>> >> >> Hi Trin,
>> >> >>
>> >> >> There was recently a discussion about this, the max size is
>> >> >> for the before merge segments, rather than the resultant merged
>> >> >> segment (if that makes sense). It'd be great if we had a merge
>> >> >> policy that limited the resultant merged segment, though that'd
>> >> >> by a rough approximation at best.
>> >> >>
>> >> >> Jason
>> >> >>
>> >> >> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <
>> mrtrin@gmail.com
>> >> >
>> >> >> wrote:
>> >> >> > Hi,
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >> > I am trying to optimize the index which would merge different
>> segment
>> >> >> > together. Let say the index folder is 1Gb in total, I need each
>> >> >> segmentation
>> >> >> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePolicy
>> >> *and
>> >> >> > setMaxMergeMB(100) to ensure no segment after merging would be
>> 200Mb.
>> >> >> > However, I still see segment that are larger than 200Mb. I did call
>> >> >> > IndexWriter.optimize(20) to make sure there are enough number
>> >> >> segmentation
>> >> >> > to allow each segment to be under 200Mb.
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >> > Can someone let me know if I am using this right? Or any suggestion
>> on
>> >> >> how
>> >> >> > to tackle this would be helpful.
>> >> >> >
>> >> >> >
>> >> >> >
>> >> >> > Thanks,
>> >> >> >
>> >> >> > Trin
>> >> >> >
>> >> >>
>> >> >> ---------------------------------------------------------------------
>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >> >>
>> >> >>
>> >> >
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--0-2094962347-1263423904=:93119--

From java-user-return-44534-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 23:08:57 2010
Return-Path: <java-user-return-44534-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23290 invoked from network); 13 Jan 2010 23:08:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 23:08:57 -0000
Received: (qmail 60683 invoked by uid 500); 13 Jan 2010 23:08:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60611 invoked by uid 500); 13 Jan 2010 23:08:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60601 invoked by uid 99); 13 Jan 2010 23:08:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 23:08:54 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FUZZY_VLIUM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.216.204 as permitted sender)
Received: from [209.85.216.204] (HELO mail-px0-f204.google.com) (209.85.216.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 23:08:44 +0000
Received: by pxi42 with SMTP id 42so12464pxi.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 15:08:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=FDAlz3sYotubAaKq+2UxWw0ltQevxBP+5DSBScLnta8=;
        b=HEv9PuiuroQvYsCnb2oZTiuG25FR6uV98pnW8O8AdlQMho8Imuy3xUM2qEldtGi8gi
         jTETbEyzCKRIYoAommC3GGO2Uy+7SgJsMQ6lR+XUJWrAGN7Hkzz6p1Gn7oBGXBVSnOk7
         BXc48xDXh0LwHjdQe0ArIuR2tdcpHUsd0K+ko=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=i7Mah41EM2J7+jPVglG3Gdet9AXArNMCguB1z8U989YsueYfP84jPD9tsFF7Yl6+6a
         +iXt0fb/58hzPdNT2L4lO501NjM32cnceBoKTg5o1AlyhOe7e1Z0o52k2rNntKjTY4/I
         j2vLRoN4BkQl4S2HG6Ik30e0LLoaxsxorxzHM=
MIME-Version: 1.0
Received: by 10.141.188.19 with SMTP id q19mr6420625rvp.164.1263424103284; 
	Wed, 13 Jan 2010 15:08:23 -0800 (PST)
In-Reply-To: <520273.93119.qm@web50307.mail.re2.yahoo.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
	 <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
	 <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
	 <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>
	 <79015b391001131429p729c967oaa5e4ab770854e@mail.gmail.com>
	 <85d3c3b61001131435j92d28f1j9130abadcd72df3@mail.gmail.com>
	 <79015b391001131444j69d898c7t98e6890aa298939e@mail.gmail.com>
	 <85d3c3b61001131454t34625cd7tf45560acc2c3abfd@mail.gmail.com>
	 <520273.93119.qm@web50307.mail.re2.yahoo.com>
Date: Wed, 13 Jan 2010 15:08:23 -0800
Message-ID: <85d3c3b61001131508p408c6903j966ba551e775f00e@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Right... It all blends together, I need an NLP analyzer for my emails

On Wed, Jan 13, 2010 at 3:05 PM, Otis Gospodnetic
<otis_gospodnetic@yahoo.com> wrote:
> I think Jason meant "15-20GB segments"?
> =A0Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>
>
>
> ________________________________
> From: Jason Rutherglen <jason.rutherglen@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Wed, January 13, 2010 5:54:38 PM
> Subject: Re: Max Segmentation Size when Optimizing Index
>
> Yes... You could hack LogMergePolicy to do something else.
>
> I use optimise(numsegments:5) regularly on 80GB indexes, that if
> optimized to 1 segment, would thrash the IO excessively. =A0This works
> fine because 15-20GB indexes are plenty large and fast.
>
> On Wed, Jan 13, 2010 at 2:44 PM, Trin Chavalittumrong <mrtrin@gmail.com> =
wrote:
>> Seems like optimize() only cares about final number of segments rather t=
han
>> the size of the segment. Is it so?
>>
>> On Wed, Jan 13, 2010 at 2:35 PM, Jason Rutherglen <
>> jason.rutherglen@gmail.com> wrote:
>>
>>> There's a different method in LogMergePolicy that performs the
>>> optimize... Right, so normal merging uses the findMerges method, then
>>> there's a findMergeOptimize (method names could be inaccurate).
>>>
>>> On Wed, Jan 13, 2010 at 2:29 PM, Trin Chavalittumrong <mrtrin@gmail.com=
>
>>> wrote:
>>> > Do you mean MergePolicy is only used during index time and will be
>>> ignored
>>> > by by the Optimize() process?
>>> >
>>> >
>>> > On Wed, Jan 13, 2010 at 1:57 PM, Jason Rutherglen <
>>> > jason.rutherglen@gmail.com> wrote:
>>> >
>>> >> Oh ok, you're asking about optimizing... I think that's a different
>>> >> algorithm inside LogMergePolicy. =A0I think it ignores the maxMergeM=
B
>>> >> param.
>>> >>
>>> >> On Wed, Jan 13, 2010 at 1:49 PM, Trin Chavalittumrong <mrtrin@gmail.=
com
>>> >
>>> >> wrote:
>>> >> > Thanks, Jason.
>>> >> >
>>> >> > Is my understanding correct that
>>> >> LogByteSizeMergePolicy.setMaxMergeMB(100)
>>> >> > will prevent
>>> >> > merging of two segments that is larger than 100 Mb each at the
>>> optimizing
>>> >> > time?
>>> >> >
>>> >> > If so, why do think would I still see segment that is larger than =
200
>>> MB?
>>> >> >
>>> >> >
>>> >> >
>>> >> > On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
>>> >> > jason.rutherglen@gmail.com> wrote:
>>> >> >
>>> >> >> Hi Trin,
>>> >> >>
>>> >> >> There was recently a discussion about this, the max size is
>>> >> >> for the before merge segments, rather than the resultant merged
>>> >> >> segment (if that makes sense). It'd be great if we had a merge
>>> >> >> policy that limited the resultant merged segment, though that'd
>>> >> >> by a rough approximation at best.
>>> >> >>
>>> >> >> Jason
>>> >> >>
>>> >> >> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <
>>> mrtrin@gmail.com
>>> >> >
>>> >> >> wrote:
>>> >> >> > Hi,
>>> >> >> >
>>> >> >> >
>>> >> >> >
>>> >> >> > I am trying to optimize the index which would merge different
>>> segment
>>> >> >> > together. Let say the index folder is 1Gb in total, I need each
>>> >> >> segmentation
>>> >> >> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePol=
icy
>>> >> *and
>>> >> >> > setMaxMergeMB(100) to ensure no segment after merging would be
>>> 200Mb.
>>> >> >> > However, I still see segment that are larger than 200Mb. I did =
call
>>> >> >> > IndexWriter.optimize(20) to make sure there are enough number
>>> >> >> segmentation
>>> >> >> > to allow each segment to be under 200Mb.
>>> >> >> >
>>> >> >> >
>>> >> >> >
>>> >> >> > Can someone let me know if I am using this right? Or any sugges=
tion
>>> on
>>> >> >> how
>>> >> >> > to tackle this would be helpful.
>>> >> >> >
>>> >> >> >
>>> >> >> >
>>> >> >> > Thanks,
>>> >> >> >
>>> >> >> > Trin
>>> >> >> >
>>> >> >>
>>> >> >> -----------------------------------------------------------------=
----
>>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >> >>
>>> >> >>
>>> >> >
>>> >>
>>> >> --------------------------------------------------------------------=
-
>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >>
>>> >>
>>> >
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44535-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 13 23:11:42 2010
Return-Path: <java-user-return-44535-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23911 invoked from network); 13 Jan 2010 23:11:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 13 Jan 2010 23:11:42 -0000
Received: (qmail 66910 invoked by uid 500); 13 Jan 2010 23:11:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66823 invoked by uid 500); 13 Jan 2010 23:11:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66813 invoked by uid 99); 13 Jan 2010 23:11:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 23:11:40 +0000
X-ASF-Spam-Status: No, hits=0.0 required=10.0
	tests=FUZZY_VLIUM,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.216.204 as permitted sender)
Received: from [209.85.216.204] (HELO mail-px0-f204.google.com) (209.85.216.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 13 Jan 2010 23:11:32 +0000
Received: by pxi42 with SMTP id 42so14726pxi.5
        for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 15:11:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=vAJljwjTgVl+4kUEiEhtqfy1uhg+bEan/75CFW2LC+M=;
        b=OkViE/lBf+KrEgJlhkpFxJql46bhbhBpWuqoqartCz6SH2rBxqJYgQs5LUPlBoWUjU
         4/C5N7aXspPhFgkqDUaDF2nvvH4d7EelmK3Dar98QW9OE6xUUVUy4TXWZzDZdWFHbdm/
         XIKY9bwagoN+CplBtDrpBH9zNoBN7pZk8/CHY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=Zq5KN7JM6x7OEzXGOwg9MZs9Q3TPkcwuWJDUyyF8zSH/otlH+rua7IDEKkTD3M7Hch
         qzihjz3em4qlYs0aW5KlSO0rnYjkcQwljou7H7cgtlaai/CocDHPJfH8baGq7tBXJvjM
         aPXQA19hH0LoXlE+lvmCicKhFPIUGqX96vTZQ=
MIME-Version: 1.0
Received: by 10.140.58.7 with SMTP id g7mr3096537rva.98.1263424271502; Wed, 13 
	Jan 2010 15:11:11 -0800 (PST)
In-Reply-To: <520273.93119.qm@web50307.mail.re2.yahoo.com>
References: <79015b391001131336t81cc1a9xa15267f5249244e@mail.gmail.com>
	 <85d3c3b61001131343o63023bc9tb772770c12d9c00f@mail.gmail.com>
	 <79015b391001131349j7158b650k7f28e814955377f@mail.gmail.com>
	 <85d3c3b61001131357pcf2625ah9fcefb004646733e@mail.gmail.com>
	 <79015b391001131429p729c967oaa5e4ab770854e@mail.gmail.com>
	 <85d3c3b61001131435j92d28f1j9130abadcd72df3@mail.gmail.com>
	 <79015b391001131444j69d898c7t98e6890aa298939e@mail.gmail.com>
	 <85d3c3b61001131454t34625cd7tf45560acc2c3abfd@mail.gmail.com>
	 <520273.93119.qm@web50307.mail.re2.yahoo.com>
Date: Wed, 13 Jan 2010 15:11:11 -0800
Message-ID: <85d3c3b61001131511o720a7f49hf538bafaad1f227b@mail.gmail.com>
Subject: Re: Max Segmentation Size when Optimizing Index
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Actually I meant to say indexes... However when optimize(numsegments)
is used they're segments...

On Wed, Jan 13, 2010 at 3:05 PM, Otis Gospodnetic
<otis_gospodnetic@yahoo.com> wrote:
> I think Jason meant "15-20GB segments"?
> =A0Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>
>
>
> ________________________________
> From: Jason Rutherglen <jason.rutherglen@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Wed, January 13, 2010 5:54:38 PM
> Subject: Re: Max Segmentation Size when Optimizing Index
>
> Yes... You could hack LogMergePolicy to do something else.
>
> I use optimise(numsegments:5) regularly on 80GB indexes, that if
> optimized to 1 segment, would thrash the IO excessively. =A0This works
> fine because 15-20GB indexes are plenty large and fast.
>
> On Wed, Jan 13, 2010 at 2:44 PM, Trin Chavalittumrong <mrtrin@gmail.com> =
wrote:
>> Seems like optimize() only cares about final number of segments rather t=
han
>> the size of the segment. Is it so?
>>
>> On Wed, Jan 13, 2010 at 2:35 PM, Jason Rutherglen <
>> jason.rutherglen@gmail.com> wrote:
>>
>>> There's a different method in LogMergePolicy that performs the
>>> optimize... Right, so normal merging uses the findMerges method, then
>>> there's a findMergeOptimize (method names could be inaccurate).
>>>
>>> On Wed, Jan 13, 2010 at 2:29 PM, Trin Chavalittumrong <mrtrin@gmail.com=
>
>>> wrote:
>>> > Do you mean MergePolicy is only used during index time and will be
>>> ignored
>>> > by by the Optimize() process?
>>> >
>>> >
>>> > On Wed, Jan 13, 2010 at 1:57 PM, Jason Rutherglen <
>>> > jason.rutherglen@gmail.com> wrote:
>>> >
>>> >> Oh ok, you're asking about optimizing... I think that's a different
>>> >> algorithm inside LogMergePolicy. =A0I think it ignores the maxMergeM=
B
>>> >> param.
>>> >>
>>> >> On Wed, Jan 13, 2010 at 1:49 PM, Trin Chavalittumrong <mrtrin@gmail.=
com
>>> >
>>> >> wrote:
>>> >> > Thanks, Jason.
>>> >> >
>>> >> > Is my understanding correct that
>>> >> LogByteSizeMergePolicy.setMaxMergeMB(100)
>>> >> > will prevent
>>> >> > merging of two segments that is larger than 100 Mb each at the
>>> optimizing
>>> >> > time?
>>> >> >
>>> >> > If so, why do think would I still see segment that is larger than =
200
>>> MB?
>>> >> >
>>> >> >
>>> >> >
>>> >> > On Wed, Jan 13, 2010 at 1:43 PM, Jason Rutherglen <
>>> >> > jason.rutherglen@gmail.com> wrote:
>>> >> >
>>> >> >> Hi Trin,
>>> >> >>
>>> >> >> There was recently a discussion about this, the max size is
>>> >> >> for the before merge segments, rather than the resultant merged
>>> >> >> segment (if that makes sense). It'd be great if we had a merge
>>> >> >> policy that limited the resultant merged segment, though that'd
>>> >> >> by a rough approximation at best.
>>> >> >>
>>> >> >> Jason
>>> >> >>
>>> >> >> On Wed, Jan 13, 2010 at 1:36 PM, Trin Chavalittumrong <
>>> mrtrin@gmail.com
>>> >> >
>>> >> >> wrote:
>>> >> >> > Hi,
>>> >> >> >
>>> >> >> >
>>> >> >> >
>>> >> >> > I am trying to optimize the index which would merge different
>>> segment
>>> >> >> > together. Let say the index folder is 1Gb in total, I need each
>>> >> >> segmentation
>>> >> >> > to be no larger than 200Mb. I tried to use *LogByteSizeMergePol=
icy
>>> >> *and
>>> >> >> > setMaxMergeMB(100) to ensure no segment after merging would be
>>> 200Mb.
>>> >> >> > However, I still see segment that are larger than 200Mb. I did =
call
>>> >> >> > IndexWriter.optimize(20) to make sure there are enough number
>>> >> >> segmentation
>>> >> >> > to allow each segment to be under 200Mb.
>>> >> >> >
>>> >> >> >
>>> >> >> >
>>> >> >> > Can someone let me know if I am using this right? Or any sugges=
tion
>>> on
>>> >> >> how
>>> >> >> > to tackle this would be helpful.
>>> >> >> >
>>> >> >> >
>>> >> >> >
>>> >> >> > Thanks,
>>> >> >> >
>>> >> >> > Trin
>>> >> >> >
>>> >> >>
>>> >> >> -----------------------------------------------------------------=
----
>>> >> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >> >>
>>> >> >>
>>> >> >
>>> >>
>>> >> --------------------------------------------------------------------=
-
>>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>>> >>
>>> >>
>>> >
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44536-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 01:35:12 2010
Return-Path: <java-user-return-44536-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80752 invoked from network); 14 Jan 2010 01:35:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 01:35:12 -0000
Received: (qmail 64790 invoked by uid 500); 14 Jan 2010 01:35:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64709 invoked by uid 500); 14 Jan 2010 01:35:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64694 invoked by uid 99); 14 Jan 2010 01:35:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 01:35:10 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 01:35:00 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NVEbg-0000nc-3J
	for java-user@lucene.apache.org; Wed, 13 Jan 2010 17:34:40 -0800
Message-ID: <27155102.post@talk.nabble.com>
Date: Wed, 13 Jan 2010 17:34:40 -0800 (PST)
From: AlexElba <ramalex1@yahoo.com>
To: java-user@lucene.apache.org
Subject: Re: RangeFilter
In-Reply-To: <27148785.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ramalex1@yahoo.com
References: <27148785.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hello,

I change filter to follow
  RangeFilter rangeFilter = new RangeFilter(
                       "rank", NumberTools
                                .longToString(rating), NumberTools
                                .longToString(10), true, true);

and change index to store rank the same way... But still not seeing :( any
results 


AlexElba wrote:
> 
> Hello,
> 
> I am currently using lucene 2.4 and have document with 3 fields
> 
> id  
> name 
> rank
> 
> and have query and filter when I am trying to use rang filter on rank I am
> not getting any result back
> 
> RangeFilter rangeFilter = new RangeFilter("rank", "3", "10", true, true);
> 
> I have documents which are in this interval 
> 
> 
> Any suggestion what am I doing wrong?
> 
> Regards
> 
> 
> 
> 
> 

-- 
View this message in context: http://old.nabble.com/RangeFilter-tp27148785p27155102.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44537-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 01:47:14 2010
Return-Path: <java-user-return-44537-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86173 invoked from network); 14 Jan 2010 01:47:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 01:47:14 -0000
Received: (qmail 77272 invoked by uid 500); 14 Jan 2010 01:47:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77196 invoked by uid 500); 14 Jan 2010 01:47:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77186 invoked by uid 99); 14 Jan 2010 01:47:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 01:47:11 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.18.92] (HELO smtp2.syr.edu) (128.230.18.92)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 01:47:02 +0000
Received: from suex07-hub-02.ad.syr.edu (suex07-hub-02.ad.syr.edu [128.230.108.196])
	by smtp2.syr.edu (8.14.3/8.14.3) with ESMTP id o0E1keoG021445
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Wed, 13 Jan 2010 20:46:40 -0500
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-02.ad.syr.edu ([fe80::813b:49a2:a4d5:6367%10]) with mapi; Wed, 13
 Jan 2010 20:46:40 -0500
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 13 Jan 2010 20:46:39 -0500
Subject: RE: RangeFilter
Thread-Topic: RangeFilter
Thread-Index: AcqUudP7n970uERATLmWhe3XUL0CPAAANIzA
Message-ID: <2D127F11DC79714E9B6A43AC9458147F36661C0A@suex07-mbx-03.ad.syr.edu>
References: <27148785.post@talk.nabble.com> <27155102.post@talk.nabble.com>
In-Reply-To: <27155102.post@talk.nabble.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.8161:2.4.5,1.2.40,4.0.166 definitions=2010-01-14_03:2010-01-05,2010-01-14,2010-01-13 signatures=0
X-Proofpoint-Spam-Reason: safe

Hi AlexElba,

Did you completely re-index?

If you did, then there is some other problem - can you share (more of) your=
 code?

Do you know about Luke?  It's an essential tool for Lucene index debugging:

   http://www.getopt.org/luke/

Steve

On 01/13/2010 at 8:34 PM, AlexElba wrote:
>=20
> Hello,
>=20
> I change filter to follow
>   RangeFilter rangeFilter =3D new RangeFilter(
>                        "rank", NumberTools
>                                 .longToString(rating), NumberTools
>                                 .longToString(10), true, true);
>=20
> and change index to store rank the same way... But still not seeing :(
> any results
>=20
>=20
> AlexElba wrote:
> >=20
> > Hello,
> >=20
> > I am currently using lucene 2.4 and have document with 3 fields
> >=20
> > id
> > name
> > rank
> >=20
> > and have query and filter when I am trying to use rang filter on rank I
> > am not getting any result back
> >=20
> > RangeFilter rangeFilter =3D new RangeFilter("rank", "3", "10", true,
> > true);
> >=20
> > I have documents which are in this interval
> >=20
> >=20
> > Any suggestion what am I doing wrong?
> >=20
> > Regards
> >=20
> >=20
> >=20
> >=20
> >=20
>=20
> -- View this message in context: http://old.nabble.com/RangeFilter-
> tp27148785p27155102.html Sent from the Lucene - Java Users mailing list
> archive at Nabble.com.
>=20
>=20
> --------------------------------------------------------------------- To
> unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
> additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44538-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 02:49:30 2010
Return-Path: <java-user-return-44538-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9754 invoked from network); 14 Jan 2010 02:49:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 02:49:29 -0000
Received: (qmail 24799 invoked by uid 500); 14 Jan 2010 02:49:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24648 invoked by uid 500); 14 Jan 2010 02:49:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24637 invoked by uid 99); 14 Jan 2010 02:49:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 02:49:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of SRS0=VBBOTs=I7=lucasmail.org=paul@yourhostingaccount.com designates 65.254.254.73 as permitted sender)
Received: from [65.254.254.73] (HELO mailout05.yourhostingaccount.com) (65.254.254.73)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 02:49:18 +0000
Received: from mailscan02.yourhostingaccount.com ([10.1.15.2] helo=mailscan02.yourhostingaccount.com)
	by mailout05.yourhostingaccount.com with esmtp (Exim)
	id 1NVFlZ-0002Lk-En
	for java-user@lucene.apache.org; Wed, 13 Jan 2010 21:48:57 -0500
Received: from impout02.yourhostingaccount.com ([10.1.55.2] helo=impout02.yourhostingaccount.com)
	by mailscan02.yourhostingaccount.com with esmtp (Exim)
	id 1NVFlZ-0001Cf-Cy
	for java-user@lucene.apache.org; Wed, 13 Jan 2010 21:48:57 -0500
Received: from authsmtp04.yourhostingaccount.com ([10.1.18.4])
	by impout02.yourhostingaccount.com with NO UCE
	id VEov1d00205G96J0000000; Wed, 13 Jan 2010 21:48:55 -0500
X-EN-OrigOutIP: 10.1.18.4
X-EN-IMPSID: VEov1d00205G96J0000000
Received: from adsl-76-204-24-82.dsl.pltn13.sbcglobal.net ([76.204.24.82] helo=[10.0.1.215])
	by authsmtp04.yourhostingaccount.com with esmtpsa (TLSv1:AES128-SHA:128)
	(Exim)
	id 1NVFlW-0003XJ-Rh
	for java-user@lucene.apache.org; Wed, 13 Jan 2010 21:48:55 -0500
From: "Paul J. Lucas" <paul@lucasmail.org>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: Hints on implementing XQuery full-text search
Date: Wed, 13 Jan 2010 18:48:51 -0800
Message-Id: <1384E79B-2D30-4059-A441-6EC6621B6DE5@lucasmail.org>
To: java-user@lucene.apache.org
Mime-Version: 1.0 (Apple Message framework v1077)
X-Mailer: Apple Mail (2.1077)
X-EN-UserInfo: 19b3ee6e8bc35660ab25150f3ce1009e:104eb4694f5dc54e252b420fd863a3b6
X-EN-AuthUser: paul@pauljlucas.org
Sender:  "Paul J. Lucas" <paul@lucasmail.org>
X-EN-OrigIP: 76.204.24.82
X-EN-OrigHost: adsl-76-204-24-82.dsl.pltn13.sbcglobal.net

Hi -

I've used Lucene on a previous project, so I am somewhat familiar with =
the API. However, I've never had to do anything "fancy" (where "fancy" =
means things like using filters, different analyzers, boosting, =
payloads, etc).

I'm about to embark on implementing the full-text search feature of =
XQuery:

	http://www.w3.org/TR/xpath-full-text-10/

Its query abilities are the most complicated I've seen.  =46rom my =
experience with Lucene, I know it can be used to implement some of the =
features; however, I'd like to walk through them all.  For each feature, =
I only need a simple answer like, "Feature X is best implemented using a =
query filter," just so I start off in the right direction for each =
feature.

Note: I will be implementing my own query parser and construct queries =
"by hand" using various instantiations of Lucene classes.

-------------------------
3.3 Cardinality Selection

This allows you to say things like:

	title ftcontains "usability" occurs at least 2 times

which means that the title field must contain the "usability" at least =
twice.  How can this be done?

---------------------
3.4.4 Stemming Option

This allows you to match words that have been indexed against words in =
the query that have been stemmed like:

	title ftcontains "improve" with stemming

which would match even if title contained "improving".  Note that =
PorterStemFilter can not be used because the decision whether to use =
stemming or not is specified at query-time and not index-time.

In this case, would I have to add each word to the index twice?  Once =
for the original word and once for the stemmed word (assuming the =
stemmed word is different from the original word)?  Or is there a better =
way?

-----------------
3.4.5 Case Option

This allows you to specify -- at query-time -- one of "case =
insensitive", "case sensitive", "lowercase", "uppercase".

The last two I think can be implemented using a query filter since, for =
"lowercase", it matches only if the document text is all in lower-case =
(and same for "uppercase").

But how would you handle the case insensitive/sensitive specifications?  =
One thought is to add every word twice: once in its original case and =
once in a normalized case (arbitrarily chosen to be, say, lowercase).  =
Any better ideas?

-----------------------
3.4.6 Diacritics Option

This is similar to the Cast Option except its "diacritics insensitive" =
or "diacritics sensitive.  How about implementing this?

----------------------
3.4.7 Stop Word Option

This allows you to specify -- qt query time -- "with stop words", e.g.:

	abstract ftcontains "propagating of errors"
	with stop words ("a", "the", "of")

would match a document with an abstract that contains "propagating few =
errors". It seems odd, I know.  It's as if the stop words become =
wildcards, i.e.:

	"propagating of errors" -> "propagating * errors"

where * will match any word in the document.  How can this be =
implemented in Lucene?

------------------------
3.5.3 Mild-Not Selection

XQuery has two flavors of "not": (regular) not and mild-not.  This =
allows you to have a query like:

	body ftcontains "Mexico" not in "New Mexico"

which would only match documents that contain "Mexico" when it's not =
part of the phrase "New Mexico".  How can this be implemented using =
Lucene?

-----------------------
3.6.1 Ordered Selection

This allows you to require that the order of the words in a query match =
the order of the words in a document, e.g.:

	title ftcontains ("web site" ftand "usability") ordered

which would match only if the phrase "web site" and the word "usability" =
both occurred in the document and "usability" comes after "web site" in =
word order.  My guess for implementing this would be to keep track of =
word positions and store this in a payload.  Yes?

---------------------
3.6.4 Scope Selection

This allows you to require that words appear in the same "scope", e.g.:

	abstract ftcontains "usability" ftand "web site" same sentence

You can also do any combination of {same|different} =
{sentence|paragraph}.  My guess for this would also be to keep track of =
sentence/paragraph data in a payload.  Yes?

-----------------
3.7 Ignore Option

Given the partial XQuery:

let $x :=3D <book>
   <title>Web Usability and Practice</title>
   <author>Montana <annotation> this author is
       an expert in Web Usability</annotation> Marigold
   </author>
   <editor>Vera Tudor-Medina on Web <annotation> best
       editor on Web Usability</annotation> Usability
   </editor>
 </book>

if I were to have a query:

	book ftcontains "Web Usability" without content $x//annotation

then it would not consider any text inside of <annotation></annotation> =
elements at all.  "Web Usability" would be found twice: once in the =
title element and once in the editor element.  Note that the latter =
<annotation> element comes smack in the middle of the phrase "Web =
Usability".  My guess for this would also be to use payload data to =
store the element each word is inside of then use a filter based on =
that.  Yes?

-----------------
I realize this is a lot, but any pointers appreciated.  Thanks!

- Paul=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44539-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 09:24:12 2010
Return-Path: <java-user-return-44539-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10640 invoked from network); 14 Jan 2010 09:24:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 09:24:12 -0000
Received: (qmail 76572 invoked by uid 500); 14 Jan 2010 09:24:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76505 invoked by uid 500); 14 Jan 2010 09:24:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76495 invoked by uid 99); 14 Jan 2010 09:24:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 09:24:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of farhang@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 09:23:59 +0000
Received: by ey-out-2122.google.com with SMTP id 9so112416eyd.3
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 01:23:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=FYBJQtIdcfEXSPkUF8GaaSZf+n6wCdtbMgxCUNT10Qk=;
        b=R6wb7/CdOdpWKsQe+4T++qIQEPxM0nR5u22Pgx2VUUOpPCzsYq+wjLPKCWnFLVmgSQ
         reHuN6CMfwuDkVVJ9OnvhD9HQ7rClzJx4rlqEAr7ZCmPpxWRtqIzyMehLkbokEHac8PI
         LrBxxjWbRQYewrnZQRt1G/3lKiyQnjthSLgbA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=um4w3rQQxNHE8T5FynI05plUj+kM8DC2oTY6s9HGq5UHsXIChvO73GKOGA6bzgT4Bj
         QnJUY7A/6l7K14fQpgbW7435nmxPci6mwWVM8mjNgPBiprBddak2XI7h18oLiG+FuUDc
         vSw/FhZe06rbmfz6UsJtUq10e9ZLngH+sxfj8=
MIME-Version: 1.0
Received: by 10.216.85.9 with SMTP id t9mr185683wee.79.1263461019187; Thu, 14 
	Jan 2010 01:23:39 -0800 (PST)
Date: Thu, 14 Jan 2010 02:23:39 -0700
Message-ID: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
Subject: incremental document field update
From: Babak Farhang <farhang@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I've been thinking about how to update a single field of a document
without touching its other fields. This is an old problem and I was
considering a solution along the lines of Andrzej Bialecki's post to
the dev list back in '07:


<quote  http://markmail.org/message/tbkgmnilhvrt6bii >

I have the following scenario: I want to use ParallelReader to
maintain parts of the index that are changing quickly, and where
changes are limited to specific fields only.

Let's say I have a "main" index (many fields, slowly changing, large
updates), and an "aux" index (fast changing, usually single doc and
single field updates). I'd like to "replace" documents in the "aux"
index - that is, delete one doc and add another - but in a way that
doesn't change the internal document numbers, so that I can keep the
mapping required by ParallelReader intact.

I think this is possible to achieve by using a FilterIndexReader,
which keeps a map of updated documents, and re-maps old doc ids to the
new ones on the fly.

>From time to time I'd like to optimize the "aux" index to get rid of
deleted docs. At this time I need to figure out how to preserve the
old->new mapping during the optimization.

So, here's the question: is this scenario feasible? If so, then in the
trunk/ version of Lucene, is there any way to figure out (predictably)
how internal document numbers are reassigned after calling optimize()
?

</quote>


Reading that trail, I wish the original poster gave up on his idea (
http://markmail.org/message/tbkgmnilhvrt6bii#query:+page:1+mid:kn77zpiu43kd2ufn+state:results
)


<quote>
Thanks for the input - for now I gave up on this, after discovering
that I would have no way to ensure in TermDocs.skipTo() that document
id-s are monotonically increasing (which seems to be a part of the
contract).
</quote>

I imagine if Andrzej's proposed FilterIndexReader maintains 2 sorted
(ordered) maps, one from internal document-ids to "view" document-ids,
and another mapping from  "view" document-ids to internal
document-ids, then things like skipTo() can be implemented reasonably
efficiently. Only the mapped ids are maintained in these structures.
(Also note that a mapped "view" document-id represents an internally
deleted document with that id.)

And if we can find a way to merge the segments of this "aux" index
along whenever the segments of its associated "main" index are merged
or optimized (such that the [internal] doc-ids in the merged aux index
end up getting sync'ed with those of the trunk), then there shouldn't
be all that many doc-ids to map anyway (if we merge frequently
enough).

So to go back Andrzej's question: is there any way to figure out
(predictably) how internal document numbers [in the main index] are
reassigned after calling optimize() ? How does LUCENE-847, as Doug
Cutting suggests in that trail, help?

Sorry if that was long winded, had to start somewhere ;)

-Babak

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44540-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 09:28:12 2010
Return-Path: <java-user-return-44540-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12443 invoked from network); 14 Jan 2010 09:28:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 09:28:12 -0000
Received: (qmail 80663 invoked by uid 500); 14 Jan 2010 09:28:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80600 invoked by uid 500); 14 Jan 2010 09:28:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80590 invoked by uid 99); 14 Jan 2010 09:28:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 09:28:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of farhang@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 09:28:01 +0000
Received: by ewy9 with SMTP id 9so8159761ewy.11
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 01:27:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ffRRaFIM0rsH05UffuaUhbRF6g0S3IkHp7rQ/020drg=;
        b=nnIMf+8lRf2AY3oVmzTema8DsvEkQqP93/XFUx095KyCZQ9KykMpVpIP16Bz3+CvN4
         GUYSxDH2/SJ5R7EalD0NDf439JrJId6YEXHc1c65Y8rSXva4ZDAY67CC05niULjpaEUb
         SUNituZRgf4JkMawyYMw7t57R0+gWrqwxvhuE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=DUMmDO1djzQIhUYiuwosznfgl4HgbCpqS7OJ0H3+4UN49LCLnECdSeCXuZfFkKQ24C
         ej2vXL27lztLMdLW3YqjGci56EAqwi+Rlq+TAhlNFwbXPsUr6D+ERIDwkiaGAxvt4HWq
         bC/h2iC0k4oetvRtjHwvdqSoL1TnLJkn0xt0M=
MIME-Version: 1.0
Received: by 10.216.86.11 with SMTP id v11mr171005wee.220.1263461260270; Thu, 
	14 Jan 2010 01:27:40 -0800 (PST)
In-Reply-To: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
Date: Thu, 14 Jan 2010 02:27:40 -0700
Message-ID: <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
Subject: Re: incremental document field update
From: Babak Farhang <farhang@gmail.com>
To: java-user <java-user@lucene.apache.org>
Content-Type: text/plain; charset=ISO-8859-1

> Reading that trail, I wish the original poster gave up on his idea (

Err, that should have read..

"Reading that trail, I wish the original poster hadn't given up on his idea"


On Thu, Jan 14, 2010 at 2:23 AM, Babak Farhang <farhang@gmail.com> wrote:
> Hi,
>
> I've been thinking about how to update a single field of a document
> without touching its other fields. This is an old problem and I was
> considering a solution along the lines of Andrzej Bialecki's post to
> the dev list back in '07:
>
>
> <quote  http://markmail.org/message/tbkgmnilhvrt6bii >
>
> I have the following scenario: I want to use ParallelReader to
> maintain parts of the index that are changing quickly, and where
> changes are limited to specific fields only.
>
> Let's say I have a "main" index (many fields, slowly changing, large
> updates), and an "aux" index (fast changing, usually single doc and
> single field updates). I'd like to "replace" documents in the "aux"
> index - that is, delete one doc and add another - but in a way that
> doesn't change the internal document numbers, so that I can keep the
> mapping required by ParallelReader intact.
>
> I think this is possible to achieve by using a FilterIndexReader,
> which keeps a map of updated documents, and re-maps old doc ids to the
> new ones on the fly.
>
> From time to time I'd like to optimize the "aux" index to get rid of
> deleted docs. At this time I need to figure out how to preserve the
> old->new mapping during the optimization.
>
> So, here's the question: is this scenario feasible? If so, then in the
> trunk/ version of Lucene, is there any way to figure out (predictably)
> how internal document numbers are reassigned after calling optimize()
> ?
>
> </quote>
>
>
> Reading that trail, I wish the original poster gave up on his idea (
> http://markmail.org/message/tbkgmnilhvrt6bii#query:+page:1+mid:kn77zpiu43kd2ufn+state:results
> )
>
>
> <quote>
> Thanks for the input - for now I gave up on this, after discovering
> that I would have no way to ensure in TermDocs.skipTo() that document
> id-s are monotonically increasing (which seems to be a part of the
> contract).
> </quote>
>
> I imagine if Andrzej's proposed FilterIndexReader maintains 2 sorted
> (ordered) maps, one from internal document-ids to "view" document-ids,
> and another mapping from  "view" document-ids to internal
> document-ids, then things like skipTo() can be implemented reasonably
> efficiently. Only the mapped ids are maintained in these structures.
> (Also note that a mapped "view" document-id represents an internally
> deleted document with that id.)
>
> And if we can find a way to merge the segments of this "aux" index
> along whenever the segments of its associated "main" index are merged
> or optimized (such that the [internal] doc-ids in the merged aux index
> end up getting sync'ed with those of the trunk), then there shouldn't
> be all that many doc-ids to map anyway (if we merge frequently
> enough).
>
> So to go back Andrzej's question: is there any way to figure out
> (predictably) how internal document numbers [in the main index] are
> reassigned after calling optimize() ? How does LUCENE-847, as Doug
> Cutting suggests in that trail, help?
>
> Sorry if that was long winded, had to start somewhere ;)
>
> -Babak
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44541-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 10:04:57 2010
Return-Path: <java-user-return-44541-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30693 invoked from network); 14 Jan 2010 10:04:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 10:04:57 -0000
Received: (qmail 10565 invoked by uid 500); 14 Jan 2010 10:04:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10491 invoked by uid 500); 14 Jan 2010 10:04:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10474 invoked by uid 99); 14 Jan 2010 10:04:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 10:04:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [213.86.41.125] (HELO mail.truvo.com) (213.86.41.125)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 10:04:46 +0000
X-ASG-Debug-ID: 1263463458-1a8e00e40004-H1Y1KX
X-Barracuda-URL: http://10.255.0.215:8000/cgi-bin/mark.cgi
Received: from exchq-001.wdnet.org (localhost [127.0.0.1])
	by mail.truvo.com (Spam Firewall) with ESMTP id DF9E4350D7
	for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 11:04:24 +0100 (CET)
Received: from exchq-001.wdnet.org (exchq-001.wdnet.org [10.100.10.5]) by mail.truvo.com with ESMTP id GMDWTMyrHwRlsrRS for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 11:04:24 +0100 (CET)
X-ASG-Whitelist: Client
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-ASG-Orig-Subj: RE: Extracting contact data
Subject: RE: Extracting contact data
Date: Thu, 14 Jan 2010 11:04:15 +0100
Message-ID: <08FC5E29EDEA6247B7E499F2EC96BAD3869394@exchq-001.wdnet.org>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Extracting contact data
Thread-Index: AcqUcr9DQlQTJPFhTzux+Xz2EHUgEAAi/pyA
References: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org> <359a92831001130905o3477165dg6202efe9c2ea079b@mail.gmail.com>
From: "Ortelli, Gian Luca" <gianluca.ortelli@truvo.com>
To: <java-user@lucene.apache.org>
X-Barracuda-Connect: exchq-001.wdnet.org[10.100.10.5]
X-Barracuda-Start-Time: 1263463464
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at truvo.com
X-Virus-Checked: Checked by ClamAV on apache.org


Well, the exact definition we're going to find out empirically,=20
as we run an implementation through our data and look at the quality=20
of results... For now, I would use the number of tokens between the
finding ("abc@def.com") and the word that gives context ("Contact").

Anyway, replying to karl: I'm not searching for a given
email/street/time interval/etc., I need to extract EVERY
email/street/time interval/etc. from the text. The kind of need for
which you suggest a natural language processing tool.

  Gianluca

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Wednesday, January 13, 2010 6:06 PM
To: java-user@lucene.apache.org
Subject: Re: Extracting contact data

Before answering, how to you measure "proximity"? You can make
Lucene work with locations (there's an example in Lucene In Action)
readily enough though....

HTH
Erick

On Wed, Jan 13, 2010 at 11:39 AM, Ortelli, Gian Luca <
gianluca.ortelli@truvo.com> wrote:

> Hi community,
>
>
>
> I have a general understanding of Lucene concepts, and I'm wondering
if
> it's the right tool for my job:
>
>
>
> - I need to extract data like e.g. time intervals ("8am - 12pm"),
street
> addresses from a set of files. The common issue with this data unit is
> that they contain spaces and are not always definable through regexes.
>
>
>
> - the extraction must take into consideration the "proximity": for
> example, a mail address which is close to the work "Contacts" will
> receive a higher rank, since I'm looking for contact data.
>
>
>
> Do you think I can get any advantage from building a solution on
Lucene?
>
>
>
>  Gianluca
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44542-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 10:39:57 2010
Return-Path: <java-user-return-44542-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48571 invoked from network); 14 Jan 2010 10:39:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 10:39:57 -0000
Received: (qmail 64757 invoked by uid 500); 14 Jan 2010 10:39:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64686 invoked by uid 500); 14 Jan 2010 10:39:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64674 invoked by uid 99); 14 Jan 2010 10:39:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 10:39:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.216.204] (HELO mail-px0-f204.google.com) (209.85.216.204)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 10:39:45 +0000
Received: by pxi42 with SMTP id 42so264609pxi.5
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 02:39:25 -0800 (PST)
MIME-Version: 1.0
Received: by 10.115.114.5 with SMTP id r5mr417962wam.145.1263465565019; Thu, 
	14 Jan 2010 02:39:25 -0800 (PST)
In-Reply-To: <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
Date: Thu, 14 Jan 2010 05:39:24 -0500
Message-ID: <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
Subject: Re: incremental document field update
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Parallel incremental indexing
(http://issues.apache.org/jira/browse/LUCENE-1879) is one way to solve
this.

Mike

On Thu, Jan 14, 2010 at 4:27 AM, Babak Farhang <farhang@gmail.com> wrote:
>> Reading that trail, I wish the original poster gave up on his idea (
>
> Err, that should have read..
>
> "Reading that trail, I wish the original poster hadn't given up on his id=
ea"
>
>
> On Thu, Jan 14, 2010 at 2:23 AM, Babak Farhang <farhang@gmail.com> wrote:
>> Hi,
>>
>> I've been thinking about how to update a single field of a document
>> without touching its other fields. This is an old problem and I was
>> considering a solution along the lines of Andrzej Bialecki's post to
>> the dev list back in '07:
>>
>>
>> <quote =A0http://markmail.org/message/tbkgmnilhvrt6bii >
>>
>> I have the following scenario: I want to use ParallelReader to
>> maintain parts of the index that are changing quickly, and where
>> changes are limited to specific fields only.
>>
>> Let's say I have a "main" index (many fields, slowly changing, large
>> updates), and an "aux" index (fast changing, usually single doc and
>> single field updates). I'd like to "replace" documents in the "aux"
>> index - that is, delete one doc and add another - but in a way that
>> doesn't change the internal document numbers, so that I can keep the
>> mapping required by ParallelReader intact.
>>
>> I think this is possible to achieve by using a FilterIndexReader,
>> which keeps a map of updated documents, and re-maps old doc ids to the
>> new ones on the fly.
>>
>> From time to time I'd like to optimize the "aux" index to get rid of
>> deleted docs. At this time I need to figure out how to preserve the
>> old->new mapping during the optimization.
>>
>> So, here's the question: is this scenario feasible? If so, then in the
>> trunk/ version of Lucene, is there any way to figure out (predictably)
>> how internal document numbers are reassigned after calling optimize()
>> ?
>>
>> </quote>
>>
>>
>> Reading that trail, I wish the original poster gave up on his idea (
>> http://markmail.org/message/tbkgmnilhvrt6bii#query:+page:1+mid:kn77zpiu4=
3kd2ufn+state:results
>> )
>>
>>
>> <quote>
>> Thanks for the input - for now I gave up on this, after discovering
>> that I would have no way to ensure in TermDocs.skipTo() that document
>> id-s are monotonically increasing (which seems to be a part of the
>> contract).
>> </quote>
>>
>> I imagine if Andrzej's proposed FilterIndexReader maintains 2 sorted
>> (ordered) maps, one from internal document-ids to "view" document-ids,
>> and another mapping from =A0"view" document-ids to internal
>> document-ids, then things like skipTo() can be implemented reasonably
>> efficiently. Only the mapped ids are maintained in these structures.
>> (Also note that a mapped "view" document-id represents an internally
>> deleted document with that id.)
>>
>> And if we can find a way to merge the segments of this "aux" index
>> along whenever the segments of its associated "main" index are merged
>> or optimized (such that the [internal] doc-ids in the merged aux index
>> end up getting sync'ed with those of the trunk), then there shouldn't
>> be all that many doc-ids to map anyway (if we merge frequently
>> enough).
>>
>> So to go back Andrzej's question: is there any way to figure out
>> (predictably) how internal document numbers [in the main index] are
>> reassigned after calling optimize() ? How does LUCENE-847, as Doug
>> Cutting suggests in that trail, help?
>>
>> Sorry if that was long winded, had to start somewhere ;)
>>
>> -Babak
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44543-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 12:41:37 2010
Return-Path: <java-user-return-44543-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87996 invoked from network); 14 Jan 2010 12:41:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 12:41:37 -0000
Received: (qmail 13475 invoked by uid 500); 14 Jan 2010 12:41:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13443 invoked by uid 500); 14 Jan 2010 12:41:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13428 invoked by uid 99); 14 Jan 2010 12:41:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 12:41:33 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists.digitalpebble@gmail.com designates 72.14.220.159 as permitted sender)
Received: from [72.14.220.159] (HELO fg-out-1718.google.com) (72.14.220.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 12:41:22 +0000
Received: by fg-out-1718.google.com with SMTP id 22so202529fge.5
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 04:41:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=U2znx1J2+OTfbxUb+jgtdR3fstrGc8b6hmUTbAxAuDs=;
        b=fTYaraZ52Jk1u+vRkolQbAA7SSwULgsdXWm1lsYqQM4rsrnY9m7pm7J8zus6XhXieJ
         p6fVzaIqWrpGq/3t+MfNlRM2QGij0eS4oC1Ze1wGZC/fuCIfXqMEjDbBJ08CAdQtzSFb
         IT2V0SUB62Kt24v7mOkVntvsunbOeB1S7eFP8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=RU4afXswxFPzlejhE/NzJKDmbXs6VsDfeoySnUs0+9xs3SIL6Ofgf8gVunvwSJ7FRh
         D+A3y464EJSeFVrLCUKYp6VIpjtLO77+tGQI48gz5yH/avzUpd2UVHcHXG5+Y9Xt5d3y
         AVilvq0UtDREMDol4fFFeIKCDt6jLcW8IbfNQ=
MIME-Version: 1.0
Received: by 10.239.131.199 with SMTP id 7mr74938hbo.192.1263472861593; Thu, 
	14 Jan 2010 04:41:01 -0800 (PST)
In-Reply-To: <08FC5E29EDEA6247B7E499F2EC96BAD3869394@exchq-001.wdnet.org>
References: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org>
	 <359a92831001130905o3477165dg6202efe9c2ea079b@mail.gmail.com>
	 <08FC5E29EDEA6247B7E499F2EC96BAD3869394@exchq-001.wdnet.org>
Date: Thu, 14 Jan 2010 12:41:01 +0000
Message-ID: <16d405e1001140441y55c84d73k83943e384acee4a7@mail.gmail.com>
Subject: Re: Extracting contact data
From: Julien Nioche <lists.digitalpebble@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6570c7219422c047d1f335c
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6570c7219422c047d1f335c
Content-Type: text/plain; charset=ISO-8859-1

Hi,

Tools like GATE (http://www.gate.ac.uk) or Apache UIMA would be good
candidates for what you are trying to achieve.

HTH
-- 
DigitalPebble Ltd
http://www.digitalpebble.com

2010/1/14 Ortelli, Gian Luca <gianluca.ortelli@truvo.com>

>
> Well, the exact definition we're going to find out empirically,
> as we run an implementation through our data and look at the quality
> of results... For now, I would use the number of tokens between the
> finding ("abc@def.com") and the word that gives context ("Contact").
>
> Anyway, replying to karl: I'm not searching for a given
> email/street/time interval/etc., I need to extract EVERY
> email/street/time interval/etc. from the text. The kind of need for
> which you suggest a natural language processing tool.
>
>  Gianluca
>
> -----Original Message-----
> From: Erick Erickson [mailto:erickerickson@gmail.com]
> Sent: Wednesday, January 13, 2010 6:06 PM
> To: java-user@lucene.apache.org
> Subject: Re: Extracting contact data
>
> Before answering, how to you measure "proximity"? You can make
> Lucene work with locations (there's an example in Lucene In Action)
> readily enough though....
>
> HTH
> Erick
>
> On Wed, Jan 13, 2010 at 11:39 AM, Ortelli, Gian Luca <
> gianluca.ortelli@truvo.com> wrote:
>
> > Hi community,
> >
> >
> >
> > I have a general understanding of Lucene concepts, and I'm wondering
> if
> > it's the right tool for my job:
> >
> >
> >
> > - I need to extract data like e.g. time intervals ("8am - 12pm"),
> street
> > addresses from a set of files. The common issue with this data unit is
> > that they contain spaces and are not always definable through regexes.
> >
> >
> >
> > - the extraction must take into consideration the "proximity": for
> > example, a mail address which is close to the work "Contacts" will
> > receive a higher rank, since I'm looking for contact data.
> >
> >
> >
> > Do you think I can get any advantage from building a solution on
> Lucene?
> >
> >
> >
> >  Gianluca
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6570c7219422c047d1f335c--

From java-user-return-44544-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 13:18:58 2010
Return-Path: <java-user-return-44544-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96819 invoked from network); 14 Jan 2010 13:18:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 13:18:57 -0000
Received: (qmail 79301 invoked by uid 500); 14 Jan 2010 13:18:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79222 invoked by uid 500); 14 Jan 2010 13:18:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79212 invoked by uid 99); 14 Jan 2010 13:18:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 13:18:55 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 13:18:47 +0000
Received: by ewy9 with SMTP id 9so8385005ewy.11
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 05:18:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=imp7S1rAjGjjtlZDyXyi4lvY4FU4Xa4H4Cn5Pr7QR8A=;
        b=ZpO+z6CIRKOl0t3MitdGW+EnQzBsWQ25apPrrPU5W+pMcxacYXV3QPaVUjebNlq7ov
         68bV3MMhwFDLui6u62sVL2cF2cGxJ8a0LiySIvJgNGlNA4+zgIijMbjljxldIHvSSXkC
         LV+rL+S0oAfiTRStKkWXh4imORTNpDPKXFVbQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=c6IxD6xD88OkTwnVJj/REHwG34AZUYi1vYPIXyQrCnu/snHluEMO84KgT+sGNjz/lS
         H12/4VzqACkxkSYDrdKtWJrMBFC9g5OsefqzM8q/Fc/vtOxeNmEe2fo2GweZK6jtXS3C
         T8hwhzjTYlCCjxfdEfys883Qh75Ulkx34LslU=
MIME-Version: 1.0
Received: by 10.216.88.67 with SMTP id z45mr248068wee.112.1263475107181; Thu, 
	14 Jan 2010 05:18:27 -0800 (PST)
In-Reply-To: <359a92831001130905o3477165dg6202efe9c2ea079b@mail.gmail.com>
References: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org>
	 <359a92831001130905o3477165dg6202efe9c2ea079b@mail.gmail.com>
Date: Thu, 14 Jan 2010 08:18:27 -0500
Message-ID: <359a92831001140518i3da5f971yf6159984360d3fcc@mail.gmail.com>
Subject: Re: Extracting contact data
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d7e162f234ce047d1fb858
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d7e162f234ce047d1fb858
Content-Type: text/plain; charset=ISO-8859-1

Ooooh boy, glad I asked the question because I was thinking in terms
of real-world locations of the addresses <G>, so nothing I would
have written would have had any relevance whatsoever......

Erick

On Wed, Jan 13, 2010 at 12:05 PM, Erick Erickson <erickerickson@gmail.com>wrote:

> Before answering, how to you measure "proximity"? You can make
> Lucene work with locations (there's an example in Lucene In Action)
> readily enough though....
>
> HTH
> Erick
>
>
> On Wed, Jan 13, 2010 at 11:39 AM, Ortelli, Gian Luca <
> gianluca.ortelli@truvo.com> wrote:
>
>> Hi community,
>>
>>
>>
>> I have a general understanding of Lucene concepts, and I'm wondering if
>> it's the right tool for my job:
>>
>>
>>
>> - I need to extract data like e.g. time intervals ("8am - 12pm"), street
>> addresses from a set of files. The common issue with this data unit is
>> that they contain spaces and are not always definable through regexes.
>>
>>
>>
>> - the extraction must take into consideration the "proximity": for
>> example, a mail address which is close to the work "Contacts" will
>> receive a higher rank, since I'm looking for contact data.
>>
>>
>>
>> Do you think I can get any advantage from building a solution on Lucene?
>>
>>
>>
>>  Gianluca
>>
>>
>

--0016e6d7e162f234ce047d1fb858--

From java-user-return-44545-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 14:45:40 2010
Return-Path: <java-user-return-44545-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47004 invoked from network); 14 Jan 2010 14:45:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 14:45:40 -0000
Received: (qmail 41608 invoked by uid 500); 14 Jan 2010 14:45:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41547 invoked by uid 500); 14 Jan 2010 14:45:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41537 invoked by uid 99); 14 Jan 2010 14:45:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 14:45:37 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [87.248.110.137] (HELO n20.bullet.mail.ukl.yahoo.com) (87.248.110.137)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 14 Jan 2010 14:45:26 +0000
Received: from [217.146.182.179] by n20.bullet.mail.ukl.yahoo.com with NNFMP; 14 Jan 2010 14:45:05 -0000
Received: from [87.248.110.119] by t5.bullet.ukl.yahoo.com with NNFMP; 14 Jan 2010 14:45:04 -0000
Received: from [127.0.0.1] by omp224.mail.ukl.yahoo.com with NNFMP; 14 Jan 2010 14:45:04 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 783323.63918.bm@omp224.mail.ukl.yahoo.com
Received: (qmail 79320 invoked by uid 60001); 14 Jan 2010 14:45:04 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.co.uk; s=s1024; t=1263480304; bh=39ywAzqp4XL9x0PPaxrAqOGcjvExsZcwj5o3DKFhenU=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=Iek1kIgyAtnQLMM7uN6AJA79/Am+IDIdbGauEGiPMywzreZ7gIZ90D2FxMNju9MMXRoFvUwhB5TEa/0sneVsJNP33KmPjhAZIclzHRt4ynTtTXuNrUERu1ZkAT+a3wJpjcxWeJ78/E3d05WmOSRouzGdYPd22P4g89iQwbuahaU=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=mk8TaLmt1CzgAAHOrExJTZ6jokZNLpwbzftBHJkiAQFa5elLxRHp6B40RK6nLlf1HY8zm8PIIiNet03kel1hbhWCryNa5ihSjkYd3YHpoQw9AH06gWWxVvDZot6V2f03v9+2oCpLRhF4T4Y1dqeH599QdSjAmNsNTTbWBifxEL0=;
Message-ID: <416442.79058.qm@web24715.mail.ird.yahoo.com>
X-YMail-OSG: 9uPJMxUVM1mPsWBUeYi7Zg.j6vpjtjm2bj_UrXN0.HKYq.n2EScjZ.JQ9c4BHgFOUj7SN7h19fkhqZ9M4IfCMT3d6vj6SDKV2DfJSo60EDzLuFXY8JvkmAZvghfBWwoBV_Kg5eNrqFHTxJtydxFtYvgVsf5O_gU0mGpF.FTCo3ftoFOOOITr94U9BE53wfVRp06InIxpczHBLzdPhzxgOb1IyQ.m99A2xaxEJbxRro8FeLViq8MnelGsv2ACx32ugHz.PsW_NyfzjOc6Fao.cM1dTzKtjItgNnpqAevJO85nwQu46zmsBJmIVLaTtQ--
Received: from [193.36.230.96] by web24715.mail.ird.yahoo.com via HTTP; Thu, 14 Jan 2010 14:45:04 GMT
X-Mailer: YahooMailRC/240.3 YahooMailWebService/0.8.100.260964
References: <08FC5E29EDEA6247B7E499F2EC96BAD3869392@exchq-001.wdnet.org>  <359a92831001130905o3477165dg6202efe9c2ea079b@mail.gmail.com>  <08FC5E29EDEA6247B7E499F2EC96BAD3869394@exchq-001.wdnet.org> <16d405e1001140441y55c84d73k83943e384acee4a7@mail.gmail.com>
Date: Thu, 14 Jan 2010 14:45:04 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Extracting contact data
To: java-user@lucene.apache.org
In-Reply-To: <16d405e1001140441y55c84d73k83943e384acee4a7@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

> > Do you think I can get any advantage from building a solution on=0A> Lu=
cene?=0A=0ALucene is generally about information retrieval not information =
extraction (as suggested, GATE or UIMA are more commonly used for extractio=
n).=0AHowever, Lucene can play a role in extraction if you use it for deter=
mining probabilities rather than using purely rule-based extraction techniq=
ues such as regex.=0AA Lucene index provides fast look-ups of term frequenc=
ies and can therefore help inform the likelihood that a word is being used =
in a particular context, given large volumes of training data.=0AYou'll nee=
d to get creative about what sources of existing pre-tagged data might be u=
seful for training and write a bunch of custom code but in my experience Lu=
cene can be useful for extraction when used in this context.=0A=0ACheers,=
=0AMark=0A=0A=0A=0A=0A----- Original Message ----=0AFrom: Julien Nioche <li=
sts.digitalpebble@gmail.com>=0ATo: java-user@lucene.apache.org=0ASent: Thu,=
 14 January, 2010 12:41:01=0ASubject: Re: Extracting contact data=0A=0AHi,=
=0A=0ATools like GATE (http://www.gate.ac.uk) or Apache UIMA would be good=
=0Acandidates for what you are trying to achieve.=0A=0AHTH=0A-- =0ADigitalP=
ebble Ltd=0Ahttp://www.digitalpebble.com=0A=0A2010/1/14 Ortelli, Gian Luca =
<gianluca.ortelli@truvo.com>=0A=0A>=0A> Well, the exact definition we're go=
ing to find out empirically,=0A> as we run an implementation through our da=
ta and look at the quality=0A> of results... For now, I would use the numbe=
r of tokens between the=0A> finding ("abc@def.com") and the word that gives=
 context ("Contact").=0A>=0A> Anyway, replying to karl: I'm not searching f=
or a given=0A> email/street/time interval/etc., I need to extract EVERY=0A>=
 email/street/time interval/etc. from the text. The kind of need for=0A> wh=
ich you suggest a natural language processing tool.=0A>=0A>  Gianluca=0A>=
=0A> -----Original Message-----=0A> From: Erick Erickson [mailto:erickerick=
son@gmail.com]=0A> Sent: Wednesday, January 13, 2010 6:06 PM=0A> To: java-u=
ser@lucene.apache.org=0A> Subject: Re: Extracting contact data=0A>=0A> Befo=
re answering, how to you measure "proximity"? You can make=0A> Lucene work =
with locations (there's an example in Lucene In Action)=0A> readily enough =
though....=0A>=0A> HTH=0A> Erick=0A>=0A> On Wed, Jan 13, 2010 at 11:39 AM, =
Ortelli, Gian Luca <=0A> gianluca.ortelli@truvo.com> wrote:=0A>=0A> > Hi co=
mmunity,=0A> >=0A> >=0A> >=0A> > I have a general understanding of Lucene c=
oncepts, and I'm wondering=0A> if=0A> > it's the right tool for my job:=0A>=
 >=0A> >=0A> >=0A> > - I need to extract data like e.g. time intervals ("8a=
m - 12pm"),=0A> street=0A> > addresses from a set of files. The common issu=
e with this data unit is=0A> > that they contain spaces and are not always =
definable through regexes.=0A> >=0A> >=0A> >=0A> > - the extraction must ta=
ke into consideration the "proximity": for=0A> > example, a mail address wh=
ich is close to the work "Contacts" will=0A> > receive a higher rank, since=
 I'm looking for contact data.=0A> >=0A> >=0A> >=0A> > Do you think I can g=
et any advantage from building a solution on=0A> Lucene?=0A> >=0A> >=0A> >=
=0A> >  Gianluca=0A> >=0A> >=0A>=0A> --------------------------------------=
-------------------------------=0A> To unsubscribe, e-mail: java-user-unsub=
scribe@lucene.apache.org=0A> For additional commands, e-mail: java-user-hel=
p@lucene.apache.org=0A>=0A>=0A=0A=0A=0A      


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44546-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 18:54:51 2010
Return-Path: <java-user-return-44546-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57186 invoked from network); 14 Jan 2010 18:54:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 18:54:51 -0000
Received: (qmail 40199 invoked by uid 500); 14 Jan 2010 18:54:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40121 invoked by uid 500); 14 Jan 2010 18:54:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40111 invoked by uid 99); 14 Jan 2010 18:54:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 18:54:49 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 18:54:38 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NVUpl-0001rP-T6
	for java-user@lucene.apache.org; Thu, 14 Jan 2010 10:54:17 -0800
Message-ID: <27166330.post@talk.nabble.com>
Date: Thu, 14 Jan 2010 10:54:17 -0800 (PST)
From: AlexElba <ramalex1@yahoo.com>
To: java-user@lucene.apache.org
Subject: RE: RangeFilter
In-Reply-To: <2D127F11DC79714E9B6A43AC9458147F36661C0A@suex07-mbx-03.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ramalex1@yahoo.com
References: <27148785.post@talk.nabble.com> <27155102.post@talk.nabble.com> <2D127F11DC79714E9B6A43AC9458147F36661C0A@suex07-mbx-03.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org


Did you completely re-index?
Yes I did 

Here is method which creates index



public void write(List<Object[]> data, Directory directory, Analyzer
analyzer) {
            IndexWriter  indexWriter = new IndexWriter(directory, analyzer,
                MaxFieldLength.LIMITED);
		
        try {
            for (Object[] obj: data) {
                try {
					Document document = new Document();
					Field field = new Field("id", obj[0]....
					document.add(field);		
					Field rank = new Field("rank", NumberTools
                    .longToString(Long.valueOf(obj[3])), Store.NO,
Index.ANALYZED_NO_NORMS);
					document.add(rank);
					indexWriter.addDocument(document);
                } catch (CorruptIndexException e) {
                    
                } catch (IOException e) {
                    
                }
            }
        } finally {
            try {
                indexWriter.commit();
            } catch (CorruptIndexException e) {
  
            } catch (IOException e) {
              }
        }
    }


Yeap I am using luke but this app is ram base index...



Steven A Rowe wrote:
> 
> Hi AlexElba,
> 
> Did you completely re-index?
> 
> If you did, then there is some other problem - can you share (more of)
> your code?
> 
> Do you know about Luke?  It's an essential tool for Lucene index
> debugging:
> 
>    http://www.getopt.org/luke/
> 
> Steve
> 
> On 01/13/2010 at 8:34 PM, AlexElba wrote:
>> 
>> Hello,
>> 
>> I change filter to follow
>>   RangeFilter rangeFilter = new RangeFilter(
>>                        "rank", NumberTools
>>                                 .longToString(rating), NumberTools
>>                                 .longToString(10), true, true);
>> 
>> and change index to store rank the same way... But still not seeing :(
>> any results
>> 
>> 
>> AlexElba wrote:
>> > 
>> > Hello,
>> > 
>> > I am currently using lucene 2.4 and have document with 3 fields
>> > 
>> > id
>> > name
>> > rank
>> > 
>> > and have query and filter when I am trying to use rang filter on rank I
>> > am not getting any result back
>> > 
>> > RangeFilter rangeFilter = new RangeFilter("rank", "3", "10", true,
>> > true);
>> > 
>> > I have documents which are in this interval
>> > 
>> > 
>> > Any suggestion what am I doing wrong?
>> > 
>> > Regards
>> > 
>> > 
>> > 
>> > 
>> > 
>> 
>> -- View this message in context: http://old.nabble.com/RangeFilter-
>> tp27148785p27155102.html Sent from the Lucene - Java Users mailing list
>> archive at Nabble.com.
>> 
>> 
>> --------------------------------------------------------------------- To
>> unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>> additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://old.nabble.com/RangeFilter-tp27148785p27166330.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44547-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 21:39:49 2010
Return-Path: <java-user-return-44547-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6610 invoked from network); 14 Jan 2010 21:39:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 21:39:49 -0000
Received: (qmail 39062 invoked by uid 500); 14 Jan 2010 21:39:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38968 invoked by uid 500); 14 Jan 2010 21:39:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38958 invoked by uid 99); 14 Jan 2010 21:39:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 21:39:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 21:39:38 +0000
Received: by fxm2 with SMTP id 2so372fxm.5
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 13:39:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type
         :content-transfer-encoding;
        bh=E4fahUMgIGh5QnpV9LzRNyJgiMBn/0YKOo1mAAb8zxI=;
        b=Ns8kk1bVLEdiSuukfW8z9c3bXzuqIY0nutSlSZfefGw3lJO6vjx7OSLJLDeOXJu3v9
         Adn4tj/GtIGOnoz2pZabalWSV4I1a79Q7Z4rTYYkZuuhVUBwCwyTBZGEf70Rvef3xRfi
         hnweXbVAZaPdQwysFJ4CsbSkJbotrt+R6at28=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type:content-transfer-encoding;
        b=RwN9K2I/FpQA3EgiEgI4NQ1RoyzYaCj+CktutiuLBES9OZ0CmS4bslxx7Z309IXFG2
         vrIsGzqBRihwV6U0KW+hme/guhhj6yF7zAOHVuiVIb1x9BrdOPm5JYj2WVijTX1Nf0aM
         C9Zse/ipfqpTz9+Hm9EA3DJ/nBDDfEIs4ptH4=
Received: by 10.103.81.35 with SMTP id i35mr671506mul.42.1263505157124;
        Thu, 14 Jan 2010 13:39:17 -0800 (PST)
Received: from ?10.1.1.141? (hq.compositesw.com [209.237.61.131])
        by mx.google.com with ESMTPS id i7sm3838301mue.16.2010.01.14.13.39.14
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 14 Jan 2010 13:39:15 -0800 (PST)
Message-ID: <4B4F8EE5.5060605@gmail.com>
Date: Thu, 14 Jan 2010 13:38:45 -0800
From: Chris Lu <chris.lu@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: IllegalArgumentException when IndexWriter.addDocument
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Seems a integer overflow problem?

java.lang.IllegalArgumentException: Increment must be zero or greater: 
-472893952
  at 
org.apache.lucene.analysis.tokenattributes.PositionIncrementAttributeImpl.setPositionIncrement(PositionIncrementAttributeImpl.java:58)
  at 
org.apache.lucene.analysis.StopFilter.incrementToken(StopFilter.java:256)
  at 
org.apache.lucene.index.DocInverterPerField.processFields(DocInverterPerField.java:188)
  at 
org.apache.lucene.index.DocFieldProcessorPerThread.processDocument(DocFieldProcessorPerThread.java:246)
  at 
org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:774)
  at 
org.apache.lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:752)
  at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1931)
  at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1905)


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44548-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 21:41:43 2010
Return-Path: <java-user-return-44548-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7491 invoked from network); 14 Jan 2010 21:41:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 21:41:43 -0000
Received: (qmail 42661 invoked by uid 500); 14 Jan 2010 21:41:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42592 invoked by uid 500); 14 Jan 2010 21:41:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42581 invoked by uid 99); 14 Jan 2010 21:41:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 21:41:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 21:41:32 +0000
Received: by fg-out-1718.google.com with SMTP id 22so421866fge.5
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 13:41:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=UqjMHC7n7Vk7r6eCEtfy8fOBUBJL+BBb+/Cf1xJUAkE=;
        b=Qu3zs9hV+1AK1woSh/Af9yRlLkqkM2y7n0oRr2xxNPkvIHgwvZWgleER0kwiOTbAUP
         IgmsUFG/dJFRl3L74C1E23si44E8gfI3gabhOld9FK/UdvVZJbCcucQzR+b6ZxCt/gCA
         IQNiWOoq7nyaTUjSLZ1DRVFpX2hgGaIkdWXrU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=Ux/+a4+1E+BdKOUGPt9VTBM9xK+nMus6qr39vC68T4SObgsgn1JtuvDQRPLCA6KV9P
         Jre+XryJpv0UeMqMFwEvTJljgUbyJoR3Xnke7aEddcktgbC9VUei+bGqoUzXxuxD6Atb
         +RnHsGJnr99oqzQcP5rtGRtkoQIU9eRSkcWrc=
Received: by 10.103.21.24 with SMTP id y24mr655783mui.110.1263505268131;
        Thu, 14 Jan 2010 13:41:08 -0800 (PST)
Received: from ?10.1.1.141? (hq.compositesw.com [209.237.61.131])
        by mx.google.com with ESMTPS id y37sm3801837mug.38.2010.01.14.13.41.05
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 14 Jan 2010 13:41:06 -0800 (PST)
Message-ID: <4B4F8F55.5090904@gmail.com>
Date: Thu, 14 Jan 2010 13:40:37 -0800
From: Chris Lu <chris.lu@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IllegalArgumentException when IndexWriter.addDocument
References: <4B4F8EE5.5060605@gmail.com>
In-Reply-To: <4B4F8EE5.5060605@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Notes: I am using Lucene 3.0
> Seems a integer overflow problem?
>
> java.lang.IllegalArgumentException: Increment must be zero or greater: 
> -472893952
>  at 
> org.apache.lucene.analysis.tokenattributes.PositionIncrementAttributeImpl.setPositionIncrement(PositionIncrementAttributeImpl.java:58) 
>
>  at 
> org.apache.lucene.analysis.StopFilter.incrementToken(StopFilter.java:256)
>  at 
> org.apache.lucene.index.DocInverterPerField.processFields(DocInverterPerField.java:188) 
>
>  at 
> org.apache.lucene.index.DocFieldProcessorPerThread.processDocument(DocFieldProcessorPerThread.java:246) 
>
>  at 
> org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.java:774) 
>
>  at 
> org.apache.lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java:752) 
>
>  at 
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1931)
>  at 
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1905)
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44549-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 21:47:49 2010
Return-Path: <java-user-return-44549-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10469 invoked from network); 14 Jan 2010 21:47:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 21:47:49 -0000
Received: (qmail 53706 invoked by uid 500); 14 Jan 2010 21:47:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53648 invoked by uid 500); 14 Jan 2010 21:47:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53638 invoked by uid 99); 14 Jan 2010 21:47:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 21:47:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 21:47:36 +0000
Received: by fxm2 with SMTP id 2so9586fxm.5
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 13:47:16 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=h3dQwBEiVEPJTrUnBJIGvPXjM8XLk4Il1f0jdeE5k00=;
        b=Kl6AWuYi4q3WlZ31Q7K2xFl4KNzm5o3XTNZC3J5OK4Oy2oOdtMzPs3E59AM10GHb8i
         XTE6ySkekNhx8Dy36lY7SKtTmxfx4DDcff9jK6EWATm4isMDedfCIhLmdLQos+WTpgnU
         e0daCB3FGrgtVmuMdCA2BmGo88uYlqImgzL6c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=Qhk+4MwT1/wjHJ+kGCv5myk477SeSZsEL8MKEcCLmbcCNKZDB3U6LbyjJyyMgsvoK1
         LQelRBN/TbAwuwyLBZauvl30+GsJSpb1KL0zfSnxc4ra7tbVXsNbvGmAYhjOIRGKP3l7
         T8xAhasbx0F7IWZQEgUckIjBsO+q6MvS+h1tU=
MIME-Version: 1.0
Received: by 10.239.170.72 with SMTP id r8mr139137hbe.157.1263505636417; Thu, 
	14 Jan 2010 13:47:16 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <4B4F8F55.5090904@gmail.com>
References: <4B4F8EE5.5060605@gmail.com> <4B4F8F55.5090904@gmail.com>
Date: Thu, 14 Jan 2010 22:47:16 +0100
Message-ID: <f18c9dde1001141347g1e9d2033mb8479aaf494fd74f@mail.gmail.com>
Subject: Re: IllegalArgumentException when IndexWriter.addDocument
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Which analyzer are you using?

simon
On Thu, Jan 14, 2010 at 10:40 PM, Chris Lu <chris.lu@gmail.com> wrote:
> Notes: I am using Lucene 3.0
>>
>> Seems a integer overflow problem?
>>
>> java.lang.IllegalArgumentException: Increment must be zero or greater:
>> -472893952
>> =C2=A0at
>> org.apache.lucene.analysis.tokenattributes.PositionIncrementAttributeImp=
l.setPositionIncrement(PositionIncrementAttributeImpl.java:58)
>> =C2=A0at
>> org.apache.lucene.analysis.StopFilter.incrementToken(StopFilter.java:256=
)
>> =C2=A0at
>> org.apache.lucene.index.DocInverterPerField.processFields(DocInverterPer=
Field.java:188)
>> =C2=A0at
>> org.apache.lucene.index.DocFieldProcessorPerThread.processDocument(DocFi=
eldProcessorPerThread.java:246)
>> =C2=A0at
>> org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.j=
ava:774)
>> =C2=A0at
>> org.apache.lucene.index.DocumentsWriter.addDocument(DocumentsWriter.java=
:752)
>> =C2=A0at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.jav=
a:1931)
>> =C2=A0at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.jav=
a:1905)
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44550-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 21:55:55 2010
Return-Path: <java-user-return-44550-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14395 invoked from network); 14 Jan 2010 21:55:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 21:55:55 -0000
Received: (qmail 64912 invoked by uid 500); 14 Jan 2010 21:55:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64827 invoked by uid 500); 14 Jan 2010 21:55:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64817 invoked by uid 99); 14 Jan 2010 21:55:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 21:55:53 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 21:55:43 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 04BC345F509
	for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 22:55:22 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id B9DKipZjwJHu for <java-user@lucene.apache.org>;
	Thu, 14 Jan 2010 22:55:11 +0100 (CET)
Received: from VEGA (port-83-236-62-54.dynamic.qsc.de [83.236.62.54])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 52A9845F4C1
	for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 22:55:11 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4B4F8EE5.5060605@gmail.com> <4B4F8F55.5090904@gmail.com>
In-Reply-To: <4B4F8F55.5090904@gmail.com>
Subject: RE: IllegalArgumentException when IndexWriter.addDocument
Date: Thu, 14 Jan 2010 22:55:11 +0100
Message-ID: <000001ca9564$3f3dbf80$bdb93e80$@de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-index: AcqVYmGV/CADLWdZQOKG3N3IcC9AWgAAWq+g
Content-language: de

This problem occurs, if you have a Tokenizer or TokenFilter that =
produces new tokens but does not call clearAttributes(). What =
TokenStreams do you use in your analyzer?

If you not call clearAttributes() (see javadocs of Tokenizer!) whenever =
you produce new tokens (in any type of TokenStream), the =
positionIncrement is never reset back to 1 (and when in adiition the =
analyzer reuses the tokenstream, it is really never reset even across =
multiple documents). So whenever a stopword occurs it get larger...

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Chris Lu [mailto:chris.lu@gmail.com]
> Sent: Thursday, January 14, 2010 10:41 PM
> To: java-user@lucene.apache.org
> Subject: Re: IllegalArgumentException when IndexWriter.addDocument
>=20
> Notes: I am using Lucene 3.0
> > Seems a integer overflow problem?
> >
> > java.lang.IllegalArgumentException: Increment must be zero or
> greater:
> > -472893952
> >  at
> >
> =
org.apache.lucene.analysis.tokenattributes.PositionIncrementAttributeIm
> pl.setPositionIncrement(PositionIncrementAttributeImpl.java:58)
> >
> >  at
> >
> =
org.apache.lucene.analysis.StopFilter.incrementToken(StopFilter.java:25
> 6)
> >  at
> >
> =
org.apache.lucene.index.DocInverterPerField.processFields(DocInverterPe
> rField.java:188)
> >
> >  at
> >
> =
org.apache.lucene.index.DocFieldProcessorPerThread.processDocument(DocF
> ieldProcessorPerThread.java:246)
> >
> >  at
> >
> =
org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.
> java:774)
> >
> >  at
> >
> =
org.apache.lucene.index.DocumentsWriter.addDocument(DocumentsWriter.jav
> a:752)
> >
> >  at
> >
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1931)
> >  at
> >
> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1905)
> >
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44551-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 14 22:17:38 2010
Return-Path: <java-user-return-44551-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24472 invoked from network); 14 Jan 2010 22:17:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 14 Jan 2010 22:17:38 -0000
Received: (qmail 90138 invoked by uid 500); 14 Jan 2010 22:17:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90060 invoked by uid 500); 14 Jan 2010 22:17:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90050 invoked by uid 99); 14 Jan 2010 22:17:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 22:17:36 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of chris.lu@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 14 Jan 2010 22:17:25 +0000
Received: by fxm2 with SMTP id 2so38536fxm.5
        for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 14:17:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type;
        bh=FMPGfB2cMByMUgk9YvCTWqrYpjabG1BiJsmOd750URY=;
        b=DgejiKHTZFqc3vaiU3hhT8CBKgqDgTn7q8OX2DRck/fnTYB+8BZXsiNK8+9PGA+uVK
         m62Btz7fKBJE+P+14A9D3q8bYqnx5QiQZqUyb8crnYFSR2TgMfLp+5W71NBdlPAahvmr
         e5ETW/zdZR6cV9zEFy+KossKxawB56lkXeY0k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type;
        b=oiHtt9fM6LC1zG2K5Ipoq8H+G5d5IiTKmn2kUMtFSWAqkyWaSCSQ1vPKzULtWurdjk
         x1QpbycprwFRkZWXVCeV2DZWbbTPPb3fDvRHIgcGYpXOV8DHoR1qcMaGKaPFvBOlWCyQ
         Vx/rMJcHFpJ7bkxkrTC9sdvbcHBrl9rmyKVKY=
Received: by 10.102.183.14 with SMTP id g14mr684028muf.71.1263507424560;
        Thu, 14 Jan 2010 14:17:04 -0800 (PST)
Received: from ?10.1.1.141? (hq.compositesw.com [209.237.61.131])
        by mx.google.com with ESMTPS id j2sm3909318mue.35.2010.01.14.14.17.02
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 14 Jan 2010 14:17:03 -0800 (PST)
Message-ID: <4B4F97C1.7060003@gmail.com>
Date: Thu, 14 Jan 2010 14:16:33 -0800
From: Chris Lu <chris.lu@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: IllegalArgumentException when IndexWriter.addDocument
References: <4B4F8EE5.5060605@gmail.com> <4B4F8F55.5090904@gmail.com> <000001ca9564$3f3dbf80$bdb93e80$@de>
In-Reply-To: <000001ca9564$3f3dbf80$bdb93e80$@de>
Content-Type: multipart/alternative;
 boundary="------------090504040902050301060101"
X-Virus-Checked: Checked by ClamAV on apache.org

--------------090504040902050301060101
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

I am using a custom analyzer upgrading from Lucene 2.x.
Need to get more familiar with Lucene 3.0 behavior.
I think this is one of the upgrade pitfalls.

Thanks for the help!

Chris

Uwe Schindler wrote:
> This problem occurs, if you have a Tokenizer or TokenFilter that produces new tokens but does not call clearAttributes(). What TokenStreams do you use in your analyzer?
>
> If you not call clearAttributes() (see javadocs of Tokenizer!) whenever you produce new tokens (in any type of TokenStream), the positionIncrement is never reset back to 1 (and when in adiition the analyzer reuses the tokenstream, it is really never reset even across multiple documents). So whenever a stopword occurs it get larger...
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>
>   
>> -----Original Message-----
>> From: Chris Lu [mailto:chris.lu@gmail.com]
>> Sent: Thursday, January 14, 2010 10:41 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: IllegalArgumentException when IndexWriter.addDocument
>>
>> Notes: I am using Lucene 3.0
>>     
>>> Seems a integer overflow problem?
>>>
>>> java.lang.IllegalArgumentException: Increment must be zero or
>>>       
>> greater:
>>     
>>> -472893952
>>>  at
>>>
>>>       
>> org.apache.lucene.analysis.tokenattributes.PositionIncrementAttributeIm
>> pl.setPositionIncrement(PositionIncrementAttributeImpl.java:58)
>>     
>>>  at
>>>
>>>       
>> org.apache.lucene.analysis.StopFilter.incrementToken(StopFilter.java:25
>> 6)
>>     
>>>  at
>>>
>>>       
>> org.apache.lucene.index.DocInverterPerField.processFields(DocInverterPe
>> rField.java:188)
>>     
>>>  at
>>>
>>>       
>> org.apache.lucene.index.DocFieldProcessorPerThread.processDocument(DocF
>> ieldProcessorPerThread.java:246)
>>     
>>>  at
>>>
>>>       
>> org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWriter.
>> java:774)
>>     
>>>  at
>>>
>>>       
>> org.apache.lucene.index.DocumentsWriter.addDocument(DocumentsWriter.jav
>> a:752)
>>     
>>>  at
>>>
>>>       
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1931)
>>     
>>>  at
>>>
>>>       
>> org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:1905)
>>     
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   

--------------090504040902050301060101--

From java-user-return-44552-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 00:57:42 2010
Return-Path: <java-user-return-44552-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77102 invoked from network); 15 Jan 2010 00:57:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 00:57:41 -0000
Received: (qmail 75763 invoked by uid 500); 15 Jan 2010 00:57:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75707 invoked by uid 500); 15 Jan 2010 00:57:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75697 invoked by uid 99); 15 Jan 2010 00:57:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 00:57:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 00:57:31 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id B5B5871C314; Thu, 14 Jan 2010 16:57:10 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id B166771C266
	for <java-user@lucene.apache.org>; Thu, 14 Jan 2010 16:57:10 -0800 (PST)
Date: Thu, 14 Jan 2010 16:57:10 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Supported way to get segment from IndexWriter?
In-Reply-To: <9ac0c6aa1001130259n76a4fc90mc88cdcdb97454ce3@mail.gmail.com>
Message-ID: <Pine.LNX.4.64.1001141644170.21837@radix.cryptio.net>
References: <Pine.LNX.4.64.1001121720120.19492@radix.cryptio.net>
 <9ac0c6aa1001130259n76a4fc90mc88cdcdb97454ce3@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Since SegmentInfos is now public, you could use SegmentInfos.read to
: read the current segments_N file, and then call its .size() method?
: 
: But, this will only count as of the last commit... which is probably
: not sufficient for SOLR-1559?

Honestly: i have no idea, I'm a little out of touch with awhat "commit" 
means in Lucene-Java these days.

The goal is to be able to compute a maxNumberOfSegments relative to "the 
current number of segments", some people might percieve that as the 
current number of "committed" segments -- but really it comes down to 
what optimize is going to do with the resulting number.

if someone has the goal of making iterative micro optimizations to their 
index, so they say "optimize to $currentSegmentCount-1 segments" but the 
number of commited segments is 3 and the number of uncommited segments is 
27 higher (because of active indexing) so the app starts trashing as it 
tries to optimize down from 27 to 3 that doesn't feel like "Do what i 
mean"

: We could simply make getSegmentCount public / expert / not only for tests?

I was considering doing that in the SolrIndexWriter class that already 
exists as a subclass of IndexWriter, but i didn't want to go that route if 
there was a good reason why IndexWriter.getSegmentCount isn't already 
public (ie: if there was an expecation that the way IndexWRiter manages 
segments was subject to refactoring getSegmentCount out of existence)




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44553-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 10:10:14 2010
Return-Path: <java-user-return-44553-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39594 invoked from network); 15 Jan 2010 10:10:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 10:10:14 -0000
Received: (qmail 36601 invoked by uid 500); 15 Jan 2010 10:10:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36520 invoked by uid 500); 15 Jan 2010 10:10:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36510 invoked by uid 99); 15 Jan 2010 10:10:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 10:10:11 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 10:10:03 +0000
Received: by ywh14 with SMTP id 14so329436ywh.20
        for <java-user@lucene.apache.org>; Fri, 15 Jan 2010 02:09:41 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.55.17 with SMTP id d17mr380292yba.143.1263550181328; Fri, 
	15 Jan 2010 02:09:41 -0800 (PST)
In-Reply-To: <Pine.LNX.4.64.1001141644170.21837@radix.cryptio.net>
References: <Pine.LNX.4.64.1001121720120.19492@radix.cryptio.net>
	 <9ac0c6aa1001130259n76a4fc90mc88cdcdb97454ce3@mail.gmail.com>
	 <Pine.LNX.4.64.1001141644170.21837@radix.cryptio.net>
Date: Fri, 15 Jan 2010 05:09:41 -0500
Message-ID: <9ac0c6aa1001150209k3ac7e4benc3f75ab8ece77c7e@mail.gmail.com>
Subject: Re: Supported way to get segment from IndexWriter?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Thu, Jan 14, 2010 at 7:57 PM, Chris Hostetter
<hossman_lucene@fucit.org> wrote:
>
> : Since SegmentInfos is now public, you could use SegmentInfos.read to
> : read the current segments_N file, and then call its .size() method?
> :
> : But, this will only count as of the last commit... which is probably
> : not sufficient for SOLR-1559?
>
> Honestly: i have no idea, I'm a little out of touch with awhat "commit"
> means in Lucene-Java these days.

Commit just means that a new segments_N file is written into the
index, so that an external reader on doing an open/reopen would see
all changes made with the IndexWriter prior to the commit.  (commit
also makes the changes "durable", ie, will survive a crash, power
loss, etc, by syncing the necessary files).

> The goal is to be able to compute a maxNumberOfSegments relative to "the
> current number of segments", some people might percieve that as the
> current number of "committed" segments -- but really it comes down to
> what optimize is going to do with the resulting number.
>
> if someone has the goal of making iterative micro optimizations to their
> index, so they say "optimize to $currentSegmentCount-1 segments" but the
> number of commited segments is 3 and the number of uncommited segments is
> 27 higher (because of active indexing) so the app starts trashing as it
> tries to optimize down from 27 to 3 that doesn't feel like "Do what i
> mean"

Right.  Merging/optimizing currently always run against all (committed
& uncommitted) segments...

> : We could simply make getSegmentCount public / expert / not only for tests?
>
> I was considering doing that in the SolrIndexWriter class that already
> exists as a subclass of IndexWriter, but i didn't want to go that route if
> there was a good reason why IndexWriter.getSegmentCount isn't already
> public (ie: if there was an expecation that the way IndexWRiter manages
> segments was subject to refactoring getSegmentCount out of existence)

I think it's fine to make this public and mark it as expert, as well
as note that one can't rely on "when" IW makes new segments.  Eg,
today when you get a near real-time reader, IW creates a new segment,
but in the future it's possible it will not.  So this expert method
lets you peek into the index structure, but what count it returns
after a series of methods invoked on IW, is subject to change.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44554-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 10:23:32 2010
Return-Path: <java-user-return-44554-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46192 invoked from network); 15 Jan 2010 10:23:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 10:23:31 -0000
Received: (qmail 45375 invoked by uid 500); 15 Jan 2010 10:23:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45299 invoked by uid 500); 15 Jan 2010 10:23:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45289 invoked by uid 99); 15 Jan 2010 10:23:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 10:23:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 10:23:19 +0000
Received: by fxm2 with SMTP id 2so379432fxm.5
        for <java-user@lucene.apache.org>; Fri, 15 Jan 2010 02:22:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=+BRQpOBgQ3oO5AIWUHnQlclIsgxH1o1clZyNaHS5ycc=;
        b=m4tg6XqZIdhY8f1mvsVeb36a/9yA9pbLxwFBI+a2l/7ML/LVfde7cN+py2JQdWFeGG
         XigBTol6Y3vHGHnMUnmEo1ieTEtsPvFaOhAShqWqGKh1nHVhIgo8/Teehao07psQCg8L
         O8JS/MUFhxEYLdoA3w/X85BmZeGzfWzckbDdo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=BMRvO1VsCZZXt2fjMfgPr+MzV2Rgn5Qhc7wjJxvG7aBcz0isK/UOPdT/j/48zSPJ+Q
         oEc9fZdYaARfwuGkEFpW+ZxZhtOkFVa9rb7w5zNGHTW+KaTvdHXpZ7CCCnFDrfeGufpR
         lLxI1pL1UXTqFXto0P81mMniQ4zKTuRcxa46o=
MIME-Version: 1.0
Received: by 10.223.20.85 with SMTP id e21mr2596369fab.25.1263550976086; Fri, 
	15 Jan 2010 02:22:56 -0800 (PST)
In-Reply-To: <27166330.post@talk.nabble.com>
References: <27148785.post@talk.nabble.com> <27155102.post@talk.nabble.com> 
	<2D127F11DC79714E9B6A43AC9458147F36661C0A@suex07-mbx-03.ad.syr.edu> 
	<27166330.post@talk.nabble.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 15 Jan 2010 10:22:36 +0000
Message-ID: <8c4e68611001150222n66f53546l34c7e7aa905e06a8@mail.gmail.com>
Subject: Re: RangeFilter
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Indexing code looks OK at a glance.  What does the search code look
like?  Should be easy enough to pass a disk based Directory to your
write method to get an index you can look at/play with in Luke.


--
Ian.


On Thu, Jan 14, 2010 at 6:54 PM, AlexElba <ramalex1@yahoo.com> wrote:
>
> Did you completely re-index?
> Yes I did
>
> Here is method which creates index
>
>
>
> public void write(List<Object[]> data, Directory directory, Analyzer
> analyzer) {
> =A0 =A0 =A0 =A0 =A0 =A0IndexWriter =A0indexWriter =3D new IndexWriter(dir=
ectory, analyzer,
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0MaxFieldLength.LIMITED);
>
> =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0for (Object[] obj: data) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0Document document =3D new Document();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0Field field =3D new Field("id", obj[0]....
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0document.add(field);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0Field rank =3D new Field("rank", NumberTools
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0.longToString(Long.valueOf(obj[3])=
), Store.NO,
> Index.ANALYZED_NO_NORMS);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0document.add(rank);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =
=A0 =A0indexWriter.addDocument(document);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (CorruptIndexException e) {
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
>
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0} finally {
> =A0 =A0 =A0 =A0 =A0 =A0try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0indexWriter.commit();
> =A0 =A0 =A0 =A0 =A0 =A0} catch (CorruptIndexException e) {
>
> =A0 =A0 =A0 =A0 =A0 =A0} catch (IOException e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0}
> =A0 =A0 =A0 =A0}
> =A0 =A0}
>
>
> Yeap I am using luke but this app is ram base index...
>
>
>
> Steven A Rowe wrote:
>>
>> Hi AlexElba,
>>
>> Did you completely re-index?
>>
>> If you did, then there is some other problem - can you share (more of)
>> your code?
>>
>> Do you know about Luke? =A0It's an essential tool for Lucene index
>> debugging:
>>
>> =A0 =A0http://www.getopt.org/luke/
>>
>> Steve
>>
>> On 01/13/2010 at 8:34 PM, AlexElba wrote:
>>>
>>> Hello,
>>>
>>> I change filter to follow
>>> =A0 RangeFilter rangeFilter =3D new RangeFilter(
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0"rank", NumberTools
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 .longTo=
String(rating), NumberTools
>>> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 .longTo=
String(10), true, true);
>>>
>>> and change index to store rank the same way... But still not seeing :(
>>> any results
>>>
>>>
>>> AlexElba wrote:
>>> >
>>> > Hello,
>>> >
>>> > I am currently using lucene 2.4 and have document with 3 fields
>>> >
>>> > id
>>> > name
>>> > rank
>>> >
>>> > and have query and filter when I am trying to use rang filter on rank=
 I
>>> > am not getting any result back
>>> >
>>> > RangeFilter rangeFilter =3D new RangeFilter("rank", "3", "10", true,
>>> > true);
>>> >
>>> > I have documents which are in this interval
>>> >
>>> >
>>> > Any suggestion what am I doing wrong?
>>> >
>>> > Regards
>>> >
>>> >
>>> >
>>> >
>>> >
>>>
>>> -- View this message in context: http://old.nabble.com/RangeFilter-
>>> tp27148785p27155102.html Sent from the Lucene - Java Users mailing list
>>> archive at Nabble.com.
>>>
>>>
>>> --------------------------------------------------------------------- T=
o
>>> unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org For
>>> additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> --
> View this message in context: http://old.nabble.com/RangeFilter-tp2714878=
5p27166330.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44555-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 13:35:36 2010
Return-Path: <java-user-return-44555-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20455 invoked from network); 15 Jan 2010 13:35:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 13:35:36 -0000
Received: (qmail 49539 invoked by uid 500); 15 Jan 2010 13:35:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49451 invoked by uid 500); 15 Jan 2010 13:35:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49441 invoked by uid 99); 15 Jan 2010 13:35:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 13:35:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 13:35:24 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NVmKN-0006l8-SV
	for java-user@lucene.apache.org; Fri, 15 Jan 2010 05:35:03 -0800
Message-ID: <27175303.post@talk.nabble.com>
Date: Fri, 15 Jan 2010 05:35:03 -0800 (PST)
From: Altimatic <chris.stuckless@gmail.com>
To: java-user@lucene.apache.org
Subject: Finding frequency of regex query match in a field
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: chris.stuckless@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi All, 

I have an application that has to count the frequency that a specific
regular expression is matched on a particular field for each document in an
indexed directory.

For example. 

Lets say I have 2 documents in the directory and each document has 3 fields,
"table", "column" and "data".

Example Doc(s):
//***************************************************************
Document doc1 = new Document();
doc1.add(new Field("table", "EMPLOYEE_US", Field.Store.NO,
Field.Index.ANALYZED);
doc1.add(new Field("column", "F_NAME", Field.Store.NO,
Field.Index.ANALYZED);
doc1.add(new Field("data", "Chris Hank Tony Cody Tom Tina Crystal",
Field.Store.NO, Field.Index.ANALYZED,
Field.TermVector.WITH_POSITIONS_OFFSETS);

Document doc2 = new Document();
doc2.add(new Field("table", "EMPLOYEE_CA", Field.Store.NO,
Field.Index.ANALYZED);
doc2.add(new Field("column", "F_NAME", Field.Store.NO,
Field.Index.ANALYZED);
doc2.add(new Field("data", "Bob Billy Tom Toby Charles Krista Madonna",
Field.Store.NO, Field.Index.ANALYZED,
Field.TermVector.WITH_POSITIONS_OFFSETS);

//I know I can  create a query to search for a regular expression and that
will return each
//document that contains a match.

IndexWriter writer = new IndexWriter(directory, new WhitespaceAnalyzer(),
true, 
                                          
IndexWriter.MaxFieldLength.LIMITED);
writer.addDocument(doc);
writer.optimize();
writer.close();
searcher = new IndexSearcher(directory);

RegexQuery query = new RegexQuery( newTerm("data", "^T.*)); 
ScoreDoc[] hits = searcher.search(query, null,
maxNumOfHits).scoreDocs;//grab the score docs and go through them to find
the documents that contain a match

//*****************************************************


The code above will tell me that both doc1 and doc2 contain a match for the
constructed query. 

However I need to know how many times the regular expression was matched in
each document. ie.

doc1 = 3
doc2 = 2

I hope I am being clear...and thanks in advance.


Cheers

-- 
View this message in context: http://old.nabble.com/Finding-frequency-of-regex-query-match-in-a-field-tp27175303p27175303.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44556-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 13:48:24 2010
Return-Path: <java-user-return-44556-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27655 invoked from network); 15 Jan 2010 13:48:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 13:48:24 -0000
Received: (qmail 71610 invoked by uid 500); 15 Jan 2010 13:48:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71522 invoked by uid 500); 15 Jan 2010 13:48:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71512 invoked by uid 99); 15 Jan 2010 13:48:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 13:48:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 13:48:14 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NVmWo-0007gB-20
	for java-user@lucene.apache.org; Fri, 15 Jan 2010 05:47:54 -0800
Message-ID: <27175915.post@talk.nabble.com>
Date: Fri, 15 Jan 2010 05:47:54 -0800 (PST)
From: Altimatic <chris.stuckless@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Finding frequency of regex query match in a field
In-Reply-To: <27175303.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: chris.stuckless@gmail.com
References: <27175303.post@talk.nabble.com>


I forgot to mention that I am using Lucene 3.0.0. 
-- 
View this message in context: http://old.nabble.com/Finding-frequency-of-regex-query-match-in-a-field-tp27175303p27175915.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44557-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 13:57:58 2010
Return-Path: <java-user-return-44557-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31635 invoked from network); 15 Jan 2010 13:57:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 13:57:58 -0000
Received: (qmail 79436 invoked by uid 500); 15 Jan 2010 13:57:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79361 invoked by uid 500); 15 Jan 2010 13:57:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79351 invoked by uid 99); 15 Jan 2010 13:57:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 13:57:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 216.239.58.188 as permitted sender)
Received: from [216.239.58.188] (HELO gv-out-0910.google.com) (216.239.58.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 13:57:47 +0000
Received: by gv-out-0910.google.com with SMTP id n8so20853gve.23
        for <java-user@lucene.apache.org>; Fri, 15 Jan 2010 05:57:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=aPMauY78Vr/3asIQgED2U09RN41eI2FYvKlvVOfabaQ=;
        b=Dmkzqr72B7QfYs8MyxQgRaJ1S6GDBETVpAJFkblCWqmJjH1Mvw8LiRim19GfwvQR9j
         YX19/dV5iMdxw3UDC14HquDXuU9QmCr/gp+LSHpqX800xzjBbPzZUDL4eycU5KTs4Uy/
         RkYYFohJE3PZsmmYzDFebZ455GItu0rR/2v3I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=wwcbkHjfolcVmFf4FR5yWLL/BrEM4HEi7lSUVN/WgsVqRFEIO9y7DYiJitodQvaHwx
         bIKuv1TSUknOHSKIobG19DUDnfGbQcbNHpyKxRI0cAFDgK0zPf8wxUowoNWA5s5zNSuk
         xnWsLjsXdJCx2HfEd+aYTK3OJCnC1yE4uBqOo=
MIME-Version: 1.0
Received: by 10.239.185.76 with SMTP id b12mr245864hbh.53.1263563844428; Fri, 
	15 Jan 2010 05:57:24 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <27175303.post@talk.nabble.com>
References: <27175303.post@talk.nabble.com>
Date: Fri, 15 Jan 2010 14:57:24 +0100
Message-ID: <f18c9dde1001150557o13d27c61t5e701e09007c611f@mail.gmail.com>
Subject: Re: Finding frequency of regex query match in a field
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

One way to do it is to use the RegexTermEnum and iterate through your
terms manually.

like the following pseudo code:
te =3D RegexTermEnum(reader, Term("^T.*"), regexpCapabilities)
while( te.next() ):
  t =3D te.term()
  td =3D reader.termDocs(t)
  while(td.next()):
    freqOfTermInCurrentDoc =3D td.freq()
    doc =3D td.doc()
    #...do something with it

does that make sense to you?

simon


On Fri, Jan 15, 2010 at 2:35 PM, Altimatic <chris.stuckless@gmail.com> wrot=
e:
>
> Hi All,
>
> I have an application that has to count the frequency that a specific
> regular expression is matched on a particular field for each document in =
an
> indexed directory.
>
> For example.
>
> Lets say I have 2 documents in the directory and each document has 3 fiel=
ds,
> "table", "column" and "data".
>
> Example Doc(s):
> //***************************************************************
> Document doc1 =3D new Document();
> doc1.add(new Field("table", "EMPLOYEE_US", Field.Store.NO,
> Field.Index.ANALYZED);
> doc1.add(new Field("column", "F_NAME", Field.Store.NO,
> Field.Index.ANALYZED);
> doc1.add(new Field("data", "Chris Hank Tony Cody Tom Tina Crystal",
> Field.Store.NO, Field.Index.ANALYZED,
> Field.TermVector.WITH_POSITIONS_OFFSETS);
>
> Document doc2 =3D new Document();
> doc2.add(new Field("table", "EMPLOYEE_CA", Field.Store.NO,
> Field.Index.ANALYZED);
> doc2.add(new Field("column", "F_NAME", Field.Store.NO,
> Field.Index.ANALYZED);
> doc2.add(new Field("data", "Bob Billy Tom Toby Charles Krista Madonna",
> Field.Store.NO, Field.Index.ANALYZED,
> Field.TermVector.WITH_POSITIONS_OFFSETS);
>
> //I know I can =C2=A0create a query to search for a regular expression an=
d that
> will return each
> //document that contains a match.
>
> IndexWriter writer =3D new IndexWriter(directory, new WhitespaceAnalyzer(=
),
> true,
>
> IndexWriter.MaxFieldLength.LIMITED);
> writer.addDocument(doc);
> writer.optimize();
> writer.close();
> searcher =3D new IndexSearcher(directory);
>
> RegexQuery query =3D new RegexQuery( newTerm("data", "^T.*));
> ScoreDoc[] hits =3D searcher.search(query, null,
> maxNumOfHits).scoreDocs;//grab the score docs and go through them to find
> the documents that contain a match
>
> //*****************************************************
>
>
> The code above will tell me that both doc1 and doc2 contain a match for t=
he
> constructed query.
>
> However I need to know how many times the regular expression was matched =
in
> each document. ie.
>
> doc1 =3D 3
> doc2 =3D 2
>
> I hope I am being clear...and thanks in advance.
>
>
> Cheers
>
> --
> View this message in context: http://old.nabble.com/Finding-frequency-of-=
regex-query-match-in-a-field-tp27175303p27175303.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44558-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 14:14:55 2010
Return-Path: <java-user-return-44558-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45530 invoked from network); 15 Jan 2010 14:14:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 14:14:55 -0000
Received: (qmail 269 invoked by uid 500); 15 Jan 2010 14:14:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 213 invoked by uid 500); 15 Jan 2010 14:14:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 203 invoked by uid 99); 15 Jan 2010 14:14:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 14:14:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 14:14:43 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NVmwQ-0001VI-VA
	for java-user@lucene.apache.org; Fri, 15 Jan 2010 06:14:22 -0800
Message-ID: <27176800.post@talk.nabble.com>
Date: Fri, 15 Jan 2010 06:14:22 -0800 (PST)
From: Altimatic <chris.stuckless@gmail.com>
To: java-user@lucene.apache.org
Subject: Finding frequency of regex query match in a field
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: chris.stuckless@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi All, 

I have an application that has to count the frequency that a specific
regular expression is matched on a particular field for each document in an
indexed directory.

For example. 

Lets say I have 2 documents in the directory and each document has 3 fields,
"table", "column" and "data".

Example Doc(s):
//***************************************************************
Document doc1 = new Document();
doc1.add(new Field("table", "EMPLOYEE_US", Field.Store.NO,
Field.Index.ANALYZED);
doc1.add(new Field("column", "F_NAME", Field.Store.NO,
Field.Index.ANALYZED);
doc1.add(new Field("data", "Chris Hank Tony Cody Tom Tina Crystal",
Field.Store.NO, Field.Index.ANALYZED,
Field.TermVector.WITH_POSITIONS_OFFSETS);

Document doc2 = new Document();
doc2.add(new Field("table", "EMPLOYEE_CA", Field.Store.NO,
Field.Index.ANALYZED);
doc2.add(new Field("column", "F_NAME", Field.Store.NO,
Field.Index.ANALYZED);
doc2.add(new Field("data", "Bob Billy Tom Toby Charles Krista Madonna",
Field.Store.NO, Field.Index.ANALYZED,
Field.TermVector.WITH_POSITIONS_OFFSETS);

//I know I can  create a query to search for a regular expression and that
will return each
//document that contains a match.

IndexWriter writer = new IndexWriter(directory, new WhitespaceAnalyzer(),
true, 
                                          
IndexWriter.MaxFieldLength.LIMITED);
writer.addDocument(doc);
writer.optimize();
writer.close();
searcher = new IndexSearcher(directory);

RegexQuery query = new RegexQuery( newTerm("data", "^T.*)); 
ScoreDoc[] hits = searcher.search(query, null,
maxNumOfHits).scoreDocs;//grab the score docs and go through them to find
the documents that contain a match

//*****************************************************


The code above will tell me that both doc1 and doc2 contain a match for the
constructed query. 

However I need to know how many times the regular expression was matched in
each document. ie.

doc1 = 3
doc2 = 2

I hope I am being clear...and thanks in advance.


Cheers

-- 
View this message in context: http://old.nabble.com/Finding-frequency-of-regex-query-match-in-a-field-tp27176800p27176800.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44559-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 15:23:17 2010
Return-Path: <java-user-return-44559-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82090 invoked from network); 15 Jan 2010 15:23:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 15:23:17 -0000
Received: (qmail 27982 invoked by uid 500); 15 Jan 2010 15:23:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27907 invoked by uid 500); 15 Jan 2010 15:23:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27897 invoked by uid 99); 15 Jan 2010 15:23:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 15:23:15 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 15:23:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NVo0a-0007Vr-56
	for java-user@lucene.apache.org; Fri, 15 Jan 2010 07:22:44 -0800
Message-ID: <27178763.post@talk.nabble.com>
Date: Fri, 15 Jan 2010 07:22:44 -0800 (PST)
From: Altimatic <chris.stuckless@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Finding frequency of regex query match in a field
In-Reply-To: <f18c9dde1001150557o13d27c61t5e701e09007c611f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: chris.stuckless@gmail.com
References: <f18c9dde1001150557o13d27c61t5e701e09007c611f@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


I think so. I'll try to write up a quick demo app to see if it will work fo=
r
what I require.

Thanks for the prompt reply.


Simon Willnauer wrote:
>=20
> One way to do it is to use the RegexTermEnum and iterate through your
> terms manually.
>=20
> like the following pseudo code:
> te =3D RegexTermEnum(reader, Term("^T.*"), regexpCapabilities)
> while( te.next() ):
>   t =3D te.term()
>   td =3D reader.termDocs(t)
>   while(td.next()):
>     freqOfTermInCurrentDoc =3D td.freq()
>     doc =3D td.doc()
>     #...do something with it
>=20
> does that make sense to you?
>=20
> simon
>=20
>=20
> On Fri, Jan 15, 2010 at 2:35 PM, Altimatic <chris.stuckless@gmail.com>
> wrote:
>>
>> Hi All,
>>
>> I have an application that has to count the frequency that a specific
>> regular expression is matched on a particular field for each document in
>> an
>> indexed directory.
>>
>> For example.
>>
>> Lets say I have 2 documents in the directory and each document has 3
>> fields,
>> "table", "column" and "data".
>>
>> Example Doc(s):
>> //***************************************************************
>> Document doc1 =3D new Document();
>> doc1.add(new Field("table", "EMPLOYEE_US", Field.Store.NO,
>> Field.Index.ANALYZED);
>> doc1.add(new Field("column", "F_NAME", Field.Store.NO,
>> Field.Index.ANALYZED);
>> doc1.add(new Field("data", "Chris Hank Tony Cody Tom Tina Crystal",
>> Field.Store.NO, Field.Index.ANALYZED,
>> Field.TermVector.WITH_POSITIONS_OFFSETS);
>>
>> Document doc2 =3D new Document();
>> doc2.add(new Field("table", "EMPLOYEE_CA", Field.Store.NO,
>> Field.Index.ANALYZED);
>> doc2.add(new Field("column", "F_NAME", Field.Store.NO,
>> Field.Index.ANALYZED);
>> doc2.add(new Field("data", "Bob Billy Tom Toby Charles Krista Madonna",
>> Field.Store.NO, Field.Index.ANALYZED,
>> Field.TermVector.WITH_POSITIONS_OFFSETS);
>>
>> //I know I can =C2=A0create a query to search for a regular expression a=
nd
>> that
>> will return each
>> //document that contains a match.
>>
>> IndexWriter writer =3D new IndexWriter(directory, new WhitespaceAnalyzer=
(),
>> true,
>>
>> IndexWriter.MaxFieldLength.LIMITED);
>> writer.addDocument(doc);
>> writer.optimize();
>> writer.close();
>> searcher =3D new IndexSearcher(directory);
>>
>> RegexQuery query =3D new RegexQuery( newTerm("data", "^T.*));
>> ScoreDoc[] hits =3D searcher.search(query, null,
>> maxNumOfHits).scoreDocs;//grab the score docs and go through them to fin=
d
>> the documents that contain a match
>>
>> //*****************************************************
>>
>>
>> The code above will tell me that both doc1 and doc2 contain a match for
>> the
>> constructed query.
>>
>> However I need to know how many times the regular expression was matched
>> in
>> each document. ie.
>>
>> doc1 =3D 3
>> doc2 =3D 2
>>
>> I hope I am being clear...and thanks in advance.
>>
>>
>> Cheers
>>
>> --
>> View this message in context:
>> http://old.nabble.com/Finding-frequency-of-regex-query-match-in-a-field-=
tp27175303p27175303.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/Re%3A-Finding-frequency=
-of-regex-query-match-in-a-field-tp27177425p27178763.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44560-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 16:19:37 2010
Return-Path: <java-user-return-44560-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5409 invoked from network); 15 Jan 2010 16:19:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 16:19:37 -0000
Received: (qmail 17728 invoked by uid 500); 15 Jan 2010 16:19:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17661 invoked by uid 500); 15 Jan 2010 16:19:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17651 invoked by uid 99); 15 Jan 2010 16:19:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 16:19:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of tjkolev@gmail.com designates 209.85.217.225 as permitted sender)
Received: from [209.85.217.225] (HELO mail-gx0-f225.google.com) (209.85.217.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 16:19:26 +0000
Received: by gxk25 with SMTP id 25so574461gxk.5
        for <java-user@lucene.apache.org>; Fri, 15 Jan 2010 08:19:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=d1+t7kPgbMIllMCEXkMNelSlmF/gRfziL7ZUty3/WRA=;
        b=DG5pXHVwNBu/Lta+S75hosXft6Kpg2JwlJUh/waNU77xCDTLeGmDY4gsuatIdYblV3
         FliCvJn7tAYrmfbyjeHJ5MSU/GnxUh2Y89moLcq6zEb+u/7Jhnvtzy1iKz+5rBAA2mcM
         jDHWXvRWyvNDnxSi+VyM18yFyun79/9l7yHZ4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=hdG9IVDtx6RRaEpxvIGakU+OGOZ/Nd1hAhMWvTQj8Timo1B1cByuAbpGtPE/xcgybZ
         hocxezABY1+zQhshFT5r8489YPgkp8wSzVekgtcybj1iqvZS604fS9kjUeuxLa+E2sdC
         4sos773cnL4EmDeGWJO5OyHEJ49zAzaJJoZDM=
MIME-Version: 1.0
Received: by 10.239.137.199 with SMTP id m7mr254069hbm.95.1263572344802; Fri, 
	15 Jan 2010 08:19:04 -0800 (PST)
In-Reply-To: <359a92831001131352x7d6ea929p1f095c79c6dc58f4@mail.gmail.com>
References: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
	 <001d01ca9497$a392a630$eab7f290$@com>
	 <359a92831001131352x7d6ea929p1f095c79c6dc58f4@mail.gmail.com>
Date: Fri, 15 Jan 2010 10:19:04 -0600
Message-ID: <743c5bb41001150819w5e4b7654p625f9dffb7e41403@mail.gmail.com>
Subject: Re: Problem: Indexing and searching repeating groups of fields
From: TJ Kolev <tjkolev@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f44f3ac28dad047d365c39
X-Virus-Checked: Checked by ClamAV on apache.org

--001485f44f3ac28dad047d365c39
Content-Type: text/plain; charset=ISO-8859-1

Hi!

I don't think the easy solution will work for me, because I'll have more
than two fields in a group - perhaps 6 - 10.

However using span queries looks very promising. I'll investigate that.

I see setPositionIncrement() only on the Token object. Is there a way to set
this when adding a field to the document, so that the first token get its
position pushed away. I would prefer not to modify my analyzer if possible.

Thank you.
tjk :)

On Wed, Jan 13, 2010 at 3:52 PM, Erick Erickson <erickerickson@gmail.com>wrote:

> Ooooh, isn't that easier. You just prompted me to think
> that you don't even have to do that, just index the pairs as single
> tokens (KeywordAnalyzer? but watch out for no case folding)...
>
> On Wed, Jan 13, 2010 at 4:30 PM, Digy <digydigy@gmail.com> wrote:
>
> > How about using languages as fieldnames?
> > Doc1(Ra):
> >        Java:5
> >        C:2
> >        PHP:3
> >
> > Doc2(Rb)
> >        Java:2
> >        C:5
> >        VB:1
> >
> > Query:Java:5 AND C:2
> >
> > DIGY
> >
> > -----Original Message-----
> > From: TJ Kolev [mailto:tjkolev@gmail.com]
> > Sent: Wednesday, January 13, 2010 11:00 PM
> > To: java-user@lucene.apache.org
> > Subject: Problem: Indexing and searching repeating groups of fields
> >
> > Greetings,
> >
> > Let's assume I have to index and search "resume" documents. Two fields
> are
> > defined: Language and Years. The fields are associated together in a
> group
> > called Experience. A resume document may have 0 or more Experience
> groups:
> >
> > Ra{ E1(Java,5); E2(C,2); E3(PHP,3);}
> > Rb{ E1(Java,2); E2(C,5); E3(VB,1);}
> >
> > How do I index such documents, and how do I search, so I can formulate a
> > query like this "Resumes which have (Java,5) and (C,2)" and get back Ra.
> I
> > know I can index multiple fields of the same name, and do "(Language:Java
> > AND Years:5) AND (Language:C AND Years:2)", but in addition to Ra that
> > would
> > also return Rb, which I don't want. The problem here is that the
> "grouping"
> > is lost. I can create fields with compound names (E1Language, E1Years,
> > E2Language, E2Years, etc), but that helps me none, as I don't know which
> > group to search. I'd also like to query for "(Language:Java AND Years:5)
> OR
> > (Language:C AND Years:2)"
> >
> > This is a simplified example. Real documents may have 30 - 40 groups,
> each
> > one with several fields. Putting all the fields in a group in one index
> > field won't work as the numeric/date ones should be available for range
> > searchers.
> >
> > So far the way I see it is to do my own post processing on the results.
> The
> > issue is that text fields will need to be untokenized, or otherwise it
> > would
> > be difficult to work on the result, and determine what matches.
> >
> > Thank you.
> > tjk :)
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--001485f44f3ac28dad047d365c39--

From java-user-return-44561-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 17:13:28 2010
Return-Path: <java-user-return-44561-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23520 invoked from network); 15 Jan 2010 17:13:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 17:13:28 -0000
Received: (qmail 27507 invoked by uid 500); 15 Jan 2010 17:13:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27442 invoked by uid 500); 15 Jan 2010 17:13:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27432 invoked by uid 99); 15 Jan 2010 17:13:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 17:13:26 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tjkolev@gmail.com designates 209.85.210.192 as permitted sender)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 17:13:19 +0000
Received: by yxe30 with SMTP id 30so729437yxe.29
        for <java-user@lucene.apache.org>; Fri, 15 Jan 2010 09:12:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=pzWgQQ2IhufAby35n6B69s6pjlmoE89+V7WczTxZLqY=;
        b=ECItyqOUAzLQKZHUGd0nakjIxaBWoGQ2PyqvJVFk/xgfoRyxh3e/3Rx3uW2Qofu8yh
         JlTh8oXDTaywurwObWdFJhpCZafeSSyKgFeFAx1PUJh8A9Cs9KgRRFxshJ8itKtos2Zz
         maaf+B7umFUFjBfM8zWLTshdJSd2kGzKXiPsQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=jXWfBgwYhi62kDvQPPyHbWlUiJixKf6c7Ono2+qRntOyhJlQ53UeetZ96I7KYNMpGy
         /feiE0KA9QqsCM3h/ua047NO1L2WeK59j+EBwbn0aUnQsJM7AeXHvTDxQBFkS209AQdv
         rFo0KW0o6WFtChqGpRPZSxk1ZgPhCaUOCDkMI=
MIME-Version: 1.0
Received: by 10.239.187.211 with SMTP id m19mr302004hbh.10.1263575577330; Fri, 
	15 Jan 2010 09:12:57 -0800 (PST)
In-Reply-To: <743c5bb41001150819w5e4b7654p625f9dffb7e41403@mail.gmail.com>
References: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
	 <001d01ca9497$a392a630$eab7f290$@com>
	 <359a92831001131352x7d6ea929p1f095c79c6dc58f4@mail.gmail.com>
	 <743c5bb41001150819w5e4b7654p625f9dffb7e41403@mail.gmail.com>
Date: Fri, 15 Jan 2010 11:12:57 -0600
Message-ID: <743c5bb41001150912k69a9fbe9k196e96f06c8b9fcc@mail.gmail.com>
Subject: Re: Problem: Indexing and searching repeating groups of fields
From: TJ Kolev <tjkolev@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f7c3006f061b047d371d5a

--001485f7c3006f061b047d371d5a
Content-Type: text/plain; charset=ISO-8859-1

Found public int getPositionIncrementGap(String fieldName) on Analyzer.
Sweet! Should've read more before emailing.

tjk :)

On Fri, Jan 15, 2010 at 10:19 AM, TJ Kolev <tjkolev@gmail.com> wrote:

> Hi!
>
> I don't think the easy solution will work for me, because I'll have more
> than two fields in a group - perhaps 6 - 10.
>
> However using span queries looks very promising. I'll investigate that.
>
> I see setPositionIncrement() only on the Token object. Is there a way to
> set this when adding a field to the document, so that the first token get
> its position pushed away. I would prefer not to modify my analyzer if
> possible.
>
> Thank you.
> tjk :)
>
>
> On Wed, Jan 13, 2010 at 3:52 PM, Erick Erickson <erickerickson@gmail.com>wrote:
>
>> Ooooh, isn't that easier. You just prompted me to think
>> that you don't even have to do that, just index the pairs as single
>> tokens (KeywordAnalyzer? but watch out for no case folding)...
>>
>> On Wed, Jan 13, 2010 at 4:30 PM, Digy <digydigy@gmail.com> wrote:
>>
>> > How about using languages as fieldnames?
>> > Doc1(Ra):
>> >        Java:5
>> >        C:2
>> >        PHP:3
>> >
>> > Doc2(Rb)
>> >        Java:2
>> >        C:5
>> >        VB:1
>> >
>> > Query:Java:5 AND C:2
>> >
>> > DIGY
>> >
>> > -----Original Message-----
>> > From: TJ Kolev [mailto:tjkolev@gmail.com]
>> > Sent: Wednesday, January 13, 2010 11:00 PM
>> > To: java-user@lucene.apache.org
>> > Subject: Problem: Indexing and searching repeating groups of fields
>> >
>> > Greetings,
>> >
>> > Let's assume I have to index and search "resume" documents. Two fields
>> are
>> > defined: Language and Years. The fields are associated together in a
>> group
>> > called Experience. A resume document may have 0 or more Experience
>> groups:
>> >
>> > Ra{ E1(Java,5); E2(C,2); E3(PHP,3);}
>> > Rb{ E1(Java,2); E2(C,5); E3(VB,1);}
>> >
>> > How do I index such documents, and how do I search, so I can formulate a
>> > query like this "Resumes which have (Java,5) and (C,2)" and get back Ra.
>> I
>> > know I can index multiple fields of the same name, and do
>> "(Language:Java
>> > AND Years:5) AND (Language:C AND Years:2)", but in addition to Ra that
>> > would
>> > also return Rb, which I don't want. The problem here is that the
>> "grouping"
>> > is lost. I can create fields with compound names (E1Language, E1Years,
>> > E2Language, E2Years, etc), but that helps me none, as I don't know which
>> > group to search. I'd also like to query for "(Language:Java AND Years:5)
>> OR
>> > (Language:C AND Years:2)"
>> >
>> > This is a simplified example. Real documents may have 30 - 40 groups,
>> each
>> > one with several fields. Putting all the fields in a group in one index
>> > field won't work as the numeric/date ones should be available for range
>> > searchers.
>> >
>> > So far the way I see it is to do my own post processing on the results.
>> The
>> > issue is that text fields will need to be untokenized, or otherwise it
>> > would
>> > be difficult to work on the result, and determine what matches.
>> >
>> > Thank you.
>> > tjk :)
>> >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>
>

--001485f7c3006f061b047d371d5a--

From java-user-return-44562-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 15 17:31:38 2010
Return-Path: <java-user-return-44562-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31471 invoked from network); 15 Jan 2010 17:31:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 15 Jan 2010 17:31:38 -0000
Received: (qmail 49534 invoked by uid 500); 15 Jan 2010 17:31:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49469 invoked by uid 500); 15 Jan 2010 17:31:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49458 invoked by uid 99); 15 Jan 2010 17:31:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 17:31:36 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 15 Jan 2010 17:31:28 +0000
Received: by bwz22 with SMTP id 22so795990bwz.5
        for <java-user@lucene.apache.org>; Fri, 15 Jan 2010 09:31:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Nu0w1aHMj/v76T7hSqaqwVJs8XHND46nAqxMOvGqsmU=;
        b=f6QAF16p9Go2D6gfzVVvVa4YwUa5PClQyugj1Jm7n/uoENTIBzlq0xZ3AfZwwBn/9w
         Nel1QUqiPh90oFW9tJ/uxe8bYW1spEnVjZcDNVb0j6VDZrt8+j6WaXCG/wcgBfnLWfBr
         gcn6aRaJf/i/ygpWhrYZmpblhStBOpiXBZSoQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=XBoQoUc7PeB7ok8ESX2oObwYEwSvRXi9FVnNKOjhlJ2bJGik8n0vKX8AlKNOgdCkBQ
         BEFsd2dr0XQ8tCCMWK9XxwkEoPVVgK1oAVxximdnp4BYJRCxkz7V2P5zha29BcTtrE7c
         /h3EaSK70R+E1batbA+Sim+8MTE8gRE6GsAFk=
MIME-Version: 1.0
Received: by 10.216.89.213 with SMTP id c63mr935324wef.211.1263576667298; Fri, 
	15 Jan 2010 09:31:07 -0800 (PST)
In-Reply-To: <743c5bb41001150819w5e4b7654p625f9dffb7e41403@mail.gmail.com>
References: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
	 <001d01ca9497$a392a630$eab7f290$@com>
	 <359a92831001131352x7d6ea929p1f095c79c6dc58f4@mail.gmail.com>
	 <743c5bb41001150819w5e4b7654p625f9dffb7e41403@mail.gmail.com>
Date: Fri, 15 Jan 2010 12:31:07 -0500
Message-ID: <359a92831001150931g140961d4s63d95878109c3b06@mail.gmail.com>
Subject: Re: Problem: Indexing and searching repeating groups of fields
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d464cc669cd9047d375ef7
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d464cc669cd9047d375ef7
Content-Type: text/plain; charset=ISO-8859-1

Well, a variant on the easy solution might. What would
happen if you indexed the un-split pairs in the same
field? I.e.

"java:5", "c:3", "php:2" all indexed as *single* tokens
in the *same* field?

But I think you should look at Digy's suggestion again.
6-10 fields is absolutely no problem at all. Documents
in Lucene can have any number of fields without
any relation to any other document. So having
"sparse" documents has no penalty (unlike a RDBMS).

In particular, with Digy's scheme you can answer questions
like "has more than 3 years of C experience" whereas
with my scheme it would be harder.


FWIW
Erick

On Fri, Jan 15, 2010 at 11:19 AM, TJ Kolev <tjkolev@gmail.com> wrote:

> Hi!
>
> I don't think the easy solution will work for me, because I'll have more
> than two fields in a group - perhaps 6 - 10.
>
> However using span queries looks very promising. I'll investigate that.
>
> I see setPositionIncrement() only on the Token object. Is there a way to
> set
> this when adding a field to the document, so that the first token get its
> position pushed away. I would prefer not to modify my analyzer if possible.
>
> Thank you.
> tjk :)
>
> On Wed, Jan 13, 2010 at 3:52 PM, Erick Erickson <erickerickson@gmail.com
> >wrote:
>
> > Ooooh, isn't that easier. You just prompted me to think
> > that you don't even have to do that, just index the pairs as single
> > tokens (KeywordAnalyzer? but watch out for no case folding)...
> >
> > On Wed, Jan 13, 2010 at 4:30 PM, Digy <digydigy@gmail.com> wrote:
> >
> > > How about using languages as fieldnames?
> > > Doc1(Ra):
> > >        Java:5
> > >        C:2
> > >        PHP:3
> > >
> > > Doc2(Rb)
> > >        Java:2
> > >        C:5
> > >        VB:1
> > >
> > > Query:Java:5 AND C:2
> > >
> > > DIGY
> > >
> > > -----Original Message-----
> > > From: TJ Kolev [mailto:tjkolev@gmail.com]
> > > Sent: Wednesday, January 13, 2010 11:00 PM
> > > To: java-user@lucene.apache.org
> > > Subject: Problem: Indexing and searching repeating groups of fields
> > >
> > > Greetings,
> > >
> > > Let's assume I have to index and search "resume" documents. Two fields
> > are
> > > defined: Language and Years. The fields are associated together in a
> > group
> > > called Experience. A resume document may have 0 or more Experience
> > groups:
> > >
> > > Ra{ E1(Java,5); E2(C,2); E3(PHP,3);}
> > > Rb{ E1(Java,2); E2(C,5); E3(VB,1);}
> > >
> > > How do I index such documents, and how do I search, so I can formulate
> a
> > > query like this "Resumes which have (Java,5) and (C,2)" and get back
> Ra.
> > I
> > > know I can index multiple fields of the same name, and do
> "(Language:Java
> > > AND Years:5) AND (Language:C AND Years:2)", but in addition to Ra that
> > > would
> > > also return Rb, which I don't want. The problem here is that the
> > "grouping"
> > > is lost. I can create fields with compound names (E1Language, E1Years,
> > > E2Language, E2Years, etc), but that helps me none, as I don't know
> which
> > > group to search. I'd also like to query for "(Language:Java AND
> Years:5)
> > OR
> > > (Language:C AND Years:2)"
> > >
> > > This is a simplified example. Real documents may have 30 - 40 groups,
> > each
> > > one with several fields. Putting all the fields in a group in one index
> > > field won't work as the numeric/date ones should be available for range
> > > searchers.
> > >
> > > So far the way I see it is to do my own post processing on the results.
> > The
> > > issue is that text fields will need to be untokenized, or otherwise it
> > > would
> > > be difficult to work on the result, and determine what matches.
> > >
> > > Thank you.
> > > tjk :)
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
>

--0016e6d464cc669cd9047d375ef7--

From java-user-return-44563-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 16 07:21:37 2010
Return-Path: <java-user-return-44563-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97884 invoked from network); 16 Jan 2010 07:21:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Jan 2010 07:21:37 -0000
Received: (qmail 45854 invoked by uid 500); 16 Jan 2010 07:21:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45779 invoked by uid 500); 16 Jan 2010 07:21:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45769 invoked by uid 99); 16 Jan 2010 07:21:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 16 Jan 2010 07:21:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of thienthanhomenh@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 16 Jan 2010 07:21:28 +0000
Received: by qw-out-2122.google.com with SMTP id 3so307978qwe.53
        for <java-user@lucene.apache.org>; Fri, 15 Jan 2010 23:21:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:from:date:message-id
         :subject:to:content-type;
        bh=7Zeg3X8vTtRwwh3Fig0pV7XhUc6AxRNGzVovx3LsFj4=;
        b=XMbIr5IypqhHVq9rxDyWIhQUR0dGI3nxGeKF+vyp6I3c1Zw9lh5VcXL2VjF5TeEL9i
         OEV1raCxG32R9TyGOO4Fj9Xz6QVZrJPUKV0a3RgDyC+ob3t400vzCEDx8xRdZyodaTdh
         v4Ccp01HnuyU+M+l2jBqKWn5+ASfLnulxAcwA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        b=k7QHuNWDnnUX62KvxX+xmI0HbLbsdeQWiuJTi0o02NUVsezLaHpNfUBxjR7alq3myG
         lQsPKDnmVaTSlUHTW+kytJFDOlbQvjf7xOvq7YVsufwFy81OLWRQu4ppyE+DgfNUolTY
         lCxcsrS4RGX+UjDZ3k9meGf4O1u/Stl+71A0g=
MIME-Version: 1.0
Received: by 10.224.52.224 with SMTP id j32mr2852477qag.302.1263626467125; 
	Fri, 15 Jan 2010 23:21:07 -0800 (PST)
From: Phan The Dai <thienthanhomenh@gmail.com>
Date: Sat, 16 Jan 2010 16:20:47 +0900
Message-ID: <3b23ce091001152320k661a52bcr2a1381cf49eecc67@mail.gmail.com>
Subject: A way to download URLs and index better ?
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00c09fa21782b3ae6a047d42f633

--00c09fa21782b3ae6a047d42f633
Content-Type: text/plain; charset=ISO-8859-1

Hi everyone, please help me this question:
I need downloading some webpages from a list of URLs (about 200 links) and
then index them by Lucene.
This list is not fixed, because it depends on definition of my process.
Currently, in my web application, I wrote class for downloading, but it
download time is too long.

Please recommend me a Java library suitable with my situation for optimize
downloading.
More its examples are very wonderful (INPUT: list of URLs; OUTPUT: webpages
content, or indexed repository)
Thank you very much.

--00c09fa21782b3ae6a047d42f633--

From java-user-return-44564-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 16 07:27:01 2010
Return-Path: <java-user-return-44564-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98513 invoked from network); 16 Jan 2010 07:27:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Jan 2010 07:27:00 -0000
Received: (qmail 50660 invoked by uid 500); 16 Jan 2010 07:26:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50581 invoked by uid 500); 16 Jan 2010 07:26:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50571 invoked by uid 99); 16 Jan 2010 07:26:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 16 Jan 2010 07:26:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.12] (HELO web52902.mail.re2.yahoo.com) (206.190.49.12)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 16 Jan 2010 07:26:48 +0000
Received: (qmail 57465 invoked by uid 60001); 16 Jan 2010 07:26:27 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263626787; bh=Rib2YJ19VBjB79lNjX+wUAMoH2sby4xuW6hbWrW3ySo=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=HwfsyqhcgIv536ZYLv5ByBoyfmNGIF9HSUoqZ3x8l9i8Us5JCxoWS4nKsqPLoWxLw8S/n/ge9ktjgujcDpH/b1tV8e3rFQKmpVEGycqlWo/n3hAurq1A1Zzarjr0JIeJCvcclkk5eYLjI4bNjUtg3D7fNDtcMXQLxWIfoBMWfz4=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=wAjZk/hKZ2ir+522nE7CEm27jWCEhI3uQc9kQ/OVZRyirgFXsHXWWUifX8UNV1Hv8zFaTQJd0SBJaqrOfdwlbjqMux0kJHaNenZ4YBHsAnjgkBSTX5N5v7wFUst4egdZr1S4LKmF2yWhkpapMvACshvQGhsGPganxkip834jBr8=;
Message-ID: <43867.57165.qm@web52902.mail.re2.yahoo.com>
X-YMail-OSG: vY8_4iAVM1lEgv9APSQSozoBNOMRrfive2dMemZrcnzXl8nC8z7E6mBlNn80lznv9zcxavmPf1L5w.qjaNUWnQqmwM83tY_5lmXpd17AonBNPnaVqXURVbjaad1a8vvMJB_ovZkGJ9kokYl0S12Pkpo_HJ8.GxR4W073VQNF6STjsgwm84SH0sem5gBj8FShd.npswBo9HYL88AaTEq_YhjCt8ALRhp.OMa._egB345HmlwnYRy2oeyG9ua8si3.irES1z537Mul2DgyRXPO9JdpPq8QxmhR6prwVvuS5zkOyjSyfIkXYWlXWTrxzwEFNMk538AzFzsM97gQhpqJaJYOES9LTCwozRKd4z7N2K5xGnapRCSlKjiB9FqQuCBQpsmqzsJdMpjvCN14rRFz0XyPXAPKY_j5y6Nwoc52TMRhJ9rdac34fFRRxNka.xYMoCPny8igmpRJhzzNVDulhYBH
Received: from [95.15.159.50] by web52902.mail.re2.yahoo.com via HTTP; Fri, 15 Jan 2010 23:26:26 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Fri, 15 Jan 2010 23:26:26 -0800 (PST)
From: Ahmet Arslan <iorixxx@yahoo.com>
Subject: Re: A way to download URLs and index better ?
To: java-user@lucene.apache.org
In-Reply-To: <3b23ce091001152320k661a52bcr2a1381cf49eecc67@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

> Hi everyone, please help me this
> question:
> I need downloading some webpages from a list of URLs (about
> 200 links) and
> then index them by Lucene.
> This list is not fixed, because it depends on definition of
> my process.
> Currently, in my web application, I wrote class for
> downloading, but it
> download time is too long.
> 
> Please recommend me a Java library suitable with my
> situation for optimize
> downloading.
> More its examples are very wonderful (INPUT: list of URLs;
> OUTPUT: webpages
> content, or indexed repository)
> Thank you very much.

Probably most famous ones :

http://lucene.apache.org/nutch/
http://crawler.archive.org/



      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44565-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 16 08:07:33 2010
Return-Path: <java-user-return-44565-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3646 invoked from network); 16 Jan 2010 08:07:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 16 Jan 2010 08:07:33 -0000
Received: (qmail 62810 invoked by uid 500); 16 Jan 2010 08:07:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62729 invoked by uid 500); 16 Jan 2010 08:07:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62719 invoked by uid 99); 16 Jan 2010 08:07:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 16 Jan 2010 08:07:31 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thienthanhomenh@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 16 Jan 2010 08:07:20 +0000
Received: by qw-out-2122.google.com with SMTP id 3so311737qwe.53
        for <java-user@lucene.apache.org>; Sat, 16 Jan 2010 00:06:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=btW1Cldfh2G42V9KxA3yP/duZ4Kcqn3w41WlEbUElx0=;
        b=Lfo7NeZST3MHrVPPDvBiKITD8QVpOM3u0jyBWJ6v762aVuADk2uhBSMKwOw7AkjQZt
         BpiUp0cQdDzzhBjxhHXvRZpXkQ0YOMU8UymwnfenrzN4AadxacLib8sHU4LF03LASTgH
         ++0GfHnO9WHcpv7903jDvyiytBZvOeImWF1vU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=wn0W1DDx2g4Nw4EbSJYNnEH2BYkQSlebtODSo5n+okC3SUXQAn9varQ2LIY/MA3UX2
         X5hDNkUxyiyTLhzmHb4wAHxXXG/HbQ29xgNI5jnWl5mPt5s0fjIKHDDD9Ozh1YLhKuqm
         wn3LFZUiW+mN3fFj1cUC58l+6iSKuQ24yJIeE=
MIME-Version: 1.0
Received: by 10.224.115.84 with SMTP id h20mr2891604qaq.289.1263629219312; 
	Sat, 16 Jan 2010 00:06:59 -0800 (PST)
In-Reply-To: <43867.57165.qm@web52902.mail.re2.yahoo.com>
References: <3b23ce091001152320k661a52bcr2a1381cf49eecc67@mail.gmail.com> 
	<43867.57165.qm@web52902.mail.re2.yahoo.com>
From: Phan The Dai <thienthanhomenh@gmail.com>
Date: Sat, 16 Jan 2010 17:06:39 +0900
Message-ID: <3b23ce091001160006k27f251cbm9f7f1dc5be9d2413@mail.gmail.com>
Subject: Re: A way to download URLs and index better ?
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000feaee583abeb4be047d439a44
X-Virus-Checked: Checked by ClamAV on apache.org

--000feaee583abeb4be047d439a44
Content-Type: text/plain; charset=ISO-8859-1

Thank much to Ahmet Arslan,
Although I have known about Nutch and Heritrix, when I read Lucene in Action
book but I am a newer of using them
I am not sure they are support for my situation.

I need an API allowing my application automatically fetching URLs and
download them into a Directory (as Directory of Lucene).
Detail question: I need 2 progresses running sequentially written in Java.
         Progress1 generates a list of URLs.
         Now I want a module (progress 1) download URLs' content to index
them directly.
Nutch and Heritrix can support libraries to do it ? An example or other
comment !

Thank you again  for answering this question.


On Sat, Jan 16, 2010 at 4:26 PM, Ahmet Arslan <iorixxx@yahoo.com> wrote:

> > Hi everyone, please help me this
> > question:
> > I need downloading some webpages from a list of URLs (about
> > 200 links) and
> > then index them by Lucene.
> > This list is not fixed, because it depends on definition of
> > my process.
> > Currently, in my web application, I wrote class for
> > downloading, but it
> > download time is too long.
> >
> > Please recommend me a Java library suitable with my
> > situation for optimize
> > downloading.
> > More its examples are very wonderful (INPUT: list of URLs;
> > OUTPUT: webpages
> > content, or indexed repository)
> > Thank you very much.
>
> Probably most famous ones :
>
> http://lucene.apache.org/nutch/
> http://crawler.archive.org/
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000feaee583abeb4be047d439a44--

From java-user-return-44566-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 17 02:38:14 2010
Return-Path: <java-user-return-44566-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75921 invoked from network); 17 Jan 2010 02:38:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Jan 2010 02:38:14 -0000
Received: (qmail 80599 invoked by uid 500); 17 Jan 2010 02:38:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80431 invoked by uid 500); 17 Jan 2010 02:38:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80419 invoked by uid 99); 17 Jan 2010 02:38:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 02:38:11 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.58] (HELO web50304.mail.re2.yahoo.com) (206.190.38.58)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 17 Jan 2010 02:38:01 +0000
Received: (qmail 95369 invoked by uid 60001); 17 Jan 2010 02:37:40 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263695860; bh=GeF8CT4rJ/oR9plZy6buFMrCQXIS95eu6mgfsl/Ge5g=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=22aVVSFk4nYVfq/FqugdHXFHOI+N5Z6wAtY4wcHI47XJ84wNLKgK6jew5TWGHIgdNrhLZheZkgHgTYPP7r6uiQeWSri9CQcVEEVYbCyJzHxVYhkJGC3CBY7k5aZYh9AL1t82GuD+AR3ifaAuHVyrSd6dPXDtLxE+e6tHH0H6QFo=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=P9uLQAOz+GHylOtsE82xLESVtOht02DxYzIopC2PNWYIG0B4g4ASBHHxGMOEPtSC6RWlaoAbbUMWBWcaJ5oJDu5us1d6uCEj4IQnf6qiUmKuD4ZtKDSNe+AazPJ0V0mC+NEljcYukahQsaOuenV3EQAg7RAZn3ClEg6q4E/u8as=;
Message-ID: <113821.95199.qm@web50304.mail.re2.yahoo.com>
X-YMail-OSG: eowMvzMVM1nTwzc40NoK1VD6ccKD3NGV4.rmWqCquGtfUrxlAobMRkFj1l14CPsMd.GWV.ZyHyi5Q2B0sGtKj0IpMwR4Q9qeLmQe8DEI7ScESVNWZfQW7eMksQa_IYyBYT3hS5EMHTvUzu6hv_iqN9tL4VzvFTYeB6RI9tEoUcHjTWhvwCUa7sWeQsZxbG7nR4OAg.1MiIQoCes5SoF_hq9kLhaGlGXrUlu8sS5J_8XKmUqkFOmq62FuuEn3GIkE1G7qAA63TkqS1mrdzMnHd0kHW1ZQJNiWhWi7k1Osb8vZfhXSK0kIQA5uAcWwdQLTKlvhe04QO7Mi.QVJIDc7ZZKNf51ODFZfSAOz6r92FVP1D0MGe.hg2fn0yvXGpudfWgHxkIzBtZIpI5qYn3bbMcVL
Received: from [74.73.1.126] by web50304.mail.re2.yahoo.com via HTTP; Sat, 16 Jan 2010 18:37:40 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <3b23ce091001152320k661a52bcr2a1381cf49eecc67@mail.gmail.com>
Date: Sat, 16 Jan 2010 18:37:40 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: A way to download URLs and index better ?
To: java-user@lucene.apache.org
In-Reply-To: <3b23ce091001152320k661a52bcr2a1381cf49eecc67@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

Use Droids, it's much simpler than Nutch or Heritrix:

http://incubator.apache.org/droids/

Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Phan The Dai <thienthanhomenh@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Sat, January 16, 2010 2:20:47 AM
> Subject: A way to download URLs and index better ?
> 
> Hi everyone, please help me this question:
> I need downloading some webpages from a list of URLs (about 200 links) and
> then index them by Lucene.
> This list is not fixed, because it depends on definition of my process.
> Currently, in my web application, I wrote class for downloading, but it
> download time is too long.
> 
> Please recommend me a Java library suitable with my situation for optimize
> downloading.
> More its examples are very wonderful (INPUT: list of URLs; OUTPUT: webpages
> content, or indexed repository)
> Thank you very much.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44567-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 17 09:34:28 2010
Return-Path: <java-user-return-44567-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62916 invoked from network); 17 Jan 2010 09:34:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Jan 2010 09:34:28 -0000
Received: (qmail 86946 invoked by uid 500); 17 Jan 2010 09:34:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86859 invoked by uid 500); 17 Jan 2010 09:34:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86849 invoked by uid 99); 17 Jan 2010 09:34:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 09:34:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of farhang@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 09:34:14 +0000
Received: by ewy25 with SMTP id 25so210999ewy.5
        for <java-user@lucene.apache.org>; Sun, 17 Jan 2010 01:33:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ID18jIE7CuP9gt+3vWzPJJnEQxBUvlfteLKh+tv8Dp4=;
        b=uRBZKSgmCW9zrxxY+il8c1FoBg26TIjmDW8b9IwYJg2+/iZlEcIp8V3f7jryAX7ZhL
         eAYYRwV10+b95ctEhA9LntOzbV6ENueGRFvXCKBVvl8vLkIagCt4Q4QJjRuNbXrEmmqX
         +rbIS6BKKBbOonq6WyXMEzZwkcm+Dow3IQXb4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=eUPLlUz4pZRwAB3386cq0fump5pMrE555DIobkNFxNHIDld7Zf0wCUmJzT7FAGHlra
         ywJ9YJKoGR2jzDLaQXn9qxX6+9YNFofd/w/abaeQWavdv7dVwyxW2YSTUi02hUHc/PB9
         bw3gQTJQwRXdfkTDqPLSHqR+OtmfmV00X5wY0=
MIME-Version: 1.0
Received: by 10.216.90.21 with SMTP id d21mr1583522wef.85.1263720832822; Sun, 
	17 Jan 2010 01:33:52 -0800 (PST)
In-Reply-To: <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
Date: Sun, 17 Jan 2010 02:33:52 -0700
Message-ID: <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
Subject: Re: incremental document field update
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Thanks Mike!  This is pretty cool..

So LUCENE-1879 takes care of aligning (syncing) doc-ids across
parallel index / segment merges. Missing is the machinery for
updating a field (or fields) in a parallel slave index: to do this the
appropriate segment in the slave index must somehow be rewritten.
(right?)

In order to support this feature, I'm thinking one could implement
an UpdateableSlaveIndexWriter / UpdateableSlaveIndexReader
pair. UpdateableSlaveIndexWriter is an IndexWriter with a special
updateField[s] method that uses a (I think, per-segment, not sure)
write-ahead log to map a to-be-deleted doc-id in to a newly created
doc-id.  It also maintains other statistics such as a virtual maxDocId.
The UpdateableSlaveIndexReader would play back this log file (if
any) and maintain the mappings in-memory.

I imagine there would also have to be a UpdateableSlaveIndexReader
variant that works on individual slave index segments rather than the
entire collection of segments that comprise the slave index. This, say,
UpdateableSlaveIndexSegReader would be used in lieu of the
SegmentReader instances currently used for merging segments.

The SegmentMerger class appears to be sufficiently agnostic about the
exact type of the IndexReader instances that represent the inputs to the
merge (though it does favor SegmentReader subclasses). So far so
good.  However, there appear to be a number of other junctures in the
merge code that depend on the static SegmentReader.get methods.
These would have to be indirected through some factory mechanism
so that we could return our UpdateableSlaveIndexSegReader.

Is the approach I'm describing sensible? Or did I get it all wrong? (This
was my first look at this code, so it is entirely possible that I'm making
a fool of myself ;)

-Babak




On Thu, Jan 14, 2010 at 3:39 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> Parallel incremental indexing
> (http://issues.apache.org/jira/browse/LUCENE-1879) is one way to solve
> this.
>
> Mike
>
> On Thu, Jan 14, 2010 at 4:27 AM, Babak Farhang <farhang@gmail.com> wrote:
>>> Reading that trail, I wish the original poster gave up on his idea (
>>
>> Err, that should have read..
>>
>> "Reading that trail, I wish the original poster hadn't given up on his idea"
>>
>>
>> On Thu, Jan 14, 2010 at 2:23 AM, Babak Farhang <farhang@gmail.com> wrote:
>>> Hi,
>>>
>>> I've been thinking about how to update a single field of a document
>>> without touching its other fields. This is an old problem and I was
>>> considering a solution along the lines of Andrzej Bialecki's post to
>>> the dev list back in '07:
>>>
>>>
>>> <quote  http://markmail.org/message/tbkgmnilhvrt6bii >
>>>
>>> I have the following scenario: I want to use ParallelReader to
>>> maintain parts of the index that are changing quickly, and where
>>> changes are limited to specific fields only.
>>>
>>> Let's say I have a "main" index (many fields, slowly changing, large
>>> updates), and an "aux" index (fast changing, usually single doc and
>>> single field updates). I'd like to "replace" documents in the "aux"
>>> index - that is, delete one doc and add another - but in a way that
>>> doesn't change the internal document numbers, so that I can keep the
>>> mapping required by ParallelReader intact.
>>>
>>> I think this is possible to achieve by using a FilterIndexReader,
>>> which keeps a map of updated documents, and re-maps old doc ids to the
>>> new ones on the fly.
>>>
>>> From time to time I'd like to optimize the "aux" index to get rid of
>>> deleted docs. At this time I need to figure out how to preserve the
>>> old->new mapping during the optimization.
>>>
>>> So, here's the question: is this scenario feasible? If so, then in the
>>> trunk/ version of Lucene, is there any way to figure out (predictably)
>>> how internal document numbers are reassigned after calling optimize()
>>> ?
>>>
>>> </quote>
>>>
>>>
>>> Reading that trail, I wish the original poster gave up on his idea (
>>> http://markmail.org/message/tbkgmnilhvrt6bii#query:+page:1+mid:kn77zpiu43kd2ufn+state:results
>>> )
>>>
>>>
>>> <quote>
>>> Thanks for the input - for now I gave up on this, after discovering
>>> that I would have no way to ensure in TermDocs.skipTo() that document
>>> id-s are monotonically increasing (which seems to be a part of the
>>> contract).
>>> </quote>
>>>
>>> I imagine if Andrzej's proposed FilterIndexReader maintains 2 sorted
>>> (ordered) maps, one from internal document-ids to "view" document-ids,
>>> and another mapping from  "view" document-ids to internal
>>> document-ids, then things like skipTo() can be implemented reasonably
>>> efficiently. Only the mapped ids are maintained in these structures.
>>> (Also note that a mapped "view" document-id represents an internally
>>> deleted document with that id.)
>>>
>>> And if we can find a way to merge the segments of this "aux" index
>>> along whenever the segments of its associated "main" index are merged
>>> or optimized (such that the [internal] doc-ids in the merged aux index
>>> end up getting sync'ed with those of the trunk), then there shouldn't
>>> be all that many doc-ids to map anyway (if we merge frequently
>>> enough).
>>>
>>> So to go back Andrzej's question: is there any way to figure out
>>> (predictably) how internal document numbers [in the main index] are
>>> reassigned after calling optimize() ? How does LUCENE-847, as Doug
>>> Cutting suggests in that trail, help?
>>>
>>> Sorry if that was long winded, had to start somewhere ;)
>>>
>>> -Babak
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44568-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 17 10:02:30 2010
Return-Path: <java-user-return-44568-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74455 invoked from network); 17 Jan 2010 10:02:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Jan 2010 10:02:30 -0000
Received: (qmail 98119 invoked by uid 500); 17 Jan 2010 10:02:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98053 invoked by uid 500); 17 Jan 2010 10:02:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98042 invoked by uid 99); 17 Jan 2010 10:02:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 10:02:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 10:02:21 +0000
Received: by ewy25 with SMTP id 25so224924ewy.5
        for <java-user@lucene.apache.org>; Sun, 17 Jan 2010 02:02:00 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=Mrrtq0idIlGMximuWSpq/mjrGwmlSPZOg+uM9Qdng5Q=;
        b=mZoCa0cBEoDFS5ussj1Nbw4/GIRGYyDQf1TfBUcXhXCgPGdvDI5S9AN8sMC8VeoaRC
         IcQsaGMBMW2reExWM/cfY5xqOfCznfnar1rAB2KNg9Vo4IAGpmHw5I19P51QaLU2DRZP
         9nULeBK+e/9zvaeh3kb30gPVo+ZK9hcQ2rdvE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=MXhEiZFfxWwQPgi+E9/biKM7O5eQ0vart/kfHWSBdGe9Lc5GBIjXUFWZzkG/IO8Avx
         Xy9lNqeE6zjl19VLSizateINNtg+HZGS5Nu5TKJS/Yg2hwLPNQwNdp13lNlxJ1OWOx0c
         eySjo1hdhsJ4z8syw4QIJjz2qift956uYQFQg=
MIME-Version: 1.0
Received: by 10.216.90.208 with SMTP id e58mr1588556wef.57.1263722519702; Sun, 
	17 Jan 2010 02:01:59 -0800 (PST)
Date: Sun, 17 Jan 2010 12:01:59 +0200
Message-ID: <786fde51001170201k21a51d51jfb1f7f9b89754a7c@mail.gmail.com>
Subject: Using TermDocs.seek vs. IndexReader.termDocs()
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6db2ae7e1af15047d5953f3

--0016e6db2ae7e1af15047d5953f3
Content-Type: text/plain; charset=ISO-8859-1

Hi

I remember a while ago a discussion around the efficiency of TermDocs.seek
and how it is inefficient and it's better to call IndexReader.termDocs
instead (actually someone was proposing to remove seek entirely from the
interface because of that). I've looked at FieldCacheImpl's
ByteCache.createValue and noticed it calls termDocs.seek.

So is it 'safe' to call seek again? Has the implementation improved? I
checked SegmentTermDocs change history but didn't see anything related, nor
in FieldCacheImpl. I'm iterating a TermEnum and need to get the documents
associated with each term. Basically, more or so what FieldCacheImpl does.
So I thought to use the same methodology (I used to call reader.termDocs on
every term before I saw FieldCacheImpl's implementation). Since TermEnum
moves forward, I hope that termDocs.seek will move forward as well, and I
only do it within the same field.

BTW, if there is a better way to do what I'm trying to (such as a better
API), I'd appreciate if you can give me a hint.

Thanks,
Shai

--0016e6db2ae7e1af15047d5953f3--

From java-user-return-44569-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 17 10:06:43 2010
Return-Path: <java-user-return-44569-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76301 invoked from network); 17 Jan 2010 10:06:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Jan 2010 10:06:43 -0000
Received: (qmail 2475 invoked by uid 500); 17 Jan 2010 10:06:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2403 invoked by uid 500); 17 Jan 2010 10:06:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2393 invoked by uid 99); 17 Jan 2010 10:06:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 10:06:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 10:06:34 +0000
Received: by yxe30 with SMTP id 30so1886166yxe.29
        for <java-user@lucene.apache.org>; Sun, 17 Jan 2010 02:06:13 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.117.14 with SMTP id p14mr3659976ybc.76.1263722766677; Sun, 
	17 Jan 2010 02:06:06 -0800 (PST)
In-Reply-To: <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
Date: Sun, 17 Jan 2010 05:06:06 -0500
Message-ID: <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
Subject: Re: incremental document field update
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Sun, Jan 17, 2010 at 4:33 AM, Babak Farhang <farhang@gmail.com> wrote:
> Thanks Mike! =A0This is pretty cool..
>
> So LUCENE-1879 takes care of aligning (syncing) doc-ids across
> parallel index / segment merges. Missing is the machinery for
> updating a field (or fields) in a parallel slave index: to do this the
> appropriate segment in the slave index must somehow be rewritten.
> (right?)

I think you're right -- though I haven't looked closely in a while.  I
think under LUCENE-1879, the entire secondary index must be fully
rewritten whenever any changes are made.  But the thinking is that the
secondary index has smallish fields so this might be OK (but I agree,
does not scale up well).

> In order to support this feature, I'm thinking one could implement
> an UpdateableSlaveIndexWriter / UpdateableSlaveIndexReader
> pair. UpdateableSlaveIndexWriter is an IndexWriter with a special
> updateField[s] method that uses a (I think, per-segment, not sure)
> write-ahead log to map a to-be-deleted doc-id in to a newly created
> doc-id. =A0It also maintains other statistics such as a virtual maxDocId.
> The UpdateableSlaveIndexReader would play back this log file (if
> any) and maintain the mappings in-memory.
>
> I imagine there would also have to be a UpdateableSlaveIndexReader
> variant that works on individual slave index segments rather than the
> entire collection of segments that comprise the slave index. This, say,
> UpdateableSlaveIndexSegReader would be used in lieu of the
> SegmentReader instances currently used for merging segments.

This sounds very interesting!

So the idea is, I can change the field for only a few docs in a
massive index, and the amount of "work" done, and bytes written, is in
proportion only to how many docs were changed?

What would the actual data structure look like on disk?  And what
would be loaded into RAM such that eg enumerating a postings lists
would work correctly?  You'd have to remap docIDs on the fly, right?

> The SegmentMerger class appears to be sufficiently agnostic about the
> exact type of the IndexReader instances that represent the inputs to the
> merge (though it does favor SegmentReader subclasses). So far so
> good. =A0However, there appear to be a number of other junctures in the
> merge code that depend on the static SegmentReader.get methods.
> These would have to be indirected through some factory mechanism
> so that we could return our UpdateableSlaveIndexSegReader.

Yeah this has been a growing problem... or at least others have bumped
up against this.  We are wanting to factor out the ReaderPool
(currently embedded in IndexWriter) to a public standalone class that
would be the "standard" factory for getting new SegmentReaders.  I
think SegmentMerger would then use this, and apps could specify their
own ReaderPool impl to produce whichever impl they wanted.  This is
being tracked (well, only started at this point) in LUCENE-2026.

> Is the approach I'm describing sensible? Or did I get it all wrong? (This
> was my first look at this code, so it is entirely possible that I'm makin=
g
> a fool of myself ;)

This sounds great so far!  Individually updateable fields would be an
awesome addition to Lucene (it's often asked about).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44570-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 17 10:25:03 2010
Return-Path: <java-user-return-44570-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85358 invoked from network); 17 Jan 2010 10:25:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Jan 2010 10:25:03 -0000
Received: (qmail 12192 invoked by uid 500); 17 Jan 2010 10:25:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12111 invoked by uid 500); 17 Jan 2010 10:25:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12101 invoked by uid 99); 17 Jan 2010 10:25:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 10:25:00 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 10:24:53 +0000
Received: by ywh14 with SMTP id 14so1644663ywh.20
        for <java-user@lucene.apache.org>; Sun, 17 Jan 2010 02:24:32 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.165.18 with SMTP id n18mr3652579ybe.253.1263723872345; 
	Sun, 17 Jan 2010 02:24:32 -0800 (PST)
In-Reply-To: <786fde51001170201k21a51d51jfb1f7f9b89754a7c@mail.gmail.com>
References: <786fde51001170201k21a51d51jfb1f7f9b89754a7c@mail.gmail.com>
Date: Sun, 17 Jan 2010 05:24:32 -0500
Message-ID: <9ac0c6aa1001170224h2e2dfc90q8b2d0910a4d6eb25@mail.gmail.com>
Subject: Re: Using TermDocs.seek vs. IndexReader.termDocs()
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Sun, Jan 17, 2010 at 5:01 AM, Shai Erera <serera@gmail.com> wrote:

> I remember a while ago a discussion around the efficiency of TermDocs.seek
> and how it is inefficient and it's better to call IndexReader.termDocs
> instead (actually someone was proposing to remove seek entirely from the
> interface because of that). I've looked at FieldCacheImpl's
> ByteCache.createValue and noticed it calls termDocs.seek.

Actually, I think the discussion was about TermEnum.skipTo, which is
in fact now removed as of 3.0, not TermDocs.seek.  I think
TermDocs.seek is OK to call.

> So is it 'safe' to call seek again? Has the implementation improved? I
> checked SegmentTermDocs change history but didn't see anything related, nor
> in FieldCacheImpl. I'm iterating a TermEnum and need to get the documents
> associated with each term. Basically, more or so what FieldCacheImpl does.
> So I thought to use the same methodology (I used to call reader.termDocs on
> every term before I saw FieldCacheImpl's implementation). Since TermEnum
> moves forward, I hope that termDocs.seek will move forward as well, and I
> only do it within the same field.

I think TermDocs.seek has no forward only "constraint", meaning,
whatever term you give it (whether it's before or after where it
currently is), it will go to.

> BTW, if there is a better way to do what I'm trying to (such as a better
> API), I'd appreciate if you can give me a hint.

Just to give a preview of the current flex API... you'd do it roughly
like this (this is what FieldCacheImpl on flex branch does):

  // represents all terms in the field
  Terms terms = reader.fields().terms(field);

  // assuming you want to skip the deleted docs...
  Bits skipDocs = reader.getDeletedDocs();

  if (terms != null) {
    // field exists
    TermsEnum termsEnum = terms.iterator();
    while(true) {
      final BytesRef term = termsEnum.next();
      if (term == null) {
        break;
      }
      DocsEnum docs = termsEnum.docs(skipDocs);
      while(true) {
        final int docID = docs.nextDoc();
        if (docID == DocsEnum.NO_MORE_DOCS) {
          break;
        }
        // do something with docID
      }
    }
  }

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44571-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 17 10:35:42 2010
Return-Path: <java-user-return-44571-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89855 invoked from network); 17 Jan 2010 10:35:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Jan 2010 10:35:41 -0000
Received: (qmail 22289 invoked by uid 500); 17 Jan 2010 10:35:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22208 invoked by uid 500); 17 Jan 2010 10:35:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22198 invoked by uid 99); 17 Jan 2010 10:35:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 10:35:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 10:35:32 +0000
Received: by ewy25 with SMTP id 25so241736ewy.5
        for <java-user@lucene.apache.org>; Sun, 17 Jan 2010 02:35:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=AKkVXXAGfAG1BHZxy9TFLfBFiw4fKiqI8fciEYpDeLU=;
        b=ZtQTK3MkmrWRMU/yCTGKG9XNDDQ7HtJnzfJc0m4X2CniwSdZcibf5JRDJFIZCpCaqV
         KOhFxZvnnB5A9caz3xldqS6FZHL78qC9A3Qx1e/8q259qehLmRwjJQgfA9RWlSKbnJmE
         loiX8XJEmOSWjpT++dW5KFzNkFSzgzEDXM/28=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=hNbQLYC3yDDu3nV4tfQKMsYnJZVR1ljF3bKhn7rQpO4oqUsPFvBiOS48FL1VpT+ZxT
         TBzz7ZwQzYOTedLEWTllH+Me3WhSMzSOH48eD3Sy85WkthWhOKbRUlwD7F2ZOwKe5oqh
         lWRKytBaXl7IPGfCd/GQTHHYIFciVsADRufus=
MIME-Version: 1.0
Received: by 10.216.162.3 with SMTP id x3mr1569544wek.21.1263724511217; Sun, 
	17 Jan 2010 02:35:11 -0800 (PST)
In-Reply-To: <9ac0c6aa1001170224h2e2dfc90q8b2d0910a4d6eb25@mail.gmail.com>
References: <786fde51001170201k21a51d51jfb1f7f9b89754a7c@mail.gmail.com>
	 <9ac0c6aa1001170224h2e2dfc90q8b2d0910a4d6eb25@mail.gmail.com>
Date: Sun, 17 Jan 2010 12:35:11 +0200
Message-ID: <786fde51001170235ue8928a5x2bb49bec4f352157@mail.gmail.com>
Subject: Re: Using TermDocs.seek vs. IndexReader.termDocs()
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e65b40e295c97e047d59ca39

--0016e65b40e295c97e047d59ca39
Content-Type: text/plain; charset=ISO-8859-1

Oh right, I confused TermEnum.skipTo w/ TermDocs.seek. Thanks for reminding
me that.

BTW, the flex implementation looks really useful. I like it that I won't
need to compare the field anymore. Looking forward to it.

Thanks
Shai

On Sun, Jan 17, 2010 at 12:24 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> On Sun, Jan 17, 2010 at 5:01 AM, Shai Erera <serera@gmail.com> wrote:
>
> > I remember a while ago a discussion around the efficiency of
> TermDocs.seek
> > and how it is inefficient and it's better to call IndexReader.termDocs
> > instead (actually someone was proposing to remove seek entirely from the
> > interface because of that). I've looked at FieldCacheImpl's
> > ByteCache.createValue and noticed it calls termDocs.seek.
>
> Actually, I think the discussion was about TermEnum.skipTo, which is
> in fact now removed as of 3.0, not TermDocs.seek.  I think
> TermDocs.seek is OK to call.
>
> > So is it 'safe' to call seek again? Has the implementation improved? I
> > checked SegmentTermDocs change history but didn't see anything related,
> nor
> > in FieldCacheImpl. I'm iterating a TermEnum and need to get the documents
> > associated with each term. Basically, more or so what FieldCacheImpl
> does.
> > So I thought to use the same methodology (I used to call reader.termDocs
> on
> > every term before I saw FieldCacheImpl's implementation). Since TermEnum
> > moves forward, I hope that termDocs.seek will move forward as well, and I
> > only do it within the same field.
>
> I think TermDocs.seek has no forward only "constraint", meaning,
> whatever term you give it (whether it's before or after where it
> currently is), it will go to.
>
> > BTW, if there is a better way to do what I'm trying to (such as a better
> > API), I'd appreciate if you can give me a hint.
>
> Just to give a preview of the current flex API... you'd do it roughly
> like this (this is what FieldCacheImpl on flex branch does):
>
>  // represents all terms in the field
>  Terms terms = reader.fields().terms(field);
>
>  // assuming you want to skip the deleted docs...
>  Bits skipDocs = reader.getDeletedDocs();
>
>  if (terms != null) {
>    // field exists
>    TermsEnum termsEnum = terms.iterator();
>    while(true) {
>      final BytesRef term = termsEnum.next();
>      if (term == null) {
>        break;
>      }
>      DocsEnum docs = termsEnum.docs(skipDocs);
>      while(true) {
>        final int docID = docs.nextDoc();
>        if (docID == DocsEnum.NO_MORE_DOCS) {
>          break;
>        }
>        // do something with docID
>      }
>    }
>  }
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e65b40e295c97e047d59ca39--

From java-user-return-44572-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 17 12:46:16 2010
Return-Path: <java-user-return-44572-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39873 invoked from network); 17 Jan 2010 12:46:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Jan 2010 12:46:16 -0000
Received: (qmail 98977 invoked by uid 500); 17 Jan 2010 12:46:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98885 invoked by uid 500); 17 Jan 2010 12:46:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98875 invoked by uid 99); 17 Jan 2010 12:46:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 12:46:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of farhang@gmail.com designates 74.125.78.25 as permitted sender)
Received: from [74.125.78.25] (HELO ey-out-2122.google.com) (74.125.78.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 12:46:05 +0000
Received: by ey-out-2122.google.com with SMTP id d26so608289eyd.3
        for <java-user@lucene.apache.org>; Sun, 17 Jan 2010 04:45:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=CY/vKa39UQe/SMJklio5tUz3VRnzJMP+MXNipmiJymE=;
        b=cNQ3ECnrrqOplIcRk/IdpW5WyV1+QlfdhDClyeyazXFdGbxPNqkoeGKni15GJlkkEu
         D1K2CuBS5qf/2GDTLcGJDF3QPQ+Mmzuh9RUPQQpypg/JRjKtx2hRnj7HsZ3WBa3wo5Aw
         JI3lELVo91vewip66drqfVxd/ZLJlPJWIuYn4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=EIWri3QvxEQDXqK5+mpZCkUeh/U44Nt7a2FDWTrSyTgZyEKidicIBvdD2gqN4p/H7M
         NXNbsKWmML0hP2cL8kgcs21ww6GX1plO3ZwWRoXfu1hUKcKDiA2JLaFQhsSQM0hz7n/V
         +rtgXwPrfq7P+PSSbeBqs/5q7o58lX/31Fcw4=
MIME-Version: 1.0
Received: by 10.216.89.149 with SMTP id c21mr1748141wef.224.1263732345069; 
	Sun, 17 Jan 2010 04:45:45 -0800 (PST)
In-Reply-To: <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
Date: Sun, 17 Jan 2010 05:45:45 -0700
Message-ID: <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
Subject: Re: incremental document field update
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

> So the idea is, I can change the field for only a few docs in a
> massive index, and the amount of "work" done, and bytes written, is in
> proportion only to how many docs were changed?

Exactly. We append auxiliary data to the parallel segment and
delay rewriting the segment to when it'll be merged with another segment.


> What would the actual data structure look like on disk?

Something like a surrogate docs log file

<rowCount><<int><int>>**rowCount

a fixed-width table, each row mapping a deleted doc-id to its "surrogate"
doc-id. The mapping entries are not sorted; it's a log file. If 2
entries reference the
same deleted doc-id, the last one wins. The <rowCount> header makes the
structure self-delimiting, and ensures clean writes (perhaps using a byte-size
keystone).


> And what
> would be loaded into RAM such that eg enumerating a postings lists
> would work correctly?  You'd have to remap docIDs on the fly, right?

Yes, on the fly. I think it boils down to 3 tasks:

1. Map "view" doc-ids to surrogate doc-ids. Supports input, e.g. referring
  to a doc by id.
2. Map surrogate doc-ids to "view" doc-ids. Supports output.
3. Re-sort postings quickly on output, and provide correct
TermDocs.skipTo() semantics.

For (1), I think an unordered HashMap<Integer,Integer> is good enough.
For (2) and (3), something like a TreeMap<Integer,Integer> I imagine should be
good enough too.  The sorted order of its keys (surrogate doc-ids)
should also allow
us to intersect the set of surrogate docs quickly with the already
sorted outbound
postings data, for example.

Both maps would be built by replaying the surrogate docs log file.


Maybe I should first try to bang out a prototype that works at the
index level, not the
segment level?

-Babak

On Sun, Jan 17, 2010 at 3:06 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> On Sun, Jan 17, 2010 at 4:33 AM, Babak Farhang <farhang@gmail.com> wrote:
>> Thanks Mike!  This is pretty cool..
>>
>> So LUCENE-1879 takes care of aligning (syncing) doc-ids across
>> parallel index / segment merges. Missing is the machinery for
>> updating a field (or fields) in a parallel slave index: to do this the
>> appropriate segment in the slave index must somehow be rewritten.
>> (right?)
>
> I think you're right -- though I haven't looked closely in a while.  I
> think under LUCENE-1879, the entire secondary index must be fully
> rewritten whenever any changes are made.  But the thinking is that the
> secondary index has smallish fields so this might be OK (but I agree,
> does not scale up well).
>
>> In order to support this feature, I'm thinking one could implement
>> an UpdateableSlaveIndexWriter / UpdateableSlaveIndexReader
>> pair. UpdateableSlaveIndexWriter is an IndexWriter with a special
>> updateField[s] method that uses a (I think, per-segment, not sure)
>> write-ahead log to map a to-be-deleted doc-id in to a newly created
>> doc-id.  It also maintains other statistics such as a virtual maxDocId.
>> The UpdateableSlaveIndexReader would play back this log file (if
>> any) and maintain the mappings in-memory.
>>
>> I imagine there would also have to be a UpdateableSlaveIndexReader
>> variant that works on individual slave index segments rather than the
>> entire collection of segments that comprise the slave index. This, say,
>> UpdateableSlaveIndexSegReader would be used in lieu of the
>> SegmentReader instances currently used for merging segments.
>
> This sounds very interesting!
>
> So the idea is, I can change the field for only a few docs in a
> massive index, and the amount of "work" done, and bytes written, is in
> proportion only to how many docs were changed?
>
> What would the actual data structure look like on disk?  And what
> would be loaded into RAM such that eg enumerating a postings lists
> would work correctly?  You'd have to remap docIDs on the fly, right?
>
>> The SegmentMerger class appears to be sufficiently agnostic about the
>> exact type of the IndexReader instances that represent the inputs to the
>> merge (though it does favor SegmentReader subclasses). So far so
>> good.  However, there appear to be a number of other junctures in the
>> merge code that depend on the static SegmentReader.get methods.
>> These would have to be indirected through some factory mechanism
>> so that we could return our UpdateableSlaveIndexSegReader.
>
> Yeah this has been a growing problem... or at least others have bumped
> up against this.  We are wanting to factor out the ReaderPool
> (currently embedded in IndexWriter) to a public standalone class that
> would be the "standard" factory for getting new SegmentReaders.  I
> think SegmentMerger would then use this, and apps could specify their
> own ReaderPool impl to produce whichever impl they wanted.  This is
> being tracked (well, only started at this point) in LUCENE-2026.
>
>> Is the approach I'm describing sensible? Or did I get it all wrong? (This
>> was my first look at this code, so it is entirely possible that I'm making
>> a fool of myself ;)
>
> This sounds great so far!  Individually updateable fields would be an
> awesome addition to Lucene (it's often asked about).
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44573-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 17 13:39:42 2010
Return-Path: <java-user-return-44573-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57704 invoked from network); 17 Jan 2010 13:39:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 17 Jan 2010 13:39:42 -0000
Received: (qmail 27558 invoked by uid 500); 17 Jan 2010 13:39:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27488 invoked by uid 500); 17 Jan 2010 13:39:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27478 invoked by uid 99); 17 Jan 2010 13:39:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 13:39:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.193] (HELO mail-yx0-f193.google.com) (209.85.210.193)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 17 Jan 2010 13:39:31 +0000
Received: by yxe31 with SMTP id 31so1640364yxe.21
        for <java-user@lucene.apache.org>; Sun, 17 Jan 2010 05:39:10 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.88.1 with SMTP id q1mr3822948ybl.22.1263735550497; Sun, 17 
	Jan 2010 05:39:10 -0800 (PST)
In-Reply-To: <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
	 <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
Date: Sun, 17 Jan 2010 08:39:10 -0500
Message-ID: <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
Subject: Re: incremental document field update
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Sun, Jan 17, 2010 at 7:45 AM, Babak Farhang <farhang@gmail.com> wrote:
>> So the idea is, I can change the field for only a few docs in a
>> massive index, and the amount of "work" done, and bytes written, is in
>> proportion only to how many docs were changed?
>
> Exactly. We append auxiliary data to the parallel segment and
> delay rewriting the segment to when it'll be merged with another segment.

OK.

>> What would the actual data structure look like on disk?
>
> Something like a surrogate docs log file
>
> <rowCount><<int><int>>**rowCount
>
> a fixed-width table, each row mapping a deleted doc-id to its "surrogate"
> doc-id. The mapping entries are not sorted; it's a log file. If 2
> entries reference the
> same deleted doc-id, the last one wins. The <rowCount> header makes the
> structure self-delimiting, and ensures clean writes (perhaps using a byte=
-size
> keystone).

Got it.  You'd presumably have to add a generation to this file, so
that multiple sessions of updates + commit write to private files
("write once")?  And then the reader merges all of them.

>> And what
>> would be loaded into RAM such that eg enumerating a postings lists
>> would work correctly? =A0You'd have to remap docIDs on the fly, right?
>
> Yes, on the fly. I think it boils down to 3 tasks:
>
> 1. Map "view" doc-ids to surrogate doc-ids. Supports input, e.g. referrin=
g
> =A0to a doc by id.
> 2. Map surrogate doc-ids to "view" doc-ids. Supports output.
> 3. Re-sort postings quickly on output, and provide correct
> TermDocs.skipTo() semantics.
>
> For (1), I think an unordered HashMap<Integer,Integer> is good enough.
> For (2) and (3), something like a TreeMap<Integer,Integer> I imagine shou=
ld be
> good enough too. =A0The sorted order of its keys (surrogate doc-ids)
> should also allow
> us to intersect the set of surrogate docs quickly with the already
> sorted outbound
> postings data, for example.

OK though for an index with many documents, that's gonna use up alot
of RAM, especially the Integer overhead.  Though, these will be sparse
right?  So it only uses RAM for docs that have updates, and when
segment merging hasn't merged them away.

> Both maps would be built by replaying the surrogate docs log file.

It sounds like this'd require the full posting list for a given term X
to be loaded into RAM, mapped, and sorted, before the caller can
actually pull the first docID, right?  I guess often this is likely an
acceptable cost, since "usually" the fields you update are smallish.

Thinking out loud... I wonder if, instead of deferring the mapping
until search time (which is costly since every search must re-do it),
we could do the mapping at indexing time?

Say we add an IndexWriter.updateDocumentFields(Term, Document) method,
which will update only the specified fields.  The Term must uniquely
refer to 1 existing doc in the index.  On flush, we resolve that Term
-> docID (we do this already, to apply deletions), and then we write
to a new set of "delta postings" files using the correct docID.  Then
the reader would have to merge these postings files when reading.
We'd also have generations...

> Maybe I should first try to bang out a prototype that works at the
> index level, not the
> segment level?

Sounds great!

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44574-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 18 05:35:43 2010
Return-Path: <java-user-return-44574-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44316 invoked from network); 18 Jan 2010 05:35:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Jan 2010 05:35:42 -0000
Received: (qmail 89001 invoked by uid 500); 18 Jan 2010 05:35:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88818 invoked by uid 500); 18 Jan 2010 05:35:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88808 invoked by uid 99); 18 Jan 2010 05:35:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 05:35:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of farhang@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 05:35:33 +0000
Received: by ewy25 with SMTP id 25so169469ewy.5
        for <java-user@lucene.apache.org>; Sun, 17 Jan 2010 21:35:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=pZzClJl9ENpjY9SPjFj7r8IIPwu7XG/OafuaZrz1ud8=;
        b=X9KdzEDYQyUaJ1+JCcDVvQkTKkVN7ajSrV6b4vJ+RcSS1GY6E3EvvRiowq0x6mnB4e
         GrHvDY5gEWuDeipWojHWne6rIPywIVfOxq8MkbRJkpy78JTQdq9THN8xcufCnag7kDXZ
         p19ZteHRv3t57zTtAgTpkJ8y3QXfAMI7haSAc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=NEooNKdhN8lI2dECt3rzAgagYXzr43FYsj+onEm/1bKCCqu98oSdCUZJvt/gNDfPJ+
         qKMbZF7TQMLhGtM0g//tuzgrTKxqWncyTtzkIgRkm2Ue+zEeizZ4GOgQu/8x6T2bjJ8r
         uQc7b3jowm9h7QRvsAlVPncUne3NdmDy/BPW0=
MIME-Version: 1.0
Received: by 10.216.86.11 with SMTP id v11mr1970271wee.220.1263792911461; Sun, 
	17 Jan 2010 21:35:11 -0800 (PST)
In-Reply-To: <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
	 <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
	 <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
Date: Sun, 17 Jan 2010 22:35:11 -0700
Message-ID: <b0f7deba1001172135y68f0fb03m3856c072ccacb83c@mail.gmail.com>
Subject: Re: incremental document field update
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

> Got it.  You'd presumably have to add a generation to this file, so
> that multiple sessions of updates + commit write to private files
> ("write once")?  And then the reader merges all of them.

Actually, I hadn't considered concurrent update/commit semantics;
I was thinking more along a single writer / many readers model..
Concurrent update is an altogether different beast than concurrent
add semantics, and I was hoping to avoid complexity.


> of RAM, especially the Integer overhead.  Though, these will be sparse
> right?  So it only uses RAM for docs that have updates, and when
> segment merging hasn't merged them away.

Yes.

> It sounds like this'd require the full posting list for a given term X
> to be loaded into RAM, mapped, and sorted, before the caller can
> actually pull the first docID, right?  I guess often this is likely an
> acceptable cost, since "usually" the fields you update are smallish.

I was thinking, for large posting lists, we can avoid loading the entire
list into RAM in most cases. Given that we have a sorted set of mapped
surrogate doc-ids (the key-set in the TreeMap), we should be able to
search any surrogate doc-ids that need to be mapped in the underlying
posting list using judicious calls to skipTo() on the underlying TermDocs.
(This is just like an efficient implementation of finding the intersection
of 2 sorted arrays of integers: the performance is linear in the size of
the shortest array, and often, not all the elements of the shorter array
need even be examined.)

So when the
[Filter]TermDocs instance is first positioned to a term, it first gathers
the to-be-mapped (surrogate) doc-ids in a sorted list (hopefully a small
subset of postings list), then maps these to their "view" ids in a separate
list, and finally sorts this list of mapped "view" ids. So one list contains
the (sorted) doc-ids that must be removed from the underlying posting
list, and another contains the (sorted) doc-ids that must be interleaved
into the postings.  Using these two lists, we should be able implement
a proper view of the postings.


> Thinking out loud... I wonder if, instead of deferring the mapping
> until search time (which is costly since every search must re-do it),
> we could do the mapping at indexing time?
>
> Say we add an IndexWriter.updateDocumentFields(Term, Document) method,

This method name/signature/semantics much better than
the one I proposed..

> which will update only the specified fields.  The Term must uniquely
> refer to 1 existing doc in the index.  On flush, we resolve that Term
> -> docID (we do this already, to apply deletions), and then we write
> to a new set of "delta postings" files using the correct docID.  Then
> the reader would have to merge these postings files when reading.

[Thinking out loud too] Interesting. So instead of rewriting the entire
slave segment on update we rewrite things like the "delta postings"
files on committing an update?

I'm thinking this approach would probably best work on "batch"
update/commits.

If on the other hand the use case is a sequence of N single-doc
update/commits, then the total cost of the N updates would likely
approach O(N**2) -- <N rewrites> * <avg delta postings file size = O(N)>
So as ever, there are tradeoffs.

-Babak



On Sun, Jan 17, 2010 at 6:39 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> On Sun, Jan 17, 2010 at 7:45 AM, Babak Farhang <farhang@gmail.com> wrote:
>>> So the idea is, I can change the field for only a few docs in a
>>> massive index, and the amount of "work" done, and bytes written, is in
>>> proportion only to how many docs were changed?
>>
>> Exactly. We append auxiliary data to the parallel segment and
>> delay rewriting the segment to when it'll be merged with another segment.
>
> OK.
>
>>> What would the actual data structure look like on disk?
>>
>> Something like a surrogate docs log file
>>
>> <rowCount><<int><int>>**rowCount
>>
>> a fixed-width table, each row mapping a deleted doc-id to its "surrogate"
>> doc-id. The mapping entries are not sorted; it's a log file. If 2
>> entries reference the
>> same deleted doc-id, the last one wins. The <rowCount> header makes the
>> structure self-delimiting, and ensures clean writes (perhaps using a byte-size
>> keystone).
>
> Got it.  You'd presumably have to add a generation to this file, so
> that multiple sessions of updates + commit write to private files
> ("write once")?  And then the reader merges all of them.
>
>>> And what
>>> would be loaded into RAM such that eg enumerating a postings lists
>>> would work correctly?  You'd have to remap docIDs on the fly, right?
>>
>> Yes, on the fly. I think it boils down to 3 tasks:
>>
>> 1. Map "view" doc-ids to surrogate doc-ids. Supports input, e.g. referring
>>  to a doc by id.
>> 2. Map surrogate doc-ids to "view" doc-ids. Supports output.
>> 3. Re-sort postings quickly on output, and provide correct
>> TermDocs.skipTo() semantics.
>>
>> For (1), I think an unordered HashMap<Integer,Integer> is good enough.
>> For (2) and (3), something like a TreeMap<Integer,Integer> I imagine should be
>> good enough too.  The sorted order of its keys (surrogate doc-ids)
>> should also allow
>> us to intersect the set of surrogate docs quickly with the already
>> sorted outbound
>> postings data, for example.
>
> OK though for an index with many documents, that's gonna use up alot
> of RAM, especially the Integer overhead.  Though, these will be sparse
> right?  So it only uses RAM for docs that have updates, and when
> segment merging hasn't merged them away.
>
>> Both maps would be built by replaying the surrogate docs log file.
>
> It sounds like this'd require the full posting list for a given term X
> to be loaded into RAM, mapped, and sorted, before the caller can
> actually pull the first docID, right?  I guess often this is likely an
> acceptable cost, since "usually" the fields you update are smallish.
>
> Thinking out loud... I wonder if, instead of deferring the mapping
> until search time (which is costly since every search must re-do it),
> we could do the mapping at indexing time?
>
> Say we add an IndexWriter.updateDocumentFields(Term, Document) method,
> which will update only the specified fields.  The Term must uniquely
> refer to 1 existing doc in the index.  On flush, we resolve that Term
> -> docID (we do this already, to apply deletions), and then we write
> to a new set of "delta postings" files using the correct docID.  Then
> the reader would have to merge these postings files when reading.
> We'd also have generations...
>
>> Maybe I should first try to bang out a prototype that works at the
>> index level, not the
>> segment level?
>
> Sounds great!
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44575-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 18 09:48:20 2010
Return-Path: <java-user-return-44575-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26319 invoked from network); 18 Jan 2010 09:48:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Jan 2010 09:48:20 -0000
Received: (qmail 56998 invoked by uid 500); 18 Jan 2010 09:48:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56926 invoked by uid 500); 18 Jan 2010 09:48:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56909 invoked by uid 99); 18 Jan 2010 09:48:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 09:48:17 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [202.86.5.88] (HELO smtp101.mail.in.yahoo.com) (202.86.5.88)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 18 Jan 2010 09:48:07 +0000
Received: (qmail 13122 invoked from network); 18 Jan 2010 09:47:43 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=5anJzr+py7Rj+g4iVXiTtDnNn7RvQU+kBv7ei3MvqaSyydel33/X5qkwGgLUmbmnlSfuWXpmhGcS3xGbX9vFiLoR+IezXXautFbWlaqVFvp+iMh+YZ2UjEP/G5gFFT+a7iQsSAxkSUjpjjTVI39uamEZ5IsmWJc7OhUbL1sO0XM=  ;
Received: from  (emailgane@203.98.194.130 with login)
        by smtp101.mail.in.yahoo.com with SMTP; 18 Jan 2010 15:17:42 +0530 IST
X-Yahoo-SMTP: JObyHkuswBBrNSLZp.Ycd7Boqpr_GQ--
X-YMail-OSG: fTr_VnQVM1lbimQhGgCpp3ijLA_fyA04rep6s_cNqpH3k52h8MfFP4eQ8lUWpCJEWpaqVHM6h4GdeoUYhjg3.LSvn5uO0QgW.usODfKO8Ihwa4yZGHlQeiSx_UMC5741r5EZK7QrpSCmWfamrASiYxd6a3DdpXnzEXj5p70lGU2uDamU5ysXY4Zf.iW4ld_09taYrD.n
X-Yahoo-Newman-Property: ymail-3
Message-ID: <5BE842FD3A27402EAD4917104DD210FA@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Subject: Reusing Document and Field objects
Date: Mon, 18 Jan 2010 15:17:37 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.5843
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all,

I am indexing millions of documents. The app is single threaded. I need =
to create Document and Fields objects repeatedly. I have a thought to =
create it once and reuse by setting the field values to null.=20

Is this advisable, Will it give any performance improvement?

Regards
Ganesh

  
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44576-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 18 10:06:05 2010
Return-Path: <java-user-return-44576-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34872 invoked from network); 18 Jan 2010 10:06:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Jan 2010 10:06:05 -0000
Received: (qmail 82096 invoked by uid 500); 18 Jan 2010 10:06:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82043 invoked by uid 500); 18 Jan 2010 10:06:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82032 invoked by uid 99); 18 Jan 2010 10:06:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 10:06:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 10:05:55 +0000
Received: by yxe30 with SMTP id 30so2571565yxe.29
        for <java-user@lucene.apache.org>; Mon, 18 Jan 2010 02:05:33 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.88.1 with SMTP id q1mr5188807ybl.22.1263809133589; Mon, 18 
	Jan 2010 02:05:33 -0800 (PST)
In-Reply-To: <5BE842FD3A27402EAD4917104DD210FA@sv.us.sonicwall.com>
References: <5BE842FD3A27402EAD4917104DD210FA@sv.us.sonicwall.com>
Date: Mon, 18 Jan 2010 05:05:33 -0500
Message-ID: <9ac0c6aa1001180205g53a8408fk73131ad215fc9494@mail.gmail.com>
Subject: Re: Reusing Document and Field objects
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

It should give some perf improvement, reducing GC costs.

But you don't need to set field values to null -- just set to the
values of the next doc to index, and index with that.

If your machine has available hardware concurrency, using threads
should give you even more gains.

Mike

On Mon, Jan 18, 2010 at 4:47 AM, Ganesh <emailgane@yahoo.co.in> wrote:
> Hello all,
>
> I am indexing millions of documents. The app is single threaded. I need to create Document and Fields objects repeatedly. I have a thought to create it once and reuse by setting the field values to null.
>
> Is this advisable, Will it give any performance improvement?
>
> Regards
> Ganesh
>
>
> Send instant messages to your online friends http://in.messenger.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44577-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 18 10:10:20 2010
Return-Path: <java-user-return-44577-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36239 invoked from network); 18 Jan 2010 10:10:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Jan 2010 10:10:20 -0000
Received: (qmail 89634 invoked by uid 500); 18 Jan 2010 10:10:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89577 invoked by uid 500); 18 Jan 2010 10:10:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89567 invoked by uid 99); 18 Jan 2010 10:10:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 10:10:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 10:10:11 +0000
Received: by mail-fx0-f210.google.com with SMTP id 2so507630fxm.5
        for <java-user@lucene.apache.org>; Mon, 18 Jan 2010 02:09:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=S9wuMjz/QKqLmIf+TlrN0hpYEPYpPvjQiYWZ9EhQdHQ=;
        b=pSy/4rJ9phHOvIPZqdRskXk/OmhRzExbsCpD/4uU7tTHHzJDTEq8RNzl8iSsUKHbRF
         YbB1Goei3Cq4vQ5AD/c21kI1DNxgqbgDh/ErxFnLO6gGEsA3WGaiZztCdn4ioBqtViie
         rfah9/WjQflKqAHrtD/9j4ld1TLDKld0D/tyM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=m7XSIZUClq8yxqfj63CUmMF5+Vzcn4hJN0rgef46lx8SiJcoRetXTO/tSFwuyvVCRe
         Tw2ZAvbRW9xxhIAQRzB8Rn/QGw/DJnjItpCMB61wUe1Eo/ZCbvQcDvMvzMa0r9aS4mYV
         ywOEwrs1rXaIMItZSoDMKPwAqRCMkda7DELsI=
MIME-Version: 1.0
Received: by 10.223.14.140 with SMTP id g12mr7272470faa.50.1263809391118; Mon, 
	18 Jan 2010 02:09:51 -0800 (PST)
In-Reply-To: <9ac0c6aa1001180205g53a8408fk73131ad215fc9494@mail.gmail.com>
References: <5BE842FD3A27402EAD4917104DD210FA@sv.us.sonicwall.com> 
	<9ac0c6aa1001180205g53a8408fk73131ad215fc9494@mail.gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Mon, 18 Jan 2010 10:09:31 +0000
Message-ID: <8c4e68611001180209k790fb552s38908a5c125949b5@mail.gmail.com>
Subject: Re: Reusing Document and Field objects
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

There's a section on reusing Fields and Documents in
http://wiki.apache.org/lucene-java/ImproveIndexingSpeed.  And lots of
other good tips.


--
Ian.

On Mon, Jan 18, 2010 at 10:05 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> It should give some perf improvement, reducing GC costs.
>
> But you don't need to set field values to null -- just set to the
> values of the next doc to index, and index with that.
>
> If your machine has available hardware concurrency, using threads
> should give you even more gains.
>
> Mike
>
> On Mon, Jan 18, 2010 at 4:47 AM, Ganesh <emailgane@yahoo.co.in> wrote:
>> Hello all,
>>
>> I am indexing millions of documents. The app is single threaded. I need to create Document and Fields objects repeatedly. I have a thought to create it once and reuse by setting the field values to null.
>>
>> Is this advisable, Will it give any performance improvement?
>>
>> Regards
>> Ganesh
>>
>>
>> Send instant messages to your online friends http://in.messenger.yahoo.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44578-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 18 11:42:59 2010
Return-Path: <java-user-return-44578-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64157 invoked from network); 18 Jan 2010 11:42:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Jan 2010 11:42:59 -0000
Received: (qmail 73241 invoked by uid 500); 18 Jan 2010 11:42:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73179 invoked by uid 500); 18 Jan 2010 11:42:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73169 invoked by uid 99); 18 Jan 2010 11:42:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 11:42:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 11:42:50 +0000
Received: by yxe30 with SMTP id 30so2623841yxe.29
        for <java-user@lucene.apache.org>; Mon, 18 Jan 2010 03:42:29 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.119.10 with SMTP id r10mr5298018ybc.341.1263814948718; 
	Mon, 18 Jan 2010 03:42:28 -0800 (PST)
In-Reply-To: <b0f7deba1001172135y68f0fb03m3856c072ccacb83c@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
	 <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
	 <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
	 <b0f7deba1001172135y68f0fb03m3856c072ccacb83c@mail.gmail.com>
Date: Mon, 18 Jan 2010 06:42:28 -0500
Message-ID: <9ac0c6aa1001180342l43ba741bhf187393cdbfc755f@mail.gmail.com>
Subject: Re: incremental document field update
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

On Mon, Jan 18, 2010 at 12:35 AM, Babak Farhang <farhang@gmail.com> wrote:

>> Got it.  You'd presumably have to add a generation to this file, so
>> that multiple sessions of updates + commit write to private files
>> ("write once")?  And then the reader merges all of them.
>
> Actually, I hadn't considered concurrent update/commit semantics;
> I was thinking more along a single writer / many readers model..
> Concurrent update is an altogether different beast than concurrent
> add semantics, and I was hoping to avoid complexity.

This isn't about concurrency (we should just keep single writer +
multiple readers model).

This is about multiple sessions with the writer.  Ie, open writer,
update a few docs, close.  Do the same again, but, that 2nd session
cannot overwrite the same files from the first one, since readers may
have those files open.  The "write once" model gives Lucene its
transactional semantics, too -- we can keep multiple commits in the
index, open an arbitrary commit, rollback, etc.

Each newly written file only has the updates from that one session,
so write cost is in proportion to how much updating you did in that
one session.

>> It sounds like this'd require the full posting list for a given term X
>> to be loaded into RAM, mapped, and sorted, before the caller can
>> actually pull the first docID, right?  I guess often this is likely an
>> acceptable cost, since "usually" the fields you update are smallish.
>
> I was thinking, for large posting lists, we can avoid loading the entire
> list into RAM in most cases. Given that we have a sorted set of mapped
> surrogate doc-ids (the key-set in the TreeMap), we should be able to
> search any surrogate doc-ids that need to be mapped in the underlying
> posting list using judicious calls to skipTo() on the underlying TermDocs.
> (This is just like an efficient implementation of finding the intersection
> of 2 sorted arrays of integers: the performance is linear in the size of
> the shortest array, and often, not all the elements of the shorter array
> need even be examined.)
>
> So when the
> [Filter]TermDocs instance is first positioned to a term, it first gathers
> the to-be-mapped (surrogate) doc-ids in a sorted list (hopefully a small
> subset of postings list), then maps these to their "view" ids in a separate
> list, and finally sorts this list of mapped "view" ids. So one list contains
> the (sorted) doc-ids that must be removed from the underlying posting
> list, and another contains the (sorted) doc-ids that must be interleaved
> into the postings.  Using these two lists, we should be able implement
> a proper view of the postings.

Ahhh I see.  Nice!

>> Thinking out loud... I wonder if, instead of deferring the mapping
>> until search time (which is costly since every search must re-do it),
>> we could do the mapping at indexing time?
>>
>> Say we add an IndexWriter.updateDocumentFields(Term, Document) method,
>
> This method name/signature/semantics much better than
> the one I proposed..
>
>> which will update only the specified fields.  The Term must uniquely
>> refer to 1 existing doc in the index.  On flush, we resolve that Term
>> -> docID (we do this already, to apply deletions), and then we write
>> to a new set of "delta postings" files using the correct docID.  Then
>> the reader would have to merge these postings files when reading.
>
> [Thinking out loud too] Interesting. So instead of rewriting the entire
> slave segment on update we rewrite things like the "delta postings"
> files on committing an update?
>
> I'm thinking this approach would probably best work on "batch"
> update/commits.

It should work well for single doc updates as well, ie, its net
indexing cost is also in proportion to the number of updated fields.
It's just that it does the remapping once (during indexing) instead of
during searching.

> If on the other hand the use case is a sequence of N single-doc
> update/commits, then the total cost of the N updates would likely
> approach O(N**2) -- <N rewrites> * <avg delta postings file size = O(N)>
> So as ever, there are tradeoffs.

I think both approaches are O(total size of updates) in indexing cost,
assuming each writes only the new changes, to a new generation
filename.

But I think at search time the "remap during indexing" approach should
simpler, since you "just" have to OR together N posting lists... and
performance should be better (by a constant factor) since there's no
remapping.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44579-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 18 14:08:08 2010
Return-Path: <java-user-return-44579-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16886 invoked from network); 18 Jan 2010 14:08:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 18 Jan 2010 14:08:08 -0000
Received: (qmail 44887 invoked by uid 500); 18 Jan 2010 14:08:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44809 invoked by uid 500); 18 Jan 2010 14:08:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44792 invoked by uid 99); 18 Jan 2010 14:08:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 14:08:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of illes.solt@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 18 Jan 2010 14:07:57 +0000
Received: by ey-out-2122.google.com with SMTP id d26so843362eyd.3
        for <java-user@lucene.apache.org>; Mon, 18 Jan 2010 06:07:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type
         :content-transfer-encoding;
        bh=X+vw1fKjJ+wN67YeTUrSYzCkw4s5WuuDYYYF6qjy8OI=;
        b=gPcyWRvQ6Nss2UPobXNENjjf3LpLr10y7Kn7HM2EwIlGF/Dl81cZ8Ol5TjeOJp8LrQ
         widQrde9EVOKm7zu622cGKjmNPpglvfqb5O8NBsM8I8bcUA74M/J/bPOxiL11zDkuvoN
         DoR/n/km2K7wjmbN2Wy6EtElq+nu2z9v0Bwfg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type:content-transfer-encoding;
        b=o/DddBQ5DYLK5EwW1/xLM2MHj46/YNr/KAw9QB712DSkpYPbzsglcHyDV11XznBhlJ
         GMNhrRP9adWnRCn/PjQvnVelidSMPNpB014Zp+5pbhmwFo4DZ85pXrIJ5+L6w7VVLz+c
         36gIHfSekybTVmILiGoqBQJ+cZGjQq+thffyw=
Received: by 10.213.38.147 with SMTP id b19mr4747032ebe.86.1263823656859;
        Mon, 18 Jan 2010 06:07:36 -0800 (PST)
Received: from ?192.168.24.110? ([72.14.240.163])
        by mx.google.com with ESMTPS id 16sm877149ewy.2.2010.01.18.06.07.36
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 18 Jan 2010 06:07:36 -0800 (PST)
Message-ID: <4B546B27.5090603@gmail.com>
Date: Mon, 18 Jan 2010 15:07:35 +0100
From: =?ISO-8859-1?Q?=22Solt=2C_Ill=E9s=22?= <illes.solt@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: unique term identifiers
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

 I am looking for a way to represent term frequency data in a vector 
space, thus using unique integer identifiers instead of string. This 
would allow feeding tools like LIBSVM from a Lucene index.

 A small example: TermFreqVector.toString() produces "{TITLE: one/3, 
two/4}". What I am looking for is "1:3 2:4", where 1 and 2 are arbitrary 
identifiers, sortedness is not an issue.

 The task can obviously be solved using some java Map, but it should be 
less efficient then using native Lucene methods.

 I am using 2.9.1, my index can be considered constant.


Thanks,
Illes Solt



 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44580-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 06:33:27 2010
Return-Path: <java-user-return-44580-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90838 invoked from network); 19 Jan 2010 06:33:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 06:33:27 -0000
Received: (qmail 22665 invoked by uid 500); 19 Jan 2010 06:33:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22475 invoked by uid 500); 19 Jan 2010 06:33:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22464 invoked by uid 99); 19 Jan 2010 06:33:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 06:33:24 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of farhang@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 06:33:16 +0000
Received: by ewy25 with SMTP id 25so60131ewy.5
        for <java-user@lucene.apache.org>; Mon, 18 Jan 2010 22:32:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=jFruG3MwJep7TVCG0Ixc1SxUctlW476cksH+qlTL6F0=;
        b=JdnxVG7goHFUjc0d6Dgvn1mrnIaP6GJKJgXzN6YirhaL1EXq/1WzmOSsqhJ3MlcYzC
         cw4pFOlvCaAU32OlNVK94Fw+pXCm2irmRpf6hR1lx/DXJmNcWh/vs8LpnH3c7QmZJnYK
         tSFcD4toxeRg+sXi7K1JnZEXDeG3TJ5yjNw0o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=x4qEVNobL4AM/cSaPKxOPx/UtrvExo3/V2Hw6Ve/4wR5kZpG+OS2DF11iCKiJ+PUNs
         LiD8gUfkHZ/aA/PZKjfl5hyLbvXQe7AnujIE+L3i9JmB+UAjHReEkGi+3QMLIZ27wwIA
         JM1OKTEO0aaJwbd564FAYqBY4O/outNvnXNtQ=
MIME-Version: 1.0
Received: by 10.216.89.149 with SMTP id c21mr2589369wef.224.1263882776330; 
	Mon, 18 Jan 2010 22:32:56 -0800 (PST)
In-Reply-To: <9ac0c6aa1001180342l43ba741bhf187393cdbfc755f@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
	 <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
	 <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
	 <b0f7deba1001172135y68f0fb03m3856c072ccacb83c@mail.gmail.com>
	 <9ac0c6aa1001180342l43ba741bhf187393cdbfc755f@mail.gmail.com>
Date: Mon, 18 Jan 2010 23:32:56 -0700
Message-ID: <b0f7deba1001182232o227615e7t7e40bfe7ac9d617d@mail.gmail.com>
Subject: Re: incremental document field update
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

> This is about multiple sessions with the writer.  Ie, open writer,
> update a few docs, close.  Do the same again, but, that 2nd session
> cannot overwrite the same files from the first one, since readers may
> have those files open.  The "write once" model gives Lucene its
> transactional semantics, too -- we can keep multiple commits in the
> index, open an arbitrary commit, rollback, etc.

Ahh, I see. We're worried about the read-consistency of the open readers
while there is a concurrent writer. I think that's already taken care of with
the fact that under the hood we are only appending data into the logical
segment.  When a reader first loads one of our slave segments, it first
loads into memory the number of entries in the right-ahead log of mapped
doc-ids before reading those number of entries from the log. It could note
the max unmapped document number represented in the last entry and
discard any document numbers above that max in the postings.

> I think both approaches are O(total size of updates) in indexing cost,
> assuming each writes only the new changes, to a new generation
> filename.
>
> But I think at search time the "remap during indexing" approach should
> simpler, since you "just" have to OR together N posting lists... and
> performance should be better (by a constant factor) since there's no
> remapping.

I think I see how this approach can work for indexed-only fields. I imagine
we also need a parallel dictionary for these mapped postings lists in order
to deal with new terms encountered during the update. Not sure how this
would work. Can you elaborate?

And how would we deal with updated stored fields?

-Babak

On Mon, Jan 18, 2010 at 4:42 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> On Mon, Jan 18, 2010 at 12:35 AM, Babak Farhang <farhang@gmail.com> wrote:
>
>>> Got it.  You'd presumably have to add a generation to this file, so
>>> that multiple sessions of updates + commit write to private files
>>> ("write once")?  And then the reader merges all of them.
>>
>> Actually, I hadn't considered concurrent update/commit semantics;
>> I was thinking more along a single writer / many readers model..
>> Concurrent update is an altogether different beast than concurrent
>> add semantics, and I was hoping to avoid complexity.
>
> This isn't about concurrency (we should just keep single writer +
> multiple readers model).
>
> This is about multiple sessions with the writer.  Ie, open writer,
> update a few docs, close.  Do the same again, but, that 2nd session
> cannot overwrite the same files from the first one, since readers may
> have those files open.  The "write once" model gives Lucene its
> transactional semantics, too -- we can keep multiple commits in the
> index, open an arbitrary commit, rollback, etc.
>
> Each newly written file only has the updates from that one session,
> so write cost is in proportion to how much updating you did in that
> one session.
>
>>> It sounds like this'd require the full posting list for a given term X
>>> to be loaded into RAM, mapped, and sorted, before the caller can
>>> actually pull the first docID, right?  I guess often this is likely an
>>> acceptable cost, since "usually" the fields you update are smallish.
>>
>> I was thinking, for large posting lists, we can avoid loading the entire
>> list into RAM in most cases. Given that we have a sorted set of mapped
>> surrogate doc-ids (the key-set in the TreeMap), we should be able to
>> search any surrogate doc-ids that need to be mapped in the underlying
>> posting list using judicious calls to skipTo() on the underlying TermDocs.
>> (This is just like an efficient implementation of finding the intersection
>> of 2 sorted arrays of integers: the performance is linear in the size of
>> the shortest array, and often, not all the elements of the shorter array
>> need even be examined.)
>>
>> So when the
>> [Filter]TermDocs instance is first positioned to a term, it first gathers
>> the to-be-mapped (surrogate) doc-ids in a sorted list (hopefully a small
>> subset of postings list), then maps these to their "view" ids in a separate
>> list, and finally sorts this list of mapped "view" ids. So one list contains
>> the (sorted) doc-ids that must be removed from the underlying posting
>> list, and another contains the (sorted) doc-ids that must be interleaved
>> into the postings.  Using these two lists, we should be able implement
>> a proper view of the postings.
>
> Ahhh I see.  Nice!
>
>>> Thinking out loud... I wonder if, instead of deferring the mapping
>>> until search time (which is costly since every search must re-do it),
>>> we could do the mapping at indexing time?
>>>
>>> Say we add an IndexWriter.updateDocumentFields(Term, Document) method,
>>
>> This method name/signature/semantics much better than
>> the one I proposed..
>>
>>> which will update only the specified fields.  The Term must uniquely
>>> refer to 1 existing doc in the index.  On flush, we resolve that Term
>>> -> docID (we do this already, to apply deletions), and then we write
>>> to a new set of "delta postings" files using the correct docID.  Then
>>> the reader would have to merge these postings files when reading.
>>
>> [Thinking out loud too] Interesting. So instead of rewriting the entire
>> slave segment on update we rewrite things like the "delta postings"
>> files on committing an update?
>>
>> I'm thinking this approach would probably best work on "batch"
>> update/commits.
>
> It should work well for single doc updates as well, ie, its net
> indexing cost is also in proportion to the number of updated fields.
> It's just that it does the remapping once (during indexing) instead of
> during searching.
>
>> If on the other hand the use case is a sequence of N single-doc
>> update/commits, then the total cost of the N updates would likely
>> approach O(N**2) -- <N rewrites> * <avg delta postings file size = O(N)>
>> So as ever, there are tradeoffs.
>
> I think both approaches are O(total size of updates) in indexing cost,
> assuming each writes only the new changes, to a new generation
> filename.
>
> But I think at search time the "remap during indexing" approach should
> simpler, since you "just" have to OR together N posting lists... and
> performance should be better (by a constant factor) since there's no
> remapping.
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44581-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 10:48:59 2010
Return-Path: <java-user-return-44581-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80559 invoked from network); 19 Jan 2010 10:48:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 10:48:59 -0000
Received: (qmail 84449 invoked by uid 500); 19 Jan 2010 10:48:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84369 invoked by uid 500); 19 Jan 2010 10:48:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84359 invoked by uid 99); 19 Jan 2010 10:48:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 10:48:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 10:48:50 +0000
Received: by yxe30 with SMTP id 30so556690yxe.29
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 02:48:29 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.238.4 with SMTP id l4mr4806053ybh.128.1263898109355; Tue, 
	19 Jan 2010 02:48:29 -0800 (PST)
In-Reply-To: <b0f7deba1001182232o227615e7t7e40bfe7ac9d617d@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001140127y5504e16fjf4a406710d1201fa@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
	 <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
	 <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
	 <b0f7deba1001172135y68f0fb03m3856c072ccacb83c@mail.gmail.com>
	 <9ac0c6aa1001180342l43ba741bhf187393cdbfc755f@mail.gmail.com>
	 <b0f7deba1001182232o227615e7t7e40bfe7ac9d617d@mail.gmail.com>
Date: Tue, 19 Jan 2010 05:48:29 -0500
Message-ID: <9ac0c6aa1001190248g2e952aabpa97d47637adeb22e@mail.gmail.com>
Subject: Re: incremental document field update
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Tue, Jan 19, 2010 at 1:32 AM, Babak Farhang <farhang@gmail.com> wrote:
>> This is about multiple sessions with the writer. =A0Ie, open writer,
>> update a few docs, close. =A0Do the same again, but, that 2nd session
>> cannot overwrite the same files from the first one, since readers may
>> have those files open. =A0The "write once" model gives Lucene its
>> transactional semantics, too -- we can keep multiple commits in the
>> index, open an arbitrary commit, rollback, etc.
>
> Ahh, I see. We're worried about the read-consistency of the open readers
> while there is a concurrent writer. I think that's already taken care of =
with
> the fact that under the hood we are only appending data into the logical
> segment. =A0When a reader first loads one of our slave segments, it first
> loads into memory the number of entries in the right-ahead log of mapped
> doc-ids before reading those number of entries from the log. It could not=
e
> the max unmapped document number represented in the last entry and
> discard any document numbers above that max in the postings.

I see -- so your file format allows you to append to the same file
without affecting prior readers?  We never do that in Lucene today
(all files are "write once").

>> I think both approaches are O(total size of updates) in indexing cost,
>> assuming each writes only the new changes, to a new generation
>> filename.
>>
>> But I think at search time the "remap during indexing" approach should
>> simpler, since you "just" have to OR together N posting lists... and
>> performance should be better (by a constant factor) since there's no
>> remapping.
>
> I think I see how this approach can work for indexed-only fields. I imagi=
ne
> we also need a parallel dictionary for these mapped postings lists in ord=
er
> to deal with new terms encountered during the update. Not sure how this
> would work. Can you elaborate?
>
> And how would we deal with updated stored fields?

Good questions (terms dict & stored fields) -- I think what we'd do is
simply write a new segment, so stored fields, term vectors, postings,
terms dict, etc., are all private to that new segment.  But, we'd mark
the segment as being a delta segment, referencing the original
segment, and we'd remap the docIDs when flushing that segment.  Then
at search time, a single SegmentReader would open its primary segment
plus any series of delta segments, merging them.

So eg StoredFieldsReader would first load the doc from the primary
segment, then go and load any deltas, overwriting the field values.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44582-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 11:51:10 2010
Return-Path: <java-user-return-44582-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95753 invoked from network); 19 Jan 2010 11:51:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 11:51:10 -0000
Received: (qmail 35170 invoked by uid 500); 19 Jan 2010 11:51:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35104 invoked by uid 500); 19 Jan 2010 11:51:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35094 invoked by uid 99); 19 Jan 2010 11:51:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 11:51:08 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of arosenschein@gmail.com designates 209.85.222.173 as permitted sender)
Received: from [209.85.222.173] (HELO mail-pz0-f173.google.com) (209.85.222.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 11:51:00 +0000
Received: by pzk3 with SMTP id 3so579570pzk.20
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 03:50:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=TiMl4WI4NS9pZpCpg8PU3GWkTsgyvjHxvcc5VvEqlkM=;
        b=DVUsQB0DAVuDllm8kd9zq8ljA7cRmrWTTa2avSXBeM8FZ8GoUgsnNClR1MBNbN47CP
         opA/uOlGQWuAIhpb+do9zW+IV3uhuDIC3QfDALldhuv6KXTa8i/hPohkMPdrYAXvm6n4
         y0x0eRY45G0i4EitySTD2VAGsfYlsD3TETWOw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=LmtATrPC5ox/LKbo6ebtJd77XoyHCTnrQArn8p7iCmWf/HD7JujO9AsaubjHZ8lbjQ
         f+SXy2/QfJWQudb4OPGEluALc4XZSAIUZOcnD3TRIRdNQHYUUGV3Bv8vsau+ywBk8j4F
         +F2kIxo5kxreagUaYZEmM/4yHGfkQMggJ64Fo=
MIME-Version: 1.0
Received: by 10.140.55.12 with SMTP id d12mr541604rva.233.1263901838970; Tue, 
	19 Jan 2010 03:50:38 -0800 (PST)
Date: Tue, 19 Jan 2010 13:50:38 +0200
Message-ID: <698f0de11001190350td6f07e4gff36264231bcd47d@mail.gmail.com>
Subject: PhraseQuery with term positions
From: Avi Rosenschein <arosenschein@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0050450294be248f95047d831453
X-Virus-Checked: Checked by ClamAV on apache.org

--0050450294be248f95047d831453
Content-Type: text/plain; charset=UTF-8

Hi,

I am using PhraseQuery with explicitly set term positions and slop=0, in
order to skip stop words. The field in my index is indexed with TermVector
positions.

When I do a query with stop words skipped, for example "internet for
research" (translated into PhraseQuery: "internet ? research"), I am getting
results with non-stop words as well as stop words, where the stop word
should be (e.g. "internet related research").

Is this expected behavior? If so, is there any way to do what I want, which
is for the query to match only results like "internet [stop-word] research"?

Thanks,
-- Avi

--0050450294be248f95047d831453--

From java-user-return-44583-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 12:57:58 2010
Return-Path: <java-user-return-44583-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20781 invoked from network); 19 Jan 2010 12:57:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 12:57:57 -0000
Received: (qmail 98772 invoked by uid 500); 19 Jan 2010 12:57:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98717 invoked by uid 500); 19 Jan 2010 12:57:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98707 invoked by uid 99); 19 Jan 2010 12:57:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 12:57:55 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [217.12.10.244] (HELO web26207.mail.ukl.yahoo.com) (217.12.10.244)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 19 Jan 2010 12:57:45 +0000
Received: (qmail 21147 invoked by uid 60001); 19 Jan 2010 12:57:23 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.de; s=s1024; t=1263905843; bh=tSsduyqw3Lhrm2VVsV2CQnBY/Cit9Va171eAPwFQfYY=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=k6iBakNvsRm4t1TnvGXsfyrm9y6XW3q6Kafaior+IvzVXJ0m4O73gxmoih3WQSxLnbBaFZYS655AnZjnuz/jiz43ygE9ManT+Gz1e35xDDic3H3f9LGvH+Ry53SupWG0In9LwpYj6nUEGZ9fvVobNcyHbjN/GPTFUzy8TlcSj2E=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.de;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=xrsk2fc/swruQRGDhg8e05NEO1OG5odrBGWrp1xiuMQGOP3omhybkLpyFepKlUmLRB3lobuWI90Bm6HnthEYtMS7NFchGiATZOv1+UusY6gfakD5zKwmO2IX/kcHQwOAr7E6V+CB/fOeKsYWjch3kdUit/nveqSkPCf6ipz8cWs=;
Message-ID: <519013.21144.qm@web26207.mail.ukl.yahoo.com>
X-YMail-OSG: 45EYh2oVM1kzBPdNMv10CEaLNXpB5NI9V1.WNerLDxfCoPrfSOuS.7jlkTBQxSCVt.xdUXFrRBDRezIypFkxf_Nrg6773c6EEUsT7NNPLafmSLQlXoj67VRbUHXBkkZVJqZQPpTmnF2gPl.kDDosWTKXxaFg7cxjwsV77t6c9Oa0eJCcJiqZ9cA60aLkyIJEbUOxBteAng61Tmj6JYMF7TetD6YN0q.06gDSir2yay3AwQQEURkyld9rVYS1v5Zo9zvCW8BGYi_vW_MaRYZ3iO2peT_QOGmtVO3n0D0Kyq.Sj0Ry73lJGzLn4UasLQ--
Received: from [10.2.3.51] by web26207.mail.ukl.yahoo.com via HTTP; Tue, 19 Jan 2010 12:57:23 GMT
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Tue, 19 Jan 2010 12:57:23 +0000 (GMT)
From: Anna Hunecke <annahunecke@yahoo.de>
Subject: Indexing and Searching linked files
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi!
I have been working with Lucene for a while now. So far, I found helpful ti=
ps on this list, so I hope somebody can help me with my problem:

In our app information is grouped in so-called cards. Now, it should be mad=
e possible to also search on files linked to the cards. You can link arbitr=
arily many files to a card and the size of the files is also not restricted=
.
So, as far as I can see, there are two ways to do this:

1. Add the content of the files to the search index of the card. First, I t=
hought that I could just have an additional field in the index which contai=
ns the content of all the files. But then, if the files are very big, I cou=
ld hit the field size limit, and would possibly not get the content of all =
files indexed. So, I would need one field per file. The problem I have then=
 is that I don't know how many files I have and how large the index would g=
et. This is risky, because some customers have a lot of data.

2. Create a separate index for files. The documents in this index would con=
tain one file each, so I would not have the problem that I don't know how m=
any fields I have. But then, the searching is a problem:
I would need to search on both the card and the document index, and somehow=
 merge the results together. I sort by score always, but, as I understand i=
t, the scores of the results of two different indexes are not comparable.

So, which way do you think is better?

Best,
Anna=0A=0A__________________________________________________=0ADo You Yahoo=
!?=0ASie sind Spam leid? Yahoo! Mail verf=FCgt =FCber einen herausragenden =
Schutz gegen Massenmails. =0Ahttp://mail.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44584-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 13:29:25 2010
Return-Path: <java-user-return-44584-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32923 invoked from network); 19 Jan 2010 13:29:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 13:29:25 -0000
Received: (qmail 42763 invoked by uid 500); 19 Jan 2010 13:29:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42670 invoked by uid 500); 19 Jan 2010 13:29:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42654 invoked by uid 99); 19 Jan 2010 13:29:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 13:29:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.78.26 as permitted sender)
Received: from [74.125.78.26] (HELO ey-out-2122.google.com) (74.125.78.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 13:29:16 +0000
Received: by ey-out-2122.google.com with SMTP id d26so1115653eyd.3
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 05:28:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=iiT75Yo/iN2mwqlZEdCW/rsY9V8yAk2+w5ea+CUCDCQ=;
        b=eJHwgAW+xEw4Ji76gldGuycjsYpcpWwMSVUb3gSz0ILDSa7H5RfPDMlHTkrABslhsk
         OD6xr7rrlXPdjEA0wbc1I0f4zuA6LzrJXVmRBTdXcoaGl1/2IqIy4CqH8oGQCIVxAtB6
         xmakYf0Z0jH4mEoMYteMR+L5pN5nxhjIoLXXs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=wXEhtXENjPjfh9DYcqoZJqWRhnK78MNMhYBX2gqoMoPg0OGfIDxzwuymdMS48b0xPI
         v9TzfYuZq42iMLMGLQhAoM6xonu1ieApxVM6uoU8D4gw3pSaeJOmmiOnd1sEFocF3lxY
         WgSXG4iMpv9u1dU3byx/2gf5ACzl7jH3EkzEM=
MIME-Version: 1.0
Received: by 10.216.90.15 with SMTP id d15mr2803926wef.219.1263907735034; Tue, 
	19 Jan 2010 05:28:55 -0800 (PST)
In-Reply-To: <698f0de11001190350td6f07e4gff36264231bcd47d@mail.gmail.com>
References: <698f0de11001190350td6f07e4gff36264231bcd47d@mail.gmail.com>
Date: Tue, 19 Jan 2010 08:28:53 -0500
Message-ID: <359a92831001190528y7ab5bcf0n133d9eb655e2bd75@mail.gmail.com>
Subject: Re: PhraseQuery with term positions
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d78426935b5a047d8473f6

--0016e6d78426935b5a047d8473f6
Content-Type: text/plain; charset=ISO-8859-1

How big is your index? Because the simplest thing would be
to just not remove stopwords at index or query time. Perhaps
in a duplicate field depending upon your needs.

Erick

On Tue, Jan 19, 2010 at 6:50 AM, Avi Rosenschein <arosenschein@gmail.com>wrote:

> Hi,
>
> I am using PhraseQuery with explicitly set term positions and slop=0, in
> order to skip stop words. The field in my index is indexed with TermVector
> positions.
>
> When I do a query with stop words skipped, for example "internet for
> research" (translated into PhraseQuery: "internet ? research"), I am
> getting
> results with non-stop words as well as stop words, where the stop word
> should be (e.g. "internet related research").
>
> Is this expected behavior? If so, is there any way to do what I want, which
> is for the query to match only results like "internet [stop-word]
> research"?
>
> Thanks,
> -- Avi
>

--0016e6d78426935b5a047d8473f6--

From java-user-return-44585-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 13:39:26 2010
Return-Path: <java-user-return-44585-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38421 invoked from network); 19 Jan 2010 13:39:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 13:39:26 -0000
Received: (qmail 56559 invoked by uid 500); 19 Jan 2010 13:39:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56475 invoked by uid 500); 19 Jan 2010 13:39:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56465 invoked by uid 99); 19 Jan 2010 13:39:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 13:39:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of arosenschein@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 13:39:16 +0000
Received: by pwi11 with SMTP id 11so2564469pwi.5
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 05:38:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=SitCmrtzo+ibpFkaOEqXlLBHHV3bgtVDGcjLlJJUz+Q=;
        b=cpyzFyozUyQUqC7mJEstc7S48ruxoWFDh1fscD/yTZmdvnka7C18sjQAXqo8kf7WLr
         IEQ8O0FeGzB+UWRgqKp/7KnZcHDnTzc5COJdqKxhlAmSZ+lNl3dynF4GXwtmC+FFSxx4
         2hToQB1aKgEZxYZo82euOGvRn3xgsa6T8B0rs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=nZZdBbpCdW/DCACq+1f6WK9f86/B+xM6zsR5akBv8pVMxz5HA50d1pxesDxQEeBWSY
         8qBhnHlb74G3AxxE3plGPfSFOHfnOBGT48Ua4kVM9JRrIDrR99XCBE0Aw/pFD4w9elKD
         sDlay3bk41b456ICORDhtc17UW5uhzyEW/VHQ=
MIME-Version: 1.0
Received: by 10.141.91.5 with SMTP id t5mr3551812rvl.186.1263908335100; Tue, 
	19 Jan 2010 05:38:55 -0800 (PST)
In-Reply-To: <359a92831001190528y7ab5bcf0n133d9eb655e2bd75@mail.gmail.com>
References: <698f0de11001190350td6f07e4gff36264231bcd47d@mail.gmail.com>
	 <359a92831001190528y7ab5bcf0n133d9eb655e2bd75@mail.gmail.com>
Date: Tue, 19 Jan 2010 15:38:55 +0200
Message-ID: <698f0de11001190538y306c72eau3a75b85f82bbb517@mail.gmail.com>
Subject: Re: PhraseQuery with term positions
From: Avi Rosenschein <arosenschein@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd116e857a319047d8497d2
X-Virus-Checked: Checked by ClamAV on apache.org

--000e0cd116e857a319047d8497d2
Content-Type: text/plain; charset=UTF-8

Index is pretty large (50GB, divided into 8 shards). I'm afraid I would
start running into memory issues by adding the stop words (though it is
definitely something I would like to test at some point).

My question was more to try to understand if this was known behavior in
lucene, since I can't really think of a situation where this would be
desired (maybe if the user was knowingly searching for "a
[one-word-wildcard] b"; but a better way to do that would be with slop, not
with term positions). Wouldn't it be better to have the ExactPhraseScorer
not allow unmatched holes (i.e. terms in the document that are not matched
in the query)?

-- Avi

On Tue, Jan 19, 2010 at 3:28 PM, Erick Erickson <erickerickson@gmail.com>wrote:

> How big is your index? Because the simplest thing would be
> to just not remove stopwords at index or query time. Perhaps
> in a duplicate field depending upon your needs.
>
> Erick
>
> On Tue, Jan 19, 2010 at 6:50 AM, Avi Rosenschein <arosenschein@gmail.com
> >wrote:
>
> > Hi,
> >
> > I am using PhraseQuery with explicitly set term positions and slop=0, in
> > order to skip stop words. The field in my index is indexed with
> TermVector
> > positions.
> >
> > When I do a query with stop words skipped, for example "internet for
> > research" (translated into PhraseQuery: "internet ? research"), I am
> > getting
> > results with non-stop words as well as stop words, where the stop word
> > should be (e.g. "internet related research").
> >
> > Is this expected behavior? If so, is there any way to do what I want,
> which
> > is for the query to match only results like "internet [stop-word]
> > research"?
> >
> > Thanks,
> > -- Avi
> >
>

--000e0cd116e857a319047d8497d2--

From java-user-return-44586-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 13:44:25 2010
Return-Path: <java-user-return-44586-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40843 invoked from network); 19 Jan 2010 13:44:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 13:44:25 -0000
Received: (qmail 64435 invoked by uid 500); 19 Jan 2010 13:44:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64374 invoked by uid 500); 19 Jan 2010 13:44:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64364 invoked by uid 99); 19 Jan 2010 13:44:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 13:44:23 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 74.125.78.27 as permitted sender)
Received: from [74.125.78.27] (HELO ey-out-2122.google.com) (74.125.78.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 13:44:14 +0000
Received: by ey-out-2122.google.com with SMTP id d26so1119237eyd.3
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 05:43:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=p+83NLFHJIo3epQnPPATZzfMDj5jEhKDLG62ojaiCEg=;
        b=LnjnP0uagH1/DrvB4RpfLuLfdqhbuxtLA+IgRjR2avT2vcFT3fO6JyJr5JiRRj3QQD
         SajMy11AstfWSeG91DcxVTvrOVMpu6YxO7lgV7dOyMB0fN8cvHjjwryB90EbzLMx6vzC
         QAmTgOnWFWihDQHwQ0jRUP0+iK5dpN+wQveO0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ppUVvG+bikUpAzLkdx26AwSVPQlBdahN5L2FE8fLk7mdJl30juD/cSZAIq0JuPnYsh
         17aSPGvioSh433Z5arnk4Tha0r1jkTEN2WERn7s8C8SRs1XLVqhGMFvajMGeA5Snl4rO
         vYwKwaYUZRL3Xl/AY1kibat9llIzu2mi1Qt2M=
MIME-Version: 1.0
Received: by 10.216.87.16 with SMTP id x16mr2447283wee.106.1263908634519; Tue, 
	19 Jan 2010 05:43:54 -0800 (PST)
In-Reply-To: <519013.21144.qm@web26207.mail.ukl.yahoo.com>
References: <519013.21144.qm@web26207.mail.ukl.yahoo.com>
Date: Tue, 19 Jan 2010 08:43:54 -0500
Message-ID: <359a92831001190543t4b5375c8y209e1180862c4dd6@mail.gmail.com>
Subject: Re: Indexing and Searching linked files
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6dab150306951047d84a906
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6dab150306951047d84a906
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

What field size limit are you talking about here? Because 10,000
tokens is the default, but you can increase it to Integer.MAX_VALUE.

So are you really talking billions of tokens here? Your index
quickly becomes unmanageable if you're allowing it to grow
by such increments.

One can argue, IMO, that the first N (10M, say) tokens/file is
"enough" and there's not much real value in the rest, but that
can be a weak argument depending on the problem space....

But if you're really committed to indexing an unbounded number
of arbitrarily large files...you'll fail. Sometime, somewhere, somebody
will want to index enough to violate whatever limits you have (disk,
memory, time, whatever). So I think you'd be farther ahead to ask your
product manager what limits are reasonable and go from there...

HTH
Erick

On Tue, Jan 19, 2010 at 7:57 AM, Anna Hunecke <annahunecke@yahoo.de> wrote:

> Hi!
> I have been working with Lucene for a while now. So far, I found helpful
> tips on this list, so I hope somebody can help me with my problem:
>
> In our app information is grouped in so-called cards. Now, it should be
> made possible to also search on files linked to the cards. You can link
> arbitrarily many files to a card and the size of the files is also not
> restricted.
> So, as far as I can see, there are two ways to do this:
>
> 1. Add the content of the files to the search index of the card. First, I
> thought that I could just have an additional field in the index which
> contains the content of all the files. But then, if the files are very bi=
g,
> I could hit the field size limit, and would possibly not get the content =
of
> all files indexed. So, I would need one field per file. The problem I hav=
e
> then is that I don't know how many files I have and how large the index
> would get. This is risky, because some customers have a lot of data.
>
> 2. Create a separate index for files. The documents in this index would
> contain one file each, so I would not have the problem that I don't know =
how
> many fields I have. But then, the searching is a problem:
> I would need to search on both the card and the document index, and someh=
ow
> merge the results together. I sort by score always, but, as I understand =
it,
> the scores of the results of two different indexes are not comparable.
>
> So, which way do you think is better?
>
> Best,
> Anna
>
> __________________________________________________
> Do You Yahoo!?
> Sie sind Spam leid? Yahoo! Mail verf=FCgt =FCber einen herausragenden Sch=
utz
> gegen Massenmails.
> http://mail.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6dab150306951047d84a906--

From java-user-return-44587-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 14:36:29 2010
Return-Path: <java-user-return-44587-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71805 invoked from network); 19 Jan 2010 14:36:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 14:36:28 -0000
Received: (qmail 40346 invoked by uid 500); 19 Jan 2010 14:36:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40293 invoked by uid 500); 19 Jan 2010 14:36:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40283 invoked by uid 99); 19 Jan 2010 14:36:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 14:36:26 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [217.12.10.240] (HELO web26203.mail.ukl.yahoo.com) (217.12.10.240)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 19 Jan 2010 14:36:17 +0000
Received: (qmail 99316 invoked by uid 60001); 19 Jan 2010 14:35:55 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.de; s=s1024; t=1263911755; bh=MGKtvcFT6D1MjpVS03GYTrzuPBsH3Z1Hs53DJNkLrbc=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=rDy+6GBhs4eWkFrQGnsnMTzKMh5HDV2SWLMzjNK9WAWkkB51hfvLRgd/aBQcXnSaPk+b+cRupZe+vLnXH/brt8kXbSiByezsqo7n/8GMfNvg9qjobKE4ky5gXCgZHJc0h1e9UbQeP0SlO+A5C4O9HC0+avM1Qo+uBvwVmJ+rzQE=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.de;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=pJCGdKuvDalgkU4Gjzb2mbr48CJmIrEN9XBBx+Oxwf3142E6k1Mj5HVa3TShBbjl/6qJ0TLDh+QBSYm7BsoaOdPCSgT4+HO5m1xK76MlVON+lG44xqGXO9nMYhsMPkJD7Ou47s3GgNSzwnOPcpQl/hwy4QKv9J/dN98TNO6Sw0M=;
Message-ID: <6839.98888.qm@web26203.mail.ukl.yahoo.com>
X-YMail-OSG: RVvayMMVM1mSYDi8OOm1bj0eAI974ZdnqpoKfxIQSXfmIMIGWXhFrFEq9QsJHO0wvjYU0fW6m_40G01VPAOJXC4gH9Ua9IP3P5GkGxRrGgsTjKkfJ4yzqZe1UGWEIOMtI9dLhnTc5aT6J0kJ.SYMssETApUjchiqzmdU7yhifhBPgTMY0weqCSz_21QTFHNGQV4vBLzc7jp1xi.KZRx8UaMgNiof0Xos1bxb3k.oYBw.xVVgX3f3HDhG0XNx8O9sX9QUd9.r5zsiT4sb3TvKR1W0JUTpsl4wIFZ48Ma8tsLtL2c-
Received: from [10.2.3.51] by web26203.mail.ukl.yahoo.com via HTTP; Tue, 19 Jan 2010 14:35:54 GMT
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Tue, 19 Jan 2010 14:35:54 +0000 (GMT)
From: Anna Hunecke <annahunecke@yahoo.de>
Subject: Re: Indexing and Searching linked files
To: java-user@lucene.apache.org
In-Reply-To: <359a92831001190543t4b5375c8y209e1180862c4dd6@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

The field size is restricted to 1 million tokens, because of the very reaso=
ns you mentioned.
So, even if I have one separate field for the content of a file, I might re=
ach the limit if the file is really big. But I can't help that. What I want=
 to avoid is that the whole content of some files can not be found because =
I used one field for the content of all files and they just could not be ap=
pended anymore.

--- Erick Erickson <erickerickson@gmail.com> schrieb am Di, 19.1.2010:

> Von: Erick Erickson <erickerickson@gmail.com>
> Betreff: Re: Indexing and Searching linked files
> An: java-user@lucene.apache.org
> Datum: Dienstag, 19. Januar 2010, 14:43
> What field size limit are you talking
> about here? Because 10,000
> tokens is the default, but you can increase it to
> Integer.MAX_VALUE.
>=20
> So are you really talking billions of tokens here? Your
> index
> quickly becomes unmanageable if you're allowing it to grow
> by such increments.
>=20
> One can argue, IMO, that the first N (10M, say) tokens/file
> is
> "enough" and there's not much real value in the rest, but
> that
> can be a weak argument depending on the problem space....
>=20
> But if you're really committed to indexing an unbounded
> number
> of arbitrarily large files...you'll fail. Sometime,
> somewhere, somebody
> will want to index enough to violate whatever limits you
> have (disk,
> memory, time, whatever). So I think you'd be farther ahead
> to ask your
> product manager what limits are reasonable and go from
> there...
>=20
> HTH
> Erick
>=20
> On Tue, Jan 19, 2010 at 7:57 AM, Anna Hunecke <annahunecke@yahoo.de>
> wrote:
>=20
> > Hi!
> > I have been working with Lucene for a while now. So
> far, I found helpful
> > tips on this list, so I hope somebody can help me with
> my problem:
> >
> > In our app information is grouped in so-called cards.
> Now, it should be
> > made possible to also search on files linked to the
> cards. You can link
> > arbitrarily many files to a card and the size of the
> files is also not
> > restricted.
> > So, as far as I can see, there are two ways to do
> this:
> >
> > 1. Add the content of the files to the search index of
> the card. First, I
> > thought that I could just have an additional field in
> the index which
> > contains the content of all the files. But then, if
> the files are very big,
> > I could hit the field size limit, and would possibly
> not get the content of
> > all files indexed. So, I would need one field per
> file. The problem I have
> > then is that I don't know how many files I have and
> how large the index
> > would get. This is risky, because some customers have
> a lot of data.
> >
> > 2. Create a separate index for files. The documents in
> this index would
> > contain one file each, so I would not have the problem
> that I don't know how
> > many fields I have. But then, the searching is a
> problem:
> > I would need to search on both the card and the
> document index, and somehow
> > merge the results together. I sort by score always,
> but, as I understand it,
> > the scores of the results of two different indexes are
> not comparable.
> >
> > So, which way do you think is better?
> >
> > Best,
> > Anna
> >
> > __________________________________________________
> > Do You Yahoo!?
> > Sie sind Spam leid? Yahoo! Mail verf=FCgt =FCber einen
> herausragenden Schutz
> > gegen Massenmails.
> > http://mail.yahoo.com
> >
> >
> ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> =0A=0A__________________________________________________=0ADo You Yahoo!?=
=0ASie sind Spam leid? Yahoo! Mail verf=FCgt =FCber einen herausragenden Sc=
hutz gegen Massenmails. =0Ahttp://mail.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44588-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 14:41:43 2010
Return-Path: <java-user-return-44588-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74532 invoked from network); 19 Jan 2010 14:41:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 14:41:43 -0000
Received: (qmail 49389 invoked by uid 500); 19 Jan 2010 14:41:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49303 invoked by uid 500); 19 Jan 2010 14:41:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49293 invoked by uid 99); 19 Jan 2010 14:41:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 14:41:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of trh@midrivers.com designates 216.228.34.54 as permitted sender)
Received: from [216.228.34.54] (HELO waldorf.midrivers.com) (216.228.34.54)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 14:41:29 +0000
Received: from your8dfb31b6e1 (dial-51.r17.mtwgln.infoave.net [216.228.43.60])
	by waldorf.midrivers.com (8.11.6/8.11.6) with SMTP id o0JEf6o25276
	for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 07:41:06 -0700
Message-ID: <023b01ca9915$4f503560$3c2be4d8@your8dfb31b6e1>
Reply-To: "T. R. Halvorson" <trh@midrivers.com>
From: "T. R. Halvorson" <trh@midrivers.com>
To: <java-user@lucene.apache.org>
References: <6839.98888.qm@web26203.mail.ukl.yahoo.com>
Subject: Proximity of More than Single Words?
Date: Tue, 19 Jan 2010 07:40:07 -0700
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="iso-8859-1";
	reply-type=original
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.2670
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.2670
X-Virus-Checked: Checked by ClamAV on apache.org

For proximity expressions, the query parser documentation says, "use the 
tilde, "~", symbol at the end of a Phrase." It gives the example "jakarta 
apache"~10

Does this mean that proximity can only be operated on single words enquoted 
in quotation marks? To clarify the question by comparision, on some systems, 
the w/ proximity operator lets one search for:

crude w/4 "west texas"

or

"spot prices" w/3 "gulf coast"

The Lucene documentation seems to imply that such searches cannot be 
constructed in any straightforward way (although there might be a way to get 
the effect by going around Cobb's Hill). Or does the Lucene syntax allow the 
examples to be cast as:

"crude "west texas""~4

or

""spot prices" "gulf coast""~3

If not, is it a fair assessment to say that in Lucene, proximity is limited 
to being a part of phrase searching, and its function is exhausted by 
allowing a slop factor in matching phrases.

Thanks in advance for any help with this.

T. R.
trh@midrivers.com
http://www.linkedin.com/in/trhalvorson
www.ncodian.com
http://twitter.com/trhalvorson 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44589-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 14:44:19 2010
Return-Path: <java-user-return-44589-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75673 invoked from network); 19 Jan 2010 14:44:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 14:44:19 -0000
Received: (qmail 53093 invoked by uid 500); 19 Jan 2010 14:44:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 53019 invoked by uid 500); 19 Jan 2010 14:44:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 53007 invoked by uid 99); 19 Jan 2010 14:44:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 14:44:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of torindan@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 14:44:09 +0000
Received: by qw-out-2122.google.com with SMTP id 3so851602qwe.53
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 06:43:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=zxDC3RQAXls4K3nXY5NtwHgbOHjlDOkeMT9vTH2E24s=;
        b=Ey3SKeb4VY5Z7vh9JIiV4vRMd4Z+ZN2ZatdQSgjv7O1C52Sx6jO7GRK2EcoZ+gfSJJ
         H3qxybhjlLs8DBpEdMF86yuJNsDUwyyMAc1lwpgZTvmqkhz5MiIdyfJPUYJbnp1JSvWl
         FPHVlcMCHImSiJAU7HH7xSzgH2oG3ScV58E9U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=IBlnuhwQv96GXOKogOh3p6R+YCCk1KniqrSUu5h6Kojybw6hYG9MlFQyNgcRdhBOWC
         2jLNBlHx0OWpIoM5lAiBZzIWrT/Eio54SrGY4RaXhdB6IPH1tTeFFc303rKiklFrYFbR
         T1Uo9VZlQxJV51FyhsiQ2LQP9SKWC+um8O9d8=
MIME-Version: 1.0
Received: by 10.229.31.206 with SMTP id z14mr4889860qcc.79.1263912228863; Tue, 
	19 Jan 2010 06:43:48 -0800 (PST)
In-Reply-To: <6839.98888.qm@web26203.mail.ukl.yahoo.com>
References: <359a92831001190543t4b5375c8y209e1180862c4dd6@mail.gmail.com>
	 <6839.98888.qm@web26203.mail.ukl.yahoo.com>
Date: Tue, 19 Jan 2010 16:43:48 +0200
Message-ID: <2ffb6d061001190643s63412102tc4facf4ae2537630@mail.gmail.com>
Subject: Re: Indexing and Searching linked files
From: =?UTF-8?B?RGFuaWwgxaJPUklO?= <torindan@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

You can simple index both "files" and "cards" into same index (no need
for 2 indexes)

Lucene easily support documents of different structure.

You may add some boosting per field or document, and tune similarity
to get most important stuff in top.


On Tue, Jan 19, 2010 at 16:35, Anna Hunecke <annahunecke@yahoo.de> wrote:
> The field size is restricted to 1 million tokens, because of the very rea=
sons you mentioned.
> So, even if I have one separate field for the content of a file, I might =
reach the limit if the file is really big. But I can't help that. What I wa=
nt to avoid is that the whole content of some files can not be found becaus=
e I used one field for the content of all files and they just could not be =
appended anymore.
>
> --- Erick Erickson <erickerickson@gmail.com> schrieb am Di, 19.1.2010:
>
>> Von: Erick Erickson <erickerickson@gmail.com>
>> Betreff: Re: Indexing and Searching linked files
>> An: java-user@lucene.apache.org
>> Datum: Dienstag, 19. Januar 2010, 14:43
>> What field size limit are you talking
>> about here? Because 10,000
>> tokens is the default, but you can increase it to
>> Integer.MAX_VALUE.
>>
>> So are you really talking billions of tokens here? Your
>> index
>> quickly becomes unmanageable if you're allowing it to grow
>> by such increments.
>>
>> One can argue, IMO, that the first N (10M, say) tokens/file
>> is
>> "enough" and there's not much real value in the rest, but
>> that
>> can be a weak argument depending on the problem space....
>>
>> But if you're really committed to indexing an unbounded
>> number
>> of arbitrarily large files...you'll fail. Sometime,
>> somewhere, somebody
>> will want to index enough to violate whatever limits you
>> have (disk,
>> memory, time, whatever). So I think you'd be farther ahead
>> to ask your
>> product manager what limits are reasonable and go from
>> there...
>>
>> HTH
>> Erick
>>
>> On Tue, Jan 19, 2010 at 7:57 AM, Anna Hunecke <annahunecke@yahoo.de>
>> wrote:
>>
>> > Hi!
>> > I have been working with Lucene for a while now. So
>> far, I found helpful
>> > tips on this list, so I hope somebody can help me with
>> my problem:
>> >
>> > In our app information is grouped in so-called cards.
>> Now, it should be
>> > made possible to also search on files linked to the
>> cards. You can link
>> > arbitrarily many files to a card and the size of the
>> files is also not
>> > restricted.
>> > So, as far as I can see, there are two ways to do
>> this:
>> >
>> > 1. Add the content of the files to the search index of
>> the card. First, I
>> > thought that I could just have an additional field in
>> the index which
>> > contains the content of all the files. But then, if
>> the files are very big,
>> > I could hit the field size limit, and would possibly
>> not get the content of
>> > all files indexed. So, I would need one field per
>> file. The problem I have
>> > then is that I don't know how many files I have and
>> how large the index
>> > would get. This is risky, because some customers have
>> a lot of data.
>> >
>> > 2. Create a separate index for files. The documents in
>> this index would
>> > contain one file each, so I would not have the problem
>> that I don't know how
>> > many fields I have. But then, the searching is a
>> problem:
>> > I would need to search on both the card and the
>> document index, and somehow
>> > merge the results together. I sort by score always,
>> but, as I understand it,
>> > the scores of the results of two different indexes are
>> not comparable.
>> >
>> > So, which way do you think is better?
>> >
>> > Best,
>> > Anna
>> >
>> > __________________________________________________
>> > Do You Yahoo!?
>> > Sie sind Spam leid? Yahoo! Mail verf=C3=BCgt =C3=BCber einen
>> herausragenden Schutz
>> > gegen Massenmails.
>> > http://mail.yahoo.com
>> >
>> >
>> ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>
> __________________________________________________
> Do You Yahoo!?
> Sie sind Spam leid? Yahoo! Mail verf=C3=BCgt =C3=BCber einen herausragend=
en Schutz gegen Massenmails.
> http://mail.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44590-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 15:07:33 2010
Return-Path: <java-user-return-44590-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83851 invoked from network); 19 Jan 2010 15:07:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 15:07:33 -0000
Received: (qmail 6587 invoked by uid 500); 19 Jan 2010 15:07:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6515 invoked by uid 500); 19 Jan 2010 15:07:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6493 invoked by uid 99); 19 Jan 2010 15:07:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 15:07:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 15:07:23 +0000
Received: by pwi11 with SMTP id 11so2616701pwi.5
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 07:07:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=hyrnPsz5wwsZ3KNKuAdBuHqojV9qFCpK1wktVcGncwE=;
        b=GjXt8HscHx9H+h3HpCD1DEGki2yhft6WrOYIdQm9Vh8UqpdJxWKnqIaIHQYQuFi0AF
         gzWJkbiErF7mumWT309i2tHl7whTdO0HNed/2EvICKcKQfmIczLr28rLoJN1Px4lFhm4
         xDdUUfgCDX3jl34Fdi1u/i9Lp3RGBN1Z1EITs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=C8aPHpGXRHEuy4m/PBE2JuApLsgJt6u6JIrfhW46b9YXeUFq3GSxJltkH8QisEZIYH
         2XbfiESYasaOzidNUQ/ikWDwfdIkhvPvhLeHhgpL9IeU8IYuqDNOCOpfijjmojU7p3uS
         /4gkqMBs7Rue8bpf8WGD7G3kC5G7j/ptaGT40=
MIME-Version: 1.0
Received: by 10.140.252.10 with SMTP id z10mr3116350rvh.275.1263913623400; 
	Tue, 19 Jan 2010 07:07:03 -0800 (PST)
In-Reply-To: <6839.98888.qm@web26203.mail.ukl.yahoo.com>
References: <359a92831001190543t4b5375c8y209e1180862c4dd6@mail.gmail.com>
	 <6839.98888.qm@web26203.mail.ukl.yahoo.com>
Date: Tue, 19 Jan 2010 10:07:03 -0500
Message-ID: <359a92831001190707q2c2c54b3p208c580faed03ae4@mail.gmail.com>
Subject: Re: Indexing and Searching linked files
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000e0cd107308cb333047d85d23f

--000e0cd107308cb333047d85d23f
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

What's a reasonable upper limit on the number of files? Because I think it
would be simpler, at least to start, to allow your field to be larger (say,
1B
tokens, 1,000 files of 1M tokens each), but restrict the input of each file
to 1M tokens per file. The most elegant way would probably be to
subclass the TokenStream of your choice and cause it to return the
end-of-input
(e.g. next() returns null) after every 1M tokens, regardless of whether
there were more. You'd have to add some methods to allow you to signal
starting a new file, but that shouldn't be difficult....

The tricky part here would be if you had to answer the question "which
file associated with this card matched for this search?". It's do-able,
I'd think about storing the begin/end offsets of each file in a
meta-data field for the card (probably stored but not indexed)......

A cruder approach would be to read the input files yourself and approximate
1M tokens and feed *that* to the analyzer, but that's perilously close to
re-writing a tokenizer.....

HTH
Erick



On Tue, Jan 19, 2010 at 9:35 AM, Anna Hunecke <annahunecke@yahoo.de> wrote:

> The field size is restricted to 1 million tokens, because of the very
> reasons you mentioned.
> So, even if I have one separate field for the content of a file, I might
> reach the limit if the file is really big. But I can't help that. What I
> want to avoid is that the whole content of some files can not be found
> because I used one field for the content of all files and they just could
> not be appended anymore.
>
> --- Erick Erickson <erickerickson@gmail.com> schrieb am Di, 19.1.2010:
>
> > Von: Erick Erickson <erickerickson@gmail.com>
> > Betreff: Re: Indexing and Searching linked files
> > An: java-user@lucene.apache.org
> > Datum: Dienstag, 19. Januar 2010, 14:43
> > What field size limit are you talking
> > about here? Because 10,000
> > tokens is the default, but you can increase it to
> > Integer.MAX_VALUE.
> >
> > So are you really talking billions of tokens here? Your
> > index
> > quickly becomes unmanageable if you're allowing it to grow
> > by such increments.
> >
> > One can argue, IMO, that the first N (10M, say) tokens/file
> > is
> > "enough" and there's not much real value in the rest, but
> > that
> > can be a weak argument depending on the problem space....
> >
> > But if you're really committed to indexing an unbounded
> > number
> > of arbitrarily large files...you'll fail. Sometime,
> > somewhere, somebody
> > will want to index enough to violate whatever limits you
> > have (disk,
> > memory, time, whatever). So I think you'd be farther ahead
> > to ask your
> > product manager what limits are reasonable and go from
> > there...
> >
> > HTH
> > Erick
> >
> > On Tue, Jan 19, 2010 at 7:57 AM, Anna Hunecke <annahunecke@yahoo.de>
> > wrote:
> >
> > > Hi!
> > > I have been working with Lucene for a while now. So
> > far, I found helpful
> > > tips on this list, so I hope somebody can help me with
> > my problem:
> > >
> > > In our app information is grouped in so-called cards.
> > Now, it should be
> > > made possible to also search on files linked to the
> > cards. You can link
> > > arbitrarily many files to a card and the size of the
> > files is also not
> > > restricted.
> > > So, as far as I can see, there are two ways to do
> > this:
> > >
> > > 1. Add the content of the files to the search index of
> > the card. First, I
> > > thought that I could just have an additional field in
> > the index which
> > > contains the content of all the files. But then, if
> > the files are very big,
> > > I could hit the field size limit, and would possibly
> > not get the content of
> > > all files indexed. So, I would need one field per
> > file. The problem I have
> > > then is that I don't know how many files I have and
> > how large the index
> > > would get. This is risky, because some customers have
> > a lot of data.
> > >
> > > 2. Create a separate index for files. The documents in
> > this index would
> > > contain one file each, so I would not have the problem
> > that I don't know how
> > > many fields I have. But then, the searching is a
> > problem:
> > > I would need to search on both the card and the
> > document index, and somehow
> > > merge the results together. I sort by score always,
> > but, as I understand it,
> > > the scores of the results of two different indexes are
> > not comparable.
> > >
> > > So, which way do you think is better?
> > >
> > > Best,
> > > Anna
> > >
> > > __________________________________________________
> > > Do You Yahoo!?
> > > Sie sind Spam leid? Yahoo! Mail verf=FCgt =FCber einen
> > herausragenden Schutz
> > > gegen Massenmails.
> > > http://mail.yahoo.com
> > >
> > >
> > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
>
> __________________________________________________
> Do You Yahoo!?
> Sie sind Spam leid? Yahoo! Mail verf=FCgt =FCber einen herausragenden Sch=
utz
> gegen Massenmails.
> http://mail.yahoo.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000e0cd107308cb333047d85d23f--

From java-user-return-44591-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 17:01:04 2010
Return-Path: <java-user-return-44591-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43097 invoked from network); 19 Jan 2010 17:01:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 17:01:03 -0000
Received: (qmail 54264 invoked by uid 500); 19 Jan 2010 17:01:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54186 invoked by uid 500); 19 Jan 2010 17:01:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54176 invoked by uid 99); 19 Jan 2010 17:01:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 17:01:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of trh@midrivers.com designates 216.228.34.54 as permitted sender)
Received: from [216.228.34.54] (HELO waldorf.midrivers.com) (216.228.34.54)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 17:00:49 +0000
Received: from TRoffice (cms2-209.r1.mtsdny.infoave.net [216.228.51.209])
	by waldorf.midrivers.com (8.11.6/8.11.6) with SMTP id o0JH0So12281
	for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 10:00:28 -0700
Message-ID: <42DD940BDAEE4F9983B3BB044C62A563@TRoffice>
Reply-To: "T. R. Halvorson" <trh@midrivers.com>
From: "T. R. Halvorson" <trh@midrivers.com>
To: <java-user@lucene.apache.org>
References: <359a92831001190543t4b5375c8y209e1180862c4dd6@mail.gmail.com> <6839.98888.qm@web26203.mail.ukl.yahoo.com> <359a92831001190707q2c2c54b3p208c580faed03ae4@mail.gmail.com>
In-Reply-To: <359a92831001190707q2c2c54b3p208c580faed03ae4@mail.gmail.com>
Subject: Unary Operators and Operator Precedence
Date: Tue, 19 Jan 2010 10:00:23 -0700
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="iso-8859-1";
	reply-type=original
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Windows Mail 6.0.6002.18005
X-MimeOLE: Produced By Microsoft MimeOLE V6.0.6002.18005
X-Virus-Checked: Checked by ClamAV on apache.org

Here are some questions about unary operators and operator precedence or 
default order of operation.

We all know the importance of order of operation of binary operators 
(ones that operate on two operands) such as AND and OR. We know how to 
impose express order of operation by grouping and nesting.

But what about unary operators, like + (plus), the "required operator", 
and - (minus), the "prohibited operator"? Unary operators operate on 
only one operand.

Here are the questions (Leaving out of consideration for the time being 
the NOT operator which also is unary because I think we know what is 
going on with that):

1.) Does order of operation matter with unary operators?

2.) If there is operator precedence or default order of operation for 
unary operators in Lucene, is it documented or published?

3.) Does grouping or nesting affect results with unary operators? Does 
using unary operators with binary operators affect results. For example, 
in the query:

     (+a +b) OR c

has the "required" effect of the + (plus) operator been eliminated by 
the OR operator, so that nevermind whether a record contains a or 
contains b both of which supposedly are required, so long as it contains 
c, it's a hit?

T. R.

trh@midrivers.com
www.linkedin.com/in/trhalvorson
www.ncodian.com
http://twitter.com/trhalvorson 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44592-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 17:13:58 2010
Return-Path: <java-user-return-44592-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49486 invoked from network); 19 Jan 2010 17:13:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 17:13:58 -0000
Received: (qmail 74245 invoked by uid 500); 19 Jan 2010 17:13:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74173 invoked by uid 500); 19 Jan 2010 17:13:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74163 invoked by uid 99); 19 Jan 2010 17:13:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 17:13:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.116.39.62] (HELO rectangular.com) (68.116.39.62)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 17:13:48 +0000
Received: from marvin by rectangular.com with local (Exim 4.63)
	(envelope-from <marvin@rectangular.com>)
	id 1NXHdt-0003q3-Fz; Tue, 19 Jan 2010 09:13:25 -0800
Date: Tue, 19 Jan 2010 09:13:25 -0800
To: java-user@lucene.apache.org, "T. R. Halvorson" <trh@midrivers.com>
Subject: Re: Unary Operators and Operator Precedence
Message-ID: <20100119171325.GA14733@rectangular.com>
References: <359a92831001190543t4b5375c8y209e1180862c4dd6@mail.gmail.com> <6839.98888.qm@web26203.mail.ukl.yahoo.com> <359a92831001190707q2c2c54b3p208c580faed03ae4@mail.gmail.com> <42DD940BDAEE4F9983B3BB044C62A563@TRoffice>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <42DD940BDAEE4F9983B3BB044C62A563@TRoffice>
User-Agent: Mutt/1.5.13 (2006-08-11)
From: Marvin Humphrey <marvin@rectangular.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> 3.) Does grouping or nesting affect results with unary operators? Does 
> using unary operators with binary operators affect results. For example, 
> in the query:
> 
>     (+a +b) OR c
> 
> has the "required" effect of the + (plus) operator been eliminated by 
> the OR operator, so that nevermind whether a record contains a or 
> contains b both of which supposedly are required, so long as it contains 
> c, it's a hit?

IMO, that's the only sensible way to handle unary operators.  If they were
global rather than nested, what would this query produce?

   (a AND -b) OR (b AND c)

Marvin Humphrey


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44593-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 17:27:07 2010
Return-Path: <java-user-return-44593-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57225 invoked from network); 19 Jan 2010 17:27:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 17:27:07 -0000
Received: (qmail 99010 invoked by uid 500); 19 Jan 2010 17:27:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98953 invoked by uid 500); 19 Jan 2010 17:27:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98943 invoked by uid 99); 19 Jan 2010 17:27:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 17:27:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.49.17] (HELO web52907.mail.re2.yahoo.com) (206.190.49.17)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 19 Jan 2010 17:26:55 +0000
Received: (qmail 46071 invoked by uid 60001); 19 Jan 2010 17:26:34 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263921994; bh=jm9gaqIAG5Mr8nGsxplxwGEU+FcWa3OH6zaPyFt009o=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=m4UaT9VHVTC6GjQS0rzMlY6ywtj5GzXogUamOKdXfNRMT3hIrD77nz3918BKpz4cEWXz1Mk+L1i79Yfz6VcwR9sUd1nfUZqK/bluA4CoLfdK8E8DyP52Co6orZqLaBmZuvPpJYupHNn+XBG2QIBlfMGWYmYHsI1kjGFx/yERIks=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=UhZNJJwn+piQAt84dIV4gSz7uKRM5WEyqOJC+xl0Ri6Nnih5cDMJZ2P/6/3JHYYpAQDCt+hCKM3+dq92PvhxaH26MxaERQgbprauDnGp/FnMqgZE+fDqA21v2ve5Rr6xxsZx+oA0Xwf/ddH9w7mADkUyrYhjSLdRbW82UxNWrdM=;
Message-ID: <209626.43343.qm@web52907.mail.re2.yahoo.com>
X-YMail-OSG: lN724L0VM1kzrSKjgH1.9bPItJRLGRJeBgF4e8cJXTP.y8tU2ZG3gPcUltjvy7PcGsBkGTSOqtJ2qxbUcaPlhr8qwgyYPpPYG.edfYvU_uVUBFGluNMXQESLqPD_JdV0xA89Pjg2VVPDBPNG9NKT5akCY6QfkAooFNqq1m6yZXWA4Q1T5rkacYjiopLDkJpreKR5Hxq20xeTN6c78244l1bad5FkRJcEIgQXhUC02IzczfvbhVInpQE1AVQHyE4FjIwEs3gkXy7K.o6KNHpp.t_oUb3A9b5EZuLxIJl40QXVIUtGVqGHN5YfvpZeAazFmExKQnIA9hbpcJDGKfq1o0xyZjYAAIwHj8i_VG.7QCNY8lB0uhKYEYVbnsyhzT5ld0q1e7AyQlp970j.aozIrKECDt9yGIR37ZQyPEmo5_t7XGpTWmqhQTQYdHh_L7eXTwMTqjq.g33eRCzcVmO6_en5YHfoGDx305J1nicDcsh6Ji3Ud3A-
Received: from [95.15.159.50] by web52907.mail.re2.yahoo.com via HTTP; Tue, 19 Jan 2010 09:26:34 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Tue, 19 Jan 2010 09:26:34 -0800 (PST)
From: Ahmet Arslan <iorixxx@yahoo.com>
Subject: Re: Proximity of More than Single Words?
To: java-user@lucene.apache.org, "T. R. Halvorson" <trh@midrivers.com>
In-Reply-To: <023b01ca9915$4f503560$3c2be4d8@your8dfb31b6e1>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

> For proximity expressions, the query
> parser documentation says, "use the tilde, "~", symbol at
> the end of a Phrase." It gives the example "jakarta
> apache"~10
> 
> Does this mean that proximity can only be operated on
> single words enquoted in quotation marks?

Yes if you are using QueryParser to generate your queries. It does not support nested proximity. But if you are constructing your queries programmatically it can be done with SpanQuery family.

> To clarify the
> question by comparision, on some systems, the w/ proximity
> operator lets one search for:
> 
> crude w/4 "west texas"
> 
> or
> 
> "spot prices" w/3 "gulf coast"

There is a org.apache.lucene.queryParser.surround.parser.QueryParser that supports nested proximity search. However it's syntax does not use quotes. There are two operators ordered (w) and unordered (n). Your examples can be translated as follows:

crude 4w (west w texax)

(spot w prices) 3w (gulf w coast)

Also surround parser do not analyze query words. There are different query parsers here:
http://www.lucidimagination.com/blog/2009/02/22/exploring-query-parsers/


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44594-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 19:04:23 2010
Return-Path: <java-user-return-44594-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14299 invoked from network); 19 Jan 2010 19:04:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 19:04:23 -0000
Received: (qmail 46297 invoked by uid 500); 19 Jan 2010 19:04:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46225 invoked by uid 500); 19 Jan 2010 19:04:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46215 invoked by uid 99); 19 Jan 2010 19:04:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 19:04:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gsiasf@gmail.com designates 209.85.217.216 as permitted sender)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 19:04:10 +0000
Received: by gxk8 with SMTP id 8so3811246gxk.11
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 11:03:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:sender:content-type
         :mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=nd+Z9E+dBC98YFv+HeUv9VqKjab0Cf2/dXpISvvJNhg=;
        b=lyKkYstHiLMN3nzeqhaa7pVGQLVD8iTwV+AsArgCO5EaF8equnlyphXoSeId7KhigV
         OPNxFCRuEslx45fE2FWLtkpmaekJoFakduebZrcjw/mV1Zx4CNQVOd4QL7o8fSGRGQEw
         S3TH872GX9kYRtPoieIhbwzesVNyozfqlBIbs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=sender:content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        b=ZWPKMkVrSZqB6SO+GUlY0+541nuPjj+0hOUts4nLVQYiSh5uuUhbosq6wsFMRjXtbX
         j49ojRp7TnUC//yO0GnGah6zyhQwJzDfQQkIZuLVO95WUCR5iVPQnZVaHuPOz0jjbDOP
         9NOxZNGgZ31aAHhEXDbXEjSB0f4WIdM3pCOf0=
Received: by 10.151.89.33 with SMTP id r33mr1777700ybl.290.1263927829751;
        Tue, 19 Jan 2010 11:03:49 -0800 (PST)
Received: from ?10.0.0.77? (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
        by mx.google.com with ESMTPS id 21sm2724784ywh.31.2010.01.19.11.03.48
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 19 Jan 2010 11:03:48 -0800 (PST)
Sender: Grant Ingersoll <gsiasf@gmail.com>
Content-Type: text/plain; charset=iso-8859-1
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: unique term identifiers
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <4B546B27.5090603@gmail.com>
Date: Tue, 19 Jan 2010 14:03:47 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <173EE288-3959-403C-8672-2CDC32BB41FC@apache.org>
References: <4B546B27.5090603@gmail.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org

Have a look at Mahout (Lucene sister project), which can create =
SparseVectors from Lucene term vectors where the entries are the term id =
and the "weight" of the term.  Trivial to replicate what is done in =
Mahout for LibSVM or ARFF or whatever.

On Jan 18, 2010, at 9:07 AM, Solt, Ill=E9s wrote:

> Hi,
>=20
> I am looking for a way to represent term frequency data in a vector =
space, thus using unique integer identifiers instead of string. This =
would allow feeding tools like LIBSVM from a Lucene index.
>=20
> A small example: TermFreqVector.toString() produces "{TITLE: one/3, =
two/4}". What I am looking for is "1:3 2:4", where 1 and 2 are arbitrary =
identifiers, sortedness is not an issue.
>=20
> The task can obviously be solved using some java Map, but it should be =
less efficient then using native Lucene methods.
>=20
> I am using 2.9.1, my index can be considered constant.
>=20
>=20
> Thanks,
> Illes Solt
>=20
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20

--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem using Solr/Lucene: =
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44595-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 20:53:27 2010
Return-Path: <java-user-return-44595-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41188 invoked from network); 19 Jan 2010 20:53:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 20:53:27 -0000
Received: (qmail 94465 invoked by uid 500); 19 Jan 2010 20:53:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94409 invoked by uid 500); 19 Jan 2010 20:53:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94399 invoked by uid 99); 19 Jan 2010 20:53:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 20:53:24 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 20:53:16 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NXL4J-0007V8-IR
	for java-user@lucene.apache.org; Tue, 19 Jan 2010 12:52:55 -0800
Message-ID: <27232534.post@talk.nabble.com>
Date: Tue, 19 Jan 2010 12:52:55 -0800 (PST)
From: Franz Garsombke <fgarsombke@yahoo.com>
To: java-user@lucene.apache.org
Subject: Lucene 2.9.1 'read past EOF' IOException under system load
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fgarsombke@yahoo.com


We have been able to expose this exception under system load but NOT with
individual requests.

Lucene version is 2.9.1. These indexed files are being read over NFS.

Java version is: 
Java(TM) SE Runtime Environment (build 1.6.0_11-b03)
Java HotSpot(TM) 64-Bit Server VM (build 11.0-b16, mixed mode)

Linux version:
Linux 2.6.18-92.el5 #1 SMP Tue Apr 29 13:16:15 EDT 2008 x86_64 x86_64 x86_64
GNU/Linux

The exception we have seen:

Caused by: java.io.IOException: read past EOF
        at
org.apache.lucene.store.BufferedIndexInput.refill(BufferedIndexInput.java:151)
        at
org.apache.lucene.store.BufferedIndexInput.readByte(BufferedIndexInput.java:38)
        at org.apache.lucene.store.IndexInput.readInt(IndexInput.java:70)
        at org.apache.lucene.store.IndexInput.readLong(IndexInput.java:93)
        at org.apache.lucene.index.FieldsReader.doc(FieldsReader.java:210)
        at
org.apache.lucene.index.SegmentReader.document(SegmentReader.java:948)
        at
org.apache.lucene.index.DirectoryReader.document(DirectoryReader.java:506)
        at
org.apache.lucene.index.MultiReader.document(MultiReader.java:241)
        at
org.apache.lucene.index.IndexReader.document(IndexReader.java:947)
        at
org.apache.lucene.search.IndexSearcher.doc(IndexSearcher.java:152)


We can not reproduce this problem unless we are running a load test with 50
users for 7 minutes.

Here is the code using the ScoreDoc[] and Searcher.

  public void iterateResults(ScoreDoc[] hits, Searcher searcher) {
    for (int i = 0; i < hits.length; ++i) {
      try {
        Document d = searcher.doc(hits[i].doc);
        // do something with document
      } catch (Exception e) {
        throw new RuntimeException("problem iterating results", e);
      }
    }

Thoughts?

Thanks in advance

Franz Garsombke


-- 
View this message in context: http://old.nabble.com/Lucene-2.9.1-%27read-past-EOF%27-IOException-under-system-load-tp27232534p27232534.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44596-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 19 22:42:17 2010
Return-Path: <java-user-return-44596-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94388 invoked from network); 19 Jan 2010 22:42:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 19 Jan 2010 22:42:16 -0000
Received: (qmail 33962 invoked by uid 500); 19 Jan 2010 22:42:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33882 invoked by uid 500); 19 Jan 2010 22:42:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33868 invoked by uid 99); 19 Jan 2010 22:42:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 22:42:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 19 Jan 2010 22:42:07 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 5D30C71C2B7; Tue, 19 Jan 2010 14:41:47 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 56B7671C236
	for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 14:41:47 -0800 (PST)
Date: Tue, 19 Jan 2010 14:41:47 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Hints on implementing XQuery full-text search
In-Reply-To: <1384E79B-2D30-4059-A441-6EC6621B6DE5@lucasmail.org>
Message-ID: <Pine.LNX.4.64.1001191429230.10224@radix.cryptio.net>
References: <1384E79B-2D30-4059-A441-6EC6621B6DE5@lucasmail.org>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII


: I'm about to embark on implementing the full-text search feature of XQuery:

Good luck with that.

Here's some quick suggestions on how i'd try to tackle the things you 
asked about, w/o putting much thought into...

: 	title ftcontains "usability" occurs at least 2 times

assuming this is just term based (and not complex subclauses) i would 
write a custom subclass of TermQuery that enforces a minimum term frequency.

: 	title ftcontains "improve" with stemming

index two versions of every field - one with stemming and one w/o

: This allows you to specify -- at query-time -- one of "case 
: insensitive", "case sensitive", "lowercase", "uppercase".

I have no idea what it would mean to match something "uppercase" or 
"lowercase" -- unless that's just syntactic suger for "uppercase by input, 
and then look for a case sensitve match) but again: two fields for case 
sensitive/insensitive

: This is similar to the Cast Option except its "diacritics insensitive" 
: or "diacritics sensitive.  How about implementing this?

two fields, again.

...at this point, if you need to support all permutations of these options 
you are looking at 2*2*2 index fields per source field ... so you start 
getting into hte realm where i might consider keeping them all in one 
field, using Payloads to note the various attributes that each Term has.

: 	abstract ftcontains "propagating of errors"
: 	with stop words ("a", "the", "of")
: 
: would match a document with an abstract that contains "propagating few 
: errors". It seems odd, I know.  It's as if the stop words become 
: wildcards, i.e.:

are you serious? ... so if i query for "A of the B" with stop words ("of", 
"the") then that has to match "A totally ridiculous B" ? ...  that makes 
no sense what so ever.  why require so much verbosity just to get a "gap" 
that matches anything?

that seems like a straight query parsing problem ... if you see one of the 
terms in teh stop work list, strip it out, and increase the phrase slop on 
the PhraseQuery you are building.

: 	body ftcontains "Mexico" not in "New Mexico"

SpanNotQuery


: 	title ftcontains ("web site" ftand "usability") ordered

SpanNearQuery


: 	abstract ftcontains "usability" ftand "web site" same sentence
: 
: You can also do any combination of {same|different} 
: {sentence|paragraph}.  My guess for this would also be to keep track of 
: sentence/paragraph data in a payload.  Yes?

sounds right.


: 	book ftcontains "Web Usability" without content $x//annotation

depends on how you plan on indexing all of hte context stuff ... if the 
tags are Terms then a SpanNOtQuery would work ... if they are Payloads you 
just need some sort of SpanTermNotMatchingPayload query.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44597-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 00:43:18 2010
Return-Path: <java-user-return-44597-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34621 invoked from network); 20 Jan 2010 00:43:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 00:43:18 -0000
Received: (qmail 54275 invoked by uid 500); 20 Jan 2010 00:43:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54201 invoked by uid 500); 20 Jan 2010 00:43:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54191 invoked by uid 99); 20 Jan 2010 00:43:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 00:43:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ryguasu@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 00:43:08 +0000
Received: by qw-out-2122.google.com with SMTP id 3so966468qwe.53
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 16:42:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:from:date:message-id
         :subject:to:content-type;
        bh=AocutXtEbjjCtZwAL8Mwda0W1xME47krerZM5ManjXE=;
        b=fOOjf4Je6h3E11nlMiRWfe7GLZ3Wg3p1m98fwjE5e1jXZaRmWjGAItvtyqHvK59vhw
         aSzw12xDek7tCpNI/ef6hyQfJ458iNed28GZHCfev1Zsr3XkzME4QOATAEnOUjkSXO1F
         up0x12qsjEkm1CP9zvhWzaWb9E8JiGD3JWvZs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        b=JT54M/r5mLwE/76ZeyN3SZ1PdsfnutCcnQYorTZCN0ChCqJ/v5v188uJ0buRoHx0mi
         6phGOEkSFhXu1grmCk3+NQgCyMFCdGun/mdWW43OyGbdcKv5VrP+uI8EvR2tdMeiGoiy
         6uu/bMUtmv7zpgnoeNx+JgZ+81Pcm2K4VWzLI=
MIME-Version: 1.0
Received: by 10.220.125.103 with SMTP id x39mr140346vcr.10.1263948167091; Tue, 
	19 Jan 2010 16:42:47 -0800 (PST)
From: Chris Harris <ryguasu@gmail.com>
Date: Tue, 19 Jan 2010 16:42:27 -0800
Message-ID: <856ac15f1001191642k7b579316w62221900ba676b85@mail.gmail.com>
Subject: Tag Index patch (LUCENE-1292) status?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

I'm interested in the Tag Index patch (LUCENE-1292), in particular
because of how it enables you to modify certain fields without
reindexing a whole document. However, that issue is marked Lucene
2.3.1 and hasn't been updated since July 2008. Can anyone provide any
status updates on this patch? Questions include:

- Is anyone using this in production?

- Does this work with Lucene 2.9/3.0?

- Is anyone actively working on the patch now?

- Are there any competing approaches now for doing updates to
particular fields? (I haven't found any yet.)

Thanks,
Chris

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44598-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 01:03:35 2010
Return-Path: <java-user-return-44598-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40290 invoked from network); 20 Jan 2010 01:03:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 01:03:35 -0000
Received: (qmail 71989 invoked by uid 500); 20 Jan 2010 01:03:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71912 invoked by uid 500); 20 Jan 2010 01:03:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71902 invoked by uid 99); 20 Jan 2010 01:03:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 01:03:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.49.15] (HELO web52905.mail.re2.yahoo.com) (206.190.49.15)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 01:03:23 +0000
Received: (qmail 41752 invoked by uid 60001); 20 Jan 2010 01:03:02 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263949382; bh=52D4Q3QyyCPpXSysRXRqGOVafxirKgpedq8RCViWjuE=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=kDmlaGvLDO/b0Sow1nLBYpeX0ydovfK8DtgS3Bk/rogdBfcGXrlhYgboqt03+y5EbctqUuaecJTw8a6UQtFi0M9K5yGYslK8zfuMu/VJPFXQNnoFVU/pq2Q3GxoKY/KZqXhpAxl22m1cbeXoV//NP6jUP3kWOM8Pnw94LdtaUiM=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=Sdg7KWxrk5cXiJfNyAsj7I/B79hgUg40MAPj8yNenji7a9Lo0kapvRYYRc6zVEm21rNSeKZycd8uOkY6C0r9NEGsP/fvaYCJQBWjTpUt+49VtMOkLymG6Ydw/zsANypQ+rNjS+w3TmoQM2/Ca5P9/ARn+Hv/UUj6C7LP/mDFCp0=;
Message-ID: <768383.36868.qm@web52905.mail.re2.yahoo.com>
X-YMail-OSG: B4nPtU4VM1nF42BFdtVQuWfeJtw1fzfivi_Bgk_hY5wPF1_5RM1cukW1haGWoYpF.y6ISKwrtuVLnT9SuXAH0FfeaNGBaSNWsMfLJ6xUN1eL.w7m4V2YCJhJxgPe4xHQXbx9WOw5lDzQYiKw7jHTY1VqCYqYBIDlnBDe6WZ78IIq0VSU83oi7b4rcBwtXntqrwyyvIGcAocpkPgOiTcgYwDPsx8p9f8SqWiypQV9bx.psLPYT4okDHX9URvsK7opxK7Nlx9bUHrmafXYgnUDQPexyz9_ScYh08W0PjHQ7d354.oTDuSs9dWITJS.rXvawuEqc_ZCKJ7TF8AYfb.aE2_2offITcpdIX4NoAAlv6snRognLdeqcyje5L5ZRL8Exwx.9JJxa1sZcsTc5lxrmfvAgLMMXkq8g.aX0FL3VLujPPfpeg--
Received: from [95.15.159.50] by web52905.mail.re2.yahoo.com via HTTP; Tue, 19 Jan 2010 17:03:02 PST
X-Mailer: YahooMailClassic/9.0.20 YahooMailWebService/0.8.100.260964
Date: Tue, 19 Jan 2010 17:03:02 -0800 (PST)
From: Ahmet Arslan <iorixxx@yahoo.com>
Subject: Re: Unary Operators and Operator Precedence
To: java-user@lucene.apache.org, "T. R. Halvorson" <trh@midrivers.com>
In-Reply-To: <42DD940BDAEE4F9983B3BB044C62A563@TRoffice>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

> Here are some questions about unary
> operators and operator precedence or default order of
> operation.
> 
> We all know the importance of order of operation of binary
> operators (ones that operate on two operands) such as AND
> and OR. We know how to impose express order of operation by
> grouping and nesting.
> 
> But what about unary operators, like + (plus), the
> "required operator", and - (minus), the "prohibited
> operator"? Unary operators operate on only one operand.

You might find this link interesting.

http://wiki.apache.org/lucene-java/BooleanQuerySyntax


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44599-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 03:45:49 2010
Return-Path: <java-user-return-44599-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89736 invoked from network); 20 Jan 2010 03:45:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 03:45:49 -0000
Received: (qmail 72718 invoked by uid 500); 20 Jan 2010 03:45:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72445 invoked by uid 500); 20 Jan 2010 03:45:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72435 invoked by uid 99); 20 Jan 2010 03:45:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 03:45:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of farhang@gmail.com designates 209.85.219.225 as permitted sender)
Received: from [209.85.219.225] (HELO mail-ew0-f225.google.com) (209.85.219.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 03:45:40 +0000
Received: by ewy25 with SMTP id 25so1300932ewy.5
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 19:45:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=bVxSKZriy4lcg5QSLYJAWhHesnedcnGXjch9FbxkmQw=;
        b=VggX4K4vUote5obAI78sMr8A7qLtgVqSWjZxieqiHTRL1vb4YlbQDpqSx2VIwaz4aN
         xcLo2Ggno6XMJOxnRvPl/L7xctEycNN6zbRZUqfqKez1Wg7U7FwDvRACupWx9CFr+p02
         5T5jyE68K+0nEc+ARxMkPcj4EjBw7EFrqF8JY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=RZr3u1rnysxpPn6uCsWMZn9V9vhDWOL33heCvZ/MoRuwwWJXLyjUB/+cU6oYyOToaj
         bRjZrzMjSx2X5fu/XOPKMPGwQ6Tfg5nJiWqJA9HCi0oH781ykZyPcNEqvk1ZPEn7ZG2+
         QQP2cCVvfGh2qMBK6dLK0w+vQnEo48setoZfs=
MIME-Version: 1.0
Received: by 10.216.87.20 with SMTP id x20mr2708790wee.158.1263959118857; Tue, 
	19 Jan 2010 19:45:18 -0800 (PST)
In-Reply-To: <9ac0c6aa1001190248g2e952aabpa97d47637adeb22e@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <9ac0c6aa1001140239t3504259cx167afb36a3d2ad30@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
	 <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
	 <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
	 <b0f7deba1001172135y68f0fb03m3856c072ccacb83c@mail.gmail.com>
	 <9ac0c6aa1001180342l43ba741bhf187393cdbfc755f@mail.gmail.com>
	 <b0f7deba1001182232o227615e7t7e40bfe7ac9d617d@mail.gmail.com>
	 <9ac0c6aa1001190248g2e952aabpa97d47637adeb22e@mail.gmail.com>
Date: Tue, 19 Jan 2010 20:45:18 -0700
Message-ID: <b0f7deba1001191945oce193cci9ac15a7589d08f93@mail.gmail.com>
Subject: Re: incremental document field update
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

> I see -- so your file format allows you to append to the same file
> without affecting prior readers?  We never do that in Lucene today
> (all files are "write once").

Yes. For the most part it only appends. The exception is when the
log's entry count is updated (when the appends actually "commit").
That count is written into one of many (>= 2 and <= 257) slots in round
robin fashion and finally a byte-size "keystone" is updated to determine
the active slot. The idea is that by flushing the file just before and just
after the keystone byte update we ensure persistence (assumes writing
one byte is always all-or-nothing). Increasing the number of slots
the count is written to narrows the chance of a bad read..

> Good questions (terms dict & stored fields) -- I think what we'd do is
> simply write a new segment, so stored fields, term vectors, postings,
> terms dict, etc., are all private to that new segment.  But, we'd mark
> the segment as being a delta segment, referencing the original
> segment, and we'd remap the docIDs when flushing that segment.

The .fdx and .tvx files use fixed-width tables, so it seems if there are
large gaps in the updated doc-ids, we'd have to fill in "null" rows for
those gaps.  Or do you have another data-structure in mind for these
.*x files?

One solution may be to combine the approaches we described: maintain
doc-id mappings for the .fdx and .tvx files for per-document
data at search time, and index-time mapped doc-ids for the posting
lists.

-Babak

On Tue, Jan 19, 2010 at 3:48 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> On Tue, Jan 19, 2010 at 1:32 AM, Babak Farhang <farhang@gmail.com> wrote:
>>> This is about multiple sessions with the writer.  Ie, open writer,
>>> update a few docs, close.  Do the same again, but, that 2nd session
>>> cannot overwrite the same files from the first one, since readers may
>>> have those files open.  The "write once" model gives Lucene its
>>> transactional semantics, too -- we can keep multiple commits in the
>>> index, open an arbitrary commit, rollback, etc.
>>
>> Ahh, I see. We're worried about the read-consistency of the open readers
>> while there is a concurrent writer. I think that's already taken care of with
>> the fact that under the hood we are only appending data into the logical
>> segment.  When a reader first loads one of our slave segments, it first
>> loads into memory the number of entries in the right-ahead log of mapped
>> doc-ids before reading those number of entries from the log. It could note
>> the max unmapped document number represented in the last entry and
>> discard any document numbers above that max in the postings.
>
> I see -- so your file format allows you to append to the same file
> without affecting prior readers?  We never do that in Lucene today
> (all files are "write once").
>
>>> I think both approaches are O(total size of updates) in indexing cost,
>>> assuming each writes only the new changes, to a new generation
>>> filename.
>>>
>>> But I think at search time the "remap during indexing" approach should
>>> simpler, since you "just" have to OR together N posting lists... and
>>> performance should be better (by a constant factor) since there's no
>>> remapping.
>>
>> I think I see how this approach can work for indexed-only fields. I imagine
>> we also need a parallel dictionary for these mapped postings lists in order
>> to deal with new terms encountered during the update. Not sure how this
>> would work. Can you elaborate?
>>
>> And how would we deal with updated stored fields?
>
> Good questions (terms dict & stored fields) -- I think what we'd do is
> simply write a new segment, so stored fields, term vectors, postings,
> terms dict, etc., are all private to that new segment.  But, we'd mark
> the segment as being a delta segment, referencing the original
> segment, and we'd remap the docIDs when flushing that segment.  Then
> at search time, a single SegmentReader would open its primary segment
> plus any series of delta segments, merging them.
>
> So eg StoredFieldsReader would first load the doc from the primary
> segment, then go and load any deltas, overwriting the field values.
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44600-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 03:59:08 2010
Return-Path: <java-user-return-44600-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92115 invoked from network); 20 Jan 2010 03:59:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 03:59:08 -0000
Received: (qmail 79434 invoked by uid 500); 20 Jan 2010 03:59:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79259 invoked by uid 500); 20 Jan 2010 03:59:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79249 invoked by uid 99); 20 Jan 2010 03:59:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 03:59:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of guido.bartolucci@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 03:58:57 +0000
Received: by pxi16 with SMTP id 16so3417877pxi.29
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 19:58:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:date:message-id
         :subject:from:to:content-type;
        bh=5prWNfIRjEcNUmgRtZS6pZR3djJnC1sS3iedDfzs4Oc=;
        b=Uekgj33LU89cw3I3mYJZFZDDuRF3qhoo67xUpZtK6bEDsN+CFK2jtvJmQdPN53YVpx
         Go0QJjTFp65huKIycHJAW3NDZ54do0QxzmjlRALoaQn9fMFgHfaWr9VhZHrzH2Zr+Rrv
         ti0NUH1HO18GBLYieIqdX+sZDpifOMHARn5PU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:reply-to:date:message-id:subject:from:to:content-type;
        b=xhJ+AwshddPYu7r5KfrMWFecvJETG6nyvPCsKjLgBZCWjJbHDGKuE1ePpGAduxYzm4
         SMu0BOXeqkHEutk8j0/M5jBxp3Fb7w8acQNDAUhVAo1Yc/ippzlO6fcVtrcXN0PtoXyq
         PvnmC2OqI/Yu22jH24bLqEGzP+upk3PLqnoDI=
MIME-Version: 1.0
Received: by 10.114.249.38 with SMTP id w38mr1553718wah.111.1263959916489; 
	Tue, 19 Jan 2010 19:58:36 -0800 (PST)
Reply-To: guido@bartolucci.org
Date: Tue, 19 Jan 2010 19:58:36 -0800
Message-ID: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
Subject: Lucene as a primary datastore
From: Guido Bartolucci <guido.bartolucci@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

I know that the primary use case for Lucene is as an index of data
that can be reconstructed (e.g., from a relational database or from
spidering your corporate intranet).

But, I'm curious if anyone uses Lucene as their primary datastore for
their gold data. Is it good enough?

Would anyone consider (or do people already) store data in Lucene
that, if it was lost, would destroy their business? And no, I'm not
suggesting that you don't back up this data, I'm just curious if there
are problems with using Lucene in this way. Are there subtle
corruptions that might show up in Lucene that wouldn't show up in
Oracle or MySQL?

I'm considering using Lucene in this way but I haven't been able to
find any documentation describing this use case. Are there any studies
of Lucene vs MySQL running for N years comparing the corruptions and
recovery times?

Am I just ignorant and scared of Lucene and too trusting of Oracle and MySQL?

Thanks.

-guido.

(BTW, I did find a similar question asked back in 2007 in the archives
but it doesn't really answer my question)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44601-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 04:11:23 2010
Return-Path: <java-user-return-44601-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94961 invoked from network); 20 Jan 2010 04:11:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 04:11:23 -0000
Received: (qmail 88069 invoked by uid 500); 20 Jan 2010 04:11:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87920 invoked by uid 500); 20 Jan 2010 04:11:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87910 invoked by uid 99); 20 Jan 2010 04:11:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 04:11:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 04:11:13 +0000
Received: by pwi11 with SMTP id 11so3090465pwi.5
        for <java-user@lucene.apache.org>; Tue, 19 Jan 2010 20:10:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=rmgW27MYpdqbiOuuQONnF+1qZEio7PzLQQiljIOZUoc=;
        b=cR7/XIBP0m7qPRC0YehLWoDFUt1WPKNJ697WTCdi+v0/c0/kXx5y6muYjTazwbT5ps
         lfdMzT/zZsldeTi+ISFQD9XWaeM6GKLmyTRk8VaAKLm2lyCTBKOTjmn4TSx2CYyr94MX
         /ipt7Ws6y8ZUDFOBLwmnb7BfRYQyo8dAaBBL0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=bMLHehoq3eG4W7IBwhmubJcN4d4q92QoWrEcMruTyDQ8sdDV25kwH8e4syc6lwG+wH
         2Y+LBhDxD5PcJHdbMaYAIQmfHNPBjLq9Od3d38PpfsDShOjEQTXhRuaB6iyLS35G8gWu
         Cek896R+xBV+dWxSrfmXHmLggsiIripR5eWcs=
MIME-Version: 1.0
Received: by 10.140.82.42 with SMTP id f42mr4140737rvb.52.1263960653559; Tue, 
	19 Jan 2010 20:10:53 -0800 (PST)
In-Reply-To: <856ac15f1001191642k7b579316w62221900ba676b85@mail.gmail.com>
References: <856ac15f1001191642k7b579316w62221900ba676b85@mail.gmail.com>
Date: Tue, 19 Jan 2010 20:10:53 -0800
Message-ID: <85d3c3b61001192010l614c83a7r9120b1b3ec2d7a9c@mail.gmail.com>
Subject: Re: Tag Index patch (LUCENE-1292) status?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Hi Chris,

It's not actively being worked on.  Are you interested in working on it?

Jason

On Tue, Jan 19, 2010 at 4:42 PM, Chris Harris <ryguasu@gmail.com> wrote:
> I'm interested in the Tag Index patch (LUCENE-1292), in particular
> because of how it enables you to modify certain fields without
> reindexing a whole document. However, that issue is marked Lucene
> 2.3.1 and hasn't been updated since July 2008. Can anyone provide any
> status updates on this patch? Questions include:
>
> - Is anyone using this in production?
>
> - Does this work with Lucene 2.9/3.0?
>
> - Is anyone actively working on the patch now?
>
> - Are there any competing approaches now for doing updates to
> particular fields? (I haven't found any yet.)
>
> Thanks,
> Chris
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44602-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 05:16:21 2010
Return-Path: <java-user-return-44602-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8876 invoked from network); 20 Jan 2010 05:16:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 05:16:21 -0000
Received: (qmail 22228 invoked by uid 500); 20 Jan 2010 05:16:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22118 invoked by uid 500); 20 Jan 2010 05:16:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22108 invoked by uid 99); 20 Jan 2010 05:16:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 05:16:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 05:16:07 +0000
Received: (qmail 68097 invoked by uid 60001); 20 Jan 2010 05:15:46 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263964546; bh=94K3nIVzqqQEsJt1a6AE/gSs3k1GBnjNicjF7/3ghaA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=NHQgKKo9VMUvLUkC3O6VjBEKRDnAEYsGOx+9fXJpJUph9TJYPct9oO4fP9HUMCS9mReLb2UYd5/6Q2u5B3sz9A+HlgcyThfOMw2QA/Ts+k57GpJgwyTg2YwKcldM4iM8lz4EzxHb/X7nhHM3bfE7oPaPVAqJwjRQQ7IuBqlWXEA=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=FMPSqC4nqDO0BbjJJjbjAK/OIW1+IyeoYKx+WNgvTu53Y/qIehRcWriQWdTJM0wCfkxR7cv69OjY69Ab/6yJCyxUQQXNgthnpWt9ZFpaqwvZriIZw5pgQXmpA25me5ufqc7QTcuOF1bZZoZ5oejuUDygiFb7YL65XYM9l4OTzcc=;
Message-ID: <672105.67952.qm@web50307.mail.re2.yahoo.com>
X-YMail-OSG: 9VsABmIVM1mLWjtatXV.QkNumJJReHSTy9SPi1xrjPh3bQNw6zpX_fY8sCTQQ6D56ork6bxLfCbTfntnXaRRa_5rZW14nJXEXAJq9y5Cqrl0fv6B_9tdP8lgziu1eQp36LsJOlAzMFEzRHz9mvqrJ3jxLCTyfWcHWmI4xTjFKM3de.OBz.37Ly02WFlxSV6EhXkqQ_LxAU0S7xCAxRgtzZaNgVxF7sUGOd3dS09dN5aBWuDI696HFjuDq90VibnOx6F48uV3e.oa131.KdbpiE9V8Ku.aR8xW.pJTkoGm9ED5s6MOiDz3iCQh_ekl5eeG_ESS1fJH4DoGO2d8Ntn4iV2YS5yxpGRaRvN6GvK2zvqGBjyoQcG65._ecyrri71B6.OyRtcPNRvRpKJw8Nz074_
Received: from [74.73.1.126] by web50307.mail.re2.yahoo.com via HTTP; Tue, 19 Jan 2010 21:15:46 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
Date: Tue, 19 Jan 2010 21:15:46 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Lucene as a primary datastore
To: java-user@lucene.apache.org, guido@bartolucci.org
In-Reply-To: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

You are not alone, Guido.  It's a good question.  In my experience, Lucene is as stable as MySQL/PostgreSQL in terms of its ability to hold your data and not corrupt it.  Of course, even with the most expensive databases, you'd want to make backups.  The same goes with Lucene.  Nowadays, one way people make "backups" is via replication. :)  Solr users thus often get backups for free, as do people who put copies of their data on file systems like HDFS, which tend to have replication turned on.

 Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Guido Bartolucci <guido.bartolucci@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Tue, January 19, 2010 10:58:36 PM
> Subject: Lucene as a primary datastore
> 
> I know that the primary use case for Lucene is as an index of data
> that can be reconstructed (e.g., from a relational database or from
> spidering your corporate intranet).
> 
> But, I'm curious if anyone uses Lucene as their primary datastore for
> their gold data. Is it good enough?
> 
> Would anyone consider (or do people already) store data in Lucene
> that, if it was lost, would destroy their business? And no, I'm not
> suggesting that you don't back up this data, I'm just curious if there
> are problems with using Lucene in this way. Are there subtle
> corruptions that might show up in Lucene that wouldn't show up in
> Oracle or MySQL?
> 
> I'm considering using Lucene in this way but I haven't been able to
> find any documentation describing this use case. Are there any studies
> of Lucene vs MySQL running for N years comparing the corruptions and
> recovery times?
> 
> Am I just ignorant and scared of Lucene and too trusting of Oracle and MySQL?
> 
> Thanks.
> 
> -guido.
> 
> (BTW, I did find a similar question asked back in 2007 in the archives
> but it doesn't really answer my question)
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44603-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 06:14:04 2010
Return-Path: <java-user-return-44603-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33366 invoked from network); 20 Jan 2010 06:14:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 06:14:02 -0000
Received: (qmail 56798 invoked by uid 500); 20 Jan 2010 06:14:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56574 invoked by uid 500); 20 Jan 2010 06:13:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56564 invoked by uid 99); 20 Jan 2010 06:13:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 06:13:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.90] (HELO smtp103.mail.in.yahoo.com) (202.86.5.90)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 06:13:49 +0000
Received: (qmail 5169 invoked from network); 20 Jan 2010 06:13:26 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=5tmeCUF4VTBvjgxaAmkxoKObOidwnZd+0SlcujlNMzGpdP+sJq3K1QOrNQ+wcSxu+MljNKZ6akUd0uWWn1nFrNRCbxV/ycrDfRyHrq5ztMDLnpzztAp8o2x3mZ3HJfqgTh+V/Mok5uY6nu4ZsAaVyrz3j/61BgjJ4Ld1NpRFDj8=  ;
Received: from  (emailgane@203.98.194.130 with login)
        by smtp103.mail.in.yahoo.com with SMTP; 20 Jan 2010 11:43:25 +0530 IST
X-Yahoo-SMTP: JObyHkuswBBrNSLZp.Ycd7Boqpr_GQ--
X-YMail-OSG: ZavoPs4VM1m7Wrk8qqtYTzzYRzFilUVusOEacAQqgWjdQ04QzIk483nEOT1dgUnDEf1XBc9DKDO1K63JwpNObpRaX5tGj3N.nqc_De22SC1K8rwaa7Aw_Ei_8hwNszn1QFm.lE1yTYRZtyFK9MCEWM4vqh8qFsRSKrYHryY8UvysvW51HwnEv0BVuJSSqtsU84get7SIkuyOxVpKNRWCfa6hJh8p6zCpzZsEBp5QpzaCvA--
X-Yahoo-Newman-Property: ymail-3
Message-ID: <AC97BD92CC214408BAB25A90F849C44D@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com> <672105.67952.qm@web50307.mail.re2.yahoo.com>
Subject: Re: Lucene as a primary datastore
Date: Wed, 20 Jan 2010 11:43:21 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.5843
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579

We have data in compound files and we use Lucene as primary database. =
Its working great and much faster with millions of records. The only =
issue, I face is with sorting. Lucene sorting consumes good amount of =
memory. I don't know much about the MySQL/PostgreSQL database, and how =
they behave with millions of records but i guess their sorting memory =
consumption would be less. =20

It would be great, If Lucene has the ability to do backups / =
replication. I don't know how to modify/use the solr script. =20

Regards
Ganesh


----- Original Message -----=20
From: "Otis Gospodnetic" <otis_gospodnetic@yahoo.com>
To: <java-user@lucene.apache.org>; <guido@bartolucci.org>
Sent: Wednesday, January 20, 2010 10:45 AM
Subject: Re: Lucene as a primary datastore


> You are not alone, Guido.  It's a good question.  In my experience, =
Lucene is as stable as MySQL/PostgreSQL in terms of its ability to hold =
your data and not corrupt it.  Of course, even with the most expensive =
databases, you'd want to make backups.  The same goes with Lucene.  =
Nowadays, one way people make "backups" is via replication. :)  Solr =
users thus often get backups for free, as do people who put copies of =
their data on file systems like HDFS, which tend to have replication =
turned on.
>=20
> Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>=20
>=20
>=20
> ----- Original Message ----
>> From: Guido Bartolucci <guido.bartolucci@gmail.com>
>> To: java-user@lucene.apache.org
>> Sent: Tue, January 19, 2010 10:58:36 PM
>> Subject: Lucene as a primary datastore
>>=20
>> I know that the primary use case for Lucene is as an index of data
>> that can be reconstructed (e.g., from a relational database or from
>> spidering your corporate intranet).
>>=20
>> But, I'm curious if anyone uses Lucene as their primary datastore for
>> their gold data. Is it good enough?
>>=20
>> Would anyone consider (or do people already) store data in Lucene
>> that, if it was lost, would destroy their business? And no, I'm not
>> suggesting that you don't back up this data, I'm just curious if =
there
>> are problems with using Lucene in this way. Are there subtle
>> corruptions that might show up in Lucene that wouldn't show up in
>> Oracle or MySQL?
>>=20
>> I'm considering using Lucene in this way but I haven't been able to
>> find any documentation describing this use case. Are there any =
studies
>> of Lucene vs MySQL running for N years comparing the corruptions and
>> recovery times?
>>=20
>> Am I just ignorant and scared of Lucene and too trusting of Oracle =
and MySQL?
>>=20
>> Thanks.
>>=20
>> -guido.
>>=20
>> (BTW, I did find a similar question asked back in 2007 in the =
archives
>> but it doesn't really answer my question)
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44604-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 06:25:30 2010
Return-Path: <java-user-return-44604-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38945 invoked from network); 20 Jan 2010 06:25:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 06:25:30 -0000
Received: (qmail 72460 invoked by uid 500); 20 Jan 2010 06:25:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72310 invoked by uid 500); 20 Jan 2010 06:25:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72298 invoked by uid 99); 20 Jan 2010 06:25:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 06:25:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.60] (HELO web50306.mail.re2.yahoo.com) (206.190.38.60)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 06:25:16 +0000
Received: (qmail 13081 invoked by uid 60001); 20 Jan 2010 06:24:54 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1263968694; bh=+1t9pffLflsEACJqQqS4PU7ym8iTQF+iKCzCIuL8Kgg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=DW1hg/I5LOLDFKYDa6bbwzpwhvq9tkaA1auHpHg2Xrqg1uZIgXnFlxdSOCbpoUg0n6hf/DYK7QOleZsdSRU3/PeYdzMAXi5k3wyKaOLNN0Z+l7bg/D2DZN1CcNU4s4ZcZoyNfMuDwEYAsDenDpuOaKuSNrsM0fUUdmvXebrKKf0=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=lSv0zDZ7vP8igrqkG93iK9DANam7+73rKABJqyfEipngDiRpN2a8LTn2bgEX+T2BxHViqTpCew/Cvd69wzeFNBtLy56m9kiSnSBCVTJKL/MPgQDdNZwxeel8w5B7KqY9nQ0Ul5WULDFyIjg1XGDa46RMiWfEEBa/Z0JhxfGezQ8=;
Message-ID: <905474.12673.qm@web50306.mail.re2.yahoo.com>
X-YMail-OSG: fuqj6n0VM1m0ev2jo66e7MTdYt5W3Ha7NxZD2KQG5ln.iGbR4hM.BNAqFspYcGSZQIHG_05aZJA76B8abZRnBZB0cZKYjWotsfFQYcmCPUsqu0LMZHUs4NA4G3o44aXdD7JKtTnWhlvG9UUfyOIe5S_EwSexyVHqBIYZqL9yVVks1kstWKIkezewMJzLv_VdBSpyHwP_YhwUUCzP0rW.JSwx07fDqFTDFU6L7aeqXpRkY0CJF7t5mJXW1RfnpsoHHCRu5adHJwV_Y04eECih1hM88zGTdNJCcek3SG8O4a1bDQb7wqAK3DACwx_NkjbDbeyPjEGe6perVAfoLDNbxRSWHKfTX4RP5RspqMISuec6dYifixckYPWrUBA1PMMOYIBg57nGpqDuaC9dvcTSRaIJRH2sLnQ1b_g38WjsIb_TLJRg4JeCEmaXiHOCQWgOdLvF.gx5YkA.HWR1PUuxs6.O6WDBT6D4K1IFB2MeNIDyjjVh1ia06tQPzt3vo9Nv7kA18uqjDCSZf8nto3lH63Urfg--
Received: from [74.73.1.126] by web50306.mail.re2.yahoo.com via HTTP; Tue, 19 Jan 2010 22:24:54 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com> <672105.67952.qm@web50307.mail.re2.yahoo.com> <AC97BD92CC214408BAB25A90F849C44D@sv.us.sonicwall.com>
Date: Tue, 19 Jan 2010 22:24:54 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Lucene as a primary datastore
To: java-user@lucene.apache.org
In-Reply-To: <AC97BD92CC214408BAB25A90F849C44D@sv.us.sonicwall.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Have you seen the "Hot Backups with Lucene" paper available via http://www.manning.com/hatcher3/ ?

 
Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Ganesh <emailgane@yahoo.co.in>
> To: java-user@lucene.apache.org
> Sent: Wed, January 20, 2010 1:13:21 AM
> Subject: Re: Lucene as a primary datastore
> 
> We have data in compound files and we use Lucene as primary database. Its 
> working great and much faster with millions of records. The only issue, I face 
> is with sorting. Lucene sorting consumes good amount of memory. I don't know 
> much about the MySQL/PostgreSQL database, and how they behave with millions of 
> records but i guess their sorting memory consumption would be less.  
> 
> It would be great, If Lucene has the ability to do backups / replication. I 
> don't know how to modify/use the solr script.  
> 
> Regards
> Ganesh
> 
> 
> ----- Original Message ----- 
> From: "Otis Gospodnetic" 
> To: ; 
> Sent: Wednesday, January 20, 2010 10:45 AM
> Subject: Re: Lucene as a primary datastore
> 
> 
> > You are not alone, Guido.  It's a good question.  In my experience, Lucene is 
> as stable as MySQL/PostgreSQL in terms of its ability to hold your data and not 
> corrupt it.  Of course, even with the most expensive databases, you'd want to 
> make backups.  The same goes with Lucene.  Nowadays, one way people make 
> "backups" is via replication. :)  Solr users thus often get backups for free, as 
> do people who put copies of their data on file systems like HDFS, which tend to 
> have replication turned on.
> > 
> > Otis
> > --
> > Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
> > 
> > 
> > 
> > ----- Original Message ----
> >> From: Guido Bartolucci 
> >> To: java-user@lucene.apache.org
> >> Sent: Tue, January 19, 2010 10:58:36 PM
> >> Subject: Lucene as a primary datastore
> >> 
> >> I know that the primary use case for Lucene is as an index of data
> >> that can be reconstructed (e.g., from a relational database or from
> >> spidering your corporate intranet).
> >> 
> >> But, I'm curious if anyone uses Lucene as their primary datastore for
> >> their gold data. Is it good enough?
> >> 
> >> Would anyone consider (or do people already) store data in Lucene
> >> that, if it was lost, would destroy their business? And no, I'm not
> >> suggesting that you don't back up this data, I'm just curious if there
> >> are problems with using Lucene in this way. Are there subtle
> >> corruptions that might show up in Lucene that wouldn't show up in
> >> Oracle or MySQL?
> >> 
> >> I'm considering using Lucene in this way but I haven't been able to
> >> find any documentation describing this use case. Are there any studies
> >> of Lucene vs MySQL running for N years comparing the corruptions and
> >> recovery times?
> >> 
> >> Am I just ignorant and scared of Lucene and too trusting of Oracle and MySQL?
> >> 
> >> Thanks.
> >> 
> >> -guido.
> >> 
> >> (BTW, I did find a similar question asked back in 2007 in the archives
> >> but it doesn't really answer my question)
> >> 
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > 
> > 
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> Send instant messages to your online friends http://in.messenger.yahoo.com
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44605-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 07:27:50 2010
Return-Path: <java-user-return-44605-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63739 invoked from network); 20 Jan 2010 07:27:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 07:27:50 -0000
Received: (qmail 38315 invoked by uid 500); 20 Jan 2010 07:27:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38241 invoked by uid 500); 20 Jan 2010 07:27:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38231 invoked by uid 99); 20 Jan 2010 07:27:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 07:27:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.36] (HELO smtp109.mail.in.yahoo.com) (202.86.5.36)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 07:27:38 +0000
Received: (qmail 86740 invoked from network); 20 Jan 2010 07:27:15 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:References:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=gfbBAhcvZGJoyxLftTi4Z9d3wqhP5tjrMRkAAcYmMJg/m4HGgNYndZv356d67KX+4hoTYW18l0BRy9kIHCl1LcTcirPInOxMG+m2jtTPDvcZNKvOXdg1BqbDPGrJNYBOIytKNFcudARrImldUt1BoIkD6WGta0YpY8y/ebRSekg=  ;
Received: from unknown (HELO GaneshM) (emailgane@203.98.194.130 with login)
  by smtp109.mail.in.yahoo.com with SMTP; 20 Jan 2010 07:27:14 -0000
X-Yahoo-SMTP: UautoMGswBCijiDZb3m7wS2y3hHHGA--
X-YMail-OSG: Hbfw2BUVM1k4tsO54vipZqbmETt4aWiBSwcyDpIZKopGiElFXKcEMiBIK.ex5pvHTm3ZQSf4Tl1vlH0CKSib8LfmFhtzPMkXUtDy_GznSgsI6TBVnhdZowIanxs1rmUmOXc_Ev8.RBC5ePaRdPszXN2.rChE6yQay4sUJT4RRwc2O_PDqg7X6eHVqbzONynO1n58L8_epwAcztFz36K2yApdvH9VGpc92v7XK5SWslWnTK_tBOsgYsMVcLlIEtvPXjHvZDe0lcSING9u
X-Yahoo-Newman-Property: ymail-3
Message-ID: <D89B9FF19E0A4006B3E10F77E2EFE764@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com> <672105.67952.qm@web50307.mail.re2.yahoo.com> <AC97BD92CC214408BAB25A90F849C44D@sv.us.sonicwall.com> <905474.12673.qm@web50306.mail.re2.yahoo.com>
Subject: Re: Lucene as a primary datastore
Date: Wed, 20 Jan 2010 12:57:11 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.5843
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579

Thanks Otis. The download link sent via email has file called cemail. =
There is no extn. I tried with html,pdf but it is not opening properly.

Regards
Ganesh

----- Original Message -----=20
From: "Otis Gospodnetic" <otis_gospodnetic@yahoo.com>
To: <java-user@lucene.apache.org>
Sent: Wednesday, January 20, 2010 11:54 AM
Subject: Re: Lucene as a primary datastore


> Have you seen the "Hot Backups with Lucene" paper available via =
http://www.manning.com/hatcher3/ ?
>=20
>=20
> Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>=20
>=20
>=20
> ----- Original Message ----
>> From: Ganesh <emailgane@yahoo.co.in>
>> To: java-user@lucene.apache.org
>> Sent: Wed, January 20, 2010 1:13:21 AM
>> Subject: Re: Lucene as a primary datastore
>>=20
>> We have data in compound files and we use Lucene as primary database. =
Its=20
>> working great and much faster with millions of records. The only =
issue, I face=20
>> is with sorting. Lucene sorting consumes good amount of memory. I =
don't know=20
>> much about the MySQL/PostgreSQL database, and how they behave with =
millions of=20
>> records but i guess their sorting memory consumption would be less. =20
>>=20
>> It would be great, If Lucene has the ability to do backups / =
replication. I=20
>> don't know how to modify/use the solr script. =20
>>=20
>> Regards
>> Ganesh
>>=20
>>=20
>> ----- Original Message -----=20
>> From: "Otis Gospodnetic"=20
>> To: ;=20
>> Sent: Wednesday, January 20, 2010 10:45 AM
>> Subject: Re: Lucene as a primary datastore
>>=20
>>=20
>> > You are not alone, Guido.  It's a good question.  In my experience, =
Lucene is=20
>> as stable as MySQL/PostgreSQL in terms of its ability to hold your =
data and not=20
>> corrupt it.  Of course, even with the most expensive databases, you'd =
want to=20
>> make backups.  The same goes with Lucene.  Nowadays, one way people =
make=20
>> "backups" is via replication. :)  Solr users thus often get backups =
for free, as=20
>> do people who put copies of their data on file systems like HDFS, =
which tend to=20
>> have replication turned on.
>> >=20
>> > Otis
>> > --
>> > Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>> >=20
>> >=20
>> >=20
>> > ----- Original Message ----
>> >> From: Guido Bartolucci=20
>> >> To: java-user@lucene.apache.org
>> >> Sent: Tue, January 19, 2010 10:58:36 PM
>> >> Subject: Lucene as a primary datastore
>> >>=20
>> >> I know that the primary use case for Lucene is as an index of data
>> >> that can be reconstructed (e.g., from a relational database or =
from
>> >> spidering your corporate intranet).
>> >>=20
>> >> But, I'm curious if anyone uses Lucene as their primary datastore =
for
>> >> their gold data. Is it good enough?
>> >>=20
>> >> Would anyone consider (or do people already) store data in Lucene
>> >> that, if it was lost, would destroy their business? And no, I'm =
not
>> >> suggesting that you don't back up this data, I'm just curious if =
there
>> >> are problems with using Lucene in this way. Are there subtle
>> >> corruptions that might show up in Lucene that wouldn't show up in
>> >> Oracle or MySQL?
>> >>=20
>> >> I'm considering using Lucene in this way but I haven't been able =
to
>> >> find any documentation describing this use case. Are there any =
studies
>> >> of Lucene vs MySQL running for N years comparing the corruptions =
and
>> >> recovery times?
>> >>=20
>> >> Am I just ignorant and scared of Lucene and too trusting of Oracle =
and MySQL?
>> >>=20
>> >> Thanks.
>> >>=20
>> >> -guido.
>> >>=20
>> >> (BTW, I did find a similar question asked back in 2007 in the =
archives
>> >> but it doesn't really answer my question)
>> >>=20
>> >> =
---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >=20
>> >=20
>> > =
---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> Send instant messages to your online friends =
http://in.messenger.yahoo.com
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44606-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 08:11:51 2010
Return-Path: <java-user-return-44606-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70759 invoked from network); 20 Jan 2010 08:11:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 08:11:51 -0000
Received: (qmail 76665 invoked by uid 500); 20 Jan 2010 08:11:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76600 invoked by uid 500); 20 Jan 2010 08:11:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76590 invoked by uid 99); 20 Jan 2010 08:11:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 08:11:48 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of pkiraly@tesuji.eu designates 62.149.196.21 as permitted sender)
Received: from [62.149.196.21] (HELO tesuji.eu) (62.149.196.21)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 08:11:39 +0000
Received: from skoda (DSLve6quo.adsl.datanet.hu [195.56.3.211])
	by tesuji.eu (Postfix) with ESMTP id 4AC2768D420
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 09:15:15 +0100 (CET)
Message-ID: <E043FD9C83F4449F9EC0965990C2F40B@skoda>
From: =?ISO-8859-1?Q?Kir=E1ly_P=E9ter?= <pkiraly@tesuji.eu>
To: <java-user@lucene.apache.org>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
Subject: Re: Lucene as a primary datastore
Date: Wed, 20 Jan 2010 09:11:11 +0100
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="ISO-8859-1";
	reply-type=original
Content-Transfer-Encoding: 8bit
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.5843
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579
X-Virus-Checked: Checked by ClamAV on apache.org

Hi, I am using Lucene for the same purpose since years.
I import an XML files with records, and in Lucene there is a special
field, which stores the original XML (this used for displaying
with XSLT), the other fields are for searching. There is a webform,
where the users can modify the data. If users click "submit"
the application re-creates the XML and the normal fields.
I have an 'exporter' utility, which can dump the XML fields into
one file - this is used for creating a backup of data.

(I prefer to store the non binary data for archival purpose, than
an older Lucene index (or MySQL table) - I got very wrong
experience with incopatibily issues of MS Word, PDF etc.
formats.)

Pter

----- Original Message ----- 
From: "Guido Bartolucci" <guido.bartolucci@gmail.com>
To: <java-user@lucene.apache.org>
Sent: Wednesday, January 20, 2010 4:58 AM
Subject: Lucene as a primary datastore


>I know that the primary use case for Lucene is as an index of data
> that can be reconstructed (e.g., from a relational database or from
> spidering your corporate intranet).
>
> But, I'm curious if anyone uses Lucene as their primary datastore for
> their gold data. Is it good enough?
>
> Would anyone consider (or do people already) store data in Lucene
> that, if it was lost, would destroy their business? And no, I'm not
> suggesting that you don't back up this data, I'm just curious if there
> are problems with using Lucene in this way. Are there subtle
> corruptions that might show up in Lucene that wouldn't show up in
> Oracle or MySQL?
>
> I'm considering using Lucene in this way but I haven't been able to
> find any documentation describing this use case. Are there any studies
> of Lucene vs MySQL running for N years comparing the corruptions and
> recovery times?
>
> Am I just ignorant and scared of Lucene and too trusting of Oracle and 
> MySQL?
>
> Thanks.
>
> -guido.
>
> (BTW, I did find a similar question asked back in 2007 in the archives
> but it doesn't really answer my question)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44607-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 10:31:09 2010
Return-Path: <java-user-return-44607-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24183 invoked from network); 20 Jan 2010 10:31:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 10:31:08 -0000
Received: (qmail 18337 invoked by uid 500); 20 Jan 2010 10:31:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18261 invoked by uid 500); 20 Jan 2010 10:31:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18251 invoked by uid 99); 20 Jan 2010 10:31:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 10:31:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ryguasu@gmail.com designates 209.85.221.188 as permitted sender)
Received: from [209.85.221.188] (HELO mail-qy0-f188.google.com) (209.85.221.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 10:30:58 +0000
Received: by qyk26 with SMTP id 26so1773455qyk.5
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 02:30:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=QOljJS+X8gR9LkQOMzHzBcak4/bPbQHJ8ddnTr7xizw=;
        b=qipxFCTg1kncZ5R9h6KSiCSEUvIkwq2N8MlFGDmNhCMkUeqxte5x5FPW08VX8jrY4V
         EjuJqzBI8wKY4wbM3zL854bHoH8CQ2KOuEHOTs2/h32zR5zuA1K4wVvz7T49/IeOXQIu
         vishea44d3ojrVJtDHa8ghg6+DlEqps9/TGww=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=YN40dmN0geh+q+8r1e6hQmCTGnEwJGiTSYat+dc98f9quicKEYNPqGFXEQ6IsLW+5B
         yJansiPyWXruL/yc3cPMl8O/N+xddSXQtB5ha4C71QcLl0MY/RO8v9oF8KbbjBoUQ7BD
         j+HfFoidbwRXysV4vT3B6U8vV7plhCbZBwMj4=
MIME-Version: 1.0
Received: by 10.220.121.214 with SMTP id i22mr229404vcr.65.1263983437174; Wed, 
	20 Jan 2010 02:30:37 -0800 (PST)
In-Reply-To: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
From: Chris Harris <ryguasu@gmail.com>
Date: Wed, 20 Jan 2010 02:30:17 -0800
Message-ID: <856ac15f1001200230g6a95ea0dp50c1502a4c6ac575@mail.gmail.com>
Subject: Re: Lucene as a primary datastore
To: java-user@lucene.apache.org, guido@bartolucci.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

I don't do a lot of work with straight Lucene right now, but I do use
Solr, and from time to time the Lucene index inside my master Solr
server gets corrupted; in particular, some of the Lucene segment files
that are still in use somehow get deleted, resulting in Lucene
throwing FileNotFoundExceptions. Once this happens, I have to either
rebuild the whole index, or else run the Lucene CheckIndex tool in
"fix" mode, which renders the index operable again, but at the expense
of throwing away some of the data. This happens rarely, and I haven't
been able to diagnose it yet. In the meantime, though, I find it
somewhat reassuring to know that my source data is in a SQL table.

I don't know that this experience is relevant to you; my problem could
come from a variety of sources outside Lucene, including a potential
bug in Solr, and user error on my part. All the same, perhaps it would
be worth searching the mailing list archives for FileNotFound, to see
what else comes up?

On Tue, Jan 19, 2010 at 7:58 PM, Guido Bartolucci
<guido.bartolucci@gmail.com> wrote:
> I know that the primary use case for Lucene is as an index of data
> that can be reconstructed (e.g., from a relational database or from
> spidering your corporate intranet).
>
> But, I'm curious if anyone uses Lucene as their primary datastore for
> their gold data. Is it good enough?
>
> Would anyone consider (or do people already) store data in Lucene
> that, if it was lost, would destroy their business? And no, I'm not
> suggesting that you don't back up this data, I'm just curious if there
> are problems with using Lucene in this way. Are there subtle
> corruptions that might show up in Lucene that wouldn't show up in
> Oracle or MySQL?
>
> I'm considering using Lucene in this way but I haven't been able to
> find any documentation describing this use case. Are there any studies
> of Lucene vs MySQL running for N years comparing the corruptions and
> recovery times?
>
> Am I just ignorant and scared of Lucene and too trusting of Oracle and MySQL?
>
> Thanks.
>
> -guido.
>
> (BTW, I did find a similar question asked back in 2007 in the archives
> but it doesn't really answer my question)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44608-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 10:41:35 2010
Return-Path: <java-user-return-44608-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29288 invoked from network); 20 Jan 2010 10:41:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 10:41:35 -0000
Received: (qmail 32628 invoked by uid 500); 20 Jan 2010 10:41:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32566 invoked by uid 500); 20 Jan 2010 10:41:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32556 invoked by uid 99); 20 Jan 2010 10:41:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 10:41:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 10:41:25 +0000
Received: by gxk8 with SMTP id 8so263500gxk.11
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 02:41:04 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.214.12 with SMTP id m12mr9271264ybg.342.1263984064391; 
	Wed, 20 Jan 2010 02:41:04 -0800 (PST)
In-Reply-To: <b0f7deba1001191945oce193cci9ac15a7589d08f93@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <b0f7deba1001170133u481919eci2722078b126ff510@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
	 <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
	 <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
	 <b0f7deba1001172135y68f0fb03m3856c072ccacb83c@mail.gmail.com>
	 <9ac0c6aa1001180342l43ba741bhf187393cdbfc755f@mail.gmail.com>
	 <b0f7deba1001182232o227615e7t7e40bfe7ac9d617d@mail.gmail.com>
	 <9ac0c6aa1001190248g2e952aabpa97d47637adeb22e@mail.gmail.com>
	 <b0f7deba1001191945oce193cci9ac15a7589d08f93@mail.gmail.com>
Date: Wed, 20 Jan 2010 05:41:04 -0500
Message-ID: <9ac0c6aa1001200241g1331cf7pea609c685d5838a4@mail.gmail.com>
Subject: Re: incremental document field update
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Tue, Jan 19, 2010 at 10:45 PM, Babak Farhang <farhang@gmail.com> wrote:
>> I see -- so your file format allows you to append to the same file
>> without affecting prior readers? =A0We never do that in Lucene today
>> (all files are "write once").
>
> Yes. For the most part it only appends. The exception is when the
> log's entry count is updated (when the appends actually "commit").
> That count is written into one of many (>=3D 2 and <=3D 257) slots in rou=
nd
> robin fashion and finally a byte-size "keystone" is updated to determine
> the active slot. The idea is that by flushing the file just before and ju=
st
> after the keystone byte update we ensure persistence (assumes writing
> one byte is always all-or-nothing). Increasing the number of slots
> the count is written to narrows the chance of a bad read..

OK; this approach (modifying an already written & possible in-use (by
an IndexReader) file) would be problematic for Lucene...

>> Good questions (terms dict & stored fields) -- I think what we'd do is
>> simply write a new segment, so stored fields, term vectors, postings,
>> terms dict, etc., are all private to that new segment. =A0But, we'd mark
>> the segment as being a delta segment, referencing the original
>> segment, and we'd remap the docIDs when flushing that segment.
>
> The .fdx and .tvx files use fixed-width tables, so it seems if there are
> large gaps in the updated doc-ids, we'd have to fill in "null" rows for
> those gaps. =A0Or do you have another data-structure in mind for these
> .*x files?

Yeah, good point; we'd have to allow for a sparse index storage for fdx/tvx=
.

> One solution may be to combine the approaches we described: maintain
> doc-id mappings for the .fdx and .tvx files for per-document
> data at search time, and index-time mapped doc-ids for the posting
> lists.

True, we could do both...

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44609-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 13:30:15 2010
Return-Path: <java-user-return-44609-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83319 invoked from network); 20 Jan 2010 13:30:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 13:30:15 -0000
Received: (qmail 29109 invoked by uid 500); 20 Jan 2010 13:30:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29054 invoked by uid 500); 20 Jan 2010 13:30:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29044 invoked by uid 99); 20 Jan 2010 13:30:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 13:30:12 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [192.112.254.51] (HELO smtp2.bedag.ch) (192.112.254.51)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 13:30:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by smtp1.bedag.ch (Postfix) with ESMTP id A9610739FD
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 14:29:43 +0100 (CET)
X-Quarantine-ID: <rlO5grD6ANcF>
X-Virus-Scanned: Scanned
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA99D4.9E3E7583"
Subject: NFS, Stale File Handle Problem and my thoughts....
Date: Wed, 20 Jan 2010 14:29:40 +0100
Message-ID: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: NFS, Stale File Handle Problem and my thoughts....
Thread-Index: AcqZ1J5Recsjg4P1TlS00G2d7MWjuQ==
From: "Sertic Mirko, Bedag" <Mirko.Sertic@bedag.ch>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 20 Jan 2010 13:29:40.0428 (UTC) FILETIME=[9E7848C0:01CA99D4]
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA99D4.9E3E7583
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi@all

=20

We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
stored on a common NFS share. Every box has a single IndexReader
instance, and one Box has an IndexWriter instance, adding new documents
or deleting existing documents at a given point in time. After adding or
deleting the documents, a IndexWriter.optimize() is called. Every box
checks periodically with IndexReader.isCurrent if the index needs to be
reopened.

=20

Now, we are encountering a "Stale file handle" error on box b after the
index was modified and optimized by box a.

=20

As far as i understand the problem with NFS is that box b tries to
open/access a file that was deleted by box a on the NFS share.

=20

The question is now, when are files deleted? Does only the index
optimization delete files, or can files be deleted just by adding or
removing documents from an existing index?=20

=20

I now that there might be a better setup with Lucene and index
replication, but this is an existing application and we cannot change
the architecture now. So what would be the best solution?

=20

Can I just "change" the way Lucene deletes files? I think that just
renaming no longer needed files would be good on NFS. After every
IndexReader has reopened the index, the renamed files can be safely
deleted, as they are definitely no longer needed. Where would be the
hook point? I heard something about IndexDeletionPolicy....

=20

Thanks in advance!

=20

Mirko

=20


------_=_NextPart_001_01CA99D4.9E3E7583--

From java-user-return-44610-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 13:45:26 2010
Return-Path: <java-user-return-44610-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91964 invoked from network); 20 Jan 2010 13:45:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 13:45:26 -0000
Received: (qmail 57209 invoked by uid 500); 20 Jan 2010 13:45:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57139 invoked by uid 500); 20 Jan 2010 13:45:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57129 invoked by uid 99); 20 Jan 2010 13:45:23 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 13:45:23 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 13:45:15 +0000
Received: by yxe30 with SMTP id 30so1769540yxe.29
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 05:44:54 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.25.6 with SMTP id c6mr128161ybj.243.1263995094416; Wed, 20 
	Jan 2010 05:44:54 -0800 (PST)
In-Reply-To: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
Date: Wed, 20 Jan 2010 08:44:54 -0500
Message-ID: <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
Subject: Re: NFS, Stale File Handle Problem and my thoughts....
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Right, you just need to make a custom IndexDeletionPolicy.  NFS makes
no effort to protect deletion of still-open files.

A simple approach is one that only deletes a commit if it's more than
XXX minutes/hours old, such that XXX is set higher than the frequency
that IndexReaders are guaranteed to have reopened.

The TestDeletionPolicy unit test in Lucene's sources has the
ExperiationTimeDeletionPolicy that you can use (but scrutinize!).

Another alternative is to simply reopen the reader whenever you hit
Stale file handle (think of it as NFS's means of notifying you that
your reader is no longer current ;) ).  But, if reopen time is
potentially long for your app, it's no good to make queries pay that
cost and the deletion policy is better.

Mike

On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch> wrote:
> Hi@all
>
>
>
> We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
> stored on a common NFS share. Every box has a single IndexReader
> instance, and one Box has an IndexWriter instance, adding new documents
> or deleting existing documents at a given point in time. After adding or
> deleting the documents, a IndexWriter.optimize() is called. Every box
> checks periodically with IndexReader.isCurrent if the index needs to be
> reopened.
>
>
>
> Now, we are encountering a "Stale file handle" error on box b after the
> index was modified and optimized by box a.
>
>
>
> As far as i understand the problem with NFS is that box b tries to
> open/access a file that was deleted by box a on the NFS share.
>
>
>
> The question is now, when are files deleted? Does only the index
> optimization delete files, or can files be deleted just by adding or
> removing documents from an existing index?
>
>
>
> I now that there might be a better setup with Lucene and index
> replication, but this is an existing application and we cannot change
> the architecture now. So what would be the best solution?
>
>
>
> Can I just "change" the way Lucene deletes files? I think that just
> renaming no longer needed files would be good on NFS. After every
> IndexReader has reopened the index, the renamed files can be safely
> deleted, as they are definitely no longer needed. Where would be the
> hook point? I heard something about IndexDeletionPolicy....
>
>
>
> Thanks in advance!
>
>
>
> Mirko
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44611-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 13:59:59 2010
Return-Path: <java-user-return-44611-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97835 invoked from network); 20 Jan 2010 13:59:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 13:59:58 -0000
Received: (qmail 77440 invoked by uid 500); 20 Jan 2010 13:59:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77372 invoked by uid 500); 20 Jan 2010 13:59:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77362 invoked by uid 99); 20 Jan 2010 13:59:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 13:59:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.78.27 as permitted sender)
Received: from [74.125.78.27] (HELO ey-out-2122.google.com) (74.125.78.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 13:59:49 +0000
Received: by ey-out-2122.google.com with SMTP id d26so1418691eyd.3
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 05:59:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uyH375vOAyWsBzfnM08wxH/vQnewogqBzUFVKXIsI1Y=;
        b=FOBZuImJlSmDy3hUKA4vjBMduanxAaphPc9A8Dunu2M2MqCwdoULHDuL2r7sv1XJx7
         WxRSV9T0bv+NC/WiaGPy4/DeJ+3NLxXOiRqzvphWpG6dEe7wrisKpnIBx8jysO91YDTr
         cGyxNmxuj61XzGcU21acn10D9slTrwyydSZQE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=fjf4t52BYXiqTZDNS6/Mr72faBUwRF04UUmRyjFg/7RjLZzU9+Ws43EDKRtPd1LMOx
         +c6/K1pMqgILB/Z19ygtokZEkUByU/Xb9seZ/AEvs9/B8OUD/vwYwXCCSwnd/vG6+eOI
         NpwtxzSEGWuSmJwVdRKqXkM8lLf5cObemiOQU=
MIME-Version: 1.0
Received: by 10.216.88.83 with SMTP id z61mr1104wee.140.1263995967761; Wed, 20 
	Jan 2010 05:59:27 -0800 (PST)
In-Reply-To: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
Date: Wed, 20 Jan 2010 08:59:27 -0500
Message-ID: <359a92831001200559h747901a5pce7b5f495a3d2654@mail.gmail.com>
Subject: Re: Lucene as a primary datastore
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d64177a7f05f047d98fe7f

--0016e6d64177a7f05f047d98fe7f
Content-Type: text/plain; charset=ISO-8859-1

My preference is to put the effort into preserving the original
source on the theory that I'm sure no information is lost that
way. So the suitability of Lucene to store it varies depending
upon the source IMO.

If it's raw text, then storing all the raw text in an un-indexed
field in Lucene might suit you well. But if it's a database,
there may be lots of meta-data codified in the design
(e.g. foreign keys, required fields, etc) that's hard to
preserve outside a DB, and that you may need someday....

So that's the first question I'd explore....

Erick

On Tue, Jan 19, 2010 at 10:58 PM, Guido Bartolucci <
guido.bartolucci@gmail.com> wrote:

> I know that the primary use case for Lucene is as an index of data
> that can be reconstructed (e.g., from a relational database or from
> spidering your corporate intranet).
>
> But, I'm curious if anyone uses Lucene as their primary datastore for
> their gold data. Is it good enough?
>
> Would anyone consider (or do people already) store data in Lucene
> that, if it was lost, would destroy their business? And no, I'm not
> suggesting that you don't back up this data, I'm just curious if there
> are problems with using Lucene in this way. Are there subtle
> corruptions that might show up in Lucene that wouldn't show up in
> Oracle or MySQL?
>
> I'm considering using Lucene in this way but I haven't been able to
> find any documentation describing this use case. Are there any studies
> of Lucene vs MySQL running for N years comparing the corruptions and
> recovery times?
>
> Am I just ignorant and scared of Lucene and too trusting of Oracle and
> MySQL?
>
> Thanks.
>
> -guido.
>
> (BTW, I did find a similar question asked back in 2007 in the archives
> but it doesn't really answer my question)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d64177a7f05f047d98fe7f--

From java-user-return-44612-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 14:06:14 2010
Return-Path: <java-user-return-44612-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 792 invoked from network); 20 Jan 2010 14:06:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 14:06:14 -0000
Received: (qmail 90539 invoked by uid 500); 20 Jan 2010 14:06:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90476 invoked by uid 500); 20 Jan 2010 14:06:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90318 invoked by uid 99); 20 Jan 2010 14:06:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 14:06:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [192.112.254.51] (HELO smtp2.bedag.ch) (192.112.254.51)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 14:06:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by smtp1.bedag.ch (Postfix) with ESMTP id B05B27398A
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 15:05:39 +0100 (CET)
X-Quarantine-ID: <FkTtx2GgPIfK>
X-Virus-Scanned: Scanned
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: AW: NFS, Stale File Handle Problem and my thoughts....
Date: Wed, 20 Jan 2010 15:05:34 +0100
Message-ID: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: NFS, Stale File Handle Problem and my thoughts....
Thread-Index: AcqZ1tMiqRMMtEklR12D7d+6AZ40kwAAVuIA
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
From: "Sertic Mirko, Bedag" <Mirko.Sertic@bedag.ch>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 20 Jan 2010 14:05:35.0014 (UTC) FILETIME=[A2B40460:01CA99D9]

Hi Mike

Thank you for your feedback!

So I would need the following setup:

a) Machine A with custom IndexDeletionPolicy and single IndexReader =
instance
b) Machine B with custom IndexDeletionPolicy and single IndexReader =
instance
c) Machine A and B periodically check if the index needs to be reopened, =
at least at 12 o'clock
d) Machine A runs an Index update and optimization at 8 o'clock, using =
the IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the =
files to be deleted.
e) On Machine A, the no longer needed files are taken from the =
IndexDeletionPolicy, and deleted at 12:30. At this point the files to be =
deleted should no longer be required by any IndexReader and can be =
safely deleted.

So the IndexDeletionPolicy should be a kind of Singleton, and in fact =
would only be needed on Machine A, as only here index modifications are =
made. Machine B has read only access.

Would this be a valid setup? The only limitation is there is only ONE =
IndexWriter box, and multiple IndexReader boxes. Based on our =
requirements, this should fix very well. I really want to avoid some =
kind of index replication between the boxes...

Regards
Mirko



-----Urspr=FCngliche Nachricht-----
Von: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Gesendet: Mittwoch, 20. Januar 2010 14:45
An: java-user@lucene.apache.org
Betreff: Re: NFS, Stale File Handle Problem and my thoughts....

Right, you just need to make a custom IndexDeletionPolicy.  NFS makes
no effort to protect deletion of still-open files.

A simple approach is one that only deletes a commit if it's more than
XXX minutes/hours old, such that XXX is set higher than the frequency
that IndexReaders are guaranteed to have reopened.

The TestDeletionPolicy unit test in Lucene's sources has the
ExperiationTimeDeletionPolicy that you can use (but scrutinize!).

Another alternative is to simply reopen the reader whenever you hit
Stale file handle (think of it as NFS's means of notifying you that
your reader is no longer current ;) ).  But, if reopen time is
potentially long for your app, it's no good to make queries pay that
cost and the deletion policy is better.

Mike

On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch> wrote:
> Hi@all
>
>
>
> We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
> stored on a common NFS share. Every box has a single IndexReader
> instance, and one Box has an IndexWriter instance, adding new =
documents
> or deleting existing documents at a given point in time. After adding =
or
> deleting the documents, a IndexWriter.optimize() is called. Every box
> checks periodically with IndexReader.isCurrent if the index needs to =
be
> reopened.
>
>
>
> Now, we are encountering a "Stale file handle" error on box b after =
the
> index was modified and optimized by box a.
>
>
>
> As far as i understand the problem with NFS is that box b tries to
> open/access a file that was deleted by box a on the NFS share.
>
>
>
> The question is now, when are files deleted? Does only the index
> optimization delete files, or can files be deleted just by adding or
> removing documents from an existing index?
>
>
>
> I now that there might be a better setup with Lucene and index
> replication, but this is an existing application and we cannot change
> the architecture now. So what would be the best solution?
>
>
>
> Can I just "change" the way Lucene deletes files? I think that just
> renaming no longer needed files would be good on NFS. After every
> IndexReader has reopened the index, the renamed files can be safely
> deleted, as they are definitely no longer needed. Where would be the
> hook point? I heard something about IndexDeletionPolicy....
>
>
>
> Thanks in advance!
>
>
>
> Mirko
>
>
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44613-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 14:12:08 2010
Return-Path: <java-user-return-44613-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5305 invoked from network); 20 Jan 2010 14:12:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 14:12:08 -0000
Received: (qmail 1320 invoked by uid 500); 20 Jan 2010 14:12:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1251 invoked by uid 500); 20 Jan 2010 14:12:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1240 invoked by uid 99); 20 Jan 2010 14:12:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 14:12:05 +0000
X-ASF-Spam-Status: No, hits=-2.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.18.3.26] (HELO exprod8og113.obsmtp.com) (64.18.3.26)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 14:11:57 +0000
Received: from source ([208.78.78.2]) by exprod8ob113.postini.com ([64.18.7.12]) with SMTP
	ID DSNKS1cPGKwo6A53/GvWA+PfUdW1Sk82Epv/@postini.com; Wed, 20 Jan 2010 06:11:37 PST
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Lucene as a primary datastore
Date: Wed, 20 Jan 2010 09:11:35 -0500
Message-ID: <214FF1B5E37DC84D9968F0F82FBB112505FED738@AUGEXCH.ghsinc.com>
In-Reply-To: <359a92831001200559h747901a5pce7b5f495a3d2654@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene as a primary datastore
Thread-Index: AcqZ2Nmyx+qQgPRjQCabdvmDhmcH2AAAF93w
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com> <359a92831001200559h747901a5pce7b5f495a3d2654@mail.gmail.com>
From: "Darren Hartford" <dhartford@ghsinc.com>
To: <java-user@lucene.apache.org>

My two cents is no, not to use lucene as a primary datastore.  Although
there are some datastores that look similar to lucene who define
themselves as primary datastores (the 'nosql' style datastores), I would
put lucene besides the likes of RRD and other specifically purposed
information stores that are about providing information and
functionality, but not necessarily be the gatekeeper of your raw (gold)
data.

Caveat: My definition of raw, or 'gold', data is detailed data and the
audit/transaction history to identify the origin of the detailed data.
So it's not just the end result (often called 'current') data, it's all
the data on how it got to the current state and as it fluctuates over
time. =20

My two coppers,

-D




-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Wednesday, January 20, 2010 8:59 AM
To: java-user@lucene.apache.org
Subject: Re: Lucene as a primary datastore

My preference is to put the effort into preserving the original
source on the theory that I'm sure no information is lost that
way. So the suitability of Lucene to store it varies depending
upon the source IMO.

If it's raw text, then storing all the raw text in an un-indexed
field in Lucene might suit you well. But if it's a database,
there may be lots of meta-data codified in the design
(e.g. foreign keys, required fields, etc) that's hard to
preserve outside a DB, and that you may need someday....

So that's the first question I'd explore....

Erick

On Tue, Jan 19, 2010 at 10:58 PM, Guido Bartolucci <
guido.bartolucci@gmail.com> wrote:

> I know that the primary use case for Lucene is as an index of data
> that can be reconstructed (e.g., from a relational database or from
> spidering your corporate intranet).
>
> But, I'm curious if anyone uses Lucene as their primary datastore for
> their gold data. Is it good enough?
>
> Would anyone consider (or do people already) store data in Lucene
> that, if it was lost, would destroy their business? And no, I'm not
> suggesting that you don't back up this data, I'm just curious if there
> are problems with using Lucene in this way. Are there subtle
> corruptions that might show up in Lucene that wouldn't show up in
> Oracle or MySQL?
>
> I'm considering using Lucene in this way but I haven't been able to
> find any documentation describing this use case. Are there any studies
> of Lucene vs MySQL running for N years comparing the corruptions and
> recovery times?
>
> Am I just ignorant and scared of Lucene and too trusting of Oracle and
> MySQL?
>
> Thanks.
>
> -guido.
>
> (BTW, I did find a similar question asked back in 2007 in the archives
> but it doesn't really answer my question)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44614-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 14:28:07 2010
Return-Path: <java-user-return-44614-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12557 invoked from network); 20 Jan 2010 14:28:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 14:28:07 -0000
Received: (qmail 29279 invoked by uid 500); 20 Jan 2010 14:28:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29211 invoked by uid 500); 20 Jan 2010 14:28:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29201 invoked by uid 99); 20 Jan 2010 14:28:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 14:28:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [192.112.254.51] (HELO smtp2.bedag.ch) (192.112.254.51)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 14:27:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by smtp1.bedag.ch (Postfix) with ESMTP id D6D73739FE
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 15:27:35 +0100 (CET)
X-Quarantine-ID: <uv4j8RNLvgEk>
X-Virus-Scanned: Scanned
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: AW: Lucene as a primary datastore
Date: Wed, 20 Jan 2010 15:26:23 +0100
Message-ID: <1D3D7943573BD14FB024A9654EB43CCB02A4CC20@A99A-EMS-01VS2.ad.bedag.ch>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene as a primary datastore
Thread-Index: AcqZ2Nmyx+qQgPRjQCabdvmDhmcH2AAAF93wAAC4+fA=
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com> <359a92831001200559h747901a5pce7b5f495a3d2654@mail.gmail.com> <214FF1B5E37DC84D9968F0F82FBB112505FED738@AUGEXCH.ghsinc.com>
From: "Sertic Mirko, Bedag" <Mirko.Sertic@bedag.ch>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 20 Jan 2010 14:27:29.0919 (UTC) FILETIME=[B27298F0:01CA99DC]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi

Did you ever think about a Content Repository, like JackRabbit or =
Alfresco?
Alfresco generates also a Lucene Index for documents stored in its =
repository. The content repository itself
is backed by a database or a filesystem...

Regards
Mirko

-----Urspr=FCngliche Nachricht-----
Von: Darren Hartford [mailto:dhartford@ghsinc.com]=20
Gesendet: Mittwoch, 20. Januar 2010 15:12
An: java-user@lucene.apache.org
Betreff: RE: Lucene as a primary datastore

My two cents is no, not to use lucene as a primary datastore.  Although
there are some datastores that look similar to lucene who define
themselves as primary datastores (the 'nosql' style datastores), I would
put lucene besides the likes of RRD and other specifically purposed
information stores that are about providing information and
functionality, but not necessarily be the gatekeeper of your raw (gold)
data.

Caveat: My definition of raw, or 'gold', data is detailed data and the
audit/transaction history to identify the origin of the detailed data.
So it's not just the end result (often called 'current') data, it's all
the data on how it got to the current state and as it fluctuates over
time. =20

My two coppers,

-D




-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]=20
Sent: Wednesday, January 20, 2010 8:59 AM
To: java-user@lucene.apache.org
Subject: Re: Lucene as a primary datastore

My preference is to put the effort into preserving the original
source on the theory that I'm sure no information is lost that
way. So the suitability of Lucene to store it varies depending
upon the source IMO.

If it's raw text, then storing all the raw text in an un-indexed
field in Lucene might suit you well. But if it's a database,
there may be lots of meta-data codified in the design
(e.g. foreign keys, required fields, etc) that's hard to
preserve outside a DB, and that you may need someday....

So that's the first question I'd explore....

Erick

On Tue, Jan 19, 2010 at 10:58 PM, Guido Bartolucci <
guido.bartolucci@gmail.com> wrote:

> I know that the primary use case for Lucene is as an index of data
> that can be reconstructed (e.g., from a relational database or from
> spidering your corporate intranet).
>
> But, I'm curious if anyone uses Lucene as their primary datastore for
> their gold data. Is it good enough?
>
> Would anyone consider (or do people already) store data in Lucene
> that, if it was lost, would destroy their business? And no, I'm not
> suggesting that you don't back up this data, I'm just curious if there
> are problems with using Lucene in this way. Are there subtle
> corruptions that might show up in Lucene that wouldn't show up in
> Oracle or MySQL?
>
> I'm considering using Lucene in this way but I haven't been able to
> find any documentation describing this use case. Are there any studies
> of Lucene vs MySQL running for N years comparing the corruptions and
> recovery times?
>
> Am I just ignorant and scared of Lucene and too trusting of Oracle and
> MySQL?
>
> Thanks.
>
> -guido.
>
> (BTW, I did find a similar question asked back in 2007 in the archives
> but it doesn't really answer my question)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44615-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 14:33:17 2010
Return-Path: <java-user-return-44615-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15067 invoked from network); 20 Jan 2010 14:33:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 14:33:17 -0000
Received: (qmail 35446 invoked by uid 500); 20 Jan 2010 14:33:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35371 invoked by uid 500); 20 Jan 2010 14:33:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35361 invoked by uid 99); 20 Jan 2010 14:33:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 14:33:14 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 14:33:07 +0000
Received: by ewy9 with SMTP id 9so8617398ewy.11
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 06:32:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=naS8nfgvvC9fuOk+xaGzqj6TU3jgmjsmdgYj56ZHJqw=;
        b=G9/38YP0WWwnYAae587hAYxz63hAv+wzNDDnieD8wwGc8UbIOxiUPImhQ7iXxMWcEk
         TbHqlVhIrc0lcESwkiX4K/S9eASzsGOzCiprXodmtxkjZpXjsafNXvJsvkv8HFQ+3JIT
         R/EIerr5oqJDs4mo/PyqquK7iFBTB+EneFFKM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=UVXnBGLMPwHncn7Rx3YqNrnXjfdryMULII5wSib8Kntyemnr/q3BXPjU7RJdV4P7Z6
         TwzD3YQ7sReJfXFQojT+26c5n2sKG0EhG4FkunWplTfqAkuQYNOdtk5riW5ZGVtn8gBN
         ihPgruRKUG0PT1ckVEp7oYJOkuJweqhnSUeo4=
MIME-Version: 1.0
Received: by 10.216.91.84 with SMTP id g62mr6081wef.216.1263997966158; Wed, 20 
	Jan 2010 06:32:46 -0800 (PST)
In-Reply-To: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
Date: Wed, 20 Jan 2010 16:32:46 +0200
Message-ID: <786fde51001200632o3b86212cw58a72552ebce52cc@mail.gmail.com>
Subject: Re: NFS, Stale File Handle Problem and my thoughts....
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d78491c50efc047d9975f1

--0016e6d78491c50efc047d9975f1
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

We've worked around that problem by doing two things:
1) We notify all nodes in the cluster when the index has committed (we use
JMS for that).
2) On each node there is a daemon which waits on this JMS queue, and once
the index has committed it reopens an IR, w/o checking isCurrent(). I think
that the isCurrent call is the problematic one, since that's the one that
checks the segments file (but I admit I forgot the details).
2.1) After the reopen is finished (we do some warm up queries as well), we
'release' this reader to search threads.

So no search thread suffers any overhead from opening a reader, because to
them the readers are always open. Calling reopen means calling isCurrent, s=
o
you can protect that code and call it until it succeeds, or if it fails cal=
l
IndexReader.open instead. Anyway, that's done on the daemon side, and
therefore does not incur any overhead for searchers. In the worse case,
they'll use a slightly older index than your application intended for.

I don't know if something like that interests the community, to get a modul=
e
that provides IndexSearcher instances, and taking care of their refresh w/o
the application needing to worry about it, or write custom code (which I'm
sure a lot of us write .. and probably the same code). If it does, I don't
mind to patch something.

Shai

On Wed, Jan 20, 2010 at 4:05 PM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch>wrote:

> Hi Mike
>
> Thank you for your feedback!
>
> So I would need the following setup:
>
> a) Machine A with custom IndexDeletionPolicy and single IndexReader
> instance
> b) Machine B with custom IndexDeletionPolicy and single IndexReader
> instance
> c) Machine A and B periodically check if the index needs to be reopened, =
at
> least at 12 o'clock
> d) Machine A runs an Index update and optimization at 8 o'clock, using th=
e
> IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the files to =
be
> deleted.
> e) On Machine A, the no longer needed files are taken from the
> IndexDeletionPolicy, and deleted at 12:30. At this point the files to be
> deleted should no longer be required by any IndexReader and can be safely
> deleted.
>
> So the IndexDeletionPolicy should be a kind of Singleton, and in fact wou=
ld
> only be needed on Machine A, as only here index modifications are made.
> Machine B has read only access.
>
> Would this be a valid setup? The only limitation is there is only ONE
> IndexWriter box, and multiple IndexReader boxes. Based on our requirement=
s,
> this should fix very well. I really want to avoid some kind of index
> replication between the boxes...
>
> Regards
> Mirko
>
>
>
> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> Gesendet: Mittwoch, 20. Januar 2010 14:45
> An: java-user@lucene.apache.org
> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>
> Right, you just need to make a custom IndexDeletionPolicy.  NFS makes
> no effort to protect deletion of still-open files.
>
> A simple approach is one that only deletes a commit if it's more than
> XXX minutes/hours old, such that XXX is set higher than the frequency
> that IndexReaders are guaranteed to have reopened.
>
> The TestDeletionPolicy unit test in Lucene's sources has the
> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>
> Another alternative is to simply reopen the reader whenever you hit
> Stale file handle (think of it as NFS's means of notifying you that
> your reader is no longer current ;) ).  But, if reopen time is
> potentially long for your app, it's no good to make queries pay that
> cost and the deletion policy is better.
>
> Mike
>
> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
> <Mirko.Sertic@bedag.ch> wrote:
> > Hi@all
> >
> >
> >
> > We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
> > stored on a common NFS share. Every box has a single IndexReader
> > instance, and one Box has an IndexWriter instance, adding new documents
> > or deleting existing documents at a given point in time. After adding o=
r
> > deleting the documents, a IndexWriter.optimize() is called. Every box
> > checks periodically with IndexReader.isCurrent if the index needs to be
> > reopened.
> >
> >
> >
> > Now, we are encountering a "Stale file handle" error on box b after the
> > index was modified and optimized by box a.
> >
> >
> >
> > As far as i understand the problem with NFS is that box b tries to
> > open/access a file that was deleted by box a on the NFS share.
> >
> >
> >
> > The question is now, when are files deleted? Does only the index
> > optimization delete files, or can files be deleted just by adding or
> > removing documents from an existing index?
> >
> >
> >
> > I now that there might be a better setup with Lucene and index
> > replication, but this is an existing application and we cannot change
> > the architecture now. So what would be the best solution?
> >
> >
> >
> > Can I just "change" the way Lucene deletes files? I think that just
> > renaming no longer needed files would be good on NFS. After every
> > IndexReader has reopened the index, the renamed files can be safely
> > deleted, as they are definitely no longer needed. Where would be the
> > hook point? I heard something about IndexDeletionPolicy....
> >
> >
> >
> > Thanks in advance!
> >
> >
> >
> > Mirko
> >
> >
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d78491c50efc047d9975f1--

From java-user-return-44616-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 14:54:39 2010
Return-Path: <java-user-return-44616-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25045 invoked from network); 20 Jan 2010 14:54:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 14:54:39 -0000
Received: (qmail 76252 invoked by uid 500); 20 Jan 2010 14:54:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76184 invoked by uid 500); 20 Jan 2010 14:54:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76174 invoked by uid 99); 20 Jan 2010 14:54:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 14:54:36 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.smith391@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 14:54:28 +0000
Received: by bwz22 with SMTP id 22so1118709bwz.5
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 06:54:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type
         :content-transfer-encoding;
        bh=NswnykqebZfXFbmfAyKe00Ahd+t5iFlr5tL7z8OZELA=;
        b=QRBzzoqLJCUIsvTvgULlT3Ldj98yO93vhvXcYcNNcofY2/T//4i57xF9Y3fhQfQKWB
         0xd/oBkwFlRvHMkxCLQYCstLgXz3rmiFpO00CE0KZQBmxaWRMlqve7Mp5lEGzibipiYR
         g6sDjo/MVb5ghnQ0ncX3aNF0dDZMbPzhQ/pA8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type:content-transfer-encoding;
        b=GJR6QYbj5KwILEWVTFZFj6jl35VtpBQAgqdd/dH4kbRSlAg6PH/+cotzV5C4c6ZMWg
         xoBOUCwO4wfne4n1WM8OjVS7/lQkp6twe1sIf/at/yoqrRH2zxFnfchnhVrdQDUEcr6d
         clJHhaN09hxKG5xAkOacgG01iOSN1ucEUiFio=
Received: by 10.204.23.20 with SMTP id p20mr51254bkb.54.1263999247275;
        Wed, 20 Jan 2010 06:54:07 -0800 (PST)
Received: from ?192.168.40.149? ([213.222.196.41])
        by mx.google.com with ESMTPS id 16sm1606764bwz.11.2010.01.20.06.54.05
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 20 Jan 2010 06:54:06 -0800 (PST)
Message-ID: <4B57190B.4000107@gmail.com>
Date: Wed, 20 Jan 2010 15:54:03 +0100
From: john smith <john.smith391@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: TooManyClauses and maxClauseCount question
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

Hi
  I'am getting TooManyClauses exception while performing wildcard query. 
I'am thinking about changing max clause count limit 
(BooleanQuery.setMaxClauseCount() method). My question referes to memory 
consumption in case of increasing maxClauseCount parameter.
  Does Lucene do it in a smart way (allocates bigger buffer only when it 
is neccesary) or allocates constant (increased) amount of memory for 
every wildcard query ?  

Regards
JS.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44617-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 15:14:11 2010
Return-Path: <java-user-return-44617-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33772 invoked from network); 20 Jan 2010 15:14:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 15:14:10 -0000
Received: (qmail 12797 invoked by uid 500); 20 Jan 2010 15:14:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12733 invoked by uid 500); 20 Jan 2010 15:14:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12723 invoked by uid 99); 20 Jan 2010 15:14:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:14:08 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.173] (HELO mail-yw0-f173.google.com) (209.85.211.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:13:59 +0000
Received: by ywh3 with SMTP id 3so2584151ywh.22
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 07:13:38 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.47.36 with SMTP id u36mr260829ybu.256.1264000418309; Wed, 
	20 Jan 2010 07:13:38 -0800 (PST)
In-Reply-To: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
Date: Wed, 20 Jan 2010 10:13:38 -0500
Message-ID: <9ac0c6aa1001200713n624674b3x529507ad3996a641@mail.gmail.com>
Subject: Re: NFS, Stale File Handle Problem and my thoughts....
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Right, it's only machine A that needs the deletion policy.  All
read-only machines just reopen on their schedule (or you can use some
communication means a Shai describes to have lower latency reopen
after the writer commits).

Also realize that doing searching over NFS does not usually give very
good performance... (though I've heard that mounting read-only can
improve performance).

Mike

On Wed, Jan 20, 2010 at 9:05 AM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch> wrote:
> Hi Mike
>
> Thank you for your feedback!
>
> So I would need the following setup:
>
> a) Machine A with custom IndexDeletionPolicy and single IndexReader insta=
nce
> b) Machine B with custom IndexDeletionPolicy and single IndexReader insta=
nce
> c) Machine A and B periodically check if the index needs to be reopened, =
at least at 12 o'clock
> d) Machine A runs an Index update and optimization at 8 o'clock, using th=
e IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the files to =
be deleted.
> e) On Machine A, the no longer needed files are taken from the IndexDelet=
ionPolicy, and deleted at 12:30. At this point the files to be deleted shou=
ld no longer be required by any IndexReader and can be safely deleted.
>
> So the IndexDeletionPolicy should be a kind of Singleton, and in fact wou=
ld only be needed on Machine A, as only here index modifications are made. =
Machine B has read only access.
>
> Would this be a valid setup? The only limitation is there is only ONE Ind=
exWriter box, and multiple IndexReader boxes. Based on our requirements, th=
is should fix very well. I really want to avoid some kind of index replicat=
ion between the boxes...
>
> Regards
> Mirko
>
>
>
> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> Gesendet: Mittwoch, 20. Januar 2010 14:45
> An: java-user@lucene.apache.org
> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>
> Right, you just need to make a custom IndexDeletionPolicy. =A0NFS makes
> no effort to protect deletion of still-open files.
>
> A simple approach is one that only deletes a commit if it's more than
> XXX minutes/hours old, such that XXX is set higher than the frequency
> that IndexReaders are guaranteed to have reopened.
>
> The TestDeletionPolicy unit test in Lucene's sources has the
> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>
> Another alternative is to simply reopen the reader whenever you hit
> Stale file handle (think of it as NFS's means of notifying you that
> your reader is no longer current ;) ). =A0But, if reopen time is
> potentially long for your app, it's no good to make queries pay that
> cost and the deletion policy is better.
>
> Mike
>
> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
> <Mirko.Sertic@bedag.ch> wrote:
>> Hi@all
>>
>>
>>
>> We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
>> stored on a common NFS share. Every box has a single IndexReader
>> instance, and one Box has an IndexWriter instance, adding new documents
>> or deleting existing documents at a given point in time. After adding or
>> deleting the documents, a IndexWriter.optimize() is called. Every box
>> checks periodically with IndexReader.isCurrent if the index needs to be
>> reopened.
>>
>>
>>
>> Now, we are encountering a "Stale file handle" error on box b after the
>> index was modified and optimized by box a.
>>
>>
>>
>> As far as i understand the problem with NFS is that box b tries to
>> open/access a file that was deleted by box a on the NFS share.
>>
>>
>>
>> The question is now, when are files deleted? Does only the index
>> optimization delete files, or can files be deleted just by adding or
>> removing documents from an existing index?
>>
>>
>>
>> I now that there might be a better setup with Lucene and index
>> replication, but this is an existing application and we cannot change
>> the architecture now. So what would be the best solution?
>>
>>
>>
>> Can I just "change" the way Lucene deletes files? I think that just
>> renaming no longer needed files would be good on NFS. After every
>> IndexReader has reopened the index, the renamed files can be safely
>> deleted, as they are definitely no longer needed. Where would be the
>> hook point? I heard something about IndexDeletionPolicy....
>>
>>
>>
>> Thanks in advance!
>>
>>
>>
>> Mirko
>>
>>
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44618-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 15:17:35 2010
Return-Path: <java-user-return-44618-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34877 invoked from network); 20 Jan 2010 15:17:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 15:17:35 -0000
Received: (qmail 21966 invoked by uid 500); 20 Jan 2010 15:17:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21884 invoked by uid 500); 20 Jan 2010 15:17:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21874 invoked by uid 99); 20 Jan 2010 15:17:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:17:33 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.173] (HELO mail-yw0-f173.google.com) (209.85.211.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:17:26 +0000
Received: by ywh3 with SMTP id 3so2587637ywh.22
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 07:17:05 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.249.10 with SMTP id w10mr283524ybh.176.1264000625043; Wed, 
	20 Jan 2010 07:17:05 -0800 (PST)
In-Reply-To: <786fde51001200632o3b86212cw58a72552ebce52cc@mail.gmail.com>
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
	 <786fde51001200632o3b86212cw58a72552ebce52cc@mail.gmail.com>
Date: Wed, 20 Jan 2010 10:17:05 -0500
Message-ID: <9ac0c6aa1001200717h587a3a48id4311afed24b7628@mail.gmail.com>
Subject: Re: NFS, Stale File Handle Problem and my thoughts....
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

I think this would be useful!

The 2nd edition Lucene in Action sources also have something similar,
a SearcherManager class that handles multiple threads doing searching
while a reopen (normal or NRT) and warming is taking place.  (NOTE:
I'm one of the authors on Lucene in Action 2nd edition!).  But it
doesn't do the communication part, to know when it's time to reopen.

Mike

On Wed, Jan 20, 2010 at 9:32 AM, Shai Erera <serera@gmail.com> wrote:
> We've worked around that problem by doing two things:
> 1) We notify all nodes in the cluster when the index has committed (we us=
e
> JMS for that).
> 2) On each node there is a daemon which waits on this JMS queue, and once
> the index has committed it reopens an IR, w/o checking isCurrent(). I thi=
nk
> that the isCurrent call is the problematic one, since that's the one that
> checks the segments file (but I admit I forgot the details).
> 2.1) After the reopen is finished (we do some warm up queries as well), w=
e
> 'release' this reader to search threads.
>
> So no search thread suffers any overhead from opening a reader, because t=
o
> them the readers are always open. Calling reopen means calling isCurrent,=
 so
> you can protect that code and call it until it succeeds, or if it fails c=
all
> IndexReader.open instead. Anyway, that's done on the daemon side, and
> therefore does not incur any overhead for searchers. In the worse case,
> they'll use a slightly older index than your application intended for.
>
> I don't know if something like that interests the community, to get a mod=
ule
> that provides IndexSearcher instances, and taking care of their refresh w=
/o
> the application needing to worry about it, or write custom code (which I'=
m
> sure a lot of us write .. and probably the same code). If it does, I don'=
t
> mind to patch something.
>
> Shai
>
> On Wed, Jan 20, 2010 at 4:05 PM, Sertic Mirko, Bedag
> <Mirko.Sertic@bedag.ch>wrote:
>
>> Hi Mike
>>
>> Thank you for your feedback!
>>
>> So I would need the following setup:
>>
>> a) Machine A with custom IndexDeletionPolicy and single IndexReader
>> instance
>> b) Machine B with custom IndexDeletionPolicy and single IndexReader
>> instance
>> c) Machine A and B periodically check if the index needs to be reopened,=
 at
>> least at 12 o'clock
>> d) Machine A runs an Index update and optimization at 8 o'clock, using t=
he
>> IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the files to=
 be
>> deleted.
>> e) On Machine A, the no longer needed files are taken from the
>> IndexDeletionPolicy, and deleted at 12:30. At this point the files to be
>> deleted should no longer be required by any IndexReader and can be safel=
y
>> deleted.
>>
>> So the IndexDeletionPolicy should be a kind of Singleton, and in fact wo=
uld
>> only be needed on Machine A, as only here index modifications are made.
>> Machine B has read only access.
>>
>> Would this be a valid setup? The only limitation is there is only ONE
>> IndexWriter box, and multiple IndexReader boxes. Based on our requiremen=
ts,
>> this should fix very well. I really want to avoid some kind of index
>> replication between the boxes...
>>
>> Regards
>> Mirko
>>
>>
>>
>> -----Urspr=FCngliche Nachricht-----
>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Gesendet: Mittwoch, 20. Januar 2010 14:45
>> An: java-user@lucene.apache.org
>> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>>
>> Right, you just need to make a custom IndexDeletionPolicy. =A0NFS makes
>> no effort to protect deletion of still-open files.
>>
>> A simple approach is one that only deletes a commit if it's more than
>> XXX minutes/hours old, such that XXX is set higher than the frequency
>> that IndexReaders are guaranteed to have reopened.
>>
>> The TestDeletionPolicy unit test in Lucene's sources has the
>> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>>
>> Another alternative is to simply reopen the reader whenever you hit
>> Stale file handle (think of it as NFS's means of notifying you that
>> your reader is no longer current ;) ). =A0But, if reopen time is
>> potentially long for your app, it's no good to make queries pay that
>> cost and the deletion policy is better.
>>
>> Mike
>>
>> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
>> <Mirko.Sertic@bedag.ch> wrote:
>> > Hi@all
>> >
>> >
>> >
>> > We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
>> > stored on a common NFS share. Every box has a single IndexReader
>> > instance, and one Box has an IndexWriter instance, adding new document=
s
>> > or deleting existing documents at a given point in time. After adding =
or
>> > deleting the documents, a IndexWriter.optimize() is called. Every box
>> > checks periodically with IndexReader.isCurrent if the index needs to b=
e
>> > reopened.
>> >
>> >
>> >
>> > Now, we are encountering a "Stale file handle" error on box b after th=
e
>> > index was modified and optimized by box a.
>> >
>> >
>> >
>> > As far as i understand the problem with NFS is that box b tries to
>> > open/access a file that was deleted by box a on the NFS share.
>> >
>> >
>> >
>> > The question is now, when are files deleted? Does only the index
>> > optimization delete files, or can files be deleted just by adding or
>> > removing documents from an existing index?
>> >
>> >
>> >
>> > I now that there might be a better setup with Lucene and index
>> > replication, but this is an existing application and we cannot change
>> > the architecture now. So what would be the best solution?
>> >
>> >
>> >
>> > Can I just "change" the way Lucene deletes files? I think that just
>> > renaming no longer needed files would be good on NFS. After every
>> > IndexReader has reopened the index, the renamed files can be safely
>> > deleted, as they are definitely no longer needed. Where would be the
>> > hook point? I heard something about IndexDeletionPolicy....
>> >
>> >
>> >
>> > Thanks in advance!
>> >
>> >
>> >
>> > Mirko
>> >
>> >
>> >
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44619-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 15:25:59 2010
Return-Path: <java-user-return-44619-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36445 invoked from network); 20 Jan 2010 15:25:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 15:25:58 -0000
Received: (qmail 34123 invoked by uid 500); 20 Jan 2010 15:25:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34057 invoked by uid 500); 20 Jan 2010 15:25:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34047 invoked by uid 99); 20 Jan 2010 15:25:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:25:56 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:25:47 +0000
Received: by ey-out-2122.google.com with SMTP id d26so1439825eyd.3
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 07:25:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ZBD5nLrfaxaUUkXwTAHBkJR8VK6QSr0eKhK9z9YdVFA=;
        b=whIUskhRmtq+KhVN359In4nz+a6FnEau65NAiLfBADIjmKCBoTSTF+gncg04Ezs5oe
         4gNys+LXEtYQSydakqBnG3vk9Uuw0ZjBy5EFbpHx8EcQNgjCIgYqOaFqMIVMjXi7Xd+h
         LBko5oNW0/aZw/ouaaMsSZwmgvPTXk67hpRYA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=ILO3iMFnCOOpszbSDPqrYL5uEeFw5J7eV08QNXVWnmUvQZstvDpm9z16xevTWYOlWW
         Xx3RT6zldvpeOPTajZzhO1v2LuZWA4MBm1/RR+ty7LwExNAH/Tt+hrHs0aMn7RkiZnji
         kOXa3mGv7sZ5f3kTJfw8PzhZOE1F+OsxXJwKs=
MIME-Version: 1.0
Received: by 10.216.87.206 with SMTP id y56mr28592wee.207.1264001127198; Wed, 
	20 Jan 2010 07:25:27 -0800 (PST)
In-Reply-To: <9ac0c6aa1001200717h587a3a48id4311afed24b7628@mail.gmail.com>
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
	 <786fde51001200632o3b86212cw58a72552ebce52cc@mail.gmail.com>
	 <9ac0c6aa1001200717h587a3a48id4311afed24b7628@mail.gmail.com>
Date: Wed, 20 Jan 2010 17:25:27 +0200
Message-ID: <786fde51001200725t3d582c0dm7c15edc550c7e757@mail.gmail.com>
Subject: Re: NFS, Stale File Handle Problem and my thoughts....
From: Shai Erera <serera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d976822ebc79047d9a3295
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d976822ebc79047d9a3295
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Ok, I haven't reached that part in LIA2 yet :-).

This module is useful for a single node as well, when one IndexSearcher is
shared between several threads. The communication part is just an extension
of that case.

I'll review the SearcherManager in LIA2, and compare to our code. If it'll
make sense, I'll patch it up !

Shai

On Wed, Jan 20, 2010 at 5:17 PM, Michael McCandless <
lucene@mikemccandless.com> wrote:

> I think this would be useful!
>
> The 2nd edition Lucene in Action sources also have something similar,
> a SearcherManager class that handles multiple threads doing searching
> while a reopen (normal or NRT) and warming is taking place.  (NOTE:
> I'm one of the authors on Lucene in Action 2nd edition!).  But it
> doesn't do the communication part, to know when it's time to reopen.
>
> Mike
>
> On Wed, Jan 20, 2010 at 9:32 AM, Shai Erera <serera@gmail.com> wrote:
> > We've worked around that problem by doing two things:
> > 1) We notify all nodes in the cluster when the index has committed (we
> use
> > JMS for that).
> > 2) On each node there is a daemon which waits on this JMS queue, and on=
ce
> > the index has committed it reopens an IR, w/o checking isCurrent(). I
> think
> > that the isCurrent call is the problematic one, since that's the one th=
at
> > checks the segments file (but I admit I forgot the details).
> > 2.1) After the reopen is finished (we do some warm up queries as well),
> we
> > 'release' this reader to search threads.
> >
> > So no search thread suffers any overhead from opening a reader, because
> to
> > them the readers are always open. Calling reopen means calling isCurren=
t,
> so
> > you can protect that code and call it until it succeeds, or if it fails
> call
> > IndexReader.open instead. Anyway, that's done on the daemon side, and
> > therefore does not incur any overhead for searchers. In the worse case,
> > they'll use a slightly older index than your application intended for.
> >
> > I don't know if something like that interests the community, to get a
> module
> > that provides IndexSearcher instances, and taking care of their refresh
> w/o
> > the application needing to worry about it, or write custom code (which
> I'm
> > sure a lot of us write .. and probably the same code). If it does, I
> don't
> > mind to patch something.
> >
> > Shai
> >
> > On Wed, Jan 20, 2010 at 4:05 PM, Sertic Mirko, Bedag
> > <Mirko.Sertic@bedag.ch>wrote:
> >
> >> Hi Mike
> >>
> >> Thank you for your feedback!
> >>
> >> So I would need the following setup:
> >>
> >> a) Machine A with custom IndexDeletionPolicy and single IndexReader
> >> instance
> >> b) Machine B with custom IndexDeletionPolicy and single IndexReader
> >> instance
> >> c) Machine A and B periodically check if the index needs to be reopene=
d,
> at
> >> least at 12 o'clock
> >> d) Machine A runs an Index update and optimization at 8 o'clock, using
> the
> >> IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the files =
to
> be
> >> deleted.
> >> e) On Machine A, the no longer needed files are taken from the
> >> IndexDeletionPolicy, and deleted at 12:30. At this point the files to =
be
> >> deleted should no longer be required by any IndexReader and can be
> safely
> >> deleted.
> >>
> >> So the IndexDeletionPolicy should be a kind of Singleton, and in fact
> would
> >> only be needed on Machine A, as only here index modifications are made=
.
> >> Machine B has read only access.
> >>
> >> Would this be a valid setup? The only limitation is there is only ONE
> >> IndexWriter box, and multiple IndexReader boxes. Based on our
> requirements,
> >> this should fix very well. I really want to avoid some kind of index
> >> replication between the boxes...
> >>
> >> Regards
> >> Mirko
> >>
> >>
> >>
> >> -----Urspr=FCngliche Nachricht-----
> >> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> >> Gesendet: Mittwoch, 20. Januar 2010 14:45
> >> An: java-user@lucene.apache.org
> >> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
> >>
> >> Right, you just need to make a custom IndexDeletionPolicy.  NFS makes
> >> no effort to protect deletion of still-open files.
> >>
> >> A simple approach is one that only deletes a commit if it's more than
> >> XXX minutes/hours old, such that XXX is set higher than the frequency
> >> that IndexReaders are guaranteed to have reopened.
> >>
> >> The TestDeletionPolicy unit test in Lucene's sources has the
> >> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
> >>
> >> Another alternative is to simply reopen the reader whenever you hit
> >> Stale file handle (think of it as NFS's means of notifying you that
> >> your reader is no longer current ;) ).  But, if reopen time is
> >> potentially long for your app, it's no good to make queries pay that
> >> cost and the deletion policy is better.
> >>
> >> Mike
> >>
> >> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
> >> <Mirko.Sertic@bedag.ch> wrote:
> >> > Hi@all
> >> >
> >> >
> >> >
> >> > We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
> >> > stored on a common NFS share. Every box has a single IndexReader
> >> > instance, and one Box has an IndexWriter instance, adding new
> documents
> >> > or deleting existing documents at a given point in time. After addin=
g
> or
> >> > deleting the documents, a IndexWriter.optimize() is called. Every bo=
x
> >> > checks periodically with IndexReader.isCurrent if the index needs to
> be
> >> > reopened.
> >> >
> >> >
> >> >
> >> > Now, we are encountering a "Stale file handle" error on box b after
> the
> >> > index was modified and optimized by box a.
> >> >
> >> >
> >> >
> >> > As far as i understand the problem with NFS is that box b tries to
> >> > open/access a file that was deleted by box a on the NFS share.
> >> >
> >> >
> >> >
> >> > The question is now, when are files deleted? Does only the index
> >> > optimization delete files, or can files be deleted just by adding or
> >> > removing documents from an existing index?
> >> >
> >> >
> >> >
> >> > I now that there might be a better setup with Lucene and index
> >> > replication, but this is an existing application and we cannot chang=
e
> >> > the architecture now. So what would be the best solution?
> >> >
> >> >
> >> >
> >> > Can I just "change" the way Lucene deletes files? I think that just
> >> > renaming no longer needed files would be good on NFS. After every
> >> > IndexReader has reopened the index, the renamed files can be safely
> >> > deleted, as they are definitely no longer needed. Where would be the
> >> > hook point? I heard something about IndexDeletionPolicy....
> >> >
> >> >
> >> >
> >> > Thanks in advance!
> >> >
> >> >
> >> >
> >> > Mirko
> >> >
> >> >
> >> >
> >> >
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d976822ebc79047d9a3295--

From java-user-return-44620-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 15:33:30 2010
Return-Path: <java-user-return-44620-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39183 invoked from network); 20 Jan 2010 15:33:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 15:33:30 -0000
Received: (qmail 48697 invoked by uid 500); 20 Jan 2010 15:33:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48632 invoked by uid 500); 20 Jan 2010 15:33:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48622 invoked by uid 99); 20 Jan 2010 15:33:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:33:27 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.173] (HELO mail-yw0-f173.google.com) (209.85.211.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:33:20 +0000
Received: by ywh3 with SMTP id 3so2603826ywh.22
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 07:32:59 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.95.1 with SMTP id x1mr298894ybl.221.1264001579540; Wed, 20 
	Jan 2010 07:32:59 -0800 (PST)
In-Reply-To: <786fde51001200725t3d582c0dm7c15edc550c7e757@mail.gmail.com>
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
	 <786fde51001200632o3b86212cw58a72552ebce52cc@mail.gmail.com>
	 <9ac0c6aa1001200717h587a3a48id4311afed24b7628@mail.gmail.com>
	 <786fde51001200725t3d582c0dm7c15edc550c7e757@mail.gmail.com>
Date: Wed, 20 Jan 2010 10:32:59 -0500
Message-ID: <9ac0c6aa1001200732u295702eema5ca4c13f6d6768b@mail.gmail.com>
Subject: Re: NFS, Stale File Handle Problem and my thoughts....
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Sounds great!

Mike

On Wed, Jan 20, 2010 at 10:25 AM, Shai Erera <serera@gmail.com> wrote:
> Ok, I haven't reached that part in LIA2 yet :-).
>
> This module is useful for a single node as well, when one IndexSearcher i=
s
> shared between several threads. The communication part is just an extensi=
on
> of that case.
>
> I'll review the SearcherManager in LIA2, and compare to our code. If it'l=
l
> make sense, I'll patch it up !
>
> Shai
>
> On Wed, Jan 20, 2010 at 5:17 PM, Michael McCandless <
> lucene@mikemccandless.com> wrote:
>
>> I think this would be useful!
>>
>> The 2nd edition Lucene in Action sources also have something similar,
>> a SearcherManager class that handles multiple threads doing searching
>> while a reopen (normal or NRT) and warming is taking place. =A0(NOTE:
>> I'm one of the authors on Lucene in Action 2nd edition!). =A0But it
>> doesn't do the communication part, to know when it's time to reopen.
>>
>> Mike
>>
>> On Wed, Jan 20, 2010 at 9:32 AM, Shai Erera <serera@gmail.com> wrote:
>> > We've worked around that problem by doing two things:
>> > 1) We notify all nodes in the cluster when the index has committed (we
>> use
>> > JMS for that).
>> > 2) On each node there is a daemon which waits on this JMS queue, and o=
nce
>> > the index has committed it reopens an IR, w/o checking isCurrent(). I
>> think
>> > that the isCurrent call is the problematic one, since that's the one t=
hat
>> > checks the segments file (but I admit I forgot the details).
>> > 2.1) After the reopen is finished (we do some warm up queries as well)=
,
>> we
>> > 'release' this reader to search threads.
>> >
>> > So no search thread suffers any overhead from opening a reader, becaus=
e
>> to
>> > them the readers are always open. Calling reopen means calling isCurre=
nt,
>> so
>> > you can protect that code and call it until it succeeds, or if it fail=
s
>> call
>> > IndexReader.open instead. Anyway, that's done on the daemon side, and
>> > therefore does not incur any overhead for searchers. In the worse case=
,
>> > they'll use a slightly older index than your application intended for.
>> >
>> > I don't know if something like that interests the community, to get a
>> module
>> > that provides IndexSearcher instances, and taking care of their refres=
h
>> w/o
>> > the application needing to worry about it, or write custom code (which
>> I'm
>> > sure a lot of us write .. and probably the same code). If it does, I
>> don't
>> > mind to patch something.
>> >
>> > Shai
>> >
>> > On Wed, Jan 20, 2010 at 4:05 PM, Sertic Mirko, Bedag
>> > <Mirko.Sertic@bedag.ch>wrote:
>> >
>> >> Hi Mike
>> >>
>> >> Thank you for your feedback!
>> >>
>> >> So I would need the following setup:
>> >>
>> >> a) Machine A with custom IndexDeletionPolicy and single IndexReader
>> >> instance
>> >> b) Machine B with custom IndexDeletionPolicy and single IndexReader
>> >> instance
>> >> c) Machine A and B periodically check if the index needs to be reopen=
ed,
>> at
>> >> least at 12 o'clock
>> >> d) Machine A runs an Index update and optimization at 8 o'clock, usin=
g
>> the
>> >> IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the files=
 to
>> be
>> >> deleted.
>> >> e) On Machine A, the no longer needed files are taken from the
>> >> IndexDeletionPolicy, and deleted at 12:30. At this point the files to=
 be
>> >> deleted should no longer be required by any IndexReader and can be
>> safely
>> >> deleted.
>> >>
>> >> So the IndexDeletionPolicy should be a kind of Singleton, and in fact
>> would
>> >> only be needed on Machine A, as only here index modifications are mad=
e.
>> >> Machine B has read only access.
>> >>
>> >> Would this be a valid setup? The only limitation is there is only ONE
>> >> IndexWriter box, and multiple IndexReader boxes. Based on our
>> requirements,
>> >> this should fix very well. I really want to avoid some kind of index
>> >> replication between the boxes...
>> >>
>> >> Regards
>> >> Mirko
>> >>
>> >>
>> >>
>> >> -----Urspr=FCngliche Nachricht-----
>> >> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> >> Gesendet: Mittwoch, 20. Januar 2010 14:45
>> >> An: java-user@lucene.apache.org
>> >> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>> >>
>> >> Right, you just need to make a custom IndexDeletionPolicy. =A0NFS mak=
es
>> >> no effort to protect deletion of still-open files.
>> >>
>> >> A simple approach is one that only deletes a commit if it's more than
>> >> XXX minutes/hours old, such that XXX is set higher than the frequency
>> >> that IndexReaders are guaranteed to have reopened.
>> >>
>> >> The TestDeletionPolicy unit test in Lucene's sources has the
>> >> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>> >>
>> >> Another alternative is to simply reopen the reader whenever you hit
>> >> Stale file handle (think of it as NFS's means of notifying you that
>> >> your reader is no longer current ;) ). =A0But, if reopen time is
>> >> potentially long for your app, it's no good to make queries pay that
>> >> cost and the deletion policy is better.
>> >>
>> >> Mike
>> >>
>> >> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
>> >> <Mirko.Sertic@bedag.ch> wrote:
>> >> > Hi@all
>> >> >
>> >> >
>> >> >
>> >> > We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index i=
s
>> >> > stored on a common NFS share. Every box has a single IndexReader
>> >> > instance, and one Box has an IndexWriter instance, adding new
>> documents
>> >> > or deleting existing documents at a given point in time. After addi=
ng
>> or
>> >> > deleting the documents, a IndexWriter.optimize() is called. Every b=
ox
>> >> > checks periodically with IndexReader.isCurrent if the index needs t=
o
>> be
>> >> > reopened.
>> >> >
>> >> >
>> >> >
>> >> > Now, we are encountering a "Stale file handle" error on box b after
>> the
>> >> > index was modified and optimized by box a.
>> >> >
>> >> >
>> >> >
>> >> > As far as i understand the problem with NFS is that box b tries to
>> >> > open/access a file that was deleted by box a on the NFS share.
>> >> >
>> >> >
>> >> >
>> >> > The question is now, when are files deleted? Does only the index
>> >> > optimization delete files, or can files be deleted just by adding o=
r
>> >> > removing documents from an existing index?
>> >> >
>> >> >
>> >> >
>> >> > I now that there might be a better setup with Lucene and index
>> >> > replication, but this is an existing application and we cannot chan=
ge
>> >> > the architecture now. So what would be the best solution?
>> >> >
>> >> >
>> >> >
>> >> > Can I just "change" the way Lucene deletes files? I think that just
>> >> > renaming no longer needed files would be good on NFS. After every
>> >> > IndexReader has reopened the index, the renamed files can be safely
>> >> > deleted, as they are definitely no longer needed. Where would be th=
e
>> >> > hook point? I heard something about IndexDeletionPolicy....
>> >> >
>> >> >
>> >> >
>> >> > Thanks in advance!
>> >> >
>> >> >
>> >> >
>> >> > Mirko
>> >> >
>> >> >
>> >> >
>> >> >
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >> ---------------------------------------------------------------------
>> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> >> For additional commands, e-mail: java-user-help@lucene.apache.org
>> >>
>> >>
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44621-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 15:51:07 2010
Return-Path: <java-user-return-44621-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44512 invoked from network); 20 Jan 2010 15:51:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 15:51:07 -0000
Received: (qmail 95929 invoked by uid 500); 20 Jan 2010 15:51:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95845 invoked by uid 500); 20 Jan 2010 15:51:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95835 invoked by uid 99); 20 Jan 2010 15:51:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:51:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [192.112.254.53] (HELO smtp2.bedag.ch) (192.112.254.53)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 15:50:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by smtp2.bedag.ch (Postfix) with ESMTP id E3038739A2
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 16:50:35 +0100 (CET)
X-Quarantine-ID: <n9BLrC7QU-4F>
X-Virus-Scanned: Scanned
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: AW: NFS, Stale File Handle Problem and my thoughts....
Date: Wed, 20 Jan 2010 16:49:51 +0100
Message-ID: <1D3D7943573BD14FB024A9654EB43CCB02A4CC21@A99A-EMS-01VS2.ad.bedag.ch>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: NFS, Stale File Handle Problem and my thoughts....
Thread-Index: AcqZ4zkfL1zTY38+RyS20Qn6xgfCTAABHZ7w
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com> <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200713n624674b3x529507ad3996a641@mail.gmail.com>
From: "Sertic Mirko, Bedag" <Mirko.Sertic@bedag.ch>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 20 Jan 2010 15:50:30.0686 (UTC) FILETIME=[4B3753E0:01CA99E8]
X-Virus-Checked: Checked by ClamAV on apache.org

Mike

Thank you so much for your feedback!

Will the new IndexDeletionPolicy also be considered when segments are =
merged? Does merging also affect the NFS problem?

Should I use IndexReader.reOpen() or just create a new IndexReader?

Thanks in advance
Mirko

-----Urspr=FCngliche Nachricht-----
Von: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Gesendet: Mittwoch, 20. Januar 2010 16:14
An: java-user@lucene.apache.org
Betreff: Re: NFS, Stale File Handle Problem and my thoughts....

Right, it's only machine A that needs the deletion policy.  All
read-only machines just reopen on their schedule (or you can use some
communication means a Shai describes to have lower latency reopen
after the writer commits).

Also realize that doing searching over NFS does not usually give very
good performance... (though I've heard that mounting read-only can
improve performance).

Mike

On Wed, Jan 20, 2010 at 9:05 AM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch> wrote:
> Hi Mike
>
> Thank you for your feedback!
>
> So I would need the following setup:
>
> a) Machine A with custom IndexDeletionPolicy and single IndexReader =
instance
> b) Machine B with custom IndexDeletionPolicy and single IndexReader =
instance
> c) Machine A and B periodically check if the index needs to be =
reopened, at least at 12 o'clock
> d) Machine A runs an Index update and optimization at 8 o'clock, using =
the IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the =
files to be deleted.
> e) On Machine A, the no longer needed files are taken from the =
IndexDeletionPolicy, and deleted at 12:30. At this point the files to be =
deleted should no longer be required by any IndexReader and can be =
safely deleted.
>
> So the IndexDeletionPolicy should be a kind of Singleton, and in fact =
would only be needed on Machine A, as only here index modifications are =
made. Machine B has read only access.
>
> Would this be a valid setup? The only limitation is there is only ONE =
IndexWriter box, and multiple IndexReader boxes. Based on our =
requirements, this should fix very well. I really want to avoid some =
kind of index replication between the boxes...
>
> Regards
> Mirko
>
>
>
> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> Gesendet: Mittwoch, 20. Januar 2010 14:45
> An: java-user@lucene.apache.org
> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>
> Right, you just need to make a custom IndexDeletionPolicy. =A0NFS =
makes
> no effort to protect deletion of still-open files.
>
> A simple approach is one that only deletes a commit if it's more than
> XXX minutes/hours old, such that XXX is set higher than the frequency
> that IndexReaders are guaranteed to have reopened.
>
> The TestDeletionPolicy unit test in Lucene's sources has the
> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>
> Another alternative is to simply reopen the reader whenever you hit
> Stale file handle (think of it as NFS's means of notifying you that
> your reader is no longer current ;) ). =A0But, if reopen time is
> potentially long for your app, it's no good to make queries pay that
> cost and the deletion policy is better.
>
> Mike
>
> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
> <Mirko.Sertic@bedag.ch> wrote:
>> Hi@all
>>
>>
>>
>> We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
>> stored on a common NFS share. Every box has a single IndexReader
>> instance, and one Box has an IndexWriter instance, adding new =
documents
>> or deleting existing documents at a given point in time. After adding =
or
>> deleting the documents, a IndexWriter.optimize() is called. Every box
>> checks periodically with IndexReader.isCurrent if the index needs to =
be
>> reopened.
>>
>>
>>
>> Now, we are encountering a "Stale file handle" error on box b after =
the
>> index was modified and optimized by box a.
>>
>>
>>
>> As far as i understand the problem with NFS is that box b tries to
>> open/access a file that was deleted by box a on the NFS share.
>>
>>
>>
>> The question is now, when are files deleted? Does only the index
>> optimization delete files, or can files be deleted just by adding or
>> removing documents from an existing index?
>>
>>
>>
>> I now that there might be a better setup with Lucene and index
>> replication, but this is an existing application and we cannot change
>> the architecture now. So what would be the best solution?
>>
>>
>>
>> Can I just "change" the way Lucene deletes files? I think that just
>> renaming no longer needed files would be good on NFS. After every
>> IndexReader has reopened the index, the renamed files can be safely
>> deleted, as they are definitely no longer needed. Where would be the
>> hook point? I heard something about IndexDeletionPolicy....
>>
>>
>>
>> Thanks in advance!
>>
>>
>>
>> Mirko
>>
>>
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44622-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 15:57:15 2010
Return-Path: <java-user-return-44622-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46619 invoked from network); 20 Jan 2010 15:57:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 15:57:15 -0000
Received: (qmail 11966 invoked by uid 500); 20 Jan 2010 15:57:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11892 invoked by uid 500); 20 Jan 2010 15:57:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11882 invoked by uid 99); 20 Jan 2010 15:57:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:57:12 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of benhei@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 15:57:06 +0000
Received: by fxm2 with SMTP id 2so3063518fxm.5
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 07:56:44 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=zkmbbKDWZeIJ7cMRbXBhTMB4jf3IDibMARZLJhCZBLQ=;
        b=CweEzLV3y01VbBXu8u9SmvMc0Se6rSC6mjrjXZx/v7qEGHtSVbqAVZW1egarvZsxmN
         UdqpTxAkyJnndajsFvfMS8tFeB2pJ8oJGFbSh/BKOxc0Z4+5ooExHceaP5IRLmCjPHBp
         UPoc3hsa5pEu6siyNAC6SYnGIfD7QT2aipO1Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=rQD1uVYBtQAFDE09snLi8WEoRWbq79Vmzg6QkQgU6BMhidcG/4jDbV+TJBPghEk26S
         tsBVpiDtauvmxhmygbv57DJa20STrzXHB5+FUTNuMjSUaPE8Dh/Gp8e8L6Ora4hiexdm
         ZJhS4D0IlpfXgvgA+n8Q0zNRcIjhgfnd198K8=
MIME-Version: 1.0
Received: by 10.223.18.137 with SMTP id w9mr136994faa.61.1264003004853; Wed, 
	20 Jan 2010 07:56:44 -0800 (PST)
In-Reply-To: <4B57190B.4000107@gmail.com>
References: <4B57190B.4000107@gmail.com>
Date: Wed, 20 Jan 2010 16:56:44 +0100
Message-ID: <94095f521001200756u6e9137f8uf0e57078ccbdcc5c@mail.gmail.com>
Subject: Re: TooManyClauses and maxClauseCount question
From: Benjamin Heilbrunn <benhei@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Isn't maxClause count just a "best practice" limit to asure that
performance doesn't decrease silently if big queries occur?
Performance and memory consumption should depend on how many clauses
are really used / number of matching documents
I think that there is no (significant) difference in memory
consumption (or performance) if you run the same query with two
different maxClauseCount settings.

But don't believe me. I'm not familiar with the corresponding code.


2010/1/20 john smith <john.smith391@gmail.com>:
> Hi
> =A0I'am getting TooManyClauses exception while performing wildcard query.=
 I'am
> thinking about changing max clause count limit
> (BooleanQuery.setMaxClauseCount() method). My question referes to memory
> consumption in case of increasing maxClauseCount parameter.
> =A0Does Lucene do it in a smart way (allocates bigger buffer only when it=
 is
> neccesary) or allocates constant (increased) amount of memory for every
> wildcard query ?
> Regards
> JS.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44623-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 16:12:55 2010
Return-Path: <java-user-return-44623-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51463 invoked from network); 20 Jan 2010 16:12:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 16:12:55 -0000
Received: (qmail 44840 invoked by uid 500); 20 Jan 2010 16:12:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44767 invoked by uid 500); 20 Jan 2010 16:12:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44757 invoked by uid 99); 20 Jan 2010 16:12:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 16:12:52 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.173] (HELO mail-yw0-f173.google.com) (209.85.211.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 16:12:45 +0000
Received: by ywh3 with SMTP id 3so2645099ywh.22
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 08:12:24 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.127.27 with SMTP id z27mr391360ybc.104.1264003943778; Wed, 
	20 Jan 2010 08:12:23 -0800 (PST)
In-Reply-To: <1D3D7943573BD14FB024A9654EB43CCB02A4CC21@A99A-EMS-01VS2.ad.bedag.ch>
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200713n624674b3x529507ad3996a641@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC21@A99A-EMS-01VS2.ad.bedag.ch>
Date: Wed, 20 Jan 2010 11:12:23 -0500
Message-ID: <9ac0c6aa1001200812n56e24632xcf7a3fd8bb2392a1@mail.gmail.com>
Subject: Re: NFS, Stale File Handle Problem and my thoughts....
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Yes, normal merging will cause this problem as well.

Generally you should always use IndexReader.reopen -- it gives much
better reopen speed, less resources used, less GC, etc.

Mike

On Wed, Jan 20, 2010 at 10:49 AM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch> wrote:
> Mike
>
> Thank you so much for your feedback!
>
> Will the new IndexDeletionPolicy also be considered when segments are mer=
ged? Does merging also affect the NFS problem?
>
> Should I use IndexReader.reOpen() or just create a new IndexReader?
>
> Thanks in advance
> Mirko
>
> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> Gesendet: Mittwoch, 20. Januar 2010 16:14
> An: java-user@lucene.apache.org
> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>
> Right, it's only machine A that needs the deletion policy. =A0All
> read-only machines just reopen on their schedule (or you can use some
> communication means a Shai describes to have lower latency reopen
> after the writer commits).
>
> Also realize that doing searching over NFS does not usually give very
> good performance... (though I've heard that mounting read-only can
> improve performance).
>
> Mike
>
> On Wed, Jan 20, 2010 at 9:05 AM, Sertic Mirko, Bedag
> <Mirko.Sertic@bedag.ch> wrote:
>> Hi Mike
>>
>> Thank you for your feedback!
>>
>> So I would need the following setup:
>>
>> a) Machine A with custom IndexDeletionPolicy and single IndexReader inst=
ance
>> b) Machine B with custom IndexDeletionPolicy and single IndexReader inst=
ance
>> c) Machine A and B periodically check if the index needs to be reopened,=
 at least at 12 o'clock
>> d) Machine A runs an Index update and optimization at 8 o'clock, using t=
he IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the files to=
 be deleted.
>> e) On Machine A, the no longer needed files are taken from the IndexDele=
tionPolicy, and deleted at 12:30. At this point the files to be deleted sho=
uld no longer be required by any IndexReader and can be safely deleted.
>>
>> So the IndexDeletionPolicy should be a kind of Singleton, and in fact wo=
uld only be needed on Machine A, as only here index modifications are made.=
 Machine B has read only access.
>>
>> Would this be a valid setup? The only limitation is there is only ONE In=
dexWriter box, and multiple IndexReader boxes. Based on our requirements, t=
his should fix very well. I really want to avoid some kind of index replica=
tion between the boxes...
>>
>> Regards
>> Mirko
>>
>>
>>
>> -----Urspr=FCngliche Nachricht-----
>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Gesendet: Mittwoch, 20. Januar 2010 14:45
>> An: java-user@lucene.apache.org
>> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>>
>> Right, you just need to make a custom IndexDeletionPolicy. =A0NFS makes
>> no effort to protect deletion of still-open files.
>>
>> A simple approach is one that only deletes a commit if it's more than
>> XXX minutes/hours old, such that XXX is set higher than the frequency
>> that IndexReaders are guaranteed to have reopened.
>>
>> The TestDeletionPolicy unit test in Lucene's sources has the
>> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>>
>> Another alternative is to simply reopen the reader whenever you hit
>> Stale file handle (think of it as NFS's means of notifying you that
>> your reader is no longer current ;) ). =A0But, if reopen time is
>> potentially long for your app, it's no good to make queries pay that
>> cost and the deletion policy is better.
>>
>> Mike
>>
>> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
>> <Mirko.Sertic@bedag.ch> wrote:
>>> Hi@all
>>>
>>>
>>>
>>> We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
>>> stored on a common NFS share. Every box has a single IndexReader
>>> instance, and one Box has an IndexWriter instance, adding new documents
>>> or deleting existing documents at a given point in time. After adding o=
r
>>> deleting the documents, a IndexWriter.optimize() is called. Every box
>>> checks periodically with IndexReader.isCurrent if the index needs to be
>>> reopened.
>>>
>>>
>>>
>>> Now, we are encountering a "Stale file handle" error on box b after the
>>> index was modified and optimized by box a.
>>>
>>>
>>>
>>> As far as i understand the problem with NFS is that box b tries to
>>> open/access a file that was deleted by box a on the NFS share.
>>>
>>>
>>>
>>> The question is now, when are files deleted? Does only the index
>>> optimization delete files, or can files be deleted just by adding or
>>> removing documents from an existing index?
>>>
>>>
>>>
>>> I now that there might be a better setup with Lucene and index
>>> replication, but this is an existing application and we cannot change
>>> the architecture now. So what would be the best solution?
>>>
>>>
>>>
>>> Can I just "change" the way Lucene deletes files? I think that just
>>> renaming no longer needed files would be good on NFS. After every
>>> IndexReader has reopened the index, the renamed files can be safely
>>> deleted, as they are definitely no longer needed. Where would be the
>>> hook point? I heard something about IndexDeletionPolicy....
>>>
>>>
>>>
>>> Thanks in advance!
>>>
>>>
>>>
>>> Mirko
>>>
>>>
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44624-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 16:31:00 2010
Return-Path: <java-user-return-44624-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56897 invoked from network); 20 Jan 2010 16:31:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 16:31:00 -0000
Received: (qmail 82424 invoked by uid 500); 20 Jan 2010 16:30:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82382 invoked by uid 500); 20 Jan 2010 16:30:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82362 invoked by uid 99); 20 Jan 2010 16:30:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 16:30:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [192.112.254.53] (HELO smtp2.bedag.ch) (192.112.254.53)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 16:30:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by smtp2.bedag.ch (Postfix) with ESMTP id 877A4739A3
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 17:30:28 +0100 (CET)
X-Quarantine-ID: <peYVxAVVX7Hz>
X-Virus-Scanned: Scanned
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: AW: NFS, Stale File Handle Problem and my thoughts....
Date: Wed, 20 Jan 2010 17:27:00 +0100
Message-ID: <1D3D7943573BD14FB024A9654EB43CCB02A4CC22@A99A-EMS-01VS2.ad.bedag.ch>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: NFS, Stale File Handle Problem and my thoughts....
Thread-Index: AcqZ622uPmc9K21kRWaD9Oo8LKf9eQAAYuiQ
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com> <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200713n624674b3x529507ad3996a641@mail.gmail.com> <1D3D7943573BD14FB024A9654EB43CCB02A4CC21@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200812n56e24632xcf7a3fd8bb2392a1@mail.gmail.com>
From: "Sertic Mirko, Bedag" <Mirko.Sertic@bedag.ch>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 20 Jan 2010 16:30:23.0904 (UTC) FILETIME=[DDAF6A00:01CA99ED]
X-Virus-Checked: Checked by ClamAV on apache.org

Ok, so does the merging go thru the IndexDeletionPolicy, or do I have to =
deal with the MergePolicy to take care of merging?

Regards
Mirko

-----Urspr=FCngliche Nachricht-----
Von: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Gesendet: Mittwoch, 20. Januar 2010 17:12
An: java-user@lucene.apache.org
Betreff: Re: NFS, Stale File Handle Problem and my thoughts....

Yes, normal merging will cause this problem as well.

Generally you should always use IndexReader.reopen -- it gives much
better reopen speed, less resources used, less GC, etc.

Mike

On Wed, Jan 20, 2010 at 10:49 AM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch> wrote:
> Mike
>
> Thank you so much for your feedback!
>
> Will the new IndexDeletionPolicy also be considered when segments are =
merged? Does merging also affect the NFS problem?
>
> Should I use IndexReader.reOpen() or just create a new IndexReader?
>
> Thanks in advance
> Mirko
>
> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> Gesendet: Mittwoch, 20. Januar 2010 16:14
> An: java-user@lucene.apache.org
> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>
> Right, it's only machine A that needs the deletion policy. =A0All
> read-only machines just reopen on their schedule (or you can use some
> communication means a Shai describes to have lower latency reopen
> after the writer commits).
>
> Also realize that doing searching over NFS does not usually give very
> good performance... (though I've heard that mounting read-only can
> improve performance).
>
> Mike
>
> On Wed, Jan 20, 2010 at 9:05 AM, Sertic Mirko, Bedag
> <Mirko.Sertic@bedag.ch> wrote:
>> Hi Mike
>>
>> Thank you for your feedback!
>>
>> So I would need the following setup:
>>
>> a) Machine A with custom IndexDeletionPolicy and single IndexReader =
instance
>> b) Machine B with custom IndexDeletionPolicy and single IndexReader =
instance
>> c) Machine A and B periodically check if the index needs to be =
reopened, at least at 12 o'clock
>> d) Machine A runs an Index update and optimization at 8 o'clock, =
using the IndexDeletionPolicy. The IndexDeletionPolicy keeps track of =
the files to be deleted.
>> e) On Machine A, the no longer needed files are taken from the =
IndexDeletionPolicy, and deleted at 12:30. At this point the files to be =
deleted should no longer be required by any IndexReader and can be =
safely deleted.
>>
>> So the IndexDeletionPolicy should be a kind of Singleton, and in fact =
would only be needed on Machine A, as only here index modifications are =
made. Machine B has read only access.
>>
>> Would this be a valid setup? The only limitation is there is only ONE =
IndexWriter box, and multiple IndexReader boxes. Based on our =
requirements, this should fix very well. I really want to avoid some =
kind of index replication between the boxes...
>>
>> Regards
>> Mirko
>>
>>
>>
>> -----Urspr=FCngliche Nachricht-----
>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Gesendet: Mittwoch, 20. Januar 2010 14:45
>> An: java-user@lucene.apache.org
>> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>>
>> Right, you just need to make a custom IndexDeletionPolicy. =A0NFS =
makes
>> no effort to protect deletion of still-open files.
>>
>> A simple approach is one that only deletes a commit if it's more than
>> XXX minutes/hours old, such that XXX is set higher than the frequency
>> that IndexReaders are guaranteed to have reopened.
>>
>> The TestDeletionPolicy unit test in Lucene's sources has the
>> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>>
>> Another alternative is to simply reopen the reader whenever you hit
>> Stale file handle (think of it as NFS's means of notifying you that
>> your reader is no longer current ;) ). =A0But, if reopen time is
>> potentially long for your app, it's no good to make queries pay that
>> cost and the deletion policy is better.
>>
>> Mike
>>
>> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
>> <Mirko.Sertic@bedag.ch> wrote:
>>> Hi@all
>>>
>>>
>>>
>>> We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
>>> stored on a common NFS share. Every box has a single IndexReader
>>> instance, and one Box has an IndexWriter instance, adding new =
documents
>>> or deleting existing documents at a given point in time. After =
adding or
>>> deleting the documents, a IndexWriter.optimize() is called. Every =
box
>>> checks periodically with IndexReader.isCurrent if the index needs to =
be
>>> reopened.
>>>
>>>
>>>
>>> Now, we are encountering a "Stale file handle" error on box b after =
the
>>> index was modified and optimized by box a.
>>>
>>>
>>>
>>> As far as i understand the problem with NFS is that box b tries to
>>> open/access a file that was deleted by box a on the NFS share.
>>>
>>>
>>>
>>> The question is now, when are files deleted? Does only the index
>>> optimization delete files, or can files be deleted just by adding or
>>> removing documents from an existing index?
>>>
>>>
>>>
>>> I now that there might be a better setup with Lucene and index
>>> replication, but this is an existing application and we cannot =
change
>>> the architecture now. So what would be the best solution?
>>>
>>>
>>>
>>> Can I just "change" the way Lucene deletes files? I think that just
>>> renaming no longer needed files would be good on NFS. After every
>>> IndexReader has reopened the index, the renamed files can be safely
>>> deleted, as they are definitely no longer needed. Where would be the
>>> hook point? I heard something about IndexDeletionPolicy....
>>>
>>>
>>>
>>> Thanks in advance!
>>>
>>>
>>>
>>> Mirko
>>>
>>>
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44625-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 16:38:31 2010
Return-Path: <java-user-return-44625-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58600 invoked from network); 20 Jan 2010 16:38:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 16:38:31 -0000
Received: (qmail 95745 invoked by uid 500); 20 Jan 2010 16:38:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95692 invoked by uid 500); 20 Jan 2010 16:38:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95682 invoked by uid 99); 20 Jan 2010 16:38:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 16:38:28 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.211.173] (HELO mail-yw0-f173.google.com) (209.85.211.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 16:38:21 +0000
Received: by ywh3 with SMTP id 3so2671239ywh.22
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 08:38:00 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.21.26 with SMTP id 26mr420142ybu.192.1264005479703; Wed, 
	20 Jan 2010 08:37:59 -0800 (PST)
In-Reply-To: <1D3D7943573BD14FB024A9654EB43CCB02A4CC22@A99A-EMS-01VS2.ad.bedag.ch>
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200713n624674b3x529507ad3996a641@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC21@A99A-EMS-01VS2.ad.bedag.ch>
	 <9ac0c6aa1001200812n56e24632xcf7a3fd8bb2392a1@mail.gmail.com>
	 <1D3D7943573BD14FB024A9654EB43CCB02A4CC22@A99A-EMS-01VS2.ad.bedag.ch>
Date: Wed, 20 Jan 2010 11:37:59 -0500
Message-ID: <9ac0c6aa1001200837q511048bfheca826d5881a2503@mail.gmail.com>
Subject: Re: NFS, Stale File Handle Problem and my thoughts....
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

You only have to create the deletion policy (merging uses it).

Mike

On Wed, Jan 20, 2010 at 11:27 AM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch> wrote:
> Ok, so does the merging go thru the IndexDeletionPolicy, or do I have to =
deal with the MergePolicy to take care of merging?
>
> Regards
> Mirko
>
> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> Gesendet: Mittwoch, 20. Januar 2010 17:12
> An: java-user@lucene.apache.org
> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>
> Yes, normal merging will cause this problem as well.
>
> Generally you should always use IndexReader.reopen -- it gives much
> better reopen speed, less resources used, less GC, etc.
>
> Mike
>
> On Wed, Jan 20, 2010 at 10:49 AM, Sertic Mirko, Bedag
> <Mirko.Sertic@bedag.ch> wrote:
>> Mike
>>
>> Thank you so much for your feedback!
>>
>> Will the new IndexDeletionPolicy also be considered when segments are me=
rged? Does merging also affect the NFS problem?
>>
>> Should I use IndexReader.reOpen() or just create a new IndexReader?
>>
>> Thanks in advance
>> Mirko
>>
>> -----Urspr=FCngliche Nachricht-----
>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Gesendet: Mittwoch, 20. Januar 2010 16:14
>> An: java-user@lucene.apache.org
>> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>>
>> Right, it's only machine A that needs the deletion policy. =A0All
>> read-only machines just reopen on their schedule (or you can use some
>> communication means a Shai describes to have lower latency reopen
>> after the writer commits).
>>
>> Also realize that doing searching over NFS does not usually give very
>> good performance... (though I've heard that mounting read-only can
>> improve performance).
>>
>> Mike
>>
>> On Wed, Jan 20, 2010 at 9:05 AM, Sertic Mirko, Bedag
>> <Mirko.Sertic@bedag.ch> wrote:
>>> Hi Mike
>>>
>>> Thank you for your feedback!
>>>
>>> So I would need the following setup:
>>>
>>> a) Machine A with custom IndexDeletionPolicy and single IndexReader ins=
tance
>>> b) Machine B with custom IndexDeletionPolicy and single IndexReader ins=
tance
>>> c) Machine A and B periodically check if the index needs to be reopened=
, at least at 12 o'clock
>>> d) Machine A runs an Index update and optimization at 8 o'clock, using =
the IndexDeletionPolicy. The IndexDeletionPolicy keeps track of the files t=
o be deleted.
>>> e) On Machine A, the no longer needed files are taken from the IndexDel=
etionPolicy, and deleted at 12:30. At this point the files to be deleted sh=
ould no longer be required by any IndexReader and can be safely deleted.
>>>
>>> So the IndexDeletionPolicy should be a kind of Singleton, and in fact w=
ould only be needed on Machine A, as only here index modifications are made=
. Machine B has read only access.
>>>
>>> Would this be a valid setup? The only limitation is there is only ONE I=
ndexWriter box, and multiple IndexReader boxes. Based on our requirements, =
this should fix very well. I really want to avoid some kind of index replic=
ation between the boxes...
>>>
>>> Regards
>>> Mirko
>>>
>>>
>>>
>>> -----Urspr=FCngliche Nachricht-----
>>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>>> Gesendet: Mittwoch, 20. Januar 2010 14:45
>>> An: java-user@lucene.apache.org
>>> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>>>
>>> Right, you just need to make a custom IndexDeletionPolicy. =A0NFS makes
>>> no effort to protect deletion of still-open files.
>>>
>>> A simple approach is one that only deletes a commit if it's more than
>>> XXX minutes/hours old, such that XXX is set higher than the frequency
>>> that IndexReaders are guaranteed to have reopened.
>>>
>>> The TestDeletionPolicy unit test in Lucene's sources has the
>>> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>>>
>>> Another alternative is to simply reopen the reader whenever you hit
>>> Stale file handle (think of it as NFS's means of notifying you that
>>> your reader is no longer current ;) ). =A0But, if reopen time is
>>> potentially long for your app, it's no good to make queries pay that
>>> cost and the deletion policy is better.
>>>
>>> Mike
>>>
>>> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
>>> <Mirko.Sertic@bedag.ch> wrote:
>>>> Hi@all
>>>>
>>>>
>>>>
>>>> We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index is
>>>> stored on a common NFS share. Every box has a single IndexReader
>>>> instance, and one Box has an IndexWriter instance, adding new document=
s
>>>> or deleting existing documents at a given point in time. After adding =
or
>>>> deleting the documents, a IndexWriter.optimize() is called. Every box
>>>> checks periodically with IndexReader.isCurrent if the index needs to b=
e
>>>> reopened.
>>>>
>>>>
>>>>
>>>> Now, we are encountering a "Stale file handle" error on box b after th=
e
>>>> index was modified and optimized by box a.
>>>>
>>>>
>>>>
>>>> As far as i understand the problem with NFS is that box b tries to
>>>> open/access a file that was deleted by box a on the NFS share.
>>>>
>>>>
>>>>
>>>> The question is now, when are files deleted? Does only the index
>>>> optimization delete files, or can files be deleted just by adding or
>>>> removing documents from an existing index?
>>>>
>>>>
>>>>
>>>> I now that there might be a better setup with Lucene and index
>>>> replication, but this is an existing application and we cannot change
>>>> the architecture now. So what would be the best solution?
>>>>
>>>>
>>>>
>>>> Can I just "change" the way Lucene deletes files? I think that just
>>>> renaming no longer needed files would be good on NFS. After every
>>>> IndexReader has reopened the index, the renamed files can be safely
>>>> deleted, as they are definitely no longer needed. Where would be the
>>>> hook point? I heard something about IndexDeletionPolicy....
>>>>
>>>>
>>>>
>>>> Thanks in advance!
>>>>
>>>>
>>>>
>>>> Mirko
>>>>
>>>>
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44626-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 16:57:46 2010
Return-Path: <java-user-return-44626-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64219 invoked from network); 20 Jan 2010 16:57:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 16:57:46 -0000
Received: (qmail 31647 invoked by uid 500); 20 Jan 2010 16:57:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31570 invoked by uid 500); 20 Jan 2010 16:57:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31560 invoked by uid 99); 20 Jan 2010 16:57:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 16:57:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [192.112.254.51] (HELO smtp2.bedag.ch) (192.112.254.51)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 20 Jan 2010 16:57:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by smtp1.bedag.ch (Postfix) with ESMTP id 6FCEF739FC
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 17:57:13 +0100 (CET)
X-Quarantine-ID: <E1ymhxBxcETV>
X-Virus-Scanned: Scanned
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: AW: NFS, Stale File Handle Problem and my thoughts....
Date: Wed, 20 Jan 2010 17:57:08 +0100
Message-ID: <1D3D7943573BD14FB024A9654EB43CCB02A4CC23@A99A-EMS-01VS2.ad.bedag.ch>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: NFS, Stale File Handle Problem and my thoughts....
Thread-Index: AcqZ7wFcvKpEDaFxQyyGFca6DsV4NAAAjwQA
References: <1D3D7943573BD14FB024A9654EB43CCB02A4CC1E@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200544w4ef5f26eq58b5d397c5ba1baa@mail.gmail.com> <1D3D7943573BD14FB024A9654EB43CCB02A4CC1F@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200713n624674b3x529507ad3996a641@mail.gmail.com> <1D3D7943573BD14FB024A9654EB43CCB02A4CC21@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200812n56e24632xcf7a3fd8bb2392a1@mail.gmail.com> <1D3D7943573BD14FB024A9654EB43CCB02A4CC22@A99A-EMS-01VS2.ad.bedag.ch> <9ac0c6aa1001200837q511048bfheca826d5881a2503@mail.gmail.com>
From: "Sertic Mirko, Bedag" <Mirko.Sertic@bedag.ch>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 20 Jan 2010 16:57:09.0148 (UTC) FILETIME=[9A7C35C0:01CA99F1]

Yeah!

You made my day!

I will post my new IndexDeletionPolicy, perhaps someone else can use it =
too!

Regards
Mirko

-----Urspr=FCngliche Nachricht-----
Von: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Gesendet: Mittwoch, 20. Januar 2010 17:38
An: java-user@lucene.apache.org
Betreff: Re: NFS, Stale File Handle Problem and my thoughts....

You only have to create the deletion policy (merging uses it).

Mike

On Wed, Jan 20, 2010 at 11:27 AM, Sertic Mirko, Bedag
<Mirko.Sertic@bedag.ch> wrote:
> Ok, so does the merging go thru the IndexDeletionPolicy, or do I have =
to deal with the MergePolicy to take care of merging?
>
> Regards
> Mirko
>
> -----Urspr=FCngliche Nachricht-----
> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
> Gesendet: Mittwoch, 20. Januar 2010 17:12
> An: java-user@lucene.apache.org
> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>
> Yes, normal merging will cause this problem as well.
>
> Generally you should always use IndexReader.reopen -- it gives much
> better reopen speed, less resources used, less GC, etc.
>
> Mike
>
> On Wed, Jan 20, 2010 at 10:49 AM, Sertic Mirko, Bedag
> <Mirko.Sertic@bedag.ch> wrote:
>> Mike
>>
>> Thank you so much for your feedback!
>>
>> Will the new IndexDeletionPolicy also be considered when segments are =
merged? Does merging also affect the NFS problem?
>>
>> Should I use IndexReader.reOpen() or just create a new IndexReader?
>>
>> Thanks in advance
>> Mirko
>>
>> -----Urspr=FCngliche Nachricht-----
>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>> Gesendet: Mittwoch, 20. Januar 2010 16:14
>> An: java-user@lucene.apache.org
>> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>>
>> Right, it's only machine A that needs the deletion policy. =A0All
>> read-only machines just reopen on their schedule (or you can use some
>> communication means a Shai describes to have lower latency reopen
>> after the writer commits).
>>
>> Also realize that doing searching over NFS does not usually give very
>> good performance... (though I've heard that mounting read-only can
>> improve performance).
>>
>> Mike
>>
>> On Wed, Jan 20, 2010 at 9:05 AM, Sertic Mirko, Bedag
>> <Mirko.Sertic@bedag.ch> wrote:
>>> Hi Mike
>>>
>>> Thank you for your feedback!
>>>
>>> So I would need the following setup:
>>>
>>> a) Machine A with custom IndexDeletionPolicy and single IndexReader =
instance
>>> b) Machine B with custom IndexDeletionPolicy and single IndexReader =
instance
>>> c) Machine A and B periodically check if the index needs to be =
reopened, at least at 12 o'clock
>>> d) Machine A runs an Index update and optimization at 8 o'clock, =
using the IndexDeletionPolicy. The IndexDeletionPolicy keeps track of =
the files to be deleted.
>>> e) On Machine A, the no longer needed files are taken from the =
IndexDeletionPolicy, and deleted at 12:30. At this point the files to be =
deleted should no longer be required by any IndexReader and can be =
safely deleted.
>>>
>>> So the IndexDeletionPolicy should be a kind of Singleton, and in =
fact would only be needed on Machine A, as only here index modifications =
are made. Machine B has read only access.
>>>
>>> Would this be a valid setup? The only limitation is there is only =
ONE IndexWriter box, and multiple IndexReader boxes. Based on our =
requirements, this should fix very well. I really want to avoid some =
kind of index replication between the boxes...
>>>
>>> Regards
>>> Mirko
>>>
>>>
>>>
>>> -----Urspr=FCngliche Nachricht-----
>>> Von: Michael McCandless [mailto:lucene@mikemccandless.com]
>>> Gesendet: Mittwoch, 20. Januar 2010 14:45
>>> An: java-user@lucene.apache.org
>>> Betreff: Re: NFS, Stale File Handle Problem and my thoughts....
>>>
>>> Right, you just need to make a custom IndexDeletionPolicy. =A0NFS =
makes
>>> no effort to protect deletion of still-open files.
>>>
>>> A simple approach is one that only deletes a commit if it's more =
than
>>> XXX minutes/hours old, such that XXX is set higher than the =
frequency
>>> that IndexReaders are guaranteed to have reopened.
>>>
>>> The TestDeletionPolicy unit test in Lucene's sources has the
>>> ExperiationTimeDeletionPolicy that you can use (but scrutinize!).
>>>
>>> Another alternative is to simply reopen the reader whenever you hit
>>> Stale file handle (think of it as NFS's means of notifying you that
>>> your reader is no longer current ;) ). =A0But, if reopen time is
>>> potentially long for your app, it's no good to make queries pay that
>>> cost and the deletion policy is better.
>>>
>>> Mike
>>>
>>> On Wed, Jan 20, 2010 at 8:29 AM, Sertic Mirko, Bedag
>>> <Mirko.Sertic@bedag.ch> wrote:
>>>> Hi@all
>>>>
>>>>
>>>>
>>>> We are using Lucene 2.4.1 on Debian Linux with 2 boxes. The index =
is
>>>> stored on a common NFS share. Every box has a single IndexReader
>>>> instance, and one Box has an IndexWriter instance, adding new =
documents
>>>> or deleting existing documents at a given point in time. After =
adding or
>>>> deleting the documents, a IndexWriter.optimize() is called. Every =
box
>>>> checks periodically with IndexReader.isCurrent if the index needs =
to be
>>>> reopened.
>>>>
>>>>
>>>>
>>>> Now, we are encountering a "Stale file handle" error on box b after =
the
>>>> index was modified and optimized by box a.
>>>>
>>>>
>>>>
>>>> As far as i understand the problem with NFS is that box b tries to
>>>> open/access a file that was deleted by box a on the NFS share.
>>>>
>>>>
>>>>
>>>> The question is now, when are files deleted? Does only the index
>>>> optimization delete files, or can files be deleted just by adding =
or
>>>> removing documents from an existing index?
>>>>
>>>>
>>>>
>>>> I now that there might be a better setup with Lucene and index
>>>> replication, but this is an existing application and we cannot =
change
>>>> the architecture now. So what would be the best solution?
>>>>
>>>>
>>>>
>>>> Can I just "change" the way Lucene deletes files? I think that just
>>>> renaming no longer needed files would be good on NFS. After every
>>>> IndexReader has reopened the index, the renamed files can be safely
>>>> deleted, as they are definitely no longer needed. Where would be =
the
>>>> hook point? I heard something about IndexDeletionPolicy....
>>>>
>>>>
>>>>
>>>> Thanks in advance!
>>>>
>>>>
>>>>
>>>> Mirko
>>>>
>>>>
>>>>
>>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44627-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 17:36:12 2010
Return-Path: <java-user-return-44627-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83304 invoked from network); 20 Jan 2010 17:36:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 17:36:12 -0000
Received: (qmail 86993 invoked by uid 500); 20 Jan 2010 17:36:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86916 invoked by uid 500); 20 Jan 2010 17:36:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86906 invoked by uid 99); 20 Jan 2010 17:36:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 17:36:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of karl.wettin@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 17:36:01 +0000
Received: by ewy9 with SMTP id 9so8816110ewy.11
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 09:35:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:from:to
         :in-reply-to:content-type:content-transfer-encoding:mime-version
         :subject:date:references:x-mailer;
        bh=BtafnTGjsszL7CQiUFxWBCiwc+NpCd1DngX23T/GSOc=;
        b=ZGT3UkANS26du1NkltXSoVviaptlijvHzjY0RLDSOUUaae7nQ86eFOi2+1d/8tNdQs
         0NO6r0bVG/Utn9a6oz4ay/J6qtgpQbt0ikhi2RezvY4/1Ggl3bgSm5mZpLrJ1Al614Yk
         Ie0KqxbjHjIb+m2b4bNFHGpZBbIRSvNOMltGY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:from:to:in-reply-to:content-type
         :content-transfer-encoding:mime-version:subject:date:references
         :x-mailer;
        b=uqyeu6EZz/S/C5UjANIRbrp2dE4Ei8ic9V77PaY0TnJBxspAAtzwXOIgroQJ+iUuYB
         TnKonEVtliuMatMnF6RSQ8Hq8vbynojC5tFf6SeHiK22ZA2vgfbvARtvMKOojwIr+tmJ
         LZfCgOwoD7+8taTXBP7n4YpumGjNprHPAyAfA=
Received: by 10.216.163.81 with SMTP id z59mr102189wek.95.1264008940903;
        Wed, 20 Jan 2010 09:35:40 -0800 (PST)
Received: from ?192.168.1.201? (c-8f8170d5.029-18-6d6c6d2.cust.bredbandsbolaget.se [213.112.129.143])
        by mx.google.com with ESMTPS id 28sm9723227eye.5.2010.01.20.09.35.38
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 20 Jan 2010 09:35:39 -0800 (PST)
Message-Id: <232D8FB9-408D-4E25-99F9-0CBD8DEB7B4C@gmail.com>
From: Karl Wettin <karl.wettin@gmail.com>
To: java-user@lucene.apache.org
In-Reply-To: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: Re: Lucene as a primary datastore
Date: Wed, 20 Jan 2010 18:35:37 +0100
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
X-Mailer: Apple Mail (2.936)
X-Virus-Checked: Checked by ClamAV on apache.org


20 jan 2010 kl. 04.58 skrev Guido Bartolucci:

> Am I just ignorant and scared of Lucene and too trusting of Oracle  
> and MySQL?

Since all your comparations is with relational databases I feel  
obligated to say what has been said so many times on this list:

Lucene is an index and not a relational database. There are many  
things you can do with a relational database you don't even want to  
try to do with a Lucene index.

What Lucene can do without a problem is to act as a key-value store.

My indices does however tend to evolve. I find ways to improve the  
index and that often result in rebuilding the index from scratch. That  
can be problematic if the index also act as the primary persistency  
layer. Therefore I've occationally used Lucene as a secondary  
persistency layer, i.e. pushed data from the primary persistency  
(usually a Berkeley DB) to Lucene (Solr) for easy and up to date  
distribution of the domain data the index points at. But to be quite  
honest I don't like it and I can't explain why in more detail than  
that it feels wrong. It's always been a hack to save time. (Since BDB  
JE came with distribution I don't do this anymore.)


       karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44628-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 18:03:48 2010
Return-Path: <java-user-return-44628-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5955 invoked from network); 20 Jan 2010 18:03:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 18:03:48 -0000
Received: (qmail 43114 invoked by uid 500); 20 Jan 2010 18:03:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43030 invoked by uid 500); 20 Jan 2010 18:03:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43020 invoked by uid 99); 20 Jan 2010 18:03:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 18:03:46 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.26 as permitted sender)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 18:03:37 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id 6AD33CE7E6
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 13:03:16 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Wed, 20 Jan 2010 13:03:16 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=UmdAGyLRpBfCQ13E97bM4t61KJA=; b=sPKIN6u8PZHVwlRw9P1asP9YKa8AbmVOIvoBrs1onTLZQzmk1zlBmlvH3HUhcO7CSSHILpNJsXFJ6nvlRCceYFxJIrfOrcZpCEMPQn0RVYkf2pW3agtCoTBOXhPw2GhgxpXVgnTEHQVuXJblZRQB32PH81mYyqG/jSsdYBzFSug=
X-Sasl-enc: oRMSmN7Igr85+e6rleUtvPSl4hj2MpsggMH4Qr8bawQ1 1264010595
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 9718B4B5910
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 13:03:15 -0500 (EST)
Message-ID: <4B574562.80308@fastmail.fm>
Date: Wed, 20 Jan 2010 18:03:14 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Can you boost multiple terms using brackets ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit


Hi

is

title:(return panther)^3 alias:(return panther)


the same as

title:return^3 title:panther^3 alias:(return panther)


thanks Paul


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44629-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 19:41:55 2010
Return-Path: <java-user-return-44629-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57822 invoked from network); 20 Jan 2010 19:41:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 19:41:55 -0000
Received: (qmail 20464 invoked by uid 500); 20 Jan 2010 19:41:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20428 invoked by uid 500); 20 Jan 2010 19:41:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20418 invoked by uid 99); 20 Jan 2010 19:41:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 19:41:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 19:41:43 +0000
Received: by bwz22 with SMTP id 22so1521023bwz.5
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 11:41:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=hYrKJWKa03rzxjE4FZ1kPGW/4xKdiymnu98gJjicZTc=;
        b=qYv/TvwH09WG2y8cF+bo7nO3OD8blyOrY+AalWPdzs3wp0kKKGBaKwoqMnEnM6qf14
         TreTHW4xMDl/b5eVqOjB594g8KwXpLpLgQZU1nA0EcCr6JOFhCgGwGPqgQ8WaWg04SzJ
         N+SYsH+SZFU1tAmI8Ao+egzu5UoL5Z/HKvL0Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=j6On212BeBq1aCtAxlVPnQSIUV0mhj1mH8XR8BswCmnM30YeH1Tk9hhs/r90Bkn0Am
         LMXNLV4OXmA87JlnYISzU/h5PcJ+6c1RpF3KTTofFzm3c7xskzH9EFy55Z6+PFQEl8H2
         /9S9rxGRdQVHfxNAPrpF2TZhm3DYW5cUBjUzA=
Received: by 10.204.4.194 with SMTP id 2mr235944bks.38.1264016481763;
        Wed, 20 Jan 2010 11:41:21 -0800 (PST)
Received: from ?192.168.1.100? (c-71-202-137-93.hsd1.ca.comcast.net [71.202.137.93])
        by mx.google.com with ESMTPS id 15sm130853bwz.4.2010.01.20.11.41.19
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 20 Jan 2010 11:41:20 -0800 (PST)
Message-ID: <4B575C4B.4040800@gmail.com>
Date: Wed, 20 Jan 2010 11:40:59 -0800
From: Chris Lu <chris.lu@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene as a primary datastore
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
In-Reply-To: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

I have 3 concerns of making Lucene as a primary database.
1) Lucene is stable when it's stable. But you will have java exceptions.
What would you do when FileNotFoundException or "Lucene 2.9.1 'read past 
EOF' IOException under system load" happens?
For me, I don't the data is safe this way. Or, you can understand all 
Lucene APIs and never make any mistakes.
Some databases, like some versions of mysql, could corrupt data. No 
better, but it's still more robust.
2) As the name suggests, Lucene index is just an index, like database 
index, it's an auxiliary data structure. It's only fast in one way, but 
could be slow in other ways.
3) The more robust approach is to pull data out of database, and create 
a Lucene index. In case something goes wrong, you can always pull data 
out again and create the index again.

--
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes: http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
DBSight customer, a shopping comparison site, (anonymous per request) got 2.6 Million Euro funding!



Guido Bartolucci wrote:
> I know that the primary use case for Lucene is as an index of data
> that can be reconstructed (e.g., from a relational database or from
> spidering your corporate intranet).
>
> But, I'm curious if anyone uses Lucene as their primary datastore for
> their gold data. Is it good enough?
>
> Would anyone consider (or do people already) store data in Lucene
> that, if it was lost, would destroy their business? And no, I'm not
> suggesting that you don't back up this data, I'm just curious if there
> are problems with using Lucene in this way. Are there subtle
> corruptions that might show up in Lucene that wouldn't show up in
> Oracle or MySQL?
>
> I'm considering using Lucene in this way but I haven't been able to
> find any documentation describing this use case. Are there any studies
> of Lucene vs MySQL running for N years comparing the corruptions and
> recovery times?
>
> Am I just ignorant and scared of Lucene and too trusting of Oracle and MySQL?
>
> Thanks.
>
> -guido.
>
> (BTW, I did find a similar question asked back in 2007 in the archives
> but it doesn't really answer my question)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44630-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 21:25:42 2010
Return-Path: <java-user-return-44630-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96599 invoked from network); 20 Jan 2010 21:25:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 21:25:42 -0000
Received: (qmail 78994 invoked by uid 500); 20 Jan 2010 21:25:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78931 invoked by uid 500); 20 Jan 2010 21:25:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78921 invoked by uid 99); 20 Jan 2010 21:25:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 21:25:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of guido.bartolucci@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 21:25:30 +0000
Received: by pxi16 with SMTP id 16so4019280pxi.29
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 13:25:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type;
        bh=YgsjJ/4JoMlF4qVo8ZTnwIDYSKm7lam2JTlsKbBmxHg=;
        b=eg5hn3wsB+DVIh85Lv4dGgauOvvs8Mrczar2aIbJl3V+dCJf0oFfd7YPEJsP6xmFxJ
         Rwr37A/jxDwqzQgX4Jw+PQfrplkthsUwbozMa71aZz8OnjgPDFgAOw15R7PR3DWTxgTi
         XgzUB8IFi6CcjRkWl783H+ilKaNGPi+jBwe8Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type;
        b=T2h0fEM4TzMzfoD1kzbrkzRkdqXinzQOWNni274x50YH9MS5ybWX0/nDDFzvasMfld
         Kfdji1Sm1ajre0p/N+HRp/bP1CshFkeEvQ4oolcdo+NiztNEZWxsc8bfnYJxzghfLNNK
         uWKnJCZKITQyxjzcPqyG2vkHi+W9wQccUyg8I=
MIME-Version: 1.0
Received: by 10.115.61.10 with SMTP id o10mr366759wak.37.1264022709475; Wed, 
	20 Jan 2010 13:25:09 -0800 (PST)
Reply-To: guido@bartolucci.org
In-Reply-To: <4B575C4B.4040800@gmail.com>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
	 <4B575C4B.4040800@gmail.com>
Date: Wed, 20 Jan 2010 13:25:09 -0800
Message-ID: <ba012a2b1001201325i5bbdc638x8ae353f4f70de8fc@mail.gmail.com>
Subject: Re: Lucene as a primary datastore
From: Guido Bartolucci <guido.bartolucci@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for the response. I understand all of what you wrote, but what
I care about and what I had a little trouble describing exactly in my
previous question is:

- Are all problems with Lucene obvious (e.g., you get an exception and
you know your data is now bad) or are there subtle corruptions that
just happen and because of that it makes sense to constantly rebuild
the index?

I ask this because if this isn't the case then replication isn't going
to help, the problems probably get copied over to the other instances
(unless I'm missing something).

guido.


On Wed, Jan 20, 2010 at 11:40 AM, Chris Lu <chris.lu@gmail.com> wrote:
> I have 3 concerns of making Lucene as a primary database.
> 1) Lucene is stable when it's stable. But you will have java exceptions.
> What would you do when FileNotFoundException or "Lucene 2.9.1 'read past
> EOF' IOException under system load" happens?
> For me, I don't the data is safe this way. Or, you can understand all Lucene
> APIs and never make any mistakes.
> Some databases, like some versions of mysql, could corrupt data. No better,
> but it's still more robust.
> 2) As the name suggests, Lucene index is just an index, like database index,
> it's an auxiliary data structure. It's only fast in one way, but could be
> slow in other ways.
> 3) The more robust approach is to pull data out of database, and create a
> Lucene index. In case something goes wrong, you can always pull data out
> again and create the index again.
>
> --
> Chris Lu
> -------------------------
> Instant Scalable Full-Text Search On Any Database/Application
> site: http://www.dbsight.net
> demo: http://search.dbsight.com
> Lucene Database Search in 3 minutes:
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> DBSight customer, a shopping comparison site, (anonymous per request) got
> 2.6 Million Euro funding!
>
>
>
> Guido Bartolucci wrote:
>>
>> I know that the primary use case for Lucene is as an index of data
>> that can be reconstructed (e.g., from a relational database or from
>> spidering your corporate intranet).
>>
>> But, I'm curious if anyone uses Lucene as their primary datastore for
>> their gold data. Is it good enough?
>>
>> Would anyone consider (or do people already) store data in Lucene
>> that, if it was lost, would destroy their business? And no, I'm not
>> suggesting that you don't back up this data, I'm just curious if there
>> are problems with using Lucene in this way. Are there subtle
>> corruptions that might show up in Lucene that wouldn't show up in
>> Oracle or MySQL?
>>
>> I'm considering using Lucene in this way but I haven't been able to
>> find any documentation describing this use case. Are there any studies
>> of Lucene vs MySQL running for N years comparing the corruptions and
>> recovery times?
>>
>> Am I just ignorant and scared of Lucene and too trusting of Oracle and
>> MySQL?
>>
>> Thanks.
>>
>> -guido.
>>
>> (BTW, I did find a similar question asked back in 2007 in the archives
>> but it doesn't really answer my question)
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44631-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 22:10:05 2010
Return-Path: <java-user-return-44631-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28258 invoked from network); 20 Jan 2010 22:10:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 22:10:05 -0000
Received: (qmail 49459 invoked by uid 500); 20 Jan 2010 22:10:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49374 invoked by uid 500); 20 Jan 2010 22:10:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49364 invoked by uid 99); 20 Jan 2010 22:10:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 22:10:02 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [72.249.82.150] (HELO uptecs.net) (72.249.82.150)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 22:09:53 +0000
Received: from ical.example.com (110-174-160-164.static.tpgi.com.au [110.174.160.164])
	(Authenticated sender: jacob)
	by uptecs.net (Postfix) with ESMTPA id E266F7C1D1
	for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 22:09:28 +0000 (UTC)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Lucene as a primary datastore
From: Jacob Rhoden <jrhoden@unimelb.edu.au>
In-Reply-To: <856ac15f1001200230g6a95ea0dp50c1502a4c6ac575@mail.gmail.com>
Date: Thu, 21 Jan 2010 09:09:26 +1100
Content-Transfer-Encoding: quoted-printable
Message-Id: <DC8A2E7D-1B9C-4C54-BD39-AC47E58EC070@unimelb.edu.au>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com> <856ac15f1001200230g6a95ea0dp50c1502a4c6ac575@mail.gmail.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org

In the same way that you should take regular exports/dumps of your mysql =
databases, you could have the same strategy with lucene.

As long as you have code that can export your data that runs daily, and =
code that can rebuild your index from that data, In the event of a =
problem the most you will loose is up to 24 hours of data yes?

The whole concept of using lucene as the data store has also been on my =
mind, simply because I have some systems where the lucene index is =
simply a copy of all of the mysql data, makes me wonder why I even =
bother with the mysql part (:

On 20/01/2010, at 9:30 PM, Chris Harris wrote:

> I don't do a lot of work with straight Lucene right now, but I do use
> Solr, and from time to time the Lucene index inside my master Solr
> server gets corrupted; in particular, some of the Lucene segment files
> that are still in use somehow get deleted, resulting in Lucene
> throwing FileNotFoundExceptions. Once this happens, I have to either
> rebuild the whole index, or else run the Lucene CheckIndex tool in
> "fix" mode, which renders the index operable again, but at the expense
> of throwing away some of the data. This happens rarely, and I haven't
> been able to diagnose it yet. In the meantime, though, I find it
> somewhat reassuring to know that my source data is in a SQL table.
>=20
> I don't know that this experience is relevant to you; my problem could
> come from a variety of sources outside Lucene, including a potential
> bug in Solr, and user error on my part. All the same, perhaps it would
> be worth searching the mailing list archives for FileNotFound, to see
> what else comes up?
>=20
> On Tue, Jan 19, 2010 at 7:58 PM, Guido Bartolucci
> <guido.bartolucci@gmail.com> wrote:
>> I know that the primary use case for Lucene is as an index of data
>> that can be reconstructed (e.g., from a relational database or from
>> spidering your corporate intranet).
>>=20
>> But, I'm curious if anyone uses Lucene as their primary datastore for
>> their gold data. Is it good enough?
>>=20
>> Would anyone consider (or do people already) store data in Lucene
>> that, if it was lost, would destroy their business? And no, I'm not
>> suggesting that you don't back up this data, I'm just curious if =
there
>> are problems with using Lucene in this way. Are there subtle
>> corruptions that might show up in Lucene that wouldn't show up in
>> Oracle or MySQL?
>>=20
>> I'm considering using Lucene in this way but I haven't been able to
>> find any documentation describing this use case. Are there any =
studies
>> of Lucene vs MySQL running for N years comparing the corruptions and
>> recovery times?
>>=20
>> Am I just ignorant and scared of Lucene and too trusting of Oracle =
and MySQL?
>>=20
>> Thanks.
>>=20
>> -guido.
>>=20
>> (BTW, I did find a similar question asked back in 2007 in the =
archives
>> but it doesn't really answer my question)
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20

Kind regards,
Jacob Rhoden

____________________________________
Information Technology Services,
The University of Melbourne

Email: jrhoden@unimelb.edu.au
Phone: +61 3 8344 2884
Mobile: +61 4 1095 7575


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44632-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 20 22:17:30 2010
Return-Path: <java-user-return-44632-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34084 invoked from network); 20 Jan 2010 22:17:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 20 Jan 2010 22:17:30 -0000
Received: (qmail 66105 invoked by uid 500); 20 Jan 2010 22:17:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66026 invoked by uid 500); 20 Jan 2010 22:17:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66016 invoked by uid 99); 20 Jan 2010 22:17:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 22:17:28 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.219.217 as permitted sender)
Received: from [209.85.219.217] (HELO mail-ew0-f217.google.com) (209.85.219.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 20 Jan 2010 22:17:18 +0000
Received: by ewy9 with SMTP id 9so9117806ewy.11
        for <java-user@lucene.apache.org>; Wed, 20 Jan 2010 14:16:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=ccM7CmC39opI6Uv9fexQH4uIV3ih1VVg1/r/lo36ulA=;
        b=a3ZpKlXALnWQGCuwFh25Ly44qd3LZ3ScjYKFOWx6gBVKBs0KCyehng7U4alN/2a7CA
         ULsZ/UlAfGGrvC3j5Tf9/7A8IBqMli2iG6k7y4GhbxRO/MR8+L5KJItZnYKJhHmymQ2D
         wBs2uC6fIQhvT8h+YwNsABBW6NP1UQUf9yGpA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=OU4gCmmbk+2JiK0wM4K6m5p9yTO/jc+NbdQ9z+RyJvR1epU5N4mHuTCYtq9Co03P8t
         EDQ/VXwK8SoaYpY8RTq75rQuMd+M78KDyVqegGtP+v7gQxqNsoCLlsSsFP8r3DtJHUHn
         0BJefriUeIHX0jpOqi/YRJu3v3C27R8KGZraE=
MIME-Version: 1.0
Received: by 10.216.87.83 with SMTP id x61mr255826wee.7.1264025817602; Wed, 20 
	Jan 2010 14:16:57 -0800 (PST)
In-Reply-To: <ba012a2b1001201325i5bbdc638x8ae353f4f70de8fc@mail.gmail.com>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>
	 <4B575C4B.4040800@gmail.com>
	 <ba012a2b1001201325i5bbdc638x8ae353f4f70de8fc@mail.gmail.com>
Date: Wed, 20 Jan 2010 17:16:57 -0500
Message-ID: <359a92831001201416r75a8d9fal8f2970a7ae880934@mail.gmail.com>
Subject: Re: Lucene as a primary datastore
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org, guido@bartolucci.org
Content-Type: multipart/alternative; boundary=0016e6d99a7fd85c6a047d9ff179
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d99a7fd85c6a047d9ff179
Content-Type: text/plain; charset=ISO-8859-1

It depends (tm). From what I've seen on this list, *if* the index
gets corrupted, you'll see some exceptions somewhere. They
may be head-scratchers, but you'll get exceptions.

But when I've seen this kind of thing reported, it's been because
of coding errors. Manually unlocking the IndexWriter and opening
a second one in a second process while the first is still running
comes to mind. In other words, you have to work at it to corrupt
your index.

The Lucene guys understand thoroughly that having an index
just decide to corrupt itself is completely unacceptable, and
take great pains to insure it doesn't happen.

We typically have very infrequent updates (every quarter
or more), and we've never had one just go wonky.

So I wouldn't rebuild my indexes unless
1> the application started going west and you saw exceptions
2> you want to periodically rebuild it to test that you *can*.

Of course having your disk go bad hurts, but frequent
rebuilding isn't going to help with that....

FWIW
Erick@IHopeWereOnTrackNow


On Wed, Jan 20, 2010 at 4:25 PM, Guido Bartolucci <
guido.bartolucci@gmail.com> wrote:

> Thanks for the response. I understand all of what you wrote, but what
> I care about and what I had a little trouble describing exactly in my
> previous question is:
>
> - Are all problems with Lucene obvious (e.g., you get an exception and
> you know your data is now bad) or are there subtle corruptions that
> just happen and because of that it makes sense to constantly rebuild
> the index?
>
> I ask this because if this isn't the case then replication isn't going
> to help, the problems probably get copied over to the other instances
> (unless I'm missing something).
>
> guido.
>
>
> On Wed, Jan 20, 2010 at 11:40 AM, Chris Lu <chris.lu@gmail.com> wrote:
> > I have 3 concerns of making Lucene as a primary database.
> > 1) Lucene is stable when it's stable. But you will have java exceptions.
> > What would you do when FileNotFoundException or "Lucene 2.9.1 'read past
> > EOF' IOException under system load" happens?
> > For me, I don't the data is safe this way. Or, you can understand all
> Lucene
> > APIs and never make any mistakes.
> > Some databases, like some versions of mysql, could corrupt data. No
> better,
> > but it's still more robust.
> > 2) As the name suggests, Lucene index is just an index, like database
> index,
> > it's an auxiliary data structure. It's only fast in one way, but could be
> > slow in other ways.
> > 3) The more robust approach is to pull data out of database, and create a
> > Lucene index. In case something goes wrong, you can always pull data out
> > again and create the index again.
> >
> > --
> > Chris Lu
> > -------------------------
> > Instant Scalable Full-Text Search On Any Database/Application
> > site: http://www.dbsight.net
> > demo: http://search.dbsight.com
> > Lucene Database Search in 3 minutes:
> >
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> > DBSight customer, a shopping comparison site, (anonymous per request) got
> > 2.6 Million Euro funding!
> >
> >
> >
> > Guido Bartolucci wrote:
> >>
> >> I know that the primary use case for Lucene is as an index of data
> >> that can be reconstructed (e.g., from a relational database or from
> >> spidering your corporate intranet).
> >>
> >> But, I'm curious if anyone uses Lucene as their primary datastore for
> >> their gold data. Is it good enough?
> >>
> >> Would anyone consider (or do people already) store data in Lucene
> >> that, if it was lost, would destroy their business? And no, I'm not
> >> suggesting that you don't back up this data, I'm just curious if there
> >> are problems with using Lucene in this way. Are there subtle
> >> corruptions that might show up in Lucene that wouldn't show up in
> >> Oracle or MySQL?
> >>
> >> I'm considering using Lucene in this way but I haven't been able to
> >> find any documentation describing this use case. Are there any studies
> >> of Lucene vs MySQL running for N years comparing the corruptions and
> >> recovery times?
> >>
> >> Am I just ignorant and scared of Lucene and too trusting of Oracle and
> >> MySQL?
> >>
> >> Thanks.
> >>
> >> -guido.
> >>
> >> (BTW, I did find a similar question asked back in 2007 in the archives
> >> but it doesn't really answer my question)
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6d99a7fd85c6a047d9ff179--

From java-user-return-44633-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 04:37:07 2010
Return-Path: <java-user-return-44633-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74160 invoked from network); 21 Jan 2010 04:37:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 04:37:07 -0000
Received: (qmail 2684 invoked by uid 500); 21 Jan 2010 04:37:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2434 invoked by uid 500); 21 Jan 2010 04:37:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2414 invoked by uid 99); 21 Jan 2010 04:37:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 04:37:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jayallenhill@gmail.com designates 209.85.222.198 as permitted sender)
Received: from [209.85.222.198] (HELO mail-pz0-f198.google.com) (209.85.222.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 04:36:52 +0000
Received: by pzk36 with SMTP id 36so4950203pzk.5
        for <multiple recipients>; Wed, 20 Jan 2010 20:36:32 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=eQbrc5epufmzx2sYttRx1FcS6P/EoqhaLkcGwTKhhog=;
        b=NI6bEXuaPrfaHZReVQ3vkFdSk0zuHp4G28E7C3Ni7oU0QH290WRVljqGyKpIuSO9UB
         uliOe6QKeslq5Kuz3giTl7IxHuBAXM3Y9BBMzGTkjMu+Y7+RPEUaqoEaY1tLBDArpw7A
         QcI00tV5So9pKVNAiEPaBXMsJ3aJ9PyaIx5eI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=vhNAON82ojYlxR6xWs775MzXW4MaUjJm7sr8Ee75wr9jwMdOmU/AhmfA49J6jQm5WH
         +Yr99o53EzcirasbaE+wdT4WUkKgRwlgMpOo+kdzIC4XVgaGrZNNDHK1kXaAepP0d8sA
         gtUGjbRSMEbJVpFaCtO9cbs5fLGdQ195Q75to=
MIME-Version: 1.0
Received: by 10.114.44.9 with SMTP id r9mr636222war.179.1264048591918; Wed, 20 
	Jan 2010 20:36:31 -0800 (PST)
Date: Wed, 20 Jan 2010 20:36:31 -0800
Message-ID: <d0e6561a1001202036w6db01c37h9279a64f7e42da88@mail.gmail.com>
Subject: Solr Analysis Webinar Jan 28, 2010
From: Jay Hill <jayallenhill@gmail.com>
To: solr-user@lucene.apache.org, java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00504502e2c04cd753047da53f7f

--00504502e2c04cd753047da53f7f
Content-Type: text/plain; charset=ISO-8859-1

My colleague at Lucid Imagination, Tom Hill, will be presenting a free
webinar focused on analysis in Lucene/Solr. If you're interested, please
sign up and join us.

Here is the official notice:

We'd like to invite you to a free webinar our company is offering next
Thursday, 28 January, at 2PM Eastern/11AM Pacific/1900 GMT

Join Lucid Imagination Senior Staff Engineer Tom Hill for a free, in depth
technical workshop to learn how the Lucene/Solr analyzer can grab and index
text and field data, overcome grammatical and semantic variations, and how a
little careful preparation and tuning lets you unleash the full power of
Lucene/Solr Open Source Search.

    * Introduction to analysis, including tokens, tokenizers and token
filters
    * Tuning tokenization to improve index flexibility and content retrieval
precision
    * Avoid common pitfalls by using special troubleshooting tools and
techniques

Thursday, January 28, 2010
11:00 AM PST / 2:00 PM EST / 1900 GMT
Register here:
http://www.eventsvc.com/lucidimagination/012810?trk=WR-JAN2010-AP

--00504502e2c04cd753047da53f7f--

From java-user-return-44634-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 05:24:06 2010
Return-Path: <java-user-return-44634-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84269 invoked from network); 21 Jan 2010 05:24:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 05:24:06 -0000
Received: (qmail 34141 invoked by uid 500); 21 Jan 2010 05:24:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33988 invoked by uid 500); 21 Jan 2010 05:24:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33978 invoked by uid 99); 21 Jan 2010 05:24:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 05:24:03 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.61] (HELO web50307.mail.re2.yahoo.com) (206.190.38.61)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 21 Jan 2010 05:23:52 +0000
Received: (qmail 66758 invoked by uid 60001); 21 Jan 2010 05:23:30 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264051410; bh=fCKA/BWVg1Vr+c4e5ahM/D634OEsP8dBKcBWOaA1kYM=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=LI2/VVIeXhNPjE+9Q6qBXUO8Z/lZwhbH97EZ/GA1hsUehzXfnlXgUnT8sSqGRWSsP0Uq2AGBjx6zV1TpkamH8FK9iqStEOZ+q8fcLMJnuLIujxrD6sZDgNXMHeOVIo+loZwpLRsPkCrLnOzRkDChND71mp3EVjuMfKuKTweinak=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=osgQWtqFp8gBM+IIG9D1ofuaayrQ2buW7wyui+B9tRgIWBpFEHvIBnHYRwy6SCQMST8z6gmxPOl2m2nT0p7S8qk8fTQE+4CuXQjvNBc/4ctoYE9b1S3OnV7RNTMaIviY56kZf/saspkhoVBB1ov1pyEMG2XLGpHnrl4o+qEpl/0=;
Message-ID: <707868.65774.qm@web50307.mail.re2.yahoo.com>
X-YMail-OSG: j9SYZwIVM1mB8jyp2BhCvdTnzbsBNuIIbwnoRotiIiW_BB_v2Fr3HYWU0Af9h9K.vA_m9CreX.F3SENWwaPe6nrrRm5FsxNu8LofNUAXsnpp05PXinsCjXkT884RUWMhtPWrKWW8hPvFERbGIC.93Tn49c2IgUZ5tEKExvKPpE7g.SFX9512HjtktIrJg9rOcCQ4OlX0gjuKjH0tawLNb3C2FcEIw2._rJE7sgGtB2I8ZIdUAazUjYoJU6zKizrQOTYGtTSZ2kOFJU2KFHW_p6rHpdY0KGqwvb57iDSbskNh84mEPFjCwCy7WYr07roD8yYCBQlUqk3rSXUeQAfEOmtKc.yvJXFQCFJJg5FtipJYAOsVyI3f9HBmdlPcWFA6P0LXf8Larp3cdv8nQqFiGw101_oXKlERpGdYr0RoqN0EigmhvVRBW6E2yVLp_NuZwLCSK79vVBuUEF6B.wNGakj98sgBcZcmAH6jfkL0k4_joKRUb3alxS7mUk6zgS8Mmg5mqJNnKQ20jFx3ewiq
Received: from [74.73.1.126] by web50307.mail.re2.yahoo.com via HTTP; Wed, 20 Jan 2010 21:23:30 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>  <4B575C4B.4040800@gmail.com> <ba012a2b1001201325i5bbdc638x8ae353f4f70de8fc@mail.gmail.com>
Date: Wed, 20 Jan 2010 21:23:30 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Lucene as a primary datastore
To: java-user@lucene.apache.org, guido@bartolucci.org
In-Reply-To: <ba012a2b1001201325i5bbdc638x8ae353f4f70de8fc@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Guido,

No, you should absolutely not need to constantly rebuild the index.  If you find you have to do that, you'll know you are doing something wrong.

Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Guido Bartolucci <guido.bartolucci@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Wed, January 20, 2010 4:25:09 PM
> Subject: Re: Lucene as a primary datastore
> 
> Thanks for the response. I understand all of what you wrote, but what
> I care about and what I had a little trouble describing exactly in my
> previous question is:
> 
> - Are all problems with Lucene obvious (e.g., you get an exception and
> you know your data is now bad) or are there subtle corruptions that
> just happen and because of that it makes sense to constantly rebuild
> the index?
> 
> I ask this because if this isn't the case then replication isn't going
> to help, the problems probably get copied over to the other instances
> (unless I'm missing something).
> 
> guido.
> 
> 
> On Wed, Jan 20, 2010 at 11:40 AM, Chris Lu wrote:
> > I have 3 concerns of making Lucene as a primary database.
> > 1) Lucene is stable when it's stable. But you will have java exceptions.
> > What would you do when FileNotFoundException or "Lucene 2.9.1 'read past
> > EOF' IOException under system load" happens?
> > For me, I don't the data is safe this way. Or, you can understand all Lucene
> > APIs and never make any mistakes.
> > Some databases, like some versions of mysql, could corrupt data. No better,
> > but it's still more robust.
> > 2) As the name suggests, Lucene index is just an index, like database index,
> > it's an auxiliary data structure. It's only fast in one way, but could be
> > slow in other ways.
> > 3) The more robust approach is to pull data out of database, and create a
> > Lucene index. In case something goes wrong, you can always pull data out
> > again and create the index again.
> >
> > --
> > Chris Lu
> > -------------------------
> > Instant Scalable Full-Text Search On Any Database/Application
> > site: http://www.dbsight.net
> > demo: http://search.dbsight.com
> > Lucene Database Search in 3 minutes:
> > 
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> > DBSight customer, a shopping comparison site, (anonymous per request) got
> > 2.6 Million Euro funding!
> >
> >
> >
> > Guido Bartolucci wrote:
> >>
> >> I know that the primary use case for Lucene is as an index of data
> >> that can be reconstructed (e.g., from a relational database or from
> >> spidering your corporate intranet).
> >>
> >> But, I'm curious if anyone uses Lucene as their primary datastore for
> >> their gold data. Is it good enough?
> >>
> >> Would anyone consider (or do people already) store data in Lucene
> >> that, if it was lost, would destroy their business? And no, I'm not
> >> suggesting that you don't back up this data, I'm just curious if there
> >> are problems with using Lucene in this way. Are there subtle
> >> corruptions that might show up in Lucene that wouldn't show up in
> >> Oracle or MySQL?
> >>
> >> I'm considering using Lucene in this way but I haven't been able to
> >> find any documentation describing this use case. Are there any studies
> >> of Lucene vs MySQL running for N years comparing the corruptions and
> >> recovery times?
> >>
> >> Am I just ignorant and scared of Lucene and too trusting of Oracle and
> >> MySQL?
> >>
> >> Thanks.
> >>
> >> -guido.
> >>
> >> (BTW, I did find a similar question asked back in 2007 in the archives
> >> but it doesn't really answer my question)
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44635-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 05:25:44 2010
Return-Path: <java-user-return-44635-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85045 invoked from network); 21 Jan 2010 05:25:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 05:25:44 -0000
Received: (qmail 36249 invoked by uid 500); 21 Jan 2010 05:25:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36091 invoked by uid 500); 21 Jan 2010 05:25:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36081 invoked by uid 99); 21 Jan 2010 05:25:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 05:25:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.59] (HELO web50305.mail.re2.yahoo.com) (206.190.38.59)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 21 Jan 2010 05:25:32 +0000
Received: (qmail 4268 invoked by uid 60001); 21 Jan 2010 05:25:11 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264051511; bh=KXDdy+MQC1yxd8ysy7KT2++CPhi49XfUOhJe0oLB2wk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=NxMUijo1g30fS8tOnYIa8ut27VHZWRDd0JNXQBK+vGI1X1B2yj6eTMgJj4T3IZXdOruHGOuhFF8kb+2CVa7koS0/le5v5SoHViFeSzpZbfhsisZECycPAu5l1frLSqzXmmCokTWPX5voHVE1B8CG4KClOwpIUqrxwPepzTKgD6A=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=zD83KkQjCw098CXjgjR2+bNWVpZrW7/yWm6EXXHBYERkJn+ZKg8PFvWT3JaXHm+rs7NNP4OPuyaXdMls08Ri0wBfOhCcAfPtZmIYnLGI+SfkoOjx5HRnXhx79K8dGosl0P1GtViBMQCVBBjI0WFZ2in3Kz5jZWb8ras31yKEB6c=;
Message-ID: <309589.3762.qm@web50305.mail.re2.yahoo.com>
X-YMail-OSG: 8YGLuzMVM1moiEY4a1z48FEAIwiRKeZnxuIuzcUyA5sF_sSsyTRjq8QpaU6NmY4bhmT3IRJU2t96Fhc0TphUj4_cv9Cbg2sZHm_DGn0dqw92fnjsGkmlC1n5PBI238Tms7yC9JRAVDwfrjTUFRfxXyXYAv83URC0qG3Hw6r14GdBc13ySJ_7x1ESkwoA56Wo0ef.9sGYukDa5F0PpPMJt0.tzAlTgs2Id3HZcWWilLr6D_HKOwpMabzvXi1uMEiVKLCOcVMTpwewnpcdTL5q6g306qBCTwP5y02EJ.yp.JJpsdjZC9tlaTSpkdBjvMvPKjQCVab1rCa.vG2f2WrlaO1.4l1Hl9W0y839NeOeJoCTNjlOsXi.Foe8x6iH_HLKCatPXyZ_dsOMWHpw0F._9TG2
Received: from [74.73.1.126] by web50305.mail.re2.yahoo.com via HTTP; Wed, 20 Jan 2010 21:25:11 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <4B574562.80308@fastmail.fm>
Date: Wed, 20 Jan 2010 21:25:11 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Can you boost multiple terms using brackets ?
To: java-user@lucene.apache.org, paul_t100@fastmail.fm
In-Reply-To: <4B574562.80308@fastmail.fm>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Yes, I believe it is the same.  I bet the Explain explanation would help confirm this.

Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: Paul Taylor <paul_t100@fastmail.fm>
> To: java-user@lucene.apache.org
> Sent: Wed, January 20, 2010 1:03:14 PM
> Subject: Can you boost multiple terms using brackets ?
> 
> 
> Hi
> 
> is
> 
> title:(return panther)^3 alias:(return panther)
> 
> 
> the same as
> 
> title:return^3 title:panther^3 alias:(return panther)
> 
> 
> thanks Paul
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44636-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 10:06:59 2010
Return-Path: <java-user-return-44636-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87214 invoked from network); 21 Jan 2010 10:06:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 10:06:59 -0000
Received: (qmail 88650 invoked by uid 500); 21 Jan 2010 10:06:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88576 invoked by uid 500); 21 Jan 2010 10:06:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88566 invoked by uid 99); 21 Jan 2010 10:06:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 10:06:57 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.26 as permitted sender)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 10:06:46 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id E713ECDA24;
	Thu, 21 Jan 2010 05:06:25 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Thu, 21 Jan 2010 05:06:25 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:cc:subject:references:in-reply-to:content-type:content-transfer-encoding; s=smtpout; bh=a+EHmIpBi54mqnHe5Izv0MHsU+c=; b=ZaWYKgySRHOXyIIq71V/r4IZdLqwJqANJYTg5Lyas0FPvfrQMj6FVPWz4hLlQJZPXeLCwHeZntafj2WBeLDqWIDZmtcdbNX2iSqb8Gsb4X6vCuFpqh1pDaknJU3hvifXV6V0sBxcK0oXymSsgpI7Ijl0p5ocfjS1EDbfUUXwuLs=
X-Sasl-enc: f0UTj04GwF0eu6SeMtSwx6P1vfGgL6BkI5px0cnrt8an 1264068385
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 4032B4B8D27;
	Thu, 21 Jan 2010 05:06:25 -0500 (EST)
Message-ID: <4B582720.7060509@fastmail.fm>
Date: Thu, 21 Jan 2010 10:06:24 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
CC: java-user@lucene.apache.org
Subject: Re: Can you boost multiple terms using brackets ?
References: <4B574562.80308@fastmail.fm> <309589.3762.qm@web50305.mail.re2.yahoo.com>
In-Reply-To: <309589.3762.qm@web50305.mail.re2.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Otis Gospodnetic wrote:
> Yes, I believe it is the same.  I bet the Explain explanation would help confirm this.
>
> Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>
>   
Yes, I did try is with Luke a little after posting and it is the same

thanks Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44637-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 11:03:22 2010
Return-Path: <java-user-return-44637-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13297 invoked from network); 21 Jan 2010 11:03:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 11:03:22 -0000
Received: (qmail 64697 invoked by uid 500); 21 Jan 2010 11:03:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64633 invoked by uid 500); 21 Jan 2010 11:03:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64623 invoked by uid 99); 21 Jan 2010 11:03:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 11:03:20 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thienthanhomenh@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 11:03:12 +0000
Received: by qw-out-2122.google.com with SMTP id 3so1269377qwe.53
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 03:02:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:from:date:message-id
         :subject:to:content-type;
        bh=6ToTWO/nYqLBdH5aOLok/dp5evoEbE2DvWD7G7zT9Ug=;
        b=PkN34UpGpepFFqrn9cszkfh8Ej3f/TvEVcVHjU0SCyU3BIEuytlGsTN+PtDM4ZM6a8
         FuauuvIDsNoKM9BqCIdApX5bf2AC7duockeTV2wlKjqBaN8bFP0bfDYiAJSjdWYx21mg
         SX6eQfv/PUbrDFRdrlQuB5u5CKI3PfXs5hMK0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        b=EJEbpErMTGMmxacalaH+9W60dUr0VnMs9CdXItuqwq+jxZ3pSNPnKnAusgaIdWAJ5C
         Dbb3wffCcagd2iFQDs6N5lZQt5LmIuYWBux5BDIUElOTZ/MWZQTpVRI6NFOM9oRr4ZrP
         7Kzfa3v9oElz3eYS1aLIjX8CD8EwW9o3V+bEg=
MIME-Version: 1.0
Received: by 10.224.39.70 with SMTP id f6mr838007qae.341.1264071771084; Thu, 
	21 Jan 2010 03:02:51 -0800 (PST)
From: Phan The Dai <thienthanhomenh@gmail.com>
Date: Thu, 21 Jan 2010 20:02:31 +0900
Message-ID: <3b23ce091001210302n61faa189o5347926a3a41328e@mail.gmail.com>
Subject: A interesting question (search by number of terms)
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00c09f9e09f2e2da6b047daaa449
X-Virus-Checked: Checked by ClamAV on apache.org

--00c09f9e09f2e2da6b047daaa449
Content-Type: text/plain; charset=ISO-8859-1

Hi everyone, I need you support with this question:
Assuming that I have some terms, such as: ("A", "B", "C", "D", "E")
How to search documents that contain a number of terms in that list
but do not care what terms are.
For example, any documents that include any 3 terms in the above list are
matched.

Please show me a query in Lucene or a solution.

Thank you much for soon answer, I need it as soon as possible.

Regards.

--00c09f9e09f2e2da6b047daaa449--

From java-user-return-44638-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 12:21:28 2010
Return-Path: <java-user-return-44638-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31044 invoked from network); 21 Jan 2010 12:21:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 12:21:28 -0000
Received: (qmail 89988 invoked by uid 500); 21 Jan 2010 12:21:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89933 invoked by uid 500); 21 Jan 2010 12:21:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89922 invoked by uid 99); 21 Jan 2010 12:21:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 12:21:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of benhei@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 12:21:17 +0000
Received: by fxm2 with SMTP id 2so4038077fxm.5
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 04:20:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=P8+yYWEvNxHTRsbaGLs3Jz38tjSC2yM63jEsOHULul0=;
        b=LJlt+98Wk5wowZoCWY2Swy0SW4ozzbUtPMXKNRgagWegVWb0yQY97SnxiFL/VWS7i+
         wzehZVH6jbhfXDEbgC+ogsuCsylw2y19SHMm3xL5WktWtmTErxH+thPf1if/pi9OnYxS
         Z3jGR6qhz4XiQvkFYfnlaCxf7Ds6TUonUqO4g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=a/MNi0rP9nCF5Hf23UFn+ZTDc0ga3c0hrDWhsUI8AWA/DRJbhIyhtSeMo6sZQdBJyb
         zgkjcA4gRZ7Un5+YygAYUHAnyvTkNGn/z9iKc+0lzsV2cYflhCT7pzzv10Ah6a6QSg/A
         OnSlCGedRm7WZeZ3CSJePh2CouRRDbWCF45fc=
MIME-Version: 1.0
Received: by 10.223.29.193 with SMTP id r1mr1403743fac.29.1264076457098; Thu, 
	21 Jan 2010 04:20:57 -0800 (PST)
In-Reply-To: <3b23ce091001210302n61faa189o5347926a3a41328e@mail.gmail.com>
References: <3b23ce091001210302n61faa189o5347926a3a41328e@mail.gmail.com>
Date: Thu, 21 Jan 2010 13:20:57 +0100
Message-ID: <94095f521001210420r7d484dc8tc2313caebbca18a7@mail.gmail.com>
Subject: Re: A interesting question (search by number of terms)
From: Benjamin Heilbrunn <benhei@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Try BooleanQuery.setMinimumNumberShouldMatch

2010/1/21 Phan The Dai <thienthanhomenh@gmail.com>:
> Hi everyone, I need you support with this question:
> Assuming that I have some terms, such as: ("A", "B", "C", "D", "E")
> How to search documents that contain a number of terms in that list
> but do not care what terms are.
> For example, any documents that include any 3 terms in the above list are
> matched.
>
> Please show me a query in Lucene or a solution.
>
> Thank you much for soon answer, I need it as soon as possible.
>
> Regards.
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44639-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 12:47:17 2010
Return-Path: <java-user-return-44639-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43700 invoked from network); 21 Jan 2010 12:47:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 12:47:17 -0000
Received: (qmail 24953 invoked by uid 500); 21 Jan 2010 12:47:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24878 invoked by uid 500); 21 Jan 2010 12:47:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24868 invoked by uid 99); 21 Jan 2010 12:47:14 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 12:47:14 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of thienthanhomenh@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 12:47:08 +0000
Received: by qw-out-2122.google.com with SMTP id 3so1284530qwe.53
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 04:46:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=vUUtYFIbDRNcp99W+Z/9/ruL4Iq3c04XYuYubG9+K7Q=;
        b=go2MKh5B35iACgakA8wp4O2eS+j0Kbcw+ZwFfDkfDHe0rSDBbQ517T2cvNNHqj8eNu
         Urf9gcyazVLxBDJ/bdVGg4/ktMhZHRz06kQZsDxAr6raDRciA+xUpN+09mER90CyxP9R
         QqenlBWNV3Osm1beYjdhsQG3V/Ack45g+a4jw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=rvmSKBi5lQx3jwfm5Y3eHCP1A7sD+x+s6+MWW12KRDpqALpqXMACQFuWDrc++j7Vr4
         MHaE0rjutUMjuyOTulIi8hpgOmRH8KvdcTsmjPjQk/iZrSMibXqUi+Z536XGqK66u2KA
         qcU/f9EcoiRDS9yoWnwpITFSB/132AJNIx+lU=
MIME-Version: 1.0
Received: by 10.224.117.82 with SMTP id p18mr909659qaq.266.1264078007114; Thu, 
	21 Jan 2010 04:46:47 -0800 (PST)
In-Reply-To: <94095f521001210420r7d484dc8tc2313caebbca18a7@mail.gmail.com>
References: <3b23ce091001210302n61faa189o5347926a3a41328e@mail.gmail.com> 
	<94095f521001210420r7d484dc8tc2313caebbca18a7@mail.gmail.com>
From: Phan The Dai <thienthanhomenh@gmail.com>
Date: Thu, 21 Jan 2010 21:46:27 +0900
Message-ID: <3b23ce091001210446o477ab1e5pb75691722d566af7@mail.gmail.com>
Subject: Re: A interesting question (search by number of terms)
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000feaedf043951f1b047dac187a

--000feaedf043951f1b047dac187a
Content-Type: text/plain; charset=ISO-8859-1

Oh, it is nice.
Thank you much!

On Thu, Jan 21, 2010 at 9:20 PM, Benjamin Heilbrunn <benhei@gmail.com>wrote:

> Try BooleanQuery.setMinimumNumberShouldMatch
>
> 2010/1/21 Phan The Dai <thienthanhomenh@gmail.com>:
> > Hi everyone, I need you support with this question:
> > Assuming that I have some terms, such as: ("A", "B", "C", "D", "E")
> > How to search documents that contain a number of terms in that list
> > but do not care what terms are.
> > For example, any documents that include any 3 terms in the above list are
> > matched.
> >
> > Please show me a query in Lucene or a solution.
> >
> > Thank you much for soon answer, I need it as soon as possible.
> >
> > Regards.
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--000feaedf043951f1b047dac187a--

From java-user-return-44640-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 14:16:24 2010
Return-Path: <java-user-return-44640-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84409 invoked from network); 21 Jan 2010 14:16:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 14:16:23 -0000
Received: (qmail 33861 invoked by uid 500); 21 Jan 2010 14:16:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33763 invoked by uid 500); 21 Jan 2010 14:16:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33744 invoked by uid 99); 21 Jan 2010 14:16:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 14:16:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mailer.thomas@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 14:16:11 +0000
Received: by bwz22 with SMTP id 22so2326bwz.5
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 06:15:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type
         :content-transfer-encoding;
        bh=9XWiU7D10m/0m6wN8qu3lF7mGYlMarx/UUfshm7WTjk=;
        b=dzTw6dD8Shh+FExPdd9SWN+OtutDlnOomlTk6hXNoZJBdNBc34odwTrEoQQzae78gh
         iurc99zCYwYqRLsNQMLgrYtfyMQADU7Hl/qA8e0lV1XUeR4hOar3X1DfWLyo2V9lhtBh
         rRvubhYjLDq6guefKsYColzL5YH4TDHIJpa8g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type:content-transfer-encoding;
        b=k53DaDxKkOp+qPeNlyofflAg2aJnD45QeliygbZJSCr+uhK2/Lsf+jB4DBCnTvmo/o
         qZE6WOQWary+xblCDq2FG3EmrWL/eBDZJQKAMepfAMCnBu9SlBAvqA3rqOhpb3PJxlqA
         Xbv6ZKC1hUYjLPKWP8QSZl0AugZhHQRbLnTJ0=
Received: by 10.204.49.88 with SMTP id u24mr774101bkf.174.1264083351386;
        Thu, 21 Jan 2010 06:15:51 -0800 (PST)
Received: from ?192.168.24.149? (funny.informatik.hu-berlin.de [141.20.24.156])
        by mx.google.com with ESMTPS id 13sm483708bwz.2.2010.01.21.06.15.50
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 21 Jan 2010 06:15:50 -0800 (PST)
Message-ID: <4B586195.5030006@gmail.com>
Date: Thu, 21 Jan 2010 15:15:49 +0100
From: Philippe <mailer.thomas@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Sort by the number of matching fields
Content-Type: text/plain; charset=ISO-8859-15; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi everyone,

I want to sort my results independent from my query string. Matching 
"documents" should be ordered by the number of fields containing a 
specific String.

Let's assume my query returns 2 Documents:

Doc1 contains 5 "ID"-fields (1,2,3,4,5)
Doc2 contains 3 "ID"-fields (5,6,7)

I'm more interested in documents containing the ids (5,6) so Document2 
should be ranked higher than Document1.

What would be the best way to perform this?

Regards,
    Philippe

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44641-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 14:20:00 2010
Return-Path: <java-user-return-44641-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86240 invoked from network); 21 Jan 2010 14:20:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 14:20:00 -0000
Received: (qmail 41324 invoked by uid 500); 21 Jan 2010 14:19:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41256 invoked by uid 500); 21 Jan 2010 14:19:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41245 invoked by uid 99); 21 Jan 2010 14:19:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 14:19:58 +0000
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=HTML_MESSAGE,MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [195.69.93.129] (HELO raq1.das.uk.net) (195.69.93.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 14:19:47 +0000
Received: from eldiablo (cpc1-midd4-0-0-cust927.midd.cable.ntl.com [82.5.183.160])
	by raq1.das.uk.net (8.10.2/8.10.2) with ESMTP id o0LE1T304425
	for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 14:01:29 GMT
From: "Bryan Lewis [DAS]" <bryan.lewis@dasmail.co.uk>
To: <java-user@lucene.apache.org>
Subject: No Matching constructor
Date: Thu, 21 Jan 2010 14:19:16 -0000
Message-ID: <008901ca9aa4$ba396c80$2eac4580$@lewis@dasmail.co.uk>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_008A_01CA9AA4.BA396C80"
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqapLbHoSnKoEqiQsuBAcjK+cQnwA==
Content-Language: en-gb
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_008A_01CA9AA4.BA396C80
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Hi,

 

I'm trying to create a Lucene index via Railo and am getting the above
error.

 

My code is as follows (and was working fine in a JSP page but doesn't seem
to want to play under Railo, using same version of Lucene 2.3.2 ):

 

<code above this to query database into qData,  create StandardAnalyzer,
IndexWriter  - all working fine>

.

.

.

<cfset vField=CreateObject("java","org.apache.lucene.document.Field")>

 

<cfloop query="qData">

                <!--- create the document   [works OK] --- >

                <cfset
vDoc=CreateObject("java","org.apache.lucene.document.Document")>

 

                <!--- add fields to document [fails with 'No matching
constructor' no matter what I use] --- >

                <cfset vDoc.add(vField.Text("id", qData.id)>

 

.

.

.

 

Where qData is a database query returning the id column from a database
table (it is returning other columns too but as it won't even insert one
field I haven't shown the others in the code above).

 

I have also tried 

<cfset vDoc.add(vField.Text("id", "test">

<cfset vDoc.add(vField.Text("id", qData.id, vField.Store.YES,
vField.Index.NO)>  [this is the one that works in my JSP but it doesn't work
here...]

 

 

 

Has anyone else come across this problem?

 

Any ideas?

 

Cheers

Bryan.

 

 

 


------=_NextPart_000_008A_01CA9AA4.BA396C80--


From java-user-return-44642-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 14:29:11 2010
Return-Path: <java-user-return-44642-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93873 invoked from network); 21 Jan 2010 14:29:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 14:29:11 -0000
Received: (qmail 58297 invoked by uid 500); 21 Jan 2010 14:29:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58198 invoked by uid 500); 21 Jan 2010 14:29:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58188 invoked by uid 99); 21 Jan 2010 14:29:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 14:29:08 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [195.69.93.129] (HELO raq1.das.uk.net) (195.69.93.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 14:29:00 +0000
Received: from eldiablo (cpc1-midd4-0-0-cust927.midd.cable.ntl.com [82.5.183.160])
	by raq1.das.uk.net (8.10.2/8.10.2) with ESMTP id o0LEAe304958
	for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 14:10:40 GMT
From: "Bryan Lewis [DAS]" <bryan.lewis@dasmail.co.uk>
To: <java-user@lucene.apache.org>
References: <008901ca9aa4$ba396c80$2eac4580$@lewis@dasmail.co.uk>
In-Reply-To: <008901ca9aa4$ba396c80$2eac4580$@lewis@dasmail.co.uk>
Subject: RE: No Matching constructor
Date: Thu, 21 Jan 2010 14:28:28 -0000
Message-ID: <00a701ca9aa6$031a3be0$094eb3a0$@lewis@dasmail.co.uk>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqapLbHoSnKoEqiQsuBAcjK+cQnwAAARaIg
Content-Language: en-gb

The typos (missing ')' at the end of some statements are not in the original
code).


-----Original Message-----
From: Bryan Lewis [DAS] [mailto:bryan.lewis@dasmail.co.uk] 
Sent: 21 January 2010 14:19
To: java-user@lucene.apache.org
Subject: No Matching constructor

Hi,

 

I'm trying to create a Lucene index via Railo and am getting the above
error.

 

My code is as follows (and was working fine in a JSP page but doesn't seem
to want to play under Railo, using same version of Lucene 2.3.2 ):

 

<code above this to query database into qData,  create StandardAnalyzer,
IndexWriter  - all working fine>

.

.

.

<cfset vField=CreateObject("java","org.apache.lucene.document.Field")>

 

<cfloop query="qData">

                <!--- create the document   [works OK] --- >

                <cfset
vDoc=CreateObject("java","org.apache.lucene.document.Document")>

 

                <!--- add fields to document [fails with 'No matching
constructor' no matter what I use] --- >

                <cfset vDoc.add(vField.Text("id", qData.id)>

 

.

.

.

 

Where qData is a database query returning the id column from a database
table (it is returning other columns too but as it won't even insert one
field I haven't shown the others in the code above).

 

I have also tried 

<cfset vDoc.add(vField.Text("id", "test">

<cfset vDoc.add(vField.Text("id", qData.id, vField.Store.YES,
vField.Index.NO)>  [this is the one that works in my JSP but it doesn't work
here...]

 

 

 

Has anyone else come across this problem?

 

Any ideas?

 

Cheers

Bryan.

 

 

 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44643-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 17:20:55 2010
Return-Path: <java-user-return-44643-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52442 invoked from network); 21 Jan 2010 17:20:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 17:20:55 -0000
Received: (qmail 10630 invoked by uid 500); 21 Jan 2010 17:20:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10573 invoked by uid 500); 21 Jan 2010 17:20:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10563 invoked by uid 99); 21 Jan 2010 17:20:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 17:20:52 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=MSGID_MULTIPLE_AT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [195.69.93.129] (HELO raq1.das.uk.net) (195.69.93.129)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 17:20:43 +0000
Received: from eldiablo (cpc1-midd4-0-0-cust927.midd.cable.ntl.com [82.5.183.160])
	by raq1.das.uk.net (8.10.2/8.10.2) with ESMTP id o0LH2N315016
	for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 17:02:23 GMT
From: "Bryan Lewis [DAS]" <bryan.lewis@dasmail.co.uk>
To: <java-user@lucene.apache.org>
References: <008901ca9aa4$ba396c80$2eac4580$@lewis@dasmail.co.uk> <00a701ca9aa6$031a3be0$094eb3a0$@lewis@dasmail.co.uk>
In-Reply-To: <00a701ca9aa6$031a3be0$094eb3a0$@lewis@dasmail.co.uk>
Subject: RE: No Matching constructor
Date: Thu, 21 Jan 2010 17:20:11 -0000
Message-ID: <011f01ca9abe$0091cf60$01b56e20$@lewis@dasmail.co.uk>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqapLbHoSnKoEqiQsuBAcjK+cQnwAAARaIgAAX/EuA=
Content-Language: en-gb

Seems that CFML handles things a bit differently...

See this thread for a solution taht worked for me:
http://groups.google.com/group/railo/browse_thread/thread/b52954bfe2aa85ea#


Case closed :0)

Bryan.



-----Original Message-----
From: Bryan Lewis [DAS] [mailto:bryan.lewis@dasmail.co.uk] 
Sent: 21 January 2010 14:28
To: java-user@lucene.apache.org
Subject: RE: No Matching constructor

The typos (missing ')' at the end of some statements are not in the original
code).


-----Original Message-----
From: Bryan Lewis [DAS] [mailto:bryan.lewis@dasmail.co.uk] 
Sent: 21 January 2010 14:19
To: java-user@lucene.apache.org
Subject: No Matching constructor

Hi,

 

I'm trying to create a Lucene index via Railo and am getting the above
error.

 

My code is as follows (and was working fine in a JSP page but doesn't seem
to want to play under Railo, using same version of Lucene 2.3.2 ):

 

<code above this to query database into qData,  create StandardAnalyzer,
IndexWriter  - all working fine>

.

.

.

<cfset vField=CreateObject("java","org.apache.lucene.document.Field")>

 

<cfloop query="qData">

                <!--- create the document   [works OK] --- >

                <cfset
vDoc=CreateObject("java","org.apache.lucene.document.Document")>

 

                <!--- add fields to document [fails with 'No matching
constructor' no matter what I use] --- >

                <cfset vDoc.add(vField.Text("id", qData.id)>

 

.

.

.

 

Where qData is a database query returning the id column from a database
table (it is returning other columns too but as it won't even insert one
field I haven't shown the others in the code above).

 

I have also tried 

<cfset vDoc.add(vField.Text("id", "test">

<cfset vDoc.add(vField.Text("id", qData.id, vField.Store.YES,
vField.Index.NO)>  [this is the one that works in my JSP but it doesn't work
here...]

 

 

 

Has anyone else come across this problem?

 

Any ideas?

 

Cheers

Bryan.

 

 

 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44644-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 17:32:10 2010
Return-Path: <java-user-return-44644-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63265 invoked from network); 21 Jan 2010 17:32:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 17:32:10 -0000
Received: (qmail 44623 invoked by uid 500); 21 Jan 2010 17:32:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44578 invoked by uid 500); 21 Jan 2010 17:32:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44568 invoked by uid 99); 21 Jan 2010 17:32:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 17:32:07 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 17:31:59 +0000
Received: by bwz22 with SMTP id 22so285091bwz.5
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 09:31:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=fz5ruNtZITQMIx4KMEb1HjLqNAeU77zbHEgoDJlKEZM=;
        b=ZDOk6aXJSnY2pVFFQmVQHS0rTeXi0K/F+22nZ6tOeWkiq809OToAicUT9fA2mwvdzL
         IuZtdneZjMuUjB7QUu69LIC3NxNDYVaZGUjq59o1dwi8SKjUKXg988oUxhe423vjiV7B
         xLQtxbw3MNTfE7Vu2zbB1sJFOuuxjcw8C3YNo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=u5IGyBQBSdeI/o8WMZ8eZ3KKt45nKXua/Tlg+AIVYVc17Tm4c+p6RYFFGwkIx4BPYW
         oljBd01LNRKYKoTDz6/3dveBCGNmauhIIUIECHUDTLZmWVZ6R4p72DW8gBI+mxrHgt+R
         nL8x+xNhpd9sNYQWmHOn6K/fAJDgbdG8F1uCQ=
MIME-Version: 1.0
Received: by 10.204.138.143 with SMTP id a15mr911558bku.153.1264095099186; 
	Thu, 21 Jan 2010 09:31:39 -0800 (PST)
In-Reply-To: <4B586195.5030006@gmail.com>
References: <4B586195.5030006@gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Thu, 21 Jan 2010 17:31:19 +0000
Message-ID: <8c4e68611001210931s74f2e2eaj2c75d2ee48f408a1@mail.gmail.com>
Subject: Re: Sort by the number of matching fields
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I'm not sure I understand what you are asking, but if you search for
id:5 id:6 then I think doc2 will be ranked higher, because it contains
both fields.

Or are you saying you want to rank based on the number of id fields in
the document i.e. doc2 better than doc1 because 3 better than 5?  If
that is the case you could add a new field to each document holding
the number of id fields in that document and sort on that.

Or maybe you just need to boost searches for preferred id values.
id:5^4 or Query.setBoost().



--
Ian.

On Thu, Jan 21, 2010 at 2:15 PM, Philippe <mailer.thomas@gmail.com> wrote:
> Hi everyone,
>
> I want to sort my results independent from my query string. Matching
> "documents" should be ordered by the number of fields containing a specif=
ic
> String.
>
> Let's assume my query returns 2 Documents:
>
> Doc1 contains 5 "ID"-fields (1,2,3,4,5)
> Doc2 contains 3 "ID"-fields (5,6,7)
>
> I'm more interested in documents containing the ids (5,6) so Document2
> should be ranked higher than Document1.
>
> What would be the best way to perform this?
>
> Regards,
> =A0 Philippe
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44645-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 20:16:35 2010
Return-Path: <java-user-return-44645-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45143 invoked from network); 21 Jan 2010 20:16:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 20:16:34 -0000
Received: (qmail 32509 invoked by uid 500); 21 Jan 2010 20:16:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32438 invoked by uid 500); 21 Jan 2010 20:16:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32428 invoked by uid 99); 21 Jan 2010 20:16:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 20:16:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of mailer.thomas@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 20:16:22 +0000
Received: by fxm2 with SMTP id 2so429071fxm.5
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 12:16:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=zifs5Th/Nz3grc8kBLJXH04hj1kP1MhWllcip//V3Y4=;
        b=mHo6CNkY04YCKv2DfsAJYW/NfaZNDMhp8DVM59BtVBV6ngstfnqYtnbKn2ABPFEoye
         5PsWaf0yA+NwtJ0WmArHcoA0yQBdp7oTtbgRK+VMXDfElxx8fcOMMao417qcpujR3Iur
         iI/L+cu7xUqzj52IyObp1f46ZFC08sscSr7D8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=Kofec+C815jcFwQnRIWlEsFlUz0Z58h5ci8rVP8fRWiynPjkAW2GyLRvz4uOQfDxWc
         YAw31ESTQrlMhBx78uosbD6FRQAmDUvvlNIgb/vu5BgZb+LVH0gmIh7yif956PaWRfXa
         /PUUj2AlcwfpGQ9vkmqt5qHZSQo5/Rytj9UJE=
Received: by 10.223.76.141 with SMTP id c13mr1952572fak.31.1264104962678;
        Thu, 21 Jan 2010 12:16:02 -0800 (PST)
Received: from ?192.168.2.102? (dslb-188-102-023-156.pools.arcor-ip.net [188.102.23.156])
        by mx.google.com with ESMTPS id 15sm856924fxm.10.2010.01.21.12.16.00
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 21 Jan 2010 12:16:01 -0800 (PST)
Message-ID: <4B58B600.2090303@gmail.com>
Date: Thu, 21 Jan 2010 21:16:00 +0100
From: Philippe <mailer.thomas@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Sort by the number of matching fields
References: <4B586195.5030006@gmail.com> <8c4e68611001210931s74f2e2eaj2c75d2ee48f408a1@mail.gmail.com>
In-Reply-To: <8c4e68611001210931s74f2e2eaj2c75d2ee48f408a1@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ian,

you are probably right that doc2 will be ranked higher as it contains 
both id-fields. However, I am sure that this is not always the case in 
the default TF/IDF-ranking scheme.

As you mentioned in the second part, I could add a new field holding the 
number of matching fields. The Problem is that the list  of relevant ids 
is often changing...

Regards,
    Philippe

Ian Lea schrieb:
> I'm not sure I understand what you are asking, but if you search for
> id:5 id:6 then I think doc2 will be ranked higher, because it contains
> both fields.
>
> Or are you saying you want to rank based on the number of id fields in
> the document i.e. doc2 better than doc1 because 3 better than 5?  If
> that is the case you could add a new field to each document holding
> the number of id fields in that document and sort on that.
>
> Or maybe you just need to boost searches for preferred id values.
> id:5^4 or Query.setBoost().
>
>
>
> --
> Ian.
>
> On Thu, Jan 21, 2010 at 2:15 PM, Philippe <mailer.thomas@gmail.com> wrote:
>   
>> Hi everyone,
>>
>> I want to sort my results independent from my query string. Matching
>> "documents" should be ordered by the number of fields containing a specific
>> String.
>>
>> Let's assume my query returns 2 Documents:
>>
>> Doc1 contains 5 "ID"-fields (1,2,3,4,5)
>> Doc2 contains 3 "ID"-fields (5,6,7)
>>
>> I'm more interested in documents containing the ids (5,6) so Document2
>> should be ranked higher than Document1.
>>
>> What would be the best way to perform this?
>>
>> Regards,
>>   Philippe
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44646-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 21:32:30 2010
Return-Path: <java-user-return-44646-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72354 invoked from network); 21 Jan 2010 21:32:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 21:32:30 -0000
Received: (qmail 21844 invoked by uid 500); 21 Jan 2010 21:32:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21750 invoked by uid 500); 21 Jan 2010 21:32:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21740 invoked by uid 99); 21 Jan 2010 21:32:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 21:32:27 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [12.44.8.171] (HELO birexchange.BIRPLAZA.local) (12.44.8.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 21:32:20 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA9AE1.2882E2DF"
Subject: FieldValueHitQueue question - migration to 3.0
X-MimeOLE: Produced By Microsoft Exchange V6.5
Date: Thu, 21 Jan 2010 16:31:56 -0500
Message-ID: <CC2671C08F06704ABFD37ED1EA09AA56F6CA3E@birexchange.BIRPLAZA.local>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: FieldValueHitQueue question - migration to 3.0
Thread-Index: Acqa4SfYaIdPo+GNQ/6uVnnCRF3sGw==
From: "Beard, Brian" <Brian.Beard@mybir.com>
To: <java-user@lucene.apache.org>

------_=_NextPart_001_01CA9AE1.2882E2DF
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Since FieldSortedHitQueue was deprecated in 3.0, I'm converting to the
new FieldValueHitQueue.

The trouble I'm having is coming up with a way to use FieldValueHitQueue
in a Collector so it is decoupled from a TopDocsCollector.

What I'd like to do is have a custom Collector that can add objects
extended from a FieldDoc to a queue class that extends from
FieldValueHitQueue. The problem is FieldValueHitQueue hides its
constructor, and uses a package protected static Entry class that
extends ScoreDoc and is not visible to any class extending from it.
Alternatively I could just modify the classes so I can extend from Entry
myself, but I thought there might be a better way to do this I'm not
seeing.

Is there a way to decouple the FieldValueHitQueue from the Entry so it
can take classes extended from FieldDoc types?

Also, I noticed that there is a FieldDocSortedHitQueue used with
MultiSearcher. Are there any reasons to not use  a clone of this class
rather than the FieldValueHitQueue?

------_=_NextPart_001_01CA9AE1.2882E2DF--

From java-user-return-44647-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 21 21:46:34 2010
Return-Path: <java-user-return-44647-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93457 invoked from network); 21 Jan 2010 21:46:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 21 Jan 2010 21:46:34 -0000
Received: (qmail 51131 invoked by uid 500); 21 Jan 2010 21:46:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51044 invoked by uid 500); 21 Jan 2010 21:46:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51033 invoked by uid 99); 21 Jan 2010 21:46:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 21:46:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 21 Jan 2010 21:46:23 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NY4qp-0006i4-4y
	for java-user@lucene.apache.org; Thu, 21 Jan 2010 13:46:03 -0800
Message-ID: <27265165.post@talk.nabble.com>
Date: Thu, 21 Jan 2010 13:46:03 -0800 (PST)
From: Frank Geary <fgeary@acquiremedia.com>
To: java-user@lucene.apache.org
Subject: Re: Index corruption using Lucene 2.4.1 - thread safety issue?
In-Reply-To: <9ac0c6aa1001121105s5e1b6c55h320e31cf734f1850@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: fgeary@acquiremedia.com
References: <27115515.post@talk.nabble.com> <9ac0c6aa1001120101o77c9e0b9i74ad0e76b59063ad@mail.gmail.com> <27129835.post@talk.nabble.com> <9ac0c6aa1001121105s5e1b6c55h320e31cf734f1850@mail.gmail.com>


Nope.  When it's time to inactivate a RAMDir indexWriter, I get that
directory,  close that writer, then clear out the directory.  Then after
clearing out the directory, I create a new IW passing in the directory that
was used previously.  No, I do not override the LockFactory - not familiar
with it.

Hmm...for what it's worth we are using ConcurrentMergeScheduler.
We do actaully have setInfoStream turned on for all our indexers.  I'll hav=
e
to hunt down one of our logs that corresponds to one of the Exceptions
though.  Thanks for that.

We delete the files explicitly, because what we found was that under high
index loads (i.e. rapid rolling of RAMDir indexWriters) leaving the RAMDir
around lead to garbage collection issues as old RAMDirs accumulated waiting
for garbage collection to take place.  It turned out that deleting the file=
s
explicitly avoided those garbage collection problems.

Thanks again.

Frank=20


Michael McCandless-2 wrote:
>=20
> Is it possible that you're not closing the old IW on the RAMDir before
> deleting files / re-using it?  Or, any other possible way that two
> open writers could accidentally share the same RAMDir?  Do you
> override the LockFactory of the RAMDir?
>=20
> EG with ConcurrentMergeScheduler, it can continue to write files into
> the RAMDir.  It's remotely possible (though I think rather unlikely)
> that this could lead to the corruption you're seeing.
>=20
> If you can turn on setInfoStream for all writers you create and
> capture & post all output leading to the exception, that could give us
> a clue...
>=20
> You should be able to use IW's deleteAll method to remove all docs
> without closing/reopening the writer (oh -- but this is only available
> as of 2.9).
>=20
> You shouldn't have to remove files yourself -- just open a new IW with
> create=3Dtrue?
>=20
> Mike
>=20
> On Tue, Jan 12, 2010 at 11:02 AM, Frank Geary <fgeary@acquiremedia.com>
> wrote:
>>
>> Thanks for the reply Mike. =C2=A0Your questions were good ones because I
>> realize
>> now I should have probably used "Corrupt IndexReader" as the subject for
>> this thread. =C2=A0Here's my answers:
>>
>> The number stays the same until the corrupted IndexReader is reopened (i=
f
>> nothing changes in the IndexReader - and thus we get the same IndexReade=
r
>> back from reopen - the problem persists). =C2=A0Then the next time the p=
roblem
>> occurs, after we've gotten at least one non-problematic IndexReader and
>> thus
>> a few successful searches, the number is different. =C2=A0For what it's =
worth
>> my
>> latest ### was 176. =C2=A0My assumption has always been that it is most =
likely
>> to
>> be 1 beyond the end of the BitVector because each commit() is only
>> changing
>> the index by adding or deleting one document. =C2=A0But I don't know for=
 sure.
>>
>> Yes, I had always expected that reopen during commit would be fine, and
>> my
>> semaphore code seems to confirm that (unless adds have something very
>> subtle
>> to do with it). =C2=A0Any other theories would be very much appreciated.
>>
>> At first I wasn't sure whether it was the RAMDirectory or the main dir.
>> =C2=A0But
>> since I now have many examples where the RAMDirectory IndexReader has
>> changed and the main dir IndexReader has not, then I feel that the
>> RAMDirectory IndexReader is the problem. =C2=A0We reopen a new IndexRead=
er
>> every
>> time we do a search on a RAMDirectory. =C2=A0For the main dir, we rarely
>> reopen
>> an IndexReader. =C2=A0We only reopen the main dir IndexReader when a RAM
>> Directory is gotten rid of, which happens once the RAM directory indexes
>> 10000 documents. =C2=A0But here's a typical example where the main dir
>> IndexReader stays the same throughout the problem:
>>
>> 1) both the RAMDirectory IndexReader and the main dir IndexReader are se=
t
>> after the last time we got rid of the RAMDirectory which was full with
>> 10000
>> documents.
>> 2) then we receive about 1077 new documents and add them to the
>> RAMDirectory
>> as well as to the main dir indexes (with a number of deletes scattered
>> throughout as well). =C2=A0The RAM directory is commited after every add=
 or
>> delete and the main dir is not committed at all.
>> 3) then a search comes in, we reopen the RAM Directoy IndexReader, use
>> the
>> existing main dir IndexReader (which does not reflect any index changes
>> since step 1) and do the search and get ArrayIndexOutOfBounds so the
>> search
>> fails (in this case the ### was 208)
>> 4) then we simply go one and get another 4000 adds and deletes in the RA=
M
>> directory and main directory. =C2=A0Again the RAM directory is commited =
after
>> every add or delete and the main dir is not committed at all.
>> 5) then the next search comes in, reopens the RAMDirectory IndexReader,
>> uses
>> the existing main dir IndexReader (which does not reflect any index
>> changes
>> since step 1) and the search works fine!
>> 6) during all that time the main dir IndexReader never got reopened, and
>> the
>> RAMDirectory IndexReader only got reopened twice - once it was bad and
>> the
>> next it was OK.
>>
>> To answer your question about when we periodically move our in-RAM
>> changes
>> to the disk index (my apologies if this is redundant):
>> We never move them. =C2=A0They are duplicated in both the RAM directory =
and
>> on-disk directory as they come in. =C2=A0Then when the RAM directory
>> determines
>> that it has 10000 documents, we begin writing to a second RAM Directory,
>> reopen and warmup the on-disk IndexReader and once that new on-disk
>> IndexReader is ready, we throw away the RAM directory which had 10000
>> documents (to do this we actually clean out the RAM directory by deletin=
g
>> all the files it contains and we create a new IndexWriter using that sam=
e
>> RAMDirectory object). =C2=A0Then we continue writing to that second
>> RAMdirectory
>> and the on-disk index until the second RAM directory has 10000 documents=
.
>> And repeat.
>>
>> We have NOT run CheckIndex on the RAM directory mainly because this
>> mostly
>> happens in our production environment which has very high traffic and I'=
d
>> have to write some special code to set aside a bad RAMDirectory index,
>> etc
>> to run the CheckIndex on it. =C2=A0Just not an easy thing to do.
>>
>> I can look into enabling asserts. =C2=A0That may help.
>>
>> Finally, for the RAM directory, we must create a new IndexWriter
>> everytime
>> "clean out" the RAM directory after we reach the 10000 documents limit.
>> =C2=A0We
>> clean out the RAM directory by deleting all the files it contains and we
>> then create a new IndexWriter using that same RAMDirectory object. =C2=
=A0If
>> there
>> was a reopen for an IndexWriter, we'd use that instead. =C2=A0For the on=
-disk
>> directory, the IndexWriter never changes and we reopen the IndexReader
>> each
>> time a RAM directory reaches the 10000 document limit.
>>
>> Any further thoughts or ideas? =C2=A0Thanks again for your help Mike!
>>
>> Frank
>>
>>
>> Michael McCandless-2 wrote:
>>>
>>> Not good! =C2=A0Can you post the ###'s from the exception? =C2=A0How fa=
r out of
>>> bounds is the access?
>>>
>>> Your usage sounds fine. =C2=A0Reopen during commit is fine.
>>>
>>> Are you sure the exception comes from the reader on the RAMDir and not
>>> your main dir?
>>>
>>> How do you periodically move your in-RAM changes to the disk index?
>>>
>>> Have you run CheckIndex on your index? =C2=A0Also, try running with ass=
erts
>>> enabled... it may catch whatever is happening, sooner.
>>>
>>> Do you hold open a single IW on the RAMDir, and re-use it? =C2=A0Or ope=
n
>>> and then close? =C2=A0What about the disk dir?
>>>
>>> Mike
>>>
>>> On Mon, Jan 11, 2010 at 1:42 PM, Frank Geary <fgeary@acquiremedia.com>
>>> wrote:
>>>>
>>>> Hi,
>>>>
>>>> I'm using Lucene 2.4.1 and am seeing occasional index corruption. =C2=
=A0It
>>>> shows
>>>> up when I call MultiSearcher.search(). =C2=A0MultiSearcher.search() th=
rows
>>>> the
>>>> following exception:
>>>>
>>>> ArrayIndexOutOfBoundsException. =C2=A0The error is: Array index out of
>>>> range:
>>>> ###
>>>> where ### is a number representing an index into the deletedDocs
>>>> BitVector
>>>> in SegmentTermDocs. =C2=A0the stack trace is as follows:
>>>>
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.util.BitVector.get(BitVector.java:91)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:125)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.index.MultiSegmentReader$MultiTermDocs.next(MultiSeg=
mentReader.java:554)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.FieldCacheImpl$10.createValue(FieldCacheImpl.=
java:384)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:=
71)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.FieldCacheImpl.getStringIndex(FieldCacheImpl.=
java:351)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.FieldSortedHitQueue.comparatorString(FieldSor=
tedHitQueue.java:415)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.FieldSortedHitQueue$1.createValue(FieldSorted=
HitQueue.java:206)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.FieldCacheImpl$Cache.get(FieldCacheImpl.java:=
71)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.FieldSortedHitQueue.getCachedComparator(Field=
SortedHitQueue.java:167)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.FieldSortedHitQueue.<init>(FieldSortedHitQueu=
e.java:55)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.TopFieldDocCollector.<init>(TopFieldDocCollec=
tor.java:43)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:122)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.MultiSearcher.search(MultiSearcher.java:232)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> org.apache.lucene.search.Searcher.search(Searcher.java:86)
>>>> 2010-01-09 20:40:00,561 [pool-1-thread-4] ERROR -
>>>> com.acquiremedia.opens.index.searcher.HybridIndexSearcher.search(Hybri=
dIndexSearcher.java:311)
>>>> .
>>>> .
>>>> .
>>>>
>>>> That makes sense, but I'm trying to understand what could be causing
>>>> the
>>>> corruption.
>>>>
>>>> Here's what I'm doing:
>>>>
>>>> 1) I have an IndexWriter created usnig a RAMDirectory.
>>>>
>>>> 2) I have a single thread processing index adds and index deletes.
>>>> =C2=A0This
>>>> thread is rather simple and calls IndexWriter.addDocument() followed b=
y
>>>> IndexWriter.commit() or IndexWriter.deleteDocuments() followed by
>>>> IndexWriter.commit(). =C2=A0The commits are done at this point because=
 we
>>>> want
>>>> the documents available for searching immediately.
>>>>
>>>> 3) I also have 4 search threads running at the same time as the index
>>>> write
>>>> thread. =C2=A0Each time a search thread executes a search it calls
>>>> IndexReader.reopen() =C2=A0on the existing IndexReader for the index c=
reated
>>>> using the RAMDirectory above, gets an existing index reader for anothe=
r
>>>> on-disk index and then calls MultiSearcher.search() (this brings
>>>> together
>>>> the RamDirectory index and an on-disk index) to execute the search.
>>>>
>>>> It generally works fine, but every few days or so I get the above
>>>> ArrayIndexOutOfBoundsException. =C2=A0 My suspicion is that when the
>>>> IndexWritert.commit() call happens due to a delete at the exact same
>>>> time
>>>> as
>>>> the IndexReader.reopen() call happens, the IndexReader has a deleteDoc=
s
>>>> BitVector which reflects the delete, but something else internal to th=
e
>>>> IndexReader is not reflecting the delete.
>>>>
>>>> So, I implemented a semaphore mechanism to prevent IndexWriter.commit(=
)
>>>> from
>>>> happening at the same time as IndexReader.reopen(). =C2=A0I only imple=
mented
>>>> the
>>>> semaphores in the delete case because my guess was that an add would b=
e
>>>> unlikely to affect the deleteDocs Bit Vector. =C2=A0Unfortunately, the
>>>> problem
>>>> continues to happen.
>>>>
>>>> I believe I read somewhere that a similar thread saftey issue had been
>>>> fixed
>>>> in Lucene 2.4, but I suspect there may still be an issue in 2.4.1.
>>>>
>>>> Does anyone have any knowledge or insight into what I may be doing
>>>> wrong
>>>> or
>>>> how I can correct/avoid the problem? =C2=A0Upgrading to Lucene 3.0 or =
using
>>>> Solr
>>>> are not really options for me at least in the short term.
>>>>
>>>> Thanks for any information you can provide!
>>>>
>>>> Frank
>>>> --
>>>> View this message in context:
>>>> http://old.nabble.com/Index-corruption-using-Lucene-2.4.1---thread-saf=
ety-issue--tp27115515p27115515.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> --
>> View this message in context:
>> http://old.nabble.com/Index-corruption-using-Lucene-2.4.1---thread-safet=
y-issue--tp27115515p27129835.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/Index-corruption-using-=
Lucene-2.4.1---thread-safety-issue--tp27115515p27265165.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44648-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 04:19:48 2010
Return-Path: <java-user-return-44648-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78264 invoked from network); 22 Jan 2010 04:19:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 04:19:48 -0000
Received: (qmail 96098 invoked by uid 500); 22 Jan 2010 04:19:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95886 invoked by uid 500); 22 Jan 2010 04:19:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95874 invoked by uid 99); 22 Jan 2010 04:19:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 04:19:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ryguasu@gmail.com designates 209.85.221.189 as permitted sender)
Received: from [209.85.221.189] (HELO mail-qy0-f189.google.com) (209.85.221.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 04:19:37 +0000
Received: by qyk27 with SMTP id 27so395311qyk.20
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 20:19:16 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=C+MkPBdGD1PCAotwBTb/Wbj0cS4AOM1XYyl9P/Xkzk0=;
        b=N6FRnFdOrlBR6ZVHr7zr+Ki936YKPvnlT1uUS4zdkvkD2HoAbFpJMjOedTPrczILQZ
         qucHB3HHJac8mcRfhAWA5xlEN3wzaQ78rt4YPmf+J0VUskBxc/h1ddvuVMBLmIkzSIb1
         8b+1o302w0yXPWLaPSHqdii9fY74oWbBgIJTQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=B/rUkb1pJMJAHR16S4q3k608EZqiTwa1kslBR6W7G4+wZ0Q78MvZzZCotHHUuy12L3
         1jBmyxJXzJHeQ2gElEvNt392eUEg2Poy5QkGTH++NLXbHjDX6mnABZAVNmkLiBOeFQqk
         P/eXV+vw3qCeaaBvP/SRaD113XKhEHboy2p/4=
MIME-Version: 1.0
Received: by 10.220.127.28 with SMTP id e28mr175745vcs.72.1264133956178; Thu, 
	21 Jan 2010 20:19:16 -0800 (PST)
In-Reply-To: <85d3c3b61001192010l614c83a7r9120b1b3ec2d7a9c@mail.gmail.com>
References: <856ac15f1001191642k7b579316w62221900ba676b85@mail.gmail.com> 
	<85d3c3b61001192010l614c83a7r9120b1b3ec2d7a9c@mail.gmail.com>
From: Chris Harris <ryguasu@gmail.com>
Date: Thu, 21 Jan 2010 20:18:56 -0800
Message-ID: <856ac15f1001212018r60938222if1e6e578b2499a9f@mail.gmail.com>
Subject: Re: Tag Index patch (LUCENE-1292) status?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

I'm probably not going to work on it right now.

It might be nice, though, to make sure I have the right big-picture
idea of the tag index patch. I can think of two ways to ask it:

1. What's the relationship between the tag index patch and LUCENE-1879
("Parallel incremental indexing", which also has the associated page
http://wiki.apache.org/lucene-java/ParallelIncrementalIndexing)? Is
the tag index an alternative idea, or a complementary one?

2. Does the tag index patch means to take care of all of my fields, or
does it only apply to my updateable (and non-tokenized) fields? For
example, if I use the tag index patch (and suppose I don't use any
LUCENE-1879 stuff), then do I need to manually create two indexes, one
for my static fields and one for my tags? (I would need to be careful
about how I coordinated these indexes, so I could use a ParallelReader
with them.) Or is there only one index, and the tag fields are
updateable simply by virtue of the patch's new segment file types?

Thanks,
Chris

On Tue, Jan 19, 2010 at 8:10 PM, Jason Rutherglen
<jason.rutherglen@gmail.com> wrote:
> Hi Chris,
>
> It's not actively being worked on. =A0Are you interested in working on it=
?
>
> Jason
>
> On Tue, Jan 19, 2010 at 4:42 PM, Chris Harris <ryguasu@gmail.com> wrote:
>> I'm interested in the Tag Index patch (LUCENE-1292), in particular
>> because of how it enables you to modify certain fields without
>> reindexing a whole document. However, that issue is marked Lucene
>> 2.3.1 and hasn't been updated since July 2008. Can anyone provide any
>> status updates on this patch? Questions include:
>>
>> - Is anyone using this in production?
>>
>> - Does this work with Lucene 2.9/3.0?
>>
>> - Is anyone actively working on the patch now?
>>
>> - Are there any competing approaches now for doing updates to
>> particular fields? (I haven't found any yet.)
>>
>> Thanks,
>> Chris
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44649-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 04:36:33 2010
Return-Path: <java-user-return-44649-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82234 invoked from network); 22 Jan 2010 04:36:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 04:36:33 -0000
Received: (qmail 9852 invoked by uid 500); 22 Jan 2010 04:36:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9699 invoked by uid 500); 22 Jan 2010 04:36:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9688 invoked by uid 99); 22 Jan 2010 04:36:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 04:36:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 04:36:24 +0000
Received: by pwi11 with SMTP id 11so519546pwi.5
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 20:36:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=hZg3cwBHROULmVRpHW0+ogo2ajF5hXwdISnGetVqrgk=;
        b=Pj8BaVRgwDe+dT97r28CNE2DLHS+f9VustMQWIjwPFpIj/L7vSVF7bmloGtXq4KA9t
         xMKE1d/3GBGfqU6fZWUH7GucyLMKaNroWsAgEyJMQ7U4+GF9hddXrtVnffL57B75TZRK
         xAzJdRwpHIfDBdAJVAImbfGTQWx/ltBgmkcAQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=Ue8vqBzFmHfEsk8F4p9RfOa2bAVPOLGaeMCsf6LChq3cUES8UtmyGl3mD2BnsL+gbH
         SO8ICM4UxcHnRutVCYsBKOidOUIQFzM3y+HRjsOXI2eEPiVzhlBDHEnmVpBAfjcqKAP6
         QUs6ExBO97+m6aAuf3/z9dsD5Lwj7/7q3dJhc=
MIME-Version: 1.0
Received: by 10.141.107.13 with SMTP id j13mr1705956rvm.172.1264134963444; 
	Thu, 21 Jan 2010 20:36:03 -0800 (PST)
In-Reply-To: <856ac15f1001212018r60938222if1e6e578b2499a9f@mail.gmail.com>
References: <856ac15f1001191642k7b579316w62221900ba676b85@mail.gmail.com>
	 <85d3c3b61001192010l614c83a7r9120b1b3ec2d7a9c@mail.gmail.com>
	 <856ac15f1001212018r60938222if1e6e578b2499a9f@mail.gmail.com>
Date: Thu, 21 Jan 2010 20:36:03 -0800
Message-ID: <85d3c3b61001212036v44cba44cid59d0c431ca779b3@mail.gmail.com>
Subject: Re: Tag Index patch (LUCENE-1292) status?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Chris,

Great questions....

TI is for untokenized fields only and so is probably for a
different use case than LUCNE-1879 (which is very cool, does it
work yet?). TI should just handle everything underneath, so one
wouldn't manually worry about it.

The only hard part, or untested performance wise part, is the if
a posting "block" becomes too small, how will that affect
performance of posting list iteration (i.e. skipping). Instead
of vint decoding, one'd probably implement TI postings using
PFOR or some other naturally "block"ed posting algorithm, which
PFOR happens to be. So if I started again, which would take a
lot of time to work on, I'd start benchmarking there to see if
the idea is even tenable. Though I'm assuming somehow it works,
as GMail labels appear to implement this type of thing. As more
current responsibilities are far removed from these lower Lucene
levels, I don't see working on it in the near future.

Jason

On Thu, Jan 21, 2010 at 8:18 PM, Chris Harris <ryguasu@gmail.com> wrote:
> I'm probably not going to work on it right now.
>
> It might be nice, though, to make sure I have the right big-picture
> idea of the tag index patch. I can think of two ways to ask it:
>
> 1. What's the relationship between the tag index patch and LUCENE-1879
> ("Parallel incremental indexing", which also has the associated page
> http://wiki.apache.org/lucene-java/ParallelIncrementalIndexing)? Is
> the tag index an alternative idea, or a complementary one?
>
> 2. Does the tag index patch means to take care of all of my fields, or
> does it only apply to my updateable (and non-tokenized) fields? For
> example, if I use the tag index patch (and suppose I don't use any
> LUCENE-1879 stuff), then do I need to manually create two indexes, one
> for my static fields and one for my tags? (I would need to be careful
> about how I coordinated these indexes, so I could use a ParallelReader
> with them.) Or is there only one index, and the tag fields are
> updateable simply by virtue of the patch's new segment file types?
>
> Thanks,
> Chris
>
> On Tue, Jan 19, 2010 at 8:10 PM, Jason Rutherglen
> <jason.rutherglen@gmail.com> wrote:
>> Hi Chris,
>>
>> It's not actively being worked on. =A0Are you interested in working on i=
t?
>>
>> Jason
>>
>> On Tue, Jan 19, 2010 at 4:42 PM, Chris Harris <ryguasu@gmail.com> wrote:
>>> I'm interested in the Tag Index patch (LUCENE-1292), in particular
>>> because of how it enables you to modify certain fields without
>>> reindexing a whole document. However, that issue is marked Lucene
>>> 2.3.1 and hasn't been updated since July 2008. Can anyone provide any
>>> status updates on this patch? Questions include:
>>>
>>> - Is anyone using this in production?
>>>
>>> - Does this work with Lucene 2.9/3.0?
>>>
>>> - Is anyone actively working on the patch now?
>>>
>>> - Are there any competing approaches now for doing updates to
>>> particular fields? (I haven't found any yet.)
>>>
>>> Thanks,
>>> Chris
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44650-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 05:51:57 2010
Return-Path: <java-user-return-44650-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5947 invoked from network); 22 Jan 2010 05:51:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 05:51:56 -0000
Received: (qmail 67573 invoked by uid 500); 22 Jan 2010 05:51:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67441 invoked by uid 500); 22 Jan 2010 05:51:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67423 invoked by uid 99); 22 Jan 2010 05:51:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 05:51:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.57] (HELO web50303.mail.re2.yahoo.com) (206.190.38.57)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 22 Jan 2010 05:51:42 +0000
Received: (qmail 62009 invoked by uid 60001); 22 Jan 2010 05:51:18 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264139478; bh=O4BQKCsErJh5AO98Clam2Hk5Rv+of7Fj/CfEkieHnCA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=PiCdsWNq1bbWA/XfqGJ9dPXv6pCIRuzZPJGnaRYStOUQaoloMsAXcHQWdnznz90yMs4F0LNPqrxYfujjR2OUm5ynQCP2YrPMZWahwFzw6R43xG02tvQzwA5pQnRwfgLz/tZ9uBsXabURuRl86kk6qqV2Jfhhu/nTYRcwv/TogKY=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=YZA/w6jd/QQjL4okcuWWXGuYOZ7OFi2iDQR5MVkQ6YiwSrPkA2m41MCL1qGyZULz9f9oDI4TAY4SNpsUaugpvdDllCPP042BjYUMmtiOWC1JOMe+o31Qkw+0yUo4Kr8AROTrKfpBBTKxzej1gL5JXwXKbG/fGmgeR3pr8NTgeRA=;
Message-ID: <829421.61400.qm@web50303.mail.re2.yahoo.com>
X-YMail-OSG: rqAV4qoVM1naZBUAUO1OrMwe2QVw1GsCZHKcDyDAJDUm27OUBt1WZhDNcvJ6KyNY1yWfy2YV_ylhhuk4tUQTprTK90hJeiPiLGP17udMAYR4io_vJ_4YTUbY8LLXYyL7xdExrGJ2P_ZKr3jIUr2K5ZVZy_HN1ofxRlZczARkm3Uelf7QB0lqgHtFxm4IN4tkrUBoINDIcih6dcHKrJLqsTrJIzPkik1i96NkFMsloTNzICdUKLAbqOtBNUNebSJU_ZDBHiJwTKQoSlR2Hal_kiUFninAFvaYf09Q630uo0hdeCRAWB0OhSL_8d6kFXbf4MbrGNrwCCEvzEJIdjH.SRmWUXWCPz6rYKVCwUVwGK2N8JeZuyNw1XuUesgdyXf5ynKfnEM4LbtV6pbWAZHOn2MpAWqT8BjCI8PXXsO6KeWfJtrB4.qENbP.joEGoq_HiPYgY4lggaP183P1DzysK94LtXhGcDBcHx91.Y18Ckvw3MzmBBxD_1KAaea81Cl2nvZwr7DpB1xHG1GP9PiduQRbEQU.60FWLmN6eGWUH8ae11w.ip3QFjOLczyowEJD38hZNWUSdWQTVWshlJ4hYxlKsw7vYCleDoY-
Received: from [74.73.1.126] by web50303.mail.re2.yahoo.com via HTTP; Thu, 21 Jan 2010 21:51:18 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <6839.98888.qm@web26203.mail.ukl.yahoo.com> <023b01ca9915$4f503560$3c2be4d8@your8dfb31b6e1>
Date: Thu, 21 Jan 2010 21:51:18 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Proximity of More than Single Words?
To: java-user@lucene.apache.org, "T. R. Halvorson" <trh@midrivers.com>
In-Reply-To: <023b01ca9915$4f503560$3c2be4d8@your8dfb31b6e1>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, that's just a phrase slop, allowing for variable gaps between words.
I *believe* the Surround QP that works with Span family of queries does handle what you are looking for.


Otis
--
Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch



----- Original Message ----
> From: T. R. Halvorson <trh@midrivers.com>
> To: java-user@lucene.apache.org
> Sent: Tue, January 19, 2010 9:40:07 AM
> Subject: Proximity of More than Single Words?
> 
> For proximity expressions, the query parser documentation says, "use the tilde, 
> "~", symbol at the end of a Phrase." It gives the example "jakarta apache"~10
> 
> Does this mean that proximity can only be operated on single words enquoted in 
> quotation marks? To clarify the question by comparision, on some systems, the w/ 
> proximity operator lets one search for:
> 
> crude w/4 "west texas"
> 
> or
> 
> "spot prices" w/3 "gulf coast"
> 
> The Lucene documentation seems to imply that such searches cannot be constructed 
> in any straightforward way (although there might be a way to get the effect by 
> going around Cobb's Hill). Or does the Lucene syntax allow the examples to be 
> cast as:
> 
> "crude "west texas""~4
> 
> or
> 
> ""spot prices" "gulf coast""~3
> 
> If not, is it a fair assessment to say that in Lucene, proximity is limited to 
> being a part of phrase searching, and its function is exhausted by allowing a 
> slop factor in matching phrases.
> 
> Thanks in advance for any help with this.
> 
> T. R.
> trh@midrivers.com
> http://www.linkedin.com/in/trhalvorson
> www.ncodian.com
> http://twitter.com/trhalvorson 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44651-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 06:40:08 2010
Return-Path: <java-user-return-44651-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31006 invoked from network); 22 Jan 2010 06:40:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 06:40:08 -0000
Received: (qmail 93754 invoked by uid 500); 22 Jan 2010 06:40:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93635 invoked by uid 500); 22 Jan 2010 06:40:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93625 invoked by uid 99); 22 Jan 2010 06:40:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 06:40:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of farhang@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 06:39:57 +0000
Received: by ewy2 with SMTP id 2so921065ewy.5
        for <java-user@lucene.apache.org>; Thu, 21 Jan 2010 22:39:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=31ankfN3WA1C4s7Rh79X9DXBbzfyzbSryQfvnBz03fg=;
        b=WGWCmHBDlQZCaO7W5zI/St6BE+MfZEnXeEXehs9I4lIl3A2AiEzREsE97Ke6EAky8T
         Qy9s2f8gmD4pbAoCKnjd3CDZgPyUcHqoRyFAfRbCrzIksmCLB8fBIMy3N5Y/30jVMe3w
         RGKarcY1WZ91SGFfk31c07sTuGbehj5NMDs0E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=tRFqPlyR4B9G3Yd22ySqzR53iq1Qcb1grX0Ufq6+w65Z95Xhtt/gyjwuKg5RtCAsAB
         jioXqU6pdIlTzhmBCh4bwdOfYtPrmAllenc0A6+1vk0aPuvdQT4UDG+n4ByaFiCCHpT7
         DQIzUOqltnqWjf5O2Uf/DVoAG2FTcbk07J0e8=
MIME-Version: 1.0
Received: by 10.216.87.143 with SMTP id y15mr919027wee.39.1264142377186; Thu, 
	21 Jan 2010 22:39:37 -0800 (PST)
In-Reply-To: <9ac0c6aa1001200241g1331cf7pea609c685d5838a4@mail.gmail.com>
References: <b0f7deba1001140123h4efd502fr5e7a4a91b3fd70df@mail.gmail.com>
	 <9ac0c6aa1001170206j69448d38v6b729502d834e94c@mail.gmail.com>
	 <b0f7deba1001170445s26ad8a15w1f4c38553a3f6df7@mail.gmail.com>
	 <9ac0c6aa1001170539s7ea30b01n96474c27c01a2713@mail.gmail.com>
	 <b0f7deba1001172135y68f0fb03m3856c072ccacb83c@mail.gmail.com>
	 <9ac0c6aa1001180342l43ba741bhf187393cdbfc755f@mail.gmail.com>
	 <b0f7deba1001182232o227615e7t7e40bfe7ac9d617d@mail.gmail.com>
	 <9ac0c6aa1001190248g2e952aabpa97d47637adeb22e@mail.gmail.com>
	 <b0f7deba1001191945oce193cci9ac15a7589d08f93@mail.gmail.com>
	 <9ac0c6aa1001200241g1331cf7pea609c685d5838a4@mail.gmail.com>
Date: Thu, 21 Jan 2010 23:39:37 -0700
Message-ID: <b0f7deba1001212239n3dc31bc5h39153cb4e35fe1d3@mail.gmail.com>
Subject: Re: incremental document field update
From: Babak Farhang <farhang@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

> OK; this approach (modifying an already written & possible in-use (by
> an IndexReader) file) would be problematic for Lucene...

If you have N slots, there would have to be N-1 commits + an Nth commit
in progress while reading the "entry-count block"  for there to be the
possibility of
a bad read. Make N large enough (max 256), and that should close the
window, I think.

Any way, just want to thank you Mike for sharing your thoughts and
ideas. Time to
try some of them..

Cheers,
-Babak

On Wed, Jan 20, 2010 at 3:41 AM, Michael McCandless
<lucene@mikemccandless.com> wrote:
> On Tue, Jan 19, 2010 at 10:45 PM, Babak Farhang <farhang@gmail.com> wrote:
>>> I see -- so your file format allows you to append to the same file
>>> without affecting prior readers?  We never do that in Lucene today
>>> (all files are "write once").
>>
>> Yes. For the most part it only appends. The exception is when the
>> log's entry count is updated (when the appends actually "commit").
>> That count is written into one of many (>= 2 and <= 257) slots in round
>> robin fashion and finally a byte-size "keystone" is updated to determine
>> the active slot. The idea is that by flushing the file just before and just
>> after the keystone byte update we ensure persistence (assumes writing
>> one byte is always all-or-nothing). Increasing the number of slots
>> the count is written to narrows the chance of a bad read..
>
> OK; this approach (modifying an already written & possible in-use (by
> an IndexReader) file) would be problematic for Lucene...
>
>>> Good questions (terms dict & stored fields) -- I think what we'd do is
>>> simply write a new segment, so stored fields, term vectors, postings,
>>> terms dict, etc., are all private to that new segment.  But, we'd mark
>>> the segment as being a delta segment, referencing the original
>>> segment, and we'd remap the docIDs when flushing that segment.
>>
>> The .fdx and .tvx files use fixed-width tables, so it seems if there are
>> large gaps in the updated doc-ids, we'd have to fill in "null" rows for
>> those gaps.  Or do you have another data-structure in mind for these
>> .*x files?
>
> Yeah, good point; we'd have to allow for a sparse index storage for fdx/tvx.
>
>> One solution may be to combine the approaches we described: maintain
>> doc-id mappings for the .fdx and .tvx files for per-document
>> data at search time, and index-time mapped doc-ids for the posting
>> lists.
>
> True, we could do both...
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44652-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 08:14:52 2010
Return-Path: <java-user-return-44652-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52448 invoked from network); 22 Jan 2010 08:14:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 08:14:51 -0000
Received: (qmail 71382 invoked by uid 500); 22 Jan 2010 08:14:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71310 invoked by uid 500); 22 Jan 2010 08:14:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71300 invoked by uid 99); 22 Jan 2010 08:14:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 08:14:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.85.217.216] (HELO mail-gx0-f216.google.com) (209.85.217.216)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 08:14:42 +0000
Received: by gxk8 with SMTP id 8so806305gxk.11
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 00:14:21 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.119.42 with SMTP id r42mr3566952ybc.325.1264148061252; 
	Fri, 22 Jan 2010 00:14:21 -0800 (PST)
In-Reply-To: <27265165.post@talk.nabble.com>
References: <27115515.post@talk.nabble.com>
	 <9ac0c6aa1001120101o77c9e0b9i74ad0e76b59063ad@mail.gmail.com>
	 <27129835.post@talk.nabble.com>
	 <9ac0c6aa1001121105s5e1b6c55h320e31cf734f1850@mail.gmail.com>
	 <27265165.post@talk.nabble.com>
Date: Fri, 22 Jan 2010 03:14:21 -0500
Message-ID: <9ac0c6aa1001220014h4fdeac43uca16c056b23364e1@mail.gmail.com>
Subject: Re: Index corruption using Lucene 2.4.1 - thread safety issue?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

On Thu, Jan 21, 2010 at 4:46 PM, Frank Geary <fgeary@acquiremedia.com> wrot=
e:

> Nope. =A0When it's time to inactivate a RAMDir indexWriter, I get that
> directory, =A0close that writer, then clear out the directory. =A0Then af=
ter
> clearing out the directory, I create a new IW passing in the directory th=
at
> was used previously. =A0No, I do not override the LockFactory - not famil=
iar
> with it.

Hmm, curious.

> Hmm...for what it's worth we are using ConcurrentMergeScheduler.
> We do actaully have setInfoStream turned on for all our indexers. =A0I'll=
 have
> to hunt down one of our logs that corresponds to one of the Exceptions
> though. =A0Thanks for that.

That could be helpful... eg it'd let us confirm every open IW is
closed before a new one is opened, on the same IW (assuming we get the
full output from all opened IWs).

> We delete the files explicitly, because what we found was that under high
> index loads (i.e. rapid rolling of RAMDir indexWriters) leaving the RAMDi=
r
> around lead to garbage collection issues as old RAMDirs accumulated waiti=
ng
> for garbage collection to take place. =A0It turned out that deleting the =
files
> explicitly avoided those garbage collection problems.

That's very odd -- RAMDir should be "easy" to GC once it's closed.  It
(and RAMFile) have no finalizers.

Were you calling RAMDir.close()?  That clears its fileMap, which will
make all RAM consumed GCable.

The fact that you hit GC issues makes me suspect something, somewhere
is still hanging on to the RAMDir (ie, the IW isn't always being
closed).

If you go back to using a new RAMDir instance per IW, does the problem go a=
way?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44653-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 08:35:15 2010
Return-Path: <java-user-return-44653-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56886 invoked from network); 22 Jan 2010 08:35:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 08:35:15 -0000
Received: (qmail 89172 invoked by uid 500); 22 Jan 2010 08:35:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89102 invoked by uid 500); 22 Jan 2010 08:35:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89092 invoked by uid 99); 22 Jan 2010 08:35:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 08:35:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 08:35:03 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id 0B37450829; Fri, 22 Jan 2010 00:34:42 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-161-221-tbnb-esr-2.dynamic.isadsl.co.za [196.210.161.221])
	by serve.stimulussoft.com (Postfix) with ESMTPA id E5D2050827
	for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 00:34:40 -0800 (PST)
Message-ID: <4B596314.8060904@stimulussoft.com>
Date: Fri, 22 Jan 2010 10:34:28 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Index Growing on Delete
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-3.3 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

Hi

In our application,on a periodic basis, documents get deleted from the 
index. Although the deleted documents correctly cannot be found when 
searching the index, our users are complaining that their hard drive is 
fulling up, since the index continues to grow in size despite the fact 
that the entries should be deleted from the index. I cannot understand 
why this is the case since I call both writer.expungeDeletes and 
writer.commit(). Any ideas?

Here is my delete function:

public void deleteDocs(Term[] terms) throws MessageSearchException {
               logger.debug("delete docs");
               try {
                   indexLock.lock();
                   openIndex();
                   try {
                       writer.deleteDocuments(terms);
                   } catch (Exception e) {
                       throw new MessageSearchException("failed to 
delete doc from index."+e.getMessage(),e,logger);
                   } finally {
                       try {
                           writer.expungeDeletes(false);
                           writer.commit();
                       } catch (Exception io) {
                           throw new MessageSearchException("failed to 
expunge docs from index"+io.getMessage(),io,logger);
                       }
                   }
               } catch (Throwable t) {
                   logger.error("failed to delete docs from 
index."+t.getMessage(),t);
               } finally {
                   indexLock.unlock();
               }
}

As an aside note, we are moving to Lucene 3.0 from 2.9. What is the 
equivalent of:

QueryParser queryParser = new QueryParser("body",analyzer);
and "Field.Index.TOKENIZED". If I change this, will my index maintain 
compatibility?


Thanks

Jamie


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44654-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 10:02:16 2010
Return-Path: <java-user-return-44654-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94823 invoked from network); 22 Jan 2010 10:02:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 10:02:15 -0000
Received: (qmail 77096 invoked by uid 500); 22 Jan 2010 10:02:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77002 invoked by uid 500); 22 Jan 2010 10:02:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76991 invoked by uid 99); 22 Jan 2010 10:02:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:02:13 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of sriramc@ivycomptech.com designates 203.153.210.130 as permitted sender)
Received: from [203.153.210.130] (HELO ivymail.ivycomptech.com) (203.153.210.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:02:05 +0000
Received: from hydsvwin800.ivycomptech.partygaming.local ([10.1.10.46]) by ivymail.ivycomptech.com with Microsoft SMTPSVC(6.0.3790.3959); Fri, 22 Jan 2010 15:29:03 +0530
Received: from HYDSVWIN004X.ivycomptech.partygaming.local ([10.1.10.228]) by hydsvwin800.ivycomptech.partygaming.local with Microsoft SMTPSVC(6.0.3790.3959); Fri, 22 Jan 2010 15:29:56 +0530
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.4073
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01CA9B49.B1CC0A1C"
Subject: Applying LUCENE-1606  -- which version
Date: Fri, 22 Jan 2010 15:34:34 +0530
Message-ID: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Applying LUCENE-1606  -- which version
thread-index: AcqbSiugQuWh842RRw6VoFWhct3oWAAABo+A
From: "Sriram Muthuswamy Chittathoor" <sriramc@ivycomptech.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 22 Jan 2010 09:59:56.0797 (UTC) FILETIME=[A6DE12D0:01CA9B49]
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01CA9B49.B1CC0A1C
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
X-EC0D2A8E-5CB7-4969-9C36-46D859D137BE-PartID: C7C3A1EA-A9A8-4D15-993E-4D02AEC34D7E

Hi:

=20

I am trying to apply this Automata patch on my Lucene 3.0 src code but
running into issues as it is complaining about failures to apply patch
to certain files.  Is this the right version

To apply to.  Please help

=20

Thanks

=20

Sriram C

=20

LUCENE-1606
https://issues.apache.org/jira/browse/LUCENE-1606


This email is sent for and on behalf of Ivy Comptech Private Limited. =
Ivy Comptech Private Limited is a limited liability company. =20

This email and any attachments are confidential, and may be legally =
privileged and protected by copyright. If you are not the intended =
recipient dissemination or copying of this email is prohibited. If you =
have received this in error, please notify the sender by replying by =
email and then delete the email completely from your system.=20
Any views or opinions are solely those of the sender.  This =
communication is not intended to form a binding contract on behalf of =
Ivy Comptech Private Limited unless expressly indicated to the contrary =
and properly authorised. Any actions taken on the basis of this email =
are at the recipient's own risk.

Registered office:
Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills, =
Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994. =
Registered in India. A list of members' names is available for =
inspection at the registered office.


------_=_NextPart_001_01CA9B49.B1CC0A1C--

From java-user-return-44655-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 10:05:06 2010
Return-Path: <java-user-return-44655-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96198 invoked from network); 22 Jan 2010 10:05:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 10:05:06 -0000
Received: (qmail 79153 invoked by uid 500); 22 Jan 2010 10:05:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79072 invoked by uid 500); 22 Jan 2010 10:05:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79062 invoked by uid 99); 22 Jan 2010 10:05:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:05:03 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=MIME_BASE64_BLANKS,MIME_BASE64_TEXT,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of anshumg@gmail.com designates 209.85.210.192 as permitted sender)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:04:55 +0000
Received: by yxe30 with SMTP id 30so906586yxe.29
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 02:04:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:x-rim-org-msg-ref-id
         :message-id:content-transfer-encoding:reply-to:x-priority
         :sensitivity:importance:subject:to:from:date:content-type
         :mime-version;
        bh=P9ORCKffFYxLVa9E8tQXql6xFXq5zrcUqzn4U0QKe9g=;
        b=tKqmkM86iCbJsXdfXM5lZgwxpYdMyP5GEYoc7O4V3jzj1QKDypjpbwnE5OPpXJEdkv
         BaZzbyagENRgmUYcZreQLG0zzEtzavJgOY7XKk+3w0zJy9SvgE3WhYbeFLe9097RPHLJ
         wQNCGIdk+6ChsmZfbECXmLW2EtVILoR0coUXY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=x-rim-org-msg-ref-id:message-id:content-transfer-encoding:reply-to
         :x-priority:sensitivity:importance:subject:to:from:date:content-type
         :mime-version;
        b=XDlOj2pJLQwj7lSXyDfTUTDeiqAjGEEy14QqXO4a9uL2dRLn1Oru9wF37mHtXDYajE
         esKwigh3NzxGhZardxCvi+z/ZzCFt1O4AwutU37V3ey45GbuZP/kbU3hZuqMnhz6ukAA
         o+VcV8KShIOxxIczX5dta6a3tPOPu+auLBb7o=
Received: by 10.150.14.8 with SMTP id 8mr3763676ybn.264.1264154674885;
        Fri, 22 Jan 2010 02:04:34 -0800 (PST)
Received: from bda2028.bisx.produk.on.blackberry (bda-68-171-238-23.bise.eu.blackberry.com [68.171.238.23])
        by mx.google.com with ESMTPS id 23sm684059yxe.36.2010.01.22.02.04.33
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 22 Jan 2010 02:04:33 -0800 (PST)
X-rim-org-msg-ref-id:1983265015
Message-ID:<1983265015-1264154671-cardhu_decombobulator_blackberry.rim.net-1749030805-@bda013.bisx.produk.on.blackberry>
Content-Transfer-Encoding: base64
Reply-To: anshumg@gmail.com
X-Priority: Normal
Sensitivity: Normal
Importance: Normal
Subject: Re: Index Growing on Delete
To: java-user@lucene.apache.org
From: "anshum.gupta@naukri.com" <anshumg@gmail.com>
Date: Fri, 22 Jan 2010 10:04:29 +0000
Content-Type: text/plain; charset="Windows-1252"
MIME-Version: 1.0

SGkgSmFtaWUsCllvdSBjb3VsZCB0cnkgYW5kIGRlYnVnIHVzaW5nCkluZGV4UmVhZGVyLm51bURl
bGV0ZWREb2NzKCkgOwpPbiB0aGUgaW5kZXggdG8gY2hlY2sgaWYgdGhlIGRvY3VtZW50cyBhcmUg
ZXhwdW5nZWQgb3Igbm90LgoKLS0tLS0tT3JpZ2luYWwgTWVzc2FnZS0tLS0tLQpGcm9tOiBKYW1p
ZQpUbzogamF2YS11c2VyQGx1Y2VuZS5hcGFjaGUub3JnClJlcGx5VG86IGphdmEtdXNlckBsdWNl
bmUuYXBhY2hlLm9yZwpTdWJqZWN0OiBJbmRleCBHcm93aW5nIG9uIERlbGV0ZQpTZW50OiBKYW4g
MjIsIDIwMTAgMTQ6MDQKCkhpCgpJbiBvdXIgYXBwbGljYXRpb24sb24gYSBwZXJpb2RpYyBiYXNp
cywgZG9jdW1lbnRzIGdldCBkZWxldGVkIGZyb20gdGhlIAppbmRleC4gQWx0aG91Z2ggdGhlIGRl
bGV0ZWQgZG9jdW1lbnRzIGNvcnJlY3RseSBjYW5ub3QgYmUgZm91bmQgd2hlbiAKc2VhcmNoaW5n
IHRoZSBpbmRleCwgb3VyIHVzZXJzIGFyZSBjb21wbGFpbmluZyB0aGF0IHRoZWlyIGhhcmQgZHJp
dmUgaXMgCmZ1bGxpbmcgdXAsIHNpbmNlIHRoZSBpbmRleCBjb250aW51ZXMgdG8gZ3JvdyBpbiBz
aXplIGRlc3BpdGUgdGhlIGZhY3QgCnRoYXQgdGhlIGVudHJpZXMgc2hvdWxkIGJlIGRlbGV0ZWQg
ZnJvbSB0aGUgaW5kZXguIEkgY2Fubm90IHVuZGVyc3RhbmQgCndoeSB0aGlzIGlzIHRoZSBjYXNl
IHNpbmNlIEkgY2FsbCBib3RoIHdyaXRlci5leHB1bmdlRGVsZXRlcyBhbmQgCndyaXRlci5jb21t
aXQoKS4gQW55IGlkZWFzPwoKSGVyZSBpcyBteSBkZWxldGUgZnVuY3Rpb246CgpwdWJsaWMgdm9p
ZCBkZWxldGVEb2NzKFRlcm1bXSB0ZXJtcykgdGhyb3dzIE1lc3NhZ2VTZWFyY2hFeGNlcHRpb24g
ewogICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoImRlbGV0ZSBkb2NzIik7CiAgICAgICAgICAg
ICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICBpbmRleExvY2subG9jaygpOwogICAgICAgICAg
ICAgICAgICAgb3BlbkluZGV4KCk7CiAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAg
ICAgICAgICAgICAgIHdyaXRlci5kZWxldGVEb2N1bWVudHModGVybXMpOwogICAgICAgICAgICAg
ICAgICAgfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICB0aHJv
dyBuZXcgTWVzc2FnZVNlYXJjaEV4Y2VwdGlvbigiZmFpbGVkIHRvIApkZWxldGUgZG9jIGZyb20g
aW5kZXguIitlLmdldE1lc3NhZ2UoKSxlLGxvZ2dlcik7CiAgICAgICAgICAgICAgICAgICB9IGZp
bmFsbHkgewogICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHdyaXRlci5leHB1bmdlRGVsZXRlcyhmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHdyaXRlci5jb21taXQoKTsKICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChF
eGNlcHRpb24gaW8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE1lc3Nh
Z2VTZWFyY2hFeGNlcHRpb24oImZhaWxlZCB0byAKZXhwdW5nZSBkb2NzIGZyb20gaW5kZXgiK2lv
LmdldE1lc3NhZ2UoKSxpbyxsb2dnZXIpOwogICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAg
ICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgfSBjYXRjaCAoVGhyb3dhYmxlIHQpIHsKICAg
ICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcigiZmFpbGVkIHRvIGRlbGV0ZSBkb2NzIGZyb20g
CmluZGV4LiIrdC5nZXRNZXNzYWdlKCksdCk7CiAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAg
ICAgICAgICAgICAgICAgICBpbmRleExvY2sudW5sb2NrKCk7CiAgICAgICAgICAgICAgIH0KfQoK
QXMgYW4gYXNpZGUgbm90ZSwgd2UgYXJlIG1vdmluZyB0byBMdWNlbmUgMy4wIGZyb20gMi45LiBX
aGF0IGlzIHRoZSAKZXF1aXZhbGVudCBvZjoKClF1ZXJ5UGFyc2VyIHF1ZXJ5UGFyc2VyID0gbmV3
IFF1ZXJ5UGFyc2VyKCJib2R5IixhbmFseXplcik7CmFuZCAiRmllbGQuSW5kZXguVE9LRU5JWkVE
Ii4gSWYgSSBjaGFuZ2UgdGhpcywgd2lsbCBteSBpbmRleCBtYWludGFpbiAKY29tcGF0aWJpbGl0
eT8KCgpUaGFua3MKCkphbWllCgoKLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tClRvIHVuc3Vic2NyaWJlLCBlLW1haWw6
IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZwpGb3IgYWRkaXRpb25hbCBj
b21tYW5kcywgZS1tYWlsOiBqYXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZwoKCg0KLS0N
CkFuc2h1bQ0KU2VudCBmcm9tIEJsYWNrQmVycnmu



From java-user-return-44656-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 10:30:09 2010
Return-Path: <java-user-return-44656-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8837 invoked from network); 22 Jan 2010 10:30:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 10:30:08 -0000
Received: (qmail 2159 invoked by uid 500); 22 Jan 2010 10:30:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2077 invoked by uid 500); 22 Jan 2010 10:30:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2067 invoked by uid 99); 22 Jan 2010 10:30:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:30:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:29:57 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 0B2EE45F676
	for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 11:29:35 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id DfoRsApYtpfl for <java-user@lucene.apache.org>;
	Fri, 22 Jan 2010 11:29:24 +0100 (CET)
Received: from VEGA (unknown [134.102.249.74])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 0429C45F675
	for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 11:29:23 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local>
In-Reply-To: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local>
Subject: RE: Applying LUCENE-1606  -- which version
Date: Fri, 22 Jan 2010 11:29:30 +0100
Message-ID: <001301ca9b4d$c89bef10$59d3cd30$@de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
thread-index: AcqbSiugQuWh842RRw6VoFWhct3oWAAABo+AAACoRVA=
Content-Language: de

Hi Sriram,

This patch cannot be applied to 3.0 as it depends on a new Lucene branch =
called flex. It depends on features, only added in version 3.1. So it =
does not even apply on trunk, you have to checkout the experimental flex =
branch first.

For 3.0 you, may try one of the early patches (the last without -flex in =
name) in this issue, but they will never go into lucene 3.1, instead the =
flex branch will hopefully merge with trunk, soon. Also the non-flex =
patches are not so performant, because the performance increases only =
with flexible indexing API.

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Sriram Muthuswamy Chittathoor [mailto:sriramc@ivycomptech.com]
> Sent: Friday, January 22, 2010 11:05 AM
> To: java-user@lucene.apache.org
> Subject: Applying LUCENE-1606 -- which version
>=20
> Hi:
>=20
>=20
>=20
> I am trying to apply this Automata patch on my Lucene 3.0 src code but
> running into issues as it is complaining about failures to apply patch
> to certain files.  Is this the right version
>=20
> To apply to.  Please help
>=20
>=20
>=20
> Thanks
>=20
>=20
>=20
> Sriram C
>=20
>=20
>=20
> LUCENE-1606
> https://issues.apache.org/jira/browse/LUCENE-1606
>=20
>=20
> This email is sent for and on behalf of Ivy Comptech Private Limited.
> Ivy Comptech Private Limited is a limited liability company.
>=20
> This email and any attachments are confidential, and may be legally
> privileged and protected by copyright. If you are not the intended
> recipient dissemination or copying of this email is prohibited. If you
> have received this in error, please notify the sender by replying by
> email and then delete the email completely from your system.
> Any views or opinions are solely those of the sender.  This
> communication is not intended to form a binding contract on behalf of
> Ivy Comptech Private Limited unless expressly indicated to the =
contrary
> and properly authorised. Any actions taken on the basis of this email
> are at the recipient's own risk.
>=20
> Registered office:
> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills,
> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
> Registered in India. A list of members' names is available for
> inspection at the registered office.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44657-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 10:43:08 2010
Return-Path: <java-user-return-44657-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13553 invoked from network); 22 Jan 2010 10:43:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 10:43:08 -0000
Received: (qmail 21301 invoked by uid 500); 22 Jan 2010 10:43:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21233 invoked by uid 500); 22 Jan 2010 10:43:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21223 invoked by uid 99); 22 Jan 2010 10:43:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:43:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of sriramc@ivycomptech.com designates 203.153.210.130 as permitted sender)
Received: from [203.153.210.130] (HELO ivymail.ivycomptech.com) (203.153.210.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:42:55 +0000
Received: from hydsvwin800.ivycomptech.partygaming.local ([10.1.10.46]) by ivymail.ivycomptech.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 22 Jan 2010 16:11:13 +0530
Received: from HYDSVWIN004X.ivycomptech.partygaming.local ([10.1.10.228]) by hydsvwin800.ivycomptech.partygaming.local with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 22 Jan 2010 16:12:07 +0530
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Applying LUCENE-1606  -- which version
Date: Fri, 22 Jan 2010 16:16:29 +0530
Message-ID: <49A7BA114AAC6A48B9C44CB06B7B987E08C12002@HYDSVWIN004X.ivycomptech.partygaming.local>
In-Reply-To: <001301ca9b4d$c89bef10$59d3cd30$@de>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Applying LUCENE-1606  -- which version
Thread-Index: AcqbSiugQuWh842RRw6VoFWhct3oWAAABo+AAACoRVAAAHJ8AA==
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local> <001301ca9b4d$c89bef10$59d3cd30$@de>
From: "Sriram Muthuswamy Chittathoor" <sriramc@ivycomptech.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 22 Jan 2010 10:42:07.0391 (UTC) FILETIME=[8B3812F0:01CA9B4F]
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks for the fast reply. =20
http://svn.apache.org/repos/asf/lucene/java/branches/flex_1458/
I used the one above to checkout.  Hope it is fine.  Will see how it
works out.

My requirement is that I have a index into a DB row (100 million rows).
On some text fields I want to do  contains  search fast.  I hope this
will suit my needs.   Something like   screenName:*poker*



-----Original Message-----
From: Uwe Schindler [mailto:uwe@thetaphi.de]=20
Sent: Friday, January 22, 2010 4:00 PM
To: java-user@lucene.apache.org
Subject: RE: Applying LUCENE-1606 -- which version

Hi Sriram,

This patch cannot be applied to 3.0 as it depends on a new Lucene branch
called flex. It depends on features, only added in version 3.1. So it
does not even apply on trunk, you have to checkout the experimental flex
branch first.

For 3.0 you, may try one of the early patches (the last without -flex in
name) in this issue, but they will never go into lucene 3.1, instead the
flex branch will hopefully merge with trunk, soon. Also the non-flex
patches are not so performant, because the performance increases only
with flexible indexing API.

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Sriram Muthuswamy Chittathoor [mailto:sriramc@ivycomptech.com]
> Sent: Friday, January 22, 2010 11:05 AM
> To: java-user@lucene.apache.org
> Subject: Applying LUCENE-1606 -- which version
>=20
> Hi:
>=20
>=20
>=20
> I am trying to apply this Automata patch on my Lucene 3.0 src code but
> running into issues as it is complaining about failures to apply patch
> to certain files.  Is this the right version
>=20
> To apply to.  Please help
>=20
>=20
>=20
> Thanks
>=20
>=20
>=20
> Sriram C
>=20
>=20
>=20
> LUCENE-1606
> https://issues.apache.org/jira/browse/LUCENE-1606
>=20
>=20
> This email is sent for and on behalf of Ivy Comptech Private Limited.
> Ivy Comptech Private Limited is a limited liability company.
>=20
> This email and any attachments are confidential, and may be legally
> privileged and protected by copyright. If you are not the intended
> recipient dissemination or copying of this email is prohibited. If you
> have received this in error, please notify the sender by replying by
> email and then delete the email completely from your system.
> Any views or opinions are solely those of the sender.  This
> communication is not intended to form a binding contract on behalf of
> Ivy Comptech Private Limited unless expressly indicated to the
contrary
> and properly authorised. Any actions taken on the basis of this email
> are at the recipient's own risk.
>=20
> Registered office:
> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills,
> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
> Registered in India. A list of members' names is available for
> inspection at the registered office.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44658-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 10:50:59 2010
Return-Path: <java-user-return-44658-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16605 invoked from network); 22 Jan 2010 10:50:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 10:50:59 -0000
Received: (qmail 32695 invoked by uid 500); 22 Jan 2010 10:50:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32626 invoked by uid 500); 22 Jan 2010 10:50:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32616 invoked by uid 99); 22 Jan 2010 10:50:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:50:57 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 10:50:50 +0000
Received: by bwz22 with SMTP id 22so993942bwz.5
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 02:50:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=waal0AiTqw/I9pvp29uWrockXckYhqjbcQHSU8dFPj8=;
        b=J/U5CaQg2ay1tgKS+PVuy+vbgbqZp1Yg5k7LiPzL6kox1fv7ohmTkesHAhDIKO5mGI
         7w8DFU5QVX4VKkdlrxdlP1qO7UIbu/J5tuYRApNleGqHv8MA9Vs6hB2MrfXxyftcouR8
         at0ByAj60Dn6pwsRFm9TjunpFLWtbvMAIfS28=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=CSnMOsFMNxkxXBAUKVrplH1wXq08pwO00BCH0JSOjkg0QCiF7wuC1hztrb/I5tBbK6
         /6Qa/5uVSKzUWTHb298YSNv1fIT2jvCwQFxjjdbh3TRtZw8gsptMRYIJ3OtGn91ifRvF
         ktQmvVjULbBp98g1lC2LelbqQBCPJbOZuu9b0=
MIME-Version: 1.0
Received: by 10.204.156.195 with SMTP id y3mr1511709bkw.46.1264157429156; Fri, 
	22 Jan 2010 02:50:29 -0800 (PST)
In-Reply-To: <1983265015-1264154671-cardhu_decombobulator_blackberry.rim.net-1749030805-@bda013.bisx.produk.on.blackberry>
References: <1983265015-1264154671-cardhu_decombobulator_blackberry.rim.net-1749030805-@bda013.bisx.produk.on.blackberry>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 22 Jan 2010 10:50:09 +0000
Message-ID: <8c4e68611001220250r754a3f8bga73e40f59646d968@mail.gmail.com>
Subject: Re: Index Growing on Delete
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

You could also try swapping the order of your commit and expunge
calls.  The javadocs for expungeDeletes says:

Note that this call does not first commit any buffered documents, so
you must do so yourself if necessary.


--
Ian.

On Fri, Jan 22, 2010 at 10:04 AM, anshum.gupta@naukri.com
<anshumg@gmail.com> wrote:
> Hi Jamie,
> You could try and debug using
> IndexReader.numDeletedDocs() ;
> On the index to check if the documents are expunged or not.
>
> ------Original Message------
> From: Jamie
> To: java-user@lucene.apache.org
> ReplyTo: java-user@lucene.apache.org
> Subject: Index Growing on Delete
> Sent: Jan 22, 2010 14:04
>
> Hi
>
> In our application,on a periodic basis, documents get deleted from the
> index. Although the deleted documents correctly cannot be found when
> searching the index, our users are complaining that their hard drive is
> fulling up, since the index continues to grow in size despite the fact
> that the entries should be deleted from the index. I cannot understand
> why this is the case since I call both writer.expungeDeletes and
> writer.commit(). Any ideas?
>
> Here is my delete function:
>
> public void deleteDocs(Term[] terms) throws MessageSearchException {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 logger.debug("delete docs");
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 indexLock.lock();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 openIndex();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 writer.deleteDocuments(terms)=
;
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 } catch (Exception e) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 throw new MessageSearchExcept=
ion("failed to
> delete doc from index."+e.getMessage(),e,logger);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 } finally {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 try {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 writer.expungeDeletes=
(false);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 writer.commit();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 } catch (Exception io) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 throw new MessageSear=
chException("failed to
> expunge docs from index"+io.getMessage(),io,logger);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 }
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 }
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 } catch (Throwable t) {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 logger.error("failed to delete docs f=
rom
> index."+t.getMessage(),t);
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 } finally {
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 indexLock.unlock();
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 }
> }
>
> As an aside note, we are moving to Lucene 3.0 from 2.9. What is the
> equivalent of:
>
> QueryParser queryParser =3D new QueryParser("body",analyzer);
> and "Field.Index.TOKENIZED". If I change this, will my index maintain
> compatibility?
>
>
> Thanks
>
> Jamie
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
> --
> Anshum
> Sent from BlackBerry=AE

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44659-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 12:40:56 2010
Return-Path: <java-user-return-44659-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56837 invoked from network); 22 Jan 2010 12:40:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 12:40:56 -0000
Received: (qmail 31796 invoked by uid 500); 22 Jan 2010 12:40:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31714 invoked by uid 500); 22 Jan 2010 12:40:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31704 invoked by uid 99); 22 Jan 2010 12:40:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 12:40:54 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of paul_t100@fastmail.fm designates 66.111.4.26 as permitted sender)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 12:40:45 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by gateway1.messagingengine.com (Postfix) with ESMTP id E35F0CE043
	for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 07:40:24 -0500 (EST)
Received: from heartbeat1.messagingengine.com ([10.202.2.160])
  by compute1.internal (MEProxy); Fri, 22 Jan 2010 07:40:24 -0500
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=messagingengine.com; h=message-id:date:from:reply-to:mime-version:to:subject:content-type:content-transfer-encoding; s=smtpout; bh=SMz0MjVz2zSPmZbteNjKs8j/JvU=; b=LEpaUSUzWyGsBpFc/UfQ40HNxECSAcNOMDeKFMV1g4f1RpghTCDEilzQU7/3Npjq1PEvKhxH5erHWVJqKAmW4ESg0pmii7MoFV57I3B39UkvZIAoalIDghfUyuujXjCrMIcC2eNCDYVs2gb7XnGUiCOJS2vqvFkrrmf45btlGzQ=
X-Sasl-enc: Fj0grFiXAhDE3zVmYUXWotbHZfoY8cvbo3p0ILFqkjVM 1264164024
Received: from [192.168.1.65] (unknown [217.155.98.246])
	by mail.messagingengine.com (Postfix) with ESMTPA id 21D7C4BAADA
	for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 07:40:24 -0500 (EST)
Message-ID: <4B599CB7.7040700@fastmail.fm>
Date: Fri, 22 Jan 2010 12:40:23 +0000
From: Paul Taylor <paul_t100@fastmail.fm>
Reply-To: paul_t100@fastmail.fm
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Can tf() field access the field it is being used for ?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi, Im trying to override the Similarity lengthNorm() and tf() methods, 
but I only want to override for particular index fields, lengthNorm() is 
fine but tf() doesn't provide the fieldname as a parameter, so Im a bit 
stuck - is there anyway round this.

Here is my code, which doesnt compile because fieldname field doesnt 
exist in tf() method

package org.musicbrainz.search.analysis;

import org.apache.lucene.search.DefaultSimilarity;

public class MusicbrainzSimilarity extends DefaultSimilarity {


    @Override
    public float lengthNorm(String fieldName, int numTerms) {

        //This will match both artist and label aliases and is 
applicable to both, didn't use the constant
        //ArtistIndexField.ALIAS because that would be confusing
        if (fieldName.equals("alias")) {
            return 0.71f; //Same result as normal calc if field had two 
terms the most common scenario
        } else {
            return super.lengthNorm(fieldName, numTerms);
        }
    }

   
     @Override
     public float tf(float freq) {

       if(fieldName.equals("alias")) {  /************** FIELDNAME DOESNT 
EXIST
         if(freq > 1.0f) {
             return 1.0f; //Same result as if matched term once
         }
       } else {
            return (float)Math.sqrt(freq);
       }
     }
}

FYI:
Each document represents a recording artist (i.e Madonna, U2)
 
An artist has one artistname , and may have many artist aliases, with 
the DefaultSimilarity implemenataion I hit two problems.

1. LengthNorm() sees all the aliases to one artist as one field, so an 
artist with many aliases but just matching one will return a much lower 
value for a match on an alias, then one which has few aliases. I wanted 
to remove this bias so I override to treat all alias fields as if they 
have two terms (Originally I just disabled norms for the alias field but 
the default value of 1.0f gave aliases an advantage over the artist field)

2. Tf() If seaching for an artist by artist or alias (i.e artist:bach OR 
alias:bach ) - and one artist has many aliases that match the search 
term  this will return a large tf() values easily beating another artist 
that matches exactly on artist name but doesnt happen to have
any aliases. So I want to remove this bias by just returning a tf() of 
1.0f for a matching alias, so having multiple aliases isn't an advantage.

thanks  Paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44660-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 13:17:35 2010
Return-Path: <java-user-return-44660-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67960 invoked from network); 22 Jan 2010 13:17:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 13:17:34 -0000
Received: (qmail 69124 invoked by uid 500); 22 Jan 2010 13:17:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69045 invoked by uid 500); 22 Jan 2010 13:17:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69035 invoked by uid 99); 22 Jan 2010 13:17:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:17:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.222.183 as permitted sender)
Received: from [209.85.222.183] (HELO mail-pz0-f183.google.com) (209.85.222.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:17:22 +0000
Received: by pzk13 with SMTP id 13so100833pzk.29
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 05:17:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=6w5JYXTpeoTeb8nebqCBu1S1vaHgwqk+P82U56zNPFU=;
        b=NSsIZUpeFkNqf9qLzEjBb8Hx/d48pshYs3mRvK8FRiUKajbmMZOg3WI1Q7jvXivKYM
         6aWNdxjVAdVZq88B7aL6CqUpasxEgiL5odVIWwfBRScSsjfRADMwSYR9GKghn2LbjO/U
         Q3BYCRoQml7JUxePCm2yw1Ki0qYjHq+UW6W8U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=PGJUapNjpOQ6lu3ZhX7qERci+wkTXVj8lbFTr11m/IGkJVFOjtn0KNqZXjjrzk9y1V
         wEjN8j0rWQncljxCtWM9ewUonrqhB4v+sWcPp08wpFeTzK9HRaNWinNIyuDqQDOlQZuZ
         xPLMjp8Q26468hbhugemU+QMcp9ISKpxQh3hQ=
MIME-Version: 1.0
Received: by 10.114.45.8 with SMTP id s8mr2000520was.85.1264166219065; Fri, 22 
	Jan 2010 05:16:59 -0800 (PST)
In-Reply-To: <49A7BA114AAC6A48B9C44CB06B7B987E08C12002@HYDSVWIN004X.ivycomptech.partygaming.local>
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local> 
	<001301ca9b4d$c89bef10$59d3cd30$@de> <49A7BA114AAC6A48B9C44CB06B7B987E08C12002@HYDSVWIN004X.ivycomptech.partygaming.local>
From: Robert Muir <rcmuir@gmail.com>
Date: Fri, 22 Jan 2010 08:16:39 -0500
Message-ID: <8f0ad1f31001220516j4d513d6fj8eaf603f2a4cdd21@mail.gmail.com>
Subject: Re: Applying LUCENE-1606 -- which version
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

the patch won't especially help queries like this. maybe they will be
5 or 6 times faster, but still slow.

if you really want to do such queries, consider this: do you really
need * to match an INFINITE amount of characters?!?!

If not, then consider rewriting input queries like this into FINITE
RegExpQuerys, something like .{0,3}poker.* at least, where the first
component can only match at most 3 of any character, before it must be
a p.
you can tweak the 'parameter' 3 until its a reasonable tradeoff
between relevance and performance.

if, on the other hand, you have 100 million rows and feel its
mandatory that * matches an infinite amount of characters in this
case, then I recommend storing your data in a different structure that
will support such queries.

On Fri, Jan 22, 2010 at 5:46 AM, Sriram Muthuswamy Chittathoor
<sriramc@ivycomptech.com> wrote:
> Thanks for the fast reply.
> http://svn.apache.org/repos/asf/lucene/java/branches/flex_1458/
> I used the one above to checkout. =C2=A0Hope it is fine. =C2=A0Will see h=
ow it
> works out.
>
> My requirement is that I have a index into a DB row (100 million rows).
> On some text fields I want to do =C2=A0contains =C2=A0search fast. =C2=A0=
I hope this
> will suit my needs. =C2=A0 Something like =C2=A0 screenName:*poker*
>
>
>
> -----Original Message-----
> From: Uwe Schindler [mailto:uwe@thetaphi.de]
> Sent: Friday, January 22, 2010 4:00 PM
> To: java-user@lucene.apache.org
> Subject: RE: Applying LUCENE-1606 -- which version
>
> Hi Sriram,
>
> This patch cannot be applied to 3.0 as it depends on a new Lucene branch
> called flex. It depends on features, only added in version 3.1. So it
> does not even apply on trunk, you have to checkout the experimental flex
> branch first.
>
> For 3.0 you, may try one of the early patches (the last without -flex in
> name) in this issue, but they will never go into lucene 3.1, instead the
> flex branch will hopefully merge with trunk, soon. Also the non-flex
> patches are not so performant, because the performance increases only
> with flexible indexing API.
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>> -----Original Message-----
>> From: Sriram Muthuswamy Chittathoor [mailto:sriramc@ivycomptech.com]
>> Sent: Friday, January 22, 2010 11:05 AM
>> To: java-user@lucene.apache.org
>> Subject: Applying LUCENE-1606 -- which version
>>
>> Hi:
>>
>>
>>
>> I am trying to apply this Automata patch on my Lucene 3.0 src code but
>> running into issues as it is complaining about failures to apply patch
>> to certain files. =C2=A0Is this the right version
>>
>> To apply to. =C2=A0Please help
>>
>>
>>
>> Thanks
>>
>>
>>
>> Sriram C
>>
>>
>>
>> LUCENE-1606
>> https://issues.apache.org/jira/browse/LUCENE-1606
>>
>>
>> This email is sent for and on behalf of Ivy Comptech Private Limited.
>> Ivy Comptech Private Limited is a limited liability company.
>>
>> This email and any attachments are confidential, and may be legally
>> privileged and protected by copyright. If you are not the intended
>> recipient dissemination or copying of this email is prohibited. If you
>> have received this in error, please notify the sender by replying by
>> email and then delete the email completely from your system.
>> Any views or opinions are solely those of the sender. =C2=A0This
>> communication is not intended to form a binding contract on behalf of
>> Ivy Comptech Private Limited unless expressly indicated to the
> contrary
>> and properly authorised. Any actions taken on the basis of this email
>> are at the recipient's own risk.
>>
>> Registered office:
>> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills,
>> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
>> Registered in India. A list of members' names is available for
>> inspection at the registered office.
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44661-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 13:24:57 2010
Return-Path: <java-user-return-44661-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70397 invoked from network); 22 Jan 2010 13:24:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 13:24:57 -0000
Received: (qmail 78989 invoked by uid 500); 22 Jan 2010 13:24:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78891 invoked by uid 500); 22 Jan 2010 13:24:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78881 invoked by uid 99); 22 Jan 2010 13:24:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:24:54 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of sriramc@ivycomptech.com designates 203.153.210.130 as permitted sender)
Received: from [203.153.210.130] (HELO ivymail.ivycomptech.com) (203.153.210.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:24:45 +0000
Received: from hydsvwin800.ivycomptech.partygaming.local ([10.1.10.46]) by ivymail.ivycomptech.com with Microsoft SMTPSVC(6.0.3790.3959); Fri, 22 Jan 2010 18:53:02 +0530
Received: from HYDSVWIN004X.ivycomptech.partygaming.local ([10.1.10.228]) by hydsvwin800.ivycomptech.partygaming.local with Microsoft SMTPSVC(6.0.3790.3959); Fri, 22 Jan 2010 18:53:55 +0530
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.4073
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Applying LUCENE-1606 -- which version
Date: Fri, 22 Jan 2010 18:58:32 +0530
Message-ID: <49A7BA114AAC6A48B9C44CB06B7B987E08C91BF9@HYDSVWIN004X.ivycomptech.partygaming.local>
In-Reply-To: <8f0ad1f31001220516j4d513d6fj8eaf603f2a4cdd21@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Applying LUCENE-1606 -- which version
thread-index: AcqbZUccYwShQp/YTcW8Z1M7u1vjpQAAWugw
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local> <001301ca9b4d$c89bef10$59d3cd30$@de> <49A7BA114AAC6A48B9C44CB06B7B987E08C12002@HYDSVWIN004X.ivycomptech.partygaming.local> <8f0ad1f31001220516j4d513d6fj8eaf603f2a4cdd21@mail.gmail.com>
From: "Sriram Muthuswamy Chittathoor" <sriramc@ivycomptech.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 22 Jan 2010 13:23:55.0875 (UTC) FILETIME=[25ED2B30:01CA9B66]

then I recommend storing your data in a different structure that
will support such queries.
--  what would this structure be ?  Is this to be done through Lucene.

-----Original Message-----
From: Robert Muir [mailto:rcmuir@gmail.com]=20
Sent: Friday, January 22, 2010 6:47 PM
To: java-user@lucene.apache.org
Subject: Re: Applying LUCENE-1606 -- which version

the patch won't especially help queries like this. maybe they will be
5 or 6 times faster, but still slow.

if you really want to do such queries, consider this: do you really
need * to match an INFINITE amount of characters?!?!

If not, then consider rewriting input queries like this into FINITE
RegExpQuerys, something like .{0,3}poker.* at least, where the first
component can only match at most 3 of any character, before it must be
a p.
you can tweak the 'parameter' 3 until its a reasonable tradeoff
between relevance and performance.

if, on the other hand, you have 100 million rows and feel its
mandatory that * matches an infinite amount of characters in this
case, then I recommend storing your data in a different structure that
will support such queries.

On Fri, Jan 22, 2010 at 5:46 AM, Sriram Muthuswamy Chittathoor
<sriramc@ivycomptech.com> wrote:
> Thanks for the fast reply.
> http://svn.apache.org/repos/asf/lucene/java/branches/flex_1458/
> I used the one above to checkout. =A0Hope it is fine. =A0Will see how =
it
> works out.
>
> My requirement is that I have a index into a DB row (100 million =
rows).
> On some text fields I want to do =A0contains =A0search fast. =A0I hope =
this
> will suit my needs. =A0 Something like =A0 screenName:*poker*
>
>
>
> -----Original Message-----
> From: Uwe Schindler [mailto:uwe@thetaphi.de]
> Sent: Friday, January 22, 2010 4:00 PM
> To: java-user@lucene.apache.org
> Subject: RE: Applying LUCENE-1606 -- which version
>
> Hi Sriram,
>
> This patch cannot be applied to 3.0 as it depends on a new Lucene =
branch
> called flex. It depends on features, only added in version 3.1. So it
> does not even apply on trunk, you have to checkout the experimental =
flex
> branch first.
>
> For 3.0 you, may try one of the early patches (the last without -flex =
in
> name) in this issue, but they will never go into lucene 3.1, instead =
the
> flex branch will hopefully merge with trunk, soon. Also the non-flex
> patches are not so performant, because the performance increases only
> with flexible indexing API.
>
> Uwe
>
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>
>> -----Original Message-----
>> From: Sriram Muthuswamy Chittathoor [mailto:sriramc@ivycomptech.com]
>> Sent: Friday, January 22, 2010 11:05 AM
>> To: java-user@lucene.apache.org
>> Subject: Applying LUCENE-1606 -- which version
>>
>> Hi:
>>
>>
>>
>> I am trying to apply this Automata patch on my Lucene 3.0 src code =
but
>> running into issues as it is complaining about failures to apply =
patch
>> to certain files. =A0Is this the right version
>>
>> To apply to. =A0Please help
>>
>>
>>
>> Thanks
>>
>>
>>
>> Sriram C
>>
>>
>>
>> LUCENE-1606
>> https://issues.apache.org/jira/browse/LUCENE-1606
>>
>>
>> This email is sent for and on behalf of Ivy Comptech Private Limited.
>> Ivy Comptech Private Limited is a limited liability company.
>>
>> This email and any attachments are confidential, and may be legally
>> privileged and protected by copyright. If you are not the intended
>> recipient dissemination or copying of this email is prohibited. If =
you
>> have received this in error, please notify the sender by replying by
>> email and then delete the email completely from your system.
>> Any views or opinions are solely those of the sender. =A0This
>> communication is not intended to form a binding contract on behalf of
>> Ivy Comptech Private Limited unless expressly indicated to the
> contrary
>> and properly authorised. Any actions taken on the basis of this email
>> are at the recipient's own risk.
>>
>> Registered office:
>> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara =
Hills,
>> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
>> Registered in India. A list of members' names is available for
>> inspection at the registered office.
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


This email is sent for and on behalf of Ivy Comptech Private Limited. =
Ivy Comptech Private Limited is a limited liability company. =20

This email and any attachments are confidential, and may be legally =
privileged and protected by copyright. If you are not the intended =
recipient dissemination or copying of this email is prohibited. If you =
have received this in error, please notify the sender by replying by =
email and then delete the email completely from your system.=20
Any views or opinions are solely those of the sender.  This =
communication is not intended to form a binding contract on behalf of =
Ivy Comptech Private Limited unless expressly indicated to the contrary =
and properly authorised. Any actions taken on the basis of this email =
are at the recipient's own risk.

Registered office:
Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills, =
Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994. =
Registered in India. A list of members' names is available for =
inspection at the registered office.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44662-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 13:31:40 2010
Return-Path: <java-user-return-44662-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74980 invoked from network); 22 Jan 2010 13:31:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 13:31:40 -0000
Received: (qmail 90214 invoked by uid 500); 22 Jan 2010 13:31:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90148 invoked by uid 500); 22 Jan 2010 13:31:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90138 invoked by uid 99); 22 Jan 2010 13:31:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:31:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:31:29 +0000
Received: by pwi11 with SMTP id 11so809117pwi.5
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 05:31:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=kWKCvMpR4dpZew7t9TFMTl5TQ+n8+/baNpgkgD0v69Q=;
        b=DVS5ksGyq/+TrGaM3VUgpxX4zx3Pcfijl5SM2n1SgWkYsKP0KPWyItSS0jwmsnsfRP
         mb3FFMT6ZrWKfrE2rNYY6TSrI/8W69Ej8KTWTnRawlg3pjanjoQA6eb019m7jQqdaAvG
         ZopBCU0oGV5OJl+UzdbhlqKRr7JrU0tos1AOM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=Nu1gwIXRliNc8Y6sMTVnR2yimCEGOzLztJMjjPtAPIazigarOd5fKMaKnJpU/QalRA
         NTBJBSxR8fCIxmQHd4/Otqhm31QKLuQy1KgQci8O0aGoOSFxbC1SspxJ+sLiyZIiKEGf
         IXFzq0fz9EL5v2RNZaV54an/3xteOLwByvHr8=
MIME-Version: 1.0
Received: by 10.115.116.37 with SMTP id t37mr1934596wam.228.1264167069110; 
	Fri, 22 Jan 2010 05:31:09 -0800 (PST)
In-Reply-To: <49A7BA114AAC6A48B9C44CB06B7B987E08C91BF9@HYDSVWIN004X.ivycomptech.partygaming.local>
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local> 
	<001301ca9b4d$c89bef10$59d3cd30$@de> <49A7BA114AAC6A48B9C44CB06B7B987E08C12002@HYDSVWIN004X.ivycomptech.partygaming.local> 
	<8f0ad1f31001220516j4d513d6fj8eaf603f2a4cdd21@mail.gmail.com> 
	<49A7BA114AAC6A48B9C44CB06B7B987E08C91BF9@HYDSVWIN004X.ivycomptech.partygaming.local>
From: Robert Muir <rcmuir@gmail.com>
Date: Fri, 22 Jan 2010 08:30:49 -0500
Message-ID: <8f0ad1f31001220530g3b25b1cclbb3f68e4c03bf3ea@mail.gmail.com>
Subject: Re: Applying LUCENE-1606 -- which version
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

the first step if determining why you really need to support *poker*
on 100M database rows, is it some programmers fault, or are users
directly typing this in?

Either can probably re-trained, perhaps you should do like google, and
drop these characters from users queries if they do this...

On Fri, Jan 22, 2010 at 8:28 AM, Sriram Muthuswamy Chittathoor
<sriramc@ivycomptech.com> wrote:
> then I recommend storing your data in a different structure that
> will support such queries.
> -- =C2=A0what would this structure be ? =C2=A0Is this to be done through =
Lucene.
>
> -----Original Message-----
> From: Robert Muir [mailto:rcmuir@gmail.com]
> Sent: Friday, January 22, 2010 6:47 PM
> To: java-user@lucene.apache.org
> Subject: Re: Applying LUCENE-1606 -- which version
>
> the patch won't especially help queries like this. maybe they will be
> 5 or 6 times faster, but still slow.
>
> if you really want to do such queries, consider this: do you really
> need * to match an INFINITE amount of characters?!?!
>
> If not, then consider rewriting input queries like this into FINITE
> RegExpQuerys, something like .{0,3}poker.* at least, where the first
> component can only match at most 3 of any character, before it must be
> a p.
> you can tweak the 'parameter' 3 until its a reasonable tradeoff
> between relevance and performance.
>
> if, on the other hand, you have 100 million rows and feel its
> mandatory that * matches an infinite amount of characters in this
> case, then I recommend storing your data in a different structure that
> will support such queries.
>
> On Fri, Jan 22, 2010 at 5:46 AM, Sriram Muthuswamy Chittathoor
> <sriramc@ivycomptech.com> wrote:
>> Thanks for the fast reply.
>> http://svn.apache.org/repos/asf/lucene/java/branches/flex_1458/
>> I used the one above to checkout. =C2=A0Hope it is fine. =C2=A0Will see =
how it
>> works out.
>>
>> My requirement is that I have a index into a DB row (100 million rows).
>> On some text fields I want to do =C2=A0contains =C2=A0search fast. =C2=
=A0I hope this
>> will suit my needs. =C2=A0 Something like =C2=A0 screenName:*poker*
>>
>>
>>
>> -----Original Message-----
>> From: Uwe Schindler [mailto:uwe@thetaphi.de]
>> Sent: Friday, January 22, 2010 4:00 PM
>> To: java-user@lucene.apache.org
>> Subject: RE: Applying LUCENE-1606 -- which version
>>
>> Hi Sriram,
>>
>> This patch cannot be applied to 3.0 as it depends on a new Lucene branch
>> called flex. It depends on features, only added in version 3.1. So it
>> does not even apply on trunk, you have to checkout the experimental flex
>> branch first.
>>
>> For 3.0 you, may try one of the early patches (the last without -flex in
>> name) in this issue, but they will never go into lucene 3.1, instead the
>> flex branch will hopefully merge with trunk, soon. Also the non-flex
>> patches are not so performant, because the performance increases only
>> with flexible indexing API.
>>
>> Uwe
>>
>> -----
>> Uwe Schindler
>> H.-H.-Meier-Allee 63, D-28213 Bremen
>> http://www.thetaphi.de
>> eMail: uwe@thetaphi.de
>>
>>> -----Original Message-----
>>> From: Sriram Muthuswamy Chittathoor [mailto:sriramc@ivycomptech.com]
>>> Sent: Friday, January 22, 2010 11:05 AM
>>> To: java-user@lucene.apache.org
>>> Subject: Applying LUCENE-1606 -- which version
>>>
>>> Hi:
>>>
>>>
>>>
>>> I am trying to apply this Automata patch on my Lucene 3.0 src code but
>>> running into issues as it is complaining about failures to apply patch
>>> to certain files. =C2=A0Is this the right version
>>>
>>> To apply to. =C2=A0Please help
>>>
>>>
>>>
>>> Thanks
>>>
>>>
>>>
>>> Sriram C
>>>
>>>
>>>
>>> LUCENE-1606
>>> https://issues.apache.org/jira/browse/LUCENE-1606
>>>
>>>
>>> This email is sent for and on behalf of Ivy Comptech Private Limited.
>>> Ivy Comptech Private Limited is a limited liability company.
>>>
>>> This email and any attachments are confidential, and may be legally
>>> privileged and protected by copyright. If you are not the intended
>>> recipient dissemination or copying of this email is prohibited. If you
>>> have received this in error, please notify the sender by replying by
>>> email and then delete the email completely from your system.
>>> Any views or opinions are solely those of the sender. =C2=A0This
>>> communication is not intended to form a binding contract on behalf of
>>> Ivy Comptech Private Limited unless expressly indicated to the
>> contrary
>>> and properly authorised. Any actions taken on the basis of this email
>>> are at the recipient's own risk.
>>>
>>> Registered office:
>>> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills,
>>> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
>>> Registered in India. A list of members' names is available for
>>> inspection at the registered office.
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> This email is sent for and on behalf of Ivy Comptech Private Limited. Ivy=
 Comptech Private Limited is a limited liability company.
>
> This email and any attachments are confidential, and may be legally privi=
leged and protected by copyright. If you are not the intended recipient dis=
semination or copying of this email is prohibited. If you have received thi=
s in error, please notify the sender by replying by email and then delete t=
he email completely from your system.
> Any views or opinions are solely those of the sender. =C2=A0This communic=
ation is not intended to form a binding contract on behalf of Ivy Comptech =
Private Limited unless expressly indicated to the contrary and properly aut=
horised. Any actions taken on the basis of this email are at the recipient'=
s own risk.
>
> Registered office:
> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills, Hy=
derabad 500 033, Andhra Pradesh, India. Registered number: 37994. Registere=
d in India. A list of members' names is available for inspection at the reg=
istered office.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44663-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 13:38:15 2010
Return-Path: <java-user-return-44663-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78569 invoked from network); 22 Jan 2010 13:38:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 13:38:15 -0000
Received: (qmail 95402 invoked by uid 500); 22 Jan 2010 13:38:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95324 invoked by uid 500); 22 Jan 2010 13:38:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95314 invoked by uid 99); 22 Jan 2010 13:38:13 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:38:13 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of sriramc@ivycomptech.com designates 203.153.210.130 as permitted sender)
Received: from [203.153.210.130] (HELO ivymail.ivycomptech.com) (203.153.210.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:38:02 +0000
Received: from hydsvwin800.ivycomptech.partygaming.local ([10.1.10.46]) by ivymail.ivycomptech.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 22 Jan 2010 19:06:19 +0530
Received: from HYDSVWIN004X.ivycomptech.partygaming.local ([10.1.10.228]) by hydsvwin800.ivycomptech.partygaming.local with Microsoft SMTPSVC(6.0.3790.3959);
	 Fri, 22 Jan 2010 19:07:13 +0530
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Applying LUCENE-1606 -- which version
Date: Fri, 22 Jan 2010 19:11:48 +0530
Message-ID: <49A7BA114AAC6A48B9C44CB06B7B987E08C91C15@HYDSVWIN004X.ivycomptech.partygaming.local>
In-Reply-To: <8f0ad1f31001220530g3b25b1cclbb3f68e4c03bf3ea@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Applying LUCENE-1606 -- which version
Thread-Index: AcqbZ0342peEaUFZQHGP7vJH6NF+XQAALWgg
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local> <001301ca9b4d$c89bef10$59d3cd30$@de> <49A7BA114AAC6A48B9C44CB06B7B987E08C12002@HYDSVWIN004X.ivycomptech.partygaming.local> <8f0ad1f31001220516j4d513d6fj8eaf603f2a4cdd21@mail.gmail.com> <49A7BA114AAC6A48B9C44CB06B7B987E08C91BF9@HYDSVWIN004X.ivycomptech.partygaming.local> <8f0ad1f31001220530g3b25b1cclbb3f68e4c03bf3ea@mail.gmail.com>
From: "Sriram Muthuswamy Chittathoor" <sriramc@ivycomptech.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 22 Jan 2010 13:37:13.0031 (UTC) FILETIME=[01118570:01CA9B68]
X-Virus-Checked: Checked by ClamAV on apache.org

Okay the only reason I asked was to support contains clause.  But it =
could be relaxed if it is causing a issue and we could support those =
.{0,3}poker.* fast. =20



-----Original Message-----
From: Robert Muir [mailto:rcmuir@gmail.com]=20
Sent: Friday, January 22, 2010 7:01 PM
To: java-user@lucene.apache.org
Subject: Re: Applying LUCENE-1606 -- which version

the first step if determining why you really need to support *poker*
on 100M database rows, is it some programmers fault, or are users
directly typing this in?

Either can probably re-trained, perhaps you should do like google, and
drop these characters from users queries if they do this...

On Fri, Jan 22, 2010 at 8:28 AM, Sriram Muthuswamy Chittathoor
<sriramc@ivycomptech.com> wrote:
> then I recommend storing your data in a different structure that
> will support such queries.
> -- =A0what would this structure be ? =A0Is this to be done through =
Lucene.
>
> -----Original Message-----
> From: Robert Muir [mailto:rcmuir@gmail.com]
> Sent: Friday, January 22, 2010 6:47 PM
> To: java-user@lucene.apache.org
> Subject: Re: Applying LUCENE-1606 -- which version
>
> the patch won't especially help queries like this. maybe they will be
> 5 or 6 times faster, but still slow.
>
> if you really want to do such queries, consider this: do you really
> need * to match an INFINITE amount of characters?!?!
>
> If not, then consider rewriting input queries like this into FINITE
> RegExpQuerys, something like .{0,3}poker.* at least, where the first
> component can only match at most 3 of any character, before it must be
> a p.
> you can tweak the 'parameter' 3 until its a reasonable tradeoff
> between relevance and performance.
>
> if, on the other hand, you have 100 million rows and feel its
> mandatory that * matches an infinite amount of characters in this
> case, then I recommend storing your data in a different structure that
> will support such queries.
>
> On Fri, Jan 22, 2010 at 5:46 AM, Sriram Muthuswamy Chittathoor
> <sriramc@ivycomptech.com> wrote:
>> Thanks for the fast reply.
>> http://svn.apache.org/repos/asf/lucene/java/branches/flex_1458/
>> I used the one above to checkout. =A0Hope it is fine. =A0Will see how =
it
>> works out.
>>
>> My requirement is that I have a index into a DB row (100 million =
rows).
>> On some text fields I want to do =A0contains =A0search fast. =A0I =
hope this
>> will suit my needs. =A0 Something like =A0 screenName:*poker*
>>
>>
>>
>> -----Original Message-----
>> From: Uwe Schindler [mailto:uwe@thetaphi.de]
>> Sent: Friday, January 22, 2010 4:00 PM
>> To: java-user@lucene.apache.org
>> Subject: RE: Applying LUCENE-1606 -- which version
>>
>> Hi Sriram,
>>
>> This patch cannot be applied to 3.0 as it depends on a new Lucene =
branch
>> called flex. It depends on features, only added in version 3.1. So it
>> does not even apply on trunk, you have to checkout the experimental =
flex
>> branch first.
>>
>> For 3.0 you, may try one of the early patches (the last without -flex =
in
>> name) in this issue, but they will never go into lucene 3.1, instead =
the
>> flex branch will hopefully merge with trunk, soon. Also the non-flex
>> patches are not so performant, because the performance increases only
>> with flexible indexing API.
>>
>> Uwe
>>
>> -----
>> Uwe Schindler
>> H.-H.-Meier-Allee 63, D-28213 Bremen
>> http://www.thetaphi.de
>> eMail: uwe@thetaphi.de
>>
>>> -----Original Message-----
>>> From: Sriram Muthuswamy Chittathoor [mailto:sriramc@ivycomptech.com]
>>> Sent: Friday, January 22, 2010 11:05 AM
>>> To: java-user@lucene.apache.org
>>> Subject: Applying LUCENE-1606 -- which version
>>>
>>> Hi:
>>>
>>>
>>>
>>> I am trying to apply this Automata patch on my Lucene 3.0 src code =
but
>>> running into issues as it is complaining about failures to apply =
patch
>>> to certain files. =A0Is this the right version
>>>
>>> To apply to. =A0Please help
>>>
>>>
>>>
>>> Thanks
>>>
>>>
>>>
>>> Sriram C
>>>
>>>
>>>
>>> LUCENE-1606
>>> https://issues.apache.org/jira/browse/LUCENE-1606
>>>
>>>
>>> This email is sent for and on behalf of Ivy Comptech Private =
Limited.
>>> Ivy Comptech Private Limited is a limited liability company.
>>>
>>> This email and any attachments are confidential, and may be legally
>>> privileged and protected by copyright. If you are not the intended
>>> recipient dissemination or copying of this email is prohibited. If =
you
>>> have received this in error, please notify the sender by replying by
>>> email and then delete the email completely from your system.
>>> Any views or opinions are solely those of the sender. =A0This
>>> communication is not intended to form a binding contract on behalf =
of
>>> Ivy Comptech Private Limited unless expressly indicated to the
>> contrary
>>> and properly authorised. Any actions taken on the basis of this =
email
>>> are at the recipient's own risk.
>>>
>>> Registered office:
>>> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara =
Hills,
>>> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
>>> Registered in India. A list of members' names is available for
>>> inspection at the registered office.
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> This email is sent for and on behalf of Ivy Comptech Private Limited. =
Ivy Comptech Private Limited is a limited liability company.
>
> This email and any attachments are confidential, and may be legally =
privileged and protected by copyright. If you are not the intended =
recipient dissemination or copying of this email is prohibited. If you =
have received this in error, please notify the sender by replying by =
email and then delete the email completely from your system.
> Any views or opinions are solely those of the sender. =A0This =
communication is not intended to form a binding contract on behalf of =
Ivy Comptech Private Limited unless expressly indicated to the contrary =
and properly authorised. Any actions taken on the basis of this email =
are at the recipient's own risk.
>
> Registered office:
> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills, =
Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994. =
Registered in India. A list of members' names is available for =
inspection at the registered office.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44664-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 13:43:45 2010
Return-Path: <java-user-return-44664-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82718 invoked from network); 22 Jan 2010 13:43:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 13:43:45 -0000
Received: (qmail 4056 invoked by uid 500); 22 Jan 2010 13:43:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4007 invoked by uid 500); 22 Jan 2010 13:43:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3997 invoked by uid 99); 22 Jan 2010 13:43:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:43:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.216.202 as permitted sender)
Received: from [209.85.216.202] (HELO mail-px0-f202.google.com) (209.85.216.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 13:43:32 +0000
Received: by pxi40 with SMTP id 40so847850pxi.21
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 05:43:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=odTLGU8uMnjdq4XMOFgiDCS8PqOFb53QTLijP9HmaBg=;
        b=VnMiO6D7CUpGfus6cMLX/T58IwtffMpxZ6S8qlxBexmgp9hGlFbXW1bs+4Ua7teOHt
         w1Be6eD847htVsFxG37Z69iIXsugDikThYJODWiQU7lGZx+wMVv1qN3hkg6O2h4kii5B
         7v65KR5UjfDHPzW5rr2NQCWjzNkyJQGPeVcLI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=a6pKp9VWU5aAEjiLj8X3TzuHiRKTPnOeKWuhtpduqhQJ1+j8w04yOhKlHZG6T1SPnO
         RQXWlWoBGzDR8fAjubJel7Ssw8fze8okYAM66wvJrjH+peSpn9Q/GMeHhR4s9wxG/QL6
         QEzy+cwoXxtQg5ZZcaKjoca4v8Fk31qAGmHmA=
MIME-Version: 1.0
Received: by 10.114.249.31 with SMTP id w31mr2008006wah.59.1264167791306; Fri, 
	22 Jan 2010 05:43:11 -0800 (PST)
In-Reply-To: <49A7BA114AAC6A48B9C44CB06B7B987E08C91C15@HYDSVWIN004X.ivycomptech.partygaming.local>
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local> 
	<001301ca9b4d$c89bef10$59d3cd30$@de> <49A7BA114AAC6A48B9C44CB06B7B987E08C12002@HYDSVWIN004X.ivycomptech.partygaming.local> 
	<8f0ad1f31001220516j4d513d6fj8eaf603f2a4cdd21@mail.gmail.com> 
	<49A7BA114AAC6A48B9C44CB06B7B987E08C91BF9@HYDSVWIN004X.ivycomptech.partygaming.local> 
	<8f0ad1f31001220530g3b25b1cclbb3f68e4c03bf3ea@mail.gmail.com> 
	<49A7BA114AAC6A48B9C44CB06B7B987E08C91C15@HYDSVWIN004X.ivycomptech.partygaming.local>
From: Robert Muir <rcmuir@gmail.com>
Date: Fri, 22 Jan 2010 08:42:51 -0500
Message-ID: <8f0ad1f31001220542v141cda67ne7d24a73e68e61b2@mail.gmail.com>
Subject: Re: Applying LUCENE-1606 -- which version
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

what is a 'contains clause' ??? what is the use case behind it, and
why can't poker be tokenized from the text so they just type 'poker'
with no wildcards?

On Fri, Jan 22, 2010 at 8:41 AM, Sriram Muthuswamy Chittathoor
<sriramc@ivycomptech.com> wrote:
> Okay the only reason I asked was to support contains clause. =C2=A0But it=
 could be relaxed if it is causing a issue and we could support those .{0,3=
}poker.* fast.
>
>
>
> -----Original Message-----
> From: Robert Muir [mailto:rcmuir@gmail.com]
> Sent: Friday, January 22, 2010 7:01 PM
> To: java-user@lucene.apache.org
> Subject: Re: Applying LUCENE-1606 -- which version
>
> the first step if determining why you really need to support *poker*
> on 100M database rows, is it some programmers fault, or are users
> directly typing this in?
>
> Either can probably re-trained, perhaps you should do like google, and
> drop these characters from users queries if they do this...
>
> On Fri, Jan 22, 2010 at 8:28 AM, Sriram Muthuswamy Chittathoor
> <sriramc@ivycomptech.com> wrote:
>> then I recommend storing your data in a different structure that
>> will support such queries.
>> -- =C2=A0what would this structure be ? =C2=A0Is this to be done through=
 Lucene.
>>
>> -----Original Message-----
>> From: Robert Muir [mailto:rcmuir@gmail.com]
>> Sent: Friday, January 22, 2010 6:47 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: Applying LUCENE-1606 -- which version
>>
>> the patch won't especially help queries like this. maybe they will be
>> 5 or 6 times faster, but still slow.
>>
>> if you really want to do such queries, consider this: do you really
>> need * to match an INFINITE amount of characters?!?!
>>
>> If not, then consider rewriting input queries like this into FINITE
>> RegExpQuerys, something like .{0,3}poker.* at least, where the first
>> component can only match at most 3 of any character, before it must be
>> a p.
>> you can tweak the 'parameter' 3 until its a reasonable tradeoff
>> between relevance and performance.
>>
>> if, on the other hand, you have 100 million rows and feel its
>> mandatory that * matches an infinite amount of characters in this
>> case, then I recommend storing your data in a different structure that
>> will support such queries.
>>
>> On Fri, Jan 22, 2010 at 5:46 AM, Sriram Muthuswamy Chittathoor
>> <sriramc@ivycomptech.com> wrote:
>>> Thanks for the fast reply.
>>> http://svn.apache.org/repos/asf/lucene/java/branches/flex_1458/
>>> I used the one above to checkout. =C2=A0Hope it is fine. =C2=A0Will see=
 how it
>>> works out.
>>>
>>> My requirement is that I have a index into a DB row (100 million rows).
>>> On some text fields I want to do =C2=A0contains =C2=A0search fast. =C2=
=A0I hope this
>>> will suit my needs. =C2=A0 Something like =C2=A0 screenName:*poker*
>>>
>>>
>>>
>>> -----Original Message-----
>>> From: Uwe Schindler [mailto:uwe@thetaphi.de]
>>> Sent: Friday, January 22, 2010 4:00 PM
>>> To: java-user@lucene.apache.org
>>> Subject: RE: Applying LUCENE-1606 -- which version
>>>
>>> Hi Sriram,
>>>
>>> This patch cannot be applied to 3.0 as it depends on a new Lucene branc=
h
>>> called flex. It depends on features, only added in version 3.1. So it
>>> does not even apply on trunk, you have to checkout the experimental fle=
x
>>> branch first.
>>>
>>> For 3.0 you, may try one of the early patches (the last without -flex i=
n
>>> name) in this issue, but they will never go into lucene 3.1, instead th=
e
>>> flex branch will hopefully merge with trunk, soon. Also the non-flex
>>> patches are not so performant, because the performance increases only
>>> with flexible indexing API.
>>>
>>> Uwe
>>>
>>> -----
>>> Uwe Schindler
>>> H.-H.-Meier-Allee 63, D-28213 Bremen
>>> http://www.thetaphi.de
>>> eMail: uwe@thetaphi.de
>>>
>>>> -----Original Message-----
>>>> From: Sriram Muthuswamy Chittathoor [mailto:sriramc@ivycomptech.com]
>>>> Sent: Friday, January 22, 2010 11:05 AM
>>>> To: java-user@lucene.apache.org
>>>> Subject: Applying LUCENE-1606 -- which version
>>>>
>>>> Hi:
>>>>
>>>>
>>>>
>>>> I am trying to apply this Automata patch on my Lucene 3.0 src code but
>>>> running into issues as it is complaining about failures to apply patch
>>>> to certain files. =C2=A0Is this the right version
>>>>
>>>> To apply to. =C2=A0Please help
>>>>
>>>>
>>>>
>>>> Thanks
>>>>
>>>>
>>>>
>>>> Sriram C
>>>>
>>>>
>>>>
>>>> LUCENE-1606
>>>> https://issues.apache.org/jira/browse/LUCENE-1606
>>>>
>>>>
>>>> This email is sent for and on behalf of Ivy Comptech Private Limited.
>>>> Ivy Comptech Private Limited is a limited liability company.
>>>>
>>>> This email and any attachments are confidential, and may be legally
>>>> privileged and protected by copyright. If you are not the intended
>>>> recipient dissemination or copying of this email is prohibited. If you
>>>> have received this in error, please notify the sender by replying by
>>>> email and then delete the email completely from your system.
>>>> Any views or opinions are solely those of the sender. =C2=A0This
>>>> communication is not intended to form a binding contract on behalf of
>>>> Ivy Comptech Private Limited unless expressly indicated to the
>>> contrary
>>>> and properly authorised. Any actions taken on the basis of this email
>>>> are at the recipient's own risk.
>>>>
>>>> Registered office:
>>>> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills,
>>>> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
>>>> Registered in India. A list of members' names is available for
>>>> inspection at the registered office.
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>
>>
>>
>> --
>> Robert Muir
>> rcmuir@gmail.com
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> This email is sent for and on behalf of Ivy Comptech Private Limited. Iv=
y Comptech Private Limited is a limited liability company.
>>
>> This email and any attachments are confidential, and may be legally priv=
ileged and protected by copyright. If you are not the intended recipient di=
ssemination or copying of this email is prohibited. If you have received th=
is in error, please notify the sender by replying by email and then delete =
the email completely from your system.
>> Any views or opinions are solely those of the sender. =C2=A0This communi=
cation is not intended to form a binding contract on behalf of Ivy Comptech=
 Private Limited unless expressly indicated to the contrary and properly au=
thorised. Any actions taken on the basis of this email are at the recipient=
's own risk.
>>
>> Registered office:
>> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills, H=
yderabad 500 033, Andhra Pradesh, India. Registered number: 37994. Register=
ed in India. A list of members' names is available for inspection at the re=
gistered office.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Robert Muir
rcmuir@gmail.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44665-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 17:02:55 2010
Return-Path: <java-user-return-44665-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82712 invoked from network); 22 Jan 2010 17:02:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 17:02:55 -0000
Received: (qmail 21092 invoked by uid 500); 22 Jan 2010 17:02:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21042 invoked by uid 500); 22 Jan 2010 17:02:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21027 invoked by uid 99); 22 Jan 2010 17:02:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 17:02:53 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 17:02:42 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NYMto-0002Ps-TX
	for java-user@lucene.apache.org; Fri, 22 Jan 2010 09:02:20 -0800
Message-ID: <27276550.post@talk.nabble.com>
Date: Fri, 22 Jan 2010 09:02:20 -0800 (PST)
From: Frank Geary <fgeary@acquiremedia.com>
To: java-user@lucene.apache.org
Subject: Re: Index corruption using Lucene 2.4.1 - thread safety issue?
In-Reply-To: <9ac0c6aa1001220014h4fdeac43uca16c056b23364e1@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: fgeary@acquiremedia.com
References: <27115515.post@talk.nabble.com> <9ac0c6aa1001120101o77c9e0b9i74ad0e76b59063ad@mail.gmail.com> <27129835.post@talk.nabble.com> <9ac0c6aa1001121105s5e1b6c55h320e31cf734f1850@mail.gmail.com> <27265165.post@talk.nabble.com> <9ac0c6aa1001220014h4fdeac43uca16c056b23364e1@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Mike,

Below are the portions of the merge log files related to the setInfoStream(=
)
calls during the time our exception happens.  The ..._1... log file is from
one RAMDir index and the ..._0... log file is from the other RAMDir index.=
=20
The time period when our Array index out of bounds exception happens is
2009-12-27 19:59:51,244 (when the IndexReader.reopen() is about to be
called) to 2009-12-27 19:59:51,259 (when the exception is thrown from the
MultiIndexSearch.search() call).  As you can see from the log files below,
our "_1" RAMDir index is the only one being used during the time the
exception is thrown - not new information to me.  Also a merge has finished
at 2009-12-27 19:59:50,561 and thus it appears that nothing at all is
happening (with respect to merges or commits) in either RAMDir index at the
time the problem occurs.  But one thing that is interesting to me - perhaps
you can clarify - is there is a very short commit at the very top of the
"_1" log file.  Why is that commit different from the commit right below it=
?=20
What does "DW: apply 1 buffered deleted terms and 0 deleted docIDs" mean?=
=20
What does "commit: pendingCommit =3D=3D null; skip" mean?  Are there differ=
ent
kinds of commit?

Here's the log file info:


indexmergesched_1_20091227161034212.log


[2009-12-27 19:59:50,534Z]: IW 48 [pool-2-thread-1]: commit: start
[2009-12-27 19:59:50,534Z]: IW 48 [pool-2-thread-1]: commit: now prepare
[2009-12-27 19:59:50,534Z]: IW 48 [pool-2-thread-1]: prepareCommit: flush
[2009-12-27 19:59:50,534Z]: IW 48 [pool-2-thread-1]:   flush: segment=3Dnul=
l
docStoreSegment=3Dnull docStoreOffset=3D0 flushDocs=3Dfalse flushDeletes=3D=
true=20

flushDocStores=3Dfalse numDocs=3D0 numBufDelTerms=3D1
[2009-12-27 19:59:50,534Z]: IW 48 [pool-2-thread-1]:   index before flush
_6o:C206 _dd:C207 _iy:C181 _q7:C225 _wm:C203 _yv:C71 _yw:C1 _yx:C1 _yy:C1=
=20

_yz:C1 _z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1
[2009-12-27 19:59:50,534Z]: IW 48 [pool-2-thread-1]: DW: apply 1 buffered
deleted terms and 0 deleted docIDs and 0 deleted queries on 15 segments.
[2009-12-27 19:59:50,536Z]: IW 48 [pool-2-thread-1]: startCommit(): start
sizeInBytes=3D0
[2009-12-27 19:59:50,536Z]: IW 48 [pool-2-thread-1]:   skip startCommit():
no changes pending
[2009-12-27 19:59:50,536Z]: IW 48 [pool-2-thread-1]: commit: pendingCommit
=3D=3D null; skip
[2009-12-27 19:59:50,536Z]: IW 48 [pool-2-thread-1]: commit: done
[2009-12-27 19:59:50,543Z]: IW 48 [pool-2-thread-1]: commit: start
[2009-12-27 19:59:50,543Z]: IW 48 [pool-2-thread-1]: commit: now prepare
[2009-12-27 19:59:50,543Z]: IW 48 [pool-2-thread-1]: prepareCommit: flush
[2009-12-27 19:59:50,543Z]: IW 48 [pool-2-thread-1]:   flush: segment=3D_z6
docStoreSegment=3D_z6 docStoreOffset=3D0 flushDocs=3Dtrue flushDeletes=3Dtr=
ue=20

flushDocStores=3Dtrue numDocs=3D1 numBufDelTerms=3D0
[2009-12-27 19:59:50,543Z]: IW 48 [pool-2-thread-1]:   index before flush
_6o:C206 _dd:C207 _iy:C181 _q7:C225 _wm:C203 _yv:C71 _yw:C1 _yx:C1 _yy:C1=
=20

_yz:C1 _z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1
[2009-12-27 19:59:50,543Z]: IW 48 [pool-2-thread-1]: DW: flush postings as
segment _z6 numDocs=3D1
[2009-12-27 19:59:50,543Z]: IW 48 [pool-2-thread-1]: DW: closeDocStore: 2
files to flush to segment _z6 numDocs=3D1
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: DW:   oldRAMSize=3D593=
92
newFlushedSize=3D6213 docs/MB=3D168.771 new/old=3D10.461%
[2009-12-27 19:59:50,544Z]: IFD [pool-2-thread-1]: now checkpoint
"segments_xv" [16 segments ; isCommit =3D false]
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: LMP: findMerges: 16
segments
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: LMP:   level 6.2247195
to 6.2465463: 5 segments
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: LMP:   level -1.0 to
5.8754334: 11 segments
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: LMP:     5 to 15: add
this merge
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: alwaysMerge=3Dtrue
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: CMS: now merge
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: CMS:   index: _6o:C206
_dd:C207 _iy:C181 _q7:C225 _wm:C203 _yv:C71 _yw:C1 _yx:C1 _yy:C1 _yz:C1=20

_z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1 _z6:C1
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: CMS:   no more merges
pending; now return
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: startCommit(): start
sizeInBytes=3D0
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: startCommit
index=3D_6o:C206 _dd:C207 _iy:C181 _q7:C225 _wm:C203 _yv:C71 _yw:C1 _yx:C1
_yy:C1 _yz:C1=20

_z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1 _z6:C1 changeCount=3D2598
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: now sync _z6.fnm
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: now sync _z6.frq
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: now sync _z6.prx
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: now sync _z6.tis
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: now sync _z6.tii
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: now sync _z6.nrm
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: now sync _z6.fdx
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: now sync _z6.fdt
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: done all syncs
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: commit: pendingCommit
!=3D null
[2009-12-27 19:59:50,544Z]: IFD [pool-2-thread-1]: now checkpoint
"segments_xw" [16 segments ; isCommit =3D true]
[2009-12-27 19:59:50,544Z]: IFD [pool-2-thread-1]: deleteCommits: now decRe=
f
commit "segments_xv"
[2009-12-27 19:59:50,544Z]: IFD [pool-2-thread-1]: delete "segments_xv"
[2009-12-27 19:59:50,544Z]: IW 48 [pool-2-thread-1]: commit: done
[2009-12-27 19:59:50,556Z]: IW 48 [pool-2-thread-1]: commit: start
[2009-12-27 19:59:50,556Z]: IW 48 [pool-2-thread-1]: commit: now prepare
[2009-12-27 19:59:50,556Z]: IW 48 [pool-2-thread-1]: prepareCommit: flush
[2009-12-27 19:59:50,556Z]: IW 48 [pool-2-thread-1]:   flush: segment=3D_z7
docStoreSegment=3D_z7 docStoreOffset=3D0 flushDocs=3Dtrue flushDeletes=3Dtr=
ue=20

flushDocStores=3Dtrue numDocs=3D1 numBufDelTerms=3D0
[2009-12-27 19:59:50,556Z]: IW 48 [pool-2-thread-1]:   index before flush
_6o:C206 _dd:C207 _iy:C181 _q7:C225 _wm:C203 _yv:C71 _yw:C1 _yx:C1 _yy:C1=
=20

_yz:C1 _z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1 _z6:C1
[2009-12-27 19:59:50,556Z]: IW 48 [pool-2-thread-1]: DW: flush postings as
segment _z7 numDocs=3D1
[2009-12-27 19:59:50,556Z]: IW 48 [pool-2-thread-1]: DW: closeDocStore: 2
files to flush to segment _z7 numDocs=3D1
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: DW:   oldRAMSize=3D593=
92
newFlushedSize=3D6156 docs/MB=3D170.334 new/old=3D10.365%
[2009-12-27 19:59:50,557Z]: IFD [pool-2-thread-1]: now checkpoint
"segments_xw" [17 segments ; isCommit =3D false]
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: LMP: findMerges: 17
segments
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: LMP:   level 6.2247195
to 6.2465463: 5 segments
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: LMP:   level -1.0 to
5.8754334: 12 segments
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: LMP:     5 to 15: add
this merge
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: alwaysMerge=3Dtrue
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: CMS: now merge
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: CMS:   index: _6o:C206
_dd:C207 _iy:C181 _q7:C225 _wm:C203 _yv:C71 _yw:C1 _yx:C1 _yy:C1 _yz:C1=20

_z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1 _z6:C1 _z7:C1
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: CMS:   no more merges
pending; now return
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: startCommit(): start
sizeInBytes=3D0
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: startCommit
index=3D_6o:C206 _dd:C207 _iy:C181 _q7:C225 _wm:C203 _yv:C71 _yw:C1 _yx:C1
_yy:C1 _yz:C1=20

_z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1 _z6:C1 _z7:C1 changeCount=3D2600
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: now sync _z7.fnm
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: now sync _z7.frq
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: now sync _z7.prx
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: now sync _z7.tis
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: now sync _z7.tii
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: now sync _z7.nrm
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: now sync _z7.fdx
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: now sync _z7.fdt
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: done all syncs
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: commit: pendingCommit
!=3D null
[2009-12-27 19:59:50,557Z]: IFD [pool-2-thread-1]: now checkpoint
"segments_xx" [17 segments ; isCommit =3D true]
[2009-12-27 19:59:50,557Z]: IFD [pool-2-thread-1]: deleteCommits: now decRe=
f
commit "segments_xw"
[2009-12-27 19:59:50,557Z]: IFD [pool-2-thread-1]: delete "segments_xw"
[2009-12-27 19:59:50,557Z]: IW 48 [pool-2-thread-1]: commit: done
[2009-12-27 19:59:50,561Z]: IW 48 [Lucene Merge Thread #125]: commitMerge:
_yv:C71 _yw:C1 _yx:C1 _yy:C1 _yz:C1 _z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1 into=
=20

_z5 index=3D_6o:C206 _dd:C207 _iy:C181 _q7:C225 _wm:C203 _yv:C71 _yw:C1 _yx=
:C1
_yy:C1 _yz:C1 _z0:C1 _z1:C1 _z2:C1 _z3:C1 _z4:C1 _z6:C1 _z7:C1
[2009-12-27 19:59:50,561Z]: IW 48 [Lucene Merge Thread #125]:
commitMergeDeletes _yv:C71 _yw:C1 _yx:C1 _yy:C1 _yz:C1 _z0:C1 _z1:C1 _z2:C1
_z3:C1 _z4:C1=20

into _z5
[2009-12-27 19:59:50,561Z]: IFD [Lucene Merge Thread #125]: now checkpoint
"segments_xx" [8 segments ; isCommit =3D false]
[2009-12-27 19:59:50,561Z]: IW 48 [Lucene Merge Thread #125]: LMP:
findMerges: 8 segments
[2009-12-27 19:59:50,561Z]: IW 48 [Lucene Merge Thread #125]: LMP:   level
6.2247195 to 6.2465463: 5 segments
[2009-12-27 19:59:50,561Z]: IW 48 [Lucene Merge Thread #125]: LMP:   level
-1.0 to 5.910075: 3 segments
[2009-12-27 19:59:50,561Z]: IW 48 [Lucene Merge Thread #125]: CMS:   merge
thread: done
[2009-12-27 19:59:50,561Z]: IW 48 [Thread-108842]:
AMConcurrentMergeScheduler: merge is done
[2009-12-27 20:00:05,494Z]: IW 48 [pool-2-thread-1]: commit: start
[2009-12-27 20:00:05,494Z]: IW 48 [pool-2-thread-1]: commit: now prepare
[2009-12-27 20:00:05,494Z]: IW 48 [pool-2-thread-1]: prepareCommit: flush
[2009-12-27 20:00:05,494Z]: IW 48 [pool-2-thread-1]:   flush: segment=3Dnul=
l
docStoreSegment=3Dnull docStoreOffset=3D0 flushDocs=3Dfalse flushDeletes=3D=
true=20

flushDocStores=3Dfalse numDocs=3D0 numBufDelTerms=3D1
[2009-12-27 20:00:05,494Z]: IW 48 [pool-2-thread-1]:   index before flush
_6o:C206 _dd:C207 _iy:C181 _q7:C225 _wm:C203 _z5:C80 _z6:C1 _z7:C1
[2009-12-27 20:00:05,495Z]: IW 48 [pool-2-thread-1]: DW: apply 1 buffered
deleted terms and 0 deleted docIDs and 0 deleted queries on 8 segments.
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: now checkpoint
"segments_xx" [8 segments ; isCommit =3D false]
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: startCommit(): start
sizeInBytes=3D0
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: startCommit
index=3D_6o:C206 _dd:C207 _iy:C181 _q7:C225 _wm:C203 _z5:C80 _z6:C1 _z7:C1=
=20

changeCount=3D2602
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5.fnm
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5.frq
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5.prx
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5.tis
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5.tii
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5.nrm
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5.fdx
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5.fdt
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: now sync _z5_1.del
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: done all syncs
[2009-12-27 20:00:05,496Z]: IW 48 [pool-2-thread-1]: commit: pendingCommit
!=3D null
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: now checkpoint
"segments_xy" [8 segments ; isCommit =3D true]
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: deleteCommits: now decRe=
f
commit "segments_xx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "segments_xx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yv.fnm"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yv.frq"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yv.prx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yv.tis"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yv.tii"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yv.nrm"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yv.fdx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yv.fdt"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yw.fnm"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yw.frq"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yw.prx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yw.tis"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yw.tii"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yw.nrm"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yw.fdx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yw.fdt"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yx.fnm"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yx.frq"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yx.prx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yx.tis"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yx.tii"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yx.nrm"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yx.fdx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yx.fdt"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yy.fnm"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yy.frq"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yy.prx"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yy.tis"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yy.tii"
[2009-12-27 20:00:05,496Z]: IFD [pool-2-thread-1]: delete "_yy.nrm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yy.fdx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yy.fdt"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yz.fnm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yz.frq"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yz.prx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yz.tis"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yz.tii"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yz.nrm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yz.fdx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_yz.fdt"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z0.fnm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z0.frq"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z0.prx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z0.tis"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z0.tii"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z0.nrm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z0.fdx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z0.fdt"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z1.fnm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z1.frq"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z1.prx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z1.tis"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z1.tii"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z1.nrm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z1.fdx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z1.fdt"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z2.fnm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z2.frq"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z2.prx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z2.tis"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z2.tii"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z2.nrm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z2.fdx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z2.fdt"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z3.fnm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z3.frq"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z3.prx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z3.tis"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z3.tii"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z3.nrm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z3.fdx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z3.fdt"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z4.fnm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z4.frq"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z4.prx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z4.tis"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z4.tii"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z4.nrm"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z4.fdx"
[2009-12-27 20:00:05,497Z]: IFD [pool-2-thread-1]: delete "_z4.fdt"
[2009-12-27 20:00:05,497Z]: IW 48 [pool-2-thread-1]: commit: done

indexmergesched_0_20091227193729876.log

[2009-12-27 19:37:29,876Z]: IFD [ArchiveIndexSearcherFactoryCreator]:
setInfoStream
deletionPolicy=3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@6=
24e2c55
[2009-12-27 19:37:29,876Z]: IW 49 [ArchiveIndexSearcherFactoryCreator]:
setInfoStream: dir=3Dorg.apache.lucene.store.RAMDirectory@1bc74f37
autoCommit=3Dfalse
mergePolicy=3Dorg.apache.lucene.index.LogByteSizeMergePolicy@7a40b2de
mergeScheduler=3Dorg.apache.lucene.index.AMConcurrentMergeScheduler@2d9f4b8=
6
ramBufferSizeMB=3D16.0 maxBufferedDocs=3D60 maxBuffereDeleteTerms=3D-1
maxFieldLength=3D100000 index=3D
[2009-12-27 23:07:17,197Z]: IW 49 [pool-2-thread-1]: commit: start
[2009-12-27 23:07:17,200Z]: IW 49 [pool-2-thread-1]: commit: now prepare
[2009-12-27 23:07:17,200Z]: IW 49 [pool-2-thread-1]: prepareCommit: flush
[2009-12-27 23:07:17,200Z]: IW 49 [pool-2-thread-1]:   flush: segment=3D_0
docStoreSegment=3D_0 docStoreOffset=3D0 flushDocs=3Dtrue flushDeletes=3Dtru=
e
flushDocStores=3Dtrue numDocs=3D1 numBufDelTerms=3D0
[2009-12-27 23:07:17,200Z]: IW 49 [pool-2-thread-1]:   index before flush
[2009-12-27 23:07:17,200Z]: IW 49 [pool-2-thread-1]: DW: flush postings as
segment _0 numDocs=3D1
[2009-12-27 23:07:17,200Z]: IW 49 [pool-2-thread-1]: DW: closeDocStore: 2
files to flush to segment _0 numDocs=3D1
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: DW:   oldRAMSize=3D151=
552
newFlushedSize=3D11654 docs/MB=3D89.976 new/old=3D7.69%
[2009-12-27 23:07:17,201Z]: IFD [pool-2-thread-1]: now checkpoint
"segments_1" [1 segments ; isCommit =3D false]
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: LMP: findMerges: 1
segments
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: LMP:   level -1.0 to
4.1824718: 1 segments
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: alwaysMerge=3Dtrue
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: CMS: now merge
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: CMS:   index: _0:C1
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: CMS:   no more merges
pending; now return
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: startCommit(): start
sizeInBytes=3D0
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: startCommit index=3D_0=
:C1
changeCount=3D2
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: now sync _0.fnm
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: now sync _0.frq
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: now sync _0.prx
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: now sync _0.tis
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: now sync _0.tii
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: now sync _0.nrm
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: now sync _0.fdx
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: now sync _0.fdt
[2009-12-27 23:07:17,201Z]: IW 49 [pool-2-thread-1]: done all syncs

Frank


Michael McCandless-2 wrote:
>=20
> On Thu, Jan 21, 2010 at 4:46 PM, Frank Geary <fgeary@acquiremedia.com>
> wrote:
>=20
>> Nope. =C2=A0When it's time to inactivate a RAMDir indexWriter, I get tha=
t
>> directory, =C2=A0close that writer, then clear out the directory. =C2=A0=
Then after
>> clearing out the directory, I create a new IW passing in the directory
>> that
>> was used previously. =C2=A0No, I do not override the LockFactory - not
>> familiar
>> with it.
>=20
> Hmm, curious.
>=20
>> Hmm...for what it's worth we are using ConcurrentMergeScheduler.
>> We do actaully have setInfoStream turned on for all our indexers. =C2=A0=
I'll
>> have
>> to hunt down one of our logs that corresponds to one of the Exceptions
>> though. =C2=A0Thanks for that.
>=20
> That could be helpful... eg it'd let us confirm every open IW is
> closed before a new one is opened, on the same IW (assuming we get the
> full output from all opened IWs).
>=20
>> We delete the files explicitly, because what we found was that under hig=
h
>> index loads (i.e. rapid rolling of RAMDir indexWriters) leaving the
>> RAMDir
>> around lead to garbage collection issues as old RAMDirs accumulated
>> waiting
>> for garbage collection to take place. =C2=A0It turned out that deleting =
the
>> files
>> explicitly avoided those garbage collection problems.
>=20
> That's very odd -- RAMDir should be "easy" to GC once it's closed.  It
> (and RAMFile) have no finalizers.
>=20
> Were you calling RAMDir.close()?  That clears its fileMap, which will
> make all RAM consumed GCable.
>=20
> The fact that you hit GC issues makes me suspect something, somewhere
> is still hanging on to the RAMDir (ie, the IW isn't always being
> closed).
>=20
> If you go back to using a new RAMDir instance per IW, does the problem go
> away?
>=20
> Mike
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/Index-corruption-using-=
Lucene-2.4.1---thread-safety-issue--tp27115515p27276550.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44666-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 18:23:42 2010
Return-Path: <java-user-return-44666-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25052 invoked from network); 22 Jan 2010 18:23:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 18:23:42 -0000
Received: (qmail 66931 invoked by uid 500); 22 Jan 2010 18:23:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66853 invoked by uid 500); 22 Jan 2010 18:23:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66843 invoked by uid 99); 22 Jan 2010 18:23:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 18:23:39 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tjkolev@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 18:23:32 +0000
Received: by fxm2 with SMTP id 2so1515660fxm.5
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 10:23:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=vg8EoksLO5Bz3UWi1KhQVbJhP5WS786kapm7uML5FJw=;
        b=moMhsHPg4tARMF6n3zAA9B9yepw42sBtgAjCFE+OTRlIXf7AMpa9c9QVX6/vL3HUZi
         cwYHRsLre//aLMv8sTZQQgz1CtBFeT393Zg05R+67vfSm/SK+zX6GbENb2n8JEAlds29
         VHqQIvJoB5R0FRDKL0ePLhLtxlRz3N1TxbF4A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=gdZNtKswLqGo7KjhV6ENwb+G3fgUoaQu05Shx1TCUxl68Zk64lfYBZJNx157rTx7NB
         /lO7jUVcIxVhlNoM4H/UaAN8wPuAkYrU506+QLd+EjaFYVYeDy00TPhPFjOTNXzqBCBk
         ILwVtNOw9APHfZTEdwD3/nxAoAsAWnQ0lO/mI=
MIME-Version: 1.0
Received: by 10.239.188.11 with SMTP id n11mr383077hbh.17.1264184591481; Fri, 
	22 Jan 2010 10:23:11 -0800 (PST)
In-Reply-To: <359a92831001150931g140961d4s63d95878109c3b06@mail.gmail.com>
References: <743c5bb41001131259o40df8ab6v66207327baefcf42@mail.gmail.com>
	 <001d01ca9497$a392a630$eab7f290$@com>
	 <359a92831001131352x7d6ea929p1f095c79c6dc58f4@mail.gmail.com>
	 <743c5bb41001150819w5e4b7654p625f9dffb7e41403@mail.gmail.com>
	 <359a92831001150931g140961d4s63d95878109c3b06@mail.gmail.com>
Date: Fri, 22 Jan 2010 12:23:10 -0600
Message-ID: <743c5bb41001221023j474f89d6gc52ccdd05e223b05@mail.gmail.com>
Subject: Re: Problem: Indexing and searching repeating groups of fields
From: TJ Kolev <tjkolev@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=001485f1d8ee817c63047dc4e908

--001485f1d8ee817c63047dc4e908
Content-Type: text/plain; charset=ISO-8859-1

The issue is that the real world document has more than 2 fields. Me giving
an example of two was a bit misleading. I can't really "pair" them. Here's a
better example:

Resume_a
  Exp_1
    Language:Java, Years:5, Certification:Sun, Area:Web
  Exp_2
    Language:C, Years:3, Certification:None, Area:Desktop

And yes, I need to be able to query for ranges on the Years field. So for
now, I'll do as much in Lucene, and then post-filter on my own any extra
documents in the search result.

Thank you.
tjk :)

On Fri, Jan 15, 2010 at 11:31 AM, Erick Erickson <erickerickson@gmail.com>wrote:

> Well, a variant on the easy solution might. What would
> happen if you indexed the un-split pairs in the same
> field? I.e.
>
> "java:5", "c:3", "php:2" all indexed as *single* tokens
> in the *same* field?
>
> But I think you should look at Digy's suggestion again.
> 6-10 fields is absolutely no problem at all. Documents
> in Lucene can have any number of fields without
> any relation to any other document. So having
> "sparse" documents has no penalty (unlike a RDBMS).
>
> In particular, with Digy's scheme you can answer questions
> like "has more than 3 years of C experience" whereas
> with my scheme it would be harder.
>
>
> FWIW
> Erick
>
> On Fri, Jan 15, 2010 at 11:19 AM, TJ Kolev <tjkolev@gmail.com> wrote:
>
> > Hi!
> >
> > I don't think the easy solution will work for me, because I'll have more
> > than two fields in a group - perhaps 6 - 10.
> >
> > However using span queries looks very promising. I'll investigate that.
> >
> > I see setPositionIncrement() only on the Token object. Is there a way to
> > set
> > this when adding a field to the document, so that the first token get its
> > position pushed away. I would prefer not to modify my analyzer if
> possible.
> >
> > Thank you.
> > tjk :)
> >
> > On Wed, Jan 13, 2010 at 3:52 PM, Erick Erickson <erickerickson@gmail.com
> > >wrote:
> >
> > > Ooooh, isn't that easier. You just prompted me to think
> > > that you don't even have to do that, just index the pairs as single
> > > tokens (KeywordAnalyzer? but watch out for no case folding)...
> > >
> > > On Wed, Jan 13, 2010 at 4:30 PM, Digy <digydigy@gmail.com> wrote:
> > >
> > > > How about using languages as fieldnames?
> > > > Doc1(Ra):
> > > >        Java:5
> > > >        C:2
> > > >        PHP:3
> > > >
> > > > Doc2(Rb)
> > > >        Java:2
> > > >        C:5
> > > >        VB:1
> > > >
> > > > Query:Java:5 AND C:2
> > > >
> > > > DIGY
> > > >
> > > > -----Original Message-----
> > > > From: TJ Kolev [mailto:tjkolev@gmail.com]
> > > > Sent: Wednesday, January 13, 2010 11:00 PM
> > > > To: java-user@lucene.apache.org
> > > > Subject: Problem: Indexing and searching repeating groups of fields
> > > >
> > > > Greetings,
> > > >
> > > > Let's assume I have to index and search "resume" documents. Two
> fields
> > > are
> > > > defined: Language and Years. The fields are associated together in a
> > > group
> > > > called Experience. A resume document may have 0 or more Experience
> > > groups:
> > > >
> > > > Ra{ E1(Java,5); E2(C,2); E3(PHP,3);}
> > > > Rb{ E1(Java,2); E2(C,5); E3(VB,1);}
> > > >
> > > > How do I index such documents, and how do I search, so I can
> formulate
> > a
> > > > query like this "Resumes which have (Java,5) and (C,2)" and get back
> > Ra.
> > > I
> > > > know I can index multiple fields of the same name, and do
> > "(Language:Java
> > > > AND Years:5) AND (Language:C AND Years:2)", but in addition to Ra
> that
> > > > would
> > > > also return Rb, which I don't want. The problem here is that the
> > > "grouping"
> > > > is lost. I can create fields with compound names (E1Language,
> E1Years,
> > > > E2Language, E2Years, etc), but that helps me none, as I don't know
> > which
> > > > group to search. I'd also like to query for "(Language:Java AND
> > Years:5)
> > > OR
> > > > (Language:C AND Years:2)"
> > > >
> > > > This is a simplified example. Real documents may have 30 - 40 groups,
> > > each
> > > > one with several fields. Putting all the fields in a group in one
> index
> > > > field won't work as the numeric/date ones should be available for
> range
> > > > searchers.
> > > >
> > > > So far the way I see it is to do my own post processing on the
> results.
> > > The
> > > > issue is that text fields will need to be untokenized, or otherwise
> it
> > > > would
> > > > be difficult to work on the result, and determine what matches.
> > > >
> > > > Thank you.
> > > > tjk :)
> > > >
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > > >
> > >
> >
>

--001485f1d8ee817c63047dc4e908--

From java-user-return-44667-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 21:08:51 2010
Return-Path: <java-user-return-44667-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80501 invoked from network); 22 Jan 2010 21:08:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 21:08:51 -0000
Received: (qmail 73867 invoked by uid 500); 22 Jan 2010 21:08:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73783 invoked by uid 500); 22 Jan 2010 21:08:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73773 invoked by uid 99); 22 Jan 2010 21:08:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 21:08:48 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 21:08:40 +0000
Received: by yxe30 with SMTP id 30so1462506yxe.29
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 13:08:19 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.127.27 with SMTP id z27mr4872003ybc.104.1264194498746; 
	Fri, 22 Jan 2010 13:08:18 -0800 (PST)
In-Reply-To: <27276550.post@talk.nabble.com>
References: <27115515.post@talk.nabble.com>
	 <9ac0c6aa1001120101o77c9e0b9i74ad0e76b59063ad@mail.gmail.com>
	 <27129835.post@talk.nabble.com>
	 <9ac0c6aa1001121105s5e1b6c55h320e31cf734f1850@mail.gmail.com>
	 <27265165.post@talk.nabble.com>
	 <9ac0c6aa1001220014h4fdeac43uca16c056b23364e1@mail.gmail.com>
	 <27276550.post@talk.nabble.com>
Date: Fri, 22 Jan 2010 16:08:18 -0500
Message-ID: <9ac0c6aa1001221308h58795ebas2c8190f634aec9e8@mail.gmail.com>
Subject: Re: Index corruption using Lucene 2.4.1 - thread safety issue?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

It looks like each IW writes to a private log file -- could you zip up
all such files and attach as a zip file (CC me directly because the
list strips attachments)?  It can give me a bigger picture than just
these fragments...

Mike

On Fri, Jan 22, 2010 at 12:02 PM, Frank Geary <fgeary@acquiremedia.com> wro=
te:
>
> Mike,
>
> Below are the portions of the merge log files related to the setInfoStrea=
m()
> calls during the time our exception happens. =A0The ..._1... log file is =
from
> one RAMDir index and the ..._0... log file is from the other RAMDir index=
.

OK

> The time period when our Array index out of bounds exception happens is
> 2009-12-27 19:59:51,244 (when the IndexReader.reopen() is about to be
> called) to 2009-12-27 19:59:51,259 (when the exception is thrown from the
> MultiIndexSearch.search() call).

I suspect the corruption happened before that, ie, somehow the
deletions file for a segment got overwritten.  To bound the time I
guess we have look back to the reopen before the corrupt IndexReader
(which didn't hit the corruption).

> As you can see from the log files below,
> our "_1" RAMDir index is the only one being used during the time the
> exception is thrown - not new information to me.

Right but we need to see logs from earlier...

> Also a merge has finished
> at 2009-12-27 19:59:50,561 and thus it appears that nothing at all is
> happening (with respect to merges or commits) in either RAMDir index at t=
he
> time the problem occurs.

Need to see all the infoStream log files to really be sure...

> But one thing that is interesting to me - perhaps
> you can clarify - is there is a very short commit at the very top of the
> "_1" log file. =A0Why is that commit different from the commit right belo=
w it?
> What does "DW: apply 1 buffered deleted terms and 0 deleted docIDs" mean?

There was one delete-by-Term buffered (and no added docs) for the
first commit, and the reverse for the 2nd case.

> What does "commit: pendingCommit =3D=3D null; skip" mean? =A0Are there di=
fferent
> kinds of commit?

It looks like the deleted Term did not in fact match a document and so
the flush & commit were skipped.

You should also try making new RAMDirs instead of reusing the same one
-- if that still hits GC problems then something else is wrong: once a
RAMDir & all readers/writers using it are closed, it should be easy to
GC.

Or, another thing you could try is to swap in MockRAMDirectory (from
Lucene's tests): it will throw an exception if you attempt to close it
when the readers/writers didn't in fact close all their files.  If you
hit that exception you know something isn't being closed... it's a
good way to catch bugs...

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44668-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 22 23:53:16 2010
Return-Path: <java-user-return-44668-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38412 invoked from network); 22 Jan 2010 23:53:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 22 Jan 2010 23:53:16 -0000
Received: (qmail 3073 invoked by uid 500); 22 Jan 2010 23:53:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2991 invoked by uid 500); 22 Jan 2010 23:53:14 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2981 invoked by uid 99); 22 Jan 2010 23:53:14 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 23:53:14 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of amccurry.lucene@gmail.com designates 74.125.92.27 as permitted sender)
Received: from [74.125.92.27] (HELO qw-out-2122.google.com) (74.125.92.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 22 Jan 2010 23:53:04 +0000
Received: by qw-out-2122.google.com with SMTP id 3so345043qwe.53
        for <java-user@lucene.apache.org>; Fri, 22 Jan 2010 15:52:43 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:content-type:mime-version
         :subject:from:in-reply-to:date:content-transfer-encoding:message-id
         :references:to:x-mailer;
        bh=hplit+AtDM8vc12To0kBRaG0xfAlK4UvgcDJItW+WOg=;
        b=J5gSRYlaCLR0iOhWxvdo8vFCuzcoliBV3mtOnuA4G8MEyb8BV1XppzeOWvH7sm3ZVw
         2gRSTcy+2ouiy5QHakPDtPsRnXWjS/CrSVDozIXKOK8WP8RRCZNqut97WIdZ2EvACUVC
         BEoDMhzbw+JpIDZ6P7Cfc6NQw7obGxR9n25RY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        b=iq/byHPi96odr3s5QZPGyIsk8KMabXqtAUEgwETzPZwGOavklSAQsoxCMheMit2Ukl
         ex7OBeg60AafafygAv2uTDJJNXRiMrGsY+7wXHb76dlE9qwwoayaKf440tzhVfv8Uqit
         Nis57ttNcGBNnqXFbEYGr5FWIgbZWzS0ld7xc=
Received: by 10.229.4.196 with SMTP id 4mr2197487qcs.101.1264204362999;
        Fri, 22 Jan 2010 15:52:42 -0800 (PST)
Received: from ?192.168.1.4? (pool-173-79-184-191.washdc.fios.verizon.net [173.79.184.191])
        by mx.google.com with ESMTPS id 22sm2038175qyk.10.2010.01.22.15.52.40
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 22 Jan 2010 15:52:41 -0800 (PST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Lucene as a primary datastore
From: Aaron McCurry <amccurry.lucene@gmail.com>
In-Reply-To: <707868.65774.qm@web50307.mail.re2.yahoo.com>
Date: Fri, 22 Jan 2010 18:52:39 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <6E395523-9302-485A-B4CA-BB84D5C15EE8@gmail.com>
References: <ba012a2b1001191958r4551d5bfpadd14ef368758f6a@mail.gmail.com>  <4B575C4B.4040800@gmail.com> <ba012a2b1001201325i5bbdc638x8ae353f4f70de8fc@mail.gmail.com> <707868.65774.qm@web50307.mail.re2.yahoo.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org

While I know that our situation is fairly unique, but we rebuild our =
indexes weekly.  The source of our indexes are data marts generated from =
flat files.  We do this because our data changes too rapidly for us to =
keep up with the changes.  We do update the indexes at runtime, but only =
with about 10% of the changes.  The other changes are re processed =
weekly.  So Lucene is our runtime data store for search and data =
retrieval.  However it is not the system of record.

Aaron


On Jan 21, 2010, at 12:23 AM, Otis Gospodnetic wrote:

> Guido,
>=20
> No, you should absolutely not need to constantly rebuild the index.  =
If you find you have to do that, you'll know you are doing something =
wrong.
>=20
> Otis
> --
> Sematext -- http://sematext.com/ -- Solr - Lucene - Nutch
>=20
>=20
>=20
> ----- Original Message ----
>> From: Guido Bartolucci <guido.bartolucci@gmail.com>
>> To: java-user@lucene.apache.org
>> Sent: Wed, January 20, 2010 4:25:09 PM
>> Subject: Re: Lucene as a primary datastore
>>=20
>> Thanks for the response. I understand all of what you wrote, but what
>> I care about and what I had a little trouble describing exactly in my
>> previous question is:
>>=20
>> - Are all problems with Lucene obvious (e.g., you get an exception =
and
>> you know your data is now bad) or are there subtle corruptions that
>> just happen and because of that it makes sense to constantly rebuild
>> the index?
>>=20
>> I ask this because if this isn't the case then replication isn't =
going
>> to help, the problems probably get copied over to the other instances
>> (unless I'm missing something).
>>=20
>> guido.
>>=20
>>=20
>> On Wed, Jan 20, 2010 at 11:40 AM, Chris Lu wrote:
>>> I have 3 concerns of making Lucene as a primary database.
>>> 1) Lucene is stable when it's stable. But you will have java =
exceptions.
>>> What would you do when FileNotFoundException or "Lucene 2.9.1 'read =
past
>>> EOF' IOException under system load" happens?
>>> For me, I don't the data is safe this way. Or, you can understand =
all Lucene
>>> APIs and never make any mistakes.
>>> Some databases, like some versions of mysql, could corrupt data. No =
better,
>>> but it's still more robust.
>>> 2) As the name suggests, Lucene index is just an index, like =
database index,
>>> it's an auxiliary data structure. It's only fast in one way, but =
could be
>>> slow in other ways.
>>> 3) The more robust approach is to pull data out of database, and =
create a
>>> Lucene index. In case something goes wrong, you can always pull data =
out
>>> again and create the index again.
>>>=20
>>> --
>>> Chris Lu
>>> -------------------------
>>> Instant Scalable Full-Text Search On Any Database/Application
>>> site: http://www.dbsight.net
>>> demo: http://search.dbsight.com
>>> Lucene Database Search in 3 minutes:
>>>=20
>> =
http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Search_in=
_3_minutes
>>> DBSight customer, a shopping comparison site, (anonymous per =
request) got
>>> 2.6 Million Euro funding!
>>>=20
>>>=20
>>>=20
>>> Guido Bartolucci wrote:
>>>>=20
>>>> I know that the primary use case for Lucene is as an index of data
>>>> that can be reconstructed (e.g., from a relational database or from
>>>> spidering your corporate intranet).
>>>>=20
>>>> But, I'm curious if anyone uses Lucene as their primary datastore =
for
>>>> their gold data. Is it good enough?
>>>>=20
>>>> Would anyone consider (or do people already) store data in Lucene
>>>> that, if it was lost, would destroy their business? And no, I'm not
>>>> suggesting that you don't back up this data, I'm just curious if =
there
>>>> are problems with using Lucene in this way. Are there subtle
>>>> corruptions that might show up in Lucene that wouldn't show up in
>>>> Oracle or MySQL?
>>>>=20
>>>> I'm considering using Lucene in this way but I haven't been able to
>>>> find any documentation describing this use case. Are there any =
studies
>>>> of Lucene vs MySQL running for N years comparing the corruptions =
and
>>>> recovery times?
>>>>=20
>>>> Am I just ignorant and scared of Lucene and too trusting of Oracle =
and
>>>> MySQL?
>>>>=20
>>>> Thanks.
>>>>=20
>>>> -guido.
>>>>=20
>>>> (BTW, I did find a similar question asked back in 2007 in the =
archives
>>>> but it doesn't really answer my question)
>>>>=20
>>>> =
---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>=20
>>>>=20
>>>=20
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>=20
>>>=20
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44669-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 23 22:50:53 2010
Return-Path: <java-user-return-44669-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 557 invoked from network); 23 Jan 2010 22:50:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 23 Jan 2010 22:50:53 -0000
Received: (qmail 76743 invoked by uid 500); 23 Jan 2010 22:50:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76670 invoked by uid 500); 23 Jan 2010 22:50:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76660 invoked by uid 99); 23 Jan 2010 22:50:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 23 Jan 2010 22:50:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [134.96.191.147] (HELO smtp.dfki.de) (134.96.191.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 23 Jan 2010 22:50:42 +0000
Received: from smtp.dfki.de (localhost [127.0.0.1])
	by imss.7 (Postfix) with ESMTP id 0BAA73146A
	for <java-user@lucene.apache.org>; Sat, 23 Jan 2010 23:50:19 +0100 (CET)
Received: from mail.dfki.de (lnv-104.sb.dfki.de [134.96.191.146])
	by smtp.dfki.de (Postfix) with ESMTP id E8F8231444
	for <java-user@lucene.apache.org>; Sat, 23 Jan 2010 23:50:18 +0100 (CET)
Received: from [192.168.178.47] (vpn-int.sb.dfki.de [134.96.191.230])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.dfki.de (Postfix) with ESMTPSA id C5DFA3108D
	for <java-user@lucene.apache.org>; Sat, 23 Jan 2010 23:50:18 +0100 (CET)
Message-Id: <B6031CA1-C441-4EC1-ACC7-83AAF8730842@activemath.org>
From: Paul Libbrecht <paul@activemath.org>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: are Lucene queries thread-safe?
Date: Sat, 23 Jan 2010 23:50:18 +0100
X-Mailer: Apple Mail (2.936)


Hello list,

for some strange reason I wish to cache very frequent (and big, ~3000  
terms) queries.
Now, this might mean that a query is searched for in several threads  
on the same index. Do I run a risk?

thanks in advance

paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44670-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 24 03:28:38 2010
Return-Path: <java-user-return-44670-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71616 invoked from network); 24 Jan 2010 03:28:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Jan 2010 03:28:38 -0000
Received: (qmail 67125 invoked by uid 500); 24 Jan 2010 03:28:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66963 invoked by uid 500); 24 Jan 2010 03:28:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66953 invoked by uid 99); 24 Jan 2010 03:28:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 03:28:35 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 03:28:27 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NYt8x-0007ms-35
	for java-user@lucene.apache.org; Sat, 23 Jan 2010 19:28:07 -0800
Message-ID: <27292118.post@talk.nabble.com>
Date: Sat, 23 Jan 2010 19:28:07 -0800 (PST)
From: jchang <jchangkihatest@gmail.com>
To: java-user@lucene.apache.org
Subject: Can't start Lucene App: java.io.FileNotFoundException with brand
 new directory
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: jchangkihatest@gmail.com



When I try to start my service and construct an IndexWriter, I get this:

java.io.FileNotFoundException: no segments* file found in
org.apache.lucene.store.NIOFSDirectory@/home/jchang/IdeaProjects/index-service_trunk/target/testindexA/index/indexablemaildata:
files: [write.lock]

It is odd.  The problem is not that it is complaining about a lock file. 
There is none there.  It seems to be complaining that there is NOT a lock
file.  Why?  The directory is brand new - nothing is it it at all - not
write.lock file is there.
-- 
View this message in context: http://old.nabble.com/Can%27t-start-Lucene-App%3A-java.io.FileNotFoundException-with-brand-new-directory-tp27292118p27292118.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44671-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 24 03:49:03 2010
Return-Path: <java-user-return-44671-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74129 invoked from network); 24 Jan 2010 03:49:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Jan 2010 03:49:03 -0000
Received: (qmail 72999 invoked by uid 500); 24 Jan 2010 03:49:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72838 invoked by uid 500); 24 Jan 2010 03:49:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72828 invoked by uid 99); 24 Jan 2010 03:49:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 03:49:00 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 03:48:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NYtSh-0000aF-G6
	for java-user@lucene.apache.org; Sat, 23 Jan 2010 19:48:31 -0800
Message-ID: <27292176.post@talk.nabble.com>
Date: Sat, 23 Jan 2010 19:48:31 -0800 (PST)
From: jchang <jchangkihatest@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Can't start Lucene App: java.io.FileNotFoundException with
 brand new directory
In-Reply-To: <27292118.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: jchangkihatest@gmail.com
References: <27292118.post@talk.nabble.com>


I figured it out...but the answer leads to a new question.

The problem was that I was using this constructor:
IndexWriter(Directory d, Analyzer a, boolean create,
IndexWriter.MaxFieldLength mfl) 

I passed in false for create, and if there is no index yet, it fails as I
described.  As soon as I pass true for create, the problem goes away.  I
guess that makes sense; if you pass false, it expects to find an index
there.

However, if I pass true, I'll overwrite my existing index (that's what the
javadocs say, and I've found it to be true, generally, although not
always...I can't explain the difference).

I don't want to overwrite my index every time I start up, but I don't want
to be able to start up with a new, clean index dir.  What do I do?


jchang wrote:
> 
> 
> When I try to start my service and construct an IndexWriter, I get this:
> 
> java.io.FileNotFoundException: no segments* file found in
> org.apache.lucene.store.NIOFSDirectory@/home/jchang/IdeaProjects/index-service_trunk/target/testindexA/index/indexablemaildata:
> files: [write.lock]
> 
> It is odd.  The problem is not that it is complaining about a lock file. 
> There is none there.  It seems to be complaining that there is NOT a lock
> file.  Why?  The directory is brand new - nothing is it it at all - not
> write.lock file is there.
> 

-- 
View this message in context: http://old.nabble.com/Can%27t-start-Lucene-App%3A-java.io.FileNotFoundException-with-brand-new-directory-tp27292118p27292176.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44672-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 24 08:27:10 2010
Return-Path: <java-user-return-44672-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30032 invoked from network); 24 Jan 2010 08:27:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Jan 2010 08:27:10 -0000
Received: (qmail 30004 invoked by uid 500); 24 Jan 2010 08:27:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29946 invoked by uid 500); 24 Jan 2010 08:27:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29936 invoked by uid 99); 24 Jan 2010 08:27:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 08:27:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of chris.lu@gmail.com designates 209.85.211.184 as permitted sender)
Received: from [209.85.211.184] (HELO mail-yw0-f184.google.com) (209.85.211.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 08:26:58 +0000
Received: by ywh14 with SMTP id 14so2607121ywh.20
        for <java-user@lucene.apache.org>; Sun, 24 Jan 2010 00:26:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type;
        bh=G1c6GJndWfvL2m+d4GripAUjAJULumQ+D17qMnC7YOc=;
        b=CqHgqZdcoCkBuiy/xFIUBxAZbrBdSmHdYCcJthGSeRgiOpKsFAjxdysCHcur/QgST+
         JIQwMVMLUBq83oqMZDOo5VREiKayVjIrRTgACO1ewgabVFt89sdBcsDtG801oue5NXmx
         suoIwqFVVzAFPk7jQLmtzB5CMmZ0HXd32PJ2I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type;
        b=R8ePpnKrnGWjHxfgHvfgBI5aP+Y8J/y/yDjxZOy3Sibz4mwFUedlFPgtIsbEQtmR2u
         TqY3UOw8XxxbW5VEPLkF+Y+BT9UW2WakrJDlHPhtPk6E5JEpxtIXTXATypL9KDZa/tCY
         2aYbYll50GOPGdLWwQYhHAMbiGP9pXG7eVnnc=
Received: by 10.101.15.17 with SMTP id s17mr6199045ani.241.1264321596172;
        Sun, 24 Jan 2010 00:26:36 -0800 (PST)
Received: from ?192.168.1.100? (c-71-202-137-93.hsd1.ca.comcast.net [71.202.137.93])
        by mx.google.com with ESMTPS id 4sm1352348ywi.9.2010.01.24.00.26.34
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 24 Jan 2010 00:26:35 -0800 (PST)
Message-ID: <4B5C0423.2010208@gmail.com>
Date: Sun, 24 Jan 2010 00:26:11 -0800
From: Chris Lu <chris.lu@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Can't start Lucene App: java.io.FileNotFoundException with brand
 new directory
Content-Type: multipart/alternative;
 boundary="------------060806060304070307000303"
X-Virus-Checked: Checked by ClamAV on apache.org

--------------060806060304070307000303
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Think from another approach: You can check whether the index exists or 
not by IndexReader.*indexExists 
<../../../../org/apache/lucene/index/IndexReader.html#indexExists%28java.io.File%29>*(), 
and then determine what you want to do with the IndexWriter constructor.

-- 

--
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes: http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
DBSight customer, a shopping comparison site, (anonymous per request) got 2.6 Million Euro funding!



jchang wrote:
> I figured it out...but the answer leads to a new question.
>
> The problem was that I was using this constructor:
> IndexWriter(Directory d, Analyzer a, boolean create,
> IndexWriter.MaxFieldLength mfl) 
>
> I passed in false for create, and if there is no index yet, it fails as I
> described.  As soon as I pass true for create, the problem goes away.  I
> guess that makes sense; if you pass false, it expects to find an index
> there.
>
> However, if I pass true, I'll overwrite my existing index (that's what the
> javadocs say, and I've found it to be true, generally, although not
> always...I can't explain the difference).
>
> I don't want to overwrite my index every time I start up, but I don't want
> to be able to start up with a new, clean index dir.  What do I do?
>
>
> jchang wrote:
>   
>> When I try to start my service and construct an IndexWriter, I get this:
>>
>> java.io.FileNotFoundException: no segments* file found in
>> org.apache.lucene.store.NIOFSDirectory@/home/jchang/IdeaProjects/index-service_trunk/target/testindexA/index/indexablemaildata:
>> files: [write.lock]
>>
>> It is odd.  The problem is not that it is complaining about a lock file. 
>> There is none there.  It seems to be complaining that there is NOT a lock
>> file.  Why?  The directory is brand new - nothing is it it at all - not
>> write.lock file is there.
>>
>>     
>
>   

--------------060806060304070307000303--

From java-user-return-44673-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 24 09:31:40 2010
Return-Path: <java-user-return-44673-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41455 invoked from network); 24 Jan 2010 09:31:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Jan 2010 09:31:40 -0000
Received: (qmail 52504 invoked by uid 500); 24 Jan 2010 09:31:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52425 invoked by uid 500); 24 Jan 2010 09:31:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52415 invoked by uid 99); 24 Jan 2010 09:31:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 09:31:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.85.210.192] (HELO mail-yx0-f192.google.com) (209.85.210.192)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 09:31:30 +0000
Received: by yxe30 with SMTP id 30so403297yxe.29
        for <java-user@lucene.apache.org>; Sun, 24 Jan 2010 01:31:09 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.172.2 with SMTP id u2mr6740774ybe.81.1264325468924; Sun, 
	24 Jan 2010 01:31:08 -0800 (PST)
In-Reply-To: <B6031CA1-C441-4EC1-ACC7-83AAF8730842@activemath.org>
References: <B6031CA1-C441-4EC1-ACC7-83AAF8730842@activemath.org>
Date: Sun, 24 Jan 2010 04:31:08 -0500
Message-ID: <9ac0c6aa1001240131p216c63bctf9d34576dafd3cdc@mail.gmail.com>
Subject: Re: are Lucene queries thread-safe?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

That's perfectly fine.

Mike

On Sat, Jan 23, 2010 at 5:50 PM, Paul Libbrecht <paul@activemath.org> wrote:
>
> Hello list,
>
> for some strange reason I wish to cache very frequent (and big, ~3000 terms)
> queries.
> Now, this might mean that a query is searched for in several threads on the
> same index. Do I run a risk?
>
> thanks in advance
>
> paul
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44674-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 24 14:24:08 2010
Return-Path: <java-user-return-44674-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20795 invoked from network); 24 Jan 2010 14:24:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 24 Jan 2010 14:24:08 -0000
Received: (qmail 65474 invoked by uid 500); 24 Jan 2010 14:24:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65322 invoked by uid 500); 24 Jan 2010 14:24:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65267 invoked by uid 99); 24 Jan 2010 14:24:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 14:24:05 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=HTML_FONT_FACE_BAD,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of r.ventaglio@gmail.com designates 209.85.220.213 as permitted sender)
Received: from [209.85.220.213] (HELO mail-fx0-f213.google.com) (209.85.220.213)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 24 Jan 2010 14:23:58 +0000
Received: by fxm5 with SMTP id 5so2614511fxm.11
        for <java-user@lucene.apache.org>; Sun, 24 Jan 2010 06:23:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=m2/LpXisDOp0mQnZI2sHxN1tPa5/V6YS0+1+rzJ22Es=;
        b=RFG7dKLy2WtXDAcDFpPMtAUPsnGdiYPwAWuolLprQnvO5u9Oj9fQqZqO2dGPfR/Zfs
         phKEhnaNg5XSoyFki6SgXQwJnSfbtwB6K7X6nkDY6qOR4eD3XwXXsEM3PB05DO54J/qL
         bfF9oThYOkOiszRZ2YICe2j4NQR2+enZoY+gA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=SNLwFJWyIbIci5qJmPeJAeotQFKlIuTAGNIqmA7lEJs8Jx4y7D8SdVh9kwWwQaHXP8
         o+Al994y3pi9YhpwFo7hs1VQoyEnAWX77HjMJqpiAHsSDrmiITUzeNpzdH428IJ8jDeK
         /wxCZS1NaPsADRXkV7Yr98/KGBOWlpnVPXe5Q=
MIME-Version: 1.0
Received: by 10.103.50.2 with SMTP id c2mr2751387muk.9.1264343017098; Sun, 24 
	Jan 2010 06:23:37 -0800 (PST)
In-Reply-To: <27292176.post@talk.nabble.com>
References: <27292118.post@talk.nabble.com> <27292176.post@talk.nabble.com>
From: Raf <r.ventaglio@gmail.com>
Date: Sun, 24 Jan 2010 15:23:17 +0100
Message-ID: <70422ecc1001240623m11104012jcf79db3704f2d19e@mail.gmail.com>
Subject: Re: Can't start Lucene App: java.io.FileNotFoundException with brand 
	new directory
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e659fd36689067047de9cc7e

--0016e659fd36689067047de9cc7e
Content-Type: text/plain; charset=ISO-8859-1

Hi,
I think you should use another IndexWriter constructor:

IndexWriter(Directory d, Analyzer a, IndexWriter.MaxFieldLength mfl)
          Constructs an IndexWriter for the index in d, first *creating it
if it does not already exist*.

Hope this helps.
Bye

Raf

On Sun, Jan 24, 2010 at 4:48 AM, jchang <jchangkihatest@gmail.com> wrote:

>
> I figured it out...but the answer leads to a new question.
>
> The problem was that I was using this constructor:
> IndexWriter(Directory d, Analyzer a, boolean create,
> IndexWriter.MaxFieldLength mfl)
>
> I passed in false for create, and if there is no index yet, it fails as I
> described.  As soon as I pass true for create, the problem goes away.  I
> guess that makes sense; if you pass false, it expects to find an index
> there.
>
> However, if I pass true, I'll overwrite my existing index (that's what the
> javadocs say, and I've found it to be true, generally, although not
> always...I can't explain the difference).
>
> I don't want to overwrite my index every time I start up, but I don't want
> to be able to start up with a new, clean index dir.  What do I do?
>
>
>

--0016e659fd36689067047de9cc7e--

From java-user-return-44675-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 25 03:24:34 2010
Return-Path: <java-user-return-44675-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26433 invoked from network); 25 Jan 2010 03:24:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Jan 2010 03:24:34 -0000
Received: (qmail 70528 invoked by uid 500); 25 Jan 2010 03:24:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70398 invoked by uid 500); 25 Jan 2010 03:24:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70388 invoked by uid 99); 25 Jan 2010 03:24:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 25 Jan 2010 03:24:31 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.163.179.220] (HELO web36106.mail.mud.yahoo.com) (66.163.179.220)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 25 Jan 2010 03:24:23 +0000
Received: (qmail 49263 invoked by uid 60001); 25 Jan 2010 03:24:01 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264389841; bh=A/kPzk+BkEBQD/0uphnnRNJg33UaTayp9QTuX5nZzEE=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=d1q223N+eKfDF5gKCGENIL5kq5LdLuE7OvQrm3NZuezRExiMdKlj52bZcAUbhG5ILjrx1eEcQsamUo6Sn1fdoDrP0pSLqw7sURu/P4dNj93ynqnN77EGOSR5mvFhOAaaTY5DxrTFhg1OFjURIjNu42pIy8BLj4Kf6nQ03sYt9ow=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=VBtbyvRSSSj4oEvxLYFykvoWqJPlIB2zShr73eDulA08oWTu6PUGuOBQJzgE6Pgr7TyyYDh3PWKgCN09mQDwIxlEIcy3XcXzbN3UOqb4GhpsrrKYoi2xi2RhM6bNwukrjnAefp0fOY1To+k3Yb4LFxcIOSAH4hXR/HJ5Zr2ZbTY=;
Message-ID: <743696.48896.qm@web36106.mail.mud.yahoo.com>
X-YMail-OSG: 233k_UQVM1nM1xB4mV6zGfEEE3WgogfA5SuuOxo1seMzedFaSGAZpNNCnTQ9gTW6ldkC_9AJnFonBKpFifGJws44CDEhA0f0.QqbpkeizC_dp.Ib0nooo2efsHeD8v_ysP.DSdj84aXrSkQavkEOYNFXLbteiqgmwe63fcGqsrtH5v9upXDdg5DY8SeQGnTMFbnUdBuMMU_EauH2sIVfh.udBOi8Z5uDhTQ3TcvzzZx6AbeHa_uRAhKqcnPHnuu4O86d1hltEaTvwIbuAEV_OJV5C.9Z9oUt3tciEhWJ0x0eMYGClgLB9hDvZGFwmS.Kwgo8QKGdh08zv7bvu0le4srJLJ2wdIuOl.B3qSqNpywS91OVinUBtrbrZz9DXyFpyqidJC6mSignIzSg7Lolic_a8tQykRpf7bWXKzHN.LgU99HXcHO2ATAUSJE3UXWOjHsz2lzUz9KFvZHb_zRzOPDNrFc4ReOkUr7jgZYZVXVP_TnMfqevJPEIgAo4zSPVJn1DcGQphPg4cbTZ.hjMfSEmL1zbyRBxXdrjljZk9J2_3AFgHngJuQMAdzJ2BnR.3inZTNnVUZNyG3Q1ipE5kWj95lju7_CmlKUF2cLp7LP3lS0MgiWqPVDjMK1v5tIzBk3AMRHaYf7cE3mQ75xtEN30xPjUCN7B.Y0AUfUU
Received: from [203.126.190.28] by web36106.mail.mud.yahoo.com via HTTP; Sun, 24 Jan 2010 19:24:01 PST
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Sun, 24 Jan 2010 19:24:01 -0800 (PST)
From: <jyzhou817@yahoo.com>
Subject: Re: Applying LUCENE-1606  -- which version
To: java-user@lucene.apache.org
In-Reply-To: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-2061192449-1264389841=:48896"

--0-2061192449-1264389841=:48896
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Hi,

I am planing to integrate Lucene into my web application. Can you please gi=
ve high level steps to follow?

Thanks
Zhou


--- On Fri, 22/1/10, Sriram Muthuswamy Chittathoor <sriramc@ivycomptech.com=
> wrote:

From: Sriram Muthuswamy Chittathoor <sriramc@ivycomptech.com>
Subject: Applying LUCENE-1606  -- which version
To: java-user@lucene.apache.org
Date: Friday, 22 January, 2010, 6:04 PM

Hi:

=20

I am trying to apply this Automata patch on my Lucene 3.0 src code but
running into issues as it is complaining about failures to apply patch
to certain files.=A0 Is this the right version

To apply to.=A0 Please help

=20

Thanks

=20

Sriram C

=20

LUCENE-1606
https://issues.apache.org/jira/browse/LUCENE-1606


This email is sent for and on behalf of Ivy Comptech Private Limited. Ivy C=
omptech Private Limited is a limited liability company.=A0=20

This email and any attachments are confidential, and may be legally privile=
ged and protected by copyright. If you are not the intended recipient disse=
mination or copying of this email is prohibited. If you have received this =
in error, please notify the sender by replying by email and then delete the=
 email completely from your system.=20
Any views or opinions are solely those of the sender.=A0 This communication=
 is not intended to form a binding contract on behalf of Ivy Comptech Priva=
te Limited unless expressly indicated to the contrary and properly authoris=
ed. Any actions taken on the basis of this email are at the recipient's own=
 risk.

Registered office:
Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills, Hyde=
rabad 500 033, Andhra Pradesh, India. Registered number: 37994. Registered =
in India. A list of members' names is available for inspection at the regis=
tered office.

=0A=0A=0A      Get your new Email address!=0AGrab the Email name you&#39;ve=
 always wanted before someone else does!=0Ahttp://mail.promotions.yahoo.com=
/newdomains/sg/
--0-2061192449-1264389841=:48896--

From java-user-return-44676-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Jan 25 13:36:04 2010
Return-Path: <java-user-return-44676-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9446 invoked from network); 25 Jan 2010 13:36:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 25 Jan 2010 13:36:04 -0000
Received: (qmail 38259 invoked by uid 500); 25 Jan 2010 13:36:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38189 invoked by uid 500); 25 Jan 2010 13:36:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38179 invoked by uid 99); 25 Jan 2010 13:36:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 25 Jan 2010 13:36:01 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 25 Jan 2010 13:35:50 +0000
Received: by ey-out-2122.google.com with SMTP id 22so550950eye.5
        for <java-user@lucene.apache.org>; Mon, 25 Jan 2010 05:35:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=8jAEPOcUbxXfXi+JMYwo9mORa+Cgpac0dYWWkH4p+2Q=;
        b=OSqrkAIgN5YcMvbsCWlkU6MZVUR12nTrk36Ra6XbOd0tIQ/WduN3FaGOcuPh7UXOM5
         l5vJvQ/YCGdS7BemR7bxUrB/TYt6YU70ntkResNUMb31vrxDwEQpjBsBr9aoDyuKtCcj
         6oqtN0MwPNmSAqWQmdU8adhSg9uEluCv4m04Y=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=SjEyb5kImef47yavN68tTDgpKezviBwXwMO0fawvXQSf+ElkRIpXtNP47Cs6mdoy5l
         lh9mjbYK5s7GKnIKVwU5Lv+ZOBO8j16JUCMA+DPpSIOlaFyQaNUdIf4SAsDacYMChPYO
         maZG7tSXG2RLtI/DDLSYK/dukkWyJoibnl4Ls=
MIME-Version: 1.0
Received: by 10.216.85.69 with SMTP id t47mr1590908wee.107.1264426530088; Mon, 
	25 Jan 2010 05:35:30 -0800 (PST)
In-Reply-To: <743696.48896.qm@web36106.mail.mud.yahoo.com>
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local>
	 <743696.48896.qm@web36106.mail.mud.yahoo.com>
Date: Mon, 25 Jan 2010 08:35:30 -0500
Message-ID: <359a92831001250535j4f2feb1bib114e9f4e7bde556@mail.gmail.com>
Subject: Re: Applying LUCENE-1606 -- which version
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d99daa2baa3c047dfd3e64
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6d99daa2baa3c047dfd3e64
Content-Type: text/plain; charset=ISO-8859-1

Two things:

1> please do not start a new subject by replying to an existing e-mail, it's
called "thread hijacking". See:
http://ubuntuforums.org/archive/index.php/t-181309.html
2> Your request is un-answerable. You've given us absolutely no details of
what you're trying to accomplish so we can't help.

Best
Erick

On Sun, Jan 24, 2010 at 10:24 PM, <jyzhou817@yahoo.com> wrote:

> Hi,
>
> I am planing to integrate Lucene into my web application. Can you please
> give high level steps to follow?
>
> Thanks
> Zhou
>
>
> --- On Fri, 22/1/10, Sriram Muthuswamy Chittathoor <
> sriramc@ivycomptech.com> wrote:
>
> From: Sriram Muthuswamy Chittathoor <sriramc@ivycomptech.com>
> Subject: Applying LUCENE-1606  -- which version
> To: java-user@lucene.apache.org
> Date: Friday, 22 January, 2010, 6:04 PM
>
> Hi:
>
>
>
> I am trying to apply this Automata patch on my Lucene 3.0 src code but
> running into issues as it is complaining about failures to apply patch
> to certain files.  Is this the right version
>
> To apply to.  Please help
>
>
>
> Thanks
>
>
>
> Sriram C
>
>
>
> LUCENE-1606
> https://issues.apache.org/jira/browse/LUCENE-1606
>
>
> This email is sent for and on behalf of Ivy Comptech Private Limited. Ivy
> Comptech Private Limited is a limited liability company.
>
> This email and any attachments are confidential, and may be legally
> privileged and protected by copyright. If you are not the intended recipient
> dissemination or copying of this email is prohibited. If you have received
> this in error, please notify the sender by replying by email and then delete
> the email completely from your system.
> Any views or opinions are solely those of the sender.  This communication
> is not intended to form a binding contract on behalf of Ivy Comptech Private
> Limited unless expressly indicated to the contrary and properly authorised.
> Any actions taken on the basis of this email are at the recipient's own
> risk.
>
> Registered office:
> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills,
> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
> Registered in India. A list of members' names is available for inspection at
> the registered office.
>
>
>
>
>       Get your new Email address!
> Grab the Email name you've always wanted before someone else does!
> http://mail.promotions.yahoo.com/newdomains/sg/

--0016e6d99daa2baa3c047dfd3e64--

From java-user-return-44677-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 01:32:48 2010
Return-Path: <java-user-return-44677-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8783 invoked from network); 26 Jan 2010 01:32:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 01:32:48 -0000
Received: (qmail 61222 invoked by uid 500); 26 Jan 2010 01:32:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61143 invoked by uid 500); 26 Jan 2010 01:32:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61131 invoked by uid 99); 26 Jan 2010 01:32:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 01:32:46 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.163.179.222] (HELO web36108.mail.mud.yahoo.com) (66.163.179.222)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 26 Jan 2010 01:32:38 +0000
Received: (qmail 16250 invoked by uid 60001); 26 Jan 2010 01:32:16 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264469536; bh=oIV2bP2Se+Wlhf3ArJCf3mn733PKS/0xXm+DDSwC8YA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=01pHte4ZQK+/5Z9+sd6zyYjN5PTgKl5l1L+VOAzlMYRlq/Gme3M59kL7ICXSP23fpdq7liNpsPaw3MIo4IHNgEdo1XSYgL6DJRXUiGdB9wMBqnQgPpk2DcwemFY0aFN+9gwW/dU6Z7vYXIiFe31yC9FKlMc1VJKNJQQoyYmkRkA=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=XdufCRWO0X7N9glaNTGG1h2h4hNadnMwCzMn9W31OKKYNlKrR7eqJNuiSNzkfqxwRVBeo6CEzMOo2f2bnF1yVQMFjk/6AmwvVNYBJMnVFh9XL0TdArGMt2AbvfpuznW/Zay8ZB8LTPTdgCXWc1nYxnYyTITJv/moiWgH4G2T8TI=;
Message-ID: <303271.13500.qm@web36108.mail.mud.yahoo.com>
X-YMail-OSG: nGMSSacVM1mkFt4M4jQ2bMCKkVDY4ykW9QZLXYtkpaHm1Yw7J_MINTqMHkXwl8gHc5rKnqwDht.xprtTgDEd9nuAhtIOdcujLa56tBATruCCLeAzCQ6EeBWs6L385UvMyMq0_kIWkIY2E5d4Z8mjhqf9X9agl3h5H8ci92sJASVmD._gBHEaX7b74vK_4q3zrg.KBeDrtoD6g8FGekQVJVcQHT2NG0KDakdzzkqOc_LOS3L7JqUpQzS3u4EldpHaCJMLzkBuR10zYCeNRY0eq3qnh6kZgNwP8WWpSUGqLBVdlb25hJjbMM2l.nZWh9ss_DhTbEn7jIobvIaiNNnan821cQjEyL173pWcju3rgtZeVFmTCMfMyB5jWUm4_6j1JIjzJjKl.zfhBYdyOSUuyzl_lmj3kdiH56gCffUlQp3wd15fOJj77PNPb229AJdQLquiHmkr2q6EnMzTxTttZFRvyKZYuKWw7cjFuNHkc1OE6UXCP0bWZAk7p2t53BfX2WDofD1waGhKEwWce2HV7EdhQKioZ9Oe5jqo2.qFTdWEYylTnteS6qVpgxyTU4sWNrw_Hmhz3UUqlGD2jmAMh5f._xanhCrFp5063aT5dXvNdzVrVXDQ.KRwW0pRHbnWUWORJfBTpbXvHhKYQz81Q12ssaXrCZI-
Received: from [203.126.190.28] by web36108.mail.mud.yahoo.com via HTTP; Mon, 25 Jan 2010 17:32:16 PST
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Mon, 25 Jan 2010 17:32:16 -0800 (PST)
From: <jyzhou817@yahoo.com>
Subject: How to implement Web Search by integrating Lucene with web application and Nutch
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1686376103-1264469536=:13500"

--0-1686376103-1264469536=:13500
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

Hi,

Does any one can tell me some high level steps to follow to build Search Fu=
nction in Web Application?

Any suggestion on tool to crawl the web site? Nutch?
Suggest steps?

Thanks
Zhou
=0A=0A=0A      
--0-1686376103-1264469536=:13500--

From java-user-return-44678-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 13:28:49 2010
Return-Path: <java-user-return-44678-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42276 invoked from network); 26 Jan 2010 13:28:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 13:28:48 -0000
Received: (qmail 31128 invoked by uid 500); 26 Jan 2010 13:28:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31024 invoked by uid 500); 26 Jan 2010 13:28:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31014 invoked by uid 99); 26 Jan 2010 13:28:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 13:28:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.142.207.230] (HELO web32603.mail.mud.yahoo.com) (68.142.207.230)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 26 Jan 2010 13:28:36 +0000
Received: (qmail 58278 invoked by uid 60001); 26 Jan 2010 13:28:15 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264512495; bh=r4JE08V54htxhTkTyN6+tvuy6Zg0sQ5+7MrAgJo3HFA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type; b=hvPr9HqRcAAnrXN9V+9pMANwngaiyZ1G2tCtqlOmD8dcTxSQ/fFfvo2QTcEM6rq3S/Jnx7b9cWoIgh9YZ/YbfDarGjzfn4m/m0l8UkzfzneE+oVVMoo0yDsume7QalSHZlX+VUqP4YPfAIDGP2kgYPq3Fc2eeyigtTtgdWuvdcI=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type;
  b=KAlx9vNZ43Xj7kxwoJrRBkaSxpGxKlTaSHqITjjr1ywAQJaXBARg3+sJZsbdTRIW8SopaPGmz4NeYZxwZQBUScplq3Ke9A67Jrsqn8aike6Qs2tU2atewukO61Lq68Nw08W6F1n4o9bX9ERBznoo5M62ddOk2NNGHbAJEZlV4Q4=;
Message-ID: <241510.57327.qm@web32603.mail.mud.yahoo.com>
X-YMail-OSG: NOoY7NkVM1nXGDyVMcxr.zQCfdwzokqf5XmeM1UUiqZx4LM5MUm_ucFpwhbsj8rJaCrUDTbd8FmqywnGHxowGpi3j8UAJ5e.5txB0fg50ObGrwvivUwHH.vrcCriTt_UM2p.KQkF5.6n2_0JZiIVCc60V3VSBo1MXNlYPf9eHUBjQow7a6tSWr.80EbP41LhOjMNHWPOQWj2kRlWqoXtn.i9PWbK.fgP6D1VpEKArlZ1FeiybGojxIbn7sU6FwbOXAEGmyZ4Q05RoNqzlw79JENYFrPLZBGjYEi.0FHrrdt0XiEgXdPO6.pkBcMdxdMwCeM_nt4XyoqvggxpQ0z0Rl05PAAfmZYh40UXt5DuczmaxUIt0J00Owgw4KL3zV_ouNZiDzoyQLK6qsps.zvgrvw4YsYEHqAo4rd4J3NS4zlAEq047fLWQcgj4QQberDtwGxJpiuwJUhawuiN3A--
Received: from [140.244.128.12] by web32603.mail.mud.yahoo.com via HTTP; Tue, 26 Jan 2010 05:28:15 PST
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Tue, 26 Jan 2010 05:28:15 -0800 (PST)
From: Ivan Provalov <iprovalo@yahoo.com>
Subject: Average Precision -  TREC-3
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

We are looking into making some improvements to relevance ranking of our search platform based on Lucene.  We started by running the Ad Hoc TREC task on the TREC-3 data using "out-of-the-box" Lucene.  The reason to run this old TREC-3 (TIPSTER Disk 1 and Disk 2; topics 151-200) data was that the content is matching the content of our production system.  

We are currently getting average precision of 0.14.  We found some format issues with the TREC-3 data which were causing even lower score.  For example, the initial average precision number was 0.9.  We discovered that the topics included the word "Topic:" in the <title> tag.  For example, 
"<title> Topic:  Coping with overcrowded prisons".  By removing this term from the queries, we bumped the average precision to 0.14.

Our query is based on the title tag of the topic and the index field is based on the <TEXT> tag of the document.  

QualityQueryParser qqParser = new SimpleQQParser("title", "TEXT");

Is there an average precision number which "out-of-the-box" Lucene should be close to?  For example, this IBM's 2007 TREC paper mentions 0.154:  
http://trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf

Thank you,

Ivan


      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44679-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 18:21:40 2010
Return-Path: <java-user-return-44679-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93661 invoked from network); 26 Jan 2010 18:21:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 18:21:40 -0000
Received: (qmail 27044 invoked by uid 500); 26 Jan 2010 18:21:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26951 invoked by uid 500); 26 Jan 2010 18:21:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26941 invoked by uid 99); 26 Jan 2010 18:21:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 18:21:38 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 18:21:29 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id DF9EB50826; Tue, 26 Jan 2010 10:21:08 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-131-61-rndf-esr-3.dynamic.isadsl.co.za [196.210.131.61])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id AF9A350823
	for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 10:21:07 -0800 (PST)
Message-ID: <4B5F328B.2020303@stimulussoft.com>
Date: Tue, 26 Jan 2010 20:20:59 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: file open handles?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-4.4 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

Hi There

I am sure if this is anything to worry about, but I thought I'd ask just 
in case.

We're trying to get a handle on our file handles, so to speak. When I 
type the following:

root@ubuntu:~# lsof | grep java

I get a whole bunch of Index files created by Lucene. Are these file 
handles still open even though the files are deleted?

We are worried about the system running out of file handles over a 
period of time since the number of open file handles
appear to be increasing due to Lucene.

Could somebody please illuminate.

Thanks

Jamie


java       5121   root 1649r      REG                8,1     13604     
247390 /var/index/vol201001/_2s5.nrm (deleted)
java       5121   root 1650r      REG                8,1      2171     
247405 /var/index/vol201001/_2s6.cfs (deleted)
java       5121   root 1651r      REG                8,1      2498     
247404 /var/index/vol201001/_2s7.cfs (deleted)
java       5121   root 1652r      REG                8,1      4552     
247406 /var/index/vol201001/_2s8.cfs (deleted)
java       5121   root 1653r      REG                8,1      1280     
247412 /var/index/vol201001/_2se.cfs (deleted)
java       5121   root 1654r      REG                8,1      1560     
247407 /var/index/vol201001/_2s9.cfs (deleted)
java       5121   root 1655r      REG                8,1     95963     
247401 /var/index/vol201001/_2sf.tis (deleted)
java       5121   root 1656r      REG                8,1      7961     
247410 /var/index/vol201001/_2sc.cfs (deleted)
java       5121   root 1657u      REG                8,1      2878     
247411 /var/index/vol201001/_2sd.cfs (deleted)
java       5121   root 1658u      REG                8,1      5271     
247409 /var/index/vol201001/_2sb.cfs (deleted)
java       5121   root 1659r      REG                8,1     26715     
247403 /var/index/vol201001/_2sf.frq (deleted)
java       5121   root 1660r      REG                8,1     19934     
247413 /var/index/vol201001/_2sf.prx (deleted)


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44680-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 18:54:51 2010
Return-Path: <java-user-return-44680-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15150 invoked from network); 26 Jan 2010 18:54:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 18:54:51 -0000
Received: (qmail 80724 invoked by uid 500); 26 Jan 2010 18:54:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80643 invoked by uid 500); 26 Jan 2010 18:54:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80633 invoked by uid 99); 26 Jan 2010 18:54:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 18:54:49 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 18:54:42 +0000
Received: by ewy2 with SMTP id 2so5820795ewy.5
        for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 10:54:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=iNb6LqAB3YoviSO+dOhWkIYOogD8YEuyGL4B2VRZpFY=;
        b=oidcIOzHinepVKJv/JSWmJ5qfuRMjhT0bcGBFUFBimDlgcFEqFIyXQduK/7zuu9iQ4
         +KUlDG6E9bxvyYSsuBI3bEMWFLIrvkIUgmVr+EDt6/sLiZOoWXIqDc6EEFfYTzJJrNsS
         b4CMTj8GyVffsK28el0k1rRppM3EVdYLWEPVo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=QZgu9v3auI6y8Bktd+gnPX+PeOPvgm0ibfhK6QvOUxe5tWSVbSclkWWeZbETyJzKxT
         p8rpbbEN+g5covp2Jz5iv1Giu5cghn2CkbAuTmdodofNFwNpcvBb1rBgnkTQ/CJOvHgX
         1tsQdVXamwL0DRrRJk72MukJ6zq+Ho7awRw1M=
MIME-Version: 1.0
Received: by 10.216.87.75 with SMTP id x53mr1193924wee.13.1264532060705; Tue, 
	26 Jan 2010 10:54:20 -0800 (PST)
In-Reply-To: <4B5F328B.2020303@stimulussoft.com>
References: <4B5F328B.2020303@stimulussoft.com>
Date: Tue, 26 Jan 2010 13:54:20 -0500
Message-ID: <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>
Subject: Re: file open handles?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6db29b54915c9047e15d052

--0016e6db29b54915c9047e15d052
Content-Type: text/plain; charset=ISO-8859-1

They should disappear when the last program holding them open
closes them or terminates. So I'm guessing that you have a
searcher or some such still accessing the files. This is why
your searcher doesn't see new additions until you reopen it,
the "snapshot" the literature talks about is just the old files.

Do note a common pitfall with Lucene's reopen is that reopen
does NOT close the underlying reader, you have to do that yourself.
See the docs for IndexReader.reopen, it even has a code snippet.

So no, don't worry about it *if* your program is closing its
IndexReaders/Writers correctly.

HTH
Erick

On Tue, Jan 26, 2010 at 1:20 PM, Jamie <jamie@stimulussoft.com> wrote:

> Hi There
>
> I am sure if this is anything to worry about, but I thought I'd ask just in
> case.
>
> We're trying to get a handle on our file handles, so to speak. When I type
> the following:
>
> root@ubuntu:~# lsof | grep java
>
> I get a whole bunch of Index files created by Lucene. Are these file
> handles still open even though the files are deleted?
>
> We are worried about the system running out of file handles over a period
> of time since the number of open file handles
> appear to be increasing due to Lucene.
>
> Could somebody please illuminate.
>
> Thanks
>
> Jamie
>
>
> java       5121   root 1649r      REG                8,1     13604
> 247390 /var/index/vol201001/_2s5.nrm (deleted)
> java       5121   root 1650r      REG                8,1      2171
> 247405 /var/index/vol201001/_2s6.cfs (deleted)
> java       5121   root 1651r      REG                8,1      2498
> 247404 /var/index/vol201001/_2s7.cfs (deleted)
> java       5121   root 1652r      REG                8,1      4552
> 247406 /var/index/vol201001/_2s8.cfs (deleted)
> java       5121   root 1653r      REG                8,1      1280
> 247412 /var/index/vol201001/_2se.cfs (deleted)
> java       5121   root 1654r      REG                8,1      1560
> 247407 /var/index/vol201001/_2s9.cfs (deleted)
> java       5121   root 1655r      REG                8,1     95963
> 247401 /var/index/vol201001/_2sf.tis (deleted)
> java       5121   root 1656r      REG                8,1      7961
> 247410 /var/index/vol201001/_2sc.cfs (deleted)
> java       5121   root 1657u      REG                8,1      2878
> 247411 /var/index/vol201001/_2sd.cfs (deleted)
> java       5121   root 1658u      REG                8,1      5271
> 247409 /var/index/vol201001/_2sb.cfs (deleted)
> java       5121   root 1659r      REG                8,1     26715
> 247403 /var/index/vol201001/_2sf.frq (deleted)
> java       5121   root 1660r      REG                8,1     19934
> 247413 /var/index/vol201001/_2sf.prx (deleted)
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6db29b54915c9047e15d052--

From java-user-return-44681-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 19:23:46 2010
Return-Path: <java-user-return-44681-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26778 invoked from network); 26 Jan 2010 19:23:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 19:23:46 -0000
Received: (qmail 47782 invoked by uid 500); 26 Jan 2010 19:23:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47709 invoked by uid 500); 26 Jan 2010 19:23:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47699 invoked by uid 99); 26 Jan 2010 19:23:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 19:23:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 19:23:35 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id 93F0B50826; Tue, 26 Jan 2010 11:23:14 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-131-61-rndf-esr-3.dynamic.isadsl.co.za [196.210.131.61])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 7CC3650823
	for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 11:23:13 -0800 (PST)
Message-ID: <4B5F4119.3050309@stimulussoft.com>
Date: Tue, 26 Jan 2010 21:23:05 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com> <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>
In-Reply-To: <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-4.6 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

Hi Erick

Our app is a long running server. Is it a problem if indexes are never 
closed? Our searchers
do see the latest snapshot as we use writer.getReader() method for fast 
searches.
In our case, the index is written to continously, and there are many 
clients reading from the
index simultaneously. Our indexing process keeps the index open at all 
times and merely
commits changes to the index. Obviously, when the server is stopped, the 
index is closed.
When searches take place, we use getReader from the IndexWriter. Should 
there be a close
taking place?

Jamie




On 2010/01/26 08:54 PM, Erick Erickson wrote:
> They should disappear when the last program holding them open
> closes them or terminates. So I'm guessing that you have a
> searcher or some such still accessing the files. This is why
> your searcher doesn't see new additions until you reopen it,
> the "snapshot" the literature talks about is just the old files.
>
> Do note a common pitfall with Lucene's reopen is that reopen
> does NOT close the underlying reader, you have to do that yourself.
> See the docs for IndexReader.reopen, it even has a code snippet.
>
> So no, don't worry about it *if* your program is closing its
> IndexReaders/Writers correctly.
>
> HTH
> Erick
>
> On Tue, Jan 26, 2010 at 1:20 PM, Jamie<jamie@stimulussoft.com>  wrote:
>
>    


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44682-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 19:40:32 2010
Return-Path: <java-user-return-44682-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31115 invoked from network); 26 Jan 2010 19:40:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 19:40:32 -0000
Received: (qmail 75546 invoked by uid 500); 26 Jan 2010 19:40:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75468 invoked by uid 500); 26 Jan 2010 19:40:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75458 invoked by uid 99); 26 Jan 2010 19:40:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 19:40:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 19:40:22 +0000
Received: by pxi16 with SMTP id 16so3461792pxi.29
        for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 11:40:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=HeJx55NrMt/j0jY8NuZ6BKNwjxp/JBmL5l/sXDrPdxA=;
        b=CYBQLrT+EntZe0aXmmtzV4uk0sYOgxKMj1JOP+XV7JTTd5bV1MZnnPvPzvh1sD5sGx
         bwb9l6nihNQehz0WQcuF4uG+3imffvkCY+W6KJnbRMDUPb3SvrpLYlPLTBy0cfWjKgw2
         rcCk04XY0m4CuNR0I4Ew96pI0GRRVuLHWrFoU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=O7cGiPL0et6sWW4nkQB3ZDsZ0g+u8lQeaTgqte+VCWUn+KKMbWM2Zxh2/QPiyzZoGR
         Yg+tIBB7sNP9ojOOe5PSb2egpK+Q/BON3mz07xzd44ETkkBLM7CLpAhJbeUeV3zf68G/
         fHnCyMUduOMYV4eQdokpZQp+NsbfNhzFXhZM0=
MIME-Version: 1.0
Received: by 10.141.89.10 with SMTP id r10mr4672278rvl.69.1264534801149; Tue, 
	26 Jan 2010 11:40:01 -0800 (PST)
In-Reply-To: <4B5F4119.3050309@stimulussoft.com>
References: <4B5F328B.2020303@stimulussoft.com>
	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>
	 <4B5F4119.3050309@stimulussoft.com>
Date: Tue, 26 Jan 2010 11:40:01 -0800
Message-ID: <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>
Subject: Re: file open handles?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Jamie,

Are you calling close on the reader?

Jason

On Tue, Jan 26, 2010 at 11:23 AM, Jamie <jamie@stimulussoft.com> wrote:
> Hi Erick
>
> Our app is a long running server. Is it a problem if indexes are never
> closed? Our searchers
> do see the latest snapshot as we use writer.getReader() method for fast
> searches.
> In our case, the index is written to continously, and there are many clie=
nts
> reading from the
> index simultaneously. Our indexing process keeps the index open at all ti=
mes
> and merely
> commits changes to the index. Obviously, when the server is stopped, the
> index is closed.
> When searches take place, we use getReader from the IndexWriter. Should
> there be a close
> taking place?
>
> Jamie
>
>
>
>
> On 2010/01/26 08:54 PM, Erick Erickson wrote:
>>
>> They should disappear when the last program holding them open
>> closes them or terminates. So I'm guessing that you have a
>> searcher or some such still accessing the files. This is why
>> your searcher doesn't see new additions until you reopen it,
>> the "snapshot" the literature talks about is just the old files.
>>
>> Do note a common pitfall with Lucene's reopen is that reopen
>> does NOT close the underlying reader, you have to do that yourself.
>> See the docs for IndexReader.reopen, it even has a code snippet.
>>
>> So no, don't worry about it *if* your program is closing its
>> IndexReaders/Writers correctly.
>>
>> HTH
>> Erick
>>
>> On Tue, Jan 26, 2010 at 1:20 PM, Jamie<jamie@stimulussoft.com> =A0wrote:
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44683-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 19:46:07 2010
Return-Path: <java-user-return-44683-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32271 invoked from network); 26 Jan 2010 19:46:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 19:46:07 -0000
Received: (qmail 82128 invoked by uid 500); 26 Jan 2010 19:46:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82052 invoked by uid 500); 26 Jan 2010 19:46:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82042 invoked by uid 99); 26 Jan 2010 19:46:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 19:46:04 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 19:45:56 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id AEC7D50826; Tue, 26 Jan 2010 11:45:36 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-131-61-rndf-esr-3.dynamic.isadsl.co.za [196.210.131.61])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id AA1E250823
	for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 11:45:35 -0800 (PST)
Message-ID: <4B5F4658.3000902@stimulussoft.com>
Date: Tue, 26 Jan 2010 21:45:28 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com>	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>	 <4B5F4119.3050309@stimulussoft.com> <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>
In-Reply-To: <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-4.7 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

Hi Jason

No .I wasn't sure whether I needed to or not. We have just switched over 
to using the the writer.getReader() method and was worried if I closed 
the Reader that the Writer would be closed too. Is this misguided?

Jamie


On 2010/01/26 09:40 PM, Jason Rutherglen wrote:
> Jamie,
>
> Are you calling close on the reader?
>
> Jason
>
> On Tue, Jan 26, 2010 at 11:23 AM, Jamie<jamie@stimulussoft.com>  wrote:
>    
>> Hi
>>      


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44684-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 20:04:31 2010
Return-Path: <java-user-return-44684-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37356 invoked from network); 26 Jan 2010 20:04:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 20:04:29 -0000
Received: (qmail 3738 invoked by uid 500); 26 Jan 2010 20:04:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3663 invoked by uid 500); 26 Jan 2010 20:04:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3653 invoked by uid 99); 26 Jan 2010 20:04:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 20:04:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.222.178 as permitted sender)
Received: from [209.85.222.178] (HELO mail-pz0-f178.google.com) (209.85.222.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 20:04:19 +0000
Received: by pzk8 with SMTP id 8so1893009pzk.29
        for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 12:03:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=oRyn/8y0Us3GU5g2TI323yLVOtZ6KI1en9CT3VVUeZE=;
        b=n0wWoYtHmqIukrb+oA5MPZ5ui/aCFMSc0iTLRxWbtb4ewSlKsUJj+jwknTkOLjSDux
         8AP9Rqa7IOpV226sD1HF/F02f7q64ikSZ4jugYhbyaT5UW8r3MfgZQOvF7ZoArezv0It
         /Eu+YYfrHhqQ2nB+OT2eircT9IqncXq+seZAk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=Ic3I7NAP/QIOh9+Skfgu/8h9CJImrN6nleknZo0JeHjO8gy+BHNKl2lubWPP/WOH4x
         ag+UdXzVgTL35h6Tbs7pNuIvpXbWUg130jKlIbrO/ZXd3v5JuMN22XquGV4BFIvGoRz/
         B/Bie4EkDY4WLi2VoRtqLEMZee6klUB7KbieE=
MIME-Version: 1.0
Received: by 10.141.91.15 with SMTP id t15mr5895390rvl.152.1264536238028; Tue, 
	26 Jan 2010 12:03:58 -0800 (PST)
In-Reply-To: <4B5F4658.3000902@stimulussoft.com>
References: <4B5F328B.2020303@stimulussoft.com>
	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>
	 <4B5F4119.3050309@stimulussoft.com>
	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>
	 <4B5F4658.3000902@stimulussoft.com>
Date: Tue, 26 Jan 2010 12:03:57 -0800
Message-ID: <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>
Subject: Re: file open handles?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

You can call close on the reader obtained via writer.getReader.  Well,
actually, you'll need to.  :)  The underlying writer will not be
affected though.

On Tue, Jan 26, 2010 at 11:45 AM, Jamie <jamie@stimulussoft.com> wrote:
> Hi Jason
>
> No .I wasn't sure whether I needed to or not. We have just switched over =
to
> using the the writer.getReader() method and was worried if I closed the
> Reader that the Writer would be closed too. Is this misguided?
>
> Jamie
>
>
> On 2010/01/26 09:40 PM, Jason Rutherglen wrote:
>>
>> Jamie,
>>
>> Are you calling close on the reader?
>>
>> Jason
>>
>> On Tue, Jan 26, 2010 at 11:23 AM, Jamie<jamie@stimulussoft.com> =A0wrote=
:
>>
>>>
>>> Hi
>>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44685-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 20:10:12 2010
Return-Path: <java-user-return-44685-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39751 invoked from network); 26 Jan 2010 20:10:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 20:10:12 -0000
Received: (qmail 14555 invoked by uid 500); 26 Jan 2010 20:10:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14471 invoked by uid 500); 26 Jan 2010 20:10:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14461 invoked by uid 99); 26 Jan 2010 20:10:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 20:10:09 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 20:10:00 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id 2D62250826; Tue, 26 Jan 2010 12:09:39 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-131-61-rndf-esr-3.dynamic.isadsl.co.za [196.210.131.61])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 31E0C50823
	for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 12:09:37 -0800 (PST)
Message-ID: <4B5F4BFA.6050901@stimulussoft.com>
Date: Tue, 26 Jan 2010 22:09:30 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com>	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>	 <4B5F4119.3050309@stimulussoft.com>	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>	 <4B5F4658.3000902@stimulussoft.com> <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>
In-Reply-To: <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-4.8 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

HI Jason

Thanks a ton. Problem solved. No more stray file handles!

Jamie

On 2010/01/26 10:03 PM, Jason Rutherglen wrote:
> You can call close on the reader obtained via writer.getReader.  Well,
> actually, you'll need to.  :)  The underlying writer will not be
> affected though.
>
> On Tue, Jan 26, 2010 at 11:45 AM, Jamie<jamie@stimulussoft.com>  wrote:
>    
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44686-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Jan 26 20:59:07 2010
Return-Path: <java-user-return-44686-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56209 invoked from network); 26 Jan 2010 20:59:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 26 Jan 2010 20:59:07 -0000
Received: (qmail 73257 invoked by uid 500); 26 Jan 2010 20:59:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73165 invoked by uid 500); 26 Jan 2010 20:59:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73155 invoked by uid 99); 26 Jan 2010 20:59:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 20:59:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 26 Jan 2010 20:58:57 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id 71C0050826; Tue, 26 Jan 2010 12:58:36 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-131-61-rndf-esr-3.dynamic.isadsl.co.za [196.210.131.61])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 3C81D50823
	for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 12:58:33 -0800 (PST)
Message-ID: <4B5F5771.4080009@stimulussoft.com>
Date: Tue, 26 Jan 2010 22:58:25 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com>	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>	 <4B5F4119.3050309@stimulussoft.com>	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>	 <4B5F4658.3000902@stimulussoft.com> <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com> <4B5F4BFA.6050901@stimulussoft.com>
In-Reply-To: <4B5F4BFA.6050901@stimulussoft.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-4.9 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

Ok. I spoke too soon. The problem is not solved. I am still seeing these 
file handles lying around. Is this something I should be worried about?
We are now closing the IndexReader but the IndexWriter remains open 
through out the running of the program.

problem is not solved
s# lsof | grep index |  awk '{n++}; END {print n+0}'
730
  java      17558   root  898r      REG                8,1   1690991     
246658 /var/index/vol201001/_5q1.cfs
java      17558   root  899r      REG                8,1     76354     
246657 /var/index/vol201001/_5q1.nrm (deleted)
java      17558   root  900r      REG                8,1      4886     
246661 /var/index/vol201001/_5q2.cfs (deleted)
java      17558   root  901r      REG                8,1     19859     
246660 /var/index/vol201001/_5q3.cfs (deleted)
java      17558   root  902r      REG                8,1      3213     
246662 /var/index/vol201001/_5q4.cfs (deleted)
java      17558   root  903r      REG                8,1      1294     
246663 /var/index/vol201001/_5q5.cfs (deleted)

On 2010/01/26 10:09 PM, Jamie wrote:
> HI Jason
>
> Thanks a ton. Problem solved. No more stray file handles!
>
> Jamie
>
> On 2010/01/26 10:03 PM, Jason Rutherglen wrote:
>> You can call close on the reader obtained via writer.getReader.  Well,
>> actually, you'll need to.  :)  The underlying writer will not be
>> affected though.
>>
>> On Tue, Jan 26, 2010 at 11:45 AM, Jamie<jamie@stimulussoft.com>  wrote:
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44687-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 00:32:51 2010
Return-Path: <java-user-return-44687-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45232 invoked from network); 27 Jan 2010 00:32:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 00:32:51 -0000
Received: (qmail 30941 invoked by uid 500); 27 Jan 2010 00:32:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30867 invoked by uid 500); 27 Jan 2010 00:32:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30857 invoked by uid 99); 27 Jan 2010 00:32:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 00:32:48 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jason.rutherglen@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 00:32:40 +0000
Received: by pwi11 with SMTP id 11so3533841pwi.5
        for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 16:32:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=SkyhYbw9qawY05ZQ94U6ACE961/z5ap06yOpP7fiJ1U=;
        b=HT62NjUHgEzzOS7eCecWeWdirR5WXuXCn7FncokLjbSQXltKDkFz+NF5nitHRVRmM9
         NPLvwdMOH96GlWu3kXZwm1WBVv4kbOTOJZUO8aWsShhw/E6CU4STQ8rQiVJ33VdMUk70
         Y3PMH525i4NxvIuEoFNiFReMQkIvn2CSNteYY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=UT514Kyv3WjCIGwJpVWM/sp6lNY9+o9GThDa215rrMnb74wZ7xx1j+SVVeOY3JM2g7
         egVtbjUjYugeQOQAKW3sqJqCJHW3Znoc+H/SBNSeyaXA8vFfvjzIO4R/aTOlPPPKlO8X
         wbUHtARrYLBzsL9M6sxsAJ6mB8UmDa3+qxrIY=
MIME-Version: 1.0
Received: by 10.141.89.10 with SMTP id r10mr4878738rvl.69.1264552338740; Tue, 
	26 Jan 2010 16:32:18 -0800 (PST)
In-Reply-To: <4B5F5771.4080009@stimulussoft.com>
References: <4B5F328B.2020303@stimulussoft.com>
	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>
	 <4B5F4119.3050309@stimulussoft.com>
	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>
	 <4B5F4658.3000902@stimulussoft.com>
	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>
	 <4B5F4BFA.6050901@stimulussoft.com>
	 <4B5F5771.4080009@stimulussoft.com>
Date: Tue, 26 Jan 2010 16:32:18 -0800
Message-ID: <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>
Subject: Re: file open handles?
From: Jason Rutherglen <jason.rutherglen@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Jamie,

How often are you calling getReader?  Is it only these files?

Jason

On Tue, Jan 26, 2010 at 12:58 PM, Jamie <jamie@stimulussoft.com> wrote:
> Ok. I spoke too soon. The problem is not solved. I am still seeing these
> file handles lying around. Is this something I should be worried about?
> We are now closing the IndexReader but the IndexWriter remains open throu=
gh
> out the running of the program.
>
> problem is not solved
> s# lsof | grep index | =A0awk '{n++}; END {print n+0}'
> 730
> =A0java =A0 =A0 =A017558 =A0 root =A0898r =A0 =A0 =A0REG =A0 =A0 =A0 =A0 =
=A0 =A0 =A0 =A08,1 =A0 1690991
> 246658 /var/index/vol201001/_5q1.cfs
> java =A0 =A0 =A017558 =A0 root =A0899r =A0 =A0 =A0REG =A0 =A0 =A0 =A0 =A0=
 =A0 =A0 =A08,1 =A0 =A0 76354
> 246657 /var/index/vol201001/_5q1.nrm (deleted)
> java =A0 =A0 =A017558 =A0 root =A0900r =A0 =A0 =A0REG =A0 =A0 =A0 =A0 =A0=
 =A0 =A0 =A08,1 =A0 =A0 =A04886
> 246661 /var/index/vol201001/_5q2.cfs (deleted)
> java =A0 =A0 =A017558 =A0 root =A0901r =A0 =A0 =A0REG =A0 =A0 =A0 =A0 =A0=
 =A0 =A0 =A08,1 =A0 =A0 19859
> 246660 /var/index/vol201001/_5q3.cfs (deleted)
> java =A0 =A0 =A017558 =A0 root =A0902r =A0 =A0 =A0REG =A0 =A0 =A0 =A0 =A0=
 =A0 =A0 =A08,1 =A0 =A0 =A03213
> 246662 /var/index/vol201001/_5q4.cfs (deleted)
> java =A0 =A0 =A017558 =A0 root =A0903r =A0 =A0 =A0REG =A0 =A0 =A0 =A0 =A0=
 =A0 =A0 =A08,1 =A0 =A0 =A01294
> 246663 /var/index/vol201001/_5q5.cfs (deleted)
>
> On 2010/01/26 10:09 PM, Jamie wrote:
>>
>> HI Jason
>>
>> Thanks a ton. Problem solved. No more stray file handles!
>>
>> Jamie
>>
>> On 2010/01/26 10:03 PM, Jason Rutherglen wrote:
>>>
>>> You can call close on the reader obtained via writer.getReader. =A0Well=
,
>>> actually, you'll need to. =A0:) =A0The underlying writer will not be
>>> affected though.
>>>
>>> On Tue, Jan 26, 2010 at 11:45 AM, Jamie<jamie@stimulussoft.com> =A0wrot=
e:
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44688-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 06:12:29 2010
Return-Path: <java-user-return-44688-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67458 invoked from network); 27 Jan 2010 06:12:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 06:12:29 -0000
Received: (qmail 93370 invoked by uid 500); 27 Jan 2010 06:12:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93215 invoked by uid 500); 27 Jan 2010 06:12:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93205 invoked by uid 99); 27 Jan 2010 06:12:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 06:12:26 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 06:12:17 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id A7C4050826; Tue, 26 Jan 2010 22:11:56 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-246-241.dynamic.isadsl.co.za [196.210.246.241])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 982605081F
	for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 22:11:54 -0800 (PST)
Message-ID: <4B5FD921.9060700@stimulussoft.com>
Date: Wed, 27 Jan 2010 08:11:45 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com>	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>	 <4B5F4119.3050309@stimulussoft.com>	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>	 <4B5F4658.3000902@stimulussoft.com>	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>	 <4B5F4BFA.6050901@stimulussoft.com>	 <4B5F5771.4080009@stimulussoft.com> <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>
In-Reply-To: <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-5.0 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

Hi Jason

I am calling it each time the search takes place. It is no only these 
files, there are more.
In fact, the number of files increases quite frequently. I am seriously 
worried that we will
run out of file handles after a period of time.

I am calling getReader every time a search takes place. The writer stays 
open all the time.
I am reluctant to think its a reader issue, as this happens even if I do 
not execute any searches.
We are using Lucene 2.9.1.

Are these files not left over from a merge process? Is lucene closing 
its file handles before
deleting the files? Any further ideas?

Jamie

On 2010/01/27 02:32 AM, Jason Rutherglen wrote:
> Jamie,
>
> How often are you calling getReader?  Is it only these files?
>
> Jason
>
> On Tue, Jan 26, 2010 at 12:58 PM, Jamie<jamie@stimulussoft.com>  wrote:
>    
>> Ok. I spoke too soon. The problem is not solved. I am still seeing these
>> file handles lying around. Is this something I should be worried about?
>> We are now closing the IndexReader but the IndexWriter remains open through
>> out the running of the program.
>>
>> problem is not solved
>> s# lsof | grep index |  awk '{n++}; END {print n+0}'
>> 730
>>   java      17558   root  898r      REG                8,1   1690991
>> 246658 /var/index/vol201001/_5q1.cfs
>> java      17558   root  899r      REG                8,1     76354
>> 246657 /var/index/vol201001/_5q1.nrm (deleted)
>> java      17558   root  900r      REG                8,1      4886
>> 246661 /var/index/vol201001/_5q2.cfs (deleted)
>> java      17558   root  901r      REG                8,1     19859
>> 246660 /var/index/vol201001/_5q3.cfs (deleted)
>> java      17558   root  902r      REG                8,1      3213
>> 246662 /var/index/vol201001/_5q4.cfs (deleted)
>> java      17558   root  903r      REG                8,1      1294
>> 246663 /var/index/vol201001/_5q5.cfs (deleted)
>>
>> On 2010/01/26 10:09 PM, Jamie wrote:
>>      
>>>        


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44689-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 06:43:02 2010
Return-Path: <java-user-return-44689-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88968 invoked from network); 27 Jan 2010 06:43:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 06:43:02 -0000
Received: (qmail 26605 invoked by uid 500); 27 Jan 2010 06:43:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26386 invoked by uid 500); 27 Jan 2010 06:42:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26373 invoked by uid 99); 27 Jan 2010 06:42:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 06:42:57 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jake.mannix@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 06:42:46 +0000
Received: by pwi11 with SMTP id 11so3723949pwi.5
        for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 22:42:24 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=qvRBVOXA9fUpZxhzGZo5eThmIVarobdWgFtBohGHN7Y=;
        b=Wdn309Ejtyjh+j8YPiW13kMqqXdYZjn7S54Zs26L1Sf56Fo7CqP6GLlDwc5BSaBa6/
         GX5enW7y+q9rXH+6hJ2wTFkMKraEnm0PBV3QHcBKa/KMrapUFzJlwhp+5tongxZnMIXL
         7xL81FA5iT83ioBXAsSfJi4ZD8zZw9SK+t/Ps=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=mTgKe9F255gKHTl+2HNfpUG7rELbTjvwsylWBNlf+zVSi0x9TWTHrmLmQNIEmmyXPO
         J7TMnen65BO6fVygDWa/aP4WHEsPi9cMZTqha3bGUzm/YHOJ2GxDzyLozvP75uxJVtuO
         wx/KQmezSUMJcYr8BRH+CsOxU28xhzhHtmW4I=
MIME-Version: 1.0
Received: by 10.115.84.8 with SMTP id m8mr6273473wal.201.1264574544164; Tue, 
	26 Jan 2010 22:42:24 -0800 (PST)
In-Reply-To: <4B5FD921.9060700@stimulussoft.com>
References: <4B5F328B.2020303@stimulussoft.com>
	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>
	 <4B5F4119.3050309@stimulussoft.com>
	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>
	 <4B5F4658.3000902@stimulussoft.com>
	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>
	 <4B5F4BFA.6050901@stimulussoft.com>
	 <4B5F5771.4080009@stimulussoft.com>
	 <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>
	 <4B5FD921.9060700@stimulussoft.com>
Date: Tue, 26 Jan 2010 22:42:24 -0800
Message-ID: <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>
Subject: Re: file open handles?
From: Jake Mannix <jake.mannix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64e575e7f364d047e1fb42a
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64e575e7f364d047e1fb42a
Content-Type: text/plain; charset=ISO-8859-1

Hi Jamie,

  How fast are you indexing (number of documents per second)?  We also ran
into this
when trying to perf test heavy query throughput while doing rapid indexing
under exactly
these conditions: call getReader() every time a search is executed (so that
it's "really
real time").

  The answer is that calling getReader() on every search request is really
not a supported
operation under heavy indexing load, currently.  You are advised to cache
the reader you
get from this call, and only refresh once per some interval of time
(determined by your need:
if you need real-time up to every 5 seconds, refresh every 5s.  If you need
every second,
refresh every second, etc).

  If you really want to have the functionality of being able to get a
completely fresh view
of the index on each search, look at the Zoie project (
http://zoie.googlecode.com ), an
Apache-licensed realtime search system built on top of Lucene which we
open-sourced
out of LinkedIn a couple of years ago.  Zoie allows for immediate reopen on
request,
and handles enormously heavy indexing and query load (I recently demo'ed
zoie to
the guys at Twitter at a tech-talk, and showed off indexing about 1500
tweets per
second (it could have done more, but it was virtualized disk - EC2) while
slamming
it with full-throttle query throughput, all while reopening for each
request, and it didn't
fall over).  If you want to try it out, drop me a line and I can help if you
need any.

  -jake

On Tue, Jan 26, 2010 at 10:11 PM, Jamie <jamie@stimulussoft.com> wrote:

> Hi Jason
>
> I am calling it each time the search takes place. It is no only these
> files, there are more.
> In fact, the number of files increases quite frequently. I am seriously
> worried that we will
> run out of file handles after a period of time.
>
> I am calling getReader every time a search takes place. The writer stays
> open all the time.
> I am reluctant to think its a reader issue, as this happens even if I do
> not execute any searches.
> We are using Lucene 2.9.1.
>
> Are these files not left over from a merge process? Is lucene closing its
> file handles before
> deleting the files? Any further ideas?
>
> Jamie
>
>
> On 2010/01/27 02:32 AM, Jason Rutherglen wrote:
>
>> Jamie,
>>
>> How often are you calling getReader?  Is it only these files?
>>
>> Jason
>>
>> On Tue, Jan 26, 2010 at 12:58 PM, Jamie<jamie@stimulussoft.com>  wrote:
>>
>>
>>> Ok. I spoke too soon. The problem is not solved. I am still seeing these
>>> file handles lying around. Is this something I should be worried about?
>>> We are now closing the IndexReader but the IndexWriter remains open
>>> through
>>> out the running of the program.
>>>
>>> problem is not solved
>>> s# lsof | grep index |  awk '{n++}; END {print n+0}'
>>> 730
>>>  java      17558   root  898r      REG                8,1   1690991
>>> 246658 /var/index/vol201001/_5q1.cfs
>>> java      17558   root  899r      REG                8,1     76354
>>> 246657 /var/index/vol201001/_5q1.nrm (deleted)
>>> java      17558   root  900r      REG                8,1      4886
>>> 246661 /var/index/vol201001/_5q2.cfs (deleted)
>>> java      17558   root  901r      REG                8,1     19859
>>> 246660 /var/index/vol201001/_5q3.cfs (deleted)
>>> java      17558   root  902r      REG                8,1      3213
>>> 246662 /var/index/vol201001/_5q4.cfs (deleted)
>>> java      17558   root  903r      REG                8,1      1294
>>> 246663 /var/index/vol201001/_5q5.cfs (deleted)
>>>
>>> On 2010/01/26 10:09 PM, Jamie wrote:
>>>
>>>
>>>>
>>>>
>>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64e575e7f364d047e1fb42a--

From java-user-return-44690-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 07:13:45 2010
Return-Path: <java-user-return-44690-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96346 invoked from network); 27 Jan 2010 07:13:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 07:13:44 -0000
Received: (qmail 43843 invoked by uid 500); 27 Jan 2010 07:13:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43771 invoked by uid 500); 27 Jan 2010 07:13:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43761 invoked by uid 99); 27 Jan 2010 07:13:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 07:13:41 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 07:13:31 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id C24D550826; Tue, 26 Jan 2010 23:13:10 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-246-241.dynamic.isadsl.co.za [196.210.246.241])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 943CB5081F
	for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 23:13:09 -0800 (PST)
Message-ID: <4B5FE77C.5040700@stimulussoft.com>
Date: Wed, 27 Jan 2010 09:13:00 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com>	 <359a92831001261054r1d63bd7dh4b4bc7020f93ad85@mail.gmail.com>	 <4B5F4119.3050309@stimulussoft.com>	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>	 <4B5F4658.3000902@stimulussoft.com>	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>	 <4B5F4BFA.6050901@stimulussoft.com>	 <4B5F5771.4080009@stimulussoft.com>	 <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>	 <4B5FD921.9060700@stimulussoft.com> <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>
In-Reply-To: <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-5.0 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4


Hi Jake

Thanks for the info. Are you specifically referring to 
http://issues.apache.org/jira/browse/LUCENE-2120?
Our app indexes about 170 50k documents per second in heavy load. In any 
case, I doubt it is the
realtime IndexReader issue since when we ran the test, no searching was 
taking place.

We have been using Lucene search on a real time basis for years and have 
not experienced any problems
until now. Thanks for the tip on Zoie, but we cannot use any additional 
frameworks on top of Lucene
as Lucene is now deeply integrated into our app.

Regards,

Jamie



On 2010/01/27 08:42 AM, Jake Mannix wrote:
> Hi Jamie,
>
>    How fast are you indexing (number of documents per second)?  We also ran
> into this
> when trying to perf test heavy query throughput while doing rapid indexing
> under exactly
> these conditions: call getReader() every time a search is executed (so that
> it's "really
> real time").
>
>    The answer is that calling getReader() on every search request is really
> not a supported
> operation under heavy indexing load, currently.  You are advised to cache
> the reader you
> get from this call, and only refresh once per some interval of time
> (determined by your need:
> if you need real-time up to every 5 seconds, refresh every 5s.  If you need
> every second,
> refresh every second, etc).
>
>    If you really want to have the functionality of being able to get a
> completely fresh view
> of the index on each search, look at the Zoie project (
> http://zoie.googlecode.com ), an
> Apache-licensed realtime search system built on top of Lucene which we
> open-sourced
> out of LinkedIn a couple of years ago.  Zoie allows for immediate reopen on
> request,
> and handles enormously heavy indexing and query load (I recently demo'ed
> zoie to
> the guys at Twitter at a tech-talk, and showed off indexing about 1500
> tweets per
> second (it could have done more, but it was virtualized disk - EC2) while
> slamming
> it with full-throttle query throughput, all while reopening for each
> request, and it didn't
> fall over).  If you want to try it out, drop me a line and I can help if you
> need any.
>
>    -jake


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44691-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 07:27:40 2010
Return-Path: <java-user-return-44691-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98681 invoked from network); 27 Jan 2010 07:27:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 07:27:40 -0000
Received: (qmail 54720 invoked by uid 500); 27 Jan 2010 07:27:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54653 invoked by uid 500); 27 Jan 2010 07:27:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54643 invoked by uid 99); 27 Jan 2010 07:27:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 07:27:37 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jake.mannix@gmail.com designates 209.85.222.178 as permitted sender)
Received: from [209.85.222.178] (HELO mail-pz0-f178.google.com) (209.85.222.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 07:27:29 +0000
Received: by pzk8 with SMTP id 8so2276851pzk.29
        for <java-user@lucene.apache.org>; Tue, 26 Jan 2010 23:27:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=3cGhZ/nVIGvEJlq0+s9niMPRDVH+SsCZygfxuMC6q9s=;
        b=pzlxJC/N7A/84Fx0XVDrMrxP1Nr/Bo9cWZgxEwHjIyFuNSNGy7ESgtX+vy4K4TkoH8
         o29DpY7rZr2zFnUyZPgb29bEMCOfQ6WLIfUFiZsCnUcAbikQBExd6cjdWntgghK0k9d2
         yk8Zk/MBoYX9iSnATVHfCs66Jb5XR51XQfmK4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=dS0OFyYjZgFl5hAaHoGKN6hLzmsF+Tt9qAMA556xm7ux9LDqbtzbCMUyHmBuf+d689
         rLlmgsBtiLXE8rVlGJ5ZxtpZoBJPnYUpKNLv6Y13GqZnlz6pnHvKMmCAAZKXA7hguh9w
         hYi0XQoBiMCehhnuupuHwNzecjQsHdqcfNZMQ=
MIME-Version: 1.0
Received: by 10.115.112.6 with SMTP id p6mr1624548wam.7.1264577227918; Tue, 26 
	Jan 2010 23:27:07 -0800 (PST)
In-Reply-To: <4B5FE77C.5040700@stimulussoft.com>
References: <4B5F328B.2020303@stimulussoft.com>
	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>
	 <4B5F4658.3000902@stimulussoft.com>
	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>
	 <4B5F4BFA.6050901@stimulussoft.com>
	 <4B5F5771.4080009@stimulussoft.com>
	 <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>
	 <4B5FD921.9060700@stimulussoft.com>
	 <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>
	 <4B5FE77C.5040700@stimulussoft.com>
Date: Tue, 26 Jan 2010 23:27:07 -0800
Message-ID: <4b124c311001262327y47aaac05n2abeb6272fde5fa9@mail.gmail.com>
Subject: Re: file open handles?
From: Jake Mannix <jake.mannix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e649c4ee760dac047e20541d
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e649c4ee760dac047e20541d
Content-Type: text/plain; charset=ISO-8859-1

On Tue, Jan 26, 2010 at 11:13 PM, Jamie <jamie@stimulussoft.com> wrote:

>
> Hi Jake
>
> Thanks for the info. Are you specifically referring to
> http://issues.apache.org/jira/browse/LUCENE-2120?
>

Yep, that's the issue I'm referring to.


> Our app indexes about 170 50k documents per second in heavy load. In any
> case, I doubt it is the
> realtime IndexReader issue since when we ran the test, no searching was
> taking place.
>

You were indexing but not searching?  So you are never calling getReader()
in the first place?


> We have been using Lucene search on a real time basis for years and have
> not experienced any problems
> until now.


How have you been doing search in a realtime fashion with Lucene before
2.9's introduction of
IndexWriter.getReader()?


> Thanks for the tip on Zoie, but we cannot use any additional frameworks on
> top of Lucene
> as Lucene is now deeply integrated into our app.
>

Zoie is a library, it integrates right at the lowest layer in search apps -
you give it the directory
in which your index lives (on a per-shard level, if you have a distributed
setup), and the inputs /
outputs are simple:

 * wherever you used to call IndexWriter.addDocument(), you instead pass the
Document
wrapped in a thin wrapper to ZoieSystem.consume()
 * whenever you want an IndexReader (possibly a subclass of IndexReader
which is one of
your own custom classes) which will get wrapped in an IndexSearcher or
whatnot, just do
new MultiReader(ZoieSystem.getReaders()).

The real-timeyness is handled inside of ZoieSystem, but you control your own
Analyzer
choices, how you create your IndexReader (and what class it is, and how it
should be
initialized or warmed up, etc...).  It's pretty non-invasive - your index
format doesn't change
at all (there's an extra field added - "_UID_", but it only adds one 8-byte
long per document
to the index as a Payload), and you can have your own custom search code all
over the
place (Collectors, custom sorts, DIY faceting, whatever), because at the end
of the day,
Zoie just sucks in your documents, indexes them and makes them immediately
available
in the form of a couple of IndexReader instances, which you can search with
in whatever
low-level way you wish.

  -jake

--0016e649c4ee760dac047e20541d--

From java-user-return-44692-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 07:42:54 2010
Return-Path: <java-user-return-44692-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1063 invoked from network); 27 Jan 2010 07:42:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 07:42:54 -0000
Received: (qmail 65538 invoked by uid 500); 27 Jan 2010 07:42:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65458 invoked by uid 500); 27 Jan 2010 07:42:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65448 invoked by uid 99); 27 Jan 2010 07:42:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 07:42:51 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of sriramc@ivycomptech.com designates 203.153.210.130 as permitted sender)
Received: from [203.153.210.130] (HELO ivymail.ivycomptech.com) (203.153.210.130)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 07:42:41 +0000
Received: from hydsvwin800.ivycomptech.partygaming.local ([10.1.10.46]) by ivymail.ivycomptech.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 27 Jan 2010 12:52:57 +0530
Received: from HYDSVWIN004X.ivycomptech.partygaming.local ([10.1.10.228]) by hydsvwin800.ivycomptech.partygaming.local with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 27 Jan 2010 12:53:45 +0530
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Applying LUCENE-1606  -- which version
Date: Wed, 27 Jan 2010 12:58:26 +0530
Message-ID: <49A7BA114AAC6A48B9C44CB06B7B987E08C926AF@HYDSVWIN004X.ivycomptech.partygaming.local>
In-Reply-To: <001301ca9b4d$c89bef10$59d3cd30$@de>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Applying LUCENE-1606  -- which version
Thread-Index: AcqbSiugQuWh842RRw6VoFWhct3oWAAABo+AAACoRVAA9Sq5sA==
References: <49A7BA114AAC6A48B9C44CB06B7B987E08C11F78@HYDSVWIN004X.ivycomptech.partygaming.local> <001301ca9b4d$c89bef10$59d3cd30$@de>
From: "Sriram Muthuswamy Chittathoor" <sriramc@ivycomptech.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 27 Jan 2010 07:23:45.0938 (UTC) FILETIME=[A9773720:01CA9F21]
X-Virus-Checked: Checked by ClamAV on apache.org

I tried on the flex brach and it  seems to be working well. This is the
general pattern I am following  (both for prefix queries and queries of
the sort   ".{0,3}poker.*".   I am assuming I could just use this as
part of a larger BooleanQuery.=20

AutomatonQuery aq =3D new
RegexpQuery(newTerm("123.*poker.*"));//".*ument"));
aq.setRewriteMethod(MultiTermQuery.CONSTANT_SCORE_AUTO_REWRITE_DEFAULT);
TopDocs td =3D searcher.search(aq, 10);
ScoreDoc[] sd =3D td.scoreDocs;=20

Begin loop ...
System.out.println ("Doc : " + searcher.doc(sd[i].doc).get("data"));
End loop


Can I just use this production or need to wait till this is officially
released ?=20
=20

-----Original Message-----
From: Uwe Schindler [mailto:uwe@thetaphi.de]=20
Sent: Friday, January 22, 2010 4:00 PM
To: java-user@lucene.apache.org
Subject: RE: Applying LUCENE-1606 -- which version

Hi Sriram,

This patch cannot be applied to 3.0 as it depends on a new Lucene branch
called flex. It depends on features, only added in version 3.1. So it
does not even apply on trunk, you have to checkout the experimental flex
branch first.

For 3.0 you, may try one of the early patches (the last without -flex in
name) in this issue, but they will never go into lucene 3.1, instead the
flex branch will hopefully merge with trunk, soon. Also the non-flex
patches are not so performant, because the performance increases only
with flexible indexing API.

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Sriram Muthuswamy Chittathoor [mailto:sriramc@ivycomptech.com]
> Sent: Friday, January 22, 2010 11:05 AM
> To: java-user@lucene.apache.org
> Subject: Applying LUCENE-1606 -- which version
>=20
> Hi:
>=20
>=20
>=20
> I am trying to apply this Automata patch on my Lucene 3.0 src code but
> running into issues as it is complaining about failures to apply patch
> to certain files.  Is this the right version
>=20
> To apply to.  Please help
>=20
>=20
>=20
> Thanks
>=20
>=20
>=20
> Sriram C
>=20
>=20
>=20
> LUCENE-1606
> https://issues.apache.org/jira/browse/LUCENE-1606
>=20
>=20
> This email is sent for and on behalf of Ivy Comptech Private Limited.
> Ivy Comptech Private Limited is a limited liability company.
>=20
> This email and any attachments are confidential, and may be legally
> privileged and protected by copyright. If you are not the intended
> recipient dissemination or copying of this email is prohibited. If you
> have received this in error, please notify the sender by replying by
> email and then delete the email completely from your system.
> Any views or opinions are solely those of the sender.  This
> communication is not intended to form a binding contract on behalf of
> Ivy Comptech Private Limited unless expressly indicated to the
contrary
> and properly authorised. Any actions taken on the basis of this email
> are at the recipient's own risk.
>=20
> Registered office:
> Ivy Comptech Private Limited, Cyber Spazio, Road No. 2, Banjara Hills,
> Hyderabad 500 033, Andhra Pradesh, India. Registered number: 37994.
> Registered in India. A list of members' names is available for
> inspection at the registered office.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44693-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 08:18:32 2010
Return-Path: <java-user-return-44693-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11000 invoked from network); 27 Jan 2010 08:18:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 08:18:32 -0000
Received: (qmail 7420 invoked by uid 500); 27 Jan 2010 08:18:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7328 invoked by uid 500); 27 Jan 2010 08:18:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7318 invoked by uid 99); 27 Jan 2010 08:18:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 08:18:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 08:18:19 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id 8544650826; Wed, 27 Jan 2010 00:17:58 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-246-241.dynamic.isadsl.co.za [196.210.246.241])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 4F0475081F
	for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 00:17:56 -0800 (PST)
Message-ID: <4B5FF6AC.8020700@stimulussoft.com>
Date: Wed, 27 Jan 2010 10:17:48 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com>	 <85d3c3b61001261140s2589af30r81485191354c83d5@mail.gmail.com>	 <4B5F4658.3000902@stimulussoft.com>	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>	 <4B5F4BFA.6050901@stimulussoft.com>	 <4B5F5771.4080009@stimulussoft.com>	 <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>	 <4B5FD921.9060700@stimulussoft.com>	 <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>	 <4B5FE77C.5040700@stimulussoft.com> <4b124c311001262327y47aaac05n2abeb6272fde5fa9@mail.gmail.com>
In-Reply-To: <4b124c311001262327y47aaac05n2abeb6272fde5fa9@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Old-Spam-Status: No, score=-5.1 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

Hi Jake

> You were indexing but not searching?  So you are never calling getReader()
> in the first place?
>    
Of course, the call exists, its just that during testing we did not 
execute any searches at all.
> How have you been doing search in a realtime fashion with Lucene before
> 2.9's introduction of
> IndexWriter.getReader()?
>    
Nope. I previously used to open and close the reader on each search. 
When I noticed the getReader() functionality
was available, I jumped at it. It immediately offered significant 
performance increases...

We are now attempting to analyze Lucene using JPicus to try and get a 
picture of what is happening here.

See: http://wiki.sdn.sap.com/wiki/display/Java/JPicus

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44694-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 08:25:10 2010
Return-Path: <java-user-return-44694-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12364 invoked from network); 27 Jan 2010 08:25:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 08:25:10 -0000
Received: (qmail 19379 invoked by uid 500); 27 Jan 2010 08:25:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19308 invoked by uid 500); 27 Jan 2010 08:25:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19298 invoked by uid 99); 27 Jan 2010 08:25:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 08:25:08 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jake.mannix@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 08:24:59 +0000
Received: by pwi11 with SMTP id 11so3771059pwi.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 00:24:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=IHSqGxQjm/gP2Rt9GqqTUqbXrT6O71wa874OEcMqrJY=;
        b=O+L4L3V1wwb/MGs0gDLeSM10eSPOGzlXiohoQj9OH8FQKItn1HKk2yBkH+sx7QSVpP
         zgllocukiVFv1lEdxiQCmEGu7JQfg+dLfPdfFOtq/SQrdbb9Aznhqb5Cbae6nautg1cy
         vHJfIPXEk15B8yRePxLQRSuLWV3zwO/D8ScPM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=SheLudItNZZgakn1NMkb2OZ32OVkbPSzLxvwCEEFK9SEAIzpBzqFwcFddnqnmdTBqr
         GK28SttL7U9qwbOtKymwV+mh7a6p2QqJRgaC3O10LEK/1o5boeDUjH6loSnOarmFxq2i
         ZersZLV9+3EhGemv/Jb5vW9XeXsz2lKM3S0a0=
MIME-Version: 1.0
Received: by 10.114.28.19 with SMTP id b19mr6312283wab.71.1264580678590; Wed, 
	27 Jan 2010 00:24:38 -0800 (PST)
In-Reply-To: <4B5FF6AC.8020700@stimulussoft.com>
References: <4B5F328B.2020303@stimulussoft.com>
	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>
	 <4B5F4BFA.6050901@stimulussoft.com>
	 <4B5F5771.4080009@stimulussoft.com>
	 <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>
	 <4B5FD921.9060700@stimulussoft.com>
	 <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>
	 <4B5FE77C.5040700@stimulussoft.com>
	 <4b124c311001262327y47aaac05n2abeb6272fde5fa9@mail.gmail.com>
	 <4B5FF6AC.8020700@stimulussoft.com>
Date: Wed, 27 Jan 2010 00:24:38 -0800
Message-ID: <4b124c311001270024q446cf5aay5f8719d6f6ddcab5@mail.gmail.com>
Subject: Re: file open handles?
From: Jake Mannix <jake.mannix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00504502e3f7232319047e212248
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502e3f7232319047e212248
Content-Type: text/plain; charset=ISO-8859-1

On Wed, Jan 27, 2010 at 12:17 AM, Jamie <jamie@stimulussoft.com> wrote:

> Hi Jake
>
>
>  You were indexing but not searching?  So you are never calling getReader()
>> in the first place?
>>
>>
> Of course, the call exists, its just that during testing we did not execute
> any searches at all.


Oh!  Re-reading your initial post - you're just seeing lots of files which
haven't quite yet
been cleaned up during indexing, it looks like, yes?  There are threads
going on in the
background which are merging segments and deleting old files, these should
go away
over time.

Do you see that they are still around after a very long period?  How high
does the file count grow?


>
>  How have you been doing search in a realtime fashion with Lucene before
>> 2.9's introduction of
>> IndexWriter.getReader()?
>>
>>
> Nope. I previously used to open and close the reader on each search. When I
> noticed the getReader() functionality
> was available, I jumped at it. It immediately offered significant
> performance increases...
>

Gah!  You must have a pretty small index, for that to be performant.  That's
historically been a really good way to
kill your search performance.  "significant performance increases" in
comparison to opening new IndexReader
per request in the pre-2.9 days indeed!

  -jake

--00504502e3f7232319047e212248--

From java-user-return-44695-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 08:49:46 2010
Return-Path: <java-user-return-44695-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25496 invoked from network); 27 Jan 2010 08:49:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 08:49:45 -0000
Received: (qmail 59279 invoked by uid 500); 27 Jan 2010 08:49:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59158 invoked by uid 500); 27 Jan 2010 08:49:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59138 invoked by uid 99); 27 Jan 2010 08:49:42 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 08:49:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 08:49:27 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id EE95050826; Wed, 27 Jan 2010 00:49:03 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-246-241.dynamic.isadsl.co.za [196.210.246.241])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 117915081F
	for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 00:48:51 -0800 (PST)
Message-ID: <4B5FFDEB.2020903@stimulussoft.com>
Date: Wed, 27 Jan 2010 10:48:43 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com>	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>	 <4B5F4BFA.6050901@stimulussoft.com>	 <4B5F5771.4080009@stimulussoft.com>	 <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>	 <4B5FD921.9060700@stimulussoft.com>	 <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>	 <4B5FE77C.5040700@stimulussoft.com>	 <4b124c311001262327y47aaac05n2abeb6272fde5fa9@mail.gmail.com>	 <4B5FF6AC.8020700@stimulussoft.com> <4b124c311001270024q446cf5aay5f8719d6f6ddcab5@mail.gmail.com>
In-Reply-To: <4b124c311001270024q446cf5aay5f8719d6f6ddcab5@mail.gmail.com>
Content-Type: multipart/mixed;
 boundary="------------060803030206080907020201"
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-5.2 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

--------------060803030206080907020201
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi Jake

Ok. The number of file handles left open is increasing rapidly. For 
instance, 4200 file handles were left open by Lucene 2.9.1 over a period 
of  16 min. You can see in the attached snapshot a picture from JPicus 
showing the file handles that are left open. These index files are  
deleted but the OS still holds references to them. Could it be that 
Lucene merge threads are not closing files correctly before they are 
deleted? More than likely, it is an error with our code, but where? Our 
LuceneIndex wrapper class is attached. If I set the max file OS count to 
a low figure, my application stops in its track, so this is definitely a 
critical issue that must be resolved.

Jamie


On 2010/01/27 10:24 AM, Jake Mannix wrote:
> On Wed, Jan 27, 2010 at 12:17 AM, Jamie<jamie@stimulussoft.com>  wrote:
> Oh!  Re-reading your initial post - you're just seeing lots of files which
> haven't quite yet
> been cleaned up during indexing, it looks like, yes?  There are threads
> going on in the
> background which are merging segments and deleting old files, these should
> go away
> over time.
>    

Yes, but they do not. They just keep growing over time until the file 
handle count is exhausted.
I can see from the JPicus utility that although these
> Do you see that they are still around after a very long period?  How high
> does the file count grow?
>
>
>    


--------------060803030206080907020201
Content-Type: text/plain;
 name="LuceneIndex.java"
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
 filename="LuceneIndex.java"

package com.stimulus.archiva.index;
import com.stimulus.util.*;
import java.io.File;
import java.io.IOException;
import java.io.PrintStream;
import org.apache.commons.logging.*;
import org.apache.lucene.document.Document;
import org.apache.lucene.index.*;
import org.apache.lucene.store.FSDirectory;
import com.stimulus.archiva.domain.Config;
import com.stimulus.archiva.domain.Indexer;
import com.stimulus.archiva.domain.Volume;
import com.stimulus.archiva.exception.*;
import com.stimulus.archiva.language.AnalyzerFactory;
import com.stimulus.archiva.search.*;
import java.util.*;
import org.apache.lucene.store.LockObtainFailedException;
import org.apache.lucene.store.AlreadyClosedException;
import java.util.concurrent.locks.ReentrantLock;
import java.util.concurrent.*;

public class LuceneIndex extends Thread {
	
		 protected ArrayBlockingQueue<LuceneDocument> queue;
		 protected static final Log logger = LogFactory.getLog(LuceneIndex.class.getName());
		 protected static final Log indexLog = LogFactory.getLog("indexlog");
	   	 IndexWriter writer = null;
	   	 protected static ScheduledExecutorService scheduler;
		 protected static ScheduledFuture<?> scheduledTask;
		 protected LuceneDocument EXIT_REQ = null;
		 ReentrantLock indexLock = new ReentrantLock();
		 ArchivaAnalyzer analyzer 	= new ArchivaAnalyzer();
		 File indexLogFile;
		 PrintStream indexLogOut;
		 IndexProcessor indexProcessor;
		 String friendlyName;
		 String indexPath;
		 int maxSimultaneousDocs;
		 int indexThreads;
		 
	  	  public LuceneIndex(int queueSize, LuceneDocument exitReq, String friendlyName, String indexPath, int  maxSimultaneousDocs, int indexThreads) {
	  		  this.queue = new ArrayBlockingQueue<LuceneDocument>(queueSize);
	  		  this.EXIT_REQ = exitReq;
	  		  this.friendlyName = friendlyName;
	  		  this.indexPath = indexPath;
	  		  this.maxSimultaneousDocs = maxSimultaneousDocs;
	  		  this.indexThreads = indexThreads;
	  		  setLog(friendlyName);
	  	  }
	  	  
	  	  
	  	public int getMaxSimultaneousDocs() {
	  		return maxSimultaneousDocs;
	  	}
	  	
	  	public void setMaxSimultaneousDocs(int maxSimultaneousDocs) {
	  		this.maxSimultaneousDocs = maxSimultaneousDocs;
	  	}
	  	  
	  	  
	  	public ReentrantLock getIndexLock() {
	  		return indexLock;
	  	}
	  
	  	protected void setLog(String logName) {

	  		  try {
	  			  indexLogFile = getIndexLogFile(logName);
	  			  if (indexLogFile!=null) {
	  				  if (indexLogFile.length()>10485760)
	  					  indexLogFile.delete();
	  				  indexLogOut = new PrintStream(indexLogFile);
	  			  }
	  			  logger.debug("set index log file path {path='"+indexLogFile.getCanonicalPath()+"'}");
	  		  } catch (Exception e) {
	  			  logger.error("failed to open index log file:"+e.getMessage(),e);
	  		  }
	  	}
		
	  	protected File getIndexLogFile(String logName) {
	  		 try {
	  			  String logfilepath = Config.getFileSystem().getLogPath()+File.separator+logName+"index.log";
	  			  return new File(logfilepath);
	  		  } catch (Exception e) {
	  			  logger.error("failed to open index log file:"+e.getMessage(),e);
	  			  return null;
	  		  }
	  	}
	  	
 		
		
		  protected void openIndex() throws MessageSearchException {
			Exception lastError = null;
			
	    	if (writer==null) {
	    		logger.debug("openIndex() index "+friendlyName+" will be opened. it is currently closed.");
	    	} else {
	    		logger.debug("openIndex() did not bother opening index "+friendlyName+". it is already open.");
	    		return; 
	    	}
	    	logger.debug("opening index "+friendlyName+" for write");
			logger.debug("opening search index "+friendlyName+" for write {indexpath='"+indexPath+"'}");
			boolean writelock;
			int attempt = 0;
			int maxattempt = 10;
			
			if (Config.getConfig().getIndex().getMultipleIndexProcesses()) {
				maxattempt = 10000;
		 	} else {
				maxattempt = 10;
		 	}
			
			do {
				writelock = false;
				try {
						FSDirectory fsDirectory = FSDirectory.open(new File(indexPath));
						int maxIndexChars = Config.getConfig().getIndex().getMaxIndexPerFieldChars();
						writer = new IndexWriter(fsDirectory,analyzer,new IndexWriter.MaxFieldLength(maxIndexChars));
						if (indexLog.isDebugEnabled() && indexLogOut!=null) {
							writer.setInfoStream(indexLogOut);
						}
				} catch (LockObtainFailedException lobfe) {
						logger.debug("write lock on index "+friendlyName+". will reopen in 50ms.");
						try { Thread.sleep(50); } catch (Exception e) {}
						attempt++;
						writelock = true;
				} catch (CorruptIndexException cie) {
					throw new MessageSearchException("index "+friendlyName+" appears to be corrupt. please reindex the active volume."+cie.getMessage(),logger);
				} catch (Throwable io) {
					throw new MessageSearchException("failed to write document to index "+friendlyName+":"+io.getMessage(),logger);
				}
		   } while (writelock && attempt<maxattempt);
		   if (attempt>=10000)
			 throw new MessageSearchException("failed to open index "+friendlyName+" writer {indexPath='"+indexPath+"'}",lastError,logger);
		}
		
		public void indexDocument(LuceneDocument luceneDocument) throws MessageSearchException {
			logger.debug("index document {"+luceneDocument+"}");
			long s = (new Date()).getTime();
			if (luceneDocument == null)
			    throw new MessageSearchException("assertion failure: null document",logger);
			try {
				queue.put(luceneDocument);
			} catch (InterruptedException ie) {
				throw new MessageSearchException("failed to add document to queue:"+ie.getMessage(),ie,logger);
			}
			logger.debug("document indexed successfully {"+luceneDocument+"}");
			
			logger.debug("indexing message end {"+luceneDocument+"}");
			long e = (new Date()).getTime();
		    logger.debug("indexing time {time='"+(e-s)+"'}");
		}
		
		public class DocWriter implements Runnable {
			
			LuceneDocument doc;
			String language;
			LinkedList<LuceneDocument> pushbacks;
			
			public DocWriter(LuceneDocument doc,String language,LinkedList<LuceneDocument> pushbacks) {
				this.doc = doc;
				this.language = language;
				this.pushbacks = pushbacks;
			}
			
			public void run() {
				try {
					writer.addDocument(doc.getDocument(),AnalyzerFactory.getAnalyzer(language,AnalyzerFactory.Operation.INDEX));
				} catch (IOException io) {
					logger.error("failed to add document to index:"+io.getMessage(),io);
				} catch (AlreadyClosedException e) {
					pushbacks.add(doc);
					
	        	}
			}
			
		}
		
	
        public class IndexProcessor extends Thread {
        	
        	public IndexProcessor() {
        		setName("index processor");
        	}
      
			public void run() {
				boolean exit = false;
				LuceneDocument luceneDocument = null;	
				LinkedList<LuceneDocument> pushbacks = new LinkedList<LuceneDocument>();
			    
				while (!exit) {
					
					try {
						//documentPool = Executors.newFixedThreadPool(Config.getConfig().getArchiver().getArchiveThreads());
						luceneDocument = null;	
						luceneDocument = (LuceneDocument) queue.take();
						
						indexLock.lock();
						
						if (luceneDocument==EXIT_REQ) {
							logger.debug("index exit req received. exiting");
							exit = true;
							continue;
						}
					
						if (luceneDocument==null) {
							logger.debug("index info is null");
						}
						int i = 0;
						ExecutorService threadPool = Executors.newFixedThreadPool(indexThreads,ThreadUtil.getFlexibleThreadFactory("indexwritepool"));
						
						while(luceneDocument!=null && i<maxSimultaneousDocs) {
						
								Document doc = luceneDocument.getDocument();
								String language = doc.get("lang");
								if (language==null) {
									language = Config.getConfig().getIndex().getIndexLanguage();
								}
								DocWriter docWriter = new DocWriter(luceneDocument,language,pushbacks);
								threadPool.submit(docWriter);
								
					        	 i++;
					        	 if (i<maxSimultaneousDocs) {
						        	 luceneDocument = (LuceneDocument) queue.poll(); 
						        	 
						        	 if (luceneDocument==null) {
											logger.debug("index info is null");
									 }
						        	 
						        	 if (luceneDocument==EXIT_REQ) {
						        		 	logger.debug("index exit req received. exiting (2)");
											exit = true;
											break;
									  }
					        	 }	
							  
						}
						threadPool.shutdown();
						threadPool.awaitTermination(30,TimeUnit.MINUTES);
						if (pushbacks.size()>0) {
							 
							  for (LuceneDocument pushback : pushbacks) {
									try {
										writer.addDocument(pushback.getDocument());
									} catch (IOException io) {
										logger.error("failed to add document to index:"+io.getMessage(),io);
									} catch (AlreadyClosedException e) {
										pushbacks.add(pushback);
						        	} 
									i++;
							  }
						}
						try {
							writer.commit(); 
						} catch (Exception e) {
							logger.error("failed to commit index:"+e.getMessage(),e);
							closeIndex();
							openIndex();
						}
						
			 		} catch (Throwable ie) {
			 			logger.error("index write interrupted:"+ie.getMessage(),ie);
			 		} finally {
			 			
						  indexLock.unlock();
					}
				}	
		   	}
			
			public class IndexDocument extends Thread {
				
			    	LuceneDocument luceneDocument = null;
			    	List<LuceneDocument> pushbacks = null;
			    	
					public IndexDocument(LuceneDocument luceneDocument,List<LuceneDocument> pushbacks) {
						this.luceneDocument = luceneDocument;
						this.pushbacks = pushbacks;
						setName("index document");
					}
				
					public void run() {
						try {
							writer.addDocument(luceneDocument.getDocument());
						} catch (IOException io) {
							logger.error("failed to add document to index:"+io.getMessage(),io);
						} catch (AlreadyClosedException e) {
							pushbacks.add(luceneDocument);
			        	} catch (Throwable t) {
			        		logger.error("failed to add document to index:"+t.getMessage(),t);
			        	}
		            }};
			}
      
		protected void closeIndex() {
		 	try {
		 		indexLock.lock();
			 	if (writer!=null) {
		        	writer.close();
			 	}
			 } catch (Throwable io) {
				logger.error("failed to close index writer:"+io.getMessage(),io);
			 } finally {
				 logger.debug("writer closed");
				 writer = null;
				 indexLock.unlock();
			 }
		}
	
		
		
		public void optimize() throws MessageSearchException {
			  logger.debug("optimize volume");
			  try {
				  indexLock.lock();
				  try {
					  writer.optimize(false);
				  } catch (Exception io) {
					  throw new MessageSearchException("failed to optimize the index:"+io.getMessage(),io,logger);
				  }
			  } catch (Throwable t) { // diskspace problems could arise
				  logger.error("failed to optimize index:"+t.getMessage(),t);
			  } finally {
				  indexLock.unlock();
			  }
			
		}
		public void deleteDocs(Term[] terms) throws MessageSearchException {
			  logger.debug("delete docs");
			  try {
				  indexLock.lock();
				  openIndex();
				  try {
					  writer.deleteDocuments(terms);
				  } catch (Exception e) {
					  throw new MessageSearchException("failed to delete doc from index:"+e.getMessage(),e,logger);
				  } finally {
					  try {
						  writer.commit();
						  writer.expungeDeletes(false);
					  } catch (Exception io) {
						  throw new MessageSearchException("failed to expunge docs from index:"+io.getMessage(),io,logger);
					  }
				  }
			  } catch (Throwable t) {
				  logger.error("failed to delete docs from index."+t.getMessage(),t);	    
		      } finally {
				  indexLock.unlock();
			  }
		}
		
		
		  public void deleteIndex() throws MessageSearchException {
			  	 logger.debug("delete index {indexpath='"+indexPath+"'}");
		  		 try {
		 			 indexLock.lock();
		 			 closeIndex();
					 try {
						int maxIndexChars = Config.getConfig().getIndex().getMaxIndexPerFieldChars();
						writer = new IndexWriter(FSDirectory.open(new File(indexPath)),analyzer,true,new IndexWriter.MaxFieldLength(maxIndexChars));
					 } catch (Throwable cie) {
						 logger.error("failed to delete index {index='"+indexPath+"'}",cie);
						 return;
					 } 
		  		} finally {
		  			  openIndex();
					  indexLock.unlock();
				}
		  }
		
		  public void startup() throws MessageSearchException {
			logger.debug("luceneindex is starting up");
			File lockFile = new File(indexPath+File.separatorChar + "write.lock");
			if (lockFile.exists()) {
				if (Config.getConfig().getIndex().getMultipleIndexProcesses()) {
					logger.debug("index lock file detected on volumeindex startup.");
				} else {
					logger.warn("index lock file detected. the server was shutdown incorrectly. automatically deleting lock file.");
					lockFile.delete();
				}
			}
			openIndex();
			indexProcessor = new IndexProcessor();
			indexProcessor.start();
			Runtime.getRuntime().addShutdownHook(this);
			
		  }
		  
		  public IndexReader getReader() throws IOException {
			  return writer.getReader();
		  }
		  
		  public void shutdown() {
			  //logger.debug("volumeindex is shutting down");
			  for (int i=0;i<indexThreads;i++) {
				  queue.add(EXIT_REQ);
			  }
			  closeIndex();
		  }
		  
		  @Override
		  public void run() {
			  shutdown();
		  }
		  
		  
		  public interface LuceneDocument {
			  
			  public String toString();
			  public Document getDocument();
			  public void finalize();
			  
		  }
	 
}

	



--------------060803030206080907020201
Content-Type: text/plain; charset=us-ascii


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
--------------060803030206080907020201--

From java-user-return-44696-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 09:26:19 2010
Return-Path: <java-user-return-44696-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49389 invoked from network); 27 Jan 2010 09:26:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 09:26:18 -0000
Received: (qmail 9320 invoked by uid 500); 27 Jan 2010 09:26:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9239 invoked by uid 500); 27 Jan 2010 09:26:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9229 invoked by uid 99); 27 Jan 2010 09:26:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 09:26:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 09:26:07 +0000
Received: by serve.stimulussoft.com (Postfix, from userid 5001)
	id 2FE5150826; Wed, 27 Jan 2010 01:25:46 -0800 (PST)
X-Spam-Checker-Version: SpamAssassin 3.2.4 (2008-01-01) on
	serve.stimulussoft.com
X-Spam-Level: 
Received: from [192.168.0.19] (196-210-246-241.dynamic.isadsl.co.za [196.210.246.241])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 2B4A85081F
	for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 01:25:43 -0800 (PST)
Message-ID: <4B60068F.80407@stimulussoft.com>
Date: Wed, 27 Jan 2010 11:25:35 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: file open handles?
References: <4B5F328B.2020303@stimulussoft.com>	 <85d3c3b61001261203q580b5e89jdac7ee02d945a83c@mail.gmail.com>	 <4B5F4BFA.6050901@stimulussoft.com>	 <4B5F5771.4080009@stimulussoft.com>	 <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>	 <4B5FD921.9060700@stimulussoft.com>	 <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>	 <4B5FE77C.5040700@stimulussoft.com>	 <4b124c311001262327y47aaac05n2abeb6272fde5fa9@mail.gmail.com>	 <4B5FF6AC.8020700@stimulussoft.com> <4b124c311001270024q446cf5aay5f8719d6f6ddcab5@mail.gmail.com> <4B5FFDEB.2020903@stimulussoft.com>
In-Reply-To: <4B5FFDEB.2020903@stimulussoft.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=-5.2 required=5.0 tests=ALL_TRUSTED,AWL,BAYES_00
	autolearn=ham version=3.2.4

Hi Jake

We got to the bottom of it. Turned out to be a status page that was 
opening the reader to obtain docCount but not closing it.Thanks for your 
help!

Jamie
On 2010/01/27 10:48 AM, Jamie wrote:
> Hi Jake
>
> Ok. The number of file handles left open is increasing rapidly. For 
> instance, 4200 file handles were left open by Lucene 2.9.1 over a 
> period of  16 min. You can see in the attached snapshot a picture from 
> JPicus showing the file handles that are left open. These index files 
> are  deleted but the OS still holds references to them. Could it be 
> that Lucene merge threads are not closing files correctly before they 
> are deleted? More than likely, it is an error with our code, but 
> where? Our LuceneIndex wrapper class is attached. If I set the max 
> file OS count to a low figure, my application stops in its track, so 
> this is definitely a critical issue that must be resolved.
>
> Jamie
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44697-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 09:41:32 2010
Return-Path: <java-user-return-44697-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62418 invoked from network); 27 Jan 2010 09:41:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 09:41:32 -0000
Received: (qmail 32277 invoked by uid 500); 27 Jan 2010 09:41:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32191 invoked by uid 500); 27 Jan 2010 09:41:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32181 invoked by uid 99); 27 Jan 2010 09:41:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 09:41:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of asifnawaz@hotmail.com designates 65.55.90.112 as permitted sender)
Received: from [65.55.90.112] (HELO snt0-omc2-s37.snt0.hotmail.com) (65.55.90.112)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 09:41:19 +0000
Received: from SNT122-W3 ([65.55.90.71]) by snt0-omc2-s37.snt0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 27 Jan 2010 01:40:58 -0800
Message-ID: <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_e33ae95f-f381-474e-9408-d5a310a33595_"
X-Originating-IP: [203.99.180.89]
From: Asif Nawaz <asifnawaz@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: Index searching problem
Date: Wed, 27 Jan 2010 14:40:59 +0500
Importance: Normal
MIME-Version: 1.0
X-OriginalArrivalTime: 27 Jan 2010 09:40:58.0892 (UTC) FILETIME=[D4B04CC0:01CA9F34]

--_e33ae95f-f381-474e-9408-d5a310a33595_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable


i build an index to store 100 docs=2C each with field author=2C title and a=
bstract.for (i=3D0=3Bi<100=3Bi++) {writer =3D new IndexWriter("index"=2Cnew=
 StandardAnalyzer()=2Ctrue=2CIndexWriter.MaxFieldLength.UNLIMITED)=3B		doc.=
add(new Field("author"=2CcfcDoc.getAu()=2C Field.Store.YES=2C Field.Index.T=
OKENIZED))=3Bdoc.add(new Field("title"=2CcfcDoc.getTi()=2C Field.Store.YES=
=2C Field.Index.TOKENIZED))=3Bdoc.add(new Field("abstract"=2CcfcDoc.getAb()=
=2C Field.Store.YES=2C Field.Index.TOKENIZED))=3Bwriter.addDocument(doc)=3B=
}
But when i perfrom a search=2C it returns zero results=2C even querystring =
exist in one of the field of document. why is it so?????
Hits hits =3D se.performSearch("Hotel")=3BSystem.out.println("hits length =
=3D "+ hits.length())=3B
It creates index folder in file system=2C but when i open the file _0.fdt o=
r _0.fdx with Luke. this shows nothing... it also deletes the file from fil=
e system.






Asif

 		 	   		 =20
_________________________________________________________________
Your E-mail and More On-the-Go. Get Windows Live Hotmail Free.
https://signup.live.com/signup.aspx?id=3D60969=

--_e33ae95f-f381-474e-9408-d5a310a33595_--

From java-user-return-44698-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 09:46:03 2010
Return-Path: <java-user-return-44698-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65287 invoked from network); 27 Jan 2010 09:46:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 09:46:03 -0000
Received: (qmail 40378 invoked by uid 500); 27 Jan 2010 09:45:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40303 invoked by uid 500); 27 Jan 2010 09:45:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40293 invoked by uid 99); 27 Jan 2010 09:45:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 09:45:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 09:45:48 +0000
Received: by fxm2 with SMTP id 2so1353180fxm.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 01:45:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=Pwe8gn6Yn/BI7Syp59I58ZkoZCSkFEkKvMC+heLu4vw=;
        b=TOXSi6rvsLGLEAQ1jLChhHw6MQWCrmTgGrtJLpFhUkX8/Jk8gNOEX8vfA+YAzqX2iY
         ztazHTtzqp9f3H8oRWJNjbnR2tIAviJoNZohd60RdpErCQkkxYZ8uJ/mWR9eHiWV9db8
         2jOGgRPwtLBkPTJBelJWdcWwamJQ2BLL9WAL8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=aa041Xz68U33W/l4vVGqoqFkmtfB1RAyZ115V8TiNkiMaomrD/X76W9CG7cpgb1Xto
         qrP9V9B+E9jzvofaBoKYW6jA5AlGZvs9XJWn2ZFBQgPVX1rPFVQq1PO0Vxueh6AFfmCv
         28UYl58Urx8yYxcMPa4CciFKulKL34J5tH8W0=
MIME-Version: 1.0
Received: by 10.239.191.199 with SMTP id c7mr1073947hbi.164.1264585527373; 
	Wed, 27 Jan 2010 01:45:27 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl>
References: <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl>
Date: Wed, 27 Jan 2010 10:45:27 +0100
Message-ID: <f18c9dde1001270145j2cd25301y26d8d241c3229933@mail.gmail.com>
Subject: Re: Index searching problem
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

do you close your index writer or commit it before you open your searcher?

one more thing, if you search for "Hotel" you might not find anything
if the querystring is not passed through the StandardAnalyzer you use
for indexing. (well, or another analyzer that does lowercasing).
BTW. you email is hard to read though - I don't see a single newline.

simon

On Wed, Jan 27, 2010 at 10:40 AM, Asif Nawaz <asifnawaz@hotmail.com> wrote:
>
> i build an index to store 100 docs, each with field author, title and abs=
tract.for (i=3D0;i<100;i++) {writer =3D new IndexWriter("index",new Standar=
dAnalyzer(),true,IndexWriter.MaxFieldLength.UNLIMITED); =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 doc.add(new Field("author",cfcDoc.getAu(), Field.Store.YES, Fiel=
d.Index.TOKENIZED));doc.add(new Field("title",cfcDoc.getTi(), Field.Store.Y=
ES, Field.Index.TOKENIZED));doc.add(new Field("abstract",cfcDoc.getAb(), Fi=
eld.Store.YES, Field.Index.TOKENIZED));writer.addDocument(doc);}
> But when i perfrom a search, it returns zero results, even querystring ex=
ist in one of the field of document. why is it so?????
> Hits hits =3D se.performSearch("Hotel");System.out.println("hits length =
=3D "+ hits.length());
> It creates index folder in file system, but when i open the file _0.fdt o=
r _0.fdx with Luke. this shows nothing... it also deletes the file from fil=
e system.
>
>
>
>
>
>
> Asif
>
>
> _________________________________________________________________
> Your E-mail and More On-the-Go. Get Windows Live Hotmail Free.
> https://signup.live.com/signup.aspx?id=3D60969

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44699-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 11:40:37 2010
Return-Path: <java-user-return-44699-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42569 invoked from network); 27 Jan 2010 11:40:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 11:40:37 -0000
Received: (qmail 54183 invoked by uid 500); 27 Jan 2010 11:40:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54104 invoked by uid 500); 27 Jan 2010 11:40:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54094 invoked by uid 99); 27 Jan 2010 11:40:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 11:40:34 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=HTML_FONT_FACE_BAD,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of asifnawaz@hotmail.com designates 65.55.90.82 as permitted sender)
Received: from [65.55.90.82] (HELO snt0-omc2-s7.snt0.hotmail.com) (65.55.90.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 11:40:24 +0000
Received: from SNT122-W55 ([65.55.90.72]) by snt0-omc2-s7.snt0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 27 Jan 2010 03:40:03 -0800
Message-ID: <SNT122-W5509D2300DEB0FF55C0A4FB15D0@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_4085972c-b22f-4102-bb06-516d077eaac5_"
X-Originating-IP: [203.99.180.89]
From: Asif Nawaz <asifnawaz@hotmail.com>
To: Java Lucene <java-user@lucene.apache.org>
Subject: RE: Index searching problem
Date: Wed, 27 Jan 2010 16:40:03 +0500
Importance: Normal
In-Reply-To: <f18c9dde1001270145j2cd25301y26d8d241c3229933@mail.gmail.com>
References:
 <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl>,<f18c9dde1001270145j2cd25301y26d8d241c3229933@mail.gmail.com>
MIME-Version: 1.0
X-OriginalArrivalTime: 27 Jan 2010 11:40:03.0390 (UTC) FILETIME=[77242DE0:01CA9F45]

--_4085972c-b22f-4102-bb06-516d077eaac5_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable


ok. it works when i add commit and close indexes. when open the index file =
with Lukes=2C it shows me the list of documents that were matched.  But in =
my program it returns no of hits =3D 0. Why???
Hits hits =3D se.performSearch("significance")=3BSystem.out.println("hits l=
ength =3D "+ hits.length())=3B











> Date: Wed=2C 27 Jan 2010 10:45:27 +0100
> Subject: Re: Index searching problem
> From: simon.willnauer@googlemail.com
> To: java-user@lucene.apache.org
>=20
> do you close your index writer or commit it before you open your searcher=
?
>=20
> one more thing=2C if you search for "Hotel" you might not find anything
> if the querystring is not passed through the StandardAnalyzer you use
> for indexing. (well=2C or another analyzer that does lowercasing).
> BTW. you email is hard to read though - I don't see a single newline.
>=20
> simon
>=20
> On Wed=2C Jan 27=2C 2010 at 10:40 AM=2C Asif Nawaz <asifnawaz@hotmail.com=
> wrote:
> >
> > i build an index to store 100 docs=2C each with field author=2C title a=
nd abstract.for (i=3D0=3Bi<100=3Bi++) {writer =3D new IndexWriter("index"=
=2Cnew StandardAnalyzer()=2Ctrue=2CIndexWriter.MaxFieldLength.UNLIMITED)=3B=
         doc.add(new Field("author"=2CcfcDoc.getAu()=2C Field.Store.YES=2C =
Field.Index.TOKENIZED))=3Bdoc.add(new Field("title"=2CcfcDoc.getTi()=2C Fie=
ld.Store.YES=2C Field.Index.TOKENIZED))=3Bdoc.add(new Field("abstract"=2Ccf=
cDoc.getAb()=2C Field.Store.YES=2C Field.Index.TOKENIZED))=3Bwriter.addDocu=
ment(doc)=3B}
> > But when i perfrom a search=2C it returns zero results=2C even querystr=
ing exist in one of the field of document. why is it so?????
> > Hits hits =3D se.performSearch("Hotel")=3BSystem.out.println("hits leng=
th =3D "+ hits.length())=3B
> > It creates index folder in file system=2C but when i open the file _0.f=
dt or _0.fdx with Luke. this shows nothing... it also deletes the file from=
 file system.
> >
> >
> >
> >
> >
> >
> > Asif
> >
> >
> > _________________________________________________________________
> > Your E-mail and More On-the-Go. Get Windows Live Hotmail Free.
> > https://signup.live.com/signup.aspx?id=3D60969
>=20
> ---------------------------------------------------------------------
> To unsubscribe=2C e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands=2C e-mail: java-user-help@lucene.apache.org
>=20
 		 	   		 =20
_________________________________________________________________
Your E-mail and More On-the-Go. Get Windows Live Hotmail Free.
https://signup.live.com/signup.aspx?id=3D60969=

--_4085972c-b22f-4102-bb06-516d077eaac5_--

From java-user-return-44700-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 11:48:31 2010
Return-Path: <java-user-return-44700-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44882 invoked from network); 27 Jan 2010 11:48:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 11:48:31 -0000
Received: (qmail 66404 invoked by uid 500); 27 Jan 2010 11:48:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66325 invoked by uid 500); 27 Jan 2010 11:48:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66315 invoked by uid 99); 27 Jan 2010 11:48:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 11:48:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 11:48:17 +0000
Received: by fxm2 with SMTP id 2so1456399fxm.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 03:47:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=++ozJbkOidZiZQiTZUHKnUVOHY3OY/X/evvZvLhJ7aY=;
        b=thS0ZgGrU+D0sfP6kPrIRHmDyWlg1DDnK2han6ubYh6AuF5N2OFDT7WIfl6gTPGzll
         Ljz8HKKbCK7lbpzuKEyVDQXc+HT3BR8MBvLoL7QTosPsyu+hA0ZsIGjC2QXuy+gtU6aX
         f1U7tbakU47ebINz5hF2SKFocA5WNYKft0mag=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=xuFgIipqZ5Y8NHa9A5BCRufio2Yhw0Eli+9Bm5pugddG6JXYFyXhau1MC0CSUm+1Lu
         CrmGVLJbmQUI80i6KlCzjVRDA//YfOYzQ5lXa/WSfKqVAe1cjdLkrIU/MI33rsJv2waM
         M9IID/D7gu7TOydK1g/2HfktOVT9PyhQRSfEc=
MIME-Version: 1.0
Received: by 10.239.191.199 with SMTP id c7mr1088427hbi.164.1264592877448; 
	Wed, 27 Jan 2010 03:47:57 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <SNT122-W5509D2300DEB0FF55C0A4FB15D0@phx.gbl>
References: <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl>
	 <f18c9dde1001270145j2cd25301y26d8d241c3229933@mail.gmail.com>
	 <SNT122-W5509D2300DEB0FF55C0A4FB15D0@phx.gbl>
Date: Wed, 27 Jan 2010 12:47:57 +0100
Message-ID: <f18c9dde1001270347v62cfd848nd15211f928684cc7@mail.gmail.com>
Subject: Re: Index searching problem
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Do you open the searcher  / reader after you call commit on the writer?

simon

On Wed, Jan 27, 2010 at 12:40 PM, Asif Nawaz <asifnawaz@hotmail.com> wrote:
>
> ok. it works when i add commit and close indexes. when open the index fil=
e with Lukes, it shows me the list of documents that were matched. =C2=A0Bu=
t in my program it returns no of hits =3D 0. Why???
> Hits hits =3D se.performSearch("significance");System.out.println("hits l=
ength =3D "+ hits.length());
>
>
>
>
>
>
>
>
>
>
>
>> Date: Wed, 27 Jan 2010 10:45:27 +0100
>> Subject: Re: Index searching problem
>> From: simon.willnauer@googlemail.com
>> To: java-user@lucene.apache.org
>>
>> do you close your index writer or commit it before you open your searche=
r?
>>
>> one more thing, if you search for "Hotel" you might not find anything
>> if the querystring is not passed through the StandardAnalyzer you use
>> for indexing. (well, or another analyzer that does lowercasing).
>> BTW. you email is hard to read though - I don't see a single newline.
>>
>> simon
>>
>> On Wed, Jan 27, 2010 at 10:40 AM, Asif Nawaz <asifnawaz@hotmail.com> wro=
te:
>> >
>> > i build an index to store 100 docs, each with field author, title and =
abstract.for (i=3D0;i<100;i++) {writer =3D new IndexWriter("index",new Stan=
dardAnalyzer(),true,IndexWriter.MaxFieldLength.UNLIMITED); =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 doc.add(new Field("author",cfcDoc.getAu(), Field.Store.YES, F=
ield.Index.TOKENIZED));doc.add(new Field("title",cfcDoc.getTi(), Field.Stor=
e.YES, Field.Index.TOKENIZED));doc.add(new Field("abstract",cfcDoc.getAb(),=
 Field.Store.YES, Field.Index.TOKENIZED));writer.addDocument(doc);}
>> > But when i perfrom a search, it returns zero results, even querystring=
 exist in one of the field of document. why is it so?????
>> > Hits hits =3D se.performSearch("Hotel");System.out.println("hits lengt=
h =3D "+ hits.length());
>> > It creates index folder in file system, but when i open the file _0.fd=
t or _0.fdx with Luke. this shows nothing... it also deletes the file from =
file system.
>> >
>> >
>> >
>> >
>> >
>> >
>> > Asif
>> >
>> >
>> > _________________________________________________________________
>> > Your E-mail and More On-the-Go. Get Windows Live Hotmail Free.
>> > https://signup.live.com/signup.aspx?id=3D60969
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>
> _________________________________________________________________
> Your E-mail and More On-the-Go. Get Windows Live Hotmail Free.
> https://signup.live.com/signup.aspx?id=3D60969

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44701-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 11:51:25 2010
Return-Path: <java-user-return-44701-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45664 invoked from network); 27 Jan 2010 11:51:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 11:51:25 -0000
Received: (qmail 71416 invoked by uid 500); 27 Jan 2010 11:51:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71347 invoked by uid 500); 27 Jan 2010 11:51:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71337 invoked by uid 99); 27 Jan 2010 11:51:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 11:51:22 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 11:51:11 +0000
Received: by bwz22 with SMTP id 22so4430847bwz.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 03:50:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type
         :content-transfer-encoding;
        bh=zVyl+1L8f008rwdf5f6MgCvGl1Az+zUh8GZYDV/R6UA=;
        b=Homk/AOZ3rbTf9+/Buemx0v1EfnX39lg/ztBzJSvo/ECcmFGIWd2LfIvTVCjY4+ggI
         sOoLLsOWeT8adYZqBGEmW65+a1CFlLxnrle/yJFCy1aKBZfT6xlbb50EdWvzRAbNXfw9
         ajwUdQ1Gsw911/IhhATgk8mtbsDKzCBAi1tVg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        b=t2HO9mvP6iW2VcJBnnGFMAAO4zyZy/TowC3rxBxCk2hLMoZRy3VxJLYckkbjE6NC3G
         xg/Qibk3JZu/Yt7rOCSbsXFl05I8hmx2cd8J5uu9PSdd9jupqP9ZfmVaiadY07hXIAXY
         Csd5rGr893SKf/AC0YHYthYNd47+bGoD1m+4U=
MIME-Version: 1.0
Received: by 10.204.5.133 with SMTP id 5mr2223535bkv.172.1264593051348; Wed, 
	27 Jan 2010 03:50:51 -0800 (PST)
In-Reply-To: <f18c9dde1001270347v62cfd848nd15211f928684cc7@mail.gmail.com>
References: <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl> <f18c9dde1001270145j2cd25301y26d8d241c3229933@mail.gmail.com> 
	<SNT122-W5509D2300DEB0FF55C0A4FB15D0@phx.gbl> <f18c9dde1001270347v62cfd848nd15211f928684cc7@mail.gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Wed, 27 Jan 2010 11:50:31 +0000
Message-ID: <8c4e68611001270350l3164de53k60dd4d0bc1eb04ed@mail.gmail.com>
Subject: Re: Index searching problem
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Lots of other things to check are listed in the FAQ:
http://wiki.apache.org/lucene-java/LuceneFAQ#Why_am_I_getting_no_hits_.2BAC=
8_incorrect_hits.3F


--
Ian.


On Wed, Jan 27, 2010 at 11:47 AM, Simon Willnauer
<simon.willnauer@googlemail.com> wrote:
> Do you open the searcher =A0/ reader after you call commit on the writer?
>
> simon
>
> On Wed, Jan 27, 2010 at 12:40 PM, Asif Nawaz <asifnawaz@hotmail.com> wrot=
e:
>>
>> ok. it works when i add commit and close indexes. when open the index fi=
le with Lukes, it shows me the list of documents that were matched. =A0But =
in my program it returns no of hits =3D 0. Why???
>> Hits hits =3D se.performSearch("significance");System.out.println("hits =
length =3D "+ hits.length());
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>> Date: Wed, 27 Jan 2010 10:45:27 +0100
>>> Subject: Re: Index searching problem
>>> From: simon.willnauer@googlemail.com
>>> To: java-user@lucene.apache.org
>>>
>>> do you close your index writer or commit it before you open your search=
er?
>>>
>>> one more thing, if you search for "Hotel" you might not find anything
>>> if the querystring is not passed through the StandardAnalyzer you use
>>> for indexing. (well, or another analyzer that does lowercasing).
>>> BTW. you email is hard to read though - I don't see a single newline.
>>>
>>> simon
>>>
>>> On Wed, Jan 27, 2010 at 10:40 AM, Asif Nawaz <asifnawaz@hotmail.com> wr=
ote:
>>> >
>>> > i build an index to store 100 docs, each with field author, title and=
 abstract.for (i=3D0;i<100;i++) {writer =3D new IndexWriter("index",new Sta=
ndardAnalyzer(),true,IndexWriter.MaxFieldLength.UNLIMITED); =A0 =A0 =A0 =A0=
 doc.add(new Field("author",cfcDoc.getAu(), Field.Store.YES, Field.Index.TO=
KENIZED));doc.add(new Field("title",cfcDoc.getTi(), Field.Store.YES, Field.=
Index.TOKENIZED));doc.add(new Field("abstract",cfcDoc.getAb(), Field.Store.=
YES, Field.Index.TOKENIZED));writer.addDocument(doc);}
>>> > But when i perfrom a search, it returns zero results, even querystrin=
g exist in one of the field of document. why is it so?????
>>> > Hits hits =3D se.performSearch("Hotel");System.out.println("hits leng=
th =3D "+ hits.length());
>>> > It creates index folder in file system, but when i open the file _0.f=
dt or _0.fdx with Luke. this shows nothing... it also deletes the file from=
 file system.
>>> >
>>> >
>>> >
>>> >
>>> >
>>> >
>>> > Asif
>>> >
>>> >
>>> > _________________________________________________________________
>>> > Your E-mail and More On-the-Go. Get Windows Live Hotmail Free.
>>> > https://signup.live.com/signup.aspx?id=3D60969
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> _________________________________________________________________
>> Your E-mail and More On-the-Go. Get Windows Live Hotmail Free.
>> https://signup.live.com/signup.aspx?id=3D60969
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44702-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 12:30:32 2010
Return-Path: <java-user-return-44702-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57890 invoked from network); 27 Jan 2010 12:30:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 12:30:32 -0000
Received: (qmail 25423 invoked by uid 500); 27 Jan 2010 12:30:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25350 invoked by uid 500); 27 Jan 2010 12:30:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25340 invoked by uid 99); 27 Jan 2010 12:30:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 12:30:30 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.185] (HELO mail-yw0-f185.google.com) (209.85.211.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 12:30:22 +0000
Received: by ywh15 with SMTP id 15so2686567ywh.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 04:30:00 -0800 (PST)
MIME-Version: 1.0
Received: by 10.151.21.8 with SMTP id y8mr12399975ybi.211.1264595397258; Wed, 
	27 Jan 2010 04:29:57 -0800 (PST)
In-Reply-To: <4B60068F.80407@stimulussoft.com>
References: <4B5F328B.2020303@stimulussoft.com>
	 <85d3c3b61001261632p328812c5jd7045306c1e8a62e@mail.gmail.com>
	 <4B5FD921.9060700@stimulussoft.com>
	 <4b124c311001262242w48d1fdc4q6d944ea250f63a4@mail.gmail.com>
	 <4B5FE77C.5040700@stimulussoft.com>
	 <4b124c311001262327y47aaac05n2abeb6272fde5fa9@mail.gmail.com>
	 <4B5FF6AC.8020700@stimulussoft.com>
	 <4b124c311001270024q446cf5aay5f8719d6f6ddcab5@mail.gmail.com>
	 <4B5FFDEB.2020903@stimulussoft.com> <4B60068F.80407@stimulussoft.com>
Date: Wed, 27 Jan 2010 07:29:57 -0500
Message-ID: <9ac0c6aa1001270429x36e303c2g711364c31c4e6ea5@mail.gmail.com>
Subject: Re: file open handles?
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Jan 27, 2010 at 4:25 AM, Jamie <jamie@stimulussoft.com> wrote:

> We got to the bottom of it.

Thanks for bringing closure!

> Turned out to be a status page that was opening
> the reader to obtain docCount but not closing it.Thanks for your help!

If you only need the docCount in the index, it's much faster to use
oal.index.SegmentInfos (public since 2.9).  That simply reads the
latest segments_N file, which internally records the docCount &
deletion count per segment, which you can then sum up.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44703-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 14:48:33 2010
Return-Path: <java-user-return-44703-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28377 invoked from network); 27 Jan 2010 14:48:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 14:48:33 -0000
Received: (qmail 49664 invoked by uid 500); 27 Jan 2010 14:48:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49611 invoked by uid 500); 27 Jan 2010 14:48:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49601 invoked by uid 99); 27 Jan 2010 14:48:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 14:48:30 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of asifnawaz@hotmail.com designates 65.55.90.108 as permitted sender)
Received: from [65.55.90.108] (HELO snt0-omc2-s33.snt0.hotmail.com) (65.55.90.108)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 14:48:20 +0000
Received: from SNT122-W59 ([65.55.90.71]) by snt0-omc2-s33.snt0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 27 Jan 2010 06:47:59 -0800
Message-ID: <SNT122-W590901000FB98E5C7DA02BB15D0@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_3d653ece-f84a-49bd-b1f7-b32b39dc0392_"
X-Originating-IP: [119.153.130.190]
From: Asif Nawaz <asifnawaz@hotmail.com>
To: Java Lucene <java-user@lucene.apache.org>
Subject: RE: Index searching problem
Date: Wed, 27 Jan 2010 19:47:59 +0500
Importance: Normal
In-Reply-To: <f18c9dde1001270347v62cfd848nd15211f928684cc7@mail.gmail.com>
References:
 <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl>,<f18c9dde1001270145j2cd25301y26d8d241c3229933@mail.gmail.com>,<SNT122-W5509D2300DEB0FF55C0A4FB15D0@phx.gbl>,<f18c9dde1001270347v62cfd848nd15211f928684cc7@mail.gmail.com>
MIME-Version: 1.0
X-OriginalArrivalTime: 27 Jan 2010 14:47:59.0625 (UTC) FILETIME=[B84D1790:01CA9F5F]

--_3d653ece-f84a-49bd-b1f7-b32b39dc0392_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable


In the demo example for hotel database searching. I am confused how to open=
 the index and where should i fit that code. In SearchEngine.java file i op=
ened the index this way
IndexSearcher is =3D new IndexSearcher(IndexReader.open("index"))=3B=20

but it's not working and still returns 0 hits :(



> Date: Wed=2C 27 Jan 2010 12:47:57 +0100
> Subject: Re: Index searching problem
> From: simon.willnauer@googlemail.com
> To: java-user@lucene.apache.org
>=20
> Do you open the searcher  / reader after you call commit on the writer?
>=20
> simon
>=20
> On Wed=2C Jan 27=2C 2010 at 12:40 PM=2C Asif Nawaz <asifnawaz@hotmail.com=
> wrote:
> >
> > ok. it works when i add commit and close indexes. when open the index f=
ile with Lukes=2C it shows me the list of documents that were matched.  But=
 in my program it returns no of hits =3D 0. Why???
> > Hits hits =3D se.performSearch("significance")=3BSystem.out.println("hi=
ts length =3D "+ hits.length())=3B
> >

 		 	   		 =20
_________________________________________________________________
Hotmail: Trusted email with powerful SPAM protection.
https://signup.live.com/signup.aspx?id=3D60969=

--_3d653ece-f84a-49bd-b1f7-b32b39dc0392_--

From java-user-return-44704-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 15:54:17 2010
Return-Path: <java-user-return-44704-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58200 invoked from network); 27 Jan 2010 15:54:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 15:54:17 -0000
Received: (qmail 81070 invoked by uid 500); 27 Jan 2010 15:54:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81013 invoked by uid 500); 27 Jan 2010 15:54:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81002 invoked by uid 99); 27 Jan 2010 15:54:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 15:54:15 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of asifnawaz@hotmail.com designates 65.55.90.82 as permitted sender)
Received: from [65.55.90.82] (HELO snt0-omc2-s7.snt0.hotmail.com) (65.55.90.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 15:54:04 +0000
Received: from SNT122-W18 ([65.55.90.71]) by snt0-omc2-s7.snt0.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Wed, 27 Jan 2010 07:53:43 -0800
Message-ID: <SNT122-W18B132129FF5C23939C01BB15D0@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_5c3e0e52-ddfc-40fc-bcf3-867f9e437686_"
X-Originating-IP: [119.153.130.190]
From: Asif Nawaz <asifnawaz@hotmail.com>
To: Java Lucene <java-user@lucene.apache.org>
Subject: RE: Index searching problem
Date: Wed, 27 Jan 2010 20:53:44 +0500
Importance: Normal
In-Reply-To: <f18c9dde1001270347v62cfd848nd15211f928684cc7@mail.gmail.com>
References:
 <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl>,<f18c9dde1001270145j2cd25301y26d8d241c3229933@mail.gmail.com>,<SNT122-W5509D2300DEB0FF55C0A4FB15D0@phx.gbl>,<f18c9dde1001270347v62cfd848nd15211f928684cc7@mail.gmail.com>
MIME-Version: 1.0
X-OriginalArrivalTime: 27 Jan 2010 15:53:43.0921 (UTC) FILETIME=[E748E610:01CA9F68]

--_5c3e0e52-ddfc-40fc-bcf3-867f9e437686_
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable



IndexSearcher is =3D new IndexSearcher("index")=3BIndexReader ir =3D is.get=
IndexReader().open("index")=3BSystem.out.println("No of documents in index =
=3D "+ir.numDocs())=3B
The last statement shows no of documents =3D 167. that means IndexReader is=
 reading from index=2C which is open. I think the problem may exists in que=
ry parser. I am using following code
QueryParser parser =3D new QueryParser("content"=2C analyzer)=3B           =
             Query query =3D parser.parse(queryString)=3B        Hits hits =
=3D is.search(query)=3B       =20




> Date: Wed=2C 27 Jan 2010 12:47:57 +0100
> Subject: Re: Index searching problem
> From: simon.willnauer@googlemail.com
> To: java-user@lucene.apache.org
>=20
> Do you open the searcher  / reader after you call commit on the writer?
>=20
> simon
=20


 		 	   		 =20
_________________________________________________________________
Hotmail: Trusted email with powerful SPAM protection.
https://signup.live.com/signup.aspx?id=3D60969=

--_5c3e0e52-ddfc-40fc-bcf3-867f9e437686_--

From java-user-return-44705-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 15:54:37 2010
Return-Path: <java-user-return-44705-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58277 invoked from network); 27 Jan 2010 15:54:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 15:54:37 -0000
Received: (qmail 82851 invoked by uid 500); 27 Jan 2010 15:54:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82797 invoked by uid 500); 27 Jan 2010 15:54:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82787 invoked by uid 99); 27 Jan 2010 15:54:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 15:54:34 +0000
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=FORGED_YAHOO_RCVD,SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 15:54:25 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NaADU-0002H1-GN
	for java-user@lucene.apache.org; Wed, 27 Jan 2010 07:54:04 -0800
Message-ID: <27341810.post@talk.nabble.com>
Date: Wed, 27 Jan 2010 07:54:04 -0800 (PST)
From: starz10de <farag_ahmed@yahoo.com>
To: java-user@lucene.apache.org
Subject: =?UTF-8?Q?Problem_with_=E2=80=9EAND=E2=80=9C_operat?=
 =?UTF-8?Q?or_to_search_Chinese_text?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: farag_ahmed@yahoo.com
X-Virus-Checked: Checked by ClamAV on apache.org




Hello ,

I could successfully implement the Chinese analyzer (CJKAnalyzer) and searc=
h
Chinese text. However, I have problem when I use the Boolean operator AND
then I got always 0 hits. When I search for the 2 Chinese terms without the
=E2=80=9CAND=E2=80=9D operator is no problem, When I want to count only the=
 hits when both
exist in the same document, the result always zero.

How I could use the =E2=80=9CAND=E2=80=9D operator when I search Chinese te=
xt and why it is
a problem to use it when searching Chinese text.

Thanks in advance

--=20
View this message in context: http://old.nabble.com/Problem-with-%E2%80%9EA=
ND%E2%80%9C-operator-to-search-Chinese-text-tp27341810p27341810.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44706-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 15:59:48 2010
Return-Path: <java-user-return-44706-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60067 invoked from network); 27 Jan 2010 15:59:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 15:59:48 -0000
Received: (qmail 4074 invoked by uid 500); 27 Jan 2010 15:59:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4008 invoked by uid 500); 27 Jan 2010 15:59:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3998 invoked by uid 99); 27 Jan 2010 15:59:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 15:59:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.218.217 as permitted sender)
Received: from [209.85.218.217] (HELO mail-bw0-f217.google.com) (209.85.218.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 15:59:34 +0000
Received: by bwz9 with SMTP id 9so4426222bwz.12
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 07:59:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=gamma;
        h=domainkey-signature:mime-version:received:reply-to:in-reply-to
         :references:date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=URFZNaD+++AMAqD/ghzdJYFV+VzUP/M06dNKkVR7Otg=;
        b=qzL9bgha8ACl30uP42/eFllTMtSaMC0ZKRVGBxGXEbPIThKX2gQmJefdpgz2uMnw2K
         fHAXI+QhhjYKfb/pfL/6vEPk8n3Ix3pWcrRpybtVIlp/vOd9OrlIzmhGRG/NaRM5+nJj
         JYHgqUO2I7QvB0YFHsJeopbpdY610VykviAb4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=gamma;
        h=mime-version:reply-to:in-reply-to:references:date:message-id
         :subject:from:to:content-type:content-transfer-encoding;
        b=SU6L21oMsLZXD0fg0oplnSaRSKu4QbZqWAZxDdP7o8aMqpy6XbCPNE3ChNTMCez/8a
         uiq8+N/fsfUZq2DL3/nXb62l3JVaDafRHEiheGH/4GEteRBdni0vvJidei9Axl2A2XDi
         lt79X0RnQzSvZFZoNz017rnJDjJOEhOT7pg/s=
MIME-Version: 1.0
Received: by 10.239.156.14 with SMTP id k14mr1063720hbc.181.1264607954161; 
	Wed, 27 Jan 2010 07:59:14 -0800 (PST)
Reply-To: simon.willnauer@gmail.com
In-Reply-To: <SNT122-W18B132129FF5C23939C01BB15D0@phx.gbl>
References: <SNT122-W3E26A3417018413CDFE22B15D0@phx.gbl>
	 <f18c9dde1001270145j2cd25301y26d8d241c3229933@mail.gmail.com>
	 <SNT122-W5509D2300DEB0FF55C0A4FB15D0@phx.gbl>
	 <f18c9dde1001270347v62cfd848nd15211f928684cc7@mail.gmail.com>
	 <SNT122-W18B132129FF5C23939C01BB15D0@phx.gbl>
Date: Wed, 27 Jan 2010 16:59:13 +0100
Message-ID: <f18c9dde1001270759t6c60158eh22534909917c451d@mail.gmail.com>
Subject: Re: Index searching problem
From: Simon Willnauer <simon.willnauer@googlemail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

On Wed, Jan 27, 2010 at 4:53 PM, Asif Nawaz <asifnawaz@hotmail.com> wrote:
>
>
> IndexSearcher is =3D new IndexSearcher("index");IndexReader ir =3D is.get=
IndexReader().open("index");System.out.println("No of documents in index =
=3D "+ir.numDocs());
> The last statement shows no of documents =3D 167. that means IndexReader =
is reading from index, which is open. I think the problem may exists in que=
ry parser. I am using following code
> QueryParser parser =3D new QueryParser("content", analyzer); =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Qu=
ery query =3D parser.parse(queryString); =C2=A0 =C2=A0 =C2=A0 =C2=A0Hits hi=
ts =3D is.search(query);
>
I don't see the field "content" in your document you build in the
first mail. What do you search for? remember if you do not specifiy a
field in you querystring the parser will use the default  field which
is "content". Could that cause your problem?

simon
>
>
>
>> Date: Wed, 27 Jan 2010 12:47:57 +0100
>> Subject: Re: Index searching problem
>> From: simon.willnauer@googlemail.com
>> To: java-user@lucene.apache.org
>>
>> Do you open the searcher =C2=A0/ reader after you call commit on the wri=
ter?
>>
>> simon
>
>
>
>
> _________________________________________________________________
> Hotmail: Trusted email with powerful SPAM protection.
> https://signup.live.com/signup.aspx?id=3D60969

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44707-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 16:02:11 2010
Return-Path: <java-user-return-44707-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61413 invoked from network); 27 Jan 2010 16:02:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 16:02:11 -0000
Received: (qmail 10265 invoked by uid 500); 27 Jan 2010 16:02:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10189 invoked by uid 500); 27 Jan 2010 16:02:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10179 invoked by uid 99); 27 Jan 2010 16:02:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:02:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thienthanhomenh@gmail.com designates 74.125.92.26 as permitted sender)
Received: from [74.125.92.26] (HELO qw-out-2122.google.com) (74.125.92.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:02:01 +0000
Received: by qw-out-2122.google.com with SMTP id 8so392305qwh.53
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 08:01:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:from:date:message-id
         :subject:to:content-type;
        bh=KoDgoA8noZef15jyqyrgg/V1BmAclBv+AwLvoyXalKI=;
        b=fmZhOIbHbZppP7z6IHWwKhxh96nIqvuGsNSho3sLeTSEhiOUKjDHiDTZXQnq9nVgam
         Dtd6yHExBqoqWYhipA6SjyVNgEiCvN2B1o4UMmd1PEBFw5DWo5enakwjQYSBBP2tdpXA
         YqahuttOz5yLGP/OZ04tuagkKV3BTCgfwrH6A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        b=nMd2m4foCJqH6l9zrykk9TIhhmWCElirXeH6KaKjzRyrzyotECLgOPLzXJ6vk3bqNi
         ElYaUvCstUuxG472fC4Y+JiAE5bwcAwn5zEAzOiqpBXEsmC7Av0CHVMCvG8Ik9j1+xlI
         cfHAXG6cRuELG7SSohQ6gDBEhsIB0oHJjGMc4=
MIME-Version: 1.0
Received: by 10.224.58.166 with SMTP id g38mr3344336qah.32.1264608095503; Wed, 
	27 Jan 2010 08:01:35 -0800 (PST)
From: Phan The Dai <thienthanhomenh@gmail.com>
Date: Thu, 28 Jan 2010 01:01:15 +0900
Message-ID: <3b23ce091001270801r7320fc87qbea5bb96297500cd@mail.gmail.com>
Subject: Analyze java camelcase words ?
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00c09f88d20d50087e047e278439
X-Virus-Checked: Checked by ClamAV on apache.org

--00c09f88d20d50087e047e278439
Content-Type: text/plain; charset=ISO-8859-1

Can everyone suggest me a solution for tokenize the camelcase words in java
?
Examples for camelcase words are: getXmlRule, setTokenizeAnalyzer.
They should be tokenized to get, Xml, Rule, set, Tokenize, Analyzer.

Thank you very much!

--00c09f88d20d50087e047e278439--

From java-user-return-44708-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 16:06:45 2010
Return-Path: <java-user-return-44708-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63217 invoked from network); 27 Jan 2010 16:06:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 16:06:45 -0000
Received: (qmail 17245 invoked by uid 500); 27 Jan 2010 16:06:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17201 invoked by uid 500); 27 Jan 2010 16:06:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17191 invoked by uid 99); 27 Jan 2010 16:06:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:06:42 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gsiasf@gmail.com designates 209.85.210.194 as permitted sender)
Received: from [209.85.210.194] (HELO mail-yx0-f194.google.com) (209.85.210.194)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:06:33 +0000
Received: by yxe32 with SMTP id 32so11017279yxe.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 08:06:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:sender:content-type
         :mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=iYYolMRhyyLmWNNaL+BLMWu97KVlbFqjFWzU4Wmq+20=;
        b=A1G2Rq83GdAhyl7LCSDs+QggcbXXlmsy4sCU2V/7hpnBBmg+q13MA/32iH7uVcTOTw
         Fy7kRjpDnh0j9UXvPnPZQo9Ik4fp7TJ+grDRWfGf6wTm7ULorEy4YLDvF0451ZDxuJ0X
         jpXu/vmBzXWoQZcKbp+YdJ/tj7YWSGrSa/LQw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=sender:content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        b=XAiYLUCAwJbQ4u15fq1mekNWZx8fJ+Fn5OW5ccOytSSaODY1RlZTCpjP+tXzmMZNgh
         BlIcPti3BmqtRR4SjaWOOfAQJJ54HC8CltZbzXJpRwNF0ywtA32uh+ypGS5pbPliuR7y
         XiG5oQVVuxhcl2ja2cYfP0MiDVnDREXMwolcU=
Received: by 10.91.19.17 with SMTP id w17mr2178977agi.54.1264608372856;
        Wed, 27 Jan 2010 08:06:12 -0800 (PST)
Received: from ?10.0.0.77? (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
        by mx.google.com with ESMTPS id 13sm15088gxk.1.2010.01.27.08.06.11
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 27 Jan 2010 08:06:12 -0800 (PST)
Sender: Grant Ingersoll <gsiasf@gmail.com>
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Average Precision -  TREC-3
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <241510.57327.qm@web32603.mail.mud.yahoo.com>
Date: Wed, 27 Jan 2010 11:06:11 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <2CF2FADC-5E9E-4794-9C16-57756819DF93@apache.org>
References: <241510.57327.qm@web32603.mail.mud.yahoo.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)


On Jan 26, 2010, at 8:28 AM, Ivan Provalov wrote:

> We are looking into making some improvements to relevance ranking of =
our search platform based on Lucene.  We started by running the Ad Hoc =
TREC task on the TREC-3 data using "out-of-the-box" Lucene.  The reason =
to run this old TREC-3 (TIPSTER Disk 1 and Disk 2; topics 151-200) data =
was that the content is matching the content of our production system. =20=

>=20
> We are currently getting average precision of 0.14.  We found some =
format issues with the TREC-3 data which were causing even lower score.  =
For example, the initial average precision number was 0.9.  We =
discovered that the topics included the word "Topic:" in the <title> =
tag.  For example,=20
> "<title> Topic:  Coping with overcrowded prisons".  By removing this =
term from the queries, we bumped the average precision to 0.14.

There's usually a lot of this involved in running TREC.  I've also seen =
a good deal of improvement from things like using phrase queries and the =
Dismax Query Parser in Solr (which uses DisjunctionQuery in Lucene, =
amongst other things) and by playing around with length normalization.


>=20
> Our query is based on the title tag of the topic and the index field =
is based on the <TEXT> tag of the document. =20
>=20
> QualityQueryParser qqParser =3D new SimpleQQParser("title", "TEXT");
>=20
> Is there an average precision number which "out-of-the-box" Lucene =
should be close to?  For example, this IBM's 2007 TREC paper mentions =
0.154: =20
> http://trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf

Hard to say.  I can't say I've run TREC 3.  You might ask over on the =
Open Relevance list too (http://lucene.apache.org/openrelevance).  I =
know Robert Muir's done a lot of experiments with Lucene on standard =
collections like TREC.

I guess the bigger question back to you is what is your goal?  Is it to =
get better at TREC or to actually tune your system?

-Grant


--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem using Solr/Lucene: =
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44709-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 16:08:55 2010
Return-Path: <java-user-return-44709-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63742 invoked from network); 27 Jan 2010 16:08:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 16:08:55 -0000
Received: (qmail 20287 invoked by uid 500); 27 Jan 2010 16:08:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20215 invoked by uid 500); 27 Jan 2010 16:08:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20205 invoked by uid 99); 27 Jan 2010 16:08:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:08:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:08:46 +0000
Received: by pxi16 with SMTP id 16so4488172pxi.29
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 08:08:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=xHJXypvMZK+ddxVvDCv8GnXXxEFGxAP3JSxq426lXO8=;
        b=ALg3vvwXHnkNV/xdqOjuqwR982CNiDvI8N+c88Xdhk7LUHNL+NCmpycz5nMhHGnKU2
         FO95nCyUyz6/QYiXd2qwqi8dmTyfaOYs2Z75kWpq5GpkHWEvnfXqn3MjWQ5TZTIY90SH
         mSHZRQq3OFRLs8J9wv1YTm3qB/7ApQUhd2lcc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=BXaX9uWREc/Ibj9hsKKU5EiP+BWrIs6QTJXp8Fr+/Om5qBbkd1XiIfxW5rPwSfu1HC
         LbFM2XjwUFP8g4xfFpnI1E2xw+h+M6GvQlzyM25cMUg9AJ4ioTENy4bm2B/dcYwo6qeN
         nG75xEL+AYARQ4NJU1x2r0OSBUbJzI5siM2hc=
MIME-Version: 1.0
Received: by 10.115.117.4 with SMTP id u4mr6634193wam.174.1264608506163; Wed, 
	27 Jan 2010 08:08:26 -0800 (PST)
In-Reply-To: <3b23ce091001270801r7320fc87qbea5bb96297500cd@mail.gmail.com>
References: <3b23ce091001270801r7320fc87qbea5bb96297500cd@mail.gmail.com>
From: Robert Muir <rcmuir@gmail.com>
Date: Wed, 27 Jan 2010 11:08:06 -0500
Message-ID: <8f0ad1f31001270808r1b73ce09re946cfec9f2a53e0@mail.gmail.com>
Subject: Re: Analyze java camelcase words ?
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64e9098ca3259047e279cbc

--0016e64e9098ca3259047e279cbc
Content-Type: text/plain; charset=UTF-8

WordDelimiterFilter has a splitOnCaseChange option that should be useful for
this:
http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.WordDelimiterFilterFactory

>From the example: PowerShot -> Power, Shot

On Wed, Jan 27, 2010 at 11:01 AM, Phan The Dai <thienthanhomenh@gmail.com>wrote:

> Can everyone suggest me a solution for tokenize the camelcase words in java
> ?
> Examples for camelcase words are: getXmlRule, setTokenizeAnalyzer.
> They should be tokenized to get, Xml, Rule, set, Tokenize, Analyzer.
>
> Thank you very much!
>



-- 
Robert Muir
rcmuir@gmail.com

--0016e64e9098ca3259047e279cbc--

From java-user-return-44710-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 16:17:45 2010
Return-Path: <java-user-return-44710-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66484 invoked from network); 27 Jan 2010 16:17:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 16:17:45 -0000
Received: (qmail 34835 invoked by uid 500); 27 Jan 2010 16:17:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34740 invoked by uid 500); 27 Jan 2010 16:17:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34730 invoked by uid 99); 27 Jan 2010 16:17:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:17:42 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.222.198 as permitted sender)
Received: from [209.85.222.198] (HELO mail-pz0-f198.google.com) (209.85.222.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:17:33 +0000
Received: by pzk36 with SMTP id 36so6033025pzk.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 08:17:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=SqjAyQjPHotuI1hGpCACrPpKdfBNt3jWapRCpi7dEaw=;
        b=FcD1viudqkwW2cIFLprdM4es9rlcTHfpZbqxZ930o/ru6A+eRsa+wBpYjyJKk0tSeR
         urAvjeSCuhkfxvaVjOGHP/xDgVILl3yXn1Rh5NhBOTKVGezeN1GqoXDgSt0Ke201PZju
         B34BNjcvFEn0JZJJ5KIajkhyx6YRlGtYcwFA8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=NJUhFYaUW6Cz7+FplyBIMsgHpYtt06gACsCrvdLdcaENiwbfjqXcKjXdPxlMxqoS5w
         0nOtQu3pr++osLxqtVFwhSADYQvqGVzCmN+MJ4pGfeSraRElttENSYG4PUHx/cvr1IhX
         LKroZLic0BeYw5/UQ0D29JXsctd/Eyrp4C/mg=
MIME-Version: 1.0
Received: by 10.114.186.10 with SMTP id j10mr6658059waf.206.1264609033194; 
	Wed, 27 Jan 2010 08:17:13 -0800 (PST)
In-Reply-To: <2CF2FADC-5E9E-4794-9C16-57756819DF93@apache.org>
References: <241510.57327.qm@web32603.mail.mud.yahoo.com> <2CF2FADC-5E9E-4794-9C16-57756819DF93@apache.org>
From: Robert Muir <rcmuir@gmail.com>
Date: Wed, 27 Jan 2010 11:16:53 -0500
Message-ID: <8f0ad1f31001270816u324905c7ye8b69f70d6ed66e4@mail.gmail.com>
Subject: Re: Average Precision - TREC-3
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64cb0fa340de1047e27bc62

--0016e64cb0fa340de1047e27bc62
Content-Type: text/plain; charset=UTF-8

Hello, forgive my ignorance here (I have not worked with these english TREC
collections), but is the TREC-3 test collection the same as the test
collection used in the 2007 paper you referenced?

It looks like that is a different collection, its not really possible to
compare these relevance scores across different collections.

On Wed, Jan 27, 2010 at 11:06 AM, Grant Ingersoll <gsingers@apache.org>wrote:

>
> On Jan 26, 2010, at 8:28 AM, Ivan Provalov wrote:
>
> > We are looking into making some improvements to relevance ranking of our
> search platform based on Lucene.  We started by running the Ad Hoc TREC task
> on the TREC-3 data using "out-of-the-box" Lucene.  The reason to run this
> old TREC-3 (TIPSTER Disk 1 and Disk 2; topics 151-200) data was that the
> content is matching the content of our production system.
> >
> > We are currently getting average precision of 0.14.  We found some format
> issues with the TREC-3 data which were causing even lower score.  For
> example, the initial average precision number was 0.9.  We discovered that
> the topics included the word "Topic:" in the <title> tag.  For example,
> > "<title> Topic:  Coping with overcrowded prisons".  By removing this term
> from the queries, we bumped the average precision to 0.14.
>
> There's usually a lot of this involved in running TREC.  I've also seen a
> good deal of improvement from things like using phrase queries and the
> Dismax Query Parser in Solr (which uses DisjunctionQuery in Lucene, amongst
> other things) and by playing around with length normalization.
>
>
> >
> > Our query is based on the title tag of the topic and the index field is
> based on the <TEXT> tag of the document.
> >
> > QualityQueryParser qqParser = new SimpleQQParser("title", "TEXT");
> >
> > Is there an average precision number which "out-of-the-box" Lucene should
> be close to?  For example, this IBM's 2007 TREC paper mentions 0.154:
> > http://trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf
>
> Hard to say.  I can't say I've run TREC 3.  You might ask over on the Open
> Relevance list too (http://lucene.apache.org/openrelevance).  I know
> Robert Muir's done a lot of experiments with Lucene on standard collections
> like TREC.
>
> I guess the bigger question back to you is what is your goal?  Is it to get
> better at TREC or to actually tune your system?
>
> -Grant
>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Robert Muir
rcmuir@gmail.com

--0016e64cb0fa340de1047e27bc62--

From java-user-return-44711-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 16:18:00 2010
Return-Path: <java-user-return-44711-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66577 invoked from network); 27 Jan 2010 16:18:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 16:18:00 -0000
Received: (qmail 36818 invoked by uid 500); 27 Jan 2010 16:17:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36764 invoked by uid 500); 27 Jan 2010 16:17:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36754 invoked by uid 99); 27 Jan 2010 16:17:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:17:58 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:17:51 +0000
Received: by ewy2 with SMTP id 2so6958554ewy.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 08:17:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uccnFIKCjjxPi6iU2PZiAV+t3fJyjH2N+sMcyH9cXjE=;
        b=gaYupEm+cFoEekGditpyzRCMgmh2EXdAiXPb6suogM1M6gm0rXZNDbfRp6sbb2lEa7
         v+7NZ5vICW7ZprsbmUptuf1WtuwBf42p+5pCHaUNTMfbgoe6XDumctMsmm3hVFP4FnQi
         moxL/KnJN/Z80T1JEW2XXIViS+4euc7CPQO0w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=syqWTcHy+tAwxZHOXPdAYwQTQ56aH8QR4lOuT6PhmgzldhOvL19tyChn3k90bI13zU
         AsPO82r7WhC9IEqnUkujUopn5OquTsXrJNcUlqgcfztDRDzDoeoCbxj2W/18ZZMM6kN1
         l8LPcdkkvbXJI2fvMuEc8/E8TIjX8uJF8q0kg=
MIME-Version: 1.0
Received: by 10.216.90.76 with SMTP id d54mr1994943wef.55.1264609049775; Wed, 
	27 Jan 2010 08:17:29 -0800 (PST)
In-Reply-To: <8f0ad1f31001270808r1b73ce09re946cfec9f2a53e0@mail.gmail.com>
References: <3b23ce091001270801r7320fc87qbea5bb96297500cd@mail.gmail.com>
	 <8f0ad1f31001270808r1b73ce09re946cfec9f2a53e0@mail.gmail.com>
Date: Wed, 27 Jan 2010 11:17:29 -0500
Message-ID: <359a92831001270817s16319876oec5e6a4d6cacd334@mail.gmail.com>
Subject: Re: Analyze java camelcase words ?
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6d778dd310fab047e27bd1d

--0016e6d778dd310fab047e27bd1d
Content-Type: text/plain; charset=ISO-8859-1

Robert:

Is this in Lucene yet? According to what I could find in JIRA, it's
still open. And it's not in the Javadocs on a quick scan.....

Erick

On Wed, Jan 27, 2010 at 11:08 AM, Robert Muir <rcmuir@gmail.com> wrote:

> WordDelimiterFilter has a splitOnCaseChange option that should be useful
> for
> this:
>
> http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.WordDelimiterFilterFactory
>
> From the example: PowerShot -> Power, Shot
>
> On Wed, Jan 27, 2010 at 11:01 AM, Phan The Dai <thienthanhomenh@gmail.com
> >wrote:
>
> > Can everyone suggest me a solution for tokenize the camelcase words in
> java
> > ?
> > Examples for camelcase words are: getXmlRule, setTokenizeAnalyzer.
> > They should be tokenized to get, Xml, Rule, set, Tokenize, Analyzer.
> >
> > Thank you very much!
> >
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>

--0016e6d778dd310fab047e27bd1d--

From java-user-return-44712-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 16:22:11 2010
Return-Path: <java-user-return-44712-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67685 invoked from network); 27 Jan 2010 16:22:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 16:22:11 -0000
Received: (qmail 51036 invoked by uid 500); 27 Jan 2010 16:22:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50975 invoked by uid 500); 27 Jan 2010 16:22:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50965 invoked by uid 99); 27 Jan 2010 16:22:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:22:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of rcmuir@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:22:02 +0000
Received: by pxi16 with SMTP id 16so4504854pxi.29
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 08:21:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=qvdUrCcUY53qS/XE+Unz+fklVv/ymllUGOvvr8jn/Ro=;
        b=oi8l3xK9AyhVoAmUT/H1j0riV3plZWfbRWyEP6gmq37a7TlsKT5klkUthqxvg3dbio
         5Q2JeIyImOeUtbmSXWuASuR9Q/a9xO35nrciFQepSs0dLMzi7WSYCoN4lVGoypLKWLSa
         p7rvYeP6uG2fAuFdTIV88MfumFBCVK5aXZBo0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=XVmW9I2lpsrB1iu2mrH5PuAZdcXifnoqm6qfGuKAGaB3SgqLAO3DULl++d3q3XMaY1
         zXzdZGYZSQ0YwIg7RamDL9KfLO+wAHNLdQWTQjAdDFbvAPiSEAB5Kf1Dayjc5W4IiPLA
         KlvDyNrR0pUgwyo5vW3vDJalq9iyBzoUj56zA=
MIME-Version: 1.0
Received: by 10.114.186.10 with SMTP id j10mr6661225waf.206.1264609302227; 
	Wed, 27 Jan 2010 08:21:42 -0800 (PST)
In-Reply-To: <359a92831001270817s16319876oec5e6a4d6cacd334@mail.gmail.com>
References: <3b23ce091001270801r7320fc87qbea5bb96297500cd@mail.gmail.com> 
	<8f0ad1f31001270808r1b73ce09re946cfec9f2a53e0@mail.gmail.com> 
	<359a92831001270817s16319876oec5e6a4d6cacd334@mail.gmail.com>
From: Robert Muir <rcmuir@gmail.com>
Date: Wed, 27 Jan 2010 11:21:22 -0500
Message-ID: <8f0ad1f31001270821r2603fac4m1115a7fed8944c7@mail.gmail.com>
Subject: Re: Analyze java camelcase words ?
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64cb0fa3d2c4d047e27cc6d

--0016e64cb0fa3d2c4d047e27cc6d
Content-Type: text/plain; charset=UTF-8

no, but you can take the tokenfilter itself and simply use it in your lucene
application.

it uses the old tokenstream API so if you want to use Lucene 3.0 or 3.1, you
will need a version that works with the new tokenstream API.
There is a patch available here for that:
https://issues.apache.org/jira/browse/SOLR-1710

On Wed, Jan 27, 2010 at 11:17 AM, Erick Erickson <erickerickson@gmail.com>wrote:

> Robert:
>
> Is this in Lucene yet? According to what I could find in JIRA, it's
> still open. And it's not in the Javadocs on a quick scan.....
>
> Erick
>
> On Wed, Jan 27, 2010 at 11:08 AM, Robert Muir <rcmuir@gmail.com> wrote:
>
> > WordDelimiterFilter has a splitOnCaseChange option that should be useful
> > for
> > this:
> >
> >
> http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.WordDelimiterFilterFactory
> >
> > From the example: PowerShot -> Power, Shot
> >
> > On Wed, Jan 27, 2010 at 11:01 AM, Phan The Dai <
> thienthanhomenh@gmail.com
> > >wrote:
> >
> > > Can everyone suggest me a solution for tokenize the camelcase words in
> > java
> > > ?
> > > Examples for camelcase words are: getXmlRule, setTokenizeAnalyzer.
> > > They should be tokenized to get, Xml, Rule, set, Tokenize, Analyzer.
> > >
> > > Thank you very much!
> > >
> >
> >
> >
> > --
> > Robert Muir
> > rcmuir@gmail.com
> >
>



-- 
Robert Muir
rcmuir@gmail.com

--0016e64cb0fa3d2c4d047e27cc6d--

From java-user-return-44713-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 16:26:34 2010
Return-Path: <java-user-return-44713-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69792 invoked from network); 27 Jan 2010 16:26:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 16:26:34 -0000
Received: (qmail 61003 invoked by uid 500); 27 Jan 2010 16:26:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60937 invoked by uid 500); 27 Jan 2010 16:26:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60927 invoked by uid 99); 27 Jan 2010 16:26:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:26:32 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of thienthanhomenh@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 16:26:25 +0000
Received: by qw-out-2122.google.com with SMTP id 8so399737qwh.53
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 08:26:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=HR+AduuX6HyZ+z+O0QOTILMx+j+rakVOd/+LV5xvUwA=;
        b=fAd/Y4j67YzXkp4tzk4gIBc8axRJGYA3BX7CXNDnezjOXumhHs5mBzSGbKSOShts5Q
         91IaUn0+g4RiHgqeCrBen1S7Z+kQQX8d7apLQ7zFMInQVla5NOlRgItXq+QTCvrJ3fQj
         OyqlvxzkAzNnTnLI4ZPqoQ315pAPzQzREBCYo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=Lij1ycFxPSeelyOnu2muTgynysUhOVkW4CILhJZLU2htjL2V+t8RtrVSJK3vs9mHPR
         xLJdFRjMeDDUlLge6bx5hoghqQctBkjt+eJ8yc3sjWxVciUT2hrF6CgLB7PdF1LlOeoO
         xoyGEINf6jRqI1tN3AEBpLD3eywaFpJ+UJubM=
MIME-Version: 1.0
Received: by 10.224.123.213 with SMTP id q21mr5685165qar.225.1264609555086; 
	Wed, 27 Jan 2010 08:25:55 -0800 (PST)
In-Reply-To: <8f0ad1f31001270821r2603fac4m1115a7fed8944c7@mail.gmail.com>
References: <3b23ce091001270801r7320fc87qbea5bb96297500cd@mail.gmail.com> 
	<8f0ad1f31001270808r1b73ce09re946cfec9f2a53e0@mail.gmail.com> 
	<359a92831001270817s16319876oec5e6a4d6cacd334@mail.gmail.com> 
	<8f0ad1f31001270821r2603fac4m1115a7fed8944c7@mail.gmail.com>
From: Phan The Dai <thienthanhomenh@gmail.com>
Date: Thu, 28 Jan 2010 01:25:35 +0900
Message-ID: <3b23ce091001270825u1572a724h3bc57f94915eac79@mail.gmail.com>
Subject: Re: Analyze java camelcase words ?
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00c09f9c9ad44f80ed047e27dbed

--00c09f9c9ad44f80ed047e27dbed
Content-Type: text/plain; charset=ISO-8859-1

Thank you much.
I study about your comments. They are useful.
I am newer using Lucene 3.0. Hope it works well.

On Thu, Jan 28, 2010 at 1:21 AM, Robert Muir <rcmuir@gmail.com> wrote:

> no, but you can take the tokenfilter itself and simply use it in your
> lucene
> application.
>
> it uses the old tokenstream API so if you want to use Lucene 3.0 or 3.1,
> you
> will need a version that works with the new tokenstream API.
> There is a patch available here for that:
> https://issues.apache.org/jira/browse/SOLR-1710
>
> On Wed, Jan 27, 2010 at 11:17 AM, Erick Erickson <erickerickson@gmail.com
> >wrote:
>
> > Robert:
> >
> > Is this in Lucene yet? According to what I could find in JIRA, it's
> > still open. And it's not in the Javadocs on a quick scan.....
> >
> > Erick
> >
> > On Wed, Jan 27, 2010 at 11:08 AM, Robert Muir <rcmuir@gmail.com> wrote:
> >
> > > WordDelimiterFilter has a splitOnCaseChange option that should be
> useful
> > > for
> > > this:
> > >
> > >
> >
> http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.WordDelimiterFilterFactory
> > >
> > > From the example: PowerShot -> Power, Shot
> > >
> > > On Wed, Jan 27, 2010 at 11:01 AM, Phan The Dai <
> > thienthanhomenh@gmail.com
> > > >wrote:
> > >
> > > > Can everyone suggest me a solution for tokenize the camelcase words
> in
> > > java
> > > > ?
> > > > Examples for camelcase words are: getXmlRule, setTokenizeAnalyzer.
> > > > They should be tokenized to get, Xml, Rule, set, Tokenize, Analyzer.
> > > >
> > > > Thank you very much!
> > > >
> > >
> > >
> > >
> > > --
> > > Robert Muir
> > > rcmuir@gmail.com
> > >
> >
>
>
>
> --
> Robert Muir
> rcmuir@gmail.com
>

--00c09f9c9ad44f80ed047e27dbed--

From java-user-return-44714-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 18:36:54 2010
Return-Path: <java-user-return-44714-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44054 invoked from network); 27 Jan 2010 18:36:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 18:36:54 -0000
Received: (qmail 23779 invoked by uid 500); 27 Jan 2010 18:36:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23703 invoked by uid 500); 27 Jan 2010 18:36:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23693 invoked by uid 99); 27 Jan 2010 18:36:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 18:36:52 +0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.142.207.229] (HELO web32602.mail.mud.yahoo.com) (68.142.207.229)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 27 Jan 2010 18:36:41 +0000
Received: (qmail 27685 invoked by uid 60001); 27 Jan 2010 18:36:19 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264617379; bh=gmtcL3xL03dTXudHcOGsojj9SuSa1lbj6cGHNRgMBsY=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=WytUCc79NLv0+rrGEseLFncYRnUxE/JO00Fn32xM450NxbYfeRh4Tz3fDlXLzzDQuSAFANYzuJERiXldvK3ejeL0EGGlXrZBstouMFn/2AYq7ymtkrBCq1fCCyS5c1jEzscH5Y7z9AdtZdwHWa+Qda+L1fOUmAK+iXqnTzW5bcM=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=6M5CxmyHirkA0qOQLFUGwpMmbnWzpmeOiDeDUstYjNrZ6DMqw5hxIumPuR+vpsaN+5DzSIufCw33BuAtsxzd7WE8pKIT+3kV9sZc8q5DuCrmO6Q5vBkTGgv9iRY2UnKjPgSQJ9CrhK97A0jl9HyYpHA7ZyacgFkkkl55NBj9HBc=;
Message-ID: <672188.25802.qm@web32602.mail.mud.yahoo.com>
X-YMail-OSG: x4ke5PsVM1ny8H73UjL_3EC0mcfXxGYq2g.sggLKNKm34CJXbOYtn_q.CcXyugnov6BgX1Orvw1AhP0DBIa4FfUB2mUQjVkI6IVi6k0mexw4yyttCCHLmIiVbmco0IHIGaiWIect5T8KMslvUCbXWTWv_sv6iFcMsel1Os.SRtql6jZ43IwYNwJ9FdVc_6o1sag8v2uQDLfLjzclSVVsrKLfR6A8emnOJRbYpf4j2RB2Itf2iKm9o5AVMmsSAmYPx8Ht2LMsauJDBoRqSJ56JLEK_G8IUBd1iv3v8WLAgY1VKMXpa2.W.cizRr3ohc8hkNhpOks7y6FswWVNN06IJ.xmD2KElR05AgGJAS9CfTnuE2Laz3Y7ekYLTZlD0uu2u6ZV2HNw_bd7BcWGG3u6kSq4XXbRrKHu7axDjt0GnupspTQk9FTYVaBFmzzeU1qmp2rOdgHqUTndlsCzwPSj7JT2W1s8FQeJNg9sItLPKWxDyCOsDinJ3N7ek.uwyLlXdR1BpDDduzGcAGv5gpXUT8zrFxECOCr_QmRXiRQ5
Received: from [140.244.128.12] by web32602.mail.mud.yahoo.com via HTTP; Wed, 27 Jan 2010 10:36:19 PST
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Wed, 27 Jan 2010 10:36:19 -0800 (PST)
From: Ivan Provalov <iprovalo@yahoo.com>
Subject: Re: Average Precision - TREC-3
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Robert, Grant:=0A=0AThank you for your replies.=A0 =0A=0AOur goal is to fin=
e-tune our existing system to perform better on relevance.=0A=0AI agree wit=
h Robert's comment that these collections are not completely compatible.=A0=
 Yes, it is possible that the results will vary some depending on the colle=
ctions differences.=A0 The reason for us picking TREC-3 TIPSTER collection =
is that our production content overlaps with some TIPSTER documents.=A0 =0A=
=0AAny suggestions on how to obtain Lucene's TREC-3 compatible results, or =
select a better approach would be appreciated.=0A=0AWe are doing this proje=
ct in three stages:=0A=0A1. Test Lucene's "vanilla" performance to establis=
h the baseline.=A0 We want to iron out the issues such as topic or document=
 formats.  For example, we had to add a different parser and clean up the t=
opic title.=A0 This will give us confidence that we are using the data and =
the methodology correctly.=0A=0A2. Fine-tune Lucene based on the latest res=
earch findings (TREC by E. Voorhees, conference proceedings, etc...).=0A=0A=
3. Repeat these steps with our production system which runs on Lucene.=A0 T=
he reason we are doing this step last is to ensure that our overall system =
doesn't introduce the relevance issues (content pre-processing steps, query=
 parsing steps, etc...).=0A=0AThank you,=0A=0AIvan Provalov=0A=0A--- On Wed=
, 1/27/10, Robert Muir <rcmuir@gmail.com> wrote:=0A=0A> From: Robert Muir <=
rcmuir@gmail.com>=0A> Subject: Re: Average Precision - TREC-3=0A> To: java-=
user@lucene.apache.org=0A> Date: Wednesday, January 27, 2010, 11:16 AM=0A> =
Hello, forgive my ignorance here (I=0A> have not worked with these english =
TREC=0A> collections), but is the TREC-3 test collection the same as=0A> th=
e test=0A> collection used in the 2007 paper you referenced?=0A> =0A> It lo=
oks like that is a different collection, its not=0A> really possible to=0A>=
 compare these relevance scores across different=0A> collections.=0A> =0A> =
On Wed, Jan 27, 2010 at 11:06 AM, Grant Ingersoll <gsingers@apache.org>wrot=
e:=0A> =0A> >=0A> > On Jan 26, 2010, at 8:28 AM, Ivan Provalov wrote:=0A> >=
=0A> > > We are looking into making some improvements to=0A> relevance rank=
ing of our=0A> > search platform based on Lucene.=A0 We started by=0A> runn=
ing the Ad Hoc TREC task=0A> > on the TREC-3 data using "out-of-the-box"=0A=
> Lucene.=A0 The reason to run this=0A> > old TREC-3 (TIPSTER Disk 1 and Di=
sk 2; topics 151-200)=0A> data was that the=0A> > content is matching the c=
ontent of our production=0A> system.=0A> > >=0A> > > We are currently getti=
ng average precision of=0A> 0.14.=A0 We found some format=0A> > issues with=
 the TREC-3 data which were causing even=0A> lower score.=A0 For=0A> > exam=
ple, the initial average precision number was=0A> 0.9.=A0 We discovered tha=
t=0A> > the topics included the word "Topic:" in the=0A> <title> tag.=A0 Fo=
r example,=0A> > > "<title> Topic:=A0 Coping with=0A> overcrowded prisons".=
=A0 By removing this term=0A> > from the queries, we bumped the average pre=
cision to=0A> 0.14.=0A> >=0A> > There's usually a lot of this involved in r=
unning=0A> TREC.=A0 I've also seen a=0A> > good deal of improvement from th=
ings like using phrase=0A> queries and the=0A> > Dismax Query Parser in Sol=
r (which uses=0A> DisjunctionQuery in Lucene, amongst=0A> > other things) a=
nd by playing around with length=0A> normalization.=0A> >=0A> >=0A> > >=0A>=
 > > Our query is based on the title tag of the topic=0A> and the index fie=
ld is=0A> > based on the <TEXT> tag of the document.=0A> > >=0A> > > Qualit=
yQueryParser qqParser =3D new=0A> SimpleQQParser("title", "TEXT");=0A> > >=
=0A> > > Is there an average precision number which=0A> "out-of-the-box" Lu=
cene should=0A> > be close to?=A0 For example, this IBM's 2007 TREC=0A> pap=
er mentions 0.154:=0A> > > http://trec.nist.gov/pubs/trec16/papers/ibm-haif=
a.mq.final.pdf=0A> >=0A> > Hard to say.=A0 I can't say I've run TREC 3.=A0=
=0A> You might ask over on the Open=0A> > Relevance list too (http://lucene=
.apache.org/openrelevance).=A0 I know=0A> > Robert Muir's done a lot of exp=
eriments with Lucene on=0A> standard collections=0A> > like TREC.=0A> >=0A>=
 > I guess the bigger question back to you is what is=0A> your goal?=A0 Is =
it to get=0A> > better at TREC or to actually tune your system?=0A> >=0A> >=
 -Grant=0A> >=0A> >=0A> > --------------------------=0A> > Grant Ingersoll=
=0A> > http://www.lucidimagination.com/=0A> >=0A> > Search the Lucene ecosy=
stem using Solr/Lucene:=0A> > http://www.lucidimagination.com/search=0A> >=
=0A> >=0A> >=0A> ----------------------------------------------------------=
-----------=0A> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apac=
he.org=0A> > For additional commands, e-mail: java-user-help@lucene.apache.=
org=0A> >=0A> >=0A> =0A> =0A> -- =0A> Robert Muir=0A> rcmuir@gmail.com=0A>=
=0A=0A=0A=0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44715-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 18:42:24 2010
Return-Path: <java-user-return-44715-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45558 invoked from network); 27 Jan 2010 18:42:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 18:42:23 -0000
Received: (qmail 40580 invoked by uid 500); 27 Jan 2010 18:42:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40521 invoked by uid 500); 27 Jan 2010 18:42:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40511 invoked by uid 99); 27 Jan 2010 18:42:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 18:42:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jose.aguera@gmail.com designates 209.85.218.217 as permitted sender)
Received: from [209.85.218.217] (HELO mail-bw0-f217.google.com) (209.85.218.217)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 18:42:10 +0000
Received: by bwz9 with SMTP id 9so4609224bwz.12
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 10:41:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type
         :content-transfer-encoding;
        bh=w9SVfmtfRS5eCzjo/7HfZXBt8jkgtQgOreeWWoFlZUo=;
        b=WBFP6stc3zKRa0CPHNCTUd4FuuTBYzRtrKgRpQNuHqfGDub1ZIjnv9CSJZSWiUzs2x
         83I8mUmc5sUMKj5oRXc3bXKb1CaRAVLXq4m1b7hDN9Itue35pFz30cAzY9G6BKBZ5dNS
         va14fM02/r1ApYHIhXykdzepYrHOu2/6t/bNM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        b=eKS2RhIidYsfWaVX0hx60WqoGiUN9pA6pImNRXh4xp02RvM0wZu8jPdodJjc21tBYP
         4OtkIMjqkLKEehsr32FNYAtxCJ9PpNrfgWPJMhkicz1Qk2Gshi9JysK500mRi73Bkhn5
         MF4xDJOG97mnrc3sT8iriBMu5OrkGNEZ8BeKE=
MIME-Version: 1.0
Received: by 10.204.34.212 with SMTP id m20mr1711397bkd.79.1264617709430; Wed, 
	27 Jan 2010 10:41:49 -0800 (PST)
In-Reply-To: <672188.25802.qm@web32602.mail.mud.yahoo.com>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com>
Date: Wed, 27 Jan 2010 13:41:49 -0500
Message-ID: <9ab5344d1001271041q4099b298xed6b55adc6158b3e@mail.gmail.com>
Subject: Re: Average Precision - TREC-3
From: =?ISO-8859-1?Q?Jos=E9_Ram=F3n_P=E9rez_Ag=FCera?= <jose.aguera@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Ivan,

you might want use the lucene BM25 implementation. Results should be
better changing the ranking function. Another option is Language model
implementation for Lucene:

http://nlp.uned.es/~jperezi/Lucene-BM25/
http://ilps.science.uva.nl/resources/lm-lucene

The main problem with this implementation is that not every different
kind of Lucene query, but if you don't need that these alternatives
implementation are a good choice.

best jose

On Wed, Jan 27, 2010 at 1:36 PM, Ivan Provalov <iprovalo@yahoo.com> wrote:
> Robert, Grant:
>
> Thank you for your replies.
>
> Our goal is to fine-tune our existing system to perform better on relevan=
ce.
>
> I agree with Robert's comment that these collections are not completely c=
ompatible.=A0 Yes, it is possible that the results will vary some depending=
 on the collections differences.=A0 The reason for us picking TREC-3 TIPSTE=
R collection is that our production content overlaps with some TIPSTER docu=
ments.
>
> Any suggestions on how to obtain Lucene's TREC-3 compatible results, or s=
elect a better approach would be appreciated.
>
> We are doing this project in three stages:
>
> 1. Test Lucene's "vanilla" performance to establish the baseline.=A0 We w=
ant to iron out the issues such as topic or document formats. =A0For exampl=
e, we had to add a different parser and clean up the topic title.=A0 This w=
ill give us confidence that we are using the data and the methodology corre=
ctly.
>
> 2. Fine-tune Lucene based on the latest research findings (TREC by E. Voo=
rhees, conference proceedings, etc...).
>
> 3. Repeat these steps with our production system which runs on Lucene.=A0=
 The reason we are doing this step last is to ensure that our overall syste=
m doesn't introduce the relevance issues (content pre-processing steps, que=
ry parsing steps, etc...).
>
> Thank you,
>
> Ivan Provalov
>
> --- On Wed, 1/27/10, Robert Muir <rcmuir@gmail.com> wrote:
>
>> From: Robert Muir <rcmuir@gmail.com>
>> Subject: Re: Average Precision - TREC-3
>> To: java-user@lucene.apache.org
>> Date: Wednesday, January 27, 2010, 11:16 AM
>> Hello, forgive my ignorance here (I
>> have not worked with these english TREC
>> collections), but is the TREC-3 test collection the same as
>> the test
>> collection used in the 2007 paper you referenced?
>>
>> It looks like that is a different collection, its not
>> really possible to
>> compare these relevance scores across different
>> collections.
>>
>> On Wed, Jan 27, 2010 at 11:06 AM, Grant Ingersoll <gsingers@apache.org>w=
rote:
>>
>> >
>> > On Jan 26, 2010, at 8:28 AM, Ivan Provalov wrote:
>> >
>> > > We are looking into making some improvements to
>> relevance ranking of our
>> > search platform based on Lucene.=A0 We started by
>> running the Ad Hoc TREC task
>> > on the TREC-3 data using "out-of-the-box"
>> Lucene.=A0 The reason to run this
>> > old TREC-3 (TIPSTER Disk 1 and Disk 2; topics 151-200)
>> data was that the
>> > content is matching the content of our production
>> system.
>> > >
>> > > We are currently getting average precision of
>> 0.14.=A0 We found some format
>> > issues with the TREC-3 data which were causing even
>> lower score.=A0 For
>> > example, the initial average precision number was
>> 0.9.=A0 We discovered that
>> > the topics included the word "Topic:" in the
>> <title> tag.=A0 For example,
>> > > "<title> Topic:=A0 Coping with
>> overcrowded prisons".=A0 By removing this term
>> > from the queries, we bumped the average precision to
>> 0.14.
>> >
>> > There's usually a lot of this involved in running
>> TREC.=A0 I've also seen a
>> > good deal of improvement from things like using phrase
>> queries and the
>> > Dismax Query Parser in Solr (which uses
>> DisjunctionQuery in Lucene, amongst
>> > other things) and by playing around with length
>> normalization.
>> >
>> >
>> > >
>> > > Our query is based on the title tag of the topic
>> and the index field is
>> > based on the <TEXT> tag of the document.
>> > >
>> > > QualityQueryParser qqParser =3D new
>> SimpleQQParser("title", "TEXT");
>> > >
>> > > Is there an average precision number which
>> "out-of-the-box" Lucene should
>> > be close to?=A0 For example, this IBM's 2007 TREC
>> paper mentions 0.154:
>> > > http://trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf
>> >
>> > Hard to say.=A0 I can't say I've run TREC 3.
>> You might ask over on the Open
>> > Relevance list too (http://lucene.apache.org/openrelevance).=A0 I know
>> > Robert Muir's done a lot of experiments with Lucene on
>> standard collections
>> > like TREC.
>> >
>> > I guess the bigger question back to you is what is
>> your goal?=A0 Is it to get
>> > better at TREC or to actually tune your system?
>> >
>> > -Grant
>> >
>> >
>> > --------------------------
>> > Grant Ingersoll
>> > http://www.lucidimagination.com/
>> >
>> > Search the Lucene ecosystem using Solr/Lucene:
>> > http://www.lucidimagination.com/search
>> >
>> >
>> >
>> ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>>
>> --
>> Robert Muir
>> rcmuir@gmail.com
>>
>
>
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Jose R. P=E9rez-Ag=FCera

Clinical Assistant Professor
Metadata Research Center
School of Information and Library Science
University of North Carolina at Chapel Hill
email: jaguera@email.unc.edu
Web page: http://www.unc.edu/~jaguera/
MRC website: http://ils.unc.edu/mrc/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44716-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 19:44:35 2010
Return-Path: <java-user-return-44716-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66038 invoked from network); 27 Jan 2010 19:44:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 19:44:35 -0000
Received: (qmail 57318 invoked by uid 500); 27 Jan 2010 19:44:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57282 invoked by uid 500); 27 Jan 2010 19:44:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57272 invoked by uid 99); 27 Jan 2010 19:44:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 19:44:33 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [69.32.146.53] (HELO thomsonlearning.com) (69.32.146.53)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 19:44:23 +0000
Received: from ([10.160.3.174])
	by ohciniron02.thomsonlearning.com with ESMTP with TLS id 5502562.61351350;
	Wed, 27 Jan 2010 14:40:06 -0500
Received: from ohcinpub02.corp.local (10.160.3.252) by ohcinht02.corp.local
 (10.160.3.174) with Microsoft SMTP Server (TLS) id 8.1.393.1; Wed, 27 Jan
 2010 14:40:05 -0500
Received: from OHCINMBX01.corp.local ([10.160.3.160]) by ohcinpub02.corp.local
 ([10.160.3.252]) with mapi; Wed, 27 Jan 2010 14:40:05 -0500
From: "Provalov, Ivan (Gale)" <Ivan.Provalov@cengage.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 27 Jan 2010 14:40:05 -0500
Subject: RE: Average Precision - TREC-3
Thread-Topic: Average Precision - TREC-3
Thread-Index: AcqfgHh/ImO8L8rbR2iyyl/dmDH8TQACAd6A
Message-ID: <70EA5691BD59734784FF872CD1B9747A15BA27947B@OHCINMBX01.corp.local>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com>
 <9ab5344d1001271041q4099b298xed6b55adc6158b3e@mail.gmail.com>
In-Reply-To: <9ab5344d1001271041q4099b298xed6b55adc6158b3e@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
x-tm-as-product-ver: SMEX-8.0.0.1181-6.000.1038-17158.000
x-tm-as-result: No--47.765000-8.000000-31
x-tm-as-user-approved-sender: No
x-tm-as-user-blocked-sender: No
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Thank you, Jose.

-----Original Message-----
From: Jos=E9 Ram=F3n P=E9rez Ag=FCera [mailto:jose.aguera@gmail.com]=20
Sent: Wednesday, January 27, 2010 1:42 PM
To: java-user@lucene.apache.org
Subject: Re: Average Precision - TREC-3

Hi Ivan,

you might want use the lucene BM25 implementation. Results should be
better changing the ranking function. Another option is Language model
implementation for Lucene:

http://nlp.uned.es/~jperezi/Lucene-BM25/
http://ilps.science.uva.nl/resources/lm-lucene

The main problem with this implementation is that not every different
kind of Lucene query, but if you don't need that these alternatives
implementation are a good choice.

best jose

On Wed, Jan 27, 2010 at 1:36 PM, Ivan Provalov <iprovalo@yahoo.com> wrote:
> Robert, Grant:
>
> Thank you for your replies.
>
> Our goal is to fine-tune our existing system to perform better on relevan=
ce.
>
> I agree with Robert's comment that these collections are not completely c=
ompatible.=A0 Yes, it is possible that the results will vary some depending=
 on the collections differences.=A0 The reason for us picking TREC-3 TIPSTE=
R collection is that our production content overlaps with some TIPSTER docu=
ments.
>
> Any suggestions on how to obtain Lucene's TREC-3 compatible results, or s=
elect a better approach would be appreciated.
>
> We are doing this project in three stages:
>
> 1. Test Lucene's "vanilla" performance to establish the baseline.=A0 We w=
ant to iron out the issues such as topic or document formats. =A0For exampl=
e, we had to add a different parser and clean up the topic title.=A0 This w=
ill give us confidence that we are using the data and the methodology corre=
ctly.
>
> 2. Fine-tune Lucene based on the latest research findings (TREC by E. Voo=
rhees, conference proceedings, etc...).
>
> 3. Repeat these steps with our production system which runs on Lucene.=A0=
 The reason we are doing this step last is to ensure that our overall syste=
m doesn't introduce the relevance issues (content pre-processing steps, que=
ry parsing steps, etc...).
>
> Thank you,
>
> Ivan Provalov
>
> --- On Wed, 1/27/10, Robert Muir <rcmuir@gmail.com> wrote:
>
>> From: Robert Muir <rcmuir@gmail.com>
>> Subject: Re: Average Precision - TREC-3
>> To: java-user@lucene.apache.org
>> Date: Wednesday, January 27, 2010, 11:16 AM
>> Hello, forgive my ignorance here (I
>> have not worked with these english TREC
>> collections), but is the TREC-3 test collection the same as
>> the test
>> collection used in the 2007 paper you referenced?
>>
>> It looks like that is a different collection, its not
>> really possible to
>> compare these relevance scores across different
>> collections.
>>
>> On Wed, Jan 27, 2010 at 11:06 AM, Grant Ingersoll <gsingers@apache.org>w=
rote:
>>
>> >
>> > On Jan 26, 2010, at 8:28 AM, Ivan Provalov wrote:
>> >
>> > > We are looking into making some improvements to
>> relevance ranking of our
>> > search platform based on Lucene.=A0 We started by
>> running the Ad Hoc TREC task
>> > on the TREC-3 data using "out-of-the-box"
>> Lucene.=A0 The reason to run this
>> > old TREC-3 (TIPSTER Disk 1 and Disk 2; topics 151-200)
>> data was that the
>> > content is matching the content of our production
>> system.
>> > >
>> > > We are currently getting average precision of
>> 0.14.=A0 We found some format
>> > issues with the TREC-3 data which were causing even
>> lower score.=A0 For
>> > example, the initial average precision number was
>> 0.9.=A0 We discovered that
>> > the topics included the word "Topic:" in the
>> <title> tag.=A0 For example,
>> > > "<title> Topic:=A0 Coping with
>> overcrowded prisons".=A0 By removing this term
>> > from the queries, we bumped the average precision to
>> 0.14.
>> >
>> > There's usually a lot of this involved in running
>> TREC.=A0 I've also seen a
>> > good deal of improvement from things like using phrase
>> queries and the
>> > Dismax Query Parser in Solr (which uses
>> DisjunctionQuery in Lucene, amongst
>> > other things) and by playing around with length
>> normalization.
>> >
>> >
>> > >
>> > > Our query is based on the title tag of the topic
>> and the index field is
>> > based on the <TEXT> tag of the document.
>> > >
>> > > QualityQueryParser qqParser =3D new
>> SimpleQQParser("title", "TEXT");
>> > >
>> > > Is there an average precision number which
>> "out-of-the-box" Lucene should
>> > be close to?=A0 For example, this IBM's 2007 TREC
>> paper mentions 0.154:
>> > > http://trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf
>> >
>> > Hard to say.=A0 I can't say I've run TREC 3.
>> You might ask over on the Open
>> > Relevance list too (http://lucene.apache.org/openrelevance).=A0 I know
>> > Robert Muir's done a lot of experiments with Lucene on
>> standard collections
>> > like TREC.
>> >
>> > I guess the bigger question back to you is what is
>> your goal?=A0 Is it to get
>> > better at TREC or to actually tune your system?
>> >
>> > -Grant
>> >
>> >
>> > --------------------------
>> > Grant Ingersoll
>> > http://www.lucidimagination.com/
>> >
>> > Search the Lucene ecosystem using Solr/Lucene:
>> > http://www.lucidimagination.com/search
>> >
>> >
>> >
>> ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
>>
>> --
>> Robert Muir
>> rcmuir@gmail.com
>>
>
>
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



--=20
Jose R. P=E9rez-Ag=FCera

Clinical Assistant Professor
Metadata Research Center
School of Information and Library Science
University of North Carolina at Chapel Hill
email: jaguera@email.unc.edu
Web page: http://www.unc.edu/~jaguera/
MRC website: http://ils.unc.edu/mrc/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44717-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 19:53:49 2010
Return-Path: <java-user-return-44717-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70339 invoked from network); 27 Jan 2010 19:53:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 19:53:49 -0000
Received: (qmail 81617 invoked by uid 500); 27 Jan 2010 19:53:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81547 invoked by uid 500); 27 Jan 2010 19:53:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81537 invoked by uid 99); 27 Jan 2010 19:53:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 19:53:47 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.160.46 as permitted sender)
Received: from [209.85.160.46] (HELO mail-pw0-f46.google.com) (209.85.160.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 19:53:36 +0000
Received: by pwi11 with SMTP id 11so4169315pwi.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 11:53:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=tLt5h+PMwHQUUvClnB1Ye4yKRnznpr7pCw80xWWOumE=;
        b=Cf8v6FT1sYC9BlxYUwe4s29a6iJDQs4h5nkDGypDTOVMg18+VseKLUJq9zi2z524Va
         5GKTIKhN6l+XANi86sfkFGThfGwYzehXyfXo+cA9jvnL2Lk7Z28TayYMTLun5pIzQ0Z+
         skBlLEac8hSfiRCwyOYmY/gJ34n4YsN15drgg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=mPQUppZXVBTqpl/XgKO9no9X+IQ0DCgw/LNLiQ3zeF20rR3Z0zHl9eFdT6SN8sbnNk
         c0sCsbZQmtbzNwvMDXkkrKPFK8mPri8GtLsdRp2uxkND+KY9zF1eWCyYKqSVrRIGAWGV
         7SDSFJYl0Jz3R/kyCQHCylY1f7YW4kLSwb3Og=
MIME-Version: 1.0
Received: by 10.114.163.19 with SMTP id l19mr4550575wae.170.1264621995400; 
	Wed, 27 Jan 2010 11:53:15 -0800 (PST)
In-Reply-To: <672188.25802.qm@web32602.mail.mud.yahoo.com>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com>
From: Robert Muir <rcmuir@gmail.com>
Date: Wed, 27 Jan 2010 14:52:55 -0500
Message-ID: <8f0ad1f31001271152y54400354i87109d791faa9df2@mail.gmail.com>
Subject: Re: Average Precision - TREC-3
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00504502f586cfa063047e2ac056
X-Virus-Checked: Checked by ClamAV on apache.org

--00504502f586cfa063047e2ac056
Content-Type: text/plain; charset=UTF-8

Hi Ivan, it sounds to me like you are going about it the right way.
I too have complained about different document/topic formats before, at
least with non-TREC test collections that claim to be in TREC format.

Here is a description of what I do, for what its worth.

1. if you use the trunk benchmark code, it will now parse Descriptions and
Narratives in addition to Titles. This way you can run TD and TDN queries.
While I think Topic only (T) queries are generally the only interesting
value, as users only typically type a few short words in their search, the
TD and TDN queries are sometimes useful for comparisons. so to do this you
will have to either change SimpleQQParser or make your own, that simply
creates a BooleanQuery of Topic + Description + Narrative or whatever.

2. another thing I usually test with is query expansion with MoreLikeThis,
all defaults, from the top 5 returned docs. I do this with T, TD, and TDN,
for 6 different MAP measures. You can see a recent example where I applied
all 6 measures here: https://issues.apache.org/jira/browse/LUCENE-2234 . I
feel these 6 measures give me a better overall idea of any relative
relevance improvement, look in that example where the unexpanded T is
improved 75%, but the other 5 its only a 40-50% improvement. While
unexpanded T is theoretically the most realistic to me, I feel its a bit
fragile and sensitive, and there's a good example.

<I can contribute code to make it easier to do the above two things if you
think it would be useful, just havent gotten around to it>

3. I don't even bother with the 'summary output' that the lucene benchmark
pkg prints out, but instead simply use the benchmark pkg to run the queries
and generate the trec_top_file (submission.txt), which I hand to trec_eval


On Wed, Jan 27, 2010 at 1:36 PM, Ivan Provalov <iprovalo@yahoo.com> wrote:

> Robert, Grant:
>
> Thank you for your replies.
>
> Our goal is to fine-tune our existing system to perform better on
> relevance.
>
> I agree with Robert's comment that these collections are not completely
> compatible.  Yes, it is possible that the results will vary some depending
> on the collections differences.  The reason for us picking TREC-3 TIPSTER
> collection is that our production content overlaps with some TIPSTER
> documents.
>
> Any suggestions on how to obtain Lucene's TREC-3 compatible results, or
> select a better approach would be appreciated.
>
> We are doing this project in three stages:
>
> 1. Test Lucene's "vanilla" performance to establish the baseline.  We want
> to iron out the issues such as topic or document formats.  For example, we
> had to add a different parser and clean up the topic title.  This will give
> us confidence that we are using the data and the methodology correctly.
>
> 2. Fine-tune Lucene based on the latest research findings (TREC by E.
> Voorhees, conference proceedings, etc...).
>
> 3. Repeat these steps with our production system which runs on Lucene.  The
> reason we are doing this step last is to ensure that our overall system
> doesn't introduce the relevance issues (content pre-processing steps, query
> parsing steps, etc...).
>
> Thank you,
>
> Ivan Provalov
>
> --- On Wed, 1/27/10, Robert Muir <rcmuir@gmail.com> wrote:
>
> > From: Robert Muir <rcmuir@gmail.com>
> > Subject: Re: Average Precision - TREC-3
> > To: java-user@lucene.apache.org
> > Date: Wednesday, January 27, 2010, 11:16 AM
> > Hello, forgive my ignorance here (I
> > have not worked with these english TREC
> > collections), but is the TREC-3 test collection the same as
> > the test
> > collection used in the 2007 paper you referenced?
> >
> > It looks like that is a different collection, its not
> > really possible to
> > compare these relevance scores across different
> > collections.
> >
> > On Wed, Jan 27, 2010 at 11:06 AM, Grant Ingersoll <gsingers@apache.org
> >wrote:
> >
> > >
> > > On Jan 26, 2010, at 8:28 AM, Ivan Provalov wrote:
> > >
> > > > We are looking into making some improvements to
> > relevance ranking of our
> > > search platform based on Lucene.  We started by
> > running the Ad Hoc TREC task
> > > on the TREC-3 data using "out-of-the-box"
> > Lucene.  The reason to run this
> > > old TREC-3 (TIPSTER Disk 1 and Disk 2; topics 151-200)
> > data was that the
> > > content is matching the content of our production
> > system.
> > > >
> > > > We are currently getting average precision of
> > 0.14.  We found some format
> > > issues with the TREC-3 data which were causing even
> > lower score.  For
> > > example, the initial average precision number was
> > 0.9.  We discovered that
> > > the topics included the word "Topic:" in the
> > <title> tag.  For example,
> > > > "<title> Topic:  Coping with
> > overcrowded prisons".  By removing this term
> > > from the queries, we bumped the average precision to
> > 0.14.
> > >
> > > There's usually a lot of this involved in running
> > TREC.  I've also seen a
> > > good deal of improvement from things like using phrase
> > queries and the
> > > Dismax Query Parser in Solr (which uses
> > DisjunctionQuery in Lucene, amongst
> > > other things) and by playing around with length
> > normalization.
> > >
> > >
> > > >
> > > > Our query is based on the title tag of the topic
> > and the index field is
> > > based on the <TEXT> tag of the document.
> > > >
> > > > QualityQueryParser qqParser = new
> > SimpleQQParser("title", "TEXT");
> > > >
> > > > Is there an average precision number which
> > "out-of-the-box" Lucene should
> > > be close to?  For example, this IBM's 2007 TREC
> > paper mentions 0.154:
> > > > http://trec.nist.gov/pubs/trec16/papers/ibm-haifa.mq.final.pdf
> > >
> > > Hard to say.  I can't say I've run TREC 3.
> > You might ask over on the Open
> > > Relevance list too (http://lucene.apache.org/openrelevance).  I know
> > > Robert Muir's done a lot of experiments with Lucene on
> > standard collections
> > > like TREC.
> > >
> > > I guess the bigger question back to you is what is
> > your goal?  Is it to get
> > > better at TREC or to actually tune your system?
> > >
> > > -Grant
> > >
> > >
> > > --------------------------
> > > Grant Ingersoll
> > > http://www.lucidimagination.com/
> > >
> > > Search the Lucene ecosystem using Solr/Lucene:
> > > http://www.lucidimagination.com/search
> > >
> > >
> > >
> > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
> >
> > --
> > Robert Muir
> > rcmuir@gmail.com
> >
>
>
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Robert Muir
rcmuir@gmail.com

--00504502f586cfa063047e2ac056--

From java-user-return-44718-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Jan 27 23:55:53 2010
Return-Path: <java-user-return-44718-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61090 invoked from network); 27 Jan 2010 23:55:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 27 Jan 2010 23:55:52 -0000
Received: (qmail 63051 invoked by uid 500); 27 Jan 2010 23:55:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62976 invoked by uid 500); 27 Jan 2010 23:55:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62966 invoked by uid 99); 27 Jan 2010 23:55:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 23:55:50 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 27 Jan 2010 23:55:42 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NaHjF-00011m-Cx
	for java-user@lucene.apache.org; Wed, 27 Jan 2010 15:55:21 -0800
Message-ID: <27348933.post@talk.nabble.com>
Date: Wed, 27 Jan 2010 15:55:21 -0800 (PST)
From: ctorresl <ctorresl@facinf.uho.edu.cu>
To: java-user@lucene.apache.org
Subject: Search for more than one term
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: ctorresl@facinf.uho.edu.cu


Hello:
I=C3=84m working with Lucene for my thesis, please I need answers to
these questions:
1. How can I tell Lucene to search for more than one term??? (for example:
the query "house garden computer" will return documents in which at least
one of the
term appears) What classes I need to use?
2. Lucene works well in Windows, Mac OS X, Linux y Unix??? what other
platform?

Thanks in advanced,
Carmen=20
--=20
View this message in context: http://old.nabble.com/Search-for-more-than-on=
e-term-tp27348933p27348933.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44719-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 00:03:32 2010
Return-Path: <java-user-return-44719-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64048 invoked from network); 28 Jan 2010 00:03:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 00:03:32 -0000
Received: (qmail 69515 invoked by uid 500); 28 Jan 2010 00:03:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69434 invoked by uid 500); 28 Jan 2010 00:03:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69423 invoked by uid 99); 28 Jan 2010 00:03:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 00:03:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 74.125.92.24 as permitted sender)
Received: from [74.125.92.24] (HELO qw-out-2122.google.com) (74.125.92.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 00:03:22 +0000
Received: by qw-out-2122.google.com with SMTP id 8so19457qwh.53
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 16:03:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :x-enigmail-version:content-type:content-transfer-encoding;
        bh=QGxkn0RuKhi8s43aFXl2fKvc1L/gpi9fp+vXZFiuEQ0=;
        b=Rff/Ovm5jvxrmhZnotXvMi6qYyYCEg3ANhh1bgUra2cI4/ccjPqtJe/MDPOwVyDHWT
         84cAYaqgnc6TL9CL+tIIqoHnP+jM9iBiqY2whomOmhc5EVoHlcwD7iZYcnwjdnufuIRv
         c9c2ZPyd0kYIPVXdvoD199/94nYjoKwKwv8NY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:x-enigmail-version:content-type
         :content-transfer-encoding;
        b=BmEdo4FeIZSjStpD0WSyC2lIdu+c3qhNwyQP9CXAshmGJvT8+g3krIwhMdiUIbUg35
         BxvrFbo0L29CorbSzYaf7ac5v5eAQQ+pXU9Yv9ujTWyz6kYl1ISXWzB/8utIUyahwOQv
         geGJVlig+jADAo2m0Rxg5fMht+dSNigput4P8=
Received: by 10.224.26.78 with SMTP id d14mr5637020qac.21.1264636981263;
        Wed, 27 Jan 2010 16:03:01 -0800 (PST)
Received: from ?192.168.1.104? (ool-44c639d9.dyn.optonline.net [68.198.57.217])
        by mx.google.com with ESMTPS id 2sm878168qwi.47.2010.01.27.16.02.59
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 27 Jan 2010 16:03:00 -0800 (PST)
Message-ID: <4B60D432.8070501@gmail.com>
Date: Wed, 27 Jan 2010 19:02:58 -0500
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (X11/20090817)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Search for more than one term
References: <27348933.post@talk.nabble.com>
In-Reply-To: <27348933.post@talk.nabble.com>
X-Enigmail-Version: 0.96.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

ctorresl wrote:
> Hello:
> Im working with Lucene for my thesis, please I need answers to
> these questions:
> 1. How can I tell Lucene to search for more than one term??? (for example:
> the query "house garden computer" will return documents in which at least
> one of the
> term appears) What classes I need to use?
> 2. Lucene works well in Windows, Mac OS X, Linux y Unix??? what other
> platform?
>
> Thanks in advanced,
> Carmen 
>   
I've seen it run nicely on AIX. If you can call running on AIX nice.

-- 
- Mark





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44720-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 02:16:10 2010
Return-Path: <java-user-return-44720-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17371 invoked from network); 28 Jan 2010 02:16:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 02:16:09 -0000
Received: (qmail 56731 invoked by uid 500); 28 Jan 2010 02:16:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56668 invoked by uid 500); 28 Jan 2010 02:16:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56658 invoked by uid 99); 28 Jan 2010 02:16:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 02:16:07 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 02:15:59 +0000
Received: by ewy2 with SMTP id 2so263726ewy.5
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 18:15:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=688lul7U8NZ5DOS9rhbRrWHjWN5YPNCfbfTYTAJeFYk=;
        b=PZa7yWKG11OoKBnXdPZrCdn2BcNr8ZrT8RXqxaD0MHDf969T4JGoGT4UtgOusEgy5J
         /2j9zGZqOpPJ9/TZqVxmAiQ2Txpbs/ngy/FS0dWcHveY5ccdbc8UNdUpiiyNMIlHUf7j
         DrB7ot7rmzWTDffrj06L3D2j+HgodNdh0+Rhw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=HcjvJf5Gfb8DNP3DlXNF+YZiXp+zvpa3cP+XDje+g6v6Nw6eXi168+n1mC4Tg3suPa
         dx8JdLKv2JfgfGFyTTT0sXtscJ0a5N6NSiX+QorlFucfUzk8Z2FFtm/I2eTRWVnYRtnh
         8Mku3aXKxfsLc5Hg4CgnYqViKVnPKiVIYC+38=
MIME-Version: 1.0
Received: by 10.216.169.198 with SMTP id n48mr1240365wel.179.1264644937654; 
	Wed, 27 Jan 2010 18:15:37 -0800 (PST)
In-Reply-To: <27348933.post@talk.nabble.com>
References: <27348933.post@talk.nabble.com>
Date: Wed, 27 Jan 2010 21:15:37 -0500
Message-ID: <359a92831001271815y532f5007le8b89845a5d7f8e1@mail.gmail.com>
Subject: Re: Search for more than one term
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6541bda46a358047e3018b3

--0016e6541bda46a358047e3018b3
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Have you looked at the query syntax?

See...
http://lucene.apache.org/java/3_0_0/queryparsersyntax.html

And the book Lucene In Action has many examples....

HTH
Erick


On Wed, Jan 27, 2010 at 6:55 PM, ctorresl <ctorresl@facinf.uho.edu.cu>wrote=
:

>
> Hello:
> I=C4m working with Lucene for my thesis, please I need answers to
> these questions:
> 1. How can I tell Lucene to search for more than one term??? (for example=
:
> the query "house garden computer" will return documents in which at least
> one of the
> term appears) What classes I need to use?
> 2. Lucene works well in Windows, Mac OS X, Linux y Unix??? what other
> platform?
>
> Thanks in advanced,
> Carmen
> --
> View this message in context:
> http://old.nabble.com/Search-for-more-than-one-term-tp27348933p27348933.h=
tml
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6541bda46a358047e3018b3--

From java-user-return-44721-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 02:42:38 2010
Return-Path: <java-user-return-44721-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28362 invoked from network); 28 Jan 2010 02:42:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 02:42:38 -0000
Received: (qmail 82277 invoked by uid 500); 28 Jan 2010 02:42:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82095 invoked by uid 500); 28 Jan 2010 02:42:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82066 invoked by uid 99); 28 Jan 2010 02:42:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 02:42:35 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.142.207.235] (HELO web32608.mail.mud.yahoo.com) (68.142.207.235)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 28 Jan 2010 02:42:26 +0000
Received: (qmail 85960 invoked by uid 60001); 28 Jan 2010 02:42:05 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264646524; bh=mmzPKit4zSvfSKVu+J0m0f7kLaPX9Ptyzwgr3AwVtDg=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=fu2vj0w4kkFapAdSfH0fdjhJLKaKJA4yQ+KLXpdRn1z8cJFqDGIPPic/VOwqCY2JXRMIu33cgfkRRqDNM17Kr4xQj/N515+sLd5+t2WnSlbq5GyTsYdB+rc6MPc0Z9Fch/9wfhw9VB8Psx2Xnpx1bUsD10OKnHZNxFp70yiDvzI=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=u3v4HiWpfszw3qfJYZvQ4wlPIxwpNzTCanwDpdUrMSRW4ZjpbDFmrdEemor1+tv2yRRmS4S1SDPAMOoLzxwnuGnpUbkL0cJxQ2xyUnyiMc6UEvpwT9q99Xjp5eB5ioxaYQXZ282Zf0wdrRDBgGKHngwUvBD3YoLtv5B/R0HleBY=;
Message-ID: <916387.85647.qm@web32608.mail.mud.yahoo.com>
X-YMail-OSG: FynvA24VM1kK31CPctL5jSo7cDabEidkBI6Nf4CmOk5z8G1XuI5rW5KiHO5FWvkoGGqoGCOY.cGbapvrAm46va9Flb7XFeW2TvO0LlvvPHZn8x7qjofAJ0c4FYdeJwNFiVQluN8X_zUKIfV9hWyU3TxozGzgejenOyzhKHVhfU1lk3fgHuYfxVvtZfKVxKHiNdCB82t4oxwp99IMp1XP.FJ8Mt71nWLo7dll72wZUnSsYpHFGwKnyb8hw_kOPehe.rTTAsDHNUeoXzczjzxL5cnrkvuvqArcH0OqgHcYCW2QaY_xAwabWNjllAIV64_Y5awFsnPmSxKgvNQsOA4keoBNhrhCTF5id3gJBY4N1.N_eM4WwjayVIxVuykZaJRWxdbiW2fcMuQRbmEvPJAicfLSjLGwffGYR.qZPHbLE.xBC_BPjzvb23errkVakFMj_Mu3taBHAhAvV9.pFf58TQ3GVi4toZxD7W2aK1d5Onc7Hb5An__AkidYujLwyoenHdrlXJS_7hFetsSaCKUSBThH6wW5XaPBcEEDOYTN
Received: from [99.150.128.40] by web32608.mail.mud.yahoo.com via HTTP; Wed, 27 Jan 2010 18:42:04 PST
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Wed, 27 Jan 2010 18:42:04 -0800 (PST)
From: Ivan Provalov <iprovalo@yahoo.com>
Subject: Re: Average Precision - TREC-3
To: java-user@lucene.apache.org
In-Reply-To: <8f0ad1f31001271152y54400354i87109d791faa9df2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable

Robert,=0A=0AThank you for this great information.  Let me look into these =
suggestions.=0A=0AIvan=0A=0A--- On Wed, 1/27/10, Robert Muir <rcmuir@gmail.=
com> wrote:=0A=0A> From: Robert Muir <rcmuir@gmail.com>=0A> Subject: Re: Av=
erage Precision - TREC-3=0A> To: java-user@lucene.apache.org=0A> Date: Wedn=
esday, January 27, 2010, 2:52 PM=0A> Hi Ivan, it sounds to me like you are=
=0A> going about it the right way.=0A> I too have complained about differen=
t document/topic=0A> formats before, at=0A> least with non-TREC test collec=
tions that claim to be in=0A> TREC format.=0A> =0A> Here is a description o=
f what I do, for what its worth.=0A> =0A> 1. if you use the trunk benchmark=
 code, it will now parse=0A> Descriptions and=0A> Narratives in addition to=
 Titles. This way you can run TD=0A> and TDN queries.=0A> While I think Top=
ic only (T) queries are generally the only=0A> interesting=0A> value, as us=
ers only typically type a few short words in=0A> their search, the=0A> TD a=
nd TDN queries are sometimes useful for comparisons. so=0A> to do this you=
=0A> will have to either change SimpleQQParser or make your own,=0A> that s=
imply=0A> creates a BooleanQuery of Topic + Description + Narrative=0A> or =
whatever.=0A> =0A> 2. another thing I usually test with is query expansion=
=0A> with MoreLikeThis,=0A> all defaults, from the top 5 returned docs. I d=
o this with=0A> T, TD, and TDN,=0A> for 6 different MAP measures. You can s=
ee a recent example=0A> where I applied=0A> all 6 measures here: https://is=
sues.apache.org/jira/browse/LUCENE-2234 . I=0A> feel these 6 measures give =
me a better overall idea of any=0A> relative=0A> relevance improvement, loo=
k in that example where the=0A> unexpanded T is=0A> improved 75%, but the o=
ther 5 its only a 40-50%=0A> improvement. While=0A> unexpanded T is theoret=
ically the most realistic to me, I=0A> feel its a bit=0A> fragile and sensi=
tive, and there's a good example.=0A> =0A> <I can contribute code to make i=
t easier to do the above=0A> two things if you=0A> think it would be useful=
, just havent gotten around to=0A> it>=0A> =0A> 3. I don't even bother with=
 the 'summary output' that the=0A> lucene benchmark=0A> pkg prints out, but=
 instead simply use the benchmark pkg to=0A> run the queries=0A> and genera=
te the trec_top_file (submission.txt), which I=0A> hand to trec_eval=0A> =
=0A> =0A> On Wed, Jan 27, 2010 at 1:36 PM, Ivan Provalov <iprovalo@yahoo.co=
m>=0A> wrote:=0A> =0A> > Robert, Grant:=0A> >=0A> > Thank you for your repl=
ies.=0A> >=0A> > Our goal is to fine-tune our existing system to=0A> perfor=
m better on=0A> > relevance.=0A> >=0A> > I agree with Robert's comment that=
 these collections=0A> are not completely=0A> > compatible.=A0 Yes, it is p=
ossible that the results=0A> will vary some depending=0A> > on the collecti=
ons differences.=A0 The reason for=0A> us picking TREC-3 TIPSTER=0A> > coll=
ection is that our production content overlaps=0A> with some TIPSTER=0A> > =
documents.=0A> >=0A> > Any suggestions on how to obtain Lucene's TREC-3=0A>=
 compatible results, or=0A> > select a better approach would be appreciated=
.=0A> >=0A> > We are doing this project in three stages:=0A> >=0A> > 1. Tes=
t Lucene's "vanilla" performance to establish=0A> the baseline.=A0 We want=
=0A> > to iron out the issues such as topic or document=0A> formats.=A0 For=
 example, we=0A> > had to add a different parser and clean up the topic=0A>=
 title.=A0 This will give=0A> > us confidence that we are using the data an=
d the=0A> methodology correctly.=0A> >=0A> > 2. Fine-tune Lucene based on t=
he latest research=0A> findings (TREC by E.=0A> > Voorhees, conference proc=
eedings, etc...).=0A> >=0A> > 3. Repeat these steps with our production sys=
tem which=0A> runs on Lucene.=A0 The=0A> > reason we are doing this step la=
st is to ensure that=0A> our overall system=0A> > doesn't introduce the rel=
evance issues (content=0A> pre-processing steps, query=0A> > parsing steps,=
 etc...).=0A> >=0A> > Thank you,=0A> >=0A> > Ivan Provalov=0A> >=0A> > --- =
On Wed, 1/27/10, Robert Muir <rcmuir@gmail.com>=0A> wrote:=0A> >=0A> > > Fr=
om: Robert Muir <rcmuir@gmail.com>=0A> > > Subject: Re: Average Precision -=
 TREC-3=0A> > > To: java-user@lucene.apache.org=0A> > > Date: Wednesday, Ja=
nuary 27, 2010, 11:16 AM=0A> > > Hello, forgive my ignorance here (I=0A> > =
> have not worked with these english TREC=0A> > > collections), but is the =
TREC-3 test collection=0A> the same as=0A> > > the test=0A> > > collection =
used in the 2007 paper you=0A> referenced?=0A> > >=0A> > > It looks like th=
at is a different collection, its=0A> not=0A> > > really possible to=0A> > =
> compare these relevance scores across different=0A> > > collections.=0A> =
> >=0A> > > On Wed, Jan 27, 2010 at 11:06 AM, Grant Ingersoll=0A> <gsingers=
@apache.org=0A> > >wrote:=0A> > >=0A> > > >=0A> > > > On Jan 26, 2010, at 8=
:28 AM, Ivan Provalov=0A> wrote:=0A> > > >=0A> > > > > We are looking into =
making some=0A> improvements to=0A> > > relevance ranking of our=0A> > > > =
search platform based on Lucene.=A0 We=0A> started by=0A> > > running the A=
d Hoc TREC task=0A> > > > on the TREC-3 data using "out-of-the-box"=0A> > >=
 Lucene.=A0 The reason to run this=0A> > > > old TREC-3 (TIPSTER Disk 1 and=
 Disk 2;=0A> topics 151-200)=0A> > > data was that the=0A> > > > content is=
 matching the content of our=0A> production=0A> > > system.=0A> > > > >=0A>=
 > > > > We are currently getting average=0A> precision of=0A> > > 0.14.=A0=
 We found some format=0A> > > > issues with the TREC-3 data which were=0A> =
causing even=0A> > > lower score.=A0 For=0A> > > > example, the initial ave=
rage precision=0A> number was=0A> > > 0.9.=A0 We discovered that=0A> > > > =
the topics included the word "Topic:" in=0A> the=0A> > > <title> tag.=A0 Fo=
r example,=0A> > > > > "<title> Topic:=A0 Coping=0A> with=0A> > > overcrowd=
ed prisons".=A0 By removing this=0A> term=0A> > > > from the queries, we bu=
mped the average=0A> precision to=0A> > > 0.14.=0A> > > >=0A> > > > There's=
 usually a lot of this involved in=0A> running=0A> > > TREC.=A0 I've also s=
een a=0A> > > > good deal of improvement from things like=0A> using phrase=
=0A> > > queries and the=0A> > > > Dismax Query Parser in Solr (which uses=
=0A> > > DisjunctionQuery in Lucene, amongst=0A> > > > other things) and by=
 playing around with=0A> length=0A> > > normalization.=0A> > > >=0A> > > >=
=0A> > > > >=0A> > > > > Our query is based on the title tag of=0A> the top=
ic=0A> > > and the index field is=0A> > > > based on the <TEXT> tag of the=
=0A> document.=0A> > > > >=0A> > > > > QualityQueryParser qqParser =3D new=
=0A> > > SimpleQQParser("title", "TEXT");=0A> > > > >=0A> > > > > Is there =
an average precision number=0A> which=0A> > > "out-of-the-box" Lucene shoul=
d=0A> > > > be close to?=A0 For example, this IBM's=0A> 2007 TREC=0A> > > p=
aper mentions 0.154:=0A> > > > > http://trec.nist.gov/pubs/trec16/papers/ib=
m-haifa.mq.final.pdf=0A> > > >=0A> > > > Hard to say.=A0 I can't say I've r=
un TREC=0A> 3.=0A> > > You might ask over on the Open=0A> > > > Relevance l=
ist too (http://lucene.apache.org/openrelevance).=A0 I know=0A> > > > Rober=
t Muir's done a lot of experiments with=0A> Lucene on=0A> > > standard coll=
ections=0A> > > > like TREC.=0A> > > >=0A> > > > I guess the bigger questio=
n back to you is=0A> what is=0A> > > your goal?=A0 Is it to get=0A> > > > b=
etter at TREC or to actually tune your=0A> system?=0A> > > >=0A> > > > -Gra=
nt=0A> > > >=0A> > > >=0A> > > > --------------------------=0A> > > > Grant=
 Ingersoll=0A> > > > http://www.lucidimagination.com/=0A> > > >=0A> > > > S=
earch the Lucene ecosystem using=0A> Solr/Lucene:=0A> > > > http://www.luci=
dimagination.com/search=0A> > > >=0A> > > >=0A> > > >=0A> > >=0A> ---------=
------------------------------------------------------------=0A> > > > To u=
nsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A> > > > For a=
dditional commands, e-mail: java-user-help@lucene.apache.org=0A> > > >=0A> =
> > >=0A> > >=0A> > >=0A> > > --=0A> > > Robert Muir=0A> > > rcmuir@gmail.c=
om=0A> > >=0A> >=0A> >=0A> >=0A> >=0A> >=0A> >=0A> >=0A> >=0A> ------------=
---------------------------------------------------------=0A> > To unsubscr=
ibe, e-mail: java-user-unsubscribe@lucene.apache.org=0A> > For additional c=
ommands, e-mail: java-user-help@lucene.apache.org=0A> >=0A> >=0A> =0A> =0A>=
 -- =0A> Robert Muir=0A> rcmuir@gmail.com=0A> =0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44722-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 04:53:02 2010
Return-Path: <java-user-return-44722-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55693 invoked from network); 28 Jan 2010 04:53:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 04:53:02 -0000
Received: (qmail 47736 invoked by uid 500); 28 Jan 2010 04:53:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47578 invoked by uid 500); 28 Jan 2010 04:53:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47568 invoked by uid 99); 28 Jan 2010 04:52:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 04:52:59 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of thienthanhomenh@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 04:52:50 +0000
Received: by qw-out-2122.google.com with SMTP id 8so53157qwh.53
        for <java-user@lucene.apache.org>; Wed, 27 Jan 2010 20:52:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=QH5oiKmQk6qsgeACobkVfggQoEW1ouRDh2YXsm58zdY=;
        b=C8Hqb9J5wOVIasSYH2YSp6KGsQ+OhtDqnTY/3mFi/4wFBaPW35JoDNA2+s+qZkBLuT
         nRIENpte8D9DsXeFfAGxxAe/LIJGf7UXsyMqYu7ZTdN5rkQEzN2WbEF91mALLWCylFgD
         jF+HeGqD+/pngXlIkMwtozG7PJzVj1ZxY7Z6w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=FioeNDbOMwAXntFpKGvpKXWp5XjGMxNlAKXtAqCxtMsk+EtzMWxfx+d1KP96koYWzK
         AliIoR7zDYwr7BrJ86gWx1QGfwktAHje80Jt3cuQmFANv1pgnY3VGnghJbtJLc7QsRNR
         7TTWO1jCUKp/xLOQF3KiNnUYOtRrkdvroIOtU=
MIME-Version: 1.0
Received: by 10.224.55.71 with SMTP id t7mr6041180qag.256.1264654338583; Wed, 
	27 Jan 2010 20:52:18 -0800 (PST)
In-Reply-To: <359a92831001271815y532f5007le8b89845a5d7f8e1@mail.gmail.com>
References: <27348933.post@talk.nabble.com> <359a92831001271815y532f5007le8b89845a5d7f8e1@mail.gmail.com>
From: Phan The Dai <thienthanhomenh@gmail.com>
Date: Thu, 28 Jan 2010 13:51:54 +0900
Message-ID: <3b23ce091001272051g2ef79c7fsde1e835955b1dcad@mail.gmail.com>
Subject: Re: Search for more than one term
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=000feaefb93e9d6e55047e324890
X-Virus-Checked: Checked by ClamAV on apache.org

--000feaefb93e9d6e55047e324890
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Hello ctorresl,
you can use QueryParser automatically creating query as query syntax (Erick
showed).
Or use BooleanQuery class.
BooleanQuery query =3D new BooleanQuery;
query.add(a_termquery, Occur.SHOULD);
query.add(other_termquery, Occur.SHOULD);


On Thu, Jan 28, 2010 at 11:15 AM, Erick Erickson <erickerickson@gmail.com>w=
rote:

> Have you looked at the query syntax?
>
> See...
> http://lucene.apache.org/java/3_0_0/queryparsersyntax.html
>
> And the book Lucene In Action has many examples....
>
> HTH
> Erick
>
>
> On Wed, Jan 27, 2010 at 6:55 PM, ctorresl <ctorresl@facinf.uho.edu.cu
> >wrote:
>
> >
> > Hello:
> > I=C4m working with Lucene for my thesis, please I need answers to
> > these questions:
> > 1. How can I tell Lucene to search for more than one term??? (for
> example:
> > the query "house garden computer" will return documents in which at lea=
st
> > one of the
> > term appears) What classes I need to use?
> > 2. Lucene works well in Windows, Mac OS X, Linux y Unix??? what other
> > platform?
> >
> > Thanks in advanced,
> > Carmen
> > --
> > View this message in context:
> >
> http://old.nabble.com/Search-for-more-than-one-term-tp27348933p27348933.h=
tml
> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

--000feaefb93e9d6e55047e324890--

From java-user-return-44723-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 09:06:17 2010
Return-Path: <java-user-return-44723-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41488 invoked from network); 28 Jan 2010 09:06:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 09:06:16 -0000
Received: (qmail 98888 invoked by uid 500); 28 Jan 2010 09:06:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98177 invoked by uid 500); 28 Jan 2010 09:06:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98167 invoked by uid 99); 28 Jan 2010 09:06:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 09:06:10 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.86.5.89] (HELO smtp102.mail.in.yahoo.com) (202.86.5.89)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 28 Jan 2010 09:06:01 +0000
Received: (qmail 37567 invoked from network); 28 Jan 2010 09:05:38 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.in;
  h=Received:X-Yahoo-SMTP:X-YMail-OSG:X-Yahoo-Newman-Property:Message-ID:From:To:Subject:Date:MIME-Version:Content-Type:Content-Transfer-Encoding:X-Priority:X-MSMail-Priority:X-Mailer:X-MimeOLE;
  b=PB6+GbF6I1TOq225KLx2c0aGljprZXggu6pvwJPBI4spPI1rMX7hBQPh8cLtdFERavkR0+v7YcIt7j06KsVQuMFYQHZuGW+d20T4NyA7iYqfSvIpo9rFIWmb4Vkh1Ej+uy69FVRJ7OEmwuv/ilxNYq79M7CllcGhKlLFUi1BVNo=  ;
Received: from  (emailgane@203.98.194.130 with login)
        by smtp102.mail.in.yahoo.com with SMTP; 28 Jan 2010 14:35:37 +0530 IST
X-Yahoo-SMTP: JObyHkuswBBrNSLZp.Ycd7Boqpr_GQ--
X-YMail-OSG: 9KKWEbwVM1lpeAba5uOh3tk2n0pHwLCPB82DndV7W37QTQefGPqNbWJlpE3FI4Es.xqK_tegm4VLjr7FtGasUXHnjUbsb853VvtYroKKjJq4d5wsrO2xHZ7aXUGDL_KochWB4kwuHQRALF0blGgZ4KlIcX2cuvzn7xSh486mzAJSf2sy6iP43in1hig0NMjtjPV_1mHW
X-Yahoo-Newman-Property: ymail-3
Message-ID: <C5567625C1594369817D0270E247E353@sv.us.sonicwall.com>
From: "Ganesh" <emailgane@yahoo.co.in>
To: <java-user@lucene.apache.org>
Subject: Roadmap for next release
Date: Thu, 28 Jan 2010 14:35:33 +0530
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.5843
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.5579

Hello all,

Please provide me the information related to road map for the next =
release. This information will be really helpful to plan our product =
road map for this year.=20

Is the below feature planned for this year.
-----------------------------------------
1. To reduce sorting memory consumption by caching / offload it to disk
2. If all records are not part of sorting, Is there any way to create =
the custom field cache array based on some filter criteria.

Regards
Ganesh  
Send instant messages to your online friends http://in.messenger.yahoo.com 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44724-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 11:01:37 2010
Return-Path: <java-user-return-44724-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95750 invoked from network); 28 Jan 2010 11:01:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 11:01:37 -0000
Received: (qmail 51191 invoked by uid 500); 28 Jan 2010 11:01:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51117 invoked by uid 500); 28 Jan 2010 11:01:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51103 invoked by uid 99); 28 Jan 2010 11:01:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 11:01:34 +0000
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [193.16.154.33] (HELO timmy.zylon.net) (193.16.154.33)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 28 Jan 2010 11:01:25 +0000
Received: (qmail 11252 invoked by uid 89); 28 Jan 2010 11:01:04 -0000
Received: from unknown (HELO ?192.168.1.112?) (dennis.hendriksen@kalooga.com@193.138.250.18)
  by 0 with SMTP; 28 Jan 2010 11:01:04 -0000
Subject: combine query score with external score
From: Dennis Hendriksen <dennis.hendriksen@kalooga.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset="UTF-8"
Organization: Kalooga
Date: Thu, 28 Jan 2010 12:01:03 +0100
Message-ID: <1264676463.2334.59.camel@kalooga-dennis>
Mime-Version: 1.0
X-Mailer: Evolution 2.28.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I'm struggling to create a performant query in Lucene 3.0.0 in which I
want to combine 'regular' scoring with scores derived from external
sources.

For each document a fixed set of scores is calculated in the range [0.0,
1.0>. These scores represent the confidences that a document falls into
categories. So for example document #1 has a score of 0.3 for cat=boys,
0.2 for cat=girls, 0.1 for cat=toys, 0.05 for cat=animals.

The 'regular' scoring is calculated using a BooleanQuery with TermQuerys
similar to: -type:H +(title:dna body:dna^1.5)

In the current naive approach I'm combining the scores as following:
- for each document store the three best categories in the following
fields:
name=cat1st value=boys fieldboost=0.3
name=cat2nd value=girls fieldboost=0.2
name=cat3rd value=toys fieldboost=0.1
Search-time use the following query if you're interested in 'girls':
-type:H +(title:dna body:dna^1.5) cat1st:girls cat2nd:girls cat3rd:girls
or if you're interested in 'boys':
-type:H +(title:dna body:dna^1.5) cat1st:boys cat2nd:boys cat3rd:boys

Disadvantages of the current approach:
- loss of precision encoding/decoding boosts (performance is important,
so this might be acceptable)
- using TermQuery for the cat fields doesn't make a lot of sense since
the external scores are multiplied by the idf of 'boys'/'girls' and the
querynorm
- the resulting score from the cat field is added to the other query
score instead of multiplied

Just to give you an idea: the index I'm using is growing in time and
contains about 50 million documents

Do you have an idea how I can improve my query and still keep high
performance? 
Or should I combine the scores in the Collector (but this doesn't seem
the right place to retrieve the category scores from the index)?
Is it possible to use a different float->byte encoder per field to
reduce the lack of precision?

Thanks for your time,
Dennis
  


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44725-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 13:05:23 2010
Return-Path: <java-user-return-44725-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 37189 invoked from network); 28 Jan 2010 13:05:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 13:05:23 -0000
Received: (qmail 5855 invoked by uid 500); 28 Jan 2010 13:05:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5779 invoked by uid 500); 28 Jan 2010 13:05:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5769 invoked by uid 99); 28 Jan 2010 13:05:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 13:05:20 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lutischanf@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 13:05:11 +0000
Received: by fxm2 with SMTP id 2so526920fxm.5
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 05:04:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:content-type;
        bh=AjXvipY1YXkguNA/oQXyXzRHkVi2CZ6jcATOZLFAthw=;
        b=LbgFlZ2g7Zb0+y2Le83mA/06Sy4FjO3UpiSJh0viaE3ekbtxgkKecmz/oEVevZGM4j
         o9VhW8W4oHaOC8vd/AkK8XoDH2TD8WLHAyRwi9KhGNjtOdWFOdHephnNgFJsgEncuRik
         +czLKjJ1j8KD+pulpQVwrGVyjcl3z3kRzjJcA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject
         :content-type;
        b=JNLP0B1IZzoRU++vhafo72GaMyLO///0fJ46lCiu5SP3Sp6O/ebmq9heAFPxbiQ5k1
         HcBDwMo8LTnt5dl51VPg9oxy8k3o7F5u2QmpqSJYmFFuVa1tIeKPs7irQGZNQW4zjMXE
         0Tmn0WuxMbES0W+etj1QUjTPfxvCDnism30XU=
Received: by 10.103.86.22 with SMTP id o22mr5388183mul.94.1264683890150;
        Thu, 28 Jan 2010 05:04:50 -0800 (PST)
Received: from ?192.168.50.220? (business-89-133-217-253.business.broadband.hu [89.133.217.253])
        by mx.google.com with ESMTPS id s11sm4731640mue.4.2010.01.28.05.04.49
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 28 Jan 2010 05:04:49 -0800 (PST)
Message-ID: <4B618B6D.6040606@gmail.com>
Date: Thu, 28 Jan 2010 14:04:45 +0100
From: =?ISO-8859-1?Q?Lutisch=E1n_Ferenc?= <lutischanf@gmail.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene full text search
Content-Type: multipart/alternative;
 boundary="------------050902040201000507070106"

--------------050902040201000507070106
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi,

I have a problem with Lucene:
I'm indexed an english phrase list with Lucene:
             doc.add(new Field("r1", r1.toLowerCase(), Field.Store.NO, 
Field.Index.ANALYZED));

I searched for the word 'arabic':

             Analyzer analyzer = new 
StandardAnalyzer(Version.LUCENE_CURRENT);
             QueryParser parser = new 
QueryParser(Version.LUCENE_CURRENT, this.searchedField, analyzer);
             Query query = parser.parse(searchedStr);
             TopScoreDocCollector collector = 
TopScoreDocCollector.create(10, true);
             this.memDict.isearcher.search(query, collector);
             foundCnt=collector.getTotalHits();
             System.out.println(searchedStr + ":" + foundCnt);

             // Iterate through the results:
             ScoreDoc[] hits = collector.topDocs().scoreDocs;
             for (int i = 0; i < hits.length; i++) {
                 Document hitDoc = this.memDict.isearcher.doc(hits[i].doc);
                 System.out.println("\"r1\"=" + hitDoc.get("r1"));
             }

The result list is:
*arabic
**arabic* numerals
gum *arabic
*
But is not in the result list:
moz*arabic*

How to use Lucene to find all the words contains 'arabic'?

Regards,
     Ferenc

--------------050902040201000507070106--

From java-user-return-44726-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 13:35:56 2010
Return-Path: <java-user-return-44726-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51316 invoked from network); 28 Jan 2010 13:35:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 13:35:56 -0000
Received: (qmail 50479 invoked by uid 500); 28 Jan 2010 13:35:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50416 invoked by uid 500); 28 Jan 2010 13:35:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50406 invoked by uid 99); 28 Jan 2010 13:35:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 13:35:53 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 13:35:44 +0000
Received: by ewy2 with SMTP id 2so803201ewy.5
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 05:35:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=uJuH42PF8UXMsU5Z4TiljsPdUpsfyKUIZIz/HqUarTU=;
        b=elsuEKsYdYbpjKAHB8mLIYJdnCjtQ0wo/qlYI/ct+XUBZxwr3KT5YDI1XxvTsn3Nem
         bUFt1qcJzoOPc7RD8dhqrufsp8O0CQ29VHKcjCnDLyM66pYLE9TpPkUlwAKSXB+DLK/B
         mnbf6cI3AMZY6eYl7t/qAXUKUKHy9LwlBL9RQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=S7j7SZIUpgd4NvFa7y6B9n+Vm2jFkYF2Cm34DRIj3k7Nta9DwFfb/X7Hv84bK7EE/B
         0Nlq+yI7HgqBuwxlgDc6rVg6uVYKs7VVioNWGqrRYO2wgiIPGm06hR1h1lBVT5mp/EYc
         7gQbHiVTg/Qvqep/fu7Yb5RJxb+FWSYBQiAPA=
MIME-Version: 1.0
Received: by 10.216.169.198 with SMTP id n48mr1589786wel.179.1264685721993; 
	Thu, 28 Jan 2010 05:35:21 -0800 (PST)
In-Reply-To: <4B618B6D.6040606@gmail.com>
References: <4B618B6D.6040606@gmail.com>
Date: Thu, 28 Jan 2010 08:35:21 -0500
Message-ID: <359a92831001280535sd47848asa58beb4af0994270@mail.gmail.com>
Subject: Re: Lucene full text search
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6541bda3642f4047e3997dd
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6541bda3642f4047e3997dd
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable

Well, there are a couple of approaches:


1> enable leading wildcards and search for *arabic*. You
     probably don't want to do this, it's really, really expensive.
2> use the ngram (edgengram?) tokenizers. This'll cost
     you some index space, but that may be acceptable.

HTH
Erick

2010/1/28 Lutisch=E1n Ferenc <lutischanf@gmail.com>

> Hi,
>
> I have a problem with Lucene:
> I'm indexed an english phrase list with Lucene:
>            doc.add(new Field("r1", r1.toLowerCase(), Field.Store.NO,
> Field.Index.ANALYZED));
>
> I searched for the word 'arabic':
>
>            Analyzer analyzer =3D new
> StandardAnalyzer(Version.LUCENE_CURRENT);
>            QueryParser parser =3D new QueryParser(Version.LUCENE_CURRENT,
> this.searchedField, analyzer);
>            Query query =3D parser.parse(searchedStr);
>            TopScoreDocCollector collector =3D TopScoreDocCollector.create=
(10,
> true);
>            this.memDict.isearcher.search(query, collector);
>            foundCnt=3Dcollector.getTotalHits();
>            System.out.println(searchedStr + ":" + foundCnt);
>
>            // Iterate through the results:
>            ScoreDoc[] hits =3D collector.topDocs().scoreDocs;
>            for (int i =3D 0; i < hits.length; i++) {
>                Document hitDoc =3D this.memDict.isearcher.doc(hits[i].doc=
);
>                System.out.println("\"r1\"=3D" + hitDoc.get("r1"));
>            }
>
> The result list is:
> *arabic
> **arabic* numerals
> gum *arabic
> *
> But is not in the result list:
> moz*arabic*
>
> How to use Lucene to find all the words contains 'arabic'?
>
> Regards,
>    Ferenc
>

--0016e6541bda3642f4047e3997dd--

From java-user-return-44727-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 14:26:31 2010
Return-Path: <java-user-return-44727-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80452 invoked from network); 28 Jan 2010 14:26:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 14:26:31 -0000
Received: (qmail 28218 invoked by uid 500); 28 Jan 2010 14:26:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28142 invoked by uid 500); 28 Jan 2010 14:26:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27973 invoked by uid 99); 28 Jan 2010 14:26:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 14:26:27 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 14:26:19 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NaVJm-0004s7-Ba
	for java-user@lucene.apache.org; Thu, 28 Jan 2010 06:25:58 -0800
Message-ID: <27356784.post@talk.nabble.com>
Date: Thu, 28 Jan 2010 06:25:58 -0800 (PST)
From: "Karsten F." <karsten-lucene@fiz-technik.de>
To: java-user@lucene.apache.org
Subject: Search a PhraseQuery one multiple terms with the same position
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: karsten-lucene@fiz-technik.de


Hi,

I have a problem with the checkedRepeats in SloppyPhraseScorer.
This feature is for phrases like "1st word 2st word".
Without this feature the result would be the same as "1st word 2st".=20
OK

But I have an Index with more then one token on the same position.
The german sentence  "Die k=C3=A4uflichen Reihenh=C3=A4user standen am Wald=
rand" is
tokenized in the index as
"die k=C3=A4uflichen|kaufen reihenh=C3=A4user|reihe|haus standen|stehen am
waldrand|wald|rand"
where e.g. all three terms "reihenh=C3=A4user|reihe|haus" have the same pos=
ition.

My problem:
I need a hit for the phrase "reihe haus", but I don't get it, because of th=
e
checkedRepeats feature in SloppyPhraseScorer.
Any ideas how to deal with this problem?

Best regards
  Karsten

P.S. a source code example to show the problem:
/////////////////////////////////////////////////////////////
package org.apache.lucene.search;

import java.io.IOException;

import org.apache.lucene.analysis.TokenStream;
import org.apache.lucene.analysis.standard.StandardAnalyzer;
import
org.apache.lucene.analysis.tokenattributes.PositionIncrementAttribute;
import org.apache.lucene.analysis.tokenattributes.TermAttribute;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.index.IndexReader;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.index.Term;
import org.apache.lucene.store.Directory;
import org.apache.lucene.store.RAMDirectory;

/**
 * @see SloppyPhraseScorer
 */
public class TestPhraseWithoutPosIncrementQuery
{
    public static class MyTokenStream extends TokenStream
    {
        TermAttribute              termAtt;
        PositionIncrementAttribute posIncrAtt;

        int[]                      posInc =3D new int[] { 1, 0, 0, 1, 0, 0 =
};
        String[]                   terms  =3D new String[] { "t00", "t01",
"t02", "t10", "t11", "t12" };
        int                        pos    =3D 0;

        public MyTokenStream()
        {
            termAtt =3D (TermAttribute) addAttribute(TermAttribute.class);
            posIncrAtt =3D (PositionIncrementAttribute)
addAttribute(PositionIncrementAttribute.class);
        }

        public boolean incrementToken() throws IOException
        {
            if (pos < terms.length)
            {
                termAtt.setTermBuffer(terms[pos]);
                posIncrAtt.setPositionIncrement(posInc[pos]);
                pos++;
                return true;
            }
            return false;
        }
    }

    public static void main(String[] args) throws Exception
    {
        Directory ramDirectory =3D new RAMDirectory();
        IndexWriter indexWriter =3D new IndexWriter(ramDirectory, new
StandardAnalyzer());
        Document testDocument =3D new org.apache.lucene.document.Document()=
;
        Field f =3D new Field("field", new MyTokenStream());
        testDocument.add(f);
        indexWriter.addDocument(testDocument);
        indexWriter.commit();
        indexWriter.close();

        IndexReader iR =3D IndexReader.open(ramDirectory);
        IndexSearcher indexSearcher =3D new IndexSearcher(iR);
        PhraseQuery query =3D new PhraseQuery();
        query.add(new Term("field", "t00"), 0);
        query.add(new Term("field", "t10"), 1);
        Hits hits =3D indexSearcher.search(query);
        System.out.println(query.toString() + ": " + hits.length());
        // field:"t00 t10": 1

        query =3D new PhraseQuery();
        query.add(new Term("field", "t01"), 0);
        query.add(new Term("field", "t11"), 1);
        hits =3D indexSearcher.search(query);
        System.out.println(query.toString() + ": " + hits.length());
        // field:"t01 t11": 1

        query =3D new PhraseQuery();
        query.add(new Term("field", "t00"), 0);
        query.add(new Term("field", "t01"), 1);
        hits =3D indexSearcher.search(query);
        System.out.println(query.toString() + ": " + hits.length());
        // field:"t00 t01": 0

    }

}
=20
--=20
View this message in context: http://old.nabble.com/Search-a-PhraseQuery-on=
e-multiple-terms-with-the-same-position-tp27356784p27356784.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44728-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 14:34:47 2010
Return-Path: <java-user-return-44728-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84314 invoked from network); 28 Jan 2010 14:34:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 14:34:47 -0000
Received: (qmail 42829 invoked by uid 500); 28 Jan 2010 14:34:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42769 invoked by uid 500); 28 Jan 2010 14:34:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42759 invoked by uid 99); 28 Jan 2010 14:34:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 14:34:45 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gsiasf@gmail.com designates 209.85.217.214 as permitted sender)
Received: from [209.85.217.214] (HELO mail-gx0-f214.google.com) (209.85.217.214)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 14:34:35 +0000
Received: by gxk6 with SMTP id 6so636999gxk.5
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 06:34:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:sender:content-type
         :mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=KEZ0e4HrHRSuGBuehtU+Gldc2aG+HeYCEEyiqd5DHxs=;
        b=mOyKSEVv7m++XkYySnEeYH+875AuRwg/mvNkdB3bv1mQTBp7Gr6sWEG/d2wp2DEWVD
         jvHtOkvpX/36wqK800VbyK7+8ISBstmpW/MdOr8hL76sgCJAH+OY1dYRi31UQ6OQNnit
         eFTWIsPdE9MKVP5FaWmZFD2ZLGP22dMeyu314=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=sender:content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        b=Lwn0uLpQFAzOrOnM1nYQP9TYRagA5uyy/CMPWlOTTBVdJ7mcZKU3yu92Xwhasvv/TX
         8ngUTAjkA70ez6Gn8cZqT5deSko0cDfG5GlZIuQcpcMEU8UXnR5JvK9pBm7teo+2aEmi
         ZQGc43+CyFA2iBz/r17PyIFvmXxssEZjdmMA0=
Received: by 10.90.11.7 with SMTP id 7mr3545838agk.79.1264689252041;
        Thu, 28 Jan 2010 06:34:12 -0800 (PST)
Received: from ?10.0.0.77? (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
        by mx.google.com with ESMTPS id 14sm619387gxk.14.2010.01.28.06.34.11
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 28 Jan 2010 06:34:11 -0800 (PST)
Sender: Grant Ingersoll <gsiasf@gmail.com>
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Average Precision - TREC-3
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <672188.25802.qm@web32602.mail.mud.yahoo.com>
Date: Thu, 28 Jan 2010 09:34:10 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)


On Jan 27, 2010, at 1:36 PM, Ivan Provalov wrote:

> Robert, Grant:
>=20
> Thank you for your replies. =20
>=20
> Our goal is to fine-tune our existing system to perform better on =
relevance.

What kind of documents do you have?  Are they very similar to the TREC =
docs (i.e. news articles)?  There can be a fairly wide difference in =
performance between real docs and TREC docs, especially given real =
queries.  Doing well at TREC does not necessarily equate to doing well =
in your own system.  You might be better off just doing something like =
taking the top 50 queries from your logs plus some random ones from the =
tail and judging the top 10.   See =
http://www.lucidimagination.com/Community/Hear-from-the-Experts/Articles/D=
ebugging-Relevance-Issues-Search


--------------------------
Grant Ingersoll
http://www.lucidimagination.com/

Search the Lucene ecosystem using Solr/Lucene: =
http://www.lucidimagination.com/search


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44729-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 15:05:10 2010
Return-Path: <java-user-return-44729-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95526 invoked from network); 28 Jan 2010 15:05:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 15:05:09 -0000
Received: (qmail 4345 invoked by uid 500); 28 Jan 2010 15:05:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4272 invoked by uid 500); 28 Jan 2010 15:05:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4262 invoked by uid 99); 28 Jan 2010 15:05:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 15:05:06 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [81.169.146.162] (HELO mo-p00-ob.rzone.de) (81.169.146.162)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 15:04:56 +0000
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; t=1264691075; l=379;
	s=domk; d=qboad.de;
	h=In-Reply-To:Content-Transfer-Encoding:Content-Type:MIME-Version:
	Date:Subject:References:To:From:X-RZG-CLASS-ID:X-RZG-AUTH;
	bh=c67/dWD19jmoNKuunVH0RQvup8c=;
	b=HGDST+EOg1Sj+GC9TFCMXhmoCJwj8BFizjuS57eubNj4KX3Cy0aSAN/+vGGWvUw7j/C
	L0MQENlpzzczLyjTQ5uXabawrOJlM0GwBo66mkvhb9klS6XpS8gCmydL5VtvQ52ZfPddl
	yFnFIcSBECrnR67rv5pSfHTusrYC7qELPME=
X-RZG-AUTH: :JWICemC5efBhIus+Y9brhO0rWemFfVqN1wGoDG990xuVN056Na5Hng==
X-RZG-CLASS-ID: mo00
Received: from marvin (p549F8BC4.dip0.t-ipconnect.de [84.159.139.196])
	by post.strato.de (mrclete mo26) (RZmta 22.6)
	with ESMTP id t03d8cm0SEuOaU for <java-user@lucene.apache.org>;
	Thu, 28 Jan 2010 16:04:34 +0100 (MET)
From: "Marc Schwarz" <info@qboad.de>
To: <java-user@lucene.apache.org>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com> <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org>
Subject: Highlighter / cannot be instantiated
Date: Thu, 28 Jan 2010 16:06:48 +0100
Message-ID: <001e01caa02b$83fec430$6f01a8c0@marvin>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 11
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
Thread-Index: AcqgJwpFITK4lMibQPSNNf0RXb845AABAmSA
In-Reply-To: <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

I'm trying to get the highlighter running, but didn't get it work.

Everywhere it's posted as following:

Highlighter highlighter = new Highlighter(new SimpleHTMLFormatter(), 
new QueryScorer(query));

but that gives me a
"Highlighter is abstract; cannot be instantiated".

I'm using version 2.9 of highliter/2.9 of lucene

Any ideas ? Thanks :-)

Greetings,
Marc




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44730-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 16:01:28 2010
Return-Path: <java-user-return-44730-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19331 invoked from network); 28 Jan 2010 16:01:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 16:01:28 -0000
Received: (qmail 93351 invoked by uid 500); 28 Jan 2010 16:01:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93290 invoked by uid 500); 28 Jan 2010 16:01:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93276 invoked by uid 99); 28 Jan 2010 16:01:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:01:26 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.222.175 as permitted sender)
Received: from [209.85.222.175] (HELO mail-pz0-f175.google.com) (209.85.222.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:01:16 +0000
Received: by pzk5 with SMTP id 5so797706pzk.29
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 08:00:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=XWBO0B9PxreKU/fyl6kB4iu/o78UeY4cUhpmn3xsNd0=;
        b=ovXUFTiv3LNAKB4h+cxzPAnbZAPWURwWl68FbzBXKVw9NM7M6jbCy+CZ+tmpFo/S7B
         WhtEgk0hOSRQ/1j/AU6RmqOTLaiOMOxzkvyT7zW6FkIMAcjLQnO8Gc1eHaLUWgFnSaNf
         30E6+V7YR7V/dCjt1oJauICf1H1d6bZj0REOA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=M2crn4ZJTx4nQV94uV1YtGtXT//LLgeDfBZyV2gjI3UZGPlFaH2kmFnObu17975/ts
         ize2YonCSJpJfWg0CZCsnPn0XG/mV2PFDItqrBvBb8GOb3HQdG9WY49c+ZNBpu8riZis
         phzv+VbwyQ8cXfu67nZ2kELc7BCClBFghYu94=
MIME-Version: 1.0
Received: by 10.115.5.18 with SMTP id h18mr7681311wai.177.1264694453191; Thu, 
	28 Jan 2010 08:00:53 -0800 (PST)
In-Reply-To: <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com> <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org>
From: Robert Muir <rcmuir@gmail.com>
Date: Thu, 28 Jan 2010 11:00:33 -0500
Message-ID: <8f0ad1f31001280800m7debae36ja87adb665e77e392@mail.gmail.com>
Subject: Re: Average Precision - TREC-3
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e649bd98a1c2b4047e3b9fc6
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e649bd98a1c2b4047e3b9fc6
Content-Type: text/plain; charset=UTF-8

in addition to what Grant said, even if your documents are similar, what
about queries?

For example, if only a few trec queries contain proper names, acronyms,
abbreviations, or whatever, but your users frequently input things like
this, it won't be representative.

i will disagree with him on a few things though, I would rather have less
queries (25 or so), but more judgements, definitely a lot more than 10.
Maybe your users only care about the top-10 results but its crucial to judge
some lower-ranking docs too, especially if you have recall problems...

On Thu, Jan 28, 2010 at 9:34 AM, Grant Ingersoll <gsingers@apache.org>wrote:

>
> On Jan 27, 2010, at 1:36 PM, Ivan Provalov wrote:
>
> > Robert, Grant:
> >
> > Thank you for your replies.
> >
> > Our goal is to fine-tune our existing system to perform better on
> relevance.
>
> What kind of documents do you have?  Are they very similar to the TREC docs
> (i.e. news articles)?  There can be a fairly wide difference in performance
> between real docs and TREC docs, especially given real queries.  Doing well
> at TREC does not necessarily equate to doing well in your own system.  You
> might be better off just doing something like taking the top 50 queries from
> your logs plus some random ones from the tail and judging the top 10.   See
> http://www.lucidimagination.com/Community/Hear-from-the-Experts/Articles/Debugging-Relevance-Issues-Search
>
>
> --------------------------
> Grant Ingersoll
> http://www.lucidimagination.com/
>
> Search the Lucene ecosystem using Solr/Lucene:
> http://www.lucidimagination.com/search
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Robert Muir
rcmuir@gmail.com

--0016e649bd98a1c2b4047e3b9fc6--

From java-user-return-44731-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 16:18:18 2010
Return-Path: <java-user-return-44731-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26997 invoked from network); 28 Jan 2010 16:18:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 16:18:18 -0000
Received: (qmail 22427 invoked by uid 500); 28 Jan 2010 16:18:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22356 invoked by uid 500); 28 Jan 2010 16:18:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22346 invoked by uid 99); 28 Jan 2010 16:18:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:18:16 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of vaiju1981@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:18:08 +0000
Received: by bwz22 with SMTP id 22so633485bwz.5
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 08:17:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=NRmiXdeYLnekSVaxafxZllMazg9e2spRrfYwBKy6aS8=;
        b=RXG0B40Yc8zWUOq67dY/zaRa9KQsIl0m+yEWhI4rn9wkCh9K7BE+1WpTASQQZfsVwI
         8xHog8orkEbtFVCw5iGprcxjpbOmvVK9RC2TAMz8rFu5vPtvmIThYrqPeO9Ad3aWVeCz
         eii+QmPM3HempFePNiY2WUyFVLjNCyD1ULMlA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=sxYjwlUPfwQ6xhM1Xr7Dm7xG+lZQcjL2l2qb7qnwKme0IInxtaIiMvsqlhlZpLtNON
         EJR/5Yz7lx27gC1GmOZ8ez7d8gY04LHhGHoKuizv3l5L6F3iKyROtX8eWIlNvjDWjGwH
         rB2wxkXzHNO+y6zuVWeJzoHOfw0C1pElysGOI=
MIME-Version: 1.0
Received: by 10.204.48.197 with SMTP id s5mr3109384bkf.88.1264695468055; Thu, 
	28 Jan 2010 08:17:48 -0800 (PST)
Date: Thu, 28 Jan 2010 21:47:48 +0530
Message-ID: <13a254fb1001280817k2e38d8a2la4dbd8a94bf7e8dc@mail.gmail.com>
Subject: How to get matched terms
From: Vaijanath Rao <vaiju1981@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00032555bc1e1f5ee8047e3bdc8a
X-Virus-Checked: Checked by ClamAV on apache.org

--00032555bc1e1f5ee8047e3bdc8a
Content-Type: text/plain; charset=ISO-8859-1

Hi All,

What is the simplest way of getting the matched terms of the query with
respect to the document. So for example let's say a document has field X and
the contains of the field are "a b c" now when I do a search for 'b c'. The
document will be returned I want to get back the terms that this document
matched with the query terms. Can someone tell me the easiest way to
accomplish this.

--Thanks and Regards
Vaijanath

-- 
I am feeling fine, healthier and Happier, what about you

--00032555bc1e1f5ee8047e3bdc8a--

From java-user-return-44732-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 16:31:34 2010
Return-Path: <java-user-return-44732-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31268 invoked from network); 28 Jan 2010 16:31:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 16:31:34 -0000
Received: (qmail 52893 invoked by uid 500); 28 Jan 2010 16:31:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52823 invoked by uid 500); 28 Jan 2010 16:31:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52813 invoked by uid 99); 28 Jan 2010 16:31:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:31:31 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of benhei@gmail.com designates 209.85.220.210 as permitted sender)
Received: from [209.85.220.210] (HELO mail-fx0-f210.google.com) (209.85.220.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:31:25 +0000
Received: by fxm2 with SMTP id 2so737496fxm.5
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 08:31:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=Gk3U4mYZVTZsLQl9PmvtZH5qplZVO4b/MIWPF7cX0aU=;
        b=wTttkgj44+jA4mBsaX0Brq6Qd+b6T5uM7XbZfe7Gn2YamX8/FG3No0An+QQnTg/6a3
         hpOT6k3gmOQCfBYk/i1HmfOZaqUNniqbveqwKKF2Vn4phfK4JkjGroLjgWxrmLsh6GQU
         dW6Uhwqh4oOKuWIFnMMc0fIjBGxF8Sike27Wk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=nF8dfuyXc0fxehvm++gXILZvuWyy0oGo6Sl7L9SMc29v5qBBg0U6xKFfMLjlCVSsyG
         wuIyCfWABjnIEyXpBZiwMietJJm1Kn06LByCl/DzcjxyRx49s61ImtAlqf7VUP+x3LL8
         IkCLr0/DUm14urEnUmP9Bh/mnKqKRxn044pYs=
MIME-Version: 1.0
Received: by 10.223.5.135 with SMTP id 7mr5312383fav.81.1264696262651; Thu, 28 
	Jan 2010 08:31:02 -0800 (PST)
In-Reply-To: <13a254fb1001280817k2e38d8a2la4dbd8a94bf7e8dc@mail.gmail.com>
References: <13a254fb1001280817k2e38d8a2la4dbd8a94bf7e8dc@mail.gmail.com>
Date: Thu, 28 Jan 2010 17:31:02 +0100
Message-ID: <94095f521001280831y100479d1n657e0618a3e7a3b@mail.gmail.com>
Subject: Re: How to get matched terms
From: Benjamin Heilbrunn <benhei@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

You could use Query.extractTerms(..) and then search for possible
matches in the field term vector (requires stored TV).

2010/1/28 Vaijanath Rao <vaiju1981@gmail.com>:
> Hi All,
>
> What is the simplest way of getting the matched terms of the query with
> respect to the document. So for example let's say a document has field X and
> the contains of the field are "a b c" now when I do a search for 'b c'. The
> document will be returned I want to get back the terms that this document
> matched with the query terms. Can someone tell me the easiest way to
> accomplish this.
>
> --Thanks and Regards
> Vaijanath
>
> --
> I am feeling fine, healthier and Happier, what about you
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44733-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 16:36:27 2010
Return-Path: <java-user-return-44733-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32910 invoked from network); 28 Jan 2010 16:36:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 16:36:26 -0000
Received: (qmail 72262 invoked by uid 500); 28 Jan 2010 16:36:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72211 invoked by uid 500); 28 Jan 2010 16:36:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72171 invoked by uid 99); 28 Jan 2010 16:36:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:36:21 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gsiasf@gmail.com designates 209.85.211.172 as permitted sender)
Received: from [209.85.211.172] (HELO mail-yw0-f172.google.com) (209.85.211.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:36:12 +0000
Received: by ywh2 with SMTP id 2so185476ywh.21
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 08:35:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:sender:content-type
         :mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        bh=iW4wGoabQYVAT39Y6nereMMwGaGtrs1HgbW2JhLP0j4=;
        b=GG8A0Al1hB/VdaLyRBvKK81c3WoZ/Jgu2pjLxPPR5eQJkrGSm/48XB/+ABHEsgx7WK
         WBWbUNKR/0/iAQTVnoMqrJI7E6O/EcwyRDhV8GTEK3pxce6Cfh3lsdSsxdnYmnqudQfa
         XdRI+Es4rcP0xDUWygpMM9br+FLxq0LtTBImY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=sender:content-type:mime-version:subject:from:in-reply-to:date
         :content-transfer-encoding:message-id:references:to:x-mailer;
        b=rJi2Bg8+k/LJDiqZY4Tfk59P6C3v3+pgOE7wp47zYRK4cbklc3bcNR9JMtJ2T0pStI
         z1YAZrG3b9C7mOM6F4UCvMc9CkSBeeT2WXpT/TJx5ltCFqC6tfMBbaKHpG687VDZLHH7
         SvRE3DbIuE77Vh1ltEYOhUBVlKQrtH6nit+Ak=
Received: by 10.91.53.11 with SMTP id f11mr1996093agk.100.1264696546658;
        Thu, 28 Jan 2010 08:35:46 -0800 (PST)
Received: from ?10.0.0.77? (adsl-065-013-152-164.sip.rdu.bellsouth.net [65.13.152.164])
        by mx.google.com with ESMTPS id 14sm674141gxk.14.2010.01.28.08.35.45
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 28 Jan 2010 08:35:45 -0800 (PST)
Sender: Grant Ingersoll <gsiasf@gmail.com>
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Apple Message framework v1077)
Subject: Re: Average Precision - TREC-3
From: Grant Ingersoll <gsingers@apache.org>
In-Reply-To: <8f0ad1f31001280800m7debae36ja87adb665e77e392@mail.gmail.com>
Date: Thu, 28 Jan 2010 11:35:44 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <3C3AAC19-4C55-4974-9A6F-C6585DCA2312@apache.org>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com> <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org> <8f0ad1f31001280800m7debae36ja87adb665e77e392@mail.gmail.com>
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org


On Jan 28, 2010, at 11:00 AM, Robert Muir wrote:

> in addition to what Grant said, even if your documents are similar, =
what
> about queries?
>=20
> For example, if only a few trec queries contain proper names, =
acronyms,
> abbreviations, or whatever, but your users frequently input things =
like
> this, it won't be representative.

+1

>=20
> i will disagree with him on a few things though, I would rather have =
less
> queries (25 or so), but more judgements, definitely a lot more than =
10.
> Maybe your users only care about the top-10 results but its crucial to =
judge
> some lower-ranking docs too, especially if you have recall problems...

Perfectly reasonable as well.  I've seen some people who only care about =
P@5 and even P@1 and others who do much more.  The important thing is to =
think about what makes sense for your application and users.  Much of =
this can be found through basic log analysis (assuming an existing =
system) or some reasoning about use cases (new system) and users (how =
sophisticated they are, etc.) =20

-Grant


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44734-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 16:45:26 2010
Return-Path: <java-user-return-44734-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35705 invoked from network); 28 Jan 2010 16:45:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 16:45:26 -0000
Received: (qmail 84121 invoked by uid 500); 28 Jan 2010 16:45:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84069 invoked by uid 500); 28 Jan 2010 16:45:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84059 invoked by uid 99); 28 Jan 2010 16:45:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:45:24 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of rcmuir@gmail.com designates 209.85.222.175 as permitted sender)
Received: from [209.85.222.175] (HELO mail-pz0-f175.google.com) (209.85.222.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 16:45:16 +0000
Received: by pzk5 with SMTP id 5so840341pzk.29
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 08:44:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=AZJUIdtt5LPHOgdTmGwsLFVfzmVxCkX6f/j002dWv5A=;
        b=R/ov74NQvV1Fmi5gUIFgzY75Uqu++Oii5TM0bFN9MbA/hwxl19fSlHXh38UJcQCDt0
         iBmUcSY79KPnRnx0NjGVvYd1hZvhIVQIBV6zWKTMis1BLepiXa/5Ahr3vOsJ6sBr+d/1
         xiOendM0ktr0vMtjsCeX+EHgor2Br/bztZqQQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=sAf8QgyR7RKt7eG1+jV/YbYwV/q6y/EyTgitGcQ7A0BIA4NEyFiG4kxXtjqkIZnrNh
         K1Sk2kmTvicPTEEwqOg+PqIxnnIF4sPacpsZsiICcszFH+BtoT5XGvjV/9YIgJ+KhpEr
         BtZ5MEF9Memo14Tjrrgpc3OnvCoYXtG82RRJo=
MIME-Version: 1.0
Received: by 10.115.50.15 with SMTP id c15mr353084wak.141.1264697094823; Thu, 
	28 Jan 2010 08:44:54 -0800 (PST)
In-Reply-To: <3C3AAC19-4C55-4974-9A6F-C6585DCA2312@apache.org>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com> <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org> 
	<8f0ad1f31001280800m7debae36ja87adb665e77e392@mail.gmail.com> 
	<3C3AAC19-4C55-4974-9A6F-C6585DCA2312@apache.org>
From: Robert Muir <rcmuir@gmail.com>
Date: Thu, 28 Jan 2010 11:44:34 -0500
Message-ID: <8f0ad1f31001280844k53ec9233u744e56919dedd4c8@mail.gmail.com>
Subject: Re: Average Precision - TREC-3
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64afbd615dff3047e3c3d49
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e64afbd615dff3047e3c3d49
Content-Type: text/plain; charset=UTF-8

right, but the problem is when something is currently ranked as doc 20 but
should be in the top 1, 5, or 10, and you aren't seeing it.

so I think if you are judging top-N docs from an existing system, you should
look a little farther ahead than the top-N you care about.
I think you should also index your data a few different ways and judge those
top-N too, for example, use n-gram tokenizer.

It doesn't have to be crazy like a formal trec-like pooling process, but I
think you need to introduce enough variation that you have judgements for
docs that should be ranked higher than they currently are.


> Perfectly reasonable as well.  I've seen some people who only care about
> P@5 and even P@1 and others who do much more.  The important thing is to
> think about what makes sense for your application and users.  Much of this
> can be found through basic log analysis (assuming an existing system) or
> some reasoning about use cases (new system) and users (how sophisticated
> they are, etc.)
>
> -Grant
>
>
>

> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>



-- 
Robert Muir
rcmuir@gmail.com

--0016e64afbd615dff3047e3c3d49--

From java-user-return-44735-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 18:42:27 2010
Return-Path: <java-user-return-44735-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2051 invoked from network); 28 Jan 2010 18:42:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 18:42:27 -0000
Received: (qmail 47937 invoked by uid 500); 28 Jan 2010 18:42:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47891 invoked by uid 500); 28 Jan 2010 18:42:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47881 invoked by uid 99); 28 Jan 2010 18:42:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 18:42:25 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 18:42:15 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NaZJS-00065Z-RE
	for java-user@lucene.apache.org; Thu, 28 Jan 2010 10:41:54 -0800
Message-ID: <27358766.post@talk.nabble.com>
Date: Thu, 28 Jan 2010 10:41:54 -0800 (PST)
From: andy green <dreamforlife@hotmail.fr>
To: java-user@lucene.apache.org
Subject: lucene search
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: dreamforlife@hotmail.fr
X-Virus-Checked: Checked by ClamAV on apache.org


hello,

I programmed with Lucene code to handle the search on my site ... the
articles indexed are those stored in a database, then I do a search with
"lucene.queryparser" on the field "code" of various objects (a "code" is a
word of 3 6-character) ...

My problem is the fact that when I search, I am obliged to insert exactly
the real "code" to get a result. For example if in the database, I have an
object whose "code" is "lpg" , by typing "lp" in my textbox (for searching),
I get nothing ... I must enter the real entire code  ... "lpg"

In addition my research does not react with "figures" or characters such as
"_"

How can I do? I think that the problem may be due to "analyzer" I chose? (I
tried to use "SimpleAnalyser" or "StandardAnalyser)


Thank you for your help!

-- 
View this message in context: http://old.nabble.com/lucene-search-tp27358766p27358766.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44736-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 18:52:47 2010
Return-Path: <java-user-return-44736-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5336 invoked from network); 28 Jan 2010 18:52:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 18:52:47 -0000
Received: (qmail 63969 invoked by uid 500); 28 Jan 2010 18:52:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63891 invoked by uid 500); 28 Jan 2010 18:52:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63881 invoked by uid 99); 28 Jan 2010 18:52:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 18:52:45 +0000
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.230.18.92] (HELO smtp2.syr.edu) (128.230.18.92)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 18:52:35 +0000
Received: from suex07-hub-01.ad.syr.edu (suex07-hub-01.ad.syr.edu [128.230.108.195])
	by smtp2.syr.edu (8.14.3/8.14.3) with ESMTP id o0SIqAbq008245
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=FAIL)
	for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 13:52:14 -0500
Received: from suex07-mbx-03.ad.syr.edu ([128.230.108.133]) by
 suex07-hub-01.ad.syr.edu ([2002:80e6:6cc3::80e6:6cc3]) with mapi; Thu, 28 Jan
 2010 13:52:13 -0500
From: Steven A Rowe <sarowe@syr.edu>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 28 Jan 2010 13:52:12 -0500
Subject: RE: combine query score with external score
Thread-Topic: combine query score with external score
Thread-Index: AcqgCUbahyrfhWlFRIqBHaihqwJx8QAOWHPA
Message-ID: <2D127F11DC79714E9B6A43AC9458147F36661E0D@suex07-mbx-03.ad.syr.edu>
References: <1264676463.2334.59.camel@kalooga-dennis>
In-Reply-To: <1264676463.2334.59.camel@kalooga-dennis>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-Proofpoint-Virus-Version: vendor=fsecure engine=1.12.8161:2.4.5,1.2.40,4.0.166 definitions=2010-01-28_11:2010-01-20,2010-01-28,2010-01-28 signatures=0
X-Proofpoint-Spam-Reason: safe

SGkgRGVubmlzLA0KDQpZb3Ugc2hvdWxkIGNoZWNrIG91dCBwYXlsb2FkcyAoYXJiaXRyYXJ5IHBl
ci1pbmRleC10ZXJtIGJ5dGVbXSBhcnJheXMpLCB3aGljaCBjYW4gYmUgdXNlZCB0byBlbmNvZGUg
dmFsdWVzIHdoaWNoIGFyZSB0aGVuIGluY29ycG9yYXRlZCBpbnRvIGRvY3VtZW50cycgc2NvcmVz
LCBieSBvdmVycmlkaW5nIFNpbWlsYXJpdHkuc2NvcmVQYXlsb2FkKCk6DQoNCjxodHRwOi8vbHVj
ZW5lLmFwYWNoZS5vcmcvamF2YS8zXzBfMC9hcGkvY29yZS9vcmcvYXBhY2hlL2x1Y2VuZS9zZWFy
Y2gvU2ltaWxhcml0eS5odG1sI3Njb3JlUGF5bG9hZCUyOGludCwlMjBqYXZhLmxhbmcuU3RyaW5n
LCUyMGludCwlMjBpbnQsJTIwYnl0ZVtdLCUyMGludCwlMjBpbnQlMjk+DQoNClRoZSBMdWNlbmUg
aW4gQWN0aW9uIDIgTUVBUCBoYXMgYSBuaWNlIGludHJvZHVjdGlvbiB0byB1c2luZyBwYXlsb2Fk
cyB0byBpbmZsdWVuY2Ugc2NvcmluZywgaW4gc2VjdGlvbiA2LjUuDQoNClNlZSBhbHNvIHRoaXMg
KHNsaWdodGx5IG91dC1vZi1kYXRlKikgYmxvZyBwb3N0ICJHZXR0aW5nIFN0YXJ0ZWQgd2l0aCBQ
YXlsb2FkcyIgYnkgR3JhbnQgSW5nZXJzb2xsIGF0IEx1Y2lkIEltYWdpbmF0aW9uOg0KDQo8aHR0
cDovL3d3dy5sdWNpZGltYWdpbmF0aW9uLmNvbS9ibG9nLzIwMDkvMDgvMDUvZ2V0dGluZy1zdGFy
dGVkLXdpdGgtcGF5bG9hZHMvPg0KDQoqTm90ZSB0aGF0IHNpbmNlIHRoaXMgYmxvZyBwb3N0IHdh
cyB3cml0dGVuLCBCb29zdGluZ1Rlcm1RdWVyeSB3YXMgcmVuYW1lZCB0byBQYXlsb2FkVGVybVF1
ZXJ5IChpbiBMdWNlbmUgMi45LjArIDsgc2VlIGh0dHA6Ly9pc3N1ZXMuYXBhY2hlLm9yZy9qaXJh
L2Jyb3dzZS9MVUNFTkUtMTgyNyA7IHdvdyAtIHRoaXMgaXNzdWUgaXNuJ3QgbWVudGlvbmVkIGlu
IENIQU5HRVMudHh0Pz8/KToNCg0KPGh0dHA6Ly9sdWNlbmUuYXBhY2hlLm9yZy9qYXZhLzNfMF8w
L2FwaS9jb3JlL29yZy9hcGFjaGUvbHVjZW5lL3NlYXJjaC9wYXlsb2Fkcy9QYXlsb2FkVGVybVF1
ZXJ5Lmh0bWw+DQoNClN0ZXZlDQoNCk9uIDAxLzI4LzIwMTAgYXQgNjowMSBBTSwgRGVubmlzIEhl
bmRyaWtzZW4gd3JvdGU6DQo+IEknbSBzdHJ1Z2dsaW5nIHRvIGNyZWF0ZSBhIHBlcmZvcm1hbnQg
cXVlcnkgaW4gTHVjZW5lIDMuMC4wIGluIHdoaWNoIEkNCj4gd2FudCB0byBjb21iaW5lICdyZWd1
bGFyJyBzY29yaW5nIHdpdGggc2NvcmVzIGRlcml2ZWQgZnJvbSBleHRlcm5hbA0KPiBzb3VyY2Vz
Lg0KPiANCj4gRm9yIGVhY2ggZG9jdW1lbnQgYSBmaXhlZCBzZXQgb2Ygc2NvcmVzIGlzIGNhbGN1
bGF0ZWQgaW4gdGhlIHJhbmdlIFswLjAsDQo+IDEuMD4uIFRoZXNlIHNjb3JlcyByZXByZXNlbnQg
dGhlIGNvbmZpZGVuY2VzIHRoYXQgYSBkb2N1bWVudCBmYWxscyBpbnRvDQo+IGNhdGVnb3JpZXMu
IFNvIGZvciBleGFtcGxlIGRvY3VtZW50ICMxIGhhcyBhIHNjb3JlIG9mIDAuMyBmb3IgY2F0PWJv
eXMsDQo+IDAuMiBmb3IgY2F0PWdpcmxzLCAwLjEgZm9yIGNhdD10b3lzLCAwLjA1IGZvciBjYXQ9
YW5pbWFscy4NCj4gDQo+IFRoZSAncmVndWxhcicgc2NvcmluZyBpcyBjYWxjdWxhdGVkIHVzaW5n
IGEgQm9vbGVhblF1ZXJ5IHdpdGggVGVybVF1ZXJ5cw0KPiBzaW1pbGFyIHRvOiAtdHlwZTpIICso
dGl0bGU6ZG5hIGJvZHk6ZG5hXjEuNSkNCj4gDQo+IEluIHRoZSBjdXJyZW50IG5haXZlIGFwcHJv
YWNoIEknbSBjb21iaW5pbmcgdGhlIHNjb3JlcyBhcyBmb2xsb3dpbmc6IC0NCj4gZm9yIGVhY2gg
ZG9jdW1lbnQgc3RvcmUgdGhlIHRocmVlIGJlc3QgY2F0ZWdvcmllcyBpbiB0aGUgZm9sbG93aW5n
DQo+IGZpZWxkczoNCj4gbmFtZT1jYXQxc3QgdmFsdWU9Ym95cyBmaWVsZGJvb3N0PTAuMw0KPiBu
YW1lPWNhdDJuZCB2YWx1ZT1naXJscyBmaWVsZGJvb3N0PTAuMg0KPiBuYW1lPWNhdDNyZCB2YWx1
ZT10b3lzIGZpZWxkYm9vc3Q9MC4xDQo+IFNlYXJjaC10aW1lIHVzZSB0aGUgZm9sbG93aW5nIHF1
ZXJ5IGlmIHlvdSdyZSBpbnRlcmVzdGVkIGluICdnaXJscyc6DQo+IC10eXBlOkggKyh0aXRsZTpk
bmEgYm9keTpkbmFeMS41KSBjYXQxc3Q6Z2lybHMgY2F0Mm5kOmdpcmxzIGNhdDNyZDpnaXJscyAN
Cj4gb3IgaWYgeW91J3JlIGludGVyZXN0ZWQgaW4gJ2JveXMnOiANCj4gLXR5cGU6SCArKHRpdGxl
OmRuYSBib2R5OmRuYV4xLjUpIGNhdDFzdDpib3lzIGNhdDJuZDpib3lzIGNhdDNyZDpib3lzDQo+
IA0KPiBEaXNhZHZhbnRhZ2VzIG9mIHRoZSBjdXJyZW50IGFwcHJvYWNoOg0KPiAtIGxvc3Mgb2Yg
cHJlY2lzaW9uIGVuY29kaW5nL2RlY29kaW5nIGJvb3N0cyAocGVyZm9ybWFuY2UgaXMgaW1wb3J0
YW50LA0KPiBzbyB0aGlzIG1pZ2h0IGJlIGFjY2VwdGFibGUpDQo+IC0gdXNpbmcgVGVybVF1ZXJ5
IGZvciB0aGUgY2F0IGZpZWxkcyBkb2Vzbid0IG1ha2UgYSBsb3Qgb2Ygc2Vuc2Ugc2luY2UNCj4g
dGhlIGV4dGVybmFsIHNjb3JlcyBhcmUgbXVsdGlwbGllZCBieSB0aGUgaWRmIG9mICdib3lzJy8n
Z2lybHMnIGFuZA0KPiB0aGUgcXVlcnlub3JtDQo+IC0gdGhlIHJlc3VsdGluZyBzY29yZSBmcm9t
IHRoZSBjYXQgZmllbGQgaXMgYWRkZWQgdG8gdGhlIG90aGVyIHF1ZXJ5DQo+IHNjb3JlIGluc3Rl
YWQgb2YgbXVsdGlwbGllZA0KPiANCj4gSnVzdCB0byBnaXZlIHlvdSBhbiBpZGVhOiB0aGUgaW5k
ZXggSSdtIHVzaW5nIGlzIGdyb3dpbmcgaW4gdGltZSBhbmQNCj4gY29udGFpbnMgYWJvdXQgNTAg
bWlsbGlvbiBkb2N1bWVudHMNCj4gDQo+IERvIHlvdSBoYXZlIGFuIGlkZWEgaG93IEkgY2FuIGlt
cHJvdmUgbXkgcXVlcnkgYW5kIHN0aWxsIGtlZXAgaGlnaA0KPiBwZXJmb3JtYW5jZT8gT3Igc2hv
dWxkIEkgY29tYmluZSB0aGUgc2NvcmVzIGluIHRoZSBDb2xsZWN0b3IgKGJ1dCB0aGlzDQo+IGRv
ZXNuJ3Qgc2VlbSB0aGUgcmlnaHQgcGxhY2UgdG8gcmV0cmlldmUgdGhlIGNhdGVnb3J5IHNjb3Jl
cyBmcm9tIHRoZQ0KPiBpbmRleCk/IElzIGl0IHBvc3NpYmxlIHRvIHVzZSBhIGRpZmZlcmVudCBm
bG9hdC0+Ynl0ZSBlbmNvZGVyIHBlciBmaWVsZA0KPiB0byByZWR1Y2UgdGhlIGxhY2sgb2YgcHJl
Y2lzaW9uPw0KPiANCj4gVGhhbmtzIGZvciB5b3VyIHRpbWUsDQo+IERlbm5pcw0KDQoNCg==


From java-user-return-44737-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 19:42:31 2010
Return-Path: <java-user-return-44737-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27371 invoked from network); 28 Jan 2010 19:42:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 19:42:31 -0000
Received: (qmail 58802 invoked by uid 500); 28 Jan 2010 19:42:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58716 invoked by uid 500); 28 Jan 2010 19:42:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58706 invoked by uid 99); 28 Jan 2010 19:42:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 19:42:29 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shashi.mit@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 19:42:19 +0000
Received: by ewy2 with SMTP id 2so1193034ewy.5
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 11:41:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:from:date:x-google-sender-auth:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=ABnqa0I9Bv4HTqzpUDZf+ode+Qk2R2tGyptrAv0AxGE=;
        b=N90SNsJBhFHTOnijDLOElhFFBk43sSa2HRB5ahKmwvlI2OUOCP722wuXWdA6j2dfdo
         iqqjBPBhRP9US1Vn6z98LSAJpL5SeF7HvbV4mzs3mHoOMVO3GY5yZxTStHzwppbpq0Q8
         OETdNJF36M7mEV3DuR9V+TLwlfGj6YCsyIj6c=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:from:date
         :x-google-sender-auth:message-id:subject:to:content-type
         :content-transfer-encoding;
        b=RePU1WEup0bt8s6PBY83jQscLBSrrjhzaJHe3s+zHJvkdi+uiCAM1sUoMHt1vfAhC/
         AnxI7e8w2jYnjcy0rehBVD+P07s17FQjLzRoKkRHLM30RR3QNtztr5G+V6TE+7evrR0c
         20M3NEr3VZVZCKAPFbBVq5WpDnMlR5PqrIVOk=
MIME-Version: 1.0
Sender: shashi.mit@gmail.com
Received: by 10.216.91.84 with SMTP id g62mr2174199wef.216.1264707719251; Thu, 
	28 Jan 2010 11:41:59 -0800 (PST)
In-Reply-To: <27358766.post@talk.nabble.com>
References: <27358766.post@talk.nabble.com>
From: Shashi Kant <skant@sloan.mit.edu>
Date: Thu, 28 Jan 2010 14:41:38 -0500
X-Google-Sender-Auth: c2c26a5e7aeec876
Message-ID: <4d19a3631001281141w231b25e3q4134e3bf99d50fa@mail.gmail.com>
Subject: Re: lucene search
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Hi, if you want to search by substring (i.e. "lp" should return "lpg"
as a result) you should look at wildcards.
So a search for "lp*" (* is the wildcard character) would return lpg,
lpghxyz, lp12345 and so on...



On Thu, Jan 28, 2010 at 1:41 PM, andy green <dreamforlife@hotmail.fr> wrote=
:
>
> hello,
>
> I programmed with Lucene code to handle the search on my site ... the
> articles indexed are those stored in a database, then I do a search with
> "lucene.queryparser" on the field "code" of various objects (a "code" is =
a
> word of 3 6-character) ...
>
> My problem is the fact that when I search, I am obliged to insert exactly
> the real "code" to get a result. For example if in the database, I have a=
n
> object whose "code" is "lpg" , by typing "lp" in my textbox (for searchin=
g),
> I get nothing ... I must enter the real entire code =A0... "lpg"
>
> In addition my research does not react with "figures" or characters such =
as
> "_"
>
> How can I do? I think that the problem may be due to "analyzer" I chose? =
(I
> tried to use "SimpleAnalyser" or "StandardAnalyser)
>
>
> Thank you for your help!
>
> --
> View this message in context: http://old.nabble.com/lucene-search-tp27358=
766p27358766.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44738-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 19:51:36 2010
Return-Path: <java-user-return-44738-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30188 invoked from network); 28 Jan 2010 19:51:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 19:51:36 -0000
Received: (qmail 78397 invoked by uid 500); 28 Jan 2010 19:51:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78321 invoked by uid 500); 28 Jan 2010 19:51:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78311 invoked by uid 99); 28 Jan 2010 19:51:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 19:51:34 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 72.14.220.156 as permitted sender)
Received: from [72.14.220.156] (HELO fg-out-1718.google.com) (72.14.220.156)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 19:51:24 +0000
Received: by fg-out-1718.google.com with SMTP id 19so163979fgg.5
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 11:51:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=2BQd6TDAXVfmUyAkGP1UZ8yUJlJpKC7gcS6R7wE29yo=;
        b=AG6wWrQPSwEObI747fzHBXscV8ygoV0ygJEIXgTYmIDBA6Ytn192SPN170rpQ24d9t
         IlsR1uwqPl8Yk8pHnO6sYj1bEELmRK1UlHf/g40aSoyKtdEO9EJif6MC6RBceYq3xy1Z
         2m12xtEVeleu7RdYP0moczls6niq0kVeGicgw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=gM/QwXN90jE9t8kQtP3OAagO+JclxzLOgBwB5y2fsAYT7LykFDTxuGJMTiVPsULO9P
         w0TOOwMBg9dsCkYaspeKcsYDMkS/8A6nmT20u8o5ndbT+nblQKRB1CJmLjcKTJt/xSbB
         lV0ha8w1GbAbUfJIH7m3BQLMOBEpQmJfLXpH4=
MIME-Version: 1.0
Received: by 10.216.186.12 with SMTP id v12mr2771475wem.75.1264708262576; Thu, 
	28 Jan 2010 11:51:02 -0800 (PST)
In-Reply-To: <27358766.post@talk.nabble.com>
References: <27358766.post@talk.nabble.com>
Date: Thu, 28 Jan 2010 14:51:02 -0500
Message-ID: <359a92831001281151t228288eah7a72058b99946d68@mail.gmail.com>
Subject: Re: lucene search
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e649c9e8bc445e047e3ed68f
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e649c9e8bc445e047e3ed68f
Content-Type: text/plain; charset=ISO-8859-1

the issue with non-letter characters is, indeed, the analyzer. Have
a look at all the different subclasses of Analyzer in the javadocs, getting
a copy of Luke will show you exactly what gets in your index, but
KeywordAnalyzer and WhitespaceAnalyzer may work for you (but they
don't normalize the case, you'll have to do that yourself).

And you can easily construct your own analyzer by stringing
together tokenizers and filters.

And don't forget PerFieldAnalyzerWrapper if you want different
analyzers for different fields.

HTH
Erick

On Thu, Jan 28, 2010 at 1:41 PM, andy green <dreamforlife@hotmail.fr> wrote:

>
> hello,
>
> I programmed with Lucene code to handle the search on my site ... the
> articles indexed are those stored in a database, then I do a search with
> "lucene.queryparser" on the field "code" of various objects (a "code" is a
> word of 3 6-character) ...
>
> My problem is the fact that when I search, I am obliged to insert exactly
> the real "code" to get a result. For example if in the database, I have an
> object whose "code" is "lpg" , by typing "lp" in my textbox (for
> searching),
> I get nothing ... I must enter the real entire code  ... "lpg"
>
> In addition my research does not react with "figures" or characters such as
> "_"
>
> How can I do? I think that the problem may be due to "analyzer" I chose? (I
> tried to use "SimpleAnalyser" or "StandardAnalyser)
>
>
> Thank you for your help!
>
> --
> View this message in context:
> http://old.nabble.com/lucene-search-tp27358766p27358766.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e649c9e8bc445e047e3ed68f--

From java-user-return-44739-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 20:30:58 2010
Return-Path: <java-user-return-44739-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40423 invoked from network); 28 Jan 2010 20:30:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 20:30:58 -0000
Received: (qmail 46168 invoked by uid 500); 28 Jan 2010 20:30:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46092 invoked by uid 500); 28 Jan 2010 20:30:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46082 invoked by uid 99); 28 Jan 2010 20:30:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 20:30:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 20:30:47 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Nab0U-0004qS-O4
	for java-user@lucene.apache.org; Thu, 28 Jan 2010 12:30:26 -0800
Message-ID: <27358959.post@talk.nabble.com>
Date: Thu, 28 Jan 2010 12:30:26 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: index a database
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: lucius.vorenus@hotmail.de


Hello 

I tried to index a database

""
import org.apache.lucene.demo.FileDocument;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.Query;
import org.apache.lucene.queryParser.QueryParser;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.util.Version;
import java.sql.*;
import java.util.Properties;
import org.apache.lucene.document.*;
import java.io.*;
import org.apache.lucene.store.Directory;
import org.apache.lucene.store.FSDirectory;

public class Con{
	public static void main(String[] args) throws Exception

	  {
		final File INDEX_DIR = new File("index");

		
		   Class.forName("com.mysql.jdbc.Driver").newInstance();
		   Connection conn =
DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
"passwort");
		   StandardAnalyzer analyzer = new StandardAnalyzer(null);
		   IndexWriter writer = new IndexWriter(INDEX_DIR, analyzer, true);
		   System.out.println("Indexing to directory '" + INDEX_DIR + "'...");
		   indexDocs(writer, conn);
		   writer.optimize();
		   writer.close();
		

		
		}
	  

private static	void indexDocs(IndexWriter writer, Connection conn) throws
Exception {
	  String sql = "select c_id, city from city";
	  Statement stmt = conn.createStatement();
	  ResultSet rs = stmt.executeQuery(sql);
	  while (rs.next()) {
	     Document d = new Document();
	     d.add(new Field("c_id", rs.getString("c_id"), Field.Store.YES,
Field.Index.NO));
	     d.add(new Field("city", rs.getString("city"), Field.Store.NO,
Field.Index.ANALYZED));
	     
	     writer.addDocument(d);
	 }

}
}
 """
and i get this message

""
symbol  : constructor
IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnalyzer,boolean)
location: class org.apache.lucene.index.IndexWriter
		   IndexWriter writer = new IndexWriter(INDEX_DIR, analyzer, true);
		                        ^
1 error

What i am doing wrong??

I'm a newbie ...

Thank U
-- 
View this message in context: http://old.nabble.com/index-a-database-tp27358959p27358959.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44740-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 20:48:00 2010
Return-Path: <java-user-return-44740-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45441 invoked from network); 28 Jan 2010 20:48:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 20:48:00 -0000
Received: (qmail 66035 invoked by uid 500); 28 Jan 2010 20:47:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65950 invoked by uid 500); 28 Jan 2010 20:47:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65936 invoked by uid 99); 28 Jan 2010 20:47:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 20:47:57 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,NORMAL_HTTP_TO_IP,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 74.125.78.24 as permitted sender)
Received: from [74.125.78.24] (HELO ey-out-2122.google.com) (74.125.78.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 20:47:48 +0000
Received: by ey-out-2122.google.com with SMTP id d26so297967eyd.3
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 12:47:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=RXimY9BQz2zKscNf8E177uUWJC7QlnCoZQpTPtuPWT4=;
        b=fdAeP6lfwu3lD3yuMxYLWtNbHlHYFKcGoqKEFUx00sKoitu0+ITQ3UEt73pkTBy4c3
         Cdy9UK8yBowC1CdpQ2UIn1+uDOsWEBDuvysiAMQ86hPk1xt8loQYSz2KawAiwfJk+axM
         bjGTHAoyCN0aoG/VTgydjIty8JXHD2y/nVRR0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=xMRNJ7ubtbW2wG1Kw5/8TQHwfhbp1Lt1oKlfyCtJzr2fZR/G/XEwEqb01auIUz9fnT
         WLtTSxgFdF3jDN426YchgUUJ6MM3EgKrIN3pcZ/IgKqN8xRcHbfHrnEqGz5DYcWaV5gi
         2MeHrH8L0k6Ry/YTfquObpyu2UtFc3EYBVfBY=
MIME-Version: 1.0
Received: by 10.216.87.81 with SMTP id x59mr3096746wee.147.1264711646740; Thu, 
	28 Jan 2010 12:47:26 -0800 (PST)
In-Reply-To: <27358959.post@talk.nabble.com>
References: <27358959.post@talk.nabble.com>
Date: Thu, 28 Jan 2010 15:47:26 -0500
Message-ID: <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com>
Subject: Re: index a database
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6dab0827282b2047e3fa0e1

--0016e6dab0827282b2047e3fa0e1
Content-Type: text/plain; charset=ISO-8859-1

What version are you using? Because there's no such constructor
(i.e. one that takes a File) in 3.0.....

You might want to use something like FSDirectory.open(file) in
your IndexWriter constructor....

If this doesn't work, more details please....

Erick

On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus <lucius.vorenus@hotmail.de>wrote:

>
> Hello
>
> I tried to index a database
>
> ""
> import org.apache.lucene.demo.FileDocument;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.analysis.Analyzer;
> import org.apache.lucene.analysis.standard.StandardAnalyzer;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.search.IndexSearcher;
> import org.apache.lucene.search.Query;
> import org.apache.lucene.queryParser.QueryParser;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.util.Version;
> import java.sql.*;
> import java.util.Properties;
> import org.apache.lucene.document.*;
> import java.io.*;
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
>
> public class Con{
>        public static void main(String[] args) throws Exception
>
>          {
>                final File INDEX_DIR = new File("index");
>
>
>                   Class.forName("com.mysql.jdbc.Driver").newInstance();
>                   Connection conn =
> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
> "passwort");
>                   StandardAnalyzer analyzer = new StandardAnalyzer(null);
>                   IndexWriter writer = new IndexWriter(INDEX_DIR, analyzer,
> true);
>                   System.out.println("Indexing to directory '" + INDEX_DIR
> + "'...");
>                   indexDocs(writer, conn);
>                   writer.optimize();
>                   writer.close();
>
>
>
>                }
>
>
> private static  void indexDocs(IndexWriter writer, Connection conn) throws
> Exception {
>          String sql = "select c_id, city from city";
>          Statement stmt = conn.createStatement();
>          ResultSet rs = stmt.executeQuery(sql);
>          while (rs.next()) {
>             Document d = new Document();
>             d.add(new Field("c_id", rs.getString("c_id"), Field.Store.YES,
> Field.Index.NO));
>             d.add(new Field("city", rs.getString("city"), Field.Store.NO,
> Field.Index.ANALYZED));
>
>             writer.addDocument(d);
>         }
>
> }
> }
>  """
> and i get this message
>
> ""
> symbol  : constructor
>
> IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnalyzer,boolean)
> location: class org.apache.lucene.index.IndexWriter
>                   IndexWriter writer = new IndexWriter(INDEX_DIR, analyzer,
> true);
>                                        ^
> 1 error
>
> What i am doing wrong??
>
> I'm a newbie ...
>
> Thank U
> --
> View this message in context:
> http://old.nabble.com/index-a-database-tp27358959p27358959.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e6dab0827282b2047e3fa0e1--

From java-user-return-44741-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 20:58:01 2010
Return-Path: <java-user-return-44741-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48070 invoked from network); 28 Jan 2010 20:58:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 20:58:01 -0000
Received: (qmail 80369 invoked by uid 500); 28 Jan 2010 20:57:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80304 invoked by uid 500); 28 Jan 2010 20:57:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80294 invoked by uid 99); 28 Jan 2010 20:57:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 20:57:58 +0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.142.207.232] (HELO web32605.mail.mud.yahoo.com) (68.142.207.232)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 28 Jan 2010 20:57:48 +0000
Received: (qmail 88598 invoked by uid 60001); 28 Jan 2010 20:57:27 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264712247; bh=ufbgZVZP7uuNJUylIJuNC8csFHuR7ay19OD96tpZAmA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=coM/e1CuV/8thgK1DDJe7wLUT5C9puMC1nQolfuGgGs2isKJiyDGo9ZLUq/9yw0zII3Ck7hB3HGlweD5IrUslsV3yeyuOR3272UdxcZpM0TR1nN4iPVMRMZUHG6Hj5crmBfXolAaByONs0AzF/MyCDE6XC1cOBVUcufhFWS8NWo=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=DB9q2TNWzgBsjC8ETTi565as5ObOXY8IGxxM4ZlGJCGKPAxiCwIOgubK5tmqKs++gXs8kA1YCkMkErMvF4u2I9zTmHr2QKbCD/SpO/r3zmmLiHeZNySaOM3R5wDihdm9kjK1YolHkPIUfhyGlBp9Wk6R8xT3dUTN1/jr307M7Og=;
Message-ID: <86280.88468.qm@web32605.mail.mud.yahoo.com>
X-YMail-OSG: EhSfoYoVM1kxOFnr8Fwx6uHD1TLAMYZXqZW4rZxvpEh.6dCmcXofV3DRQ0sJpB3Uey4PIsc60dnBV72A0ObmWwEfxdZnS4fl0XTL1_ED3f5qXiiZKWWV1N9hjy_rijEZtHFfszCl11t3I16PdpvwH6qq849vLxM06IYrpGd6dn5IAGlSYH62MEEjFfQrd7t85QTlzkmMnM2nkQ44WQb3eCBLFGuX0lhigNyA8yZbrvDGfSoGEWuyZAKfI.odjFLCXyTrEPWZz4y1ar5n09pdr7Au1aPSW0tXtxxFvpbeMRP9EPab9q_952ozfY.RVFUBq3V5Yj51UoWCUbo1Q4aCx0jqBLTmrwHS.6B_3v_UVKtL16Y8FHc.k4Y2RSM9tQlErox4PfsuZbQIa0wcBNv2WqEUPfjtgnrXPW8yZQmVhQdk0NunUWVxYBLs.5vKELrB3jrhV24xtg--
Received: from [140.244.128.12] by web32605.mail.mud.yahoo.com via HTTP; Thu, 28 Jan 2010 12:57:27 PST
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Thu, 28 Jan 2010 12:57:27 -0800 (PST)
From: Ivan Provalov <iprovalo@yahoo.com>
Subject: Re: Average Precision - TREC-3
To: java-user@lucene.apache.org
In-Reply-To: <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Great reference, Grant!  Thank you!=0A=0AOur content is very similar to TRE=
C-3 (periodicals).  In fact, there is some content overlap between our cont=
ent and TREC's (actual documents).  =0A=0AThe query types are very similar =
(ad hoc).  The cost of extracting our top queries is that we would have to =
also perform the judgments ourselves.  This could be a very time consuming =
process.=0A=0AThank you,=0A=0AIvan=0A=0A=0A=0A--- On Thu, 1/28/10, Grant In=
gersoll <gsingers@apache.org> wrote:=0A=0A> From: Grant Ingersoll <gsingers=
@apache.org>=0A> Subject: Re: Average Precision - TREC-3=0A> To: java-user@=
lucene.apache.org=0A> Date: Thursday, January 28, 2010, 9:34 AM=0A> =0A> On=
 Jan 27, 2010, at 1:36 PM, Ivan Provalov wrote:=0A> =0A> > Robert, Grant:=
=0A> > =0A> > Thank you for your replies.=A0 =0A> > =0A> > Our goal is to f=
ine-tune our existing system to=0A> perform better on relevance.=0A> =0A> W=
hat kind of documents do you have?=A0 Are they very=0A> similar to the TREC=
 docs (i.e. news articles)?=A0 There=0A> can be a fairly wide difference in=
 performance between real=0A> docs and TREC docs, especially given real que=
ries.=A0=0A> Doing well at TREC does not necessarily equate to doing well=
=0A> in your own system.=A0 You might be better off just doing=0A> somethin=
g like taking the top 50 queries from your logs plus=0A> some random ones f=
rom the tail and judging the top=0A> 10.=A0=A0=A0See http://www.lucidimagin=
ation.com/Community/Hear-from-the-Experts/Articles/Debugging-Relevance-Issu=
es-Search=0A> =0A> =0A> --------------------------=0A> Grant Ingersoll=0A> =
http://www.lucidimagination.com/=0A> =0A> Search the Lucene ecosystem using=
 Solr/Lucene: http://www.lucidimagination.com/search=0A> =0A> =0A> --------=
-------------------------------------------------------------=0A> To unsubs=
cribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A> For additional c=
ommands, e-mail: java-user-help@lucene.apache.org=0A> =0A> =0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44742-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 21:10:09 2010
Return-Path: <java-user-return-44742-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53779 invoked from network); 28 Jan 2010 21:10:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 21:10:08 -0000
Received: (qmail 9370 invoked by uid 500); 28 Jan 2010 21:10:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9297 invoked by uid 500); 28 Jan 2010 21:10:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9287 invoked by uid 99); 28 Jan 2010 21:10:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:10:06 +0000
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [68.142.207.228] (HELO web32601.mail.mud.yahoo.com) (68.142.207.228)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 28 Jan 2010 21:09:56 +0000
Received: (qmail 52014 invoked by uid 60001); 28 Jan 2010 21:09:35 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264712975; bh=0ht5oaepVLPRzTvsFSX9271K6bC/JrjEMOflU2/uw8A=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding; b=gDAu7UgUqwZm5Hj5Pgot76J+WLX+1xTmg23mabYPzkzyi961InbgyAe9aZ/j2gP9ppw6UmiSFO/XaOI7QZtnpx/dY/fisAhlQnbw+sTBmUKzsBYijYUN5k6X1VV5a1EC6IEiMhABqvPOkVlQ8NRbkatnBDbc5J2JABGr/sW1tOk=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding;
  b=Z4K3XsG40WiKousw9IhDJNFXPIlGOY+SEAqtGva4mxJOL88n4VDCvolBWu3KfF72TRyo1wjKhnhnbuKUbLtQoAuImnJQay0bCd3En4OBuv1CXz+ycB3NJim6A7ibFu5jDTsYmigXpaQjH/7VimLXcH/aNICbo30ALkoDSAX+tCI=;
Message-ID: <66685.51096.qm@web32601.mail.mud.yahoo.com>
X-YMail-OSG: eGFLgegVM1nxox8NprmEddTmvHOEZWVacOCvB21v1ioHS.rBg_wyM4gYOUQQfi3VRB9tZu28y1wH4zkch45AK2ivxwbEU3euWtl2BBOTyyi6OQbyi0DP7fTj.dkVX34w7iXtT5lh.5Y8J_43K2sLMvTixrv5SqcQnNrpb_Ey0KrLxCQ0odA_iIEVY.qz61QMTkXzl08P172raWZB22hORdhHswmFNEv6dFu_PDdZvtaJQ_OCtBFrJ3dli.hT3PWjmHUHxGkBdzen7XvBMTBaQWza4gZBF86Ov86xVj8b0W9B5uhrIrHLqtx.6OtrYYeWo029d35ipBb1v8TxpQZtUJKfonmRN7.DY1MXVRA-
Received: from [140.244.128.12] by web32601.mail.mud.yahoo.com via HTTP; Thu, 28 Jan 2010 13:09:35 PST
X-Mailer: YahooMailClassic/9.1.10 YahooMailWebService/0.8.100.260964
Date: Thu, 28 Jan 2010 13:09:35 -0800 (PST)
From: Ivan Provalov <iprovalo@yahoo.com>
Subject: Re: Average Precision - TREC-3
To: java-user@lucene.apache.org
In-Reply-To: <8f0ad1f31001280844k53ec9233u744e56919dedd4c8@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Great points, Robert!  =0A=0AI agree, we have a lot of fine tuning ahead of=
 us.  =0A=0AI think we probably have achieved the baseline with our MAP of =
0.14.  We should move on to stage two and apply some of the suggestions to =
improve the overall scores.=0A=0AThese are just the first steps.  Both you =
and Grant brought up good points on the users' information needs and the pr=
ecision/recall tuning of the system.=0A=0AThanks,=0A=0AIvan=0A=0A--- On Thu=
, 1/28/10, Robert Muir <rcmuir@gmail.com> wrote:=0A=0A> From: Robert Muir <=
rcmuir@gmail.com>=0A> Subject: Re: Average Precision - TREC-3=0A> To: java-=
user@lucene.apache.org=0A> Date: Thursday, January 28, 2010, 11:44 AM=0A> r=
ight, but the problem is when=0A> something is currently ranked as doc 20 b=
ut=0A> should be in the top 1, 5, or 10, and you aren't seeing=0A> it.=0A> =
=0A> so I think if you are judging top-N docs from an existing=0A> system, =
you should=0A> look a little farther ahead than the top-N you care about.=
=0A> I think you should also index your data a few different=0A> ways and j=
udge those=0A> top-N too, for example, use n-gram tokenizer.=0A> =0A> It do=
esn't have to be crazy like a formal trec-like pooling=0A> process, but I=
=0A> think you need to introduce enough variation that you have=0A> judgeme=
nts for=0A> docs that should be ranked higher than they currently are.=0A> =
=0A> =0A> > Perfectly reasonable as well.=A0 I've seen some=0A> people who =
only care about=0A> > P@5 and even P@1 and others who do much more.=A0=0A> =
The important thing is to=0A> > think about what makes sense for your appli=
cation and=0A> users.=A0 Much of this=0A> > can be found through basic log =
analysis (assuming an=0A> existing system) or=0A> > some reasoning about us=
e cases (new system) and users=0A> (how sophisticated=0A> > they are, etc.)=
=0A> >=0A> > -Grant=0A> >=0A> >=0A> >=0A> =0A> >=0A> ----------------------=
-----------------------------------------------=0A> > To unsubscribe, e-mai=
l: java-user-unsubscribe@lucene.apache.org=0A> > For additional commands, e=
-mail: java-user-help@lucene.apache.org=0A> >=0A> >=0A> =0A> =0A> =0A> -- =
=0A> Robert Muir=0A> rcmuir@gmail.com=0A> =0A=0A=0A      

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44743-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 21:29:18 2010
Return-Path: <java-user-return-44743-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62546 invoked from network); 28 Jan 2010 21:29:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 21:29:18 -0000
Received: (qmail 42819 invoked by uid 500); 28 Jan 2010 21:29:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42738 invoked by uid 500); 28 Jan 2010 21:29:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42728 invoked by uid 99); 28 Jan 2010 21:29:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:29:15 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [81.169.146.162] (HELO mo-p00-ob.rzone.de) (81.169.146.162)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:29:05 +0000
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; t=1264714123; l=3515;
	s=domk; d=qboad.de;
	h=In-Reply-To:Content-Transfer-Encoding:Content-Type:MIME-Version:
	Date:Subject:References:To:From:X-RZG-CLASS-ID:X-RZG-AUTH;
	bh=UuJ4ZlL1GjuTWjul+nForI4O0Hs=;
	b=AkZab38671KIK2S7uCvl7WwT4QLoqTAsTAP3VL0FXl+F3ZwCuwpNh9WWSUwybv544n5
	/XuoeYOR4hRx2pgkbxfedj0uLoIy1oHZS2Tk77PYjE+pKtZImg0G/rsw3VuZXQrqMxSA0
	fR8pgY1knauhX8LSAwsYfdK3iHcS3GM/ybE=
X-RZG-AUTH: :JWICemC5efBhIus+Y9brhO0rWemFfVqN1wGoDG990xuVMkV6NaJBng==
X-RZG-CLASS-ID: mo00
Received: from marvin (p549FA296.dip0.t-ipconnect.de [84.159.162.150])
	by post.strato.de (klopstock mo2) (RZmta 22.6)
	with ESMTP id Z00c56m0SKPGRV for <java-user@lucene.apache.org>;
	Thu, 28 Jan 2010 22:28:42 +0100 (MET)
From: "Marc Schwarz" <info@qboad.de>
To: <java-user@lucene.apache.org>
References: <27358959.post@talk.nabble.com> <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com>
Subject: AW: index a database
Date: Thu, 28 Jan 2010 22:30:57 +0100
Message-ID: <001f01caa061$2e640860$6f01a8c0@marvin>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com>
thread-index: AcqgWyzxq6Alv2RqQnisEy0Qq43b2wABdndw
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198

I had that problem yesterday... this works in my app:

Directory directory =3D new SimpleFSDirectory(new =
File("c:\\lucene\\index"));

IndexWriter w =3D new IndexWriter(directory, analyzer,true,
new IndexWriter.MaxFieldLength(25000));



-----Urspr=FCngliche Nachricht-----
Von: Erick Erickson [mailto:erickerickson@gmail.com]=20
Gesendet: Donnerstag, 28. Januar 2010 21:47
An: java-user@lucene.apache.org
Betreff: Re: index a database

What version are you using? Because there's no such constructor
(i.e. one that takes a File) in 3.0.....

You might want to use something like FSDirectory.open(file) in
your IndexWriter constructor....

If this doesn't work, more details please....

Erick

On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus
<lucius.vorenus@hotmail.de>wrote:

>
> Hello
>
> I tried to index a database
>
> ""
> import org.apache.lucene.demo.FileDocument;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.analysis.Analyzer;
> import org.apache.lucene.analysis.standard.StandardAnalyzer;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.search.IndexSearcher;
> import org.apache.lucene.search.Query;
> import org.apache.lucene.queryParser.QueryParser;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.util.Version;
> import java.sql.*;
> import java.util.Properties;
> import org.apache.lucene.document.*;
> import java.io.*;
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
>
> public class Con{
>        public static void main(String[] args) throws Exception
>
>          {
>                final File INDEX_DIR =3D new File("index");
>
>
>                   =
Class.forName("com.mysql.jdbc.Driver").newInstance();
>                   Connection conn =3D
> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
> "passwort");
>                   StandardAnalyzer analyzer =3D new =
StandardAnalyzer(null);
>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
analyzer,
> true);
>                   System.out.println("Indexing to directory '" + =
INDEX_DIR
> + "'...");
>                   indexDocs(writer, conn);
>                   writer.optimize();
>                   writer.close();
>
>
>
>                }
>
>
> private static  void indexDocs(IndexWriter writer, Connection conn) =
throws
> Exception {
>          String sql =3D "select c_id, city from city";
>          Statement stmt =3D conn.createStatement();
>          ResultSet rs =3D stmt.executeQuery(sql);
>          while (rs.next()) {
>             Document d =3D new Document();
>             d.add(new Field("c_id", rs.getString("c_id"), =
Field.Store.YES,
> Field.Index.NO));
>             d.add(new Field("city", rs.getString("city"), =
Field.Store.NO,
> Field.Index.ANALYZED));
>
>             writer.addDocument(d);
>         }
>
> }
> }
>  """
> and i get this message
>
> ""
> symbol  : constructor
>
>
IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnal=
yze
r,boolean)
> location: class org.apache.lucene.index.IndexWriter
>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
analyzer,
> true);
>                                        ^
> 1 error
>
> What i am doing wrong??
>
> I'm a newbie ...
>
> Thank U
> --
> View this message in context:
> http://old.nabble.com/index-a-database-tp27358959p27358959.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44744-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 21:46:20 2010
Return-Path: <java-user-return-44744-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73994 invoked from network); 28 Jan 2010 21:46:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 21:46:20 -0000
Received: (qmail 69088 invoked by uid 500); 28 Jan 2010 21:46:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69032 invoked by uid 500); 28 Jan 2010 21:46:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69022 invoked by uid 99); 28 Jan 2010 21:46:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:46:17 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS,WEIRD_QUOTING
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:46:07 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NacBO-0008TS-04
	for java-user@lucene.apache.org; Thu, 28 Jan 2010 13:45:46 -0800
Message-ID: <27363073.post@talk.nabble.com>
Date: Thu, 28 Jan 2010 13:45:45 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: Re: index a database
In-Reply-To: <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: lucius.vorenus@hotmail.de
References: <27358959.post@talk.nabble.com> <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


lucene 3.3

i tried liek this

""
import org.apache.lucene.demo.FileDocument;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.Query;
import org.apache.lucene.queryParser.QueryParser;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.util.Version;
import java.sql.*;
import java.util.Properties;
import org.apache.lucene.document.*;
import java.io.*;
import org.apache.lucene.store.Directory;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.store.SimpleFSDirectory;

public class Con{
	public static void main(String[] args) throws Exception

	  {
		final File INDEX_DIR = new File("index");

		
		   Class.forName("com.mysql.jdbc.Driver").newInstance();
		   Connection conn =
DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
"passwort");
		   StandardAnalyzer analyzer = new StandardAnalyzer(null);
                   Directory directory = new SimpleFSDirectory(new
File("home/lucius/Desktop/index"));
		   IndexWriter w = new IndexWriter(directory, analyzer,true, new
IndexWriter.MaxFieldLength(25000));
 
		   System.out.println("Indexing to directory '" + INDEX_DIR + "'...");
		   indexDocs(w, conn);
		   w.optimize();
		   w.close();
		

		
		}
	  

private static	void indexDocs(IndexWriter writer, Connection conn) throws
Exception {
	  String sql = "select c_id, city from city";
	  Statement stmt = conn.createStatement();
	  ResultSet rs = stmt.executeQuery(sql);
	  while (rs.next()) {
	     Document d = new Document();
	     d.add(new Field("c_id", rs.getString("c_id"), Field.Store.YES,
Field.Index.NO));
	     d.add(new Field("city", rs.getString("city"), Field.Store.NO,
Field.Index.ANALYZED));
	     
	     writer.addDocument(d);
	 }

}
}
 
	
		
""""
I ' on the right track ?

now i get this message after compiling
""
Exception in thread "main" java.lang.NullPointerException
	at
org.apache.lucene.analysis.StopFilter.getEnablePositionIncrementsVersionDefault(StopFilter.java:162)
	at
org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnalyzer.java:73)
	at
org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnalyzer.java:63)
	at Con.main(Con.java:29)
"""


once again many thanks

Erick Erickson wrote:
> 
> What version are you using? Because there's no such constructor
> (i.e. one that takes a File) in 3.0.....
> 
> You might want to use something like FSDirectory.open(file) in
> your IndexWriter constructor....
> 
> If this doesn't work, more details please....
> 
> Erick
> 
> On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus
> <lucius.vorenus@hotmail.de>wrote:
> 
>>
>> Hello
>>
>> I tried to index a database
>>
>> ""
>> import org.apache.lucene.demo.FileDocument;
>> import org.apache.lucene.document.Document;
>> import org.apache.lucene.document.Field;
>> import org.apache.lucene.analysis.Analyzer;
>> import org.apache.lucene.analysis.standard.StandardAnalyzer;
>> import org.apache.lucene.index.IndexWriter;
>> import org.apache.lucene.search.IndexSearcher;
>> import org.apache.lucene.search.Query;
>> import org.apache.lucene.queryParser.QueryParser;
>> import org.apache.lucene.store.FSDirectory;
>> import org.apache.lucene.util.Version;
>> import java.sql.*;
>> import java.util.Properties;
>> import org.apache.lucene.document.*;
>> import java.io.*;
>> import org.apache.lucene.store.Directory;
>> import org.apache.lucene.store.FSDirectory;
>>
>> public class Con{
>>        public static void main(String[] args) throws Exception
>>
>>          {
>>                final File INDEX_DIR = new File("index");
>>
>>
>>                   Class.forName("com.mysql.jdbc.Driver").newInstance();
>>                   Connection conn =
>> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
>> "passwort");
>>                   StandardAnalyzer analyzer = new StandardAnalyzer(null);
>>                   IndexWriter writer = new IndexWriter(INDEX_DIR,
>> analyzer,
>> true);
>>                   System.out.println("Indexing to directory '" +
>> INDEX_DIR
>> + "'...");
>>                   indexDocs(writer, conn);
>>                   writer.optimize();
>>                   writer.close();
>>
>>
>>
>>                }
>>
>>
>> private static  void indexDocs(IndexWriter writer, Connection conn)
>> throws
>> Exception {
>>          String sql = "select c_id, city from city";
>>          Statement stmt = conn.createStatement();
>>          ResultSet rs = stmt.executeQuery(sql);
>>          while (rs.next()) {
>>             Document d = new Document();
>>             d.add(new Field("c_id", rs.getString("c_id"),
>> Field.Store.YES,
>> Field.Index.NO));
>>             d.add(new Field("city", rs.getString("city"), Field.Store.NO,
>> Field.Index.ANALYZED));
>>
>>             writer.addDocument(d);
>>         }
>>
>> }
>> }
>>  """
>> and i get this message
>>
>> ""
>> symbol  : constructor
>>
>> IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnalyzer,boolean)
>> location: class org.apache.lucene.index.IndexWriter
>>                   IndexWriter writer = new IndexWriter(INDEX_DIR,
>> analyzer,
>> true);
>>                                        ^
>> 1 error
>>
>> What i am doing wrong??
>>
>> I'm a newbie ...
>>
>> Thank U
>> --
>> View this message in context:
>> http://old.nabble.com/index-a-database-tp27358959p27358959.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://old.nabble.com/index-a--mysql-database-tp27358959p27363073.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44745-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 21:54:45 2010
Return-Path: <java-user-return-44745-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77841 invoked from network); 28 Jan 2010 21:54:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 21:54:45 -0000
Received: (qmail 84484 invoked by uid 500); 28 Jan 2010 21:54:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84411 invoked by uid 500); 28 Jan 2010 21:54:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84401 invoked by uid 99); 28 Jan 2010 21:54:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:54:42 +0000
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=SPF_NEUTRAL,WEIRD_QUOTING
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [81.169.146.160] (HELO mo-p00-ob.rzone.de) (81.169.146.160)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:54:33 +0000
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; t=1264715651; l=6469;
	s=domk; d=qboad.de;
	h=In-Reply-To:Content-Transfer-Encoding:Content-Type:MIME-Version:
	Date:Subject:References:To:From:X-RZG-CLASS-ID:X-RZG-AUTH;
	bh=N0wmg14o7u4PqU2FJSg3T3kJqSg=;
	b=W/7CjmBoapwG3BxRLLtSkskmgnutOjKC+g13PMyCLLUpQPt98soe8P+DozBOOXBsQG1
	YRXAaCrFV9/BwJFE28boiV2NvAH96C5MBu022OeplwgSXtZrEysL/zfWRSUmVAa7xtOlP
	gNOHlCMJeA4JeSeu27jMXlIiviHkqoHguwk=
X-RZG-AUTH: :JWICemC5efBhIus+Y9brhO0rWemFfVqN1wGoDG990xuVMkV6NaJBng==
X-RZG-CLASS-ID: mo00
Received: from marvin (p549FA296.dip0.t-ipconnect.de [84.159.162.150])
	by post.strato.de (mrclete mo61) (RZmta 22.6)
	with ESMTP id o05db1m0SIv1rL for <java-user@lucene.apache.org>;
	Thu, 28 Jan 2010 22:54:09 +0100 (MET)
From: "Marc Schwarz" <info@qboad.de>
To: <java-user@lucene.apache.org>
References: <27358959.post@talk.nabble.com> <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com> <27363073.post@talk.nabble.com>
Subject: AW: index a database
Date: Thu, 28 Jan 2010 22:56:24 +0100
Message-ID: <002001caa064$bd2d8050$6f01a8c0@marvin>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <27363073.post@talk.nabble.com>
thread-index: AcqgY1O0Ky3HpMXKSEG7JWzAcymoeAAAUxAQ
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198

StandardAnalyzer analyzer =3D new =
StandardAnalyzer(Version.LUCENE_CURRENT);

any difference with that ?

-----Urspr=FCngliche Nachricht-----
Von: luciusvorenus [mailto:lucius.vorenus@hotmail.de]=20
Gesendet: Donnerstag, 28. Januar 2010 22:46
An: java-user@lucene.apache.org
Betreff: Re: index a database


lucene 3.3

i tried liek this

""
import org.apache.lucene.demo.FileDocument;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.Query;
import org.apache.lucene.queryParser.QueryParser;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.util.Version;
import java.sql.*;
import java.util.Properties;
import org.apache.lucene.document.*;
import java.io.*;
import org.apache.lucene.store.Directory;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.store.SimpleFSDirectory;

public class Con{
	public static void main(String[] args) throws Exception

	  {
		final File INDEX_DIR =3D new File("index");

	=09
		   Class.forName("com.mysql.jdbc.Driver").newInstance();
		   Connection conn =3D
DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
"passwort");
		   StandardAnalyzer analyzer =3D new StandardAnalyzer(null);
                   Directory directory =3D new SimpleFSDirectory(new
File("home/lucius/Desktop/index"));
		   IndexWriter w =3D new IndexWriter(directory, analyzer,true,
new
IndexWriter.MaxFieldLength(25000));
=20
		   System.out.println("Indexing to directory '" + INDEX_DIR
+ "'...");
		   indexDocs(w, conn);
		   w.optimize();
		   w.close();
	=09

	=09
		}
	 =20

private static	void indexDocs(IndexWriter writer, Connection conn) =
throws
Exception {
	  String sql =3D "select c_id, city from city";
	  Statement stmt =3D conn.createStatement();
	  ResultSet rs =3D stmt.executeQuery(sql);
	  while (rs.next()) {
	     Document d =3D new Document();
	     d.add(new Field("c_id", rs.getString("c_id"), Field.Store.YES,
Field.Index.NO));
	     d.add(new Field("city", rs.getString("city"), Field.Store.NO,
Field.Index.ANALYZED));
	    =20
	     writer.addDocument(d);
	 }

}
}
=20
=09
	=09
""""
I ' on the right track ?

now i get this message after compiling
""
Exception in thread "main" java.lang.NullPointerException
	at
org.apache.lucene.analysis.StopFilter.getEnablePositionIncrementsVersionD=
efa
ult(StopFilter.java:162)
	at
org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer
.java:73)
	at
org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer
.java:63)
	at Con.main(Con.java:29)
"""


once again many thanks

Erick Erickson wrote:
>=20
> What version are you using? Because there's no such constructor
> (i.e. one that takes a File) in 3.0.....
>=20
> You might want to use something like FSDirectory.open(file) in
> your IndexWriter constructor....
>=20
> If this doesn't work, more details please....
>=20
> Erick
>=20
> On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus
> <lucius.vorenus@hotmail.de>wrote:
>=20
>>
>> Hello
>>
>> I tried to index a database
>>
>> ""
>> import org.apache.lucene.demo.FileDocument;
>> import org.apache.lucene.document.Document;
>> import org.apache.lucene.document.Field;
>> import org.apache.lucene.analysis.Analyzer;
>> import org.apache.lucene.analysis.standard.StandardAnalyzer;
>> import org.apache.lucene.index.IndexWriter;
>> import org.apache.lucene.search.IndexSearcher;
>> import org.apache.lucene.search.Query;
>> import org.apache.lucene.queryParser.QueryParser;
>> import org.apache.lucene.store.FSDirectory;
>> import org.apache.lucene.util.Version;
>> import java.sql.*;
>> import java.util.Properties;
>> import org.apache.lucene.document.*;
>> import java.io.*;
>> import org.apache.lucene.store.Directory;
>> import org.apache.lucene.store.FSDirectory;
>>
>> public class Con{
>>        public static void main(String[] args) throws Exception
>>
>>          {
>>                final File INDEX_DIR =3D new File("index");
>>
>>
>>                   =
Class.forName("com.mysql.jdbc.Driver").newInstance();
>>                   Connection conn =3D
>> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
>> "passwort");
>>                   StandardAnalyzer analyzer =3D new =
StandardAnalyzer(null);
>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>> analyzer,
>> true);
>>                   System.out.println("Indexing to directory '" +
>> INDEX_DIR
>> + "'...");
>>                   indexDocs(writer, conn);
>>                   writer.optimize();
>>                   writer.close();
>>
>>
>>
>>                }
>>
>>
>> private static  void indexDocs(IndexWriter writer, Connection conn)
>> throws
>> Exception {
>>          String sql =3D "select c_id, city from city";
>>          Statement stmt =3D conn.createStatement();
>>          ResultSet rs =3D stmt.executeQuery(sql);
>>          while (rs.next()) {
>>             Document d =3D new Document();
>>             d.add(new Field("c_id", rs.getString("c_id"),
>> Field.Store.YES,
>> Field.Index.NO));
>>             d.add(new Field("city", rs.getString("city"), =
Field.Store.NO,
>> Field.Index.ANALYZED));
>>
>>             writer.addDocument(d);
>>         }
>>
>> }
>> }
>>  """
>> and i get this message
>>
>> ""
>> symbol  : constructor
>>
>>
IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnal=
yze
r,boolean)
>> location: class org.apache.lucene.index.IndexWriter
>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>> analyzer,
>> true);
>>                                        ^
>> 1 error
>>
>> What i am doing wrong??
>>
>> I'm a newbie ...
>>
>> Thank U
>> --
>> View this message in context:
>> http://old.nabble.com/index-a-database-tp27358959p27358959.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
>=20

--=20
View this message in context:
http://old.nabble.com/index-a--mysql-database-tp27358959p27363073.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44746-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 21:55:07 2010
Return-Path: <java-user-return-44746-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78096 invoked from network); 28 Jan 2010 21:55:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 21:55:07 -0000
Received: (qmail 86413 invoked by uid 500); 28 Jan 2010 21:55:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86362 invoked by uid 500); 28 Jan 2010 21:55:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86352 invoked by uid 99); 28 Jan 2010 21:55:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:55:05 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 21:54:54 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NacJt-0000gO-QC
	for java-user@lucene.apache.org; Thu, 28 Jan 2010 13:54:33 -0800
Message-ID: <27363463.post@talk.nabble.com>
Date: Thu, 28 Jan 2010 13:54:33 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: Re: AW: index a database
In-Reply-To: <001f01caa061$2e640860$6f01a8c0@marvin>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: lucius.vorenus@hotmail.de
References: <27358959.post@talk.nabble.com> <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com> <001f01caa061$2e640860$6f01a8c0@marvin>
X-Virus-Checked: Checked by ClamAV on apache.org



""

Exception in thread "main" java.lang.NullPointerException
=09at
org.apache.lucene.analysis.StopFilter.getEnablePositionIncrementsVersionDef=
ault(StopFilter.java:162)
=09at
org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnalyze=
r.java:73)
=09at
org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnalyze=
r.java:63)
=09at Con.main(Con.java:29)

"""
did you get  also this message  after the compilation?


br



Marc Schwarz wrote:
>=20
> I had that problem yesterday... this works in my app:
>=20
> Directory directory =3D new SimpleFSDirectory(new
> File("c:\\lucene\\index"));
>=20
> IndexWriter w =3D new IndexWriter(directory, analyzer,true,
> new IndexWriter.MaxFieldLength(25000));
>=20
>=20
>=20
> -----Urspr=C3=BCngliche Nachricht-----
> Von: Erick Erickson [mailto:erickerickson@gmail.com]=20
> Gesendet: Donnerstag, 28. Januar 2010 21:47
> An: java-user@lucene.apache.org
> Betreff: Re: index a database
>=20
> What version are you using? Because there's no such constructor
> (i.e. one that takes a File) in 3.0.....
>=20
> You might want to use something like FSDirectory.open(file) in
> your IndexWriter constructor....
>=20
> If this doesn't work, more details please....
>=20
> Erick
>=20
> On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus
> <lucius.vorenus@hotmail.de>wrote:
>=20
>>
>> Hello
>>
>> I tried to index a database
>>
>> ""
>> import org.apache.lucene.demo.FileDocument;
>> import org.apache.lucene.document.Document;
>> import org.apache.lucene.document.Field;
>> import org.apache.lucene.analysis.Analyzer;
>> import org.apache.lucene.analysis.standard.StandardAnalyzer;
>> import org.apache.lucene.index.IndexWriter;
>> import org.apache.lucene.search.IndexSearcher;
>> import org.apache.lucene.search.Query;
>> import org.apache.lucene.queryParser.QueryParser;
>> import org.apache.lucene.store.FSDirectory;
>> import org.apache.lucene.util.Version;
>> import java.sql.*;
>> import java.util.Properties;
>> import org.apache.lucene.document.*;
>> import java.io.*;
>> import org.apache.lucene.store.Directory;
>> import org.apache.lucene.store.FSDirectory;
>>
>> public class Con{
>>        public static void main(String[] args) throws Exception
>>
>>          {
>>                final File INDEX_DIR =3D new File("index");
>>
>>
>>                   Class.forName("com.mysql.jdbc.Driver").newInstance();
>>                   Connection conn =3D
>> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
>> "passwort");
>>                   StandardAnalyzer analyzer =3D new StandardAnalyzer(nul=
l);
>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
> analyzer,
>> true);
>>                   System.out.println("Indexing to directory '" +
>> INDEX_DIR
>> + "'...");
>>                   indexDocs(writer, conn);
>>                   writer.optimize();
>>                   writer.close();
>>
>>
>>
>>                }
>>
>>
>> private static  void indexDocs(IndexWriter writer, Connection conn)
>> throws
>> Exception {
>>          String sql =3D "select c_id, city from city";
>>          Statement stmt =3D conn.createStatement();
>>          ResultSet rs =3D stmt.executeQuery(sql);
>>          while (rs.next()) {
>>             Document d =3D new Document();
>>             d.add(new Field("c_id", rs.getString("c_id"),
>> Field.Store.YES,
>> Field.Index.NO));
>>             d.add(new Field("city", rs.getString("city"), Field.Store.NO=
,
>> Field.Index.ANALYZED));
>>
>>             writer.addDocument(d);
>>         }
>>
>> }
>> }
>>  """
>> and i get this message
>>
>> ""
>> symbol  : constructor
>>
>>
> IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnal=
yze
> r,boolean)
>> location: class org.apache.lucene.index.IndexWriter
>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
> analyzer,
>> true);
>>                                        ^
>> 1 error
>>
>> What i am doing wrong??
>>
>> I'm a newbie ...
>>
>> Thank U
>> --
>> View this message in context:
>> http://old.nabble.com/index-a-database-tp27358959p27358959.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/index-a--mysql-database=
-tp27358959p27363463.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44747-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 22:02:44 2010
Return-Path: <java-user-return-44747-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82682 invoked from network); 28 Jan 2010 22:02:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 22:02:44 -0000
Received: (qmail 3794 invoked by uid 500); 28 Jan 2010 22:02:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3744 invoked by uid 500); 28 Jan 2010 22:02:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3711 invoked by uid 99); 28 Jan 2010 22:02:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 22:02:38 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS,WEIRD_QUOTING
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 22:02:29 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NacRF-0001Zb-5G
	for java-user@lucene.apache.org; Thu, 28 Jan 2010 14:02:09 -0800
Message-ID: <27363752.post@talk.nabble.com>
Date: Thu, 28 Jan 2010 14:02:09 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: Re: AW: index a database
In-Reply-To: <002001caa064$bd2d8050$6f01a8c0@marvin>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: lucius.vorenus@hotmail.de
References: <27358959.post@talk.nabble.com> <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com> <27363073.post@talk.nabble.com> <002001caa064$bd2d8050$6f01a8c0@marvin>


yes.... many thanks ..
 But .... /.../my index folder is empty. Have I done something wrong in
"private static void indexDocs"? It is not indexed




Marc Schwarz wrote:
>=20
> StandardAnalyzer analyzer =3D new StandardAnalyzer(Version.LUCENE_CURRENT=
);
>=20
> any difference with that ?
>=20
> -----Urspr=C3=BCngliche Nachricht-----
> Von: luciusvorenus [mailto:lucius.vorenus@hotmail.de]=20
> Gesendet: Donnerstag, 28. Januar 2010 22:46
> An: java-user@lucene.apache.org
> Betreff: Re: index a database
>=20
>=20
> lucene 3.3
>=20
> i tried liek this
>=20
> ""
> import org.apache.lucene.demo.FileDocument;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.analysis.Analyzer;
> import org.apache.lucene.analysis.standard.StandardAnalyzer;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.search.IndexSearcher;
> import org.apache.lucene.search.Query;
> import org.apache.lucene.queryParser.QueryParser;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.util.Version;
> import java.sql.*;
> import java.util.Properties;
> import org.apache.lucene.document.*;
> import java.io.*;
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.store.SimpleFSDirectory;
>=20
> public class Con{
> =09public static void main(String[] args) throws Exception
>=20
> =09  {
> =09=09final File INDEX_DIR =3D new File("index");
>=20
> =09=09
> =09=09   Class.forName("com.mysql.jdbc.Driver").newInstance();
> =09=09   Connection conn =3D
> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
> "passwort");
> =09=09   StandardAnalyzer analyzer =3D new StandardAnalyzer(null);
>                    Directory directory =3D new SimpleFSDirectory(new
> File("home/lucius/Desktop/index"));
> =09=09   IndexWriter w =3D new IndexWriter(directory, analyzer,true,
> new
> IndexWriter.MaxFieldLength(25000));
> =20
> =09=09   System.out.println("Indexing to directory '" + INDEX_DIR
> + "'...");
> =09=09   indexDocs(w, conn);
> =09=09   w.optimize();
> =09=09   w.close();
> =09=09
>=20
> =09=09
> =09=09}
> =09 =20
>=20
> private static=09void indexDocs(IndexWriter writer, Connection conn) thro=
ws
> Exception {
> =09  String sql =3D "select c_id, city from city";
> =09  Statement stmt =3D conn.createStatement();
> =09  ResultSet rs =3D stmt.executeQuery(sql);
> =09  while (rs.next()) {
> =09     Document d =3D new Document();
> =09     d.add(new Field("c_id", rs.getString("c_id"), Field.Store.YES,
> Field.Index.NO));
> =09     d.add(new Field("city", rs.getString("city"), Field.Store.NO,
> Field.Index.ANALYZED));
> =09    =20
> =09     writer.addDocument(d);
> =09 }
>=20
> }
> }
> =20
> =09
> =09=09
> """"
> I ' on the right track ?
>=20
> now i get this message after compiling
> ""
> Exception in thread "main" java.lang.NullPointerException
> =09at
> org.apache.lucene.analysis.StopFilter.getEnablePositionIncrementsVersionD=
efa
> ult(StopFilter.java:162)
> =09at
> org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer
> .java:73)
> =09at
> org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer
> .java:63)
> =09at Con.main(Con.java:29)
> """
>=20
>=20
> once again many thanks
>=20
> Erick Erickson wrote:
>>=20
>> What version are you using? Because there's no such constructor
>> (i.e. one that takes a File) in 3.0.....
>>=20
>> You might want to use something like FSDirectory.open(file) in
>> your IndexWriter constructor....
>>=20
>> If this doesn't work, more details please....
>>=20
>> Erick
>>=20
>> On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus
>> <lucius.vorenus@hotmail.de>wrote:
>>=20
>>>
>>> Hello
>>>
>>> I tried to index a database
>>>
>>> ""
>>> import org.apache.lucene.demo.FileDocument;
>>> import org.apache.lucene.document.Document;
>>> import org.apache.lucene.document.Field;
>>> import org.apache.lucene.analysis.Analyzer;
>>> import org.apache.lucene.analysis.standard.StandardAnalyzer;
>>> import org.apache.lucene.index.IndexWriter;
>>> import org.apache.lucene.search.IndexSearcher;
>>> import org.apache.lucene.search.Query;
>>> import org.apache.lucene.queryParser.QueryParser;
>>> import org.apache.lucene.store.FSDirectory;
>>> import org.apache.lucene.util.Version;
>>> import java.sql.*;
>>> import java.util.Properties;
>>> import org.apache.lucene.document.*;
>>> import java.io.*;
>>> import org.apache.lucene.store.Directory;
>>> import org.apache.lucene.store.FSDirectory;
>>>
>>> public class Con{
>>>        public static void main(String[] args) throws Exception
>>>
>>>          {
>>>                final File INDEX_DIR =3D new File("index");
>>>
>>>
>>>                   Class.forName("com.mysql.jdbc.Driver").newInstance();
>>>                   Connection conn =3D
>>> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
>>> "passwort");
>>>                   StandardAnalyzer analyzer =3D new
>>> StandardAnalyzer(null);
>>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>>> analyzer,
>>> true);
>>>                   System.out.println("Indexing to directory '" +
>>> INDEX_DIR
>>> + "'...");
>>>                   indexDocs(writer, conn);
>>>                   writer.optimize();
>>>                   writer.close();
>>>
>>>
>>>
>>>                }
>>>
>>>
>>> private static  void indexDocs(IndexWriter writer, Connection conn)
>>> throws
>>> Exception {
>>>          String sql =3D "select c_id, city from city";
>>>          Statement stmt =3D conn.createStatement();
>>>          ResultSet rs =3D stmt.executeQuery(sql);
>>>          while (rs.next()) {
>>>             Document d =3D new Document();
>>>             d.add(new Field("c_id", rs.getString("c_id"),
>>> Field.Store.YES,
>>> Field.Index.NO));
>>>             d.add(new Field("city", rs.getString("city"),
>>> Field.Store.NO,
>>> Field.Index.ANALYZED));
>>>
>>>             writer.addDocument(d);
>>>         }
>>>
>>> }
>>> }
>>>  """
>>> and i get this message
>>>
>>> ""
>>> symbol  : constructor
>>>
>>>
> IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnal=
yze
> r,boolean)
>>> location: class org.apache.lucene.index.IndexWriter
>>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>>> analyzer,
>>> true);
>>>                                        ^
>>> 1 error
>>>
>>> What i am doing wrong??
>>>
>>> I'm a newbie ...
>>>
>>> Thank U
>>> --
>>> View this message in context:
>>> http://old.nabble.com/index-a-database-tp27358959p27358959.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>=20
>>=20
>=20
> --=20
> View this message in context:
> http://old.nabble.com/index-a--mysql-database-tp27358959p27363073.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/index-a--mysql-database=
-tp27358959p27363752.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44748-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Jan 28 22:17:28 2010
Return-Path: <java-user-return-44748-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92237 invoked from network); 28 Jan 2010 22:17:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 28 Jan 2010 22:17:28 -0000
Received: (qmail 37866 invoked by uid 500); 28 Jan 2010 22:17:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37790 invoked by uid 500); 28 Jan 2010 22:17:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37780 invoked by uid 99); 28 Jan 2010 22:17:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 22:17:25 +0000
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=SPF_NEUTRAL,WEIRD_QUOTING
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [81.169.146.161] (HELO mo-p00-ob.rzone.de) (81.169.146.161)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 28 Jan 2010 22:17:16 +0000
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; t=1264717014; l=8454;
	s=domk; d=qboad.de;
	h=In-Reply-To:Content-Transfer-Encoding:Content-Type:MIME-Version:
	Date:Subject:References:To:From:X-RZG-CLASS-ID:X-RZG-AUTH;
	bh=PirwU0DpgKEJGzvYOsJHbjtyiFg=;
	b=iECEwLwukpbwHs8BozlrbZrxRnvUOLkV60NPMGvw195w4OvldTOnY1bvR5Q9ozOnVio
	7JnVdlE1joIgjsxxkS8CYkJ4qmwU+2IIDG/Vhc5JyTitk6BXU35zZah280zIWPOZ3dnWB
	nvFAZXQ533mrEP1r+oD/hINKWM4CSOMCjcE=
X-RZG-AUTH: :JWICemC5efBhIus+Y9brhO0rWemFfVqN1wGoDG990xuVMkV6NaJBng==
X-RZG-CLASS-ID: mo00
Received: from marvin (p549FA296.dip0.t-ipconnect.de [84.159.162.150])
	by post.strato.de (klopstock mo47) (RZmta 22.6)
	with ESMTP id K024b2m0SKh5we for <java-user@lucene.apache.org>;
	Thu, 28 Jan 2010 23:16:53 +0100 (MET)
From: "Marc Schwarz" <info@qboad.de>
To: <java-user@lucene.apache.org>
References: <27358959.post@talk.nabble.com> <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com> <27363073.post@talk.nabble.com> <002001caa064$bd2d8050$6f01a8c0@marvin> <27363752.post@talk.nabble.com>
Subject: AW: AW: index a database
Date: Thu, 28 Jan 2010 23:19:08 +0100
Message-ID: <002101caa067$e99915c0$6f01a8c0@marvin>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <27363752.post@talk.nabble.com>
thread-index: AcqgZZ42ypEHR3deTgOBWApb/spd2AAAeoZg
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198

Maybe you should seperate the add method from the database function...

Separate the db loop something like that:

try
           {
            ResultSet rs2 =3D stm.executeQuery(sql);
            while(rs2.next()) {
                String text =3D rs2.getString("textvalue");
                addDoc(w, text,rs2.getString("id"));
                count_ds++;
            }


and then the addDoc seems something like that:


private static void addDoc(IndexWriter w, String value,String empty) =
throws
IOException {
    Document doc =3D new Document();
    doc.add(new Field("title", value, Field.Store.YES,
Field.Index.ANALYZED));
    w.addDocument(doc);
  }


-----Urspr=FCngliche Nachricht-----
Von: luciusvorenus [mailto:lucius.vorenus@hotmail.de]=20
Gesendet: Donnerstag, 28. Januar 2010 23:02
An: java-user@lucene.apache.org
Betreff: Re: AW: index a database


yes.... many thanks ..
 But .... /.../my index folder is empty. Have I done something wrong in
"private static void indexDocs"? It is not indexed




Marc Schwarz wrote:
>=20
> StandardAnalyzer analyzer =3D new =
StandardAnalyzer(Version.LUCENE_CURRENT);
>=20
> any difference with that ?
>=20
> -----Urspr=FCngliche Nachricht-----
> Von: luciusvorenus [mailto:lucius.vorenus@hotmail.de]=20
> Gesendet: Donnerstag, 28. Januar 2010 22:46
> An: java-user@lucene.apache.org
> Betreff: Re: index a database
>=20
>=20
> lucene 3.3
>=20
> i tried liek this
>=20
> ""
> import org.apache.lucene.demo.FileDocument;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.analysis.Analyzer;
> import org.apache.lucene.analysis.standard.StandardAnalyzer;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.search.IndexSearcher;
> import org.apache.lucene.search.Query;
> import org.apache.lucene.queryParser.QueryParser;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.util.Version;
> import java.sql.*;
> import java.util.Properties;
> import org.apache.lucene.document.*;
> import java.io.*;
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.store.SimpleFSDirectory;
>=20
> public class Con{
> 	public static void main(String[] args) throws Exception
>=20
> 	  {
> 		final File INDEX_DIR =3D new File("index");
>=20
> 	=09
> 		   Class.forName("com.mysql.jdbc.Driver").newInstance();
> 		   Connection conn =3D
> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
> "passwort");
> 		   StandardAnalyzer analyzer =3D new StandardAnalyzer(null);
>                    Directory directory =3D new SimpleFSDirectory(new
> File("home/lucius/Desktop/index"));
> 		   IndexWriter w =3D new IndexWriter(directory, analyzer,true,
> new
> IndexWriter.MaxFieldLength(25000));
> =20
> 		   System.out.println("Indexing to directory '" + INDEX_DIR
> + "'...");
> 		   indexDocs(w, conn);
> 		   w.optimize();
> 		   w.close();
> 	=09
>=20
> 	=09
> 		}
> 	 =20
>=20
> private static	void indexDocs(IndexWriter writer, Connection conn)
throws
> Exception {
> 	  String sql =3D "select c_id, city from city";
> 	  Statement stmt =3D conn.createStatement();
> 	  ResultSet rs =3D stmt.executeQuery(sql);
> 	  while (rs.next()) {
> 	     Document d =3D new Document();
> 	     d.add(new Field("c_id", rs.getString("c_id"), Field.Store.YES,
> Field.Index.NO));
> 	     d.add(new Field("city", rs.getString("city"), Field.Store.NO,
> Field.Index.ANALYZED));
> 	    =20
> 	     writer.addDocument(d);
> 	 }
>=20
> }
> }
> =20
> =09
> 	=09
> """"
> I ' on the right track ?
>=20
> now i get this message after compiling
> ""
> Exception in thread "main" java.lang.NullPointerException
> 	at
>
org.apache.lucene.analysis.StopFilter.getEnablePositionIncrementsVersionD=
efa
> ult(StopFilter.java:162)
> 	at
>
org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer
> .java:73)
> 	at
>
org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer
> .java:63)
> 	at Con.main(Con.java:29)
> """
>=20
>=20
> once again many thanks
>=20
> Erick Erickson wrote:
>>=20
>> What version are you using? Because there's no such constructor
>> (i.e. one that takes a File) in 3.0.....
>>=20
>> You might want to use something like FSDirectory.open(file) in
>> your IndexWriter constructor....
>>=20
>> If this doesn't work, more details please....
>>=20
>> Erick
>>=20
>> On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus
>> <lucius.vorenus@hotmail.de>wrote:
>>=20
>>>
>>> Hello
>>>
>>> I tried to index a database
>>>
>>> ""
>>> import org.apache.lucene.demo.FileDocument;
>>> import org.apache.lucene.document.Document;
>>> import org.apache.lucene.document.Field;
>>> import org.apache.lucene.analysis.Analyzer;
>>> import org.apache.lucene.analysis.standard.StandardAnalyzer;
>>> import org.apache.lucene.index.IndexWriter;
>>> import org.apache.lucene.search.IndexSearcher;
>>> import org.apache.lucene.search.Query;
>>> import org.apache.lucene.queryParser.QueryParser;
>>> import org.apache.lucene.store.FSDirectory;
>>> import org.apache.lucene.util.Version;
>>> import java.sql.*;
>>> import java.util.Properties;
>>> import org.apache.lucene.document.*;
>>> import java.io.*;
>>> import org.apache.lucene.store.Directory;
>>> import org.apache.lucene.store.FSDirectory;
>>>
>>> public class Con{
>>>        public static void main(String[] args) throws Exception
>>>
>>>          {
>>>                final File INDEX_DIR =3D new File("index");
>>>
>>>
>>>                   =
Class.forName("com.mysql.jdbc.Driver").newInstance();
>>>                   Connection conn =3D
>>> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
>>> "passwort");
>>>                   StandardAnalyzer analyzer =3D new
>>> StandardAnalyzer(null);
>>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>>> analyzer,
>>> true);
>>>                   System.out.println("Indexing to directory '" +
>>> INDEX_DIR
>>> + "'...");
>>>                   indexDocs(writer, conn);
>>>                   writer.optimize();
>>>                   writer.close();
>>>
>>>
>>>
>>>                }
>>>
>>>
>>> private static  void indexDocs(IndexWriter writer, Connection conn)
>>> throws
>>> Exception {
>>>          String sql =3D "select c_id, city from city";
>>>          Statement stmt =3D conn.createStatement();
>>>          ResultSet rs =3D stmt.executeQuery(sql);
>>>          while (rs.next()) {
>>>             Document d =3D new Document();
>>>             d.add(new Field("c_id", rs.getString("c_id"),
>>> Field.Store.YES,
>>> Field.Index.NO));
>>>             d.add(new Field("city", rs.getString("city"),
>>> Field.Store.NO,
>>> Field.Index.ANALYZED));
>>>
>>>             writer.addDocument(d);
>>>         }
>>>
>>> }
>>> }
>>>  """
>>> and i get this message
>>>
>>> ""
>>> symbol  : constructor
>>>
>>>
>
IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnal=
yze
> r,boolean)
>>> location: class org.apache.lucene.index.IndexWriter
>>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>>> analyzer,
>>> true);
>>>                                        ^
>>> 1 error
>>>
>>> What i am doing wrong??
>>>
>>> I'm a newbie ...
>>>
>>> Thank U
>>> --
>>> View this message in context:
>>> http://old.nabble.com/index-a-database-tp27358959p27358959.html
>>> Sent from the Lucene - Java Users mailing list archive at =
Nabble.com.
>>>
>>>
>>> =
---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>=20
>>=20
>=20
> --=20
> View this message in context:
> http://old.nabble.com/index-a--mysql-database-tp27358959p27363073.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context:
http://old.nabble.com/index-a--mysql-database-tp27358959p27363752.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44749-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 01:16:01 2010
Return-Path: <java-user-return-44749-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49307 invoked from network); 29 Jan 2010 01:16:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 01:16:01 -0000
Received: (qmail 32654 invoked by uid 500); 29 Jan 2010 01:15:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32592 invoked by uid 500); 29 Jan 2010 01:15:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32582 invoked by uid 99); 29 Jan 2010 01:15:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 01:15:58 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Kuro@basistech.com designates 199.88.205.136 as permitted sender)
Received: from [199.88.205.136] (HELO mailer.basistech.com) (199.88.205.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 01:15:49 +0000
Received: from mail.basistech.com (internal.basistech.net [10.1.250.1])
	by mailer.basistech.com (Postfix) with ESMTP id D2E75368C3
	for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 20:15:27 -0500 (EST)
X-DKIM: Sendmail DKIM Filter v2.8.3 mailer.basistech.com D2E75368C3
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=basistech.com;
	s=basis09aug; t=1264727727;
	bh=dGZm9vJrSsOQPXAMcm4H7my/iClUAj1FIrBEF8bZ4gc=;
	h=From:To:Date:Subject:Message-ID:Content-Type:
	 Content-Transfer-Encoding:MIME-Version;
	b=jyCUOz54ANckPvDHZrHnhykdAbGN/JIToG+7GgzZkEnvBOpwi+BdjBJXMzy/wpneW
	 ThVZCOq8oiGZzXKBLKa03cVdpuGYEHdB3sEUIKOFHw1McjOK9DgxEkk3KgZZ9Al22t
	 HmAEqWiujFVaQqhW0pondinsovm8eYtm6MHpgpEc=
Received: from MSG-BOX.basistech.net ([::1]) by MSG-BOX.basistech.net ([::1])
 with mapi; Thu, 28 Jan 2010 20:15:27 -0500
From: Teruhiko Kurosaka <Kuro@basistech.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 28 Jan 2010 20:15:26 -0500
Subject: index demo throws LockObtainFailedException
Thread-Topic: index demo throws LockObtainFailedException
Thread-Index: AcqggIoqSHxB1+7DQbOBoSnocGRpwQ==
Message-ID: <CAE8639A6FAB3D4AA7973D5897B325185F4CB7E1F7@MSG-BOX.basistech.net>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

We have many Linux machines of different brands, sharing the same NFS files=
ystem
for home.  The Lucene file indexing demo program is failing with LockObainF=
ailedException=20
only on one particular Linux machine (Fedora Core 4, x86).  I am including
the console output at the bottom of this message.

I tried Lucene 2.9.0, 2.9.1 and 3.0.0, and the result is identical.

After searching the Internet, I saw some postings suggesting that this happ=
ens
when the disk space is low. But there seem to be more than enough for this
small demo.  I didn't understand suggestions about lockd.  I'd appreciate
for any advices on how to find the cause of this Exception.=20

Thank you in advance.

T. "Kuro" Kurosaka

-bash-3.00$ cd lucene-3.0.0/
-bash-3.00$ ant demo-index-text
Buildfile: build.xml

jar.core-check:

compile-demo:
    [mkdir] Created dir: /basis/users/kuro/opt/lucene-3.0.0/build/classes/d=
emo
    [javac] Compiling 17 source files to /basis/users/kuro/opt/lucene-3.0.0=
/build/classes/demo

jar-demo:
      [jar] Building jar: /basis/users/kuro/opt/lucene-3.0.0/lucene-demos-3=
.0.0.jar

demo-index-text:
     [echo] ----- (1) Prepare dir -----
     [echo] cd /basis/users/kuro/opt/lucene-3.0.0
     [echo] rmdir demo-text-dir
     [echo] mkdir demo-text-dir
    [mkdir] Created dir: /basis/users/kuro/opt/lucene-3.0.0/demo-text-dir
     [echo] cd demo-text-dir
     [echo] ----- (2) Index the files located under /basis/users/kuro/opt/l=
ucene-3.0.0/src -----
     [echo] java -classpath "../lucene-core-3.0.0.jar;../lucene-demos-3.0.0=
.jar" org.apache.lucene.demo.IndexFiles ../src/demo
     [java]  caught a class org.apache.lucene.store.LockObtainFailedExcepti=
on
     [java]  with message: Lock obtain timed out: NativeFSLock@/basis/users=
/kuro/opt/lucene-3.0.0/demo-text-dir/index/write.lock: java.io.IOException:=
 Input/output error

BUILD SUCCESSFUL
Total time: 6 seconds
-bash-3.00$ df -k . /tmp
Filesystem           1K-blocks      Used Available Use% Mounted on
storev:/vol/exports/users
                     3119362560 2790661520 328701040  90% /basis/users
/dev/sda2              9718360   7700764   1515968  84% /

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44750-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 02:39:40 2010
Return-Path: <java-user-return-44750-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82112 invoked from network); 29 Jan 2010 02:39:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 02:39:39 -0000
Received: (qmail 14089 invoked by uid 500); 29 Jan 2010 02:39:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13943 invoked by uid 500); 29 Jan 2010 02:39:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13933 invoked by uid 99); 29 Jan 2010 02:39:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 02:39:37 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [206.190.38.57] (HELO web50303.mail.re2.yahoo.com) (206.190.38.57)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 29 Jan 2010 02:39:25 +0000
Received: (qmail 99487 invoked by uid 60001); 29 Jan 2010 02:39:04 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264732744; bh=tr/kb0E3VQ/nDG1CKCr2jVqqe8npOSwWBm37J/i/nsk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=nF4t/bjmNe2UYCxCK9HKMar/eU+C55+meUJbds2d8/YTAgNh34UtIck358EIGFdOF5PfmaGKIkbQe+tNZXBcRkTYN9OxdypIWBqDFPJVryFT+NdrVCcnGm7sS655wHZa9HZG9JbU7Fbb3rScA8aKvLu0C+VMEOFwMrygKm9mJ+8=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=gsvRgrZs63eMrLZp3qMKVjMnfGXzzvah4p65lpIeFZGmbC1+rKZd6SDa88IqSOYS7Orp5zJQYtnNUH1kQSrKQaFFJJRZoD9fXM18NFn0/bUJwct5oW/uiRU5XOrDav28xHSp+vvNQGJnLpdAdBQ8SWH8xVJbBQlekJaTSGJY/YA=;
Message-ID: <108904.99452.qm@web50303.mail.re2.yahoo.com>
X-YMail-OSG: ny1e_HsVM1lXi3W18MqXhapSme.Rgmie7RlPtUjaYHHChxqp_22kF9MT.4ymK0fQt25xz0OYsks_NAzU03ojlR9nYNPsbqvHd8rqBmYqYrkl_7EP81XnXkngUsw2jQbKNXGK9cjJecsnby.XpSf.jfUlERNyFnzsYZ8At6OV4VS2WmpuhX4lR5VEe49Gofwa8Sy1GafMKrIOOOs_6JfFPMziRCIDUFN.ZE8EPdYfFZOCWCBKrhWxlV6AimPPq6rO63Kbzzk1L_DUGYKkvPgHblGlG8t9XGyTaG.DFwR_4VtyWAKrKQuO1cGKHjqahg6Ad4spT20pccHl1GUToHjKDqJ1Gh5SdI88cQcW5qF4DiAAVYN3L5fouS9luVADNnIsp.xGcWMr93yMt6TXgZOiIZ.Qv6fl55t_4.YzruknvFYByPLBecqviWR3AVl_C41RbJkHaw6n8jXoNUuaNo545O2DHJATqSVASfJIuI8yYzuKq8M-
Received: from [74.72.161.166] by web50303.mail.re2.yahoo.com via HTTP; Thu, 28 Jan 2010 18:39:03 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <CAE8639A6FAB3D4AA7973D5897B325185F4CB7E1F7@MSG-BOX.basistech.net>
Date: Thu, 28 Jan 2010 18:39:03 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: index demo throws LockObtainFailedException
To: java-user@lucene.apache.org
In-Reply-To: <CAE8639A6FAB3D4AA7973D5897B325185F4CB7E1F7@MSG-BOX.basistech.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii

Fedora Core 4 is *ancient*! :)
Could it be that the NFS client on it is old, and this is causing problems?  I remember emails about NFS 3 vs. NFS 4 and some improvements in the latter.  I don't recall the details and tend to keep my Lucene and Solr instances away from NFS mounts.

Otis
----
Sematext :: http://sematext.com/ :: Solr - Lucene - Nutch
Hadoop ecosystem search :: http://search-hadoop.com/



----- Original Message ----
> From: Teruhiko Kurosaka <Kuro@basistech.com>
> To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
> Sent: Thu, January 28, 2010 8:15:26 PM
> Subject: index demo throws LockObtainFailedException
> 
> We have many Linux machines of different brands, sharing the same NFS filesystem
> for home.  The Lucene file indexing demo program is failing with 
> LockObainFailedException 
> only on one particular Linux machine (Fedora Core 4, x86).  I am including
> the console output at the bottom of this message.
> 
> I tried Lucene 2.9.0, 2.9.1 and 3.0.0, and the result is identical.
> 
> After searching the Internet, I saw some postings suggesting that this happens
> when the disk space is low. But there seem to be more than enough for this
> small demo.  I didn't understand suggestions about lockd.  I'd appreciate
> for any advices on how to find the cause of this Exception. 
> 
> Thank you in advance.
> 
> T. "Kuro" Kurosaka
> 
> -bash-3.00$ cd lucene-3.0.0/
> -bash-3.00$ ant demo-index-text
> Buildfile: build.xml
> 
> jar.core-check:
> 
> compile-demo:
>     [mkdir] Created dir: /basis/users/kuro/opt/lucene-3.0.0/build/classes/demo
>     [javac] Compiling 17 source files to 
> /basis/users/kuro/opt/lucene-3.0.0/build/classes/demo
> 
> jar-demo:
>       [jar] Building jar: 
> /basis/users/kuro/opt/lucene-3.0.0/lucene-demos-3.0.0.jar
> 
> demo-index-text:
>      [echo] ----- (1) Prepare dir -----
>      [echo] cd /basis/users/kuro/opt/lucene-3.0.0
>      [echo] rmdir demo-text-dir
>      [echo] mkdir demo-text-dir
>     [mkdir] Created dir: /basis/users/kuro/opt/lucene-3.0.0/demo-text-dir
>      [echo] cd demo-text-dir
>      [echo] ----- (2) Index the files located under 
> /basis/users/kuro/opt/lucene-3.0.0/src -----
>      [echo] java -classpath "../lucene-core-3.0.0.jar;../lucene-demos-3.0.0.jar" 
> org.apache.lucene.demo.IndexFiles ../src/demo
>      [java]  caught a class org.apache.lucene.store.LockObtainFailedException
>      [java]  with message: Lock obtain timed out: 
> NativeFSLock@/basis/users/kuro/opt/lucene-3.0.0/demo-text-dir/index/write.lock: 
> java.io.IOException: Input/output error
> 
> BUILD SUCCESSFUL
> Total time: 6 seconds
> -bash-3.00$ df -k . /tmp
> Filesystem           1K-blocks      Used Available Use% Mounted on
> storev:/vol/exports/users
>                      3119362560 2790661520 328701040  90% /basis/users
> /dev/sda2              9718360   7700764   1515968  84% /
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44751-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 03:44:05 2010
Return-Path: <java-user-return-44751-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99587 invoked from network); 29 Jan 2010 03:44:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 03:44:05 -0000
Received: (qmail 85865 invoked by uid 500); 29 Jan 2010 03:44:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85734 invoked by uid 500); 29 Jan 2010 03:44:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85724 invoked by uid 99); 29 Jan 2010 03:44:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 03:44:02 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of franz.see@gmail.com designates 209.85.222.175 as permitted sender)
Received: from [209.85.222.175] (HELO mail-pz0-f175.google.com) (209.85.222.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 03:43:51 +0000
Received: by pzk5 with SMTP id 5so1358813pzk.29
        for <java-user@lucene.apache.org>; Thu, 28 Jan 2010 19:43:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:date:message-id:subject
         :from:to:content-type;
        bh=XqVdfKbuxRIqg5Sb5ag+K9PeVowgwyE6ArNCRwROlmE=;
        b=RHs/f68jdptFHCW0R7OvuiumwheWp3ItPFYkUG92esl8moOZCHROoV+hg2yJOIrdDC
         iyGuGpq9Rqdu6Woju07s4oUuV+eM2kj8zKq0Cgds6qAAvWOnazBPcon/hQPy5tXk2ecH
         5Cjdiup5xS+xcmgj+ntzmiiLpgQo7oKxLmPYQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:date:message-id:subject:from:to:content-type;
        b=KYY2bQB3esJwFU9XDc1pzfg2l/bLryKnAlzpsREqJtJ9TKuUYIY0GoIS6IeZ9+9T+r
         BEn91qCbAUzD5H4s5IcnnTNT6IHfXMbDYekplYXgRHOJkvA9puRKjYZ+J+XKoLo+RcZe
         9cRDfXILDWUN5n16UInxMMMGxS42fSu4Kqte8=
MIME-Version: 1.0
Received: by 10.114.252.3 with SMTP id z3mr195912wah.54.1264736610040; Thu, 28 
	Jan 2010 19:43:30 -0800 (PST)
Date: Fri, 29 Jan 2010 11:43:30 +0800
Message-ID: <5b254f71001281943q6d015c3ak6a7c43ce78670287@mail.gmail.com>
Subject: Modifying IDF
From: Franz Allan Valencia See <franz.see@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e6878a1b603e2a047e457098
X-Virus-Checked: Checked by ClamAV on apache.org

--0016e6878a1b603e2a047e457098
Content-Type: text/plain; charset=ISO-8859-1

Good day,

I am currently using lucene for my searches. And one of the problems that Im
facing is when keyword is a url. The tokens such as http, https, ://, index,
html, etc seems to be messing up with our search results. The focus was
supposed to be only on the url domain.

The idea that I have is modify the idf so that rare terms get boosted much
more than the default settings in lucene. Since there are probably a lot of
http, https://, etc, then matches to these terms should be really really
low, while matches to the domain (which is rare) should be high.

Would this work or am I totally misunderstanding lucene's tf/idf? :-)

Thanks,

-- 
Franz Allan Valencia See | Java Software Engineer
franz.see@gmail.com
LinkedIn: http://www.linkedin.com/in/franzsee
Twitter: http://www.twitter.com/franz_see

--0016e6878a1b603e2a047e457098--

From java-user-return-44752-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 09:04:00 2010
Return-Path: <java-user-return-44752-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6665 invoked from network); 29 Jan 2010 09:04:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 09:04:00 -0000
Received: (qmail 51485 invoked by uid 500); 29 Jan 2010 09:03:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51400 invoked by uid 500); 29 Jan 2010 09:03:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51390 invoked by uid 99); 29 Jan 2010 09:03:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 09:03:56 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 09:03:47 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NamlC-0003IX-9S
	for java-user@lucene.apache.org; Fri, 29 Jan 2010 01:03:26 -0800
Message-ID: <27367213.post@talk.nabble.com>
Date: Fri, 29 Jan 2010 01:03:26 -0800 (PST)
From: andy green <dreamforlife@hotmail.fr>
To: java-user@lucene.apache.org
Subject: Re: lucene search
In-Reply-To: <359a92831001281151t228288eah7a72058b99946d68@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: dreamforlife@hotmail.fr
References: <27358766.post@talk.nabble.com> <359a92831001281151t228288eah7a72058b99946d68@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org



   

  Thanks ++++


-- 
View this message in context: http://old.nabble.com/lucene-search-tp27358766p27367213.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44753-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 10:12:24 2010
Return-Path: <java-user-return-44753-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39992 invoked from network); 29 Jan 2010 10:12:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 10:12:24 -0000
Received: (qmail 20516 invoked by uid 500); 29 Jan 2010 10:12:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20440 invoked by uid 500); 29 Jan 2010 10:12:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20430 invoked by uid 99); 29 Jan 2010 10:12:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 10:12:22 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.211.172] (HELO mail-yw0-f172.google.com) (209.85.211.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 10:12:14 +0000
Received: by ywh2 with SMTP id 2so913007ywh.21
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 02:11:53 -0800 (PST)
MIME-Version: 1.0
Received: by 10.150.130.3 with SMTP id c3mr1332801ybd.70.1264759912380; Fri, 
	29 Jan 2010 02:11:52 -0800 (PST)
In-Reply-To: <CAE8639A6FAB3D4AA7973D5897B325185F4CB7E1F7@MSG-BOX.basistech.net>
References: <CAE8639A6FAB3D4AA7973D5897B325185F4CB7E1F7@MSG-BOX.basistech.net>
Date: Fri, 29 Jan 2010 05:11:52 -0500
Message-ID: <9ac0c6aa1001290211m2c954dcfm25e8ace89209e541@mail.gmail.com>
Subject: Re: index demo throws LockObtainFailedException
From: Michael McCandless <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
X-Virus-Checked: Checked by ClamAV on apache.org

Likely you'll have to modify the demo to use SimpleFSLockFactory --
NativeFSLockFactory (now the default for Lucene, as of 2.9) often does
not work on NFS.

Mike

On Thu, Jan 28, 2010 at 8:15 PM, Teruhiko Kurosaka <Kuro@basistech.com> wro=
te:
> We have many Linux machines of different brands, sharing the same NFS fil=
esystem
> for home. =A0The Lucene file indexing demo program is failing with LockOb=
ainFailedException
> only on one particular Linux machine (Fedora Core 4, x86). =A0I am includ=
ing
> the console output at the bottom of this message.
>
> I tried Lucene 2.9.0, 2.9.1 and 3.0.0, and the result is identical.
>
> After searching the Internet, I saw some postings suggesting that this ha=
ppens
> when the disk space is low. But there seem to be more than enough for thi=
s
> small demo. =A0I didn't understand suggestions about lockd. =A0I'd apprec=
iate
> for any advices on how to find the cause of this Exception.
>
> Thank you in advance.
>
> T. "Kuro" Kurosaka
>
> -bash-3.00$ cd lucene-3.0.0/
> -bash-3.00$ ant demo-index-text
> Buildfile: build.xml
>
> jar.core-check:
>
> compile-demo:
> =A0 =A0[mkdir] Created dir: /basis/users/kuro/opt/lucene-3.0.0/build/clas=
ses/demo
> =A0 =A0[javac] Compiling 17 source files to /basis/users/kuro/opt/lucene-=
3.0.0/build/classes/demo
>
> jar-demo:
> =A0 =A0 =A0[jar] Building jar: /basis/users/kuro/opt/lucene-3.0.0/lucene-=
demos-3.0.0.jar
>
> demo-index-text:
> =A0 =A0 [echo] ----- (1) Prepare dir -----
> =A0 =A0 [echo] cd /basis/users/kuro/opt/lucene-3.0.0
> =A0 =A0 [echo] rmdir demo-text-dir
> =A0 =A0 [echo] mkdir demo-text-dir
> =A0 =A0[mkdir] Created dir: /basis/users/kuro/opt/lucene-3.0.0/demo-text-=
dir
> =A0 =A0 [echo] cd demo-text-dir
> =A0 =A0 [echo] ----- (2) Index the files located under /basis/users/kuro/=
opt/lucene-3.0.0/src -----
> =A0 =A0 [echo] java -classpath "../lucene-core-3.0.0.jar;../lucene-demos-=
3.0.0.jar" org.apache.lucene.demo.IndexFiles ../src/demo
> =A0 =A0 [java] =A0caught a class org.apache.lucene.store.LockObtainFailed=
Exception
> =A0 =A0 [java] =A0with message: Lock obtain timed out: NativeFSLock@/basi=
s/users/kuro/opt/lucene-3.0.0/demo-text-dir/index/write.lock: java.io.IOExc=
eption: Input/output error
>
> BUILD SUCCESSFUL
> Total time: 6 seconds
> -bash-3.00$ df -k . /tmp
> Filesystem =A0 =A0 =A0 =A0 =A0 1K-blocks =A0 =A0 =A0Used Available Use% M=
ounted on
> storev:/vol/exports/users
> =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 =A0 3119362560 2790661520 328701040 =
=A090% /basis/users
> /dev/sda2 =A0 =A0 =A0 =A0 =A0 =A0 =A09718360 =A0 7700764 =A0 1515968 =A08=
4% /
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44754-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 10:43:21 2010
Return-Path: <java-user-return-44754-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52570 invoked from network); 29 Jan 2010 10:43:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 10:43:20 -0000
Received: (qmail 51730 invoked by uid 500); 29 Jan 2010 10:43:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51662 invoked by uid 500); 29 Jan 2010 10:43:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51652 invoked by uid 99); 29 Jan 2010 10:43:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 10:43:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 10:43:08 +0000
Received: by bwz22 with SMTP id 22so1276871bwz.5
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 02:42:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=lXerAPCZierRJd2lhCs6CC25+fG37DIm+O5W8ADvzzE=;
        b=SrAuxpYQYxSvC5cKJoIlG2rW0Og51fc5BOgtJGIpRV/MvidTGPeCgemraAdrM60OAE
         uHWrL318e55b8c/eJiXfdNJVIhBIuA+9nAmY9eXOTprRyr+v9sUCCPmIyQM8fOSewPwl
         fbpZMURyjG7Og75fRg/yyCchdSt2V0a+WjWN4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=DW3DXlN1A41fJnKf0gD9WgMbZCKKmiYtOJny54O4ivNsJTQ/2ZMA7kL5oxW7aFv2uY
         j+CPOXDCyeDiBK5tr2wFOvrzPxUCWKqINrPaWMfvwwxXzvK4EtcsIJIGQUCZ/mdbuYfQ
         d6Ns/8/CsxdndyQygwsjHIi5DhHvioGCKfjJk=
MIME-Version: 1.0
Received: by 10.204.133.146 with SMTP id f18mr397995bkt.17.1264761766842; Fri, 
	29 Jan 2010 02:42:46 -0800 (PST)
In-Reply-To: <5b254f71001281943q6d015c3ak6a7c43ce78670287@mail.gmail.com>
References: <5b254f71001281943q6d015c3ak6a7c43ce78670287@mail.gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 29 Jan 2010 10:42:26 +0000
Message-ID: <8c4e68611001290242k4cb7d6e4v58048f0d7854228f@mail.gmail.com>
Subject: Re: Modifying IDF
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

Instead of playing around with tf/idf, how about just indexing and
searching the domain.


--
Ian.


On Fri, Jan 29, 2010 at 3:43 AM, Franz Allan Valencia See
<franz.see@gmail.com> wrote:
> Good day,
>
> I am currently using lucene for my searches. And one of the problems that Im
> facing is when keyword is a url. The tokens such as http, https, ://, index,
> html, etc seems to be messing up with our search results. The focus was
> supposed to be only on the url domain.
>
> The idea that I have is modify the idf so that rare terms get boosted much
> more than the default settings in lucene. Since there are probably a lot of
> http, https://, etc, then matches to these terms should be really really
> low, while matches to the domain (which is rare) should be high.
>
> Would this work or am I totally misunderstanding lucene's tf/idf? :-)
>
> Thanks,
>
> --
> Franz Allan Valencia See | Java Software Engineer
> franz.see@gmail.com
> LinkedIn: http://www.linkedin.com/in/franzsee
> Twitter: http://www.twitter.com/franz_see
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44755-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 12:28:19 2010
Return-Path: <java-user-return-44755-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74080 invoked from network); 29 Jan 2010 12:28:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 12:28:19 -0000
Received: (qmail 51949 invoked by uid 500); 29 Jan 2010 12:28:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51909 invoked by uid 500); 29 Jan 2010 12:28:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51899 invoked by uid 99); 29 Jan 2010 12:28:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:28:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:28:08 +0000
Received: from [192.168.0.19] (196-210-134-164-rhwh-esr-2.dynamic.isadsl.co.za [196.210.134.164])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id 2E47F50820
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 04:27:45 -0800 (PST)
Message-ID: <4B62D422.6090005@stimulussoft.com>
Date: Fri, 29 Jan 2010 14:27:14 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene 2.9.0-rc2 [PROBLEM] : TokenStream API (incrementToken
 / AttributeSource), cannot implement a LookaheadTokenFilter.
References: <5B20DEF02611534DB08854076CE825D8032DB19B@sc1exc2.corp.emainc.com> <4A9D99C7.3080400@lexum.umontreal.ca> <4A9D9C48.7040703@lexum.umontreal.ca> <4A9DB1C4.3000001@gmail.com> <4A9DB3EA.7000800@gmail.com> <A95513C77FA44482B345BA468895E341@VEGA> <4A9FE6E1.1060108@lexum.umontreal.ca>
In-Reply-To: <4A9FE6E1.1060108@lexum.umontreal.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi THere

In the absense of documentation, I am trying to convert an EmailFilter 
class to Lucene 3.0. Its not working! Obviously, my understanding of the 
new token filter mechanism is misguided.
Can someone in the know help me out for a sec and let me know where I am 
going wrong. Thanks.

import org.apache.commons.logging.*;
import org.apache.lucene.analysis.TokenStream;
import org.apache.lucene.analysis.TokenFilter;
import org.apache.lucene.analysis.Token;
import org.apache.lucene.analysis.tokenattributes.TermAttribute;

import java.io.IOException;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.Stack;

/* Many thanks to Michael J. Prichard" <michael_prich...@mac.com> for his
  * original the email filter code. It is rewritten. */

public class EmailFilter extends TokenFilter  implements Serializable {

     public EmailFilter(TokenStream in) {
         super(in);
     }

     public final boolean incrementToken() throws java.io.IOException {

         if (!input.incrementToken()) {
             return false;
         }


         TermAttribute termAtt = (TermAttribute) 
input.getAttribute(TermAttribute.class);

         char[] buffer = termAtt.termBuffer();
         final int bufferLength = termAtt.termLength();
         String emailAddress = new String(buffer, 0,bufferLength);
         emailAddress = emailAddress.replaceAll("<", "");
         emailAddress = emailAddress.replaceAll(">", "");
         emailAddress = emailAddress.replaceAll("\"", "");

         String [] parts = extractEmailParts(emailAddress);
         clearAttributes();
         for (int i = 0; i < parts.length; i++) {
             if (parts[i]!=null) {
                 TermAttribute newTermAttribute = 
addAttribute(TermAttribute.class);
                 newTermAttribute.setTermBuffer(parts[i]);
                 newTermAttribute.setTermLength(parts[i].length());
             }
         }
         return true;
     }

     private String[] extractWhitespaceParts(String email) {
         String[] whitespaceParts = email.split(" ");
         ArrayList<String> partsList = new ArrayList<String>();
         for (int i=0; i < whitespaceParts.length; i++) {
             partsList.add(whitespaceParts[i]);
         }
         return whitespaceParts;
     }

     private String[] extractEmailParts(String email) {

         if (email.indexOf('@')==-1)
             return extractWhitespaceParts(email);

         ArrayList<String> partsList = new ArrayList<String>();

         String[] whitespaceParts = extractWhitespaceParts(email);

          for (int w=0;w<whitespaceParts.length;w++) {

              if (whitespaceParts[w].indexOf('@')==-1)
                  partsList.add(whitespaceParts[w]);
              else {
                  partsList.add(whitespaceParts[w]);
                  String[] splitOnAmpersand = whitespaceParts[w].split("@");
                  try {
                      partsList.add(splitOnAmpersand[0]);
                      partsList.add(splitOnAmpersand[1]);
                  } catch (ArrayIndexOutOfBoundsException ae) {}

                 if (splitOnAmpersand.length > 0) {
                     String[] splitOnDot = splitOnAmpersand[0].split("\\.");
                      for (int i=0; i < splitOnDot.length; i++) {
                          partsList.add(splitOnDot[i]);
                      }
                 }
                 if (splitOnAmpersand.length > 1) {
                     String[] splitOnDot = splitOnAmpersand[1].split("\\.");
                     for (int i=0; i < splitOnDot.length; i++) {
                         partsList.add(splitOnDot[i]);
                     }

                     if (splitOnDot.length > 2) {
                         String domain = splitOnDot[splitOnDot.length-2] 
+ "." + splitOnDot[splitOnDot.length-1];
                         partsList.add(domain);
                     }
                 }
              }
          }
         return partsList.toArray(new String[0]);
     }

}


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44756-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 12:30:20 2010
Return-Path: <java-user-return-44756-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74426 invoked from network); 29 Jan 2010 12:30:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 12:30:20 -0000
Received: (qmail 54893 invoked by uid 500); 29 Jan 2010 12:30:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54827 invoked by uid 500); 29 Jan 2010 12:30:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54817 invoked by uid 99); 29 Jan 2010 12:30:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:30:17 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:30:07 +0000
Received: from [192.168.0.19] (196-210-134-164-rhwh-esr-2.dynamic.isadsl.co.za [196.210.134.164])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id E72E450829
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 04:29:43 -0800 (PST)
Message-ID: <4B62D499.5030807@stimulussoft.com>
Date: Fri, 29 Jan 2010 14:29:13 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Email Filter using Lucene 3.0
Content-Type: multipart/alternative;
 boundary="------------020002020306030205080501"
X-Virus-Checked: Checked by ClamAV on apache.org

--------------020002020306030205080501
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi THere

In the absence of documentation, I am trying to convert an EmailFilter 
class to Lucene 3.0. Its not working! Obviously, my understanding of the 
new token filter mechanism is misguided.
Can someone in the know help me out for a sec and let me know where I am 
going wrong. Thanks.

import org.apache.commons.logging.*;
import org.apache.lucene.analysis.TokenStream;
import org.apache.lucene.analysis.TokenFilter;
import org.apache.lucene.analysis.Token;
import org.apache.lucene.analysis.tokenattributes.TermAttribute;

import java.io.IOException;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.Stack;

/* Many thanks to Michael J. Prichard" <michael_prich...@mac.com> for his
  * original the email filter code. It is rewritten. */

public class EmailFilter extends TokenFilter  implements Serializable {

     public EmailFilter(TokenStream in) {
         super(in);
     }

     public final boolean incrementToken() throws java.io.IOException {

         if (!input.incrementToken()) {
             return false;
         }


         TermAttribute termAtt = (TermAttribute) 
input.getAttribute(TermAttribute.class);

         char[] buffer = termAtt.termBuffer();
         final int bufferLength = termAtt.termLength();
         String emailAddress = new String(buffer, 0,bufferLength);
         emailAddress = emailAddress.replaceAll("<", "");
         emailAddress = emailAddress.replaceAll(">", "");
         emailAddress = emailAddress.replaceAll("\"", "");

         String [] parts = extractEmailParts(emailAddress);
         clearAttributes();
         for (int i = 0; i < parts.length; i++) {
             if (parts[i]!=null) {
                 TermAttribute newTermAttribute = 
addAttribute(TermAttribute.class);
                 newTermAttribute.setTermBuffer(parts[i]);
                 newTermAttribute.setTermLength(parts[i].length());
             }
         }
         return true;
     }

     private String[] extractWhitespaceParts(String email) {
         String[] whitespaceParts = email.split(" ");
         ArrayList<String> partsList = new ArrayList<String>();
         for (int i=0; i < whitespaceParts.length; i++) {
             partsList.add(whitespaceParts[i]);
         }
         return whitespaceParts;
     }

     private String[] extractEmailParts(String email) {

         if (email.indexOf('@')==-1)
             return extractWhitespaceParts(email);

         ArrayList<String> partsList = new ArrayList<String>();

         String[] whitespaceParts = extractWhitespaceParts(email);

          for (int w=0;w<whitespaceParts.length;w++) {

              if (whitespaceParts[w].indexOf('@')==-1)
                  partsList.add(whitespaceParts[w]);
              else {
                  partsList.add(whitespaceParts[w]);
                  String[] splitOnAmpersand = 
whitespaceParts[w].split("@");
                  try {
                      partsList.add(splitOnAmpersand[0]);
                      partsList.add(splitOnAmpersand[1]);
                  } catch (ArrayIndexOutOfBoundsException ae) {}

                 if (splitOnAmpersand.length > 0) {
                     String[] splitOnDot = 
splitOnAmpersand[0].split("\\.");
                      for (int i=0; i < splitOnDot.length; i++) {
                          partsList.add(splitOnDot[i]);
                      }
                 }
                 if (splitOnAmpersand.length > 1) {
                     String[] splitOnDot = 
splitOnAmpersand[1].split("\\.");
                     for (int i=0; i < splitOnDot.length; i++) {
                         partsList.add(splitOnDot[i]);
                     }

                     if (splitOnDot.length > 2) {
                         String domain = splitOnDot[splitOnDot.length-2] 
+ "." + splitOnDot[splitOnDot.length-1];
                         partsList.add(domain);
                     }
                 }
              }
          }
         return partsList.toArray(new String[0]);
     }

}



--------------020002020306030205080501--

From java-user-return-44757-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 12:50:04 2010
Return-Path: <java-user-return-44757-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85165 invoked from network); 29 Jan 2010 12:50:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 12:50:04 -0000
Received: (qmail 83469 invoked by uid 500); 29 Jan 2010 12:50:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83404 invoked by uid 500); 29 Jan 2010 12:50:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83394 invoked by uid 99); 29 Jan 2010 12:50:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:50:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.58] (HELO web50304.mail.re2.yahoo.com) (206.190.38.58)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 29 Jan 2010 12:49:50 +0000
Received: (qmail 43163 invoked by uid 60001); 29 Jan 2010 12:49:29 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264769369; bh=yWa/qS84/4LLrDIJ5LWzkeYCrmBIr7vzHcMKJI92FYk=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=omvEL6WPU5VYYN0UilY9OWQv0g0oUFQJXmC8pfL3p+VzCQKn0CjDcfrvUYAYtYz7UCmtgEYX3X30z/FBkrxymAsGsXN4MB+wnsQ+u3wkv3kVFdXCyclcLBVoHqGyrEXJ0T+slLuJRYxloblUP0tmnWIwsNU4jveIX0S3QmWzjVw=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=OgYdWxDAxK2UP0JdCqkyXg50f5IMJ+eO1hrPFmZcSFzxuvgIJKbGk2tpGEgVrgGC5CPTyC654Oqlunc7VSF9LWGyyKckL6dt7rl9oMhx47So5RJX6p28M/+DXK0N/UlU7PU+7HFDDwuZk+Jh5thZYnto3CB7oqG3BlHecY37aek=;
Message-ID: <368471.43133.qm@web50304.mail.re2.yahoo.com>
X-YMail-OSG: X.rDFEUVM1nUX_.GnViJcfe3arPGOtrGKxGD_PPdMJKLOCkgSluEv8nv_7Ye_SFG9qhjjybradJNYkTvkdkkliAJE2w3Z98dsP_UbdwSkJrJTzb4C6gM4WBQ620r.CHI_c7xESbPBM9Qt28JWYHHrIhqyhDkeaFiHfj8jQjW.CmM5r2M.VxcYdXW5baQsb3DPOR8fiPSUsTXvjcmJzvdJHc3Q3FFMD3r3DGA9f1h8yxdR30Or5EYGI0mJMvlcpIbEssokwZnUohHu.f7AgIAPK87iUxsnTyW6qoD89GE8n3ephvaeQEFBAxQmSn7sgLCz4luU10wheMxmc5eavPAOWvebbfXbJku9binIuT8KdaTPZJj9WAKxBKKOZPyXCnuywpFMw8u7BNr2tqyFx_fIPkftTGQMZoCKk5LVikn65lTyLQDewcjXYJs05UaNMi_MG4JgqfX8YW68WVTTlo-
Received: from [74.73.1.126] by web50304.mail.re2.yahoo.com via HTTP; Fri, 29 Jan 2010 04:49:29 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <4B62D499.5030807@stimulussoft.com>
Date: Fri, 29 Jan 2010 04:49:29 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: Email Filter using Lucene 3.0
To: java-user@lucene.apache.org
In-Reply-To: <4B62D499.5030807@stimulussoft.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Jamie,

Could you say more about how it's not working?  No compiling? Run-time exceptions?  Doesn't work as expected after you run a unit test for it?


Otis ----
Sematext :: http://sematext.com/ :: Solr - Lucene - Nutch
Hadoop ecosystem search :: http://search-hadoop.com/



----- Original Message ----
> From: Jamie <jamie@stimulussoft.com>
> To: java-user@lucene.apache.org
> Sent: Fri, January 29, 2010 7:29:13 AM
> Subject: Email Filter using Lucene 3.0
> 
> Hi THere
> 
> In the absence of documentation, I am trying to convert an EmailFilter class to 
> Lucene 3.0. Its not working! Obviously, my understanding of the new token filter 
> mechanism is misguided.
> Can someone in the know help me out for a sec and let me know where I am going 
> wrong. Thanks.
> 
> import org.apache.commons.logging.*;
> import org.apache.lucene.analysis.TokenStream;
> import org.apache.lucene.analysis.TokenFilter;
> import org.apache.lucene.analysis.Token;
> import org.apache.lucene.analysis.tokenattributes.TermAttribute;
> 
> import java.io.IOException;
> import java.io.Serializable;
> import java.util.ArrayList;
> import java.util.Stack;
> 
> /* Many thanks to Michael J. Prichard" for his
> * original the email filter code. It is rewritten. */
> 
> public class EmailFilter extends TokenFilter  implements Serializable {
> 
>     public EmailFilter(TokenStream in) {
>         super(in);
>     }
> 
>     public final boolean incrementToken() throws java.io.IOException {
> 
>         if (!input.incrementToken()) {
>             return false;
>         }
> 
> 
>         TermAttribute termAtt = (TermAttribute) 
> input.getAttribute(TermAttribute.class);
> 
>         char[] buffer = termAtt.termBuffer();
>         final int bufferLength = termAtt.termLength();
>         String emailAddress = new String(buffer, 0,bufferLength);
>         emailAddress = emailAddress.replaceAll("<", "");
>         emailAddress = emailAddress.replaceAll(">", "");
>         emailAddress = emailAddress.replaceAll("\"", "");
> 
>         String [] parts = extractEmailParts(emailAddress);
>         clearAttributes();
>         for (int i = 0; i < parts.length; i++) {
>             if (parts[i]!=null) {
>                 TermAttribute newTermAttribute = 
> addAttribute(TermAttribute.class);
>                 newTermAttribute.setTermBuffer(parts[i]);
>                 newTermAttribute.setTermLength(parts[i].length());
>             }
>         }
>         return true;
>     }
> 
>     private String[] extractWhitespaceParts(String email) {
>         String[] whitespaceParts = email.split(" ");
>         ArrayListpartsList = new ArrayList();
>         for (int i=0; i < whitespaceParts.length; i++) {
>             partsList.add(whitespaceParts[i]);
>         }
>         return whitespaceParts;
>     }
> 
>     private String[] extractEmailParts(String email) {
> 
>         if (email.indexOf('@')==-1)
>             return extractWhitespaceParts(email);
> 
>         ArrayListpartsList = new ArrayList();
> 
>         String[] whitespaceParts = extractWhitespaceParts(email);
> 
>          for (int w=0;w
> 
>              if (whitespaceParts[w].indexOf('@')==-1)
>                  partsList.add(whitespaceParts[w]);
>              else {
>                  partsList.add(whitespaceParts[w]);
>                  String[] splitOnAmpersand = whitespaceParts[w].split("@");
>                  try {
>                      partsList.add(splitOnAmpersand[0]);
>                      partsList.add(splitOnAmpersand[1]);
>                  } catch (ArrayIndexOutOfBoundsException ae) {}
> 
>                 if (splitOnAmpersand.length > 0) {
>                     String[] splitOnDot = splitOnAmpersand[0].split("\\.");
>                      for (int i=0; i < splitOnDot.length; i++) {
>                          partsList.add(splitOnDot[i]);
>                      }
>                 }
>                 if (splitOnAmpersand.length > 1) {
>                     String[] splitOnDot = splitOnAmpersand[1].split("\\.");
>                     for (int i=0; i < splitOnDot.length; i++) {
>                         partsList.add(splitOnDot[i]);
>                     }
> 
>                     if (splitOnDot.length > 2) {
>                         String domain = splitOnDot[splitOnDot.length-2] + "." + 
> splitOnDot[splitOnDot.length-1];
>                         partsList.add(domain);
>                     }
>                 }
>              }
>          }
>         return partsList.toArray(new String[0]);
>     }
> 
> }


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44758-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 12:52:23 2010
Return-Path: <java-user-return-44758-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85855 invoked from network); 29 Jan 2010 12:52:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 12:52:23 -0000
Received: (qmail 87038 invoked by uid 500); 29 Jan 2010 12:52:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86943 invoked by uid 500); 29 Jan 2010 12:52:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86933 invoked by uid 99); 29 Jan 2010 12:52:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:52:20 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:52:11 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id E2CD945F762
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 13:51:47 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id MQcNcms6V8Vo for <java-user@lucene.apache.org>;
	Fri, 29 Jan 2010 13:51:38 +0100 (CET)
Received: from VEGA (unknown [134.102.249.78])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id C837B45F850
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 13:51:37 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4B62D499.5030807@stimulussoft.com>
In-Reply-To: <4B62D499.5030807@stimulussoft.com>
Subject: RE: Email Filter using Lucene 3.0
Date: Fri, 29 Jan 2010 13:51:50 +0100
Message-ID: <000c01caa0e1$d354db80$79fe9280$@de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Acqg3tdfXPfTD+ZIQUmc0j1QmvY/vwAARKeQ
Content-Language: de

Can you send us the original filter?

The implementation below is wrong in the whole design. All attributes =
are singletons in each instance of this TokenStream, so your code cannot =
work. addAttribute always return the same instance. You have to register =
the singletons in the ctor using addAttribute and then fill this one =
instance with the correct text parts on each call to incrementToken():

Here my proposal, its just pseudo-code:

In ctor:

	Define a class member (!!!) LinkedList<String> for your splitted email =
addresses, initially empty
	termAtt =3D addAttribute(TermAttribute.class);

In incrementToken:

if (!linkedlist.isEmpty()) {=20
	clearAttributes(); // important, do this only here, if you do it in the =
filter part you will break your stream!!!!
	termAtt.setTermBuffer(linkedList.removeFirst());
	// set eventually offsets and so on in the other attributes
	return true;
} else {
	if (!input.incrementToken()) return false;
	read the term (the one input generated) text using termAtt.term() (no =
need for new String, termAtt is the one registered in ctor)
	split your term into the token parts and add all token parts to the =
linkedList<String> above
	//recurse to self, as the list has no elements, if it is still empty it =
will recurse again:
	return incrementToken();
}

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Jamie [mailto:jamie@stimulussoft.com]
> Sent: Friday, January 29, 2010 1:29 PM
> To: java-user@lucene.apache.org
> Subject: Email Filter using Lucene 3.0
>=20
> Hi THere
>=20
> In the absence of documentation, I am trying to convert an EmailFilter
> class to Lucene 3.0. Its not working! Obviously, my understanding of
> the
> new token filter mechanism is misguided.
> Can someone in the know help me out for a sec and let me know where I
> am
> going wrong. Thanks.
>=20
> import org.apache.commons.logging.*;
> import org.apache.lucene.analysis.TokenStream;
> import org.apache.lucene.analysis.TokenFilter;
> import org.apache.lucene.analysis.Token;
> import org.apache.lucene.analysis.tokenattributes.TermAttribute;
>=20
> import java.io.IOException;
> import java.io.Serializable;
> import java.util.ArrayList;
> import java.util.Stack;
>=20
> /* Many thanks to Michael J. Prichard" <michael_prich...@mac.com> for
> his
>   * original the email filter code. It is rewritten. */
>=20
> public class EmailFilter extends TokenFilter  implements Serializable =
{
>=20
>      public EmailFilter(TokenStream in) {
>          super(in);
>      }
>=20
>      public final boolean incrementToken() throws java.io.IOException =
{
>=20
>          if (!input.incrementToken()) {
>              return false;
>          }
>=20
>=20
>          TermAttribute termAtt =3D (TermAttribute)
> input.getAttribute(TermAttribute.class);
>=20
>          char[] buffer =3D termAtt.termBuffer();
>          final int bufferLength =3D termAtt.termLength();
>          String emailAddress =3D new String(buffer, 0,bufferLength);
>          emailAddress =3D emailAddress.replaceAll("<", "");
>          emailAddress =3D emailAddress.replaceAll(">", "");
>          emailAddress =3D emailAddress.replaceAll("\"", "");
>=20
>          String [] parts =3D extractEmailParts(emailAddress);
>          clearAttributes();
>          for (int i =3D 0; i < parts.length; i++) {
>              if (parts[i]!=3Dnull) {
>                  TermAttribute newTermAttribute =3D
> addAttribute(TermAttribute.class);
>                  newTermAttribute.setTermBuffer(parts[i]);
>                  newTermAttribute.setTermLength(parts[i].length());
>              }
>          }
>          return true;
>      }
>=20
>      private String[] extractWhitespaceParts(String email) {
>          String[] whitespaceParts =3D email.split(" ");
>          ArrayList<String> partsList =3D new ArrayList<String>();
>          for (int i=3D0; i < whitespaceParts.length; i++) {
>              partsList.add(whitespaceParts[i]);
>          }
>          return whitespaceParts;
>      }
>=20
>      private String[] extractEmailParts(String email) {
>=20
>          if (email.indexOf('@')=3D=3D-1)
>              return extractWhitespaceParts(email);
>=20
>          ArrayList<String> partsList =3D new ArrayList<String>();
>=20
>          String[] whitespaceParts =3D extractWhitespaceParts(email);
>=20
>           for (int w=3D0;w<whitespaceParts.length;w++) {
>=20
>               if (whitespaceParts[w].indexOf('@')=3D=3D-1)
>                   partsList.add(whitespaceParts[w]);
>               else {
>                   partsList.add(whitespaceParts[w]);
>                   String[] splitOnAmpersand =3D
> whitespaceParts[w].split("@");
>                   try {
>                       partsList.add(splitOnAmpersand[0]);
>                       partsList.add(splitOnAmpersand[1]);
>                   } catch (ArrayIndexOutOfBoundsException ae) {}
>=20
>                  if (splitOnAmpersand.length > 0) {
>                      String[] splitOnDot =3D
> splitOnAmpersand[0].split("\\.");
>                       for (int i=3D0; i < splitOnDot.length; i++) {
>                           partsList.add(splitOnDot[i]);
>                       }
>                  }
>                  if (splitOnAmpersand.length > 1) {
>                      String[] splitOnDot =3D
> splitOnAmpersand[1].split("\\.");
>                      for (int i=3D0; i < splitOnDot.length; i++) {
>                          partsList.add(splitOnDot[i]);
>                      }
>=20
>                      if (splitOnDot.length > 2) {
>                          String domain =3D =
splitOnDot[splitOnDot.length-
> 2]
> + "." + splitOnDot[splitOnDot.length-1];
>                          partsList.add(domain);
>                      }
>                  }
>               }
>           }
>          return partsList.toArray(new String[0]);
>      }
>=20
> }
>=20



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44759-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 12:58:44 2010
Return-Path: <java-user-return-44759-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87092 invoked from network); 29 Jan 2010 12:58:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 12:58:44 -0000
Received: (qmail 94951 invoked by uid 500); 29 Jan 2010 12:58:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94872 invoked by uid 500); 29 Jan 2010 12:58:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94862 invoked by uid 99); 29 Jan 2010 12:58:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:58:42 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 12:58:33 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 2032345F8D5
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 13:58:12 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id o-ia2rABsVw4 for <java-user@lucene.apache.org>;
	Fri, 29 Jan 2010 13:58:02 +0100 (CET)
Received: from VEGA (unknown [134.102.249.78])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id C217245F86C
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 13:58:01 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4B62D499.5030807@stimulussoft.com> <000c01caa0e1$d354db80$79fe9280$@de>
In-Reply-To: <000c01caa0e1$d354db80$79fe9280$@de>
Subject: RE: Email Filter using Lucene 3.0
Date: Fri, 29 Jan 2010 13:58:14 +0100
Message-ID: <000001caa0e2$b82f96a0$288ec3e0$@de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Acqg3tdfXPfTD+ZIQUmc0j1QmvY/vwAARKeQAACosTA=
Content-Language: de

Here another variant without a recursion:

In ctor:

	Define a class member (!!!) LinkedList<String> for your splitted email =
addresses, initially empty
	termAtt =3D addAttribute(TermAttribute.class);

In incrementToken:

While (true) {
	if (!linkedlist.isEmpty()) {=20
		clearAttributes(); // important, do this only here, if you do it in =
the filter part you will break your stream!!!!
		termAtt.setTermBuffer(linkedList.removeFirst());
		// set eventually offsets and so on in the other attributes
		return true;
	} else {
		if (!input.incrementToken()) return false;
		read the term (the one input generated) text using termAtt.term() (no =
need for new String, termAtt is the one registered in ctor)
		split your term into the token parts and add all token parts to the =
linkedList<String> above
	}
}

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: Uwe Schindler [mailto:uwe@thetaphi.de]
> Sent: Friday, January 29, 2010 1:52 PM
> To: java-user@lucene.apache.org
> Subject: RE: Email Filter using Lucene 3.0
>=20
> Can you send us the original filter?
>=20
> The implementation below is wrong in the whole design. All attributes
> are singletons in each instance of this TokenStream, so your code
> cannot work. addAttribute always return the same instance. You have to
> register the singletons in the ctor using addAttribute and then fill
> this one instance with the correct text parts on each call to
> incrementToken():
>=20
> Here my proposal, its just pseudo-code:
>=20
> In ctor:
>=20
> 	Define a class member (!!!) LinkedList<String> for your splitted
> email addresses, initially empty
> 	termAtt =3D addAttribute(TermAttribute.class);
>=20
> In incrementToken:
>=20
> if (!linkedlist.isEmpty()) {
> 	clearAttributes(); // important, do this only here, if you do it
> in the filter part you will break your stream!!!!
> 	termAtt.setTermBuffer(linkedList.removeFirst());
> 	// set eventually offsets and so on in the other attributes
> 	return true;
> } else {
> 	if (!input.incrementToken()) return false;
> 	read the term (the one input generated) text using termAtt.term()
> (no need for new String, termAtt is the one registered in ctor)
> 	split your term into the token parts and add all token parts to
> the linkedList<String> above
> 	//recurse to self, as the list has no elements, if it is still
> empty it will recurse again:
> 	return incrementToken();
> }
>=20
> Uwe
>=20
> -----
> Uwe Schindler
> H.-H.-Meier-Allee 63, D-28213 Bremen
> http://www.thetaphi.de
> eMail: uwe@thetaphi.de
>=20
> > -----Original Message-----
> > From: Jamie [mailto:jamie@stimulussoft.com]
> > Sent: Friday, January 29, 2010 1:29 PM
> > To: java-user@lucene.apache.org
> > Subject: Email Filter using Lucene 3.0
> >
> > Hi THere
> >
> > In the absence of documentation, I am trying to convert an
> EmailFilter
> > class to Lucene 3.0. Its not working! Obviously, my understanding of
> > the
> > new token filter mechanism is misguided.
> > Can someone in the know help me out for a sec and let me know where =
I
> > am
> > going wrong. Thanks.
> >
> > import org.apache.commons.logging.*;
> > import org.apache.lucene.analysis.TokenStream;
> > import org.apache.lucene.analysis.TokenFilter;
> > import org.apache.lucene.analysis.Token;
> > import org.apache.lucene.analysis.tokenattributes.TermAttribute;
> >
> > import java.io.IOException;
> > import java.io.Serializable;
> > import java.util.ArrayList;
> > import java.util.Stack;
> >
> > /* Many thanks to Michael J. Prichard" <michael_prich...@mac.com> =
for
> > his
> >   * original the email filter code. It is rewritten. */
> >
> > public class EmailFilter extends TokenFilter  implements =
Serializable
> {
> >
> >      public EmailFilter(TokenStream in) {
> >          super(in);
> >      }
> >
> >      public final boolean incrementToken() throws =
java.io.IOException
> {
> >
> >          if (!input.incrementToken()) {
> >              return false;
> >          }
> >
> >
> >          TermAttribute termAtt =3D (TermAttribute)
> > input.getAttribute(TermAttribute.class);
> >
> >          char[] buffer =3D termAtt.termBuffer();
> >          final int bufferLength =3D termAtt.termLength();
> >          String emailAddress =3D new String(buffer, 0,bufferLength);
> >          emailAddress =3D emailAddress.replaceAll("<", "");
> >          emailAddress =3D emailAddress.replaceAll(">", "");
> >          emailAddress =3D emailAddress.replaceAll("\"", "");
> >
> >          String [] parts =3D extractEmailParts(emailAddress);
> >          clearAttributes();
> >          for (int i =3D 0; i < parts.length; i++) {
> >              if (parts[i]!=3Dnull) {
> >                  TermAttribute newTermAttribute =3D
> > addAttribute(TermAttribute.class);
> >                  newTermAttribute.setTermBuffer(parts[i]);
> >                  newTermAttribute.setTermLength(parts[i].length());
> >              }
> >          }
> >          return true;
> >      }
> >
> >      private String[] extractWhitespaceParts(String email) {
> >          String[] whitespaceParts =3D email.split(" ");
> >          ArrayList<String> partsList =3D new ArrayList<String>();
> >          for (int i=3D0; i < whitespaceParts.length; i++) {
> >              partsList.add(whitespaceParts[i]);
> >          }
> >          return whitespaceParts;
> >      }
> >
> >      private String[] extractEmailParts(String email) {
> >
> >          if (email.indexOf('@')=3D=3D-1)
> >              return extractWhitespaceParts(email);
> >
> >          ArrayList<String> partsList =3D new ArrayList<String>();
> >
> >          String[] whitespaceParts =3D extractWhitespaceParts(email);
> >
> >           for (int w=3D0;w<whitespaceParts.length;w++) {
> >
> >               if (whitespaceParts[w].indexOf('@')=3D=3D-1)
> >                   partsList.add(whitespaceParts[w]);
> >               else {
> >                   partsList.add(whitespaceParts[w]);
> >                   String[] splitOnAmpersand =3D
> > whitespaceParts[w].split("@");
> >                   try {
> >                       partsList.add(splitOnAmpersand[0]);
> >                       partsList.add(splitOnAmpersand[1]);
> >                   } catch (ArrayIndexOutOfBoundsException ae) {}
> >
> >                  if (splitOnAmpersand.length > 0) {
> >                      String[] splitOnDot =3D
> > splitOnAmpersand[0].split("\\.");
> >                       for (int i=3D0; i < splitOnDot.length; i++) {
> >                           partsList.add(splitOnDot[i]);
> >                       }
> >                  }
> >                  if (splitOnAmpersand.length > 1) {
> >                      String[] splitOnDot =3D
> > splitOnAmpersand[1].split("\\.");
> >                      for (int i=3D0; i < splitOnDot.length; i++) {
> >                          partsList.add(splitOnDot[i]);
> >                      }
> >
> >                      if (splitOnDot.length > 2) {
> >                          String domain =3D
> splitOnDot[splitOnDot.length-
> > 2]
> > + "." + splitOnDot[splitOnDot.length-1];
> >                          partsList.add(domain);
> >                      }
> >                  }
> >               }
> >           }
> >          return partsList.toArray(new String[0]);
> >      }
> >
> > }
> >
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44760-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 13:22:18 2010
Return-Path: <java-user-return-44760-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93778 invoked from network); 29 Jan 2010 13:22:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 13:22:18 -0000
Received: (qmail 29608 invoked by uid 500); 29 Jan 2010 13:22:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29550 invoked by uid 500); 29 Jan 2010 13:22:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29540 invoked by uid 99); 29 Jan 2010 13:22:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 13:22:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [71.6.200.51] (HELO serve.stimulussoft.com) (71.6.200.51)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 13:22:06 +0000
Received: from [192.168.0.19] (196-210-147-175-rndf-esr-3.dynamic.isadsl.co.za [196.210.147.175])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by serve.stimulussoft.com (Postfix) with ESMTPSA id EB4B650820
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 05:21:43 -0800 (PST)
Message-ID: <4B62E0C8.9070102@stimulussoft.com>
Date: Fri, 29 Jan 2010 15:21:12 +0200
From: Jamie <jamie@stimulussoft.com>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.7) Gecko/20100111 Thunderbird/3.0.1
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Email Filter using Lucene 3.0
References: <4B62D499.5030807@stimulussoft.com> <000c01caa0e1$d354db80$79fe9280$@de> <000001caa0e2$b82f96a0$288ec3e0$@de>
In-Reply-To: <000001caa0e2$b82f96a0$288ec3e0$@de>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Uwe

Thanks so much for your help. I now understand Token Filters much better 
and your suggestion worked! Here's the code for anyone else who is 
interested.

import org.apache.commons.logging.*;
import org.apache.lucene.analysis.TokenStream;
import org.apache.lucene.analysis.TokenFilter;
import org.apache.lucene.analysis.Token;
import org.apache.lucene.analysis.tokenattributes.TermAttribute;

import java.io.IOException;
import java.io.Serializable;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.Stack;

/* Many thanks to Michael J. Prichard" <michael_prich...@mac.com> for his
  * original the email filter code. It is rewritten. */

public class EmailFilter extends TokenFilter  implements Serializable {

     LinkedList<String> partsList = null;
     TermAttribute termAtt = null;

     public EmailFilter(TokenStream in) {
         super(in);
         termAtt = addAttribute(TermAttribute.class);
     }

     public final boolean incrementToken() throws java.io.IOException {

         if (partsList!=null && !partsList.isEmpty()) {
             clearAttributes();
             termAtt.setTermBuffer(partsList.removeFirst());
             return true;
         } else {
             if (!input.incrementToken()) return false;
             String emailAddress = termAtt.term();
             emailAddress = emailAddress.replaceAll("<", "");
             emailAddress = emailAddress.replaceAll(">", "");
             emailAddress = emailAddress.replaceAll("\"", "");
             partsList = extractEmailParts(emailAddress);
             return incrementToken();
         }
     }

     private LinkedList<String> extractWhitespaceParts(String email) {
         String[] whitespaceParts = email.split(" ");
         LinkedList<String> partsList = new LinkedList<String>();
         for (int i=0; i < whitespaceParts.length; i++) {
             partsList.add(whitespaceParts[i]);
         }
         return partsList;
     }

     private LinkedList<String> extractEmailParts(String email) {

         if (email.indexOf('@')==-1)
             return extractWhitespaceParts(email);

         LinkedList<String> partsList = new LinkedList<String>();

         LinkedList<String> whitespaceParts = extractWhitespaceParts(email);

         for (String whitespacePart : whitespaceParts) {

              if (whitespacePart.indexOf('@')==-1)
                  partsList.add(whitespacePart);
              else {
                  partsList.add(whitespacePart);
                  String[] splitOnAmpersand = whitespacePart.split("@");
                  try {
                      partsList.add(splitOnAmpersand[0]);
                      partsList.add(splitOnAmpersand[1]);
                  } catch (ArrayIndexOutOfBoundsException ae) {}

                 if (splitOnAmpersand.length > 0) {
                     String[] splitOnDot = splitOnAmpersand[0].split("\\.");
                      for (int i=0; i < splitOnDot.length; i++) {
                          partsList.add(splitOnDot[i]);
                      }
                 }
                 if (splitOnAmpersand.length > 1) {
                     String[] splitOnDot = splitOnAmpersand[1].split("\\.");
                     for (int i=0; i < splitOnDot.length; i++) {
                         partsList.add(splitOnDot[i]);
                     }

                     if (splitOnDot.length > 2) {
                         String domain = splitOnDot[splitOnDot.length-2] 
+ "." + splitOnDot[splitOnDot.length-1];
                         partsList.add(domain);
                     }
                 }
              }
          }
         return partsList;
     }

}

On 2010/01/29 02:58 PM, Uwe Schindler wrote:
> Here another variant without a recursion:
>
> In ctor:
>
> 	Define a class member (!!!) LinkedList<String>  for your splitted email addresses, initially empty
> 	termAtt = addAttribute(TermAttribute.class);
>
> In incrementToken:
>
> While (true) {
> 	if (!linkedlist.isEmpty()) {
> 		clearAttributes(); // important, do this only here, if you do it in the filter part you will break your stream!!!!
> 		termAtt.setTermBuffer(linkedList.removeFirst());
> 		// set eventually offsets and so on in the other attributes
> 		return true;
> 	} else {
> 		if (!input.incrementToken()) return false;
> 		read the term (the one input generated) text using termAtt.term() (no need for new String, termAtt is the one registered in ctor)
> 		split your term into the token parts and add all token parts to the linkedList<String>  above
> 	}
>    


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44761-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 14:17:25 2010
Return-Path: <java-user-return-44761-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20969 invoked from network); 29 Jan 2010 14:17:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 14:17:25 -0000
Received: (qmail 89918 invoked by uid 500); 29 Jan 2010 14:17:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89842 invoked by uid 500); 29 Jan 2010 14:17:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89832 invoked by uid 99); 29 Jan 2010 14:17:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 14:17:23 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 14:17:13 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id B9ED245F8ED
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 15:16:52 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id Cu-1LMU7FHFT for <java-user@lucene.apache.org>;
	Fri, 29 Jan 2010 15:16:44 +0100 (CET)
Received: from VEGA (unknown [134.102.249.78])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 6891245F886
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 15:16:44 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <4B62D499.5030807@stimulussoft.com> <000c01caa0e1$d354db80$79fe9280$@de> <000001caa0e2$b82f96a0$288ec3e0$@de> <4B62E0C8.9070102@stimulussoft.com>
In-Reply-To: <4B62E0C8.9070102@stimulussoft.com>
Subject: RE: Email Filter using Lucene 3.0
Date: Fri, 29 Jan 2010 15:16:56 +0100
Message-ID: <000401caa0ed$b721cf20$25656d60$@de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: Acqg5hzT/oN9bJq7T5a/S/JYOcAUagAB3lNw
Content-Language: de

We talked about that internally, i would change the recursion to a =
while-loop. Else it looks correct. And for efficience I would really use =
always the same linked list and not create a new one each time.

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: Jamie [mailto:jamie@stimulussoft.com]
> Sent: Friday, January 29, 2010 2:21 PM
> To: java-user@lucene.apache.org
> Subject: Re: Email Filter using Lucene 3.0
>=20
> Hi Uwe
>=20
> Thanks so much for your help. I now understand Token Filters much
> better
> and your suggestion worked! Here's the code for anyone else who is
> interested.
>=20
> import org.apache.commons.logging.*;
> import org.apache.lucene.analysis.TokenStream;
> import org.apache.lucene.analysis.TokenFilter;
> import org.apache.lucene.analysis.Token;
> import org.apache.lucene.analysis.tokenattributes.TermAttribute;
>=20
> import java.io.IOException;
> import java.io.Serializable;
> import java.util.ArrayList;
> import java.util.LinkedList;
> import java.util.Stack;
>=20
> /* Many thanks to Michael J. Prichard" <michael_prich...@mac.com> for
> his
>   * original the email filter code. It is rewritten. */
>=20
> public class EmailFilter extends TokenFilter  implements Serializable =
{
>=20
>      LinkedList<String> partsList =3D null;
>      TermAttribute termAtt =3D null;
>=20
>      public EmailFilter(TokenStream in) {
>          super(in);
>          termAtt =3D addAttribute(TermAttribute.class);
>      }
>=20
>      public final boolean incrementToken() throws java.io.IOException =
{
>=20
>          if (partsList!=3Dnull && !partsList.isEmpty()) {
>              clearAttributes();
>              termAtt.setTermBuffer(partsList.removeFirst());
>              return true;
>          } else {
>              if (!input.incrementToken()) return false;
>              String emailAddress =3D termAtt.term();
>              emailAddress =3D emailAddress.replaceAll("<", "");
>              emailAddress =3D emailAddress.replaceAll(">", "");
>              emailAddress =3D emailAddress.replaceAll("\"", "");
>              partsList =3D extractEmailParts(emailAddress);
>              return incrementToken();
>          }
>      }
>=20
>      private LinkedList<String> extractWhitespaceParts(String email) {
>          String[] whitespaceParts =3D email.split(" ");
>          LinkedList<String> partsList =3D new LinkedList<String>();
>          for (int i=3D0; i < whitespaceParts.length; i++) {
>              partsList.add(whitespaceParts[i]);
>          }
>          return partsList;
>      }
>=20
>      private LinkedList<String> extractEmailParts(String email) {
>=20
>          if (email.indexOf('@')=3D=3D-1)
>              return extractWhitespaceParts(email);
>=20
>          LinkedList<String> partsList =3D new LinkedList<String>();
>=20
>          LinkedList<String> whitespaceParts =3D
> extractWhitespaceParts(email);
>=20
>          for (String whitespacePart : whitespaceParts) {
>=20
>               if (whitespacePart.indexOf('@')=3D=3D-1)
>                   partsList.add(whitespacePart);
>               else {
>                   partsList.add(whitespacePart);
>                   String[] splitOnAmpersand =3D
> whitespacePart.split("@");
>                   try {
>                       partsList.add(splitOnAmpersand[0]);
>                       partsList.add(splitOnAmpersand[1]);
>                   } catch (ArrayIndexOutOfBoundsException ae) {}
>=20
>                  if (splitOnAmpersand.length > 0) {
>                      String[] splitOnDot =3D
> splitOnAmpersand[0].split("\\.");
>                       for (int i=3D0; i < splitOnDot.length; i++) {
>                           partsList.add(splitOnDot[i]);
>                       }
>                  }
>                  if (splitOnAmpersand.length > 1) {
>                      String[] splitOnDot =3D
> splitOnAmpersand[1].split("\\.");
>                      for (int i=3D0; i < splitOnDot.length; i++) {
>                          partsList.add(splitOnDot[i]);
>                      }
>=20
>                      if (splitOnDot.length > 2) {
>                          String domain =3D =
splitOnDot[splitOnDot.length-
> 2]
> + "." + splitOnDot[splitOnDot.length-1];
>                          partsList.add(domain);
>                      }
>                  }
>               }
>           }
>          return partsList;
>      }
>=20
> }
>=20
> On 2010/01/29 02:58 PM, Uwe Schindler wrote:
> > Here another variant without a recursion:
> >
> > In ctor:
> >
> > 	Define a class member (!!!) LinkedList<String>  for your splitted
> email addresses, initially empty
> > 	termAtt =3D addAttribute(TermAttribute.class);
> >
> > In incrementToken:
> >
> > While (true) {
> > 	if (!linkedlist.isEmpty()) {
> > 		clearAttributes(); // important, do this only here, if you
> do it in the filter part you will break your stream!!!!
> > 		termAtt.setTermBuffer(linkedList.removeFirst());
> > 		// set eventually offsets and so on in the other attributes
> > 		return true;
> > 	} else {
> > 		if (!input.incrementToken()) return false;
> > 		read the term (the one input generated) text using
> termAtt.term() (no need for new String, termAtt is the one registered
> in ctor)
> > 		split your term into the token parts and add all token
> parts to the linkedList<String>  above
> > 	}
> >
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44762-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 14:42:35 2010
Return-Path: <java-user-return-44762-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31396 invoked from network); 29 Jan 2010 14:42:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 14:42:35 -0000
Received: (qmail 44436 invoked by uid 500); 29 Jan 2010 14:42:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44374 invoked by uid 500); 29 Jan 2010 14:42:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44364 invoked by uid 99); 29 Jan 2010 14:42:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 14:42:32 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of illes.solt@gmail.com designates 216.239.58.184 as permitted sender)
Received: from [216.239.58.184] (HELO gv-out-0910.google.com) (216.239.58.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 14:42:24 +0000
Received: by gv-out-0910.google.com with SMTP id e6so123946gvc.23
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 06:42:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=p09XsSOrfPBE9mC1v/SBsxlFGdsPJwtDyk1cb+7MeuQ=;
        b=k9YUjKc6IkzQT0rg9ZKNPIMR5Qb4fcu+iSjvGDFA4HNw/+hcLEQvVD5hRr31OiBUdS
         1AOIYb2whIzc8bwMlmtXRWPPJFwOLiVe9Bda7K7eAeaxvPk40KADN4oZT5Gk4t5kKPzj
         Pppjl4rsXuPj+0+FfPBXBobmDBqiHZh41aDbI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=cvT7Nv1tM23IBm3JZSHZ5BL7fwuUguEbOj/A/zgQSENBJjDDUsssCaKXl2Dz3AGbut
         0nMHbszYdmlFKIWq7LFwpV45k2qmVDT2jrFPXfJmYEf5PTOurUA2OBwP5QAbPFhRhpNl
         83OrHo+5voqfpCLIcwdQVfd+yyUmHGueRZSwA=
MIME-Version: 1.0
Received: by 10.102.248.30 with SMTP id v30mr395180muh.98.1264776124169; Fri, 
	29 Jan 2010 06:42:04 -0800 (PST)
In-Reply-To: <001e01caa02b$83fec430$6f01a8c0@marvin>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com> <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org> 
	<001e01caa02b$83fec430$6f01a8c0@marvin>
From: =?ISO-8859-1?Q?Ill=E9s_Solt?= <illes.solt@gmail.com>
Date: Fri, 29 Jan 2010 15:41:44 +0100
Message-ID: <5100be8c1001290641l6f0aaf8dybdb112e036772e1c@mail.gmail.com>
Subject: Re: Highlighter / cannot be instantiated
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Are you sure you imported Highlighter from the correct lucene namespace

 org.apache.lucene.search.highlight.Highlighter

and not something else like javax.swing.text.Highlighter?


Illes

2010/1/28 Marc Schwarz <info@qboad.de>:
> I'm trying to get the highlighter running, but didn't get it work.
>
> Everywhere it's posted as following:
>
> Highlighter highlighter = new Highlighter(new SimpleHTMLFormatter(),
> new QueryScorer(query));
>
> but that gives me a
> "Highlighter is abstract; cannot be instantiated".
>
> I'm using version 2.9 of highliter/2.9 of lucene
>
> Any ideas ? Thanks :-)
>
> Greetings,
> Marc
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44763-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 15:55:48 2010
Return-Path: <java-user-return-44763-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51266 invoked from network); 29 Jan 2010 15:55:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 15:55:48 -0000
Received: (qmail 60885 invoked by uid 500); 29 Jan 2010 15:55:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60825 invoked by uid 500); 29 Jan 2010 15:55:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60814 invoked by uid 99); 29 Jan 2010 15:55:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 15:55:46 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 15:55:38 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NatBl-00055I-DD
	for java-user@lucene.apache.org; Fri, 29 Jan 2010 07:55:17 -0800
Message-ID: <27373932.post@talk.nabble.com>
Date: Fri, 29 Jan 2010 07:55:17 -0800 (PST)
From: Marc Sturlese <marc.sturlese@gmail.com>
To: java-user@lucene.apache.org
Subject: FastVectorHighlighter and query with multiple fields
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: marc.sturlese@gmail.com


I have FastVectorHighlighter working with a query like:
title:Ipod OR title:IPad

but it's not working when (0 snippets are returned):
title:Ipod OR content:IPad

Could this be because when FieldQuery is created the query to build it must
have just one field?
If it's not the case I may be missing something... any idea?

Thanks in advance
-- 
View this message in context: http://old.nabble.com/FastVectorHighlighter-and-query-with-multiple-fields-tp27373932p27373932.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44764-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 16:08:53 2010
Return-Path: <java-user-return-44764-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55273 invoked from network); 29 Jan 2010 16:08:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 16:08:53 -0000
Received: (qmail 83188 invoked by uid 500); 29 Jan 2010 16:08:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83115 invoked by uid 500); 29 Jan 2010 16:08:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83105 invoked by uid 99); 29 Jan 2010 16:08:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 16:08:50 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [81.169.146.162] (HELO mo-p00-ob.rzone.de) (81.169.146.162)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 16:08:41 +0000
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; t=1264781298; l=1333;
	s=domk; d=qboad.de;
	h=In-Reply-To:Content-Transfer-Encoding:Content-Type:MIME-Version:
	Date:Subject:References:To:From:X-RZG-CLASS-ID:X-RZG-AUTH;
	bh=Txk2xYTcD123KALLu1RHamuTlbo=;
	b=Y73MkLg9TNnKP9fozY99TuMdTsPnMIp6vATENL74wqlm3+Z6oy7Qq/yyhM8g3BgkV/2
	4PTNQO2tsnri5nC2VQ61aEfwLAZkjQSZ+Ics6Sj7IrI+EPw3t35Ist2dJTdVSuakEa2M5
	MHM541Nd2VZufV8vGHPE3GcTjSlCKP4Z+ng=
X-RZG-AUTH: :JWICemC5efBhIus+Y9brhO0rWemFfVqN1wGoDG990xuVPE96NqZJng==
X-RZG-CLASS-ID: mo00
Received: from marvin (p549FBCDA.dip0.t-ipconnect.de [84.159.188.218])
	by post.strato.de (mrclete mo60) (RZmta 22.6)
	with ESMTP id x05d9am0TFroe1 for <java-user@lucene.apache.org>;
	Fri, 29 Jan 2010 17:08:18 +0100 (MET)
From: "Marc Schwarz" <info@qboad.de>
To: <java-user@lucene.apache.org>
References: <672188.25802.qm@web32602.mail.mud.yahoo.com> <8F9F0D7D-CBD3-4C71-A9BD-CA2E3B8D3E8A@apache.org> <001e01caa02b$83fec430$6f01a8c0@marvin> <5100be8c1001290641l6f0aaf8dybdb112e036772e1c@mail.gmail.com>
Subject: AW: Highlighter / cannot be instantiated
Date: Fri, 29 Jan 2010 17:10:32 +0100
Message-ID: <004901caa0fd$9665bb60$6f01a8c0@marvin>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 11
In-Reply-To: <5100be8c1001290641l6f0aaf8dybdb112e036772e1c@mail.gmail.com>
Thread-Index: Acqg8UuiqSBZaCGWTKCs+na0cEQwAAADAoig
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198

Yep that was it :-)=20

Thanks !

-----Urspr=FCngliche Nachricht-----
Von: Ill=E9s Solt [mailto:illes.solt@gmail.com]=20
Gesendet: Freitag, 29. Januar 2010 15:42
An: java-user@lucene.apache.org
Betreff: Re: Highlighter / cannot be instantiated

Are you sure you imported Highlighter from the correct lucene namespace

 org.apache.lucene.search.highlight.Highlighter

and not something else like javax.swing.text.Highlighter?


Illes

2010/1/28 Marc Schwarz <info@qboad.de>:
> I'm trying to get the highlighter running, but didn't get it work.
>
> Everywhere it's posted as following:
>
> Highlighter highlighter =3D new Highlighter(new SimpleHTMLFormatter(),
> new QueryScorer(query));
>
> but that gives me a
> "Highlighter is abstract; cannot be instantiated".
>
> I'm using version 2.9 of highliter/2.9 of lucene
>
> Any ideas ? Thanks :-)
>
> Greetings,
> Marc
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44765-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 16:28:11 2010
Return-Path: <java-user-return-44765-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61097 invoked from network); 29 Jan 2010 16:28:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 16:28:11 -0000
Received: (qmail 25476 invoked by uid 500); 29 Jan 2010 16:28:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25402 invoked by uid 500); 29 Jan 2010 16:28:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25388 invoked by uid 99); 29 Jan 2010 16:28:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 16:28:09 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of thienthanhomenh@gmail.com designates 74.125.92.25 as permitted sender)
Received: from [74.125.92.25] (HELO qw-out-2122.google.com) (74.125.92.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 16:28:02 +0000
Received: by qw-out-2122.google.com with SMTP id 3so106155qwe.53
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 08:27:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:from:date:message-id
         :subject:to:content-type;
        bh=fE+2JKVQ7W3leMImJlFZVv09zRjtQrVyPU/7eXKs7WY=;
        b=CpXUSp2YAaMnyW/t/yyB5bVGub/2oPQbgrS8tmlRPIvkpeKf4KGyIggw8He1qcevFs
         QuNDxnJQ1vj5gURmpV96tgOAMWjCnu2L0McmjdzEIh2eMA0PQhRK8EiHytCHhLKr1LuQ
         rf4UPLTVSfhUYWMHJSleEcdAYdNCgoAbZ66P4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:from:date:message-id:subject:to:content-type;
        b=S47wI1CNWlxONGDs6mrGgx2P9fekV14sdyNcplGz/El3Zb9JeuAl6ZGmmJq5vfQUWs
         49Y38XY10AKMP8HG7ogXBMyB7EatI8BZ2u+r6q5NuomNa1ck7CUnU0Eg1IuMK3VvpkFi
         F+qnWU04f854r5H/y+FTjempelb1iVeznQQzM=
MIME-Version: 1.0
Received: by 10.224.7.145 with SMTP id d17mr450209qad.125.1264782461140; Fri, 
	29 Jan 2010 08:27:41 -0800 (PST)
From: Phan The Dai <thienthanhomenh@gmail.com>
Date: Sat, 30 Jan 2010 01:27:21 +0900
Message-ID: <3b23ce091001290827q22bfa182v941f140ae00f00cf@mail.gmail.com>
Subject: How further reward documents matching more query terms?
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=00c09f971e115083f5047e501de7

--00c09f971e115083f5047e501de7
Content-Type: text/plain; charset=ISO-8859-1

"When searching with a query as a multi term query, users can further reward
documents matching more query terms through a coordination factor:
*coord-factor(q,d)
"

*How we configure this factor?
I am needing if documents matching more term queries then their score are
higher.

Please show me more details. Thanks 1

--00c09f971e115083f5047e501de7--

From java-user-return-44766-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 16:36:22 2010
Return-Path: <java-user-return-44766-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63951 invoked from network); 29 Jan 2010 16:36:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 16:36:22 -0000
Received: (qmail 48857 invoked by uid 500); 29 Jan 2010 16:36:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48786 invoked by uid 500); 29 Jan 2010 16:36:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48776 invoked by uid 99); 29 Jan 2010 16:36:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 16:36:19 +0000
X-ASF-Spam-Status: No, hits=2.8 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS,WEIRD_QUOTING
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 16:36:10 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Natoz-0000gF-TH
	for java-user@lucene.apache.org; Fri, 29 Jan 2010 08:35:49 -0800
Message-ID: <27374590.post@talk.nabble.com>
Date: Fri, 29 Jan 2010 08:35:49 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: Re: AW: AW: index a database
In-Reply-To: <002101caa067$e99915c0$6f01a8c0@marvin>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: lucius.vorenus@hotmail.de
References: <27358959.post@talk.nabble.com> <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com> <27363073.post@talk.nabble.com> <002001caa064$bd2d8050$6f01a8c0@marvin> <27363752.post@talk.nabble.com> <002101caa067$e99915c0$6f01a8c0@marvin>


Thank you Marc and thank u all... it` working :)
:clap:


Marc Schwarz wrote:
>=20
> Maybe you should seperate the add method from the database function...
>=20
> Separate the db loop something like that:
>=20
> try
>            {
>             ResultSet rs2 =3D stm.executeQuery(sql);
>             while(rs2.next()) {
>                 String text =3D rs2.getString("textvalue");
>                 addDoc(w, text,rs2.getString("id"));
>                 count_ds++;
>             }
>=20
>=20
> and then the addDoc seems something like that:
>=20
>=20
> private static void addDoc(IndexWriter w, String value,String empty)
> throws
> IOException {
>     Document doc =3D new Document();
>     doc.add(new Field("title", value, Field.Store.YES,
> Field.Index.ANALYZED));
>     w.addDocument(doc);
>   }
>=20
>=20
> -----Urspr=C3=BCngliche Nachricht-----
> Von: luciusvorenus [mailto:lucius.vorenus@hotmail.de]=20
> Gesendet: Donnerstag, 28. Januar 2010 23:02
> An: java-user@lucene.apache.org
> Betreff: Re: AW: index a database
>=20
>=20
> yes.... many thanks ..
>  But .... /.../my index folder is empty. Have I done something wrong in
> "private static void indexDocs"? It is not indexed
>=20
>=20
>=20
>=20
> Marc Schwarz wrote:
>>=20
>> StandardAnalyzer analyzer =3D new StandardAnalyzer(Version.LUCENE_CURREN=
T);
>>=20
>> any difference with that ?
>>=20
>> -----Urspr=C3=BCngliche Nachricht-----
>> Von: luciusvorenus [mailto:lucius.vorenus@hotmail.de]=20
>> Gesendet: Donnerstag, 28. Januar 2010 22:46
>> An: java-user@lucene.apache.org
>> Betreff: Re: index a database
>>=20
>>=20
>> lucene 3.3
>>=20
>> i tried liek this
>>=20
>> ""
>> import org.apache.lucene.demo.FileDocument;
>> import org.apache.lucene.document.Document;
>> import org.apache.lucene.document.Field;
>> import org.apache.lucene.analysis.Analyzer;
>> import org.apache.lucene.analysis.standard.StandardAnalyzer;
>> import org.apache.lucene.index.IndexWriter;
>> import org.apache.lucene.search.IndexSearcher;
>> import org.apache.lucene.search.Query;
>> import org.apache.lucene.queryParser.QueryParser;
>> import org.apache.lucene.store.FSDirectory;
>> import org.apache.lucene.util.Version;
>> import java.sql.*;
>> import java.util.Properties;
>> import org.apache.lucene.document.*;
>> import java.io.*;
>> import org.apache.lucene.store.Directory;
>> import org.apache.lucene.store.FSDirectory;
>> import org.apache.lucene.store.SimpleFSDirectory;
>>=20
>> public class Con{
>> =09public static void main(String[] args) throws Exception
>>=20
>> =09  {
>> =09=09final File INDEX_DIR =3D new File("index");
>>=20
>> =09=09
>> =09=09   Class.forName("com.mysql.jdbc.Driver").newInstance();
>> =09=09   Connection conn =3D
>> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
>> "passwort");
>> =09=09   StandardAnalyzer analyzer =3D new StandardAnalyzer(null);
>>                    Directory directory =3D new SimpleFSDirectory(new
>> File("home/lucius/Desktop/index"));
>> =09=09   IndexWriter w =3D new IndexWriter(directory, analyzer,true,
>> new
>> IndexWriter.MaxFieldLength(25000));
>> =20
>> =09=09   System.out.println("Indexing to directory '" + INDEX_DIR
>> + "'...");
>> =09=09   indexDocs(w, conn);
>> =09=09   w.optimize();
>> =09=09   w.close();
>> =09=09
>>=20
>> =09=09
>> =09=09}
>> =09 =20
>>=20
>> private static=09void indexDocs(IndexWriter writer, Connection conn)
> throws
>> Exception {
>> =09  String sql =3D "select c_id, city from city";
>> =09  Statement stmt =3D conn.createStatement();
>> =09  ResultSet rs =3D stmt.executeQuery(sql);
>> =09  while (rs.next()) {
>> =09     Document d =3D new Document();
>> =09     d.add(new Field("c_id", rs.getString("c_id"), Field.Store.YES,
>> Field.Index.NO));
>> =09     d.add(new Field("city", rs.getString("city"), Field.Store.NO,
>> Field.Index.ANALYZED));
>> =09    =20
>> =09     writer.addDocument(d);
>> =09 }
>>=20
>> }
>> }
>> =20
>> =09
>> =09=09
>> """"
>> I ' on the right track ?
>>=20
>> now i get this message after compiling
>> ""
>> Exception in thread "main" java.lang.NullPointerException
>> =09at
>>
> org.apache.lucene.analysis.StopFilter.getEnablePositionIncrementsVersionD=
efa
>> ult(StopFilter.java:162)
>> =09at
>>
> org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer
>> .java:73)
>> =09at
>>
> org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer
>> .java:63)
>> =09at Con.main(Con.java:29)
>> """
>>=20
>>=20
>> once again many thanks
>>=20
>> Erick Erickson wrote:
>>>=20
>>> What version are you using? Because there's no such constructor
>>> (i.e. one that takes a File) in 3.0.....
>>>=20
>>> You might want to use something like FSDirectory.open(file) in
>>> your IndexWriter constructor....
>>>=20
>>> If this doesn't work, more details please....
>>>=20
>>> Erick
>>>=20
>>> On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus
>>> <lucius.vorenus@hotmail.de>wrote:
>>>=20
>>>>
>>>> Hello
>>>>
>>>> I tried to index a database
>>>>
>>>> ""
>>>> import org.apache.lucene.demo.FileDocument;
>>>> import org.apache.lucene.document.Document;
>>>> import org.apache.lucene.document.Field;
>>>> import org.apache.lucene.analysis.Analyzer;
>>>> import org.apache.lucene.analysis.standard.StandardAnalyzer;
>>>> import org.apache.lucene.index.IndexWriter;
>>>> import org.apache.lucene.search.IndexSearcher;
>>>> import org.apache.lucene.search.Query;
>>>> import org.apache.lucene.queryParser.QueryParser;
>>>> import org.apache.lucene.store.FSDirectory;
>>>> import org.apache.lucene.util.Version;
>>>> import java.sql.*;
>>>> import java.util.Properties;
>>>> import org.apache.lucene.document.*;
>>>> import java.io.*;
>>>> import org.apache.lucene.store.Directory;
>>>> import org.apache.lucene.store.FSDirectory;
>>>>
>>>> public class Con{
>>>>        public static void main(String[] args) throws Exception
>>>>
>>>>          {
>>>>                final File INDEX_DIR =3D new File("index");
>>>>
>>>>
>>>>                   Class.forName("com.mysql.jdbc.Driver").newInstance()=
;
>>>>                   Connection conn =3D
>>>> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
>>>> "passwort");
>>>>                   StandardAnalyzer analyzer =3D new
>>>> StandardAnalyzer(null);
>>>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>>>> analyzer,
>>>> true);
>>>>                   System.out.println("Indexing to directory '" +
>>>> INDEX_DIR
>>>> + "'...");
>>>>                   indexDocs(writer, conn);
>>>>                   writer.optimize();
>>>>                   writer.close();
>>>>
>>>>
>>>>
>>>>                }
>>>>
>>>>
>>>> private static  void indexDocs(IndexWriter writer, Connection conn)
>>>> throws
>>>> Exception {
>>>>          String sql =3D "select c_id, city from city";
>>>>          Statement stmt =3D conn.createStatement();
>>>>          ResultSet rs =3D stmt.executeQuery(sql);
>>>>          while (rs.next()) {
>>>>             Document d =3D new Document();
>>>>             d.add(new Field("c_id", rs.getString("c_id"),
>>>> Field.Store.YES,
>>>> Field.Index.NO));
>>>>             d.add(new Field("city", rs.getString("city"),
>>>> Field.Store.NO,
>>>> Field.Index.ANALYZED));
>>>>
>>>>             writer.addDocument(d);
>>>>         }
>>>>
>>>> }
>>>> }
>>>>  """
>>>> and i get this message
>>>>
>>>> ""
>>>> symbol  : constructor
>>>>
>>>>
>>
> IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAnal=
yze
>> r,boolean)
>>>> location: class org.apache.lucene.index.IndexWriter
>>>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>>>> analyzer,
>>>> true);
>>>>                                        ^
>>>> 1 error
>>>>
>>>> What i am doing wrong??
>>>>
>>>> I'm a newbie ...
>>>>
>>>> Thank U
>>>> --
>>>> View this message in context:
>>>> http://old.nabble.com/index-a-database-tp27358959p27358959.html
>>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>>=20
>>>=20
>>=20
>> --=20
>> View this message in context:
>> http://old.nabble.com/index-a--mysql-database-tp27358959p27363073.html
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>=20
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>=20
>>=20
>=20
> --=20
> View this message in context:
> http://old.nabble.com/index-a--mysql-database-tp27358959p27363752.html
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/index-a--mysql-database=
-tp27358959p27374590.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44767-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 17:28:55 2010
Return-Path: <java-user-return-44767-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81001 invoked from network); 29 Jan 2010 17:28:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 17:28:54 -0000
Received: (qmail 42686 invoked by uid 500); 29 Jan 2010 17:28:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42632 invoked by uid 500); 29 Jan 2010 17:28:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42622 invoked by uid 99); 29 Jan 2010 17:28:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 17:28:52 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 17:28:42 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Naudo-0005Yh-JB
	for java-user@lucene.apache.org; Fri, 29 Jan 2010 09:28:20 -0800
Message-ID: <27375431.post@talk.nabble.com>
Date: Fri, 29 Jan 2010 09:28:20 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: Re: AW: index a database
In-Reply-To: <27363463.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: lucius.vorenus@hotmail.de
References: <27358959.post@talk.nabble.com> <359a92831001281247w311ef31ay74ed2a3db62cb81@mail.gmail.com> <001f01caa061$2e640860$6f01a8c0@marvin> <27363463.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org



One more question

""d.add(new Field("txt", rs.getString("subject"), Field.Store.NO,
Field.Index.ANALYZED));"""

the field txt is a blob ...how can i index a blob?  with rs.geBlob(txt) ?=
=20

thank




luciusvorenus wrote:
>=20
>=20
> ""
>=20
> Exception in thread "main" java.lang.NullPointerException
> =09at
> org.apache.lucene.analysis.StopFilter.getEnablePositionIncrementsVersionD=
efault(StopFilter.java:162)
> =09at
> org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer.java:73)
> =09at
> org.apache.lucene.analysis.standard.StandardAnalyzer.<init>(StandardAnaly=
zer.java:63)
> =09at Con.main(Con.java:29)
>=20
> """
> did you get  also this message  after the compilation?
>=20
>=20
> br
>=20
>=20
>=20
> Marc Schwarz wrote:
>>=20
>> I had that problem yesterday... this works in my app:
>>=20
>> Directory directory =3D new SimpleFSDirectory(new
>> File("c:\\lucene\\index"));
>>=20
>> IndexWriter w =3D new IndexWriter(directory, analyzer,true,
>> new IndexWriter.MaxFieldLength(25000));
>>=20
>>=20
>>=20
>> -----Urspr=C3=BCngliche Nachricht-----
>> Von: Erick Erickson [mailto:erickerickson@gmail.com]=20
>> Gesendet: Donnerstag, 28. Januar 2010 21:47
>> An: java-user@lucene.apache.org
>> Betreff: Re: index a database
>>=20
>> What version are you using? Because there's no such constructor
>> (i.e. one that takes a File) in 3.0.....
>>=20
>> You might want to use something like FSDirectory.open(file) in
>> your IndexWriter constructor....
>>=20
>> If this doesn't work, more details please....
>>=20
>> Erick
>>=20
>> On Thu, Jan 28, 2010 at 3:30 PM, luciusvorenus
>> <lucius.vorenus@hotmail.de>wrote:
>>=20
>>>
>>> Hello
>>>
>>> I tried to index a database
>>>
>>> ""
>>> import org.apache.lucene.demo.FileDocument;
>>> import org.apache.lucene.document.Document;
>>> import org.apache.lucene.document.Field;
>>> import org.apache.lucene.analysis.Analyzer;
>>> import org.apache.lucene.analysis.standard.StandardAnalyzer;
>>> import org.apache.lucene.index.IndexWriter;
>>> import org.apache.lucene.search.IndexSearcher;
>>> import org.apache.lucene.search.Query;
>>> import org.apache.lucene.queryParser.QueryParser;
>>> import org.apache.lucene.store.FSDirectory;
>>> import org.apache.lucene.util.Version;
>>> import java.sql.*;
>>> import java.util.Properties;
>>> import org.apache.lucene.document.*;
>>> import java.io.*;
>>> import org.apache.lucene.store.Directory;
>>> import org.apache.lucene.store.FSDirectory;
>>>
>>> public class Con{
>>>        public static void main(String[] args) throws Exception
>>>
>>>          {
>>>                final File INDEX_DIR =3D new File("index");
>>>
>>>
>>>                   Class.forName("com.mysql.jdbc.Driver").newInstance();
>>>                   Connection conn =3D
>>> DriverManager.getConnection("jdbc:mysql://127.0.0.1/test", "root",
>>> "passwort");
>>>                   StandardAnalyzer analyzer =3D new
>>> StandardAnalyzer(null);
>>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>> analyzer,
>>> true);
>>>                   System.out.println("Indexing to directory '" +
>>> INDEX_DIR
>>> + "'...");
>>>                   indexDocs(writer, conn);
>>>                   writer.optimize();
>>>                   writer.close();
>>>
>>>
>>>
>>>                }
>>>
>>>
>>> private static  void indexDocs(IndexWriter writer, Connection conn)
>>> throws
>>> Exception {
>>>          String sql =3D "select c_id, city from city";
>>>          Statement stmt =3D conn.createStatement();
>>>          ResultSet rs =3D stmt.executeQuery(sql);
>>>          while (rs.next()) {
>>>             Document d =3D new Document();
>>>             d.add(new Field("c_id", rs.getString("c_id"),
>>> Field.Store.YES,
>>> Field.Index.NO));
>>>             d.add(new Field("city", rs.getString("city"),
>>> Field.Store.NO,
>>> Field.Index.ANALYZED));
>>>
>>>             writer.addDocument(d);
>>>         }
>>>
>>> }
>>> }
>>>  """
>>> and i get this message
>>>
>>> ""
>>> symbol  : constructor
>>>
>>>
>> IndexWriter(java.io.File,org.apache.lucene.analysis.standard.StandardAna=
lyze
>> r,boolean)
>>> location: class org.apache.lucene.index.IndexWriter
>>>                   IndexWriter writer =3D new IndexWriter(INDEX_DIR,
>> analyzer,
>>> true);
>>>                                        ^
>>> 1 error
>>>
>>> What i am doing wrong??
>>>
>>> I'm a newbie ...
>>>
>>> Thank U
>>> --
>>> View this message in context:
>>> http://old.nabble.com/index-a-database-tp27358959p27358959.html
>>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>=20
>>=20
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>=20
>>=20
>>=20
>=20
>=20

--=20
View this message in context: http://old.nabble.com/index-a--mysql-database=
-tp27358959p27375431.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44768-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 17:47:20 2010
Return-Path: <java-user-return-44768-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91005 invoked from network); 29 Jan 2010 17:47:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 17:47:20 -0000
Received: (qmail 71822 invoked by uid 500); 29 Jan 2010 17:47:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71749 invoked by uid 500); 29 Jan 2010 17:47:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71739 invoked by uid 99); 29 Jan 2010 17:47:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 17:47:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ian.lea@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 17:47:11 +0000
Received: by bwz22 with SMTP id 22so1641909bwz.5
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 09:46:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=0J3xnIP5iR9AAlcmqBD0+AjT0m18haBI0tSOg4nyJS0=;
        b=ZNYCZoX6q1yG2BXcpE6pJxXQPO7/ZYBfRoU3DAdi3olmgpxteQKM5BuKvD3j/KVMYo
         plXk7NsoSMLQQm0+L5kYm2I41sHEQNa3pwJuKGWEpPzyVD9FkeX3q0REI4Bnm7YCrc2K
         q6uSBZlnZ7fgK2upHJwq7cN2BS+dQLr2QfcIU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=Qzp8N/lKfIPsP2XK/adoE9LdLxQCTyhJJ4gDmzlotmw1aumeHAepCTzBs9AGfwIeWt
         PVr1z7/E6yTJsVMIxoFQ8u+FZAk+qY7dVMxEEXSMp9MDeqWYiZpHvKKh1DaLCr3zGOY+
         g3tllRNk6lX1TeZ9rGc0o653ekc8j1JIQrL38=
MIME-Version: 1.0
Received: by 10.204.160.67 with SMTP id m3mr809921bkx.51.1264787210305; Fri, 
	29 Jan 2010 09:46:50 -0800 (PST)
In-Reply-To: <3b23ce091001290827q22bfa182v941f140ae00f00cf@mail.gmail.com>
References: <3b23ce091001290827q22bfa182v941f140ae00f00cf@mail.gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 29 Jan 2010 17:46:30 +0000
Message-ID: <8c4e68611001290946g5b5e5d0ctc27419f7c5752c3e@mail.gmail.com>
Subject: Re: How further reward documents matching more query terms?
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1

I presume that quote is from the javadocs for Similarity.

You can write your own Similarity class that extends DefaultSimilarity
and provides an implementation of public float coord(int overlap, int
maxOverlap) that does what you want, maybe by scaling up the value
returned, if I've understood the description properly.

Tell lucene to use your class by calling
Similarity.setDefault(Similarity similarity).

Warning: in my limited experience of trying to tweak lucene's scoring
I almost always make things worse rather than better.  YMMV.  Good
luck.


--
Ian.


On Fri, Jan 29, 2010 at 4:27 PM, Phan The Dai <thienthanhomenh@gmail.com> wrote:
> "When searching with a query as a multi term query, users can further reward
> documents matching more query terms through a coordination factor:
> *coord-factor(q,d)
> "
>
> *How we configure this factor?
> I am needing if documents matching more term queries then their score are
> higher.
>
> Please show me more details. Thanks 1
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44769-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 18:10:42 2010
Return-Path: <java-user-return-44769-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2247 invoked from network); 29 Jan 2010 18:10:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 18:10:42 -0000
Received: (qmail 12119 invoked by uid 500); 29 Jan 2010 18:10:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12030 invoked by uid 500); 29 Jan 2010 18:10:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12020 invoked by uid 99); 29 Jan 2010 18:10:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 18:10:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 18:10:31 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NavII-00016k-SS
	for java-user@lucene.apache.org; Fri, 29 Jan 2010 10:10:10 -0800
Message-ID: <27376053.post@talk.nabble.com>
Date: Fri, 29 Jan 2010 10:10:10 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: index a mysql database   -blob field
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: lucius.vorenus@hotmail.de


helo 

One more question to blob :

""d.add(new Field("txt", rs.getString("subject"), Field.Store.NO,
Field.Index.ANALYZED));"""

but how can i index a blob? 

the field txt is a blob ... with rs.geBlob(txt) ?

thank u

thank 
-- 
View this message in context: http://old.nabble.com/index-a-mysql-database----blob-field-tp27376053p27376053.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44770-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 20:06:51 2010
Return-Path: <java-user-return-44770-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50432 invoked from network); 29 Jan 2010 20:06:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 20:06:51 -0000
Received: (qmail 91557 invoked by uid 500); 29 Jan 2010 20:06:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91475 invoked by uid 500); 29 Jan 2010 20:06:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91465 invoked by uid 99); 29 Jan 2010 20:06:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 20:06:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 20:06:39 +0000
Received: by bwz22 with SMTP id 22so1737078bwz.5
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 12:06:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=eq8rwbyuqqU6p79yRRnJHj6sKveGkdP+cBb8UxHfIyg=;
        b=wtjucs5MDpd7847rhIRcyEBTwkIp0C+LvTC1zEN5FKbY/5/A5Gk02zoCskmxVs1bfl
         PTRp2QWV25m9KYxRzn9jKoss98ErRkTTsZ1Y/98H1U/PxTgMlTJcuDwJxV6YXWhcS6Dl
         yg4lawVszPLqWisp2Gwf9BFSkCk/ghXBCY970=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=h8mtiq73JAZMn0OQYCjuIcTsz3YDCVmB7rsBcHSuOS5STBbQ/909Q4UTBnpQ2SrZUS
         JbkIcCBynlQGd+69E6rgOASy8YeULv5LJw7E2pz7wkO413RVd2goI6SiyuM6VRJ6aWZl
         BwctOcP9o9bPxlMsXheowcb5w/M4COrb+to2Q=
MIME-Version: 1.0
Received: by 10.204.20.142 with SMTP id f14mr861209bkb.64.1264795579360; Fri, 
	29 Jan 2010 12:06:19 -0800 (PST)
In-Reply-To: <27376053.post@talk.nabble.com>
References: <27376053.post@talk.nabble.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Fri, 29 Jan 2010 20:05:59 +0000
Message-ID: <8c4e68611001291205g3df96d4bq547c06bec3fa490a@mail.gmail.com>
Subject: Re: index a mysql database -blob field
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Search google for converting mysql BLOBs to text.  Or look at the
ResultSet stream methods in conjunction with the Field constructors
that take Readers.

Maybe something like
 new Field(txt, new InputStreamReader(rs.getBinaryStream(txt))


--
Ian.


On Fri, Jan 29, 2010 at 6:10 PM, luciusvorenus
<lucius.vorenus@hotmail.de> wrote:
>
> helo
>
> One more question to blob :
>
> ""d.add(new Field("txt", rs.getString("subject"), Field.Store.NO,
> Field.Index.ANALYZED));"""
>
> but how can i index a blob?
>
> the field txt is a blob ... with rs.geBlob(txt) ?
>
> thank u
>
> thank

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44771-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 21:39:31 2010
Return-Path: <java-user-return-44771-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80635 invoked from network); 29 Jan 2010 21:39:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 21:39:31 -0000
Received: (qmail 16347 invoked by uid 500); 29 Jan 2010 21:39:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16282 invoked by uid 500); 29 Jan 2010 21:39:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16272 invoked by uid 99); 29 Jan 2010 21:39:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 21:39:28 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [134.96.191.147] (HELO smtp.dfki.de) (134.96.191.147)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 21:39:20 +0000
Received: from smtp.dfki.de (localhost [127.0.0.1])
	by imss.7 (Postfix) with ESMTP id 13E4D318C7
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 22:38:58 +0100 (CET)
Received: from mail.dfki.de (lnv-104.sb.dfki.de [134.96.191.146])
	by smtp.dfki.de (Postfix) with ESMTP id 01F4E318C2
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 22:38:58 +0100 (CET)
Received: from [192.168.178.47] (srbk-4db7e4e3.pool.mediaWays.net [77.183.228.227])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.dfki.de (Postfix) with ESMTPSA id D347F31168
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 22:38:57 +0100 (CET)
Message-Id: <F41AC5B8-34EA-4B58-87F4-AB795E9F5506@activemath.org>
From: Paul Libbrecht <paul@activemath.org>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v936)
Subject: "one of the terms"
Date: Fri, 29 Jan 2010 22:38:56 +0100
X-Mailer: Apple Mail (2.936)


Hello luceners,

In our project, we are building queries from long list of possible  
terms (expanded through ontology deduction). I would like, however,  
that the rank is unaffected by the number of matches: one or thirty  
occurrences of one of the many words should give the same score.

Did someone make such a query already?
Should I "just craft the Similarity"? (I'd rather avoid it if possible)

thanks in advance

paul

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44772-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 22:09:42 2010
Return-Path: <java-user-return-44772-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95726 invoked from network); 29 Jan 2010 22:09:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 22:09:42 -0000
Received: (qmail 67807 invoked by uid 500); 29 Jan 2010 22:09:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67744 invoked by uid 500); 29 Jan 2010 22:09:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67734 invoked by uid 99); 29 Jan 2010 22:09:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 22:09:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Kuro@basistech.com designates 199.88.205.136 as permitted sender)
Received: from [199.88.205.136] (HELO mailer.basistech.com) (199.88.205.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 22:09:30 +0000
Received: from mail.basistech.com (internal.basistech.net [10.1.250.1])
	by mailer.basistech.com (Postfix) with ESMTP id 2D3CA368BF
	for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 17:09:08 -0500 (EST)
X-DKIM: Sendmail DKIM Filter v2.8.3 mailer.basistech.com 2D3CA368BF
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=basistech.com;
	s=basis09aug; t=1264802948;
	bh=XRSoy+pO8N0dym5qohE0tK+CmkhjKjAibFFSFOKHVWc=;
	h=From:To:Date:Subject:Message-ID:References:In-Reply-To:
	 Content-Type:Content-Transfer-Encoding:MIME-Version;
	b=PSPU3Wfw91PRJg39+EyEab2pTH0W9VM92pUL2DC0pDU2nsc4NASpUdjOtdyL6skxT
	 INCWgJpVBhcm6fzEkfM6eNQcSAcoy0yjgwZwKxIr8aFOrRitP0G+GoidIa2+vfNPy8
	 MLDKxuQBHBbfZ04IrCJat14wQc30rhA+MFKAxTPE=
Received: from MSG-BOX.basistech.net ([::1]) by MSG-BOX.basistech.net ([::1])
 with mapi; Fri, 29 Jan 2010 17:09:09 -0500
From: Teruhiko Kurosaka <Kuro@basistech.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 29 Jan 2010 17:09:07 -0500
Subject: RE: index demo throws LockObtainFailedException
Thread-Topic: index demo throws LockObtainFailedException
Thread-Index: Acqgy4/+eJmgBBX/R0ed5oaxu7UYMwAY9cyw
Message-ID: <CAE8639A6FAB3D4AA7973D5897B325185F4CB7E27E@MSG-BOX.basistech.net>
References: <CAE8639A6FAB3D4AA7973D5897B325185F4CB7E1F7@MSG-BOX.basistech.net>
 <9ac0c6aa1001290211m2c954dcfm25e8ace89209e541@mail.gmail.com>
In-Reply-To: <9ac0c6aa1001290211m2c954dcfm25e8ace89209e541@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Thank you, Otis and Mike!
I verified that the older verison of Lucene (2.3.1)
works w/o a problem like this on this machine.

Kuro


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44773-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Jan 29 23:14:30 2010
Return-Path: <java-user-return-44773-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17836 invoked from network); 29 Jan 2010 23:14:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 29 Jan 2010 23:14:29 -0000
Received: (qmail 24506 invoked by uid 500); 29 Jan 2010 23:14:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24427 invoked by uid 500); 29 Jan 2010 23:14:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24417 invoked by uid 99); 29 Jan 2010 23:14:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 23:14:27 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 59.106.19.174 is neither permitted nor denied by domain of koji@r.email.ne.jp)
Received: from [59.106.19.174] (HELO www724.sakura.ne.jp) (59.106.19.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 29 Jan 2010 23:14:18 +0000
Received: from koji-sekiguchi-no-macbook.local (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	(authenticated bits=0)
	by www724.sakura.ne.jp (8.14.3/8.14.3) with ESMTP id o0TNDuiC063200
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 08:13:56 +0900 (JST)
	(envelope-from koji@r.email.ne.jp)
Message-ID: <4B636BB4.7090507@r.email.ne.jp>
Date: Sat, 30 Jan 2010 08:13:56 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.23 (Macintosh/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: FastVectorHighlighter and query with multiple fields
References: <27373932.post@talk.nabble.com>
In-Reply-To: <27373932.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Marc Sturlese wrote:
> I have FastVectorHighlighter working with a query like:
> title:Ipod OR title:IPad
>
> but it's not working when (0 snippets are returned):
> title:Ipod OR content:IPad
>
>   
This is true when you are going to highlight IPad in title field and
set fieldMatch to true at the FVH constructor. If you set fieldMatch
to true, try setting to false.

Koji

-- 
http://www.rondhuit.com/en/


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44774-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 00:12:59 2010
Return-Path: <java-user-return-44774-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29294 invoked from network); 30 Jan 2010 00:12:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 00:12:59 -0000
Received: (qmail 79340 invoked by uid 500); 30 Jan 2010 00:12:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79256 invoked by uid 500); 30 Jan 2010 00:12:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79246 invoked by uid 99); 30 Jan 2010 00:12:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 00:12:57 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of franz.see@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 00:12:47 +0000
Received: by pxi16 with SMTP id 16so2464711pxi.29
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 16:12:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=v08AG5HKFQ6PSPiHjyAMjDM8e+EhuZsonr3ShTRc1tM=;
        b=ukcghMqJOpRA0XRuonwCd9TNtojTioGLbkUySILFcyaWhw+uTYYhStN6J06SigdPlU
         Sb1+HikxcGPOFom04Zy/HWdjY/nZxCVJICQNpPub4q6zDsVQWxPhPqJG5uChzbaSkBWW
         MjxghRqM/ycqMk5xMv2xnRKO/uqIYn7+2Ga0M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=SmB+M+AF6VNT3SOl/2aCym6BBw1w32Z3oiL/Ty1gTsbXehRcl38TqN/EwWGTXEYmJ4
         q4dmuxv3cTmB0Dq+6yECgNTUqg32WszswGMCXn2Dj3k4AqgX0A22SLcvCDon0QNW+GN9
         pY5Qj4VSti/GYQpsuQNvBC3UkijHBiJv9uCjc=
MIME-Version: 1.0
Received: by 10.114.188.23 with SMTP id l23mr1045342waf.40.1264810346748; Fri, 
	29 Jan 2010 16:12:26 -0800 (PST)
In-Reply-To: <8c4e68611001290242k4cb7d6e4v58048f0d7854228f@mail.gmail.com>
References: <5b254f71001281943q6d015c3ak6a7c43ce78670287@mail.gmail.com>
	 <8c4e68611001290242k4cb7d6e4v58048f0d7854228f@mail.gmail.com>
Date: Sat, 30 Jan 2010 08:12:26 +0800
Message-ID: <5b254f71001291612jcce8f2fha8f9360297da3f42@mail.gmail.com>
Subject: Re: Modifying IDF
From: Franz Allan Valencia See <franz.see@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64cb4546d1d11047e569b94

--0016e64cb4546d1d11047e569b94
Content-Type: text/plain; charset=ISO-8859-1

How should I go about identifying the domain?

Thanks,

-- 
Franz Allan Valencia See | Java Software Engineer
franz.see@gmail.com
LinkedIn: http://www.linkedin.com/in/franzsee
Twitter: http://www.twitter.com/franz_see

On Fri, Jan 29, 2010 at 6:42 PM, Ian Lea <ian.lea@gmail.com> wrote:

> Instead of playing around with tf/idf, how about just indexing and
> searching the domain.
>
>
> --
> Ian.
>
>
> On Fri, Jan 29, 2010 at 3:43 AM, Franz Allan Valencia See
> <franz.see@gmail.com> wrote:
> > Good day,
> >
> > I am currently using lucene for my searches. And one of the problems that
> Im
> > facing is when keyword is a url. The tokens such as http, https, ://,
> index,
> > html, etc seems to be messing up with our search results. The focus was
> > supposed to be only on the url domain.
> >
> > The idea that I have is modify the idf so that rare terms get boosted
> much
> > more than the default settings in lucene. Since there are probably a lot
> of
> > http, https://, etc, then matches to these terms should be really really
> > low, while matches to the domain (which is rare) should be high.
> >
> > Would this work or am I totally misunderstanding lucene's tf/idf? :-)
> >
> > Thanks,
> >
> > --
> > Franz Allan Valencia See | Java Software Engineer
> > franz.see@gmail.com
> > LinkedIn: http://www.linkedin.com/in/franzsee
> > Twitter: http://www.twitter.com/franz_see
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64cb4546d1d11047e569b94--

From java-user-return-44775-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 05:28:46 2010
Return-Path: <java-user-return-44775-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4880 invoked from network); 30 Jan 2010 05:28:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 05:28:46 -0000
Received: (qmail 12579 invoked by uid 500); 30 Jan 2010 05:28:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12403 invoked by uid 500); 30 Jan 2010 05:28:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12393 invoked by uid 99); 30 Jan 2010 05:28:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 05:28:43 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [206.190.38.62] (HELO web50308.mail.re2.yahoo.com) (206.190.38.62)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 30 Jan 2010 05:28:32 +0000
Received: (qmail 6729 invoked by uid 60001); 30 Jan 2010 05:28:10 -0000
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=yahoo.com; s=s1024; t=1264829290; bh=S/hZQ8uJ8s9KijYl0W9Au1B1njYw2h4ZGZoIiA3DBJA=; h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type; b=eBsz36K/XoQyFbhXOHlK9R11nq4DK/rVWKw93FB92y/gS+jiSwr7KmZqP8IpwNCMoQ11oP9VRMe25TphmVKajp6ITAPEzgDejjFE8OfDihpFVgSBRsEQj0LXRnoXHZTCAgd4aQppzAZdq3C/N6Uxz+y24UbPPeNIMS1JvAu+Khk=
DomainKey-Signature:a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=Message-ID:X-YMail-OSG:Received:X-Mailer:References:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type;
  b=eo+41LaEBs5I1bj5fNpHaziEfJHaRg5KFqqCwWsP4l2kbX6/UrMXgmfoAEdvHBswzZ48fWli/dZWYj6+j4Hf2FUFH55xzKkz6rz9neU/p4kRWmqLDn93EtJaGB38hxacqaLYv2Majh/iZsWiIkjAtuwzWpXHONvT87pkhyk+uHo=;
Message-ID: <498740.5879.qm@web50308.mail.re2.yahoo.com>
X-YMail-OSG: e15d1bsVM1lsek_r7nUYzAQ89yXn8R47aCqThEkP_pFi9vcENHQUWRVZkdz2AYjeT_2MkiCOBWstAd7wv5zNr4BXZw55hvXcNcwQ1oZHWautO1tnTjMLlLKnvuWtkR.10QJ.0FZAGFxmj1k4nozMTK1QXW9VBnGcbX2L5JBrD9xyTnZfkyAT_gE9frWKHUEqXCH27EzOgBbd1.dQT0PTuOWDHF7JnjN0dovGYlBbRvQL6rmzWGjPCHcO2aTxqOOl9y6KvZ41AusMMH9xi3k3HKsUABNDiQMUyAgo42vWaBjKlendhqy1EYKhzQzJ.0YdTkV50cZHfE9WarN1N4nfAZNl3UbqG7yDDGCBL5m7B69WGsy15XACVqGRGU5vXXhLItLdNmjzZTYqrw.tOVwJziExH5mNxLrE_ATBolAFkn0Ph7Xyc6OGsg4Ptv6ArCRH8sNPd0UimfcLC6M.HBc-
Received: from [74.72.161.166] by web50308.mail.re2.yahoo.com via HTTP; Fri, 29 Jan 2010 21:28:10 PST
X-Mailer: YahooMailRC/272.7 YahooMailWebService/0.8.100.260964
References: <F41AC5B8-34EA-4B58-87F4-AB795E9F5506@activemath.org>
Date: Fri, 29 Jan 2010 21:28:10 -0800 (PST)
From: Otis Gospodnetic <otis_gospodnetic@yahoo.com>
Subject: Re: "one of the terms"
To: java-user@lucene.apache.org
In-Reply-To: <F41AC5B8-34EA-4B58-87F4-AB795E9F5506@activemath.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Virus-Checked: Checked by ClamAV on apache.org

Paul,

Custom Similarity perhaps, oui.  Not 100% sure, maybe have this always return 1.0f.


  /** Computes a score factor based on the fraction of all query terms that a
   * document contains.  This value is multiplied into scores.
   *
   * The presence of a large portion of the query terms indicates a better
   * match with the query, so implementations of this method usually return
   * larger values when the ratio between these parameters is large and smaller
   * values when the ratio between them is small.
   *
   * @param overlap the number of query terms matched in the document
   * @param maxOverlap the total number of terms in the query
   * @return a score factor based on term overlap with the query
   */
  public abstract float coord(int overlap, int maxOverlap);

Otis
----
Sematext :: http://sematext.com/ :: Solr - Lucene - Nutch
Hadoop ecosystem search :: http://search-hadoop.com/



----- Original Message ----
> From: Paul Libbrecht <paul@activemath.org>
> To: java-user@lucene.apache.org
> Sent: Fri, January 29, 2010 4:38:56 PM
> Subject: "one of the terms"
> 
> 
> Hello luceners,
> 
> In our project, we are building queries from long list of possible terms 
> (expanded through ontology deduction). I would like, however, that the rank is 
> unaffected by the number of matches: one or thirty occurrences of one of the 
> many words should give the same score.
> 
> Did someone make such a query already?
> Should I "just craft the Similarity"? (I'd rather avoid it if possible)
> 
> thanks in advance
> 
> paul
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44776-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 05:39:35 2010
Return-Path: <java-user-return-44776-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9298 invoked from network); 30 Jan 2010 05:39:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 05:39:35 -0000
Received: (qmail 17400 invoked by uid 500); 30 Jan 2010 05:39:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17282 invoked by uid 500); 30 Jan 2010 05:39:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17272 invoked by uid 99); 30 Jan 2010 05:39:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 05:39:31 +0000
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jake.mannix@gmail.com designates 209.85.216.186 as permitted sender)
Received: from [209.85.216.186] (HELO mail-px0-f186.google.com) (209.85.216.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 05:39:22 +0000
Received: by pxi16 with SMTP id 16so2713277pxi.29
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 21:39:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :date:message-id:subject:from:to:content-type;
        bh=F0SZpZUVENjJFKMAzpfqtQPJTzMJuHS9YBcPO8thcxY=;
        b=AU3jXFBtUBvHQ+T814MRUCxqScvAEItR3BrDJAR0lAHioAzE3DokIxm5yqrF6HO/X1
         HmAvA/c2eAIm9fbVUVpG7Wr2spBB1qhOGcVt2lJdL0VJ+fiueuf69iwxclOvHPzhlIiC
         XMkFfXeyat0q4hPqMhdbVt42ORJdKigfoAvb8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        b=vczk0k7tVU5CFHQ2hCIE24FmIg/MNVJhhLoirroEQG84pU4YbM1u8M/46R2TC2Wy+x
         p8UJ2voFvFWUX92VvfmQklMs32bCb1zuaE8u/1sDzLcbxCvjnJso8kO2A1gkUMMlf61O
         xtcchEnCY37fLiceF6DWszWsS6VaVRDoyfwho=
MIME-Version: 1.0
Received: by 10.114.249.31 with SMTP id w31mr1182747wah.59.1264829941742; Fri, 
	29 Jan 2010 21:39:01 -0800 (PST)
In-Reply-To: <498740.5879.qm@web50308.mail.re2.yahoo.com>
References: <F41AC5B8-34EA-4B58-87F4-AB795E9F5506@activemath.org>
	 <498740.5879.qm@web50308.mail.re2.yahoo.com>
Date: Fri, 29 Jan 2010 21:39:01 -0800
Message-ID: <4b124c311001292139m7724cd5ct3702aa41a621cf49@mail.gmail.com>
Subject: Re: "one of the terms"
From: Jake Mannix <jake.mannix@gmail.com>
To: java-user@lucene.apache.org
Content-Type: multipart/alternative; boundary=0016e64caf8860ff32047e5b2bdd

--0016e64caf8860ff32047e5b2bdd
Content-Type: text/plain; charset=ISO-8859-1

coord won't help him, I don't think.

Doesn't he just want a DisjunctionMaxQuery instead of BooleanQuery?

  -jake

On Fri, Jan 29, 2010 at 9:28 PM, Otis Gospodnetic <
otis_gospodnetic@yahoo.com> wrote:

> Paul,
>
> Custom Similarity perhaps, oui.  Not 100% sure, maybe have this always
> return 1.0f.
>
>
>  /** Computes a score factor based on the fraction of all query terms that
> a
>   * document contains.  This value is multiplied into scores.
>   *
>   * The presence of a large portion of the query terms indicates a better
>   * match with the query, so implementations of this method usually return
>   * larger values when the ratio between these parameters is large and
> smaller
>   * values when the ratio between them is small.
>   *
>   * @param overlap the number of query terms matched in the document
>   * @param maxOverlap the total number of terms in the query
>   * @return a score factor based on term overlap with the query
>   */
>  public abstract float coord(int overlap, int maxOverlap);
>
> Otis
> ----
> Sematext :: http://sematext.com/ :: Solr - Lucene - Nutch
> Hadoop ecosystem search :: http://search-hadoop.com/
>
>
>
> ----- Original Message ----
> > From: Paul Libbrecht <paul@activemath.org>
> > To: java-user@lucene.apache.org
> > Sent: Fri, January 29, 2010 4:38:56 PM
> > Subject: "one of the terms"
> >
> >
> > Hello luceners,
> >
> > In our project, we are building queries from long list of possible terms
> > (expanded through ontology deduction). I would like, however, that the
> rank is
> > unaffected by the number of matches: one or thirty occurrences of one of
> the
> > many words should give the same score.
> >
> > Did someone make such a query already?
> > Should I "just craft the Similarity"? (I'd rather avoid it if possible)
> >
> > thanks in advance
> >
> > paul
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

--0016e64caf8860ff32047e5b2bdd--

From java-user-return-44777-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 05:44:50 2010
Return-Path: <java-user-return-44777-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11352 invoked from network); 30 Jan 2010 05:44:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 05:44:50 -0000
Received: (qmail 22220 invoked by uid 500); 30 Jan 2010 05:44:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22059 invoked by uid 500); 30 Jan 2010 05:44:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22049 invoked by uid 99); 30 Jan 2010 05:44:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 05:44:47 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 209.85.217.209 as permitted sender)
Received: from [209.85.217.209] (HELO mail-gx0-f209.google.com) (209.85.217.209)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 05:44:39 +0000
Received: by gxk1 with SMTP id 1so401461gxk.11
        for <java-user@lucene.apache.org>; Fri, 29 Jan 2010 21:44:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from
         :user-agent:mime-version:to:subject:references:in-reply-to
         :content-type:content-transfer-encoding;
        bh=lz3Nr1+sMLOHjeTOP+iEkUiSdhbu6ZBvc2io5jMgWfA=;
        b=s9MHDqqaFPchB23Ux8Eg8UztEte0AW5zcwMLe+6DxcwYPv07FzxsIQyH9WGAZL0Ig+
         toFt1wYCA6gEOUTizhoxhfrUf6oqdwxAXSUb0q6mMeJrWmnPWXyLHu3AC6Q1IrzJndeU
         yMsPurlu/r8YB1OxFe+WV8+myF0UT8JIzzz3I=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=message-id:date:from:user-agent:mime-version:to:subject:references
         :in-reply-to:content-type:content-transfer-encoding;
        b=onYtOOz0ohctjJLkuVf5FxINHEHXPfUv8CppbnA5VXiaRoDiT5fP6alx6PBZA4t/kK
         ge6GYU7vbT8Pjcd9wPNL6e8a2UpPHB/NjIiKSuyp+uJn+UzbiKObMgtYQ/oevFQAqNcL
         3bLBhlQTemqo4HaxZfki1M6WxEO3zypjB+mZE=
Received: by 10.90.246.19 with SMTP id t19mr1731930agh.119.1264830257499;
        Fri, 29 Jan 2010 21:44:17 -0800 (PST)
Received: from ?192.168.1.100? (c-71-202-137-93.hsd1.ca.comcast.net [71.202.137.93])
        by mx.google.com with ESMTPS id 20sm980770ywh.32.2010.01.29.21.44.15
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 29 Jan 2010 21:44:16 -0800 (PST)
Message-ID: <4B63C70A.4010905@gmail.com>
Date: Fri, 29 Jan 2010 21:43:38 -0800
From: Chris Lu <chris.lu@gmail.com>
User-Agent: Thunderbird 2.0.0.23 (Windows/20090812)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: index a mysql database   -blob field
References: <27376053.post@talk.nabble.com>
In-Reply-To: <27376053.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

For blob, it is not so simple since BLOB could contain different file 
types, like HTML, pdf, word, zip file type.
So besides getting results out via resultSet.getBlob() function, you 
will need to convert the binary stream into simple text strings.

DBSight free version already can read the blog content, based on file 
name extension. You will need a file name extension, or some other way, 
to know what kind of BLOB content it contains.

Chris

-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes: http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
DBSight customer, a shopping comparison site, (anonymous per request) got 2.6 Million Euro funding!


luciusvorenus wrote:
> helo 
>
> One more question to blob :
>
> ""d.add(new Field("txt", rs.getString("subject"), Field.Store.NO,
> Field.Index.ANALYZED));"""
>
> but how can i index a blob? 
>
> the field txt is a blob ... with rs.geBlob(txt) ?
>
> thank u
>
> thank 
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44778-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 07:32:32 2010
Return-Path: <java-user-return-44778-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44555 invoked from network); 30 Jan 2010 07:32:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 07:32:32 -0000
Received: (qmail 50068 invoked by uid 500); 30 Jan 2010 07:32:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49924 invoked by uid 500); 30 Jan 2010 07:32:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49914 invoked by uid 99); 30 Jan 2010 07:32:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 07:32:28 +0000
X-ASF-Spam-Status: No, hits=2.7 required=10.0
	tests=HTML_IMAGE_RATIO_02,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luocan19826164@sohu.com designates 61.135.132.136 as permitted sender)
Received: from [61.135.132.136] (HELO relay.mail.sohu.com) (61.135.132.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 07:32:20 +0000
Received: from 85737ec54efc4e1 (unknown [121.34.180.27])
	by relay.mail.sohu.com (Postfix) with ESMTPA id CC7EB40901F2
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 15:31:09 +0800 (CST)
From: "luocanrao" <luocan19826164@sohu.com>
To: <java-user@lucene.apache.org>
Subject: MMapDirectory need twice more virtual memory than actually need?
Date: Sat, 30 Jan 2010 15:31:03 +0800
Message-ID: <000301caa17e$31201da0$936058e0$@com>
MIME-Version: 1.0
Content-Type: multipart/related;
	boundary="----=_NextPart_000_0004_01CAA1C1.3F435DA0"
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqhfivRM/omb9A4T6SRd/XzNYfX0A==
Content-Language: zh-cn
x-cr-hashedpuzzle: ALJU A9V7 CaqN CdY/ Dnmi D9k9 EAjn FaQ0 FeEm Fod/ Fs8N F6nw F7pX Gbyi IHwO IkeF;1;agBhAHYAYQAtAHUAcwBlAHIAQABsAHUAYwBlAG4AZQAuAGEAcABhAGMAaABlAC4AbwByAGcA;Sosha1_v1;7;{AFB3D96F-440D-493A-8D03-490A09601939};bAB1AG8AYwBhAG4AMQA5ADgAMgA2ADEANgA0AEAAcwBvAGgAdQAuAGMAbwBtAA==;Sat, 30 Jan 2010 07:31:00 GMT;TQBNAGEAcABEAGkAcgBlAGMAdABvAHIAeQAgAG4AZQBlAGQAIAB0AHcAaQBjAGUAIABtAG8AcgBlACAAdgBpAHIAdAB1AGEAbAAgAG0AZQBtAG8AcgB5ACAAdABoAGEAbgAgAGEAYwB0AHUAYQBsAGwAeQAgAG4AZQBlAGQAPwA=
x-cr-puzzleid: {AFB3D96F-440D-493A-8D03-490A09601939}
X-SOHU-Antispam-Bayes: 0

------=_NextPart_000_0004_01CAA1C1.3F435DA0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_001_0005_01CAA1C1.3F435DA0"


------=_NextPart_001_0005_01CAA1C1.3F435DA0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Environment: 64 bit linux,memory 8G

When I used pmap instruction to see virtual memory, I found two big anon
memory which grows with the index file size.

I had the two following pictures to show the problem, can you explain?

         This is why I got out of memory exception in 32 bit machine.
Because my index file size is only 800m.

                                                                 Anon memory
picture



                                                                 Indexfile
memory picture




------=_NextPart_001_0005_01CAA1C1.3F435DA0
Content-Type: text/html;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

<html xmlns:v=3D"urn:schemas-microsoft-com:vml" =
xmlns:o=3D"urn:schemas-microsoft-com:office:office" =
xmlns:w=3D"urn:schemas-microsoft-com:office:word" =
xmlns:m=3D"http://schemas.microsoft.com/office/2004/12/omml" =
xmlns=3D"http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=3DContent-Type content=3D"text/html; =
charset=3Dus-ascii">
<meta name=3DGenerator content=3D"Microsoft Word 12 (filtered medium)">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-priority:99;
	mso-style-link:"\6279\6CE8\6846\6587\672C Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:9.0pt;
	font-family:"Calibri","sans-serif";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.Char
	{mso-style-name:"\6279\6CE8\6846\6587\672C Char";
	mso-style-priority:99;
	mso-style-link:\6279\6CE8\6846\6587\672C;}
.MsoChpDefault
	{mso-style-type:export-only;}
 /* Page Definitions */
 @page Section1
	{size:612.0pt 792.0pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext=3D"edit" spidmax=3D"2050" />
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext=3D"edit">
  <o:idmap v:ext=3D"edit" data=3D"1" />
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=3DZH-CN link=3Dblue vlink=3Dpurple =
style=3D'text-justify-trim:punctuation'>

<div class=3DSection1>

<p class=3DMsoNormal style=3D'text-indent:21.0pt'><span =
lang=3DEN-US>Environment: 64 bit
linux,memory 8G<o:p></o:p></span></p>

<p class=3DMsoNormal style=3D'text-indent:21.0pt'><span =
lang=3DEN-US>When I used pmap
instruction to see virtual memory, I found two big anon memory which =
grows with
the index file size.<o:p></o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US>I had the two following pictures =
to show
the problem, can you explain?<o:p></o:p></span></p>

<p class=3DMsoNormal><span =
lang=3DEN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This
is why I got out of memory exception in 32 bit machine. Because my index =
file
size is only 800m.<o:p></o:p></span></p>

<p class=3DMsoNormal><span =
lang=3DEN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp; =
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp; Anon
memory picture<o:p></o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US><img width=3D535 height=3D58
id=3D"_x56fe__x7247__x0020_1" =
src=3D"cid:image001.png@01CAA1C1.0975DE00"></span><span
lang=3DEN-US><o:p></o:p></span></p>

<p class=3DMsoNormal><span =
lang=3DEN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Indexfile
memory picture<o:p></o:p></span></p>

<p class=3DMsoNormal><span lang=3DEN-US><img width=3D795 height=3D670
id=3D"_x56fe__x7247__x0020_2" =
src=3D"cid:image002.png@01CAA1C1.0975DE00"></span><span
lang=3DEN-US><o:p></o:p></span></p>

</div>

</body>

</html>

------=_NextPart_001_0005_01CAA1C1.3F435DA0--

------=_NextPart_000_0004_01CAA1C1.3F435DA0--


From java-user-return-44779-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 08:47:39 2010
Return-Path: <java-user-return-44779-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54593 invoked from network); 30 Jan 2010 08:47:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 08:47:38 -0000
Received: (qmail 74539 invoked by uid 500); 30 Jan 2010 08:47:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74442 invoked by uid 500); 30 Jan 2010 08:47:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74431 invoked by uid 99); 30 Jan 2010 08:47:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 08:47:36 +0000
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=HTML_IMAGE_RATIO_02,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 08:47:25 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id A942A45F762
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 09:47:04 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 7IdR44O+-yXK for <java-user@lucene.apache.org>;
	Sat, 30 Jan 2010 09:46:50 +0100 (CET)
Received: from VEGA (port-83-236-62-54.dynamic.qsc.de [83.236.62.54])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 020CA45F72B
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 09:46:49 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <000301caa17e$31201da0$936058e0$@com>
In-Reply-To: <000301caa17e$31201da0$936058e0$@com>
Subject: RE: MMapDirectory need twice more virtual memory than actually need?
Date: Sat, 30 Jan 2010 09:47:02 +0100
Message-ID: <000c01caa188$cb4f0c60$61ed2520$@de>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_000D_01CAA191.2D137460"
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqhfivRM/omb9A4T6SRd/XzNYfX0AAClTtA
Content-Language: de
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_000D_01CAA191.2D137460
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable

MMapDirectory should only be used on 64bit machines with 64bit JVMs. =
This is described in the Javadocs.

The additional sizes are caused by reopens and have their reason in =
specialties with the Java VM, described in 2.9/3.0 Javadocs of the =
class, please take a look. You can also enable a workaround for the =
missing =E2=80=9Cunmap=E2=80=9D call.

=20

-----

Uwe Schindler

H.-H.-Meier-Allee 63, D-28213 Bremen

 <http://www.thetaphi.de/> http://www.thetaphi.de

eMail: uwe@thetaphi.de

=20

From: luocanrao [mailto:luocan19826164@sohu.com]=20
Sent: Saturday, January 30, 2010 8:31 AM
To: java-user@lucene.apache.org
Subject: MMapDirectory need twice more virtual memory than actually =
need?

=20

Environment: 64 bit linux,memory 8G

When I used pmap instruction to see virtual memory, I found two big anon =
memory which grows with the index file size.

I had the two following pictures to show the problem, can you explain?

         This is why I got out of memory exception in 32 bit machine. =
Because my index file size is only 800m.

                                                                 Anon =
memory picture



                                                                 =
Indexfile memory picture




------=_NextPart_000_000D_01CAA191.2D137460--


From java-user-return-44780-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 09:38:04 2010
Return-Path: <java-user-return-44780-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64424 invoked from network); 30 Jan 2010 09:38:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 09:38:04 -0000
Received: (qmail 92748 invoked by uid 500); 30 Jan 2010 09:38:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92658 invoked by uid 500); 30 Jan 2010 09:38:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92648 invoked by uid 99); 30 Jan 2010 09:38:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 09:38:01 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of luocan19826164@sohu.com designates 61.135.132.86 as permitted sender)
Received: from [61.135.132.86] (HELO relay.mail.sohu.com) (61.135.132.86)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 09:37:50 +0000
Received: from 85737ec54efc4e1 (unknown [121.34.180.27])
	by relay.mail.sohu.com (Postfix) with ESMTPA id AF261698485
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 17:37:20 +0800 (CST)
From: "luocanrao" <luocan19826164@sohu.com>
To: <java-user@lucene.apache.org>
References: <000301caa17e$31201da0$936058e0$@com> <000c01caa188$cb4f0c60$61ed2520$@de>
In-Reply-To: <000c01caa188$cb4f0c60$61ed2520$@de>
Subject: =?utf-8?Q?=E7=AD=94=E5=A4=8D:_MMapDirectory_need_twice_mor?=
	=?utf-8?Q?e_virtual_memory_than_actually_n?=
	=?utf-8?Q?eed=3F?=
Date: Sat, 30 Jan 2010 17:37:19 +0800
Message-ID: <000f01caa18f$d4321e10$7c965a30$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqhfivRM/omb9A4T6SRd/XzNYfX0AAClTtAAAFM00A=
Content-Language: zh-cn
X-SOHU-Antispam-Bayes: 0
X-Virus-Checked: Checked by ClamAV on apache.org

Uwe Schindler ,thanks for your reply.
First,I did not use reopens method, even when I start the my program, I =
can see this two big anon memory at once.
Second,if I miss unmap,I will see some other index file map to virtual =
memory other than anon memory.
 =20
-----=E9=82=AE=E4=BB=B6=E5=8E=9F=E4=BB=B6-----
=E5=8F=91=E4=BB=B6=E4=BA=BA: Uwe Schindler [mailto:uwe@thetaphi.de]=20
=E5=8F=91=E9=80=81=E6=97=B6=E9=97=B4: 2010=E5=B9=B41=E6=9C=8830=E6=97=A5 =
16:47
=E6=94=B6=E4=BB=B6=E4=BA=BA: java-user@lucene.apache.org
=E4=B8=BB=E9=A2=98: RE: MMapDirectory need twice more virtual memory =
than actually need?

MMapDirectory should only be used on 64bit machines with 64bit JVMs. =
This is described in the Javadocs.

The additional sizes are caused by reopens and have their reason in =
specialties with the Java VM, described in 2.9/3.0 Javadocs of the =
class, please take a look. You can also enable a workaround for the =
missing =E2=80=9Cunmap=E2=80=9D call.

=20

-----

Uwe Schindler

H.-H.-Meier-Allee 63, D-28213 Bremen

 <http://www.thetaphi.de/> http://www.thetaphi.de

eMail: uwe@thetaphi.de

=20

From: luocanrao [mailto:luocan19826164@sohu.com]=20
Sent: Saturday, January 30, 2010 8:31 AM
To: java-user@lucene.apache.org
Subject: MMapDirectory need twice more virtual memory than actually =
need?

=20

Environment: 64 bit linux,memory 8G

When I used pmap instruction to see virtual memory, I found two big anon =
memory which grows with the index file size.

I had the two following pictures to show the problem, can you explain?

         This is why I got out of memory exception in 32 bit machine. =
Because my index file size is only 800m.

                                                                 Anon =
memory picture



                                                                 =
Indexfile memory picture





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44781-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 09:42:43 2010
Return-Path: <java-user-return-44781-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66589 invoked from network); 30 Jan 2010 09:42:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 09:42:43 -0000
Received: (qmail 95423 invoked by uid 500); 30 Jan 2010 09:42:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95379 invoked by uid 500); 30 Jan 2010 09:42:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95369 invoked by uid 99); 30 Jan 2010 09:42:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 09:42:40 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of luocan19826164@sohu.com designates 61.135.132.132 as permitted sender)
Received: from [61.135.132.132] (HELO relay.mail.sohu.com) (61.135.132.132)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 09:42:29 +0000
Received: from 85737ec54efc4e1 (unknown [121.34.180.27])
	by relay.mail.sohu.com (Postfix) with ESMTPA id 6AA16459030
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 17:42:13 +0800 (CST)
From: "luocanrao" <luocan19826164@sohu.com>
To: <java-user@lucene.apache.org>
References: <000301caa17e$31201da0$936058e0$@com> <000c01caa188$cb4f0c60$61ed2520$@de>
In-Reply-To: <000c01caa188$cb4f0c60$61ed2520$@de>
Subject: =?utf-8?Q?=E7=AD=94=E5=A4=8D:_MMapDirectory_need_twice_mor?=
	=?utf-8?Q?e_virtual_memory_than_actually_n?=
	=?utf-8?Q?eed=3F?=
Date: Sat, 30 Jan 2010 17:41:56 +0800
Message-ID: <001001caa190$7aee4a80$70cadf80$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqhfivRM/omb9A4T6SRd/XzNYfX0AAClTtAAAHe3TA=
Content-Language: zh-cn
X-SOHU-Antispam-Bayes: 0
X-Virus-Checked: Checked by ClamAV on apache.org

Ps=20
I use Sun JVMs, I will try setUseUnmap(true) to see whether anon memory =
disappear.

-----=E9=82=AE=E4=BB=B6=E5=8E=9F=E4=BB=B6-----
=E5=8F=91=E4=BB=B6=E4=BA=BA: Uwe Schindler [mailto:uwe@thetaphi.de]=20
=E5=8F=91=E9=80=81=E6=97=B6=E9=97=B4: 2010=E5=B9=B41=E6=9C=8830=E6=97=A5 =
16:47
=E6=94=B6=E4=BB=B6=E4=BA=BA: java-user@lucene.apache.org
=E4=B8=BB=E9=A2=98: RE: MMapDirectory need twice more virtual memory =
than actually need?

MMapDirectory should only be used on 64bit machines with 64bit JVMs. =
This is described in the Javadocs.

The additional sizes are caused by reopens and have their reason in =
specialties with the Java VM, described in 2.9/3.0 Javadocs of the =
class, please take a look. You can also enable a workaround for the =
missing =E2=80=9Cunmap=E2=80=9D call.

=20

-----

Uwe Schindler

H.-H.-Meier-Allee 63, D-28213 Bremen

 <http://www.thetaphi.de/> http://www.thetaphi.de

eMail: uwe@thetaphi.de

=20

From: luocanrao [mailto:luocan19826164@sohu.com]=20
Sent: Saturday, January 30, 2010 8:31 AM
To: java-user@lucene.apache.org
Subject: MMapDirectory need twice more virtual memory than actually =
need?

=20

Environment: 64 bit linux,memory 8G

When I used pmap instruction to see virtual memory, I found two big anon =
memory which grows with the index file size.

I had the two following pictures to show the problem, can you explain?

         This is why I got out of memory exception in 32 bit machine. =
Because my index file size is only 800m.

                                                                 Anon =
memory picture



                                                                 =
Indexfile memory picture





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44782-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 11:48:33 2010
Return-Path: <java-user-return-44782-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99518 invoked from network); 30 Jan 2010 11:48:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 11:48:33 -0000
Received: (qmail 56403 invoked by uid 500); 30 Jan 2010 11:48:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56309 invoked by uid 500); 30 Jan 2010 11:48:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56298 invoked by uid 99); 30 Jan 2010 11:48:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 11:48:30 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 11:48:22 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NbBo1-0004QH-SY
	for java-user@lucene.apache.org; Sat, 30 Jan 2010 03:48:01 -0800
Message-ID: <27383178.post@talk.nabble.com>
Date: Sat, 30 Jan 2010 03:48:01 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: Re: index a mysql database   -blob field
In-Reply-To: <4B63C70A.4010905@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: lucius.vorenus@hotmail.de
References: <27376053.post@talk.nabble.com> <4B63C70A.4010905@gmail.com>


 i try with dbsight and  when a try to type && retype my passwort:

"""Can not read Server Configuration file(WEB-INF/data/xsearch-config.xml).
You may avoid this by manually extract the war file."

I already extract the war file ...

Thank u Chris


chrislusf wrote:
> 
> For blob, it is not so simple since BLOB could contain different file 
> types, like HTML, pdf, word, zip file type.
> So besides getting results out via resultSet.getBlob() function, you 
> will need to convert the binary stream into simple text strings.
> 
> DBSight free version already can read the blog content, based on file 
> name extension. You will need a file name extension, or some other way, 
> to know what kind of BLOB content it contains.
> 
> Chris
> 
> -------------------------
> Instant Scalable Full-Text Search On Any Database/Application
> site: http://www.dbsight.net
> demo: http://search.dbsight.com
> Lucene Database Search in 3 minutes:
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> DBSight customer, a shopping comparison site, (anonymous per request) got
> 2.6 Million Euro funding!
> 
> 
> luciusvorenus wrote:
>> helo 
>>
>> One more question to blob :
>>
>> ""d.add(new Field("txt", rs.getString("subject"), Field.Store.NO,
>> Field.Index.ANALYZED));"""
>>
>> but how can i index a blob? 
>>
>> the field txt is a blob ... with rs.geBlob(txt) ?
>>
>> thank u
>>
>> thank 
>>   
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://old.nabble.com/index-a-mysql-database----blob-field-tp27376053p27383178.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44783-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 11:53:45 2010
Return-Path: <java-user-return-44783-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 897 invoked from network); 30 Jan 2010 11:53:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 11:53:45 -0000
Received: (qmail 59721 invoked by uid 500); 30 Jan 2010 11:53:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59653 invoked by uid 500); 30 Jan 2010 11:53:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59642 invoked by uid 99); 30 Jan 2010 11:53:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 11:53:42 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 11:53:33 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 1DAB145F940
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 12:53:11 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id yvKpIpWoH9VX for <java-user@lucene.apache.org>;
	Sat, 30 Jan 2010 12:53:01 +0100 (CET)
Received: from VEGA (port-83-236-62-54.dynamic.qsc.de [83.236.62.54])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id C007F45F92F
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 12:53:00 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <000301caa17e$31201da0$936058e0$@com> <000c01caa188$cb4f0c60$61ed2520$@de> <000f01caa18f$d4321e10$7c965a30$@com>
In-Reply-To: <000f01caa18f$d4321e10$7c965a30$@com>
Subject: RE: MMapDirectory need twice more virtual memory than actually need?
Date: Sat, 30 Jan 2010 12:53:13 +0100
Message-ID: <000001caa1a2$cda44830$68ecd890$@de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqhfivRM/omb9A4T6SRd/XzNYfX0AAClTtAAAFM00AABThPkA==
Content-Language: de

I am sorry, I cannot see your attached pictures, can you put them on a =
web server and link here? In general with 64 bit operating systems the =
usage of address space is no problem at all, because no real memory is =
wasted it is just allocated address space and there is enough available =
:-)

Uwe

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de

> -----Original Message-----
> From: luocanrao [mailto:luocan19826164@sohu.com]
> Sent: Saturday, January 30, 2010 10:37 AM
> To: java-user@lucene.apache.org
> Subject: =E7=AD=94=E5=A4=8D: MMapDirectory need twice more virtual =
memory than
> actually need?
>=20
> Uwe Schindler ,thanks for your reply.
> First,I did not use reopens method, even when I start the my program, =
I
> can see this two big anon memory at once.
> Second,if I miss unmap,I will see some other index file map to virtual
> memory other than anon memory.
>=20
> -----=E9=82=AE=E4=BB=B6=E5=8E=9F=E4=BB=B6-----
> =E5=8F=91=E4=BB=B6=E4=BA=BA: Uwe Schindler [mailto:uwe@thetaphi.de]
> =E5=8F=91=E9=80=81=E6=97=B6=E9=97=B4: =
2010=E5=B9=B41=E6=9C=8830=E6=97=A5 16:47
> =E6=94=B6=E4=BB=B6=E4=BA=BA: java-user@lucene.apache.org
> =E4=B8=BB=E9=A2=98: RE: MMapDirectory need twice more virtual memory =
than actually
> need?
>=20
> MMapDirectory should only be used on 64bit machines with 64bit JVMs.
> This is described in the Javadocs.
>=20
> The additional sizes are caused by reopens and have their reason in
> specialties with the Java VM, described in 2.9/3.0 Javadocs of the
> class, please take a look. You can also enable a workaround for the
> missing =E2=80=9Cunmap=E2=80=9D call.
>=20
>=20
>=20
> -----
>=20
> Uwe Schindler
>=20
> H.-H.-Meier-Allee 63, D-28213 Bremen
>=20
>  <http://www.thetaphi.de/> http://www.thetaphi.de
>=20
> eMail: uwe@thetaphi.de
>=20
>=20
>=20
> From: luocanrao [mailto:luocan19826164@sohu.com]
> Sent: Saturday, January 30, 2010 8:31 AM
> To: java-user@lucene.apache.org
> Subject: MMapDirectory need twice more virtual memory than actually
> need?
>=20
>=20
>=20
> Environment: 64 bit linux,memory 8G
>=20
> When I used pmap instruction to see virtual memory, I found two big
> anon memory which grows with the index file size.
>=20
> I had the two following pictures to show the problem, can you explain?
>=20
>          This is why I got out of memory exception in 32 bit machine.
> Because my index file size is only 800m.
>=20
>                                                                  Anon
> memory picture
>=20
>=20
>=20
>=20
> Indexfile memory picture
>=20
>=20
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44784-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 11:58:21 2010
Return-Path: <java-user-return-44784-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1712 invoked from network); 30 Jan 2010 11:58:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 11:58:21 -0000
Received: (qmail 63264 invoked by uid 500); 30 Jan 2010 11:58:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63180 invoked by uid 500); 30 Jan 2010 11:58:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63170 invoked by uid 99); 30 Jan 2010 11:58:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 11:58:18 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luocan19826164@sohu.com designates 61.135.132.136 as permitted sender)
Received: from [61.135.132.136] (HELO relay.mail.sohu.com) (61.135.132.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 11:58:08 +0000
Received: from 85737ec54efc4e1 (unknown [121.34.180.27])
	by relay.mail.sohu.com (Postfix) with ESMTPA id 144B43A59893
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 19:57:42 +0800 (CST)
From: "luocanrao" <luocan19826164@sohu.com>
To: <java-user@lucene.apache.org>
References: <000301caa17e$31201da0$936058e0$@com> <000c01caa188$cb4f0c60$61ed2520$@de>
In-Reply-To: <000c01caa188$cb4f0c60$61ed2520$@de>
Subject: =?utf-8?Q?=E7=AD=94=E5=A4=8D:_MMapDirectory_need_twice_mor?=
	=?utf-8?Q?e_virtual_memory_than_actually_n?=
	=?utf-8?Q?eed=3F?=
Date: Sat, 30 Jan 2010 19:57:35 +0800
Message-ID: <001101caa1a3$6d507110$47f15330$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqhfivRM/omb9A4T6SRd/XzNYfX0AAClTtAAAaMj+A=
Content-Language: zh-cn
X-SOHU-Antispam-Bayes: 0

I found this in http://osdir.com/ml/linux-kernel/2009-10/msg03503.html

   If application does mlockall(MCL_FUTURE) it is no longer possible to =
mmap=20
file bigger than main memory or allocate big area of anonymous memory=20
in a thread safe manner. Sometimes it is desirable to lock everything=20
related to program execution into memory, but still be able to mmap=20
big file or allocate huge amount of memory and allow OS to swap them on=20
demand. MAP_UNLOCKED allows to do that

  if  mmap method use MAP_UNLOCKED flag, this can expain everything.
  Is that right?

-----=E9=82=AE=E4=BB=B6=E5=8E=9F=E4=BB=B6-----
=E5=8F=91=E4=BB=B6=E4=BA=BA: Uwe Schindler [mailto:uwe@thetaphi.de]=20
=E5=8F=91=E9=80=81=E6=97=B6=E9=97=B4: 2010=E5=B9=B41=E6=9C=8830=E6=97=A5 =
16:47
=E6=94=B6=E4=BB=B6=E4=BA=BA: java-user@lucene.apache.org
=E4=B8=BB=E9=A2=98: RE: MMapDirectory need twice more virtual memory =
than actually need?

MMapDirectory should only be used on 64bit machines with 64bit JVMs. =
This is described in the Javadocs.

The additional sizes are caused by reopens and have their reason in =
specialties with the Java VM, described in 2.9/3.0 Javadocs of the =
class, please take a look. You can also enable a workaround for the =
missing =E2=80=9Cunmap=E2=80=9D call.

=20

-----

Uwe Schindler

H.-H.-Meier-Allee 63, D-28213 Bremen

 <http://www.thetaphi.de/> http://www.thetaphi.de

eMail: uwe@thetaphi.de

=20

From: luocanrao [mailto:luocan19826164@sohu.com]=20
Sent: Saturday, January 30, 2010 8:31 AM
To: java-user@lucene.apache.org
Subject: MMapDirectory need twice more virtual memory than actually =
need?

=20

Environment: 64 bit linux,memory 8G

When I used pmap instruction to see virtual memory, I found two big anon =
memory which grows with the index file size.

I had the two following pictures to show the problem, can you explain?

         This is why I got out of memory exception in 32 bit machine. =
Because my index file size is only 800m.

                                                                 Anon =
memory picture



                                                                 =
Indexfile memory picture





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44785-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 12:04:53 2010
Return-Path: <java-user-return-44785-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3109 invoked from network); 30 Jan 2010 12:04:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 12:04:53 -0000
Received: (qmail 71593 invoked by uid 500); 30 Jan 2010 12:04:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71512 invoked by uid 500); 30 Jan 2010 12:04:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71502 invoked by uid 99); 30 Jan 2010 12:04:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 12:04:50 +0000
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [85.25.71.29] (HELO mail.troja.net) (85.25.71.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 12:04:39 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.troja.net (Postfix) with ESMTP id 402CF45F9AE
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 13:04:19 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail.troja.net
Received: from mail.troja.net ([127.0.0.1])
	by localhost (megaira.troja.net [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id NoaRR02yEaHp for <java-user@lucene.apache.org>;
	Sat, 30 Jan 2010 13:04:08 +0100 (CET)
Received: from VEGA (port-83-236-62-54.dynamic.qsc.de [83.236.62.54])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mail.troja.net (Postfix) with ESMTPSA id 78FAD45F9AA
	for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 13:04:07 +0100 (CET)
From: "Uwe Schindler" <uwe@thetaphi.de>
To: <java-user@lucene.apache.org>
References: <000301caa17e$31201da0$936058e0$@com> <000c01caa188$cb4f0c60$61ed2520$@de> <001101caa1a3$6d507110$47f15330$@com>
In-Reply-To: <001101caa1a3$6d507110$47f15330$@com>
Subject: RE: MMapDirectory need twice more virtual memory than actually need?
Date: Sat, 30 Jan 2010 13:04:19 +0100
Message-ID: <000401caa1a4$5b326be0$119743a0$@de>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcqhfivRM/omb9A4T6SRd/XzNYfX0AAClTtAAAaMj+AAAE5AkA==
Content-Language: de
X-Virus-Checked: Checked by ClamAV on apache.org

I am sorry, we know nothing about how the JVM internally handles this. =
But we do not force it to map into memory! MMapDirectory just maps but =
does not call MappedByteBuffer.load(). So it is completely handled by =
the kernel when something is swapped in or not.

I have a server with 32 GB RAM that mapps about 100 GB files using =
JAVA's MappedByteBuffer into its address space and it still runs :-) =
(Solaris 64 bit, Java 5, no unmap hack).

-----
Uwe Schindler
H.-H.-Meier-Allee 63, D-28213 Bremen
http://www.thetaphi.de
eMail: uwe@thetaphi.de


> -----Original Message-----
> From: luocanrao [mailto:luocan19826164@sohu.com]
> Sent: Saturday, January 30, 2010 12:58 PM
> To: java-user@lucene.apache.org
> Subject: =E7=AD=94=E5=A4=8D: MMapDirectory need twice more virtual =
memory than
> actually need?
>=20
> I found this in http://osdir.com/ml/linux-kernel/2009-10/msg03503.html
>=20
>    If application does mlockall(MCL_FUTURE) it is no longer possible =
to
> mmap
> file bigger than main memory or allocate big area of anonymous memory
> in a thread safe manner. Sometimes it is desirable to lock everything
> related to program execution into memory, but still be able to mmap
> big file or allocate huge amount of memory and allow OS to swap them =
on
> demand. MAP_UNLOCKED allows to do that
>=20
>   if  mmap method use MAP_UNLOCKED flag, this can expain everything.
>   Is that right?
>=20
> -----=E9=82=AE=E4=BB=B6=E5=8E=9F=E4=BB=B6-----
> =E5=8F=91=E4=BB=B6=E4=BA=BA: Uwe Schindler [mailto:uwe@thetaphi.de]
> =E5=8F=91=E9=80=81=E6=97=B6=E9=97=B4: =
2010=E5=B9=B41=E6=9C=8830=E6=97=A5 16:47
> =E6=94=B6=E4=BB=B6=E4=BA=BA: java-user@lucene.apache.org
> =E4=B8=BB=E9=A2=98: RE: MMapDirectory need twice more virtual memory =
than actually
> need?
>=20
> MMapDirectory should only be used on 64bit machines with 64bit JVMs.
> This is described in the Javadocs.
>=20
> The additional sizes are caused by reopens and have their reason in
> specialties with the Java VM, described in 2.9/3.0 Javadocs of the
> class, please take a look. You can also enable a workaround for the
> missing =E2=80=9Cunmap=E2=80=9D call.
>=20
>=20
>=20
> -----
>=20
> Uwe Schindler
>=20
> H.-H.-Meier-Allee 63, D-28213 Bremen
>=20
>  <http://www.thetaphi.de/> http://www.thetaphi.de
>=20
> eMail: uwe@thetaphi.de
>=20
>=20
>=20
> From: luocanrao [mailto:luocan19826164@sohu.com]
> Sent: Saturday, January 30, 2010 8:31 AM
> To: java-user@lucene.apache.org
> Subject: MMapDirectory need twice more virtual memory than actually
> need?
>=20
>=20
>=20
> Environment: 64 bit linux,memory 8G
>=20
> When I used pmap instruction to see virtual memory, I found two big
> anon memory which grows with the index file size.
>=20
> I had the two following pictures to show the problem, can you explain?
>=20
>          This is why I got out of memory exception in 32 bit machine.
> Because my index file size is only 800m.
>=20
>                                                                  Anon
> memory picture
>=20
>=20
>=20
>=20
> Indexfile memory picture
>=20
>=20
>=20
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44786-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 17:59:42 2010
Return-Path: <java-user-return-44786-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93223 invoked from network); 30 Jan 2010 17:59:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 17:59:42 -0000
Received: (qmail 77588 invoked by uid 500); 30 Jan 2010 17:59:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77519 invoked by uid 500); 30 Jan 2010 17:59:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77509 invoked by uid 99); 30 Jan 2010 17:59:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 17:59:39 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ian.lea@gmail.com designates 209.85.218.222 as permitted sender)
Received: from [209.85.218.222] (HELO mail-bw0-f222.google.com) (209.85.218.222)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 17:59:28 +0000
Received: by bwz22 with SMTP id 22so2131417bwz.5
        for <java-user@lucene.apache.org>; Sat, 30 Jan 2010 09:59:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:received:in-reply-to:references
         :from:date:message-id:subject:to:content-type;
        bh=ojEzfLlT/3JKZGGNC1uP+KRAxx8yRPPeV3CQsO0gDsk=;
        b=LGyn3WsljsEK87tfmPomX9jIZcG0Y24DMrJZmOw9aAnAHyEkLI8TLFacN533FW2PNz
         lr8kLlbnTiJ0xvOnfs07B1WOgF+thEnTvEYNm8WPaJnmFUaFGomWH/VUX3rW6b7y7VQH
         qvHMESdfe0wA6KkvVuQMOTBcDkt5XdIymmL2w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        b=pkYVpiTUi/XgwQX8Ga4oSnyWQ/rL7GYi7qiNMObuosIqflicZNrcUdlY3SKIlHhYUg
         Ab3f6uuonYwYgOukeZlLzEkfabtGOyN3WtDzR2R1jhu9gOE0KuypLnTVEfMbRlmj7HRC
         BBjTatvlRLjTz8d1lzE3Ik9ZiAk87BnRleHn8=
MIME-Version: 1.0
Received: by 10.204.20.142 with SMTP id f14mr1550255bkb.64.1264874348182; Sat, 
	30 Jan 2010 09:59:08 -0800 (PST)
In-Reply-To: <5b254f71001291612jcce8f2fha8f9360297da3f42@mail.gmail.com>
References: <5b254f71001281943q6d015c3ak6a7c43ce78670287@mail.gmail.com> 
	<8c4e68611001290242k4cb7d6e4v58048f0d7854228f@mail.gmail.com> 
	<5b254f71001291612jcce8f2fha8f9360297da3f42@mail.gmail.com>
From: Ian Lea <ian.lea@gmail.com>
Date: Sat, 30 Jan 2010 17:58:48 +0000
Message-ID: <8c4e68611001300958w380968b0sc3cdb12152fecb96@mail.gmail.com>
Subject: Re: Modifying IDF
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

Are you asking how to get lucene.apache.org out of
http://lucene.apache.org/ or how to get apache.org out of
lucene.apache.org?  The getHost() method of java.net.URL will give you
the former. Or use a regexp.  I don't know an easy way to do the
latter, but depending on your requirements you could split
lucene.apache.org into tokens "lucene.apache.org" and "apache.org" and
"org" and index all of them.  You probably want to use an analyzer
that doesn't split on the . character.


--
Ian.


On Sat, Jan 30, 2010 at 12:12 AM, Franz Allan Valencia See
<franz.see@gmail.com> wrote:
> How should I go about identifying the domain?
>
> Thanks,
>
> --
> Franz Allan Valencia See | Java Software Engineer
> franz.see@gmail.com
> LinkedIn: http://www.linkedin.com/in/franzsee
> Twitter: http://www.twitter.com/franz_see
>
> On Fri, Jan 29, 2010 at 6:42 PM, Ian Lea <ian.lea@gmail.com> wrote:
>
>> Instead of playing around with tf/idf, how about just indexing and
>> searching the domain.
>>
>>
>> --
>> Ian.
>>
>>
>> On Fri, Jan 29, 2010 at 3:43 AM, Franz Allan Valencia See
>> <franz.see@gmail.com> wrote:
>> > Good day,
>> >
>> > I am currently using lucene for my searches. And one of the problems that
>> Im
>> > facing is when keyword is a url. The tokens such as http, https, ://,
>> index,
>> > html, etc seems to be messing up with our search results. The focus was
>> > supposed to be only on the url domain.
>> >
>> > The idea that I have is modify the idf so that rare terms get boosted
>> much
>> > more than the default settings in lucene. Since there are probably a lot
>> of
>> > http, https://, etc, then matches to these terms should be really really
>> > low, while matches to the domain (which is rare) should be high.
>> >
>> > Would this work or am I totally misunderstanding lucene's tf/idf? :-)
>> >
>> > Thanks,
>> >
>> > --
>> > Franz Allan Valencia See | Java Software Engineer
>> > franz.see@gmail.com
>> > LinkedIn: http://www.linkedin.com/in/franzsee
>> > Twitter: http://www.twitter.com/franz_see
>> >
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44787-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Jan 30 19:25:19 2010
Return-Path: <java-user-return-44787-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22831 invoked from network); 30 Jan 2010 19:25:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 30 Jan 2010 19:25:19 -0000
Received: (qmail 30957 invoked by uid 500); 30 Jan 2010 19:25:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30880 invoked by uid 500); 30 Jan 2010 19:25:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30870 invoked by uid 99); 30 Jan 2010 19:25:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 19:25:16 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 30 Jan 2010 19:25:07 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1NbIw2-0005mq-Ff
	for java-user@lucene.apache.org; Sat, 30 Jan 2010 11:24:46 -0800
Message-ID: <27386652.post@talk.nabble.com>
Date: Sat, 30 Jan 2010 11:24:46 -0800 (PST)
From: luciusvorenus <lucius.vorenus@hotmail.de>
To: java-user@lucene.apache.org
Subject: Re: index a mysql database   -blob field
In-Reply-To: <4B63C70A.4010905@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: lucius.vorenus@hotmail.de
References: <27376053.post@talk.nabble.com> <4B63C70A.4010905@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Ps.

I use tomcat 6 



chrislusf wrote:
> 
> For blob, it is not so simple since BLOB could contain different file 
> types, like HTML, pdf, word, zip file type.
> So besides getting results out via resultSet.getBlob() function, you 
> will need to convert the binary stream into simple text strings.
> 
> DBSight free version already can read the blog content, based on file 
> name extension. You will need a file name extension, or some other way, 
> to know what kind of BLOB content it contains.
> 
> Chris
> 
> -------------------------
> Instant Scalable Full-Text Search On Any Database/Application
> site: http://www.dbsight.net
> demo: http://search.dbsight.com
> Lucene Database Search in 3 minutes:
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> DBSight customer, a shopping comparison site, (anonymous per request) got
> 2.6 Million Euro funding!
> 
> 
> luciusvorenus wrote:
>> helo 
>>
>> One more question to blob :
>>
>> ""d.add(new Field("txt", rs.getString("subject"), Field.Store.NO,
>> Field.Index.ANALYZED));"""
>>
>> but how can i index a blob? 
>>
>> the field txt is a blob ... with rs.geBlob(txt) ?
>>
>> thank u
>>
>> thank 
>>   
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://old.nabble.com/index-a-mysql-database----blob-field-tp27376053p27386652.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44788-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 31 16:52:09 2010
Return-Path: <java-user-return-44788-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77632 invoked from network); 31 Jan 2010 16:52:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Jan 2010 16:52:09 -0000
Received: (qmail 38567 invoked by uid 500); 31 Jan 2010 16:52:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38484 invoked by uid 500); 31 Jan 2010 16:52:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38474 invoked by uid 99); 31 Jan 2010 16:52:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 31 Jan 2010 16:52:06 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [69.20.54.33] (HELO server2.livestoryboard.com) (69.20.54.33)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 31 Jan 2010 16:51:57 +0000
Received: from [192.168.1.68] (76-224-187-174.lightspeed.sntcca.sbcglobal.net [76.224.187.174])
	by server2.livestoryboard.com (Postfix) with ESMTP id F11A92BEA1A
	for <java-user@lucene.apache.org>; Sun, 31 Jan 2010 11:51:35 -0500 (EST)
From: Robert Koberg <rob@koberg.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: best way to compare Documents
Date: Sun, 31 Jan 2010 08:51:35 -0800
Message-Id: <6CA9B075-90B5-411D-9CD8-B799F3DF77BC@koberg.com>
To: java-user@lucene.apache.org
Mime-Version: 1.0 (Apple Message framework v1077)
X-Mailer: Apple Mail (2.1077)
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Just coming back to Lucene after a few years.

Is there some convenient way to compare Lucene Documents?

I want to check if I should update a document based on whether field =
values have changed and whether fields have been added or removed.=20

Is it as simple as:

newDoc.equals(oldDoc)

?

I don't need to create the newDoc first, so I could compare by field. I =
am creating Fields like so:

new Field("modified", modified, Field.Store.YES, =
Field.Index.NOT_ANALYZED)

So, would it be better to:
* check oldDoc's fields count against the to be created documents =
desired fields count, and
* loop through the fields and compare values

?

Is there a better way to create Fields and/or Documents for this type of =
thing?

thanks,
-Rob



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44789-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 31 16:58:51 2010
Return-Path: <java-user-return-44789-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78787 invoked from network); 31 Jan 2010 16:58:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Jan 2010 16:58:51 -0000
Received: (qmail 46704 invoked by uid 500); 31 Jan 2010 16:58:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46618 invoked by uid 500); 31 Jan 2010 16:58:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46608 invoked by uid 99); 31 Jan 2010 16:58:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 31 Jan 2010 16:58:49 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shashi.mit@gmail.com designates 209.85.219.210 as permitted sender)
Received: from [209.85.219.210] (HELO mail-ew0-f210.google.com) (209.85.219.210)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 31 Jan 2010 16:58:41 +0000
Received: by ewy2 with SMTP id 2so3966994ewy.5
        for <java-user@lucene.apache.org>; Sun, 31 Jan 2010 08:58:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:from:date:x-google-sender-auth:message-id:subject:to
         :content-type;
        bh=tpTHcGzFOLkyOgzEsI7GQmVETb7yEuVTw4Mh331Ecns=;
        b=rw2lW+jsT9g0LOtoKUHY5fjq8rwpdWzJIZ8dkPh8Wb99J7pnVjb1th5wp1QhvwobJJ
         fmH7ySVznJnDJEJ3Yd2DatCSOXO0qPtN0YRMjhJHwrmlJUhNJgyzqIqoSESXkbpc8hzX
         ojdLxG6nTJcZ6j42HdenqSdECtb9wcp9U/zjo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:from:date
         :x-google-sender-auth:message-id:subject:to:content-type;
        b=AljRjpwripLcJW4/jm6wquhbKcm8GH6idx8jlzDLbqyefNHRXB1v6xEU6XUeYLQ3WC
         sg62CAQWEw+2vYZNEN+bW+xv5rXZkVBcvrkcZhSvdEOBwktKzqCk5m5FUoXlZQ17abDS
         WjA5BhcpWdvfWag2/GQKYjqMuvAaS6gYTh/ZI=
MIME-Version: 1.0
Sender: shashi.mit@gmail.com
Received: by 10.216.87.6 with SMTP id x6mr1665993wee.174.1264957101275; Sun, 
	31 Jan 2010 08:58:21 -0800 (PST)
In-Reply-To: <6CA9B075-90B5-411D-9CD8-B799F3DF77BC@koberg.com>
References: <6CA9B075-90B5-411D-9CD8-B799F3DF77BC@koberg.com>
From: Shashi Kant <skant@sloan.mit.edu>
Date: Sun, 31 Jan 2010 11:58:01 -0500
X-Google-Sender-Auth: dc033eb53a6342c2
Message-ID: <4d19a3631001310858p2f1bc31bpd6cfbe5d77f128c7@mail.gmail.com>
Subject: Re: best way to compare Documents
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

If all you want is to flag a document "dirty" you could hash the
fields in the document and and check for an update.



On Sun, Jan 31, 2010 at 11:51 AM, Robert Koberg <rob@koberg.com> wrote:
> Hi,
>
> Just coming back to Lucene after a few years.
>
> Is there some convenient way to compare Lucene Documents?
>
> I want to check if I should update a document based on whether field values have changed and whether fields have been added or removed.
>
> Is it as simple as:
>
> newDoc.equals(oldDoc)
>
> ?
>
> I don't need to create the newDoc first, so I could compare by field. I am creating Fields like so:
>
> new Field("modified", modified, Field.Store.YES, Field.Index.NOT_ANALYZED)
>
> So, would it be better to:
> * check oldDoc's fields count against the to be created documents desired fields count, and
> * loop through the fields and compare values
>
> ?
>
> Is there a better way to create Fields and/or Documents for this type of thing?
>
> thanks,
> -Rob
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-44790-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Jan 31 22:32:22 2010
Return-Path: <java-user-return-44790-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90341 invoked from network); 31 Jan 2010 22:32:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.3)
  by minotaur.apache.org with SMTP; 31 Jan 2010 22:32:22 -0000
Received: (qmail 14532 invoked by uid 500); 31 Jan 2010 22:32:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14468 invoked by uid 500); 31 Jan 2010 22:32:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14458 invoked by uid 99); 31 Jan 2010 22:32:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 31 Jan 2010 22:32:20 +0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of shashi.mit@gmail.com designates 74.125.78.27 as permitted sender)
Received: from [74.125.78.27] (HELO ey-out-2122.google.com) (74.125.78.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 31 Jan 2010 22:32:12 +0000
Received: by ey-out-2122.google.com with SMTP id d26so1027146eyd.3
        for <java-user@lucene.apache.org>; Sun, 31 Jan 2010 14:31:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:mime-version:sender:received:in-reply-to
         :references:from:date:x-google-sender-auth:message-id:subject:to
         :content-type;
        bh=4p4cTbsXNYukx6SqZNw1h7zafWl8gcQXTc98ZOgMX8g=;
        b=b6fZNGHFIxaqFMN2lEPI24zo3jocO01b0BEgITTpv25s2h1qqRoNiJpOtNuLjfEFCp
         Pe6bSc47M4xmW9MvpHIfmUjzGlYVr0cT7Q77xASIz3yJyUu8DI/rjRQ2gALumhDgMrhK
         5ZgZQ9L1AhFXWVbaZX8riKvL6cBHtHwmqDtJ0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=mime-version:sender:in-reply-to:references:from:date
         :x-google-sender-auth:message-id:subject:to:content-type;
        b=cMkMY5DW3dqVPVIYyEyJyNC4XhVf2HmKZCAEUI5/uPLhoMO4L9TCjE0B6bbbUb08c8
         RinQ2ev17wwfM6ACTnlw6/slao3AJaMBluVtOrA8YimFNxkfJptZOptrA8o2IYV0YWwT
         0PjWV55jX4UXpbNrYpNYD4zt+YCv2LdtrEz/A=
MIME-Version: 1.0
Sender: shashi.mit@gmail.com
Received: by 10.216.85.5 with SMTP id t5mr2196543wee.142.1264977112115; Sun, 
	31 Jan 2010 14:31:52 -0800 (PST)
In-Reply-To: <4d19a3631001310858p2f1bc31bpd6cfbe5d77f128c7@mail.gmail.com>
References: <6CA9B075-90B5-411D-9CD8-B799F3DF77BC@koberg.com> 
	<4d19a3631001310858p2f1bc31bpd6cfbe5d77f128c7@mail.gmail.com>
From: Shashi Kant <skant@sloan.mit.edu>
Date: Sun, 31 Jan 2010 17:31:32 -0500
X-Google-Sender-Auth: 9b0ba128db692f85
Message-ID: <4d19a3631001311431m24e0ad70x9c492fcd092ad066@mail.gmail.com>
Subject: Re: best way to compare Documents
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=ISO-8859-1
X-Virus-Checked: Checked by ClamAV on apache.org

or a CRC

On Sun, Jan 31, 2010 at 11:58 AM, Shashi Kant <skant@sloan.mit.edu> wrote:
> If all you want is to flag a document "dirty" you could hash the
> fields in the document and and check for an update.
>
>
>
> On Sun, Jan 31, 2010 at 11:51 AM, Robert Koberg <rob@koberg.com> wrote:
>> Hi,
>>
>> Just coming back to Lucene after a few years.
>>
>> Is there some convenient way to compare Lucene Documents?
>>
>> I want to check if I should update a document based on whether field values have changed and whether fields have been added or removed.
>>
>> Is it as simple as:
>>
>> newDoc.equals(oldDoc)
>>
>> ?
>>
>> I don't need to create the newDoc first, so I could compare by field. I am creating Fields like so:
>>
>> new Field("modified", modified, Field.Store.YES, Field.Index.NOT_ANALYZED)
>>
>> So, would it be better to:
>> * check oldDoc's fields count against the to be created documents desired fields count, and
>> * loop through the fields and compare values
>>
>> ?
>>
>> Is there a better way to create Fields and/or Documents for this type of thing?
>>
>> thanks,
>> -Rob
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


