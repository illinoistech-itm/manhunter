From java-user-return-30835-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 01:24:06 2007
Return-Path: <java-user-return-30835-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58137 invoked from network); 1 Nov 2007 01:24:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 01:24:06 -0000
Received: (qmail 12093 invoked by uid 500); 1 Nov 2007 01:23:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12065 invoked by uid 500); 1 Nov 2007 01:23:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12050 invoked by uid 99); 1 Nov 2007 01:23:47 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 Oct 2007 18:23:47 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.175] (HELO web25703.mail.ukl.yahoo.com) (217.12.10.175)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 Nov 2007 01:24:02 +0000
Received: (qmail 84714 invoked by uid 60001); 1 Nov 2007 01:23:24 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=X-YMail-OSG:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=H2UQFY+9yLAm3Fdw2n1MemApZKBodnUHvJv5++HFSPSNEyGKKVMYaHXCt/mw6Xzr14N5nPuspI39i8yENz9YcNa0dcjT/kjraNr3YuyNaStrqhJ7aIMoLWJ3K1fLpj0Bb1qBRrNwxTF12Xoio5S8zgCsgSWYoYUjhX1nfxMJ4Dw=;
X-YMail-OSG: IoM53WcVM1kPD1TyHVdMhC94NZ6MPeGB_yKo_hRLwtKNXctjxlknMqnfrfrJ2xwf_kgXIUQaE6nawdqHrGYj16je0XxnbMdXL.BnrvKzoOgWAwnq
Received: from [196.217.46.162] by web25703.mail.ukl.yahoo.com via HTTP; Thu, 01 Nov 2007 02:23:24 CET
Date: Thu, 1 Nov 2007 02:23:24 +0100 (CET)
From: Jamal jamalator <jtandina@yahoo.fr>
Subject: problem undestanding the hits.score
To: java-user@lucene.apache.org, general@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-353154718-1193880204=:81254"
Content-Transfer-Encoding: 8bit
Message-ID: <808815.81254.qm@web25703.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-353154718-1193880204=:81254
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit


 Hi 

I have indexed this html document 
=============z1========================
<html>
  <body>
<h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
<h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
<h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1>
  </body>
</html>
=============z2=========================
 <html>
   <body>
 <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
 <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
   </body>
 </html>
=============z3==========================
 <html>
   <body>
 <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
   </body>
 </html>
=========================================
with this code

Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),Field.Store.NO,Field.Index.TOKENIZED );
contentK1.setBoost(1/10f);  //10%
doc.add(contentK1);
       
and when a search "zo" with luke i have (whitespaceanalyser):

(score , id   )
(0,0957,z2 )
(0,0947,z3 )
(0,0938,z1)

NORMALY the resut expected have to be z1 z2 z3

Some One have an idea ??

Thank you all

                

---------------------------------
  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 

             
---------------------------------
 Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
--0-353154718-1193880204=:81254--

From java-user-return-30836-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 02:05:47 2007
Return-Path: <java-user-return-30836-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80183 invoked from network); 1 Nov 2007 02:05:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 02:05:47 -0000
Received: (qmail 44962 invoked by uid 500); 1 Nov 2007 02:05:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44927 invoked by uid 500); 1 Nov 2007 02:05:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44916 invoked by uid 99); 1 Nov 2007 02:05:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 31 Oct 2007 19:05:28 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 02:05:46 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 4837771C1C8; Wed, 31 Oct 2007 19:05:09 -0700 (PDT)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 443A671C0F4
	for <java-user@lucene.apache.org>; Wed, 31 Oct 2007 19:05:09 -0700 (PDT)
Date: Wed, 31 Oct 2007 19:05:09 -0700 (PDT)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Hits.score mystery
In-Reply-To: <562BCF4FF1D14343BC81378BA0050AD90AB086@SBS2003.2LSHQ.local>
Message-ID: <Pine.LNX.4.62.0710311900510.15623@radix.cryptio.net>
References: <562BCF4FF1D14343BC81378BA0050AD90AB086@SBS2003.2LSHQ.local>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: I'm returning the document plus hits.score(i) * 100 but when the

NOTE: the score returned by Hits is not a "percentage" ... it is an 
arbitrary number less then 1.  it might be the "raw score" of the document 
or it might be the result of dividing the "raw score" by the "raw score" 
of the highest scoring document, if hte raw score of the highest scoring 
document is greater then 1

(kinda silly huh?)

basically it's just a way to ensure you always have a number less then 1 
-- but a score of 0.9 from one query isn't neccessarily better then a 
score of 0.1 from another query.

PS...

http://people.apache.org/~hossman/#threadhijack
When starting a new discussion on a mailing list, please do not reply to 
an existing message, instead start a fresh email.  Even if you change the 
subject line of your email, other mail headers still track which thread 
you replied to and your question is "hidden" in that thread and gets less 
attention.   It makes following discussions in the mailing list archives 
particularly difficult.
See Also:  http://en.wikipedia.org/wiki/Thread_hijacking


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30837-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 07:01:17 2007
Return-Path: <java-user-return-30837-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87137 invoked from network); 1 Nov 2007 07:01:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 07:01:17 -0000
Received: (qmail 95595 invoked by uid 500); 1 Nov 2007 07:00:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 95568 invoked by uid 500); 1 Nov 2007 07:00:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 95557 invoked by uid 99); 1 Nov 2007 07:00:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 00:00:57 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [217.41.57.100] (HELO 2ls.com) (217.41.57.100)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 07:01:14 +0000
Subject: RE: Hits.score mystery
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Date: Thu, 1 Nov 2007 07:00:36 -0000
Content-class: urn:content-classes:message
Message-ID: <562BCF4FF1D14343BC81378BA0050AD90AB087@SBS2003.2LSHQ.local>
X-MimeOLE: Produced By Microsoft Exchange V6.5
In-Reply-To: <0564B5C2-6FC3-40F5-BD06-6BC6F663DB38@apache.org>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Hits.score mystery
Thread-Index: Acgb8tYCTlghQkW3RfGPwp9xikhpnwAYSgcg
From: "Tom Conlon" <tomc@2ls.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Grant,

> but you should have a look at Searcher.explain()=20

I was half-expecting this answer. :(

The query is very basic and the scoring seems completely arbitrary.
Documents with the same number of ocurrences and (seemingly)
distribution are being given widely different scores.=20

> Chris Hostetter
> NOTE: the score returned by Hits is not a "percentage" ...=20
> a score of 0.9 from 1 query isn't better then a score of 0.1 from
another query.

Thanks for re-emphasizing these points (I was aware of them in any
event).

Tom

-----Original Message-----
From: Grant Ingersoll [mailto:gsingers@apache.org]=20
Sent: 31 October 2007 19:17
To: java-user@lucene.apache.org
Subject: Re: Hits.score mystery

Not sure what UI you are referring to, but you should have a look at
Searcher.explain() for giving you information about why a particular
document scored the way it does

-Grant

On Oct 31, 2007, at 2:14 PM, Tom Conlon wrote:

> Hi All,
>
> Query:	systems AND 2000
> Results: 	558 total matching documents
>
> I'm returning the document plus hits.score(i) * 100 but when the=20
> relevance is examined in the User interface it doesn't seem to be=20
> working.
>
>
> E.g.  'rough' feedback in terms of occurences
>
> 61.txt	18.356403	100%	(13 occurences)
> 119.txt	17.865013	 97% 	(13 occurences)
> ...
> 45.txt	8.600986	 47%  (18 occurences)
> ...
> 8.rtf		2.7724645	 15%  (10 occurences)
>
> Is there something else I need to do or am missing?
>
> Thanks,
> Tom
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!
http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30838-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 08:22:54 2007
Return-Path: <java-user-return-30838-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20272 invoked from network); 1 Nov 2007 08:22:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 08:22:54 -0000
Received: (qmail 52124 invoked by uid 500); 1 Nov 2007 08:22:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52073 invoked by uid 500); 1 Nov 2007 08:22:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52062 invoked by uid 99); 1 Nov 2007 08:22:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 01:22:36 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.43 as permitted sender)
Received: from [80.67.18.43] (HELO smtprelay05.ispgateway.de) (80.67.18.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 08:22:36 +0000
Received: (qmail 15573 invoked from network); 1 Nov 2007 08:22:13 -0000
Received: from unknown (HELO p54bfd4e7.dip.t-dialin.net) (695637@[84.191.212.231])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay05.ispgateway.de (qmail-ldap-1.03) with RC4-MD5 encrypted SMTP
          for <java-user@lucene.apache.org>; 1 Nov 2007 08:22:13 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: Hits.score mystery
Date: Thu, 1 Nov 2007 09:18:52 +0100
User-Agent: KMail/1.8.2
References: <562BCF4FF1D14343BC81378BA0050AD90AB086@SBS2003.2LSHQ.local>
In-Reply-To: <562BCF4FF1D14343BC81378BA0050AD90AB086@SBS2003.2LSHQ.local>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: base64
Content-Disposition: inline
Message-Id: <200711010918.53140@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

T24gV2VkbmVzZGF5IDMxIE9jdG9iZXIgMjAwNyAxOToxNCwgVG9tIENvbmxvbiB3cm90ZToKCj4g
MTE5LnR4dMKgMTcuODY1MDEzwqDCoMKgwqDCoMKgwqAgOTclIMKgwqDCoCgxMyBvY2N1cmVuY2Vz
KQo+IDQ1LnR4dMKgwqA4LjYwMDk4NsKgwqDCoMKgwqDCoMKgwqAgNDclIMKgKDE4IG9jY3VyZW5j
ZXMpCgo0NS50eHQgbWlnaHQgYmUgYSBkb2N1bWVudCB3aXRoIG1vcmUgdGhlcm1zIHNvIHRoYXQg
aXRzIHNjb3JlIGlzIGxvd2VyIAphbHRob3VnaCBpdCBjb250YWlucyBtb3JlIG1hdGNoZXMuCgpS
ZWdhcmRzCiBEYW5pZWwKCi0tIApodHRwOi8vd3d3LmRhbmllbG5hYmVyLmRlCg==


From java-user-return-30839-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 09:18:15 2007
Return-Path: <java-user-return-30839-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38299 invoked from network); 1 Nov 2007 09:18:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 09:18:14 -0000
Received: (qmail 98418 invoked by uid 500); 1 Nov 2007 09:17:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98386 invoked by uid 500); 1 Nov 2007 09:17:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98375 invoked by uid 99); 1 Nov 2007 09:17:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 02:17:54 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [217.41.57.100] (HELO 2ls.com) (217.41.57.100)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 09:18:14 +0000
Subject: RE: Hits.score mystery
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Date: Thu, 1 Nov 2007 09:17:36 -0000
Content-class: urn:content-classes:message
Message-ID: <562BCF4FF1D14343BC81378BA0050AD90AB08A@SBS2003.2LSHQ.local>
X-MimeOLE: Produced By Microsoft Exchange V6.5
In-Reply-To: <200711010918.53140@danielnaber.de>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Hits.score mystery
Thread-Index: AcgcYGeP19AbCWZvTfuXaxFVEGSX8AAB116w
From: "Tom Conlon" <tomc@2ls.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Daniel,

I'm using Searcher.explain() & luke to try to understand the reasons for =
the score.

-----Original Message-----
From: Daniel Naber [mailto:lucenelist2007@danielnaber.de]=20
Sent: 01 November 2007 08:19
To: java-user@lucene.apache.org
Subject: Re: Hits.score mystery

On Wednesday 31 October 2007 19:14, Tom Conlon wrote:

> 119.txt=A017.865013=A0=A0=A0=A0=A0=A0=A0 97% =A0=A0=A0(13 occurences) =
45.txt=A0=A08.600986=A0=A0=A0=A0=A0=A0=A0=A0=20
> 47% =A0(18 occurences)

45.txt might be a document with more therms so that its score is lower =
although it contains more matches.

Regards
 Daniel

--
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30840-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 09:46:15 2007
Return-Path: <java-user-return-30840-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50842 invoked from network); 1 Nov 2007 09:46:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 09:46:14 -0000
Received: (qmail 35939 invoked by uid 500); 1 Nov 2007 09:45:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35191 invoked by uid 500); 1 Nov 2007 09:45:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35180 invoked by uid 99); 1 Nov 2007 09:45:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 02:45:56 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of sonusr@gmail.com designates 209.85.198.191 as permitted sender)
Received: from [209.85.198.191] (HELO rv-out-0910.google.com) (209.85.198.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 09:45:59 +0000
Received: by rv-out-0910.google.com with SMTP id k20so322185rvb
        for <java-user@lucene.apache.org>; Thu, 01 Nov 2007 02:45:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=9z0w80HMqAYLSrg/DzgFxXokWUktDqnWAh2qGuLu6Q0=;
        b=aX638VYT1wU5QRcs9gRIj4C0C3NFdXEiwkPJrhNCeqpp61y02VNBT2jf6BmYmb4Bo2yEZ6dQGfb3K41sOwCftOJRiuKeBVRw2Nl1TH+6OWl2sWycs2WnmvEiBxSnGzp4ujzyjr73++K58Gqe2wnP3j6U+U45/hvLjQ6saeAVaOI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=J0Ba0d/Nv6YMb3PgWylESR7FZrEu8xXrBv0l0fBqUWCBCt3bn+7Ot+wS+tg+WUXcNbfVwOj6gyHUBcN43nYBz4rBveOIR+RQkNXdTTHhTLBQy6aCGvRp/J419NNqO8AjAwE3l4gyFvdMkgvZNoT8yuMIMNX7Qoaf44tk6Dp5tnU=
Received: by 10.140.132.8 with SMTP id f8mr155572rvd.1193910338263;
        Thu, 01 Nov 2007 02:45:38 -0700 (PDT)
Received: by 10.140.191.5 with HTTP; Thu, 1 Nov 2007 02:45:38 -0700 (PDT)
Message-ID: <d5b3ea330711010245l39b5c7bdg54d350ac19ed70b@mail.gmail.com>
Date: Thu, 1 Nov 2007 15:15:38 +0530
From: "Sonu SR" <sonusr@gmail.com>
To: java-user@lucene.apache.org
Subject: Question regarding proximity search
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_7213_10219090.1193910338264"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_7213_10219090.1193910338264
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,
I got confused of proximity search. I am getting different results for the
queries TTL:"test device"~2 and TTL:"device test"~2
I expect same result for the above two queries. Is there any importance of
position of terms in a proximity query?  Anybody please help me how lucene
exactly handles proximity query search. Is there any good documentation for
it?


Thanks,
Sonu

------=_Part_7213_10219090.1193910338264--

From java-user-return-30841-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 10:47:41 2007
Return-Path: <java-user-return-30841-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72758 invoked from network); 1 Nov 2007 10:47:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 10:47:41 -0000
Received: (qmail 19641 invoked by uid 500); 1 Nov 2007 10:47:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19616 invoked by uid 500); 1 Nov 2007 10:47:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19605 invoked by uid 99); 1 Nov 2007 10:47:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 03:47:22 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.16 as permitted sender)
Received: from [80.67.18.16] (HELO smtprelay04.ispgateway.de) (80.67.18.16)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 10:47:22 +0000
Received: (qmail 5245 invoked from network); 1 Nov 2007 10:47:00 -0000
Received: from unknown (HELO p54bffcab.dip.t-dialin.net) (695637@[84.191.252.171])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay04.ispgateway.de (qmail-ldap-1.03) with RC4-MD5 encrypted SMTP
          for <java-user@lucene.apache.org>; 1 Nov 2007 10:47:00 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: Question regarding proximity search
Date: Thu, 1 Nov 2007 11:43:45 +0100
User-Agent: KMail/1.8.2
References: <d5b3ea330711010245l39b5c7bdg54d350ac19ed70b@mail.gmail.com>
In-Reply-To: <d5b3ea330711010245l39b5c7bdg54d350ac19ed70b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711011143.45653@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Thursday 01 November 2007 10:45, Sonu SR wrote:

> I got confused of proximity search. I am getting different results for
> the queries TTL:"test device"~2 and TTL:"device test"~2

Order is significant, this is described here:
http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/PhraseQuery.html#setSlop(int)

regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30842-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 15:59:10 2007
Return-Path: <java-user-return-30842-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68090 invoked from network); 1 Nov 2007 15:59:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 15:59:10 -0000
Received: (qmail 91498 invoked by uid 500); 1 Nov 2007 15:31:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91475 invoked by uid 500); 1 Nov 2007 15:31:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91464 invoked by uid 99); 1 Nov 2007 15:31:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 08:31:04 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [217.41.57.100] (HELO 2ls.com) (217.41.57.100)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 15:31:05 +0000
Subject: RE: Hits.score mystery
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Date: Thu, 1 Nov 2007 15:30:42 -0000
Content-class: urn:content-classes:message
X-MimeOLE: Produced By Microsoft Exchange V6.5
Message-ID: <562BCF4FF1D14343BC81378BA0050AD90AB08D@SBS2003.2LSHQ.local>
In-Reply-To: <562BCF4FF1D14343BC81378BA0050AD90AB08A@SBS2003.2LSHQ.local>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Hits.score mystery
Thread-Index: AcgcYGeP19AbCWZvTfuXaxFVEGSX8AAB116wAAzIxCA=
From: "Tom Conlon" <tomc@2ls.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

The reason seems to be that I found I needed to implement an analyser =
that lowercases terms as well as *not* ignoring trailing characters such =
as #, +.=20
(i.e. I needed to match C# and C++)

public final class LowercaseWhitespaceAnalyzer extends Analyzer=20
{
  public TokenStream tokenStream(String fieldName, Reader reader) {
    return new LowercaseWhitespaceTokenizer(reader);
  }
}=20

Problem now exists that "system," etc is not matched against "system".

Can anyone point to an example of a combination of analyser/tokeniser =
(or other method) that gets around this please?

Thanks,
Tom


-----Original Message-----
From: Tom Conlon [mailto:tomc@2ls.com]=20
Sent: 01 November 2007 09:18
To: java-user@lucene.apache.org
Subject: RE: Hits.score mystery

Thanks Daniel,

I'm using Searcher.explain() & luke to try to understand the reasons for =
the score.

-----Original Message-----
From: Daniel Naber [mailto:lucenelist2007@danielnaber.de]
Sent: 01 November 2007 08:19
To: java-user@lucene.apache.org
Subject: Re: Hits.score mystery

On Wednesday 31 October 2007 19:14, Tom Conlon wrote:

> 119.txt=A017.865013=A0=A0=A0=A0=A0=A0=A0 97% =A0=A0=A0(13 occurences) =
45.txt=A0=A08.600986 47% =A0
> (18 occurences)

45.txt might be a document with more therms so that its score is lower =
although it contains more matches.

Regards
 Daniel

--
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30843-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 17:13:53 2007
Return-Path: <java-user-return-30843-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 576 invoked from network); 1 Nov 2007 17:13:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 17:13:53 -0000
Received: (qmail 80693 invoked by uid 500); 1 Nov 2007 17:10:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80666 invoked by uid 500); 1 Nov 2007 17:10:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80653 invoked by uid 99); 1 Nov 2007 17:10:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 10:10:59 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.196.101.37] (HELO web59211.mail.re1.yahoo.com) (66.196.101.37)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 Nov 2007 17:11:02 +0000
Received: (qmail 86335 invoked by uid 60001); 1 Nov 2007 17:09:39 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=iMAMYTZJQ9YPHAXf7FaMX3ELFHd9EhLqQxeYdWz5MKuQvQiibeqDvo80tyxYsaKzHtkeIqQ7Ts7h42dBOZgBnw9YbztRR/s7LPeahAG7pnDj4oSLiVZb2iYwT+O2E7b0cWegAyknfC6oQ/re6jaL24ney2A6Ko/2KMuLqSdCXeg=;
X-YMail-OSG: OWOAz40VM1ktp2TEPWrfQIaFms4Nd0R.fIla1L17g.SX_QJURseW0IR8aI8FSaIJMoI9cpa9CY8ZTGTth9fZPCvfoLGJkpwDnVXi.7OzMesCTFx0w3cqGy_XgnpU.rRwWh0ziRdUnIwhFFIm2qoelzHG4w--
Received: from [68.167.115.34] by web59211.mail.re1.yahoo.com via HTTP; Thu, 01 Nov 2007 10:09:39 PDT
Date: Thu, 1 Nov 2007 10:09:39 -0700 (PDT)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Re: Best way to count tokens
To: java-user@lucene.apache.org
In-Reply-To: <BDF97B31-1EDC-4CA6-8BB6-51059F117C1B@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-190867870-1193936979=:85324"
Content-Transfer-Encoding: 8bit
Message-ID: <944241.85324.qm@web59211.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-190867870-1193936979=:85324
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

This is what I am looking for prior to adding into index. SO that it can help me  to display in my site first 10 tokens that has got maximum occurences in my index. In otherword, user can add weightage to these terms.
   
  - BR

Karl Wettin <karl.wettin@gmail.com> wrote:
  
31 okt 2007 kl. 15.18 skrev Cool Coder:

> Hi Group,
> I need to display list of tokens (tags) in my side 
> those have got maximum occurances in my index. One way I can think 
> of is to keep track of all tokens during analysis and accordingly 
> display them. Is there any other way? e.g. if I want to display 
> tokens in order of their occurences as well as their weightage.

Are you looking for the term frequency vector?

IndexReader.html#getTermFreqVector(int,%20java.lang.String)>

If you are using 2.3 the TermVectorMapper might save you a couple of 
clock ticks sorting.


Or is this something you want to do prior to adding the document to 
the index?

-- 
karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



 __________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
--0-190867870-1193936979=:85324--

From java-user-return-30844-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 18:57:56 2007
Return-Path: <java-user-return-30844-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38654 invoked from network); 1 Nov 2007 18:57:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 18:57:56 -0000
Received: (qmail 51471 invoked by uid 500); 1 Nov 2007 18:56:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51445 invoked by uid 500); 1 Nov 2007 18:56:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51428 invoked by uid 99); 1 Nov 2007 18:56:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 11:56:18 -0700
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: 80.76.149.213 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [80.76.149.213] (HELO ch-smtp02.sth.basefarm.net) (80.76.149.213)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 18:56:20 +0000
Received: from c83-249-118-113.bredband.comhem.se ([83.249.118.113]:54631 helo=[192.168.1.101])
	by ch-smtp02.sth.basefarm.net with esmtp (Exim 4.68)
	(envelope-from <karl.wettin@gmail.com>)
	id 1InfCw-0002pG-8L
	for java-user@lucene.apache.org; Thu, 01 Nov 2007 19:55:58 +0100
Mime-Version: 1.0 (Apple Message framework v752.3)
In-Reply-To: <944241.85324.qm@web59211.mail.re1.yahoo.com>
References: <944241.85324.qm@web59211.mail.re1.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <FE1ED6A0-4B8A-46DF-8D3C-CDD6E89CF947@gmail.com>
Content-Transfer-Encoding: 7bit
From: Karl Wettin <karl.wettin@gmail.com>
Subject: Re: Best way to count tokens
Date: Thu, 1 Nov 2007 19:55:54 +0100
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.752.3)
X-Originating-IP: 83.249.118.113
X-Scan-Result: No virus found in message 1InfCw-0002pG-8L.
X-Scan-Signature: ch-smtp02.sth.basefarm.net 1InfCw-0002pG-8L b36226094ad9a6109ba5e7fe1a26c4f7
X-Virus-Checked: Checked by ClamAV on apache.org


1 nov 2007 kl. 18.09 skrev Cool Coder:

> prior to adding into index

Easiest way out would be to add the document to a temporary index and  
extract the term frequency vector. I would recommend using MemoryIndex.

You could also tokenize the document and pass the data to a  
TermVectorMapper. You could consider replacing the fields of the  
document with CachedTokenStreams if you got the RAM to spare and  
don't want to waste CPU analyzing the document twice. I welcome  
TermVectorMappingChachedTokenStreamFactory. Even cooler would be to  
pass code down the IndexWriter.addDocument using a command pattern or  
something, allowing one to extend the document at the time of the  
analysis.


-- 
karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30845-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 21:03:22 2007
Return-Path: <java-user-return-30845-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75753 invoked from network); 1 Nov 2007 21:03:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 21:03:21 -0000
Received: (qmail 17889 invoked by uid 500); 1 Nov 2007 21:03:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17863 invoked by uid 500); 1 Nov 2007 21:03:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17852 invoked by uid 99); 1 Nov 2007 21:03:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 14:03:01 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.196.101.28] (HELO web59202.mail.re1.yahoo.com) (66.196.101.28)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 01 Nov 2007 21:03:03 +0000
Received: (qmail 86348 invoked by uid 60001); 1 Nov 2007 21:02:42 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=maeM+T7ceiufVQ9KVxJbVTs/LAfDGk8XdaVFF8QkPKrklXHrk1n/m89fsvjKXh3vOOhjRLU6khXd9eH0IDbBaT6Bv2PRlDWFeDbPoQxLElHVkbxnCP1KPDlLo3orglM3v4vdGHag0pRK5/hLKlqPXZpXp+acxkOWU+hySzmw+4s=;
X-YMail-OSG: 19TZwe4VM1mtyIwkOKP72ii8ykFS3UTPf1_FyBbGZFl8AWS6NOitb524fpRkURX.j4wlDO7CbER0jj9Axkm0W3k_Sd0E8YVlv2atdjk.jjkvG.skCAi3jY.MFPT4
Received: from [68.167.115.34] by web59202.mail.re1.yahoo.com via HTTP; Thu, 01 Nov 2007 14:02:42 PDT
Date: Thu, 1 Nov 2007 14:02:42 -0700 (PDT)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Re: Best way to count tokens
To: java-user@lucene.apache.org
In-Reply-To: <FE1ED6A0-4B8A-46DF-8D3C-CDD6E89CF947@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-709750756-1193950962=:72143"
Content-Transfer-Encoding: 8bit
Message-ID: <517581.72143.qm@web59202.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-709750756-1193950962=:72143
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Currently I have extended StandardAnalyzer and counting tokens in the following way. But the index is not getting created , though I call tokenStream.reset(). I am not sure whether reset() on token stream works or not??? I am debugging now
   
  public TokenStream tokenStream(String fieldName, Reader reader) {
  TokenStream result = super.tokenStream(fieldName,new HTMLStripReader(reader));
  //To count tokens and put in a Map
   analyzeTokens(result);
  try {
  result.reset();
  } catch (IOException e) {
  // TODO Auto-generated catch block
  e.printStackTrace();
  }
  return result;
  }
   
  public void analyzeTokens(TokenStream result)
  {
  try {
  Token token = result.next();
  while(token != null)
  {
  String tokenStr = token.termText();
  if(TokenHolder.tokenMap.get(tokenStr) == null)
  {
  TokenHolder.tokenMap.put(tokenStr,1);
  }
  else
  {
  TokenHolder.tokenMap.put(tokenStr,Integer.parseInt(TokenHolder.tokenMap.get(tokenStr).toString())+1);
  }
  token = result.next();
  
  }
  //exxtra reset 
  result.reset();
  } catch (IOException e) {
  e.printStackTrace();
  }
  }
  

Karl Wettin <karl.wettin@gmail.com> wrote:
  
1 nov 2007 kl. 18.09 skrev Cool Coder:

> prior to adding into index

Easiest way out would be to add the document to a temporary index and 
extract the term frequency vector. I would recommend using MemoryIndex.

You could also tokenize the document and pass the data to a 
TermVectorMapper. You could consider replacing the fields of the 
document with CachedTokenStreams if you got the RAM to spare and 
don't want to waste CPU analyzing the document twice. I welcome 
TermVectorMappingChachedTokenStreamFactory. Even cooler would be to 
pass code down the IndexWriter.addDocument using a command pattern or 
something, allowing one to extend the document at the time of the 
analysis.


-- 
karl

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



 __________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
--0-709750756-1193950962=:72143--

From java-user-return-30846-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 22:56:47 2007
Return-Path: <java-user-return-30846-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16592 invoked from network); 1 Nov 2007 22:56:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 22:56:47 -0000
Received: (qmail 24091 invoked by uid 500); 1 Nov 2007 22:56:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24059 invoked by uid 500); 1 Nov 2007 22:56:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24048 invoked by uid 99); 1 Nov 2007 22:56:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 15:56:29 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.186 as permitted sender)
Received: from [209.85.128.186] (HELO fk-out-0910.google.com) (209.85.128.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 22:56:30 +0000
Received: by fk-out-0910.google.com with SMTP id z23so610390fkz
        for <java-user@lucene.apache.org>; Thu, 01 Nov 2007 15:56:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=iuJ8mA+9UK0rct2uPjAPBqi6SWoSzRSf/mvIp8hN2nU=;
        b=pQniS3ak1pQzCykECDZhR1Oy3ni1pxFcD4KYlG1rwkCN4padvLHge+CZzN2M1Q7xEokSe8HuVkofdCb63E0MIBQrjo9flhO/PXZqLVD79axYs09ZJ+0De/z+8YyJ0PR/4cHtzfMN4dMfEVH3TGOyYhGNTyS/Nwjysg4NjDxAIJk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=L34wQKztC/CGOQ4mVVLFM1khhgl9nSvcyQEzCOI36tHW6nPzcA9M0xJNbkCJH29HuP33y9gIgSvy+zYa6UPI9DCrRj385wMDhuNXV6M3NS4uXXY16QtNl+qxfaLLCZa6aeZLYu3PiTWFWwA7/KC0irUj3aFsmSiYxtVTXy3cP6A=
Received: by 10.82.182.1 with SMTP id e1mr1787692buf.1193957768158;
        Thu, 01 Nov 2007 15:56:08 -0700 (PDT)
Received: by 10.82.167.3 with HTTP; Thu, 1 Nov 2007 15:56:08 -0700 (PDT)
Message-ID: <359a92830711011556s2d493ddcw3deeadf01b2161b8@mail.gmail.com>
Date: Thu, 1 Nov 2007 18:56:08 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: problem undestanding the hits.score
In-Reply-To: <808815.81254.qm@web25703.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_12388_12109025.1193957768140"
References: <808815.81254.qm@web25703.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_12388_12109025.1193957768140
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

What leads you to expect that ordering? Scoring in Lucene is
NOT simply counting the number of times a word appears.

That said, I really have no clue how the scoring algorithm
works since it's always been "good enough for me". But
if you search the mail archive for scoring, you'll find a
wealth of info.

But a cursory look at the Lucene website turned up
this:
http://lucene.apache.org/java/docs/scoring.html

which goes into some detail about scoring..

Best
Erick

On 10/31/07, Jamal jamalator <jtandina@yahoo.fr> wrote:
>
>
> Hi
>
> I have indexed this html document
> =============z1========================
> <html>
>   <body>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1>
>   </body>
> </html>
> =============z2=========================
> <html>
>    <body>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
>    </body>
> </html>
> =============z3==========================
> <html>
>    <body>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
>    </body>
> </html>
> =========================================
> with this code
>
> Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),
> Field.Store.NO,Field.Index.TOKENIZED );
> contentK1.setBoost(1/10f);  //10%
> doc.add(contentK1);
>
> and when a search "zo" with luke i have (whitespaceanalyser):
>
> (score , id   )
> (0,0957,z2 )
> (0,0947,z3 )
> (0,0938,z1)
>
> NORMALY the resut expected have to be z1 z2 z3
>
> Some One have an idea ??
>
> Thank you all
>
>
>
> ---------------------------------
>   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo!
> Mail
>
>
> ---------------------------------
> Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo!
> Mail

------=_Part_12388_12109025.1193957768140--

From java-user-return-30847-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 01 23:02:24 2007
Return-Path: <java-user-return-30847-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18043 invoked from network); 1 Nov 2007 23:02:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 1 Nov 2007 23:02:24 -0000
Received: (qmail 30895 invoked by uid 500); 1 Nov 2007 23:01:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30852 invoked by uid 500); 1 Nov 2007 23:01:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30747 invoked by uid 99); 1 Nov 2007 23:01:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 16:01:57 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.188 as permitted sender)
Received: from [209.85.128.188] (HELO fk-out-0910.google.com) (209.85.128.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 23:01:59 +0000
Received: by fk-out-0910.google.com with SMTP id z23so611632fkz
        for <java-user@lucene.apache.org>; Thu, 01 Nov 2007 16:01:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Yw7TOTc77ozbs4uaxoe2gc26wpu80/p3E/IjfypVMZ8=;
        b=jREfBgB6syleDxlAhSn4ndFiy/YUVn95m66+GaJdO09hT2ICW2ycnLZKF07Rn9bn5fJTgnSmGaIoKa9aRad94wm4LStVnnUUizUMxDaKu9iyzBN1QL6oQznSODT4x9aJaWCOTwrndfmp6tzxi32o9ZU90xz+GEUWWW3LobOLzLY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=NAYCyOvDF7wqeHHSL8t9wlSf6uY5SybdYkedBMK8O4BXI2xM0uXA+p3UTqcNH0eTIod7TEm9f//Gx825zqpN9w1gWzaMpovzwQ5AUG2R2lHnb8soPHobHVAQBGxrFLLuVh9RB7GNNBMmyddcCh4QeuP9dlIL3tL1MUXd3QR1ZLI=
Received: by 10.82.175.17 with SMTP id x17mr2362889bue.1193958097479;
        Thu, 01 Nov 2007 16:01:37 -0700 (PDT)
Received: by 10.82.167.3 with HTTP; Thu, 1 Nov 2007 16:01:37 -0700 (PDT)
Message-ID: <359a92830711011601l194e0d89x8a6e68735b1966b7@mail.gmail.com>
Date: Thu, 1 Nov 2007 19:01:37 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Hits.score mystery
In-Reply-To: <562BCF4FF1D14343BC81378BA0050AD90AB08D@SBS2003.2LSHQ.local>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_12410_24184354.1193958097473"
References: <562BCF4FF1D14343BC81378BA0050AD90AB08A@SBS2003.2LSHQ.local>
	 <562BCF4FF1D14343BC81378BA0050AD90AB08D@SBS2003.2LSHQ.local>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_12410_24184354.1193958097473
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Well, you might have to pre-process your strings before you
give them to an analyzer. Or roll your own analyzer.

What you're asking for, in effect, is an analyzer "that does
exactly what I want it to, nothing more and nothing less". But
the problem is that there is nothing general about what you want.
That is, leaving in # and ++ is completely arbitrary so I don't
think there are any canned analyzers out there that'll do what you
want.

But it's pretty simple to write a regular expression that'll remove
(actually, replace with spaces), anything that you want to. So I'd
think about that approach and then feed your lower-case/whitespace
analyzer the results.

Best
Erick

On 11/1/07, Tom Conlon <tomc@2ls.com> wrote:
>
> The reason seems to be that I found I needed to implement an analyser that
> lowercases terms as well as *not* ignoring trailing characters such as #, +.
> (i.e. I needed to match C# and C++)
>
> public final class LowercaseWhitespaceAnalyzer extends Analyzer
> {
>   public TokenStream tokenStream(String fieldName, Reader reader) {
>     return new LowercaseWhitespaceTokenizer(reader);
>   }
> }
>
> Problem now exists that "system," etc is not matched against "system".
>
> Can anyone point to an example of a combination of analyser/tokeniser (or
> other method) that gets around this please?
>
> Thanks,
> Tom
>
>
> -----Original Message-----
> From: Tom Conlon [mailto:tomc@2ls.com]
> Sent: 01 November 2007 09:18
> To: java-user@lucene.apache.org
> Subject: RE: Hits.score mystery
>
> Thanks Daniel,
>
> I'm using Searcher.explain() & luke to try to understand the reasons for
> the score.
>
> -----Original Message-----
> From: Daniel Naber [mailto:lucenelist2007@danielnaber.de]
> Sent: 01 November 2007 08:19
> To: java-user@lucene.apache.org
> Subject: Re: Hits.score mystery
>
> On Wednesday 31 October 2007 19:14, Tom Conlon wrote:
>
> > 119.txt17.865013 97% (13 occurences) 45.txt8.600986 47%
> > (18 occurences)
>
> 45.txt might be a document with more therms so that its score is lower
> although it contains more matches.
>
> Regards
> Daniel
>
> --
> http://www.danielnaber.de
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_12410_24184354.1193958097473--

From java-user-return-30848-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 00:05:00 2007
Return-Path: <java-user-return-30848-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31832 invoked from network); 2 Nov 2007 00:05:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 00:05:00 -0000
Received: (qmail 71524 invoked by uid 500); 2 Nov 2007 00:04:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71488 invoked by uid 500); 2 Nov 2007 00:04:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71477 invoked by uid 99); 2 Nov 2007 00:04:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 17:04:42 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.82.238 as permitted sender)
Received: from [66.249.82.238] (HELO wx-out-0506.google.com) (66.249.82.238)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 00:04:44 +0000
Received: by wx-out-0506.google.com with SMTP id i28so532817wxd
        for <java-user@lucene.apache.org>; Thu, 01 Nov 2007 17:04:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=S3wHrWTpetiz9hz4mUONoHFmNOTIROjODhNkjcBnonU=;
        b=pH/oQ719tu9mNtmV1FYNI+Hhpnu9dATrCYp9DHZU2l1KJ+U8pd6js4WMIuDcE/v6046EtdL/MlCEEWKVKCxCUFK7qQuybNQGK7chwcM0fpT4F/d/fTw11j1mCuC7XmyidNDXXtL+nw9KUNq3E46WoQ1EcMtW831K9qQkBYwKgAA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=cj5/GGrVck/vp18vDXfyWTFE/e4w19rcIK9IpeZerXzSdVhAsGvcHpnDzoiA5locTTDJLvMX/c9A+DH4P31aQhjciuL4L4YL2svg8MRItmashVviV8wat7gsoH0mxAPbnovLwTUS8cOLcDpVXd6RLZ8N/hGdf2bPv9Jn6p6uSAQ=
Received: by 10.70.89.11 with SMTP id m11mr1573628wxb.1193961863401;
        Thu, 01 Nov 2007 17:04:23 -0700 (PDT)
Received: from ?192.168.1.103? ( [69.124.234.183])
        by mx.google.com with ESMTPS id 52sm1631702hsf.2007.11.01.17.04.20
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 01 Nov 2007 17:04:22 -0700 (PDT)
Message-ID: <472A6970.7060906@gmail.com>
Date: Thu, 01 Nov 2007 20:04:00 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: Best way to count tokens
References: <517581.72143.qm@web59202.mail.re1.yahoo.com>
In-Reply-To: <517581.72143.qm@web59202.mail.re1.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

reset is optional. StandardAnalyzer does not implement it. Check out 
CachingTokenFilter and wrap StandardAnalzyer in it.

Cool Coder wrote:
> Currently I have extended StandardAnalyzer and counting tokens in the following way. But the index is not getting created , though I call tokenStream.reset(). I am not sure whether reset() on token stream works or not??? I am debugging now
>    
>   public TokenStream tokenStream(String fieldName, Reader reader) {
>   TokenStream result = super.tokenStream(fieldName,new HTMLStripReader(reader));
>   //To count tokens and put in a Map
>    analyzeTokens(result);
>   try {
>   result.reset();
>   } catch (IOException e) {
>   // TODO Auto-generated catch block
>   e.printStackTrace();
>   }
>   return result;
>   }
>    
>   public void analyzeTokens(TokenStream result)
>   {
>   try {
>   Token token = result.next();
>   while(token != null)
>   {
>   String tokenStr = token.termText();
>   if(TokenHolder.tokenMap.get(tokenStr) == null)
>   {
>   TokenHolder.tokenMap.put(tokenStr,1);
>   }
>   else
>   {
>   TokenHolder.tokenMap.put(tokenStr,Integer.parseInt(TokenHolder.tokenMap.get(tokenStr).toString())+1);
>   }
>   token = result.next();
>   
>   }
>   //exxtra reset 
>   result.reset();
>   } catch (IOException e) {
>   e.printStackTrace();
>   }
>   }
>   
>
> Karl Wettin <karl.wettin@gmail.com> wrote:
>   
> 1 nov 2007 kl. 18.09 skrev Cool Coder:
>
>   
>> prior to adding into index
>>     
>
> Easiest way out would be to add the document to a temporary index and 
> extract the term frequency vector. I would recommend using MemoryIndex.
>
> You could also tokenize the document and pass the data to a 
> TermVectorMapper. You could consider replacing the fields of the 
> document with CachedTokenStreams if you got the RAM to spare and 
> don't want to waste CPU analyzing the document twice. I welcome 
> TermVectorMappingChachedTokenStreamFactory. Even cooler would be to 
> pass code down the IndexWriter.addDocument using a command pattern or 
> something, allowing one to extend the document at the time of the 
> analysis.
>
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30849-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 00:10:42 2007
Return-Path: <java-user-return-30849-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33133 invoked from network); 2 Nov 2007 00:10:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 00:10:42 -0000
Received: (qmail 76110 invoked by uid 500); 2 Nov 2007 00:10:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76082 invoked by uid 500); 2 Nov 2007 00:10:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76071 invoked by uid 99); 2 Nov 2007 00:10:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 17:10:24 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.82.234 as permitted sender)
Received: from [66.249.82.234] (HELO wx-out-0506.google.com) (66.249.82.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 00:10:25 +0000
Received: by wx-out-0506.google.com with SMTP id i28so533740wxd
        for <java-user@lucene.apache.org>; Thu, 01 Nov 2007 17:10:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=SDfdca8Hp7xgveGd5vFXr/R2kVzTvF6qdh/MEbCXEKA=;
        b=clEz5bKhTay+KFqWmyx/GxWngYpiO6RiPRKuONgsAinGwUiFU7/2l2r1T1vBV9LDccMwr7SL7gKWoujnUraeg3gslQleTtVrrE2KvSZs0OAgu+7xRlubdyHASE9VSQUZe8qETb4QmagaSxrNWqD3EMcQjgzeZHEJJeVkKm8EnCw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=LBtg7TIQshdBciMuLwZ7nCflyTkgJQRdEDwqhKAykfd8mZVcA7VZEg1lKZCKE8rpE+bSj7KqHmemM9Pn+M1juBU4mKJ2s+rd3/E/GIde78iZuCVAUQp35qlZiILH3OuSJh52yDIEArywsPRK8jQVnUk7C3hu9VUVZaHJlCih9I4=
Received: by 10.70.41.14 with SMTP id o14mr1583515wxo.1193962204033;
        Thu, 01 Nov 2007 17:10:04 -0700 (PDT)
Received: from ?192.168.1.103? ( [69.124.234.183])
        by mx.google.com with ESMTPS id s40sm1642205hsb.2007.11.01.17.10.02
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 01 Nov 2007 17:10:03 -0700 (PDT)
Message-ID: <472A6AC7.9020904@gmail.com>
Date: Thu, 01 Nov 2007 20:09:43 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: Hits.score mystery
References: <562BCF4FF1D14343BC81378BA0050AD90AB08D@SBS2003.2LSHQ.local>
In-Reply-To: <562BCF4FF1D14343BC81378BA0050AD90AB08D@SBS2003.2LSHQ.local>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

One of many options is to copy the StandardAnalyzer but change it so 
that + and # are considered letters.

Just add + and # to the LETTER definition in the JavaCC file if you are 
using a release, or the JFlex file if you are working off Trunk (your 
prob using a release but the new JFlex analyzer is mega faster).

Tom Conlon wrote:
> The reason seems to be that I found I needed to implement an analyser that lowercases terms as well as *not* ignoring trailing characters such as #, +. 
> (i.e. I needed to match C# and C++)
>
> public final class LowercaseWhitespaceAnalyzer extends Analyzer 
> {
>   public TokenStream tokenStream(String fieldName, Reader reader) {
>     return new LowercaseWhitespaceTokenizer(reader);
>   }
> } 
>
> Problem now exists that "system," etc is not matched against "system".
>
> Can anyone point to an example of a combination of analyser/tokeniser (or other method) that gets around this please?
>
> Thanks,
> Tom
>
>
> -----Original Message-----
> From: Tom Conlon [mailto:tomc@2ls.com] 
> Sent: 01 November 2007 09:18
> To: java-user@lucene.apache.org
> Subject: RE: Hits.score mystery
>
> Thanks Daniel,
>
> I'm using Searcher.explain() & luke to try to understand the reasons for the score.
>
> -----Original Message-----
> From: Daniel Naber [mailto:lucenelist2007@danielnaber.de]
> Sent: 01 November 2007 08:19
> To: java-user@lucene.apache.org
> Subject: Re: Hits.score mystery
>
> On Wednesday 31 October 2007 19:14, Tom Conlon wrote:
>
>   
>> 119.txt 17.865013        97%    (13 occurences) 45.txt  8.600986 47%  
>> (18 occurences)
>>     
>
> 45.txt might be a document with more therms so that its score is lower although it contains more matches.
>
> Regards
>  Daniel
>
> --
> http://www.danielnaber.de
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30850-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 00:14:47 2007
Return-Path: <java-user-return-30850-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33904 invoked from network); 2 Nov 2007 00:14:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 00:14:47 -0000
Received: (qmail 80666 invoked by uid 500); 2 Nov 2007 00:14:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80632 invoked by uid 500); 2 Nov 2007 00:14:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80621 invoked by uid 99); 2 Nov 2007 00:14:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 17:14:29 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.82.225 as permitted sender)
Received: from [66.249.82.225] (HELO wx-out-0506.google.com) (66.249.82.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 00:14:32 +0000
Received: by wx-out-0506.google.com with SMTP id i28so534359wxd
        for <java-user@lucene.apache.org>; Thu, 01 Nov 2007 17:14:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=GRhx19tJhW6VZkKkgZNeKhek1E8A888XZnYaaVgT79k=;
        b=SBI5PVrewi49JTwbQqbB1lkfkuKwrlxzGMQ3eAGbBEQIRLE+4ifrnaj5t8X9d+BVU5LM00WALFpf1c6WUkEv0aLwatteWeedMcuOLc+ffIywp7L+KMjKPCROzTIIguzLTwO48Js3zxyAeJB6RHukdeTDYwO0pIQXlgqT9oeYmGo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=J9kWXAK7Ey5lpFYP+4iwaR81Nw0MBmpdiQv/1ERTtVmnyosl+DOeXKUiqLTtn0FVGBhxURaZVPqrLMJjlHSp4ghedUYxEyxyEGLcAnjTljFt+qXYjzF7FswkijAsHRBahBwjBXRtU32HO1yo+bjduJb4fL2EUP8WFiRB8o583Ak=
Received: by 10.70.13.6 with SMTP id 6mr1587722wxm.1193962450909;
        Thu, 01 Nov 2007 17:14:10 -0700 (PDT)
Received: from ?192.168.1.103? ( [69.124.234.183])
        by mx.google.com with ESMTPS id c78sm1640020hsa.2007.11.01.17.14.05
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 01 Nov 2007 17:14:08 -0700 (PDT)
Message-ID: <472A6BB6.9070901@gmail.com>
Date: Thu, 01 Nov 2007 20:13:42 -0400
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: problem undestanding the hits.score
References: <808815.81254.qm@web25703.mail.ukl.yahoo.com>
In-Reply-To: <808815.81254.qm@web25703.mail.ukl.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

There are many factors that go into scoring. Erick gave a nice link that 
will help you out.

Also, check out Query.explain(). That will tell you how your score was 
resolved.

To give you a start, normally shorter fields are preferred...finding a 
keyword in a short title is usually more relevant than in a huge body.

Jamal jamalator wrote:
>  Hi 
>
> I have indexed this html document 
> =============z1========================
> <html>
>   <body>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1>
>   </body>
> </html>
> =============z2=========================
>  <html>
>    <body>
>  <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
>  <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
>    </body>
>  </html>
> =============z3==========================
>  <html>
>    <body>
>  <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
>    </body>
>  </html>
> =========================================
> with this code
>
> Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),Field.Store.NO,Field.Index.TOKENIZED );
> contentK1.setBoost(1/10f);  //10%
> doc.add(contentK1);
>        
> and when a search "zo" with luke i have (whitespaceanalyser):
>
> (score , id   )
> (0,0957,z2 )
> (0,0947,z3 )
> (0,0938,z1)
>
> NORMALY the resut expected have to be z1 z2 z3
>
> Some One have an idea ??
>
> Thank you all
>
>                 
>
> ---------------------------------
>   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>
>              
> ---------------------------------
>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30851-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 02:57:07 2007
Return-Path: <java-user-return-30851-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16932 invoked from network); 2 Nov 2007 02:57:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 02:57:07 -0000
Received: (qmail 16339 invoked by uid 500); 2 Nov 2007 02:56:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16301 invoked by uid 500); 2 Nov 2007 02:56:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16290 invoked by uid 99); 2 Nov 2007 02:56:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Nov 2007 19:56:49 -0700
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 02:56:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Inmhz-0002uk-PT
	for java-user@lucene.apache.org; Thu, 01 Nov 2007 19:56:31 -0700
Message-ID: <13541503.post@talk.nabble.com>
Date: Thu, 1 Nov 2007 19:56:31 -0700 (PDT)
From: Vs_Inf <vyalavarthi@informatica.com>
To: java-user@lucene.apache.org
Subject: Parsing text containing forward slash and wildcard
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: vyalavarthi@informatica.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,
 Using StandardAnalyzer, when we indexed the text "/123xcv",
QueryParser.parse() produced "123xcv". 
During searching using the same Analyzer, parsing a search text of "/123"
produced "123" but parsing "/123*" produces "/123*". 
How can i get a parser output of "123*" when parsing "/123*"?

Thanks for your help.
-Vasu
-- 
View this message in context: http://www.nabble.com/Parsing-text-containing-forward-slash-and-wildcard-tf4735312.html#a13541503
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30852-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 08:38:09 2007
Return-Path: <java-user-return-30852-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96552 invoked from network); 2 Nov 2007 08:38:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 08:38:09 -0000
Received: (qmail 7991 invoked by uid 500); 2 Nov 2007 08:37:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7336 invoked by uid 500); 2 Nov 2007 08:37:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7325 invoked by uid 99); 2 Nov 2007 08:37:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 01:37:50 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.53] (HELO web25711.mail.ukl.yahoo.com) (217.12.10.53)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 02 Nov 2007 08:38:09 +0000
Received: (qmail 48470 invoked by uid 60001); 2 Nov 2007 08:37:29 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=X-YMail-OSG:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=AGJW6wMifr/6fB7uFIXd7HZTacafAnx1BBuwatIXAIVDc55LXFGAazIi/K4D3x1jaQEc9sk18uUzPgDoX8YYKN9DCdf1+uiBCqPMBVDqIi+hKBX7IeqsoWaq/ht3R1jy9upSSWXf3r0oHezhRRhjtJ8XZxLXufyrGG5Fxs+5Sq0=;
X-YMail-OSG: t_9D8nsVM1mX1L09KWAEWXnOR98Uo7DLr4BajTNkHFsnSGqe10WIK65eYaLZHDaT2aRLGZvX7Q.a591fMAYhMJPCn1RjVPUzHtP6y2BsqF7fElb4
Received: from [41.248.2.53] by web25711.mail.ukl.yahoo.com via HTTP; Fri, 02 Nov 2007 09:37:28 CET
Date: Fri, 2 Nov 2007 09:37:28 +0100 (CET)
From: Jamal H Tandina <jtandina@yahoo.fr>
Subject: how to use Field.TermVector
To: luceneMAIL <java-user@lucene.apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1661093156-1193992648=:48341"
Content-Transfer-Encoding: 8bit
Message-ID: <44428.48341.qm@web25711.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1661093156-1193992648=:48341
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Hi

Iam having problem using Field.TermVector, i dont know how to use it. does some one have an exemple or an address, how to use the termVector in indexing an searching?

doc.add(new Field("title", httpd.getTiltle(), Field.Store.YES,  Field.TermVector));

Thanks

             
---------------------------------
 Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
--0-1661093156-1193992648=:48341--

From java-user-return-30853-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 08:42:03 2007
Return-Path: <java-user-return-30853-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98323 invoked from network); 2 Nov 2007 08:42:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 08:42:03 -0000
Received: (qmail 16417 invoked by uid 500); 2 Nov 2007 08:41:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15508 invoked by uid 500); 2 Nov 2007 08:41:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15497 invoked by uid 99); 2 Nov 2007 08:41:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 01:41:45 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [213.157.179.162] (HELO mail.mcr.ro) (213.157.179.162)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 08:42:08 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.mcr.ro (Postfix) with ESMTP id 8EE1B2AC0A9
	for <java-user@lucene.apache.org>; Fri,  2 Nov 2007 10:54:53 +0200 (EET)
Received: from mail.mcr.ro ([127.0.0.1])
	by localhost (2beer [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
	id 02471-16 for <java-user@lucene.apache.org>;
	Fri, 2 Nov 2007 10:54:52 +0200 (EET)
Received: from [192.168.0.32] (unknown [192.168.0.32])
	by mail.mcr.ro (Postfix) with ESMTP id EFA062AC0A1
	for <java-user@lucene.apache.org>; Fri,  2 Nov 2007 10:54:52 +0200 (EET)
Message-ID: <472AE2B7.7040901@mcr.ro>
Date: Fri, 02 Nov 2007 10:41:27 +0200
From: Ion Badita <ion.badita@mcr.ro>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: problem undestanding the hits.score
References: <808815.81254.qm@web25703.mail.ukl.yahoo.com>
In-Reply-To: <808815.81254.qm@web25703.mail.ukl.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at mcr.ro
X-Virus-Checked: Checked by ClamAV on apache.org

Try too look at Similarity, there you will find thinks about the 
scoring. Your query is more "similar" with the shorter document.
If you have 2 documents with a field body; first with words "red flower" 
and the second with just one word "flower", and search for the word 
"flower", the second document will score high because is very similar 
with the query.

If you want to give priority to documents that are larger, like z1, you 
should change the DefaultSimilarity (at index time), more exactly the 
method:

  public float lengthNorm(String fieldName, int numTerms) {
    return (float)(1.0 / Math.sqrt(numTerms));
  }

to something like this

  public float lengthNorm(String fieldName, int numTerms) {
    return (float)(Math.sqrt(numTerms));
  }


Reindex your documents with the Similarity modified and try to search 
again. The IndexWriter has a method to set the similarity used for indexing.


I hope this will help you...


Ion



Jamal jamalator wrote:
>  Hi 
>
> I have indexed this html document 
> =============z1========================
> <html>
>   <body>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
> <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1>
>   </body>
> </html>
> =============z2=========================
>  <html>
>    <body>
>  <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
>  <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
>    </body>
>  </html>
> =============z3==========================
>  <html>
>    <body>
>  <h1>zo zo zo zo zo zo zo zo zo zo zo zo </h1><br>
>    </body>
>  </html>
> =========================================
> with this code
>
> Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),Field.Store.NO,Field.Index.TOKENIZED );
> contentK1.setBoost(1/10f);  //10%
> doc.add(contentK1);
>        
> and when a search "zo" with luke i have (whitespaceanalyser):
>
> (score , id   )
> (0,0957,z2 )
> (0,0947,z3 )
> (0,0938,z1)
>
> NORMALY the resut expected have to be z1 z2 z3
>
> Some One have an idea ??
>
> Thank you all
>
>                 
>
> ---------------------------------
>   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>
>              
> ---------------------------------
>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30854-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 08:51:55 2007
Return-Path: <java-user-return-30854-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2932 invoked from network); 2 Nov 2007 08:51:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 08:51:55 -0000
Received: (qmail 22565 invoked by uid 500); 2 Nov 2007 08:51:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22532 invoked by uid 500); 2 Nov 2007 08:51:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22521 invoked by uid 99); 2 Nov 2007 08:51:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 01:51:37 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.178] (HELO web25706.mail.ukl.yahoo.com) (217.12.10.178)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 02 Nov 2007 08:51:56 +0000
Received: (qmail 17910 invoked by uid 60001); 2 Nov 2007 08:51:16 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=t1nohiz5AxJJfEFjEIPq2sEVGRxDHufRHNMPzFpAI3mEQZcBkWtHJ4+pi7dxOiHRvc3Aowi8vyWf7BnnPNTcsvs7kPddn5eJk8hyy1WraKJDk68swtQVgJVRfUsLtWc5Q2cFYTYVXYKRvG83UWV31QCgb2BxaRM1+kD0i6iZywg=;
X-YMail-OSG: n.6pnnMVM1kPqOntHnVaN2kNNrvoElcIMTSe0ElnTEnH5E_HiQVyHpMBOmKASTSD9dzfT6RjZcJIKiK26nmHObOduEwe7dNaW1B3.OxjRAj.NytF
Received: from [41.248.2.53] by web25706.mail.ukl.yahoo.com via HTTP; Fri, 02 Nov 2007 09:51:15 CET
Date: Fri, 2 Nov 2007 09:51:15 +0100 (CET)
From: Jamal H Tandina <jtandina@yahoo.fr>
Subject: RE : Re: problem undestanding the hits.score
To: java-user@lucene.apache.org
In-Reply-To: <472AE2B7.7040901@mcr.ro>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-142458868-1193993475=:17899"
Content-Transfer-Encoding: 8bit
Message-ID: <995658.17899.qm@web25706.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-142458868-1193993475=:17899
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Thank you  for your reply 

How can i change the defaultSimilarity in the indexing and the searching, do you have an example or an url how to set the Similarity  ?
http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/Similarity.html

Thanks again 

Ion Badita <ion.badita@mcr.ro> a crit : Try too look at Similarity, there you will find thinks about the 
scoring. Your query is more "similar" with the shorter document.
If you have 2 documents with a field body; first with words "red flower" 
and the second with just one word "flower", and search for the word 
"flower", the second document will score high because is very similar 
with the query.

If you want to give priority to documents that are larger, like z1, you 
should change the DefaultSimilarity (at index time), more exactly the 
method:

  public float lengthNorm(String fieldName, int numTerms) {
    return (float)(1.0 / Math.sqrt(numTerms));
  }

to something like this

  public float lengthNorm(String fieldName, int numTerms) {
    return (float)(Math.sqrt(numTerms));
  }


Reindex your documents with the Similarity modified and try to search 
again. The IndexWriter has a method to set the similarity used for indexing.


I hope this will help you...


Ion



Jamal jamalator wrote:
>  Hi 
>
> I have indexed this html document 
> =============z1========================
> 
>   
> zo zo zo zo zo zo zo zo zo zo zo zo 

> zo zo zo zo zo zo zo zo zo zo zo zo 

> zo zo zo zo zo zo zo zo zo zo zo zo 
>   
> 
> =============z2=========================
>  
>    
>  zo zo zo zo zo zo zo zo zo zo zo zo 

>  zo zo zo zo zo zo zo zo zo zo zo zo 

>    
>  
> =============z3==========================
>  
>    
>  zo zo zo zo zo zo zo zo zo zo zo zo 

>    
>  
> =========================================
> with this code
>
> Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),Field.Store.NO,Field.Index.TOKENIZED );
> contentK1.setBoost(1/10f);  //10%
> doc.add(contentK1);
>        
> and when a search "zo" with luke i have (whitespaceanalyser):
>
> (score , id   )
> (0,0957,z2 )
> (0,0947,z3 )
> (0,0938,z1)
>
> NORMALY the resut expected have to be z1 z2 z3
>
> Some One have an idea ??
>
> Thank you all
>
>                 
>
> ---------------------------------
>   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>
>              
> ---------------------------------
>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



             
---------------------------------
 Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
--0-142458868-1193993475=:17899--

From java-user-return-30855-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 09:11:18 2007
Return-Path: <java-user-return-30855-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7278 invoked from network); 2 Nov 2007 09:11:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 09:11:18 -0000
Received: (qmail 41713 invoked by uid 500); 2 Nov 2007 09:11:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41679 invoked by uid 500); 2 Nov 2007 09:11:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41668 invoked by uid 99); 2 Nov 2007 09:11:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 02:11:00 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [213.157.179.162] (HELO mail.mcr.ro) (213.157.179.162)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 09:11:04 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.mcr.ro (Postfix) with ESMTP id 67BE62AC0A9
	for <java-user@lucene.apache.org>; Fri,  2 Nov 2007 11:24:08 +0200 (EET)
Received: from mail.mcr.ro ([127.0.0.1])
	by localhost (2beer [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
	id 04458-07 for <java-user@lucene.apache.org>;
	Fri, 2 Nov 2007 11:24:07 +0200 (EET)
Received: from [192.168.0.32] (unknown [192.168.0.32])
	by mail.mcr.ro (Postfix) with ESMTP id 939F12AC0A1
	for <java-user@lucene.apache.org>; Fri,  2 Nov 2007 11:24:07 +0200 (EET)
Message-ID: <472AE991.9020603@mcr.ro>
Date: Fri, 02 Nov 2007 11:10:41 +0200
From: Ion Badita <ion.badita@mcr.ro>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: RE : Re: problem undestanding the hits.score
References: <995658.17899.qm@web25706.mail.ukl.yahoo.com>
In-Reply-To: <995658.17899.qm@web25706.mail.ukl.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at mcr.ro
X-Virus-Checked: Checked by ClamAV on apache.org

For your specific problem you need to change the DefaultSimilarity only 
at index time, because the lengthNorm is written to the index when is 
created.
So... first you'll need to extend the DefaultSimilarity and override the 
lengthNorm() method with the one suggested in the previous replay; then 
set your (changed) similarity to the IndexWriter like this:

IndexWriter indexWriter = new IndexWriter(....);
indexWriter.setSimilarity(new YourSimilarity());

Add your documents... and search.


Ion


Jamal H Tandina wrote:
> Thank you  for your reply 
>
> How can i change the defaultSimilarity in the indexing and the searching, do you have an example or an url how to set the Similarity  ?
> http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/Similarity.html
>
> Thanks again 
>
> Ion Badita <ion.badita@mcr.ro> a crit : Try too look at Similarity, there you will find thinks about the 
> scoring. Your query is more "similar" with the shorter document.
> If you have 2 documents with a field body; first with words "red flower" 
> and the second with just one word "flower", and search for the word 
> "flower", the second document will score high because is very similar 
> with the query.
>
> If you want to give priority to documents that are larger, like z1, you 
> should change the DefaultSimilarity (at index time), more exactly the 
> method:
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(1.0 / Math.sqrt(numTerms));
>   }
>
> to something like this
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(Math.sqrt(numTerms));
>   }
>
>
> Reindex your documents with the Similarity modified and try to search 
> again. The IndexWriter has a method to set the similarity used for indexing.
>
>
> I hope this will help you...
>
>
> Ion
>
>
>
> Jamal jamalator wrote:
>   
>>  Hi 
>>
>> I have indexed this html document 
>> =============z1========================
>>
>>   
>> zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>> zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>> zo zo zo zo zo zo zo zo zo zo zo zo 
>>   
>>
>> =============z2=========================
>>  
>>    
>>  zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>>  zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>>    
>>  
>> =============z3==========================
>>  
>>    
>>  zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>>    
>>  
>> =========================================
>> with this code
>>
>> Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),Field.Store.NO,Field.Index.TOKENIZED );
>> contentK1.setBoost(1/10f);  //10%
>> doc.add(contentK1);
>>        
>> and when a search "zo" with luke i have (whitespaceanalyser):
>>
>> (score , id   )
>> (0,0957,z2 )
>> (0,0947,z3 )
>> (0,0938,z1)
>>
>> NORMALY the resut expected have to be z1 z2 z3
>>
>> Some One have an idea ??
>>
>> Thank you all
>>
>>                 
>>
>> ---------------------------------
>>   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>>
>>              
>> ---------------------------------
>>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>>   
>>     
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>              
> ---------------------------------
>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30856-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 09:14:02 2007
Return-Path: <java-user-return-30856-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7639 invoked from network); 2 Nov 2007 09:14:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 09:14:01 -0000
Received: (qmail 46320 invoked by uid 500); 2 Nov 2007 09:13:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46284 invoked by uid 500); 2 Nov 2007 09:13:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46273 invoked by uid 99); 2 Nov 2007 09:13:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 02:13:43 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.178] (HELO web25706.mail.ukl.yahoo.com) (217.12.10.178)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 02 Nov 2007 09:13:44 +0000
Received: (qmail 26764 invoked by uid 60001); 2 Nov 2007 09:13:22 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=VIz9S+pi+hDH4OTWyH9ZIX2HfQ+u+KTcB4TLJF5/fj0Tlxx3qcrMMOH2nRlJFI0BaKBf7SbVMnZGMWXx+StZyKDbf+e8dKvY0v3aQTkhHOJyfVCejwGM1nyMaZF0pHL9rigP+UaTXIa9u7zvdSwijdwzwfTQo56BkAWtN2lkGk0=;
X-YMail-OSG: HUxkMtAVM1kVXS3_z.xqOqFMt7HlLZwf0H1voiVy8ciVLoChDhxK8hAdgSCziiZv3soIUoNo2LjZwa80.k2Mnd9iWZBM5i75VBLP7Y5u.1kSR79C
Received: from [41.248.2.53] by web25706.mail.ukl.yahoo.com via HTTP; Fri, 02 Nov 2007 10:13:22 CET
Date: Fri, 2 Nov 2007 10:13:22 +0100 (CET)
From: Jamal H Tandina <jtandina@yahoo.fr>
Subject: RE : Re: problem undestanding the hits.score
To: java-user@lucene.apache.org
In-Reply-To: <995658.17899.qm@web25706.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1103909671-1193994802=:26712"
Content-Transfer-Encoding: 8bit
Message-ID: <318407.26712.qm@web25706.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1103909671-1193994802=:26712
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

<<<<

If you want to give priority to documents that are larger, like z1, you
 
should change the DefaultSimilarity (at index time), more exactly the 
method:

  public float lengthNorm(String fieldName, int numTerms) {
    return (float)(1.0 / Math.sqrt(numTerms));
  }

to something like this

  public float lengthNorm(String fieldName, int numTerms) {
    return (float)(Math.sqrt(numTerms));


  }
>>>

I want to give priority to documents that have the word we are searching more frequent !

Thank you



Jamal H Tandina <jtandina@yahoo.fr> a crit : Thank you  for your reply 

How can i change the defaultSimilarity in the indexing and the searching, do you have an example or an url how to set the Similarity  ?
http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/Similarity.html

Thanks again 

Ion Badita  a crit : Try too look at Similarity, there you will find thinks about the 
scoring. Your query is more "similar" with the shorter document.
If you have 2 documents with a field body; first with words "red flower" 
and the second with just one word "flower", and search for the word 
"flower", the second document will score high because is very similar 
with the query.

If you want to give priority to documents that are larger, like z1, you 
should change the DefaultSimilarity (at index time), more exactly the 
method:

  public float lengthNorm(String fieldName, int numTerms) {
    return (float)(1.0 / Math.sqrt(numTerms));
  }

to something like this

  public float lengthNorm(String fieldName, int numTerms) {
    return (float)(Math.sqrt(numTerms));
  }


Reindex your documents with the Similarity modified and try to search 
again. The IndexWriter has a method to set the similarity used for indexing.


I hope this will help you...


Ion



Jamal jamalator wrote:
>  Hi 
>
> I have indexed this html document 
> =============z1========================
> 
>   
> zo zo zo zo zo zo zo zo zo zo zo zo 

> zo zo zo zo zo zo zo zo zo zo zo zo 

> zo zo zo zo zo zo zo zo zo zo zo zo 
>   
> 
> =============z2=========================
>  
>    
>  zo zo zo zo zo zo zo zo zo zo zo zo 

>  zo zo zo zo zo zo zo zo zo zo zo zo 

>    
>  
> =============z3==========================
>  
>    
>  zo zo zo zo zo zo zo zo zo zo zo zo 

>    
>  
> =========================================
> with this code
>
> Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),Field.Store.NO,Field.Index.TOKENIZED );
> contentK1.setBoost(1/10f);  //10%
> doc.add(contentK1);
>        
> and when a search "zo" with luke i have (whitespaceanalyser):
>
> (score , id   )
> (0,0957,z2 )
> (0,0947,z3 )
> (0,0938,z1)
>
> NORMALY the resut expected have to be z1 z2 z3
>
> Some One have an idea ??
>
> Thank you all
>
>                 
>
> ---------------------------------
>   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>
>              
> ---------------------------------
>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



             
---------------------------------
 Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 

             
---------------------------------
 Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
--0-1103909671-1193994802=:26712--

From java-user-return-30857-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 09:19:12 2007
Return-Path: <java-user-return-30857-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8307 invoked from network); 2 Nov 2007 09:19:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 09:19:11 -0000
Received: (qmail 51427 invoked by uid 500); 2 Nov 2007 09:18:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51388 invoked by uid 500); 2 Nov 2007 09:18:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51377 invoked by uid 99); 2 Nov 2007 09:18:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 02:18:53 -0700
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [213.157.179.162] (HELO mail.mcr.ro) (213.157.179.162)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 09:18:57 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mail.mcr.ro (Postfix) with ESMTP id C640E2AC0A9
	for <java-user@lucene.apache.org>; Fri,  2 Nov 2007 11:32:01 +0200 (EET)
Received: from mail.mcr.ro ([127.0.0.1])
	by localhost (2beer [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
	id 04458-10 for <java-user@lucene.apache.org>;
	Fri, 2 Nov 2007 11:32:01 +0200 (EET)
Received: from [192.168.0.32] (unknown [192.168.0.32])
	by mail.mcr.ro (Postfix) with ESMTP id 1E8BB2AC0A1
	for <java-user@lucene.apache.org>; Fri,  2 Nov 2007 11:32:01 +0200 (EET)
Message-ID: <472AEB6B.6040106@mcr.ro>
Date: Fri, 02 Nov 2007 11:18:35 +0200
From: Ion Badita <ion.badita@mcr.ro>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: RE : Re: problem undestanding the hits.score
References: <318407.26712.qm@web25706.mail.ukl.yahoo.com>
In-Reply-To: <318407.26712.qm@web25706.mail.ukl.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at mcr.ro
X-Virus-Checked: Checked by ClamAV on apache.org

That is already in the similarity formula, in tf term, documents that 
have more occurrences of a given term receive a higher score.


Jamal H Tandina wrote:
> <<<<
>
> If you want to give priority to documents that are larger, like z1, you
>  
> should change the DefaultSimilarity (at index time), more exactly the 
> method:
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(1.0 / Math.sqrt(numTerms));
>   }
>
> to something like this
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(Math.sqrt(numTerms));
>
>
>   }
>   
>
> I want to give priority to documents that have the word we are searching more frequent !
>
> Thank you
>
>
>
> Jamal H Tandina <jtandina@yahoo.fr> a crit : Thank you  for your reply 
>
> How can i change the defaultSimilarity in the indexing and the searching, do you have an example or an url how to set the Similarity  ?
> http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/Similarity.html
>
> Thanks again 
>
> Ion Badita  a crit : Try too look at Similarity, there you will find thinks about the 
> scoring. Your query is more "similar" with the shorter document.
> If you have 2 documents with a field body; first with words "red flower" 
> and the second with just one word "flower", and search for the word 
> "flower", the second document will score high because is very similar 
> with the query.
>
> If you want to give priority to documents that are larger, like z1, you 
> should change the DefaultSimilarity (at index time), more exactly the 
> method:
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(1.0 / Math.sqrt(numTerms));
>   }
>
> to something like this
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(Math.sqrt(numTerms));
>   }
>
>
> Reindex your documents with the Similarity modified and try to search 
> again. The IndexWriter has a method to set the similarity used for indexing.
>
>
> I hope this will help you...
>
>
> Ion
>
>
>
> Jamal jamalator wrote:
>   
>>  Hi 
>>
>> I have indexed this html document 
>> =============z1========================
>>
>>   
>> zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>> zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>> zo zo zo zo zo zo zo zo zo zo zo zo 
>>   
>>
>> =============z2=========================
>>  
>>    
>>  zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>>  zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>>    
>>  
>> =============z3==========================
>>  
>>    
>>  zo zo zo zo zo zo zo zo zo zo zo zo 
>>     
>
>   
>>    
>>  
>> =========================================
>> with this code
>>
>> Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),Field.Store.NO,Field.Index.TOKENIZED );
>> contentK1.setBoost(1/10f);  //10%
>> doc.add(contentK1);
>>        
>> and when a search "zo" with luke i have (whitespaceanalyser):
>>
>> (score , id   )
>> (0,0957,z2 )
>> (0,0947,z3 )
>> (0,0938,z1)
>>
>> NORMALY the resut expected have to be z1 z2 z3
>>
>> Some One have an idea ??
>>
>> Thank you all
>>
>>                 
>>
>> ---------------------------------
>>   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>>
>>              
>> ---------------------------------
>>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>>   
>>     
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>              
> ---------------------------------
>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>
>              
> ---------------------------------
>  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30858-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 10:05:00 2007
Return-Path: <java-user-return-30858-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19250 invoked from network); 2 Nov 2007 10:05:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 10:05:00 -0000
Received: (qmail 93609 invoked by uid 500); 2 Nov 2007 10:04:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93581 invoked by uid 500); 2 Nov 2007 10:04:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93570 invoked by uid 99); 2 Nov 2007 10:04:40 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 03:04:40 -0700
X-ASF-Spam-Status: No, hits=-2.0 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gresh@us.ibm.com designates 32.97.182.142 as permitted sender)
Received: from [32.97.182.142] (HELO e2.ny.us.ibm.com) (32.97.182.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 10:05:01 +0000
Received: from d01relay04.pok.ibm.com (d01relay04.pok.ibm.com [9.56.227.236])
	by e2.ny.us.ibm.com (8.13.8/8.13.8) with ESMTP id lA2A48DB021248
	for <java-user@lucene.apache.org>; Fri, 2 Nov 2007 06:04:08 -0400
Received: from d01av03.pok.ibm.com (d01av03.pok.ibm.com [9.56.224.217])
	by d01relay04.pok.ibm.com (8.13.8/8.13.8/NCO v8.5) with ESMTP id lA2A48Mk098644
	for <java-user@lucene.apache.org>; Fri, 2 Nov 2007 06:04:08 -0400
Received: from d01av03.pok.ibm.com (loopback [127.0.0.1])
	by d01av03.pok.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id lA2A48WK008270
	for <java-user@lucene.apache.org>; Fri, 2 Nov 2007 06:04:08 -0400
Received: from d01ml605.pok.ibm.com (d01ml605.pok.ibm.com [9.56.227.91])
	by d01av03.pok.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id lA2A48v8008265
	for <java-user@lucene.apache.org>; Fri, 2 Nov 2007 06:04:08 -0400
In-Reply-To: <359a92830711011556s2d493ddcw3deeadf01b2161b8@mail.gmail.com>
To: java-user@lucene.apache.org
MIME-Version: 1.0
Subject: Re: problem understanding the hits.score
X-Mailer: Lotus Notes Release 7.0 HF277 June 21, 2006
From: Donna L Gresh <gresh@us.ibm.com>
Message-ID: <OFA94B6781.F64F7887-ON85257387.003706FD-85257387.00374762@us.ibm.com>
Date: Fri, 2 Nov 2007 06:04:06 -0400
X-MIMETrack: Serialize by Router on D01ML605/01/M/IBM(Release 8.0|August 02, 2007) at 11/02/2007
 06:04:08,
	Serialize complete at 11/02/2007 06:04:08
Content-Type: multipart/alternative; boundary="=_alternative 003744AB85257387_="
X-Virus-Checked: Checked by ClamAV on apache.org

--=_alternative 003744AB85257387_=
Content-Type: text/plain; charset="US-ASCII"

I found this page extremely helpful in finding out EXACTLY what Lucene is 
doing (and how, if I wanted to, to change it). Like Erik said, it does 
pretty darn well just as it is. I'm not sure if anyone has already pointed 
you to this page yet.

You'll have to spend some time diving down in to each component of the 
score, as it's composed of a number of different factors, but it's all 
described on this page, and it tells you what the default behavior is 
using DefaultSimilarity.

http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/Similarity.html

Donna L. Gresh
Services Research, Mathematical Sciences Department
IBM T.J. Watson Research Center
(914) 945-2472
http://www.research.ibm.com/people/g/donnagresh
gresh@us.ibm.com

--=_alternative 003744AB85257387_=--

From java-user-return-30859-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 12:36:31 2007
Return-Path: <java-user-return-30859-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69273 invoked from network); 2 Nov 2007 12:36:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 12:36:31 -0000
Received: (qmail 60158 invoked by uid 500); 2 Nov 2007 12:36:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60133 invoked by uid 500); 2 Nov 2007 12:36:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60122 invoked by uid 99); 2 Nov 2007 12:36:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 05:36:13 -0700
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a13.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 12:36:13 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a13.g.dreamhost.com (Postfix) with ESMTP id E20F3129B39
	for <java-user@lucene.apache.org>; Fri,  2 Nov 2007 05:35:52 -0700 (PDT)
Message-Id: <C06DADDF-A157-45ED-A06A-CAA478D3387A@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <44428.48341.qm@web25711.mail.ukl.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: how to use Field.TermVector
Date: Fri, 2 Nov 2007 08:35:51 -0400
References: <44428.48341.qm@web25711.mail.ukl.yahoo.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org


On Nov 2, 2007, at 4:37 AM, Jamal H Tandina wrote:

> Hi
>
> Iam having problem using Field.TermVector, i dont know how to use  
> it. does some one have an exemple or an address, how to use the  
> termVector in indexing an searching?
>

doc.add(new Field("title", "value", Field.Store.YES,  
Field.Index.TOKENIZED, Field.TermVector.YES);

You don't really need to use it during searching necessarily, but it  
can come in handy for highlighting and other purposes (clustering,  
relevance feedback, etc.)

On the reader side,
IndexReader.getTermFreqVector(int, String)

let's you retrieve them from disk.

Also, see my talk from ApacheCon 2005 at http://cnlp.org/ 
apachecon2005/ as there are a number of examples there (although I  
don't guarantee they compile against the latest version of Lucene,  
they should still be generally applicable)




> doc.add(new Field("title", httpd.getTiltle(), Field.Store.YES,   
> Field.TermVector));
>
> Thanks
>
>
> ---------------------------------
> Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers  
> Yahoo! Mail

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30860-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 15:14:27 2007
Return-Path: <java-user-return-30860-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17912 invoked from network); 2 Nov 2007 15:14:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 15:14:27 -0000
Received: (qmail 75647 invoked by uid 500); 2 Nov 2007 15:14:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75193 invoked by uid 500); 2 Nov 2007 15:14:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75182 invoked by uid 99); 2 Nov 2007 15:14:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 08:14:07 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.196.101.41] (HELO web59215.mail.re1.yahoo.com) (66.196.101.41)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 02 Nov 2007 15:14:27 +0000
Received: (qmail 36446 invoked by uid 60001); 2 Nov 2007 15:13:46 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=0FuhmGNNat1GybNotRexqAO/nanBDNlNmh0orYQzAXtgoeq1ZHg36HG+7lBoY5oX8ROgvzNdxKMSUx4I6OFBEqPG9WTcsX8uCgo6O7mTF5x8MUHhkEpzH6Cih0jcIpc2rhzYcqe3UQZ33Ah3Z0CsBXxMMj7I0fnPkYx6s/4p74A=;
X-YMail-OSG: rzGWXUYVM1kn9DrvALPy6RlosxbwSxzxhwneJTm8J6O.YRT6Tuj2O4mOQyoWzvLEAu.pW3bheuCIJMwy.FgPiiqxWp4jNg.WEwP6cz_Ec.QfiRNFX6hpym4OkoQlT61YZ3RDqITNZsJpkvjBPJTbd3Se
Received: from [68.167.115.34] by web59215.mail.re1.yahoo.com via HTTP; Fri, 02 Nov 2007 08:13:46 PDT
Date: Fri, 2 Nov 2007 08:13:46 -0700 (PDT)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Re: Best way to count tokens
To: java-user@lucene.apache.org
In-Reply-To: <472A6970.7060906@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1362750182-1194016426=:36207"
Content-Transfer-Encoding: 8bit
Message-ID: <136984.36207.qm@web59215.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1362750182-1194016426=:36207
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

This works and I can reuse token streams. But why TokenStream.reset() does not work which was in my earlier case. Is this a marker method in TokenStream without implementation and CachingTokenFilter implements the method.
   
  - BR


Mark Miller <markrmiller@gmail.com> wrote:
  reset is optional. StandardAnalyzer does not implement it. Check out 
CachingTokenFilter and wrap StandardAnalzyer in it.

Cool Coder wrote:
> Currently I have extended StandardAnalyzer and counting tokens in the following way. But the index is not getting created , though I call tokenStream.reset(). I am not sure whether reset() on token stream works or not??? I am debugging now
> 
> public TokenStream tokenStream(String fieldName, Reader reader) {
> TokenStream result = super.tokenStream(fieldName,new HTMLStripReader(reader));
> //To count tokens and put in a Map
> analyzeTokens(result);
> try {
> result.reset();
> } catch (IOException e) {
> // TODO Auto-generated catch block
> e.printStackTrace();
> }
> return result;
> }
> 
> public void analyzeTokens(TokenStream result)
> {
> try {
> Token token = result.next();
> while(token != null)
> {
> String tokenStr = token.termText();
> if(TokenHolder.tokenMap.get(tokenStr) == null)
> {
> TokenHolder.tokenMap.put(tokenStr,1);
> }
> else
> {
> TokenHolder.tokenMap.put(tokenStr,Integer.parseInt(TokenHolder.tokenMap.get(tokenStr).toString())+1);
> }
> token = result.next();
> 
> }
> //exxtra reset 
> result.reset();
> } catch (IOException e) {
> e.printStackTrace();
> }
> }
> 
>
> Karl Wettin wrote:
> 
> 1 nov 2007 kl. 18.09 skrev Cool Coder:
>
> 
>> prior to adding into index
>> 
>
> Easiest way out would be to add the document to a temporary index and 
> extract the term frequency vector. I would recommend using MemoryIndex.
>
> You could also tokenize the document and pass the data to a 
> TermVectorMapper. You could consider replacing the fields of the 
> document with CachedTokenStreams if you got the RAM to spare and 
> don't want to waste CPU analyzing the document twice. I welcome 
> TermVectorMappingChachedTokenStreamFactory. Even cooler would be to 
> pass code down the IndexWriter.addDocument using a command pattern or 
> something, allowing one to extend the document at the time of the 
> analysis.
>
>
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



 __________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
--0-1362750182-1194016426=:36207--

From java-user-return-30861-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 02 17:26:51 2007
Return-Path: <java-user-return-30861-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71198 invoked from network); 2 Nov 2007 17:26:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 2 Nov 2007 17:26:51 -0000
Received: (qmail 80120 invoked by uid 500); 2 Nov 2007 17:26:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80086 invoked by uid 500); 2 Nov 2007 17:26:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80075 invoked by uid 99); 2 Nov 2007 17:26:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 10:26:12 -0700
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.187 as permitted sender)
Received: from [209.85.128.187] (HELO fk-out-0910.google.com) (209.85.128.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 02 Nov 2007 17:26:14 +0000
Received: by fk-out-0910.google.com with SMTP id z23so842799fkz
        for <java-user@lucene.apache.org>; Fri, 02 Nov 2007 10:25:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=PCtqzb+6GjT8V9iP9QqYrjJgPFTn4O20je5y/QJ59zA=;
        b=uMOSH9b6xf1+tPPWWyA+fuyW7yNy6+R+mHDx7smQR7dF15Cm44GRT72iWqRIU0b4/3SRnCXgTxqmGcrSAPbCGLJ25bHYN1YuyQaPuCrsuSnMXOj3UomxQjkqERmd1fZV260qSSIvSdza1OeHGuDJmLKLi5y7qmyI4G3BfLRLgCg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Vv/DiG3h+WOymT1wfAjBmtDaQzPzjPXqDyhGmtivGfP/W2ko/YR+lcBq3S6MXhqO0Sl5orkW6w4Pd+1xoSdm8pMotmG6ueONC12Fp9PtVtS1rsNKEhoU1DN/y6rCxGB/+d5912IcnjB5RuUC0223V1SEZukSzVCkBqLa0drJ3Ck=
Received: by 10.82.138.6 with SMTP id l6mr3986388bud.1194024351582;
        Fri, 02 Nov 2007 10:25:51 -0700 (PDT)
Received: by 10.82.167.3 with HTTP; Fri, 2 Nov 2007 10:25:51 -0700 (PDT)
Message-ID: <359a92830711021025g2f16a628p2255d9746b60f45c@mail.gmail.com>
Date: Fri, 2 Nov 2007 13:25:51 -0400
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: RE : Re: problem undestanding the hits.score
In-Reply-To: <318407.26712.qm@web25706.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_14401_12188535.1194024351566"
References: <995658.17899.qm@web25706.mail.ukl.yahoo.com>
	 <318407.26712.qm@web25706.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_14401_12188535.1194024351566
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

I strongly recommend against this. Simple word counts are a poor
measure of relevance. Which is why Lucene doesn't score that
way. Do you have an example showing why the default scoring is
inadequate or is this just an assumption?

It would be helpful if you gave us some idea of what you're trying
to accomplish. What is the use-case you're trying to solve? That
would generate more helpful responses I think....

Best
Erick

On 11/2/07, Jamal H Tandina <jtandina@yahoo.fr> wrote:
>
> <<<<
>
> If you want to give priority to documents that are larger, like z1, you
>
> should change the DefaultSimilarity (at index time), more exactly the
> method:
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(1.0 / Math.sqrt(numTerms));
>   }
>
> to something like this
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(Math.sqrt(numTerms));
>
>
>   }
> >>>
>
> I want to give priority to documents that have the word we are searching
> more frequent !
>
> Thank you
>
>
>
> Jamal H Tandina <jtandina@yahoo.fr> a =E9crit : Thank you  for your reply
>
> How can i change the defaultSimilarity in the indexing and the searching,
> do you have an example or an url how to set the Similarity  ?
>
> http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org=
/apache/lucene/search/Similarity.html
>
> Thanks again
>
> Ion Badita  a =E9crit : Try too look at Similarity, there you will find
> thinks about the
> scoring. Your query is more "similar" with the shorter document.
> If you have 2 documents with a field body; first with words "red flower"
> and the second with just one word "flower", and search for the word
> "flower", the second document will score high because is very similar
> with the query.
>
> If you want to give priority to documents that are larger, like z1, you
> should change the DefaultSimilarity (at index time), more exactly the
> method:
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(1.0 / Math.sqrt(numTerms));
>   }
>
> to something like this
>
>   public float lengthNorm(String fieldName, int numTerms) {
>     return (float)(Math.sqrt(numTerms));
>   }
>
>
> Reindex your documents with the Similarity modified and try to search
> again. The IndexWriter has a method to set the similarity used for
> indexing.
>
>
> I hope this will help you...
>
>
> Ion
>
>
>
> Jamal jamalator wrote:
> >  Hi
> >
> > I have indexed this html document
> > =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3Dz1=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> >
> >
> > zo zo zo zo zo zo zo zo zo zo zo zo
>
> > zo zo zo zo zo zo zo zo zo zo zo zo
>
> > zo zo zo zo zo zo zo zo zo zo zo zo
> >
> >
> > =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3Dz2=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> >
> >
> >  zo zo zo zo zo zo zo zo zo zo zo zo
>
> >  zo zo zo zo zo zo zo zo zo zo zo zo
>
> >
> >
> > =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3Dz3=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> >
> >
> >  zo zo zo zo zo zo zo zo zo zo zo zo
>
> >
> >
> > =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> > with this code
> >
> > Field contentK1 =3D new  Field("htmlcontent",httpd.getContentKeywords()=
,
> Field.Store.NO,Field.Index.TOKENIZED );
> > contentK1.setBoost(1/10f);  //10%
> > doc.add(contentK1);
> >
> > and when a search "zo" with luke i have (whitespaceanalyser):
> >
> > (score , id   )
> > (0,0957,z2 )
> > (0,0947,z3 )
> > (0,0938,z1)
> >
> > NORMALY the resut expected have to be z1 z2 z3
> >
> > Some One have an idea ??
> >
> > Thank you all
> >
> >
> >
> > ---------------------------------
> >   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers
> Yahoo! Mail
> >
> >
> > ---------------------------------
> >  Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo=
!
> Mail
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
> ---------------------------------
> Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo!
> Mail
>
>
> ---------------------------------
> Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo!
> Mail

------=_Part_14401_12188535.1194024351566--

From java-user-return-30862-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 04 08:40:04 2007
Return-Path: <java-user-return-30862-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72911 invoked from network); 4 Nov 2007 08:40:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 Nov 2007 08:40:04 -0000
Received: (qmail 7158 invoked by uid 500); 4 Nov 2007 08:39:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7115 invoked by uid 500); 4 Nov 2007 08:39:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7104 invoked by uid 99); 4 Nov 2007 08:39:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 01:39:44 -0700
X-ASF-Spam-Status: No, hits=3.5 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WEIRD_PORT
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of blueye117@gmail.com designates 209.85.198.189 as permitted sender)
Received: from [209.85.198.189] (HELO rv-out-0910.google.com) (209.85.198.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 08:39:42 +0000
Received: by rv-out-0910.google.com with SMTP id k20so966864rvb
        for <java-user@lucene.apache.org>; Sun, 04 Nov 2007 01:39:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=IzBeRMMpaGShrvgjEkD/U/FsA/5dbQRamzMIT1sgUWY=;
        b=jy+mpE5h1wKC+wB+9T8Vo3oFvm2CNtetyDOAol/l/BGdcauxXfx4YZ4JCpRB5gE3WYsiA0TKcxjr4xccyuXoBE4Xs0Jr7Pps2v8RM4wJI2DlJyWzmD7MO6AoGkugd4PGASrIcayoIZXxGOGT1KqZ7XtAvXPR56GssmUSGS5RWTU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=aOYGxMEJwF9FAIu7tQS5DB+dYV8zHSiOzoc7oQ8T8YugUjX2vCEdJ/P2389HfpA60lFfGEetrh4bZNbddv7vfkqz3qBhIJV4x5HVzyegQ9DsxKqnGvH8U1M4wyyRmSWb4kHNlgyPen3VSTlZkhRYNbqqNecdkvr0ygp10qS/5mI=
Received: by 10.140.164.1 with SMTP id m1mr1773797rve.1194165160177;
        Sun, 04 Nov 2007 01:32:40 -0700 (PDT)
Received: by 10.141.185.15 with HTTP; Sun, 4 Nov 2007 01:32:40 -0700 (PDT)
Message-ID: <f09790220711040132n6d535caeodf8d6e751815c2f4@mail.gmail.com>
Date: Sun, 4 Nov 2007 16:32:40 +0800
From: "h t" <blueye117@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: EdgeNGramTokenizer
In-Reply-To: <47276B47.8090407@libero.it>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_12182_22785109.1194165160160"
References: <47275FEF.7060100@libero.it> <47276B47.8090407@libero.it>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_12182_22785109.1194165160160
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

http://www.shifttab.cn:8001/wiki

2007/10/31, Marco <spinmar@libero.it>:
>
> It seems that the problem is when I add the token created by
> EdgeNGramTokenizer in in the index.
> If the token contains a space (for example apple com) I have to add to
> the index with Field.Index.TOKENIZED otherwise the search cannot find it.
> If there is no space there is no problem even if I use
> Field.Index.UN_TOKENIZED.
> So I'd like to know if there is speed search difference insertinf a
> field as TOKENIZED or UN_TOKENIZED.
> Best regards
>
>
>
> Marco ha scritto:
> > Hi all,
> > I'm following the suggestion of this forum on how create a suggestion
> > service like google suggest.
> > I'm parsing a words/rank file with my words.
> > For each word, I'm adding a document with content and rank in in
> > index: then I create a EdgeNGramTokenizer of the word. This gives me N
> > words and I add each one in a new field of the index.
> > So for each word in the index I have:
> > - content (for example apple)
> > - rank
> > - X initial letters of the word (for example app)
> > - X+1 initial letters of the word (for example appl)
> > - X+2 initial letters of the word (for example apple)
> > ....
> > - Y initial letters of the word (for example app)
> >
> > I add each additional field in the index as:
> >
> > doc.add(new Field(name_gram, tn.termText(), Field.Store.NO,
> > Field.Index.UN_TOKENIZED));
> >
> > When an user search a word, for example app, I have to query the index
> > the right field.
> > I calculate the length of the input and the I query the right field
> > and the I get the content of the docs.
> > Is it ok?
> > For search I use:
> >
> > String field_ok = field + line.length(); QueryParser parser = new
> > QueryParser(field_ok, analyzer);
> > Query query = parser.parse(line);
> > System.out.println("Searching for: " + query.toString(field_ok));
> > Hits hits = searcher.search(query, new Sort("rank", true));
> >
> >
> > All is ok if the input of the user doesn't contain spaces...
> > Am I missing something?
> > Best regards
> >
> > Marco
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_12182_22785109.1194165160160--

From java-user-return-30863-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 04 09:30:22 2007
Return-Path: <java-user-return-30863-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77581 invoked from network); 4 Nov 2007 09:30:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 Nov 2007 09:30:22 -0000
Received: (qmail 16663 invoked by uid 500); 4 Nov 2007 09:30:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16630 invoked by uid 500); 4 Nov 2007 09:30:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16619 invoked by uid 99); 4 Nov 2007 09:30:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 01:30:03 -0800
X-ASF-Spam-Status: No, hits=3.5 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WEIRD_PORT
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of blueye117@gmail.com designates 209.85.198.191 as permitted sender)
Received: from [209.85.198.191] (HELO rv-out-0910.google.com) (209.85.198.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 09:30:04 +0000
Received: by rv-out-0910.google.com with SMTP id k20so970990rvb
        for <java-user@lucene.apache.org>; Sun, 04 Nov 2007 01:29:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=IzBeRMMpaGShrvgjEkD/U/FsA/5dbQRamzMIT1sgUWY=;
        b=jy+mpE5h1wKC+wB+9T8Vo3oFvm2CNtetyDOAol/l/BGdcauxXfx4YZ4JCpRB5gE3WYsiA0TKcxjr4xccyuXoBE4Xs0Jr7Pps2v8RM4wJI2DlJyWzmD7MO6AoGkugd4PGASrIcayoIZXxGOGT1KqZ7XtAvXPR56GssmUSGS5RWTU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=aOYGxMEJwF9FAIu7tQS5DB+dYV8zHSiOzoc7oQ8T8YugUjX2vCEdJ/P2389HfpA60lFfGEetrh4bZNbddv7vfkqz3qBhIJV4x5HVzyegQ9DsxKqnGvH8U1M4wyyRmSWb4kHNlgyPen3VSTlZkhRYNbqqNecdkvr0ygp10qS/5mI=
Received: by 10.140.164.1 with SMTP id m1mr1773797rve.1194165160177;
        Sun, 04 Nov 2007 01:32:40 -0700 (PDT)
Received: by 10.141.185.15 with HTTP; Sun, 4 Nov 2007 01:32:40 -0700 (PDT)
Message-ID: <f09790220711040132n6d535caeodf8d6e751815c2f4@mail.gmail.com>
Date: Sun, 4 Nov 2007 16:32:40 +0800
From: "h t" <blueye117@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: EdgeNGramTokenizer
In-Reply-To: <47276B47.8090407@libero.it>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_12182_22785109.1194165160160"
References: <47275FEF.7060100@libero.it> <47276B47.8090407@libero.it>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_12182_22785109.1194165160160
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

http://www.shifttab.cn:8001/wiki

2007/10/31, Marco <spinmar@libero.it>:
>
> It seems that the problem is when I add the token created by
> EdgeNGramTokenizer in in the index.
> If the token contains a space (for example apple com) I have to add to
> the index with Field.Index.TOKENIZED otherwise the search cannot find it.
> If there is no space there is no problem even if I use
> Field.Index.UN_TOKENIZED.
> So I'd like to know if there is speed search difference insertinf a
> field as TOKENIZED or UN_TOKENIZED.
> Best regards
>
>
>
> Marco ha scritto:
> > Hi all,
> > I'm following the suggestion of this forum on how create a suggestion
> > service like google suggest.
> > I'm parsing a words/rank file with my words.
> > For each word, I'm adding a document with content and rank in in
> > index: then I create a EdgeNGramTokenizer of the word. This gives me N
> > words and I add each one in a new field of the index.
> > So for each word in the index I have:
> > - content (for example apple)
> > - rank
> > - X initial letters of the word (for example app)
> > - X+1 initial letters of the word (for example appl)
> > - X+2 initial letters of the word (for example apple)
> > ....
> > - Y initial letters of the word (for example app)
> >
> > I add each additional field in the index as:
> >
> > doc.add(new Field(name_gram, tn.termText(), Field.Store.NO,
> > Field.Index.UN_TOKENIZED));
> >
> > When an user search a word, for example app, I have to query the index
> > the right field.
> > I calculate the length of the input and the I query the right field
> > and the I get the content of the docs.
> > Is it ok?
> > For search I use:
> >
> > String field_ok = field + line.length(); QueryParser parser = new
> > QueryParser(field_ok, analyzer);
> > Query query = parser.parse(line);
> > System.out.println("Searching for: " + query.toString(field_ok));
> > Hits hits = searcher.search(query, new Sort("rank", true));
> >
> >
> > All is ok if the input of the user doesn't contain spaces...
> > Am I missing something?
> > Best regards
> >
> > Marco
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_12182_22785109.1194165160160--

From java-user-return-30864-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 04 18:49:02 2007
Return-Path: <java-user-return-30864-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78372 invoked from network); 4 Nov 2007 18:49:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 4 Nov 2007 18:49:02 -0000
Received: (qmail 38832 invoked by uid 500); 4 Nov 2007 18:48:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38786 invoked by uid 500); 4 Nov 2007 18:48:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38775 invoked by uid 99); 4 Nov 2007 18:48:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 10:48:43 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mahendru.sandeep@gmail.com designates 64.233.182.189 as permitted sender)
Received: from [64.233.182.189] (HELO nf-out-0910.google.com) (64.233.182.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 18:48:47 +0000
Received: by nf-out-0910.google.com with SMTP id d3so957935nfc
        for <java-user@lucene.apache.org>; Sun, 04 Nov 2007 10:48:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:mime-version:content-type;
        bh=xUX9jv9Qe+AezG9HUtxNNoUYIZlwjfPsPZ8+mU/frsw=;
        b=nLUmdDnMU9tzcGTIOpNkXvLcBUxKOWGD21jTE4SMAL1XG6RAgpTPaBRfESQ21qmNiHisgGJSSyTRSVSeE0ZXFodrHtfW9ALNXUGS8AwDmKGHDXjdxTDdd4ATqYp6usimQ1KoxYvSidwpnqSjo3WLW6bs1G5Yb0jUUiR2SL2dR/k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:cc:mime-version:content-type;
        b=biZxSy3bj4tTT699yWExAunVdLX0pDsdZlJFCYQ/ztXevAwSkasrczpnfkQFinhAnhPR1y71C4nIkSdV9cR23aMuWs6hA1EMrMV69OItAODrClH1f3vGEIQMcY1slfa3y9RNdvsPyR1TCHNYz+cs8s3pymhETMPUh1EUosjCbbc=
Received: by 10.78.184.2 with SMTP id h2mr3174908huf.1194202104854;
        Sun, 04 Nov 2007 10:48:24 -0800 (PST)
Received: by 10.78.67.3 with HTTP; Sun, 4 Nov 2007 10:48:24 -0800 (PST)
Message-ID: <41f0d6590711041048y1e8421edpab755af82436094f@mail.gmail.com>
Date: Sun, 4 Nov 2007 13:48:24 -0500
From: "Sandeep Mahendru" <mahendru.sandeep@gmail.com>
To: java-user@lucene.apache.org
Subject: How do we limit the growth of a Lucene Index?
Cc: "Mahendru, Sandeep" <Sandeep.Mahendru@wachovia.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_18947_2405165.1194202104844"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_18947_2405165.1194202104844
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi ,

   We have been developing an enterprise logging service at the Wachovia
bank. The logs (Busines, application, error) for all the bank related
applications are consolidated
at one single location in an Oracle 10g Database.

In our second phase, we are now building a high perforinmg report viewer
over it. So our search algorithm does not go to the Oracle 10g DB. We
therfore avoid network and I/O.
Our serach algorith now goes to a LUCENE index. We have Lucene indexes
created for each application. These indexes are present on the same machine,
where the search algorithm runs. As more applications at the bank are now
beginning to consume this service, the Lucene Index is now growing.

One of my team leads has suggested the following approach to resolve this
issue:

*I think the best approach is to restrict the Index size , is to keep it for
some limited time and then archive the same. In case user wants to search
against the old files then we might need to provide some configuration using
which the lucene searcher can point to the achieved file and search the
content. To implement this we need to rename the Index file with from and to
date before its archived. While searching against the older files, user need
to provide the date range and then the app can point to the relevant
archived index files for search. Let me know your thoughts on this. *
**
At present this sounds the most logical to me. But then we begin to store
the Lucene indexes on a diffferent machine. This might again cause the
search algorithm to make a network trip, if the serach is based on old
archived data.

 Is there a better design to resolve the above concern. Does Lucene provid
some sort of API to handle the above scenario's?

Regards,
Sandeep.

------=_Part_18947_2405165.1194202104844--

From java-user-return-30865-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 05:58:08 2007
Return-Path: <java-user-return-30865-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28104 invoked from network); 5 Nov 2007 05:58:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 05:58:08 -0000
Received: (qmail 65034 invoked by uid 500); 5 Nov 2007 05:57:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65005 invoked by uid 500); 5 Nov 2007 05:57:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64994 invoked by uid 99); 5 Nov 2007 05:57:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 21:57:49 -0800
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.134.191] (HELO mu-out-0910.google.com) (209.85.134.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 05:57:50 +0000
Received: by mu-out-0910.google.com with SMTP id i10so1467933mue
        for <java-user@lucene.apache.org>; Sun, 04 Nov 2007 21:57:28 -0800 (PST)
Received: by 10.82.181.10 with SMTP id d10mr9037355buf.1194242247840;
        Sun, 04 Nov 2007 21:57:27 -0800 (PST)
Received: by 10.82.127.4 with HTTP; Sun, 4 Nov 2007 21:57:27 -0800 (PST)
Message-ID: <7e536b1f0711042157j4b2ee68fld8043344b022095d@mail.gmail.com>
Date: Mon, 5 Nov 2007 06:57:27 +0100
From: "Marcus Herou" <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Subject: Group by in Lucene ?
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_20510_7489798.1194242247826"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_20510_7489798.1194242247826
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi.

I have a situation where I'm searching amongst some 100K feeds and only want
one result per site in return. I have developed a really simple method of
grouping which just scrolls through the resultset(hitset) until a maxNum
docs of feeds from a set of unique sites is populated. Since I don't wanna
reinvent the wheel, I want to know if Lucene has something like this built.
I as well will use Solr soon and then my own homecooked recipe will not work
so I really need a standard way of doing this.

I know Nutch has something like it called depupField which default is set to
2.

Anyone?


Kindly

//Marcus

-- 
Marcus Herou Solution Architect & Core Java developer Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com

------=_Part_20510_7489798.1194242247826--

From java-user-return-30866-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 06:47:20 2007
Return-Path: <java-user-return-30866-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39373 invoked from network); 5 Nov 2007 06:47:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 06:47:19 -0000
Received: (qmail 92628 invoked by uid 500); 5 Nov 2007 06:47:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92593 invoked by uid 500); 5 Nov 2007 06:47:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92581 invoked by uid 99); 5 Nov 2007 06:47:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 22:47:02 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 06:47:04 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IovjP-0001L2-UK
	for java-user@lucene.apache.org; Sun, 04 Nov 2007 22:46:43 -0800
Message-ID: <13582008.post@talk.nabble.com>
Date: Sun, 4 Nov 2007 22:46:43 -0800 (PST)
From: jackxin <jackxin2100@gmail.com>
To: java-user@lucene.apache.org
Subject: Does someone know how to sort the hits list by a specified document
 field?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: jackxin2100@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Does someone know how to sort the hits list by a specified document field?
Even if the field is numeric or datetime etc.

-- 
View this message in context: http://www.nabble.com/Does-someone-know-how-to-sort-the-hits-list-by-a-specified-document-field--tf4749900.html#a13582008
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30867-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 06:54:39 2007
Return-Path: <java-user-return-30867-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40533 invoked from network); 5 Nov 2007 06:54:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 06:54:39 -0000
Received: (qmail 97909 invoked by uid 500); 5 Nov 2007 06:54:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97874 invoked by uid 500); 5 Nov 2007 06:54:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97863 invoked by uid 99); 5 Nov 2007 06:54:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Nov 2007 22:54:20 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of durgadeep@gmail.com designates 209.85.198.185 as permitted sender)
Received: from [209.85.198.185] (HELO rv-out-0910.google.com) (209.85.198.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 06:54:51 +0000
Received: by rv-out-0910.google.com with SMTP id k20so1155213rvb
        for <java-user@lucene.apache.org>; Sun, 04 Nov 2007 22:54:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=jBJcWGHeEzoGgcMYSxlrfCQdPUCRzwvzxpSdcAci07A=;
        b=lXcxIlZ2rjiLdM3AU2noPhyQ/NP+CFYYb5P6KQDrkhEpLxmNyifRuRtZx/t5ZGmA1uJScffP2cntl0wGKHvt2nis8imTWkeU+J7/QmnlhAJiCJ8qfljSiR9juLf1AUKIQ5Gpf/iZ9Bfxzw/3M1O68hf24rfFADM/z+Jp2XJlPwU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=dFfQpwld31JUuHRa9jlw5BqzP5c3AgO2FXTyaetCJWqxuJCV9A0yOrev4uIsvUWvfZuh+qJsmYhSzFc9FRNscjO7vebDK+5EHmJ4z7WNuDY+WrGqgVR1Ftl0ClQh5X7IyoIGM6PF3CMihfF/nweBJyjVZJhxGP1dSw8tAiEjGoc=
Received: by 10.141.210.16 with SMTP id m16mr997633rvq.1194245643573;
        Sun, 04 Nov 2007 22:54:03 -0800 (PST)
Received: by 10.140.128.14 with HTTP; Sun, 4 Nov 2007 22:54:03 -0800 (PST)
Message-ID: <21625f380711042254l550cdf97k5361d9e2db5cc917@mail.gmail.com>
Date: Sun, 4 Nov 2007 22:54:03 -0800
From: "DURGA DEEP" <durgadeep@gmail.com>
To: java-user@lucene.apache.org
Subject: Pointers on Messaging Server and Lucene.
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Folks,

         we have started on a project ( evaluating ) using Lucene with
our Groupware services ( Messaging / Calendar and IM for now ). Are
there any good pointers or links, we can reference before we start our
evaluation. Any feed back would be of immense help...

Thanks you!
_d

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30868-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 08:53:12 2007
Return-Path: <java-user-return-30868-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93643 invoked from network); 5 Nov 2007 08:53:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 08:53:12 -0000
Received: (qmail 35795 invoked by uid 500); 5 Nov 2007 08:52:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35766 invoked by uid 500); 5 Nov 2007 08:52:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35755 invoked by uid 99); 5 Nov 2007 08:52:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 00:52:52 -0800
X-ASF-Spam-Status: No, hits=3.4 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.128.191] (HELO fk-out-0910.google.com) (209.85.128.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 08:52:53 +0000
Received: by fk-out-0910.google.com with SMTP id z23so1527471fkz
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 00:52:31 -0800 (PST)
Received: by 10.82.175.17 with SMTP id x17mr9252473bue.1194252750556;
        Mon, 05 Nov 2007 00:52:30 -0800 (PST)
Received: by 10.82.127.4 with HTTP; Mon, 5 Nov 2007 00:52:30 -0800 (PST)
Message-ID: <7e536b1f0711050052h64965bb7pda1cd923c1e72b58@mail.gmail.com>
Date: Mon, 5 Nov 2007 09:52:30 +0100
From: "Marcus Herou" <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Subject: Re: Does someone know how to sort the hits list by a specified document field?
In-Reply-To: <13582008.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_21145_30635910.1194252750543"
References: <13582008.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_21145_30635910.1194252750543
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi.
Just add a Sort object to the search.

Sort sort = new Sort(sortField, !ascending);
Hits[] hits = searcher.search(query, sort);

Kindly

//Marcus

On 11/5/07, jackxin <jackxin2100@gmail.com> wrote:
>
>
> Does someone know how to sort the hits list by a specified document field?
> Even if the field is numeric or datetime etc.
>
> --
> View this message in context:
> http://www.nabble.com/Does-someone-know-how-to-sort-the-hits-list-by-a-specified-document-field--tf4749900.html#a13582008
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Marcus Herou Solution Architect & Core Java developer Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com

------=_Part_21145_30635910.1194252750543--

From java-user-return-30869-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 12:02:07 2007
Return-Path: <java-user-return-30869-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39891 invoked from network); 5 Nov 2007 12:02:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 12:02:06 -0000
Received: (qmail 37765 invoked by uid 500); 5 Nov 2007 12:01:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37735 invoked by uid 500); 5 Nov 2007 12:01:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37724 invoked by uid 99); 5 Nov 2007 12:01:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 04:01:48 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=FUZZY_CPILL,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a9.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:02:15 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a9.g.dreamhost.com (Postfix) with ESMTP id 7B9C621172
	for <java-user@lucene.apache.org>; Mon,  5 Nov 2007 04:01:25 -0800 (PST)
Message-Id: <F101D398-9CC5-4053-BFE1-72002F8822EE@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <7e536b1f0711042157j4b2ee68fld8043344b022095d@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Group by in Lucene ?
Date: Mon, 5 Nov 2007 07:01:23 -0500
References: <7e536b1f0711042157j4b2ee68fld8043344b022095d@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Solr has an issue outstanding right now that implements something that  
may be close to what you want.  They are calling it Field Collapsing.   
See https://issues.apache.org/jira/browse/SOLR-236

-Grant

On Nov 5, 2007, at 12:57 AM, Marcus Herou wrote:

> Hi.
>
> I have a situation where I'm searching amongst some 100K feeds and  
> only want
> one result per site in return. I have developed a really simple  
> method of
> grouping which just scrolls through the resultset(hitset) until a  
> maxNum
> docs of feeds from a set of unique sites is populated. Since I don't  
> wanna
> reinvent the wheel, I want to know if Lucene has something like this  
> built.
> I as well will use Solr soon and then my own homecooked recipe will  
> not work
> so I really need a standard way of doing this.
>
> I know Nutch has something like it called depupField which default  
> is set to
> 2.
>
> Anyone?
>
>
> Kindly
>
> //Marcus
>
> -- 
> Marcus Herou Solution Architect & Core Java developer Tailsweep AB
> +46702561312
> marcus.herou@tailsweep.com
> http://www.tailsweep.com

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30870-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 12:03:43 2007
Return-Path: <java-user-return-30870-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40342 invoked from network); 5 Nov 2007 12:03:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 12:03:43 -0000
Received: (qmail 40944 invoked by uid 500); 5 Nov 2007 12:03:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40912 invoked by uid 500); 5 Nov 2007 12:03:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40901 invoked by uid 99); 5 Nov 2007 12:03:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 04:03:24 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of Leire.Urcelay@unil.ch designates 130.223.8.20 as permitted sender)
Received: from [130.223.8.20] (HELO uldns1.unil.ch) (130.223.8.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:03:27 +0000
Received: from xxxx
	by uldns1.unil.ch with esmtpsa (TLSv1:RC4-MD5:128)
	(Exim 4.44)
	id 1Ip0fZ-0000YE-RO
	for java-user@lucene.apache.org; Mon, 05 Nov 2007 13:03:05 +0100
From: "Leire Urcelay" <Leire.Urcelay@unil.ch>
To: <java-user@lucene.apache.org>
Subject: blank space before special characters
Date: Mon, 5 Nov 2007 13:02:02 +0100
Message-ID: <004201c81fa3$ad75adc0$7408df82@ad.unil.ch>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_0043_01C81FAC.0F3A15C0"
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.6822
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
Thread-Index: Acgfo6z5kRE5AqRjRZqaDIkhS+8kwQ==
Importance: Normal
X-GW-Unil-From-IP:  max176d.unil.ch ([130.223.8.116] helo=nightstar)
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_0043_01C81FAC.0F3A15C0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Hello, 

 

I have the following problem with my lucene index.

 

When indexing fields containing special characters (like &), a blank space
is inserted before the special character. For example: the content
"L'article" is indexed as "L &apos;" (with a blank space between 'L' and
'&amp;'). 

 

Is there any way to avoid that?

 

The characteristics of my field are the following: Indexed, Tokenized,
Stored and Term Vector.

 

Thanks in advance for your help,

 

Leire


------=_NextPart_000_0043_01C81FAC.0F3A15C0--


From java-user-return-30871-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 12:06:19 2007
Return-Path: <java-user-return-30871-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40872 invoked from network); 5 Nov 2007 12:06:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 12:06:18 -0000
Received: (qmail 45648 invoked by uid 500); 5 Nov 2007 12:06:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45619 invoked by uid 500); 5 Nov 2007 12:06:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45608 invoked by uid 99); 5 Nov 2007 12:06:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 04:06:00 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.5] (HELO spunkymail-a3.g.dreamhost.com) (208.97.132.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:06:00 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a3.g.dreamhost.com (Postfix) with ESMTP id 4D6CC15D55F
	for <java-user@lucene.apache.org>; Mon,  5 Nov 2007 04:05:37 -0800 (PST)
Message-Id: <569980C1-9ABD-45A5-B200-FC87A4E0F580@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <21625f380711042254l550cdf97k5361d9e2db5cc917@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Pointers on Messaging Server and Lucene.
Date: Mon, 5 Nov 2007 07:05:37 -0500
References: <21625f380711042254l550cdf97k5361d9e2db5cc917@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Can you explain more of what you are trying to do?  Lucene just works  
with text, it is up to you to extract the text from whatever format it  
is in.  That being said, you can try searching the archives of this  
list as a starting point.  You might also check out Aperture (http://aperture.sourceforge.net 
) for connectors/extractors.  I am pretty sure they have email and  
calendar connectors, but I don't think they have IM.

-Grant

On Nov 5, 2007, at 1:54 AM, DURGA DEEP wrote:

> Hi Folks,
>
>         we have started on a project ( evaluating ) using Lucene with
> our Groupware services ( Messaging / Calendar and IM for now ). Are
> there any good pointers or links, we can reference before we start our
> evaluation. Any feed back would be of immense help...
>
> Thanks you!
> _d
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30872-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 12:11:25 2007
Return-Path: <java-user-return-30872-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41792 invoked from network); 5 Nov 2007 12:11:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 12:11:24 -0000
Received: (qmail 53357 invoked by uid 500); 5 Nov 2007 12:11:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52493 invoked by uid 500); 5 Nov 2007 12:11:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52482 invoked by uid 99); 5 Nov 2007 12:11:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 04:11:06 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of Leire.Urcelay@unil.ch designates 130.223.8.20 as permitted sender)
Received: from [130.223.8.20] (HELO uldns1.unil.ch) (130.223.8.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:11:37 +0000
Received: from xxxx
	by uldns1.unil.ch with esmtpsa (TLSv1:RC4-MD5:128)
	(Exim 4.44)
	id 1Ip0n3-0001aC-9w
	for java-user@lucene.apache.org; Mon, 05 Nov 2007 13:10:49 +0100
From: "Leire Urcelay" <Leire.Urcelay@unil.ch>
To: <java-user@lucene.apache.org>
Subject: RE : blank space before special characters
Date: Mon, 5 Nov 2007 13:09:46 +0100
Message-ID: <004901c81fa4$c1a43180$7408df82@ad.unil.ch>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook, Build 10.0.6822
In-Reply-To: <004201c81fa3$ad75adc0$7408df82@ad.unil.ch>
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3198
Thread-Index: Acgfo6z5kRE5AqRjRZqaDIkhS+8kwQAAME+Q
Importance: Normal
X-GW-Unil-From-IP:  max176d.unil.ch ([130.223.8.116] helo=nightstar)
X-Virus-Checked: Checked by ClamAV on apache.org

Sorry, I did a mistake in my previous email.
The field "L'article" is indexed as "L &apos;article". The blank space =
is
inserted between 'L' and '&apos;article'.

Thanks,

Leire

-----Message d'origine-----
De=A0: Leire Urcelay [mailto:Leire.Urcelay@unil.ch]=20
Envoy=E9=A0: lundi, 5. novembre 2007 13:02
=C0=A0: java-user@lucene.apache.org
Objet=A0: blank space before special characters

Hello,=20

I have the following problem with my lucene index.

When indexing fields containing special characters (like &), a blank =
space
is inserted before the special character. For example: the content
"L'article" is indexed as "L &apos;" (with a blank space between 'L' and
'&amp;').=20

Is there any way to avoid that?

The characteristics of my field are the following: Indexed, Tokenized,
Stored and Term Vector.

Thanks in advance for your help,

Leire



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30873-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 12:14:04 2007
Return-Path: <java-user-return-30873-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42439 invoked from network); 5 Nov 2007 12:14:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 12:14:03 -0000
Received: (qmail 56025 invoked by uid 500); 5 Nov 2007 12:13:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55989 invoked by uid 500); 5 Nov 2007 12:13:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55978 invoked by uid 99); 5 Nov 2007 12:13:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 04:13:45 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a8.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:14:12 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a8.g.dreamhost.com (Postfix) with ESMTP id 5275D10A227
	for <java-user@lucene.apache.org>; Mon,  5 Nov 2007 04:13:23 -0800 (PST)
Message-Id: <FF4539F6-E54F-420C-8BC9-B25FC0D80B56@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <41f0d6590711041048y1e8421edpab755af82436094f@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: How do we limit the growth of a Lucene Index?
Date: Mon, 5 Nov 2007 07:13:22 -0500
References: <41f0d6590711041048y1e8421edpab755af82436094f@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

You could search this list about distributing your indexes, etc.   
RemoteSearchable may be handy, but you will probably have to build  
some infrastructure around it for handling failover, etc. (would make  
for a nice contribution)

How often do you think archived data will need to be accessed?  And  
how much data are you talking?  Seems to me like the main issue will  
be in managing the searchers in light of having a lot of potential  
indexes.  Just thinking out loud, though.

-Grant

On Nov 4, 2007, at 1:48 PM, Sandeep Mahendru wrote:

> Hi ,
>
>   We have been developing an enterprise logging service at the  
> Wachovia
> bank. The logs (Busines, application, error) for all the bank related
> applications are consolidated
> at one single location in an Oracle 10g Database.
>
> In our second phase, we are now building a high perforinmg report  
> viewer
> over it. So our search algorithm does not go to the Oracle 10g DB. We
> therfore avoid network and I/O.
> Our serach algorith now goes to a LUCENE index. We have Lucene indexes
> created for each application. These indexes are present on the same  
> machine,
> where the search algorithm runs. As more applications at the bank  
> are now
> beginning to consume this service, the Lucene Index is now growing.
>
> One of my team leads has suggested the following approach to resolve  
> this
> issue:
>
> *I think the best approach is to restrict the Index size , is to  
> keep it for
> some limited time and then archive the same. In case user wants to  
> search
> against the old files then we might need to provide some  
> configuration using
> which the lucene searcher can point to the achieved file and search  
> the
> content. To implement this we need to rename the Index file with  
> from and to
> date before its archived. While searching against the older files,  
> user need
> to provide the date range and then the app can point to the relevant
> archived index files for search. Let me know your thoughts on this. *
> **
> At present this sounds the most logical to me. But then we begin to  
> store
> the Lucene indexes on a diffferent machine. This might again cause the
> search algorithm to make a network trip, if the serach is based on old
> archived data.
>
> Is there a better design to resolve the above concern. Does Lucene  
> provid
> some sort of API to handle the above scenario's?
>
> Regards,
> Sandeep.

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30874-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 12:24:25 2007
Return-Path: <java-user-return-30874-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50399 invoked from network); 5 Nov 2007 12:24:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 12:24:24 -0000
Received: (qmail 68954 invoked by uid 500); 5 Nov 2007 12:24:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68917 invoked by uid 500); 5 Nov 2007 12:24:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68906 invoked by uid 99); 5 Nov 2007 12:24:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 04:24:05 -0800
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.233.182.185] (HELO nf-out-0910.google.com) (64.233.182.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:24:06 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1095633nfc
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 04:23:43 -0800 (PST)
Received: by 10.82.107.15 with SMTP id f15mr9658287buc.1194265422640;
        Mon, 05 Nov 2007 04:23:42 -0800 (PST)
Received: by 10.82.127.4 with HTTP; Mon, 5 Nov 2007 04:23:42 -0800 (PST)
Message-ID: <7e536b1f0711050423v274db26code2dd5bd44f7c0ed@mail.gmail.com>
Date: Mon, 5 Nov 2007 13:23:42 +0100
From: "Marcus Herou" <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Subject: Re: How do we limit the growth of a Lucene Index?
In-Reply-To: <FF4539F6-E54F-420C-8BC9-B25FC0D80B56@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_21851_14394272.1194265422637"
References: <41f0d6590711041048y1e8421edpab755af82436094f@mail.gmail.com>
	 <FF4539F6-E54F-420C-8BC9-B25FC0D80B56@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_21851_14394272.1194265422637
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

As you suggest you could either roll the index on the local machine or
remote and gzip the content fileds on the archive index and provide a
GzipReader when you need to search old results.

If money is of the essence then the best solution probably is to have 1 good
box with fast SCSI disks which serves the primary index and an "archive"
slower machine with huge cheap IDE disks.
You then need to have a servlet or such on the archive server which
understands searching over http. Anyone said SOLR :)

//Marcus

On 11/5/07, Grant Ingersoll <gsingers@apache.org> wrote:
>
> You could search this list about distributing your indexes, etc.
> RemoteSearchable may be handy, but you will probably have to build
> some infrastructure around it for handling failover, etc. (would make
> for a nice contribution)
>
> How often do you think archived data will need to be accessed?  And
> how much data are you talking?  Seems to me like the main issue will
> be in managing the searchers in light of having a lot of potential
> indexes.  Just thinking out loud, though.
>
> -Grant
>
> On Nov 4, 2007, at 1:48 PM, Sandeep Mahendru wrote:
>
> > Hi ,
> >
> >   We have been developing an enterprise logging service at the
> > Wachovia
> > bank. The logs (Busines, application, error) for all the bank related
> > applications are consolidated
> > at one single location in an Oracle 10g Database.
> >
> > In our second phase, we are now building a high perforinmg report
> > viewer
> > over it. So our search algorithm does not go to the Oracle 10g DB. We
> > therfore avoid network and I/O.
> > Our serach algorith now goes to a LUCENE index. We have Lucene indexes
> > created for each application. These indexes are present on the same
> > machine,
> > where the search algorithm runs. As more applications at the bank
> > are now
> > beginning to consume this service, the Lucene Index is now growing.
> >
> > One of my team leads has suggested the following approach to resolve
> > this
> > issue:
> >
> > *I think the best approach is to restrict the Index size , is to
> > keep it for
> > some limited time and then archive the same. In case user wants to
> > search
> > against the old files then we might need to provide some
> > configuration using
> > which the lucene searcher can point to the achieved file and search
> > the
> > content. To implement this we need to rename the Index file with
> > from and to
> > date before its archived. While searching against the older files,
> > user need
> > to provide the date range and then the app can point to the relevant
> > archived index files for search. Let me know your thoughts on this. *
> > **
> > At present this sounds the most logical to me. But then we begin to
> > store
> > the Lucene indexes on a diffferent machine. This might again cause the
> > search algorithm to make a network trip, if the serach is based on old
> > archived data.
> >
> > Is there a better design to resolve the above concern. Does Lucene
> > provid
> > some sort of API to handle the above scenario's?
> >
> > Regards,
> > Sandeep.
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Boot Camp Training:
> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Marcus Herou Solution Architect & Core Java developer Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com

------=_Part_21851_14394272.1194265422637--

From java-user-return-30875-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 12:46:02 2007
Return-Path: <java-user-return-30875-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59078 invoked from network); 5 Nov 2007 12:46:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 12:46:02 -0000
Received: (qmail 92361 invoked by uid 500); 5 Nov 2007 12:45:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92334 invoked by uid 500); 5 Nov 2007 12:45:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92323 invoked by uid 99); 5 Nov 2007 12:45:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 04:45:43 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [89.213.91.233] (HELO mail.ardentiasearch.com) (89.213.91.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:45:47 +0000
Received: from biscuit.ARDENTIASEARCH.local ([10.0.0.9]) by
 biscuit.ARDENTIASEARCH.local ([10.0.0.9]) with mapi; Mon, 5 Nov 2007 12:42:24
 +0000
From: Mike Streeton <mike.streeton@ardentiasearch.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 5 Nov 2007 12:42:23 +0000
Subject: Reuse TermDocs
Thread-Topic: Reuse TermDocs
Thread-Index: AcgaRdXTZsfsuIkUTbq3nqBaC3p4dQFYQLYw
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B614124D8183@biscuit.ARDENTIASEARCH.local>
References: <DFE6314F5CE91344A74BD2AA612C93B614124D7F2E@biscuit.ARDENTIASEARCH.local>
 <47260509.5050506@gmail.com>
In-Reply-To: <47260509.5050506@gmail.com>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Can TermDocs be reused i.e. can you do.

TermDocs docs =3D reader.termDocs();
docs.seek(term1);
int i =3D 0;
while (docs.next()) {
        i++;
}
docs.seek(term2);
int j =3D 0;
while (docs.next()) {
        j++;
}

Reuse does seem to work but I get ArrayIndexOutOfBoundsExceptions from BitV=
ector it I reuse the same one over a period of time.

Many Thanks

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30876-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 12:49:51 2007
Return-Path: <java-user-return-30876-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59802 invoked from network); 5 Nov 2007 12:49:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 12:49:51 -0000
Received: (qmail 98532 invoked by uid 500); 5 Nov 2007 12:49:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98496 invoked by uid 500); 5 Nov 2007 12:49:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98485 invoked by uid 99); 5 Nov 2007 12:49:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 04:49:32 -0800
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [64.233.182.191] (HELO nf-out-0910.google.com) (64.233.182.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:49:33 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1100434nfc
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 04:49:10 -0800 (PST)
Received: by 10.82.156.12 with SMTP id d12mr9764451bue.1194266949688;
        Mon, 05 Nov 2007 04:49:09 -0800 (PST)
Received: by 10.82.127.4 with HTTP; Mon, 5 Nov 2007 04:49:09 -0800 (PST)
Message-ID: <7e536b1f0711050449u15b6af6j8456e9c5e89f4364@mail.gmail.com>
Date: Mon, 5 Nov 2007 13:49:09 +0100
From: "Marcus Herou" <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Subject: Re: Group by in Lucene ?
In-Reply-To: <F101D398-9CC5-4053-BFE1-72002F8822EE@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_21977_16994033.1194266949670"
References: <7e536b1f0711042157j4b2ee68fld8043344b022095d@mail.gmail.com>
	 <F101D398-9CC5-4053-BFE1-72002F8822EE@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_21977_16994033.1194266949670
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks. They seem to have got real far in the dev cycle on this. Seems like
it will hit the road in Solr 1.3.

However I would really like this feature to be developed for Core Lucene,
how do I start that process?
Develop it yourself you would say :) I'm serious isn't it a really cool and
useful feature ?

Kindly

//Marcus

On 11/5/07, Grant Ingersoll <gsingers@apache.org> wrote:
>
> Solr has an issue outstanding right now that implements something that
> may be close to what you want.  They are calling it Field Collapsing.
> See https://issues.apache.org/jira/browse/SOLR-236
>
> -Grant
>
> On Nov 5, 2007, at 12:57 AM, Marcus Herou wrote:
>
> > Hi.
> >
> > I have a situation where I'm searching amongst some 100K feeds and
> > only want
> > one result per site in return. I have developed a really simple
> > method of
> > grouping which just scrolls through the resultset(hitset) until a
> > maxNum
> > docs of feeds from a set of unique sites is populated. Since I don't
> > wanna
> > reinvent the wheel, I want to know if Lucene has something like this
> > built.
> > I as well will use Solr soon and then my own homecooked recipe will
> > not work
> > so I really need a standard way of doing this.
> >
> > I know Nutch has something like it called depupField which default
> > is set to
> > 2.
> >
> > Anyone?
> >
> >
> > Kindly
> >
> > //Marcus
> >
> > --
> > Marcus Herou Solution Architect & Core Java developer Tailsweep AB
> > +46702561312
> > marcus.herou@tailsweep.com
> > http://www.tailsweep.com
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Boot Camp Training:
> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Marcus Herou Solution Architect & Core Java developer Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com

------=_Part_21977_16994033.1194266949670--

From java-user-return-30877-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 13:37:47 2007
Return-Path: <java-user-return-30877-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75708 invoked from network); 5 Nov 2007 13:37:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 13:37:46 -0000
Received: (qmail 52899 invoked by uid 500); 5 Nov 2007 13:37:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52869 invoked by uid 500); 5 Nov 2007 13:37:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 50334 invoked by uid 99); 5 Nov 2007 13:34:05 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
From: Timo Nentwig <tnentwig@jamba.net>
To: java-user@lucene.apache.org
Subject: FuzzyQuery using termDocs() for context filtering
Date: Mon, 5 Nov 2007 14:33:17 +0100
User-Agent: KMail/1.9.7
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711051433.17244.tnentwig@jamba.net>
X-OriginalArrivalTime: 05 Nov 2007 13:34:31.0562 (UTC) FILETIME=[98A38EA0:01C81FB0]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi!

Imagine an index holding documents in different languages and country. 
Language+country is what I call a context and I build and hold a QueryFilter 
for each context.

When performing a fuzzy search, FilteredTermEnum doesn't care about any 
contexts at all (well, how should it :). It builds a BooleanQuery of all 
terms that come into question.

I came up with the idea to reimplementing FuzzyTermEnum to use 
reader.termDocs() instead of reader.terms(). This way for each term I know 
which document it comes from and by means of the above mentioned QueryFilter 
I can decide whether the term is valid for the given context or not.

This results (potentially) in a smaller BooleanQuery but I wonder whether this 
approach will gain any mentionable performance advantage (maybe reduce IO?).

Timo

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30878-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 13:46:06 2007
Return-Path: <java-user-return-30878-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77159 invoked from network); 5 Nov 2007 13:46:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 13:46:06 -0000
Received: (qmail 61796 invoked by uid 500); 5 Nov 2007 13:45:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61763 invoked by uid 500); 5 Nov 2007 13:45:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61752 invoked by uid 99); 5 Nov 2007 13:45:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 05:45:48 -0800
X-ASF-Spam-Status: No, hits=-2.0 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.151.4.82] (HELO salcexchfen2.telco.tspain.local) (62.151.4.82)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 13:45:52 +0000
Received: from TSPAINEXCH.telco.tspain.local ([10.224.28.53]) by salcexchfen2.telco.tspain.local with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 5 Nov 2007 14:48:34 +0100
Received: from elamas ([10.224.14.51]) by TSPAINEXCH.telco.tspain.local with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 5 Nov 2007 14:48:32 +0100
Message-ID: <017001c81fb2$8dc53310$330ee00a@telco.tspain.local>
From: "Enrique Lamas" <enrique.lamas@corp.ya.com>
To: <java-user@lucene.apache.org>
Subject: Can changes on an index be visible to an open IndexSearcher without reopening it?
Date: Mon, 5 Nov 2007 14:48:32 +0100
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_016D_01C81FBA.EF7B4330"
X-Priority: 3
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook Express 6.00.2900.3028
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2900.3028
X-OriginalArrivalTime: 05 Nov 2007 13:48:32.0176 (UTC) FILETIME=[8DAF1300:01C81FB2]
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_016D_01C81FBA.EF7B4330
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Hi,
I have an application using Lucene 2.2.0 that opens an IndexSearcher =
only once to optimize performance, because opening the index is a heavy =
operation. My question is, if I modify the index with an IndexWriter or =
IndexModifier, is there any way for the changes to be visible to the =
opened IndexSearcher without reopening it?

Thanks

------=_NextPart_000_016D_01C81FBA.EF7B4330--


From java-user-return-30879-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 14:01:21 2007
Return-Path: <java-user-return-30879-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81893 invoked from network); 5 Nov 2007 14:01:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 14:01:20 -0000
Received: (qmail 89893 invoked by uid 500); 5 Nov 2007 14:01:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89855 invoked by uid 500); 5 Nov 2007 14:01:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89844 invoked by uid 99); 5 Nov 2007 14:01:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 06:01:01 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 14:01:32 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 1D62344D67
	for <java-user@lucene.apache.org>; Mon,  5 Nov 2007 09:00:43 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Mon, 05 Nov 2007 09:00:43 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id F018E3C642; Mon,  5 Nov 2007 09:00:42 -0500 (EST)
Message-Id: <1194271242.24173.1219603671@webmail.messagingengine.com>
X-Sasl-Enc: Un12wEXmXPoadWF+rOKa1bZBD9yDUk3OWiHKO3XSzdKH 1194271242
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <017001c81fb2$8dc53310$330ee00a@telco.tspain.local>
Subject: Re: Can changes on an index be visible to an open IndexSearcher without
   reopening it?
In-Reply-To: <017001c81fb2$8dc53310$330ee00a@telco.tspain.local>
Date: Mon, 05 Nov 2007 09:00:42 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


Unfortunately, no.  Once open, the IndexReader/IndexSearcher searches
a frozen "point in time" snapshot of the index as it existed when it
was first opened.

You'll have to open a new searcher in order to see the changes.

However, there is work underway now to add a "reopen" method to
IndexReader that somewhat lowers the cost of opening a reader (not yet
clear by how much).  This should be part of the next release (2.3).
See here for details:

  https://issues.apache.org/jira/browse/LUCENE-743

Mike

"Enrique Lamas" <enrique.lamas@corp.ya.com> wrote:
> Hi,
> I have an application using Lucene 2.2.0 that opens an IndexSearcher only
> once to optimize performance, because opening the index is a heavy
> operation. My question is, if I modify the index with an IndexWriter or
> IndexModifier, is there any way for the changes to be visible to the
> opened IndexSearcher without reopening it?
> 
> Thanks

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30880-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 14:30:19 2007
Return-Path: <java-user-return-30880-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90444 invoked from network); 5 Nov 2007 14:30:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 14:30:19 -0000
Received: (qmail 36350 invoked by uid 500); 5 Nov 2007 14:30:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35446 invoked by uid 500); 5 Nov 2007 14:30:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35434 invoked by uid 99); 5 Nov 2007 14:30:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 06:30:00 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 66.249.92.171 as permitted sender)
Received: from [66.249.92.171] (HELO ug-out-1314.google.com) (66.249.92.171)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 14:30:00 +0000
Received: by ug-out-1314.google.com with SMTP id h3so961362ugf
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 06:29:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=wwWU0hcrM2ZPdk9XO0txSJMjqSSCxpqR48WcZug3V5o=;
        b=IGc4qRrxZnXIYqiNaPYdvm9B8SjQDyx1plAzgCTtxo1JXXkYEm69RqY6BmDk8Uk/MmG4l3D8JcCNSXG4npDxIaHqUMt1wiR1gQo1MjzMsbnSywXlSENd7HNVgk4f4dy4NwabEMhmAyv19zMmAcj6aFiqlLw4CEKTQxSJJS01014=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=hS2/Ho08jJ11ylq/riUlem6ul+fwdoi94cF3rrWUXFEsPLF7FW2tyaC1FlooP3H8H7k7egNw30z4rUiYLwZsB8uFvxZWpF3aWSwPmFQuLZth3UnPvNFR5VrRIzueaTW8hzRNbKruxpe6I4GEhij+9XBZHMmrF3xYh51AbXOykEo=
Received: by 10.143.157.10 with SMTP id j10mr959520wfo.1194272976290;
        Mon, 05 Nov 2007 06:29:36 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Mon, 5 Nov 2007 06:29:36 -0800 (PST)
Message-ID: <c68e39170711050629y19459d92v65665633a6b8085c@mail.gmail.com>
Date: Mon, 5 Nov 2007 09:29:36 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: Reuse TermDocs
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B614124D8183@biscuit.ARDENTIASEARCH.local>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <DFE6314F5CE91344A74BD2AA612C93B614124D7F2E@biscuit.ARDENTIASEARCH.local>
	 <47260509.5050506@gmail.com>
	 <DFE6314F5CE91344A74BD2AA612C93B614124D8183@biscuit.ARDENTIASEARCH.local>
X-Google-Sender-Auth: a88bea60543e8dba
X-Virus-Checked: Checked by ClamAV on apache.org

On 11/5/07, Mike Streeton <mike.streeton@ardentiasearch.com> wrote:
> Can TermDocs be reused i.e. can you do.
>
> TermDocs docs = reader.termDocs();
> docs.seek(term1);
> int i = 0;
> while (docs.next()) {
>         i++;
> }
> docs.seek(term2);
> int j = 0;
> while (docs.next()) {
>         j++;
> }
>
> Reuse does seem to work but I get ArrayIndexOutOfBoundsExceptions from BitVector it I reuse the same one over a period of time.

That shouldn't happen... your reuse looks fine.
TermDocs instances are not thread safe - I assume you are only reusing
it from a single thread?
Is it possible for you to create a test case that reproduces this?

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30881-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 18:35:50 2007
Return-Path: <java-user-return-30881-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18978 invoked from network); 5 Nov 2007 18:35:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 18:35:50 -0000
Received: (qmail 3461 invoked by uid 500); 5 Nov 2007 18:35:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3434 invoked by uid 500); 5 Nov 2007 18:35:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3420 invoked by uid 99); 5 Nov 2007 18:35:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 10:35:26 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 64.233.182.190 as permitted sender)
Received: from [64.233.182.190] (HELO nf-out-0910.google.com) (64.233.182.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 18:35:29 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1191748nfc
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 10:35:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=tF0Ff7UYpkKLiH3iFaQYPBI+UGiHw+DGKwMQp2MmZrU=;
        b=W871jh6APbtPTE9PPNXgrvAAWt8FUABjh4saod05+Rc+p6eDUsLftk7uOWuBzqvysM0xFFEKMBkdOg0p4PRJFWNZF0njvyYdeHdXm4tvjFvZSEf+KYSCUeA5ZwI5+dmnXsvNx6PHibWO6aLMZuIn2Yknp8Ga2QEhw9yjSQtj5rE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=E2whwqb8NSIsIL2GfhMoXErNG5aAtPcBLKguS/btf6sWKd3kW7Kv2jnVp6Cgd6IM9uWulqWj08p1KbdBnhcu/lqmodOJ1f6CC1u3Y6WQuAwP670l9f0G96ijVnBq085AtxNWexG+Iz+OixDMpoMQr/aCAx2j7J4LdaWTLShw0+I=
Received: by 10.82.171.16 with SMTP id t16mr10431158bue.1194287704984;
        Mon, 05 Nov 2007 10:35:04 -0800 (PST)
Received: by 10.82.190.14 with HTTP; Mon, 5 Nov 2007 10:34:59 -0800 (PST)
Message-ID: <359a92830711051034u19392198udf2809ddf7350dff@mail.gmail.com>
Date: Mon, 5 Nov 2007 13:34:59 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: RE : blank space before special characters
In-Reply-To: <004901c81fa4$c1a43180$7408df82@ad.unil.ch>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_26121_12203551.1194287699934"
References: <004201c81fa3$ad75adc0$7408df82@ad.unil.ch>
	 <004901c81fa4$c1a43180$7408df82@ad.unil.ch>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_26121_12203551.1194287699934
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

There are several issues here....
1> How are you getting the entity reference? You must be encoding
the stream (or getting it encoded for you). So the first thing I'd do
is un-encode it.
2> After that, it's a question of what Filters/Analyzers you're using.
Take a look at ISOLatin1AccentFilter. I'm unclear whether it "closes up" th=
e
case you're looking at, so be sure to check.
3> Since my peculiar situation can't use the Filter (the character
set I'm using isn't standard), I've pre-processed the input (both at
index and query time) to substitute the empty string for the
apostrophe

Hope this helps
Erick

On 11/5/07, Leire Urcelay <Leire.Urcelay@unil.ch> wrote:
>
> Sorry, I did a mistake in my previous email.
> The field "L'article" is indexed as "L &apos;article". The blank space is
> inserted between 'L' and '&apos;article'.
>
> Thanks,
>
> Leire
>
> -----Message d'origine-----
> De: Leire Urcelay [mailto:Leire.Urcelay@unil.ch]
> Envoy=E9: lundi, 5. novembre 2007 13:02
> =C0: java-user@lucene.apache.org
> Objet: blank space before special characters
>
> Hello,
>
> I have the following problem with my lucene index.
>
> When indexing fields containing special characters (like &), a blank spac=
e
> is inserted before the special character. For example: the content
> "L'article" is indexed as "L &apos;" (with a blank space between 'L' and
> '&amp;').
>
> Is there any way to avoid that?
>
> The characteristics of my field are the following: Indexed, Tokenized,
> Stored and Term Vector.
>
> Thanks in advance for your help,
>
> Leire
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_26121_12203551.1194287699934--

From java-user-return-30882-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 20:25:35 2007
Return-Path: <java-user-return-30882-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57557 invoked from network); 5 Nov 2007 20:25:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 20:25:35 -0000
Received: (qmail 51696 invoked by uid 500); 5 Nov 2007 20:25:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51659 invoked by uid 500); 5 Nov 2007 20:25:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51648 invoked by uid 99); 5 Nov 2007 20:25:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 12:25:16 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.196.101.38] (HELO web59212.mail.re1.yahoo.com) (66.196.101.38)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 05 Nov 2007 20:25:45 +0000
Received: (qmail 66013 invoked by uid 60001); 5 Nov 2007 20:24:54 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=bEIds6sNL0EkekdKd7By9pRo+KfmZW2CIO4gDaiELenP+HWiUPzGa6BONPyYid7SldSjMNn3KhKwid62iZUVsusO5z3mk+5qmBKmvRwHvhsaBSWPM73ZD2VM7knqatfAZ9dAtOlPD0mi4AqMn/Kkk4UFqTaQ11+QKUR3q3XQPek=;
X-YMail-OSG: Yi_ksxsVM1nuXRlD51vXuCHy0ybM1j7GDtQtFpL2dAJnkuQvrUFkTKOaSaq50iqrOWyBRWDjrXKg7ET3aWkT6t8UV8tZAbBEPTOL3Od8AOyXyQLD71aPyRjcBylWNOU_
Received: from [68.167.115.34] by web59212.mail.re1.yahoo.com via HTTP; Mon, 05 Nov 2007 12:24:54 PST
Date: Mon, 5 Nov 2007 12:24:54 -0800 (PST)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Related items
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-954704033-1194294294=:65860"
Content-Transfer-Encoding: 8bit
Message-ID: <761034.65860.qm@web59212.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-954704033-1194294294=:65860
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Hello Group,
                   I have a requirement in my project where I need to display related items for any select item in the group. I am not sure whether this can be possible. Let me tell you that all our documents are indexed and for any document selected by user, we need to display related documents(items) in some sort of group format.
  My initial thought was to use MultiPhraseQuery, something like
   
  If Currently selected Item's title is "foo bar and chacolate", then search index with following query
   
  MultiPhraseQuery multiTermQuery = new MultiPhraseQuery();
  
  multiTermQuery.add(new Term("title","foo"));
  multiTermQuery.add(new Term("title","bar"));
  multiTermQuery.add(new Term("title","chacolate"));
   
  From the hits, show most relevant document. Maybe show all documents
   
  But search result is not returning anything though there are items with title "foo bar a chacolate", "foo bar and chacolate" etc...
   
  I would appreciate your valuable suggestion.
   
  - BR

 __________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
--0-954704033-1194294294=:65860--

From java-user-return-30883-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 05 21:03:50 2007
Return-Path: <java-user-return-30883-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66585 invoked from network); 5 Nov 2007 21:03:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 5 Nov 2007 21:03:49 -0000
Received: (qmail 354 invoked by uid 500); 5 Nov 2007 21:03:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 323 invoked by uid 500); 5 Nov 2007 21:03:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 312 invoked by uid 99); 5 Nov 2007 21:03:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 13:03:31 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.5] (HELO spunkymail-a4.g.dreamhost.com) (208.97.132.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 21:03:59 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a4.g.dreamhost.com (Postfix) with ESMTP id 78F2F3B9F4
	for <java-user@lucene.apache.org>; Mon,  5 Nov 2007 13:03:11 -0800 (PST)
Message-Id: <C7DED9F8-A524-4735-A1F5-1089DC869CEC@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <7e536b1f0711050449u15b6af6j8456e9c5e89f4364@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Group by in Lucene ?
Date: Mon, 5 Nov 2007 16:03:08 -0500
References: <7e536b1f0711042157j4b2ee68fld8043344b022095d@mail.gmail.com> <F101D398-9CC5-4053-BFE1-72002F8822EE@apache.org> <7e536b1f0711050449u15b6af6j8456e9c5e89f4364@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org


On Nov 5, 2007, at 7:49 AM, Marcus Herou wrote:

> Thanks. They seem to have got real far in the dev cycle on this.  
> Seems like
> it will hit the road in Solr 1.3.
>
> However I would really like this feature to be developed for Core  
> Lucene,
> how do I start that process?
> Develop it yourself you would say :) I'm serious isn't it a really  
> cool and
> useful feature ?


We're always open to well-thought out and tested patches.  See the  
Wiki for info on contributing.

-Grant


--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30884-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 02:36:14 2007
Return-Path: <java-user-return-30884-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96143 invoked from network); 6 Nov 2007 02:36:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 02:36:14 -0000
Received: (qmail 2754 invoked by uid 500); 6 Nov 2007 02:35:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2717 invoked by uid 500); 6 Nov 2007 02:35:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2706 invoked by uid 99); 6 Nov 2007 02:35:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 18:35:54 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mahendru.sandeep@gmail.com designates 64.233.182.191 as permitted sender)
Received: from [64.233.182.191] (HELO nf-out-0910.google.com) (64.233.182.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 02:35:55 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1289731nfc
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 18:35:33 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        bh=63xaD8TyAh6pRT1WaEQI447Z7sxDiJMN6U4swZU+oYo=;
        b=imfDII6Jx+CzRyv4gim305U0lGZsnw+ovii5ApKfe2HbIKrNVXtDp3r3VWHu0hTpj2jmYtzJ8ps7oxYKEoS13wizBbnxfi+k+Sv9kiJzEmL3SJXzoDq5zJ7GHWJjB8DBXDv7g2jiwVeGGJxRZwgpxX1qwZbDhhIbjlI8RmPN6Ng=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        b=MLuwvEP5+8Gqq0+eM0kTbT5IuQWdN20QQgj+TvGtAwJjL5Y6H5hSYiYP6/cc1NrnWLLI+6o1d9/Wvi1e15Ex9Be6KLk0jzYCBuy+pRlChSyt2b44SSdoWi2bmHLRztR8j6sVFE4fyaPGUddJitrXUieav6fztYjAQ9rwB4i5B8A=
Received: by 10.78.204.1 with SMTP id b1mr4342145hug.1194316533095;
        Mon, 05 Nov 2007 18:35:33 -0800 (PST)
Received: by 10.78.67.3 with HTTP; Mon, 5 Nov 2007 18:35:33 -0800 (PST)
Message-ID: <41f0d6590711051835h694847e9yaa4a2960ea9aeb13@mail.gmail.com>
Date: Mon, 5 Nov 2007 21:35:33 -0500
From: "Sandeep Mahendru" <mahendru.sandeep@gmail.com>
To: marcus.herou@tailsweep.com
Subject: Re: How do we limit the growth of a Lucene Index?
Cc: java-user@lucene.apache.org
In-Reply-To: <7e536b1f0711050423v274db26code2dd5bd44f7c0ed@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_24774_24638475.1194316533093"
References: <41f0d6590711041048y1e8421edpab755af82436094f@mail.gmail.com>
	 <FF4539F6-E54F-420C-8BC9-B25FC0D80B56@apache.org>
	 <7e536b1f0711050423v274db26code2dd5bd44f7c0ed@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_24774_24638475.1194316533093
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi Marcus,

  Thanks for providing these suggestions. I will work on these directions
with my team.

Regards,
Sandeep.


On 11/5/07, Marcus Herou <marcus.herou@tailsweep.com> wrote:
>
> As you suggest you could either roll the index on the local machine or
> remote and gzip the content fileds on the archive index and provide a
> GzipReader when you need to search old results.
>
> If money is of the essence then the best solution probably is to have 1
> good
> box with fast SCSI disks which serves the primary index and an "archive"
> slower machine with huge cheap IDE disks.
> You then need to have a servlet or such on the archive server which
> understands searching over http. Anyone said SOLR :)
>
> //Marcus
>
> On 11/5/07, Grant Ingersoll <gsingers@apache.org> wrote:
> >
> > You could search this list about distributing your indexes, etc.
> > RemoteSearchable may be handy, but you will probably have to build
> > some infrastructure around it for handling failover, etc. (would make
> > for a nice contribution)
> >
> > How often do you think archived data will need to be accessed?  And
> > how much data are you talking?  Seems to me like the main issue will
> > be in managing the searchers in light of having a lot of potential
> > indexes.  Just thinking out loud, though.
> >
> > -Grant
> >
> > On Nov 4, 2007, at 1:48 PM, Sandeep Mahendru wrote:
> >
> > > Hi ,
> > >
> > >   We have been developing an enterprise logging service at the
> > > Wachovia
> > > bank. The logs (Busines, application, error) for all the bank related
> > > applications are consolidated
> > > at one single location in an Oracle 10g Database.
> > >
> > > In our second phase, we are now building a high perforinmg report
> > > viewer
> > > over it. So our search algorithm does not go to the Oracle 10g DB. We
> > > therfore avoid network and I/O.
> > > Our serach algorith now goes to a LUCENE index. We have Lucene indexes
> > > created for each application. These indexes are present on the same
> > > machine,
> > > where the search algorithm runs. As more applications at the bank
> > > are now
> > > beginning to consume this service, the Lucene Index is now growing.
> > >
> > > One of my team leads has suggested the following approach to resolve
> > > this
> > > issue:
> > >
> > > *I think the best approach is to restrict the Index size , is to
> > > keep it for
> > > some limited time and then archive the same. In case user wants to
> > > search
> > > against the old files then we might need to provide some
> > > configuration using
> > > which the lucene searcher can point to the achieved file and search
> > > the
> > > content. To implement this we need to rename the Index file with
> > > from and to
> > > date before its archived. While searching against the older files,
> > > user need
> > > to provide the date range and then the app can point to the relevant
> > > archived index files for search. Let me know your thoughts on this. *
> > > **
> > > At present this sounds the most logical to me. But then we begin to
> > > store
> > > the Lucene indexes on a diffferent machine. This might again cause the
> > > search algorithm to make a network trip, if the serach is based on old
> > > archived data.
> > >
> > > Is there a better design to resolve the above concern. Does Lucene
> > > provid
> > > some sort of API to handle the above scenario's?
> > >
> > > Regards,
> > > Sandeep.
> >
> > --------------------------
> > Grant Ingersoll
> > http://lucene.grantingersoll.com
> >
> > Lucene Boot Camp Training:
> > ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!
> http://www.apachecon.com
> >
> > Lucene Helpful Hints:
> > http://wiki.apache.org/lucene-java/BasicsOfPerformance
> > http://wiki.apache.org/lucene-java/LuceneFAQ
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> --
> Marcus Herou Solution Architect & Core Java developer Tailsweep AB
> +46702561312
> marcus.herou@tailsweep.com
> http://www.tailsweep.com
>

------=_Part_24774_24638475.1194316533093--

From java-user-return-30885-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 02:36:51 2007
Return-Path: <java-user-return-30885-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96446 invoked from network); 6 Nov 2007 02:36:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 02:36:51 -0000
Received: (qmail 4892 invoked by uid 500); 6 Nov 2007 02:36:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4863 invoked by uid 500); 6 Nov 2007 02:36:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4852 invoked by uid 99); 6 Nov 2007 02:36:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 18:36:32 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mahendru.sandeep@gmail.com designates 64.233.182.191 as permitted sender)
Received: from [64.233.182.191] (HELO nf-out-0910.google.com) (64.233.182.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 02:36:32 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1289731nfc
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 18:36:12 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        bh=3CX5ElyYij42t2feUUshkZ+wPozh1AHSN2xrCc8AH+I=;
        b=tfkcWCrCIh3A8kneFa4968SuOTYu9vZnS04yIvz84m/X+dkc0dofak56S0KkEjaZe4GUrbtphTf7Wj9qOqiOvGPNmlUOVrpB1T7LDJz42nkm14LQ2EE92Rc9WoLHkF3MnTXeMhq2OwgljjMd/v2dtpXX6u2krH8qEClgVsnPwpo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        b=s7t0kJuvRDDRUOiyOmJ4EE/CIOpqllBRCeIZLUTdK2MsoWTPXyHMqShPwuFwpSYDkhqyDV2pg4y/83G44APh6tCMfip+6gpLxXRUJDdvtlm58jaopMDdOHZHdoZKznGT91LUwt3X3MD8Lm2pGaqZwlmdGpPvidssOrzkizV/i4E=
Received: by 10.78.97.7 with SMTP id u7mr4353055hub.1194316571664;
        Mon, 05 Nov 2007 18:36:11 -0800 (PST)
Received: by 10.78.67.3 with HTTP; Mon, 5 Nov 2007 18:36:11 -0800 (PST)
Message-ID: <41f0d6590711051836v7653b756g9e7a49a9f7dc49cc@mail.gmail.com>
Date: Mon, 5 Nov 2007 21:36:11 -0500
From: "Sandeep Mahendru" <mahendru.sandeep@gmail.com>
To: gsingers@apache.org
Subject: Re: How do we limit the growth of a Lucene Index?
Cc: java-user@lucene.apache.org
In-Reply-To: <FF4539F6-E54F-420C-8BC9-B25FC0D80B56@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_24776_13292059.1194316571661"
References: <41f0d6590711041048y1e8421edpab755af82436094f@mail.gmail.com>
	 <FF4539F6-E54F-420C-8BC9-B25FC0D80B56@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_24776_13292059.1194316571661
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi Grant,

  Thanks for providing these suggestions. I will work on these directions
with my team.

Regards,
Sandeep.


On 11/5/07, Grant Ingersoll <gsingers@apache.org> wrote:
>
> You could search this list about distributing your indexes, etc.
> RemoteSearchable may be handy, but you will probably have to build
> some infrastructure around it for handling failover, etc. (would make
> for a nice contribution)
>
> How often do you think archived data will need to be accessed?  And
> how much data are you talking?  Seems to me like the main issue will
> be in managing the searchers in light of having a lot of potential
> indexes.  Just thinking out loud, though.
>
> -Grant
>
> On Nov 4, 2007, at 1:48 PM, Sandeep Mahendru wrote:
>
> > Hi ,
> >
> >   We have been developing an enterprise logging service at the
> > Wachovia
> > bank. The logs (Busines, application, error) for all the bank related
> > applications are consolidated
> > at one single location in an Oracle 10g Database.
> >
> > In our second phase, we are now building a high perforinmg report
> > viewer
> > over it. So our search algorithm does not go to the Oracle 10g DB. We
> > therfore avoid network and I/O.
> > Our serach algorith now goes to a LUCENE index. We have Lucene indexes
> > created for each application. These indexes are present on the same
> > machine,
> > where the search algorithm runs. As more applications at the bank
> > are now
> > beginning to consume this service, the Lucene Index is now growing.
> >
> > One of my team leads has suggested the following approach to resolve
> > this
> > issue:
> >
> > *I think the best approach is to restrict the Index size , is to
> > keep it for
> > some limited time and then archive the same. In case user wants to
> > search
> > against the old files then we might need to provide some
> > configuration using
> > which the lucene searcher can point to the achieved file and search
> > the
> > content. To implement this we need to rename the Index file with
> > from and to
> > date before its archived. While searching against the older files,
> > user need
> > to provide the date range and then the app can point to the relevant
> > archived index files for search. Let me know your thoughts on this. *
> > **
> > At present this sounds the most logical to me. But then we begin to
> > store
> > the Lucene indexes on a diffferent machine. This might again cause the
> > search algorithm to make a network trip, if the serach is based on old
> > archived data.
> >
> > Is there a better design to resolve the above concern. Does Lucene
> > provid
> > some sort of API to handle the above scenario's?
> >
> > Regards,
> > Sandeep.
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Boot Camp Training:
> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_24776_13292059.1194316571661--

From java-user-return-30886-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 04:19:14 2007
Return-Path: <java-user-return-30886-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34990 invoked from network); 6 Nov 2007 04:19:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 04:19:14 -0000
Received: (qmail 66469 invoked by uid 500); 6 Nov 2007 04:18:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66427 invoked by uid 500); 6 Nov 2007 04:18:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66416 invoked by uid 99); 6 Nov 2007 04:18:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 20:18:55 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of durgadeep@gmail.com designates 209.85.198.187 as permitted sender)
Received: from [209.85.198.187] (HELO rv-out-0910.google.com) (209.85.198.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 04:18:55 +0000
Received: by rv-out-0910.google.com with SMTP id k20so1408269rvb
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 20:18:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=fdAfJOldkg+pOpmqKpbD6RUXUx+2cC0DE/RoLH8IyLs=;
        b=fzPgsR3vqp0/Bue5s+MEz4obMyHlO+s1S24m0XwXKJ2zwh0+wI6EeuABXXcF6o8SIUhOLVR0H+wBl/LJPhDqywT3TvTquBp6qzJ3Y5u1XqQtEQkyPBFfThXyxMDpVWra6imxzFeG7iXcbxpt6MhAMxNbm0Bt4t18n4d0sfWvN6k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=CL3kuDdTY/WPIsGC7TmvWpY/o7lqeUGbQVnoGcI+Kpo5WditrB4HLZipWCBkfhRbexiCxm9nVvRygWpXZgj1YomQrYQDcXZ0btgAHa+fsnkyTALhHMunLji7+R6LYXgahATTorQsx2NelYCfiZINXz/bal3cro8DNLEi81ofBic=
Received: by 10.141.5.3 with SMTP id h3mr2794637rvi.1194322713904;
        Mon, 05 Nov 2007 20:18:33 -0800 (PST)
Received: by 10.140.128.14 with HTTP; Mon, 5 Nov 2007 20:18:33 -0800 (PST)
Message-ID: <21625f380711052018r72b3ac82ua4c86b53c2c43ea0@mail.gmail.com>
Date: Mon, 5 Nov 2007 20:18:33 -0800
From: "DURGA DEEP" <durgadeep@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Pointers on Messaging Server and Lucene.
In-Reply-To: <569980C1-9ABD-45A5-B200-FC87A4E0F580@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1734_20015092.1194322713896"
References: <21625f380711042254l550cdf97k5361d9e2db5cc917@mail.gmail.com>
	 <569980C1-9ABD-45A5-B200-FC87A4E0F580@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1734_20015092.1194322713896
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

We have an e-mail server / Calendar Server / Address book etc. And we are
planning on to use Lucene for searching through the respective stores. I am
aware that I have convert every thing in to a format acceptable to Lucene.
But I would like to see if any one out there, has done this previously pros
/ cons (or) suggestions. The pointer provided is useful.

_Durga
On 11/5/07, Grant Ingersoll <gsingers@apache.org> wrote:
>
> Can you explain more of what you are trying to do?  Lucene just works
> with text, it is up to you to extract the text from whatever format it
> is in.  That being said, you can try searching the archives of this
> list as a starting point.  You might also check out Aperture (
> http://aperture.sourceforge.net
> ) for connectors/extractors.  I am pretty sure they have email and
> calendar connectors, but I don't think they have IM.



>
>
> -Grant
>
> On Nov 5, 2007, at 1:54 AM, DURGA DEEP wrote:
>
> > Hi Folks,
> >
> >         we have started on a project ( evaluating ) using Lucene with
> > our Groupware services ( Messaging / Calendar and IM for now ). Are
> > there any good pointers or links, we can reference before we start our
> > evaluation. Any feed back would be of immense help...
> >
> > Thanks you!
> > _d
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Boot Camp Training:
> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!   http://www.apachecon.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_1734_20015092.1194322713896--

From java-user-return-30887-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 06:05:33 2007
Return-Path: <java-user-return-30887-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53302 invoked from network); 6 Nov 2007 06:05:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 06:05:33 -0000
Received: (qmail 44261 invoked by uid 500); 6 Nov 2007 06:05:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44241 invoked by uid 500); 6 Nov 2007 06:05:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44230 invoked by uid 99); 6 Nov 2007 06:05:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 22:05:15 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 06:05:47 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IpHYW-0001nP-Ow
	for java-user@lucene.apache.org; Mon, 05 Nov 2007 22:04:56 -0800
Message-ID: <13601296.post@talk.nabble.com>
Date: Mon, 5 Nov 2007 22:04:56 -0800 (PST)
From: Sure <suresh.lucene@gmail.com>
To: java-user@lucene.apache.org
Subject: Needs TermFreqeuency from the index
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: suresh.lucene@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi All,
We are trying to fetch the TermFreq from the lucene index, using
IndexReader.getTermFreqVectors().

But the problem here is, if none of the fields in the index is Vectorized,
then the above function call returns null. In my index, none of the fields
are vectorized. Without re-creating the index, is it possible to get the
TermFreqVector ?

Thanks in advance.

Regards,
Suresh N.
-- 
View this message in context: http://www.nabble.com/Needs-TermFreqeuency-from-the-index-tf4756240.html#a13601296
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30888-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 06:06:48 2007
Return-Path: <java-user-return-30888-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53433 invoked from network); 6 Nov 2007 06:06:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 06:06:48 -0000
Received: (qmail 45869 invoked by uid 500); 6 Nov 2007 06:06:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45836 invoked by uid 500); 6 Nov 2007 06:06:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45825 invoked by uid 99); 6 Nov 2007 06:06:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Nov 2007 22:06:29 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mudgal.shailendra@gmail.com designates 64.233.162.239 as permitted sender)
Received: from [64.233.162.239] (HELO nz-out-0506.google.com) (64.233.162.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 06:06:33 +0000
Received: by nz-out-0506.google.com with SMTP id i28so1174802nzi
        for <java-user@lucene.apache.org>; Mon, 05 Nov 2007 22:06:12 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=UPmkXL6wasB+dXKdrHDk2oqIjnhtf5puovviJS/jCus=;
        b=KtJTz7fkET6nfrMjMQY9kVwjbhZMJal9lCsOxe91U9p7UW1KgMsE3OC/ts5Axmnk1lon6k2AboRtg1ln9T1Z0ZAIIK3R7Za8YhUqzKRmVltenszPi52uNq0qROAC//v/LrdAquEdFu3OwpxZ+UND+aaPUVChNb2kBvCun9Apq3s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=gDvd2n+vb9fkqc+S6/JQjJtiz34YvJnTJPmU+4bo33EqiEgcuupAovXOwEpfCrLE2gn4Z6GqSBjPOJTFo4qLQ2rHr8xTvXB1ECDvqBp+vHpwzkeP80dvrsHLY++cp3f1ZW3m8FJFarmvZVJt3F/wOB6JjjeziabJAE2fMt86khw=
Received: by 10.114.77.1 with SMTP id z1mr6042121waa.1194329171483;
        Mon, 05 Nov 2007 22:06:11 -0800 (PST)
Received: by 10.141.3.15 with HTTP; Mon, 5 Nov 2007 22:06:11 -0800 (PST)
Message-ID: <fa7518640711052206u5ae118boac71d854cbd355e2@mail.gmail.com>
Date: Tue, 6 Nov 2007 11:36:11 +0530
From: "Shailendra Mudgal" <mudgal.shailendra@gmail.com>
To: java-user@lucene.apache.org
Subject: How to generate TermFreqVector from an existing index
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_16061_8543353.1194329171461"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_16061_8543353.1194329171461
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi All,

I have an index without does not have the termFreqVector stored in it. I do
not want to recreate the index as it is a big index and took a lot of time
while creation. Is their a other way for generating the termFreqVector with
the available info for all the documents.

Any help will be appreciated,

Regards,
Shaile

------=_Part_16061_8543353.1194329171461--

From java-user-return-30889-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 08:20:31 2007
Return-Path: <java-user-return-30889-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11045 invoked from network); 6 Nov 2007 08:20:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 08:20:29 -0000
Received: (qmail 49059 invoked by uid 500); 6 Nov 2007 08:20:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49020 invoked by uid 500); 6 Nov 2007 08:20:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49009 invoked by uid 99); 6 Nov 2007 08:20:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 00:20:09 -0800
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=FUZZY_CPILL,HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [72.14.214.227] (HELO hu-out-0506.google.com) (72.14.214.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 08:20:10 +0000
Received: by hu-out-0506.google.com with SMTP id 27so954328hub
        for <java-user@lucene.apache.org>; Tue, 06 Nov 2007 00:19:47 -0800 (PST)
Received: by 10.82.177.3 with SMTP id z3mr11927397bue.1194337187389;
        Tue, 06 Nov 2007 00:19:47 -0800 (PST)
Received: by 10.82.127.4 with HTTP; Tue, 6 Nov 2007 00:19:47 -0800 (PST)
Message-ID: <7e536b1f0711060019r32914558ke1e2ee7885e9f1f@mail.gmail.com>
Date: Tue, 6 Nov 2007 09:19:47 +0100
From: "Marcus Herou" <marcus.herou@tailsweep.com>
To: java-user@lucene.apache.org
Subject: Re: Group by in Lucene ?
In-Reply-To: <C7DED9F8-A524-4735-A1F5-1089DC869CEC@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_36988_19364632.1194337187382"
References: <7e536b1f0711042157j4b2ee68fld8043344b022095d@mail.gmail.com>
	 <F101D398-9CC5-4053-BFE1-72002F8822EE@apache.org>
	 <7e536b1f0711050449u15b6af6j8456e9c5e89f4364@mail.gmail.com>
	 <C7DED9F8-A524-4735-A1F5-1089DC869CEC@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_36988_19364632.1194337187382
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Cool.

I'll do since this is a field which I can spend time in.

Kindly

//Marcus
On 11/5/07, Grant Ingersoll <gsingers@apache.org> wrote:
>
>
> On Nov 5, 2007, at 7:49 AM, Marcus Herou wrote:
>
> > Thanks. They seem to have got real far in the dev cycle on this.
> > Seems like
> > it will hit the road in Solr 1.3.
> >
> > However I would really like this feature to be developed for Core
> > Lucene,
> > how do I start that process?
> > Develop it yourself you would say :) I'm serious isn't it a really
> > cool and
> > useful feature ?
>
>
> We're always open to well-thought out and tested patches.  See the
> Wiki for info on contributing.
>
> -Grant
>
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Boot Camp Training:
> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Marcus Herou Solution Architect & Core Java developer Tailsweep AB
+46702561312
marcus.herou@tailsweep.com
http://www.tailsweep.com

------=_Part_36988_19364632.1194337187382--

From java-user-return-30890-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 08:51:41 2007
Return-Path: <java-user-return-30890-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17440 invoked from network); 6 Nov 2007 08:51:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 08:51:41 -0000
Received: (qmail 84373 invoked by uid 500); 6 Nov 2007 08:51:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84021 invoked by uid 500); 6 Nov 2007 08:51:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84008 invoked by uid 99); 6 Nov 2007 08:51:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 00:51:22 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mudgal.shailendra@gmail.com designates 209.85.146.183 as permitted sender)
Received: from [209.85.146.183] (HELO wa-out-1112.google.com) (209.85.146.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 08:51:22 +0000
Received: by wa-out-1112.google.com with SMTP id j40so2564039wah
        for <java-user@lucene.apache.org>; Tue, 06 Nov 2007 00:51:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=eRQpiuzPdN0IbZ/rZX1pLZkZmpnMHjfEM7ZoQXa6+Ik=;
        b=ajkAL1CEdWyEuWy2cuqUDUsAW2c000587qTiz1PnrN1vvbWuo5N/6ZyC5fzl/pWwfkX5hMXC5y2DPH8nkEIjwqfmwbWYtQJiSuxc4Je5Izvw2mubs5zKaKAIwVJiX0HImF6KtogownnR+EovCOzd3vti9d6Ouxzf9ABe/+a37t0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=sgIEMBEBDLWTqeUdVxAqJXqCDggjRxWxMszYuGtbo5TRbkpTrf2QV7hFhFvdA1mVSfCLAZjOpSarQYThUlrRtD/TEHMNQNTIlYq7aUcnZyUb0ZtaBw71Qq/OT14pF0u8sC4UDL3gT7S3cZvXOUXCqhLebVZWm/BHlXCafn8MwVs=
Received: by 10.115.55.1 with SMTP id h1mr526170wak.1194339061076;
        Tue, 06 Nov 2007 00:51:01 -0800 (PST)
Received: by 10.141.3.15 with HTTP; Tue, 6 Nov 2007 00:51:01 -0800 (PST)
Message-ID: <fa7518640711060051g5f2842f3p9a1a02fe37aaac66@mail.gmail.com>
Date: Tue, 6 Nov 2007 14:21:01 +0530
From: "Shailendra Mudgal" <mudgal.shailendra@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Get the terms and frequency vector of an indexed but unstored field
In-Reply-To: <11981677.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_16308_25111189.1194339061079"
References: <11980001.post@talk.nabble.com> <11981677.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_16308_25111189.1194339061079
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,
If while indexing we have not set this flag, then is there any other way to
get this info, i mean the TermFreqVector for a document ??



On 8/3/07, testn <test1@doramail.com> wrote:
>
>
> you can use IndexReader.getTermFreqVectors(int n) to get all terms and
> their
> frequencies. Make sure when you create an index, you choose option to
> store
> it by specifying Field.TermVector option.
> Check out http://www.cnlp.org/presentations/slides/AdvancedLuceneEU.pdf
>
>
>
> tierecke wrote:
> >
> > Hi,
> >
> > I indexed a large number of large documents, but I did not store the
> > document themselves, just indexed them.
> > Now I am interested in getting the vector (i.e.: the terms indexed and
> the
> > frequency) of that indexed but unstored field.
> > doc.getField (fieldname) returns null.
> > How can I get the data? It must be there, since it's a part of the
> index,
> > or am I wrong?
> >
> > Would be grateful for a quick result (need to submit data for a
> conference
> > this weekend).
> > thanks,
> > Nir.
> >
>
> --
> View this message in context:
> http://www.nabble.com/Get-the-terms-and-frequency-vector-of-an-indexed-but-unstored-field-tf4211430.html#a11981677
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_16308_25111189.1194339061079--

From java-user-return-30891-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 11:36:19 2007
Return-Path: <java-user-return-30891-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95105 invoked from network); 6 Nov 2007 11:36:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 11:36:19 -0000
Received: (qmail 87593 invoked by uid 500); 6 Nov 2007 11:36:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87566 invoked by uid 500); 6 Nov 2007 11:36:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87553 invoked by uid 99); 6 Nov 2007 11:35:59 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 03:35:59 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: 194.109.24.33 is neither permitted nor denied by domain of karl.wettin@gmail.com)
Received: from [194.109.24.33] (HELO smtp-vbr13.xs4all.nl) (194.109.24.33)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 11:36:29 +0000
Received: from [192.168.1.64] (memnon.xs4all.nl [82.93.70.124])
	by smtp-vbr13.xs4all.nl (8.13.8/8.13.8) with ESMTP id lA6BZcOQ067771
	for <java-user@lucene.apache.org>; Tue, 6 Nov 2007 12:35:39 +0100 (CET)
	(envelope-from karl.wettin@gmail.com)
Mime-Version: 1.0 (Apple Message framework v752.3)
In-Reply-To: <fa7518640711060051g5f2842f3p9a1a02fe37aaac66@mail.gmail.com>
References: <11980001.post@talk.nabble.com> <11981677.post@talk.nabble.com> <fa7518640711060051g5f2842f3p9a1a02fe37aaac66@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <A71CC317-99CE-4B06-9CCA-6583881AC451@gmail.com>
Content-Transfer-Encoding: 7bit
From: Karl Wettin <karl.wettin@gmail.com>
Subject: Re: Get the terms and frequency vector of an indexed but unstored field
Date: Tue, 6 Nov 2007 12:35:38 +0100
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.752.3)
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

6 nov 2007 kl. 09.51 skrev Shailendra Mudgal:

> Hi,
> If while indexing we have not set this flag, then is there any  
> other way to
> get this info, i mean the TermFreqVector for a document ??

See TermVectorAccessor in JIRA.

http://issues.apache.org/jira/browse/LUCENE-1016

The highligher also has some ad hoc code for extracting the data from  
the inverted index using TermEnum and TermDocs. It can however take  
quite some time.

-- 
karl


>
>
>
> On 8/3/07, testn <test1@doramail.com> wrote:
>>
>>
>> you can use IndexReader.getTermFreqVectors(int n) to get all terms  
>> and
>> their
>> frequencies. Make sure when you create an index, you choose option to
>> store
>> it by specifying Field.TermVector option.
>> Check out http://www.cnlp.org/presentations/slides/ 
>> AdvancedLuceneEU.pdf
>>
>>
>>
>> tierecke wrote:
>>>
>>> Hi,
>>>
>>> I indexed a large number of large documents, but I did not store the
>>> document themselves, just indexed them.
>>> Now I am interested in getting the vector (i.e.: the terms  
>>> indexed and
>> the
>>> frequency) of that indexed but unstored field.
>>> doc.getField (fieldname) returns null.
>>> How can I get the data? It must be there, since it's a part of the
>> index,
>>> or am I wrong?
>>>
>>> Would be grateful for a quick result (need to submit data for a
>> conference
>>> this weekend).
>>> thanks,
>>> Nir.
>>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Get-the-terms-and-frequency-vector-of-an- 
>> indexed-but-unstored-field-tf4211430.html#a11981677
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30892-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 12:43:58 2007
Return-Path: <java-user-return-30892-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15844 invoked from network); 6 Nov 2007 12:43:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 12:43:58 -0000
Received: (qmail 37718 invoked by uid 500); 6 Nov 2007 12:43:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37312 invoked by uid 500); 6 Nov 2007 12:43:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37301 invoked by uid 99); 6 Nov 2007 12:43:39 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 04:43:39 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a1.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 12:44:09 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a1.g.dreamhost.com (Postfix) with ESMTP id 17DDBFEC82
	for <java-user@lucene.apache.org>; Tue,  6 Nov 2007 04:43:13 -0800 (PST)
Message-Id: <CAF2ACCD-DA71-4E69-908D-699B1C7E34C3@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <fa7518640711052206u5ae118boac71d854cbd355e2@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: How to generate TermFreqVector from an existing index
Date: Tue, 6 Nov 2007 07:43:13 -0500
References: <fa7518640711052206u5ae118boac71d854cbd355e2@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

You would have to take the original input and re-analyze it and put it  
into the TermFreqVector format.  It's just a list of terms and their  
frequencies for a given doc, so it should be pretty straightforward to  
do.  Just extra runtime computation.

-Grant

On Nov 6, 2007, at 1:06 AM, Shailendra Mudgal wrote:

> Hi All,
>
> I have an index without does not have the termFreqVector stored in  
> it. I do
> not want to recreate the index as it is a big index and took a lot  
> of time
> while creation. Is their a other way for generating the  
> termFreqVector with
> the available info for all the documents.
>
> Any help will be appreciated,
>
> Regards,
> Shaile

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30893-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 22:14:44 2007
Return-Path: <java-user-return-30893-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22546 invoked from network); 6 Nov 2007 22:14:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 22:14:42 -0000
Received: (qmail 3744 invoked by uid 500); 6 Nov 2007 22:14:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3716 invoked by uid 500); 6 Nov 2007 22:14:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3705 invoked by uid 99); 6 Nov 2007 22:14:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 14:14:22 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mike.klaas@gmail.com designates 209.85.198.184 as permitted sender)
Received: from [209.85.198.184] (HELO rv-out-0910.google.com) (209.85.198.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 22:14:25 +0000
Received: by rv-out-0910.google.com with SMTP id k20so1545283rvb
        for <java-user@lucene.apache.org>; Tue, 06 Nov 2007 14:14:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:mime-version:in-reply-to:references:content-type:message-id:content-transfer-encoding:from:subject:date:to:x-mailer;
        bh=QHU6/2eh5Opd/9zvACjre4o5texFhNtBcpr64cArV8A=;
        b=SstiPGCOJnRpixrMSYv4LYCy/oyeoT9Y8NcO4KxeKvQh85isVxFw6RnoGCsQOX+Q6XqNLetf0lcE62tPxIdvaZ8Df27m1ZBN2XYlZIn6YNxDfoCVV21tYBLHl2i+yftEpxolpwIGplRkYrTEyY8sbQPHCUEeYbfkjl20Kqu8AaI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:mime-version:in-reply-to:references:content-type:message-id:content-transfer-encoding:from:subject:date:to:x-mailer;
        b=BBcWeg4R357seEUGzalVv01ZAtn/plRSW7i4OgRZ5Zg0nWGAg2xlBEHlKVKtXv1irviELWsl50kiVF1l773e+x/1nUocLKPxpSPC3MbN8riHUMugUsnAJMcF2LRv9CTEQ/YVdnJ8ZiGxPnksNq43uwdlQxx42/xd9W9zTc6Vh7o=
Received: by 10.114.173.15 with SMTP id v15mr6792222wae.1194387243923;
        Tue, 06 Nov 2007 14:14:03 -0800 (PST)
Received: from ?192.168.1.106? ( [24.82.155.191])
        by mx.google.com with ESMTPS id k14sm11499644waf.2007.11.06.14.14.00
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 06 Nov 2007 14:14:02 -0800 (PST)
Mime-Version: 1.0 (Apple Message framework v752.2)
In-Reply-To: <200710291743.14297.paul.elschot@xs4all.nl>
References: <F8E386B54CE3E6408F3A32ABB9A7908A347CED@hai02.hippointern.lan> <200710291743.14297.paul.elschot@xs4all.nl>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <FB901EF6-68EB-41C0-9068-343F36C18C61@gmail.com>
Content-Transfer-Encoding: 7bit
From: Mike Klaas <mike.klaas@gmail.com>
Subject: Re: Search performance using BooleanQueries in BooleanQueries
Date: Tue, 6 Nov 2007 14:14:01 -0800
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.752.2)
X-Virus-Checked: Checked by ClamAV on apache.org

On 29-Oct-07, at 9:43 AM, Paul Elschot wrote:

> On Friday 26 October 2007 09:36:58 Ard Schrijvers wrote:
>> +prop1:a +prop2:b +prop3:c +prop4:d +prop5:e
>>
>> is much faster than
>>
>> (+(+(+(+prop1:a +prop2:b) +prop3:c) +prop4:d) +prop5:e)
>>
>> where the second one is a result from BooleanQuery in  
>> BooleanQuery, and
>> all have Occur.MUST.
>>
>
> SImplifying boolean queries like this is not available in Lucene,  
> but it
> would have a positive effect on search performance, especially when
> prop1:a and prop2:b have a high document frequency.

Wait--shouldn't the outer-most BooleanQuery provide most of this  
speedup already (since it should be skipTo'ing between the nested  
BooleanQueries and the outermost).  Is it the indirection and sub- 
query management that is causing the performance difference, or  
differences in skiptTo behaviour?

-Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30894-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 22:28:06 2007
Return-Path: <java-user-return-30894-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28456 invoked from network); 6 Nov 2007 22:28:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 22:28:06 -0000
Received: (qmail 24870 invoked by uid 500); 6 Nov 2007 22:27:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24845 invoked by uid 500); 6 Nov 2007 22:27:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24834 invoked by uid 99); 6 Nov 2007 22:27:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 14:27:46 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of isaacrc82@gmail.com designates 209.85.198.185 as permitted sender)
Received: from [209.85.198.185] (HELO rv-out-0910.google.com) (209.85.198.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 22:27:50 +0000
Received: by rv-out-0910.google.com with SMTP id k20so1547643rvb
        for <java-user@lucene.apache.org>; Tue, 06 Nov 2007 14:27:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=IRNwmZPUXFCbNuPEC2oOydibJpJvbzFZCze2gzGI0AI=;
        b=Ul88uUDifwmuiB7KXKkcFhsZIg68HtpWyAllczuip/R2Z4Wa7uq6QBcrJWxbaMvLuUU2m3/k70va0E7o0dHSf9kSZCdz5dD9pxNGjsCoIeaTtP5op63RFQ72/NYL/JBjmTRsT5n3F+0Y/fMPCbJrrG0D4zjc8wSWtSPb0gFZLXs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=gMvuY9MBjFU0CrTb6kTilUIGa/008GDKfKt+ga6igdEYfWlj/kMNgJjqBb5IArPN71YBBCf4EuTMhjV4Hv+8YjdilQtbllwM5td2heC1EBKxYwOP1Pb6p0X7x42JKkpnaOFiHlo05IhhxTSOaTLMHhRHfrGaj33tB/EM2S2f/VQ=
Received: by 10.141.162.16 with SMTP id p16mr3204078rvo.1194388048629;
        Tue, 06 Nov 2007 14:27:28 -0800 (PST)
Received: by 10.140.173.8 with HTTP; Tue, 6 Nov 2007 14:27:28 -0800 (PST)
Message-ID: <bf1404350711061427n1af8f422qa61cfdeacdcb2e8d@mail.gmail.com>
Date: Tue, 6 Nov 2007 17:27:28 -0500
From: Ariel <isaacrc82@gmail.com>
To: java-user@lucene.apache.org
Subject: How to build your custom termfreq vector an add it to the field ?
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_16518_20598213.1194388048601"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_16518_20598213.1194388048601
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi:
I want to build a custom termfreq vector an add it to the field to store it
to the index.
I want to use lucene for research, I'm thinking to make some experimentation
so I need to store a term vector in a field in the index not based in the
frecuency of the term in the document instead of I want to use another
measure to get ranking improvements.
How can I do that. Is that posible with lucene ?
I will appreciate your help.
Greetings

------=_Part_16518_20598213.1194388048601--

From java-user-return-30895-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 23:02:45 2007
Return-Path: <java-user-return-30895-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53776 invoked from network); 6 Nov 2007 23:02:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 23:02:45 -0000
Received: (qmail 76317 invoked by uid 500); 6 Nov 2007 23:02:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76284 invoked by uid 500); 6 Nov 2007 23:02:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76273 invoked by uid 99); 6 Nov 2007 23:02:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 15:02:26 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.25] (HELO smtp-vbr5.xs4all.nl) (194.109.24.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 23:02:28 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr5.xs4all.nl (8.13.8/8.13.8) with ESMTP id lA6N26eY011036
	for <java-user@lucene.apache.org>; Wed, 7 Nov 2007 00:02:06 +0100 (CET)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Search performance using BooleanQueries in BooleanQueries
Date: Wed, 7 Nov 2007 00:02:06 +0100
User-Agent: KMail/1.9.6 (enterprise 0.20070907.709405)
References: <F8E386B54CE3E6408F3A32ABB9A7908A347CED@hai02.hippointern.lan> <200710291743.14297.paul.elschot@xs4all.nl> <FB901EF6-68EB-41C0-9068-343F36C18C61@gmail.com>
In-Reply-To: <FB901EF6-68EB-41C0-9068-343F36C18C61@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711070002.06566.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

On Tuesday 06 November 2007 23:14:01 Mike Klaas wrote:
> On 29-Oct-07, at 9:43 AM, Paul Elschot wrote:
> > On Friday 26 October 2007 09:36:58 Ard Schrijvers wrote:
> >> +prop1:a +prop2:b +prop3:c +prop4:d +prop5:e
> >>
> >> is much faster than
> >>
> >> (+(+(+(+prop1:a +prop2:b) +prop3:c) +prop4:d) +prop5:e)
> >>
> >> where the second one is a result from BooleanQuery in
> >> BooleanQuery, and
> >> all have Occur.MUST.
> >
> > SImplifying boolean queries like this is not available in Lucene,
> > but it
> > would have a positive effect on search performance, especially when
> > prop1:a and prop2:b have a high document frequency.
>
> Wait--shouldn't the outer-most BooleanQuery provide most of this
> speedup already (since it should be skipTo'ing between the nested
> BooleanQueries and the outermost).  Is it the indirection and sub-
> query management that is causing the performance difference, or
> differences in skiptTo behaviour?

The usual Lucene answer to performance questions: it depends.

After every hit, next() needs to be called on a subquery before
skipTo() can be used to find the next hit. It is currently not defined which 
subquery will be used for this first next().

The structure of the scorers normally follows the structure of
the BooleanQueries, so the indirection over the deep subquery
scores could well  be relevant to performance, too.

Which of these factors actually dominates performance is hard
to predict in advance. The point of skipTo() is that is tries to avoid
disk I/O as much as possible for the first time that the query is
executed. Later executions are much more likely to hit the OS cache,
and then the indirections will be more relevant to performance.

I'd like to have a good way to do a performance test on a first
query execution, in the sense that it does not hit the OS cache
for its skipTo() executions, but I have not found a good way yet.

Regards,
Paul Elschot

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30896-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 23:14:00 2007
Return-Path: <java-user-return-30896-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56699 invoked from network); 6 Nov 2007 23:13:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 23:13:59 -0000
Received: (qmail 88705 invoked by uid 500); 6 Nov 2007 23:13:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88669 invoked by uid 500); 6 Nov 2007 23:13:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88657 invoked by uid 99); 6 Nov 2007 23:13:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 15:13:41 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mike.klaas@gmail.com designates 209.85.146.178 as permitted sender)
Received: from [209.85.146.178] (HELO wa-out-1112.google.com) (209.85.146.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 23:13:43 +0000
Received: by wa-out-1112.google.com with SMTP id j40so2857001wah
        for <java-user@lucene.apache.org>; Tue, 06 Nov 2007 15:13:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:mime-version:in-reply-to:references:content-type:message-id:content-transfer-encoding:from:subject:date:to:x-mailer;
        bh=WLHNfeb55tIYiTh1Ok50maN7Vnu85wDyzevgN9s/W9Y=;
        b=MYjXuVx/U1fMAkYiO4M5VBslt6a0I0IGNjmlo+ugbmfkLmlD0u8cGgfDIieJjtPuviDAPwGOdD4EhUtsgcWl5bQkv5H0AYtlEvICNn3Vx6F8BDYynEMWpfUW+ddlS10mexZ+QAb8SbJwUaYRbvx1jCq8D7+FXWhD1LJqca01C+s=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:mime-version:in-reply-to:references:content-type:message-id:content-transfer-encoding:from:subject:date:to:x-mailer;
        b=f6FGGwvKk1GyiU1WMYG4TuqE277k4iRXJEn2Q/ZFqJvhYgpHZnDAis245Oiw+k6FqKjRxp+AseVWfIpEbsIstg7k4KiuRJygCgPPLxvs8vCQtZUofjy161Xp+v5WSQa6gjt0oXOePHRDchG0twZ+eZrvrI/tqUyD2x8j1QWU3VE=
Received: by 10.115.72.1 with SMTP id z1mr6864339wak.1194390802187;
        Tue, 06 Nov 2007 15:13:22 -0800 (PST)
Received: from ?192.168.1.106? ( [24.82.155.191])
        by mx.google.com with ESMTPS id k39sm17465419wah.2007.11.06.15.13.20
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 06 Nov 2007 15:13:21 -0800 (PST)
Mime-Version: 1.0 (Apple Message framework v752.2)
In-Reply-To: <200711070002.06566.paul.elschot@xs4all.nl>
References: <F8E386B54CE3E6408F3A32ABB9A7908A347CED@hai02.hippointern.lan> <200710291743.14297.paul.elschot@xs4all.nl> <FB901EF6-68EB-41C0-9068-343F36C18C61@gmail.com> <200711070002.06566.paul.elschot@xs4all.nl>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <1C852BEE-9E8B-4432-BC92-B967E154C1AF@gmail.com>
Content-Transfer-Encoding: 7bit
From: Mike Klaas <mike.klaas@gmail.com>
Subject: Re: Search performance using BooleanQueries in BooleanQueries
Date: Tue, 6 Nov 2007 15:13:21 -0800
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.752.2)
X-Virus-Checked: Checked by ClamAV on apache.org

On 6-Nov-07, at 3:02 PM, Paul Elschot wrote:

> On Tuesday 06 November 2007 23:14:01 Mike Klaas wrote:

>> Wait--shouldn't the outer-most BooleanQuery provide most of this
>> speedup already (since it should be skipTo'ing between the nested
>> BooleanQueries and the outermost).  Is it the indirection and sub-
>> query management that is causing the performance difference, or
>> differences in skiptTo behaviour?
>
> The usual Lucene answer to performance questions: it depends.
>
> After every hit, next() needs to be called on a subquery before
> skipTo() can be used to find the next hit. It is currently not  
> defined which
> subquery will be used for this first next().
>
> The structure of the scorers normally follows the structure of
> the BooleanQueries, so the indirection over the deep subquery
> scores could well  be relevant to performance, too.
>
> Which of these factors actually dominates performance is hard
> to predict in advance. The point of skipTo() is that is tries to avoid
> disk I/O as much as possible for the first time that the query is
> executed. Later executions are much more likely to hit the OS cache,
> and then the indirections will be more relevant to performance.
>
> I'd like to have a good way to do a performance test on a first
> query execution, in the sense that it does not hit the OS cache
> for its skipTo() executions, but I have not found a good way yet.

Interesting--thanks for the thoughtful answer.

-Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30897-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 06 23:21:24 2007
Return-Path: <java-user-return-30897-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59708 invoked from network); 6 Nov 2007 23:21:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 6 Nov 2007 23:21:22 -0000
Received: (qmail 98791 invoked by uid 500); 6 Nov 2007 23:21:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98764 invoked by uid 500); 6 Nov 2007 23:21:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98753 invoked by uid 99); 6 Nov 2007 23:21:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 15:21:04 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a19.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 23:21:35 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a19.g.dreamhost.com (Postfix) with ESMTP id 0F04610A88
	for <java-user@lucene.apache.org>; Tue,  6 Nov 2007 15:20:41 -0800 (PST)
Message-Id: <D5F1BA44-724F-4721-B822-3281233C60F0@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <bf1404350711061427n1af8f422qa61cfdeacdcb2e8d@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: How to build your custom termfreq vector an add it to the field ?
Date: Tue, 6 Nov 2007 18:20:35 -0500
References: <bf1404350711061427n1af8f422qa61cfdeacdcb2e8d@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

My guess is you want to look into the Scorer implementations.  I am  
not sure Lucene's term vector storage is needed, you could just store  
the terms as they always are and implement your own Query/Weigh/Scorer  
combo that ignores TF and uses your new approach.

See http://lucene.apache.org/java/docs/scoring.html for more info.

Otherwise, if you really want to use the TermVectors just for scoring,  
you may find the TermVectorMapper addition on the trunk to be useful  
for extracting the info you want.

Might be able to offer more suggestions if you can provide more detail  
about what you are trying to do.

HTH,
Grant

On Nov 6, 2007, at 5:27 PM, Ariel wrote:

> Hi:
> I want to build a custom termfreq vector an add it to the field to  
> store it
> to the index.
> I want to use lucene for research, I'm thinking to make some  
> experimentation
> so I need to store a term vector in a field in the index not based  
> in the
> frecuency of the term in the document instead of I want to use another
> measure to get ranking improvements.
> How can I do that. Is that posible with lucene ?
> I will appreciate your help.
> Greetings

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30898-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 03:35:38 2007
Return-Path: <java-user-return-30898-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52654 invoked from network); 7 Nov 2007 03:35:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 03:35:37 -0000
Received: (qmail 2480 invoked by uid 500); 7 Nov 2007 03:35:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 2447 invoked by uid 500); 7 Nov 2007 03:35:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 2436 invoked by uid 99); 7 Nov 2007 03:35:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Nov 2007 19:35:18 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [210.54.141.254] (HELO mta01.xtra.co.nz) (210.54.141.254)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 03:35:52 +0000
Received: from fep04.xtra.co.nz ([172.23.12.41]) by mta01.xtra.co.nz
          with ESMTP
          id <20071107033454.FAQO7558.mta01.xtra.co.nz@fep04.xtra.co.nz>
          for <java-user@lucene.apache.org>; Wed, 7 Nov 2007 16:34:54 +1300
Received: from x1000.msqr.us ([125.238.106.4]) by fep04.xtra.co.nz
          with ESMTP
          id <20071107033453.MRDA17371.fep04.xtra.co.nz@x1000.msqr.us>
          for <java-user@lucene.apache.org>; Wed, 7 Nov 2007 16:34:53 +1300
Received: from x1000.msqr.us (x1000.msqr.us [127.0.0.1])
	by x1000.msqr.us (8.13.1/8.13.1) with ESMTP id lA73YquE005816
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Wed, 7 Nov 2007 16:34:53 +1300
Received: (from apache@localhost)
	by x1000.msqr.us (8.13.1/8.13.1/Submit) id lA73YpFJ005815;
	Wed, 7 Nov 2007 16:34:51 +1300
Received: from 192.168.1.108
        (SquirrelMail authenticated user matt)
        by msqr.us with HTTP;
        Wed, 7 Nov 2007 16:34:51 +1300 (NZDT)
Message-ID: <50648.192.168.1.108.1194406491.squirrel@msqr.us>
Date: Wed, 7 Nov 2007 16:34:51 +1300 (NZDT)
Subject: Can multiple JVMs search an index with one JVM writing to it?
From: "Matt Magoffin" <apache.org@msqr.us>
To: java-user@lucene.apache.org
User-Agent: SquirrelMail/1.4.8-4.0.1.el4
MIME-Version: 1.0
Content-Type: text/plain;charset=iso-8859-1
Content-Transfer-Encoding: 8bit
X-Priority: 3 (Normal)
Importance: Normal
X-Virus-Checked: Checked by ClamAV on apache.org

Hello, I tried finding information about this from past mailing list
emails, but couldn't find anything. I'm using Lucene 1.4 series and
wondered if it is safe for two different JVMs opening and searching the
same physical index located on the local file system, with one of the JVMs
performing writes to the index?

All JVMs are long-running application servers, so I was wondering if this
would work at all or pose any problems for the search-only JVMs.

-- m@

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30899-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 13:22:35 2007
Return-Path: <java-user-return-30899-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97349 invoked from network); 7 Nov 2007 13:22:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 13:22:35 -0000
Received: (qmail 11605 invoked by uid 500); 7 Nov 2007 13:22:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11213 invoked by uid 500); 7 Nov 2007 13:22:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11202 invoked by uid 99); 7 Nov 2007 13:22:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 05:22:15 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nikolay.diakov@fredhopper.com designates 82.94.15.138 as permitted sender)
Received: from [82.94.15.138] (HELO smtp.fredhopper.com) (82.94.15.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 13:22:52 +0000
Received: from [192.168.0.235] (nikolay.ams.fredhopper.com [192.168.0.235])
	by smtp.fredhopper.com (Postfix) with ESMTP id EEF0D20D85A
	for <java-user@lucene.apache.org>; Wed,  7 Nov 2007 14:21:58 +0100 (CET)
Message-ID: <4731BBF4.4060409@fredhopper.com>
Date: Wed, 07 Nov 2007 14:21:56 +0100
From: Nikolay Diakov <nikolay.diakov@fredhopper.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: - possible bug in lock timeout
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the 
following line:

int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);

Since I wanted to set the lock timeout to the largest possible, I called 
the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This 
produces the effect in the quoted line that we get maxSleepCount a 
negative number.

Is this intended?

Cheers,
   Nik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30900-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 13:44:53 2007
Return-Path: <java-user-return-30900-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2750 invoked from network); 7 Nov 2007 13:44:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 13:44:53 -0000
Received: (qmail 36512 invoked by uid 500); 7 Nov 2007 13:44:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35605 invoked by uid 500); 7 Nov 2007 13:44:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35594 invoked by uid 99); 7 Nov 2007 13:44:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 05:44:35 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.128.190 as permitted sender)
Received: from [209.85.128.190] (HELO fk-out-0910.google.com) (209.85.128.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 13:44:38 +0000
Received: by fk-out-0910.google.com with SMTP id z23so2253522fkz
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 05:44:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=SKrO1mZbFkQ78t36b2Ct+PT+i53QQUlh1fmeY0xxyCE=;
        b=LykUZbvOYtUIWiLiiNpo4PguEL6M9XEUZyq/Z/u4almwhtiOIjcnhxCOBVJInfJTKfDwNPaXHsUeFZ+ctscMtltgvu/eNVS5TsS/9mW4Z99ASWvgj+g0fV0w0DfJQhTURCZbAA4kN7V5kQL4pdjAEnPfJpD5r1ajSjGyH4HkJnM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=bUvsnEgOSK9AGP3VroTEui2h6LcqueGhtk0fbfOF+ipxMASEVScmMXQDW5IoHLkJUMjZ6vCDRW9IFJnBoGddLZ2busSz0iqz30ZFCutc7G90/6JvW13SbLo/dKDPpgjBPPjIqNE3G4R35Z1JQRMFN8JE7YBC44sbGtDqlhPW11k=
Received: by 10.82.111.8 with SMTP id j8mr14755504buc.1194443056419;
        Wed, 07 Nov 2007 05:44:16 -0800 (PST)
Received: by 10.82.182.15 with HTTP; Wed, 7 Nov 2007 05:44:16 -0800 (PST)
Message-ID: <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>
Date: Wed, 7 Nov 2007 08:44:16 -0500
From: "Mark Miller" <markrmiller@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
In-Reply-To: <4731BBF4.4060409@fredhopper.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <4731BBF4.4060409@fredhopper.com>
X-Virus-Checked: Checked by ClamAV on apache.org

There are a few places in Lucene (prob in a lot of other code as well)
where you should not use Long.MAX_VALUE.

Don't use it as the number of docs to return in a TopDocsCollector
either. If the code that takes that long even just adds 1 to the
variable...your screwed with a huge negative number.

In your case here, a huge long is getting cast to an int, and the int
just cannot hold a number that big.

Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.

- Mark

On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
> following line:
>
> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
>
> Since I wanted to set the lock timeout to the largest possible, I called
> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
> produces the effect in the quoted line that we get maxSleepCount a
> negative number.
>
> Is this intended?
>
> Cheers,
>    Nik
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30901-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 13:48:49 2007
Return-Path: <java-user-return-30901-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3369 invoked from network); 7 Nov 2007 13:48:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 13:48:49 -0000
Received: (qmail 41494 invoked by uid 500); 7 Nov 2007 13:48:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41275 invoked by uid 500); 7 Nov 2007 13:48:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41264 invoked by uid 99); 7 Nov 2007 13:48:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 05:48:30 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nikolay.diakov@fredhopper.com designates 82.94.15.138 as permitted sender)
Received: from [82.94.15.138] (HELO smtp.fredhopper.com) (82.94.15.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 13:48:34 +0000
Received: from [192.168.0.235] (nikolay.ams.fredhopper.com [192.168.0.235])
	by smtp.fredhopper.com (Postfix) with ESMTP id 5F50F20D5AC
	for <java-user@lucene.apache.org>; Wed,  7 Nov 2007 14:48:13 +0100 (CET)
Message-ID: <4731C21A.4020900@fredhopper.com>
Date: Wed, 07 Nov 2007 14:48:10 +0100
From: Nikolay Diakov <nikolay.diakov@fredhopper.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
References: <4731BBF4.4060409@fredhopper.com> <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>
In-Reply-To: <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks, I understand.

Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will 
make the function tolerate the whole range of its parameter values.

Cheers,
   Nikolay

Mark Miller wrote:
> There are a few places in Lucene (prob in a lot of other code as well)
> where you should not use Long.MAX_VALUE.
> 
> Don't use it as the number of docs to return in a TopDocsCollector
> either. If the code that takes that long even just adds 1 to the
> variable...your screwed with a huge negative number.
> 
> In your case here, a huge long is getting cast to an int, and the int
> just cannot hold a number that big.
> 
> Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
> 
> - Mark
> 
> On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
>> following line:
>>
>> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
>>
>> Since I wanted to set the lock timeout to the largest possible, I called
>> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
>> produces the effect in the quoted line that we get maxSleepCount a
>> negative number.
>>
>> Is this intended?
>>
>> Cheers,
>>    Nik
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30902-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 13:55:23 2007
Return-Path: <java-user-return-30902-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4890 invoked from network); 7 Nov 2007 13:55:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 13:55:23 -0000
Received: (qmail 56589 invoked by uid 500); 7 Nov 2007 13:55:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56263 invoked by uid 500); 7 Nov 2007 13:55:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56252 invoked by uid 99); 7 Nov 2007 13:55:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 05:55:03 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.128.188 as permitted sender)
Received: from [209.85.128.188] (HELO fk-out-0910.google.com) (209.85.128.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 13:55:07 +0000
Received: by fk-out-0910.google.com with SMTP id z23so2256588fkz
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 05:54:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=buq/FLR+isnpHq7ga4QnRhi920i1nsqAkrQwHh6D+xE=;
        b=fDuxN0WI5z8R2Lr6zmf/w2i4fuDHK+HeWbv8nF0PyeM/0dgUqAedNbnAlsHbt+tNugYvom/T1QqRJa3gVXfJGdUkeKxdVW5aQ/6d624q0IhGa/J++hDiYTLkLTRGEar96ddAgff0Isqi97wm23nM8kx3ABB8n/TWQQxrzvrRpfE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=SyLGJOYdGmeD9OZPyBLvDnTQQuqTvm/LL6gi/Is5xWIcs1YNMP/c7fLGRaXvR2sxVu3nXJFgKGAWEkEzapUx7XUxrtl0EhZyFs3o+DJePtwsAisEABDajmBmBfSK1jqDmlDUQ9/DfIWidedzOLuoo9AulNzzYLy5rnBMHdkGkCw=
Received: by 10.82.126.5 with SMTP id y5mr15206730buc.1194443684420;
        Wed, 07 Nov 2007 05:54:44 -0800 (PST)
Received: by 10.82.182.15 with HTTP; Wed, 7 Nov 2007 05:54:44 -0800 (PST)
Message-ID: <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>
Date: Wed, 7 Nov 2007 08:54:44 -0500
From: "Mark Miller" <markrmiller@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
In-Reply-To: <4731C21A.4020900@fredhopper.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <4731BBF4.4060409@fredhopper.com>
	 <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>
	 <4731C21A.4020900@fredhopper.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I agree to an extent. You could argue for checks like this in a lot of
places though. It seems to protect an odd use case here. Normally your
timeout would not be anywhere near Long.MAX_VALUE. I would argue there
should be a better way to set "never timeout" than by using a huge
number. In either case, its a pretty easy error to spot even without
an exception thrown. These types of checks are a slippery slope.

Of course the Lucene developers just might agree with you.

On Nov 7, 2007 8:48 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> Thanks, I understand.
>
> Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will
> make the function tolerate the whole range of its parameter values.
>
> Cheers,
>    Nikolay
>
>
> Mark Miller wrote:
> > There are a few places in Lucene (prob in a lot of other code as well)
> > where you should not use Long.MAX_VALUE.
> >
> > Don't use it as the number of docs to return in a TopDocsCollector
> > either. If the code that takes that long even just adds 1 to the
> > variable...your screwed with a huge negative number.
> >
> > In your case here, a huge long is getting cast to an int, and the int
> > just cannot hold a number that big.
> >
> > Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
> >
> > - Mark
> >
> > On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> >> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
> >> following line:
> >>
> >> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
> >>
> >> Since I wanted to set the lock timeout to the largest possible, I called
> >> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
> >> produces the effect in the quoted line that we get maxSleepCount a
> >> negative number.
> >>
> >> Is this intended?
> >>
> >> Cheers,
> >>    Nik
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30903-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 14:05:00 2007
Return-Path: <java-user-return-30903-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7201 invoked from network); 7 Nov 2007 14:05:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 14:05:00 -0000
Received: (qmail 73909 invoked by uid 500); 7 Nov 2007 14:04:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73872 invoked by uid 500); 7 Nov 2007 14:04:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73861 invoked by uid 99); 7 Nov 2007 14:04:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 06:04:41 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.128.185 as permitted sender)
Received: from [209.85.128.185] (HELO fk-out-0910.google.com) (209.85.128.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 14:04:45 +0000
Received: by fk-out-0910.google.com with SMTP id z23so2259248fkz
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 06:04:24 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=O7g07vyrHwgDsY+MzMYsmx9Yud8en1D8r2a5iCzxQro=;
        b=lVH477PyJkCvJ4Xy3/mSPuqSzxbpb/MwPGbSVIrhFrmTpcs5fRsJ9uDKPc8nU7/qquQMK7JNNqch9n87mnUl4ywhEDZITjbK0lLintNmDRCQOmw/xYtZVIRAwbfgOr76NBPh3g0wxJ2APeCzT3afZKKg4iFXoAteEFyst6Sv114=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=qw42QZCHEoWknHRUDKLfeUnMWGV7CnHlkn98acauB4iCB1MoKFuLc3ScbG0Fby9o23L6PnCaw2wvD+ve1pult/WrLQZXgpal6k+ebBcJjRchB4yv3gjsJ73wfuVZCDQagEdYEUeuDeRcvBMpeoOG/7O6j7ix66g3zhQBImgzOQ8=
Received: by 10.82.107.15 with SMTP id f15mr15094739buc.1194444263802;
        Wed, 07 Nov 2007 06:04:23 -0800 (PST)
Received: by 10.82.182.15 with HTTP; Wed, 7 Nov 2007 06:04:18 -0800 (PST)
Message-ID: <ab0709bf0711070604x28611401w885ffbcd9388f21b@mail.gmail.com>
Date: Wed, 7 Nov 2007 09:04:18 -0500
From: "Mark Miller" <markrmiller@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
In-Reply-To: <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <4731BBF4.4060409@fredhopper.com>
	 <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>
	 <4731C21A.4020900@fredhopper.com>
	 <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

By the way...it looks like to me like you still get the behavior you
wanted. Getting the lock effectively never times out, correct?

On Nov 7, 2007 8:54 AM, Mark Miller <markrmiller@gmail.com> wrote:
> I agree to an extent. You could argue for checks like this in a lot of
> places though. It seems to protect an odd use case here. Normally your
> timeout would not be anywhere near Long.MAX_VALUE. I would argue there
> should be a better way to set "never timeout" than by using a huge
> number. In either case, its a pretty easy error to spot even without
> an exception thrown. These types of checks are a slippery slope.
>
> Of course the Lucene developers just might agree with you.
>
>
> On Nov 7, 2007 8:48 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> > Thanks, I understand.
> >
> > Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will
> > make the function tolerate the whole range of its parameter values.
> >
> > Cheers,
> >    Nikolay
> >
> >
> > Mark Miller wrote:
> > > There are a few places in Lucene (prob in a lot of other code as well)
> > > where you should not use Long.MAX_VALUE.
> > >
> > > Don't use it as the number of docs to return in a TopDocsCollector
> > > either. If the code that takes that long even just adds 1 to the
> > > variable...your screwed with a huge negative number.
> > >
> > > In your case here, a huge long is getting cast to an int, and the int
> > > just cannot hold a number that big.
> > >
> > > Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
> > >
> > > - Mark
> > >
> > > On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> > >> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
> > >> following line:
> > >>
> > >> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
> > >>
> > >> Since I wanted to set the lock timeout to the largest possible, I called
> > >> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
> > >> produces the effect in the quoted line that we get maxSleepCount a
> > >> negative number.
> > >>
> > >> Is this intended?
> > >>
> > >> Cheers,
> > >>    Nik
> > >>
> > >> ---------------------------------------------------------------------
> > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>
> > >>
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30904-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 14:05:52 2007
Return-Path: <java-user-return-30904-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7396 invoked from network); 7 Nov 2007 14:05:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 14:05:52 -0000
Received: (qmail 76247 invoked by uid 500); 7 Nov 2007 14:05:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76217 invoked by uid 500); 7 Nov 2007 14:05:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76206 invoked by uid 99); 7 Nov 2007 14:05:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 06:05:33 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nikolay.diakov@fredhopper.com designates 82.94.15.138 as permitted sender)
Received: from [82.94.15.138] (HELO smtp.fredhopper.com) (82.94.15.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 14:05:36 +0000
Received: from [192.168.0.235] (nikolay.ams.fredhopper.com [192.168.0.235])
	by smtp.fredhopper.com (Postfix) with ESMTP id 7984F1C6312
	for <java-user@lucene.apache.org>; Wed,  7 Nov 2007 15:05:15 +0100 (CET)
Message-ID: <4731C618.6030502@fredhopper.com>
Date: Wed, 07 Nov 2007 15:05:12 +0100
From: Nikolay Diakov <nikolay.diakov@fredhopper.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
References: <4731BBF4.4060409@fredhopper.com>	 <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>	 <4731C21A.4020900@fredhopper.com> <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>
In-Reply-To: <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Ok, to make thing simpler, our application cannot tolerate timeouts, so 
the following business case becomes desirable:

"I'd like mandatory locks - ones that either block or lock the resource."

One way to do this requires passing of a very large value that seems 
infinite to a normal business user. At the moment we use 100 minutes, 
but our first guess was - "hey, lets try the maximum number - it works 
on other lock based APIs of Java". Hence the reported "feature".

Anyway, the least improvement of Lucene in that respect would include 
documenting the usable range of the argument value - in that case [0 to 
1000 times less than Long. MAX_VALUE]. The left interval border one can 
guess easily as we have milliseconds. For the right border one needs to 
look at the code for a spec.

Cheers,
   Nikolay

Mark Miller wrote:
> I agree to an extent. You could argue for checks like this in a lot of
> places though. It seems to protect an odd use case here. Normally your
> timeout would not be anywhere near Long.MAX_VALUE. I would argue there
> should be a better way to set "never timeout" than by using a huge
> number. In either case, its a pretty easy error to spot even without
> an exception thrown. These types of checks are a slippery slope.
> 
> Of course the Lucene developers just might agree with you.
> 
> On Nov 7, 2007 8:48 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>> Thanks, I understand.
>>
>> Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will
>> make the function tolerate the whole range of its parameter values.
>>
>> Cheers,
>>    Nikolay
>>
>>
>> Mark Miller wrote:
>>> There are a few places in Lucene (prob in a lot of other code as well)
>>> where you should not use Long.MAX_VALUE.
>>>
>>> Don't use it as the number of docs to return in a TopDocsCollector
>>> either. If the code that takes that long even just adds 1 to the
>>> variable...your screwed with a huge negative number.
>>>
>>> In your case here, a huge long is getting cast to an int, and the int
>>> just cannot hold a number that big.
>>>
>>> Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
>>>
>>> - Mark
>>>
>>> On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>>>> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
>>>> following line:
>>>>
>>>> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
>>>>
>>>> Since I wanted to set the lock timeout to the largest possible, I called
>>>> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
>>>> produces the effect in the quoted line that we get maxSleepCount a
>>>> negative number.
>>>>
>>>> Is this intended?
>>>>
>>>> Cheers,
>>>>    Nik
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30905-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 14:07:43 2007
Return-Path: <java-user-return-30905-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7866 invoked from network); 7 Nov 2007 14:07:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 14:07:43 -0000
Received: (qmail 81523 invoked by uid 500); 7 Nov 2007 14:07:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81493 invoked by uid 500); 7 Nov 2007 14:07:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81482 invoked by uid 99); 7 Nov 2007 14:07:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 06:07:18 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nikolay.diakov@fredhopper.com designates 82.94.15.138 as permitted sender)
Received: from [82.94.15.138] (HELO smtp.fredhopper.com) (82.94.15.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 14:07:22 +0000
Received: from [192.168.0.235] (nikolay.ams.fredhopper.com [192.168.0.235])
	by smtp.fredhopper.com (Postfix) with ESMTP id C114B1C633F
	for <java-user@lucene.apache.org>; Wed,  7 Nov 2007 15:07:01 +0100 (CET)
Message-ID: <4731C683.3090403@fredhopper.com>
Date: Wed, 07 Nov 2007 15:06:59 +0100
From: Nikolay Diakov <nikolay.diakov@fredhopper.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
References: <4731BBF4.4060409@fredhopper.com>	 <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>	 <4731C21A.4020900@fredhopper.com>	 <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com> <ab0709bf0711070604x28611401w885ffbcd9388f21b@mail.gmail.com>
In-Reply-To: <ab0709bf0711070604x28611401w885ffbcd9388f21b@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, yes, I never said it does not work ;-). I wrote that we get a 
negative number there, doubting it desired behavior.

--Nikolay

Mark Miller wrote:
> By the way...it looks like to me like you still get the behavior you
> wanted. Getting the lock effectively never times out, correct?
> 
> On Nov 7, 2007 8:54 AM, Mark Miller <markrmiller@gmail.com> wrote:
>> I agree to an extent. You could argue for checks like this in a lot of
>> places though. It seems to protect an odd use case here. Normally your
>> timeout would not be anywhere near Long.MAX_VALUE. I would argue there
>> should be a better way to set "never timeout" than by using a huge
>> number. In either case, its a pretty easy error to spot even without
>> an exception thrown. These types of checks are a slippery slope.
>>
>> Of course the Lucene developers just might agree with you.
>>
>>
>> On Nov 7, 2007 8:48 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>>> Thanks, I understand.
>>>
>>> Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will
>>> make the function tolerate the whole range of its parameter values.
>>>
>>> Cheers,
>>>    Nikolay
>>>
>>>
>>> Mark Miller wrote:
>>>> There are a few places in Lucene (prob in a lot of other code as well)
>>>> where you should not use Long.MAX_VALUE.
>>>>
>>>> Don't use it as the number of docs to return in a TopDocsCollector
>>>> either. If the code that takes that long even just adds 1 to the
>>>> variable...your screwed with a huge negative number.
>>>>
>>>> In your case here, a huge long is getting cast to an int, and the int
>>>> just cannot hold a number that big.
>>>>
>>>> Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
>>>>
>>>> - Mark
>>>>
>>>> On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>>>>> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
>>>>> following line:
>>>>>
>>>>> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
>>>>>
>>>>> Since I wanted to set the lock timeout to the largest possible, I called
>>>>> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
>>>>> produces the effect in the quoted line that we get maxSleepCount a
>>>>> negative number.
>>>>>
>>>>> Is this intended?
>>>>>
>>>>> Cheers,
>>>>>    Nik
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30906-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 14:14:22 2007
Return-Path: <java-user-return-30906-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9163 invoked from network); 7 Nov 2007 14:14:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 14:14:19 -0000
Received: (qmail 93103 invoked by uid 500); 7 Nov 2007 14:13:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93071 invoked by uid 500); 7 Nov 2007 14:13:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93057 invoked by uid 99); 7 Nov 2007 14:13:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 06:13:56 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.128.188 as permitted sender)
Received: from [209.85.128.188] (HELO fk-out-0910.google.com) (209.85.128.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 14:14:32 +0000
Received: by fk-out-0910.google.com with SMTP id z23so2261929fkz
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 06:13:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=tjl7FgX3x9vEFBPVS64OzuC4wGc3ZC/MqqQzRysV2wQ=;
        b=f8An6wRWNFeksyyilqXlaPcPeuy0wl9K8zLkog0S+PqLoJBraIiLaJSw7TvPb+8VxRFulLghS68hPs2h9HSbcI8oU2UBKV3N+QVGBRKIXuzp0vRtTw7kU5k/+tl67Xt2eq0SvLoKGrjjIqM/uv0CBrD6cplMG0kX7XepYbC6Lkg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=txvkr/DmIaFfMlF0W7zCiwFnwkoTbWw7GQd6AAa8WlZfq+FyhuUKdnM+YMpAyUsJve29yBc1aLT9p7T/7kJmPBL9VBR1xz/3QukmPbggqWjhkP8J8lu3Oyada6webqcZpN2mCFpFe0fYvnYS+iQ72bAsd1yQwV0P2zU6ZB1Kfd0=
Received: by 10.82.171.16 with SMTP id t16mr15189949bue.1194444816803;
        Wed, 07 Nov 2007 06:13:36 -0800 (PST)
Received: by 10.82.182.15 with HTTP; Wed, 7 Nov 2007 06:13:36 -0800 (PST)
Message-ID: <ab0709bf0711070613ib563217v3e45ccfe2abda5ef@mail.gmail.com>
Date: Wed, 7 Nov 2007 09:13:36 -0500
From: "Mark Miller" <markrmiller@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
In-Reply-To: <4731C683.3090403@fredhopper.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <4731BBF4.4060409@fredhopper.com>
	 <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>
	 <4731C21A.4020900@fredhopper.com>
	 <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>
	 <ab0709bf0711070604x28611401w885ffbcd9388f21b@mail.gmail.com>
	 <4731C683.3090403@fredhopper.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Seems pretty desirable to me. Unless you where *really* counting on
that lock obtain timing out after how ever many years of being denied
<g>.

On Nov 7, 2007 9:06 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> Yes, yes, I never said it does not work ;-). I wrote that we get a
> negative number there, doubting it desired behavior.
>
> --Nikolay
>
>
> Mark Miller wrote:
> > By the way...it looks like to me like you still get the behavior you
> > wanted. Getting the lock effectively never times out, correct?
> >
> > On Nov 7, 2007 8:54 AM, Mark Miller <markrmiller@gmail.com> wrote:
> >> I agree to an extent. You could argue for checks like this in a lot of
> >> places though. It seems to protect an odd use case here. Normally your
> >> timeout would not be anywhere near Long.MAX_VALUE. I would argue there
> >> should be a better way to set "never timeout" than by using a huge
> >> number. In either case, its a pretty easy error to spot even without
> >> an exception thrown. These types of checks are a slippery slope.
> >>
> >> Of course the Lucene developers just might agree with you.
> >>
> >>
> >> On Nov 7, 2007 8:48 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> >>> Thanks, I understand.
> >>>
> >>> Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will
> >>> make the function tolerate the whole range of its parameter values.
> >>>
> >>> Cheers,
> >>>    Nikolay
> >>>
> >>>
> >>> Mark Miller wrote:
> >>>> There are a few places in Lucene (prob in a lot of other code as well)
> >>>> where you should not use Long.MAX_VALUE.
> >>>>
> >>>> Don't use it as the number of docs to return in a TopDocsCollector
> >>>> either. If the code that takes that long even just adds 1 to the
> >>>> variable...your screwed with a huge negative number.
> >>>>
> >>>> In your case here, a huge long is getting cast to an int, and the int
> >>>> just cannot hold a number that big.
> >>>>
> >>>> Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
> >>>>
> >>>> - Mark
> >>>>
> >>>> On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> >>>>> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
> >>>>> following line:
> >>>>>
> >>>>> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
> >>>>>
> >>>>> Since I wanted to set the lock timeout to the largest possible, I called
> >>>>> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
> >>>>> produces the effect in the quoted line that we get maxSleepCount a
> >>>>> negative number.
> >>>>>
> >>>>> Is this intended?
> >>>>>
> >>>>> Cheers,
> >>>>>    Nik
> >>>>>
> >>>>> ---------------------------------------------------------------------
> >>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>>
> >>>>>
> >>>> ---------------------------------------------------------------------
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30907-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 14:19:14 2007
Return-Path: <java-user-return-30907-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10043 invoked from network); 7 Nov 2007 14:19:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 14:19:13 -0000
Received: (qmail 736 invoked by uid 500); 7 Nov 2007 14:18:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 564 invoked by uid 500); 7 Nov 2007 14:18:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 553 invoked by uid 99); 7 Nov 2007 14:18:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 06:18:50 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of markrmiller@gmail.com designates 209.85.128.189 as permitted sender)
Received: from [209.85.128.189] (HELO fk-out-0910.google.com) (209.85.128.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 14:19:25 +0000
Received: by fk-out-0910.google.com with SMTP id z23so2263241fkz
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 06:18:32 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=xoc8nI6U/XsqjzUH6ZabVtNbUo7GX80aowX+IPKtwVU=;
        b=WV+iHOrq6AE6qYoZJSnYb9v4NvF+EprR/o66cPq0Wx3PSG8fLP+REl6b2dNS/2ZS+lpUNICgDFD1sRaBX06gewQmltsKciwSTbd2nJP9vUcPVJgFpkVOwfypwX4zHmtkCIZkS9UIn0K9EfV0U/2LN5Nd+IdhZG+ekRxSU5+hLuQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=ev2aec79VbAZqJTzM4Q2/TGW1pGVHSyVP0Z7gW6dVf3oW2iyT0C1W6JqyoHfdcMAwpl3pIRVLWZA/HFGZIdXo8WvOTDvZew+L95LjQBGp0a4ScTm5R9309v78A/5kyFIgiOt79kl1kh8lBSmFT4l9aL2xCLrUeOBxa6uCYkA1uw=
Received: by 10.82.112.3 with SMTP id k3mr15331634buc.1194445101691;
        Wed, 07 Nov 2007 06:18:21 -0800 (PST)
Received: by 10.82.182.15 with HTTP; Wed, 7 Nov 2007 06:18:08 -0800 (PST)
Message-ID: <ab0709bf0711070618n65518536m15cb9aaf337fd53@mail.gmail.com>
Date: Wed, 7 Nov 2007 09:18:08 -0500
From: "Mark Miller" <markrmiller@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
In-Reply-To: <4731C618.6030502@fredhopper.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <4731BBF4.4060409@fredhopper.com>
	 <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>
	 <4731C21A.4020900@fredhopper.com>
	 <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>
	 <4731C618.6030502@fredhopper.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hmmmm...it seems to me that making locks that never time out would be
hiding a real problem that you could be having. It should never take
anywhere near that long to get a lock, and if it does, something very
serious is wrong and very unlikely to fix itself. I don't think this
lock is even of any value if you access the index with only one JVM
and follow good Lucene design practices. I think its more of a
safeguard against erratic use...

On Nov 7, 2007 9:05 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> Ok, to make thing simpler, our application cannot tolerate timeouts, so
> the following business case becomes desirable:
>
> "I'd like mandatory locks - ones that either block or lock the resource."
>
> One way to do this requires passing of a very large value that seems
> infinite to a normal business user. At the moment we use 100 minutes,
> but our first guess was - "hey, lets try the maximum number - it works
> on other lock based APIs of Java". Hence the reported "feature".
>
> Anyway, the least improvement of Lucene in that respect would include
> documenting the usable range of the argument value - in that case [0 to
> 1000 times less than Long. MAX_VALUE]. The left interval border one can
> guess easily as we have milliseconds. For the right border one needs to
> look at the code for a spec.
>
>
> Cheers,
>    Nikolay
>
> Mark Miller wrote:
> > I agree to an extent. You could argue for checks like this in a lot of
> > places though. It seems to protect an odd use case here. Normally your
> > timeout would not be anywhere near Long.MAX_VALUE. I would argue there
> > should be a better way to set "never timeout" than by using a huge
> > number. In either case, its a pretty easy error to spot even without
> > an exception thrown. These types of checks are a slippery slope.
> >
> > Of course the Lucene developers just might agree with you.
> >
> > On Nov 7, 2007 8:48 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> >> Thanks, I understand.
> >>
> >> Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will
> >> make the function tolerate the whole range of its parameter values.
> >>
> >> Cheers,
> >>    Nikolay
> >>
> >>
> >> Mark Miller wrote:
> >>> There are a few places in Lucene (prob in a lot of other code as well)
> >>> where you should not use Long.MAX_VALUE.
> >>>
> >>> Don't use it as the number of docs to return in a TopDocsCollector
> >>> either. If the code that takes that long even just adds 1 to the
> >>> variable...your screwed with a huge negative number.
> >>>
> >>> In your case here, a huge long is getting cast to an int, and the int
> >>> just cannot hold a number that big.
> >>>
> >>> Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
> >>>
> >>> - Mark
> >>>
> >>> On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
> >>>> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
> >>>> following line:
> >>>>
> >>>> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
> >>>>
> >>>> Since I wanted to set the lock timeout to the largest possible, I called
> >>>> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
> >>>> produces the effect in the quoted line that we get maxSleepCount a
> >>>> negative number.
> >>>>
> >>>> Is this intended?
> >>>>
> >>>> Cheers,
> >>>>    Nik
> >>>>
> >>>> ---------------------------------------------------------------------
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30908-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 14:26:22 2007
Return-Path: <java-user-return-30908-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12166 invoked from network); 7 Nov 2007 14:26:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 14:26:21 -0000
Received: (qmail 11513 invoked by uid 500); 7 Nov 2007 14:26:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11375 invoked by uid 500); 7 Nov 2007 14:26:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11364 invoked by uid 99); 7 Nov 2007 14:26:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 06:26:02 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of nikolay.diakov@fredhopper.com designates 82.94.15.138 as permitted sender)
Received: from [82.94.15.138] (HELO smtp.fredhopper.com) (82.94.15.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 14:26:38 +0000
Received: from [192.168.0.235] (nikolay.ams.fredhopper.com [192.168.0.235])
	by smtp.fredhopper.com (Postfix) with ESMTP id BDFBA20E1D5
	for <java-user@lucene.apache.org>; Wed,  7 Nov 2007 15:25:44 +0100 (CET)
Message-ID: <4731CAE6.5000409@fredhopper.com>
Date: Wed, 07 Nov 2007 15:25:42 +0100
From: Nikolay Diakov <nikolay.diakov@fredhopper.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
References: <4731BBF4.4060409@fredhopper.com>	 <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>	 <4731C21A.4020900@fredhopper.com>	 <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>	 <4731C618.6030502@fredhopper.com> <ab0709bf0711070618n65518536m15cb9aaf337fd53@mail.gmail.com>
In-Reply-To: <ab0709bf0711070618n65518536m15cb9aaf337fd53@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Ok, some more info then - one of our tests ran on a machine with not so 
many resources. The system started swapping a lot and the file system 
slowed down its response to many operations. As one effect - locks 
started timing out. We like to have these machines around since slow 
machines tend to make more likely to happen some otherwise tricky errors 
that one does not see very often on fast machines. Hence the thing with 
mandatory locks that lock "no matter what", and the subsequent posting.

--Nikolay

Mark Miller wrote:
> Hmmmm...it seems to me that making locks that never time out would be
> hiding a real problem that you could be having. It should never take
> anywhere near that long to get a lock, and if it does, something very
> serious is wrong and very unlikely to fix itself. I don't think this
> lock is even of any value if you access the index with only one JVM
> and follow good Lucene design practices. I think its more of a
> safeguard against erratic use...
> 
> On Nov 7, 2007 9:05 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>> Ok, to make thing simpler, our application cannot tolerate timeouts, so
>> the following business case becomes desirable:
>>
>> "I'd like mandatory locks - ones that either block or lock the resource."
>>
>> One way to do this requires passing of a very large value that seems
>> infinite to a normal business user. At the moment we use 100 minutes,
>> but our first guess was - "hey, lets try the maximum number - it works
>> on other lock based APIs of Java". Hence the reported "feature".
>>
>> Anyway, the least improvement of Lucene in that respect would include
>> documenting the usable range of the argument value - in that case [0 to
>> 1000 times less than Long. MAX_VALUE]. The left interval border one can
>> guess easily as we have milliseconds. For the right border one needs to
>> look at the code for a spec.
>>
>>
>> Cheers,
>>    Nikolay
>>
>> Mark Miller wrote:
>>> I agree to an extent. You could argue for checks like this in a lot of
>>> places though. It seems to protect an odd use case here. Normally your
>>> timeout would not be anywhere near Long.MAX_VALUE. I would argue there
>>> should be a better way to set "never timeout" than by using a huge
>>> number. In either case, its a pretty easy error to spot even without
>>> an exception thrown. These types of checks are a slippery slope.
>>>
>>> Of course the Lucene developers just might agree with you.
>>>
>>> On Nov 7, 2007 8:48 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>>>> Thanks, I understand.
>>>>
>>>> Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will
>>>> make the function tolerate the whole range of its parameter values.
>>>>
>>>> Cheers,
>>>>    Nikolay
>>>>
>>>>
>>>> Mark Miller wrote:
>>>>> There are a few places in Lucene (prob in a lot of other code as well)
>>>>> where you should not use Long.MAX_VALUE.
>>>>>
>>>>> Don't use it as the number of docs to return in a TopDocsCollector
>>>>> either. If the code that takes that long even just adds 1 to the
>>>>> variable...your screwed with a huge negative number.
>>>>>
>>>>> In your case here, a huge long is getting cast to an int, and the int
>>>>> just cannot hold a number that big.
>>>>>
>>>>> Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
>>>>>
>>>>> - Mark
>>>>>
>>>>> On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>>>>>> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
>>>>>> following line:
>>>>>>
>>>>>> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
>>>>>>
>>>>>> Since I wanted to set the lock timeout to the largest possible, I called
>>>>>> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
>>>>>> produces the effect in the quoted line that we get maxSleepCount a
>>>>>> negative number.
>>>>>>
>>>>>> Is this intended?
>>>>>>
>>>>>> Cheers,
>>>>>>    Nik
>>>>>>
>>>>>> ---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30909-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 14:27:37 2007
Return-Path: <java-user-return-30909-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12448 invoked from network); 7 Nov 2007 14:27:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 14:27:37 -0000
Received: (qmail 13546 invoked by uid 500); 7 Nov 2007 14:27:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13515 invoked by uid 500); 7 Nov 2007 14:27:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13500 invoked by uid 99); 7 Nov 2007 14:27:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 06:27:18 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nikolay.diakov@fredhopper.com designates 82.94.15.138 as permitted sender)
Received: from [82.94.15.138] (HELO smtp.fredhopper.com) (82.94.15.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 14:27:22 +0000
Received: from [192.168.0.235] (nikolay.ams.fredhopper.com [192.168.0.235])
	by smtp.fredhopper.com (Postfix) with ESMTP id 9901220DD4C
	for <java-user@lucene.apache.org>; Wed,  7 Nov 2007 15:27:01 +0100 (CET)
Message-ID: <4731CB33.7000003@fredhopper.com>
Date: Wed, 07 Nov 2007 15:26:59 +0100
From: Nikolay Diakov <nikolay.diakov@fredhopper.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: - possible bug in lock timeout
References: <4731BBF4.4060409@fredhopper.com>	 <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>	 <4731C21A.4020900@fredhopper.com>	 <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>	 <4731C618.6030502@fredhopper.com> <ab0709bf0711070618n65518536m15cb9aaf337fd53@mail.gmail.com>
In-Reply-To: <ab0709bf0711070618n65518536m15cb9aaf337fd53@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I hope we do not get lock starvation or anything in these cases. Do 
these lock have any fairness integrated in them?

--Nikolay

Mark Miller wrote:
> Hmmmm...it seems to me that making locks that never time out would be
> hiding a real problem that you could be having. It should never take
> anywhere near that long to get a lock, and if it does, something very
> serious is wrong and very unlikely to fix itself. I don't think this
> lock is even of any value if you access the index with only one JVM
> and follow good Lucene design practices. I think its more of a
> safeguard against erratic use...
> 
> On Nov 7, 2007 9:05 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>> Ok, to make thing simpler, our application cannot tolerate timeouts, so
>> the following business case becomes desirable:
>>
>> "I'd like mandatory locks - ones that either block or lock the resource."
>>
>> One way to do this requires passing of a very large value that seems
>> infinite to a normal business user. At the moment we use 100 minutes,
>> but our first guess was - "hey, lets try the maximum number - it works
>> on other lock based APIs of Java". Hence the reported "feature".
>>
>> Anyway, the least improvement of Lucene in that respect would include
>> documenting the usable range of the argument value - in that case [0 to
>> 1000 times less than Long. MAX_VALUE]. The left interval border one can
>> guess easily as we have milliseconds. For the right border one needs to
>> look at the code for a spec.
>>
>>
>> Cheers,
>>    Nikolay
>>
>> Mark Miller wrote:
>>> I agree to an extent. You could argue for checks like this in a lot of
>>> places though. It seems to protect an odd use case here. Normally your
>>> timeout would not be anywhere near Long.MAX_VALUE. I would argue there
>>> should be a better way to set "never timeout" than by using a huge
>>> number. In either case, its a pretty easy error to spot even without
>>> an exception thrown. These types of checks are a slippery slope.
>>>
>>> Of course the Lucene developers just might agree with you.
>>>
>>> On Nov 7, 2007 8:48 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>>>> Thanks, I understand.
>>>>
>>>> Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and will
>>>> make the function tolerate the whole range of its parameter values.
>>>>
>>>> Cheers,
>>>>    Nikolay
>>>>
>>>>
>>>> Mark Miller wrote:
>>>>> There are a few places in Lucene (prob in a lot of other code as well)
>>>>> where you should not use Long.MAX_VALUE.
>>>>>
>>>>> Don't use it as the number of docs to return in a TopDocsCollector
>>>>> either. If the code that takes that long even just adds 1 to the
>>>>> variable...your screwed with a huge negative number.
>>>>>
>>>>> In your case here, a huge long is getting cast to an int, and the int
>>>>> just cannot hold a number that big.
>>>>>
>>>>> Prob could be handled better, but I would avoid using Long.MAX_VALUE anyway.
>>>>>
>>>>> - Mark
>>>>>
>>>>> On Nov 7, 2007 8:21 AM, Nikolay Diakov <nikolay.diakov@fredhopper.com> wrote:
>>>>>> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the
>>>>>> following line:
>>>>>>
>>>>>> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
>>>>>>
>>>>>> Since I wanted to set the lock timeout to the largest possible, I called
>>>>>> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This
>>>>>> produces the effect in the quoted line that we get maxSleepCount a
>>>>>> negative number.
>>>>>>
>>>>>> Is this intended?
>>>>>>
>>>>>> Cheers,
>>>>>>    Nik
>>>>>>
>>>>>> ---------------------------------------------------------------------
>>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>>
>>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30910-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 14:46:27 2007
Return-Path: <java-user-return-30910-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17043 invoked from network); 7 Nov 2007 14:46:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 14:46:27 -0000
Received: (qmail 38396 invoked by uid 500); 7 Nov 2007 14:46:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38371 invoked by uid 500); 7 Nov 2007 14:46:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38360 invoked by uid 99); 7 Nov 2007 14:46:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 06:46:09 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 14:46:45 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 2A1FC45E0C
	for <java-user@lucene.apache.org>; Wed,  7 Nov 2007 09:45:51 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Wed, 07 Nov 2007 09:45:51 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 08DAD3E921; Wed,  7 Nov 2007 09:45:51 -0500 (EST)
Message-Id: <1194446751.27304.1220038291@webmail.messagingengine.com>
X-Sasl-Enc: GFeAWwDmOVIhuFoeM++FxL4N17FgaSdlMYv28Xni1t/R 1194446751
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <4731BBF4.4060409@fredhopper.com>
   <ab0709bf0711070544n43cd441dp2b6114536d91a30d@mail.gmail.com>
   <4731C21A.4020900@fredhopper.com>
   <ab0709bf0711070554k65804874t52cc6820d5bf06c7@mail.gmail.com>
   <4731C618.6030502@fredhopper.com>
   <ab0709bf0711070618n65518536m15cb9aaf337fd53@mail.gmail.com>
   <4731CB33.7000003@fredhopper.com>
Subject: Re: - possible bug in lock timeout
In-Reply-To: <4731CB33.7000003@fredhopper.com>
Date: Wed, 07 Nov 2007 09:45:50 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Nikolay Diakov" <nikolay.diakov@fredhopper.com> wrote:

> I hope we do not get lock starvation or anything in these cases. Do
>  these lock have any fairness integrated in them?

Unfortunately, none of the builtin lock factories in Lucene have
fairness: they always just retry once per second (by default).  There
is no fifo queue for example.

> Nevertheless, a proper check for > Integer.MAX_VALUE won't hurt and
> will make the function tolerate the whole range of its parameter
> values

I agree, we should fix this.  I'll open a Jira issue.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30911-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 15:42:25 2007
Return-Path: <java-user-return-30911-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36680 invoked from network); 7 Nov 2007 15:42:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 15:42:25 -0000
Received: (qmail 29942 invoked by uid 500); 7 Nov 2007 15:42:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29909 invoked by uid 500); 7 Nov 2007 15:42:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29898 invoked by uid 99); 7 Nov 2007 15:42:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 07:42:06 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of l.rzeszotarski@gmail.com designates 209.85.198.186 as permitted sender)
Received: from [209.85.198.186] (HELO rv-out-0910.google.com) (209.85.198.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 15:42:10 +0000
Received: by rv-out-0910.google.com with SMTP id k20so1729623rvb
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 07:41:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=6mOTwyPqK3n9ckfOr3twey1hNpVKNh/+3DhUca8R/V8=;
        b=NEJsERRS3BKWsUfcU4o9STy+4ijijPl8SWfwXLeoNXGB1o/tPggPnReMkWEbMWxUpTsapb+Ec9JSSRd4UITAhU6DjwgZmEwe9VJA99eotlqlAYzG/NLGCzV+ODyHnYOdzmz1i5I9rOEaWVI+hY9UI3empbOd5Sk+YK54GsZh3nY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=Vd1WqqNE00+C3Lu0mvQmLkXTkenGTo9T48ihUcH0AF1xGmf6YM1yfgdyDVR8tc/6L+TDaoUWohhjqXVSrVVjxNG0c3jRQpFwqOT8Lt4g2Fc/RW+xzLlX1ev9a3DAaUingmPw9j3WS6esADe3DFvggcHW9Dx0C4XZAfbSDf5MZI0=
Received: by 10.141.162.16 with SMTP id p16mr3389154rvo.1194450110137;
        Wed, 07 Nov 2007 07:41:50 -0800 (PST)
Received: by 10.141.68.5 with HTTP; Wed, 7 Nov 2007 07:41:50 -0800 (PST)
Message-ID: <f9b40aaa0711070741j16bad167w4d04522212364aa8@mail.gmail.com>
Date: Wed, 7 Nov 2007 16:41:50 +0100
From: "Lukasz Rzeszotarski" <l.rzeszotarski@gmail.com>
To: java-user@lucene.apache.org
Subject: How to check which field contains Term
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_531_1306354.1194450110145"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_531_1306354.1194450110145
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hello. Let assume I have a Document which has two fields: Content_1 and
Content_2.
I am making query to find word "blabla" in the Content_1 OR Content_2.
But as a result I receive Hits collection without knowledge in which
Content_X, the word was founded.
Is it possible to receive Hits collection with documents and with
konwledge which Content_X was matched to the query.

I must write application, where client wants to make very complex query,
like:
find word "blabla" in (Content_1 OR Content_2) AND (...) AND (...).......
and as a result he expectes not only documents, but also  information in
which Content_X
was it founded.

Can lucene manage with it ?

------=_Part_531_1306354.1194450110145--

From java-user-return-30912-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 17:50:26 2007
Return-Path: <java-user-return-30912-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11317 invoked from network); 7 Nov 2007 17:50:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 17:50:26 -0000
Received: (qmail 58086 invoked by uid 500); 7 Nov 2007 17:50:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58050 invoked by uid 500); 7 Nov 2007 17:50:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58039 invoked by uid 99); 7 Nov 2007 17:50:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 09:50:07 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of isaacrc82@gmail.com designates 209.85.198.187 as permitted sender)
Received: from [209.85.198.187] (HELO rv-out-0910.google.com) (209.85.198.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 17:50:44 +0000
Received: by rv-out-0910.google.com with SMTP id k20so1755254rvb
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 09:49:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=jtT8FgGJVyfPL9eFsDG5Sc23LYfGE7S33JeQttlkhI0=;
        b=ivB9jb8H2FqXxj8eW8EsGZCwIDG/+vNQcOWhct9PjxjIxnAhXiXTQr8+bJ4xoz1H3NENY8irEWAyJZp1Pjn1C+q2y0j7pHtquZZDp5wlLYql9COE0F6BlNvOLS9olQEhj4IogL9yd9NXtZCFDrwmdmO2SMffHB7Kp8XGqcii0UM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=m8QUGrJ1N7+JWjH1xj3gH1xOrRJFEjUE1deFmSuxpTCNCIOTzwUh+Y4CJ+JZb7ap6uOI5Zy9MoOIOg1QU6KIs+P72A42T+p7MUxe/yUJGeUtIBxWBBfIpr5WutgoghqhZz/Y2pS/YHfHFp8YV7A+SbPy69Zmyd+pnq8n74aWMC8=
Received: by 10.141.15.19 with SMTP id s19mr3675225rvi.1194457788676;
        Wed, 07 Nov 2007 09:49:48 -0800 (PST)
Received: by 10.140.133.6 with HTTP; Wed, 7 Nov 2007 09:49:48 -0800 (PST)
Message-ID: <bf1404350711070949i1a856534p18aac179b7c4d88@mail.gmail.com>
Date: Wed, 7 Nov 2007 12:49:48 -0500
From: Ariel <isaacrc82@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to build your custom termfreq vector an add it to the field ?
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Then if I want to use another scoring formula I must to implement my
own Query/Weigh/Scorer  ? For example instead of cousine distance
leiderbage distance or .. another. I'm studying Query/Weigh/Scorer
classes to find out how to do that but there is not much documentation
about that.

I have seen I could change similarity factors extending the simlarity
class, but I have not seen any example about changing scoring formula
and changing the weight by term in the term vector. Do you know any
tutorial about this ?

What I want to do changing frecuency in the terms vector is this: for
example instead of take the tf term frecuency of the term and stored
in the vector I want to consider the correlation of the term with the
other terms of the documents and store that measure by term in the
vector so later with my custom similarity formula calculate the
ranking of a document against a query considering the correlation
between terms.
Dou you think is a big mistake try to do this with lucene ??? Is there any way ?

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30913-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 07 18:49:36 2007
Return-Path: <java-user-return-30913-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39307 invoked from network); 7 Nov 2007 18:49:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 7 Nov 2007 18:49:35 -0000
Received: (qmail 65899 invoked by uid 500); 7 Nov 2007 18:49:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65873 invoked by uid 500); 7 Nov 2007 18:49:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65855 invoked by uid 99); 7 Nov 2007 18:49:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 10:49:16 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.177] (HELO spunkymail-a10.g.dreamhost.com) (208.97.132.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 18:49:16 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a10.g.dreamhost.com (Postfix) with ESMTP id D753B163725
	for <java-user@lucene.apache.org>; Wed,  7 Nov 2007 10:48:42 -0800 (PST)
Message-Id: <07472893-A840-4215-A512-8C6A21D7E0D5@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <bf1404350711070949i1a856534p18aac179b7c4d88@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: How to build your custom termfreq vector an add it to the field ?
Date: Wed, 7 Nov 2007 13:48:41 -0500
References: <bf1404350711070949i1a856534p18aac179b7c4d88@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Term Vectors (specifically TermFreqVector) in Lucene are a storage  
mechanism for convenience and applications to use.  They are not an  
integral part of the scoring in the way you may be thinking of them in  
terms of the traditional Vector Space Model, thus there may be some  
confusion from the different usages of that terminology.  If you want  
to see examples of how to implement scorers have a look at classes  
like TermScorer, BoostingTermQuery, and any of the other classes that  
extend Scorer.  You might also find the file formats page (off of the  
Lucene Java website under Documentation) helpful for understanding  
what Lucene stores so that it can do scoring.

There really isn't any tutorial on scoring, as it is not something  
that many people have expressed an interest in or no one has made it a  
high enough priority to write one.  Having written a Scorer (or maybe  
two, I forget) I can give advice on specific things, but I am not sure  
I could write a tutorial that is general enough to be useful at this  
point.

One thought for associating a weight to a given term based on its  
cooccurring terms is to use the new Payload mechanism whereby you can  
store a byte array at each term which can then be used in scoring via  
things like the BoostingTermQuery (or your own implementation.)  If  
that is of interest, you can search the archives for payloads (I also  
think Michael Busch is presenting on Payloads, amongst other things,  
at ApacheCon in Atlanta) and have a look at the BoostingTermQuery.   
There certainly are other PayloadQueries that need to be implemented.   
See the Lucene wiki for some background and details on Payloads as well.

I don't know that it is a big mistake to try this in Lucene.  The  
community hasn't put a huge priority on making altering the innards of  
scoring easier to deal with (if possible), but that doesn't mean we  
are not open to suggestions and patches.    You may find https://issues.apache.org/jira/browse/LUCENE-965 
  to be informative for both the implementation and the discussion of  
things that need to happen to be accepted into Lucene.  This JIRA  
issue specifically attempts to provide Lucene with a new scoring  
mechanism.

You might also have a look at Lemur (http://www.lemurproject.org/)  
which is much more academically focused.

Cheers,
Grant

On Nov 7, 2007, at 12:49 PM, Ariel wrote:

> Then if I want to use another scoring formula I must to implement my
> own Query/Weigh/Scorer  ? For example instead of cousine distance
> leiderbage distance or .. another. I'm studying Query/Weigh/Scorer
> classes to find out how to do that but there is not much documentation
> about that.
>
> I have seen I could change similarity factors extending the simlarity
> class, but I have not seen any example about changing scoring formula
> and changing the weight by term in the term vector. Do you know any
> tutorial about this ?
>
> What I want to do changing frecuency in the terms vector is this: for
> example instead of take the tf term frecuency of the term and stored
> in the vector I want to consider the correlation of the term with the
> other terms of the documents and store that measure by term in the
> vector so later with my custom similarity formula calculate the
> ranking of a document against a query considering the correlation
> between terms.
> Dou you think is a big mistake try to do this with lucene ??? Is  
> there any way ?
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30914-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 00:47:00 2007
Return-Path: <java-user-return-30914-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68423 invoked from network); 8 Nov 2007 00:47:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 00:47:00 -0000
Received: (qmail 91421 invoked by uid 500); 8 Nov 2007 00:46:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91390 invoked by uid 500); 8 Nov 2007 00:46:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91379 invoked by uid 99); 8 Nov 2007 00:46:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 16:46:41 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 00:46:43 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IpvXL-0003hk-40
	for java-user@lucene.apache.org; Wed, 07 Nov 2007 16:46:23 -0800
Message-ID: <13639399.post@talk.nabble.com>
Date: Wed, 7 Nov 2007 16:46:23 -0800 (PST)
From: sumittyagi <ping.sumit@gmail.com>
To: java-user@lucene.apache.org
Subject: how can i store lucene results from a webpage to a oracle database
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ping.sumit@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


i want to retrieve lucene search results from the web page and want to put
them into oracle database through JDBC, and after some manipulation want to
display results again after fetching it from database. please help me
regarding this...like from where i have to start with... and what exactly i
need to do regarding this.
-- 
View this message in context: http://www.nabble.com/how-can-i-store-lucene-results-from-a-webpage-to-a-oracle-database-tf4768387.html#a13639399
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30915-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 02:31:34 2007
Return-Path: <java-user-return-30915-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4688 invoked from network); 8 Nov 2007 02:31:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 02:31:34 -0000
Received: (qmail 66020 invoked by uid 500); 8 Nov 2007 02:31:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65983 invoked by uid 500); 8 Nov 2007 02:31:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65972 invoked by uid 99); 8 Nov 2007 02:31:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 18:31:15 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 72.14.214.225 as permitted sender)
Received: from [72.14.214.225] (HELO hu-out-0506.google.com) (72.14.214.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 02:31:16 +0000
Received: by hu-out-0506.google.com with SMTP id 27so1383903hub
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 18:30:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=2Zig4TueMl9QTn25MvMs8lVMWgOh9rZwDrUjYXUtTj4=;
        b=ujLzjBzTWsQCvRZWqw0HdC0rFGfmZHLPiryUzqWFWyoD+DbxjTG2YNRj5fFWK0lpHvHvDE1WUpbaGVYzaNMg+JOfP4HU5K+MEepFLR+ZhmuldxPyjdb9WCusIE0H+Fe+PeJ8Em2HTD8KZhSpba/aW+w3w+7lJX3qYyak2mf6RRA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=ITWeAFGUdhTfLmWo1ICxxolrV+rU8NYJR49SGr/hbcsS3iG9G/DUjS0p1Ai3zKZ5ToNI8rTr2IJbhbfIfjn/4DlWDxpsMKzx6ow1aLzGMcLaOEJHeMlsf3gHYIiym9odXdlg1fwpRW1NGnjHwIacEQOA8w1CM6Hs40q5WKzBq1I=
Received: by 10.78.204.20 with SMTP id b20mr35798hug.1194489054324;
        Wed, 07 Nov 2007 18:30:54 -0800 (PST)
Received: by 10.78.140.9 with HTTP; Wed, 7 Nov 2007 18:30:54 -0800 (PST)
Message-ID: <6e3ae6310711071830re8902d2g2383c55eb7fdf57c@mail.gmail.com>
Date: Wed, 7 Nov 2007 18:30:54 -0800
From: "Chris Lu" <chris.lu@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: how can i store lucene results from a webpage to a oracle database
In-Reply-To: <13639399.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_41271_24678860.1194489054319"
References: <13639399.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_41271_24678860.1194489054319
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Very confused of your requirements.

Do you mean to search on Lucene and store the results in database? Sounds
you can do it easily via a JDBC call, and not really related to Lucene.

-- 
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes:
http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes

On Nov 7, 2007 4:46 PM, sumittyagi <ping.sumit@gmail.com> wrote:

>
> i want to retrieve lucene search results from the web page and want to put
> them into oracle database through JDBC, and after some manipulation want
> to
> display results again after fetching it from database. please help me
> regarding this...like from where i have to start with... and what exactly
> i
> need to do regarding this.
> --
> View this message in context:
> http://www.nabble.com/how-can-i-store-lucene-results-from-a-webpage-to-a-oracle-database-tf4768387.html#a13639399
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_41271_24678860.1194489054319--

From java-user-return-30916-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 02:57:09 2007
Return-Path: <java-user-return-30916-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12059 invoked from network); 8 Nov 2007 02:57:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 02:57:09 -0000
Received: (qmail 80433 invoked by uid 500); 8 Nov 2007 02:56:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80403 invoked by uid 500); 8 Nov 2007 02:56:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80392 invoked by uid 99); 8 Nov 2007 02:56:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 18:56:51 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 02:56:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IpxZH-0006dn-MN
	for java-user@lucene.apache.org; Wed, 07 Nov 2007 18:56:31 -0800
Message-ID: <13640495.post@talk.nabble.com>
Date: Wed, 7 Nov 2007 18:56:31 -0800 (PST)
From: sumittyagi <ping.sumit@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: how can i store lucene results from a webpage to a oracle
 database
In-Reply-To: <6e3ae6310711071830re8902d2g2383c55eb7fdf57c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: ping.sumit@gmail.com
References: <13639399.post@talk.nabble.com> <6e3ae6310711071830re8902d2g2383c55eb7fdf57c@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


thank you very much for the answer..
actually i am trying to make a project in which i have to rerank the lucene
results.....for that i have to retrieve the results from the results page
store them into a database and then after some manupulation to the pages ,
again i have to display the pages in some other order , as they were
displayed before, in short i have to do the reranking of pages ....after
manupulating them.....
for that i think the first step is to retrieve the results(hyperlinks) from
the lucene results page and store them into database.......that's what i was
asking like....how should i start with ..to do that....
thanks
Sumit Tyagi

Chris Lu wrote:
> 
> Very confused of your requirements.
> 
> Do you mean to search on Lucene and store the results in database? Sounds
> you can do it easily via a JDBC call, and not really related to Lucene.
> 
> -- 
> Chris Lu
> -------------------------
> Instant Scalable Full-Text Search On Any Database/Application
> site: http://www.dbsight.net
> demo: http://search.dbsight.com
> Lucene Database Search in 3 minutes:
> http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes
> 
> On Nov 7, 2007 4:46 PM, sumittyagi <ping.sumit@gmail.com> wrote:
> 
>>
>> i want to retrieve lucene search results from the web page and want to
>> put
>> them into oracle database through JDBC, and after some manipulation want
>> to
>> display results again after fetching it from database. please help me
>> regarding this...like from where i have to start with... and what exactly
>> i
>> need to do regarding this.
>> --
>> View this message in context:
>> http://www.nabble.com/how-can-i-store-lucene-results-from-a-webpage-to-a-oracle-database-tf4768387.html#a13639399
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/how-can-i-store-lucene-results-from-a-webpage-to-a-oracle-database-tf4768387.html#a13640495
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30917-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 04:35:31 2007
Return-Path: <java-user-return-30917-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29737 invoked from network); 8 Nov 2007 04:35:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 04:35:29 -0000
Received: (qmail 54851 invoked by uid 500); 8 Nov 2007 04:35:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54818 invoked by uid 500); 8 Nov 2007 04:35:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54807 invoked by uid 99); 8 Nov 2007 04:35:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 20:35:10 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [203.217.22.128] (HELO file1.syd.nuix.com.au) (203.217.22.128)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 04:35:48 +0000
Received: from host68.syd.nuix.com.au (host68.syd.nuix.com.au [192.168.222.68])
	by file1.syd.nuix.com.au (Postfix) with ESMTP id A19C24A823E
	for <java-user@lucene.apache.org>; Thu,  8 Nov 2007 15:33:33 +1100 (EST)
From: Daniel Noll <daniel@nuix.com>
To: java-user@lucene.apache.org
Subject: Re: How to check which field contains Term
Date: Thu, 8 Nov 2007 15:30:43 +1100
User-Agent: KMail/1.9.7
References: <f9b40aaa0711070741j16bad167w4d04522212364aa8@mail.gmail.com>
In-Reply-To: <f9b40aaa0711070741j16bad167w4d04522212364aa8@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711081530.44047.daniel@nuix.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On Thursday 08 November 2007 02:41:50 Lukasz Rzeszotarski wrote:
> I must write application, where client wants to make very complex query,
> like:
> find word "blabla" in (Content_1 OR Content_2) AND (...) AND (...).......
> and as a result he expectes not only documents, but also  information in
> which Content_X
> was it founded.
>
> Can lucene manage with it ?

Query#explain can probably help.  It gives you back a tree of explanations 
describing which parts of the query tree matched a given document.

Daniel

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30918-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 05:45:29 2007
Return-Path: <java-user-return-30918-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45064 invoked from network); 8 Nov 2007 05:45:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 05:45:29 -0000
Received: (qmail 8536 invoked by uid 500); 8 Nov 2007 05:45:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8507 invoked by uid 500); 8 Nov 2007 05:45:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8496 invoked by uid 99); 8 Nov 2007 05:45:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Nov 2007 21:45:10 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 64.233.170.189 as permitted sender)
Received: from [64.233.170.189] (HELO rn-out-0102.google.com) (64.233.170.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 05:45:12 +0000
Received: by rn-out-0102.google.com with SMTP id v46so40231rnb
        for <java-user@lucene.apache.org>; Wed, 07 Nov 2007 21:44:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=i423rxhUCRZtcesdh+FecFbKOlcWN5HWyRqpxVzKcxQ=;
        b=jBaM5hFrTveBoHwzHqU38UR0CmAqTbR08sb19LMMO/qifKFB4L4lfxfM1CsETI3ym1auC7m+1gEiboOMhDN3+3+XDX7BwCrNs5Fxa0WT6g1fu9g8DBXvPUQk7MSxTLbPZF1ECq0jBaZwOdHF7XRh6NNbG0MCCPk0ASSk+V6QAHQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=sLO3gYHhBb98NCoQbIvFmQBr59LcUI6EtKbVYmxjH//y5BSsQYoUCSqlgkwAYqTy9vnAn2T0uaP1RNHibIJb0E8LC/jLi0pFQuCADopgGw+qbeILbDL43tzOCOrwdQqk6DQLSepGaToRuIJE8HP2kRTQm8ZBNgyQuw54TtU49gk=
Received: by 10.78.177.3 with SMTP id z3mr111196hue.1194500689722;
        Wed, 07 Nov 2007 21:44:49 -0800 (PST)
Received: by 10.78.140.9 with HTTP; Wed, 7 Nov 2007 21:44:49 -0800 (PST)
Message-ID: <6e3ae6310711072144r4a6a6468nd54b5cc9333e4bd4@mail.gmail.com>
Date: Wed, 7 Nov 2007 21:44:49 -0800
From: "Chris Lu" <chris.lu@gmail.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Subject: why Term variable text can not be interned?
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_41621_19019174.1194500689695"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_41621_19019174.1194500689695
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

In Term object, there are variables "field" and "text".
My question is, why variable "text" can not be intern() ?

Wouldn't it save some memory, especially in the FieldCache?

-- 
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes:
http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes

------=_Part_41621_19019174.1194500689695--

From java-user-return-30919-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 09:38:22 2007
Return-Path: <java-user-return-30919-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30771 invoked from network); 8 Nov 2007 09:38:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 09:38:22 -0000
Received: (qmail 93045 invoked by uid 500); 8 Nov 2007 09:38:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92604 invoked by uid 500); 8 Nov 2007 09:38:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92593 invoked by uid 99); 8 Nov 2007 09:38:03 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 01:38:03 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [213.133.51.241] (HELO mail.hippo.nl) (213.133.51.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 09:38:36 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: how can i store lucene results from a webpage to a oracle database
Date: Thu, 8 Nov 2007 10:37:41 +0100
Message-ID: <F8E386B54CE3E6408F3A32ABB9A7908A347D72@hai02.hippointern.lan>
In-Reply-To: <13640495.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: how can i store lucene results from a webpage to a oracle database
Thread-Index: Acghsw0ax0jTrHp0Qm2Ezm6nT/8vygAN3O7g
References: <13639399.post@talk.nabble.com> <6e3ae6310711071830re8902d2g2383c55eb7fdf57c@mail.gmail.com> <13640495.post@talk.nabble.com>
From: "Ard Schrijvers" <a.schrijvers@hippo.nl>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

I suppose you have for about 5 minutes to display a single search ? :-)

Perhaps before pointing out your possible solutions, you might better
start describing your functional requirements, because your suggested
solution is headed for problems. So you need custom ordering, check out
lucene scoring and see if you can hook it in there. First gathering
*all* results, store *all* of them in a database, and do some new
ordering is like....pretty horrible :-)

Regards Ard

>=20
> thank you very much for the answer..
> actually i am trying to make a project in which i have to=20
> rerank the lucene results.....for that i have to retrieve the=20
> results from the results page store them into a database and=20
> then after some manupulation to the pages , again i have to=20
> display the pages in some other order , as they were=20
> displayed before, in short i have to do the reranking of=20
> pages ....after manupulating them.....
> for that i think the first step is to retrieve the=20
> results(hyperlinks) from the lucene results page and store=20
> them into database.......that's what i was asking like....how=20
> should i start with ..to do that....
> thanks
> Sumit Tyagi
>=20
> Chris Lu wrote:
> >=20
> > Very confused of your requirements.
> >=20
> > Do you mean to search on Lucene and store the results in database?=20
> > Sounds you can do it easily via a JDBC call, and not really=20
> related to Lucene.
> >=20
> > --
> > Chris Lu
> > -------------------------
> > Instant Scalable Full-Text Search On Any Database/Application
> > site: http://www.dbsight.net
> > demo: http://search.dbsight.com
> > Lucene Database Search in 3 minutes:
> >=20
> =
http://wiki.dbsight.com/index.php?title=3DCreate_Lucene_Database_Search_
> > in_3_minutes
> >=20
> > On Nov 7, 2007 4:46 PM, sumittyagi <ping.sumit@gmail.com> wrote:
> >=20
> >>
> >> i want to retrieve lucene search results from the web page=20
> and want=20
> >> to put them into oracle database through JDBC, and after some=20
> >> manipulation want to display results again after fetching it from=20
> >> database. please help me regarding this...like from where=20
> i have to=20
> >> start with... and what exactly i need to do regarding this.
> >> --
> >> View this message in context:
> >>=20
> http://www.nabble.com/how-can-i-store-lucene-results-from-a-webpage-t
> >> o-a-oracle-database-tf4768387.html#a13639399
> >> Sent from the Lucene - Java Users mailing list archive at=20
> Nabble.com.
> >>
> >>
> >>=20
> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >=20
> >=20
>=20
> --
> View this message in context:=20
> http://www.nabble.com/how-can-i-store-lucene-results-from-a-we
> bpage-to-a-oracle-database-tf4768387.html#a13640495
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30920-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 10:56:34 2007
Return-Path: <java-user-return-30920-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48346 invoked from network); 8 Nov 2007 10:56:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 10:56:34 -0000
Received: (qmail 72341 invoked by uid 500); 8 Nov 2007 10:56:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72321 invoked by uid 500); 8 Nov 2007 10:56:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72310 invoked by uid 99); 8 Nov 2007 10:56:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 02:56:15 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 72.14.202.180 as permitted sender)
Received: from [72.14.202.180] (HELO ro-out-1112.google.com) (72.14.202.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 10:56:19 +0000
Received: by ro-out-1112.google.com with SMTP id k4so1822227rog
        for <java-user@lucene.apache.org>; Thu, 08 Nov 2007 02:55:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=+DAR/oJt7UHFTYLv5uT7anUIpgwkSl6ZPYV0M8GI0EE=;
        b=qcU0zflxcU0FmVyCKQtnEwOFdVJviU66ugIl7hxXVDnY2UJtV2x0ZTdZVQh2i2wMot+xAK+1uGzADADDspQdMiga4atgTccHMYlUvuvKGmy96s58BL9bAZ0yB9IKgXxBYklatCnh1rWAiwzvnSkpHjLrYxxjJmeCo+/iYKlpBoM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=gbaoD10epsPqyaHTksHl/dJzWI5cfprhb51SVtB8it43RP4XLMbaIpRhLv86kmo5iG0orr4dVlvM0hZU9tQPOXDjIQS00h11ThAhu6GuzvEoS8djQqPT94qRNRIqxOLXqwi9ptwVYK/eDX4KWpNy/vSgj6BI3cF3In3BV93zPn8=
Received: by 10.142.252.11 with SMTP id z11mr41731wfh.1194519357586;
        Thu, 08 Nov 2007 02:55:57 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Thu, 8 Nov 2007 02:55:57 -0800 (PST)
Message-ID: <c68e39170711080255m5f724689oe5e18d8bfe0bca4e@mail.gmail.com>
Date: Thu, 8 Nov 2007 05:55:57 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: why Term variable text can not be interned?
In-Reply-To: <6e3ae6310711072144r4a6a6468nd54b5cc9333e4bd4@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <6e3ae6310711072144r4a6a6468nd54b5cc9333e4bd4@mail.gmail.com>
X-Google-Sender-Auth: 0ed98bee39b5af89
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 8, 2007 12:44 AM, Chris Lu <chris.lu@gmail.com> wrote:
> In Term object, there are variables "field" and "text".
> My question is, why variable "text" can not be intern() ?
>
> Wouldn't it save some memory, especially in the FieldCache?

The FieldCache already stores only one string per term, regardless of
how many documents contain that term.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30921-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 11:33:22 2007
Return-Path: <java-user-return-30921-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58471 invoked from network); 8 Nov 2007 11:33:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 11:33:22 -0000
Received: (qmail 12545 invoked by uid 500); 8 Nov 2007 11:33:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12509 invoked by uid 500); 8 Nov 2007 11:33:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12498 invoked by uid 99); 8 Nov 2007 11:33:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 03:33:04 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 11:33:07 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 88D304698C
	for <java-user@lucene.apache.org>; Thu,  8 Nov 2007 06:32:46 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Thu, 08 Nov 2007 06:32:46 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 639263F862; Thu,  8 Nov 2007 06:32:46 -0500 (EST)
Message-Id: <1194521566.7378.1220216811@webmail.messagingengine.com>
X-Sasl-Enc: GXiYhWrDodgDcDcFv9Tx0SiE3yfe8iLGwbC4EMa15LWU 1194521566
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <4731BBF4.4060409@fredhopper.com>
Subject: Re: - possible bug in lock timeout
In-Reply-To: <4731BBF4.4060409@fredhopper.com>
Date: Thu, 08 Nov 2007 06:32:46 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


OK, I've opened https://issues.apache.org/jira/browse/LUCENE-1048 to this issue.

Thanks Nikolay!

Mike

"Nikolay Diakov" <nikolay.diakov@fredhopper.com> wrote:
> In Lucene 2.x, in method Lock#obtain(long lockWaitTimeout) I see the 
> following line:
> 
> int maxSleepCount = (int)(lockWaitTimeout / LOCK_POLL_INTERVAL);
> 
> Since I wanted to set the lock timeout to the largest possible, I called 
> the IndexWriter#setDefaultWriteLockTimeout(Long.MAX_VALUE). This 
> produces the effect in the quoted line that we get maxSleepCount a 
> negative number.
> 
> Is this intended?
> 
> Cheers,
>    Nik
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30922-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 12:19:32 2007
Return-Path: <java-user-return-30922-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77740 invoked from network); 8 Nov 2007 12:19:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 12:19:32 -0000
Received: (qmail 67384 invoked by uid 500); 8 Nov 2007 12:19:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67140 invoked by uid 500); 8 Nov 2007 12:19:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67127 invoked by uid 99); 8 Nov 2007 12:19:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 04:19:13 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [136.173.62.228] (HELO SMTP15.europarl.europa.eu) (136.173.62.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 12:19:16 +0000
Received: from EMAILLUXSV33.ep.parl.union.eu (unverified) by SMTP15.europarl.europa.eu
 (European Parliament) with ESMTP id <T832bd282db88ad3ee4173c@SMTP15.europarl.europa.eu> for <java-user@lucene.apache.org>;
 Thu, 8 Nov 2007 13:18:52 +0100
x-mimeole: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C82201.8700A772"
Subject: Sorting with MultiSearcher
Date: Thu, 8 Nov 2007 13:18:53 +0100
Message-ID: <E2BB1A5AB9C4BD409420F3C9E9A6914416DF2D@EMAILLUXSV33.ep.parl.union.eu>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Sorting with MultiSearcher
Thread-Index: AcgiAYjFTfuHJRuHS1it0abZBFRoRQ==
From: "WATHELET Thomas" <thomas.wathelet@europarl.europa.eu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C82201.8700A772
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi,
I have few Indexes with the same structure.
I'm using MultiSearcher to search into those indexes and when I try to
sort the result by field the result is sort by field and by index (we
have all results from index1 and then index2,...) but I would like to
have the result sorted on the all resultset
Is it possible?
Piece of code i'm using to do it:
Sort sort =3D new Sort(new SortField(field, SortField.STRING,
orderDirect));

MultiSearcher search=3D...

Hits hit =3D searcher.search(query, sort);

Thanks in advence.


------_=_NextPart_001_01C82201.8700A772--

From java-user-return-30923-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 12:22:59 2007
Return-Path: <java-user-return-30923-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79746 invoked from network); 8 Nov 2007 12:22:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 12:22:59 -0000
Received: (qmail 71238 invoked by uid 500); 8 Nov 2007 12:22:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71198 invoked by uid 500); 8 Nov 2007 12:22:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71182 invoked by uid 99); 8 Nov 2007 12:22:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 04:22:41 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 209.85.132.242 as permitted sender)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 12:22:44 +0000
Received: by an-out-0708.google.com with SMTP id d11so19546and
        for <java-user@lucene.apache.org>; Thu, 08 Nov 2007 04:22:24 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=4wjjN2zRv6iLZQxX7uiw70Ofv6AD9GGp2xmFCwsvCNU=;
        b=d1syMXU+om2NW3783wz1kxyiS8X/UiMEVY1J/a8rvCJVjEkzLmW0qMmek4yPUbbVWDPl+btuIu1usIageeXIcjLtHb8VtFVjkEEQjGo68hJo0u7lN1bONpwtkDiodH89O3Mndu2qbjyfA4ifP56ZActq+CQq0WjYEO3aGnIzUjc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=G68N5nW+hwTixk/IY2JcxZ2yClc6hce16s+QuRE8sBWlx6rWQqUxloZbrrc0SzhgpKq/elG99BbzNNNgJyD/20Klr//1gP+2e2OpE2d3FE3FHANWvupG33MIlXG6/eok/7ztzup9S9MlTufvy8A4z5VrP9n+yDoBMfRy3pzYE4o=
Received: by 10.100.94.14 with SMTP id r14mr612674anb.1194524543862;
        Thu, 08 Nov 2007 04:22:23 -0800 (PST)
Received: from ?192.168.1.103? ( [69.124.234.183])
        by mx.google.com with ESMTPS id 61sm454245wry.2007.11.08.04.22.20
        (version=SSLv3 cipher=RC4-MD5);
        Thu, 08 Nov 2007 04:22:21 -0800 (PST)
Message-ID: <4732FF76.908@gmail.com>
Date: Thu, 08 Nov 2007 07:22:14 -0500
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: Sorting with MultiSearcher
References: <E2BB1A5AB9C4BD409420F3C9E9A6914416DF2D@EMAILLUXSV33.ep.parl.union.eu>
In-Reply-To: <E2BB1A5AB9C4BD409420F3C9E9A6914416DF2D@EMAILLUXSV33.ep.parl.union.eu>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Any other info or code snippets? I sort on multisearchers all the time 
and have never seen that behavior.

- Mark (sorting on multisearchers since Lucene 1.4 <g>)

WATHELET Thomas wrote:
> Hi,
> I have few Indexes with the same structure.
> I'm using MultiSearcher to search into those indexes and when I try to
> sort the result by field the result is sort by field and by index (we
> have all results from index1 and then index2,...) but I would like to
> have the result sorted on the all resultset
> Is it possible?
> Piece of code i'm using to do it:
> Sort sort = new Sort(new SortField(field, SortField.STRING,
> orderDirect));
>
> MultiSearcher search=...
>
> Hits hit = searcher.search(query, sort);
>
> Thanks in advence.
>
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30924-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 13:34:53 2007
Return-Path: <java-user-return-30924-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96035 invoked from network); 8 Nov 2007 13:34:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 13:34:53 -0000
Received: (qmail 43759 invoked by uid 500); 8 Nov 2007 13:34:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42811 invoked by uid 500); 8 Nov 2007 13:34:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42800 invoked by uid 99); 8 Nov 2007 13:34:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 05:34:34 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [17.148.16.79] (HELO smtpoutm.mac.com) (17.148.16.79)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 13:34:36 +0000
Received: from mac.com (asmtp001-s [10.150.69.64])
	by smtpoutm.mac.com (Xserve/smtpout016/MantshX 4.0) with ESMTP id lA8DYFGQ007973
	for <java-user@lucene.apache.org>; Thu, 8 Nov 2007 05:34:15 -0800 (PST)
Received: from [10.0.1.198] (va-71-53-212-231.dhcp.embarqhsd.net [71.53.212.231])
	(authenticated bits=0)
	by mac.com (Xserve/asmtp001/MantshX 4.0) with ESMTP id lA8DX4VN020260
	for <java-user@lucene.apache.org>; Thu, 8 Nov 2007 05:34:14 -0800 (PST)
Mime-Version: 1.0 (Apple Message framework v752.3)
Content-Transfer-Encoding: 7bit
Message-Id: <439B1C16-0FFF-4655-A148-B9E9E4B264C8@mac.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: java-user@lucene.apache.org
From: Michael Prichard <michael_prichard@mac.com>
Subject: Office 2007
Date: Thu, 8 Nov 2007 08:37:15 -0500
X-Mailer: Apple Mail (2.752.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

I know this has gone around a bit but anyone had any success with  
pulling text from Office 2007 files?  Any recommendations?

Thanks,
Michael

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30925-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 14:10:20 2007
Return-Path: <java-user-return-30925-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7715 invoked from network); 8 Nov 2007 14:10:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 14:10:20 -0000
Received: (qmail 88255 invoked by uid 500); 8 Nov 2007 14:10:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88212 invoked by uid 500); 8 Nov 2007 14:10:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88201 invoked by uid 99); 8 Nov 2007 14:10:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 06:10:01 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.119] (HELO spunkymail-a15.g.dreamhost.com) (208.97.132.119)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 14:10:36 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a15.g.dreamhost.com (Postfix) with ESMTP id 5D5DE7F017
	for <java-user@lucene.apache.org>; Thu,  8 Nov 2007 06:09:39 -0800 (PST)
Message-Id: <DE132446-BF66-4C8D-B6BC-9D6C89EA1552@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <439B1C16-0FFF-4655-A148-B9E9E4B264C8@mac.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Office 2007
Date: Thu, 8 Nov 2007 09:09:38 -0500
References: <439B1C16-0FFF-4655-A148-B9E9E4B264C8@mac.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

You might also consider asking on the Tika (a Lucene subproject  
currently in Incubation) and Aperture project sites (http://aperture.sourceforge.net 
).  Not sure if you will have any luck, but they are also focused on  
the extraction problem and may have thought more about it.

-Grant

On Nov 8, 2007, at 8:37 AM, Michael Prichard wrote:

> Hello,
>
> I know this has gone around a bit but anyone had any success with  
> pulling text from Office 2007 files?  Any recommendations?
>
> Thanks,
> Michael
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30926-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 14:20:50 2007
Return-Path: <java-user-return-30926-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10559 invoked from network); 8 Nov 2007 14:20:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 14:20:50 -0000
Received: (qmail 9751 invoked by uid 500); 8 Nov 2007 14:20:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9727 invoked by uid 500); 8 Nov 2007 14:20:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9716 invoked by uid 99); 8 Nov 2007 14:20:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 06:20:31 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [136.173.62.228] (HELO SMTP15.europarl.europa.eu) (136.173.62.228)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 14:20:34 +0000
Received: from EMAILLUXSV33.ep.parl.union.eu (unverified) by SMTP15.europarl.europa.eu
 (European Parliament) with ESMTP id <T832c4192ae88ad3ee4173c@SMTP15.europarl.europa.eu>;
 Thu, 8 Nov 2007 15:20:10 +0100
x-mimeole: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Sorting with MultiSearcher
Date: Thu, 8 Nov 2007 15:20:12 +0100
Message-ID: <E2BB1A5AB9C4BD409420F3C9E9A6914416DF30@EMAILLUXSV33.ep.parl.union.eu>
In-Reply-To: <4732FF76.908@gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Sorting with MultiSearcher
Thread-Index: AcgiAh/3zNWBaY/ERAOytCGZXDTdtQAD9Bgw
References: <E2BB1A5AB9C4BD409420F3C9E9A6914416DF2D@EMAILLUXSV33.ep.parl.union.eu> <4732FF76.908@gmail.com>
From: "WATHELET Thomas" <thomas.wathelet@europarl.europa.eu>
To: <java-user@lucene.apache.org>
Cc: <markrmiller@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I'm using Lucene core 2.2.0
The field i'm trying to sort is not presente in each documents into the
index. I add the field only if I have a metadata for it
Maybee it's the problem?
My field is untokenized store and indexed.=20

-----Original Message-----
From: Mark Miller [mailto:markrmiller@gmail.com]=20
Sent: 08 November 2007 13:22
To: java-user@lucene.apache.org
Subject: Re: Sorting with MultiSearcher

Any other info or code snippets? I sort on multisearchers all the time=20
and have never seen that behavior.

- Mark (sorting on multisearchers since Lucene 1.4 <g>)

WATHELET Thomas wrote:
> Hi,
> I have few Indexes with the same structure.
> I'm using MultiSearcher to search into those indexes and when I try to
> sort the result by field the result is sort by field and by index (we
> have all results from index1 and then index2,...) but I would like to
> have the result sorted on the all resultset
> Is it possible?
> Piece of code i'm using to do it:
> Sort sort =3D new Sort(new SortField(field, SortField.STRING,
> orderDirect));
>
> MultiSearcher search=3D...
>
> Hits hit =3D searcher.search(query, sort);
>
> Thanks in advence.
>
>
>  =20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30927-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 15:05:06 2007
Return-Path: <java-user-return-30927-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35402 invoked from network); 8 Nov 2007 15:05:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 15:05:05 -0000
Received: (qmail 13145 invoked by uid 500); 8 Nov 2007 15:04:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12452 invoked by uid 500); 8 Nov 2007 15:04:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12441 invoked by uid 99); 8 Nov 2007 15:04:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 07:04:46 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of jmuguruza@gmail.com designates 66.249.90.180 as permitted sender)
Received: from [66.249.90.180] (HELO ik-out-1112.google.com) (66.249.90.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 15:04:46 +0000
Received: by ik-out-1112.google.com with SMTP id c28so101461ika
        for <java-user@lucene.apache.org>; Thu, 08 Nov 2007 07:04:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=djWrk+DoWQDGYhUNQGOx+K2vCfXF6Yv5zN11WMNxhOM=;
        b=S6hCLgzIu4BG4pCXJhLCEL0sq6ILvw4/KGblqntQs8XucKgvYvsD00SvUTOGnY5Z23Z2POeRxvYmieF4u47+9XoDVSPFeZOlksZdlQ1Xvpx/X0ATjJr8JSoFPZqQwJrDE2LmCLVOwMv25QLGIMLv3JEHYaIRGkK8LgsNsXzAKKI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=dJujVXHkaQSNeAmKdJs2qXByhm0v82D3V/vrTEDzyl5uI0n1a7UA/QoT/D9dwo5YEvop+YvbygHfMOhNsk7Obkjmd1mdskufAWbdmtz18DfToAuvzn4QDHCq78sN4FMz6/aniFRKzIw+ZJ0XR1mQFJko8AsFHwPzPjrdeFmTe8g=
Received: by 10.142.108.14 with SMTP id g14mr134978wfc.1194534259317;
        Thu, 08 Nov 2007 07:04:19 -0800 (PST)
Received: by 10.142.161.8 with HTTP; Thu, 8 Nov 2007 07:04:19 -0800 (PST)
Message-ID: <f071061b0711080704q1cd69ba0m9399433867f5be8d@mail.gmail.com>
Date: Thu, 8 Nov 2007 16:04:19 +0100
From: jm <jmuguruza@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Office 2007
In-Reply-To: <DE132446-BF66-4C8D-B6BC-9D6C89EA1552@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <439B1C16-0FFF-4655-A148-B9E9E4B264C8@mac.com>
	 <DE132446-BF66-4C8D-B6BC-9D6C89EA1552@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

I havent upgraded yet but I think I read in the aperture list that
they already had some extractors for some office 2007 stuff in trunk
some ago.

On Nov 8, 2007 3:09 PM, Grant Ingersoll <gsingers@apache.org> wrote:
> You might also consider asking on the Tika (a Lucene subproject
> currently in Incubation) and Aperture project sites (http://aperture.sourceforge.net
> ).  Not sure if you will have any luck, but they are also focused on
> the extraction problem and may have thought more about it.
>
> -Grant
>
>
> On Nov 8, 2007, at 8:37 AM, Michael Prichard wrote:
>
> > Hello,
> >
> > I know this has gone around a bit but anyone had any success with
> > pulling text from Office 2007 files?  Any recommendations?
> >
> > Thanks,
> > Michael
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Boot Camp Training:
> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30928-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 15:44:45 2007
Return-Path: <java-user-return-30928-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55350 invoked from network); 8 Nov 2007 15:44:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 15:44:45 -0000
Received: (qmail 988 invoked by uid 500); 8 Nov 2007 15:44:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 947 invoked by uid 500); 8 Nov 2007 15:44:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 936 invoked by uid 99); 8 Nov 2007 15:44:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 07:44:26 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [17.148.16.77] (HELO smtpoutm.mac.com) (17.148.16.77)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 15:45:01 +0000
Received: from mac.com (asmtp010-s [10.150.69.73])
	by smtpoutm.mac.com (Xserve/smtpout014/MantshX 4.0) with ESMTP id lA8Fi3GP027655
	for <java-user@lucene.apache.org>; Thu, 8 Nov 2007 07:44:03 -0800 (PST)
Received: from [10.0.1.198] (va-71-53-212-231.dhcp.embarqhsd.net [71.53.212.231])
	(authenticated bits=0)
	by mac.com (Xserve/asmtp010/MantshX 4.0) with ESMTP id lA8Fi0eB015406
	for <java-user@lucene.apache.org>; Thu, 8 Nov 2007 07:44:01 -0800 (PST)
Mime-Version: 1.0 (Apple Message framework v752.3)
In-Reply-To: <f071061b0711080704q1cd69ba0m9399433867f5be8d@mail.gmail.com>
References: <439B1C16-0FFF-4655-A148-B9E9E4B264C8@mac.com> <DE132446-BF66-4C8D-B6BC-9D6C89EA1552@apache.org> <f071061b0711080704q1cd69ba0m9399433867f5be8d@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <B3F57D98-8C8D-49F2-967D-EDE418609ED1@mac.com>
Content-Transfer-Encoding: 7bit
From: Michael Prichard <michael_prichard@mac.com>
Subject: Re: Office 2007
Date: Thu, 8 Nov 2007 10:47:02 -0500
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.752.3)
X-Virus-Checked: Checked by ClamAV on apache.org

What about http://www.openxml4j.org/?  Any experience there?

On Nov 8, 2007, at 10:04 AM, jm wrote:

> I havent upgraded yet but I think I read in the aperture list that
> they already had some extractors for some office 2007 stuff in trunk
> some ago.
>
> On Nov 8, 2007 3:09 PM, Grant Ingersoll <gsingers@apache.org> wrote:
>> You might also consider asking on the Tika (a Lucene subproject
>> currently in Incubation) and Aperture project sites (http:// 
>> aperture.sourceforge.net
>> ).  Not sure if you will have any luck, but they are also focused on
>> the extraction problem and may have thought more about it.
>>
>> -Grant
>>
>>
>> On Nov 8, 2007, at 8:37 AM, Michael Prichard wrote:
>>
>>> Hello,
>>>
>>> I know this has gone around a bit but anyone had any success with
>>> pulling text from Office 2007 files?  Any recommendations?
>>>
>>> Thanks,
>>> Michael
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> --------------------------
>> Grant Ingersoll
>> http://lucene.grantingersoll.com
>>
>> Lucene Boot Camp Training:
>> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http:// 
>> www.apachecon.com
>>
>> Lucene Helpful Hints:
>> http://wiki.apache.org/lucene-java/BasicsOfPerformance
>> http://wiki.apache.org/lucene-java/LuceneFAQ
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30929-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 17:36:12 2007
Return-Path: <java-user-return-30929-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93570 invoked from network); 8 Nov 2007 17:36:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 17:36:11 -0000
Received: (qmail 36095 invoked by uid 500); 8 Nov 2007 17:35:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36070 invoked by uid 500); 8 Nov 2007 17:35:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36059 invoked by uid 99); 8 Nov 2007 17:35:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 09:35:52 -0800
X-ASF-Spam-Status: No, hits=1.0 required=10.0
	tests=FUZZY_AMBIEN,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.181.193.4] (HELO drutten.citerus.net) (62.181.193.4)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 17:35:55 +0000
Received: from drutten.citerus.net ([62.181.193.4]) by drutten.citerus.net
 ([62.181.193.4]) with mapi; Thu, 8 Nov 2007 18:34:37 +0100
From: Tobias Hill <Tobias.Hill@citerus.se>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 8 Nov 2007 18:34:37 +0100
Subject: OutOfMemory-problems with SortComparatorSource / ScoreDocComparator
Thread-Topic: OutOfMemory-problems with SortComparatorSource /
 ScoreDocComparator
Thread-Index: AQHIIi2i6rLlgrBdCEeFQkp1e4lWdA==
Message-ID: <BBD1371A36A8D8458F94E4AC71DBEC051588DCA30A@drutten.citerus.net>
Accept-Language: sv-SE, en-US
Content-Language: sv-SE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: sv-SE, en-US
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

We have implemented a custom sort following the pattern in Lucene in Action=
.
Unfortunately this has led to quite serious memory problems. When analyzing
those (with a profiler) it seems that there are as many remaining instances=
 of
our SortComparatorSource as there have been queries against the index.
Moreover, it seems that those are held by only one reference (per instance)
coming from some cache:ish feature of lucene itself.

Caching does not make sense for our comparator ... and if it has to be this
way (for a reason or other) it seems reasonable that the cache dropped the
reference if available memory is getting low so that gc could do it's thing=
. Right?

When digging a bit deeper this also seems to be the intention, since I see
WeakHashMap entries in the reference chain. This leaves me puzzled. Why
are not our instances retained when there is only one incoming reference.
Weak as it seems too.

I would be very thankful if anyone could spot why this custom sorter just
piles up in the cache. See below.

Best regards,
Tobias



/**
 * The BlendSorter can sort on any lucene field and blend its value
 * with the document-score. The blend can be configured.
 */
public class BlendSorter implements SortComparatorSource {

    private final static Log log =3D LogFactory.getLog(BlendSorter.class);
    private FieldConverter fieldConverter;
    private float blendFactor;

    /**
     * Constructs a BlendSorter
     * @param fieldConverter    The converter to use wen converting the luc=
ent field
     * @param blendFactor       The factor to blend (0 means 0% fieldvalue =
and 100%
     *                          document-score, 1 means 100% fieldvalue and=
 0% document-score).
     */
    public BlendSorter(FieldConverter fieldConverter, float blendFactor) {
        this.fieldConverter =3D fieldConverter;
        this.blendFactor =3D blendFactor;
    }

    public ScoreDocComparator newComparator(final IndexReader indexReader, =
final String field) throws IOException {
        return new ScoreDocComparator() {
            Map<Integer, Float> values =3D new HashMap<Integer, Float>();

            public int compare(ScoreDoc scoreDoc1, ScoreDoc scoreDoc2) {
                try {
                    Float v1 =3D getValue(scoreDoc1, indexReader, field);
                    Float v2 =3D getValue(scoreDoc2, indexReader, field);
                    return v2.compareTo(v1);

                } catch (IOException e) {
                    log.error("Cannot read doc", e);
                }
                return 0;
            }

            public Comparable sortValue(ScoreDoc scoreDoc) {
                return values.get(scoreDoc.doc);
            }

            public int sortType() {
                return SortField.FLOAT;
            }


            // lazily get values, and store them in our value-map
            private Float getValue(ScoreDoc scoreDoc, IndexReader indexRead=
er, String field) throws IOException {
                Float value =3D values.get(scoreDoc.doc);
                if (value !=3D null) return value;
                final Document doc =3D indexReader.document(scoreDoc.doc);
                float fieldValue =3D fieldConverter.get(doc.get(field));
                float queryValue =3D scoreDoc.score;
                value =3D blendFactor * fieldValue + (1 - blendFactor) * qu=
eryValue;
                values.put(scoreDoc.doc, value);
                return value;
            }
        };
    }

}



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30930-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 08 20:30:54 2007
Return-Path: <java-user-return-30930-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10949 invoked from network); 8 Nov 2007 20:30:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 8 Nov 2007 20:30:54 -0000
Received: (qmail 51598 invoked by uid 500); 8 Nov 2007 20:30:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51564 invoked by uid 500); 8 Nov 2007 20:30:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51553 invoked by uid 99); 8 Nov 2007 20:30:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 12:30:35 -0800
X-ASF-Spam-Status: No, hits=1.0 required=10.0
	tests=FUZZY_AMBIEN,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [62.181.193.4] (HELO drutten.citerus.net) (62.181.193.4)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 20:30:35 +0000
Received: from drutten.citerus.net ([62.181.193.4]) by drutten.citerus.net
 ([62.181.193.4]) with mapi; Thu, 8 Nov 2007 21:29:17 +0100
From: Tobias Hill <Tobias.Hill@citerus.se>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Thu, 8 Nov 2007 21:28:27 +0100
Subject: SV: OutOfMemory-problems with SortComparatorSource /
 ScoreDocComparator
Thread-Topic: OutOfMemory-problems with SortComparatorSource /
 ScoreDocComparator
Thread-Index: AcgiLbokEVWECphNS8KYvuqkiGHeoQAGDFhM
Message-ID: <BBD1371A36A8D8458F94E4AC71DBEC051588DCA30B@drutten.citerus.net>
References: <BBD1371A36A8D8458F94E4AC71DBEC051588DCA30A@drutten.citerus.net>
In-Reply-To: <BBD1371A36A8D8458F94E4AC71DBEC051588DCA30A@drutten.citerus.net>
Accept-Language: sv-SE, en-US
Content-Language: sv-SE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: sv-SE, en-US
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Tobias,

I had the similar problem with lucene custom sorting about two years ago.

Please take a look at these two email threads:
http://www.gossamer-threads.com/lists/lucene/java-dev/39100
http://www.gossamer-threads.com/lists/lucene/java-user/38016

It seems like they did not make any patch for this problem since then.
But you could do it yourself - check one of the threads above, there
is small patch that force lucene to not cache in case of Custom
sorting.

P.S. I'm not subscribed (just checking RSS), so you could repost it to
mailing list.

Hope it helps,
Alex



________________________________________
Fr=E5n: Tobias Hill [Tobias.Hill@citerus.se]
Skickat: den 8 november 2007 18:34
Till: java-user@lucene.apache.org
=C4mne: OutOfMemory-problems with SortComparatorSource / ScoreDocComparator

Hi,

We have implemented a custom sort following the pattern in Lucene in Action=
.
Unfortunately this has led to quite serious memory problems. When analyzing
those (with a profiler) it seems that there are as many remaining instances=
 of
our SortComparatorSource as there have been queries against the index.
Moreover, it seems that those are held by only one reference (per instance)
coming from some cache:ish feature of lucene itself.

Caching does not make sense for our comparator ... and if it has to be this
way (for a reason or other) it seems reasonable that the cache dropped the
reference if available memory is getting low so that gc could do it's thing=
. Right?

When digging a bit deeper this also seems to be the intention, since I see
WeakHashMap entries in the reference chain. This leaves me puzzled. Why
are not our instances retained when there is only one incoming reference.
Weak as it seems too.

I would be very thankful if anyone could spot why this custom sorter just
piles up in the cache. See below.

Best regards,
Tobias



/**
 * The BlendSorter can sort on any lucene field and blend its value
 * with the document-score. The blend can be configured.
 */
public class BlendSorter implements SortComparatorSource {

    private final static Log log =3D LogFactory.getLog(BlendSorter.class);
    private FieldConverter fieldConverter;
    private float blendFactor;

    /**
     * Constructs a BlendSorter
     * @param fieldConverter    The converter to use wen converting the luc=
ent field
     * @param blendFactor       The factor to blend (0 means 0% fieldvalue =
and 100%
     *                          document-score, 1 means 100% fieldvalue and=
 0% document-score).
     */
    public BlendSorter(FieldConverter fieldConverter, float blendFactor) {
        this.fieldConverter =3D fieldConverter;
        this.blendFactor =3D blendFactor;
    }

    public ScoreDocComparator newComparator(final IndexReader indexReader, =
final String field) throws IOException {
        return new ScoreDocComparator() {
            Map<Integer, Float> values =3D new HashMap<Integer, Float>();

            public int compare(ScoreDoc scoreDoc1, ScoreDoc scoreDoc2) {
                try {
                    Float v1 =3D getValue(scoreDoc1, indexReader, field);
                    Float v2 =3D getValue(scoreDoc2, indexReader, field);
                    return v2.compareTo(v1);

                } catch (IOException e) {
                    log.error("Cannot read doc", e);
                }
                return 0;
            }

            public Comparable sortValue(ScoreDoc scoreDoc) {
                return values.get(scoreDoc.doc);
            }

            public int sortType() {
                return SortField.FLOAT;
            }


            // lazily get values, and store them in our value-map
            private Float getValue(ScoreDoc scoreDoc, IndexReader indexRead=
er, String field) throws IOException {
                Float value =3D values.get(scoreDoc.doc);
                if (value !=3D null) return value;
                final Document doc =3D indexReader.document(scoreDoc.doc);
                float fieldValue =3D fieldConverter.get(doc.get(field));
                float queryValue =3D scoreDoc.score;
                value =3D blendFactor * fieldValue + (1 - blendFactor) * qu=
eryValue;
                values.put(scoreDoc.doc, value);
                return value;
            }
        };
    }

}



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30931-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 02:11:44 2007
Return-Path: <java-user-return-30931-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3998 invoked from network); 9 Nov 2007 02:11:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 02:11:44 -0000
Received: (qmail 8791 invoked by uid 500); 9 Nov 2007 02:11:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8751 invoked by uid 500); 9 Nov 2007 02:11:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8740 invoked by uid 99); 9 Nov 2007 02:11:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 18:11:25 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of isaacrc82@gmail.com designates 72.14.202.182 as permitted sender)
Received: from [72.14.202.182] (HELO ro-out-1112.google.com) (72.14.202.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 02:11:26 +0000
Received: by ro-out-1112.google.com with SMTP id k4so2279334rog
        for <java-user@lucene.apache.org>; Thu, 08 Nov 2007 18:11:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=2byt6AJXtukXTqIlrfgAYxuv/I9wVZFQ1L1wbYmv638=;
        b=lo4EZpZ8mzcCRXuG4DIcJk4OTQ562y4oloKcvVv6gesdTcW6/QmIvaridWZ/BmEkz3oHtWNxdFpGPtG/Fw0+lwRAMbf9PxqLo0IYJVNumMOWjG3U5C8R5xz2z6wr7GOdYaU6l1gQHcrq0kjy4AFK/z3DmtXlhpnIyATZgNSm5+g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=dtMmAn1h6AULJV3CS5yK1YHkXgoPsmhzZ2mtu+zjeP02G0QE1wcCqyoRb4bQMzGdMlXQKLKsj0PuJJUfh8cfZAs6o3tMD7sevw/URnSMjzSUd2R0je9QMpUK8Ys/Qd1+4gHdxj8SeDC5M0jtxRzIZ661MKODr498cv42+QvzEWk=
Received: by 10.141.133.14 with SMTP id k14mr691839rvn.1194574263745;
        Thu, 08 Nov 2007 18:11:03 -0800 (PST)
Received: by 10.140.133.6 with HTTP; Thu, 8 Nov 2007 18:11:03 -0800 (PST)
Message-ID: <bf1404350711081811gf7ba89ct193e72f87da0de4a@mail.gmail.com>
Date: Thu, 8 Nov 2007 21:11:03 -0500
From: Ariel <isaacrc82@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to build your custom termfreq vector an add it to the field ?
In-Reply-To: <07472893-A840-4215-A512-8C6A21D7E0D5@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <bf1404350711070949i1a856534p18aac179b7c4d88@mail.gmail.com>
	 <07472893-A840-4215-A512-8C6A21D7E0D5@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Very interesting the link you suggest me Mr Grant Ingersoll.
Let see if I understand how the ranking issue in lucene could be implemented:
1.	First I must create my own query class extending the abstract Query
class. The only method I must implement from this class is toString.
Is right this ???
2.	I must implement inside my own query class the Weight interface
But I really don't understand how this is going to let me change my
ranking scoring.
3 I must implement my custom Scorer ???
I don't know how integrate this. There is a lot of little pieces of
information but not concrete.
Greetings



On Nov 7, 2007 1:48 PM, Grant Ingersoll <gsingers@apache.org> wrote:
> Term Vectors (specifically TermFreqVector) in Lucene are a storage
> mechanism for convenience and applications to use.  They are not an
> integral part of the scoring in the way you may be thinking of them in
> terms of the traditional Vector Space Model, thus there may be some
> confusion from the different usages of that terminology.  If you want
> to see examples of how to implement scorers have a look at classes
> like TermScorer, BoostingTermQuery, and any of the other classes that
> extend Scorer.  You might also find the file formats page (off of the
> Lucene Java website under Documentation) helpful for understanding
> what Lucene stores so that it can do scoring.
>
> There really isn't any tutorial on scoring, as it is not something
> that many people have expressed an interest in or no one has made it a
> high enough priority to write one.  Having written a Scorer (or maybe
> two, I forget) I can give advice on specific things, but I am not sure
> I could write a tutorial that is general enough to be useful at this
> point.
>
> One thought for associating a weight to a given term based on its
> cooccurring terms is to use the new Payload mechanism whereby you can
> store a byte array at each term which can then be used in scoring via
> things like the BoostingTermQuery (or your own implementation.)  If
> that is of interest, you can search the archives for payloads (I also
> think Michael Busch is presenting on Payloads, amongst other things,
> at ApacheCon in Atlanta) and have a look at the BoostingTermQuery.
> There certainly are other PayloadQueries that need to be implemented.
> See the Lucene wiki for some background and details on Payloads as well.
>
> I don't know that it is a big mistake to try this in Lucene.  The
> community hasn't put a huge priority on making altering the innards of
> scoring easier to deal with (if possible), but that doesn't mean we
> are not open to suggestions and patches.    You may find https://issues.apache.org/jira/browse/LUCENE-965
>   to be informative for both the implementation and the discussion of
> things that need to happen to be accepted into Lucene.  This JIRA
> issue specifically attempts to provide Lucene with a new scoring
> mechanism.
>
> You might also have a look at Lemur (http://www.lemurproject.org/)
> which is much more academically focused.
>
> Cheers,
> Grant
>
>
> On Nov 7, 2007, at 12:49 PM, Ariel wrote:
>
> > Then if I want to use another scoring formula I must to implement my
> > own Query/Weigh/Scorer  ? For example instead of cousine distance
> > leiderbage distance or .. another. I'm studying Query/Weigh/Scorer
> > classes to find out how to do that but there is not much documentation
> > about that.
> >
> > I have seen I could change similarity factors extending the simlarity
> > class, but I have not seen any example about changing scoring formula
> > and changing the weight by term in the term vector. Do you know any
> > tutorial about this ?
> >
> > What I want to do changing frecuency in the terms vector is this: for
> > example instead of take the tf term frecuency of the term and stored
> > in the vector I want to consider the correlation of the term with the
> > other terms of the documents and store that measure by term in the
> > vector so later with my custom similarity formula calculate the
> > ranking of a document against a query considering the correlation
> > between terms.
> > Dou you think is a big mistake try to do this with lucene ??? Is
> > there any way ?
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Boot Camp Training:
> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30932-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 03:00:04 2007
Return-Path: <java-user-return-30932-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23399 invoked from network); 9 Nov 2007 03:00:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 03:00:04 -0000
Received: (qmail 46368 invoked by uid 500); 9 Nov 2007 02:59:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46335 invoked by uid 500); 9 Nov 2007 02:59:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46324 invoked by uid 99); 9 Nov 2007 02:59:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Nov 2007 18:59:44 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cedric.ho@gmail.com designates 72.14.204.234 as permitted sender)
Received: from [72.14.204.234] (HELO qb-out-0506.google.com) (72.14.204.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 02:59:48 +0000
Received: by qb-out-0506.google.com with SMTP id e12so1116692qba
        for <java-user@lucene.apache.org>; Thu, 08 Nov 2007 18:59:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=GULgnxQDds0TfgddFnF01xk/3VGwxRP9YYqLRNgX/dA=;
        b=edGP2WAc6bayXf7fQoAqG9MNZrna+65fww9RwtQOzzoA6vQNw2tEXc2IeNrrO1tzuSzpBJE2FbgjbuoUlCwfNtt/2bZZZNNVyQ3EaeGvmWx+PTDhGWGSGR2Ef4lelsP/uqjAi6xSjkBCG0zvP9OC1GssP+MB/yaZCYrdD3+RHSY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=nLjLKtY4K+VtrJJHPnnifblyauheFazN+4BBg6e7F7pVvBPq8se2xCDbZQwzMOteX2iZa3La9Pqgjz1JniNwM5yIO8bzyjD/+KQTBTIpP+Mr74WBBjtvr+wtXBe0dENVaKuSMIN6yd1u1QVw1V8mpl+Nm2tRVdmgY4h4eUeTNYc=
Received: by 10.115.75.1 with SMTP id c1mr252183wal.1194577165548;
        Thu, 08 Nov 2007 18:59:25 -0800 (PST)
Received: by 10.114.52.11 with HTTP; Thu, 8 Nov 2007 18:59:25 -0800 (PST)
Message-ID: <839ba01c0711081859h2d485e8vef8d193ae9edb59d@mail.gmail.com>
Date: Fri, 9 Nov 2007 10:59:25 +0800
From: "Cedric Ho" <cedric.ho@gmail.com>
To: java-user@lucene.apache.org
Subject: Chinese Segmentation with Phase Query
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

We are having an issue while indexing Chinese Documents in Lucene.

Some background first:
Since CJK languages doesn't have space between words, we first have to
determine the words from sentences. e.g.

a sentence containing characters ABC, it may be segmented into AB, C or A, BC.

the problem is sometimes there can be ambiguities in how the sentence
should be segmented. It is possible that
both AB, C and A, BC are valid segmentations.

In this cases we would like to index both segmentation into the index:

AB offset (0,1) position 0
C offset (2,2) position 1
A offset (0,0) position 0
BC offset (1,2) position 1

Now the problem is, when someone search using a PhraseQuery (AC) it
will find this line ABC because it match A (position 0) and C
(position 1).

Are there any ways to search for exact match using the offset
information instead of the position information ?

Best Regards,
Cedric

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30933-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 09:18:54 2007
Return-Path: <java-user-return-30933-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78288 invoked from network); 9 Nov 2007 09:18:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 09:18:54 -0000
Received: (qmail 81112 invoked by uid 500); 9 Nov 2007 09:18:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81077 invoked by uid 500); 9 Nov 2007 09:18:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81064 invoked by uid 99); 9 Nov 2007 09:18:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 01:18:35 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of koji@r.email.ne.jp designates 202.224.39.198 as permitted sender)
Received: from [202.224.39.198] (HELO mail.asahi-net.or.jp) (202.224.39.198)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 09:18:38 +0000
Received: from [127.0.0.1] (w244069.ppp.asahi-net.or.jp [121.1.244.69])
	by mail.asahi-net.or.jp (Postfix) with ESMTP id 7A0A4512C1
	for <java-user@lucene.apache.org>; Fri,  9 Nov 2007 18:18:13 +0900 (JST)
Message-ID: <47342584.4010702@r.email.ne.jp>
Date: Fri, 09 Nov 2007 18:16:52 +0900
From: Koji Sekiguchi <koji@r.email.ne.jp>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: Can multiple JVMs search an index with one JVM writing to it?
References: <50648.192.168.1.108.1194406491.squirrel@msqr.us>
In-Reply-To: <50648.192.168.1.108.1194406491.squirrel@msqr.us>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

It should work. See the following FAQ:

http://wiki.apache.org/lucene-java/LuceneFAQ#head-6c56b0449d114826586940dcc6fe51582676a36e

regards,

Koji

Matt Magoffin wrote:
> Hello, I tried finding information about this from past mailing list
> emails, but couldn't find anything. I'm using Lucene 1.4 series and
> wondered if it is safe for two different JVMs opening and searching the
> same physical index located on the local file system, with one of the JVMs
> performing writes to the index?
>
> All JVMs are long-running application servers, so I was wondering if this
> would work at all or pose any problems for the search-only JVMs.
>
> -- m@
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30934-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 10:52:29 2007
Return-Path: <java-user-return-30934-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10202 invoked from network); 9 Nov 2007 10:52:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 10:52:29 -0000
Received: (qmail 96245 invoked by uid 500); 9 Nov 2007 10:52:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96215 invoked by uid 500); 9 Nov 2007 10:52:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96204 invoked by uid 99); 9 Nov 2007 10:52:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 02:52:09 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [89.213.91.233] (HELO mail.ardentiasearch.com) (89.213.91.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 10:52:13 +0000
Received: from biscuit.ARDENTIASEARCH.local ([10.0.0.9]) by
 biscuit.ARDENTIASEARCH.local ([10.0.0.9]) with mapi; Fri, 9 Nov 2007 10:51:48
 +0000
From: Mike Streeton <mike.streeton@ardentiasearch.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 9 Nov 2007 10:51:54 +0000
Subject: TermDocs.skipTo error
Thread-Topic: TermDocs.skipTo error
Thread-Index: Acgivopz6jss0qz3SKGELI54E7ycug==
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: multipart/alternative;
	boundary="_000_DFE6314F5CE91344A74BD2AA612C93B6142B7F5130biscuitARDENT_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_DFE6314F5CE91344A74BD2AA612C93B6142B7F5130biscuitARDENT_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

I have posted before about a problem with TermDocs.skipTo () but never mana=
ged to reproduce it. I have now got it to fail using the following program,=
 please can someone try it and see if they get the stack trace:

Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Array =
index out of range: 101306
      at org.apache.lucene.util.BitVector.get(BitVector.java:72)
      at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:=
118)
      at org.apache.lucene.index.SegmentTermDocs.skipTo(SegmentTermDocs.jav=
a:176)
      at org.apache.lucene.index.MultiTermDocs.skipTo(MultiReader.java:413)
      at Test4.test(Test4.java:88)
      at main(Test4.java:69)

The program creates a test index, if you run it a second time it will not c=
reate the index. Change the directory name on line 33.

Many Thanks

Mike

Ps I am using Lucene 2.2 and java 1.6 u1



import java.io.IOException;
import java.util.Random;

import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.document.Field.Index;
import org.apache.lucene.document.Field.Store;
import org.apache.lucene.index.CorruptIndexException;
import org.apache.lucene.index.IndexReader;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.index.MultiReader;
import org.apache.lucene.index.Term;
import org.apache.lucene.index.TermDocs;
import org.apache.lucene.store.Directory;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.store.LockObtainFailedException;

public class Test4 {

      /**
       * @param args
       * @throws IOException
       * @throws LockObtainFailedException
       * @throws CorruptIndexException
       */
      public static void main(String[] args) throws Exception {
            Random rand =3D new Random(0);
            Directory[] dirs =3D new Directory[10];
            for (int i =3D 0; i < dirs.length; i++) {
                  dirs[i] =3D FSDirectory.getDirectory("c:\\temp\\lucenetes=
t\\"
                              + Integer.toString(i));
                  if (!IndexReader.indexExists(dirs[i])) {
                        IndexWriter writer =3D new IndexWriter(dirs[i],
                                    new StandardAnalyzer(), true);
                        for (int j =3D 0; j < 100000; j++) {
                              Document doc =3D new Document();
                              doc.add(new Field("i", Integer.toString(rand.=
nextInt(100)),
                                          Store.YES, Index.UN_TOKENIZED));
                              doc.add(new Field("j",
                                          Integer.toString(rand.nextInt(100=
0)), Store.YES,
                                          Index.UN_TOKENIZED));
                              writer.addDocument(doc);
                              if (j % 10000 =3D=3D 0) {
                                    System.out.println(j);
                              }
                        }
                        writer.optimize();
                        writer.close();
                        writer =3D null;
                  }
                  IndexReader reader =3D IndexReader.open(dirs[i]);
                  for (int j =3D 0; j < 1000; j++) {
                        reader.deleteDocument(rand.nextInt(reader.maxDoc())=
);
                  }
                  reader.close();
            }
            IndexReader[] readers =3D new IndexReader[dirs.length];
            for (int i =3D 0; i < dirs.length; i++) {
                  readers[i] =3D IndexReader.open(dirs[i]);
            }
            IndexReader reader =3D new MultiReader(readers);
            TermDocs docs =3D reader.termDocs();
            for (int i =3D 0; i < 100; i++) {
                  for (int j =3D 0; j < 1000; j++) {
                        try {
                              test(docs, Integer.toString(i), Integer.toStr=
ing(j));
                        } catch (Exception e) {
                              System.err.println("Failed at i=3D"+i+" j=3D"=
+j);
                              throw e;
                        }
                  }
            }
            docs.close();
            reader.close();
      }

      private static void test(TermDocs docs, String i, String j)
                  throws IOException {
            docs.seek(new Term("i", i));
            while (docs.next());
            docs.seek(new Term("j", j));
            while (docs.next());
            docs.seek(new Term("i", i));
            if (docs.next()) {
                  while (docs.skipTo(docs.doc()+1000));
            }
            docs.seek(new Term("j", j));
            if (docs.next()) {
                  while (docs.skipTo(docs.doc()+1000));
            }
      }

}


--_000_DFE6314F5CE91344A74BD2AA612C93B6142B7F5130biscuitARDENT_--

From java-user-return-30935-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 14:25:10 2007
Return-Path: <java-user-return-30935-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80831 invoked from network); 9 Nov 2007 14:25:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 14:25:09 -0000
Received: (qmail 58248 invoked by uid 500); 9 Nov 2007 14:24:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58212 invoked by uid 500); 9 Nov 2007 14:24:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58201 invoked by uid 99); 9 Nov 2007 14:24:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 06:24:49 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 14:24:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IqUmd-0008Fm-IH
	for java-user@lucene.apache.org; Fri, 09 Nov 2007 06:24:31 -0800
Message-ID: <13667927.post@talk.nabble.com>
Date: Fri, 9 Nov 2007 06:24:31 -0800 (PST)
From: KR <Keith.Rhodes.ext@siemens.com>
To: java-user@lucene.apache.org
Subject: Re: Create and populate a field when indexing
In-Reply-To: <4449172F-9DC9-40A8-8180-7C0E47C4FE68@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: Keith.Rhodes.ext@siemens.com
References: <13471852.post@talk.nabble.com> <4449172F-9DC9-40A8-8180-7C0E47C4FE68@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org



Grant Ingersoll-6 wrote:
> 
> When you are indexing the file and adding the Document, you will need  
> to parse out your filename per your regular expression, and then  
> create the appropriate field:
> 
> Document doc = new Document()
> String cat = getCategoryFromFileName(inputFileName)
> doc.add(new Field("category", cat, ...)
> //do the rest of your adds
> 
> Just locate where in the demo the Document add is taking place (I  
> forget the exact spot) and then add in the appropriate stuff from  
> above.  Obviously, you need to implement the method I stubbed called  
> getCategoryFromFileName.
> 
> HTH,
> Grant
> 

Thanks, Grant. That was just the hint I needed.

I found that the fields are populated in HTMLDocument.

I added:

doc.add(new Field("category", "test", Field.Store.YES,
Field.Index.TOKENIZED));

and then used Luke to verify that this field had been added. It had.

Now I am trying to get a quick-and-dirty way of setting the field based on
the filename, but I'm running into problems that I don't really understand
well enough to fix quickly.

I have only very limited experience of Java programming, so I might be using
the wrong terms, but I think the problem is variable scope. I get a
compilation error:

HTMLDocument.java:86: cannot find symbol
symbol  : variable url
location: class org.apache.lucene.demo.HTMLDocument
        if (url.indexOf("-ov-") != -1) {


I thought I'd be able to use a simple mechanism based on indexOf() to check
the existence of a short sequence of characters within the filename. For
example, "-sys-". I know that this sequence, if it exists anywhere in the
full path must be in the filename.

So I put in a series of if statements like this:

	if (url.indexOf("-sys-") != -1) {
		string category = "system";
	}

then right at the end:
doc.add(new Field("category", category, Field.Store.YES,
Field.Index.TOKENIZED));

Am I right in thinking that the variable url is undefined at this point in
the code? It certainly seems to be defined earlier on in the file:

  public static String uid2url(String uid) {
    String url = uid.replace('\u0000', '/');	  // replace nulls with slashes
    return url.substring(0, url.lastIndexOf('/')); // remove date from end
  }

Is there some way for me to perhaps chop down to the filename here, and make
that available later in the code?

K.
-- 
View this message in context: http://www.nabble.com/Create-and-populate-a-field-when-indexing-tf4713018.html#a13667927
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30936-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 14:44:29 2007
Return-Path: <java-user-return-30936-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87439 invoked from network); 9 Nov 2007 14:44:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 14:44:29 -0000
Received: (qmail 87425 invoked by uid 500); 9 Nov 2007 14:44:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86472 invoked by uid 500); 9 Nov 2007 14:44:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86461 invoked by uid 99); 9 Nov 2007 14:44:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 06:44:11 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of open.study@gmail.com designates 209.85.128.186 as permitted sender)
Received: from [209.85.128.186] (HELO fk-out-0910.google.com) (209.85.128.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 14:44:15 +0000
Received: by fk-out-0910.google.com with SMTP id z23so532352fkz
        for <java-user@lucene.apache.org>; Fri, 09 Nov 2007 06:43:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=+ephW3sQdiO8DfEhR/55Oh6BxbqwXCOafGesu9LDcyM=;
        b=Q3U7rDpmTufaY8Ryi6lxPjnbWZOcx9xRQDYOXAwiwUaYq1yoHkO1yAFmnaR+Xg0GGyXNSivCbTzLAME2KRZV033Obe9oo/o5NalELlQwtDVn6kAVWGfeUtC2rq3XoePUJ9bvfOZjBdQY3HUWgkqUaCufe50EjEoFnWFG83d44uk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=OoKgjaKSqBbrChbfYBAiLVWKgBbQfuGcocdustvi++JoNgZxu/zU1g3n7TJobhqQfdIoCIgjxg4D6FMJZnazbiKr8/pxWQ1mERQ4xpq2R+5sXbo2E2SqlWoPjoNjt0Fl115hDLfSU27WJGsfc17yfRNhdeoF9klerLMuJK5GqZM=
Received: by 10.82.187.16 with SMTP id k16mr4162391buf.1194619431741;
        Fri, 09 Nov 2007 06:43:51 -0800 (PST)
Received: by 10.82.126.18 with HTTP; Fri, 9 Nov 2007 06:43:51 -0800 (PST)
Message-ID: <fb1e04d60711090643q2e319676h22b9f98ce9800dcb@mail.gmail.com>
Date: Fri, 9 Nov 2007 22:43:51 +0800
From: "Open Study" <open.study@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Chinese Segmentation with Phase Query
In-Reply-To: <839ba01c0711081859h2d485e8vef8d193ae9edb59d@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <839ba01c0711081859h2d485e8vef8d193ae9edb59d@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Cedric

You may try the CJKAnalyzer within the lucene sandbox. It doesn't give
a perfect solution for Chinese word segmentation, but will solve the
problem in your case.

On Nov 9, 2007 10:59 AM, Cedric Ho <cedric.ho@gmail.com> wrote:
> Hi,
>
> We are having an issue while indexing Chinese Documents in Lucene.
>
> Some background first:
> Since CJK languages doesn't have space between words, we first have to
> determine the words from sentences. e.g.
>
> a sentence containing characters ABC, it may be segmented into AB, C or A, BC.
>
> the problem is sometimes there can be ambiguities in how the sentence
> should be segmented. It is possible that
> both AB, C and A, BC are valid segmentations.
>
> In this cases we would like to index both segmentation into the index:
>
> AB offset (0,1) position 0
> C offset (2,2) position 1
> A offset (0,0) position 0
> BC offset (1,2) position 1
>
> Now the problem is, when someone search using a PhraseQuery (AC) it
> will find this line ABC because it match A (position 0) and C
> (position 1).
>
> Are there any ways to search for exact match using the offset
> information instead of the position information ?
>
> Best Regards,
> Cedric
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30937-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 15:18:40 2007
Return-Path: <java-user-return-30937-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3542 invoked from network); 9 Nov 2007 15:18:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 15:18:40 -0000
Received: (qmail 42089 invoked by uid 500); 9 Nov 2007 15:18:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42054 invoked by uid 500); 9 Nov 2007 15:18:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42043 invoked by uid 99); 9 Nov 2007 15:18:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 07:18:21 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nikolay.diakov@fredhopper.com designates 82.94.15.138 as permitted sender)
Received: from [82.94.15.138] (HELO smtp.fredhopper.com) (82.94.15.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 15:18:25 +0000
Received: from [192.168.0.235] (nikolay.ams.fredhopper.com [192.168.0.235])
	by smtp.fredhopper.com (Postfix) with ESMTP id 07FDD20D926
	for <java-user@lucene.apache.org>; Fri,  9 Nov 2007 16:18:04 +0100 (CET)
Message-ID: <47347A26.5000205@fredhopper.com>
Date: Fri, 09 Nov 2007 16:17:58 +0100
From: Nikolay Diakov <nikolay.diakov@fredhopper.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: - lock improvement suggestion
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I have briefly reviewed the SimpleFSLock of Lucene 2.1 and 2.2. I see 
that the lock release mechanism does not check the return value of delete:

   public void release() {
     lockFile.delete();
   }

On most linux-es this can never return false, however under some windows 
FS if someone (a virus scanner) touches the file at the proper 
(improper) time, one may get a delete failure and get a false value. In 
the original code this means that the directory stays locked forever 
(unless someone does double unlocking or until a clearLock from the lock 
factory). For diagnosting purposes, it may be a good idea to throw an 
exception in that case. Alternatively, release() may return a boolean up 
the chain, however this may require more changes in the code using the 
release(). Just a suggestion.

Cheers,
   Nikolay

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30938-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 15:50:49 2007
Return-Path: <java-user-return-30938-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16291 invoked from network); 9 Nov 2007 15:50:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 15:50:49 -0000
Received: (qmail 5704 invoked by uid 500); 9 Nov 2007 15:50:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5526 invoked by uid 500); 9 Nov 2007 15:50:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5502 invoked by uid 99); 9 Nov 2007 15:50:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 07:50:30 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 15:51:12 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id C71854659B
	for <java-user@lucene.apache.org>; Fri,  9 Nov 2007 10:50:12 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Fri, 09 Nov 2007 10:50:12 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id A0EDE42C2D; Fri,  9 Nov 2007 10:50:12 -0500 (EST)
Message-Id: <1194623412.30050.1220454289@webmail.messagingengine.com>
X-Sasl-Enc: amC4QODRsZNRTL35ybEPSiDUgJ+b/3attuheVRzZirN/ 1194623412
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47347A26.5000205@fredhopper.com>
Subject: Re: - lock improvement suggestion
In-Reply-To: <47347A26.5000205@fredhopper.com>
Date: Fri, 09 Nov 2007 10:50:12 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


I agree, we should not ignore the return value here.  I think throwing an
exception if it returns false is the right thing to do?  Though, if it's
a checked exception, that's not a backwards compatible change...

Mike

"Nikolay Diakov" <nikolay.diakov@fredhopper.com> wrote:
> I have briefly reviewed the SimpleFSLock of Lucene 2.1 and 2.2. I see 
> that the lock release mechanism does not check the return value of
> delete:
> 
>    public void release() {
>      lockFile.delete();
>    }
> 
> On most linux-es this can never return false, however under some windows 
> FS if someone (a virus scanner) touches the file at the proper 
> (improper) time, one may get a delete failure and get a false value. In 
> the original code this means that the directory stays locked forever 
> (unless someone does double unlocking or until a clearLock from the lock 
> factory). For diagnosting purposes, it may be a good idea to throw an 
> exception in that case. Alternatively, release() may return a boolean up 
> the chain, however this may require more changes in the code using the 
> release(). Just a suggestion.
> 
> Cheers,
>    Nikolay
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30939-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 15:59:57 2007
Return-Path: <java-user-return-30939-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18821 invoked from network); 9 Nov 2007 15:59:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 15:59:57 -0000
Received: (qmail 21739 invoked by uid 500); 9 Nov 2007 15:59:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21143 invoked by uid 500); 9 Nov 2007 15:59:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21120 invoked by uid 99); 9 Nov 2007 15:59:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 07:59:39 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.188 as permitted sender)
Received: from [209.85.134.188] (HELO mu-out-0910.google.com) (209.85.134.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 15:59:42 +0000
Received: by mu-out-0910.google.com with SMTP id i10so541915mue
        for <java-user@lucene.apache.org>; Fri, 09 Nov 2007 07:59:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=FP5UvM+Wqy9Yg2AhEgXnyxQ+M3pmM/AxGalsrjt9Rl4=;
        b=nh9SE1NeQ2/A7kaMaRlq74LYsrApdE5Yn91hQtcyocICUG39BBpDAyEgIB1+m8Y3U8wSNgbjIoBWxzERGkIPZSuKCEfUXxCcbIpDNWnyeFL46Tgv7P2ljJBZaSGGo4ia2lzheGWRCEIWU+B9Z7MBSYN2i0bMOusq7GUiMtDr/kg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=QXbr/2+P6/ukxGBLs57ildFUxSBjS50sonGqqeAaTwiVZdnvuoMN6YJMeLS8anZKPUhSn7CMVCMN5+F0To/jozUUFIFImfe4w3LPoSJ4DfG1t59D/iczvAj9IQW07k1/FWxlrEjFFfWxdSpgX8W4RlHONZymY6JWB8r2YFIldmc=
Received: by 10.82.181.10 with SMTP id d10mr3323917buf.1194623960272;
        Fri, 09 Nov 2007 07:59:20 -0800 (PST)
Received: by 10.82.190.14 with HTTP; Fri, 9 Nov 2007 07:59:20 -0800 (PST)
Message-ID: <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
Date: Fri, 9 Nov 2007 10:59:20 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: TermDocs.skipTo error
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_42479_30815759.1194623960253"
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_42479_30815759.1194623960253
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

FWIW, running Lucene 2.1, Java 1.5 all I get is some numbers being printed
out
0
10000
20000
.
.
.
90,000


and ran through the above 4 times or so....

Erick

On Nov 9, 2007 5:51 AM, Mike Streeton <mike.streeton@ardentiasearch.com>
wrote:

> I have posted before about a problem with TermDocs.skipTo () but never
> managed to reproduce it. I have now got it to fail using the following
> program, please can someone try it and see if they get the stack trace:
>
> Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Array
> index out of range: 101306
>      at org.apache.lucene.util.BitVector.get(BitVector.java:72)
>      at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java
> :118)
>      at org.apache.lucene.index.SegmentTermDocs.skipTo(
> SegmentTermDocs.java:176)
>      at org.apache.lucene.index.MultiTermDocs.skipTo(MultiReader.java:413)
>      at Test4.test(Test4.java:88)
>      at main(Test4.java:69)
>
> The program creates a test index, if you run it a second time it will not
> create the index. Change the directory name on line 33.
>
> Many Thanks
>
> Mike
>
> Ps I am using Lucene 2.2 and java 1.6 u1
>
>
>
> import java.io.IOException;
> import java.util.Random;
>
> import org.apache.lucene.analysis.standard.StandardAnalyzer;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.document.Field.Index;
> import org.apache.lucene.document.Field.Store;
> import org.apache.lucene.index.CorruptIndexException;
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.index.MultiReader;
> import org.apache.lucene.index.Term;
> import org.apache.lucene.index.TermDocs;
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.store.LockObtainFailedException;
>
> public class Test4 {
>
>      /**
>       * @param args
>       * @throws IOException
>       * @throws LockObtainFailedException
>       * @throws CorruptIndexException
>       */
>      public static void main(String[] args) throws Exception {
>            Random rand = new Random(0);
>            Directory[] dirs = new Directory[10];
>            for (int i = 0; i < dirs.length; i++) {
>                  dirs[i] = FSDirectory.getDirectory
> ("c:\\temp\\lucenetest\\"
>                              + Integer.toString(i));
>                  if (!IndexReader.indexExists(dirs[i])) {
>                        IndexWriter writer = new IndexWriter(dirs[i],
>                                    new StandardAnalyzer(), true);
>                        for (int j = 0; j < 100000; j++) {
>                              Document doc = new Document();
>                              doc.add(new Field("i", Integer.toString(
> rand.nextInt(100)),
>                                          Store.YES, Index.UN_TOKENIZED));
>                              doc.add(new Field("j",
>                                          Integer.toString(rand.nextInt(1000)),
> Store.YES,
>                                          Index.UN_TOKENIZED));
>                              writer.addDocument(doc);
>                              if (j % 10000 == 0) {
>                                    System.out.println(j);
>                              }
>                        }
>                        writer.optimize();
>                        writer.close();
>                        writer = null;
>                  }
>                  IndexReader reader = IndexReader.open(dirs[i]);
>                  for (int j = 0; j < 1000; j++) {
>                        reader.deleteDocument(rand.nextInt(reader.maxDoc
> ()));
>                  }
>                  reader.close();
>            }
>            IndexReader[] readers = new IndexReader[dirs.length];
>            for (int i = 0; i < dirs.length; i++) {
>                  readers[i] = IndexReader.open(dirs[i]);
>            }
>            IndexReader reader = new MultiReader(readers);
>            TermDocs docs = reader.termDocs();
>            for (int i = 0; i < 100; i++) {
>                  for (int j = 0; j < 1000; j++) {
>                        try {
>                              test(docs, Integer.toString(i),
> Integer.toString(j));
>                        } catch (Exception e) {
>                              System.err.println("Failed at i="+i+" j="+j);
>                              throw e;
>                        }
>                  }
>            }
>            docs.close();
>            reader.close();
>      }
>
>      private static void test(TermDocs docs, String i, String j)
>                  throws IOException {
>            docs.seek(new Term("i", i));
>            while (docs.next());
>            docs.seek(new Term("j", j));
>            while (docs.next());
>            docs.seek(new Term("i", i));
>            if (docs.next()) {
>                  while (docs.skipTo(docs.doc()+1000));
>            }
>            docs.seek(new Term("j", j));
>            if (docs.next()) {
>                  while (docs.skipTo(docs.doc()+1000));
>            }
>      }
>
> }
>
>

------=_Part_42479_30815759.1194623960253--

From java-user-return-30940-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 16:05:04 2007
Return-Path: <java-user-return-30940-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20848 invoked from network); 9 Nov 2007 16:05:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 16:05:04 -0000
Received: (qmail 36003 invoked by uid 500); 9 Nov 2007 16:04:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35981 invoked by uid 500); 9 Nov 2007 16:04:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35970 invoked by uid 99); 9 Nov 2007 16:04:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 08:04:45 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [89.213.91.233] (HELO mail.ardentiasearch.com) (89.213.91.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 16:04:48 +0000
Received: from biscuit.ARDENTIASEARCH.local ([10.0.0.9]) by
 biscuit.ARDENTIASEARCH.local ([10.0.0.9]) with mapi; Fri, 9 Nov 2007 16:04:26
 +0000
From: Mike Streeton <mike.streeton@ardentiasearch.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 9 Nov 2007 16:04:34 +0000
Subject: RE: TermDocs.skipTo error
Thread-Topic: TermDocs.skipTo error
Thread-Index: Acgi6ZULEEvmTiwsTbit5uM0eX6I7gAACzJw
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local>
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
 <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
In-Reply-To: <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Erick,
   Sorry the numbers are just printed out for debugging when it is building=
 the index. I will try it with lucene 2.1 and see what happens

Thanks

Mike

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]
Sent: 09 November 2007 15:59
To: java-user@lucene.apache.org
Subject: Re: TermDocs.skipTo error

FWIW, running Lucene 2.1, Java 1.5 all I get is some numbers being printed
out
0
10000
20000
.
.
.
90,000


and ran through the above 4 times or so....

Erick

On Nov 9, 2007 5:51 AM, Mike Streeton <mike.streeton@ardentiasearch.com>
wrote:

> I have posted before about a problem with TermDocs.skipTo () but never
> managed to reproduce it. I have now got it to fail using the following
> program, please can someone try it and see if they get the stack trace:
>
> Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Arra=
y
> index out of range: 101306
>      at org.apache.lucene.util.BitVector.get(BitVector.java:72)
>      at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java
> :118)
>      at org.apache.lucene.index.SegmentTermDocs.skipTo(
> SegmentTermDocs.java:176)
>      at org.apache.lucene.index.MultiTermDocs.skipTo(MultiReader.java:413=
)
>      at Test4.test(Test4.java:88)
>      at main(Test4.java:69)
>
> The program creates a test index, if you run it a second time it will not
> create the index. Change the directory name on line 33.
>
> Many Thanks
>
> Mike
>
> Ps I am using Lucene 2.2 and java 1.6 u1
>
>
>
> import java.io.IOException;
> import java.util.Random;
>
> import org.apache.lucene.analysis.standard.StandardAnalyzer;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.document.Field.Index;
> import org.apache.lucene.document.Field.Store;
> import org.apache.lucene.index.CorruptIndexException;
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.index.MultiReader;
> import org.apache.lucene.index.Term;
> import org.apache.lucene.index.TermDocs;
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.store.LockObtainFailedException;
>
> public class Test4 {
>
>      /**
>       * @param args
>       * @throws IOException
>       * @throws LockObtainFailedException
>       * @throws CorruptIndexException
>       */
>      public static void main(String[] args) throws Exception {
>            Random rand =3D new Random(0);
>            Directory[] dirs =3D new Directory[10];
>            for (int i =3D 0; i < dirs.length; i++) {
>                  dirs[i] =3D FSDirectory.getDirectory
> ("c:\\temp\\lucenetest\\"
>                              + Integer.toString(i));
>                  if (!IndexReader.indexExists(dirs[i])) {
>                        IndexWriter writer =3D new IndexWriter(dirs[i],
>                                    new StandardAnalyzer(), true);
>                        for (int j =3D 0; j < 100000; j++) {
>                              Document doc =3D new Document();
>                              doc.add(new Field("i", Integer.toString(
> rand.nextInt(100)),
>                                          Store.YES, Index.UN_TOKENIZED));
>                              doc.add(new Field("j",
>                                          Integer.toString(rand.nextInt(10=
00)),
> Store.YES,
>                                          Index.UN_TOKENIZED));
>                              writer.addDocument(doc);
>                              if (j % 10000 =3D=3D 0) {
>                                    System.out.println(j);
>                              }
>                        }
>                        writer.optimize();
>                        writer.close();
>                        writer =3D null;
>                  }
>                  IndexReader reader =3D IndexReader.open(dirs[i]);
>                  for (int j =3D 0; j < 1000; j++) {
>                        reader.deleteDocument(rand.nextInt(reader.maxDoc
> ()));
>                  }
>                  reader.close();
>            }
>            IndexReader[] readers =3D new IndexReader[dirs.length];
>            for (int i =3D 0; i < dirs.length; i++) {
>                  readers[i] =3D IndexReader.open(dirs[i]);
>            }
>            IndexReader reader =3D new MultiReader(readers);
>            TermDocs docs =3D reader.termDocs();
>            for (int i =3D 0; i < 100; i++) {
>                  for (int j =3D 0; j < 1000; j++) {
>                        try {
>                              test(docs, Integer.toString(i),
> Integer.toString(j));
>                        } catch (Exception e) {
>                              System.err.println("Failed at i=3D"+i+" j=3D=
"+j);
>                              throw e;
>                        }
>                  }
>            }
>            docs.close();
>            reader.close();
>      }
>
>      private static void test(TermDocs docs, String i, String j)
>                  throws IOException {
>            docs.seek(new Term("i", i));
>            while (docs.next());
>            docs.seek(new Term("j", j));
>            while (docs.next());
>            docs.seek(new Term("i", i));
>            if (docs.next()) {
>                  while (docs.skipTo(docs.doc()+1000));
>            }
>            docs.seek(new Term("j", j));
>            if (docs.next()) {
>                  while (docs.skipTo(docs.doc()+1000));
>            }
>      }
>
> }
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30941-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 16:06:07 2007
Return-Path: <java-user-return-30941-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21358 invoked from network); 9 Nov 2007 16:06:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 16:06:06 -0000
Received: (qmail 40652 invoked by uid 500); 9 Nov 2007 16:05:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40621 invoked by uid 500); 9 Nov 2007 16:05:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40606 invoked by uid 99); 9 Nov 2007 16:05:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 08:05:44 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of nikolay.diakov@fredhopper.com designates 82.94.15.138 as permitted sender)
Received: from [82.94.15.138] (HELO smtp.fredhopper.com) (82.94.15.138)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 16:05:48 +0000
Received: from [192.168.0.235] (nikolay.ams.fredhopper.com [192.168.0.235])
	by smtp.fredhopper.com (Postfix) with ESMTP id AB6B71C631E
	for <java-user@lucene.apache.org>; Fri,  9 Nov 2007 17:05:27 +0100 (CET)
Message-ID: <47348542.4090004@fredhopper.com>
Date: Fri, 09 Nov 2007 17:05:22 +0100
From: Nikolay Diakov <nikolay.diakov@fredhopper.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: - lock improvement suggestion
References: <47347A26.5000205@fredhopper.com> <1194623412.30050.1220454289@webmail.messagingengine.com>
In-Reply-To: <1194623412.30050.1220454289@webmail.messagingengine.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I see you do the wrapping in a RuntimeException trick. Perhaps you can 
introduce a special exception derived from RuntimeException that you 
would throw in that case. It would basically mean "The underlying FS 
does something we cannot tolerate so we fail fast."

--Nikolay

Michael McCandless wrote:
> I agree, we should not ignore the return value here.  I think throwing an
> exception if it returns false is the right thing to do?  Though, if it's
> a checked exception, that's not a backwards compatible change...
> 
> Mike
> 
> "Nikolay Diakov" <nikolay.diakov@fredhopper.com> wrote:
>> I have briefly reviewed the SimpleFSLock of Lucene 2.1 and 2.2. I see 
>> that the lock release mechanism does not check the return value of
>> delete:
>>
>>    public void release() {
>>      lockFile.delete();
>>    }
>>
>> On most linux-es this can never return false, however under some windows 
>> FS if someone (a virus scanner) touches the file at the proper 
>> (improper) time, one may get a delete failure and get a false value. In 
>> the original code this means that the directory stays locked forever 
>> (unless someone does double unlocking or until a clearLock from the lock 
>> factory). For diagnosting purposes, it may be a good idea to throw an 
>> exception in that case. Alternatively, release() may return a boolean up 
>> the chain, however this may require more changes in the code using the 
>> release(). Just a suggestion.
>>
>> Cheers,
>>    Nikolay
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30942-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 16:34:12 2007
Return-Path: <java-user-return-30942-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30745 invoked from network); 9 Nov 2007 16:34:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 16:34:12 -0000
Received: (qmail 87004 invoked by uid 500); 9 Nov 2007 16:33:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86966 invoked by uid 500); 9 Nov 2007 16:33:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86955 invoked by uid 99); 9 Nov 2007 16:33:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 08:33:53 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [89.213.91.233] (HELO mail.ardentiasearch.com) (89.213.91.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 16:33:57 +0000
Received: from biscuit.ARDENTIASEARCH.local ([10.0.0.9]) by
 biscuit.ARDENTIASEARCH.local ([10.0.0.9]) with mapi; Fri, 9 Nov 2007 16:33:35
 +0000
From: Mike Streeton <mike.streeton@ardentiasearch.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 9 Nov 2007 16:33:43 +0000
Subject: RE: TermDocs.skipTo error
Thread-Topic: TermDocs.skipTo error
Thread-Index: Acgi6ZULEEvmTiwsTbit5uM0eX6I7gAACzJwAAEWmjA=
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5182@biscuit.ARDENTIASEARCH.local>
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
 <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
 <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local>
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

I have tried this again using Lucene 2.1 and as Erick found it works okay, =
I have tried it on jdk 1.6 u1 and u3 both work, but both fail when using lu=
cene 2.2

Mike

-----Original Message-----
From: Mike Streeton [mailto:mike.streeton@ardentiasearch.com]
Sent: 09 November 2007 16:05
To: java-user@lucene.apache.org
Subject: RE: TermDocs.skipTo error

Erick,
   Sorry the numbers are just printed out for debugging when it is building=
 the index. I will try it with lucene 2.1 and see what happens

Thanks

Mike

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]
Sent: 09 November 2007 15:59
To: java-user@lucene.apache.org
Subject: Re: TermDocs.skipTo error

FWIW, running Lucene 2.1, Java 1.5 all I get is some numbers being printed
out
0
10000
20000
.
.
.
90,000


and ran through the above 4 times or so....

Erick

On Nov 9, 2007 5:51 AM, Mike Streeton <mike.streeton@ardentiasearch.com>
wrote:

> I have posted before about a problem with TermDocs.skipTo () but never
> managed to reproduce it. I have now got it to fail using the following
> program, please can someone try it and see if they get the stack trace:
>
> Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Arra=
y
> index out of range: 101306
>      at org.apache.lucene.util.BitVector.get(BitVector.java:72)
>      at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java
> :118)
>      at org.apache.lucene.index.SegmentTermDocs.skipTo(
> SegmentTermDocs.java:176)
>      at org.apache.lucene.index.MultiTermDocs.skipTo(MultiReader.java:413=
)
>      at Test4.test(Test4.java:88)
>      at main(Test4.java:69)
>
> The program creates a test index, if you run it a second time it will not
> create the index. Change the directory name on line 33.
>
> Many Thanks
>
> Mike
>
> Ps I am using Lucene 2.2 and java 1.6 u1
>
>
>
> import java.io.IOException;
> import java.util.Random;
>
> import org.apache.lucene.analysis.standard.StandardAnalyzer;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.document.Field.Index;
> import org.apache.lucene.document.Field.Store;
> import org.apache.lucene.index.CorruptIndexException;
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.index.MultiReader;
> import org.apache.lucene.index.Term;
> import org.apache.lucene.index.TermDocs;
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.store.LockObtainFailedException;
>
> public class Test4 {
>
>      /**
>       * @param args
>       * @throws IOException
>       * @throws LockObtainFailedException
>       * @throws CorruptIndexException
>       */
>      public static void main(String[] args) throws Exception {
>            Random rand =3D new Random(0);
>            Directory[] dirs =3D new Directory[10];
>            for (int i =3D 0; i < dirs.length; i++) {
>                  dirs[i] =3D FSDirectory.getDirectory
> ("c:\\temp\\lucenetest\\"
>                              + Integer.toString(i));
>                  if (!IndexReader.indexExists(dirs[i])) {
>                        IndexWriter writer =3D new IndexWriter(dirs[i],
>                                    new StandardAnalyzer(), true);
>                        for (int j =3D 0; j < 100000; j++) {
>                              Document doc =3D new Document();
>                              doc.add(new Field("i", Integer.toString(
> rand.nextInt(100)),
>                                          Store.YES, Index.UN_TOKENIZED));
>                              doc.add(new Field("j",
>                                          Integer.toString(rand.nextInt(10=
00)),
> Store.YES,
>                                          Index.UN_TOKENIZED));
>                              writer.addDocument(doc);
>                              if (j % 10000 =3D=3D 0) {
>                                    System.out.println(j);
>                              }
>                        }
>                        writer.optimize();
>                        writer.close();
>                        writer =3D null;
>                  }
>                  IndexReader reader =3D IndexReader.open(dirs[i]);
>                  for (int j =3D 0; j < 1000; j++) {
>                        reader.deleteDocument(rand.nextInt(reader.maxDoc
> ()));
>                  }
>                  reader.close();
>            }
>            IndexReader[] readers =3D new IndexReader[dirs.length];
>            for (int i =3D 0; i < dirs.length; i++) {
>                  readers[i] =3D IndexReader.open(dirs[i]);
>            }
>            IndexReader reader =3D new MultiReader(readers);
>            TermDocs docs =3D reader.termDocs();
>            for (int i =3D 0; i < 100; i++) {
>                  for (int j =3D 0; j < 1000; j++) {
>                        try {
>                              test(docs, Integer.toString(i),
> Integer.toString(j));
>                        } catch (Exception e) {
>                              System.err.println("Failed at i=3D"+i+" j=3D=
"+j);
>                              throw e;
>                        }
>                  }
>            }
>            docs.close();
>            reader.close();
>      }
>
>      private static void test(TermDocs docs, String i, String j)
>                  throws IOException {
>            docs.seek(new Term("i", i));
>            while (docs.next());
>            docs.seek(new Term("j", j));
>            while (docs.next());
>            docs.seek(new Term("i", i));
>            if (docs.next()) {
>                  while (docs.skipTo(docs.doc()+1000));
>            }
>            docs.seek(new Term("j", j));
>            if (docs.next()) {
>                  while (docs.skipTo(docs.doc()+1000));
>            }
>      }
>
> }
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30943-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 16:40:41 2007
Return-Path: <java-user-return-30943-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33658 invoked from network); 9 Nov 2007 16:40:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 16:40:41 -0000
Received: (qmail 1001 invoked by uid 500); 9 Nov 2007 16:40:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 971 invoked by uid 500); 9 Nov 2007 16:40:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 952 invoked by uid 99); 9 Nov 2007 16:40:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 08:40:22 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [89.213.91.233] (HELO mail.ardentiasearch.com) (89.213.91.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 16:40:26 +0000
Received: from biscuit.ARDENTIASEARCH.local ([10.0.0.9]) by
 biscuit.ARDENTIASEARCH.local ([10.0.0.9]) with mapi; Fri, 9 Nov 2007 16:40:04
 +0000
From: Mike Streeton <mike.streeton@ardentiasearch.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Fri, 9 Nov 2007 16:40:12 +0000
Subject: RE: TermDocs.skipTo error
Thread-Topic: TermDocs.skipTo error
Thread-Index: Acgi6ZULEEvmTiwsTbit5uM0eX6I7gAACzJwAAEWmjAAADxCQA==
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5183@biscuit.ARDENTIASEARCH.local>
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
 <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
 <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local>
 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5182@biscuit.ARDENTIASEARCH.local>
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5182@biscuit.ARDENTIASEARCH.local>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

I have just tried this again using the index I built with lucene 2.1 but ru=
nning the test using lucene 2.2 and it works okay, so it seems to be someth=
ing related to an index built using lucene 2.2.

Mike

-----Original Message-----
From: Mike Streeton [mailto:mike.streeton@ardentiasearch.com]
Sent: 09 November 2007 16:34
To: java-user@lucene.apache.org
Subject: RE: TermDocs.skipTo error

I have tried this again using Lucene 2.1 and as Erick found it works okay, =
I have tried it on jdk 1.6 u1 and u3 both work, but both fail when using lu=
cene 2.2

Mike

-----Original Message-----
From: Mike Streeton [mailto:mike.streeton@ardentiasearch.com]
Sent: 09 November 2007 16:05
To: java-user@lucene.apache.org
Subject: RE: TermDocs.skipTo error

Erick,
   Sorry the numbers are just printed out for debugging when it is building=
 the index. I will try it with lucene 2.1 and see what happens

Thanks

Mike

-----Original Message-----
From: Erick Erickson [mailto:erickerickson@gmail.com]
Sent: 09 November 2007 15:59
To: java-user@lucene.apache.org
Subject: Re: TermDocs.skipTo error

FWIW, running Lucene 2.1, Java 1.5 all I get is some numbers being printed
out
0
10000
20000
.
.
.
90,000


and ran through the above 4 times or so....

Erick

On Nov 9, 2007 5:51 AM, Mike Streeton <mike.streeton@ardentiasearch.com>
wrote:

> I have posted before about a problem with TermDocs.skipTo () but never
> managed to reproduce it. I have now got it to fail using the following
> program, please can someone try it and see if they get the stack trace:
>
> Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Arra=
y
> index out of range: 101306
>      at org.apache.lucene.util.BitVector.get(BitVector.java:72)
>      at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java
> :118)
>      at org.apache.lucene.index.SegmentTermDocs.skipTo(
> SegmentTermDocs.java:176)
>      at org.apache.lucene.index.MultiTermDocs.skipTo(MultiReader.java:413=
)
>      at Test4.test(Test4.java:88)
>      at main(Test4.java:69)
>
> The program creates a test index, if you run it a second time it will not
> create the index. Change the directory name on line 33.
>
> Many Thanks
>
> Mike
>
> Ps I am using Lucene 2.2 and java 1.6 u1
>
>
>
> import java.io.IOException;
> import java.util.Random;
>
> import org.apache.lucene.analysis.standard.StandardAnalyzer;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.document.Field.Index;
> import org.apache.lucene.document.Field.Store;
> import org.apache.lucene.index.CorruptIndexException;
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.index.MultiReader;
> import org.apache.lucene.index.Term;
> import org.apache.lucene.index.TermDocs;
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.store.LockObtainFailedException;
>
> public class Test4 {
>
>      /**
>       * @param args
>       * @throws IOException
>       * @throws LockObtainFailedException
>       * @throws CorruptIndexException
>       */
>      public static void main(String[] args) throws Exception {
>            Random rand =3D new Random(0);
>            Directory[] dirs =3D new Directory[10];
>            for (int i =3D 0; i < dirs.length; i++) {
>                  dirs[i] =3D FSDirectory.getDirectory
> ("c:\\temp\\lucenetest\\"
>                              + Integer.toString(i));
>                  if (!IndexReader.indexExists(dirs[i])) {
>                        IndexWriter writer =3D new IndexWriter(dirs[i],
>                                    new StandardAnalyzer(), true);
>                        for (int j =3D 0; j < 100000; j++) {
>                              Document doc =3D new Document();
>                              doc.add(new Field("i", Integer.toString(
> rand.nextInt(100)),
>                                          Store.YES, Index.UN_TOKENIZED));
>                              doc.add(new Field("j",
>                                          Integer.toString(rand.nextInt(10=
00)),
> Store.YES,
>                                          Index.UN_TOKENIZED));
>                              writer.addDocument(doc);
>                              if (j % 10000 =3D=3D 0) {
>                                    System.out.println(j);
>                              }
>                        }
>                        writer.optimize();
>                        writer.close();
>                        writer =3D null;
>                  }
>                  IndexReader reader =3D IndexReader.open(dirs[i]);
>                  for (int j =3D 0; j < 1000; j++) {
>                        reader.deleteDocument(rand.nextInt(reader.maxDoc
> ()));
>                  }
>                  reader.close();
>            }
>            IndexReader[] readers =3D new IndexReader[dirs.length];
>            for (int i =3D 0; i < dirs.length; i++) {
>                  readers[i] =3D IndexReader.open(dirs[i]);
>            }
>            IndexReader reader =3D new MultiReader(readers);
>            TermDocs docs =3D reader.termDocs();
>            for (int i =3D 0; i < 100; i++) {
>                  for (int j =3D 0; j < 1000; j++) {
>                        try {
>                              test(docs, Integer.toString(i),
> Integer.toString(j));
>                        } catch (Exception e) {
>                              System.err.println("Failed at i=3D"+i+" j=3D=
"+j);
>                              throw e;
>                        }
>                  }
>            }
>            docs.close();
>            reader.close();
>      }
>
>      private static void test(TermDocs docs, String i, String j)
>                  throws IOException {
>            docs.seek(new Term("i", i));
>            while (docs.next());
>            docs.seek(new Term("j", j));
>            while (docs.next());
>            docs.seek(new Term("i", i));
>            if (docs.next()) {
>                  while (docs.skipTo(docs.doc()+1000));
>            }
>            docs.seek(new Term("j", j));
>            if (docs.next()) {
>                  while (docs.skipTo(docs.doc()+1000));
>            }
>      }
>
> }
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30944-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 17:03:58 2007
Return-Path: <java-user-return-30944-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44625 invoked from network); 9 Nov 2007 17:03:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 17:03:58 -0000
Received: (qmail 56858 invoked by uid 500); 9 Nov 2007 17:03:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56830 invoked by uid 500); 9 Nov 2007 17:03:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56819 invoked by uid 99); 9 Nov 2007 17:03:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 09:03:39 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucener@gmail.com designates 64.233.182.186 as permitted sender)
Received: from [64.233.182.186] (HELO nf-out-0910.google.com) (64.233.182.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 17:03:43 +0000
Received: by nf-out-0910.google.com with SMTP id d3so429903nfc
        for <java-user@lucene.apache.org>; Fri, 09 Nov 2007 09:03:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=g1NLeDLVhAMeIq7QpNgqCRrMWCtQYEmbJEWofU9jnU8=;
        b=f50Zb/bWGE/5Gr6oTz/DieePpYe3NpHx0mTgD5rbfdZJ6BzHcCYAg5PtETUJEM8qLkdPN7zlLeyn03b3Wk+W/dMGA5LjKZi39KLN2mvg3q1/l4GSOoFMRXYjN43F7hq+wsutRvJytYrVhLrJGsWTbaIhv4yHJAKtMrapZyhGytc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=t0r/SYlHKJkhQd7PCtN1X4OdY6FkHx2P0pRxBdDkmUrXBebf9rF6N/mXlK2uWwPOuuquFV5jVnOU2CFAS9Dr1wPTJ0dBadWXAVdETLgv8+B+EaAjuQeJMi+Hk1BIhLPEeQi/k+oDFO+rHf3CVBDv+8mMKIOjvScm+le+yRT/fU4=
Received: by 10.78.179.12 with SMTP id b12mr2680783huf.1194627801631;
        Fri, 09 Nov 2007 09:03:21 -0800 (PST)
Received: by 10.78.13.13 with HTTP; Fri, 9 Nov 2007 09:03:21 -0800 (PST)
Message-ID: <882004010711090903s1efbfd0ah80aa32842c137cab@mail.gmail.com>
Date: Fri, 9 Nov 2007 12:03:21 -0500
From: "Lucifer Hammer" <lucener@gmail.com>
To: java-user@lucene.apache.org
Subject: Obtaining the number of segments in an index?
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Is there a way to get the number of segments in an index?

I looked at the API's for the reader, writer and searcher, but didn't
find anything.

Thanks,
Lucifer

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30945-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 17:14:55 2007
Return-Path: <java-user-return-30945-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46795 invoked from network); 9 Nov 2007 17:14:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 17:14:54 -0000
Received: (qmail 74022 invoked by uid 500); 9 Nov 2007 17:14:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73985 invoked by uid 500); 9 Nov 2007 17:14:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73974 invoked by uid 99); 9 Nov 2007 17:14:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 09:14:35 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luceneuser4@gmail.com designates 209.85.132.246 as permitted sender)
Received: from [209.85.132.246] (HELO an-out-0708.google.com) (209.85.132.246)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 17:14:39 +0000
Received: by an-out-0708.google.com with SMTP id d11so99709and
        for <java-user@lucene.apache.org>; Fri, 09 Nov 2007 09:14:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=rC2P10E4ohZ33u5R1uVbP68ogDePmLE8v86wR/f2xyk=;
        b=TX8H+kM+vkXeHaLR75NK/6z/+EnUCmshZI3NXq+oAQ4tRJeqaUocO7yOfIfP66dWABz9RWuMDqt1vW8km8Zin7Zznl97S0Xy7EmPnOkWQ0JTaoDvsyNXtZuwbmkj9wX32MpUpL9iK5N7oNUqlXZJpI40atRBzZC6ZCHYrQ5yFxs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=qtxlFQkPxe7jB/vvgiVrkjt4XBba0JkdYg/OVaetG5pfcgkNtcc7TUZfnjvJcNXSH3m3ADOGSzJ8J8NMSwwqWyuyq9SUiKxjezy/4gJKPxo6Em71tytgMaUSIcnRtViivMqextU5Aub5vBk+49JYqUy9inl2UtWVrqkfV6C2CnM=
Received: by 10.101.68.19 with SMTP id v19mr3242487ank.1194628458360;
        Fri, 09 Nov 2007 09:14:18 -0800 (PST)
Received: by 10.101.66.10 with HTTP; Fri, 9 Nov 2007 09:14:18 -0800 (PST)
Message-ID: <f1dbd1980711090914l33d06c88kd216ac07bafd84a9@mail.gmail.com>
Date: Fri, 9 Nov 2007 12:14:18 -0500
From: "Lucene User" <luceneuser4@gmail.com>
To: java-user@lucene.apache.org
Subject: Comparing Two Indexes
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I wanted two compare two indexes.Please recommend an algorithm

which takes all the factors into accoubt such as versions of software
being used by

lucene and application which has an effect on the index being
created.We can also

compare with certain fields and the text.

Regards

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30946-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 18:09:12 2007
Return-Path: <java-user-return-30946-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63641 invoked from network); 9 Nov 2007 18:09:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 18:09:12 -0000
Received: (qmail 51008 invoked by uid 500); 9 Nov 2007 18:08:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50979 invoked by uid 500); 9 Nov 2007 18:08:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50968 invoked by uid 99); 9 Nov 2007 18:08:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 10:08:52 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.230.108.46] (HELO SUEXCL-02.ad.syr.edu) (128.230.108.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 18:09:32 +0000
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: base64
Subject: RE: Chinese Segmentation with Phase Query
Date: Fri, 9 Nov 2007 13:08:09 -0500
Message-ID: <9294E20AED46934EA459020706463F9450FE0F@SUEXCL-02.ad.syr.edu>
In-Reply-To: <839ba01c0711081859h2d485e8vef8d193ae9edb59d@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Chinese Segmentation with Phase Query
Thread-Index: AcgifKHv20Ycut4AQzGyb4XOHvsvRQAbKOyA
From: "Steven A Rowe" <sarowe@syr.edu>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgQ2VkcmljLA0KDQpPbiAxMS8wOC8yMDA3LCBDZWRyaWMgSG8gd3JvdGU6DQo+IGEgc2VudGVu
Y2UgY29udGFpbmluZyBjaGFyYWN0ZXJzIEFCQywgaXQgbWF5IGJlIHNlZ21lbnRlZCBpbnRvIEFC
LCBDIG9yIEEsIEJDLg0KW3NuaXBdDQo+IEluIHRoaXMgY2FzZXMgd2Ugd291bGQgbGlrZSB0byBp
bmRleCBib3RoIHNlZ21lbnRhdGlvbiBpbnRvIHRoZSBpbmRleDoNCj4gDQo+IEFCIG9mZnNldCAo
MCwxKSBwb3NpdGlvbiAwCQlBIG9mZnNldCAoMCwwKSBwb3NpdGlvbiAwDQo+IEMgb2Zmc2V0ICgy
LDIpIHBvc2l0aW9uIDEJCUJDIG9mZnNldCAoMSwyKSBwb3NpdGlvbiAxDQo+IA0KPiBOb3cgdGhl
IHByb2JsZW0gaXMsIHdoZW4gc29tZW9uZSBzZWFyY2ggdXNpbmcgYSBQaHJhc2VRdWVyeSAoQUMp
IGl0DQo+IHdpbGwgZmluZCB0aGlzIGxpbmUgQUJDIGJlY2F1c2UgaXQgbWF0Y2ggQSAocG9zaXRp
b24gMCkgYW5kIEMNCj4gKHBvc2l0aW9uIDEpLg0KPiANCj4gQXJlIHRoZXJlIGFueSB3YXlzIHRv
IHNlYXJjaCBmb3IgZXhhY3QgbWF0Y2ggdXNpbmcgdGhlIG9mZnNldA0KPiBpbmZvcm1hdGlvbiBp
bnN0ZWFkIG9mIHRoZSBwb3NpdGlvbiBpbmZvcm1hdGlvbiA/DQoNClNpbmNlIHlvdSBhcmUgd3Jp
dGluZyB0aGUgdG9rZW5pemVyICh0aGUgTHVjZW5lIHRlcm0gZm9yIHRoZSBtb2R1bGUgdGhhdCBw
ZXJmb3JtcyB0aGUgc2VnbWVudGF0aW9uKSwgeW91IHlvdXJzZWxmIGNhbiBzdWJzdGl0dXRlIHRo
ZSBiZWdpbm5pbmcgb2Zmc2V0IGZvciB0aGUgcG9zaXRpb24uICBCdXQgSSB0aGluayB0aGF0IHdp
dGhvdXQgdGhlIGVuZCBvZmZzZXQsIGl0IHdvbid0IGdldCB5b3Ugd2hhdCB5b3Ugd2FudC4NCg0K
Rm9yIGV4YW1wbGUsIGlmIHlvdXIgYWJvdmUgZXhhbXBsZSB3ZXJlIGluZGV4ZWQgd2l0aCBiZWdp
bm5pbmcgb2Zmc2V0cyBhcyBwb3NpdGlvbnMsIGEgcGhyYXNlIHF1ZXJ5IGZvciAiQUIsIEMiIHdp
bGwgZmFpbCB0byBtYXRjaCAtLSBldmVuIHRob3VnaCBpdCBzaG91bGQgbWF0Y2ggLS0gYmVjYXVz
ZSB0aGUgc2VnbWVudHMnIGJlZ2lubmluZyBvZmZzZXRzICgwIGFuZCAyKSBhcmUgbm90IGNvbnRp
Z3VvdXMuDQoNClRoZSBuZXcgUGF5bG9hZHMgZmVhdHVyZSBjb3VsZCBwcm92aWRlIHRoZSBiYXNp
cyBmb3Igc3RvcmluZyBiZWdpbm5pbmcgYW5kIGVuZGluZyBvZmZzZXRzIHJlcXVpcmVkIHRvIGRl
dGVybWluZSBjb250aWd1aXR5IHdoZW4gbWF0Y2hpbmcgcGhyYXNlcywgYnV0IHlvdSB3b3VsZCBo
YXZlIHRvIHdyaXRlIG1hdGNoaW5nIGFuZCBzY29yaW5nIGZvciB0aGlzIHJlcHJlc2VudGF0aW9u
LCBhbmQgdGhhdCBtYXkgbm90IGJlIHRoZSBxdWlja2VzdCByb3V0ZSBhdmFpbGFibGUgdG8geW91
Lg0KDQpTb2x1dGlvbiAjMTogQ3JlYXRlIG11bHRpcGxlIGZpZWxkcywgb25lIGZvciBlYWNoIGZ1
bGwgYWx0ZXJuYXRpdmUgc2VnbWVudGF0aW9uLCBhbmQgdGhlbiBxdWVyeSBhZ2FpbnN0IGFsbCBv
ZiB0aGVtLg0KDQpTb2x1dGlvbiAjMjogU3RvcmUgdGhlIGFsdGVybmF0aXZlIHNlZ21lbnRhdGlv
bnMgaW4gdGhlIHNhbWUgZmllbGQsIGJ1dCBpbnN0ZWFkIG9mIGludGVybGVhdmluZyB0aGUgc2Vn
bWVudHMnIHBvc2l0aW9ucywgYXMgaW4geW91ciBleGFtcGxlLCBtYWtlIHRoZSBwb3NpdGlvbiBy
YW5nZXMgb2YgdGhlIGFsdGVybmF0aXZlcyBub24tY29udGlndW91cy4gIFJlY2FzdGluZyB5b3Vy
IGV4YW1wbGU6DQoNCglsdGVybmF0aXZlICMxCUFsdGVybmF0aXZlICMyCUFsdGVybmF0aXZlICMz
DQoJLS0tLS0tLS0tLS0tLQktLS0tLS0tLS0tLS0tLQktLS0tLS0tLS0tLS0tLQ0KCUFCIHBvc2l0
aW9uIDAJQSBwb3NpdGlvbiAxMDAJQSBwb3NpdGlvbiAyMDANCglDIHBvc2l0aW9uIDEJQkMgcG9z
aXRpb24gMTAxCUIgcG9zaXRpb24gMjAxDQoJCQkJCQkJQyBwb3NpdGlvbiAyMDINCg0KVGhlcmUg
aXMgYSBwcm9ibGVtIHdpdGggYm90aCBvZiB0aGUgYWJvdmUtZGVzY3JpYmVkIHNvbHV0aW9uczog
aW4gbXkgbGltaXRlZCBleHBlcmllbmNlIHdpdGggQ2hpbmVzZSBzZWdtZW50YXRpb24sIHN1YnN0
YW50aWFsbHkgbGVzcyB0aGFuIGhhbGYgdGhlIHRleHQgaGFzIGFsdGVybmF0aXZlIHNlZ21lbnRh
dGlvbnMuICBBcyBhIHJlc3VsdCwgdGhlIHNlZ21lbnRzIG9uIHdoaWNoIGFsbCBvZiBhbHRlcm5h
dGl2ZXMgYWdyZWUgKGNhbGwgdGhlbSAidW5jb250ZXN0ZWQgc2VnbWVudHMiKSB3aWxsIGhhdmUg
aGlnaGVyIHRlcm0gZnJlcXVlbmNpZXMgdGhhbiB0aG9zZSBzZWdtZW50cyB3aGljaCBkaWZmZXIg
YW1vbmcgdGhlIGFsdGVybmF0aXZlcyAoImNvbnRlc3RlZCBzZWdtZW50cyIpLiAgVGhpcyBtZWFu
cyB0aGF0IGRvY3VtZW50IHNjb3JlcyB3aWxsIGJlIGluZmx1ZW5jZWQgYnkgdGhlIHZhcmlhYmxl
IGRlbnNpdHkgb2YgdGhlIGNvbnRlc3RlZCBzZWdtZW50cyB0aGV5IGNvbnRhaW4uDQoNCkhvd2V2
ZXIsIGlmIHlvdSB3ZXJlIHRvIHVzZSBteSBhYm92ZS1kZXNjcmliZWQgU29sdXRpb24gIzEgYWxv
bmcgd2l0aCBhIERpc2p1bmN0aW9uTWF4UXVlcnlbMV0gYXMgYSB3cmFwcGVyIGFyb3VuZCBvbmUg
cXVlcnkgcGVyIGFsdGVybmF0aXZlIHNlZ21lbnRhdGlvbiBmaWVsZCwgdGhlIHRlcm0gZnJlcXVl
bmN5IHByb2JsZW0gd291bGQgbm8gbG9uZ2VyIGJlIGFuIGlzc3VlLiAgRnJvbSB0aGUgQVBJIGRv
YyBmb3IgRGlzanVuY3Rpb25NYXhRdWVyeToNCg0KICAgIEEgcXVlcnkgdGhhdCBnZW5lcmF0ZXMg
dGhlIHVuaW9uIG9mIGRvY3VtZW50cyBwcm9kdWNlZCBieSBpdHMNCiAgICBzdWJxdWVyaWVzLCBh
bmQgdGhhdCBzY29yZXMgZWFjaCBkb2N1bWVudCB3aXRoIHRoZSBtYXhpbXVtDQogICAgc2NvcmUg
Zm9yIHRoYXQgZG9jdW1lbnQgYXMgcHJvZHVjZWQgYnkgYW55IHN1YnF1ZXJ5LCBwbHVzIGEgDQog
ICAgdGllIGJyZWFraW5nIGluY3JlbWVudCBmb3IgYW55IGFkZGl0aW9uYWwgbWF0Y2hpbmcgc3Vi
cXVlcmllcy4gDQogICAgVGhpcyBpcyB1c2VmdWwgd2hlbiBzZWFyY2hpbmcgZm9yIGEgd29yZCBp
biBtdWx0aXBsZSBmaWVsZHMgDQogICAgd2l0aCBkaWZmZXJlbnQgYm9vc3QgZmFjdG9ycyAoc28g
dGhhdCB0aGUgZmllbGRzIGNhbm5vdCBiZSANCiAgICBjb21iaW5lZCBlcXVpdmFsZW50bHkgaW50
byBhIHNpbmdsZSBzZWFyY2ggZmllbGQpLiAgV2Ugd2FudA0KICAgIHRoZSBwcmltYXJ5IHNjb3Jl
IHRvIGJlIHRoZSBvbmUgYXNzb2NpYXRlZCB3aXRoIHRoZSBoaWdoZXN0DQogICAgYm9vc3QsIG5v
dCB0aGUgc3VtIG9mIHRoZSBmaWVsZCBzY29yZXMgKGFzIEJvb2xlYW5RdWVyeSB3b3VsZA0KICAg
IGdpdmUpLg0KDQpVbmxpa2UgdGhlIHVzZS1jYXNlIG1lbnRpb25lZCBhYm92ZSwgd2hlcmUgZWFj
aCBmaWVsZCB3aWxsIGJlIGJvb3N0ZWQgZGlmZmVyZW50bHksIHlvdSBwcm9iYWJseSBkb24ndCBo
YXZlIGFueSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgcmVsYXRpdmUgcHJvYmFiaWxpdHkgb2YgdGhl
IGFsdGVybmF0aXZlIHNlZ21lbnRhdGlvbnMsIHNvIHlvdSdsbCB3YW50IHRvIHVzZSB0aGUgc2Ft
ZSBib29zdCBmb3IgZWFjaCBzdWItcXVlcnkuDQoNClN0ZXZlDQoNClsxXSA8aHR0cDovL2x1Y2Vu
ZS5hcGFjaGUub3JnL2phdmEvMl8yXzAvYXBpL29yZy9hcGFjaGUvbHVjZW5lL3NlYXJjaC9EaXNq
dW5jdGlvbk1heFF1ZXJ5Lmh0bWw+DQoNCi0tIA0KU3RldmUgUm93ZQ0KQ2VudGVyIGZvciBOYXR1
cmFsIExhbmd1YWdlIFByb2Nlc3NpbmcNCmh0dHA6Ly93d3cuY25scC5vcmcvdGVjaC9sdWNlbmUu
YXNwIA0K


From java-user-return-30947-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 18:16:59 2007
Return-Path: <java-user-return-30947-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68927 invoked from network); 9 Nov 2007 18:16:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 18:16:59 -0000
Received: (qmail 65584 invoked by uid 500); 9 Nov 2007 18:16:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65560 invoked by uid 500); 9 Nov 2007 18:16:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65547 invoked by uid 99); 9 Nov 2007 18:16:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 10:16:41 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of l.rzeszotarski@gmail.com designates 209.85.198.189 as permitted sender)
Received: from [209.85.198.189] (HELO rv-out-0910.google.com) (209.85.198.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 18:16:45 +0000
Received: by rv-out-0910.google.com with SMTP id k20so463716rvb
        for <java-user@lucene.apache.org>; Fri, 09 Nov 2007 10:16:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=MjPHSW3PnSbMz27a+yxtARIJPTH1vTcxK8rQIbfhEuo=;
        b=ClHsVZq7DY1i7JIPY1bl8GnUh8y4ekAViBEOCQ2eEm6e5Gbfj7R+B0uufcZkWMhDS9QrI+odtzfJhanifTeRe/KZHM/ysNNZwGtDF0QD7sxzuKnbIBprAGAxOrP8QamHOCNpnyTHViKWZW2zqsI0lH6IpfQAFH4U8mRN1E4mhYc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=hXV+XynLtjmE+dw7BoH9OuRqI0Zt+5O1Ey2DQxcKGT21OMvlF1Gvm5iw17Jds4PaD9fWI2YseYBGiA3d7l6Pe+tzrv2bJ3zj/+nLXisWQI7cJ89F/vgwSVeVNwDHhGIYwfj+ZMSwbMqmVU5JrmSR3N/vg/VBZLjmM8SVfMmcbI0=
Received: by 10.141.116.16 with SMTP id t16mr1103790rvm.1194632183905;
        Fri, 09 Nov 2007 10:16:23 -0800 (PST)
Received: by 10.141.68.5 with HTTP; Fri, 9 Nov 2007 10:16:23 -0800 (PST)
Message-ID: <f9b40aaa0711091016n4084f10csd14776343f28183f@mail.gmail.com>
Date: Fri, 9 Nov 2007 19:16:23 +0100
From: "Lukasz Rzeszotarski" <l.rzeszotarski@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: How to check which field contains Term
In-Reply-To: <200711081530.44047.daniel@nuix.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1548_214764.1194632183892"
References: <f9b40aaa0711070741j16bad167w4d04522212364aa8@mail.gmail.com>
	 <200711081530.44047.daniel@nuix.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1548_214764.1194632183892
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks for yours response, Probably, I will use this class in my project.

------=_Part_1548_214764.1194632183892--

From java-user-return-30948-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 09 18:18:37 2007
Return-Path: <java-user-return-30948-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69750 invoked from network); 9 Nov 2007 18:18:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 9 Nov 2007 18:18:37 -0000
Received: (qmail 67822 invoked by uid 500); 9 Nov 2007 18:18:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67698 invoked by uid 500); 9 Nov 2007 18:18:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67681 invoked by uid 99); 9 Nov 2007 18:18:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 10:18:19 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 209.85.198.186 as permitted sender)
Received: from [209.85.198.186] (HELO rv-out-0910.google.com) (209.85.198.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 18:18:22 +0000
Received: by rv-out-0910.google.com with SMTP id k20so464108rvb
        for <java-user@lucene.apache.org>; Fri, 09 Nov 2007 10:18:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=FVRzOeFxfnnlyT5u1HJ4tM4ATg17lglXA1lcSU/MuzY=;
        b=hQbfoRrvPrqjY6Z6YHQb4HF7isM7bYCUR9yoE0ByAgEa7HHIGjtzrNatkWhWL+y0qYqM8pzTrbLAaD4mRE/pG3bMwfvj5gpf/pMWXXbk8zuQHvZtSrTpJyvmZKPfKTam6l+0QaBm0mNYSKU34FU/e9JiZlaBIssTAstguAinvOE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=SaT0yBR944UVL6t5tyLRdQP0Kz3AwXBS1LgqgOX9midFIW6xXH6mFWBSuUaVSpxaHPIqCvwSLjMEwnj/iXQ6ulgmR5gmRltFjJloAcRZTLUQE/A3ZpOJXG5yUNTSlPiOfIaEiXkEG7WlAltuKS/qjhIh8wFbSpbUEEC4LZkleQc=
Received: by 10.141.123.4 with SMTP id a4mr1120950rvn.1194632282508;
        Fri, 09 Nov 2007 10:18:02 -0800 (PST)
Received: from ?192.168.1.104? ( [70.137.142.125])
        by mx.google.com with ESMTPS id g22sm3760272rvb.2007.11.09.10.18.00
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 09 Nov 2007 10:18:01 -0800 (PST)
Message-ID: <4734A405.4090203@gmail.com>
Date: Fri, 09 Nov 2007 10:16:37 -0800
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: TermDocs.skipTo error
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local> <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com> <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local> <DFE6314F5CE91344A74BD2AA612C93B6142B7F5182@biscuit.ARDENTIASEARCH.local> <DFE6314F5CE91344A74BD2AA612C93B6142B7F5183@biscuit.ARDENTIASEARCH.local>
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5183@biscuit.ARDENTIASEARCH.local>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Mike Streeton wrote:
> I have just tried this again using the index I built with lucene 2.1 but running the test using lucene 2.2 and it works okay, so it seems to be something related to an index built using lucene 2.2.
> 
> Mike
> 

Hi Mike,

does this also happen with the current trunk version? A bunch of fixes
have been committed since 2.2.

-Michael

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30949-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 00:51:17 2007
Return-Path: <java-user-return-30949-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90049 invoked from network); 10 Nov 2007 00:51:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 00:51:17 -0000
Received: (qmail 10050 invoked by uid 500); 10 Nov 2007 00:50:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10007 invoked by uid 500); 10 Nov 2007 00:50:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9996 invoked by uid 99); 10 Nov 2007 00:50:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 16:50:58 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cedric.ho@gmail.com designates 72.14.202.182 as permitted sender)
Received: from [72.14.202.182] (HELO ro-out-1112.google.com) (72.14.202.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 00:51:02 +0000
Received: by ro-out-1112.google.com with SMTP id k4so376129rog
        for <java-user@lucene.apache.org>; Fri, 09 Nov 2007 16:50:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=sYaE7CdAR9RyCenkSPezLtd7RFF5u2H2MCAkO2FiObY=;
        b=mW0JeS8EiNx02BYfpbXCqqswBaJJkEBApwrzmg05SFW1fZRKixae0u5mgofF/KP5pEa50TWqa/ElRUz+rC3IuVKqMTOsVUY1J04hupiLbZlfZfnc6Spw4VuTrs54wPAN8mBYcTrEltLUuJg1+YgZ/mfkd17gL1AZi3DmK/sIvKY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=h8Xq1eAfXLG0/zfDrAPKwn0GmsIyOlGk4X4KWqaLg0NnuqyfuEjfGwq/7aNmlkvvcw82rxzbC9lVXc/hp7HnfTjVjKJmkZNGpih/zfS/J6iKLZDDMZt7daO+ZWgNyS0SsTs/3wiivsraPeEf97KZ5/wuIHIdGCPmbwonobXqt4s=
Received: by 10.114.177.1 with SMTP id z1mr59935wae.1194655839451;
        Fri, 09 Nov 2007 16:50:39 -0800 (PST)
Received: by 10.114.52.11 with HTTP; Fri, 9 Nov 2007 16:50:39 -0800 (PST)
Message-ID: <839ba01c0711091650i456c78dbu70b23b3888fdf875@mail.gmail.com>
Date: Sat, 10 Nov 2007 08:50:39 +0800
From: "Cedric Ho" <cedric.ho@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Chinese Segmentation with Phase Query
In-Reply-To: <fb1e04d60711090643q2e319676h22b9f98ce9800dcb@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <839ba01c0711081859h2d485e8vef8d193ae9edb59d@mail.gmail.com>
	 <fb1e04d60711090643q2e319676h22b9f98ce9800dcb@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

The CJKAnalyzer is too simple for our need. But thanks for suggesting anyway.

Cheers,
Cedric

On Nov 9, 2007 10:43 PM, Open Study <open.study@gmail.com> wrote:
> Hi Cedric
>
> You may try the CJKAnalyzer within the lucene sandbox. It doesn't give
> a perfect solution for Chinese word segmentation, but will solve the
> problem in your case.
>
>
> On Nov 9, 2007 10:59 AM, Cedric Ho <cedric.ho@gmail.com> wrote:
> > Hi,
> >
> > We are having an issue while indexing Chinese Documents in Lucene.
> >
> > Some background first:
> > Since CJK languages doesn't have space between words, we first have to
> > determine the words from sentences. e.g.
> >
> > a sentence containing characters ABC, it may be segmented into AB, C or A, BC.
> >
> > the problem is sometimes there can be ambiguities in how the sentence
> > should be segmented. It is possible that
> > both AB, C and A, BC are valid segmentations.
> >
> > In this cases we would like to index both segmentation into the index:
> >
> > AB offset (0,1) position 0
> > C offset (2,2) position 1
> > A offset (0,0) position 0
> > BC offset (1,2) position 1
> >
> > Now the problem is, when someone search using a PhraseQuery (AC) it
> > will find this line ABC because it match A (position 0) and C
> > (position 1).
> >
> > Are there any ways to search for exact match using the offset
> > information instead of the position information ?
> >
> > Best Regards,
> > Cedric
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30950-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 01:28:15 2007
Return-Path: <java-user-return-30950-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9243 invoked from network); 10 Nov 2007 01:28:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 01:28:15 -0000
Received: (qmail 26135 invoked by uid 500); 10 Nov 2007 01:27:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26096 invoked by uid 500); 10 Nov 2007 01:27:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26085 invoked by uid 99); 10 Nov 2007 01:27:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 17:27:56 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cedric.ho@gmail.com designates 209.85.198.187 as permitted sender)
Received: from [209.85.198.187] (HELO rv-out-0910.google.com) (209.85.198.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 01:27:57 +0000
Received: by rv-out-0910.google.com with SMTP id k20so526348rvb
        for <java-user@lucene.apache.org>; Fri, 09 Nov 2007 17:27:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=zs0mCmanvHtYqgK/N1v2pVbuxIrKUysCUxGigDxB36o=;
        b=t6Y0xcKuT/RQXOwSq5dAHbN4V6Qaqto1jmdzYoxgFyP9Qyka/fYqiHs5sHTYtkV/jFKZWEQEsH1ahBgUolYujtOKlFRUXA5mmGs62YRLfgrEDk06E/RCLCRSIva8YvKqwqfcWo+pJAqWhsEy3RA93KKktsoPARw6YbdEBnOJtkg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=k3Hdyz4FbGaWDieTIx4KVitHckbpdRv9Rd6FsJFsDEbHau/K1jbSk5FT8SpR+ufvEdbdtdQIGnorRcm2Be1mR1fg5rqT7x2HKyjex6zT+6a8lzwTEct5qbbYsOHpVgXtrcBjtlddI4oNtD7Om9ZgZe3F3pMzhfn8EET0/fPwk8E=
Received: by 10.114.204.7 with SMTP id b7mr401251wag.1194658056277;
        Fri, 09 Nov 2007 17:27:36 -0800 (PST)
Received: by 10.114.52.11 with HTTP; Fri, 9 Nov 2007 17:27:36 -0800 (PST)
Message-ID: <839ba01c0711091727u5744510fk67d82548b53f0a01@mail.gmail.com>
Date: Sat, 10 Nov 2007 09:27:36 +0800
From: "Cedric Ho" <cedric.ho@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Chinese Segmentation with Phase Query
In-Reply-To: <9294E20AED46934EA459020706463F9450FE0F@SUEXCL-02.ad.syr.edu>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <839ba01c0711081859h2d485e8vef8d193ae9edb59d@mail.gmail.com>
	 <9294E20AED46934EA459020706463F9450FE0F@SUEXCL-02.ad.syr.edu>
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 10, 2007 2:08 AM, Steven A Rowe <sarowe@syr.edu> wrote:
> Hi Cedric,
>
> On 11/08/2007, Cedric Ho wrote:
> > a sentence containing characters ABC, it may be segmented into AB, C or A, BC.
> [snip]
> > In this cases we would like to index both segmentation into the index:
> >
> > AB offset (0,1) position 0            A offset (0,0) position 0
> > C offset (2,2) position 1             BC offset (1,2) position 1
> >
> > Now the problem is, when someone search using a PhraseQuery (AC) it
> > will find this line ABC because it match A (position 0) and C
> > (position 1).
> >
> > Are there any ways to search for exact match using the offset
> > information instead of the position information ?
>
> Since you are writing the tokenizer (the Lucene term for the module that performs the segmentation), you yourself can substitute the beginning offset for the position.  But I think that without the end offset, it won't get you what you want.
>
> For example, if your above example were indexed with beginning offsets as positions, a phrase query for "AB, C" will fail to match -- even though it should match -- because the segments' beginning offsets (0 and 2) are not contiguous.
>
> The new Payloads feature could provide the basis for storing beginning and ending offsets required to determine contiguity when matching phrases, but you would have to write matching and scoring for this representation, and that may not be the quickest route available to you.
>
> Solution #1: Create multiple fields, one for each full alternative segmentation, and then query against all of them.
>
> Solution #2: Store the alternative segmentations in the same field, but instead of interleaving the segments' positions, as in your example, make the position ranges of the alternatives non-contiguous.  Recasting your example:
>
>         lternative #1   Alternative #2  Alternative #3
>         -------------   --------------  --------------
>         AB position 0   A position 100  A position 200
>         C position 1    BC position 101 B position 201
>                                                         C position 202
>
> There is a problem with both of the above-described solutions: in my limited experience with Chinese segmentation, substantially less than half the text has alternative segmentations.  As a result, the segments on which all of alternatives agree (call them "uncontested segments") will have higher term frequencies than those segments which differ among the alternatives ("contested segments").  This means that document scores will be influenced by the variable density of the contested segments they contain.
>
> However, if you were to use my above-described Solution #1 along with a DisjunctionMaxQuery[1] as a wrapper around one query per alternative segmentation field, the term frequency problem would no longer be an issue.  From the API doc for DisjunctionMaxQuery:
>
>     A query that generates the union of documents produced by its
>     subqueries, and that scores each document with the maximum
>     score for that document as produced by any subquery, plus a
>     tie breaking increment for any additional matching subqueries.
>     This is useful when searching for a word in multiple fields
>     with different boost factors (so that the fields cannot be
>     combined equivalently into a single search field).  We want
>     the primary score to be the one associated with the highest
>     boost, not the sum of the field scores (as BooleanQuery would
>     give).
>
> Unlike the use-case mentioned above, where each field will be boosted differently, you probably don't have any information about the relative probability of the alternative segmentations, so you'll want to use the same boost for each sub-query.
>
> Steve
>
> [1] <http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/search/DisjunctionMaxQuery.html>
>
> --
> Steve Rowe
> Center for Natural Language Processing
> http://www.cnlp.org/tech/lucene.asp
>

Hi Steve,

We have actually thought about solution #1, and in our case, sorting
by scoring is not a very important factor as well. However this would
double the index size. A full index of our documents now would take >
80G already, and it's expected to grow much faster in the near future.
As you've mentioned, the ambiguities in segmentation are rare indeed.
So we are not very willing to double the index size just for that.

For solution #2, it is a good solution indeed, but you see, our
problem is much deeper in fact. We are currently try to replace our
old search engine with Lucene. Which means whatever features the old
engine have, we need to simulate it in Lucene. One such feature is
similar to Lucene's SpanNearQuery, which, unfortunately, doesn't work
with solution #2 if the search terms contains the term BC in
Alternative #2.

e.g.
Given a sentence XYZABCDEF
suppose the segmentation is
XY position 0
Z position 1           Alternative #2
AB position 2         A position 102
C position 3          BC position 103
DEF position 4

A SpanNearQuery of (XY, BC, DEF) with distance of 10 would fail to
match this document.

So it seems we may have to go the more difficult route in exploring
the Payload feature that you mentioned. I've seen it being announced
during the release of 2.2.0, but the API says "experimental" and there
ain't any example about how can it be used.

But thanks very much for your good suggestions.

Cheers,
Cedric

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30951-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 04:22:56 2007
Return-Path: <java-user-return-30951-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50293 invoked from network); 10 Nov 2007 04:22:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 04:22:56 -0000
Received: (qmail 88157 invoked by uid 500); 10 Nov 2007 04:22:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88123 invoked by uid 500); 10 Nov 2007 04:22:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88112 invoked by uid 99); 10 Nov 2007 04:22:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Nov 2007 20:22:38 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a20.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 04:22:38 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a20.g.dreamhost.com (Postfix) with ESMTP id 875C3E24CA
	for <java-user@lucene.apache.org>; Fri,  9 Nov 2007 20:22:15 -0800 (PST)
Message-Id: <15193CB7-1364-48F3-9D1C-A4DA37B8DCB3@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <bf1404350711081811gf7ba89ct193e72f87da0de4a@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: How to build your custom termfreq vector an add it to the field ?
Date: Fri, 9 Nov 2007 23:22:14 -0500
References: <bf1404350711070949i1a856534p18aac179b7c4d88@mail.gmail.com> <07472893-A840-4215-A512-8C6A21D7E0D5@apache.org> <bf1404350711081811gf7ba89ct193e72f87da0de4a@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Not really sure what to tell you other than you need to dig in and  
look at how the other Query classes are implemented.  I would start  
with TermQuery/TermScorer.

One thing I did to get to know the scoring was to go through and  
document it the best I could (given the time I had) as pseudocode  
(some of my notes are at http://lucene.apache.org/java/docs/scoring.html#Algorithm) 
  by stepping through it starting with some of the Unit tests.  Index  
a sample collection of known documents w/ known terms and frequencies  
that you can accurately product what the scores should be, then issue  
some basic TermQuery's and debug.  As your confidence grows, move onto  
PhraseQuery and BooleanQuery, then onto the SpanQueries.  Then write  
it all down and send us a patch :-)   Kind of kidding (we do like  
patches to docs), but do ask specific questions as you dig in.

Next thing you know, you will be submitting patches and on your way to  
being a committer.

Cheers,
Grant

On Nov 8, 2007, at 9:11 PM, Ariel wrote:

> Very interesting the link you suggest me Mr Grant Ingersoll.
> Let see if I understand how the ranking issue in lucene could be  
> implemented:
> 1.	First I must create my own query class extending the abstract Query
> class. The only method I must implement from this class is toString.
> Is right this ???
> 2.	I must implement inside my own query class the Weight interface
> But I really don't understand how this is going to let me change my
> ranking scoring.
> 3 I must implement my custom Scorer ???
> I don't know how integrate this. There is a lot of little pieces of
> information but not concrete.
> Greetings
>
>
>
> On Nov 7, 2007 1:48 PM, Grant Ingersoll <gsingers@apache.org> wrote:
>> Term Vectors (specifically TermFreqVector) in Lucene are a storage
>> mechanism for convenience and applications to use.  They are not an
>> integral part of the scoring in the way you may be thinking of them  
>> in
>> terms of the traditional Vector Space Model, thus there may be some
>> confusion from the different usages of that terminology.  If you want
>> to see examples of how to implement scorers have a look at classes
>> like TermScorer, BoostingTermQuery, and any of the other classes that
>> extend Scorer.  You might also find the file formats page (off of the
>> Lucene Java website under Documentation) helpful for understanding
>> what Lucene stores so that it can do scoring.
>>
>> There really isn't any tutorial on scoring, as it is not something
>> that many people have expressed an interest in or no one has made  
>> it a
>> high enough priority to write one.  Having written a Scorer (or maybe
>> two, I forget) I can give advice on specific things, but I am not  
>> sure
>> I could write a tutorial that is general enough to be useful at this
>> point.
>>
>> One thought for associating a weight to a given term based on its
>> cooccurring terms is to use the new Payload mechanism whereby you can
>> store a byte array at each term which can then be used in scoring via
>> things like the BoostingTermQuery (or your own implementation.)  If
>> that is of interest, you can search the archives for payloads (I also
>> think Michael Busch is presenting on Payloads, amongst other things,
>> at ApacheCon in Atlanta) and have a look at the BoostingTermQuery.
>> There certainly are other PayloadQueries that need to be implemented.
>> See the Lucene wiki for some background and details on Payloads as  
>> well.
>>
>> I don't know that it is a big mistake to try this in Lucene.  The
>> community hasn't put a huge priority on making altering the innards  
>> of
>> scoring easier to deal with (if possible), but that doesn't mean we
>> are not open to suggestions and patches.    You may find https://issues.apache.org/jira/browse/LUCENE-965
>>  to be informative for both the implementation and the discussion of
>> things that need to happen to be accepted into Lucene.  This JIRA
>> issue specifically attempts to provide Lucene with a new scoring
>> mechanism.
>>
>> You might also have a look at Lemur (http://www.lemurproject.org/)
>> which is much more academically focused.
>>
>> Cheers,
>> Grant
>>
>>
>> On Nov 7, 2007, at 12:49 PM, Ariel wrote:
>>
>>> Then if I want to use another scoring formula I must to implement my
>>> own Query/Weigh/Scorer  ? For example instead of cousine distance
>>> leiderbage distance or .. another. I'm studying Query/Weigh/Scorer
>>> classes to find out how to do that but there is not much  
>>> documentation
>>> about that.
>>>
>>> I have seen I could change similarity factors extending the  
>>> simlarity
>>> class, but I have not seen any example about changing scoring  
>>> formula
>>> and changing the weight by term in the term vector. Do you know any
>>> tutorial about this ?
>>>
>>> What I want to do changing frecuency in the terms vector is this:  
>>> for
>>> example instead of take the tf term frecuency of the term and stored
>>> in the vector I want to consider the correlation of the term with  
>>> the
>>> other terms of the documents and store that measure by term in the
>>> vector so later with my custom similarity formula calculate the
>>> ranking of a document against a query considering the correlation
>>> between terms.
>>> Dou you think is a big mistake try to do this with lucene ??? Is
>>> there any way ?
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> --------------------------
>> Grant Ingersoll
>> http://lucene.grantingersoll.com
>>
>> Lucene Boot Camp Training:
>> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com
>>
>> Lucene Helpful Hints:
>> http://wiki.apache.org/lucene-java/BasicsOfPerformance
>> http://wiki.apache.org/lucene-java/LuceneFAQ
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30952-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 12:09:21 2007
Return-Path: <java-user-return-30952-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67293 invoked from network); 10 Nov 2007 12:09:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 12:09:21 -0000
Received: (qmail 18881 invoked by uid 500); 10 Nov 2007 12:09:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18859 invoked by uid 500); 10 Nov 2007 12:09:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18848 invoked by uid 99); 10 Nov 2007 12:09:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 04:09:01 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [217.237.170.35] (HELO mzex01.healy-hudson.com) (217.237.170.35)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 12:09:02 +0000
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.4073
Content-Class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject:  Re: Chinese Segmentation with Phase Query
Date: Sat, 10 Nov 2007 13:08:36 +0100
Message-ID: <D7206503EB5BE94497458AF4FE4AE8AB4F01CD@mzex01.healy-hudson.com>
In-Reply-To: <839ba01c0711091727u5744510fk67d82548b53f0a01@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic:  Re: Chinese Segmentation with Phase Query
thread-index: AcgjOPkKQI4ejJ3FTr2l0dK5r9jw0AAV6M8g
References: <839ba01c0711081859h2d485e8vef8d193ae9edb59d@mail.gmail.com> <9294E20AED46934EA459020706463F9450FE0F@SUEXCL-02.ad.syr.edu> <839ba01c0711091727u5744510fk67d82548b53f0a01@mail.gmail.com>
From: "Uwe Goetzke" <uwe.goetzke@healy-hudson.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Cedric,

Although I have no idea how to use the Chinese language=20
but I went a different route to overcome language specific problems.

Instead of using a language specific segmentation we use now the =
statistical segmentation with bigrams=20

e.g.
Given a your sentence XYZABCDEF
suppose the segmentation is
XY YZ ZA AB BC CD DE EF=20

A SpanNearQuery of (XY, BC, DE, EF) with distance of 10 should work to
match this document.

I am not sure if this works in your case because we index product =
information and their descriptions which are not language friendly =
anyway because of the abbreviations)=20

Regards

Uwe Goetzke


-----Urspr=FCngliche Nachricht-----
Von: Cedric Ho [mailto:cedric.ho@gmail.com]=20
Gesendet: Samstag, 10. November 2007 02:28
An: java-user@lucene.apache.org
Betreff: - Re: Chinese Segmentation with Phase Query=20

On Nov 10, 2007 2:08 AM, Steven A Rowe <sarowe@syr.edu> wrote:
> Hi Cedric,
>
> On 11/08/2007, Cedric Ho wrote:
> > a sentence containing characters ABC, it may be segmented into AB, C =
or A, BC.
> [snip]
> > In this cases we would like to index both segmentation into the =
index:
> >
> > AB offset (0,1) position 0            A offset (0,0) position 0
> > C offset (2,2) position 1             BC offset (1,2) position 1
> >
> > Now the problem is, when someone search using a PhraseQuery (AC) it
> > will find this line ABC because it match A (position 0) and C
> > (position 1).
> >
> > Are there any ways to search for exact match using the offset
> > information instead of the position information ?
>
> Since you are writing the tokenizer (the Lucene term for the module =
that performs the segmentation), you yourself can substitute the =
beginning offset for the position.  But I think that without the end =
offset, it won't get you what you want.
>
> For example, if your above example were indexed with beginning offsets =
as positions, a phrase query for "AB, C" will fail to match -- even =
though it should match -- because the segments' beginning offsets (0 and =
2) are not contiguous.
>
> The new Payloads feature could provide the basis for storing beginning =
and ending offsets required to determine contiguity when matching =
phrases, but you would have to write matching and scoring for this =
representation, and that may not be the quickest route available to you.
>
> Solution #1: Create multiple fields, one for each full alternative =
segmentation, and then query against all of them.
>
> Solution #2: Store the alternative segmentations in the same field, =
but instead of interleaving the segments' positions, as in your example, =
make the position ranges of the alternatives non-contiguous.  Recasting =
your example:
>
>         lternative #1   Alternative #2  Alternative #3
>         -------------   --------------  --------------
>         AB position 0   A position 100  A position 200
>         C position 1    BC position 101 B position 201
>                                                         C position 202
>
> There is a problem with both of the above-described solutions: in my =
limited experience with Chinese segmentation, substantially less than =
half the text has alternative segmentations.  As a result, the segments =
on which all of alternatives agree (call them "uncontested segments") =
will have higher term frequencies than those segments which differ among =
the alternatives ("contested segments").  This means that document =
scores will be influenced by the variable density of the contested =
segments they contain.
>
> However, if you were to use my above-described Solution #1 along with =
a DisjunctionMaxQuery[1] as a wrapper around one query per alternative =
segmentation field, the term frequency problem would no longer be an =
issue.  From the API doc for DisjunctionMaxQuery:
>
>     A query that generates the union of documents produced by its
>     subqueries, and that scores each document with the maximum
>     score for that document as produced by any subquery, plus a
>     tie breaking increment for any additional matching subqueries.
>     This is useful when searching for a word in multiple fields
>     with different boost factors (so that the fields cannot be
>     combined equivalently into a single search field).  We want
>     the primary score to be the one associated with the highest
>     boost, not the sum of the field scores (as BooleanQuery would
>     give).
>
> Unlike the use-case mentioned above, where each field will be boosted =
differently, you probably don't have any information about the relative =
probability of the alternative segmentations, so you'll want to use the =
same boost for each sub-query.
>
> Steve
>
> [1] =
<http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/search/Disjunc=
tionMaxQuery.html>
>
> --
> Steve Rowe
> Center for Natural Language Processing
> http://www.cnlp.org/tech/lucene.asp
>

Hi Steve,

We have actually thought about solution #1, and in our case, sorting
by scoring is not a very important factor as well. However this would
double the index size. A full index of our documents now would take >
80G already, and it's expected to grow much faster in the near future.
As you've mentioned, the ambiguities in segmentation are rare indeed.
So we are not very willing to double the index size just for that.

For solution #2, it is a good solution indeed, but you see, our
problem is much deeper in fact. We are currently try to replace our
old search engine with Lucene. Which means whatever features the old
engine have, we need to simulate it in Lucene. One such feature is
similar to Lucene's SpanNearQuery, which, unfortunately, doesn't work
with solution #2 if the search terms contains the term BC in
Alternative #2.

e.g.
Given a sentence XYZABCDEF
suppose the segmentation is
XY position 0
Z position 1           Alternative #2
AB position 2         A position 102
C position 3          BC position 103
DEF position 4

A SpanNearQuery of (XY, BC, DEF) with distance of 10 would fail to
match this document.

So it seems we may have to go the more difficult route in exploring
the Payload feature that you mentioned. I've seen it being announced
during the release of 2.2.0, but the API says "experimental" and there
ain't any example about how can it be used.

But thanks very much for your good suggestions.

Cheers,
Cedric

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


-----------------------------------------------------------------------
Healy Hudson GmbH - D-55252 Mainz Kastel
Gesch=E4ftsf=FChrer Christian Konh=E4user - Amtsgericht Wiesbaden HRB =
12076

Diese Email ist vertraulich. Wenn Sie nicht der beabsichtigte =
Empf=E4nger sind, d=FCrfen Sie die Informationen nicht offen legen oder =
benutzen. Wenn Sie diese Email durch einen Fehler bekommen haben, teilen =
Sie uns dies bitte umgehend mit, indem Sie diese Email an den Absender =
zur=FCckschicken. Bitte l=F6schen Sie danach diese Email.
This email is confidential. If you are not the intended recipient, you =
must not disclose or use this information contained in it. If you have =
received this email in error please tell us immediately by return email =
and delete the document.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30953-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 13:30:56 2007
Return-Path: <java-user-return-30953-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87654 invoked from network); 10 Nov 2007 13:30:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 13:30:55 -0000
Received: (qmail 43626 invoked by uid 500); 10 Nov 2007 13:30:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43593 invoked by uid 500); 10 Nov 2007 13:30:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43582 invoked by uid 99); 10 Nov 2007 13:30:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 05:30:37 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:31:20 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 6522747022
	for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 08:30:18 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Sat, 10 Nov 2007 08:30:18 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 396A643AD6; Sat, 10 Nov 2007 08:30:18 -0500 (EST)
Message-Id: <1194701418.29096.1220580879@webmail.messagingengine.com>
X-Sasl-Enc: BGPvT4jAj1vNh44+cuUaru1kbAqWZTRYqFf7przcHK0/ 1194701418
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47347A26.5000205@fredhopper.com>
   <1194623412.30050.1220454289@webmail.messagingengine.com>
   <47348542.4090004@fredhopper.com>
Subject: Re: - lock improvement suggestion
In-Reply-To: <47348542.4090004@fredhopper.com>
Date: Sat, 10 Nov 2007 08:30:18 -0500
X-Virus-Checked: Checked by ClamAV on apache.org

"Nikolay Diakov" <nikolay.diakov@fredhopper.com> wrote:

> I see you do the wrapping in a RuntimeException trick. Perhaps you
> can introduce a special exception derived from RuntimeException that
> you would throw in that case. It would basically mean "The
> underlying FS does something we cannot tolerate so we fail fast."

I think in this case I'd like to make a "LockReleaseFailedException"
that subclasses from IOException, since the root cause (inability to
delete) really is an IOException type of issue.  This would be a very
minor break to backwards compatibility: all methods that call
Lock.release in Lucene themselves already throw IOException.

I'll open an issue & post a patch!

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30954-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 14:53:52 2007
Return-Path: <java-user-return-30954-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7874 invoked from network); 10 Nov 2007 14:53:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 14:53:52 -0000
Received: (qmail 88394 invoked by uid 500); 10 Nov 2007 14:53:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88354 invoked by uid 500); 10 Nov 2007 14:53:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88343 invoked by uid 99); 10 Nov 2007 14:53:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 06:53:33 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 14:54:18 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id EF20646CE3
	for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 09:53:16 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Sat, 10 Nov 2007 09:53:16 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id D080743B23; Sat, 10 Nov 2007 09:53:16 -0500 (EST)
Message-Id: <1194706396.8489.1220587547@webmail.messagingengine.com>
X-Sasl-Enc: YoSnMOmYtNudzwiEms/NFu53cBEtJTPdau0daGOl/BOJ 1194706396
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47347A26.5000205@fredhopper.com>
   <1194623412.30050.1220454289@webmail.messagingengine.com>
   <47348542.4090004@fredhopper.com>
   <1194701418.29096.1220580879@webmail.messagingengine.com>
Subject: Re: - lock improvement suggestion
In-Reply-To: <1194701418.29096.1220580879@webmail.messagingengine.com>
Date: Sat, 10 Nov 2007 09:53:16 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


OK I've opened this issue:

    https://issues.apache.org/jira/browse/LUCENE-1050

Mike

"Michael McCandless" <lucene@mikemccandless.com> wrote:
> "Nikolay Diakov" <nikolay.diakov@fredhopper.com> wrote:
> 
> > I see you do the wrapping in a RuntimeException trick. Perhaps you
> > can introduce a special exception derived from RuntimeException that
> > you would throw in that case. It would basically mean "The
> > underlying FS does something we cannot tolerate so we fail fast."
> 
> I think in this case I'd like to make a "LockReleaseFailedException"
> that subclasses from IOException, since the root cause (inability to
> delete) really is an IOException type of issue.  This would be a very
> minor break to backwards compatibility: all methods that call
> Lock.release in Lucene themselves already throw IOException.
> 
> I'll open an issue & post a patch!
> 
> Mike
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30955-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 21:06:22 2007
Return-Path: <java-user-return-30955-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 994 invoked from network); 10 Nov 2007 21:06:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 21:06:22 -0000
Received: (qmail 42008 invoked by uid 500); 10 Nov 2007 21:06:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41982 invoked by uid 500); 10 Nov 2007 21:06:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41967 invoked by uid 99); 10 Nov 2007 21:06:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:06:03 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 209.85.132.241 as permitted sender)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 21:06:06 +0000
Received: by an-out-0708.google.com with SMTP id d40so143654and
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 13:04:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=0qOAqiewT4jBTjyC/xKiWvJPSACagYNNJcs7/19Jmno=;
        b=rGCiibfijV5MCsKEyzsdWk1XtYrSt2zE8bWxoWLVc1GauTQb2OVooqas3ZY+E4/xJ9huwB0BaUUw6nvK0pEu2VEXD2OXvJgxwdrIuMLrg/LYsK2GVjWFBuaL6R6tOsidFPIjkfSAdKjJprQ6FuEkbVSqKuhzmI2UsQV975sS30M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=naQY5ZOIy//mCx12t6PIHbLf0rQ4X4dsYVCFxallSXLcM1jrj459rtOXSafqJDfq4kJFpurH+Nfun5yRuh2VDglcqINaW/cjBRwf/s2qNAI610wBW/dMDxXHsgmr1ZBb5m+64e2vYaQUevoA38hX0KkCgIuTpMhXh65sTTxdc4w=
Received: by 10.100.172.17 with SMTP id u17mr5146860ane.1194728699541;
        Sat, 10 Nov 2007 13:04:59 -0800 (PST)
Received: from ?192.168.1.6? ( [76.114.134.202])
        by mx.google.com with ESMTPS id 11sm4412213wrl.2007.11.10.13.04.57
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 10 Nov 2007 13:04:58 -0800 (PST)
Message-ID: <47361C43.6030506@gmail.com>
Date: Sat, 10 Nov 2007 16:01:55 -0500
From: Ryan McKinley <ryantxu@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: restoring a corrupt index?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Using solr, we have been running an indexing process for a while and 
when I checked on it today, it spits out an error:

java.lang.RuntimeException: java.io.FileNotFoundException: 
/path/to/index/_cf9.fnm (No such file or directory)
	at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:584)
	at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:475)

Looking through the archives, it looks like we are up a creek.

Any thoughts on what could have caused this?  The log files contains 
some 'too many open files' errors, I can't tell if that corresponds with 
when the index went bad though.

the startup script includes:
  ulimit -n 100000
which seems generous, no?

it is a 22GB index, ls -l | wc shows 180K files (oh my)

So my questions:

1. Anything I can do to use this index while I rebuild another? (takes a 
long time!)

2. Does the ulimit number explain how the index got corrupted?  If so, 
it seems like a problem.


thanks
ryan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30956-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 21:15:37 2007
Return-Path: <java-user-return-30956-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2356 invoked from network); 10 Nov 2007 21:15:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 21:15:37 -0000
Received: (qmail 45982 invoked by uid 500); 10 Nov 2007 21:15:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45867 invoked by uid 500); 10 Nov 2007 21:15:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45856 invoked by uid 99); 10 Nov 2007 21:15:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:15:19 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 209.85.132.245 as permitted sender)
Received: from [209.85.132.245] (HELO an-out-0708.google.com) (209.85.132.245)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 21:15:22 +0000
Received: by an-out-0708.google.com with SMTP id d40so143936and
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 13:14:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=0qOAqiewT4jBTjyC/xKiWvJPSACagYNNJcs7/19Jmno=;
        b=rGCiibfijV5MCsKEyzsdWk1XtYrSt2zE8bWxoWLVc1GauTQb2OVooqas3ZY+E4/xJ9huwB0BaUUw6nvK0pEu2VEXD2OXvJgxwdrIuMLrg/LYsK2GVjWFBuaL6R6tOsidFPIjkfSAdKjJprQ6FuEkbVSqKuhzmI2UsQV975sS30M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=naQY5ZOIy//mCx12t6PIHbLf0rQ4X4dsYVCFxallSXLcM1jrj459rtOXSafqJDfq4kJFpurH+Nfun5yRuh2VDglcqINaW/cjBRwf/s2qNAI610wBW/dMDxXHsgmr1ZBb5m+64e2vYaQUevoA38hX0KkCgIuTpMhXh65sTTxdc4w=
Received: by 10.100.172.17 with SMTP id u17mr5146860ane.1194728699541;
        Sat, 10 Nov 2007 13:04:59 -0800 (PST)
Received: from ?192.168.1.6? ( [76.114.134.202])
        by mx.google.com with ESMTPS id 11sm4412213wrl.2007.11.10.13.04.57
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 10 Nov 2007 13:04:58 -0800 (PST)
Message-ID: <47361C43.6030506@gmail.com>
Date: Sat, 10 Nov 2007 16:01:55 -0500
From: Ryan McKinley <ryantxu@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: restoring a corrupt index?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Using solr, we have been running an indexing process for a while and 
when I checked on it today, it spits out an error:

java.lang.RuntimeException: java.io.FileNotFoundException: 
/path/to/index/_cf9.fnm (No such file or directory)
	at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:584)
	at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:475)

Looking through the archives, it looks like we are up a creek.

Any thoughts on what could have caused this?  The log files contains 
some 'too many open files' errors, I can't tell if that corresponds with 
when the index went bad though.

the startup script includes:
  ulimit -n 100000
which seems generous, no?

it is a 22GB index, ls -l | wc shows 180K files (oh my)

So my questions:

1. Anything I can do to use this index while I rebuild another? (takes a 
long time!)

2. Does the ulimit number explain how the index got corrupted?  If so, 
it seems like a problem.


thanks
ryan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30957-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 21:20:45 2007
Return-Path: <java-user-return-30957-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3126 invoked from network); 10 Nov 2007 21:20:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 21:20:45 -0000
Received: (qmail 49006 invoked by uid 500); 10 Nov 2007 21:20:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48933 invoked by uid 500); 10 Nov 2007 21:20:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48922 invoked by uid 99); 10 Nov 2007 21:20:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:20:27 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.132.244 as permitted sender)
Received: from [209.85.132.244] (HELO an-out-0708.google.com) (209.85.132.244)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 21:20:31 +0000
Received: by an-out-0708.google.com with SMTP id d40so144123and
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 13:20:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=kUtoERjDkjgf84iZ1sLw82lQ4g+OGZMqbuOlwLCDfMo=;
        b=a2f1SEbKMe/K3X1Jj0mYbdN6zPIDVfVVxP1TeVoj0jrE8vUbeqc7zuyim5nsE7mPnGDg7Sa/oXuaEq6av5u5VtLLaA3uGeKjx6Y3h/EPyxlY84L1vulZpBfiCWKSMidHtvfCKPdd62Z5vtxoZaatyaOa8MNzhamJe1mIv4GRb7k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=sAJF1SjmO/XP45F2UP9quwmyYLRgP83TBGDaQlBTyizw6+6PjkqVL58OiEJacRkKw1T2xPExYt6/ieF7Y9/AOkbPTofx+yxr/PsCnB64IGFdvNKEICSIcAQmtaTOXKH1ydNmlUGBWi1qCHYA9PskxlwZdlsPPHpRYSOQP+Pm9S4=
Received: by 10.142.103.6 with SMTP id a6mr824504wfc.1194729603448;
        Sat, 10 Nov 2007 13:20:03 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Sat, 10 Nov 2007 13:20:03 -0800 (PST)
Message-ID: <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
Date: Sat, 10 Nov 2007 16:20:03 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
In-Reply-To: <47361C43.6030506@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <47361C43.6030506@gmail.com>
X-Google-Sender-Auth: a098adbb2d517dc4
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 10, 2007 4:01 PM, Ryan McKinley <ryantxu@gmail.com> wrote:
> Using solr, we have been running an indexing process for a while and
> when I checked on it today, it spits out an error:
>
> java.lang.RuntimeException: java.io.FileNotFoundException:
> /path/to/index/_cf9.fnm (No such file or directory)
>         at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:584)
>         at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:475)
>
> Looking through the archives, it looks like we are up a creek.
>
> Any thoughts on what could have caused this?  The log files contains
> some 'too many open files' errors, I can't tell if that corresponds with
> when the index went bad though.

Yup... that would most likely be it.

> the startup script includes:
>   ulimit -n 100000
> which seems generous, no?

The kernel may have a lower limit.

> it is a 22GB index, ls -l | wc shows 180K files (oh my)

I don't think any index with a normal mergeFactor should have that many files.
Most of these files are probably unreferenced by the current index but
haven't been cleaned up due to the errors with file descriptors.

> So my questions:
>
> 1. Anything I can do to use this index while I rebuild another? (takes a
> long time!)

Doubt it... you would never be sure if the index was correct.

> 2. Does the ulimit number explain how the index got corrupted?  If so,
> it seems like a problem.

I think newest lucene versions would prevent this with
lucene_autocommit=false.  A new segments file (the file which
references all other files in the current index) is not written until
a close of the writer.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30958-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 21:24:34 2007
Return-Path: <java-user-return-30958-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3409 invoked from network); 10 Nov 2007 21:24:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 21:24:34 -0000
Received: (qmail 50871 invoked by uid 500); 10 Nov 2007 21:24:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50831 invoked by uid 500); 10 Nov 2007 21:24:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50819 invoked by uid 99); 10 Nov 2007 21:24:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:24:16 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.66] (HELO spunkymail-a9.g.dreamhost.com) (208.97.132.66)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 21:24:17 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a9.g.dreamhost.com (Postfix) with ESMTP id DA01821192
	for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 13:23:55 -0800 (PST)
Message-Id: <0F9DC074-E194-418B-8761-A4C2F134ABE6@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <47361C43.6030506@gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: restoring a corrupt index?
Date: Sat, 10 Nov 2007 16:23:54 -0500
References: <47361C43.6030506@gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Would this help: https://issues.apache.org/jira/browse/LUCENE-1020


On Nov 10, 2007, at 4:01 PM, Ryan McKinley wrote:

> Using solr, we have been running an indexing process for a while and  
> when I checked on it today, it spits out an error:
>
> java.lang.RuntimeException: java.io.FileNotFoundException: /path/to/ 
> index/_cf9.fnm (No such file or directory)
> 	at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:584)
> 	at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:475)
>
> Looking through the archives, it looks like we are up a creek.
>
> Any thoughts on what could have caused this?  The log files contains  
> some 'too many open files' errors, I can't tell if that corresponds  
> with when the index went bad though.
>
> the startup script includes:
> ulimit -n 100000
> which seems generous, no?
>
> it is a 22GB index, ls -l | wc shows 180K files (oh my)
>
> So my questions:
>
> 1. Anything I can do to use this index while I rebuild another?  
> (takes a long time!)
>
> 2. Does the ulimit number explain how the index got corrupted?  If  
> so, it seems like a problem.
>
>
> thanks
> ryan
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Boot Camp Training:
ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30959-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 21:29:34 2007
Return-Path: <java-user-return-30959-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3992 invoked from network); 10 Nov 2007 21:29:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 21:29:34 -0000
Received: (qmail 54090 invoked by uid 500); 10 Nov 2007 21:29:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 54062 invoked by uid 500); 10 Nov 2007 21:29:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 54048 invoked by uid 99); 10 Nov 2007 21:29:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:29:16 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 21:29:16 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 94C744654A
	for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 16:28:55 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Sat, 10 Nov 2007 16:28:55 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 764F044049; Sat, 10 Nov 2007 16:28:55 -0500 (EST)
Message-Id: <1194730135.31119.1220622077@webmail.messagingengine.com>
X-Sasl-Enc: FwVgFPBi8i/GMGEH/law45O8XSOq7BrcWMFJ4VtAcdBs 1194730135
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47361C43.6030506@gmail.com>
   <0F9DC074-E194-418B-8761-A4C2F134ABE6@apache.org>
Subject: Re: restoring a corrupt index?
In-Reply-To: <0F9DC074-E194-418B-8761-A4C2F134ABE6@apache.org>
Date: Sat, 10 Nov 2007 16:28:55 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


> Would this help: https://issues.apache.org/jira/browse/LUCENE-1020

That should help here, but please proceed with caution: this tool is
very new, has only been tested on trunk indices, and is brutal in how
it recovers the index (it removes the entire segment if there is any
problem loading one of its files).

You can run it without "-fix" and it will report details & any errors
it in loading your index.

Mike

"Grant Ingersoll" <gsingers@apache.org> wrote:
> Would this help: https://issues.apache.org/jira/browse/LUCENE-1020
> 
> 
> On Nov 10, 2007, at 4:01 PM, Ryan McKinley wrote:
> 
> > Using solr, we have been running an indexing process for a while and  
> > when I checked on it today, it spits out an error:
> >
> > java.lang.RuntimeException: java.io.FileNotFoundException: /path/to/ 
> > index/_cf9.fnm (No such file or directory)
> > 	at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:584)
> > 	at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:475)
> >
> > Looking through the archives, it looks like we are up a creek.
> >
> > Any thoughts on what could have caused this?  The log files contains  
> > some 'too many open files' errors, I can't tell if that corresponds  
> > with when the index went bad though.
> >
> > the startup script includes:
> > ulimit -n 100000
> > which seems generous, no?
> >
> > it is a 22GB index, ls -l | wc shows 180K files (oh my)
> >
> > So my questions:
> >
> > 1. Anything I can do to use this index while I rebuild another?  
> > (takes a long time!)
> >
> > 2. Does the ulimit number explain how the index got corrupted?  If  
> > so, it seems like a problem.
> >
> >
> > thanks
> > ryan
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
> 
> Lucene Boot Camp Training:
> ApacheCon Atlanta, Nov. 12, 2007.  Sign up now!  http://www.apachecon.com
> 
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30960-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 21:34:56 2007
Return-Path: <java-user-return-30960-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6618 invoked from network); 10 Nov 2007 21:34:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 21:34:56 -0000
Received: (qmail 56943 invoked by uid 500); 10 Nov 2007 21:34:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56913 invoked by uid 500); 10 Nov 2007 21:34:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56902 invoked by uid 99); 10 Nov 2007 21:34:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:34:38 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 21:35:23 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id C95C646832
	for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 16:34:20 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Sat, 10 Nov 2007 16:34:20 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id A96F243FBE; Sat, 10 Nov 2007 16:34:20 -0500 (EST)
Message-Id: <1194730460.31785.1220622099@webmail.messagingengine.com>
X-Sasl-Enc: nXVfojyt6TnJoYMBSLuCeRTbYGleZohhOL6VBTKSElfX 1194730460
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47361C43.6030506@gmail.com>
   <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
Subject: Re: restoring a corrupt index?
In-Reply-To: <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
Date: Sat, 10 Nov 2007 16:34:20 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Yonik Seeley" <yonik@apache.org> wrote:
> On Nov 10, 2007 4:01 PM, Ryan McKinley <ryantxu@gmail.com> wrote:
> > Using solr, we have been running an indexing process for a while and
> > when I checked on it today, it spits out an error:
> >
> > java.lang.RuntimeException: java.io.FileNotFoundException:
> > /path/to/index/_cf9.fnm (No such file or directory)
> >         at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:584)
> >         at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:475)
> >
> > Looking through the archives, it looks like we are up a creek.
> >
> > Any thoughts on what could have caused this?  The log files contains
> > some 'too many open files' errors, I can't tell if that corresponds with
> > when the index went bad though.
> 
> Yup... that would most likely be it.

How can this lead to index corruption?  The "no such file or directory" on
loading _cf9.fnm sounds like index corruption?

Or maybe the index is not corrupt but then we are hitting the descriptor limit
on opening a searcher and it's being reported as "no such file or directory"?

If so, maybe opening an IndexWriter and optimizing the index would recover
it?  (Make a backup copy of the index first!).

> > 2. Does the ulimit number explain how the index got corrupted?  If so,
> > it seems like a problem.
> 
> I think newest lucene versions would prevent this with
> lucene_autocommit=false.  A new segments file (the file which
> references all other files in the current index) is not written until
> a close of the writer.

Yonik do you understand why so many unreferenced files are being produced
here?  What's the root cause?

Mike


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30961-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 21:46:30 2007
Return-Path: <java-user-return-30961-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11448 invoked from network); 10 Nov 2007 21:46:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 21:46:29 -0000
Received: (qmail 72546 invoked by uid 500); 10 Nov 2007 21:46:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72515 invoked by uid 500); 10 Nov 2007 21:46:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72504 invoked by uid 99); 10 Nov 2007 21:46:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:46:11 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 64.233.162.227 as permitted sender)
Received: from [64.233.162.227] (HELO nz-out-0506.google.com) (64.233.162.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 21:46:15 +0000
Received: by nz-out-0506.google.com with SMTP id i28so622609nzi
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 13:45:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=N9eAheGAET2Hp/+poHbVACbymqMaMqmX5l6rTeYop9U=;
        b=mX9iHQJ5AbZDvZFworzajbzCl/rcIDr4YEjIip0k2dXzzCL6na+Gn+5h/eYRqrxdwD+vYZHl9lykJTnrjQ2l6fF2D/KrczRXod7MLqc65gerg53dFggGTatMnaC1ZrsAnz5AEL9/tG2GFDn0PUzOwfZdv59wpbb4CDsZoPKIgQM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=LC9QOAEMmwNe5qoO4xT1U5N1T5Oa0672aVjCKpSM+Xxwu1ZYe4DlW26F2DrESaW6o/JxxeuIMvIuTwyAzAFXmlIqjiabYpFguYRWg15pUy7Q9BUkgzWg3Gg3pW59Ih7LRwRycvdb01Vr5WicRf2Hl2G6MxCJtUnRvzqj4eAMMaA=
Received: by 10.142.185.13 with SMTP id i13mr470439wff.1194731153427;
        Sat, 10 Nov 2007 13:45:53 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Sat, 10 Nov 2007 13:45:53 -0800 (PST)
Message-ID: <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
Date: Sat, 10 Nov 2007 16:45:53 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
In-Reply-To: <1194730460.31785.1220622099@webmail.messagingengine.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <47361C43.6030506@gmail.com>
	 <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
	 <1194730460.31785.1220622099@webmail.messagingengine.com>
X-Google-Sender-Auth: c0dd8e3dbc5f85b9
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 10, 2007 4:34 PM, Michael McCandless <lucene@mikemccandless.com> wrote:
>
> "Yonik Seeley" <yonik@apache.org> wrote:
> > On Nov 10, 2007 4:01 PM, Ryan McKinley <ryantxu@gmail.com> wrote:
> > > Using solr, we have been running an indexing process for a while and
> > > when I checked on it today, it spits out an error:
> > >
> > > java.lang.RuntimeException: java.io.FileNotFoundException:
> > > /path/to/index/_cf9.fnm (No such file or directory)
> > >         at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:584)
> > >         at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:475)
> > >
> > > Looking through the archives, it looks like we are up a creek.
> > >
> > > Any thoughts on what could have caused this?  The log files contains
> > > some 'too many open files' errors, I can't tell if that corresponds with
> > > when the index went bad though.
> >
> > Yup... that would most likely be it.
>
> How can this lead to index corruption?  The "no such file or directory" on
> loading _cf9.fnm sounds like index corruption?

I don't think older versions of lucene handled these errors as well.
Perhaps _cf9.fnm failed to be written, but the segments file succeeded.
It could also be Solr's fault for allowing further operations on an
index after one failed?  I'm not sure how that should be handled.

> Or maybe the index is not corrupt but then we are hitting the descriptor limit
> on opening a searcher and it's being reported as "no such file or directory"?

Hmmm, yes that's possible too...
Should be easy to tell by checking if the file _cf9.fnm already exists.

> If so, maybe opening an IndexWriter and optimizing the index would recover
> it?  (Make a backup copy of the index first!).
>
> > > 2. Does the ulimit number explain how the index got corrupted?  If so,
> > > it seems like a problem.
> >
> > I think newest lucene versions would prevent this with
> > lucene_autocommit=false.  A new segments file (the file which
> > references all other files in the current index) is not written until
> > a close of the writer.
>
> Yonik do you understand why so many unreferenced files are being produced
> here?  What's the root cause?

Just guesses... but perhaps new index files are written but things
fail before the stage where old files are deleted?

Ryan, what version of lucene is this version of Solr using?

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30962-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 21:58:02 2007
Return-Path: <java-user-return-30962-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13006 invoked from network); 10 Nov 2007 21:58:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 21:58:02 -0000
Received: (qmail 77666 invoked by uid 500); 10 Nov 2007 21:57:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77630 invoked by uid 500); 10 Nov 2007 21:57:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77617 invoked by uid 99); 10 Nov 2007 21:57:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 13:57:44 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ryantxu@gmail.com designates 209.85.132.241 as permitted sender)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 21:58:28 +0000
Received: by an-out-0708.google.com with SMTP id d40so145192and
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 13:57:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=scIQCQMIPpCVlzM5/C3SVQNaNCBzVrnbGGmkxyDEhfY=;
        b=YRZpG55tLxy3k4kaLqook/FYCxckwuaYoJ4ugRH+3m+TSTVZXfkqkXGNEvTLxtbXSI0dBXPAUO9Y6UHd/DVDfo+um3aWcFXJ8kQtFfkK0sytMmZNBYKE5M6Wdc5DTSBA7qYNCBC3vHGt0xyDvsj7FoMOBJoiCbG7d3LPCtEIOCQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=TaGKt94wjFveyn2lzeP1XQq16DvC30nSP6j7Vf07Cq3nQbJKMrHEILtHV26hA/ypcTfBkN8taYbGTrXGkjmz8dCAwTqoyMpxnVWoFUJT+HgwBiIwg+xeUefIli7k7SUpXTNgqK+14fMkr/79W7HFVnqrIQaI++1qQgqHcML/TwM=
Received: by 10.100.226.15 with SMTP id y15mr5198686ang.1194731845324;
        Sat, 10 Nov 2007 13:57:25 -0800 (PST)
Received: from ?192.168.1.6? ( [76.114.134.202])
        by mx.google.com with ESMTPS id q30sm3906860wrq.2007.11.10.13.57.23
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 10 Nov 2007 13:57:24 -0800 (PST)
Message-ID: <4736288B.4090104@gmail.com>
Date: Sat, 10 Nov 2007 16:54:19 -0500
From: Ryan McKinley <ryantxu@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
References: <47361C43.6030506@gmail.com>	 <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>	 <1194730460.31785.1220622099@webmail.messagingengine.com> <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
In-Reply-To: <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


thanks for all the replies

>> Yonik do you understand why so many unreferenced files are being produced
>> here?  What's the root cause?
> 

This is an index that has the same documents get updated many times, 
that could build up old files w/o optimizing.


> Just guesses... but perhaps new index files are written but things
> fail before the stage where old files are deleted?
> 
> Ryan, what version of lucene is this version of Solr using?
> 

solr trunk from a few weeks back.  packaged lucene jar is lucene-core-2.2.0


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30963-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 22:01:56 2007
Return-Path: <java-user-return-30963-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13887 invoked from network); 10 Nov 2007 22:01:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 22:01:56 -0000
Received: (qmail 80338 invoked by uid 500); 10 Nov 2007 22:01:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80308 invoked by uid 500); 10 Nov 2007 22:01:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80296 invoked by uid 99); 10 Nov 2007 22:01:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 14:01:38 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 22:01:40 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 7D8E845BF3
	for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 17:01:19 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Sat, 10 Nov 2007 17:01:19 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 2E49F44098; Sat, 10 Nov 2007 17:01:19 -0500 (EST)
Message-Id: <1194732079.3067.1220624239@webmail.messagingengine.com>
X-Sasl-Enc: +23Kgx2wWifptx+cmao+/TeHBSMWPUmoBRZEy6099FTd 1194732079
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47361C43.6030506@gmail.com>
   <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
   <1194730460.31785.1220622099@webmail.messagingengine.com>
   <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
Subject: Re: restoring a corrupt index?
In-Reply-To: <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
Date: Sat, 10 Nov 2007 17:01:19 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Yonik Seeley" <yonik@apache.org> wrote:

> > How can this lead to index corruption?  The "no such file or directory" on
> > loading _cf9.fnm sounds like index corruption?
> 
> I don't think older versions of lucene handled these errors as well.
> Perhaps _cf9.fnm failed to be written, but the segments file succeeded.
> It could also be Solr's fault for allowing further operations on an
> index after one failed?  I'm not sure how that should be handled.

Ahh, OK.

Yeah it's not clear how Solr should handle this case, though Lucene
should be at (get to?) the point where on exception no harm to the
index can be done.  Ie, index on disk is left consistent, and, the
state of the writer is such that it can't corrupt the index even if
it's further used after the exception.

> > Or maybe the index is not corrupt but then we are hitting the descriptor limit
> > on opening a searcher and it's being reported as "no such file or directory"?
> 
> Hmmm, yes that's possible too...
> Should be easy to tell by checking if the file _cf9.fnm already exists.

Oh yeah.  Ryan, does that file exist?

> > Yonik do you understand why so many unreferenced files are being produced
> > here?  What's the root cause?
> 
> Just guesses... but perhaps new index files are written but things
> fail before the stage where old files are deleted?

OK, though, writer doesn't use many descriptors at all, right?  It
opens 1 segment's worth to flush, and mergeFactor+1 segment's worth to
merge.  It's spooky if Lucene can create zillions of un-referenced
files.  Would be good to get to the root cause & make sure it's really
fixed on trunk.

Or, maybe they are all referenced -- I think there were issues with
the old merge policy that could cause segments to not be merged when
they should have been?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30964-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 22:12:15 2007
Return-Path: <java-user-return-30964-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15765 invoked from network); 10 Nov 2007 22:12:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 22:12:13 -0000
Received: (qmail 86251 invoked by uid 500); 10 Nov 2007 22:11:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86220 invoked by uid 500); 10 Nov 2007 22:11:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86208 invoked by uid 99); 10 Nov 2007 22:11:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 14:11:56 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 209.85.132.243 as permitted sender)
Received: from [209.85.132.243] (HELO an-out-0708.google.com) (209.85.132.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 22:11:58 +0000
Received: by an-out-0708.google.com with SMTP id d40so145469and
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 14:11:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=NtcKelbMK40GFx+Q0VJGyjjsvOc1d1nZVCQN3N55IyI=;
        b=l6M6aR4qcyJB1HG74k23PZdzRsPfdD4/uF6Ih3RzxJn/GCTLuyQvPh4OkeQ0Evp7bpZzZLRjdeJjthoSyPHejuQp/qoE9HZ+T/6GhTQ7GHZG+lDvnAvfSqhb93k5zkUXvrhq1feMb1tlr+2ArZt17bmWIwgHPWrYPjA5I/fIHwg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=c3fZIwDrvKN1YbnGOz9INi5St8yosn8UNtfFHbp2Bu708G9cZ2rIrXRRlBLBSSLb1EUo5kbwifTRUBG2UXkNgZ5sZL1TQsy8/ETAtmAgjiHZvFuVI3soa0lmvoq1N2dqkfiV69VBs67AWocK6qSHbahmTLRbHP7zAKFrBp8+TUk=
Received: by 10.100.247.14 with SMTP id u14mr5212373anh.1194732697651;
        Sat, 10 Nov 2007 14:11:37 -0800 (PST)
Received: from ?192.168.1.6? ( [76.114.134.202])
        by mx.google.com with ESMTPS id 10sm2932592wrl.2007.11.10.14.11.34
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sat, 10 Nov 2007 14:11:35 -0800 (PST)
Message-ID: <47362BE0.80202@gmail.com>
Date: Sat, 10 Nov 2007 17:08:32 -0500
From: Ryan McKinley <ryantxu@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
References: <47361C43.6030506@gmail.com>   <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>   <1194730460.31785.1220622099@webmail.messagingengine.com>   <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com> <1194732079.3067.1220624239@webmail.messagingengine.com>
In-Reply-To: <1194732079.3067.1220624239@webmail.messagingengine.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

> 
>>> Or maybe the index is not corrupt but then we are hitting the descriptor limit
>>> on opening a searcher and it's being reported as "no such file or directory"?
>> Hmmm, yes that's possible too...
>> Should be easy to tell by checking if the file _cf9.fnm already exists.
> 
> Oh yeah.  Ryan, does that file exist?
> 

no luck.
ryan@posh:~$ ls -l /array/home/nestor/data2/flat/index/_cf9.fnm
ls: /array/home/nestor/data2/flat/index/_cf9.fnm: No such file or directory


I'm backing up the broken index now and will try:

1. run optimize and hope for the best
2. LUCENE-1020

and then hope for the best.

The index takes ~week to build so even having something with a block of 
stuff missing is better then zero (or gulp, our last backup)

thanks
ryan




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30965-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 22:23:35 2007
Return-Path: <java-user-return-30965-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17992 invoked from network); 10 Nov 2007 22:23:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 22:23:34 -0000
Received: (qmail 92916 invoked by uid 500); 10 Nov 2007 22:23:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92877 invoked by uid 500); 10 Nov 2007 22:23:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92866 invoked by uid 99); 10 Nov 2007 22:23:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 14:23:17 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 66.249.92.175 as permitted sender)
Received: from [66.249.92.175] (HELO ug-out-1314.google.com) (66.249.92.175)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 22:23:20 +0000
Received: by ug-out-1314.google.com with SMTP id h3so753846ugf
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 14:22:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=oflai4CeP68iBGkOnUKU3JeIFAZJElV6ZNb2deBCy70=;
        b=mUPTJ0z/xY3LtLTYiMDF+tBbUWCjsvbUv5Bc1wmUWNJBDqNGm20Oj6ij31d5bj02HWGk/PMoF5QwCxertaVQE1Uyb3+QAfHso/YR/pmsSVWBtJZInIrzypT4BzrIuam1APaTLyPanfBghqUctP1tjcZotXX8VabgntGXB8O9KLU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=cC2KdQyUWEJxnEusVhm8KUqDR8K8VslBkURib2sy5JJy1EGYH0SoFDbCsazrN65JCyhIaYZdB4rMMJzC/sivIj32QSVpPwJaVdQzHBEw4l3dC8cfcgnHciyct5upARlVV09wdwHxL6An4kvNrVuh/SobaB4gVcePb6RdokUrSM4=
Received: by 10.142.109.16 with SMTP id h16mr825406wfc.1194733376600;
        Sat, 10 Nov 2007 14:22:56 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Sat, 10 Nov 2007 14:22:56 -0800 (PST)
Message-ID: <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
Date: Sat, 10 Nov 2007 17:22:56 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
In-Reply-To: <1194732079.3067.1220624239@webmail.messagingengine.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <47361C43.6030506@gmail.com>
	 <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
	 <1194730460.31785.1220622099@webmail.messagingengine.com>
	 <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
	 <1194732079.3067.1220624239@webmail.messagingengine.com>
X-Google-Sender-Auth: 556a0dd09fc6d067
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 10, 2007 5:01 PM, Michael McCandless <lucene@mikemccandless.com> wrote:
> "Yonik Seeley" <yonik@apache.org> wrote:
>
> > > How can this lead to index corruption?  The "no such file or directory" on
> > > loading _cf9.fnm sounds like index corruption?
> >
> > I don't think older versions of lucene handled these errors as well.
> > Perhaps _cf9.fnm failed to be written, but the segments file succeeded.
> > It could also be Solr's fault for allowing further operations on an
> > index after one failed?  I'm not sure how that should be handled.
>
> Ahh, OK.
>
> Yeah it's not clear how Solr should handle this case, though Lucene
> should be at (get to?) the point where on exception no harm to the
> index can be done.  Ie, index on disk is left consistent, and, the
> state of the writer is such that it can't corrupt the index even if
> it's further used after the exception.

Right... keep in mind concurrent updates too... it's pretty much
impossible for the user-level to avoid other calls to addDocument()
from going ahead since they can be in different threads.

> OK, though, writer doesn't use many descriptors at all, right?

Yeah, but other things might be usng up the descriptors... there is
probably an open searcher for searching, possibly another one warming
in the background,   plus whatever else is going on in the servlet
container.

Ryan, are you using stock solr, or embedded?  Anything that might
prevent old searchers from being closed (you chould check the log
files for #opens vs #closes)

>  It
> opens 1 segment's worth to flush, and mergeFactor+1 segment's worth to
> merge.  It's spooky if Lucene can create zillions of un-referenced
> files.

Perhaps unreferenced files may not be deleted if an exception is
encountered first, or perhaps even the deleter is failing due to lack
of descriptors.

> Would be good to get to the root cause & make sure it's really
> fixed on trunk.

Is there a tool we could have ryan point at the segments file and get
a dump of the referenced segments?

> Or, maybe they are all referenced -- I think there were issues with
> the old merge policy that could cause segments to not be merged when
> they should have been?

That should not have been the case in Lucene 2.2 I think.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30966-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 22:41:10 2007
Return-Path: <java-user-return-30966-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21655 invoked from network); 10 Nov 2007 22:41:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 22:41:10 -0000
Received: (qmail 98209 invoked by uid 500); 10 Nov 2007 22:40:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 98011 invoked by uid 500); 10 Nov 2007 22:40:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 98000 invoked by uid 99); 10 Nov 2007 22:40:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 14:40:51 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 22:40:55 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id B204346A93
	for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 17:40:34 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Sat, 10 Nov 2007 17:40:34 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 8A27B440D5; Sat, 10 Nov 2007 17:40:34 -0500 (EST)
Message-Id: <1194734434.8784.1220626841@webmail.messagingengine.com>
X-Sasl-Enc: Rt0F20eJtGPSzhmow2eEgSL2qgGaVNMtEKL7ddDKeJo4 1194734434
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47361C43.6030506@gmail.com>
   <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
   <1194730460.31785.1220622099@webmail.messagingengine.com>
   <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
   <1194732079.3067.1220624239@webmail.messagingengine.com>
   <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
Subject: Re: restoring a corrupt index?
In-Reply-To: <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
Date: Sat, 10 Nov 2007 17:40:34 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Yonik Seeley" <yonik@apache.org> wrote:
> On Nov 10, 2007 5:01 PM, Michael McCandless <lucene@mikemccandless.com>
> wrote:
> > "Yonik Seeley" <yonik@apache.org> wrote:
> >
> > > > How can this lead to index corruption?  The "no such file or directory" on
> > > > loading _cf9.fnm sounds like index corruption?
> > >
> > > I don't think older versions of lucene handled these errors as well.
> > > Perhaps _cf9.fnm failed to be written, but the segments file succeeded.
> > > It could also be Solr's fault for allowing further operations on an
> > > index after one failed?  I'm not sure how that should be handled.
> >
> > Ahh, OK.
> >
> > Yeah it's not clear how Solr should handle this case, though Lucene
> > should be at (get to?) the point where on exception no harm to the
> > index can be done.  Ie, index on disk is left consistent, and, the
> > state of the writer is such that it can't corrupt the index even if
> > it's further used after the exception.
> 
> Right... keep in mind concurrent updates too... it's pretty much
> impossible for the user-level to avoid other calls to addDocument()
> from going ahead since they can be in different threads.

Ahh, true.

> > OK, though, writer doesn't use many descriptors at all, right?
> 
> Yeah, but other things might be usng up the descriptors... there is
> probably an open searcher for searching, possibly another one warming
> in the background,   plus whatever else is going on in the servlet
> container.

OK.

> Ryan, are you using stock solr, or embedded?  Anything that might
> prevent old searchers from being closed (you chould check the log
> files for #opens vs #closes)
> 
> >  It
> > opens 1 segment's worth to flush, and mergeFactor+1 segment's worth to
> > merge.  It's spooky if Lucene can create zillions of un-referenced
> > files.
> 
> Perhaps unreferenced files may not be deleted if an exception is
> encountered first, or perhaps even the deleter is failing due to lack
> of descriptors.

OK.  Still spooky that this failure mode is possible on 2.2.

> > Would be good to get to the root cause & make sure it's really
> > fixed on trunk.
> 
> Is there a tool we could have ryan point at the segments file and get
> a dump of the referenced segments?

LUCENE-1020 will print the details of all segments ... hmmm, I see
that I'm not closing each SegmentReader in that tool.  OK I just committed
a fix.  Otherwise I think Ryan would hit file descriptor limit (if these
files are referenced).

Ryan are you able to update to that commit I just did?  If so I think
you should run the tool without -fix and post back what it printed.  It
should report an error on that one segment due to the missing file.
Then, run -fix to remove that segment (please backup your index first!).
Then, if you have a zillion segments in the index, try optimizing it?

Oh, hang on: you can't run -fix because this tool will write a
segments_N file in the current trunk format, which is different
from 2.2.x.  It would not be hard to port the tool back to 2.2:
just comment out those System.out.println's that hit compilation
errors.

> > Or, maybe they are all referenced -- I think there were issues with
> > the old merge policy that could cause segments to not be merged when
> > they should have been?
> 
> That should not have been the case in Lucene 2.2 I think.

Ahh, right.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30967-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 10 22:49:51 2007
Return-Path: <java-user-return-30967-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24062 invoked from network); 10 Nov 2007 22:49:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 10 Nov 2007 22:49:51 -0000
Received: (qmail 3251 invoked by uid 500); 10 Nov 2007 22:49:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3219 invoked by uid 500); 10 Nov 2007 22:49:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3208 invoked by uid 99); 10 Nov 2007 22:49:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 14:49:34 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 64.233.162.227 as permitted sender)
Received: from [64.233.162.227] (HELO nz-out-0506.google.com) (64.233.162.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 22:49:38 +0000
Received: by nz-out-0506.google.com with SMTP id i28so626326nzi
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 14:49:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=L3RCCZm7u2zxKsGa2l3oyil/lDZiVW+ntS27LAIYXoM=;
        b=tPRl/zt7Peotoq9PGenLpaM2ylaaZZ5k52m2cYIgVD/5RcecdI81Xdo5ICRz0OU/hp8vH0+3mBLcQ3e14Q7JVlatShgmMuRlOwNxy0g4PHsyJmtOa/XOqxCWDPTg93f6m2vTAS4+ZOnUiY2n7tz+S24pJbKCp3hmbghzDgV9mFY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=f5JOj827xLlATpldm02zvBjCLfMsn+pisZl8EJADB9HNNpfEOLtBae9C/JiXOexVMC0nmj8NsniLd9ETwi4W4NWVpEY64sz4UXNB65BzH2TkHwUqHGHSwosxZXCDuJ/r3dq5FGBp/UzIEDuidca8A1Ar/b6uIqZgDYVsnRWc6VI=
Received: by 10.142.139.19 with SMTP id m19mr831038wfd.1194734956914;
        Sat, 10 Nov 2007 14:49:16 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Sat, 10 Nov 2007 14:49:16 -0800 (PST)
Message-ID: <c68e39170711101449p1c52da76j1b451eeff9cecc26@mail.gmail.com>
Date: Sat, 10 Nov 2007 17:49:16 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: TermDocs.skipTo error
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5183@biscuit.ARDENTIASEARCH.local>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
	 <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5182@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5183@biscuit.ARDENTIASEARCH.local>
X-Google-Sender-Auth: 1499d9720ec28ead
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 9, 2007 11:40 AM, Mike Streeton <mike.streeton@ardentiasearch.com> wrote:
> I have just tried this again using the index I built with lucene 2.1 but running the test using lucene 2.2 and it works okay, so it seems to be something related to an index built using lucene 2.2.

I bet you are triggering an issue in multi-level skip lists by
attempting to skipTo a target past maxDoc (which per the javadoc,
seems like it should be legal).

So a short term workaround for you might be to first test if the
target you are trying to skip to is less than maxDoc().

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30968-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 02:45:50 2007
Return-Path: <java-user-return-30968-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76404 invoked from network); 11 Nov 2007 02:45:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 02:45:50 -0000
Received: (qmail 56972 invoked by uid 500); 11 Nov 2007 02:45:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56945 invoked by uid 500); 11 Nov 2007 02:45:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56934 invoked by uid 99); 11 Nov 2007 02:45:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Nov 2007 18:45:32 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of cedric.ho@gmail.com designates 209.85.146.179 as permitted sender)
Received: from [209.85.146.179] (HELO wa-out-1112.google.com) (209.85.146.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 02:45:33 +0000
Received: by wa-out-1112.google.com with SMTP id j40so1195685wah
        for <java-user@lucene.apache.org>; Sat, 10 Nov 2007 18:45:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=BbXSkuOCHUr9GaJXR6Aqo6QqjbKEfhnSsajU+EYLsz8=;
        b=NkyPC8qmdcbkGkRgEv8TAxX3gFkI14zB8NW5WlJmzhczu5XYIbcgskHLZb/948uPPmZ38t2/qIX2K0lGANJWteLqr0QoNhGanysHR0LFw35s7yAs/MIkWStXiUki6qikH/Nqo683iW+QBZSibvM6UNOIJoKJnvJ9ZOYSQscWqQg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=XS+NTsPEqp21fku9aqMNAG9EbbgZX/YyfHIwkI37Hk82yH7tSm6EQJtPbT2msx4o1u5Szw5YZn9HMulm4ErNK7kvTbH+J9NOfef17Bt9HFXWcG6nX0IsRVKADnK0lgKXjIWvoTVhPO6G9+ptAZXBVYprQxG7zuEgQx7cNfhLAJY=
Received: by 10.114.177.1 with SMTP id z1mr661976wae.1194749112974;
        Sat, 10 Nov 2007 18:45:12 -0800 (PST)
Received: by 10.114.52.11 with HTTP; Sat, 10 Nov 2007 18:45:12 -0800 (PST)
Message-ID: <839ba01c0711101845v3c572b75m2362a31a7e66a574@mail.gmail.com>
Date: Sun, 11 Nov 2007 10:45:12 +0800
From: "Cedric Ho" <cedric.ho@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Chinese Segmentation with Phase Query
In-Reply-To: <D7206503EB5BE94497458AF4FE4AE8AB4F01CD@mzex01.healy-hudson.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: base64
Content-Disposition: inline
References: <839ba01c0711081859h2d485e8vef8d193ae9edb59d@mail.gmail.com>
	 <9294E20AED46934EA459020706463F9450FE0F@SUEXCL-02.ad.syr.edu>
	 <839ba01c0711091727u5744510fk67d82548b53f0a01@mail.gmail.com>
	 <D7206503EB5BE94497458AF4FE4AE8AB4F01CD@mzex01.healy-hudson.com>
X-Virus-Checked: Checked by ClamAV on apache.org

SGkgVXdlLAoKSSBiZWxpZXZlIHRoaXMgaXMgdGhlIHNlZ21lbnRhdGlvbiBtZXRob2QgdXNlZCBi
eSBDSktBbmFseXplciBpbiBMdWNlbmUuClRoZSBwcm9ibGVtIGlzIHdpdGggdGhpcyBBbmFseXpl
ciwgbWFueSBpbmNvcnJlY3QgaGl0cyB3aWxsIGJlCnJldHVybmVkIGR1cmluZyBzZWFyY2guCgpJ
biBmYWN0LCBmb3IgcHVyZSBjaGluZXNlIGRvY3VtZW50IChub3QgY29udGFpbmluZyBFbmdsaXNo
IHdvcmRzKSwgSQpiZWxpZXZlIHRoZXJlJ3Mgbm8gZGlmZmVyZW5jZSBiZXR3ZWVuIHVzaW5nIGEg
Q0pLQW5hbHl6ZXIgb3IgYSBzaW1wbGUKQ2hhclRva2VuaXplci4KCkNoZWVycywKQ2VkcmljCgoK
T24gTm92IDEwLCAyMDA3IDg6MDggUE0sIFV3ZSBHb2V0emtlIDx1d2UuZ29ldHprZUBoZWFseS1o
dWRzb24uY29tPiB3cm90ZToKPiBIaSBDZWRyaWMsCj4KPiBBbHRob3VnaCBJIGhhdmUgbm8gaWRl
YSBob3cgdG8gdXNlIHRoZSBDaGluZXNlIGxhbmd1YWdlCj4gYnV0IEkgd2VudCBhIGRpZmZlcmVu
dCByb3V0ZSB0byBvdmVyY29tZSBsYW5ndWFnZSBzcGVjaWZpYyBwcm9ibGVtcy4KPgo+IEluc3Rl
YWQgb2YgdXNpbmcgYSBsYW5ndWFnZSBzcGVjaWZpYyBzZWdtZW50YXRpb24gd2UgdXNlIG5vdyB0
aGUgc3RhdGlzdGljYWwgc2VnbWVudGF0aW9uIHdpdGggYmlncmFtcwo+Cj4gZS5nLgo+IEdpdmVu
IGEgeW91ciBzZW50ZW5jZSBYWVpBQkNERUYKPiBzdXBwb3NlIHRoZSBzZWdtZW50YXRpb24gaXMK
PiBYWSBZWiBaQSBBQiBCQyBDRCBERSBFRgo+Cj4gQSBTcGFuTmVhclF1ZXJ5IG9mIChYWSwgQkMs
IERFLCBFRikgd2l0aCBkaXN0YW5jZSBvZiAxMCBzaG91bGQgd29yayB0bwo+IG1hdGNoIHRoaXMg
ZG9jdW1lbnQuCj4KPiBJIGFtIG5vdCBzdXJlIGlmIHRoaXMgd29ya3MgaW4geW91ciBjYXNlIGJl
Y2F1c2Ugd2UgaW5kZXggcHJvZHVjdCBpbmZvcm1hdGlvbiBhbmQgdGhlaXIgZGVzY3JpcHRpb25z
IHdoaWNoIGFyZSBub3QgbGFuZ3VhZ2UgZnJpZW5kbHkgYW55d2F5IGJlY2F1c2Ugb2YgdGhlIGFi
YnJldmlhdGlvbnMpCj4KPiBSZWdhcmRzCj4KPiBVd2UgR29ldHprZQo+Cj4KPiAtLS0tLVVyc3By
w7xuZ2xpY2hlIE5hY2hyaWNodC0tLS0tCj4gVm9uOiBDZWRyaWMgSG8gW21haWx0bzpjZWRyaWMu
aG9AZ21haWwuY29tXQo+IEdlc2VuZGV0OiBTYW1zdGFnLCAxMC4gTm92ZW1iZXIgMjAwNyAwMjoy
OAo+IEFuOiBqYXZhLXVzZXJAbHVjZW5lLmFwYWNoZS5vcmcKPiBCZXRyZWZmOiAtIFJlOiBDaGlu
ZXNlIFNlZ21lbnRhdGlvbiB3aXRoIFBoYXNlIFF1ZXJ5Cj4KPgo+IE9uIE5vdiAxMCwgMjAwNyAy
OjA4IEFNLCBTdGV2ZW4gQSBSb3dlIDxzYXJvd2VAc3lyLmVkdT4gd3JvdGU6Cj4gPiBIaSBDZWRy
aWMsCj4gPgo+ID4gT24gMTEvMDgvMjAwNywgQ2VkcmljIEhvIHdyb3RlOgo+ID4gPiBhIHNlbnRl
bmNlIGNvbnRhaW5pbmcgY2hhcmFjdGVycyBBQkMsIGl0IG1heSBiZSBzZWdtZW50ZWQgaW50byBB
QiwgQyBvciBBLCBCQy4KPiA+IFtzbmlwXQo+ID4gPiBJbiB0aGlzIGNhc2VzIHdlIHdvdWxkIGxp
a2UgdG8gaW5kZXggYm90aCBzZWdtZW50YXRpb24gaW50byB0aGUgaW5kZXg6Cj4gPiA+Cj4gPiA+
IEFCIG9mZnNldCAoMCwxKSBwb3NpdGlvbiAwICAgICAgICAgICAgQSBvZmZzZXQgKDAsMCkgcG9z
aXRpb24gMAo+ID4gPiBDIG9mZnNldCAoMiwyKSBwb3NpdGlvbiAxICAgICAgICAgICAgIEJDIG9m
ZnNldCAoMSwyKSBwb3NpdGlvbiAxCj4gPiA+Cj4gPiA+IE5vdyB0aGUgcHJvYmxlbSBpcywgd2hl
biBzb21lb25lIHNlYXJjaCB1c2luZyBhIFBocmFzZVF1ZXJ5IChBQykgaXQKPiA+ID4gd2lsbCBm
aW5kIHRoaXMgbGluZSBBQkMgYmVjYXVzZSBpdCBtYXRjaCBBIChwb3NpdGlvbiAwKSBhbmQgQwo+
ID4gPiAocG9zaXRpb24gMSkuCj4gPiA+Cj4gPiA+IEFyZSB0aGVyZSBhbnkgd2F5cyB0byBzZWFy
Y2ggZm9yIGV4YWN0IG1hdGNoIHVzaW5nIHRoZSBvZmZzZXQKPiA+ID4gaW5mb3JtYXRpb24gaW5z
dGVhZCBvZiB0aGUgcG9zaXRpb24gaW5mb3JtYXRpb24gPwo+ID4KPiA+IFNpbmNlIHlvdSBhcmUg
d3JpdGluZyB0aGUgdG9rZW5pemVyICh0aGUgTHVjZW5lIHRlcm0gZm9yIHRoZSBtb2R1bGUgdGhh
dCBwZXJmb3JtcyB0aGUgc2VnbWVudGF0aW9uKSwgeW91IHlvdXJzZWxmIGNhbiBzdWJzdGl0dXRl
IHRoZSBiZWdpbm5pbmcgb2Zmc2V0IGZvciB0aGUgcG9zaXRpb24uICBCdXQgSSB0aGluayB0aGF0
IHdpdGhvdXQgdGhlIGVuZCBvZmZzZXQsIGl0IHdvbid0IGdldCB5b3Ugd2hhdCB5b3Ugd2FudC4K
PiA+Cj4gPiBGb3IgZXhhbXBsZSwgaWYgeW91ciBhYm92ZSBleGFtcGxlIHdlcmUgaW5kZXhlZCB3
aXRoIGJlZ2lubmluZyBvZmZzZXRzIGFzIHBvc2l0aW9ucywgYSBwaHJhc2UgcXVlcnkgZm9yICJB
QiwgQyIgd2lsbCBmYWlsIHRvIG1hdGNoIC0tIGV2ZW4gdGhvdWdoIGl0IHNob3VsZCBtYXRjaCAt
LSBiZWNhdXNlIHRoZSBzZWdtZW50cycgYmVnaW5uaW5nIG9mZnNldHMgKDAgYW5kIDIpIGFyZSBu
b3QgY29udGlndW91cy4KPiA+Cj4gPiBUaGUgbmV3IFBheWxvYWRzIGZlYXR1cmUgY291bGQgcHJv
dmlkZSB0aGUgYmFzaXMgZm9yIHN0b3JpbmcgYmVnaW5uaW5nIGFuZCBlbmRpbmcgb2Zmc2V0cyBy
ZXF1aXJlZCB0byBkZXRlcm1pbmUgY29udGlndWl0eSB3aGVuIG1hdGNoaW5nIHBocmFzZXMsIGJ1
dCB5b3Ugd291bGQgaGF2ZSB0byB3cml0ZSBtYXRjaGluZyBhbmQgc2NvcmluZyBmb3IgdGhpcyBy
ZXByZXNlbnRhdGlvbiwgYW5kIHRoYXQgbWF5IG5vdCBiZSB0aGUgcXVpY2tlc3Qgcm91dGUgYXZh
aWxhYmxlIHRvIHlvdS4KPiA+Cj4gPiBTb2x1dGlvbiAjMTogQ3JlYXRlIG11bHRpcGxlIGZpZWxk
cywgb25lIGZvciBlYWNoIGZ1bGwgYWx0ZXJuYXRpdmUgc2VnbWVudGF0aW9uLCBhbmQgdGhlbiBx
dWVyeSBhZ2FpbnN0IGFsbCBvZiB0aGVtLgo+ID4KPiA+IFNvbHV0aW9uICMyOiBTdG9yZSB0aGUg
YWx0ZXJuYXRpdmUgc2VnbWVudGF0aW9ucyBpbiB0aGUgc2FtZSBmaWVsZCwgYnV0IGluc3RlYWQg
b2YgaW50ZXJsZWF2aW5nIHRoZSBzZWdtZW50cycgcG9zaXRpb25zLCBhcyBpbiB5b3VyIGV4YW1w
bGUsIG1ha2UgdGhlIHBvc2l0aW9uIHJhbmdlcyBvZiB0aGUgYWx0ZXJuYXRpdmVzIG5vbi1jb250
aWd1b3VzLiAgUmVjYXN0aW5nIHlvdXIgZXhhbXBsZToKPiA+Cj4gPiAgICAgICAgIGx0ZXJuYXRp
dmUgIzEgICBBbHRlcm5hdGl2ZSAjMiAgQWx0ZXJuYXRpdmUgIzMKPiA+ICAgICAgICAgLS0tLS0t
LS0tLS0tLSAgIC0tLS0tLS0tLS0tLS0tICAtLS0tLS0tLS0tLS0tLQo+ID4gICAgICAgICBBQiBw
b3NpdGlvbiAwICAgQSBwb3NpdGlvbiAxMDAgIEEgcG9zaXRpb24gMjAwCj4gPiAgICAgICAgIEMg
cG9zaXRpb24gMSAgICBCQyBwb3NpdGlvbiAxMDEgQiBwb3NpdGlvbiAyMDEKPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQyBwb3NpdGlv
biAyMDIKPiA+Cj4gPiBUaGVyZSBpcyBhIHByb2JsZW0gd2l0aCBib3RoIG9mIHRoZSBhYm92ZS1k
ZXNjcmliZWQgc29sdXRpb25zOiBpbiBteSBsaW1pdGVkIGV4cGVyaWVuY2Ugd2l0aCBDaGluZXNl
IHNlZ21lbnRhdGlvbiwgc3Vic3RhbnRpYWxseSBsZXNzIHRoYW4gaGFsZiB0aGUgdGV4dCBoYXMg
YWx0ZXJuYXRpdmUgc2VnbWVudGF0aW9ucy4gIEFzIGEgcmVzdWx0LCB0aGUgc2VnbWVudHMgb24g
d2hpY2ggYWxsIG9mIGFsdGVybmF0aXZlcyBhZ3JlZSAoY2FsbCB0aGVtICJ1bmNvbnRlc3RlZCBz
ZWdtZW50cyIpIHdpbGwgaGF2ZSBoaWdoZXIgdGVybSBmcmVxdWVuY2llcyB0aGFuIHRob3NlIHNl
Z21lbnRzIHdoaWNoIGRpZmZlciBhbW9uZyB0aGUgYWx0ZXJuYXRpdmVzICgiY29udGVzdGVkIHNl
Z21lbnRzIikuICBUaGlzIG1lYW5zIHRoYXQgZG9jdW1lbnQgc2NvcmVzIHdpbGwgYmUgaW5mbHVl
bmNlZCBieSB0aGUgdmFyaWFibGUgZGVuc2l0eSBvZiB0aGUgY29udGVzdGVkIHNlZ21lbnRzIHRo
ZXkgY29udGFpbi4KPiA+Cj4gPiBIb3dldmVyLCBpZiB5b3Ugd2VyZSB0byB1c2UgbXkgYWJvdmUt
ZGVzY3JpYmVkIFNvbHV0aW9uICMxIGFsb25nIHdpdGggYSBEaXNqdW5jdGlvbk1heFF1ZXJ5WzFd
IGFzIGEgd3JhcHBlciBhcm91bmQgb25lIHF1ZXJ5IHBlciBhbHRlcm5hdGl2ZSBzZWdtZW50YXRp
b24gZmllbGQsIHRoZSB0ZXJtIGZyZXF1ZW5jeSBwcm9ibGVtIHdvdWxkIG5vIGxvbmdlciBiZSBh
biBpc3N1ZS4gIEZyb20gdGhlIEFQSSBkb2MgZm9yIERpc2p1bmN0aW9uTWF4UXVlcnk6Cj4gPgo+
ID4gICAgIEEgcXVlcnkgdGhhdCBnZW5lcmF0ZXMgdGhlIHVuaW9uIG9mIGRvY3VtZW50cyBwcm9k
dWNlZCBieSBpdHMKPiA+ICAgICBzdWJxdWVyaWVzLCBhbmQgdGhhdCBzY29yZXMgZWFjaCBkb2N1
bWVudCB3aXRoIHRoZSBtYXhpbXVtCj4gPiAgICAgc2NvcmUgZm9yIHRoYXQgZG9jdW1lbnQgYXMg
cHJvZHVjZWQgYnkgYW55IHN1YnF1ZXJ5LCBwbHVzIGEKPiA+ICAgICB0aWUgYnJlYWtpbmcgaW5j
cmVtZW50IGZvciBhbnkgYWRkaXRpb25hbCBtYXRjaGluZyBzdWJxdWVyaWVzLgo+ID4gICAgIFRo
aXMgaXMgdXNlZnVsIHdoZW4gc2VhcmNoaW5nIGZvciBhIHdvcmQgaW4gbXVsdGlwbGUgZmllbGRz
Cj4gPiAgICAgd2l0aCBkaWZmZXJlbnQgYm9vc3QgZmFjdG9ycyAoc28gdGhhdCB0aGUgZmllbGRz
IGNhbm5vdCBiZQo+ID4gICAgIGNvbWJpbmVkIGVxdWl2YWxlbnRseSBpbnRvIGEgc2luZ2xlIHNl
YXJjaCBmaWVsZCkuICBXZSB3YW50Cj4gPiAgICAgdGhlIHByaW1hcnkgc2NvcmUgdG8gYmUgdGhl
IG9uZSBhc3NvY2lhdGVkIHdpdGggdGhlIGhpZ2hlc3QKPiA+ICAgICBib29zdCwgbm90IHRoZSBz
dW0gb2YgdGhlIGZpZWxkIHNjb3JlcyAoYXMgQm9vbGVhblF1ZXJ5IHdvdWxkCj4gPiAgICAgZ2l2
ZSkuCj4gPgo+ID4gVW5saWtlIHRoZSB1c2UtY2FzZSBtZW50aW9uZWQgYWJvdmUsIHdoZXJlIGVh
Y2ggZmllbGQgd2lsbCBiZSBib29zdGVkIGRpZmZlcmVudGx5LCB5b3UgcHJvYmFibHkgZG9uJ3Qg
aGF2ZSBhbnkgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHJlbGF0aXZlIHByb2JhYmlsaXR5IG9mIHRo
ZSBhbHRlcm5hdGl2ZSBzZWdtZW50YXRpb25zLCBzbyB5b3UnbGwgd2FudCB0byB1c2UgdGhlIHNh
bWUgYm9vc3QgZm9yIGVhY2ggc3ViLXF1ZXJ5Lgo+ID4KPiA+IFN0ZXZlCj4gPgo+ID4gWzFdIDxo
dHRwOi8vbHVjZW5lLmFwYWNoZS5vcmcvamF2YS8yXzJfMC9hcGkvb3JnL2FwYWNoZS9sdWNlbmUv
c2VhcmNoL0Rpc2p1bmN0aW9uTWF4UXVlcnkuaHRtbD4KPiA+Cj4gPiAtLQo+ID4gU3RldmUgUm93
ZQo+ID4gQ2VudGVyIGZvciBOYXR1cmFsIExhbmd1YWdlIFByb2Nlc3NpbmcKPiA+IGh0dHA6Ly93
d3cuY25scC5vcmcvdGVjaC9sdWNlbmUuYXNwCj4gPgo+Cj4gSGkgU3RldmUsCj4KPiBXZSBoYXZl
IGFjdHVhbGx5IHRob3VnaHQgYWJvdXQgc29sdXRpb24gIzEsIGFuZCBpbiBvdXIgY2FzZSwgc29y
dGluZwo+IGJ5IHNjb3JpbmcgaXMgbm90IGEgdmVyeSBpbXBvcnRhbnQgZmFjdG9yIGFzIHdlbGwu
IEhvd2V2ZXIgdGhpcyB3b3VsZAo+IGRvdWJsZSB0aGUgaW5kZXggc2l6ZS4gQSBmdWxsIGluZGV4
IG9mIG91ciBkb2N1bWVudHMgbm93IHdvdWxkIHRha2UgPgo+IDgwRyBhbHJlYWR5LCBhbmQgaXQn
cyBleHBlY3RlZCB0byBncm93IG11Y2ggZmFzdGVyIGluIHRoZSBuZWFyIGZ1dHVyZS4KPiBBcyB5
b3UndmUgbWVudGlvbmVkLCB0aGUgYW1iaWd1aXRpZXMgaW4gc2VnbWVudGF0aW9uIGFyZSByYXJl
IGluZGVlZC4KPiBTbyB3ZSBhcmUgbm90IHZlcnkgd2lsbGluZyB0byBkb3VibGUgdGhlIGluZGV4
IHNpemUganVzdCBmb3IgdGhhdC4KPgo+IEZvciBzb2x1dGlvbiAjMiwgaXQgaXMgYSBnb29kIHNv
bHV0aW9uIGluZGVlZCwgYnV0IHlvdSBzZWUsIG91cgo+IHByb2JsZW0gaXMgbXVjaCBkZWVwZXIg
aW4gZmFjdC4gV2UgYXJlIGN1cnJlbnRseSB0cnkgdG8gcmVwbGFjZSBvdXIKPiBvbGQgc2VhcmNo
IGVuZ2luZSB3aXRoIEx1Y2VuZS4gV2hpY2ggbWVhbnMgd2hhdGV2ZXIgZmVhdHVyZXMgdGhlIG9s
ZAo+IGVuZ2luZSBoYXZlLCB3ZSBuZWVkIHRvIHNpbXVsYXRlIGl0IGluIEx1Y2VuZS4gT25lIHN1
Y2ggZmVhdHVyZSBpcwo+IHNpbWlsYXIgdG8gTHVjZW5lJ3MgU3Bhbk5lYXJRdWVyeSwgd2hpY2gs
IHVuZm9ydHVuYXRlbHksIGRvZXNuJ3Qgd29yawo+IHdpdGggc29sdXRpb24gIzIgaWYgdGhlIHNl
YXJjaCB0ZXJtcyBjb250YWlucyB0aGUgdGVybSBCQyBpbgo+IEFsdGVybmF0aXZlICMyLgo+Cj4g
ZS5nLgo+IEdpdmVuIGEgc2VudGVuY2UgWFlaQUJDREVGCj4gc3VwcG9zZSB0aGUgc2VnbWVudGF0
aW9uIGlzCj4gWFkgcG9zaXRpb24gMAo+IFogcG9zaXRpb24gMSAgICAgICAgICAgQWx0ZXJuYXRp
dmUgIzIKPiBBQiBwb3NpdGlvbiAyICAgICAgICAgQSBwb3NpdGlvbiAxMDIKPiBDIHBvc2l0aW9u
IDMgICAgICAgICAgQkMgcG9zaXRpb24gMTAzCj4gREVGIHBvc2l0aW9uIDQKPgo+IEEgU3Bhbk5l
YXJRdWVyeSBvZiAoWFksIEJDLCBERUYpIHdpdGggZGlzdGFuY2Ugb2YgMTAgd291bGQgZmFpbCB0
bwo+IG1hdGNoIHRoaXMgZG9jdW1lbnQuCj4KPiBTbyBpdCBzZWVtcyB3ZSBtYXkgaGF2ZSB0byBn
byB0aGUgbW9yZSBkaWZmaWN1bHQgcm91dGUgaW4gZXhwbG9yaW5nCj4gdGhlIFBheWxvYWQgZmVh
dHVyZSB0aGF0IHlvdSBtZW50aW9uZWQuIEkndmUgc2VlbiBpdCBiZWluZyBhbm5vdW5jZWQKPiBk
dXJpbmcgdGhlIHJlbGVhc2Ugb2YgMi4yLjAsIGJ1dCB0aGUgQVBJIHNheXMgImV4cGVyaW1lbnRh
bCIgYW5kIHRoZXJlCj4gYWluJ3QgYW55IGV4YW1wbGUgYWJvdXQgaG93IGNhbiBpdCBiZSB1c2Vk
Lgo+Cj4gQnV0IHRoYW5rcyB2ZXJ5IG11Y2ggZm9yIHlvdXIgZ29vZCBzdWdnZXN0aW9ucy4KPgo+
IENoZWVycywKPiBDZWRyaWMKPgo+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo+IFRvIHVuc3Vic2NyaWJlLCBlLW1h
aWw6IGphdmEtdXNlci11bnN1YnNjcmliZUBsdWNlbmUuYXBhY2hlLm9yZwo+IEZvciBhZGRpdGlv
bmFsIGNvbW1hbmRzLCBlLW1haWw6IGphdmEtdXNlci1oZWxwQGx1Y2VuZS5hcGFjaGUub3JnCj4K
Pgo+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCj4gSGVhbHkgSHVkc29uIEdtYkggLSBELTU1MjUyIE1haW56IEth
c3RlbAo+IEdlc2Now6RmdHNmw7xocmVyIENocmlzdGlhbiBLb25ow6R1c2VyIC0gQW10c2dlcmlj
aHQgV2llc2JhZGVuIEhSQiAxMjA3Ngo+Cj4gRGllc2UgRW1haWwgaXN0IHZlcnRyYXVsaWNoLiBX
ZW5uIFNpZSBuaWNodCBkZXIgYmVhYnNpY2h0aWd0ZSBFbXBmw6RuZ2VyIHNpbmQsIGTDvHJmZW4g
U2llIGRpZSBJbmZvcm1hdGlvbmVuIG5pY2h0IG9mZmVuIGxlZ2VuIG9kZXIgYmVudXR6ZW4uIFdl
bm4gU2llIGRpZXNlIEVtYWlsIGR1cmNoIGVpbmVuIEZlaGxlciBiZWtvbW1lbiBoYWJlbiwgdGVp
bGVuIFNpZSB1bnMgZGllcyBiaXR0ZSB1bWdlaGVuZCBtaXQsIGluZGVtIFNpZSBkaWVzZSBFbWFp
bCBhbiBkZW4gQWJzZW5kZXIgenVyw7xja3NjaGlja2VuLiBCaXR0ZSBsw7ZzY2hlbiBTaWUgZGFu
YWNoIGRpZXNlIEVtYWlsLgo+IFRoaXMgZW1haWwgaXMgY29uZmlkZW50aWFsLiBJZiB5b3UgYXJl
IG5vdCB0aGUgaW50ZW5kZWQgcmVjaXBpZW50LCB5b3UgbXVzdCBub3QgZGlzY2xvc2Ugb3IgdXNl
IHRoaXMgaW5mb3JtYXRpb24gY29udGFpbmVkIGluIGl0LiBJZiB5b3UgaGF2ZSByZWNlaXZlZCB0
aGlzIGVtYWlsIGluIGVycm9yIHBsZWFzZSB0ZWxsIHVzIGltbWVkaWF0ZWx5IGJ5IHJldHVybiBl
bWFpbCBhbmQgZGVsZXRlIHRoZSBkb2N1bWVudC4KPgo+Cj4KPiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KPiBUbyB1
bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3JpYmVAbHVjZW5lLmFwYWNoZS5v
cmcKPiBGb3IgYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWlsOiBqYXZhLXVzZXItaGVscEBsdWNl
bmUuYXBhY2hlLm9yZwo+Cj4K


From java-user-return-30969-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 09:56:24 2007
Return-Path: <java-user-return-30969-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75216 invoked from network); 11 Nov 2007 09:56:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 09:56:24 -0000
Received: (qmail 47527 invoked by uid 500); 11 Nov 2007 09:56:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47487 invoked by uid 500); 11 Nov 2007 09:56:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47476 invoked by uid 99); 11 Nov 2007 09:56:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 01:56:06 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [202.60.81.233] (HELO host.avantic.com.au) (202.60.81.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 09:56:51 +0000
Received: from [203.171.98.86] (helo=[10.0.0.3])
	by host.avantic.com.au with esmtpa (Exim 4.63)
	(envelope-from <jason@jaykel.com>)
	id 1Ir9UH-0005eC-R0
	for java-user@lucene.apache.org; Sun, 11 Nov 2007 19:52:17 +1000
Message-ID: <4736D18A.7070005@jaykel.com>
Date: Sun, 11 Nov 2007 19:55:22 +1000
From: Jason Bradfield <jason@jaykel.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: round robin search results with same score
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - host.avantic.com.au
X-AntiAbuse: Original Domain - lucene.apache.org
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - jaykel.com
X-Source: 
X-Source-Args: 
X-Source-Dir: 
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
I am quite new to Lucene, I've read most of the documentation and can't 
find want I need..
Basically for any documents returned from a search if they have the same 
score I need them to be returned in a round robin type of ordering based 
on previous searches with the same query.

ie. I have documents A, B and C, they all have a field with the same 
value. The query is only on this field with an exact match on their 
values.. What I need is first time the query is called it will return 
say A, B, C (no specific order here) but then the next time this query 
is executed i need it returned B, C, A, then C, A, B on the next and so 
forth..

This is basically for a directory search app where we want to maximize 
the display of each business for the same search criteria..

Can this be done with the current Lucene, or will I need to dive into 
its bowls to get what I need.

BTW. I am using Hibernate Search.. But have the ability to do pure Lucene...

Thanks.
Jason.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30970-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 13:06:35 2007
Return-Path: <java-user-return-30970-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2654 invoked from network); 11 Nov 2007 13:06:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 13:06:35 -0000
Received: (qmail 12087 invoked by uid 500); 11 Nov 2007 13:06:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11755 invoked by uid 500); 11 Nov 2007 13:06:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11744 invoked by uid 99); 11 Nov 2007 13:06:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 05:06:17 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.57] (HELO web25715.mail.ukl.yahoo.com) (217.12.10.57)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 11 Nov 2007 13:06:16 +0000
Received: (qmail 71704 invoked by uid 60001); 11 Nov 2007 13:05:54 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.fr;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=wD5fc+yVfLg66NaAWCxy/PaKrJBYA1orhetUBfAcfYkQXzjeKzSH3scJ6o4UoPXeDkJ2zsf9h3C6FNWcvMp3IKrtaJYLa9rRv9HJoSMG5K0hQYwAtAs2Vwijzh9ayoLE++DAXTWTaa9DWQdooki0AjtHjdyBQJHxK/j3qbVDjHY=;
X-YMail-OSG: o1NoPGEVM1khE9UkZhKKQNkEbjd8yYtJMoRAAMHV6nAPtXv0lMZ8a3.YU.8srKsKEPNxvuhHrxBYZGLH3NNjlo7QPjyleoxyvtURVTz5WQ9gr07DD_oXFweTTWM-
Received: from [196.217.57.39] by web25715.mail.ukl.yahoo.com via HTTP; Sun, 11 Nov 2007 14:05:54 CET
Date: Sun, 11 Nov 2007 14:05:54 +0100 (CET)
From: Jamal H Tandina <jtandina@yahoo.fr>
Subject: RE : Re: RE : Re: RE : Re: problem undestanding the hits.score
To: java-user@lucene.apache.org
In-Reply-To: <359a92830711110435y635cc4d1sedee2cdc9da711e9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-555211886-1194786354=:64420"
Content-Transfer-Encoding: 8bit
Message-ID: <582870.64420.qm@web25715.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-555211886-1194786354=:64420
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit


 Thanks you for your reply

 The thing is i'am trying to emplement a weight for a word form indexing html
 web pages.

 The is like :

*50% +  Weigth(word in doc d) = *20% + * 10% +
 ...

 the code is :
 =============================================================
 doc.add(new Field("url", httpd.getURL(), Field.Store.YES,
 Field.Index.UN_TOKENIZED));

 Field tiTle = new
 Field("title",httpd.getTitle(),Field.Store.YES,Field.Index.TOKENIZED );
 tiTle.setBoost(1/2f);   //50%
 doc.add(tiTle);


 Field keyWords1 = new
 Field("keywords",httpd.getKeywords(),Field.Store.YES,Field.Index.TOKENIZED
 );
 keyWords1.setBoost(2/5f);  //40% 2/5
 doc.add(keyWords1);

 Field contentK1 = new
 Field("contentKeywords",httpd.getContentKeywords(),Field.Store.NO,Field.Index.TOKENIZED
 );
 contentK1.setBoost(1/10f);  //10%
 doc.add(contentK1);

 writer.addDocument(doc);
 ===========================================================

 and the hit.score return just a field score when we do the searching.  how
 can i get this together

*50% +  Weigth(word in doc d) = *20% + * 10% +
 ...

 THANK YOU FOR YOUR TIME


> Erick Erickson  a crit : I strongly recommend
> against this. Simple word counts are a poor
> measure of relevance. Which is why Lucene doesn't score that
> way. Do you have an example showing why the default scoring is
> inadequate or is this just an assumption?
>
> It would be helpful if you gave us some idea of what you're trying
> to accomplish. What is the use-case you're trying to solve? That
> would generate more helpful responses I think....
>
> Best
> Erick
>
> On 11/2/07, Jamal H Tandina  wrote:
> >
> > <<<<
> >
> > If you want to give priority to documents that are larger, like z1, you
> >
> > should change the DefaultSimilarity (at index  time), more exactly the
> > method:
> >
> >   public float lengthNorm(String fieldName, int numTerms) {
> >     return (float)(1.0 / Math.sqrt(numTerms));
> >   }
> >
> > to something like this
> >
> >   public float lengthNorm(String fieldName, int numTerms) {
> >     return (float)(Math.sqrt(numTerms));
> >
> >
> >   }
> > >>>
> >
> > I want to give priority to documents that have the word we are searching
> > more frequent !
> >
> > Thank you
> >
> >
> >
> > Jamal H Tandina  a crit : Thank you  for your reply
> >
> > How can i change the defaultSimilarity in the indexing and the searching,
> > do you have an example or an url how to set the Similarity  ?
> >
> >
> http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/Similarity.html
> >
> > Thanks again
> >
> > Ion Badita  a  crit : Try too look at Similarity, there you will find
> > thinks about the
> > scoring. Your query is more "similar" with the shorter document.
> > If you have 2 documents with a field body; first with words "red flower"
> > and the second with just one word "flower", and search for the word
> > "flower", the second document will score high because is very similar
> > with the query.
> >
> > If you want to give priority to documents that are larger, like z1, you
> > should change the DefaultSimilarity (at index time), more exactly the
> > method:
> >
> >   public float lengthNorm(String fieldName, int numTerms) {
> >     return (float)(1.0 / Math.sqrt(numTerms));
> >   }
> >
> > to something like this
> >
> >   public float lengthNorm(String fieldName, int numTerms) {
> >     return (float)(Math.sqrt(numTerms));
> >   }
> >
> >
> > Reindex your documents with the Similarity  modified and try to search
> > again. The IndexWriter has a method to set the similarity used for
> > indexing.
> >
> >
> > I hope this will help you...
> >
> >
> > Ion
> >
> >
> >
> > Jamal jamalator wrote:
> > >  Hi
> > >
> > > I have indexed this html document
> > > =============z1========================
> > >
> > >
> > > zo zo zo zo zo zo zo zo zo zo zo zo
> >
> > > zo zo zo zo zo zo zo zo zo zo zo zo
> >
> > > zo zo zo zo zo zo zo zo zo zo zo zo
> > >
> > >
> > > =============z2=========================
> > >
> > >
> > >  zo zo zo zo zo zo zo zo zo zo zo zo
> >
> > >  zo zo zo zo zo zo zo zo zo zo zo zo
> >
> > >
> > >
> > > =============z3==========================
> > >
> > >
> > >  zo zo zo zo zo zo zo zo zo zo zo zo
> >
> > >
> >  >
> > > =========================================
> > > with this code
> > >
> > > Field contentK1 = new  Field("htmlcontent",httpd.getContentKeywords(),
> > Field.Store.NO,Field.Index.TOKENIZED );
> > > contentK1.setBoost(1/10f);  //10%
> > > doc.add(contentK1);
> > >
> > > and when a search "zo" with luke i have (whitespaceanalyser):
> > >
> > > (score , id   )
> > > (0,0957,z2 )
> > > (0,0947,z3 )
> > > (0,0938,z1)
> > >
> > > NORMALY the resut expected have to be z1 z2 z3
> > >
> > > Some One have an idea ??
> > >
> > > Thank you all
> > >
> > >
> > >
> > > ---------------------------------
> > >   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers
> > Yahoo! Mail
> > >
> > >
> > > ---------------------------------
> > >  Ne gardez plus qu'une seule  adresse mail ! Copiez vos mails vers
> Yahoo!
> > Mail
> > >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> >
> > ---------------------------------
> > Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo!
> > Mail
> >
> >
> > ---------------------------------
> > Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo!
> > Mail
>
>
>
> ---------------------------------
>   Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo!
> Mail
>
>
> ---------------------------------
>  Stockage illimit de vos mails avec Yahoo! Mail. Changez aujourd'hui de
> mail !


             
---------------------------------
 Ne gardez plus qu'une seule adresse mail ! Copiez vos mails vers Yahoo! Mail 
--0-555211886-1194786354=:64420--

From java-user-return-30971-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 13:37:56 2007
Return-Path: <java-user-return-30971-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6431 invoked from network); 11 Nov 2007 13:37:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 13:37:56 -0000
Received: (qmail 36010 invoked by uid 500); 11 Nov 2007 13:37:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35973 invoked by uid 500); 11 Nov 2007 13:37:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35962 invoked by uid 99); 11 Nov 2007 13:37:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 05:37:38 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.198.189 as permitted sender)
Received: from [209.85.198.189] (HELO rv-out-0910.google.com) (209.85.198.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 13:37:41 +0000
Received: by rv-out-0910.google.com with SMTP id k20so786012rvb
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 05:37:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=WOMrrUtMcdBCAeUHdOn/nvPzUi93S8NIbG2nJXV5JhA=;
        b=RrkpbnB+IQC/NcurtmNXsofE4/7BqqhFpkzcXlK69xsG8wLZqITpivmv+5LosIN5pVpuc4o0Q26LbbJCRQj/r5oM9eww/82qQrMAAPoh+vQOBdsCErIIcr+j2c+NHTlSIi8uE9iGL6Mx6u8h1cMsUs5sSZP+1wm2Y7JsbFBu3S0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=X50RDOoNpykrPmi23B7kgmQNGTbJGkD4DYdXFJWFztVn7sfXVUWNDzeGbDNmf5RMGNrIkKWd/GaLELBwtDr4wgbMPTXaS9Xgd+FDXFR0th0MVraoLCdeOj7W1EwBU3SN2svEfAwAshtu1rGjH4pgts4xO0y44RHpGG3FoKwIcI8=
Received: by 10.142.162.5 with SMTP id k5mr1063498wfe.1194788241155;
        Sun, 11 Nov 2007 05:37:21 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Sun, 11 Nov 2007 05:37:21 -0800 (PST)
Message-ID: <c68e39170711110537w74cb81a5qab6c9f0e61d1bfcd@mail.gmail.com>
Date: Sun, 11 Nov 2007 08:37:21 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: round robin search results with same score
In-Reply-To: <4736D18A.7070005@jaykel.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <4736D18A.7070005@jaykel.com>
X-Google-Sender-Auth: 4db308ba43214159
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 11, 2007 4:55 AM, Jason Bradfield <jason@jaykel.com> wrote:
> Basically for any documents returned from a search if they have the same
> score I need them to be returned in a round robin type of ordering based
> on previous searches with the same query.
>
> ie. I have documents A, B and C, they all have a field with the same
> value. The query is only on this field with an exact match on their
> values.. What I need is first time the query is called it will return
> say A, B, C (no specific order here) but then the next time this query
> is executed i need it returned B, C, A, then C, A, B on the next and so
> forth..
>
> This is basically for a directory search app where we want to maximize
> the display of each business for the same search criteria..

Solr has a random field that would serve to equalize over time (but it
wouldn't be round robin).
You could do the same type of thing yourself and implement true
round-robin with a custom sort field in Lucene.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30972-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 17:52:00 2007
Return-Path: <java-user-return-30972-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49220 invoked from network); 11 Nov 2007 17:52:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 17:52:00 -0000
Received: (qmail 69228 invoked by uid 500); 11 Nov 2007 17:51:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69195 invoked by uid 500); 11 Nov 2007 17:51:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69184 invoked by uid 99); 11 Nov 2007 17:51:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 09:51:40 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 64.233.184.232 as permitted sender)
Received: from [64.233.184.232] (HELO wr-out-0506.google.com) (64.233.184.232)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 17:51:43 +0000
Received: by wr-out-0506.google.com with SMTP id c46so357392wra
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 09:51:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=Br4kq4OaYjc5/AeUINrlK4kKMeBCeE9jzjcLItMgTYk=;
        b=k4U2avHtstFr3bjYCdQ/i74tNTBL++nKcWg71q8vMEjA1T66+PWhWe64+ndYonbyPig5CMTNWKcYDUYpg5R853PjAcSVTEVL8YhRklIhuxZtc8/nrU6fljkQhRmOydzUQrS8mBYxgMX47qhodfl2spihKPfxNKF5ySh4pAQ6fkI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=X0+VBfmCWNQTwjsQHZUph92/qNP7fxMqVVmpqjiBX4r9dbcxORbHkd+XDOA1kiF+oD0NfhC6AaDjY+Jnh9MXhs1vek4LX6Mstg9P1FTuE8VOSaLq30HDEPHgPuxrpiQC4XWspyzMHOOZb/Fe3H3LGNO07XDxqeVu2cKSIUnj3G8=
Received: by 10.150.91.20 with SMTP id o20mr615827ybb.1194803481620;
        Sun, 11 Nov 2007 09:51:21 -0800 (PST)
Received: from ?192.168.1.6? ( [76.114.134.202])
        by mx.google.com with ESMTPS id 33sm4941114wra.2007.11.11.09.51.20
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 11 Nov 2007 09:51:20 -0800 (PST)
Message-ID: <4737405F.1040608@gmail.com>
Date: Sun, 11 Nov 2007 12:48:15 -0500
From: Ryan McKinley <ryantxu@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
References: <47361C43.6030506@gmail.com>   <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>   <1194730460.31785.1220622099@webmail.messagingengine.com>   <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>   <1194732079.3067.1220624239@webmail.messagingengine.com>   <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com> <1194734434.8784.1220626841@webmail.messagingengine.com>
In-Reply-To: <1194734434.8784.1220626841@webmail.messagingengine.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


> 
> Ryan are you able to update to that commit I just did?  If so I think
> you should run the tool without -fix and post back what it printed.  It
> should report an error on that one segment due to the missing file.
> Then, run -fix to remove that segment (please backup your index first!).
> Then, if you have a zillion segments in the index, try optimizing it?
> 

uggg.  Thanks for all your help / pointers.  I've been able to salvage a 
functioning index - (with 800K fewer docs) - I'll just go back to an old 
index and build from there.

Optimizing reduced 180K files to 1800 - I'm guessing that had something 
to do with why it hit a max open file limit.

I'm running a standard solr-trunk from a few weeks back (nothing custom, 
no 'embedded' stuff).  The index is constantly updating a few files, so 
I am not surprised by the mass of unused files optimize cleans up.

If I understand Yonik's comments, something in lucene 2.3 has changed so 
that hitting the max open file limit could not result in a corrupt 
index.  Is that true?  In the meantime would optimizing more often help 
avoid this?

thanks
ryan






---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30973-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 18:04:19 2007
Return-Path: <java-user-return-30973-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50815 invoked from network); 11 Nov 2007 18:04:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 18:04:18 -0000
Received: (qmail 77232 invoked by uid 500); 11 Nov 2007 18:04:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77205 invoked by uid 500); 11 Nov 2007 18:04:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77194 invoked by uid 99); 11 Nov 2007 18:04:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 10:04:00 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 209.85.198.190 as permitted sender)
Received: from [209.85.198.190] (HELO rv-out-0910.google.com) (209.85.198.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 18:04:02 +0000
Received: by rv-out-0910.google.com with SMTP id k20so825253rvb
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 10:03:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=bDECx6vBodFYsC0YciDYcyAPKGYOj8/ncv0xE7V0rw8=;
        b=tISnpyUsUh2Ptas6pc2XAkkw6cfibi3f4D6zqi81OsSuFpzJOnbKNWP3XyHmMyEo+JejrThodqvoYI5SXlz8cliKk5pHzkSJuV6mPCH1AP72fYucOlqsbyNd3UTri8yvRxAvRoRs2eo38O2Yi933Ode+WkS86FKPwuMNTKbZ+Mc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=Pi2lV1evhNt5/hcM6ny3L5DjVfzY5ZLPXjAVNIeqOyLM3lTX4+oBca4bA64Jtl/PA8H1oh8my6PXe198vaYAeqWXjAanp4wJ++V0GySX1TAi2USfVXJLwngPc299/UxsjihQSlyveLIyGaUpwdhQsnVKz0oGK2bNTLhwS2wM9SU=
Received: by 10.141.171.6 with SMTP id y6mr2010308rvo.1194804222162;
        Sun, 11 Nov 2007 10:03:42 -0800 (PST)
Received: from ?192.168.1.6? ( [76.114.134.202])
        by mx.google.com with ESMTPS id 12sm5569395wrl.2007.11.11.10.03.40
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 11 Nov 2007 10:03:41 -0800 (PST)
Message-ID: <47374343.60401@gmail.com>
Date: Sun, 11 Nov 2007 13:00:35 -0500
From: Ryan McKinley <ryantxu@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: CheckIndex tool
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I just used the CheckIndex tool to try to salvage a corrupt index 
(http://www.nabble.com/restoring-a-corrupt-index--tf4783866.html)

Its a great tool thanks!

I'm wondering about adding support for this tool in the solr admin 
interface, but have a few questions about how it works before I see if 
that is a good idea or not.

Would it be safe to run this tool while searching the index?
Would it be safe to run during an update?

thanks
ryan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30974-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 18:32:42 2007
Return-Path: <java-user-return-30974-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60183 invoked from network); 11 Nov 2007 18:32:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 18:32:42 -0000
Received: (qmail 91597 invoked by uid 500); 11 Nov 2007 18:32:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91563 invoked by uid 500); 11 Nov 2007 18:32:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91552 invoked by uid 99); 11 Nov 2007 18:32:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 10:32:24 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of yseeley@gmail.com designates 209.85.198.185 as permitted sender)
Received: from [209.85.198.185] (HELO rv-out-0910.google.com) (209.85.198.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 18:33:08 +0000
Received: by rv-out-0910.google.com with SMTP id k20so829080rvb
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 10:32:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=DJNCEu9nK0ZVYyA+erENv2fbgMh4sYeou9qZIdIoToM=;
        b=ZOZmiEMorGUKU8uqwLs3TkoAj/az1Furcmfk7CHTsvNEfL7zMp0L5LGRjbbT2eeaxM/22xp+q4J7HnajEbBS/kj/baswlrJgortxOW3sHPinLCoXi2AA7tlTWoinDODrlppG/8By0jQ0XOsKAzBb71YDeGie7sCxTUXMisvebJM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=Sgg1WQfghQLkobrx+k34cPgBcE51AwvartRN3DxWpxWr7jQXYC25ivqNfSujhYnjnqg5kgQTrsr5sz6TOGH6HSujOFDBMTSLL8lSUuYb/xGMnHM58E4vnerW126UrBmvYmgnlE4/jj2PHyGuSC5G9tLIPjFypDHVTi64lkySx2E=
Received: by 10.142.191.2 with SMTP id o2mr56862wff.1194805922591;
        Sun, 11 Nov 2007 10:32:02 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Sun, 11 Nov 2007 10:32:02 -0800 (PST)
Message-ID: <c68e39170711111032i5365698fjb1a85f501283f30c@mail.gmail.com>
Date: Sun, 11 Nov 2007 13:32:02 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
In-Reply-To: <4737405F.1040608@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <47361C43.6030506@gmail.com>
	 <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
	 <1194730460.31785.1220622099@webmail.messagingengine.com>
	 <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
	 <1194732079.3067.1220624239@webmail.messagingengine.com>
	 <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
	 <1194734434.8784.1220626841@webmail.messagingengine.com>
	 <4737405F.1040608@gmail.com>
X-Google-Sender-Auth: 6805e041d9d664a6
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 11, 2007 12:48 PM, Ryan McKinley <ryantxu@gmail.com> wrote:
> > Ryan are you able to update to that commit I just did?  If so I think
> > you should run the tool without -fix and post back what it printed.  It
> > should report an error on that one segment due to the missing file.
> > Then, run -fix to remove that segment (please backup your index first!).
> > Then, if you have a zillion segments in the index, try optimizing it?
> >
>
> uggg.  Thanks for all your help / pointers.  I've been able to salvage a
> functioning index - (with 800K fewer docs) - I'll just go back to an old
> index and build from there.
>
> Optimizing reduced 180K files to 1800 - I'm guessing that had something
> to do with why it hit a max open file limit.

It shouldn't.  A single lucene segment should have about 8 or 9 files
associated with it, so I don't know what the remaining 1800 are.  An
index (with normal settings) should *never* get to 180K files that are
actually part of the index.

> I'm running a standard solr-trunk from a few weeks back (nothing custom,
> no 'embedded' stuff).  The index is constantly updating a few files, so
> I am not surprised by the mass of unused files optimize cleans up.

All files that look like segment files are cleaned up when they are
not referenced now.
The fact that optimize cleaned them up doesn't mean they were in use before.

> If I understand Yonik's comments, something in lucene 2.3 has changed so
> that hitting the max open file limit could not result in a corrupt
> index.  Is that true?

I think Lucene has become more resistant to index corruption on a
failure (like an exception).
Just make sure you do a commit once in a while (old versions of lucene
flushed a new segment and it was automatically added into the current
view of the index... the newest version of lucene with
lucene_autocommit=off won't do that).

> In the meantime would optimizing more often help
> avoid this?

I think the root cause is more running out of descriptors.  It may be
that you just need a higher limit.
If you are using Linux, see this link for how to check/set the number
of system-wide descriptors:
http://www.cs.uwaterloo.ca/~brecht/servers/openfiles.html

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30975-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 19:00:25 2007
Return-Path: <java-user-return-30975-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63467 invoked from network); 11 Nov 2007 19:00:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 19:00:24 -0000
Received: (qmail 14160 invoked by uid 500); 11 Nov 2007 19:00:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14123 invoked by uid 500); 11 Nov 2007 19:00:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14112 invoked by uid 99); 11 Nov 2007 19:00:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 11:00:06 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 19:00:10 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id EDBF4468BF
	for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 13:59:48 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Sun, 11 Nov 2007 13:59:48 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id C7D5D4528E; Sun, 11 Nov 2007 13:59:48 -0500 (EST)
Message-Id: <1194807588.7808.1220709497@webmail.messagingengine.com>
X-Sasl-Enc: lcr59H5cW4sKWJfYNr/jJumYzKcjzMmdRtNKXnkinh9G 1194807588
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47361C43.6030506@gmail.com>
   <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
   <1194730460.31785.1220622099@webmail.messagingengine.com>
   <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
   <1194732079.3067.1220624239@webmail.messagingengine.com>
   <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
   <1194734434.8784.1220626841@webmail.messagingengine.com>
   <4737405F.1040608@gmail.com>
   <c68e39170711111032i5365698fjb1a85f501283f30c@mail.gmail.com>
Subject: Re: restoring a corrupt index?
In-Reply-To: <c68e39170711111032i5365698fjb1a85f501283f30c@mail.gmail.com>
Date: Sun, 11 Nov 2007 13:59:48 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Yonik Seeley" <yonik@apache.org> wrote:
> On Nov 11, 2007 12:48 PM, Ryan McKinley <ryantxu@gmail.com> wrote:
> > > Ryan are you able to update to that commit I just did?  If so I think
> > > you should run the tool without -fix and post back what it printed.  It
> > > should report an error on that one segment due to the missing file.
> > > Then, run -fix to remove that segment (please backup your index first!).
> > > Then, if you have a zillion segments in the index, try optimizing it?
> > >
> >
> > uggg.  Thanks for all your help / pointers.  I've been able to salvage a
> > functioning index - (with 800K fewer docs) - I'll just go back to an old
> > index and build from there.
> >
> > Optimizing reduced 180K files to 1800 - I'm guessing that had something
> > to do with why it hit a max open file limit.

> It shouldn't.  A single lucene segment should have about 8 or 9 files
> associated with it, so I don't know what the remaining 1800 are.  An
> index (with normal settings) should *never* get to 180K files that are
> actually part of the index.

Ryan can you post the output of CheckIndex on your now-working index?
(1800 is still too many files I think, certainly after having
optimized).

Also, what steps finally allowed you to recover?  CheckIndex
(back-ported to 2.2) followed by optimize?

> > If I understand Yonik's comments, something in lucene 2.3 has changed so
> > that hitting the max open file limit could not result in a corrupt
> > index.  Is that true?
> 
> I think Lucene has become more resistant to index corruption on a
> failure (like an exception).
> Just make sure you do a commit once in a while (old versions of lucene
> flushed a new segment and it was automatically added into the current
> view of the index... the newest version of lucene with
> lucene_autocommit=off won't do that).

I'm still baffled how Lucene 2.2 could ever produce a corrupt index
even on hitting descriptor limits or other exceptions.  I can see that
this could cause files to not be deleted properly, but, I can't see
how it can corrupt the index.

Ryan can you share any details of how you (Solr) is using Lucene?  Are
you using autoCommit=false?  I'd really love to get to the root cause
here.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30976-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 19:06:47 2007
Return-Path: <java-user-return-30976-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64684 invoked from network); 11 Nov 2007 19:06:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 19:06:47 -0000
Received: (qmail 21330 invoked by uid 500); 11 Nov 2007 19:06:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21291 invoked by uid 500); 11 Nov 2007 19:06:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21279 invoked by uid 99); 11 Nov 2007 19:06:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 11:06:29 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 19:06:31 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id D71B139313
	for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 14:06:10 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Sun, 11 Nov 2007 14:06:10 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id B935745278; Sun, 11 Nov 2007 14:06:10 -0500 (EST)
Message-Id: <1194807970.9214.1220709871@webmail.messagingengine.com>
X-Sasl-Enc: cP149njFArstH6/51vm0lhsyslJZO7bHxwDO09oJSo1R 1194807970
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47374343.60401@gmail.com>
Subject: Re: CheckIndex tool
In-Reply-To: <47374343.60401@gmail.com>
Date: Sun, 11 Nov 2007 14:06:10 -0500
X-Virus-Checked: Checked by ClamAV on apache.org

"Ryan McKinley" <ryantxu@gmail.com> wrote:
> I just used the CheckIndex tool to try to salvage a corrupt index 
> (http://www.nabble.com/restoring-a-corrupt-index--tf4783866.html)
> 
> Its a great tool thanks!

Phew!  I think you are the first user (besides me).

> I'm wondering about adding support for this tool in the solr admin 
> interface, but have a few questions about how it works before I see if 
> that is a good idea or not.
> 
> Would it be safe to run this tool while searching the index?

This should be safe.  This tool does not delete any files: it only
writes a new segments_N+1 file that has dropped references to those
segments that had trouble loading.

> Would it be safe to run during an update?

Not as it currently stands: the tool does not acquire the write lock,
so, if another writer is working on the index, it would cause problems
in that both this tool and the writer would try to write the
segments_N file, possibly at different times (in which case the later
one would overwrite the first one) or at/near the same time (in which
case on Windows one would hit an IOException).

We could fix the tool to acquire the write.lock, though this isn't
perfect since the tool doesn't know the locking configuration for your
index (eg using NativeFSSLockFactory or SimpleFSLockFactory, maybe
with a different lock directory, etc.).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30977-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 19:29:12 2007
Return-Path: <java-user-return-30977-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67879 invoked from network); 11 Nov 2007 19:29:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 19:29:11 -0000
Received: (qmail 35620 invoked by uid 500); 11 Nov 2007 19:28:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35572 invoked by uid 500); 11 Nov 2007 19:28:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35559 invoked by uid 99); 11 Nov 2007 19:28:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 11:28:51 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 64.233.162.235 as permitted sender)
Received: from [64.233.162.235] (HELO nz-out-0506.google.com) (64.233.162.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 19:28:37 +0000
Received: by nz-out-0506.google.com with SMTP id i28so670986nzi
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 11:28:16 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=an8I0IEJ8qgrPSYJkxW5pFf3e4oVdrxenI/pasR/Rzg=;
        b=JThdM66TnwJfkAthBvzdr0RfX5d9jE4LR9fL4Epd1yjwfMERH0OqtXkz0W7onfcu4nb3+w7Zqz3UE+QvqxoS2LQnY8ksmwQuC1p+anHRGP9oG8xnv8YBYDj0HudHYwQ1iSSYpOI2ysESqjl/pFoQUdrWG1CH8X9iBXi+viPi2+8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=HN/glN/9/YYxDMpWecCBLSmi7WYgfFGpC8oyqzuTI1TG8KXLdlKxxMTmEeLG6Gc0PcmBzrJntTKAGX0N8ll+JRxTYBjnYKmRwJItfXrpED/Atz8aQMzeJqBVGZoNwQaZsn9U+t7xEi4fcj+Z5XHt20m9378NOy5Zdut7QzIu7mA=
Received: by 10.142.48.14 with SMTP id v14mr1080011wfv.1194809295663;
        Sun, 11 Nov 2007 11:28:15 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Sun, 11 Nov 2007 11:28:15 -0800 (PST)
Message-ID: <c68e39170711111128u6744e7bev345e5c8e7b84321a@mail.gmail.com>
Date: Sun, 11 Nov 2007 14:28:15 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
In-Reply-To: <1194807588.7808.1220709497@webmail.messagingengine.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <47361C43.6030506@gmail.com>
	 <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
	 <1194730460.31785.1220622099@webmail.messagingengine.com>
	 <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
	 <1194732079.3067.1220624239@webmail.messagingengine.com>
	 <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
	 <1194734434.8784.1220626841@webmail.messagingengine.com>
	 <4737405F.1040608@gmail.com>
	 <c68e39170711111032i5365698fjb1a85f501283f30c@mail.gmail.com>
	 <1194807588.7808.1220709497@webmail.messagingengine.com>
X-Google-Sender-Auth: bbaf5cc62b6d634b
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 11, 2007 1:59 PM, Michael McCandless <lucene@mikemccandless.com> wrote:
> Ryan can you share any details of how you (Solr) is using Lucene?  Are
> you using autoCommit=false?  I'd really love to get to the root cause
> here.

Unfortunately, Solr and Lucene both have something called autocommit now.
Solr autocommit automatically called a solr level "commit" after a
certain amount of time or docs were added (commit == close the writer,
deleted buffered deletes, open new searcher to make the changes
visible.) Lucene's autocommit (added in 2.3 AFAIK) if true, means that
a new segment descriptor will be written (making it visible to a new
reader opened on the index) each time a new segment is flushed by the
writer... otherwise close() needs to be called for this to happen.

Anyway, Ryan was using Lucene 2.2 when this happened (hence
lucene_autoCommit==true, right?)

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30978-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 19:55:04 2007
Return-Path: <java-user-return-30978-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72214 invoked from network); 11 Nov 2007 19:55:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 19:55:03 -0000
Received: (qmail 49263 invoked by uid 500); 11 Nov 2007 19:54:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49220 invoked by uid 500); 11 Nov 2007 19:54:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49209 invoked by uid 99); 11 Nov 2007 19:54:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 11:54:45 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 19:54:48 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id F1779461F7
	for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 14:54:27 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Sun, 11 Nov 2007 14:54:27 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id C650E452CF; Sun, 11 Nov 2007 14:54:27 -0500 (EST)
Message-Id: <1194810867.15942.1220714711@webmail.messagingengine.com>
X-Sasl-Enc: zgpIWgXIC/sg7G+yZkLDi0cG+l7cRq11hBzI6abit+8P 1194810867
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47361C43.6030506@gmail.com>
   <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>
   <1194730460.31785.1220622099@webmail.messagingengine.com>
   <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
   <1194732079.3067.1220624239@webmail.messagingengine.com>
   <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
   <1194734434.8784.1220626841@webmail.messagingengine.com>
   <4737405F.1040608@gmail.com>
   <c68e39170711111032i5365698fjb1a85f501283f30c@mail.gmail.com>
   <1194807588.7808.1220709497@webmail.messagingengine.com>
   <c68e39170711111128u6744e7bev345e5c8e7b84321a@mail.gmail.com>
Subject: Re: restoring a corrupt index?
In-Reply-To: <c68e39170711111128u6744e7bev345e5c8e7b84321a@mail.gmail.com>
Date: Sun, 11 Nov 2007 14:54:27 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Yonik Seeley" <yonik@apache.org> wrote:
> On Nov 11, 2007 1:59 PM, Michael McCandless <lucene@mikemccandless.com>
> wrote:
> > Ryan can you share any details of how you (Solr) is using Lucene?  Are
> > you using autoCommit=false?  I'd really love to get to the root cause
> > here.
> 
> Unfortunately, Solr and Lucene both have something called autocommit now.
> Solr autocommit automatically called a solr level "commit" after a
> certain amount of time or docs were added (commit == close the writer,
> deleted buffered deletes, open new searcher to make the changes
> visible.) Lucene's autocommit (added in 2.3 AFAIK) if true, means that
> a new segment descriptor will be written (making it visible to a new
> reader opened on the index) each time a new segment is flushed by the
> writer... otherwise close() needs to be called for this to happen.
> 
> Anyway, Ryan was using Lucene 2.2 when this happened (hence
> lucene_autoCommit==true, right?)

Actually Lucene autoCommit was first available in 2.2, but it sounds
like Solr leaves that at the default (true).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30979-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 22:14:41 2007
Return-Path: <java-user-return-30979-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3994 invoked from network); 11 Nov 2007 22:14:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 22:14:41 -0000
Received: (qmail 28450 invoked by uid 500); 11 Nov 2007 22:14:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28413 invoked by uid 500); 11 Nov 2007 22:14:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28402 invoked by uid 99); 11 Nov 2007 22:14:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 14:14:23 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ryantxu@gmail.com designates 209.85.132.248 as permitted sender)
Received: from [209.85.132.248] (HELO an-out-0708.google.com) (209.85.132.248)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 22:14:26 +0000
Received: by an-out-0708.google.com with SMTP id d40so177119and
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 14:14:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=7353BFcUlvo8aJlrM7rwBpElXCtHOnu3stVXi14qZDM=;
        b=QJYs5R/VaYCY740lka1kIoAH3pL9fR47VQlZqOXO/cNCFLFojwe8Z9Yp7Pp9qo2qU+jZC0wJ9BQSDzUtvXX4q1cep3BcM0mZDCSwGY3LE71j5fkOVSll7YfC++j+ST1NV50PLBLf4wsA3dBC8y9no8/TvE6XEc+/ucqFX/reRFQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=L26JnQ/H3BMa066PRWYMbK6RSmsQzYQ9ESylPEh0MCFBtBPXOlwPtAknvT3oEq0j/BDQgitKe7uG54LcmRsNSgKq5RLkrh1cmfqN3b7o7c3syWLRVLePHnVWamoBYpQqoqv1psMMHaUjoxWoN1D9ZQzEQyElXEtOan3uciyK0Y0=
Received: by 10.100.248.9 with SMTP id v9mr403603anh.1194819245396;
        Sun, 11 Nov 2007 14:14:05 -0800 (PST)
Received: from ?192.168.1.6? ( [76.114.134.202])
        by mx.google.com with ESMTPS id 11sm5815079wrl.2007.11.11.14.14.03
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 11 Nov 2007 14:14:03 -0800 (PST)
Message-ID: <47377DF1.8050301@gmail.com>
Date: Sun, 11 Nov 2007 17:10:57 -0500
From: Ryan McKinley <ryantxu@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
References: <47361C43.6030506@gmail.com>   <c68e39170711101320m471c0be1v67f74f1850919a8e@mail.gmail.com>   <1194730460.31785.1220622099@webmail.messagingengine.com>   <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>   <1194732079.3067.1220624239@webmail.messagingengine.com>   <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>   <1194734434.8784.1220626841@webmail.messagingengine.com>   <4737405F.1040608@gmail.com>   <c68e39170711111032i5365698fjb1a85f501283f30c@mail.gmail.com> <1194807588.7808.1220709497@webmail.messagingengine.com>
In-Reply-To: <1194807588.7808.1220709497@webmail.messagingengine.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


> 
> Ryan can you post the output of CheckIndex on your now-working index?
> (1800 is still too many files I think, certainly after having
> optimized).
> 

ok, 1800 was wrong - that was from a botched attempt where I:
1. ran optimize on the broken 18K file index.  It crashed midway through.
2. run CheckIndex -fix on that

When I:
1. run CheckIndex -fix
2. run Optimize
it results in an index with 65 files (that seems normal)


> Also, what steps finally allowed you to recover?  CheckIndex
> (back-ported to 2.2) followed by optimize?
> 

I did not back-port to 2.2, this converted 2.2 index to 2.3, and i 
shoved 2.3 libs into an exploded solr.war.  (just to see if it works) 
It works, but I'm better off going back to an older working version.


> 
> I'm still baffled how Lucene 2.2 could ever produce a corrupt index
> even on hitting descriptor limits or other exceptions.  I can see that
> this could cause files to not be deleted properly, but, I can't see
> how it can corrupt the index.
> 

I'm not confident it is lucene's fault - the hardware has been flaky 
too.  But the 18K files and 'too many open files' error makes me 
suspicious.  Unfortunately, I can't quite grock when stuff started going 
wrong and how long it has been going on from my log files.


> Ryan can you share any details of how you (Solr) is using Lucene?  Are
> you using autoCommit=false?  I'd really love to get to the root cause
> here.
> 

I am using all standard solr config (copied from the example).  I am 
using solr's <autoCommit> to "commit" added documents every 30 secs.


ryan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30980-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 23:17:04 2007
Return-Path: <java-user-return-30980-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 16907 invoked from network); 11 Nov 2007 23:17:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 23:17:03 -0000
Received: (qmail 59550 invoked by uid 500); 11 Nov 2007 23:16:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59514 invoked by uid 500); 11 Nov 2007 23:16:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59503 invoked by uid 99); 11 Nov 2007 23:16:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 15:16:45 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bforrest10@gmail.com designates 209.85.132.242 as permitted sender)
Received: from [209.85.132.242] (HELO an-out-0708.google.com) (209.85.132.242)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 23:16:48 +0000
Received: by an-out-0708.google.com with SMTP id d40so178735and
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 15:16:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=+0r5soDsaZ5uGOlbFjYHV/CE+g9CgtyQJUeMGZf1XCo=;
        b=TP6/bmf19pautQAUePfwr7vUwLOQKUG10IkE/VJxGmME31iv2kfQ7Z8Zxoz25plFCqoRTLYs3gjCGBHJyjVVv42Lz9FDPooMuAlKy1k37fWPLvt+oilqNAYpPEqnASKEXX662QcxPiD16WcyKDs99PUOHbMjVE4KobvQLw9Z/9M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=QWsPq/4xFDZr3q2xhrRLliukiVDXEEuBiBbCPo11iEuF8/iPGftyvICV6ZcvRZL76MrA03EdXvwH8LbZZ72+P1nlMMNj2+181qt0M/jSE4MUXvUz0ngLTuCMS3n5CIyXPErCNXscaKPI5D+pNXLIysjwn/8w6zpdXGQm1a+r7uM=
Received: by 10.100.201.16 with SMTP id y16mr864462anf.1194822988091;
        Sun, 11 Nov 2007 15:16:28 -0800 (PST)
Received: by 10.100.209.15 with HTTP; Sun, 11 Nov 2007 15:16:28 -0800 (PST)
Message-ID: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
Date: Mon, 12 Nov 2007 10:16:28 +1100
From: "Barry Forrest" <bforrest10@gmail.com>
To: java-user@lucene.apache.org
Subject: Optimizing index takes too long
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Optimizing my index of 1.5 million documents takes days and days.

I have a collection of 10 million documents that I am trying to index
with Lucene.  I've divided the collection into chunks of about 1.5 - 2
million documents each.  Indexing 1.5 documents is fast enough (about
12 hours), but this results in an index directory containing about
35000 files.  Optimizing this index takes several days, which is a bit
too long for my purposes.  Each sub-index is about 150G.

What can I do to make this process faster?

Thanks for your help,
Barry

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30981-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 11 23:42:13 2007
Return-Path: <java-user-return-30981-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21372 invoked from network); 11 Nov 2007 23:42:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 11 Nov 2007 23:42:13 -0000
Received: (qmail 72007 invoked by uid 500); 11 Nov 2007 23:41:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71973 invoked by uid 500); 11 Nov 2007 23:41:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71962 invoked by uid 99); 11 Nov 2007 23:41:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 15:41:55 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.66] (HELO spunkymail-a8.g.dreamhost.com) (208.97.132.66)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 23:42:42 +0000
Received: from [10.0.1.2] (1023chost82.starwoodbroadband.com [12.37.185.82])
	by spunkymail-a8.g.dreamhost.com (Postfix) with ESMTP id 67ED310AA02
	for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 15:41:33 -0800 (PST)
Message-Id: <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Optimizing index takes too long
Date: Sun, 11 Nov 2007 18:41:12 -0500
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Hmmm, something doesn't sound quite right.  You have 10 million docs,  
split into 5 or so indexes, right?  And each sub index is 150  
gigabytes?  How big are your documents?

Can you provide more info about what your Directory and IndexWriter  
settings are?  What version of Lucene are you using?  What are your  
Field settings?  Are you storing info?  What about Term Vectors?

Can you explain more about your documents, etc?  10 million doesn't  
sound like it would need to be split up that much, if at all,  
depending on your hardware.

The wiki has some excellent resources on improving both indexing and  
search speed.

-Grant


On Nov 11, 2007, at 6:16 PM, Barry Forrest wrote:

> Hi,
>
> Optimizing my index of 1.5 million documents takes days and days.
>
> I have a collection of 10 million documents that I am trying to index
> with Lucene.  I've divided the collection into chunks of about 1.5 - 2
> million documents each.  Indexing 1.5 documents is fast enough (about
> 12 hours), but this results in an index directory containing about
> 35000 files.  Optimizing this index takes several days, which is a bit
> too long for my purposes.  Each sub-index is about 150G.
>
> What can I do to make this process faster?
>
> Thanks for your help,
> Barry
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30982-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 00:06:05 2007
Return-Path: <java-user-return-30982-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26862 invoked from network); 12 Nov 2007 00:06:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 00:06:04 -0000
Received: (qmail 81721 invoked by uid 500); 12 Nov 2007 00:05:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81682 invoked by uid 500); 12 Nov 2007 00:05:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81671 invoked by uid 99); 12 Nov 2007 00:05:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 16:05:46 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bforrest10@gmail.com designates 72.14.202.179 as permitted sender)
Received: from [72.14.202.179] (HELO ro-out-1112.google.com) (72.14.202.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 00:05:50 +0000
Received: by ro-out-1112.google.com with SMTP id m6so58840roe
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 16:05:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=TYPpw2GipOw4zhVtQCMHjWoUGpYzfBSdVRdR1tXkgd8=;
        b=FcWgReqqfMMt9DOZaA4YQzc6MgLZ1LIlhj+dI9ivUCvQkcVxPYBZ6GWC4eiFpruFxcYfK9Nrer+P+jkLQDLuovv3A1kkjSk1fbihlvnRE8um7jtr4UDIewWyL36c/BqGRdTUoKjcsyxdrHFjTG/2hCkeDIQeIbqApfPulSXTOT4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=h+8GJc0uIreAriB+WlA+UBMknwNdFLo3tdbnI6JRrYGEUpC8GeznzleDp0hD6y1Bq29rZlbMLLhqxJFkgs8pWNoP4QC0m3KyVfAX15MPArXbyqLx4NWpDRD0oCAqFYrKBklXk25C9acSkvcdHdSP8dFHaA2ZiqrOlGVRp0C6TUc=
Received: by 10.100.211.8 with SMTP id j8mr6430502ang.1194825928377;
        Sun, 11 Nov 2007 16:05:28 -0800 (PST)
Received: by 10.100.209.15 with HTTP; Sun, 11 Nov 2007 16:05:28 -0800 (PST)
Message-ID: <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com>
Date: Mon, 12 Nov 2007 11:05:28 +1100
From: "Barry Forrest" <bforrest10@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Optimizing index takes too long
In-Reply-To: <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
	 <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

Thanks for your help.

I'm using Lucene 2.3.

Raw document size is about 138G for 1.5M documents, which is about
250k per document.

IndexWriter settings are MergeFactor 50, MaxMergeDocs 2000,
RAMBufferSizeMB 32, MaxFieldLength Integer.MAX_VALUE.

Each document has about 10 short bibliographic fields and 3 longer
content fields and 1 field that contains the entire contents of the
document.  The longer content fields are stored twice - in a stemmed
and unstemmed form.  So actually there are about 8 longer content
fields.  (The effect of storing stemmed and unstemmed versions is to
approximately double the index size over storing the content only
once).  About half the short bibliographic fields are stored
(compressed) in the index.  The longer content fields are not stored,
and no term vectors are stored.

The hardware is quite new and fast: 8 cores, 15,000 RPM disks.

Thanks again
Barry

On Nov 12, 2007 10:41 AM, Grant Ingersoll <gsingers@apache.org> wrote:
> Hmmm, something doesn't sound quite right.  You have 10 million docs,
> split into 5 or so indexes, right?  And each sub index is 150
> gigabytes?  How big are your documents?
>
> Can you provide more info about what your Directory and IndexWriter
> settings are?  What version of Lucene are you using?  What are your
> Field settings?  Are you storing info?  What about Term Vectors?
>
> Can you explain more about your documents, etc?  10 million doesn't
> sound like it would need to be split up that much, if at all,
> depending on your hardware.
>
> The wiki has some excellent resources on improving both indexing and
> search speed.
>
> -Grant
>
>
>
> On Nov 11, 2007, at 6:16 PM, Barry Forrest wrote:
>
> > Hi,
> >
> > Optimizing my index of 1.5 million documents takes days and days.
> >
> > I have a collection of 10 million documents that I am trying to index
> > with Lucene.  I've divided the collection into chunks of about 1.5 - 2
> > million documents each.  Indexing 1.5 documents is fast enough (about
> > 12 hours), but this results in an index directory containing about
> > 35000 files.  Optimizing this index takes several days, which is a bit
> > too long for my purposes.  Each sub-index is about 150G.
> >
> > What can I do to make this process faster?
> >
> > Thanks for your help,
> > Barry
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30983-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 01:50:28 2007
Return-Path: <java-user-return-30983-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61693 invoked from network); 12 Nov 2007 01:50:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 01:50:27 -0000
Received: (qmail 26261 invoked by uid 500); 12 Nov 2007 01:50:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26229 invoked by uid 500); 12 Nov 2007 01:50:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26218 invoked by uid 99); 12 Nov 2007 01:50:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 17:50:08 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 72.14.202.176 as permitted sender)
Received: from [72.14.202.176] (HELO ro-out-1112.google.com) (72.14.202.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 01:50:08 +0000
Received: by ro-out-1112.google.com with SMTP id m6so18078roe
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 17:49:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=PbMkf2FXu8ytJMG62ZvMGubILmtnFKvwDa4iuuL0zfY=;
        b=KQfFfsvDmI7s2++f/YMXxwYf5GHNoKaa24JaqGzgO+PhLunORE6wH4FEBf9ljgN9fqW416sgKUEZimJgyspy3RXFOnyG90gtYiIwPs21h6rx9O7fulXvXNgQgB/u7/9NDhW7kPbFnivtVDfuhB2HPvkMheIy/HO4GlWMKdmSwgU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=auxvAKE0IOyTYlpYKNk0CGiG57O84GM0qrTCc0h3KcAuqWxw1WsMX1x/RUUvuXXeRLBaPQzERcthbKMk7oKkDBxfLRBt11v/6/nHRORkN9JPYfO9C3gF7n2bl1aBDu2IoO12DCySl345YvPsyih/tnFFBWupBmJvUPaQ3Zu0eiw=
Received: by 10.100.44.4 with SMTP id r4mr6479050anr.1194832186473;
        Sun, 11 Nov 2007 17:49:46 -0800 (PST)
Received: from ?192.168.1.102? ( [69.124.234.183])
        by mx.google.com with ESMTPS id 66sm5311120wra.2007.11.11.17.49.45
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 11 Nov 2007 17:49:45 -0800 (PST)
Message-ID: <4737B134.1040002@gmail.com>
Date: Sun, 11 Nov 2007 20:49:40 -0500
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: Optimizing index takes too long
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>	 <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org> <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com>
In-Reply-To: <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

For a start, I would lower the merge factor quite a bit. A high merge 
factor is over rated :) You will build the index faster, but searches 
will be slower and an optimize takes much longer. Essentially, the time 
you save when indexing is paid when optimizing anyway. You might as well 
amortize the cost with a lower merge factor.

Grant seems to think the numbers are off anyway, so you may have more to 
do -- just a suggestion about the merge factor. How much RAM are you 
giving your application?

With a machine with 8 cores and 15,000rpm, days does seem a little 
ridiculous.

- Mark

Barry Forrest wrote:
> Hi,
>
> Thanks for your help.
>
> I'm using Lucene 2.3.
>
> Raw document size is about 138G for 1.5M documents, which is about
> 250k per document.
>
> IndexWriter settings are MergeFactor 50, MaxMergeDocs 2000,
> RAMBufferSizeMB 32, MaxFieldLength Integer.MAX_VALUE.
>
> Each document has about 10 short bibliographic fields and 3 longer
> content fields and 1 field that contains the entire contents of the
> document.  The longer content fields are stored twice - in a stemmed
> and unstemmed form.  So actually there are about 8 longer content
> fields.  (The effect of storing stemmed and unstemmed versions is to
> approximately double the index size over storing the content only
> once).  About half the short bibliographic fields are stored
> (compressed) in the index.  The longer content fields are not stored,
> and no term vectors are stored.
>
> The hardware is quite new and fast: 8 cores, 15,000 RPM disks.
>
> Thanks again
> Barry
>
> On Nov 12, 2007 10:41 AM, Grant Ingersoll <gsingers@apache.org> wrote:
>   
>> Hmmm, something doesn't sound quite right.  You have 10 million docs,
>> split into 5 or so indexes, right?  And each sub index is 150
>> gigabytes?  How big are your documents?
>>
>> Can you provide more info about what your Directory and IndexWriter
>> settings are?  What version of Lucene are you using?  What are your
>> Field settings?  Are you storing info?  What about Term Vectors?
>>
>> Can you explain more about your documents, etc?  10 million doesn't
>> sound like it would need to be split up that much, if at all,
>> depending on your hardware.
>>
>> The wiki has some excellent resources on improving both indexing and
>> search speed.
>>
>> -Grant
>>
>>
>>
>> On Nov 11, 2007, at 6:16 PM, Barry Forrest wrote:
>>
>>     
>>> Hi,
>>>
>>> Optimizing my index of 1.5 million documents takes days and days.
>>>
>>> I have a collection of 10 million documents that I am trying to index
>>> with Lucene.  I've divided the collection into chunks of about 1.5 - 2
>>> million documents each.  Indexing 1.5 documents is fast enough (about
>>> 12 hours), but this results in an index directory containing about
>>> 35000 files.  Optimizing this index takes several days, which is a bit
>>> too long for my purposes.  Each sub-index is about 150G.
>>>
>>> What can I do to make this process faster?
>>>
>>> Thanks for your help,
>>> Barry
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>       
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30984-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 02:16:52 2007
Return-Path: <java-user-return-30984-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67857 invoked from network); 12 Nov 2007 02:16:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 02:16:52 -0000
Received: (qmail 32498 invoked by uid 500); 12 Nov 2007 02:16:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32458 invoked by uid 500); 12 Nov 2007 02:16:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32447 invoked by uid 99); 12 Nov 2007 02:16:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 18:16:34 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of jjl@panix.com designates 166.84.1.72 as permitted sender)
Received: from [166.84.1.72] (HELO mail1.panix.com) (166.84.1.72)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 02:17:20 +0000
Received: from mailspool3.panix.com (mailspool3.panix.com [166.84.1.78])
	by mail1.panix.com (Postfix) with ESMTP id 96D3E2941A;
	Sun, 11 Nov 2007 21:16:14 -0500 (EST)
Received: from [192.168.1.2] (pool-72-65-188-3.prvdri.east.verizon.net [72.65.188.3])
	by mailspool3.panix.com (Postfix) with ESMTP id 40A8816962;
	Sun, 11 Nov 2007 21:16:13 -0500 (EST)
Mime-Version: 1.0
Message-Id: <p06240808c35d5c29bd45@[192.168.1.2]>
In-Reply-To: <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com>
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>	
 <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org>
 <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com>
Date: Sun, 11 Nov 2007 21:15:56 -0500
To: "Barry Forrest" <bforrest10@gmail.com>
From: "J.J. Larrea" <jjl@panix.com>
Subject: Re: Optimizing index takes too long
Cc: java-user@lucene.apache.org
Content-Type: text/plain; charset="us-ascii"
X-Virus-Checked: Checked by ClamAV on apache.org

Hi. Here are a couple of thoughts:

1. Your problem description would be a little easier to parse if you didn't use the word "stored" to refer to fields which are not, in a Lucene sense, stored, only indexed.  For example, one doesn't "store" stemmed and unstemmed versions, since stemming has absolutely no effect on the stored Documents (and here I am using the capitalized word to distinguish Lucene Documents from your source documents).

2. Since the full document and its longer bibliographic subfields are being indexed but not stored, my guess is that the large size of the index segments is due to the inverted index rather than the stored data fields.  But you can roughly verify by checking the size of the files in the index, with Luke's Files tab or simply an ls -l.  For example .fdt files are stored data while .tis are the inverted index; see http://lucene.apache.org/java/docs/fileformats.html  And if you have .cfs files...

3. You have set MaxFieldLength to Integer.MAX_VALUE.  Is there a specific requirement for that being unbounded?  If you reduce the size, e.g. to 50k, you will dramatically reduce the size of the inverted index.

For fields for which norms will never be used (ie. queries of those fields affect hits but do not contribute to the score), disable them.

4. Make sure you have set useCompoundFile(false)!  If it is true (which is the default), every round of optimization* writes separate per-role files, then as a separate step packs them up into a compound file.  Besides causing an additional recopy, it means that optimization can take three times rather than twice the space on disk**.

5. 35000 files for 1.5M documents - that's <50 documents per file, way too low!  When I index 27M documents I think it's a lot when I'm up to 100 files!  Reduce MergeFactor, increase MaxMergeDocs.  I think if you reduce MergeFactor from 50 to 10 and increase  MaxMergeDocs from 2000 to 10000, you will end up with a similar memory footprint but a significantly more efficient disk footprint and far fewer rounds of optimization.  Also, what about MinMergeDocs?

I've not experimented with the RAMBufferSizeMB parameter, but 32Mb seems low for  an app dealing with such heavyweight documents.  Perhaps someone else knows better.

Note that if useCompoundFiles is false, you will end up with ~8 times the number of files (depending on features such as term vectors, etc.), so it is essential to first reduce the number with MergeFactor and MaxMergeDocs.

Through some judicious combination of the above steps, I am confident you can greatly reduce indexing time, optimization time, and index size, without impairing the ability to meet functional requirements.

- J.J.

*I'm not absolutely sure it's still every round of optimization, but it's certainly the case for the final round.

**At least in Lucene 1.9, I'm not sure about 2.3

At 11:05 AM +1100 11/12/07, Barry Forrest wrote:
>Hi,
>
>Thanks for your help.
>
>I'm using Lucene 2.3.
>
>Raw document size is about 138G for 1.5M documents, which is about
>250k per document.
>
>IndexWriter settings are MergeFactor 50, MaxMergeDocs 2000,
>RAMBufferSizeMB 32, MaxFieldLength Integer.MAX_VALUE.
>
>Each document has about 10 short bibliographic fields and 3 longer
>content fields and 1 field that contains the entire contents of the
>document.  The longer content fields are stored twice - in a stemmed
>and unstemmed form.  So actually there are about 8 longer content
>fields.  (The effect of storing stemmed and unstemmed versions is to
>approximately double the index size over storing the content only
>once).  About half the short bibliographic fields are stored
>(compressed) in the index.  The longer content fields are not stored,
>and no term vectors are stored.
>
>The hardware is quite new and fast: 8 cores, 15,000 RPM disks.
>
>Thanks again
>Barry
>
>On Nov 12, 2007 10:41 AM, Grant Ingersoll <gsingers@apache.org> wrote:
>> Hmmm, something doesn't sound quite right.  You have 10 million docs,
> > split into 5 or so indexes, right?  And each sub index is 150
>> gigabytes?  How big are your documents?
>>
>> Can you provide more info about what your Directory and IndexWriter
>> settings are?  What version of Lucene are you using?  What are your
>> Field settings?  Are you storing info?  What about Term Vectors?
>>
>> Can you explain more about your documents, etc?  10 million doesn't
>> sound like it would need to be split up that much, if at all,
>> depending on your hardware.
>>
>> The wiki has some excellent resources on improving both indexing and
>> search speed.
>>
>> -Grant
>>
>>
>>
>> On Nov 11, 2007, at 6:16 PM, Barry Forrest wrote:
>>
>> > Hi,
>> >
> > > Optimizing my index of 1.5 million documents takes days and days.
>> >
>> > I have a collection of 10 million documents that I am trying to index
>> > with Lucene.  I've divided the collection into chunks of about 1.5 - 2
>> > million documents each.  Indexing 1.5 documents is fast enough (about
>> > 12 hours), but this results in an index directory containing about
>> > 35000 files.  Optimizing this index takes several days, which is a bit
>> > too long for my purposes.  Each sub-index is about 150G.
>> >
>> > What can I do to make this process faster?
> > >
>> > Thanks for your help,
> > > Barry

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30985-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 02:32:04 2007
Return-Path: <java-user-return-30985-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71209 invoked from network); 12 Nov 2007 02:32:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 02:32:03 -0000
Received: (qmail 40095 invoked by uid 500); 12 Nov 2007 02:31:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40060 invoked by uid 500); 12 Nov 2007 02:31:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40049 invoked by uid 99); 12 Nov 2007 02:31:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 18:31:45 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a11.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 02:31:48 +0000
Received: from [10.0.1.2] (1023chost82.starwoodbroadband.com [12.37.185.82])
	by spunkymail-a11.g.dreamhost.com (Postfix) with ESMTP id 5DFFAB8573
	for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 18:31:23 -0800 (PST)
Message-Id: <D2ED8E48-AE99-44B8-A4A2-18E9377ADDD0@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <4737B134.1040002@gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Optimizing index takes too long
Date: Sun, 11 Nov 2007 21:30:59 -0500
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>	 <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org> <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com> <4737B134.1040002@gmail.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Not sure the numbers are off w/ documents that big, although I imagine  
you are hitting the token limit w/ docs that big.  Is this all on one  
machine as you described, or are you saying you have a couple of  
these?  If one, have you tried having just one index?

Since you are using 2.3 (note to other readers, 2.3 is NOT released  
yet, he really means 2.3-dev), are which MergeScheduler and  
MergePolicy are you using?  Can you do some profiling to see where is  
spending time?

Also, maybe Mike M. can chime in w/ how compressed fields are merged  
now.  I want to say that with the new indexing changes, they are all  
done right away and not revisited so that shouldn't be an issue.   
Having said that, I am a bit confused by some of your terminology.   
You say some Fields are stored twice, but then say they are not  
stored.  Can you share what the actual Field constructions are?    
There probably isn't a reason to compress the short biblio fields.   
Lucene Field compression, while not deprecated, really isn't  
recommended, b/c it doesn't give the application much control (since  
it uses the highest level of compression and is not tunable.)  The  
better approach is to do the compression yourself and store as a  
binary.  Again, though, it doesn't sound like you need compression for  
those fields.

Are you using compound file format or not?

Also, were you using 2.2 before and upgraded, or is this an  
application built on 2.3 to begin with?  If on 2.2, did you see these  
problems before?

Cheers,
Grant

On Nov 11, 2007, at 8:49 PM, Mark Miller wrote:

> For a start, I would lower the merge factor quite a bit. A high  
> merge factor is over rated :) You will build the index faster, but  
> searches will be slower and an optimize takes much longer.  
> Essentially, the time you save when indexing is paid when optimizing  
> anyway. You might as well amortize the cost with a lower merge factor.
>
> Grant seems to think the numbers are off anyway, so you may have  
> more to do -- just a suggestion about the merge factor. How much RAM  
> are you giving your application?
>
> With a machine with 8 cores and 15,000rpm, days does seem a little  
> ridiculous.
>
> - Mark
>
> Barry Forrest wrote:
>> Hi,
>>
>> Thanks for your help.
>>
>> I'm using Lucene 2.3.
>>
>> Raw document size is about 138G for 1.5M documents, which is about
>> 250k per document.
>>
>> IndexWriter settings are MergeFactor 50, MaxMergeDocs 2000,
>> RAMBufferSizeMB 32, MaxFieldLength Integer.MAX_VALUE.
>>
>> Each document has about 10 short bibliographic fields and 3 longer
>> content fields and 1 field that contains the entire contents of the
>> document.  The longer content fields are stored twice - in a stemmed
>> and unstemmed form.  So actually there are about 8 longer content
>> fields.  (The effect of storing stemmed and unstemmed versions is to
>> approximately double the index size over storing the content only
>> once).  About half the short bibliographic fields are stored
>> (compressed) in the index.  The longer content fields are not stored,
>> and no term vectors are stored.
>>
>> The hardware is quite new and fast: 8 cores, 15,000 RPM disks.
>>
>> Thanks again
>> Barry
>>
>> On Nov 12, 2007 10:41 AM, Grant Ingersoll <gsingers@apache.org>  
>> wrote:
>>
>>> Hmmm, something doesn't sound quite right.  You have 10 million  
>>> docs,
>>> split into 5 or so indexes, right?  And each sub index is 150
>>> gigabytes?  How big are your documents?
>>>
>>> Can you provide more info about what your Directory and IndexWriter
>>> settings are?  What version of Lucene are you using?  What are your
>>> Field settings?  Are you storing info?  What about Term Vectors?
>>>
>>> Can you explain more about your documents, etc?  10 million doesn't
>>> sound like it would need to be split up that much, if at all,
>>> depending on your hardware.
>>>
>>> The wiki has some excellent resources on improving both indexing and
>>> search speed.
>>>
>>> -Grant
>>>
>>>
>>>
>>> On Nov 11, 2007, at 6:16 PM, Barry Forrest wrote:
>>>
>>>
>>>> Hi,
>>>>
>>>> Optimizing my index of 1.5 million documents takes days and days.
>>>>
>>>> I have a collection of 10 million documents that I am trying to  
>>>> index
>>>> with Lucene.  I've divided the collection into chunks of about  
>>>> 1.5 - 2
>>>> million documents each.  Indexing 1.5 documents is fast enough  
>>>> (about
>>>> 12 hours), but this results in an index directory containing about
>>>> 35000 files.  Optimizing this index takes several days, which is  
>>>> a bit
>>>> too long for my purposes.  Each sub-index is about 150G.
>>>>
>>>> What can I do to make this process faster?
>>>>
>>>> Thanks for your help,
>>>> Barry
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>>
>>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30986-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 03:37:09 2007
Return-Path: <java-user-return-30986-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86610 invoked from network); 12 Nov 2007 03:37:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 03:37:08 -0000
Received: (qmail 65613 invoked by uid 500); 12 Nov 2007 03:36:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65576 invoked by uid 500); 12 Nov 2007 03:36:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65565 invoked by uid 99); 12 Nov 2007 03:36:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Nov 2007 19:36:50 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bforrest10@gmail.com designates 72.14.202.182 as permitted sender)
Received: from [72.14.202.182] (HELO ro-out-1112.google.com) (72.14.202.182)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 03:36:54 +0000
Received: by ro-out-1112.google.com with SMTP id m6so44734roe
        for <java-user@lucene.apache.org>; Sun, 11 Nov 2007 19:36:33 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=3/rABOxULcL4mSQC22qDnxd6t9UNo3lE0KTKZOTHIJA=;
        b=CRMhxezt4aynEYCAidkMfDbY222jknrs3RbDcBdUfiWFCSBL7KHRpi2MTICOGKB+M7+En7b8QKhqVC8vVPhQFLwkbsVT6aoyzkCvJAD8BO1dkiJlBPssrFr17ejp+Ho68jF9SFNUeo4i+HI4xVuT3BlBo9GTTLnizqttt5LjRR8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=KrxMI3S9FdcCTBSd7JRv8B+fPEvZNkqvhNKEKjDUX5x+fiIB/SaRVdKCvrRP1sz6BIXbu5BgSVpwt8fklDnJnc+g8eIdiyq4NqBQg1KNvchIpBWEL19s79hYBxymjfdntcO9xWQxg6nH1ckQ6WZKOte4D7cRVMkQjhGuyjiWgJs=
Received: by 10.100.248.9 with SMTP id v9mr584284anh.1194838591908;
        Sun, 11 Nov 2007 19:36:31 -0800 (PST)
Received: by 10.100.209.15 with HTTP; Sun, 11 Nov 2007 19:36:31 -0800 (PST)
Message-ID: <525c024b0711111936q349975c5ufe180fde8373d2d4@mail.gmail.com>
Date: Mon, 12 Nov 2007 14:36:31 +1100
From: "Barry Forrest" <bforrest10@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Optimizing index takes too long
In-Reply-To: <D2ED8E48-AE99-44B8-A4A2-18E9377ADDD0@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_16288_10829790.1194838591898"
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
	 <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org>
	 <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com>
	 <4737B134.1040002@gmail.com>
	 <D2ED8E48-AE99-44B8-A4A2-18E9377ADDD0@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_16288_10829790.1194838591898
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Thanks very much for all your suggestions.

I will work through these to see what works.  Appreciate that indexing takes
many hours, so it will take me a few days.  Working with a subset isn't
really indicative, since the problems only manifest with larger indexes.
 (Note that this might be a solution to my problem - simply subdivide the
collection even further).  I will reduce the merge factor and increase the
max merge docs.

No, I am not using the compound index format.

Apologies for my confusing use of the word "stored".  Most fields are not
stored at all, although some are indexed twice.

I am using the 2.3-dev version only because LUCENE-843 suggested that this
might be a path to faster indexing.  I started out using 2.2 and can easily
go back. I am using default MergePolicy and MergeScheduler.

The field constructions are something like the following.

// Stored bibliographic fields.
document.add(new Field(FieldName.FIELD1.name(), documentBean.getField1()
Field.Store.COMPRESS,
Field.Index.UN_TOKENIZED, Field.TermVector.NO));
...
// Unstored content fields - stemmed and unstemmed versions.
document.add(new Field(Fields.FIELD5_STEMMED.name(),
documentBean.getField5Stemmed() Field.Store.NO,
Field.Index.TOKENIZED, Field.TermVector.NO));
document.add(new Field(Fields.FIELD5_UNSTEMMED.name(),
documentBean.getField5Unstemmed() Field.Store.NO,Field.Index.TOKENIZED,
Field.TermVector.NO));
...

Let me do some more experiments and I'll report back.

Thanks
Barry.


On Nov 12, 2007 1:30 PM, Grant Ingersoll <gsingers@apache.org> wrote:
> Not sure the numbers are off w/ documents that big, although I imagine
> you are hitting the token limit w/ docs that big.  Is this all on one
> machine as you described, or are you saying you have a couple of
> these?  If one, have you tried having just one index?
>
> Since you are using 2.3 (note to other readers, 2.3 is NOT released
> yet, he really means 2.3-dev), are which MergeScheduler and
> MergePolicy are you using?  Can you do some profiling to see where is
> spending time?
>
> Also, maybe Mike M. can chime in w/ how compressed fields are merged
> now.  I want to say that with the new indexing changes, they are all
> done right away and not revisited so that shouldn't be an issue.
> Having said that, I am a bit confused by some of your terminology.
> You say some Fields are stored twice, but then say they are not
> stored.  Can you share what the actual Field constructions are?
> There probably isn't a reason to compress the short biblio fields.
> Lucene Field compression, while not deprecated, really isn't
> recommended, b/c it doesn't give the application much control (since
> it uses the highest level of compression and is not tunable.)  The
> better approach is to do the compression yourself and store as a
> binary.  Again, though, it doesn't sound like you need compression for
> those fields.
>
> Are you using compound file format or not?
>
> Also, were you using 2.2 before and upgraded, or is this an
> application built on 2.3 to begin with?  If on 2.2, did you see these
> problems before?
>
> Cheers,
> Grant
>
>
> On Nov 11, 2007, at 8:49 PM, Mark Miller wrote:
>
> > For a start, I would lower the merge factor quite a bit. A high
> > merge factor is over rated :) You will build the index faster, but
> > searches will be slower and an optimize takes much longer.
> > Essentially, the time you save when indexing is paid when optimizing
> > anyway. You might as well amortize the cost with a lower merge factor.
> >
> > Grant seems to think the numbers are off anyway, so you may have
> > more to do -- just a suggestion about the merge factor. How much RAM
> > are you giving your application?
> >
> > With a machine with 8 cores and 15,000rpm, days does seem a little
> > ridiculous.
> >
> > - Mark
> >
> > Barry Forrest wrote:
> >> Hi,
> >>
> >> Thanks for your help.
> >>
> >> I'm using Lucene 2.3.
> >>
> >> Raw document size is about 138G for 1.5M documents, which is about
> >> 250k per document.
> >>
> >> IndexWriter settings are MergeFactor 50, MaxMergeDocs 2000,
> >> RAMBufferSizeMB 32, MaxFieldLength Integer.MAX_VALUE.
> >>
> >> Each document has about 10 short bibliographic fields and 3 longer
> >> content fields and 1 field that contains the entire contents of the
> >> document.  The longer content fields are stored twice - in a stemmed
> >> and unstemmed form.  So actually there are about 8 longer content
> >> fields.  (The effect of storing stemmed and unstemmed versions is to
> >> approximately double the index size over storing the content only
> >> once).  About half the short bibliographic fields are stored
> >> (compressed) in the index.  The longer content fields are not stored,
> >> and no term vectors are stored.
> >>
> >> The hardware is quite new and fast: 8 cores, 15,000 RPM disks.
> >>
> >> Thanks again
> >> Barry
> >>
> >> On Nov 12, 2007 10:41 AM, Grant Ingersoll <gsingers@apache.org>
> >> wrote:
> >>
> >>> Hmmm, something doesn't sound quite right.  You have 10 million
> >>> docs,
> >>> split into 5 or so indexes, right?  And each sub index is 150
> >>> gigabytes?  How big are your documents?
> >>>
> >>> Can you provide more info about what your Directory and IndexWriter
> >>> settings are?  What version of Lucene are you using?  What are your
> >>> Field settings?  Are you storing info?  What about Term Vectors?
> >>>
> >>> Can you explain more about your documents, etc?  10 million doesn't
> >>> sound like it would need to be split up that much, if at all,
> >>> depending on your hardware.
> >>>
> >>> The wiki has some excellent resources on improving both indexing and
> >>> search speed.
> >>>
> >>> -Grant
> >>>
> >>>
> >>>
> >>> On Nov 11, 2007, at 6:16 PM, Barry Forrest wrote:
> >>>
> >>>
> >>>> Hi,
> >>>>
> >>>> Optimizing my index of 1.5 million documents takes days and days.
> >>>>
> >>>> I have a collection of 10 million documents that I am trying to
> >>>> index
> >>>> with Lucene.  I've divided the collection into chunks of about
> >>>> 1.5 - 2
> >>>> million documents each.  Indexing 1.5 documents is fast enough
> >>>> (about
> >>>> 12 hours), but this results in an index directory containing about
> >>>> 35000 files.  Optimizing this index takes several days, which is
> >>>> a bit
> >>>> too long for my purposes.  Each sub-index is about 150G.
> >>>>
> >>>> What can I do to make this process faster?
> >>>>
> >>>> Thanks for your help,
> >>>> Barry
> >>>>
> >>>> ---------------------------------------------------------------------
> >>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>>
> >>>>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>>
> >>>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_16288_10829790.1194838591898--

From java-user-return-30987-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 09:29:49 2007
Return-Path: <java-user-return-30987-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14107 invoked from network); 12 Nov 2007 09:29:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 09:29:49 -0000
Received: (qmail 95308 invoked by uid 500); 12 Nov 2007 09:29:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94620 invoked by uid 500); 12 Nov 2007 09:29:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94609 invoked by uid 99); 12 Nov 2007 09:29:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 01:29:30 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [89.213.91.233] (HELO mail.ardentiasearch.com) (89.213.91.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 09:30:19 +0000
Received: from biscuit.ARDENTIASEARCH.local ([10.0.0.9]) by
 biscuit.ARDENTIASEARCH.local ([10.0.0.9]) with mapi; Mon, 12 Nov 2007
 09:29:12 +0000
From: Mike Streeton <mike.streeton@ardentiasearch.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 12 Nov 2007 09:29:11 +0000
Subject: RE: TermDocs.skipTo error
Thread-Topic: TermDocs.skipTo error
Thread-Index: Acgj7ANdgBBBvTjbRVu2F1gxPUUT3wBIjKBw
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B6142B7F51A1@biscuit.ARDENTIASEARCH.local>
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
	 <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5182@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5183@biscuit.ARDENTIASEARCH.local>
 <c68e39170711101449p1c52da76j1b451eeff9cecc26@mail.gmail.com>
In-Reply-To: <c68e39170711101449p1c52da76j1b451eeff9cecc26@mail.gmail.com>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

Yonik,
    Thanks for this , I have checked and it is not at the end of the index,=
 but something funny is happening. It is a multireader each reader within i=
t has 100,000 documents, but when it fails it is trying to access a documen=
t e.g. 123,456, in the segment that only has 100,000

Many Thanks

Mike

-----Original Message-----
From: yseeley@gmail.com [mailto:yseeley@gmail.com] On Behalf Of Yonik Seele=
y
Sent: 10 November 2007 22:49
To: java-user@lucene.apache.org
Subject: Re: TermDocs.skipTo error

On Nov 9, 2007 11:40 AM, Mike Streeton <mike.streeton@ardentiasearch.com> w=
rote:
> I have just tried this again using the index I built with lucene 2.1 but =
running the test using lucene 2.2 and it works okay, so it seems to be some=
thing related to an index built using lucene 2.2.

I bet you are triggering an issue in multi-level skip lists by
attempting to skipTo a target past maxDoc (which per the javadoc,
seems like it should be legal).

So a short term workaround for you might be to first test if the
target you are trying to skip to is less than maxDoc().

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30988-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 09:48:27 2007
Return-Path: <java-user-return-30988-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19817 invoked from network); 12 Nov 2007 09:48:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 09:48:27 -0000
Received: (qmail 14923 invoked by uid 500); 12 Nov 2007 09:48:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14886 invoked by uid 500); 12 Nov 2007 09:48:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14875 invoked by uid 99); 12 Nov 2007 09:48:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 01:48:08 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 09:48:56 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IrVtW-0003NH-HZ
	for java-user@lucene.apache.org; Mon, 12 Nov 2007 01:47:50 -0800
Message-ID: <13702686.post@talk.nabble.com>
Date: Mon, 12 Nov 2007 01:47:50 -0800 (PST)
From: kumarlimbu <kumarlimbu@gmail.com>
To: java-user@lucene.apache.org
Subject: best way to share cookie info (user search history, etc.) between
 two load balanaced lucene search servers..
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: kumarlimbu@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Everyone,

We are planning on scaling our current web server by adding a machine with
similar specification. Both machine will be running lucene searches. What we
plan to do is add a load balancer in front of these servers. Our requirement
is to be able to share user info (user search history, etc.), cookies etc
between these two servers. What is the best way to load balance two or more
lucene search server and share session and cookie information between these
servers?

Our current server has 8 GB of RAM and size of the index is around 8GB
(contains around 3M+ records) as well. Any more info about current server
environment will be provided upon request.

Thank you all.

Kumar
-- 
View this message in context: http://www.nabble.com/best-way-to-share-cookie-info-%28user-search-history%2C-etc.%29-between-two-load-balanaced-lucene-search-servers..-tf4789975.html#a13702686
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30989-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 10:02:35 2007
Return-Path: <java-user-return-30989-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23591 invoked from network); 12 Nov 2007 10:02:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 10:02:35 -0000
Received: (qmail 26872 invoked by uid 500); 12 Nov 2007 10:02:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26842 invoked by uid 500); 12 Nov 2007 10:02:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26831 invoked by uid 99); 12 Nov 2007 10:02:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 02:02:17 -0800
X-ASF-Spam-Status: No, hits=-0.8 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp2.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 10:03:02 +0000
Received: from smtp1.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp2.akamai.com (8.13.8/8.12.10) with ESMTP id lACA2j8M022083
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 05:02:45 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lAC9xmrU006857
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 04:59:48 -0500 (EST)
Received: from MAVS2.kendall.corp.akamai.com ([172.17.33.20]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 12 Nov 2007 05:01:52 -0500
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by MAVS2.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 12 Nov 2007 05:01:52 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: best way to share cookie info (user search history, etc.) between two load balanaced lucene search servers..
Date: Mon, 12 Nov 2007 15:31:49 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A620239DD7D@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <13702686.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: best way to share cookie info (user search history, etc.) between two load balanaced lucene search servers..
Thread-Index: AcglETjLOL7N8iUUQACh3QOqww9t0AAAIs0A
References: <13702686.post@talk.nabble.com>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 12 Nov 2007 10:01:52.0512 (UTC) FILETIME=[0C8B4800:01C82513]
X-Virus-Checked: Checked by ClamAV on apache.org

Ah! There are so many ways to do this as there are so many questions
unanswered in your mail.

What kind of load balancer are you going to install?
Will you be replicating the complete lucene index on both the servers?
Do you plan to use the MultiSearcher/ParellelMultiSearcher?
Do these servers share a common domain name eg. server1.mydomain.com &
server2.mydomain.com?
How and where do you store the user search history (is it in the cookies
itself?)

Anyhow, simply put, if=20
1. your servers share a common domin name with different subdomain
2. you store user info in the cookies &
3. both servers will render results directly to the end user
You could solve your problem easily by using a domain based cookie
rather than a server based cookie.

Ie. Instead of setting the cookie access for a server (eg.
server1.mydomain.com), set it for the domain (eg. .mydomain.com, don't
forget the "dot" before the domain name).

Regards,
kapilChhabra

-----Original Message-----
From: kumarlimbu [mailto:kumarlimbu@gmail.com]=20
Sent: Monday, November 12, 2007 3:18 PM
To: java-user@lucene.apache.org
Subject: best way to share cookie info (user search history, etc.)
between two load balanaced lucene search servers..


Hi Everyone,

We are planning on scaling our current web server by adding a machine
with similar specification. Both machine will be running lucene
searches. What we plan to do is add a load balancer in front of these
servers. Our requirement is to be able to share user info (user search
history, etc.), cookies etc between these two servers. What is the best
way to load balance two or more lucene search server and share session
and cookie information between these servers?

Our current server has 8 GB of RAM and size of the index is around 8GB
(contains around 3M+ records) as well. Any more info about current
server environment will be provided upon request.

Thank you all.

Kumar
--
View this message in context:
http://www.nabble.com/best-way-to-share-cookie-info-%28user-search-histo
ry%2C-etc.%29-between-two-load-balanaced-lucene-search-servers..-tf47899
75.html#a13702686
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30990-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 10:15:04 2007
Return-Path: <java-user-return-30990-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26381 invoked from network); 12 Nov 2007 10:15:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 10:15:04 -0000
Received: (qmail 39431 invoked by uid 500); 12 Nov 2007 10:14:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39396 invoked by uid 500); 12 Nov 2007 10:14:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39385 invoked by uid 99); 12 Nov 2007 10:14:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 02:14:46 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 10:15:34 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 66F3D44E78
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 05:14:27 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Mon, 12 Nov 2007 05:14:27 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 49A8C45F64; Mon, 12 Nov 2007 05:14:27 -0500 (EST)
Message-Id: <1194862467.12633.1220802807@webmail.messagingengine.com>
X-Sasl-Enc: QPimf6UFlmU/Zp1RSZF5fUJmaG9dOvg9GuhIzGjqcr9d 1194862467
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
   <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org>
   <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com>
   <4737B134.1040002@gmail.com>
   <D2ED8E48-AE99-44B8-A4A2-18E9377ADDD0@apache.org>
   <525c024b0711111936q349975c5ufe180fde8373d2d4@mail.gmail.com>
Subject: Re: Optimizing index takes too long
In-Reply-To: <525c024b0711111936q349975c5ufe180fde8373d2d4@mail.gmail.com>
Date: Mon, 12 Nov 2007 05:14:27 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


> I am using the 2.3-dev version only because LUCENE-843 suggested
> that this might be a path to faster indexing.  I started out using
> 2.2 and can easily go back. I am using default MergePolicy and
> MergeScheduler.

Did you note any indexing or optimize speed differences between 2.2 &
2.3-dev?

One important thing to realize is LUCENE-843 only addresses speeding
up the creation of newly flushed segments (from add/updateDocument()
calls).

It does not speed up segment merging (which is what optimize() is
actually doing), though there have been at least a couple recent
issues on 2.3-dev that should speed up merging:

  - LUCENE-1043 (use bulk byte-copying to merge stored fields when
    possible)

  - LUCENE-888 (increase buffer sizes in input/outputs used during
    merging)

There is a separate issue open (LUCENE-856) to track ideas on how to
speed up segment merging.

> Also, maybe Mike M. can chime in w/ how compressed fields are merged
> now.

As far as I know, merging of compressed fields is unchanged wrt 2.2:
we still [efficiently] load & rewrite the raw bytes without
decompresssing them.

> For a start, I would lower the merge factor quite a bit. A high
> merge factor is over rated :) 

I would second this one: try lower values and see if optimizing is
faster.  It's not clear that a high mergeFactor gives faster merging
overall.

> The hardware is quite new and fast: 8 cores, 15,000 RPM disks.

Your machine sounds fabulous (I'm jealous!) so the numbers don't seem
to add up.

Are you giving the JVM plenty of RAM?  And the machine is not
swapping?  Indexing/optimizing should not be RAM intensive, like
searching, but it's still worth checking into.

> IndexWriter settings are MergeFactor 50, MaxMergeDocs 2000,
> RAMBufferSizeMB 32, MaxFieldLength Integer.MAX_VALUE.

The MaxMergeDocs=2000 is what's causing 35K files in your index (which
is far too many) -- and, this also foists all the merge cost into your
optimize call.  With the default MaxMergeDocs (effectively unlimited)
Lucene would do more merging, concurrently (in 2.3-dev), as the
index is being built.

If possible, the next time you run optimize() could you also call
IndexWriter.setInfoStream(...) and post the result log?  This would
have details on what merges are being selected, in case something
is going awry in the LogByteSizeMergePolicy.

Can you do "ls -l" on one of your sub-indices and post the results?
This would give us a raw check on where the bytes are going in the
index...

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30991-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 14:55:19 2007
Return-Path: <java-user-return-30991-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97877 invoked from network); 12 Nov 2007 14:55:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 14:55:19 -0000
Received: (qmail 52583 invoked by uid 500); 12 Nov 2007 14:55:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52544 invoked by uid 500); 12 Nov 2007 14:55:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52533 invoked by uid 99); 12 Nov 2007 14:55:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 06:55:01 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.32] (HELO smtp-vbr12.xs4all.nl) (194.109.24.32)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 14:55:03 +0000
Received: from [192.168.89.206] (impressie.xs4all.nl [82.93.53.149])
	by smtp-vbr12.xs4all.nl (8.13.8/8.13.8) with ESMTP id lACEsg5Q035247
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 15:54:42 +0100 (CET)
	(envelope-from matthijs@impressie.nl)
Message-ID: <47386935.4080803@impressie.nl>
Date: Mon, 12 Nov 2007 15:54:45 +0100
From: Matthijs Bierman <matthijs@impressie.nl>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: get original term for synonym
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Hi there,

Currently I am trying to get synonyms to work. I have gotten as far as 
injecting them into the index as Token.type SYNONYM. Lucene then finds 
the original word and synonym and points to the same document. So far so 
good.

However, I am stuck at highlighting the result. I have highlighters of 
my own that currently need an array of words to highlight. Extraction is 
done from the query, but the query gives the synonym, instead of the 
word it points to. Therefore highlighting is incorrect (or rather 
non-existent). Is there a simple way to make the synonym return the word 
it points to?

Thank you in advance,
Matthijs Bierman
(Netherlands)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30992-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 15:37:59 2007
Return-Path: <java-user-return-30992-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26839 invoked from network); 12 Nov 2007 15:37:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 15:37:59 -0000
Received: (qmail 29224 invoked by uid 500); 12 Nov 2007 15:37:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29196 invoked by uid 500); 12 Nov 2007 15:37:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29185 invoked by uid 99); 12 Nov 2007 15:37:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 07:37:41 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [62.159.88.170] (HELO ns1.hauk-sasko-backup.de) (62.159.88.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 15:38:27 +0000
Received: (from mail@localhost)
	by ns1.hauk-sasko-backup.de (8.9.3/8.9.3) id QAA31237
	for java-user@lucene.apache.org.KAV; Mon, 12 Nov 2007 16:37:20 +0100
Received: (from mail@localhost)
	by ns1.hauk-sasko-backup.de (8.9.3/8.9.3) id QAA31233
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 16:37:20 +0100
Received: from UNKNOWN(172.19.1.103), claiming to be "homer.hauk-sasko.de"
 via SMTP by ns1, id smtpduzWsQd; Mon Nov 12 16:37:17 2007
Received: from core1 (localhost [127.0.0.1])
	by localhost (Postfix) with SMTP id D3FA328BE7
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 16:37:17 +0100 (CET)
Received: by homer.hauk-sasko.de (Postfix, from userid 1050)
	id C454928BE6; Mon, 12 Nov 2007 16:37:17 +0100 (CET)
Received: from [172.19.4.123] (lx-el.hauk-sasko.de [172.19.4.123])
	by homer.hauk-sasko.de (Postfix) with ESMTP id 7865228BD7
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 16:37:17 +0100 (CET)
Message-ID: <4738732D.3040505@hauk-sasko.de>
Date: Mon, 12 Nov 2007 16:37:17 +0100
From: Eric Louvard <eric.louvard@hauk-sasko.de>
User-Agent: Thunderbird 1.5.0.14pre (X11/20071023)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Optimizing index takes too long
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
In-Reply-To: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
X-Enigmail-Version: 0.94.2.0
Content-Type: text/plain; charset=ISO-8859-1
X-Spam-Level: 
X-Spam-Checker-Version: SpamAssassin 2.55 (1.174.2.19-2003-05-19-exp)
X-Sanitizer: This message has been sanitized!
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by ns1.hauk-sasko-backup.de id QAA31233
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, hits=-106.7 required=4.0
	tests=BAYES_01,IN_REP_TO,QUOTED_EMAIL_TEXT,REFERENCES,
	      REPLY_WITH_QUOTES,SIGNATURE_LONG_SPARSE,USER_AGENT,
	      USER_IN_WHITELIST
	version=2.55

You could have a look at this thread.
http://www.gossamer-threads.com/lists/lucene/java-user/29354

regards.

Barry Forrest schrieb:
> Hi,
> 
> Optimizing my index of 1.5 million documents takes days and days.
> 
> I have a collection of 10 million documents that I am trying to index
> with Lucene.  I've divided the collection into chunks of about 1.5 - 2
> million documents each.  Indexing 1.5 documents is fast enough (about
> 12 hours), but this results in an index directory containing about
> 35000 files.  Optimizing this index takes several days, which is a bit
> too long for my purposes.  Each sub-index is about 150G.
> 
> What can I do to make this process faster?
> 
> Thanks for your help,
> Barry
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> 


-- 
Mit freundlichen Gren

i. A. ric Louvard
HAUK & SASKO Ingenieurgesellschaft mbH
Zettachring 2
D-70567 Stuttgart

Phone: +49 7 11 7 25 89 - 19
Fax: +49 7 11 7 25 89 - 50
E-Mail: eric.louvard@hauk-sasko.de
www: www.hauk-sasko.de
Niederlassung Stuttgart
Firmensitz: Markstr. 77, 44801 Bochum
Registergericht: Amtsgericht Bochum, HRB 2532
Geschftsfhrer: Dr.-Ing. Pavol Sasko




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30993-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 15:47:08 2007
Return-Path: <java-user-return-30993-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31172 invoked from network); 12 Nov 2007 15:47:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 15:47:08 -0000
Received: (qmail 42280 invoked by uid 500); 12 Nov 2007 15:46:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42248 invoked by uid 500); 12 Nov 2007 15:46:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42232 invoked by uid 99); 12 Nov 2007 15:46:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 07:46:47 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 15:46:50 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IrbUb-0005wK-Jo
	for java-user@lucene.apache.org; Mon, 12 Nov 2007 07:46:29 -0800
Message-ID: <13707745.post@talk.nabble.com>
Date: Mon, 12 Nov 2007 07:46:29 -0800 (PST)
From: Britske <gbrits@gmail.com>
To: java-user@lucene.apache.org
Subject: fieldcache gives OOM. Deos a LRU-style fieldcache exist?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: gbrits@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


First my question: 

Is there an (experimental / patch-version) lucene-fieldcache available which
uses some kind of eviction-strategy (LRU or whatever) so that OOM's would
never happen in my case, but instead some sorts would simply get evicted?

Now the background for those who are interested: 

I'm having a usecase in which products can have a lot of variants. (Up to
10.000) 
These variants can each have their own price (Which I need to sort and
filter by ) and a bunch of stored values (which I just need to display to
the client). At all times only 1 variant per product needs to be shown in a
search-result. I've modeled this by letting each possible variant have 2
fields: 1 pricefield and 1 storagefield. This means that every entry in the
index is a product with possible more than 20.000 fields. Potentially:
because the actual collection of available variants is sparse per product.
This all sounds a bit exotic I know, but uptil I was pointed to this problem
everything went fine. (index-time is a 'bit' slow but that's no real
problem.)

The problem is that potentially all pricefields of all variants can be used
for sorting, meaning that the fieldcache would have to contain up to 10.000
cached lists. This will give OutOfMemory-errors sooner or later, (products
will grow to about 400.000, so the fieldcache will grow to about 16GB) which
is not what my evironment will be able to handle any time soon.

Thanks in advance, 

Geert-Jan
-- 
View this message in context: http://www.nabble.com/fieldcache-gives-OOM.-Deos-a-LRU-style-fieldcache-exist--tf4791826.html#a13707745
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30994-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 15:50:27 2007
Return-Path: <java-user-return-30994-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77364 invoked from network); 12 Nov 2007 15:50:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 15:50:27 -0000
Received: (qmail 48649 invoked by uid 500); 12 Nov 2007 15:50:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48371 invoked by uid 500); 12 Nov 2007 15:50:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48360 invoked by uid 99); 12 Nov 2007 15:50:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 07:50:08 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.217] (HELO web26006.mail.ukl.yahoo.com) (217.12.10.217)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 12 Nov 2007 15:50:11 +0000
Received: (qmail 69772 invoked by uid 60001); 12 Nov 2007 15:49:49 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=xICGEjvy+QN6zVmwVboeat636Vysy/pmsLncIiH7CaJSrIqdG4VoWr0bjbYi+m4IasVdd61h/4IttVcUMTTp2zJfHdiLGP8oFwXc4KgF37rppkwi16l2tE/qMdq08PkUkEG+w+CkVn3DdsGPnadfoXbfwdpwNfLWtd5DVjGwxYI=;
X-YMail-OSG: ZsdJvGkVM1kN43kbS8hjzi9Rr9YkhDfGSQxVpKRoICMriLmh2ZkWvLZxynI0MgT7YGtvwGWTPAFgq6UZ_22n7g_aH4ABexsunrorKH4AX5Bt_Kmp
Received: from [193.36.230.96] by web26006.mail.ukl.yahoo.com via HTTP; Mon, 12 Nov 2007 15:49:48 GMT
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.152
Date: Mon, 12 Nov 2007 15:49:48 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: get original term for synonym
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <76844.69545.qm@web26006.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

>>Is there a simple way to make the synonym return the=0A word it points to=
?=0A=0AGive the highlighter the same analyzer you used to create the index,=
 not the one you use to parse the query. This should ensure the set of word=
s to be highlighted includes all synonyms.=0A=0ACheers=0AMark=0A=0A----- Or=
iginal Message ----=0AFrom: Matthijs Bierman <matthijs@impressie.nl>=0ATo: =
java-user@lucene.apache.org=0ASent: Monday, 12 November, 2007 2:54:45 PM=0A=
Subject: get original term for synonym=0A=0AHi there,=0A=0ACurrently I am t=
rying to get synonyms to work. I have gotten as far as =0Ainjecting them in=
to the index as Token.type SYNONYM. Lucene then finds =0Athe original word =
and synonym and points to the same document. So far=0A so =0Agood.=0A=0AHow=
ever, I am stuck at highlighting the result. I have highlighters of =0Amy o=
wn that currently need an array of words to highlight. Extraction=0A is =0A=
done from the query, but the query gives the synonym, instead of the =0Awor=
d it points to. Therefore highlighting is incorrect (or rather =0Anon-exist=
ent). Is there a simple way to make the synonym return the=0A word =0Ait po=
ints to?=0A=0AThank you in advance,=0AMatthijs Bierman=0A(Netherlands)=0A=
=0A---------------------------------------------------------------------=0A=
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0AFor addit=
ional commands, e-mail: java-user-help@lucene.apache.org=0A=0A=0A=0A=0A=0A=
=0A      ___________________________________________________________ =0AWan=
t ideas for reducing your carbon footprint? Visit Yahoo! For Good  http://u=
k.promotions.yahoo.com/forgood/environment.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30995-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 15:58:45 2007
Return-Path: <java-user-return-30995-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81546 invoked from network); 12 Nov 2007 15:58:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 15:58:44 -0000
Received: (qmail 68844 invoked by uid 500); 12 Nov 2007 15:58:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 68814 invoked by uid 500); 12 Nov 2007 15:58:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 68803 invoked by uid 99); 12 Nov 2007 15:58:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 07:58:26 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 66.249.92.170 as permitted sender)
Received: from [66.249.92.170] (HELO ug-out-1314.google.com) (66.249.92.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 15:58:29 +0000
Received: by ug-out-1314.google.com with SMTP id h3so926754ugf
        for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 07:58:06 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=SKnJfxK2LTi0Zbsqd19BA9eEgFomUCEp3exk7Bd4h2g=;
        b=saxKn7PIUEBZtAlnnWZbyJB71Vjh5y7Y9xBf22W0s0VUF7QjPun4Xj5u/HwGtBdjkINw/6BOfWgcb780LyfschJtQyOXl8pzP4yB/3JIYz2h6yYlA9qZjotJoWTQ7sx+hrnPdMNe9j74Wz08srtItHeK4K3dOL0jfgz/hFSRrDg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=j7qdp6SIZlbMWWhlHgJFyzRFAhZXyLIS094YbYClBk54meS/IGPL3p6ueEZRgFmesLTz2JHOxEMQRnNoy60E1NgVFqQeQMAHY/b5Y0ZKGrqRO51b2pQfOyoU5Qzyfh4j6YpGccgYBaf7241sFRcJzd/dkDvZ+VSuSOPnem+rJN8=
Received: by 10.142.84.3 with SMTP id h3mr751692wfb.1194883084780;
        Mon, 12 Nov 2007 07:58:04 -0800 (PST)
Received: from ?192.168.1.102? ( [69.124.234.183])
        by mx.google.com with ESMTPS id 8sm6198403wrl.2007.11.12.07.58.02
        (version=SSLv3 cipher=RC4-MD5);
        Mon, 12 Nov 2007 07:58:03 -0800 (PST)
Message-ID: <47387808.6090804@gmail.com>
Date: Mon, 12 Nov 2007 10:58:00 -0500
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: fieldcache gives OOM. Deos a LRU-style fieldcache exist?
References: <13707745.post@talk.nabble.com>
In-Reply-To: <13707745.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

https://issues.apache.org/jira/browse/LUCENE-831

This patch should be a good start for you. Not sure how stale it is at 
this point though.

Britske wrote:
> First my question: 
>
> Is there an (experimental / patch-version) lucene-fieldcache available which
> uses some kind of eviction-strategy (LRU or whatever) so that OOM's would
> never happen in my case, but instead some sorts would simply get evicted?
>
> Now the background for those who are interested: 
>
> I'm having a usecase in which products can have a lot of variants. (Up to
> 10.000) 
> These variants can each have their own price (Which I need to sort and
> filter by ) and a bunch of stored values (which I just need to display to
> the client). At all times only 1 variant per product needs to be shown in a
> search-result. I've modeled this by letting each possible variant have 2
> fields: 1 pricefield and 1 storagefield. This means that every entry in the
> index is a product with possible more than 20.000 fields. Potentially:
> because the actual collection of available variants is sparse per product.
> This all sounds a bit exotic I know, but uptil I was pointed to this problem
> everything went fine. (index-time is a 'bit' slow but that's no real
> problem.)
>
> The problem is that potentially all pricefields of all variants can be used
> for sorting, meaning that the fieldcache would have to contain up to 10.000
> cached lists. This will give OutOfMemory-errors sooner or later, (products
> will grow to about 400.000, so the fieldcache will grow to about 16GB) which
> is not what my evironment will be able to handle any time soon.
>
> Thanks in advance, 
>
> Geert-Jan
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30996-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 17:48:00 2007
Return-Path: <java-user-return-30996-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40891 invoked from network); 12 Nov 2007 17:48:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 17:48:00 -0000
Received: (qmail 99683 invoked by uid 500); 12 Nov 2007 17:47:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99651 invoked by uid 500); 12 Nov 2007 17:47:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99640 invoked by uid 99); 12 Nov 2007 17:47:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 09:47:41 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.184 as permitted sender)
Received: from [209.85.134.184] (HELO mu-out-0910.google.com) (209.85.134.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 17:47:44 +0000
Received: by mu-out-0910.google.com with SMTP id i10so1525683mue
        for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 09:47:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=rKYLfsZYUh1NS537DZLvT2xUqxd3ibYeRqLLn95jBfo=;
        b=F2yIOILQCDLCC/LIB33jXXfN4cRJYuX5aXbv5OGHVESKf2dHmffkM+c6H1fTD4JHZLX4s7ATny9soV6VtFrxKHHMoeidslqOjZDnI2C7P7rG6wRZ2IUUudewv3PMbvZx4cu7l6HjFKGSys/dUVmGZjb59dOFwfSLb7A9Y2Pavqg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=hpVuNPkuShbZTAhywq7j1CosSUK80+wGN8gEdF0Lm2/XkEpWRqLnMpOGmHPMXUOc3NnK3qYWtEEbJ6Ig05tIff1RhYfablP/SHAMhF3Xn1INFQI4PoLyyP/QeEO4eQ9w0u/ziIOzw4HjxY0vGjBFn5sTKwcxcpWkxZ4DygcI4i4=
Received: by 10.82.160.19 with SMTP id i19mr12317085bue.1194889626753;
        Mon, 12 Nov 2007 09:47:06 -0800 (PST)
Received: by 10.82.190.14 with HTTP; Mon, 12 Nov 2007 09:47:06 -0800 (PST)
Message-ID: <359a92830711120947l56a21642of760d896fd19dc7a@mail.gmail.com>
Date: Mon, 12 Nov 2007 12:47:06 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Create and populate a field when indexing
In-Reply-To: <13667927.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5202_24991318.1194889626715"
References: <13471852.post@talk.nabble.com>
	 <4449172F-9DC9-40A8-8180-7C0E47C4FE68@apache.org>
	 <13667927.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5202_24991318.1194889626715
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Sure, just define it in the same scope as you want to refer to it.
Of course, that tells you nothing <G>...

Java variables go out of scope when the last '}' *at the same level*
is passed. For intance:

{
   string s1;
   {
      string s2;
   } // s2 is out of scope after this line.
   // s1 is still available
}
//s1 no longer available.

So just define your category string "at the appropriate place" outside the
if statement and it will be available *after* the if. You may need to move
it outside the enclosing braces. Or outside the enclosing braces
outside the enclosing braces (as many levels as your braces are
nested that you want to refer to that variable).

Erick

On Nov 9, 2007 9:24 AM, KR <Keith.Rhodes.ext@siemens.com> wrote:

>
>
> Grant Ingersoll-6 wrote:
> >
> > When you are indexing the file and adding the Document, you will need
> > to parse out your filename per your regular expression, and then
> > create the appropriate field:
> >
> > Document doc = new Document()
> > String cat = getCategoryFromFileName(inputFileName)
> > doc.add(new Field("category", cat, ...)
> > //do the rest of your adds
> >
> > Just locate where in the demo the Document add is taking place (I
> > forget the exact spot) and then add in the appropriate stuff from
> > above.  Obviously, you need to implement the method I stubbed called
> > getCategoryFromFileName.
> >
> > HTH,
> > Grant
> >
>
> Thanks, Grant. That was just the hint I needed.
>
> I found that the fields are populated in HTMLDocument.
>
> I added:
>
> doc.add(new Field("category", "test", Field.Store.YES,
> Field.Index.TOKENIZED));
>
> and then used Luke to verify that this field had been added. It had.
>
> Now I am trying to get a quick-and-dirty way of setting the field based on
> the filename, but I'm running into problems that I don't really understand
> well enough to fix quickly.
>
> I have only very limited experience of Java programming, so I might be
> using
> the wrong terms, but I think the problem is variable scope. I get a
> compilation error:
>
> HTMLDocument.java:86: cannot find symbol
> symbol  : variable url
> location: class org.apache.lucene.demo.HTMLDocument
>        if (url.indexOf("-ov-") != -1) {
>
>
> I thought I'd be able to use a simple mechanism based on indexOf() to
> check
> the existence of a short sequence of characters within the filename. For
> example, "-sys-". I know that this sequence, if it exists anywhere in the
> full path must be in the filename.
>
> So I put in a series of if statements like this:
>
>        if (url.indexOf("-sys-") != -1) {
>                string category = "system";
>        }
>
> then right at the end:
> doc.add(new Field("category", category, Field.Store.YES,
> Field.Index.TOKENIZED));
>
> Am I right in thinking that the variable url is undefined at this point in
> the code? It certainly seems to be defined earlier on in the file:
>
>  public static String uid2url(String uid) {
>    String url = uid.replace('\u0000', '/');      // replace nulls with
> slashes
>    return url.substring(0, url.lastIndexOf('/')); // remove date from end
>  }
>
> Is there some way for me to perhaps chop down to the filename here, and
> make
> that available later in the code?
>
> K.
> --
> View this message in context:
> http://www.nabble.com/Create-and-populate-a-field-when-indexing-tf4713018.html#a13667927
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5202_24991318.1194889626715--

From java-user-return-30997-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 17:50:34 2007
Return-Path: <java-user-return-30997-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42235 invoked from network); 12 Nov 2007 17:50:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 17:50:34 -0000
Received: (qmail 6172 invoked by uid 500); 12 Nov 2007 17:50:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 6142 invoked by uid 500); 12 Nov 2007 17:50:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 6127 invoked by uid 99); 12 Nov 2007 17:50:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 09:50:12 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.184 as permitted sender)
Received: from [209.85.134.184] (HELO mu-out-0910.google.com) (209.85.134.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 17:50:15 +0000
Received: by mu-out-0910.google.com with SMTP id i10so1526609mue
        for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 09:49:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=ZGaZVTuMt214htyi807EBolSeyKNLA0xzHkGae7V2H8=;
        b=U7/0m/Juhl6A8SrH4vzdA3ae0be2xieJ1BoEzTXCD8QEeOD2PUWIjSbVdK/ID9KfflpPlyvL5ExSB+gm/YE2/e36iHlH8d5k2pQhHz0qgU4ozfQUHpNfpncZoXPwv1YWj5nhM8vItw5mx9Ah6AqVQGr1mq53ZKsWoPOR/6ZsLQ0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=J9jgwHsUtVhZP1fZiyHs5GkEQgzOFOoAstVQga+FP7u58b9l+0NCcsnw0PwTrc7OvMA0m2GipEPIY/60LWaLLXhgrs+lsocM1rVKVN3WwBNB88cHj+IB9hLdZic27r5w1TiyoGAX5pJPyAbFcB1z/ZZgiZGIqKXBEnkFgU4hOcs=
Received: by 10.82.181.10 with SMTP id d10mr11428720buf.1194889787256;
        Mon, 12 Nov 2007 09:49:47 -0800 (PST)
Received: by 10.82.190.14 with HTTP; Mon, 12 Nov 2007 09:49:47 -0800 (PST)
Message-ID: <359a92830711120949t7fa61d1dm52292a98192e263d@mail.gmail.com>
Date: Mon, 12 Nov 2007 12:49:47 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Comparing Two Indexes
In-Reply-To: <f1dbd1980711090914l33d06c88kd216ac07bafd84a9@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5224_6718343.1194889787255"
References: <f1dbd1980711090914l33d06c88kd216ac07bafd84a9@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5224_6718343.1194889787255
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

To paraphrase "Why do you want to know"? These kinds of questions
are so lacking in context that meaningful help is hard to offer. What
problem
are you trying to solve? Why do you want to compare indexes?

Erick

On Nov 9, 2007 12:14 PM, Lucene User <luceneuser4@gmail.com> wrote:

> Hi,
>
> I wanted two compare two indexes.Please recommend an algorithm
>
> which takes all the factors into accoubt such as versions of software
> being used by
>
> lucene and application which has an effect on the index being
> created.We can also
>
> compare with certain fields and the text.
>
> Regards
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5224_6718343.1194889787255--

From java-user-return-30998-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 18:43:47 2007
Return-Path: <java-user-return-30998-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74952 invoked from network); 12 Nov 2007 18:43:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 18:43:47 -0000
Received: (qmail 42142 invoked by uid 500); 12 Nov 2007 18:43:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42114 invoked by uid 500); 12 Nov 2007 18:43:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42101 invoked by uid 99); 12 Nov 2007 18:43:28 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 10:43:28 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 18:44:17 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IreFZ-0003sY-SL
	for java-user@lucene.apache.org; Mon, 12 Nov 2007 10:43:09 -0800
Message-ID: <13711541.post@talk.nabble.com>
Date: Mon, 12 Nov 2007 10:43:09 -0800 (PST)
From: KR <Keith.Rhodes.ext@siemens.com>
To: java-user@lucene.apache.org
Subject: Re: Create and populate a field when indexing
In-Reply-To: <359a92830711120947l56a21642of760d896fd19dc7a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: Keith.Rhodes.ext@siemens.com
References: <13471852.post@talk.nabble.com> <4449172F-9DC9-40A8-8180-7C0E47C4FE68@apache.org> <13667927.post@talk.nabble.com> <359a92830711120947l56a21642of760d896fd19dc7a@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org



Erick Erickson wrote:
> 
> Sure, just define it in the same scope as you want to refer to it.
> Of course, that tells you nothing <G>...
> 
> Java variables go out of scope when the last '}' *at the same level*
> is passed. For intance:
> 
> {
>    string s1;
>    {
>       string s2;
>    } // s2 is out of scope after this line.
>    // s1 is still available
> }
> //s1 no longer available.
> 
> So just define your category string "at the appropriate place" outside the
> if statement and it will be available *after* the if. You may need to move
> it outside the enclosing braces. Or outside the enclosing braces
> outside the enclosing braces (as many levels as your braces are
> nested that you want to refer to that variable).
> 
> 


Thanks, I understand that better now... (I hope).

It looks like the best way to do this would be to extract the filename from
the path  just after the code snippet below:


 public static Document Document(File f)
       throws IOException, InterruptedException  {
    // make a new, empty document
    Document doc = new Document();

    // Add the url as a field named "path".  Use a field that is 
    // indexed (i.e. searchable), but don't tokenize the field into words.
    doc.add(new Field("path", f.getPath().replace(dirSep, '/'),
Field.Store.YES,
        Field.Index.UN_TOKENIZED));


This way the filename is available for all the subsequent if {} blocks.

Keith.
-- 
View this message in context: http://www.nabble.com/Create-and-populate-a-field-when-indexing-tf4713018.html#a13711541
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-30999-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 19:31:23 2007
Return-Path: <java-user-return-30999-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 524 invoked from network); 12 Nov 2007 19:31:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 19:31:23 -0000
Received: (qmail 27389 invoked by uid 500); 12 Nov 2007 19:31:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27361 invoked by uid 500); 12 Nov 2007 19:31:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27350 invoked by uid 99); 12 Nov 2007 19:31:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 11:31:04 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 64.233.182.186 as permitted sender)
Received: from [64.233.182.186] (HELO nf-out-0910.google.com) (64.233.182.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 19:31:53 +0000
Received: by nf-out-0910.google.com with SMTP id d3so986136nfc
        for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 11:30:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=QjawUJQNvfhYt1GKLcQ0+8QjIcB50n5IBGIJ8K1H+G8=;
        b=HHLR6J5PCD8Wnu8dR5hDq0gQWO02xtQVQWvnHNuPvEt43roC0lBvF3FWdyF+yNGyHhe5YjmaMTnx/CVxwySpKHKnPkeJtjhN6JLJL8pAF1KgxdfwyA/wAHizUViFOKjn+PT8PUGk7vxogbK8eZfK3RvvGCdICEYsGFabNAYc3jo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=hogXXwj9LoFctFnFA5lH8YPrHDgKOOortafJP9rQPOIECxKYhASeQc7LdLD/fh5F/USomtzBKOSrFbRhycatKaVCven9QMUzQrwrtTnCs4fzHPLwF7KbxWyXfSEL8wvvwo4mcktu3T7tp+RKuEzVRuH/8kjdSUuaFWxp9afZmPU=
Received: by 10.82.154.12 with SMTP id b12mr12639832bue.1194895321517;
        Mon, 12 Nov 2007 11:22:01 -0800 (PST)
Received: by 10.82.190.14 with HTTP; Mon, 12 Nov 2007 11:22:01 -0800 (PST)
Message-ID: <359a92830711121122n6b5c606cka3bd6a93e031fce0@mail.gmail.com>
Date: Mon, 12 Nov 2007 14:22:01 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Create and populate a field when indexing
In-Reply-To: <13711541.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5571_6532261.1194895321515"
References: <13471852.post@talk.nabble.com>
	 <4449172F-9DC9-40A8-8180-7C0E47C4FE68@apache.org>
	 <13667927.post@talk.nabble.com>
	 <359a92830711120947l56a21642of760d896fd19dc7a@mail.gmail.com>
	 <13711541.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5571_6532261.1194895321515
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Sure, that'd work. It would also work to just continue to use
f.getPath() whenever you need it.

FWIW
Erick


On Nov 12, 2007 1:43 PM, KR <Keith.Rhodes.ext@siemens.com> wrote:

>
>
> Erick Erickson wrote:
> >
> > Sure, just define it in the same scope as you want to refer to it.
> > Of course, that tells you nothing <G>...
> >
> > Java variables go out of scope when the last '}' *at the same level*
> > is passed. For intance:
> >
> > {
> >    string s1;
> >    {
> >       string s2;
> >    } // s2 is out of scope after this line.
> >    // s1 is still available
> > }
> > //s1 no longer available.
> >
> > So just define your category string "at the appropriate place" outside
> the
> > if statement and it will be available *after* the if. You may need to
> move
> > it outside the enclosing braces. Or outside the enclosing braces
> > outside the enclosing braces (as many levels as your braces are
> > nested that you want to refer to that variable).
> >
> >
>
>
> Thanks, I understand that better now... (I hope).
>
> It looks like the best way to do this would be to extract the filename
> from
> the path  just after the code snippet below:
>
>
>  public static Document Document(File f)
>       throws IOException, InterruptedException  {
>    // make a new, empty document
>    Document doc = new Document();
>
>    // Add the url as a field named "path".  Use a field that is
>    // indexed (i.e. searchable), but don't tokenize the field into words.
>    doc.add(new Field("path", f.getPath().replace(dirSep, '/'),
> Field.Store.YES,
>        Field.Index.UN_TOKENIZED));
>
>
> This way the filename is available for all the subsequent if {} blocks.
>
> Keith.
> --
> View this message in context:
> http://www.nabble.com/Create-and-populate-a-field-when-indexing-tf4713018.html#a13711541
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5571_6532261.1194895321515--

From java-user-return-31000-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 20:23:03 2007
Return-Path: <java-user-return-31000-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23330 invoked from network); 12 Nov 2007 20:23:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 20:23:03 -0000
Received: (qmail 25448 invoked by uid 500); 12 Nov 2007 20:22:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25420 invoked by uid 500); 12 Nov 2007 20:22:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25398 invoked by uid 99); 12 Nov 2007 20:22:48 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 12:22:48 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [128.222.32.20] (HELO mexforward.lss.emc.com) (128.222.32.20)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 20:23:33 +0000
Received: from hop04-l1d11-si02.isus.emc.com (HOP04-L1D11-SI02.isus.emc.com [10.254.111.55])
	by mexforward.lss.emc.com (Switch-3.2.5/Switch-3.1.7) with ESMTP id lACKMPtT006020
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 15:22:25 -0500 (EST)
Received: from mailhub.lss.emc.com (nirah.lss.emc.com [10.254.144.13]) by hop04-l1d11-si02.isus.emc.com (Tablus Interceptor) for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 15:22:25 -0500
Received: from corpussmtp1.corp.emc.com (corpussmtp1.corp.emc.com [128.221.10.43])
	by mailhub.lss.emc.com (Switch-3.2.5/Switch-3.1.7) with ESMTP id lACKLrnv022160
	for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 15:22:24 -0500 (EST)
From: Seneviratne_Yasoja@emc.com
Received: from CORPUSMX10C.corp.emc.com ([128.221.14.93]) by corpussmtp1.corp.emc.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 12 Nov 2007 15:21:59 -0500
x-mimeole: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: indexing a large number of fields (and nesting them)
Date: Mon, 12 Nov 2007 15:21:58 -0500
Message-ID: <8856DF1FF75B2348A2D4033D1E8A7EE402229F8F@CORPUSMX10C.corp.emc.com>
In-Reply-To: <4738732D.3040505@hauk-sasko.de>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: indexing a large number of fields (and nesting them)
Thread-Index: AcglQge+NCBDTmT/Qs+gExZZVxl4GQAJRKOA
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 12 Nov 2007 20:21:59.0511 (UTC) FILETIME=[ADA4C670:01C82569]
X-PMX-Version: 4.7.1.128075, Antispam-Engine: 2.5.1.298604, Antispam-Data: 2007.8.30.51425
X-PerlMx-Spam: Gauge=, SPAM=1%, Reason='EMC_FROM_0+ -3, NO_REAL_NAME 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __IMS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __SANE_MSGID 0'
X-Tablus-Inspected: yes
X-Tablus-Classifications: public
X-Tablus-Action: allow
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I need to index tons of meta-data fields along with every document
(around 80 fields, mostly strings of 32 characters, some integers, bools
and dates too, a couple of strings are longer like 64 chars or 120).

Also it would be nice if there was a way to represent nested fields, and
query for them.  Right now nesting is handled by redundantly creating
fields.  And numbers and dates are normalized to strings during
indexing/querying.

So representing the following meta data:
<field A>
  <sub field a>
  <sub field b>
</field A>

in lucene looks like:
Document.add(new Field("fieldA", "value of entire field A section",
Field.Store.YES, Field.Index.TOKENIZED)

Document.add(new Field("fielda", "value of field a", Field.Store.YES,
Field.Index.TOKENIZED)

Document.add(new Field("fielda", "value of field b", Field.Store.YES,
Field.Index.TOKENIZED)

Is there a better way to do this?  I'd appreciate any suggestions. =20

Thanks,
Yasoja


PS: Current implementation is on an older lucene 2.1 but moving to 2.2
or 2.3 is not a problem.



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31001-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 21:45:31 2007
Return-Path: <java-user-return-31001-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61717 invoked from network); 12 Nov 2007 21:45:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 21:45:31 -0000
Received: (qmail 55148 invoked by uid 500); 12 Nov 2007 21:45:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55113 invoked by uid 500); 12 Nov 2007 21:45:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55100 invoked by uid 99); 12 Nov 2007 21:45:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 13:45:13 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.76.149.213] (HELO ch-smtp02.sth.basefarm.net) (80.76.149.213)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 21:45:14 +0000
Received: from c80-217-212-236.bredband.comhem.se ([80.217.212.236]:62478 helo=smtp.1und1.com)
	by ch-smtp02.sth.basefarm.net with esmtp (Exim 4.68)
	(envelope-from <hardy@ferentschik.de>)
	id 1Irh5I-0007rd-8W
	for java-user@lucene.apache.org; Mon, 12 Nov 2007 22:44:45 +0100
To: java-user@lucene.apache.org
Subject: substring indexing to avoid 'TooManyClauses' exception
From: "Hardy Ferentschik" <hardy@ferentschik.de>
Content-Type: text/plain; format=flowed; delsp=yes; charset=iso-8859-15
MIME-Version: 1.0
Content-Transfer-Encoding: 8bit
Date: Mon, 12 Nov 2007 22:44:40 +0100
Message-ID: <op.t1o70q0xvsesg3@smtp.1und1.com>
User-Agent: Opera Mail/9.22 (Win32)
X-Relayed-By: GPGrelay Version 0.959 (Win32)
X-Originating-IP: 80.217.212.236
X-Scan-Result: No virus found in message 1Irh5I-0007rd-8W.
X-Scan-Signature: ch-smtp02.sth.basefarm.net 1Irh5I-0007rd-8W 760ea30eda44bde754d2861a6cae90ea
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I have a question regarding the way I got around the 'TooManyClauses'  
exception when using wild card queries  
(http://wiki.apache.org/lucene-java/LuceneFAQ#head-06fafb5d19e786a50fb3dfb8821a6af9f37aa831).


I am using Lucene in conjunction with Hibernate Search  
(http://www.hibernate.org/410.html). I am indexing 'Compmany' objects  
which contain multiple attibutes and the application supports different  
types of searches.

One type of search is a right hand truncated (wildcard query) search of  
the company name. If eg the user searches for 'M' I constructed initially  
a 'M*' query. I have about 250.000 companies in the index. Without any  
modifications I get the 'TooManyClauses' exception and I initially kept  
increasing the 'maxClauseCount'. It works, but performace was terrible. I  
haven't tried working with a filter, but instead decided to try a  
different approach. I index all possible substrings of a string , eg 'Foo'  
would be indexed as 'F', 'Fo' and 'Foo'.

I got rid of the 'TooManyClauses' exception and performace improved by  
magnitude, but I would like to get some feedback from other users whether  
this is a good approach or not.

Of course the index size increased, but that was no issue in this case.  
Are there any potential problems with ranking/scoring?

Thanks for any feedback.

--Hardy


-- 
Hartmut Ferentschik
Ekholmsv.339 ,1, 127 45 Skrholmen, Sweden
Phone: +46 855 923 676 (h); +46 704 225 097 (m)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31002-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 22:43:09 2007
Return-Path: <java-user-return-31002-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 91954 invoked from network); 12 Nov 2007 22:43:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 22:43:09 -0000
Received: (qmail 36094 invoked by uid 500); 12 Nov 2007 22:42:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36063 invoked by uid 500); 12 Nov 2007 22:42:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36052 invoked by uid 99); 12 Nov 2007 22:42:51 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 14:42:51 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of bforrest10@gmail.com designates 64.233.184.234 as permitted sender)
Received: from [64.233.184.234] (HELO wr-out-0506.google.com) (64.233.184.234)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 22:42:54 +0000
Received: by wr-out-0506.google.com with SMTP id c46so628699wra
        for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 14:42:33 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        bh=kWB62Fw0uMN2FiSWsyJASE+1p4UnXBpN7/0CF/Rqbwc=;
        b=h0kPdY9yQAoZvHK8smr556YKaTK0DkPhautGWF01yzbuYHRMxN2Uct8aicD5mHfJOa/rVCeCqSpkgG5Hk18IAvO85mY5PsCgJtmSdYQEuKmKi5KPLRLxTpM948SzjW2DQp9ZRIE1QFNSH0z44cpCC4J/u4xtH9itas7kJbHzIIk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        b=AjF7WnNJ1pNBx0zi05vZbYuuxdzum2Pf4gfVGq5PyRNULz/3hq9wLiPHHTqHdMZ02NOdcbxJ0VSa55v0bTxMag+LwkktRDoF55lmnzvN1yMZlveiH5qVcCoCF8x7wZMji4mYcESg9xpsdvtOEVo9XDuTXexlCE5k+6Zzd4q4lzw=
Received: by 10.100.251.5 with SMTP id y5mr8418874anh.1194907353511;
        Mon, 12 Nov 2007 14:42:33 -0800 (PST)
Received: by 10.100.209.15 with HTTP; Mon, 12 Nov 2007 14:42:33 -0800 (PST)
Message-ID: <525c024b0711121442lcb808e0pb66dd548946954d0@mail.gmail.com>
Date: Tue, 13 Nov 2007 09:42:33 +1100
From: "Barry Forrest" <bforrest10@gmail.com>
To: "J.J. Larrea" <jjl@panix.com>
Subject: Re: Optimizing index takes too long
Cc: java-user@lucene.apache.org
In-Reply-To: <p06240808c35d5c29bd45@192.168.1.2>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_18919_26190865.1194907353495"
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
	 <5F1985B0-6F4C-4274-B188-521312C2E018@apache.org>
	 <525c024b0711111605s1aa8ff56hbea8d739f1cbae4f@mail.gmail.com>
	 <p06240808c35d5c29bd45@192.168.1.2>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_18919_26190865.1194907353495
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

On Nov 12, 2007 1:15 PM, J.J. Larrea <jjl@panix.com> wrote:

>
> 2. Since the full document and its longer bibliographic subfields are
> being indexed but not stored, my guess is that the large size of the index
> segments is due to the inverted index rather than the stored data fields.
>  But you can roughly verify by checking the size of the files in the index,
> with Luke's Files tab or simply an ls -l.  For example .fdt files are stored
> data while .tis are the inverted index; see
> http://lucene.apache.org/java/docs/fileformats.html  And if you have .cfs
> files...


OK here are some of the details of one index directory.  The number of
indexed documents is approximately 1.5million.

$ ls -1 |wc -l
29542

$ du -hs .
90G     .

$ // Show space used (in GB) by file extension.
$ for filetype in `ls -1 | sed -r "s/.*\.(.*)/\1/" | sort -u` ;\
  do echo -n "filetype=$filetype: " ; (echo -n "scale=2; \
  (" ; (for size in `ls -l *.$filetype| cut -c 24-34`; do \
  echo -n "$size+"; done) ; echo "0)/10^9") | bc; done

filetype=fdt: .44
filetype=fdx: .01
filetype=fnm: .01
filetype=frq: 15.95
filetype=lock: 0
filetype=nrm: .03
filetype=prx: 70.94
filetype=tii: .12
filetype=tis: 8.79


So most of the space is occupied with .prx files.

Thanks
Barry

------=_Part_18919_26190865.1194907353495--

From java-user-return-31003-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 12 22:49:53 2007
Return-Path: <java-user-return-31003-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97513 invoked from network); 12 Nov 2007 22:49:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 12 Nov 2007 22:49:53 -0000
Received: (qmail 49619 invoked by uid 500); 12 Nov 2007 22:49:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49591 invoked by uid 500); 12 Nov 2007 22:49:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49580 invoked by uid 99); 12 Nov 2007 22:49:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 14:49:35 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luceneuser4@gmail.com designates 72.14.202.176 as permitted sender)
Received: from [72.14.202.176] (HELO ro-out-1112.google.com) (72.14.202.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 22:49:39 +0000
Received: by ro-out-1112.google.com with SMTP id m6so405038roe
        for <java-user@lucene.apache.org>; Mon, 12 Nov 2007 14:49:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=E1fue5VgyfmL9/mG5iNzYxgneAYhzK3c5/qFL9W9tMo=;
        b=Gb24Pphloy1fGBArZdNUyK+DsM7ek3jrWv6zRSeL1H8K8UObRDTQ4SubCia5JS69VhGHxbysBAHfg2ooNVM0wCvOHrjxudT5I6yTxEliGjQMdU/Yu6mqTXd1A1P9uvi00RPIcLA3jzqgT2avZ8LQPfwdz5Oi1P0fNVCQkyFEyrE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=HGfgNqRTXRTXWGB5NKeXyPbbSR7X5JAfWXhJKg+FcQVj1cb3Hqs0mt0WtGIJtC8wJgbdS9+kAUaIVsVfhKwH5Ahtht+ypQnz7JeoizBifOVuNxpFTRsW6mfaTWe4QF1Qj3nLWLJmcOvnxmqdArcymhRSBk9fCJyCYC7UlYFwL5M=
Received: by 10.100.228.17 with SMTP id a17mr8425928anh.1194907756786;
        Mon, 12 Nov 2007 14:49:16 -0800 (PST)
Received: by 10.101.66.10 with HTTP; Mon, 12 Nov 2007 14:49:16 -0800 (PST)
Message-ID: <f1dbd1980711121449v3aee1134jee2d60daace06c40@mail.gmail.com>
Date: Mon, 12 Nov 2007 17:49:16 -0500
From: "Lucene User" <luceneuser4@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Optimizing index takes too long
In-Reply-To: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_22873_23348846.1194907756785"
References: <525c024b0711111516o255e13fyf017751419f5e184@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_22873_23348846.1194907756785
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

what type of documents are indexing

regards

gaurav


On 11/11/07, Barry Forrest <bforrest10@gmail.com> wrote:
>
> Hi,
>
> Optimizing my index of 1.5 million documents takes days and days.
>
> I have a collection of 10 million documents that I am trying to index
> with Lucene.  I've divided the collection into chunks of about 1.5 - 2
> million documents each.  Indexing 1.5 documents is fast enough (about
> 12 hours), but this results in an index directory containing about
> 35000 files.  Optimizing this index takes several days, which is a bit
> too long for my purposes.  Each sub-index is about 150G.
>
> What can I do to make this process faster?
>
> Thanks for your help,
> Barry
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_22873_23348846.1194907756785--

From java-user-return-31004-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 02:13:49 2007
Return-Path: <java-user-return-31004-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90095 invoked from network); 13 Nov 2007 02:13:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 02:13:49 -0000
Received: (qmail 83700 invoked by uid 500); 13 Nov 2007 02:13:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83666 invoked by uid 500); 13 Nov 2007 02:13:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83654 invoked by uid 99); 13 Nov 2007 02:13:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 18:13:31 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 02:13:32 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IrlH5-0001Dk-ID
	for java-user@lucene.apache.org; Mon, 12 Nov 2007 18:13:11 -0800
Message-ID: <13718609.post@talk.nabble.com>
Date: Mon, 12 Nov 2007 18:13:11 -0800 (PST)
From: kumarlimbu <kumarlimbu@gmail.com>
To: java-user@lucene.apache.org
Subject: RE: best way to share cookie info (user search history, etc.)
 between two load balanaced lucene search servers..
In-Reply-To: <4FA8C6AEE609B644B38DE471A3657A620239DD7D@INVS1.bangalore.corp.akamai.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: kumarlimbu@gmail.com
References: <13702686.post@talk.nabble.com> <4FA8C6AEE609B644B38DE471A3657A620239DD7D@INVS1.bangalore.corp.akamai.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi Kapil,

Thanks for your response.

We are looking at replicating complete lucene index on both servers. The
main reason for this is the ease of scaling compared to say splitting the
index between the 2 servers. Since we will have separate indexes we won't be
using MultiSearcher/ParallelMultiSearcher.

We are using domain based cookie as opposed to server based cookie. But we
are using HTTPSession for storing the more complicated datastructures as it
allows easier manipulation of objects. The problem we for  us is sharing
this information between two tomcat servers running lucene searches. And we
plan on using both servers for rendering results directly to the end user.

We are not sure about the load balancer yet. That is what we are trying to
find out. I was thinking of using LVS, but not sure how easy is it to use. I
also found the Persistence feature to be quite useful. Is there any better
solution for load balancing?



Chhabra, Kapil wrote:
> 
> Ah! There are so many ways to do this as there are so many questions
> unanswered in your mail.
> 
> What kind of load balancer are you going to install?
> Will you be replicating the complete lucene index on both the servers?
> Do you plan to use the MultiSearcher/ParellelMultiSearcher?
> Do these servers share a common domain name eg. server1.mydomain.com &
> server2.mydomain.com?
> How and where do you store the user search history (is it in the cookies
> itself?)
> 
> Anyhow, simply put, if 
> 1. your servers share a common domin name with different subdomain
> 2. you store user info in the cookies &
> 3. both servers will render results directly to the end user
> You could solve your problem easily by using a domain based cookie
> rather than a server based cookie.
> 
> Ie. Instead of setting the cookie access for a server (eg.
> server1.mydomain.com), set it for the domain (eg. .mydomain.com, don't
> forget the "dot" before the domain name).
> 
> Regards,
> kapilChhabra
> 
> -----Original Message-----
> From: kumarlimbu [mailto:kumarlimbu@gmail.com] 
> Sent: Monday, November 12, 2007 3:18 PM
> To: java-user@lucene.apache.org
> Subject: best way to share cookie info (user search history, etc.)
> between two load balanaced lucene search servers..
> 
> 
> Hi Everyone,
> 
> We are planning on scaling our current web server by adding a machine
> with similar specification. Both machine will be running lucene
> searches. What we plan to do is add a load balancer in front of these
> servers. Our requirement is to be able to share user info (user search
> history, etc.), cookies etc between these two servers. What is the best
> way to load balance two or more lucene search server and share session
> and cookie information between these servers?
> 
> Our current server has 8 GB of RAM and size of the index is around 8GB
> (contains around 3M+ records) as well. Any more info about current
> server environment will be provided upon request.
> 
> Thank you all.
> 
> Kumar
> --
> View this message in context:
> http://www.nabble.com/best-way-to-share-cookie-info-%28user-search-histo
> ry%2C-etc.%29-between-two-load-balanaced-lucene-search-servers..-tf47899
> 75.html#a13702686
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/best-way-to-share-cookie-info-%28user-search-history%2C-etc.%29-between-two-load-balanaced-lucene-search-servers..-tf4789975.html#a13718609
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31005-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 07:41:31 2007
Return-Path: <java-user-return-31005-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82860 invoked from network); 13 Nov 2007 07:41:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 07:41:31 -0000
Received: (qmail 8326 invoked by uid 500); 13 Nov 2007 07:41:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8288 invoked by uid 500); 13 Nov 2007 07:41:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8277 invoked by uid 99); 13 Nov 2007 07:41:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Nov 2007 23:41:12 -0800
X-ASF-Spam-Status: No, hits=-0.8 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp2.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 07:42:00 +0000
Received: from smtp2.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp2.akamai.com (8.13.8/8.12.10) with ESMTP id lAD7fhoP020178
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 02:41:43 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp2.akamai.com (8.13.8/8.12.10) with ESMTP id lAD7fgfP020170
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 02:41:42 -0500 (EST)
Received: from MAVS2.kendall.corp.akamai.com ([172.17.33.20]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 13 Nov 2007 02:40:49 -0500
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by MAVS2.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 13 Nov 2007 02:40:49 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: best way to share cookie info (user search history, etc.) between two load balanaced lucene search servers..
Date: Tue, 13 Nov 2007 13:10:45 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A620239DFB0@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <13718609.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: best way to share cookie info (user search history, etc.) between two load balanaced lucene search servers..
Thread-Index: AcglmtcfbOZJoTwCQxqRRfjq/Uf2xgALS/ig
References: <13702686.post@talk.nabble.com> <4FA8C6AEE609B644B38DE471A3657A620239DD7D@INVS1.bangalore.corp.akamai.com> <13718609.post@talk.nabble.com>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 13 Nov 2007 07:40:49.0134 (UTC) FILETIME=[826408E0:01C825C8]
X-Virus-Checked: Checked by ClamAV on apache.org

Kumar,
This seems to be more of a non-lucene problem.=20

Anyhow, have a look at "ha-proxy"; this is closer to what you require.

We can discuss more on this off the lucene list, if required.

Regards,
kapilChhabra


-----Original Message-----
From: kumarlimbu [mailto:kumarlimbu@gmail.com]=20
Sent: Tuesday, November 13, 2007 7:43 AM
To: java-user@lucene.apache.org
Subject: RE: best way to share cookie info (user search history, etc.)
between two load balanaced lucene search servers..


Hi Kapil,

Thanks for your response.

We are looking at replicating complete lucene index on both servers. The
main reason for this is the ease of scaling compared to say splitting
the index between the 2 servers. Since we will have separate indexes we
won't be using MultiSearcher/ParallelMultiSearcher.

We are using domain based cookie as opposed to server based cookie. But
we are using HTTPSession for storing the more complicated datastructures
as it allows easier manipulation of objects. The problem we for  us is
sharing this information between two tomcat servers running lucene
searches. And we plan on using both servers for rendering results
directly to the end user.

We are not sure about the load balancer yet. That is what we are trying
to find out. I was thinking of using LVS, but not sure how easy is it to
use. I also found the Persistence feature to be quite useful. Is there
any better solution for load balancing?



Chhabra, Kapil wrote:
>=20
> Ah! There are so many ways to do this as there are so many questions=20
> unanswered in your mail.
>=20
> What kind of load balancer are you going to install?
> Will you be replicating the complete lucene index on both the servers?
> Do you plan to use the MultiSearcher/ParellelMultiSearcher?
> Do these servers share a common domain name eg. server1.mydomain.com &

> server2.mydomain.com?
> How and where do you store the user search history (is it in the=20
> cookies
> itself?)
>=20
> Anyhow, simply put, if
> 1. your servers share a common domin name with different subdomain 2.=20
> you store user info in the cookies & 3. both servers will render=20
> results directly to the end user You could solve your problem easily=20
> by using a domain based cookie rather than a server based cookie.
>=20
> Ie. Instead of setting the cookie access for a server (eg.
> server1.mydomain.com), set it for the domain (eg. .mydomain.com, don't

> forget the "dot" before the domain name).
>=20
> Regards,
> kapilChhabra
>=20
> -----Original Message-----
> From: kumarlimbu [mailto:kumarlimbu@gmail.com]
> Sent: Monday, November 12, 2007 3:18 PM
> To: java-user@lucene.apache.org
> Subject: best way to share cookie info (user search history, etc.)=20
> between two load balanaced lucene search servers..
>=20
>=20
> Hi Everyone,
>=20
> We are planning on scaling our current web server by adding a machine=20
> with similar specification. Both machine will be running lucene=20
> searches. What we plan to do is add a load balancer in front of these=20
> servers. Our requirement is to be able to share user info (user search

> history, etc.), cookies etc between these two servers. What is the=20
> best way to load balance two or more lucene search server and share=20
> session and cookie information between these servers?
>=20
> Our current server has 8 GB of RAM and size of the index is around 8GB

> (contains around 3M+ records) as well. Any more info about current=20
> server environment will be provided upon request.
>=20
> Thank you all.
>=20
> Kumar
> --
> View this message in context:
> http://www.nabble.com/best-way-to-share-cookie-info-%28user-search-his
> to
> ry%2C-etc.%29-between-two-load-balanaced-lucene-search-servers..-tf478
> 99
> 75.html#a13702686
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>=20
>=20
>=20

--
View this message in context:
http://www.nabble.com/best-way-to-share-cookie-info-%28user-search-histo
ry%2C-etc.%29-between-two-load-balanaced-lucene-search-servers..-tf47899
75.html#a13718609
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31006-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 12:22:03 2007
Return-Path: <java-user-return-31006-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23456 invoked from network); 13 Nov 2007 12:22:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 12:22:03 -0000
Received: (qmail 75490 invoked by uid 500); 13 Nov 2007 12:21:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75452 invoked by uid 500); 13 Nov 2007 12:21:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75441 invoked by uid 99); 13 Nov 2007 12:21:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 04:21:44 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [193.137.179.196] (HELO equipa.di.uevora.pt) (193.137.179.196)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 12:22:36 +0000
Received: from [10.10.10.194] (sslwrap@localhost [127.0.0.1])
	by equipa.di.uevora.pt (8.13.5/8.13.5/Debian-3) with ESMTP id lADCLN9v008769;
	Tue, 13 Nov 2007 12:21:23 GMT
Subject: Lucene  search question
From: =?ISO-8859-1?Q?Cl=E1udio?= Fernandes <cff@di.uevora.pt>
To: java-user@lucene.apache.org
Cc: cff <cff@alinex.org>
Content-Type: text/plain; charset=ISO-8859-15
Organization: Universidade =?ISO-8859-1?Q?=C9vora?=
Date: Tue, 13 Nov 2007 12:21:43 +0000
Message-Id: <1194956503.6185.13.camel@localhost.localdomain>
Mime-Version: 1.0
X-Mailer: Evolution 2.12.0 
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello all, 

I don't know if this is a somehow naive question, but here we go:

Does Lucene support index by sections? Like having a text document with
three sections divided by XML tags indexed in a way we could do a search
by work and section. Does Lucene itself support this kind of indexing or
should it be used with other engines like Cocoon?

Thanks in advance for your time, 


-- 
Cludio Fernandes


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31007-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 12:30:48 2007
Return-Path: <java-user-return-31007-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27258 invoked from network); 13 Nov 2007 12:30:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 12:30:48 -0000
Received: (qmail 84212 invoked by uid 500); 13 Nov 2007 12:30:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84180 invoked by uid 500); 13 Nov 2007 12:30:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84169 invoked by uid 99); 13 Nov 2007 12:30:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 04:30:30 -0800
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp1.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 12:31:22 +0000
Received: from smtp1.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lADCS6jA011257
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 07:28:07 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lADCS3Xq011216;
	Tue, 13 Nov 2007 07:28:03 -0500 (EST)
Received: from MAVS1.kendall.corp.akamai.com ([172.17.33.15]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 13 Nov 2007 07:30:06 -0500
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by MAVS1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 13 Nov 2007 07:30:06 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Lucene  search question
Date: Tue, 13 Nov 2007 18:00:02 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A620239E077@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <1194956503.6185.13.camel@localhost.localdomain>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene  search question
Thread-Index: Acgl79xKIq5Xe4Q9S2OeuZgwBnOXkgAAGOjQ
References: <1194956503.6185.13.camel@localhost.localdomain>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
Cc: "cff" <cff@alinex.org>
X-OriginalArrivalTime: 13 Nov 2007 12:30:06.0067 (UTC) FILETIME=[EBEDD430:01C825F0]
X-Virus-Checked: Checked by ClamAV on apache.org

If its only about the search, you could have "section" as just another =
field in your index. You could simply search on work as "well" as =
"section".

Otherwise, if you are looking at aggregating category hits, then look at =
http://mail-archives.apache.org/mod_mbox/lucene-java-user/200605.mbox/%3c=
200605221252.k4MCqCuf017313@pigeon.ciao.com%3e

Regards,
kapilChhabra

-----Original Message-----
From: Cl=E1udio Fernandes [mailto:cff@di.uevora.pt]=20
Sent: Tuesday, November 13, 2007 5:52 PM
To: java-user@lucene.apache.org
Cc: cff
Subject: Lucene search question

Hello all,=20

I don't know if this is a somehow naive question, but here we go:

Does Lucene support index by sections? Like having a text document with =
three sections divided by XML tags indexed in a way we could do a search =
by work and section. Does Lucene itself support this kind of indexing or =
should it be used with other engines like Cocoon?

Thanks in advance for your time,=20


--
Cl=E1udio Fernandes


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31008-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 12:33:14 2007
Return-Path: <java-user-return-31008-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27930 invoked from network); 13 Nov 2007 12:33:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 12:33:14 -0000
Received: (qmail 86425 invoked by uid 500); 13 Nov 2007 12:32:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86027 invoked by uid 500); 13 Nov 2007 12:32:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86016 invoked by uid 99); 13 Nov 2007 12:32:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 04:32:56 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.74] (HELO spunkymail-a16.g.dreamhost.com) (208.97.132.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 12:33:47 +0000
Received: from [10.0.1.2] (1023chost82.starwoodbroadband.com [12.37.185.82])
	by spunkymail-a16.g.dreamhost.com (Postfix) with ESMTP id D71437BE83
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 04:32:25 -0800 (PST)
Message-Id: <75900C13-71C1-4AF1-8DE4-0CA914AA7C65@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <1194956503.6185.13.camel@localhost.localdomain>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Lucene  search question
Date: Tue, 13 Nov 2007 07:32:03 -0500
References: <1194956503.6185.13.camel@localhost.localdomain>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, your application can do this using Lucene.  Lucene is a low level =20=

search enabling library, it is up to your application to give meaning =20=

to what you put in it.

One way doing what you want is to give each section its own Field for =20=

any given document.

Cheers,
Grant
On Nov 13, 2007, at 7:21 AM, Cl=E1udio Fernandes wrote:

> Hello all,
>
> I don't know if this is a somehow naive question, but here we go:
>
> Does Lucene support index by sections? Like having a text document =20
> with
> three sections divided by XML tags indexed in a way we could do a =20
> search
> by work and section. Does Lucene itself support this kind of =20
> indexing or
> should it be used with other engines like Cocoon?
>
> Thanks in advance for your time,
>
>
> --=20
> Cl=E1udio Fernandes
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31009-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 14:38:06 2007
Return-Path: <java-user-return-31009-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 76333 invoked from network); 13 Nov 2007 14:38:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 14:38:06 -0000
Received: (qmail 50481 invoked by uid 500); 13 Nov 2007 14:37:47 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50442 invoked by uid 500); 13 Nov 2007 14:37:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50430 invoked by uid 99); 13 Nov 2007 14:37:46 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 06:37:46 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [130.225.24.87] (HELO luna.statsbiblioteket.dk) (130.225.24.87)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 14:38:38 +0000
Received: from [130.225.25.7] (pc977.sb.statsbiblioteket.dk [130.225.25.7])
 by luna.statsbiblioteket.dk
 (iPlanet Messaging Server 5.2 HotFix 1.16 (built May 14 2003))
 with ESMTP id <0JRG00C9Z8MHV3@luna.statsbiblioteket.dk> for
 java-user@lucene.apache.org; Tue, 13 Nov 2007 15:37:29 +0100 (MET)
Date: Tue, 13 Nov 2007 15:37:29 +0100
From: Lars Clausen <lc@statsbiblioteket.dk>
Subject: OutOfMemoryError on small search in large, simple index
To: java-user@lucene.apache.org
Message-id: <1194964649.13896.1180.camel@pc977>
Organization: Statsbiblioteket
MIME-version: 1.0
X-Mailer: Evolution 2.12.0
Content-type: text/plain
Content-transfer-encoding: 7BIT
X-Virus-Checked: Checked by ClamAV on apache.org

We've run into a blocking problem with our use of Lucene: we get
OutOfMemoryError when performing a one-term search in our index. The
search, if completed, should give only a few thousand hits, but from
inspecting a heap dump it appears that many more documents in the index
get stored in Lucene during the search. Our index consists of eight
fields per document, fairly regularly sized, the total index size is
170GB, spread over about 400 million documents (425 bytes per document).
The search is a simple TermQuery, the search term a trivial string, the
code in question looks like this (cut together for conciseness): 

public static final String FIELD_URL = "url";
...
luceneSearcher = new IndexSearcher(indexDir.getAbsolutePath());
Query query = new TermQuery(new Term(DigestIndexer.FIELD_URL, uri));
try {
Hits hits = luceneSearcher.search(query);

Stack trace:
Oct 11, 2007 4:02:19 PM org.slf4j.impl.JCLLoggerAdapter error
SEVERE: EXCEPTION 
java.lang.OutOfMemoryError: Java heap space
at
org.apache.lucene.index.SegmentReader.getNorms(SegmentReader.java:384)
at org.apache.lucene.index.SegmentReader.norms(SegmentReader.java:393)
at org.apache.lucene.search.TermQuery
$TermWeight.scorer(TermQuery.java:68)
at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:129)
at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:99)
at org.apache.lucene.search.Hits.getMoreDocs(Hits.java:65)
at org.apache.lucene.search.Hits.(Hits.java:44)
at org.apache.lucene.search.Searcher.search(Searcher.java:44)
at org.apache.lucene.search.Searcher.search(Searcher.java:36)
at
dk.netarkivet.common.distribute.arcrepository.ARCLookup.luceneLookup(ARCLookup.java:166)
at
dk.netarkivet.common.distribute.arcrepository.ARCLookup.lookup(ARCLookup.java:130)
at
dk.netarkivet.viewerproxy.ARCArchiveAccess.lookup(ARCArchiveAccess.java:126)
at
dk.netarkivet.viewerproxy.NotifyingURIResolver.lookup(NotifyingURIResolver.java:72)
at
dk.netarkivet.viewerproxy.CommandResolver.lookup(CommandResolver.java:80)
at
dk.netarkivet.viewerproxy.CommandResolver.lookup(CommandResolver.java:80)
at
dk.netarkivet.viewerproxy.CommandResolver.lookup(CommandResolver.java:80)
at dk.netarkivet.viewerproxy.WebProxy.handle(WebProxy.java:129)
at
org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:139)
at org.mortbay.jetty.Server.handle(Server.java:285)
at
org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:457)
at org.mortbay.jetty.HttpConnection
$RequestHandler.headerComplete(HttpConnection.java:751)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:500)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:209)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:357)
at org.mortbay.jetty.bio.SocketConnector
$Connection.run(SocketConnector.java:217)
at org.mortbay.thread.BoundedThreadPool
$PoolThread.run(BoundedThreadPool.java:475)

Can it be right that memory usage depends on size of the index rather
than size of the result?  Can something be done to reduce memory usage
for such a simple but big scenario?

-Lars


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31010-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 15:12:46 2007
Return-Path: <java-user-return-31010-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95902 invoked from network); 13 Nov 2007 15:12:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 15:12:44 -0000
Received: (qmail 10812 invoked by uid 500); 13 Nov 2007 15:12:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10532 invoked by uid 500); 13 Nov 2007 15:12:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10517 invoked by uid 99); 13 Nov 2007 15:12:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 07:12:25 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.29.8 as permitted sender)
Received: from [80.67.29.8] (HELO smtprelay08.ispgateway.de) (80.67.29.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 15:13:16 +0000
Received: (qmail 27827 invoked from network); 13 Nov 2007 15:12:07 -0000
Received: from unknown (HELO p54bfdb40.dip.t-dialin.net) (695637@[84.191.219.64])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay08.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 13 Nov 2007 15:12:07 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: OutOfMemoryError on small search in large, simple index
Date: Tue, 13 Nov 2007 16:13:07 +0100
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <1194964649.13896.1180.camel@pc977>
In-Reply-To: <1194964649.13896.1180.camel@pc977>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711131613.07641@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Dienstag, 13. November 2007, Lars Clausen wrote:

> Can it be right that memory usage depends on size of the index rather
> than size of the result?

Yes, see IndexWriter.setTermIndexInterval(). How much RAM are you giving to 
the JVM now?

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31011-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 15:13:07 2007
Return-Path: <java-user-return-31011-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95966 invoked from network); 13 Nov 2007 15:13:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 15:13:07 -0000
Received: (qmail 12566 invoked by uid 500); 13 Nov 2007 15:12:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12160 invoked by uid 500); 13 Nov 2007 15:12:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12149 invoked by uid 99); 13 Nov 2007 15:12:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 07:12:49 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 66.249.92.172 as permitted sender)
Received: from [66.249.92.172] (HELO ug-out-1314.google.com) (66.249.92.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 15:12:49 +0000
Received: by ug-out-1314.google.com with SMTP id h3so114211ugf
        for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 07:12:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=x3Kom88IGLlOmDMO2jqgvUuE9sGoQ716Gnd5TsbleLg=;
        b=AX5CHSGhKouysBGKw5n8nDksgFiIZgLKH3ohjZ0Sccmyb7m5DAT9LkFv1wBQBR8+s76aSV2bIKR1//LXlxjVxXTIJXMkATne/3I58XNTx2MxqPmj426wk7CUj4jMp7raYaBd9ANxwbIcLGOIFP7M7acIN+RyPw8pJwWQy+Aph5E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=g9ddfq2rdHm1vIWHfbQfvvjdJ4N3Fs96XAaJfCvxE5ohvDwGpnj1Ri/SjbgR1TxInkJ0hJpCBhaATallYfxuq8Vg24J81Zv8ykwZ+xwK5z1rF9VQq3Zo0eddi0zW7sAfV0QknIGPlv+2Uajouve3tSZamo3X09qEvZqOoNYn2Qs=
Received: by 10.67.26.11 with SMTP id d11mr709504ugj.1194966746578;
        Tue, 13 Nov 2007 07:12:26 -0800 (PST)
Received: by 10.86.89.14 with HTTP; Tue, 13 Nov 2007 07:12:26 -0800 (PST)
Message-ID: <359a92830711130712h39c1abb2l207773b32378171@mail.gmail.com>
Date: Tue, 13 Nov 2007 10:12:26 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: substring indexing to avoid 'TooManyClauses' exception
In-Reply-To: <op.t1o70q0xvsesg3@smtp.1und1.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_337_14897013.1194966746562"
References: <op.t1o70q0xvsesg3@smtp.1und1.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_337_14897013.1194966746562
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Hardy:

I'm certainly not an expert on ranking and scoring, but I've got to assume
that this approach influences scoring.

Another issue is how you indexed multiple values. If you took a hint from
the SynonymAnalyzer example in Lucene In Action, and indexed all the
substrings with an increment of 0, you're probably OK with phrase and
span queries. Consider indexing the following "anne gables". You'd
index a, an, ann and anne followed by g, ga, gab, gabl, gable, gables.
If the increments for the variants of anne were the default of 1, searching
for the phrase "anne gables"~2 would fail because anne is really 5 or so
terms away from gables. You can fix this by insuring that the gap
is 0 for the variants, but you need to be aware of this.

What about false hits? I don't know enough about your problem
space to know whether matching on "ann AND gab" in the
above example would be acceptable (note: no wild cards,
so the user might be left scratching her head wondering why
she got a match).

There are several approaches. There is a thread titled "I just don't
understand wildcards at all" that has a bunch of information about
wildcards, and searching the archive for "wildcards" will turn up a
wealth of information.

But here are a couple of approaches:
1> use filters. This has worked quite well for me where I construct
the filter by WildCardTermEnum. If you have potential to re-use
these you can always use CachingWrapperFilter (?) to keep
them around.

1a> you could pre-compute, say, 1 filter for each of the
one-letter possibilities (e.g. a filter for a*, one for b*, etc)
and use the filters for the pathological case of one leading
character and wildcard queries for the 2 or more leading
character wildcard queries. Assuming this performance
was acceptable for the two-leading character case.

2> ask your users whether there's really much value in getting
so many hits. That is, if you can restrict the leading number
of characters to, say, two (e.g. ab*), wildcarding might
work acceptably out of the box. I think a legitimate question
is "is 10,000 matching terms a useful thing to allow?" Of course
the immediate response is "yes", but challenging the person
to with producing an actual use case often results in the
realization that catching the "too many clauses" error and
responding with a message of "your search is too broad to
be useful" is reasonable.

Best
Erick

On Nov 12, 2007 4:44 PM, Hardy Ferentschik <hardy@ferentschik.de> wrote:

> Hi,
>
> I have a question regarding the way I got around the 'TooManyClauses'
> exception when using wild card queries
> (
> http://wiki.apache.org/lucene-java/LuceneFAQ#head-06fafb5d19e786a50fb3dfb=
8821a6af9f37aa831
> ).
>
>
> I am using Lucene in conjunction with Hibernate Search
> (http://www.hibernate.org/410.html). I am indexing 'Compmany' objects
> which contain multiple attibutes and the application supports different
> types of searches.
>
> One type of search is a right hand truncated (wildcard query) search of
> the company name. If eg the user searches for 'M' I constructed initially
> a 'M*' query. I have about 250.000 companies in the index. Without any
> modifications I get the 'TooManyClauses' exception and I initially kept
> increasing the 'maxClauseCount'. It works, but performace was terrible. I
> haven't tried working with a filter, but instead decided to try a
> different approach. I index all possible substrings of a string , eg 'Foo=
'
> would be indexed as 'F', 'Fo' and 'Foo'.
>
> I got rid of the 'TooManyClauses' exception and performace improved by
> magnitude, but I would like to get some feedback from other users whether
> this is a good approach or not.
>
> Of course the index size increased, but that was no issue in this case.
> Are there any potential problems with ranking/scoring?
>
> Thanks for any feedback.
>
> --Hardy
>
>
> --
> Hartmut Ferentschik
> Ekholmsv.339 ,1, 127 45 Sk=E4rholmen, Sweden
> Phone: +46 855 923 676 (h); +46 704 225 097 (m)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_337_14897013.1194966746562--

From java-user-return-31012-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 15:16:42 2007
Return-Path: <java-user-return-31012-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98593 invoked from network); 13 Nov 2007 15:16:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 15:16:41 -0000
Received: (qmail 19277 invoked by uid 500); 13 Nov 2007 15:16:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19247 invoked by uid 500); 13 Nov 2007 15:16:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19236 invoked by uid 99); 13 Nov 2007 15:16:22 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 07:16:22 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [193.137.179.196] (HELO equipa.di.uevora.pt) (193.137.179.196)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 15:17:14 +0000
Received: from [10.10.10.194] (sslwrap@localhost [127.0.0.1])
	by equipa.di.uevora.pt (8.13.5/8.13.5/Debian-3) with ESMTP id lADFG0pX015946
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 15:16:00 GMT
Subject: Re: Lucene  search question
From: =?ISO-8859-1?Q?Cl=E1udio?= Fernandes <cff@di.uevora.pt>
To: java-user@lucene.apache.org
In-Reply-To: <75900C13-71C1-4AF1-8DE4-0CA914AA7C65@apache.org>
References: <1194956503.6185.13.camel@localhost.localdomain>
	 <75900C13-71C1-4AF1-8DE4-0CA914AA7C65@apache.org>
Content-Type: text/plain; charset=ISO-8859-15
Organization: Universidade =?ISO-8859-1?Q?=C9vora?=
Date: Tue, 13 Nov 2007 15:16:26 +0000
Message-Id: <1194966986.6185.26.camel@localhost.localdomain>
Mime-Version: 1.0
X-Mailer: Evolution 2.12.0 
Content-Transfer-Encoding: 8bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

On Tue, 2007-11-13 at 07:32 -0500, Grant Ingersoll wrote:
> Yes, your application can do this using Lucene.  Lucene is a low level  
> search enabling library, it is up to your application to give meaning  
> to what you put in it.
> 
> One way doing what you want is to give each section its own Field for  
> any given document.

Ok, thanks poeple for the quick responses. 
I will try that.

Cheers,

> Cheers,
> Grant
> On Nov 13, 2007, at 7:21 AM, Cludio Fernandes wrote:
> 
> > Hello all,
> >
> > I don't know if this is a somehow naive question, but here we go:
> >
> > Does Lucene support index by sections? Like having a text document  
> > with
> > three sections divided by XML tags indexed in a way we could do a  
> > search
> > by work and section. Does Lucene itself support this kind of  
> > indexing or
> > should it be used with other engines like Cocoon?
> >
> > Thanks in advance for your time,
> >
> >
> > -- 
> > Cludio Fernandes
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
-- 
Cludio Fernandes


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31013-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 15:25:22 2007
Return-Path: <java-user-return-31013-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1443 invoked from network); 13 Nov 2007 15:25:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 15:25:22 -0000
Received: (qmail 40450 invoked by uid 500); 13 Nov 2007 15:25:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40423 invoked by uid 500); 13 Nov 2007 15:25:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40412 invoked by uid 99); 13 Nov 2007 15:25:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 07:25:03 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.187 as permitted sender)
Received: from [209.85.134.187] (HELO mu-out-0910.google.com) (209.85.134.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 15:25:06 +0000
Received: by mu-out-0910.google.com with SMTP id i10so1823655mue
        for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 07:24:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=AH3y2pw60gR6fuzvhBjdC1bHi5UIHv4515petFjNR2I=;
        b=oIviix5xPX5MVsBstvLwjkaHYzyDa7ins7FoghWSYbskS0tijzejmtd/qYAfy16ELajMD6XPEdgs7HLWoEusnwtUToeyZFXd2G/9MvfI9H6tq6+PJhZNfV6i8Nc0DkgoiOYdpqHFwshuu+CN7/wDwgSSdaS3aoRlJyDXA+AvaVI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=LlDrcjFWSj0NTirBgEKg5qAC4Cci06lALuiJsHN5pgsG/exF+MVG+M0kS2l+qhkhhrl6VbL+SeS1HfOVXDS9jKoZ/UBONYZHvF8k8nLy5VNfu6xeNQqzHDRpstHJkJKjNHWm6gLH7WemKFM+bWt5lB2Jw+6wMGtL7wHb6873aeo=
Received: by 10.86.70.8 with SMTP id s8mr5888691fga.1194967476004;
        Tue, 13 Nov 2007 07:24:36 -0800 (PST)
Received: by 10.86.89.14 with HTTP; Tue, 13 Nov 2007 07:24:35 -0800 (PST)
Message-ID: <359a92830711130724j628bd4c4ubd55dd11c41c3fcf@mail.gmail.com>
Date: Tue, 13 Nov 2007 10:24:35 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene search question
In-Reply-To: <1194966986.6185.26.camel@localhost.localdomain>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_371_24465365.1194967475984"
References: <1194956503.6185.13.camel@localhost.localdomain>
	 <75900C13-71C1-4AF1-8DE4-0CA914AA7C65@apache.org>
	 <1194966986.6185.26.camel@localhost.localdomain>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_371_24465365.1194967475984
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

If you only have a maximum of a few sections, then indexing
as different fields should work fine. If you have a big upper limit
you might need to do something like index all the data in one field
with a special marker (e.g. $$$$$$$) between sections, then use
termdocs/termenum on the result set to figure out whether
the matches were in the desired section.

Best
Erick

On Nov 13, 2007 10:16 AM, Cl=E1udio Fernandes <cff@di.uevora.pt> wrote:

> Hi,
>
> On Tue, 2007-11-13 at 07:32 -0500, Grant Ingersoll wrote:
> > Yes, your application can do this using Lucene.  Lucene is a low level
> > search enabling library, it is up to your application to give meaning
> > to what you put in it.
> >
> > One way doing what you want is to give each section its own Field for
> > any given document.
>
> Ok, thanks poeple for the quick responses.
> I will try that.
>
> Cheers,
>
> > Cheers,
> > Grant
> > On Nov 13, 2007, at 7:21 AM, Cl=E1udio Fernandes wrote:
> >
> > > Hello all,
> > >
> > > I don't know if this is a somehow naive question, but here we go:
> > >
> > > Does Lucene support index by sections? Like having a text document
> > > with
> > > three sections divided by XML tags indexed in a way we could do a
> > > search
> > > by work and section. Does Lucene itself support this kind of
> > > indexing or
> > > should it be used with other engines like Cocoon?
> > >
> > > Thanks in advance for your time,
> > >
> > >
> > > --
> > > Cl=E1udio Fernandes
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> --
> Cl=E1udio Fernandes
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_371_24465365.1194967475984--

From java-user-return-31014-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 15:27:30 2007
Return-Path: <java-user-return-31014-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3126 invoked from network); 13 Nov 2007 15:27:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 15:27:29 -0000
Received: (qmail 48692 invoked by uid 500); 13 Nov 2007 15:27:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48540 invoked by uid 500); 13 Nov 2007 15:27:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48526 invoked by uid 99); 13 Nov 2007 15:27:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 07:27:11 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 15:27:15 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id AC18C71C21F; Tue, 13 Nov 2007 07:26:54 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 9DF6671C1F1
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 07:26:54 -0800 (PST)
Date: Tue, 13 Nov 2007 07:26:54 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: Lucene Users <java-user@lucene.apache.org>
Subject: Re: OutOfMemoryError on small search in large, simple index
In-Reply-To: <200711131613.07641@danielnaber.de>
Message-ID: <Pine.LNX.4.62.0711130722400.6553@radix.cryptio.net>
References: <1194964649.13896.1180.camel@pc977> <200711131613.07641@danielnaber.de>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: > Can it be right that memory usage depends on size of the index rather
: > than size of the result?
: 
: Yes, see IndexWriter.setTermIndexInterval(). How much RAM are you giving to 
: the JVM now?

and in general: yes.  Lucene is using memory so that *lots* of searches 
can be fast ... if you reuse the searcher object for multiple searches, 
they will all reuse those same internal memory structures.


there's also the specific issue of norms ... did you OMIT_NORMS when you 
indexed your data? do you need norms for this field? (if you aren't sure, 
take a look at the scoring docs)

http://lucene.apache.org/java/docs/scoring.html



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31015-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 17:00:12 2007
Return-Path: <java-user-return-31015-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44324 invoked from network); 13 Nov 2007 17:00:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 17:00:12 -0000
Received: (qmail 16319 invoked by uid 500); 13 Nov 2007 16:59:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16293 invoked by uid 500); 13 Nov 2007 16:59:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16282 invoked by uid 99); 13 Nov 2007 16:59:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 08:59:53 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [128.143.2.178] (HELO fork8.mail.virginia.edu) (128.143.2.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 16:59:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by fork8.mail.virginia.edu (Postfix) with ESMTP id C8B221F519A
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 11:59:35 -0500 (EST)
Received: from fork8.mail.virginia.edu ([127.0.0.1])
 by localhost (fork8.mail.virginia.edu [127.0.0.1]) (amavisd-new, port 10024)
 with ESMTP id 03550-02 for <java-user@lucene.apache.org>;
 Tue, 13 Nov 2007 11:59:35 -0500 (EST)
Received: from [128.143.197.28] (d-128-197-28.bootp.Virginia.EDU [128.143.197.28])
	by fork8.mail.virginia.edu (Postfix) with ESMTP id A6E6E1F5196
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 11:59:35 -0500 (EST)
Mime-Version: 1.0 (Apple Message framework v752.2)
In-Reply-To: <1194956503.6185.13.camel@localhost.localdomain>
References: <1194956503.6185.13.camel@localhost.localdomain>
Content-Type: text/plain; charset=ISO-8859-1; delsp=yes; format=flowed
Message-Id: <8D65FDA6-BBBF-4ED6-A3D3-ADF78518C274@virginia.edu>
Content-Transfer-Encoding: quoted-printable
From: "Steven D. Majewski" <sdm7g@virginia.edu>
Subject: Re: Lucene  search question
Date: Tue, 13 Nov 2007 11:59:34 -0500
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.752.2)
X-UVA-Virus-Scanned: by amavisd-new at fork8.mail.virginia.edu
X-Virus-Checked: Checked by ClamAV on apache.org


On Nov 13, 2007, at 7:21 AM, Cl=E1udio Fernandes wrote:

> Hello all,
>
> I don't know if this is a somehow naive question, but here we go:
>
> Does Lucene support index by sections? Like having a text document =20
> with
> three sections divided by XML tags indexed in a way we could do a =20
> search
> by work and section. Does Lucene itself support this kind of =20
> indexing or
> should it be used with other engines like Cocoon?
>
> Thanks in advance for your time,
>

Depends on what you mean by sections.
If your document divides up simply into fixed fields:
      <title>...</title>, <author>...</author> , <body>...</body>
or:  <part1>...</part1>, <part2>...</part2>, <part3>...</part3>
then you can make those into fields of your lucene index.

But if there aren't a fixed number of sections, then fields probably =20
won't
work. Lucene doesn't itself handle nesting or inclusion, so finding
text within some arbitrary div or finding the div holding the text
is not so straightforward. However, lucene has a flexible notion
of what a 'document' is. ( Basically, it's whatever unit you feed
it as a document. ) So if this is what you need, you might be able
to make each <div> into a "document" rather than each file.

  If you were indexing a large TEI text and wanted to return a =20
particular
chapter where the text was found, you could make each chapter a =20
'document',
and each document would have indexed fields to store the common header
info as well as the file name containing the chapter.

  Lucene is great at finding documents, but not quite as good at finding
things IN documents. The index contains pointers to the terms, but =20
they are
pointers to a token in the parsed token stream, so to find a =20
character index
into a file, you have to (I believe) run the text thru the tokenizer =20
again.
( But lucene API gives you access to everything, even if it's not =20
simple or easy.
   I think there are some new features in the latest version that can =20=

make this
   sort of thing easier, but I haven't yet figured out how to use =20
them. )


-- Steve Majewski=20

( Not much of a lucene expert, but I've spent some time figuring out =20
the difference
   between document indexers like lucene and text indexers like xpat/=20
opentext.  )







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31016-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 17:10:46 2007
Return-Path: <java-user-return-31016-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50189 invoked from network); 13 Nov 2007 17:10:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 17:10:46 -0000
Received: (qmail 32843 invoked by uid 500); 13 Nov 2007 17:10:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32677 invoked by uid 500); 13 Nov 2007 17:10:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32666 invoked by uid 99); 13 Nov 2007 17:10:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 09:10:27 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.177] (HELO spunkymail-a6.g.dreamhost.com) (208.97.132.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 17:11:19 +0000
Received: from [172.16.18.240] (unknown [12.6.150.3])
	by spunkymail-a6.g.dreamhost.com (Postfix) with ESMTP id 31EB2109F47
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 09:10:09 -0800 (PST)
Message-Id: <4CB229CB-8312-490C-81E7-9A42512F4506@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <8D65FDA6-BBBF-4ED6-A3D3-ADF78518C274@virginia.edu>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Lucene  search question
Date: Tue, 13 Nov 2007 12:10:05 -0500
References: <1194956503.6185.13.camel@localhost.localdomain> <8D65FDA6-BBBF-4ED6-A3D3-ADF78518C274@virginia.edu>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org


On Nov 13, 2007, at 11:59 AM, Steven D. Majewski wrote:
>
> Lucene is great at finding documents, but not quite as good at finding
> things IN documents. The index contains pointers to the terms, but  
> they are
> pointers to a token in the parsed token stream, so to find a  
> character index
> into a file, you have to (I believe) run the text thru the tokenizer  
> again.
> ( But lucene API gives you access to everything, even if it's not  
> simple or easy.
>  I think there are some new features in the latest version that can  
> make this
>  sort of thing easier, but I haven't yet figured out how to use  
> them. )
>

You can use Term Vectors to access the offset (and position)  
information for a document.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31017-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 18:53:56 2007
Return-Path: <java-user-return-31017-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96932 invoked from network); 13 Nov 2007 18:53:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 18:53:56 -0000
Received: (qmail 66981 invoked by uid 500); 13 Nov 2007 18:53:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66951 invoked by uid 500); 13 Nov 2007 18:53:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66937 invoked by uid 99); 13 Nov 2007 18:53:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 10:53:37 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of vivextra@gmail.com designates 72.14.204.239 as permitted sender)
Received: from [72.14.204.239] (HELO qb-out-0506.google.com) (72.14.204.239)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 18:53:41 +0000
Received: by qb-out-0506.google.com with SMTP id e12so2351764qba
        for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 10:53:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=HhA72xlXkUI05uNkVDFUquUSEeaBo8w9ThVcDLg0hKk=;
        b=LHToYfeTFI+Cf7Vuu7Zb24TwAe9C36KiIH/3tdirw7dsngY6VhS+pgIGP2C8je7wgcQSCcmJVq5P46YrdO29mp8LdJnJ8uit4RxXzHRa/Z1PHpxi12MM6S53IoC+6hHk3eEGX6MPwzof5QpUmK64m49PJw74X6Mpgp/zkiNhIRY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=aSS0UsetQpMqSGXwabpi16LiODoN76tVzMo1oVctoFPkmzz54T8jz2wVvxZVnbW60+gRIMru41aOKIRMzPYx3L44QobG7REFj/UogQ5TYrAIC/brS/VA5CwZDui1MYG1epe1pdnmaZky1MTsWpQXSptjmlYvrdoxRkBXKzmrNaw=
Received: by 10.142.80.7 with SMTP id d7mr1134587wfb.1194979999493;
        Tue, 13 Nov 2007 10:53:19 -0800 (PST)
Received: by 10.142.161.16 with HTTP; Tue, 13 Nov 2007 10:53:19 -0800 (PST)
Message-ID: <a206fb7e0711131053r298b3e5dtee957bde5a169102@mail.gmail.com>
Date: Tue, 13 Nov 2007 10:53:19 -0800
From: "vivek sar" <vivextra@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: restoring a corrupt index?
In-Reply-To: <47377DF1.8050301@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <47361C43.6030506@gmail.com>
	 <1194730460.31785.1220622099@webmail.messagingengine.com>
	 <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
	 <1194732079.3067.1220624239@webmail.messagingengine.com>
	 <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
	 <1194734434.8784.1220626841@webmail.messagingengine.com>
	 <4737405F.1040608@gmail.com>
	 <c68e39170711111032i5365698fjb1a85f501283f30c@mail.gmail.com>
	 <1194807588.7808.1220709497@webmail.messagingengine.com>
	 <47377DF1.8050301@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

We have seen similar exceptions (with Lucene 2.2) when were doing the
following mistakes,

1) Not closing the old searchers and re-creating a new one for every
new search (fixed it by closing the searcher every time, if you want
you could only one searcher instance as well)
2) Not having any jvm shutdown hook (in cases the JVM gets killled we
need to make sure the indexer is closed if it's in the middle of
indexing) - of course you would still need to avoid forceful killing
(kill -9).


Since, these two fixes we haven't seen this problem happening. I think
if the indexer is abruptly stopped while it's in progress the index
corruption can happen.

-vivek

On Nov 11, 2007 2:10 PM, Ryan McKinley <ryantxu@gmail.com> wrote:
>
> >
> > Ryan can you post the output of CheckIndex on your now-working index?
> > (1800 is still too many files I think, certainly after having
> > optimized).
> >
>
> ok, 1800 was wrong - that was from a botched attempt where I:
> 1. ran optimize on the broken 18K file index.  It crashed midway through.
> 2. run CheckIndex -fix on that
>
> When I:
> 1. run CheckIndex -fix
> 2. run Optimize
> it results in an index with 65 files (that seems normal)
>
>
> > Also, what steps finally allowed you to recover?  CheckIndex
> > (back-ported to 2.2) followed by optimize?
> >
>
> I did not back-port to 2.2, this converted 2.2 index to 2.3, and i
> shoved 2.3 libs into an exploded solr.war.  (just to see if it works)
> It works, but I'm better off going back to an older working version.
>
>
> >
> > I'm still baffled how Lucene 2.2 could ever produce a corrupt index
> > even on hitting descriptor limits or other exceptions.  I can see that
> > this could cause files to not be deleted properly, but, I can't see
> > how it can corrupt the index.
> >
>
> I'm not confident it is lucene's fault - the hardware has been flaky
> too.  But the 18K files and 'too many open files' error makes me
> suspicious.  Unfortunately, I can't quite grock when stuff started going
> wrong and how long it has been going on from my log files.
>
>
> > Ryan can you share any details of how you (Solr) is using Lucene?  Are
> > you using autoCommit=false?  I'd really love to get to the root cause
> > here.
> >
>
> I am using all standard solr config (copied from the example).  I am
> using solr's <autoCommit> to "commit" added documents every 30 secs.
>
>
> ryan
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31018-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 13 19:03:23 2007
Return-Path: <java-user-return-31018-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99336 invoked from network); 13 Nov 2007 19:03:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 13 Nov 2007 19:03:23 -0000
Received: (qmail 82433 invoked by uid 500); 13 Nov 2007 19:03:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82404 invoked by uid 500); 13 Nov 2007 19:03:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82393 invoked by uid 99); 13 Nov 2007 19:03:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 11:03:05 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.26] (HELO out2.smtp.messagingengine.com) (66.111.4.26)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 19:03:09 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 5B558472E0
	for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 14:02:48 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Tue, 13 Nov 2007 14:02:48 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 3E18E47F52; Tue, 13 Nov 2007 14:02:48 -0500 (EST)
Message-Id: <1194980568.23058.1221107573@webmail.messagingengine.com>
X-Sasl-Enc: 9yRI1EU+POkSPnOTSPQJt0+gRRj4uTJEZ8pK0uh4SGuD 1194980568
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <47361C43.6030506@gmail.com>
   <1194730460.31785.1220622099@webmail.messagingengine.com>
   <c68e39170711101345h35b68a62rc1e022d202bff34c@mail.gmail.com>
   <1194732079.3067.1220624239@webmail.messagingengine.com>
   <c68e39170711101422x66b32ae3n61785b13d3cce35e@mail.gmail.com>
   <1194734434.8784.1220626841@webmail.messagingengine.com>
   <4737405F.1040608@gmail.com>
   <c68e39170711111032i5365698fjb1a85f501283f30c@mail.gmail.com>
   <1194807588.7808.1220709497@webmail.messagingengine.com>
   <47377DF1.8050301@gmail.com>
   <a206fb7e0711131053r298b3e5dtee957bde5a169102@mail.gmail.com>
Subject: Re: restoring a corrupt index?
In-Reply-To: <a206fb7e0711131053r298b3e5dtee957bde5a169102@mail.gmail.com>
Date: Tue, 13 Nov 2007 14:02:48 -0500
X-Virus-Checked: Checked by ClamAV on apache.org

"vivek sar" <vivextra@gmail.com> wrote:

> I think if the indexer is abruptly stopped while it's in progress
> the index corruption can happen.

One correction here: as far as I know, the index should not become
corrupt if the JVM is kill -9'd or JVM crashes.  If that seems to be
happening then we need to dig down to the root cause and fix it...

However, if the OS or machine crashes, or power is pulled from the
machine, it is possible for the index to become corrupt.  But for the
next version of Lucene (2.3) we are making changes to try to
ensure consistency even for these cases as well.  See here for details:

    https://issues.apache.org/jira/browse/LUCENE-1044

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31019-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 06:11:46 2007
Return-Path: <java-user-return-31019-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1382 invoked from network); 14 Nov 2007 06:11:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 06:11:45 -0000
Received: (qmail 46154 invoked by uid 500); 14 Nov 2007 06:11:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46125 invoked by uid 500); 14 Nov 2007 06:11:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46112 invoked by uid 99); 14 Nov 2007 06:11:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 22:11:27 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 06:12:20 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IsBSv-0008U6-1x
	for java-user@lucene.apache.org; Tue, 13 Nov 2007 22:11:09 -0800
Message-ID: <13740560.post@talk.nabble.com>
Date: Tue, 13 Nov 2007 22:11:09 -0800 (PST)
From: testn <test1@doramail.com>
To: java-user@lucene.apache.org
Subject: How's 2.3 doing?
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: test1@doramail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

Are we closed to release Lucene 2.3? Is it stable enough to production? I
thought it's supposed to be released in October.

Thanks,
-- 
View this message in context: http://www.nabble.com/How%27s-2.3-doing--tf4802426.html#a13740560
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31020-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 06:17:32 2007
Return-Path: <java-user-return-31020-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 2151 invoked from network); 14 Nov 2007 06:17:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 06:17:29 -0000
Received: (qmail 48386 invoked by uid 500); 14 Nov 2007 06:17:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48356 invoked by uid 500); 14 Nov 2007 06:17:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48345 invoked by uid 99); 14 Nov 2007 06:17:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Nov 2007 22:17:11 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 64.233.184.235 as permitted sender)
Received: from [64.233.184.235] (HELO wr-out-0506.google.com) (64.233.184.235)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 06:17:14 +0000
Received: by wr-out-0506.google.com with SMTP id c46so65759wra
        for <java-user@lucene.apache.org>; Tue, 13 Nov 2007 22:16:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=QvFlP8uNw0N+JCb9TGqD7GZ7O4CBFjDnI04LqH/6mbw=;
        b=c+eDp3YZ8rIWvGYc52zqFoNtA9MLhI8ZT3sD3mMU+jx+/0JMRzP7m1tn2qUGxweYHqYz82u1ACS1IQ5uoI5W2vElVwlrPnGFI+zR1C+5hu2obiVzmn9LRMwQjguPWGy8wLaO5VBpYbYahKZl5eknNRT0ljFw5WD6IpnZ+HQsZZA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=DXl/W4euLwLn8qjr0P627xo4gFzDKUCmwrsAaITNEfuWf0bekAji/Kdxs8Y7IyLQ9SbKECuGHyF3oWo6EpELuycASjfAS9WliLEP+NolCAobFQvqg7b84Qj+H56QhJGPitd28/eBqTWBtmYwNLKYvNrlXwXiups6kaUww/WptJY=
Received: by 10.90.81.8 with SMTP id e8mr1100235agb.1195021013234;
        Tue, 13 Nov 2007 22:16:53 -0800 (PST)
Received: from ?10.59.1.48? ( [72.242.61.130])
        by mx.google.com with ESMTPS id 43sm319728wri.2007.11.13.22.16.51
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Tue, 13 Nov 2007 22:16:52 -0800 (PST)
Message-ID: <473A927E.80305@gmail.com>
Date: Tue, 13 Nov 2007 22:15:26 -0800
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: How's 2.3 doing?
References: <13740560.post@talk.nabble.com>
In-Reply-To: <13740560.post@talk.nabble.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

testn wrote:
> Hi,
> 
> Are we closed to release Lucene 2.3? Is it stable enough to production? I
> thought it's supposed to be released in October.
> 
> Thanks,

I think it's very close. There are a couple of outstanding issues:
http://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=true&mode=hide&sorter/order=DESC&sorter/field=priority&resolution=-1&pid=12310110&fixfor=12312531

We're working hard to get those resolved and 2.3 out of the door very soon.

-Michael

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31021-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 10:26:16 2007
Return-Path: <java-user-return-31021-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14289 invoked from network); 14 Nov 2007 10:26:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 10:26:16 -0000
Received: (qmail 85007 invoked by uid 500); 14 Nov 2007 10:25:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84985 invoked by uid 500); 14 Nov 2007 10:25:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84974 invoked by uid 99); 14 Nov 2007 10:25:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 02:25:57 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [85.158.139.51] (HELO mail180.messagelabs.com) (85.158.139.51)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 14 Nov 2007 10:26:00 +0000
X-VirusChecked: Checked
X-Env-Sender: ulrich.vachon@vidal.fr
X-Msg-Ref: server-4.tower-180.messagelabs.com!1195035937!13136913!1
X-StarScan-Version: 5.5.12.14.2; banners=-,-,-
X-Originating-IP: [212.234.178.68]
Received: (qmail 17400 invoked from network); 14 Nov 2007 10:25:38 -0000
Received: from antares.mmsupport.com (HELO localhost.localdomain) (212.234.178.68)
  by server-4.tower-180.messagelabs.com with SMTP; 14 Nov 2007 10:25:38 -0000
Received: from srv-exch01.france.groupe.intra (srv-exch01.france.groupe.intra [172.16.50.5])
	by localhost.localdomain (Postfix) with ESMTP id C39E713FA5E
	for <java-user@lucene.apache.org>; Wed, 14 Nov 2007 11:25:37 +0100 (CET)
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/mixed;
	boundary="----_=_NextPart_001_01C826A8.B2CD2199"
Subject: RE : How's 2.3 doing?
Date: Wed, 14 Nov 2007 11:24:36 +0100
Message-ID: <476E2FDEECC8D84C8875B4252C94822229C608@srv-exch01.france.groupe.intra>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: <476E2FDEECC8D84C8875B4252C94822229C608@srv-exch01.france.groupe.intra>
Thread-Topic: RE : How's 2.3 doing?
Thread-Index: Acgmhgh2OPr133c/QPi9vIilNPP6nAAIoX0G
References: <13740560.post@talk.nabble.com> <473A927E.80305@gmail.com>
From: "Ulrich Vachon" <ulrich.vachon@vidal.fr>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C826A8.B2CD2199
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Thanks, good work!

-------- Message d'origine--------
De: Michael Busch [mailto:buschmic@gmail.com]
Date: mer. 14/11/2007 07:15
=C0: java-user@lucene.apache.org
Objet : Re: How's 2.3 doing?
=20
testn wrote:
> Hi,
>=20
> Are we closed to release Lucene 2.3? Is it stable enough to =
production? I
> thought it's supposed to be released in October.
>=20
> Thanks,

I think it's very close. There are a couple of outstanding issues:
http://issues.apache.org/jira/secure/IssueNavigator.jspa?reset=3Dtrue&mod=
e=3Dhide&sorter/order=3DDESC&sorter/field=3Dpriority&resolution=3D-1&pid=3D=
12310110&fixfor=3D12312531

We're working hard to get those resolved and 2.3 out of the door very =
soon.

-Michael

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


______________________________________________________________________
This email has been scanned by the MessageLabs Email Security System.
For more information please visit http://www.messagelabs.com/email=20
______________________________________________________________________



------_=_NextPart_001_01C826A8.B2CD2199
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
------_=_NextPart_001_01C826A8.B2CD2199--

From java-user-return-31022-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 10:30:36 2007
Return-Path: <java-user-return-31022-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17253 invoked from network); 14 Nov 2007 10:30:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 10:30:36 -0000
Received: (qmail 94558 invoked by uid 500); 14 Nov 2007 10:30:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94528 invoked by uid 500); 14 Nov 2007 10:30:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94517 invoked by uid 99); 14 Nov 2007 10:30:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 02:30:17 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [89.213.91.233] (HELO mail.ardentiasearch.com) (89.213.91.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 10:31:11 +0000
Received: from biscuit.ARDENTIASEARCH.local ([10.0.0.9]) by
 biscuit.ARDENTIASEARCH.local ([10.0.0.9]) with mapi; Wed, 14 Nov 2007
 10:27:51 +0000
From: Mike Streeton <mike.streeton@ardentiasearch.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Wed, 14 Nov 2007 10:29:50 +0000
Subject: RE: TermDocs.skipTo error
Thread-Topic: TermDocs.skipTo error
Thread-Index: Acgj7ANdgBBBvTjbRVu2F1gxPUUT3wBIjKBwAGZtWuA=
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5229@biscuit.ARDENTIASEARCH.local>
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
	 <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5182@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5183@biscuit.ARDENTIASEARCH.local>
 <c68e39170711101449p1c52da76j1b451eeff9cecc26@mail.gmail.com>
 <DFE6314F5CE91344A74BD2AA612C93B6142B7F51A1@biscuit.ARDENTIASEARCH.local>
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6142B7F51A1@biscuit.ARDENTIASEARCH.local>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

I have now managed to quantify the error, it only affects Lucene 2.2 build =
indexes and occurs after a period of time reusing a TermDocs object, I have=
 modified my test app top be a little more verbose about the conditions it =
fails under. Hopefully someone can track the bug down in Lucene. I have run=
 the test again after it fails changing the loop iterators so it repeats th=
e failing iteratation first and it works okay.

Many Thanks

Mike



import java.io.File;
import java.io.IOException;
import java.util.Random;

import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.document.Field.Index;
import org.apache.lucene.document.Field.Store;
import org.apache.lucene.index.CorruptIndexException;
import org.apache.lucene.index.IndexReader;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.index.MultiReader;
import org.apache.lucene.index.Term;
import org.apache.lucene.index.TermDocs;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.store.LockObtainFailedException;

public class Test4 {

        /**
         * @param args
         * @throws IOException
         * @throws LockObtainFailedException
         * @throws CorruptIndexException
         */
        public static void main(String[] args) throws Exception {
                Random rand =3D new Random(0);
                FSDirectory[] dirs =3D new FSDirectory[10];
                boolean build =3D false;
                for (int i =3D 0; i < dirs.length; i++) {
                        dirs[i] =3D FSDirectory.getDirectory("c:" + File.se=
parator + "temp"
                                        + File.separator + "lucenetest" + F=
ile.separator
                                        + Integer.toString(i));
                        if (!IndexReader.indexExists(dirs[i])) {
                                if (!build) {
                                        System.out.println("Building Test I=
ndex Start");
                                }
                                build =3D true;
                                System.out.println("Building Index: " + dir=
s[i].getFile()
                                                + " Start");
                                IndexWriter writer =3D new IndexWriter(dirs=
[i],
                                                new StandardAnalyzer(), tru=
e);
                                for (int j =3D 0; j < 100000; j++) {
                                        Document doc =3D new Document();
                                        doc.add(new Field("i", Integer.toSt=
ring(rand.nextInt(100)),
                                                        Store.YES, Index.UN=
_TOKENIZED));
                                        doc.add(new Field("j",
                                                        Integer.toString(ra=
nd.nextInt(1000)), Store.YES,
                                                        Index.UN_TOKENIZED)=
);
                                        writer.addDocument(doc);
                                }
                                writer.optimize();
                                writer.close();
                                writer =3D null;
                                System.out.println("Building Index: " + dir=
s[i].getFile()
                                                + " Complete");
                        }
                        IndexReader reader =3D IndexReader.open(dirs[i]);
                        for (int j =3D 0; j < 1000; j++) {
                                reader.deleteDocument(rand.nextInt(reader.m=
axDoc()));
                        }
                        reader.close();
                }
                if (build) {
                        System.out.println("Building Test Index Complete");
                }
                System.out.println("Test Start");
                IndexReader[] readers =3D new IndexReader[dirs.length];
                for (int i =3D 0; i < dirs.length; i++) {
                        readers[i] =3D IndexReader.open(dirs[i]);
                }
                IndexReader reader =3D new MultiReader(readers);
                TermDocs docs =3D reader.termDocs();
                for (int i =3D 0; i < 100; i++) {
                        for (int j =3D 0; j < 1000; j++) {
                                try {
                                        test(reader, docs, Integer.toString=
(i), Integer.toString(j));
                                } catch (Exception e) {
                                        System.err.println("maxdoc=3D" + re=
ader.maxDoc());
                                        System.err.println("Test Failed at =
i=3D" + i + " j=3D" + j);
                                        throw e;
                                }
                        }
                }
                docs.close();
                reader.close();
                System.out.println("Test Complete");
        }

        private static void test(IndexReader reader, TermDocs docs, String =
i,
                        String j) throws Exception {
                docs.seek(new Term("i", i));
                while (docs.next())
                        ;
                docs.seek(new Term("j", j));
                while (docs.next())
                        ;
                docs.seek(new Term("i", i));
                if (docs.next()) {
                        int doc =3D docs.doc();
                        try {
                                while (docs.skipTo(doc + 1000)) {
                                        doc =3D docs.doc();
                                }
                        } catch (Exception e) {
                                System.err.println("doc=3D" + (doc + 1000) =
+ ": deleted=3D"
                                                + reader.isDeleted(doc + 10=
00));
                                throw e;
                        }
                }
                docs.seek(new Term("j", j));
                if (docs.next()) {
                        int doc =3D docs.doc();
                        try {
                                while (docs.skipTo(doc + 1000)) {
                                        doc =3D docs.doc();
                                }
                        } catch (Exception e) {
                                System.err.println("doc=3D" + doc);
                                throw e;
                        }
                }
        }

}

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31023-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 11:51:40 2007
Return-Path: <java-user-return-31023-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39685 invoked from network); 14 Nov 2007 11:51:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 11:51:40 -0000
Received: (qmail 76788 invoked by uid 500); 14 Nov 2007 11:51:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76755 invoked by uid 500); 14 Nov 2007 11:51:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76744 invoked by uid 99); 14 Nov 2007 11:51:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 03:51:22 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.31] (HELO smtp-vbr11.xs4all.nl) (194.109.24.31)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 11:51:25 +0000
Received: from [192.168.89.206] (impressie.xs4all.nl [82.93.53.149])
	by smtp-vbr11.xs4all.nl (8.13.8/8.13.8) with ESMTP id lAEBp32a062721
	for <java-user@lucene.apache.org>; Wed, 14 Nov 2007 12:51:03 +0100 (CET)
	(envelope-from matthijs@impressie.nl)
Message-ID: <473AE12B.8080602@impressie.nl>
Date: Wed, 14 Nov 2007 12:51:07 +0100
From: Matthijs Bierman <matthijs@impressie.nl>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: get original term for synonym
References: <76844.69545.qm@web26006.mail.ukl.yahoo.com>
In-Reply-To: <76844.69545.qm@web26006.mail.ukl.yahoo.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Mark,

Your solution would be correct if the synonym would be a true 2-way
synonym. Unfortunately this is not the case. My analyzer takes care of
decomposition of specific Dutch words (where a "-" is used to create
compound words). For example: 'zone-indeling' would create synonyms for
'zone'-> 'zone-indeling' and 'indeling'->'zone-indeling'.
When analyzing 'zone' it will therefore not point back to
'zone-indeling' (this information is simply not available). Putting all
the results from the indexing process into a file or lucene document
(thus creating a 'lookup' index) would probably make the lookup process
rather slow, or make application startup too long (due to HashMap
generation).

Maybe you can do something with offsets?

Thanks,
Matthijs


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31024-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 13:11:00 2007
Return-Path: <java-user-return-31024-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66731 invoked from network); 14 Nov 2007 13:10:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 13:10:59 -0000
Received: (qmail 91960 invoked by uid 500); 14 Nov 2007 13:10:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91934 invoked by uid 500); 14 Nov 2007 13:10:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91923 invoked by uid 99); 14 Nov 2007 13:10:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 05:10:41 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.85] (HELO web26011.mail.ukl.yahoo.com) (217.12.10.85)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 14 Nov 2007 13:10:44 +0000
Received: (qmail 34625 invoked by uid 60001); 14 Nov 2007 13:10:22 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=SN5yVO9zRmfm2yq0tV/bcW67tNoMf9YXPk/5oJIam66cKg4lf2w7iqaP1Aid+1KZuyDu8zP9Na1jPctSlgQDmNm36dxz09VcaqsbuEAzhXhtPnPit4C4C8ucrJrBFkHvbTJegvm6++GtNm+5CWp0UFE1ON+RhLyWN+ZRuN9bGzA=;
X-YMail-OSG: v82yMxoVM1myMBhTOt5b9NXEF1elCTqINkCCnRMRURdf2iFWXyyBVwqSK8SvESnJcV0MSdKSBhQZIhlk3CfGk6P9X0zyNPVMN_9yBmwJPfWqIpyb
Received: from [193.36.230.96] by web26011.mail.ukl.yahoo.com via HTTP; Wed, 14 Nov 2007 13:10:22 GMT
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.152
Date: Wed, 14 Nov 2007 13:10:22 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: get original term for synonym
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <802248.33094.qm@web26011.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

It would be useful to have more details about the query input and the expec=
ted highlights you want.=0A=0ASo given your 'zone-indeling' example documen=
t and the index-time tokenisation you described, which of the following que=
ries would you expect to match and what would you want highlighted in each =
case?=0A1) zone=0A2) zone-indeling=0A3) "zone indeling"=0A4) zone-something=
Else=0A=0A=0AMy assumption here is that you are using the standard Lucene Q=
uery parser and that query 3 will therefore be a phrase query. =0A=0ACheers=
=0AMark=0A=0A=0A----- Original Message ----=0AFrom: Matthijs Bierman <matth=
ijs@impressie.nl>=0ATo: java-user@lucene.apache.org=0ASent: Wednesday, 14 N=
ovember, 2007 11:51:07 AM=0ASubject: Re: get original term for synonym=0A=
=0AHi Mark,=0A=0AYour solution would be correct if the synonym would be a t=
rue 2-way=0Asynonym. Unfortunately this is not the case. My analyzer takes =
care of=0Adecomposition of specific Dutch words (where a "-" is used to cre=
ate=0Acompound words). For example: 'zone-indeling' would create synonyms f=
or=0A'zone'-> 'zone-indeling' and 'indeling'->'zone-indeling'.=0AWhen analy=
zing 'zone' it will therefore not point back to=0A'zone-indeling' (this inf=
ormation is simply not available). Putting all=0Athe results from the index=
ing process into a file or lucene document=0A(thus creating a 'lookup' inde=
x) would probably make the lookup process=0Arather slow, or make applicatio=
n startup too long (due to HashMap=0Ageneration).=0A=0AMaybe you can do som=
ething with offsets?=0A=0AThanks,=0AMatthijs=0A=0A=0A----------------------=
-----------------------------------------------=0ATo unsubscribe, e-mail: j=
ava-user-unsubscribe@lucene.apache.org=0AFor additional commands, e-mail: j=
ava-user-help@lucene.apache.org=0A=0A=0A=0A=0A=0A=0A      _________________=
__________________________________________=0AYahoo! Answers - Got a questio=
n? Someone out there knows the answer. Try it=0Anow.=0Ahttp://uk.answers.ya=
hoo.com/ 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31025-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 13:27:50 2007
Return-Path: <java-user-return-31025-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71170 invoked from network); 14 Nov 2007 13:27:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 13:27:50 -0000
Received: (qmail 16111 invoked by uid 500); 14 Nov 2007 13:27:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16007 invoked by uid 500); 14 Nov 2007 13:27:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15996 invoked by uid 99); 14 Nov 2007 13:27:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 05:27:31 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 64.233.162.227 as permitted sender)
Received: from [64.233.162.227] (HELO nz-out-0506.google.com) (64.233.162.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 13:27:35 +0000
Received: by nz-out-0506.google.com with SMTP id i28so152087nzi
        for <java-user@lucene.apache.org>; Wed, 14 Nov 2007 05:27:12 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=u1hrR0f67hQ/b69M2UYVUOvJKmEokLJM6is6BtqS70g=;
        b=sCOPBMgJqwLU9YFx6iCsSYNDC5YIYKNptKiz/PJZDTBRj3CdDCch7t/Fn1u5OCC+7DzjVmFy752/xQOfkpgOWqAPh0zzqurvLHdshz+xHZjn24MgOoYoUMmIKtvm838k7gGmB3B7vsLX4xvlEt9H3fkHymBBxeqh+elS/CDaZ5M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=b6gUJbpzdPtl/5LTSYYAXL9LHLRb6A+Zfa7B+y3m9q7ufUEVmOwncppTnX9ihHCTVWGQmCMhzrArv5G2wR/A4BaQTlOGQt8lG/fVKq6vkzC/LJ8bLuEmGNupBwd97xQ3X2+7AvDU9ohpYkCLnhOBuDrhfsbPbOjP33Y/xY7nCrc=
Received: by 10.142.232.20 with SMTP id e20mr1528791wfh.1195046831969;
        Wed, 14 Nov 2007 05:27:11 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Wed, 14 Nov 2007 05:27:11 -0800 (PST)
Message-ID: <c68e39170711140527s3b169274ic2839c31e7799649@mail.gmail.com>
Date: Wed, 14 Nov 2007 08:27:11 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: TermDocs.skipTo error
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5229@biscuit.ARDENTIASEARCH.local>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <DFE6314F5CE91344A74BD2AA612C93B6142B7F5130@biscuit.ARDENTIASEARCH.local>
	 <359a92830711090759v436c53c5nf9e6a4150cba6a8b@mail.gmail.com>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F517C@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5182@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5183@biscuit.ARDENTIASEARCH.local>
	 <c68e39170711101449p1c52da76j1b451eeff9cecc26@mail.gmail.com>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F51A1@biscuit.ARDENTIASEARCH.local>
	 <DFE6314F5CE91344A74BD2AA612C93B6142B7F5229@biscuit.ARDENTIASEARCH.local>
X-Google-Sender-Auth: c5237a5488c33ba3
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 14, 2007 5:29 AM, Mike Streeton <mike.streeton@ardentiasearch.com> wrote:
> I have now managed to quantify the error, it only affects Lucene 2.2 build indexes and occurs after a period of time reusing a TermDocs object, I have modified my test app top be a little more verbose about the conditions it fails under. Hopefully someone can track the bug down in Lucene. I have run the test again after it fails changing the loop iterators so it repeats the failing iteratation first and it works okay.

Thanks Mike, could you open up a JIRA issue for this?

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31026-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 20:07:36 2007
Return-Path: <java-user-return-31026-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56112 invoked from network); 14 Nov 2007 20:07:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 20:07:35 -0000
Received: (qmail 37320 invoked by uid 500); 14 Nov 2007 20:07:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37295 invoked by uid 500); 14 Nov 2007 20:07:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37261 invoked by uid 99); 14 Nov 2007 20:07:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 12:07:10 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.66] (HELO spunkymail-a18.g.dreamhost.com) (208.97.132.66)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 20:06:58 +0000
Received: from [172.16.17.232] (unknown [12.6.150.3])
	by spunkymail-a18.g.dreamhost.com (Postfix) with ESMTP id 9ACDE5B539
	for <java-user@lucene.apache.org>; Wed, 14 Nov 2007 12:06:51 -0800 (PST)
Message-Id: <C8AA45CB-BF98-4CFA-B86E-FE451AD14962@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: GData
Date: Wed, 14 Nov 2007 15:06:49 -0500
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Is there anyone out there using the GData implementation in Lucene?  
(under the contrib module)

If so, please let us know, as we are considering archiving it and not  
including it future releases of Lucene (we won't throw it away), per https://issues.apache.org/jira/browse/LUCENE-1055 
.

Thanks,
Grant Ingersoll

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31027-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 20:24:13 2007
Return-Path: <java-user-return-31027-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61392 invoked from network); 14 Nov 2007 20:24:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 20:24:13 -0000
Received: (qmail 59680 invoked by uid 500); 14 Nov 2007 20:23:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59635 invoked by uid 500); 14 Nov 2007 20:23:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59624 invoked by uid 99); 14 Nov 2007 20:23:55 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 12:23:55 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [216.154.214.159] (HELO botspiritcompany.com) (216.154.214.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 20:24:49 +0000
Received: from www.botspiritcompany.com (botspiritcompany.com [127.0.0.1])
	by botspiritcompany.com (8.13.1/8.13.1) with ESMTP id lAEKNYlb014042;
	Wed, 14 Nov 2007 15:23:34 -0500
From: "bbrown" <bbrown@botspiritcompany.com>
To: java-user@lucene.apache.org
Cc: berlin.brown@gmail.com, bbrown@botspiritcompany.com
Subject: Can't code to index documents
Date: Wed, 14 Nov 2007 15:23:34 -0500
Message-Id: <20071114201958.M45941@www.botspiritcompany.com>
X-Mailer: Open WebMail 2.51 20050228
X-OriginatingIP: 68.208.8.29 (bbrown)
MIME-Version: 1.0
Content-Type: text/plain;
	charset=iso-8859-1
Received-SPF: pass (botspiritcompany.com: domain of bbrown@www.botspiritcompany.com designates 127.0.0.1 as permitted sender) receiver=botspiritcompany.com; client-ip=127.0.0.1; helo=www.botspiritcompany.com; envelope-from=bbrown@www.botspiritcompany.com; x-software=spfmilter 0.97 http://www.acme.com/software/spfmilter/ with libspf2-1.0.0;
X-Virus-Checked: Checked by ClamAV on apache.org

I am using this code which is pretty basic.  And it won't index the documents.
 I run the index code and print the document to make sure that it gets
indexed, but when I looked at the output "gen" and "segments" file, there are
only like 20bytes of data in the files.  I am indexing about 300k of text
data.  I am using scala but I dont think that is an issue as I have used
similar code before.  When I do a search 0 documents for everything.

I am using Lucene 2.2.0 (just downloaded).

Here is the core of my code:

  def indexData(writer:IndexWriter, file: File) {
    val doc = new LucDocument()
	
	// Read the content from the file
	val contentReader = new ContentReader(file.getAbsolutePath)
    val (title, content) = contentReader.readFile()

	// Extract data from the java File class
	val link = new DocumentLink(file.getAbsolutePath, file.getName,
							content, file.getAbsolutePath)
	
	// Index the document and data.
    doc.add(new Field(LUC_KEY_FULL_PATH, link.fullPath, 
					  Field.Store.YES, Field.Index.TOKENIZED))
    doc.add(new Field(LUC_KEY_FILE_NAME, link.filename, 
					  Field.Store.YES, Field.Index.TOKENIZED))
	doc.add(new Field(LUC_KEY_CONTENT, link.content, 
					  Field.Store.YES, Field.Index.TOKENIZED))
    doc.add(new Field(LUC_KEY_IDENTITY, link.id, 
					  Field.Store.YES, Field.Index.UN_TOKENIZED))
    writer.addDocument(doc)
  }


But if you want the full scala source, here it is.  Think of it as pseudo code:

object BotlistIndexDocuments {
   
  val LUC_KEY_FULL_PATH = "full_path"
  val LUC_KEY_FILE_NAME = "file_name"
  val LUC_KEY_CONTENT = "content"
  val LUC_KEY_IDENTITY = "id"
  
    //
  // Read the content file.  The first line should contain
  // a "#title summary" line and the rest of the document
  // will contain the "wiki" document.
  class ContentReader(filename: String) {
    def readFile(): (String, String) = {
      val file = Source.fromFile(filename)
      var counted = file.getLines.counted
      val fileData = new StringBuilder()
      var title = ""
      counted.foreach { (line: String) =>
		if (counted.count == 0) {
	      //title = line.substring(6).trim()
		  title = line
		} else { 
	      fileData.append(line)
		}
      }
      (title, fileData.toString())
    }
  } // End of Class //

  case class DocumentLink(abs_path: String, file: String, data: String,
						  unique_id:String) {
    val fullPath = abs_path
    val filename = file
	val content = data
    val id = unique_id
  }
  def indexData(writer:IndexWriter, file: File) {
    val doc = new LucDocument()
	
	// Read the content from the file
	val contentReader = new ContentReader(file.getAbsolutePath)
    val (title, content) = contentReader.readFile()

	// Extract data from the java File class
	val link = new DocumentLink(file.getAbsolutePath, file.getName,
							content, file.getAbsolutePath)
	
	// Index the document and data.
    doc.add(new Field(LUC_KEY_FULL_PATH, link.fullPath, 
					  Field.Store.YES, Field.Index.TOKENIZED))
    doc.add(new Field(LUC_KEY_FILE_NAME, link.filename, 
					  Field.Store.YES, Field.Index.TOKENIZED))
	doc.add(new Field(LUC_KEY_CONTENT, link.content, 
					  Field.Store.YES, Field.Index.TOKENIZED))
    doc.add(new Field(LUC_KEY_IDENTITY, link.id, 
					  Field.Store.YES, Field.Index.UN_TOKENIZED))
    writer.addDocument(doc)
  }
  
  //
  // Utility for recursively walking directory tree
  // See:
  // override final def flatMap  [B](f : (A) => Iterable[B]) : List[B]
  class DocWalkFile(file: File) {  
	def children = new Iterable[File] {
    def elements = 
      if (file.isDirectory) file.listFiles.elements else Iterator.empty;
	}
	def andTree : Iterable[File] = (
      Seq.single(file) ++ children.flatMap(child => new
DocWalkFile(child).andTree))
  }
  def listDocuments(dir: File): List[File] =
	(new DocWalkFile(dir)).andTree.toList filter (f =>
(f.getName.endsWith(".java") || f.getName.endsWith(".txt")))
	  
  def indexDocuments(index_dir: File, files: List[File]) {
	Console.println("INFO: number of files to index=" + files.length)
    val writer = new IndexWriter(index_dir, new StandardAnalyzer(), true)
    for (val file <- files) {
      indexData(writer, file)
    }
  } 
  def main(args: Array[String]): Unit = {
    
    if (args.length != 2) {
      Console.println("usage: java BotlistIndexDocuments parent-index-dir
input-doc-dir")
	  Console.println("\n")
	  Console.println("\nRun the BotlistIndexDocuments index tool on the provided
index directory.")
	  Console.println("\nFor bug reporting instructions, please see:")
	  Console.println("<URL:http://code.google.com/p/openbotlist>.")
      return
    }

    Console.println("INFO: Indexing Document Data <standby> ...")
    val index = new File(args(0) + "/index")
	val doc_dir = new File(args(1)) 
    if (!index.exists()) {
      index.mkdir();
      Console.println("Creating index directory.")
    } else {
      Console.println("WARN: Index already exists (remove directory to continue)")
      Console.println("DIR: " + index.getAbsolutePath())
      //return
    }
	
	// Calculate the processing time to run application
    val timeStart = System.currentTimeMillis()
    indexDocuments(index, (listDocuments(doc_dir)))
    val timeEnd = System.currentTimeMillis()
    Console.println("Done...")
    Console.println("Completed processing in " + (timeEnd - timeStart) + " ms.")
  }
}

--
Berlin Brown
[berlin dot brown at gmail dot com]
http://botspiritcompany.com/botlist/?


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31028-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 21:26:19 2007
Return-Path: <java-user-return-31028-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88112 invoked from network); 14 Nov 2007 21:26:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 21:26:19 -0000
Received: (qmail 80477 invoked by uid 500); 14 Nov 2007 21:26:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80452 invoked by uid 500); 14 Nov 2007 21:26:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80441 invoked by uid 99); 14 Nov 2007 21:26:00 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 13:26:00 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [80.76.149.213] (HELO ch-smtp02.sth.basefarm.net) (80.76.149.213)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 21:26:55 +0000
Received: from c80-217-212-207.bredband.comhem.se ([80.217.212.207]:63422 helo=smtp.1und1.com)
	by ch-smtp02.sth.basefarm.net with esmtp (Exim 4.68)
	(envelope-from <hardy@ferentschik.de>)
	id 1IsPjx-0005SQ-7a
	for java-user@lucene.apache.org; Wed, 14 Nov 2007 22:25:41 +0100
Date: Wed, 14 Nov 2007 22:25:38 +0100
To: java-user@lucene.apache.org
Subject: Re: substring indexing to avoid 'TooManyClauses' exception
From: "Hardy Ferentschik" <hardy@ferentschik.de>
Content-Type: text/plain; format=flowed; delsp=yes; charset=iso-8859-15
MIME-Version: 1.0
References: <op.t1o70q0xvsesg3@smtp.1und1.com> <359a92830711130712h39c1abb2l207773b32378171@mail.gmail.com>
Content-Transfer-Encoding: 8bit
Message-ID: <op.t1swg0e9vsesg3@smtp.1und1.com>
In-Reply-To: <359a92830711130712h39c1abb2l207773b32378171@mail.gmail.com>
User-Agent: Opera Mail/9.22 (Win32)
X-Relayed-By: GPGrelay Version 0.959 (Win32)
X-Originating-IP: 80.217.212.207
X-Scan-Result: No virus found in message 1IsPjx-0005SQ-7a.
X-Scan-Signature: ch-smtp02.sth.basefarm.net 1IsPjx-0005SQ-7a 30e4090b6c93712c7691550ca390950e
X-Virus-Checked: Checked by ClamAV on apache.org

On Tue, 13 Nov 2007 16:12:26 +0100, Erick Erickson  
<erickerickson@gmail.com> wrote:

Thanks for your help.

> I'm certainly not an expert on ranking and scoring, but I've got to  
> assume that this approach influences scoring.
No doubt. The question is if it matters for this particular use case. For  
this particualt field I will ever only have a simple right hand truncated  
search. The user cannot use span or phrase queries against this field, not  
even explicit AND. I don't think this approach makes much sense when  
indexing a whole block of text. I only want to use it for indexing a  
simple name which at most consits of a few words. I guess what I want to  
do here is comparable to a single column SQL LIKE query, eg SELECT FROM  
COMPANY WHERE COMPANY.NAME LIKE 'M%'. Of course this is only the simple  
case. There are other queries where I combine the name search with other  
fields which are indexed using for example a SnowballAnalyzer.

> There are several approaches. There is a thread titled "I just don't
> understand wildcards at all" that has a bunch of information about
> wildcards, and searching the archive for "wildcards" will turn up a
> wealth of information.
Great. I will look into it.

Thanks again.

-- Hardy
-- 
Hartmut Ferentschik
Ekholmsv.339 ,1, 127 45 Skrholmen, Sweden
Phone: +46 855 923 676 (h); +46 704 225 097 (m)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31029-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 21:44:15 2007
Return-Path: <java-user-return-31029-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95779 invoked from network); 14 Nov 2007 21:44:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 21:44:14 -0000
Received: (qmail 22773 invoked by uid 500); 14 Nov 2007 21:43:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22482 invoked by uid 500); 14 Nov 2007 21:43:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22467 invoked by uid 99); 14 Nov 2007 21:43:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 13:43:55 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.189 as permitted sender)
Received: from [209.85.128.189] (HELO fk-out-0910.google.com) (209.85.128.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 21:43:43 +0000
Received: by fk-out-0910.google.com with SMTP id z23so318565fkz
        for <java-user@lucene.apache.org>; Wed, 14 Nov 2007 13:43:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=sfL7bNWYOKw4q1jzWP4mYgWO/7U+iqOxU9hT223vyig=;
        b=X7FblKTCWP8Jz6VN6SYUBvcgXigYjU7suMXMgXxj3q7G4s1irr5TdThBuMR7EhCOC6xS6bOCv0OQn060DxfabbTWTQ5YWIKcbarLLqQ+nTmFSHi/PFzslwxZ/AzJknXCEAlg7EQiBXJDPNSb8sJQ3b1cC/tQ5N2aUHdog8j+G9A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=erNXS+VWphghACoJXudbyerI6/rf9KB4xT4jibVezdOAoJcKv4j8JGgew+GIjZh5uae5tQRouVZ/DDaLtq3bZjB8iLSif6tVboASy+LomsBuAhqQ8wowQb2crhU/OsTCEIH+JhwgwNMAFkaGcU6GD7wopQ6e77gLJjs62Eu6/e0=
Received: by 10.82.134.12 with SMTP id h12mr5238314bud.1195076605327;
        Wed, 14 Nov 2007 13:43:25 -0800 (PST)
Received: by 10.82.190.14 with HTTP; Wed, 14 Nov 2007 13:43:25 -0800 (PST)
Message-ID: <359a92830711141343r638a0c13h1110839eda78ec1f@mail.gmail.com>
Date: Wed, 14 Nov 2007 16:43:25 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Can't code to index documents
In-Reply-To: <20071114201958.M45941@www.botspiritcompany.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3782_33047835.1195076605322"
References: <20071114201958.M45941@www.botspiritcompany.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3782_33047835.1195076605322
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Several questions:

1> have you gotten a copy of Luke to examine your index? If so,
    what does it show?
2> Do you ever close your indexwriter? If so, is it closed
    before you open your indexreader to search? I don't see
    anything in your code that looks like it closes the writer, but
    I sure don't know much about scala
3> what does printing the document have to do with being sure
     it gets indexed? It's unclear what relationship you see between
     those statements.
4> what is a LucDocument? I assume it's a sublcass of a Lucene
    Document. But one thing I'd try is just using the raw Lucene
    doc first.
5> are you absolutely sure that your calls to link.(fullPath, filename,
content, id)
    actually return something that can be indexed?

Best
Erick


On Nov 14, 2007 3:23 PM, bbrown <bbrown@botspiritcompany.com> wrote:

> I am using this code which is pretty basic.  And it won't index the
> documents.
>  I run the index code and print the document to make sure that it gets
> indexed, but when I looked at the output "gen" and "segments" file, there
> are
> only like 20bytes of data in the files.  I am indexing about 300k of text
> data.  I am using scala but I dont think that is an issue as I have used
> similar code before.  When I do a search 0 documents for everything.
>
> I am using Lucene 2.2.0 (just downloaded).
>
> Here is the core of my code:
>
>  def indexData(writer:IndexWriter, file: File) {
>    val doc = new LucDocument()
>
>        // Read the content from the file
>        val contentReader = new ContentReader(file.getAbsolutePath)
>    val (title, content) = contentReader.readFile()
>
>        // Extract data from the java File class
>        val link = new DocumentLink(file.getAbsolutePath, file.getName,
>                                                        content,
> file.getAbsolutePath)
>
>        // Index the document and data.
>    doc.add(new Field(LUC_KEY_FULL_PATH, link.fullPath,
>                                          Field.Store.YES,
> Field.Index.TOKENIZED))
>    doc.add(new Field(LUC_KEY_FILE_NAME, link.filename,
>                                          Field.Store.YES,
> Field.Index.TOKENIZED))
>        doc.add(new Field(LUC_KEY_CONTENT, link.content,
>                                          Field.Store.YES,
> Field.Index.TOKENIZED))
>    doc.add(new Field(LUC_KEY_IDENTITY, link.id,
>                                          Field.Store.YES,
> Field.Index.UN_TOKENIZED))
>    writer.addDocument(doc)
>  }
>
>
> But if you want the full scala source, here it is.  Think of it as pseudo
> code:
>
> object BotlistIndexDocuments {
>
>  val LUC_KEY_FULL_PATH = "full_path"
>  val LUC_KEY_FILE_NAME = "file_name"
>  val LUC_KEY_CONTENT = "content"
>  val LUC_KEY_IDENTITY = "id"
>
>    //
>  // Read the content file.  The first line should contain
>  // a "#title summary" line and the rest of the document
>  // will contain the "wiki" document.
>  class ContentReader(filename: String) {
>    def readFile(): (String, String) = {
>      val file = Source.fromFile(filename)
>      var counted = file.getLines.counted
>      val fileData = new StringBuilder()
>      var title = ""
>      counted.foreach { (line: String) =>
>                if (counted.count == 0) {
>              //title = line.substring(6).trim()
>                  title = line
>                } else {
>              fileData.append(line)
>                }
>      }
>      (title, fileData.toString())
>    }
>  } // End of Class //
>
>  case class DocumentLink(abs_path: String, file: String, data: String,
>                                                  unique_id:String) {
>    val fullPath = abs_path
>    val filename = file
>        val content = data
>    val id = unique_id
>  }
>  def indexData(writer:IndexWriter, file: File) {
>    val doc = new LucDocument()
>
>        // Read the content from the file
>        val contentReader = new ContentReader(file.getAbsolutePath)
>    val (title, content) = contentReader.readFile()
>
>        // Extract data from the java File class
>        val link = new DocumentLink(file.getAbsolutePath, file.getName,
>                                                        content,
> file.getAbsolutePath)
>
>        // Index the document and data.
>    doc.add(new Field(LUC_KEY_FULL_PATH, link.fullPath,
>                                          Field.Store.YES,
> Field.Index.TOKENIZED))
>    doc.add(new Field(LUC_KEY_FILE_NAME, link.filename,
>                                          Field.Store.YES,
> Field.Index.TOKENIZED))
>        doc.add(new Field(LUC_KEY_CONTENT, link.content,
>                                          Field.Store.YES,
> Field.Index.TOKENIZED))
>    doc.add(new Field(LUC_KEY_IDENTITY, link.id,
>                                          Field.Store.YES,
> Field.Index.UN_TOKENIZED))
>    writer.addDocument(doc)
>  }
>
>  //
>  // Utility for recursively walking directory tree
>  // See:
>  // override final def flatMap  [B](f : (A) => Iterable[B]) : List[B]
>  class DocWalkFile(file: File) {
>        def children = new Iterable[File] {
>    def elements =
>      if (file.isDirectory) file.listFiles.elements else Iterator.empty;
>        }
>        def andTree : Iterable[File] = (
>      Seq.single(file) ++ children.flatMap(child => new
> DocWalkFile(child).andTree))
>  }
>  def listDocuments(dir: File): List[File] =
>        (new DocWalkFile(dir)).andTree.toList filter (f =>
> (f.getName.endsWith(".java") || f.getName.endsWith(".txt")))
>
>  def indexDocuments(index_dir: File, files: List[File]) {
>        Console.println("INFO: number of files to index=" + files.length)
>    val writer = new IndexWriter(index_dir, new StandardAnalyzer(), true)
>    for (val file <- files) {
>      indexData(writer, file)
>    }
>  }
>  def main(args: Array[String]): Unit = {
>
>    if (args.length != 2) {
>      Console.println("usage: java BotlistIndexDocuments parent-index-dir
> input-doc-dir")
>          Console.println("\n")
>          Console.println("\nRun the BotlistIndexDocuments index tool on
> the provided
> index directory.")
>          Console.println("\nFor bug reporting instructions, please see:")
>          Console.println("<URL:http://code.google.com/p/openbotlist>.")
>      return
>    }
>
>    Console.println("INFO: Indexing Document Data <standby> ...")
>    val index = new File(args(0) + "/index")
>        val doc_dir = new File(args(1))
>    if (!index.exists()) {
>      index.mkdir();
>      Console.println("Creating index directory.")
>    } else {
>      Console.println("WARN: Index already exists (remove directory to
> continue)")
>      Console.println("DIR: " + index.getAbsolutePath())
>      //return
>    }
>
>        // Calculate the processing time to run application
>    val timeStart = System.currentTimeMillis()
>    indexDocuments(index, (listDocuments(doc_dir)))
>    val timeEnd = System.currentTimeMillis()
>    Console.println("Done...")
>    Console.println("Completed processing in " + (timeEnd - timeStart) + "
> ms.")
>  }
> }
>
> --
> Berlin Brown
> [berlin dot brown at gmail dot com]
> http://botspiritcompany.com/botlist/?
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_3782_33047835.1195076605322--

From java-user-return-31030-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 14 21:53:24 2007
Return-Path: <java-user-return-31030-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98792 invoked from network); 14 Nov 2007 21:53:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 14 Nov 2007 21:53:23 -0000
Received: (qmail 35999 invoked by uid 500); 14 Nov 2007 21:53:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35965 invoked by uid 500); 14 Nov 2007 21:53:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35954 invoked by uid 99); 14 Nov 2007 21:53:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 13:53:05 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.189 as permitted sender)
Received: from [209.85.134.189] (HELO mu-out-0910.google.com) (209.85.134.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 21:52:54 +0000
Received: by mu-out-0910.google.com with SMTP id i10so339902mue
        for <java-user@lucene.apache.org>; Wed, 14 Nov 2007 13:52:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=8pf5zpFxaqID/c16cYJ6Vtcyn1M6P4fMVgBfVjETdP8=;
        b=b7UDe0ylg6P89v8WAeNBW/hJ8Y4egISUVnMQJD1WQ+5W4Pa1rzLrvYKjbtjBqLOSsYwMvx4utA9IKoKuVdtRiMU2EegKJvPepWvE0QJ2ACN7S5oNOrmOPZ2mbtzZdLhpam4BOs6oflkXS7SAsnHwfGBjELCUanPHToh2qOY5L/A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=gYuDyhVUsgO3sBLvGfiDEChxACP4hD5kBm0YSdgMuisTXMdQg4tgwMTciN2EB8DsD9DShm85L3gFKZjpeZJntKXxp6JW2YTXJT1HS9ABw+IjcodNPagypDqyku2xqYpyQMfe3slW0W9hzIi9qTzTZkc1CiVQyNEajGlPVfu+X2w=
Received: by 10.82.181.10 with SMTP id d10mr18026715buf.1195077144831;
        Wed, 14 Nov 2007 13:52:24 -0800 (PST)
Received: by 10.82.190.14 with HTTP; Wed, 14 Nov 2007 13:52:24 -0800 (PST)
Message-ID: <359a92830711141352o2e9824f7g1d8a03666d22761d@mail.gmail.com>
Date: Wed, 14 Nov 2007 16:52:24 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: substring indexing to avoid 'TooManyClauses' exception
In-Reply-To: <op.t1swg0e9vsesg3@smtp.1und1.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3822_24902805.1195077144821"
References: <op.t1o70q0xvsesg3@smtp.1und1.com>
	 <359a92830711130712h39c1abb2l207773b32378171@mail.gmail.com>
	 <op.t1swg0e9vsesg3@smtp.1und1.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3822_24902805.1195077144821
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Hardy:

Since your use-case is so restricted, I'd recommend that you
just construct a filter. I think you'll find it's much faster than
you'd think at first glance. Of course, "Your mileage may
vary" Is there any equivalent phrase like "Your kilometerage
may vary" <G>?

Most of the discussion in the archives has to do with the
more general case, so much of it probably doesn't apply to
your specific case.

Best
Erick

On Nov 14, 2007 4:25 PM, Hardy Ferentschik <hardy@ferentschik.de> wrote:

> On Tue, 13 Nov 2007 16:12:26 +0100, Erick Erickson
> <erickerickson@gmail.com> wrote:
>
> Thanks for your help.
>
> > I'm certainly not an expert on ranking and scoring, but I've got to
> > assume that this approach influences scoring.
> No doubt. The question is if it matters for this particular use case. For
> this particualt field I will ever only have a simple right hand truncated
> search. The user cannot use span or phrase queries against this field, no=
t
> even explicit AND. I don't think this approach makes much sense when
> indexing a whole block of text. I only want to use it for indexing a
> simple name which at most consits of a few words. I guess what I want to
> do here is comparable to a single column SQL LIKE query, eg SELECT FROM
> COMPANY WHERE COMPANY.NAME LIKE 'M%'. Of course this is only the simple
> case. There are other queries where I combine the name search with other
> fields which are indexed using for example a SnowballAnalyzer.
>
> > There are several approaches. There is a thread titled "I just don't
> > understand wildcards at all" that has a bunch of information about
> > wildcards, and searching the archive for "wildcards" will turn up a
> > wealth of information.
> Great. I will look into it.
>
> Thanks again.
>
> -- Hardy
> --
> Hartmut Ferentschik
> Ekholmsv.339 ,1, 127 45 Sk=E4rholmen, Sweden
> Phone: +46 855 923 676 (h); +46 704 225 097 (m)
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_3822_24902805.1195077144821--

From java-user-return-31031-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 03:15:14 2007
Return-Path: <java-user-return-31031-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90274 invoked from network); 15 Nov 2007 03:15:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 03:15:14 -0000
Received: (qmail 67836 invoked by uid 500); 15 Nov 2007 03:14:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67808 invoked by uid 500); 15 Nov 2007 03:14:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67797 invoked by uid 99); 15 Nov 2007 03:14:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 19:14:55 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.112.26.52] (HELO mx.sjtu.edu.cn) (202.112.26.52)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 03:14:44 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by mx.sjtu.edu.cn (Postfix) with ESMTP id C6A2D3413DA
	for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 11:14:25 +0800 (CST)
Received: from mx.sjtu.edu.cn ([127.0.0.1])
	by localhost (mx [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
	id 19757-02 for <java-user@lucene.apache.org>;
	Thu, 15 Nov 2007 11:14:25 +0800 (CST)
Received: from nb (unknown [211.220.99.141])
	by mx.sjtu.edu.cn (Postfix) with ESMTP id 21A12341120
	for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 11:14:24 +0800 (CST)
From: "Zhou Qi" <zhou_qi@sjtu.edu.cn>
To: <java-user@lucene.apache.org>
Subject: how to effeciently implement the stastical scores like pagerank?
Date: Thu, 15 Nov 2007 12:14:18 +0800
Message-ID: <000c01c8273e$00e7dc70$02b79550$@edu.cn>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_000D_01C82781.0F0B1C70"
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcgnPf146a86XPBGRY+uAQ29Pd44tQ==
Content-Language: zh-cn
X-Virus-Scanned: by amavisd-new-20030616-p10 (Debian) at sjtu.edu.cn
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_000D_01C82781.0F0B1C70
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit

Hi Guys,

 

         I made a problem in implement some extra scores besides the VSM
model. My works entails with re-ranking the returned documents from the
extra scores like page quality or page property ( good page or navigator
page). I have tried two approaches before:

A.      Setting the document boosting attribute in indexing, but it is hard
to adjust these weight after indexing the documents.

B.      The second way is to retrieve all the documents and getting the
score first, and then I will need to iterate all the documents to fetch some
store fields to get the property of the page to compute the re-ranking
score. From the experiments before, this way takes too much time and it will
need to iterate all the documents to re-ranking. This implementation is easy
to adjust the ranking algorithem but it is too slow.

Can anyone give a better solution to do that? Thanks in advance.

 

Best Regards,

 

Zhou Qi 

Dept. Computer Science & Engineering

Shanghai Jiaotong University

 

 


------=_NextPart_000_000D_01C82781.0F0B1C70--


From java-user-return-31032-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 06:23:19 2007
Return-Path: <java-user-return-31032-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36413 invoked from network); 15 Nov 2007 06:23:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 06:23:19 -0000
Received: (qmail 80361 invoked by uid 500); 15 Nov 2007 06:23:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80319 invoked by uid 500); 15 Nov 2007 06:23:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80308 invoked by uid 99); 15 Nov 2007 06:23:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 22:23:00 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chee.wu@gmail.com designates 64.233.182.191 as permitted sender)
Received: from [64.233.182.191] (HELO nf-out-0910.google.com) (64.233.182.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 06:22:51 +0000
Received: by nf-out-0910.google.com with SMTP id d3so336506nfc
        for <java-user@lucene.apache.org>; Wed, 14 Nov 2007 22:22:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=dI8HITkxM9lwjSHRrzRJubuKGXS/HTz5Z6QlWD9vmv4=;
        b=bAk9Wznt0r/tkELNPL5NDA5Y0eGmwpUXW13wx+NNc8GkWxCpvU6ImRwgA4B0bxlFBZv83sg0tF/22yno4D/jvrLRhx3xmXDQQ9Skm+/+369s3Y5GmpP4KJJwEEFmeHO5So1hFnjsbheD/zgGWrOyK03oUc9TtMjepyd+mM9VMJU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=cjL9pAbFKDrKRb6xB0ZcXnQoxYadSt/2rYJ+AyG8y6jbAt4u0V4YfDsqHrNSi92UwMumssaltiG+a2IEiHe88ex2N3k5NXQ2sKdEUpHUesGHf0+yxnSXlxLcg0+p65wj8nx68nPY26NQvt7BvAe1tB/VhOl1MDJqxsxD9jPpjWA=
Received: by 10.86.60.7 with SMTP id i7mr333810fga.1195107760863;
        Wed, 14 Nov 2007 22:22:40 -0800 (PST)
Received: by 10.86.52.9 with HTTP; Wed, 14 Nov 2007 22:22:40 -0800 (PST)
Message-ID: <99dfded80711142222u30616dp6ef9282e047da98e@mail.gmail.com>
Date: Thu, 15 Nov 2007 14:22:40 +0800
From: "Chee Wu" <chee.wu@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: how to effeciently implement the stastical scores like pagerank?
In-Reply-To: <000c01c8273e$00e7dc70$02b79550$@edu.cn>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_957_19803624.1195107760852"
References: <000c01c8273e$00e7dc70$02b79550$@edu.cn>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_957_19803624.1195107760852
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Not sure with what you want to do ..
There are many factors can affect the rank of documents.Some factors should
be fixed, always the same for different query  words ,such as PageRank and
the ratio between amount of the links and the full text length of the
pages,and VSM should be a dynamic factor..

So how do you want to implement your own score mechanism, just import some
new factors or a completely new way? If add new factor, then a fixed one or
a dynamic one ?



2007/11/15, Zhou Qi <zhou_qi@sjtu.edu.cn>:
>
> Hi Guys,
>
>
>
>          I made a problem in implement some extra scores besides the VSM
> model. My works entails with re-ranking the returned documents from the
> extra scores like page quality or page property ( good page or navigator
> page). I have tried two approaches before:
>
> A.      Setting the document boosting attribute in indexing, but it is
> hard
> to adjust these weight after indexing the documents.
>
> B.      The second way is to retrieve all the documents and getting the
> score first, and then I will need to iterate all the documents to fetch
> some
> store fields to get the property of the page to compute the re-ranking
> score. From the experiments before, this way takes too much time and it
> will
> need to iterate all the documents to re-ranking. This implementation is
> easy
> to adjust the ranking algorithem but it is too slow.
>
> Can anyone give a better solution to do that? Thanks in advance.
>
>
>
> Best Regards,
>
>
>
> Zhou Qi
>
> Dept. Computer Science & Engineering
>
> Shanghai Jiaotong University
>
>
>
>
>
>

------=_Part_957_19803624.1195107760852--

From java-user-return-31033-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 07:35:49 2007
Return-Path: <java-user-return-31033-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48522 invoked from network); 15 Nov 2007 07:35:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 07:35:49 -0000
Received: (qmail 33809 invoked by uid 500); 15 Nov 2007 07:35:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33771 invoked by uid 500); 15 Nov 2007 07:35:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33758 invoked by uid 99); 15 Nov 2007 07:35:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Nov 2007 23:35:31 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [196.204.161.5] (HELO sexgw3k-h2035.local.bibalex.dom) (196.204.161.5)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 15 Nov 2007 07:35:21 +0000
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C82758.8BCB33B6"
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: lucene datatypes
Date: Thu, 15 Nov 2007 09:24:23 +0200
Message-ID: <7A7E448CEEDE4741B9C7C889689EC4B805E1C6@sexgw3k-h2035.local.bibalex.dom>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: lucene datatypes
Thread-Index: AcgnWcsVZbt7//oRTIaiKq8r88qZeA==
From: "Heba Farouk" <Heba.Farouk@bibalex.org>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C82758.8BCB33B6
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hello,

=20

I would like to ask how lucene handles different datatypes, or "String"
is the only available datatype.

=20

 Best regards,

=20

Heba Farouk

Software Engineer

Bibliotheca Alexandrina


------_=_NextPart_001_01C82758.8BCB33B6--

From java-user-return-31034-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 13:25:49 2007
Return-Path: <java-user-return-31034-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90334 invoked from network); 15 Nov 2007 13:25:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 13:25:49 -0000
Received: (qmail 86472 invoked by uid 500); 15 Nov 2007 13:25:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86435 invoked by uid 500); 15 Nov 2007 13:25:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86424 invoked by uid 99); 15 Nov 2007 13:25:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 05:25:29 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a12.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 13:25:19 +0000
Received: from [10.0.1.2] (1023chost55.starwoodbroadband.com [12.37.185.55])
	by spunkymail-a12.g.dreamhost.com (Postfix) with ESMTP id AD6287FAB
	for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 05:25:12 -0800 (PST)
Message-Id: <94F2BB84-A9D8-480F-B85B-7F07E6B3389A@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <7A7E448CEEDE4741B9C7C889689EC4B805E1C6@sexgw3k-h2035.local.bibalex.dom>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: lucene datatypes
Date: Thu, 15 Nov 2007 08:24:46 -0500
References: <7A7E448CEEDE4741B9C7C889689EC4B805E1C6@sexgw3k-h2035.local.bibalex.dom>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Solr provides semantics on Lucene fields for handling other data  
types, and there are some tools (DateTools, NumberTools) for  
converting some types to Strings for searching.  But yeah, Strings are  
pretty much the only thing Lucene cares about when it comes to  
searching.

-Grant

On Nov 15, 2007, at 2:24 AM, Heba Farouk wrote:

> Hello,
>
>
>
> I would like to ask how lucene handles different datatypes, or  
> "String"
> is the only available datatype.
>
>
>
> Best regards,
>
>
>
> Heba Farouk
>
> Software Engineer
>
> Bibliotheca Alexandrina
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31035-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 14:13:39 2007
Return-Path: <java-user-return-31035-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13632 invoked from network); 15 Nov 2007 14:13:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 14:13:39 -0000
Received: (qmail 46071 invoked by uid 500); 15 Nov 2007 14:13:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46039 invoked by uid 500); 15 Nov 2007 14:13:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46027 invoked by uid 99); 15 Nov 2007 14:13:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 06:13:20 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.35] (HELO smtp-vbr15.xs4all.nl) (194.109.24.35)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 14:13:10 +0000
Received: from [192.168.89.206] (impressie.xs4all.nl [82.93.53.149])
	by smtp-vbr15.xs4all.nl (8.13.8/8.13.8) with ESMTP id lAFED2N6010659
	for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 15:13:02 +0100 (CET)
	(envelope-from matthijs@impressie.nl)
Message-ID: <473C53EF.8030907@impressie.nl>
Date: Thu, 15 Nov 2007 15:13:03 +0100
From: Matthijs Bierman <matthijs@impressie.nl>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: get original term for synonym
References: <802248.33094.qm@web26011.mail.ukl.yahoo.com>
In-Reply-To: <802248.33094.qm@web26011.mail.ukl.yahoo.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Mark,

I have solved it in another way now. I've created my own implementation 
of StandardAnalyzer (which I've called AdvancedAnalyzer). This analyzer 
keeps the word "zone-indeling" together, so users can simply search for 
this term and it will be highlighted exactly as is. These compound words 
occur in Dutch only I presume.

The problem was my highlighter was for a PDF document (through PDFBox). 
This would highlight 1,2 and "indeling". Resulting in unwanted behaviour 
when the word was split into zone and indeling.

Thanks for your help though.

Cheers,
Matthijs

mark harwood wrote:
> It would be useful to have more details about the query input and the expected highlights you want.
>
> So given your 'zone-indeling' example document and the index-time tokenisation you described, which of the following queries would you expect to match and what would you want highlighted in each case?
> 1) zone
> 2) zone-indeling
> 3) "zone indeling"
> 4) zone-somethingElse
>
>
> My assumption here is that you are using the standard Lucene Query parser and that query 3 will therefore be a phrase query. 
>
> Cheers
> Mark
>
>
> ----- Original Message ----
> From: Matthijs Bierman <matthijs@impressie.nl>
> To: java-user@lucene.apache.org
> Sent: Wednesday, 14 November, 2007 11:51:07 AM
> Subject: Re: get original term for synonym
>
> Hi Mark,
>
> Your solution would be correct if the synonym would be a true 2-way
> synonym. Unfortunately this is not the case. My analyzer takes care of
> decomposition of specific Dutch words (where a "-" is used to create
> compound words). For example: 'zone-indeling' would create synonyms for
> 'zone'-> 'zone-indeling' and 'indeling'->'zone-indeling'.
> When analyzing 'zone' it will therefore not point back to
> 'zone-indeling' (this information is simply not available). Putting all
> the results from the indexing process into a file or lucene document
> (thus creating a 'lookup' index) would probably make the lookup process
> rather slow, or make application startup too long (due to HashMap
> generation).
>
> Maybe you can do something with offsets?
>
> Thanks,
> Matthijs
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>
>
>       ___________________________________________________________
> Yahoo! Answers - Got a question? Someone out there knows the answer. Try it
> now.
> http://uk.answers.yahoo.com/ 
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31036-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 14:25:14 2007
Return-Path: <java-user-return-31036-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17883 invoked from network); 15 Nov 2007 14:25:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 14:25:14 -0000
Received: (qmail 63899 invoked by uid 500); 15 Nov 2007 14:24:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63775 invoked by uid 500); 15 Nov 2007 14:24:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63764 invoked by uid 99); 15 Nov 2007 14:24:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 06:24:54 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.112.26.52] (HELO mx.sjtu.edu.cn) (202.112.26.52)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 14:24:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by mx.sjtu.edu.cn (Postfix) with ESMTP id D0851C73C
	for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 22:24:33 +0800 (CST)
X-Virus-Scanned: Debian amavisd-new at mx2.sjtu.edu.cn
Received: from mx.sjtu.edu.cn ([127.0.0.1])
	by localhost (mx2.sjtu.edu.cn [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id pyesnt2fXMVV for <java-user@lucene.apache.org>;
	Thu, 15 Nov 2007 22:24:31 +0800 (CST)
Received: from nb (unknown [210.222.183.235])
	by mx.sjtu.edu.cn (Postfix) with ESMTP id E2276C6B8
	for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 22:24:11 +0800 (CST)
From: "Zhou Qi" <zhou_qi@sjtu.edu.cn>
To: <java-user@lucene.apache.org>
References: <000c01c8273e$00e7dc70$02b79550$@edu.cn> <99dfded80711142222u30616dp6ef9282e047da98e@mail.gmail.com>
In-Reply-To: <99dfded80711142222u30616dp6ef9282e047da98e@mail.gmail.com>
Subject: =?utf-8?Q?=E7=AD=94=E5=A4=8D:_how_to_effeciently_implement?=
	=?utf-8?Q?_the_stastical_scores_like_pager?=
	=?utf-8?Q?ank=3F?=
Date: Thu, 15 Nov 2007 23:23:23 +0800
Message-ID: <000d01c8279b$8bf4f5c0$a3dee140$@edu.cn>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcgnUC+glSP0DNibTEKgSEEsm2EtewASkE/w
Content-Language: zh-cn
X-Virus-Checked: Checked by ClamAV on apache.org

Thank you, my score is fixed score from the properties of the page, but =
at first we need to adjust the score for a promising result.
I have tried one way of manually re-ranking all the documents by the =
search results. But it needs to iterate all the retrieved results and =
fetch the re-ranking score (stored in the index) to sum the overall =
score. It is inefficient. How to improve that by a new approach?

Sorry for making you misunderstanding. Thanks

Best Regards,

Zhou Qi=20
Dept. Computer Science & Engineering
Shanghai Jiaotong University
=20

-----=E9=82=AE=E4=BB=B6=E5=8E=9F=E4=BB=B6-----
=E5=8F=91=E4=BB=B6=E4=BA=BA: Chee Wu [mailto:chee.wu@gmail.com]=20
=E5=8F=91=E9=80=81=E6=97=B6=E9=97=B4: =
2007=E5=B9=B411=E6=9C=8815=E6=97=A5 14:23
=E6=94=B6=E4=BB=B6=E4=BA=BA: java-user@lucene.apache.org
=E4=B8=BB=E9=A2=98: Re: how to effeciently implement the stastical =
scores like pagerank?

Not sure with what you want to do ..
There are many factors can affect the rank of documents.Some factors =
should
be fixed, always the same for different query  words ,such as PageRank =
and
the ratio between amount of the links and the full text length of the
pages,and VSM should be a dynamic factor..

So how do you want to implement your own score mechanism, just import =
some
new factors or a completely new way? If add new factor, then a fixed one =
or
a dynamic one ?



2007/11/15, Zhou Qi <zhou_qi@sjtu.edu.cn>:
>
> Hi Guys,
>
>
>
>          I made a problem in implement some extra scores besides the =
VSM
> model. My works entails with re-ranking the returned documents from =
the
> extra scores like page quality or page property ( good page or =
navigator
> page). I have tried two approaches before:
>
> A.      Setting the document boosting attribute in indexing, but it is
> hard
> to adjust these weight after indexing the documents.
>
> B.      The second way is to retrieve all the documents and getting =
the
> score first, and then I will need to iterate all the documents to =
fetch
> some
> store fields to get the property of the page to compute the re-ranking
> score. From the experiments before, this way takes too much time and =
it
> will
> need to iterate all the documents to re-ranking. This implementation =
is
> easy
> to adjust the ranking algorithem but it is too slow.
>
> Can anyone give a better solution to do that? Thanks in advance.
>
>
>
> Best Regards,
>
>
>
> Zhou Qi
>
> Dept. Computer Science & Engineering
>
> Shanghai Jiaotong University
>
>
>
>
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31037-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 15:03:50 2007
Return-Path: <java-user-return-31037-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30374 invoked from network); 15 Nov 2007 15:03:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 15:03:49 -0000
Received: (qmail 20204 invoked by uid 500); 15 Nov 2007 15:03:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20176 invoked by uid 500); 15 Nov 2007 15:03:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20165 invoked by uid 99); 15 Nov 2007 15:03:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 07:03:30 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 64.233.182.189 as permitted sender)
Received: from [64.233.182.189] (HELO nf-out-0910.google.com) (64.233.182.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 15:03:20 +0000
Received: by nf-out-0910.google.com with SMTP id d3so439230nfc
        for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 07:03:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=Py43Yqwf2kkolKcuHduDI5NsXtYOMlQLIYBPb1nWdA8=;
        b=sf3itYq1Q35dP2AUsVysgCzFw8PCzUretvu96Dzz/QwhWKNN4T1uHksTkZe2sXUuL12YEjrED6xA940Iv89aIfF2ZpR10n4+O7FELuIeclMgdH5EPxGj9ZgKG7t4EtxEwKHdGa/VXrGCS3yvpKbipOBSrbAgP3c4KjXngtPSImI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=gBqtXqkgeXp5DeVYZJkCQW4nQNTVfkWYZYvgDqasJrsuepzaTDGB4TOiF7CdWnQcSUXqGYPw4H1597zRh34fSRVi0Aoi2P73kq0lmMM1DTh6UeLxaNXcp+Qnpiu0rd657TaEGHE6g0+Or8Goyrp+aTMsAsJwaEM71Dl4ZLh6YOM=
Received: by 10.86.58.3 with SMTP id g3mr743136fga.1195138991318;
        Thu, 15 Nov 2007 07:03:11 -0800 (PST)
Received: by 10.86.59.11 with HTTP; Thu, 15 Nov 2007 07:03:11 -0800 (PST)
Message-ID: <8837fb770711150703j6ec4c578qe829f74e5c61321b@mail.gmail.com>
Date: Thu, 15 Nov 2007 07:03:11 -0800
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: =?GB2312?B?UmU6ILTwuLQ6IGhvdyB0byBlZmZlY2llbnRseSBpbXBsZW1lbnQ=?= =?GB2312?B?IHRoZSBzdGFzdGljYWwgc2NvcmVzIGxpa2UgcGFnZXJhbms/?=
In-Reply-To: <000d01c8279b$8bf4f5c0$a3dee140$@edu.cn>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_7162_15987759.1195138991312"
References: <000c01c8273e$00e7dc70$02b79550$@edu.cn>
	 <99dfded80711142222u30616dp6ef9282e047da98e@mail.gmail.com>
	 <000d01c8279b$8bf4f5c0$a3dee140$@edu.cn>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_7162_15987759.1195138991312
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: base64
Content-Disposition: inline

V291bGQgcGF5bG9hZCB3b3JrPwotSm9obgoKT24gMTEvMTUvMDcsIFpob3UgUWkgPHpob3VfcWlA
c2p0dS5lZHUuY24+IHdyb3RlOgo+Cj4gVGhhbmsgeW91LCBteSBzY29yZSBpcyBmaXhlZCBzY29y
ZSBmcm9tIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBwYWdlLCBidXQgYXQKPiBmaXJzdCB3ZSBuZWVk
IHRvIGFkanVzdCB0aGUgc2NvcmUgZm9yIGEgcHJvbWlzaW5nIHJlc3VsdC4KPiBJIGhhdmUgdHJp
ZWQgb25lIHdheSBvZiBtYW51YWxseSByZS1yYW5raW5nIGFsbCB0aGUgZG9jdW1lbnRzIGJ5IHRo
ZQo+IHNlYXJjaCByZXN1bHRzLiBCdXQgaXQgbmVlZHMgdG8gaXRlcmF0ZSBhbGwgdGhlIHJldHJp
ZXZlZCByZXN1bHRzIGFuZCBmZXRjaAo+IHRoZSByZS1yYW5raW5nIHNjb3JlIChzdG9yZWQgaW4g
dGhlIGluZGV4KSB0byBzdW0gdGhlIG92ZXJhbGwgc2NvcmUuIEl0IGlzCj4gaW5lZmZpY2llbnQu
IEhvdyB0byBpbXByb3ZlIHRoYXQgYnkgYSBuZXcgYXBwcm9hY2g/Cj4KPiBTb3JyeSBmb3IgbWFr
aW5nIHlvdSBtaXN1bmRlcnN0YW5kaW5nLiBUaGFua3MKPgo+IEJlc3QgUmVnYXJkcywKPgo+IFpo
b3UgUWkKPiBEZXB0LiBDb21wdXRlciBTY2llbmNlICYgRW5naW5lZXJpbmcKPiBTaGFuZ2hhaSBK
aWFvdG9uZyBVbml2ZXJzaXR5Cj4KPgo+IC0tLS0t08q8/tStvP4tLS0tLQo+ILeivP7IyzogQ2hl
ZSBXdSBbbWFpbHRvOmNoZWUud3VAZ21haWwuY29tXQo+ILeiy83KsbzkOiAyMDA3xOoxMdTCMTXI
1SAxNDoyMwo+IMrVvP7IyzogamF2YS11c2VyQGx1Y2VuZS5hcGFjaGUub3JnCj4g1vfM4jogUmU6
IGhvdyB0byBlZmZlY2llbnRseSBpbXBsZW1lbnQgdGhlIHN0YXN0aWNhbCBzY29yZXMgbGlrZSBw
YWdlcmFuaz8KPgo+IE5vdCBzdXJlIHdpdGggd2hhdCB5b3Ugd2FudCB0byBkbyAuLgo+IFRoZXJl
IGFyZSBtYW55IGZhY3RvcnMgY2FuIGFmZmVjdCB0aGUgcmFuayBvZiBkb2N1bWVudHMuU29tZSBm
YWN0b3JzCj4gc2hvdWxkCj4gYmUgZml4ZWQsIGFsd2F5cyB0aGUgc2FtZSBmb3IgZGlmZmVyZW50
IHF1ZXJ5ICB3b3JkcyAsc3VjaCBhcyBQYWdlUmFuayBhbmQKPiB0aGUgcmF0aW8gYmV0d2VlbiBh
bW91bnQgb2YgdGhlIGxpbmtzIGFuZCB0aGUgZnVsbCB0ZXh0IGxlbmd0aCBvZiB0aGUKPiBwYWdl
cyxhbmQgVlNNIHNob3VsZCBiZSBhIGR5bmFtaWMgZmFjdG9yLi4KPgo+IFNvIGhvdyBkbyB5b3Ug
d2FudCB0byBpbXBsZW1lbnQgeW91ciBvd24gc2NvcmUgbWVjaGFuaXNtLCBqdXN0IGltcG9ydCBz
b21lCj4gbmV3IGZhY3RvcnMgb3IgYSBjb21wbGV0ZWx5IG5ldyB3YXk/IElmIGFkZCBuZXcgZmFj
dG9yLCB0aGVuIGEgZml4ZWQgb25lCj4gb3IKPiBhIGR5bmFtaWMgb25lID8KPgo+Cj4KPiAyMDA3
LzExLzE1LCBaaG91IFFpIDx6aG91X3FpQHNqdHUuZWR1LmNuPjoKPiA+Cj4gPiBIaSBHdXlzLAo+
ID4KPiA+Cj4gPgo+ID4gICAgICAgICAgSSBtYWRlIGEgcHJvYmxlbSBpbiBpbXBsZW1lbnQgc29t
ZSBleHRyYSBzY29yZXMgYmVzaWRlcyB0aGUgVlNNCj4gPiBtb2RlbC4gTXkgd29ya3MgZW50YWls
cyB3aXRoIHJlLXJhbmtpbmcgdGhlIHJldHVybmVkIGRvY3VtZW50cyBmcm9tIHRoZQo+ID4gZXh0
cmEgc2NvcmVzIGxpa2UgcGFnZSBxdWFsaXR5IG9yIHBhZ2UgcHJvcGVydHkgKCBnb29kIHBhZ2Ug
b3IgbmF2aWdhdG9yCj4gPiBwYWdlKS4gSSBoYXZlIHRyaWVkIHR3byBhcHByb2FjaGVzIGJlZm9y
ZToKPiA+Cj4gPiBBLiAgICAgIFNldHRpbmcgdGhlIGRvY3VtZW50IGJvb3N0aW5nIGF0dHJpYnV0
ZSBpbiBpbmRleGluZywgYnV0IGl0IGlzCj4gPiBoYXJkCj4gPiB0byBhZGp1c3QgdGhlc2Ugd2Vp
Z2h0IGFmdGVyIGluZGV4aW5nIHRoZSBkb2N1bWVudHMuCj4gPgo+ID4gQi4gICAgICBUaGUgc2Vj
b25kIHdheSBpcyB0byByZXRyaWV2ZSBhbGwgdGhlIGRvY3VtZW50cyBhbmQgZ2V0dGluZyB0aGUK
PiA+IHNjb3JlIGZpcnN0LCBhbmQgdGhlbiBJIHdpbGwgbmVlZCB0byBpdGVyYXRlIGFsbCB0aGUg
ZG9jdW1lbnRzIHRvIGZldGNoCj4gPiBzb21lCj4gPiBzdG9yZSBmaWVsZHMgdG8gZ2V0IHRoZSBw
cm9wZXJ0eSBvZiB0aGUgcGFnZSB0byBjb21wdXRlIHRoZSByZS1yYW5raW5nCj4gPiBzY29yZS4g
RnJvbSB0aGUgZXhwZXJpbWVudHMgYmVmb3JlLCB0aGlzIHdheSB0YWtlcyB0b28gbXVjaCB0aW1l
IGFuZCBpdAo+ID4gd2lsbAo+ID4gbmVlZCB0byBpdGVyYXRlIGFsbCB0aGUgZG9jdW1lbnRzIHRv
IHJlLXJhbmtpbmcuIFRoaXMgaW1wbGVtZW50YXRpb24gaXMKPiA+IGVhc3kKPiA+IHRvIGFkanVz
dCB0aGUgcmFua2luZyBhbGdvcml0aGVtIGJ1dCBpdCBpcyB0b28gc2xvdy4KPiA+Cj4gPiBDYW4g
YW55b25lIGdpdmUgYSBiZXR0ZXIgc29sdXRpb24gdG8gZG8gdGhhdD8gVGhhbmtzIGluIGFkdmFu
Y2UuCj4gPgo+ID4KPiA+Cj4gPiBCZXN0IFJlZ2FyZHMsCj4gPgo+ID4KPiA+Cj4gPiBaaG91IFFp
Cj4gPgo+ID4gRGVwdC4gQ29tcHV0ZXIgU2NpZW5jZSAmIEVuZ2luZWVyaW5nCj4gPgo+ID4gU2hh
bmdoYWkgSmlhb3RvbmcgVW5pdmVyc2l0eQo+ID4KPiA+Cj4gPgo+ID4KPiA+Cj4gPgo+Cj4KPiAt
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KPiBUbyB1bnN1YnNjcmliZSwgZS1tYWlsOiBqYXZhLXVzZXItdW5zdWJzY3Jp
YmVAbHVjZW5lLmFwYWNoZS5vcmcKPiBGb3IgYWRkaXRpb25hbCBjb21tYW5kcywgZS1tYWlsOiBq
YXZhLXVzZXItaGVscEBsdWNlbmUuYXBhY2hlLm9yZwo+Cj4K
------=_Part_7162_15987759.1195138991312--

From java-user-return-31038-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 18:35:56 2007
Return-Path: <java-user-return-31038-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41430 invoked from network); 15 Nov 2007 18:35:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 18:35:55 -0000
Received: (qmail 49633 invoked by uid 500); 15 Nov 2007 18:35:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49154 invoked by uid 500); 15 Nov 2007 18:35:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49143 invoked by uid 99); 15 Nov 2007 18:35:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 10:35:36 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 209.85.132.243 as permitted sender)
Received: from [209.85.132.243] (HELO an-out-0708.google.com) (209.85.132.243)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 18:35:25 +0000
Received: by an-out-0708.google.com with SMTP id d40so152911and
        for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 10:35:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=9ipdmRXCCyQCj0dBx4OanGxRJLrtz9jsTnJqLTUXibY=;
        b=hMPcS/6YD+4r5yPDxGzhu52hrtS/AuC99UnYb2fSgW7DlqYYhT8PBOQhcb98wVuWyfxdjCdODskIoqjUQEufJ+PhF5bhlQAxGABgkTYgXabYHKbKc/M4oHoapg1lorRHsC56hCBqSmYo3kNCXynTYHkIeFRE1xicNo8TNvBRCy4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=pJYrlr1y8aG/8tHXqfBemEHKm7CMSD/goEG97y2Mex2/NsquNnhhlPCbOwP5YaYDgAhUANzVZ1UuWbYnpOFBgQi1WdlEDMG8bLZKGfWYcy8sLTnWDclTq0Ign1qYn6XitXPyzADFhE6X9YFod5MS6zrg+2MTSj0UvGn7vB4aqMA=
Received: by 10.142.213.9 with SMTP id l9mr270061wfg.1195151716879;
        Thu, 15 Nov 2007 10:35:16 -0800 (PST)
Received: from ?172.16.17.233? ( [12.6.150.3])
        by mx.google.com with ESMTPS id 6sm2812566wrh.2007.11.15.10.35.14
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 15 Nov 2007 10:35:15 -0800 (PST)
Message-ID: <473C9108.2080504@gmail.com>
Date: Thu, 15 Nov 2007 10:33:44 -0800
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.6 (Windows/20070728)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: Re: =?GB2312?B?tPC4tDogaG93IHRvIGVmZmVjaWVudGx5IGltcGxlbWVudCB0aA==?=
 =?GB2312?B?ZSBzdGFzdGljYWwgc2NvcmVzIGxpa2UgcGFnZXJhbms/?=
References: <000c01c8273e$00e7dc70$02b79550$@edu.cn>	 <99dfded80711142222u30616dp6ef9282e047da98e@mail.gmail.com>	 <000d01c8279b$8bf4f5c0$a3dee140$@edu.cn> <8837fb770711150703j6ec4c578qe829f74e5c61321b@mail.gmail.com>
In-Reply-To: <8837fb770711150703j6ec4c578qe829f74e5c61321b@mail.gmail.com>
Content-Type: text/plain; charset=GB2312
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

John Wang wrote:
> Would payload work?
> -John
>
>   
Yes, if you used payloads instead of stored fields your performance
should be much better.

Try and index one special term per document (e. g. score:pagerank), and
index one position with a payload for each doc. Then when you retrieve
hits open a TermPositions using the special term, get the payload and
incorporate it in the docs' score.

The performance overhead should be comparable to adding one AND-term to
your query.

-Michael

> On 11/15/07, Zhou Qi <zhou_qi@sjtu.edu.cn> wrote:
>   
>> Thank you, my score is fixed score from the properties of the page, but at
>> first we need to adjust the score for a promising result.
>> I have tried one way of manually re-ranking all the documents by the
>> search results. But it needs to iterate all the retrieved results and fetch
>> the re-ranking score (stored in the index) to sum the overall score. It is
>> inefficient. How to improve that by a new approach?
>>
>> Sorry for making you misunderstanding. Thanks
>>
>> Best Regards,
>>
>> Zhou Qi
>> Dept. Computer Science & Engineering
>> Shanghai Jiaotong University
>>
>>     


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31039-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 18:42:58 2007
Return-Path: <java-user-return-31039-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43122 invoked from network); 15 Nov 2007 18:42:58 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 18:42:58 -0000
Received: (qmail 61405 invoked by uid 500); 15 Nov 2007 18:42:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61360 invoked by uid 500); 15 Nov 2007 18:42:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61349 invoked by uid 99); 15 Nov 2007 18:42:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 10:42:39 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 18:42:29 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IsjfS-0007lF-Ab
	for java-user@lucene.apache.org; Thu, 15 Nov 2007 10:42:22 -0800
Message-ID: <13778913.post@talk.nabble.com>
Date: Thu, 15 Nov 2007 10:42:22 -0800 (PST)
From: Sirish <vsirishreddy@yahoo.co.in>
To: java-user@lucene.apache.org
Subject: Indexing Problem
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: vsirishreddy@yahoo.co.in
X-Virus-Checked: Checked by ClamAV on apache.org


The following is my code snippet for indexing the text:

document.add(Field.Text(IFIELD_TEXT, billMeasureDoc.getText()));

When ever the text is less or short, it works perfectly. But in few of the
cases if the text is too lengthy; i.e. around 1000 lines or more then it
causes a problem.

The problem being when the text is lengthy, after indexing, the document is
getting searched only upto a certain extent of text. For eg: Lets say we
have a text:

Test Test Test Test Test Test Test Test Test
.......... .......... .......... .......... .......... .......... .....
Test1 Test1 Test1 Test1 Test1 Test1 Test1 
.......... .......... .......... .......... .......... .......... .....
Test2 Test2 Test2 Test2 Test2 Test2 Test2

Now while searching, it returns the document only if I search for either
Test or Test1 and it ignores any text that is trailing after Test1.

Can someone let me know if there is any text or character size limitation
for Field.Text in my above code. Also I would like to store this text as I
need to implement highlighting for the search text.


-- 
View this message in context: http://www.nabble.com/Indexing-Problem-tf4816336.html#a13778913
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31040-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 19:11:15 2007
Return-Path: <java-user-return-31040-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51123 invoked from network); 15 Nov 2007 19:11:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 19:11:15 -0000
Received: (qmail 10154 invoked by uid 500); 15 Nov 2007 19:10:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10115 invoked by uid 500); 15 Nov 2007 19:10:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10084 invoked by uid 99); 15 Nov 2007 19:10:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 11:10:50 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.128.184 as permitted sender)
Received: from [209.85.128.184] (HELO fk-out-0910.google.com) (209.85.128.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 19:10:10 +0000
Received: by fk-out-0910.google.com with SMTP id z23so628560fkz
        for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 11:09:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=eMNwr5QqMw9Sktu8Ja0YZKyIvtb70uaL9pIVtDX5VZM=;
        b=cEdpIvBH+c4PQFp0/SUozoPpaDC0P7IwYLlnz1G6NJOxS+q+HMyZtBRZF7IKvbdeyQOyeqvFvZIl05AWtxH89oxqA3/HiQioJEB8s7CfhoUIubKrDMrUBSWGVeA33nc1FhHFgynFR495XbJpvxgQfuJW3burhOI7zBOb3yD/xCE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Ybvn2knso+3ti/mgH8Lgw5Ko70cMLPqbtI4gYO+HHSQLY+IQxPI2Wcp/omGCVLPCNVFg3s23R6vwMEpjHCeAGMNz8VYnR8VbEsI5MXaq0U4bXchTLrQmui0GD6CyXyq93ySQ59sD074nOH3G5iWOQ+OcKs9L7nXLUL5rQ+v6Xvk=
Received: by 10.82.167.5 with SMTP id p5mr2701955bue.1195153796350;
        Thu, 15 Nov 2007 11:09:56 -0800 (PST)
Received: by 10.82.151.7 with HTTP; Thu, 15 Nov 2007 11:09:56 -0800 (PST)
Message-ID: <359a92830711151109t38267370h946c3195767e967a@mail.gmail.com>
Date: Thu, 15 Nov 2007 14:09:56 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Indexing Problem
In-Reply-To: <13778913.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5322_14811468.1195153796345"
References: <13778913.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5322_14811468.1195153796345
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Your problem is probably, that by default, Lucene stops after
10,000 terms. See IndexWriter.SetMaxFieldLength

Best
Erick

On Nov 15, 2007 1:42 PM, Sirish <vsirishreddy@yahoo.co.in> wrote:

>
> The following is my code snippet for indexing the text:
>
> document.add(Field.Text(IFIELD_TEXT, billMeasureDoc.getText()));
>
> When ever the text is less or short, it works perfectly. But in few of the
> cases if the text is too lengthy; i.e. around 1000 lines or more then it
> causes a problem.
>
> The problem being when the text is lengthy, after indexing, the document
> is
> getting searched only upto a certain extent of text. For eg: Lets say we
> have a text:
>
> Test Test Test Test Test Test Test Test Test
> .......... .......... .......... .......... .......... .......... .....
> Test1 Test1 Test1 Test1 Test1 Test1 Test1
> .......... .......... .......... .......... .......... .......... .....
> Test2 Test2 Test2 Test2 Test2 Test2 Test2
>
> Now while searching, it returns the document only if I search for either
> Test or Test1 and it ignores any text that is trailing after Test1.
>
> Can someone let me know if there is any text or character size limitation
> for Field.Text in my above code. Also I would like to store this text as I
> need to implement highlighting for the search text.
>
>
> --
> View this message in context:
> http://www.nabble.com/Indexing-Problem-tf4816336.html#a13778913
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5322_14811468.1195153796345--

From java-user-return-31041-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 21:15:41 2007
Return-Path: <java-user-return-31041-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89804 invoked from network); 15 Nov 2007 21:15:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 21:15:39 -0000
Received: (qmail 5218 invoked by uid 500); 15 Nov 2007 21:15:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5189 invoked by uid 500); 15 Nov 2007 21:15:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5178 invoked by uid 99); 15 Nov 2007 21:15:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 13:15:20 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 21:15:09 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Ism3C-0004f1-Td
	for java-user@lucene.apache.org; Thu, 15 Nov 2007 13:15:02 -0800
Message-ID: <13781957.post@talk.nabble.com>
Date: Thu, 15 Nov 2007 13:15:02 -0800 (PST)
From: Sirish <vsirishreddy@yahoo.co.in>
To: java-user@lucene.apache.org
Subject: Re: Indexing Problem
In-Reply-To: <359a92830711151109t38267370h946c3195767e967a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: vsirishreddy@yahoo.co.in
References: <13778913.post@talk.nabble.com> <359a92830711151109t38267370h946c3195767e967a@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Wow!! Thanks dude... that works... I have spent almost a day figuring out the
issue... I appreciate it!!

Erick Erickson wrote:
> 
> Your problem is probably, that by default, Lucene stops after
> 10,000 terms. See IndexWriter.SetMaxFieldLength
> 
> Best
> Erick
> 
> On Nov 15, 2007 1:42 PM, Sirish <vsirishreddy@yahoo.co.in> wrote:
> 
>>
>> The following is my code snippet for indexing the text:
>>
>> document.add(Field.Text(IFIELD_TEXT, billMeasureDoc.getText()));
>>
>> When ever the text is less or short, it works perfectly. But in few of
>> the
>> cases if the text is too lengthy; i.e. around 1000 lines or more then it
>> causes a problem.
>>
>> The problem being when the text is lengthy, after indexing, the document
>> is
>> getting searched only upto a certain extent of text. For eg: Lets say we
>> have a text:
>>
>> Test Test Test Test Test Test Test Test Test
>> .......... .......... .......... .......... .......... .......... .....
>> Test1 Test1 Test1 Test1 Test1 Test1 Test1
>> .......... .......... .......... .......... .......... .......... .....
>> Test2 Test2 Test2 Test2 Test2 Test2 Test2
>>
>> Now while searching, it returns the document only if I search for either
>> Test or Test1 and it ignores any text that is trailing after Test1.
>>
>> Can someone let me know if there is any text or character size limitation
>> for Field.Text in my above code. Also I would like to store this text as
>> I
>> need to implement highlighting for the search text.
>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/Indexing-Problem-tf4816336.html#a13778913
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/Indexing-Problem-tf4816336.html#a13781957
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31042-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 15 22:32:00 2007
Return-Path: <java-user-return-31042-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15977 invoked from network); 15 Nov 2007 22:32:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 15 Nov 2007 22:32:00 -0000
Received: (qmail 3487 invoked by uid 500); 15 Nov 2007 22:31:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3445 invoked by uid 500); 15 Nov 2007 22:31:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3433 invoked by uid 99); 15 Nov 2007 22:31:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 14:31:41 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [156.80.1.73] (HELO mclniron02-ext.bah.com) (156.80.1.73)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 22:31:29 +0000
x-SBRS: None
X-REMOTE-IP: 156.80.7.151
X-IronPort-AV: E=Sophos;i="4.21,422,1188792000"; 
   d="scan'208,217";a="256468536"
Received: from mclnexbh01.resource.ds.bah.com ([156.80.7.151])
  by mclniron02-int.bah.com with ESMTP; 15 Nov 2007 17:31:23 -0500
Received: from MCLNEXVS10.resource.ds.bah.com ([156.80.7.215]) by mclnexbh01.resource.ds.bah.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Thu, 15 Nov 2007 17:31:28 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C827D7.43DBB245"
Subject: gdata server 
Date: Thu, 15 Nov 2007 17:31:22 -0500
Message-ID: <97AEC8D598C0694E974EFE59A6CC144002BED008@MCLNEXVS10.resource.ds.bah.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: gdata server 
Thread-Index: Acgn1z/CeZUMneBeTRWfEWIQzxaZ9A==
From: "Lyth, Christopher [USA]" <lyth_christopher@bah.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 15 Nov 2007 22:31:28.0498 (UTC) FILETIME=[438F5D20:01C827D7]
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C827D7.43DBB245
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Is anyone on this list using the gdata server? I have been trying to get
it working and have been running into some problems.=20


------_=_NextPart_001_01C827D7.43DBB245--

From java-user-return-31043-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 00:46:41 2007
Return-Path: <java-user-return-31043-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54810 invoked from network); 16 Nov 2007 00:46:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 00:46:41 -0000
Received: (qmail 5280 invoked by uid 500); 16 Nov 2007 00:46:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5247 invoked by uid 500); 16 Nov 2007 00:46:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5236 invoked by uid 99); 16 Nov 2007 00:46:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 16:46:23 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [156.80.1.71] (HELO mclniron01-ext.bah.com) (156.80.1.71)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 00:46:11 +0000
x-SBRS: None
X-REMOTE-IP: 156.80.7.152
X-IronPort-AV: E=Sophos;i="4.21,422,1188792000"; 
   d="scan'208";a="292158145"
Received: from bahmail.bah.com (HELO mclnexbh02.resource.ds.bah.com) ([156.80.7.152])
  by mclniron01-int.bah.com with ESMTP; 15 Nov 2007 19:46:03 -0500
Received: from MCLNEXVS10.resource.ds.bah.com ([156.80.7.215]) by mclnexbh02.resource.ds.bah.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Thu, 15 Nov 2007 19:46:08 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: Stack Trace  - RE: gdata server 
Date: Thu, 15 Nov 2007 19:46:02 -0500
Message-ID: <97AEC8D598C0694E974EFE59A6CC144002BED071@MCLNEXVS10.resource.ds.bah.com>
In-Reply-To: <97AEC8D598C0694E974EFE59A6CC144002BED008@MCLNEXVS10.resource.ds.bah.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Stack Trace  - RE: gdata server 
Thread-Index: Acgn1z/CeZUMneBeTRWfEWIQzxaZ9AACjuaw
References: <97AEC8D598C0694E974EFE59A6CC144002BED008@MCLNEXVS10.resource.ds.bah.com>
From: "Lyth, Christopher [USA]" <lyth_christopher@bah.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 16 Nov 2007 00:46:08.0043 (UTC) FILETIME=[135817B0:01C827EA]
X-Virus-Checked: Checked by ClamAV on apache.org

Nov 15, 2007 7:40:39 PM
org.apache.lucene.gdata.server.registry.GDataServerRegistry
registerScopeVisitor
INFO: Register scope visitor -- class
org.apache.lucene.gdata.server.registry.ProvidedServiceConfig
Nov 15, 2007 7:40:39 PM org.apache.commons.digester.Digester endElement
SEVERE: End event threw exception
java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
a:39)
        at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
Impl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at
org.apache.commons.beanutils.PropertyUtilsBean.invokeMethod(PropertyUtil
sBean.java:1773)
        at
org.apache.commons.beanutils.PropertyUtilsBean.setSimpleProperty(Propert
yUtilsBean.java:1759)
        at
org.apache.commons.beanutils.PropertyUtilsBean.setNestedProperty(Propert
yUtilsBean.java:1648)
        at
org.apache.commons.beanutils.PropertyUtilsBean.setProperty(PropertyUtils
Bean.java:1677)
        at
org.apache.commons.beanutils.BeanUtilsBean.setProperty(BeanUtilsBean.jav
a:1022)
        at
org.apache.commons.beanutils.BeanUtils.setProperty(BeanUtils.java:313)
        at
org.apache.commons.digester.BeanPropertySetterRule.end(BeanPropertySette
rRule.java:197)
        at
org.apache.commons.digester.Digester.endElement(Digester.java:1130)
        at
org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
        at
org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown Source)
        at
org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
        at
org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDis
patcher.dispatch(Unknown Source)
        at
org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unkno
wn Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
Source)
        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown
Source)
        at
org.apache.commons.digester.Digester.parse(Digester.java:1666)
        at
org.apache.lucene.gdata.server.registry.RegistryBuilder.buildFromConfigu
ration(RegistryBuilder.java:96)
        at
org.apache.lucene.gdata.server.registry.RegistryBuilder.buildRegistry(Re
gistryBuilder.java:60)
        at
org.apache.lucene.gdata.server.registry.RegistryContextListener.contextI
nitialized(RegistryContextListener.java:60)
        at
org.apache.catalina.core.StandardContext.listenerStart(StandardContext.j
ava:3764)
        at
org.apache.catalina.core.StandardContext.start(StandardContext.java:4216
)
        at
org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.ja
va:760)
        at
org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:740)
        at
org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
        at
org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:
626)
        at
org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java
:553)
        at
org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
        at
org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
        at
org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:31
1)
        at
org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSu
pport.java:120)
        at
org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
        at
org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
        at
org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
        at
org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
        at
org.apache.catalina.core.StandardService.start(StandardService.java:448)
        at
org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
        at org.apache.catalina.startup.Catalina.start(Catalina.java:552)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
a:39)
        at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
Impl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at
org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
        at
org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)
Caused by: java.lang.ClassCastException:
com.google.gdata.data.ExtensionProfile
        at
org.apache.lucene.gdata.server.registry.ProvidedServiceConfig.setExtensi
onProfileClass(ProvidedServiceConfig.java:188)
        ... 49 more
Nov 15, 2007 7:40:39 PM
org.apache.lucene.gdata.server.registry.RegistryContextListener
contextInitialized
SEVERE: can not register required components
java.lang.ClassCastException: com.google.gdata.data.ExtensionProfile
        at
org.apache.commons.digester.Digester.createSAXException(Digester.java:29
19)
        at
org.apache.commons.digester.Digester.createSAXException(Digester.java:29
45)
        at
org.apache.commons.digester.Digester.endElement(Digester.java:1133)
        at
org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
        at
org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown Source)
        at
org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
        at
org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDis
patcher.dispatch(Unknown Source)
        at
org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unkno
wn Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
Source)
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
Source)
        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown
Source)
        at
org.apache.commons.digester.Digester.parse(Digester.java:1666)
        at
org.apache.lucene.gdata.server.registry.RegistryBuilder.buildFromConfigu
ration(RegistryBuilder.java:96)
        at
org.apache.lucene.gdata.server.registry.RegistryBuilder.buildRegistry(Re
gistryBuilder.java:60)
        at
org.apache.lucene.gdata.server.registry.RegistryContextListener.contextI
nitialized(RegistryContextListener.java:60)
        at
org.apache.catalina.core.StandardContext.listenerStart(StandardContext.j
ava:3764)
        at
org.apache.catalina.core.StandardContext.start(StandardContext.java:4216
)
        at
org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.ja
va:760)
        at
org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:740)
        at
org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
        at
org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:
626)
        at
org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java
:553)
        at
org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
        at
org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
        at
org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:31
1)
        at
org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSu
pport.java:120)
        at
org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
        at
org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
        at
org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
        at
org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
        at
org.apache.catalina.core.StandardService.start(StandardService.java:448)
        at
org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
        at org.apache.catalina.startup.Catalina.start(Catalina.java:552)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at
sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
a:39)
        at
sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
Impl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at
org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
        at
org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)
Nov 15, 2007 7:40:40 PM org.apache.catalina.core.StandardContext start
SEVERE: Error listenerStart

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31044-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 03:44:52 2007
Return-Path: <java-user-return-31044-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96018 invoked from network); 16 Nov 2007 03:44:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 03:44:52 -0000
Received: (qmail 20463 invoked by uid 500); 16 Nov 2007 03:44:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20429 invoked by uid 500); 16 Nov 2007 03:44:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20418 invoked by uid 99); 16 Nov 2007 03:44:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 19:44:32 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a10.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 03:44:22 +0000
Received: from [10.0.1.2] (1023chost55.starwoodbroadband.com [12.37.185.55])
	by spunkymail-a10.g.dreamhost.com (Postfix) with ESMTP id 7DC5F163712
	for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 19:44:15 -0800 (PST)
Message-Id: <C3C90866-7662-4739-AECC-A2154C75ADC9@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <97AEC8D598C0694E974EFE59A6CC144002BED008@MCLNEXVS10.resource.ds.bah.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: gdata server 
Date: Thu, 15 Nov 2007 22:43:53 -0500
References: <97AEC8D598C0694E974EFE59A6CC144002BED008@MCLNEXVS10.resource.ds.bah.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Hmm, we're not sure.  We were just asking if anyone uses it b/c we are  
thinking of archiving it.  I guess, though, you are saying that you  
would like to use it.  :-)

-Grant
On Nov 15, 2007, at 5:31 PM, Lyth, Christopher [USA] wrote:

> Is anyone on this list using the gdata server? I have been trying to  
> get
> it working and have been running into some problems.
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31045-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 03:46:26 2007
Return-Path: <java-user-return-31045-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 96587 invoked from network); 16 Nov 2007 03:46:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 03:46:26 -0000
Received: (qmail 23327 invoked by uid 500); 16 Nov 2007 03:46:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23300 invoked by uid 500); 16 Nov 2007 03:46:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23289 invoked by uid 99); 16 Nov 2007 03:46:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 19:46:07 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.202] (HELO spunkymail-a20.g.dreamhost.com) (208.97.132.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 03:45:56 +0000
Received: from [10.0.1.2] (1023chost55.starwoodbroadband.com [12.37.185.55])
	by spunkymail-a20.g.dreamhost.com (Postfix) with ESMTP id 9CAF3E24AA
	for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 19:45:48 -0800 (PST)
Message-Id: <9FCDE3E1-9330-4554-B6F0-BD397D53E538@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <97AEC8D598C0694E974EFE59A6CC144002BED071@MCLNEXVS10.resource.ds.bah.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Stack Trace  - RE: gdata server 
Date: Thu, 15 Nov 2007 22:45:18 -0500
References: <97AEC8D598C0694E974EFE59A6CC144002BED008@MCLNEXVS10.resource.ds.bah.com> <97AEC8D598C0694E974EFE59A6CC144002BED071@MCLNEXVS10.resource.ds.bah.com>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Is there a configuration file you have to setup?  Can you give info on  
what commands you ran?  I have never used GData, but this error looks  
like it is trying to configure something and it is not getting the  
class it expects.

-Grant

On Nov 15, 2007, at 7:46 PM, Lyth, Christopher [USA] wrote:

> Nov 15, 2007 7:40:39 PM
> org.apache.lucene.gdata.server.registry.GDataServerRegistry
> registerScopeVisitor
> INFO: Register scope visitor -- class
> org.apache.lucene.gdata.server.registry.ProvidedServiceConfig
> Nov 15, 2007 7:40:39 PM org.apache.commons.digester.Digester  
> endElement
> SEVERE: End event threw exception
> java.lang.reflect.InvocationTargetException
>        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>        at
> sun 
> .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> a:39)
>        at
> sun 
> .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> Impl.java:25)
>        at java.lang.reflect.Method.invoke(Method.java:585)
>        at
> org 
> .apache.commons.beanutils.PropertyUtilsBean.invokeMethod(PropertyUtil
> sBean.java:1773)
>        at
> org 
> .apache.commons.beanutils.PropertyUtilsBean.setSimpleProperty(Propert
> yUtilsBean.java:1759)
>        at
> org 
> .apache.commons.beanutils.PropertyUtilsBean.setNestedProperty(Propert
> yUtilsBean.java:1648)
>        at
> org 
> .apache.commons.beanutils.PropertyUtilsBean.setProperty(PropertyUtils
> Bean.java:1677)
>        at
> org 
> .apache.commons.beanutils.BeanUtilsBean.setProperty(BeanUtilsBean.jav
> a:1022)
>        at
> org.apache.commons.beanutils.BeanUtils.setProperty(BeanUtils.java:313)
>        at
> org 
> .apache.commons.digester.BeanPropertySetterRule.end(BeanPropertySette
> rRule.java:197)
>        at
> org.apache.commons.digester.Digester.endElement(Digester.java:1130)
>        at
> org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
>        at
> org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown  
> Source)
>        at
> org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
> Source)
>        at
> org.apache.xerces.impl.XMLDocumentFragmentScannerImpl 
> $FragmentContentDis
> patcher.dispatch(Unknown Source)
>        at
> org 
> .apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unkno
> wn Source)
>        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> Source)
>        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> Source)
>        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
>        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown
> Source)
>        at
> org.apache.commons.digester.Digester.parse(Digester.java:1666)
>        at
> org 
> .apache.lucene.gdata.server.registry.RegistryBuilder.buildFromConfigu
> ration(RegistryBuilder.java:96)
>        at
> org 
> .apache.lucene.gdata.server.registry.RegistryBuilder.buildRegistry(Re
> gistryBuilder.java:60)
>        at
> org 
> .apache.lucene.gdata.server.registry.RegistryContextListener.contextI
> nitialized(RegistryContextListener.java:60)
>        at
> org 
> .apache.catalina.core.StandardContext.listenerStart(StandardContext.j
> ava:3764)
>        at
> org.apache.catalina.core.StandardContext.start(StandardContext.java: 
> 4216
> )
>        at
> org 
> .apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.ja
> va:760)
>        at
> org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java: 
> 740)
>        at
> org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
>        at
> org 
> .apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:
> 626)
>        at
> org 
> .apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java
> :553)
>        at
> org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
>        at
> org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
>        at
> org 
> .apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:31
> 1)
>        at
> org 
> .apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSu
> pport.java:120)
>        at
> org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
>        at
> org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
>        at
> org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
>        at
> org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
>        at
> org.apache.catalina.core.StandardService.start(StandardService.java: 
> 448)
>        at
> org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
>        at org.apache.catalina.startup.Catalina.start(Catalina.java: 
> 552)
>        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>        at
> sun 
> .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> a:39)
>        at
> sun 
> .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> Impl.java:25)
>        at java.lang.reflect.Method.invoke(Method.java:585)
>        at
> org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
>        at
> org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)
> Caused by: java.lang.ClassCastException:
> com.google.gdata.data.ExtensionProfile
>        at
> org 
> .apache.lucene.gdata.server.registry.ProvidedServiceConfig.setExtensi
> onProfileClass(ProvidedServiceConfig.java:188)
>        ... 49 more
> Nov 15, 2007 7:40:39 PM
> org.apache.lucene.gdata.server.registry.RegistryContextListener
> contextInitialized
> SEVERE: can not register required components
> java.lang.ClassCastException: com.google.gdata.data.ExtensionProfile
>        at
> org 
> .apache.commons.digester.Digester.createSAXException(Digester.java:29
> 19)
>        at
> org 
> .apache.commons.digester.Digester.createSAXException(Digester.java:29
> 45)
>        at
> org.apache.commons.digester.Digester.endElement(Digester.java:1133)
>        at
> org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
>        at
> org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown  
> Source)
>        at
> org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
> Source)
>        at
> org.apache.xerces.impl.XMLDocumentFragmentScannerImpl 
> $FragmentContentDis
> patcher.dispatch(Unknown Source)
>        at
> org 
> .apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unkno
> wn Source)
>        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> Source)
>        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> Source)
>        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
>        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown
> Source)
>        at
> org.apache.commons.digester.Digester.parse(Digester.java:1666)
>        at
> org 
> .apache.lucene.gdata.server.registry.RegistryBuilder.buildFromConfigu
> ration(RegistryBuilder.java:96)
>        at
> org 
> .apache.lucene.gdata.server.registry.RegistryBuilder.buildRegistry(Re
> gistryBuilder.java:60)
>        at
> org 
> .apache.lucene.gdata.server.registry.RegistryContextListener.contextI
> nitialized(RegistryContextListener.java:60)
>        at
> org 
> .apache.catalina.core.StandardContext.listenerStart(StandardContext.j
> ava:3764)
>        at
> org.apache.catalina.core.StandardContext.start(StandardContext.java: 
> 4216
> )
>        at
> org 
> .apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.ja
> va:760)
>        at
> org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java: 
> 740)
>        at
> org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
>        at
> org 
> .apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:
> 626)
>        at
> org 
> .apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java
> :553)
>        at
> org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
>        at
> org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
>        at
> org 
> .apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:31
> 1)
>        at
> org 
> .apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSu
> pport.java:120)
>        at
> org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
>        at
> org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
>        at
> org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
>        at
> org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
>        at
> org.apache.catalina.core.StandardService.start(StandardService.java: 
> 448)
>        at
> org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
>        at org.apache.catalina.startup.Catalina.start(Catalina.java: 
> 552)
>        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>        at
> sun 
> .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> a:39)
>        at
> sun 
> .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> Impl.java:25)
>        at java.lang.reflect.Method.invoke(Method.java:585)
>        at
> org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
>        at
> org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)
> Nov 15, 2007 7:40:40 PM org.apache.catalina.core.StandardContext start
> SEVERE: Error listenerStart
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31046-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 03:57:26 2007
Return-Path: <java-user-return-31046-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98761 invoked from network); 16 Nov 2007 03:57:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 03:57:26 -0000
Received: (qmail 34661 invoked by uid 500); 16 Nov 2007 03:57:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34425 invoked by uid 500); 16 Nov 2007 03:57:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34414 invoked by uid 99); 16 Nov 2007 03:57:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 19:57:07 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [156.80.1.71] (HELO mclniron01-ext.bah.com) (156.80.1.71)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 03:56:55 +0000
x-SBRS: None
X-REMOTE-IP: 156.80.7.151
X-IronPort-AV: E=Sophos;i="4.21,424,1188792000"; 
   d="scan'208";a="292178638"
Received: from mclnexbh01.resource.ds.bah.com ([156.80.7.151])
  by mclniron01-int.bah.com with ESMTP; 15 Nov 2007 22:56:47 -0500
Received: from MCLNEXVS10.resource.ds.bah.com ([156.80.7.215]) by mclnexbh01.resource.ds.bah.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Thu, 15 Nov 2007 22:56:53 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Stack Trace  - RE: gdata server 
Date: Thu, 15 Nov 2007 22:56:43 -0500
Message-ID: <97AEC8D598C0694E974EFE59A6CC144002BED0CC@MCLNEXVS10.resource.ds.bah.com>
In-Reply-To: <9FCDE3E1-9330-4554-B6F0-BD397D53E538@apache.org>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Stack Trace  - RE: gdata server 
Thread-Index: AcgoA0fv7SgWvJqdSzKkWVbos5TbMAAAIs9A
References: <97AEC8D598C0694E974EFE59A6CC144002BED008@MCLNEXVS10.resource.ds.bah.com> <97AEC8D598C0694E974EFE59A6CC144002BED071@MCLNEXVS10.resource.ds.bah.com> <9FCDE3E1-9330-4554-B6F0-BD397D53E538@apache.org>
From: "Lyth, Christopher [USA]" <lyth_christopher@bah.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 16 Nov 2007 03:56:53.0957 (UTC) FILETIME=[B9A3F750:01C82804]
X-Virus-Checked: Checked by ClamAV on apache.org

Well as far as I could tell the config xml files should work out of
version control. All I have done so far is check out the project and
tried to build it. The ant files seem to need some attention.

Anyway, I was hoping to find someone that was using it or had ever set
it up. This project is very interesting to me and my team.

Thanks for the quick response
Chris
-----Original Message-----
From: Grant Ingersoll [mailto:gsingers@apache.org]=20
Sent: Thursday, November 15, 2007 10:45 PM
To: java-user@lucene.apache.org
Subject: Re: Stack Trace - RE: gdata server=20

Is there a configuration file you have to setup?  Can you give info on =20
what commands you ran?  I have never used GData, but this error looks =20
like it is trying to configure something and it is not getting the =20
class it expects.

-Grant

On Nov 15, 2007, at 7:46 PM, Lyth, Christopher [USA] wrote:

> Nov 15, 2007 7:40:39 PM
> org.apache.lucene.gdata.server.registry.GDataServerRegistry
> registerScopeVisitor
> INFO: Register scope visitor -- class
> org.apache.lucene.gdata.server.registry.ProvidedServiceConfig
> Nov 15, 2007 7:40:39 PM org.apache.commons.digester.Digester =20
> endElement
> SEVERE: End event threw exception
> java.lang.reflect.InvocationTargetException
>        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>        at
> sun=20
> .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> a:39)
>        at
> sun=20
> .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> Impl.java:25)
>        at java.lang.reflect.Method.invoke(Method.java:585)
>        at
> org=20
> .apache.commons.beanutils.PropertyUtilsBean.invokeMethod(PropertyUtil
> sBean.java:1773)
>        at
> org=20
> .apache.commons.beanutils.PropertyUtilsBean.setSimpleProperty(Propert
> yUtilsBean.java:1759)
>        at
> org=20
> .apache.commons.beanutils.PropertyUtilsBean.setNestedProperty(Propert
> yUtilsBean.java:1648)
>        at
> org=20
> .apache.commons.beanutils.PropertyUtilsBean.setProperty(PropertyUtils
> Bean.java:1677)
>        at
> org=20
> .apache.commons.beanutils.BeanUtilsBean.setProperty(BeanUtilsBean.jav
> a:1022)
>        at
> org.apache.commons.beanutils.BeanUtils.setProperty(BeanUtils.java:313)
>        at
> org=20
> .apache.commons.digester.BeanPropertySetterRule.end(BeanPropertySette
> rRule.java:197)
>        at
> org.apache.commons.digester.Digester.endElement(Digester.java:1130)
>        at
> org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
>        at
> org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown =20
> Source)
>        at
> org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
> Source)
>        at
> org.apache.xerces.impl.XMLDocumentFragmentScannerImpl=20
> $FragmentContentDis
> patcher.dispatch(Unknown Source)
>        at
> org=20
> .apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unkno
> wn Source)
>        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> Source)
>        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> Source)
>        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
>        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown
> Source)
>        at
> org.apache.commons.digester.Digester.parse(Digester.java:1666)
>        at
> org=20
> .apache.lucene.gdata.server.registry.RegistryBuilder.buildFromConfigu
> ration(RegistryBuilder.java:96)
>        at
> org=20
> .apache.lucene.gdata.server.registry.RegistryBuilder.buildRegistry(Re
> gistryBuilder.java:60)
>        at
> org=20
> .apache.lucene.gdata.server.registry.RegistryContextListener.contextI
> nitialized(RegistryContextListener.java:60)
>        at
> org=20
> .apache.catalina.core.StandardContext.listenerStart(StandardContext.j
> ava:3764)
>        at
> org.apache.catalina.core.StandardContext.start(StandardContext.java:=20
> 4216
> )
>        at
> org=20
> .apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.ja
> va:760)
>        at
> org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:=20
> 740)
>        at
> org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
>        at
> org=20
> .apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:
> 626)
>        at
> org=20
> .apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java
> :553)
>        at
> org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
>        at
> org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
>        at
> org=20
> .apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:31
> 1)
>        at
> org=20
> .apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSu
> pport.java:120)
>        at
> org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
>        at
> org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
>        at
> org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
>        at
> org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
>        at
> org.apache.catalina.core.StandardService.start(StandardService.java:=20
> 448)
>        at
> org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
>        at org.apache.catalina.startup.Catalina.start(Catalina.java:=20
> 552)
>        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>        at
> sun=20
> .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> a:39)
>        at
> sun=20
> .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> Impl.java:25)
>        at java.lang.reflect.Method.invoke(Method.java:585)
>        at
> org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
>        at
> org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)
> Caused by: java.lang.ClassCastException:
> com.google.gdata.data.ExtensionProfile
>        at
> org=20
> .apache.lucene.gdata.server.registry.ProvidedServiceConfig.setExtensi
> onProfileClass(ProvidedServiceConfig.java:188)
>        ... 49 more
> Nov 15, 2007 7:40:39 PM
> org.apache.lucene.gdata.server.registry.RegistryContextListener
> contextInitialized
> SEVERE: can not register required components
> java.lang.ClassCastException: com.google.gdata.data.ExtensionProfile
>        at
> org=20
> .apache.commons.digester.Digester.createSAXException(Digester.java:29
> 19)
>        at
> org=20
> .apache.commons.digester.Digester.createSAXException(Digester.java:29
> 45)
>        at
> org.apache.commons.digester.Digester.endElement(Digester.java:1133)
>        at
> org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
>        at
> org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown =20
> Source)
>        at
> org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
> Source)
>        at
> org.apache.xerces.impl.XMLDocumentFragmentScannerImpl=20
> $FragmentContentDis
> patcher.dispatch(Unknown Source)
>        at
> org=20
> .apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unkno
> wn Source)
>        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> Source)
>        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> Source)
>        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
>        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown
> Source)
>        at
> org.apache.commons.digester.Digester.parse(Digester.java:1666)
>        at
> org=20
> .apache.lucene.gdata.server.registry.RegistryBuilder.buildFromConfigu
> ration(RegistryBuilder.java:96)
>        at
> org=20
> .apache.lucene.gdata.server.registry.RegistryBuilder.buildRegistry(Re
> gistryBuilder.java:60)
>        at
> org=20
> .apache.lucene.gdata.server.registry.RegistryContextListener.contextI
> nitialized(RegistryContextListener.java:60)
>        at
> org=20
> .apache.catalina.core.StandardContext.listenerStart(StandardContext.j
> ava:3764)
>        at
> org.apache.catalina.core.StandardContext.start(StandardContext.java:=20
> 4216
> )
>        at
> org=20
> .apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.ja
> va:760)
>        at
> org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:=20
> 740)
>        at
> org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
>        at
> org=20
> .apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:
> 626)
>        at
> org=20
> .apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java
> :553)
>        at
> org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
>        at
> org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
>        at
> org=20
> .apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:31
> 1)
>        at
> org=20
> .apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSu
> pport.java:120)
>        at
> org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
>        at
> org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
>        at
> org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
>        at
> org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
>        at
> org.apache.catalina.core.StandardService.start(StandardService.java:=20
> 448)
>        at
> org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
>        at org.apache.catalina.startup.Catalina.start(Catalina.java:=20
> 552)
>        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>        at
> sun=20
> .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> a:39)
>        at
> sun=20
> .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> Impl.java:25)
>        at java.lang.reflect.Method.invoke(Method.java:585)
>        at
> org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
>        at
> org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)
> Nov 15, 2007 7:40:40 PM org.apache.catalina.core.StandardContext start
> SEVERE: Error listenerStart
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31047-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 06:44:59 2007
Return-Path: <java-user-return-31047-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46532 invoked from network); 16 Nov 2007 06:44:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 06:44:59 -0000
Received: (qmail 57938 invoked by uid 500); 16 Nov 2007 06:44:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56853 invoked by uid 500); 16 Nov 2007 06:44:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56842 invoked by uid 99); 16 Nov 2007 06:44:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Nov 2007 22:44:40 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 64.233.182.190 as permitted sender)
Received: from [64.233.182.190] (HELO nf-out-0910.google.com) (64.233.182.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 06:44:30 +0000
Received: by nf-out-0910.google.com with SMTP id d3so639243nfc
        for <java-user@lucene.apache.org>; Thu, 15 Nov 2007 22:44:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=Oe7u6NlP2cHG4IBlTdJR/5zUOjQ7VHmXhEaAYa8CVQE=;
        b=InLLKwxpyk94eA3nSTqTuEjpKvCY1LGXgLV7vDXsYsbHkYAkySAG//qOboO/TA4NLKOsGFMujR4msnpwxcbsMg+PNivFnxgV/3NMQ3sXCIvOAkD5V2ZV4lizOuh/tA4p1+odOdwy6ndUTfi5QDMWlec3DM4QwP4vXy5y0GZxDxE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=qMiDWTLkW8jXrqEh4uEZuy8bAGKEHZlph3IJmPjd9eUD3UOCfd9y6h8RMrL1Eoz1yFtyfTxsOvxVOd32JvWsvEszwKoh23bP0U3ZXWVATIff5UcmFFTQsp1+0E3szewPWaaCyuWj3uB65lG/nc9TuaRI3tZq8Ll9/xlqE5Bjst8=
Received: by 10.86.58.3 with SMTP id g3mr1483536fga.1195195462109;
        Thu, 15 Nov 2007 22:44:22 -0800 (PST)
Received: by 10.86.59.11 with HTTP; Thu, 15 Nov 2007 22:44:22 -0800 (PST)
Message-ID: <8837fb770711152244r2113e851v401394276b5e6453@mail.gmail.com>
Date: Thu, 15 Nov 2007 22:44:22 -0800
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: realtime indexing
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi:

    It was interesting hearing about the need for real time indexing
at the BirdsOfAFeather round table. We also needed to solve this
problem. We took this approach:

A large disk index that indexes in batch, e.g. sleeps for some time
queue up requests, wakes up and the index.
While large disk index is sleeping, same requests are also added to a
ram index, and when disk indexer is working, requests received is
added to another ram index.

When new disk index is published, the first ram index points to the
secondary ram index, and the secondary ram index is flushed.

we keep 1 index reader open for the disk index, and create new
indexReaders for the ram indexes per request (it seems to be ok
because the ram indexes are small)

We use MultiSearcher across these readers.

duplicates are also handled with our scheme.

I am curious to see if anyone else is trying this. It would be
interesting to hear comments from the experts.

Thanks

-John

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31048-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 09:09:21 2007
Return-Path: <java-user-return-31048-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25308 invoked from network); 16 Nov 2007 09:09:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 09:09:21 -0000
Received: (qmail 25741 invoked by uid 500); 16 Nov 2007 09:09:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25703 invoked by uid 500); 16 Nov 2007 09:09:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25690 invoked by uid 99); 16 Nov 2007 09:09:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 01:09:02 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of simon.willnauer@googlemail.com designates 209.85.146.181 as permitted sender)
Received: from [209.85.146.181] (HELO wa-out-1112.google.com) (209.85.146.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 09:08:50 +0000
Received: by wa-out-1112.google.com with SMTP id j40so1006577wah
        for <java-user@lucene.apache.org>; Fri, 16 Nov 2007 01:08:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=googlemail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=WgCwRwYPSzDwzzSArU6+LZ3wwb4lKSeoKSPpjBLdrRA=;
        b=ZO22u2mUnalKIRNFQCsXpGwkxnbSDh3r8HVBPpeo9Ul6rLTjk3yeG+/oZfFwYScQeTMTR5Fogis4bou9omrrwM1G/itg4gyK7TGoxVo4tdFDtHMEKvAyspShw+TXQL7LfQkPZnekatuTtq5U4I7HKja6kTMX1xGLTSWQTrUuTNc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=googlemail.com; s=beta;
        h=received:message-id:date:from:reply-to:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=RjOq1R0q+1yeOLUuJSo0g7cy9xfnRWn2RHohIH6dbPCD+224ZcsYbptAmqfwHX5oL91bc6H7geQT18xsNaxJL+CTGahtb9z3E4xfcEVFPEDkRdc0TNCvhRHyGfnnVZnulTKjF84MfZ/THM/f61L8LY4CvtPBdu5RdvGDSGIe1Wo=
Received: by 10.114.210.2 with SMTP id i2mr134935wag.1195204122576;
        Fri, 16 Nov 2007 01:08:42 -0800 (PST)
Received: by 10.115.108.5 with HTTP; Fri, 16 Nov 2007 01:08:42 -0800 (PST)
Message-ID: <f18c9dde0711160108v266f5f77rdf4cc80a514cb24c@mail.gmail.com>
Date: Fri, 16 Nov 2007 10:08:42 +0100
From: "Simon Willnauer" <simon.willnauer@googlemail.com>
Reply-To: simon.willnauer@gmail.com
To: java-user@lucene.apache.org
Subject: Re: Stack Trace - RE: gdata server
In-Reply-To: <97AEC8D598C0694E974EFE59A6CC144002BED0CC@MCLNEXVS10.resource.ds.bah.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <97AEC8D598C0694E974EFE59A6CC144002BED008@MCLNEXVS10.resource.ds.bah.com>
	 <97AEC8D598C0694E974EFE59A6CC144002BED071@MCLNEXVS10.resource.ds.bah.com>
	 <9FCDE3E1-9330-4554-B6F0-BD397D53E538@apache.org>
	 <97AEC8D598C0694E974EFE59A6CC144002BED0CC@MCLNEXVS10.resource.ds.bah.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hello Christopher,

I did set it up and I have a version running but the last time I did
set it up is about a year ago.
I did develop this very early alpha version and there are many many
bugs. Unfortunately I don't have the resources
for any further developement at the moment and within the next couple of month.
I started with some major refactorings but could not finish them so
the version in the svn might not be a "running" version.

If you need any further help feel free to post the list or contact me
directly. But please consider this is a very very early alpha version.

- simon

On Nov 16, 2007 4:56 AM, Lyth, Christopher [USA]
<lyth_christopher@bah.com> wrote:
> Well as far as I could tell the config xml files should work out of
> version control. All I have done so far is check out the project and
> tried to build it. The ant files seem to need some attention.
>
> Anyway, I was hoping to find someone that was using it or had ever set
> it up. This project is very interesting to me and my team.
>
> Thanks for the quick response
> Chris
>
> -----Original Message-----
> From: Grant Ingersoll [mailto:gsingers@apache.org]
> Sent: Thursday, November 15, 2007 10:45 PM
> To: java-user@lucene.apache.org
> Subject: Re: Stack Trace - RE: gdata server
>
> Is there a configuration file you have to setup?  Can you give info on
> what commands you ran?  I have never used GData, but this error looks
> like it is trying to configure something and it is not getting the
> class it expects.
>
> -Grant
>
> On Nov 15, 2007, at 7:46 PM, Lyth, Christopher [USA] wrote:
>
> > Nov 15, 2007 7:40:39 PM
> > org.apache.lucene.gdata.server.registry.GDataServerRegistry
> > registerScopeVisitor
> > INFO: Register scope visitor -- class
> > org.apache.lucene.gdata.server.registry.ProvidedServiceConfig
> > Nov 15, 2007 7:40:39 PM org.apache.commons.digester.Digester
> > endElement
> > SEVERE: End event threw exception
> > java.lang.reflect.InvocationTargetException
> >        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
> >        at
> > sun
> > .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> > a:39)
> >        at
> > sun
> > .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> > Impl.java:25)
> >        at java.lang.reflect.Method.invoke(Method.java:585)
> >        at
> > org
> > .apache.commons.beanutils.PropertyUtilsBean.invokeMethod(PropertyUtil
> > sBean.java:1773)
> >        at
> > org
> > .apache.commons.beanutils.PropertyUtilsBean.setSimpleProperty(Propert
> > yUtilsBean.java:1759)
> >        at
> > org
> > .apache.commons.beanutils.PropertyUtilsBean.setNestedProperty(Propert
> > yUtilsBean.java:1648)
> >        at
> > org
> > .apache.commons.beanutils.PropertyUtilsBean.setProperty(PropertyUtils
> > Bean.java:1677)
> >        at
> > org
> > .apache.commons.beanutils.BeanUtilsBean.setProperty(BeanUtilsBean.jav
> > a:1022)
> >        at
> > org.apache.commons.beanutils.BeanUtils.setProperty(BeanUtils.java:313)
> >        at
> > org
> > .apache.commons.digester.BeanPropertySetterRule.end(BeanPropertySette
> > rRule.java:197)
> >        at
> > org.apache.commons.digester.Digester.endElement(Digester.java:1130)
> >        at
> > org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
> >        at
> > org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown
> > Source)
> >        at
> > org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
> > Source)
> >        at
> > org.apache.xerces.impl.XMLDocumentFragmentScannerImpl
> > $FragmentContentDis
> > patcher.dispatch(Unknown Source)
> >        at
> > org
> > .apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unkno
> > wn Source)
> >        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> > Source)
> >        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> > Source)
> >        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
> >        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown
> > Source)
> >        at
> > org.apache.commons.digester.Digester.parse(Digester.java:1666)
> >        at
> > org
> > .apache.lucene.gdata.server.registry.RegistryBuilder.buildFromConfigu
> > ration(RegistryBuilder.java:96)
> >        at
> > org
> > .apache.lucene.gdata.server.registry.RegistryBuilder.buildRegistry(Re
> > gistryBuilder.java:60)
> >        at
> > org
> > .apache.lucene.gdata.server.registry.RegistryContextListener.contextI
> > nitialized(RegistryContextListener.java:60)
> >        at
> > org
> > .apache.catalina.core.StandardContext.listenerStart(StandardContext.j
> > ava:3764)
> >        at
> > org.apache.catalina.core.StandardContext.start(StandardContext.java:
> > 4216
> > )
> >        at
> > org
> > .apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.ja
> > va:760)
> >        at
> > org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:
> > 740)
> >        at
> > org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
> >        at
> > org
> > .apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:
> > 626)
> >        at
> > org
> > .apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java
> > :553)
> >        at
> > org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
> >        at
> > org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
> >        at
> > org
> > .apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:31
> > 1)
> >        at
> > org
> > .apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSu
> > pport.java:120)
> >        at
> > org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
> >        at
> > org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
> >        at
> > org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
> >        at
> > org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
> >        at
> > org.apache.catalina.core.StandardService.start(StandardService.java:
> > 448)
> >        at
> > org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
> >        at org.apache.catalina.startup.Catalina.start(Catalina.java:
> > 552)
> >        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
> >        at
> > sun
> > .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> > a:39)
> >        at
> > sun
> > .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> > Impl.java:25)
> >        at java.lang.reflect.Method.invoke(Method.java:585)
> >        at
> > org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
> >        at
> > org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)
> > Caused by: java.lang.ClassCastException:
> > com.google.gdata.data.ExtensionProfile
> >        at
> > org
> > .apache.lucene.gdata.server.registry.ProvidedServiceConfig.setExtensi
> > onProfileClass(ProvidedServiceConfig.java:188)
> >        ... 49 more
> > Nov 15, 2007 7:40:39 PM
> > org.apache.lucene.gdata.server.registry.RegistryContextListener
> > contextInitialized
> > SEVERE: can not register required components
> > java.lang.ClassCastException: com.google.gdata.data.ExtensionProfile
> >        at
> > org
> > .apache.commons.digester.Digester.createSAXException(Digester.java:29
> > 19)
> >        at
> > org
> > .apache.commons.digester.Digester.createSAXException(Digester.java:29
> > 45)
> >        at
> > org.apache.commons.digester.Digester.endElement(Digester.java:1133)
> >        at
> > org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
> >        at
> > org.apache.xerces.impl.xs.XMLSchemaValidator.endElement(Unknown
> > Source)
> >        at
> > org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
> > Source)
> >        at
> > org.apache.xerces.impl.XMLDocumentFragmentScannerImpl
> > $FragmentContentDis
> > patcher.dispatch(Unknown Source)
> >        at
> > org
> > .apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unkno
> > wn Source)
> >        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> > Source)
> >        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown
> > Source)
> >        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
> >        at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown
> > Source)
> >        at
> > org.apache.commons.digester.Digester.parse(Digester.java:1666)
> >        at
> > org
> > .apache.lucene.gdata.server.registry.RegistryBuilder.buildFromConfigu
> > ration(RegistryBuilder.java:96)
> >        at
> > org
> > .apache.lucene.gdata.server.registry.RegistryBuilder.buildRegistry(Re
> > gistryBuilder.java:60)
> >        at
> > org
> > .apache.lucene.gdata.server.registry.RegistryContextListener.contextI
> > nitialized(RegistryContextListener.java:60)
> >        at
> > org
> > .apache.catalina.core.StandardContext.listenerStart(StandardContext.j
> > ava:3764)
> >        at
> > org.apache.catalina.core.StandardContext.start(StandardContext.java:
> > 4216
> > )
> >        at
> > org
> > .apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.ja
> > va:760)
> >        at
> > org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:
> > 740)
> >        at
> > org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
> >        at
> > org
> > .apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:
> > 626)
> >        at
> > org
> > .apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java
> > :553)
> >        at
> > org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:488)
> >        at
> > org.apache.catalina.startup.HostConfig.start(HostConfig.java:1138)
> >        at
> > org
> > .apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:31
> > 1)
> >        at
> > org
> > .apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSu
> > pport.java:120)
> >        at
> > org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1022)
> >        at
> > org.apache.catalina.core.StandardHost.start(StandardHost.java:736)
> >        at
> > org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1014)
> >        at
> > org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
> >        at
> > org.apache.catalina.core.StandardService.start(StandardService.java:
> > 448)
> >        at
> > org.apache.catalina.core.StandardServer.start(StandardServer.java:700)
> >        at org.apache.catalina.startup.Catalina.start(Catalina.java:
> > 552)
> >        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
> >        at
> > sun
> > .reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.jav
> > a:39)
> >        at
> > sun
> > .reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessor
> > Impl.java:25)
> >        at java.lang.reflect.Method.invoke(Method.java:585)
> >        at
> > org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:295)
> >        at
> > org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:433)
> > Nov 15, 2007 7:40:40 PM org.apache.catalina.core.StandardContext start
> > SEVERE: Error listenerStart
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31049-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 11:00:30 2007
Return-Path: <java-user-return-31049-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58993 invoked from network); 16 Nov 2007 11:00:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 11:00:29 -0000
Received: (qmail 907 invoked by uid 500); 16 Nov 2007 11:00:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 870 invoked by uid 500); 16 Nov 2007 11:00:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 859 invoked by uid 99); 16 Nov 2007 11:00:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 03:00:10 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [82.146.123.134] (HELO villon.taktik.be) (82.146.123.134)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 11:00:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by villon.taktik.be (Postfix) with ESMTP id 4186E39BF7F0
	for <java-user@lucene.apache.org>; Fri, 16 Nov 2007 11:59:51 +0100 (CET)
Received: from villon.taktik.be ([127.0.0.1])
 by localhost (localhost [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
 id 08230-09 for <java-user@lucene.apache.org>;
 Fri, 16 Nov 2007 11:59:43 +0100 (CET)
Received: from [192.168.63.159] (unknown [192.168.63.159])
	by villon.taktik.be (Postfix) with ESMTP id 7375639BF7C1
	for <java-user@lucene.apache.org>; Fri, 16 Nov 2007 11:59:42 +0100 (CET)
Message-Id: <2731AB53-CA85-4FC9-8FFD-F7DB52F86836@taktik.be>
From: Antoine Baudoux <ab@taktik.be>
To: java-user@lucene.apache.org
In-Reply-To: <8837fb770711152244r2113e851v401394276b5e6453@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: realtime indexing
Date: Fri, 16 Nov 2007 11:59:38 +0100
References: <8837fb770711152244r2113e851v401394276b5e6453@mail.gmail.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Scanned: by amavisd-new at taktik.be
X-Virus-Checked: Checked by ClamAV on apache.org

	Hi,

	I'm trying to implement a similar solution.


	Could you be more precise on how you handle duplicates, as well as  
document deletion?


	Thx,


Antoine

On Nov 16, 2007, at 7:44 AM, John Wang wrote:

> Hi:
>
>    It was interesting hearing about the need for real time indexing
> at the BirdsOfAFeather round table. We also needed to solve this
> problem. We took this approach:
>
> A large disk index that indexes in batch, e.g. sleeps for some time
> queue up requests, wakes up and the index.
> While large disk index is sleeping, same requests are also added to a
> ram index, and when disk indexer is working, requests received is
> added to another ram index.
>
> When new disk index is published, the first ram index points to the
> secondary ram index, and the secondary ram index is flushed.
>
> we keep 1 index reader open for the disk index, and create new
> indexReaders for the ram indexes per request (it seems to be ok
> because the ram indexes are small)
>
> We use MultiSearcher across these readers.
>
> duplicates are also handled with our scheme.
>
> I am curious to see if anyone else is trying this. It would be
> interesting to hear comments from the experts.
>
> Thanks
>
> -John
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31050-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 11:43:39 2007
Return-Path: <java-user-return-31050-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66552 invoked from network); 16 Nov 2007 11:43:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 11:43:38 -0000
Received: (qmail 59211 invoked by uid 500); 16 Nov 2007 11:43:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59180 invoked by uid 500); 16 Nov 2007 11:43:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59166 invoked by uid 99); 16 Nov 2007 11:43:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 03:43:19 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of kay.roepke@epublica.de designates 213.238.59.6 as permitted sender)
Received: from [213.238.59.6] (HELO mail-1.epublica.de) (213.238.59.6)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 11:43:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by mail-1.epublica.de (Postfix) with ESMTP id 9E73B300013E
	for <java-user@lucene.apache.org>; Fri, 16 Nov 2007 12:42:56 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at mail-1.epublica.de
Received: from mail-1.epublica.de ([127.0.0.1])
	by localhost (mail-1.rz.epublica.de [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id dsS0mpg8MB5P for <java-user@lucene.apache.org>;
	Fri, 16 Nov 2007 12:42:56 +0100 (CET)
Received: from nr225.intern.epublica.de (nr225.intern.epublica.de [192.168.1.225])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	(Authenticated sender: kay.roepke@epublica.de)
	by mail-1.epublica.de (Postfix) with ESMTP id 6A0CF3000135
	for <java-user@lucene.apache.org>; Fri, 16 Nov 2007 12:42:56 +0100 (CET)
Message-Id: <B6FDE61E-479E-4F32-851F-777C8C6349C3@epublica.de>
From: =?ISO-8859-1?Q?Kay_R=F6pke?= <kay.roepke@epublica.de>
To: java-user@lucene.apache.org
In-Reply-To: <2731AB53-CA85-4FC9-8FFD-F7DB52F86836@taktik.be>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: realtime indexing
Date: Fri, 16 Nov 2007 12:42:59 +0100
References: <8837fb770711152244r2113e851v401394276b5e6453@mail.gmail.com> <2731AB53-CA85-4FC9-8FFD-F7DB52F86836@taktik.be>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org


On Nov 16, 2007, at 11:59 AM, Antoine Baudoux wrote:

> 	I'm trying to implement a similar solution.
>
>
> 	Could you be more precise on how you handle duplicates, as well as  
> document deletion?

The key probably is (it was for us, anyway) that you have a fast way  
of determining whether or not a given document is in an index.
We use (and John et al, too, I suppose) the unique id (!= doc id) each  
document has for that purpose. The basic idea for that should be in  
the archives.

So, back to the question:
By definition anything in the RAM index is newer than anything on  
disk, so documents found in the RAM index should supersede docs from  
disk when they have the same unique id (user id, primary key, whatever).
When you have the hits of the query you can easily determine duplicate  
primary keys, and for those you look up from which index they came (by  
asking an enhanced MultiReader that knows the indices and their doc id  
ranges). The last operation obviously has to be very fast, thus we use  
out custom id => docid mapping mechanism (and I think John is using  
his own, too).

There are probably even more clever ways of doing this, but it should  
give you an idea. :)

cheers,
-k

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31051-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 16 12:06:16 2007
Return-Path: <java-user-return-31051-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71389 invoked from network); 16 Nov 2007 12:06:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 16 Nov 2007 12:06:15 -0000
Received: (qmail 86493 invoked by uid 500); 16 Nov 2007 12:05:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86461 invoked by uid 500); 16 Nov 2007 12:05:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86450 invoked by uid 99); 16 Nov 2007 12:05:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 04:05:57 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 64.233.182.185 as permitted sender)
Received: from [64.233.182.185] (HELO nf-out-0910.google.com) (64.233.182.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 12:05:46 +0000
Received: by nf-out-0910.google.com with SMTP id d3so696535nfc
        for <java-user@lucene.apache.org>; Fri, 16 Nov 2007 04:05:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=GvvBhGy5AhiRPhu5u/FnZfxOpJJlxQEEm2UwOSJCh+o=;
        b=KMU+3xYDrMUSH9XjYI5hvHypvBb3X3dymvHXDQjuPa0KAUfXVjwHjRs1uHNFTm1PLVop15eBJexNMJeJauJm2u66C4Mha+H+Npfl2W3uoEN9KnZ+fG2xZScyqByOuNdMMIP/ajGU5EVWRVhcFSZt9Qmbdui01GA7oxdTIO83hL4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=YEYvTz4w3h9f+AGsVc8jUM0WR13uy2xeOQ0qQ67vySiY+Qc2e+C4U6J7DXC04QwoLuLdtn65ygGZg3HgAda3JS0jyi6VRb4kyHiTnEY9Ucdfk81V94+wtrIG8JNnG5Ri7L54GWWwDNLsk58jczLQkWa/TzeQyb6GXbya5efD0Qo=
Received: by 10.86.4.2 with SMTP id 2mr1736066fgd.1195214738300;
        Fri, 16 Nov 2007 04:05:38 -0800 (PST)
Received: by 10.86.59.11 with HTTP; Fri, 16 Nov 2007 04:05:38 -0800 (PST)
Message-ID: <8837fb770711160405h5056b1e2u4a43f30342af9fea@mail.gmail.com>
Date: Fri, 16 Nov 2007 04:05:38 -0800
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: realtime indexing
In-Reply-To: <2731AB53-CA85-4FC9-8FFD-F7DB52F86836@taktik.be>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <8837fb770711152244r2113e851v401394276b5e6453@mail.gmail.com>
	 <2731AB53-CA85-4FC9-8FFD-F7DB52F86836@taktik.be>
X-Virus-Checked: Checked by ClamAV on apache.org

Thanks Kay.

I am doing exactly what you are saying.

Just to elaborate:

So whatever is submitted to the RAM index is always the latest, any
deletes (an update is a delete + an add) submitted to the any of the
ram indexes is recorded (discarded when the ram index is discarded)
with the uid.

That "delete list" is passed onto the searcher handling the disk
index. In the hitCollector, we do a quickly look up of uid given a
docid and then check to see if that uid is in the deleted list and
discard if it is. (actually in reality, you can have your own searcher
implementation and check before score is called to avoid unnecc
scoring computation if you expect the delete list to be large)

For us, we've implemented a way (by hacking into the lucene guts) to
be able to lookup a uid very fast (amounts to an array lookup). and
then the check is just an integer hash lookup (our uid is an integer)

(I started a thread on the dev list on how to quickly lookup primary
id (uid) given a lucene doc id.)


Hope this helps.

-John

On Nov 16, 2007 2:59 AM, Antoine Baudoux <ab@taktik.be> wrote:
>         Hi,
>
>         I'm trying to implement a similar solution.
>
>
>         Could you be more precise on how you handle duplicates, as well as
> document deletion?
>
>
>         Thx,
>
>
> Antoine
>
>
> On Nov 16, 2007, at 7:44 AM, John Wang wrote:
>
> > Hi:
> >
> >    It was interesting hearing about the need for real time indexing
> > at the BirdsOfAFeather round table. We also needed to solve this
> > problem. We took this approach:
> >
> > A large disk index that indexes in batch, e.g. sleeps for some time
> > queue up requests, wakes up and the index.
> > While large disk index is sleeping, same requests are also added to a
> > ram index, and when disk indexer is working, requests received is
> > added to another ram index.
> >
> > When new disk index is published, the first ram index points to the
> > secondary ram index, and the secondary ram index is flushed.
> >
> > we keep 1 index reader open for the disk index, and create new
> > indexReaders for the ram indexes per request (it seems to be ok
> > because the ram indexes are small)
> >
> > We use MultiSearcher across these readers.
> >
> > duplicates are also handled with our scheme.
> >
> > I am curious to see if anyone else is trying this. It would be
> > interesting to hear comments from the experts.
> >
> > Thanks
> >
> > -John
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31052-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 17 03:37:56 2007
Return-Path: <java-user-return-31052-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24110 invoked from network); 17 Nov 2007 03:37:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 Nov 2007 03:37:56 -0000
Received: (qmail 1626 invoked by uid 500); 17 Nov 2007 03:37:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1586 invoked by uid 500); 17 Nov 2007 03:37:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1575 invoked by uid 99); 17 Nov 2007 03:37:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 19:37:37 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of pgwillia@uwaterloo.ca designates 129.97.152.18 as permitted sender)
Received: from [129.97.152.18] (HELO services10.student.cs.uwaterloo.ca) (129.97.152.18)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 03:37:27 +0000
Received: from [192.168.1.111] (d66-222-166-22.abhsia.telus.net [66.222.166.22])
	(authenticated bits=0)
	by services10.student.cs.uwaterloo.ca (8.13.8/8.13.8) with ESMTP id lAH3bFuT023424
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Fri, 16 Nov 2007 22:37:19 -0500 (EST)
Message-ID: <473E61EB.8030502@uwaterloo.ca>
Date: Fri, 16 Nov 2007 20:37:15 -0700
From: Tricia Williams <pgwillia@uwaterloo.ca>
User-Agent: Thunderbird 2.0.0.6 (X11/20071022)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Payloads, Tokenizers, and Filters.  Oh My!
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Greylist: Sender succeeded SMTP AUTH authentication, not delayed by milter-greylist-3.0 (services10.student.cs.uwaterloo.ca [129.97.152.13]); Fri, 16 Nov 2007 22:37:20 -0500 (EST)
X-Miltered: at mailchk-m02 with ID 473E61EB.002 by Joe's j-chkmail (http://j-chkmail.ensmp.fr)!
X-Virus-Scanned: ClamAV version 0.91.2, clamav-milter version 0.91.2 on localhost
X-Virus-Status: Clean
X-UUID: 82808b0c-4d46-4301-a9f9-887f44c14cd2
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

   I'll explain what I'm working on, and then I'll ask my two questions.

   I'm working on the issue 
https://issues.apache.org/jira/browse/SOLR-380 which is a feature 
request that allows one to index a "Structured Document" which is 
anything that can be represented by XML in order to provide more context 
to hits in the result set.  This allows us to do things like query the 
index for "Canada" and be able to not only say that that query matched a 
document titled "Some Nonsense" but also that the query term appeared on 
page 7 of chapter 1.  We can then take this one step further and 
markup/highlight the image of this page based on our OCR and position hit.
For example:

<book title='Some Nonsense'><chapter title='One'><page name='1'>Some 
text from page one of a book.</page><page name='7'>Some more text from 
page seven of a book. Oh and I'm from Canada.</page></chapter></book>

   I accomplished this by creating a custom Tokenizer which strips the 
xml elements and stores them as a Payload at each of the Tokens created 
from the character data in the input.  The payload is the string that 
describes the XPath at that location.  So for <Canada> the payload is 
"/book[title='Some Nonsense']/chapter[title='One']/page[name='7']"

   The other part of this work is the SolrHighlighter which is less 
important to this list.  I retrieve the TermPositions for the Query's 
Terms and use the TermPosition functionality to get back the payload for 
the hits and build output which shows hit positions categorized by the 
payload they are associated with.

QUESTION 1:  Applying TokenFilters to my Tokenizer creates some strange 
(in my opinion) behavior.  First of all the TermPositions change and 
second the Payload is removed.  Is this the expected behavior, or is 
this a bug?  With the Payload being an "experimental feature" I can 
understand if this persistence just hasn't been implemented yet.  But is 
it, or will it be?

In the following example I will denote a token by {pos,<term 
text>,<payload>}:

input: <class name='mammalia'>Dog, and Cat</class>

XmlPayloadTokenizer:
{1,<Dog,>,</class[name='mammalia'][startPos='0']>},{2,<and>,</class[name='mammalia'][startPos='0']>},{3,<Cat>,</class[name='mammalia'][startPos='0']>} 

StopFilter:
{1,<Dog,>,</class[name='mammalia'][startPos='0']>},{2,<Cat>,</class[name='mammalia'][startPos='0']>} 

WordDelimiterFilter:
{1,<Dog>,<>} {2,<Cat>,</class[name='mammalia'][startPos='0']>}
LowerCaseFilter:
{1,<dog>,<>} {2,<cat>,</class[name='mammalia'][startPos='0']>}


QUESTION 2:  As I explained I'm storing the String representing the 
XPath of the token as the Payload (well the ByteArray of the String) of 
each token.   Is there a more efficient way to do this?  Is this 
exploiting Payload functionality and will it turn around and bite me 
when I get to indexing hundreds of thousands of documents?  Perhaps I 
shouldn't be relying on the Payload functionality before it is deemed 
not experimental?

I feel these questions are both related to Lucene proper rather than 
Solr, which is why I've posted here.  If you think solr-user is a better 
place to post my questions let me know.

Thanks for your input!
Tricia


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31053-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 17 05:25:54 2007
Return-Path: <java-user-return-31053-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38399 invoked from network); 17 Nov 2007 05:25:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 Nov 2007 05:25:54 -0000
Received: (qmail 44051 invoked by uid 500); 17 Nov 2007 05:25:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44011 invoked by uid 500); 17 Nov 2007 05:25:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44000 invoked by uid 99); 17 Nov 2007 05:25:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Nov 2007 21:25:35 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [202.112.26.52] (HELO mx2.sjtu.edu.cn) (202.112.26.52)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 05:25:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by mx2.sjtu.edu.cn (Postfix) with ESMTP id 8ED661039C
	for <java-user@lucene.apache.org>; Sat, 17 Nov 2007 13:25:14 +0800 (CST)
X-Virus-Scanned: Debian amavisd-new at mx2.sjtu.edu.cn
Received: from mx2.sjtu.edu.cn ([127.0.0.1])
	by localhost (mx2.sjtu.edu.cn [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id T4slbNG6YRo5 for <java-user@lucene.apache.org>;
	Sat, 17 Nov 2007 13:25:14 +0800 (CST)
Received: from nb (unknown [218.82.124.34])
	(Authenticated sender: zhou_qi)
	by mx2.sjtu.edu.cn (Postfix) with ESMTP id EF35A10218
	for <java-user@lucene.apache.org>; Sat, 17 Nov 2007 13:25:13 +0800 (CST)
From: "Zhou Qi" <zhou_qi@sjtu.edu.cn>
To: <java-user@lucene.apache.org>
References: <000c01c8273e$00e7dc70$02b79550$@edu.cn>	 <99dfded80711142222u30616dp6ef9282e047da98e@mail.gmail.com>	 <000d01c8279b$8bf4f5c0$a3dee140$@edu.cn> <8837fb770711150703j6ec4c578qe829f74e5c61321b@mail.gmail.com> <473C9108.2080504@gmail.com>
In-Reply-To: <473C9108.2080504@gmail.com>
Subject: =?utf-8?Q?=E7=AD=94=E5=A4=8D:_=E7=AD=94=E5=A4=8D:_how_to_effeciently_imple?=
	=?utf-8?Q?ment_the_stastical_scores_like_p?=
	=?utf-8?Q?agerank=3F?=
Date: Sat, 17 Nov 2007 13:24:46 +0800
Message-ID: <001001c828da$31516aa0$93f43fe0$@edu.cn>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcgntqQOfNIRO9/UR6iUpx0sIZyPKABI3Gbw
Content-Language: zh-cn
X-Virus-Checked: Checked by ClamAV on apache.org

It works. John and Michael Thank you very much.

Best Regards,

Zhou Qi=20
Dept. Computer Science & Engineering
Shanghai Jiaotong University
=20

-----=E9=82=AE=E4=BB=B6=E5=8E=9F=E4=BB=B6-----
=E5=8F=91=E4=BB=B6=E4=BA=BA: Michael Busch [mailto:buschmic@gmail.com]=20
=E5=8F=91=E9=80=81=E6=97=B6=E9=97=B4: =
2007=E5=B9=B411=E6=9C=8816=E6=97=A5 2:34
=E6=94=B6=E4=BB=B6=E4=BA=BA: java-user@lucene.apache.org
=E4=B8=BB=E9=A2=98: Re: =E7=AD=94=E5=A4=8D: how to effeciently implement =
the stastical scores like pagerank?

John Wang wrote:
> Would payload work?
> -John
>
>  =20
Yes, if you used payloads instead of stored fields your performance
should be much better.

Try and index one special term per document (e. g. score:pagerank), and
index one position with a payload for each doc. Then when you retrieve
hits open a TermPositions using the special term, get the payload and
incorporate it in the docs' score.

The performance overhead should be comparable to adding one AND-term to
your query.

-Michael

> On 11/15/07, Zhou Qi <zhou_qi@sjtu.edu.cn> wrote:
>  =20
>> Thank you, my score is fixed score from the properties of the page, =
but at
>> first we need to adjust the score for a promising result.
>> I have tried one way of manually re-ranking all the documents by the
>> search results. But it needs to iterate all the retrieved results and =
fetch
>> the re-ranking score (stored in the index) to sum the overall score. =
It is
>> inefficient. How to improve that by a new approach?
>>
>> Sorry for making you misunderstanding. Thanks
>>
>> Best Regards,
>>
>> Zhou Qi
>> Dept. Computer Science & Engineering
>> Shanghai Jiaotong University
>>
>>    =20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31054-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 17 06:51:35 2007
Return-Path: <java-user-return-31054-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54460 invoked from network); 17 Nov 2007 06:51:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 Nov 2007 06:51:35 -0000
Received: (qmail 78830 invoked by uid 500); 17 Nov 2007 06:51:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78809 invoked by uid 500); 17 Nov 2007 06:51:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Delivered-To: moderator for java-user@lucene.apache.org
Received: (qmail 42519 invoked by uid 99); 16 Nov 2007 23:04:19 -0000
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of pgwillia@uwaterloo.ca designates 129.97.152.18 as permitted sender)
Message-ID: <473E21AC.5000702@uwaterloo.ca>
Date: Fri, 16 Nov 2007 16:03:08 -0700
From: Tricia Williams <pgwillia@uwaterloo.ca>
User-Agent: Thunderbird 2.0.0.6 (X11/20071022)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Payloads, Tokenizers, and Filters.  Oh My!
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Greylist: Sender succeeded SMTP AUTH authentication, not delayed by milter-greylist-3.0 (services10.student.cs.uwaterloo.ca [129.97.152.13]); Fri, 16 Nov 2007 18:03:12 -0500 (EST)
X-Miltered: at mailchk-w03 with ID 473E21AC.000 by Joe's j-chkmail (http://j-chkmail.ensmp.fr)!
X-Virus-Scanned: ClamAV version 0.91.2, clamav-milter version 0.91.2 on localhost
X-Virus-Status: Clean
X-UUID: 7d4fda07-2bce-4509-85f8-33dd24054994
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

    I'll explain what I'm working on, and then I'll ask my two questions.

    I'm working on the issue 
https://issues.apache.org/jira/browse/SOLR-380 which is a feature 
request that allows one to index a "Structured Document" which is 
anything that can be represented by XML in order to provide more context 
to hits in the result set.  This allows us to do things like query the 
index for "Canada" and be able to not only say that that query matched a 
document titled "Some Nonsense" but also that the query term appeared on 
page 7 of chapter 1.  We can then take this one step further and 
markup/highlight the image of this page based on our OCR and position hit. 

For example:

<book title='Some Nonsense'><chapter title='One'><page name='1'>Some 
text from page one of a book.</page><page name='7'>Some more text from 
page seven of a book. Oh and I'm from Canada.</page></chapter></book>

    I accomplished this by creating a custom Tokenizer which strips the 
xml elements and stores them as a Payload at each of the Tokens created 
from the character data in the input.  The payload is the string that 
describes the XPath at that location.  So for <Canada> the payload is 
"/book[title='Some Nonsense']/chapter[title='One']/page[name='7']"

    The other part of this work is the SolrHighlighter which is less 
important to this list.  I retrieve the TermPositions for the Query's 
Terms and use the TermPosition functionality to get back the payload for 
the hits and build output which shows hit positions categorized by the 
payload they are associated with.

QUESTION 1:  Applying TokenFilters to my Tokenizer creates some strange 
(in my opinion) behavior.  First of all the TermPositions change and 
second the Payload is removed.  Is this the expected behavior, or is 
this a bug?  With the Payload being an "experimental feature" I can 
understand if this persistence just hasn't been implemented yet.  But is 
it, or will it be?

In the following example I will denote a token by {pos,<term 
text>,<payload>}:

input: <class name='mammalia'>Dog, and Cat</class>

XmlPayloadTokenizer:
{1,<Dog,>,</class[name='mammalia'][startPos='0']>},{2,<and>,</class[name='mammalia'][startPos='0']>},{3,<Cat>,</class[name='mammalia'][startPos='0']>}
StopFilter:
{1,<Dog,>,</class[name='mammalia'][startPos='0']>},{2,<Cat>,</class[name='mammalia'][startPos='0']>}
WordDelimiterFilter:
{1,<Dog>,<>} {2,<Cat>,</class[name='mammalia'][startPos='0']>}
LowerCaseFilter:
{1,<dog>,<>} {2,<cat>,</class[name='mammalia'][startPos='0']>}


QUESTION 2:  As I explained I'm storing the String representing the 
XPath of the token as the Payload (well the ByteArray of the String) of 
each token.   Is there a more efficient way to do this?  Is this 
exploiting Payload functionality and will it turn around and bite me 
when I get to indexing hundreds of thousands of documents?  Perhaps I 
shouldn't be relying on the Payload functionality before it is deemed 
not experimental?

I feel these questions are both related to Lucene proper rather than 
Solr, which is why I've posted here.  If you think solr-user is a better 
place to post my questions let me know.

Thanks for your input!
Tricia

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31055-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 17 12:42:21 2007
Return-Path: <java-user-return-31055-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47360 invoked from network); 17 Nov 2007 12:42:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 Nov 2007 12:42:21 -0000
Received: (qmail 23987 invoked by uid 500); 17 Nov 2007 12:42:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23953 invoked by uid 500); 17 Nov 2007 12:42:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23942 invoked by uid 99); 17 Nov 2007 12:42:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 04:42:02 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a4.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 12:41:51 +0000
Received: from [10.0.1.2] (1023chost55.starwoodbroadband.com [12.37.185.55])
	by spunkymail-a4.g.dreamhost.com (Postfix) with ESMTP id 699CC3B9D2
	for <java-user@lucene.apache.org>; Sat, 17 Nov 2007 04:41:41 -0800 (PST)
Message-Id: <70CC07CE-5F57-4884-8E23-35F541FCE1CD@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <473E21AC.5000702@uwaterloo.ca>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: Payloads, Tokenizers, and Filters.  Oh My!
Date: Sat, 17 Nov 2007 07:41:20 -0500
References: <473E21AC.5000702@uwaterloo.ca>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

Inline below

On Nov 16, 2007, at 6:03 PM, Tricia Williams wrote:

> Hi All,
>
>   I'll explain what I'm working on, and then I'll ask my two  
> questions.
>
>   I'm working on the issue https://issues.apache.org/jira/browse/SOLR-380 
>  which is a feature request that allows one to index a "Structured  
> Document" which is anything that can be represented by XML in order  
> to provide more context to hits in the result set.  This allows us  
> to do things like query the index for "Canada" and be able to not  
> only say that that query matched a document titled "Some Nonsense"  
> but also that the query term appeared on page 7 of chapter 1.  We  
> can then take this one step further and markup/highlight the image  
> of this page based on our OCR and position hit.
> For example:
>
> <book title='Some Nonsense'><chapter title='One'><page name='1'>Some  
> text from page one of a book.</page><page name='7'>Some more text  
> from page seven of a book. Oh and I'm from Canada.</page></chapter></ 
> book>
>
>   I accomplished this by creating a custom Tokenizer which strips  
> the xml elements and stores them as a Payload at each of the Tokens  
> created from the character data in the input.  The payload is the  
> string that describes the XPath at that location.  So for <Canada>  
> the payload is "/book[title='Some Nonsense']/chapter[title='One']/ 
> page[name='7']"
>
>   The other part of this work is the SolrHighlighter which is less  
> important to this list.  I retrieve the TermPositions for the  
> Query's Terms and use the TermPosition functionality to get back the  
> payload for the hits and build output which shows hit positions  
> categorized by the payload they are associated with.
>
> QUESTION 1:  Applying TokenFilters to my Tokenizer creates some  
> strange (in my opinion) behavior.  First of all the TermPositions  
> change and second the Payload is removed.  Is this the expected  
> behavior, or is this a bug?  With the Payload being an "experimental  
> feature" I can understand if this persistence just hasn't been  
> implemented yet.  But is it, or will it be?
>

Do you have other TokenFilters in your Analyzer?  Are you reusing the  
same Token or creating a new one in your TokenFilters?  If creating a  
new one, you will have to set the payload as it won't be copied down.   
Perhaps we should add a constructor that takes a payload.  On the  
other hand, I think we are going to remove the Payload object in favor  
of just using the byte array.


> In the following example I will denote a token by {pos,<term  
> text>,<payload>}:
>
> input: <class name='mammalia'>Dog, and Cat</class>
>
> XmlPayloadTokenizer:
> {1,<Dog,>,</class[name='mammalia'][startPos='0']>},{2,<and>,</ 
> class[name='mammalia'][startPos='0']>},{3,<Cat>,</ 
> class[name='mammalia'][startPos='0']>}
> StopFilter:
> {1,<Dog,>,</class[name='mammalia'][startPos='0']>},{2,<Cat>,</ 
> class[name='mammalia'][startPos='0']>}
> WordDelimiterFilter:
> {1,<Dog>,<>} {2,<Cat>,</class[name='mammalia'][startPos='0']>}
> LowerCaseFilter:
> {1,<dog>,<>} {2,<cat>,</class[name='mammalia'][startPos='0']>}
>
>
> QUESTION 2:  As I explained I'm storing the String representing the  
> XPath of the token as the Payload (well the ByteArray of the String)  
> of each token.   Is there a more efficient way to do this?  Is this  
> exploiting Payload functionality and will it turn around and bite me  
> when I get to indexing hundreds of thousands of documents?  Perhaps  
> I shouldn't be relying on the Payload functionality before it is  
> deemed not experimental?
>

I think this is reasonable.  Micheal Busch had a nice talk at  
ApacheCon on payloads that you can find at http://people.apache.org/~buschmi/apachecon/AdvancedIndexingLuceneAtlanta07.ppt

I guess you just want to be careful about how big your payloads get.

One of the original use cases for payloads was for doing XPath queries.

Also, the only thing experimental about Payloads is the actual  
signature of the methods, not the need for them.  If anything, I think  
you will see an expansion of payload capability in the future.  Also  
note, that you will probably be interested in adding more Payload  
querying capability.  And also note, I am in the process of adding the  
ability to get payloads from Spans, but I am not sure if this gets  
into 2.3 or not.

Cheers,
Grant

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31056-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 17 12:46:46 2007
Return-Path: <java-user-return-31056-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47871 invoked from network); 17 Nov 2007 12:46:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 Nov 2007 12:46:46 -0000
Received: (qmail 27844 invoked by uid 500); 17 Nov 2007 12:46:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27806 invoked by uid 500); 17 Nov 2007 12:46:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27795 invoked by uid 99); 17 Nov 2007 12:46:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 04:46:27 -0800
X-ASF-Spam-Status: No, hits=2.1 required=10.0
	tests=SPF_PASS,TVD_PH_SUBJ_URGENT
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [124.30.170.13] (HELO hydmail1.satyam.com) (124.30.170.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 12:46:15 +0000
Received: from hyd.satyam.com (hyd.satyam.com [204.252.161.226])
	by hydmail1.satyam.com (8.13.4/8.13.4) with ESMTP id lAHCQHfi030251
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Sat, 17 Nov 2007 17:56:17 +0530
Received: from Disclaimerhyd.corp.satyam.ad (hhtbh.satyam.com [172.16.186.212])
	by hyd.satyam.com (8.13.1/8.13.1) with ESMTP id lAHCj9Pv003014
	for <java-user@lucene.apache.org>; Sat, 17 Nov 2007 18:15:09 +0530
Received: from hstmsg005.corp.satyam.ad ([172.16.186.216]) by Disclaimerhyd.corp.satyam.ad with Microsoft SMTPSVC(6.0.3790.211); Sat, 17 Nov 2007 18:16:12 +0530
Content-class: urn:content-classes:message
Subject: urgent
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Priority: normal
Importance: normal
Content-Transfer-Encoding: quoted-printable
Date: Sat, 17 Nov 2007 18:16:12 +0530
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.607
Message-ID: <9312093579B72048B1E5659DC3EC7F39022E9300@hstmsg005.corp.satyam.ad>
In-Reply-To: <70CC07CE-5F57-4884-8E23-35F541FCE1CD@apache.org>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: urgent
Thread-Index: AcgpF1DPizkVu5XYSheVz9eR2Fo+ZgAAVCow
From: "Shakti_Sareen" <Shakti_Sareen@satyam.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 17 Nov 2007 12:46:12.0346 (UTC) FILETIME=[D5874DA0:01C82917]
X-Virus-Scanned: ClamAV version 0.88.4, clamav-milter version 0.88.4 on hyd.satyam.com
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Hi=20

=20

I am facing problem in searching the word containing forward slash (/).

My index file contains more then one documents.=20

On searching for the word "U/S" in the claims field I am getting hits.

But the word "U/S" is actually not there in the document.

=20

Below is the code I am using for searching.

Analyzer analyzer =3D null;

                                analyzer =3D new StandardAnalyzer();

                                IndexSearcher searcher =3D new
IndexSearcher(fIndexFolder.getAbsolutePath());

                                QueryParser parser =3D new
QueryParser("Claim",analyzer);

                                Query query =3D parser.parse("U/S");


                                Hits hits =3D searcher.search(query);

                                LOGGER.info("Hits of word U/S in claims
::::::::  " + hits.length());

                                for (int i =3D 0; i < hits.length(); =
i++)
{

                                                docum =3D hits.doc(i);

                                                LOGGER.info("file NUMBER
>>>>   " + docum.get("PatentNumber"));

                                }

=20

Regards
SHAKTI SAREEN


DISCLAIMER:
This email (including any attachments) is intended for the sole use of =
the intended recipient/s and may contain material that is CONFIDENTIAL =
AND PRIVATE COMPANY INFORMATION. Any review or reliance by others or =
copying or distribution or forwarding of any or all of the contents in =
this message is STRICTLY PROHIBITED. If you are not the intended =
recipient, please contact the sender by email and delete all copies; =
your cooperation in this regard is appreciated.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31057-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 17 12:59:44 2007
Return-Path: <java-user-return-31057-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49549 invoked from network); 17 Nov 2007 12:59:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 Nov 2007 12:59:44 -0000
Received: (qmail 33921 invoked by uid 500); 17 Nov 2007 12:59:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33883 invoked by uid 500); 17 Nov 2007 12:59:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33872 invoked by uid 99); 17 Nov 2007 12:59:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 04:59:26 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.81] (HELO spunkymail-a12.g.dreamhost.com) (208.97.132.81)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 12:59:13 +0000
Received: from [10.0.1.2] (1023chost55.starwoodbroadband.com [12.37.185.55])
	by spunkymail-a12.g.dreamhost.com (Postfix) with ESMTP id DC6767FAB
	for <java-user@lucene.apache.org>; Sat, 17 Nov 2007 04:59:01 -0800 (PST)
Message-Id: <87D650B6-3D7F-4A45-A354-0F9451FF0165@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E9300@hstmsg005.corp.satyam.ad>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v912)
Subject: Re: urgent
Date: Sat, 17 Nov 2007 07:58:38 -0500
References: <9312093579B72048B1E5659DC3EC7F39022E9300@hstmsg005.corp.satyam.ad>
X-Mailer: Apple Mail (2.912)
X-Virus-Checked: Checked by ClamAV on apache.org

http://wiki.apache.org/lucene-java/LuceneFAQ#head-3558e5121806fb4fce80fc022d889484a9248b71

Have a look at what the StandardTokenizer is doing (inside the  
StandardAnalyzer).


On Nov 17, 2007, at 7:46 AM, Shakti_Sareen wrote:

> Hi
>
>
>
> I am facing problem in searching the word containing forward slash  
> (/).
>
> My index file contains more then one documents.
>
> On searching for the word "U/S" in the claims field I am getting hits.
>
> But the word "U/S" is actually not there in the document.
>
>
>
> Below is the code I am using for searching.
>
> Analyzer analyzer = null;
>
>                                analyzer = new StandardAnalyzer();
>
>                                IndexSearcher searcher = new
> IndexSearcher(fIndexFolder.getAbsolutePath());
>
>                                QueryParser parser = new
> QueryParser("Claim",analyzer);
>
>                                Query query = parser.parse("U/S");
>
>
>                                Hits hits = searcher.search(query);
>
>                                LOGGER.info("Hits of word U/S in claims
> ::::::::  " + hits.length());
>
>                                for (int i = 0; i < hits.length(); i++)
> {
>
>                                                docum = hits.doc(i);
>
>                                                LOGGER.info("file  
> NUMBER
>>>>>  " + docum.get("PatentNumber"));
>
>                                }
>
>
>
> Regards
> SHAKTI SAREEN
>
>
> DISCLAIMER:
> This email (including any attachments) is intended for the sole use  
> of the intended recipient/s and may contain material that is  
> CONFIDENTIAL AND PRIVATE COMPANY INFORMATION. Any review or reliance  
> by others or copying or distribution or forwarding of any or all of  
> the contents in this message is STRICTLY PROHIBITED. If you are not  
> the intended recipient, please contact the sender by email and  
> delete all copies; your cooperation in this regard is appreciated.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31058-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 17 15:39:25 2007
Return-Path: <java-user-return-31058-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69586 invoked from network); 17 Nov 2007 15:39:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 Nov 2007 15:39:25 -0000
Received: (qmail 9543 invoked by uid 500); 17 Nov 2007 15:39:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9504 invoked by uid 500); 17 Nov 2007 15:39:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9493 invoked by uid 99); 17 Nov 2007 15:39:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 07:39:07 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 72.14.214.225 as permitted sender)
Received: from [72.14.214.225] (HELO hu-out-0506.google.com) (72.14.214.225)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 15:38:55 +0000
Received: by hu-out-0506.google.com with SMTP id 27so500643hub
        for <java-user@lucene.apache.org>; Sat, 17 Nov 2007 07:38:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=bPBvRLMq8KaZMtWKOmzXzW5+jBJXI9VP1lUGqPaC8M8=;
        b=gVloUO0/TKD7tkfRKjkwFrE50cG4iy/cAWdxzIkfHur7GX1VIZWSjzrgLIeWjiIuX/EvVeKHxX8g8Fqe62F0aKC9dZ7UVuUj/Y6F/7MZeL8tnBblaviu0I/sTriZwDEN3FKd8GA5lZn57kN9zCxV6uXukRJTs6K0JE0xuenltF4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=fzW79Z+oSHB8NQ0Ik2kSrrA8tpyZEMQskDq4q+IqX094fL8U6G9VxPJoIJBCzODY+6gQvFAv3tZtTbKeMo0oy0aE7XIJ+URenaL05pkacamvNXY9f5xVZlu7IHOMbDeAsbZuwAVZBIT6sBoc36FMgNrzA04r6m2jNwnWECl/l3w=
Received: by 10.86.58.3 with SMTP id g3mr2960797fga.1195313927470;
        Sat, 17 Nov 2007 07:38:47 -0800 (PST)
Received: by 10.86.59.11 with HTTP; Sat, 17 Nov 2007 07:38:47 -0800 (PST)
Message-ID: <8837fb770711170738g50c0e0a6g918fbc35410bc72f@mail.gmail.com>
Date: Sat, 17 Nov 2007 07:38:47 -0800
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: urgent
In-Reply-To: <87D650B6-3D7F-4A45-A354-0F9451FF0165@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <9312093579B72048B1E5659DC3EC7F39022E9300@hstmsg005.corp.satyam.ad>
	 <87D650B6-3D7F-4A45-A354-0F9451FF0165@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

I think "U/S" is tokenized to 'U' and 'S'.

Sicne the query parser is using the same analyzer/tokenizer, the
search for "U/S" is actually the same as the phrase query: "U S".
Which explains why it is a hit but not in the index.

-John

On Nov 17, 2007 4:58 AM, Grant Ingersoll <gsingers@apache.org> wrote:
> http://wiki.apache.org/lucene-java/LuceneFAQ#head-3558e5121806fb4fce80fc022d889484a9248b71
>
> Have a look at what the StandardTokenizer is doing (inside the
> StandardAnalyzer).
>
>
>
> On Nov 17, 2007, at 7:46 AM, Shakti_Sareen wrote:
>
> > Hi
> >
> >
> >
> > I am facing problem in searching the word containing forward slash
> > (/).
> >
> > My index file contains more then one documents.
> >
> > On searching for the word "U/S" in the claims field I am getting hits.
> >
> > But the word "U/S" is actually not there in the document.
> >
> >
> >
> > Below is the code I am using for searching.
> >
> > Analyzer analyzer = null;
> >
> >                                analyzer = new StandardAnalyzer();
> >
> >                                IndexSearcher searcher = new
> > IndexSearcher(fIndexFolder.getAbsolutePath());
> >
> >                                QueryParser parser = new
> > QueryParser("Claim",analyzer);
> >
> >                                Query query = parser.parse("U/S");
> >
> >
> >                                Hits hits = searcher.search(query);
> >
> >                                LOGGER.info("Hits of word U/S in claims
> > ::::::::  " + hits.length());
> >
> >                                for (int i = 0; i < hits.length(); i++)
> > {
> >
> >                                                docum = hits.doc(i);
> >
> >                                                LOGGER.info("file
> > NUMBER
> >>>>>  " + docum.get("PatentNumber"));
> >
> >                                }
> >
> >
> >
> > Regards
> > SHAKTI SAREEN
> >
> >
> > DISCLAIMER:
> > This email (including any attachments) is intended for the sole use
> > of the intended recipient/s and may contain material that is
> > CONFIDENTIAL AND PRIVATE COMPANY INFORMATION. Any review or reliance
> > by others or copying or distribution or forwarding of any or all of
> > the contents in this message is STRICTLY PROHIBITED. If you are not
> > the intended recipient, please contact the sender by email and
> > delete all copies; your cooperation in this regard is appreciated.
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31059-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 17 19:00:43 2007
Return-Path: <java-user-return-31059-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3046 invoked from network); 17 Nov 2007 19:00:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 17 Nov 2007 19:00:43 -0000
Received: (qmail 97927 invoked by uid 500); 17 Nov 2007 19:00:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97888 invoked by uid 500); 17 Nov 2007 19:00:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97877 invoked by uid 99); 17 Nov 2007 19:00:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 11:00:24 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of pgwillia@uwaterloo.ca designates 129.97.152.18 as permitted sender)
Received: from [129.97.152.18] (HELO services10.student.cs.uwaterloo.ca) (129.97.152.18)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Nov 2007 19:00:14 +0000
Received: from [192.168.1.111] (d66-222-166-22.abhsia.telus.net [66.222.166.22])
	(authenticated bits=0)
	by services10.student.cs.uwaterloo.ca (8.13.8/8.13.8) with ESMTP id lAHJ02eV010928
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Sat, 17 Nov 2007 14:00:06 -0500 (EST)
Message-ID: <473F3A32.9000202@uwaterloo.ca>
Date: Sat, 17 Nov 2007 12:00:02 -0700
From: Tricia Williams <pgwillia@uwaterloo.ca>
User-Agent: Thunderbird 2.0.0.6 (X11/20071022)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Payloads, Tokenizers, and Filters.  Oh My!
References: <473E21AC.5000702@uwaterloo.ca> <70CC07CE-5F57-4884-8E23-35F541FCE1CD@apache.org>
In-Reply-To: <70CC07CE-5F57-4884-8E23-35F541FCE1CD@apache.org>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Greylist: Sender succeeded SMTP AUTH authentication, not delayed by milter-greylist-3.0 (services10.student.cs.uwaterloo.ca [129.97.152.13]); Sat, 17 Nov 2007 14:00:06 -0500 (EST)
X-Miltered: at minos with ID 473F3A32.000 by Joe's j-chkmail (http://j-chkmail.ensmp.fr)!
X-Virus-Scanned: ClamAV version 0.91.2, clamav-milter version 0.91.2 on localhost
X-Virus-Status: Clean
X-UUID: 4e808723-082c-45ef-9b21-007ab4e1917f
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Grant,

    Thanks for your response!

    Taking a closer look at the TokenFilter(s) that causes my problem 
with the Payload are all from org.apache.solr.analysis rather than 
org.apache.lucene.analysis.  I had originally thought that all the 
TokenFilters available through Solr's TokenFilterFactory(s) were part of 
Lucene.  But I guess there are TokenFilters specific to Solr, such as 
the WordDelimiterFilter, that aren't aware of Payloads.  Thanks for 
saying exactly the right thing to make me realize that.
> I guess you just want to be careful about how big your payloads get.
    Erik Hatcher suggested storing the bulky XPath strings in a table of 
contents field and just storing a smaller representation of the 
information at each token with the intention of doing a lookup to get 
the bulky stuff at query time. 
>
> One of the original use cases for payloads was for doing XPath queries.
>
    Has anyone actually completed anything with XPath queries and Payloads?
> Also, the only thing experimental about Payloads is the actual 
> signature of the methods, not the need for them.  If anything, I think 
> you will see an expansion of payload capability in the future.  Also 
> note, that you will probably be interested in adding more Payload 
> querying capability.  And also note, I am in the process of adding the 
> ability to get payloads from Spans, but I am not sure if this gets 
> into 2.3 or not.
>
    I look forward to seeing more of Payloads!  I can already see how 
they can be extremely useful.

Thanks,
Tricia

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31060-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 15:23:14 2007
Return-Path: <java-user-return-31060-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57006 invoked from network); 18 Nov 2007 15:23:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 15:23:14 -0000
Received: (qmail 36320 invoked by uid 500); 18 Nov 2007 15:22:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36293 invoked by uid 500); 18 Nov 2007 15:22:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36282 invoked by uid 99); 18 Nov 2007 15:22:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 07:22:55 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [88.198.15.21] (HELO mountproc.org) (88.198.15.21)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 15:22:45 +0000
Received: from lothar by mountproc.org with local (Exim 4.50)
	id 1ItlsC-0004F6-Qs
	for java-user@lucene.apache.org; Sun, 18 Nov 2007 16:15:48 +0100
Date: Sun, 18 Nov 2007 16:15:48 +0100
To: java-user@lucene.apache.org
Subject: Estimate index filesystem requirements
Message-ID: <20071118151548.GA16222@digitalarbeiter.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.9i
From: Lothar Maerkle <lothar@mountproc.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I'm wondering if there is a kind of "formule" to estimate the size of a
lucene index. Searching the list, I did not find any pointers.

Does anybody has a hint?

What I figured out from the file format description and some empirical
tests is, that for every index-file:
Field-files:
  field-data .fdt:  NumberOfDocs * NumberOfFieldsPerDoc
  field-index .fdx: NumberOfDocs * 8
  field-info .fnm:  ignored

Term-Files:
  term-data .tis:   NumberOfTerms * 8
  term-index .tii:  no idea so far
  term-freq: .frq:  estimated as NumberOfDocs * NumberOfTerms
Normalization:
  Norm file: .nrm:  NumberOfDocs

This concerns only Un-stored fields of course.

I estimate the total NumberOfTerms of my document collection with 10% of
the NumberOfDocuments. Does someone has similiar experience?

lofi


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31061-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 17:09:40 2007
Return-Path: <java-user-return-31061-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 72115 invoked from network); 18 Nov 2007 17:09:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 17:09:40 -0000
Received: (qmail 90401 invoked by uid 500); 18 Nov 2007 17:09:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90366 invoked by uid 500); 18 Nov 2007 17:09:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90354 invoked by uid 99); 18 Nov 2007 17:09:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 09:09:21 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aleboo@gmail.com designates 64.233.182.186 as permitted sender)
Received: from [64.233.182.186] (HELO nf-out-0910.google.com) (64.233.182.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 17:09:08 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1051740nfc
        for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 09:09:00 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=LrlRLj5l+W3XI8EJi8Ph5nCtIq6Nw/fls3jHSNzihwE=;
        b=X+p9gUkDjKDl8pXeMdm8rUCinv+JDv7Atw1/DazQHJNzPrT47PKj+gDa9u1k4TtdRsOKi8Aw/096RE6c6hDuK+iqVqO3T4ygxXcG0HkuEfnbQZND0mBfHgd+MY4nfKWvFskKDeX8SSQSizws7uhlZpNvKVghxh/DENdQ52pEs0k=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=PDIxLepMrr8v557uRpYeITLv467qhP1MQbxNF/i2i/kFAFwaMvsvWFg3jHWRtffggUKMrLDOviXJckX1R37aM/qYKNAdim958uusGUJhPhjHvaYtErXjDLtvz9FXjwQunV0gJ42WiuMDkTY7tbbDR4cGSuyCEEOgsHw4neqJH5c=
Received: by 10.86.26.11 with SMTP id 11mr4131686fgz.1195405740044;
        Sun, 18 Nov 2007 09:09:00 -0800 (PST)
Received: from ?213.164.101.224? ( [213.164.101.224])
        by mx.google.com with ESMTPS id l12sm2783219fgb.2007.11.18.09.08.58
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 18 Nov 2007 09:08:59 -0800 (PST)
Message-ID: <47407FF4.7010101@gmail.com>
Date: Sun, 18 Nov 2007 19:09:56 +0100
From: Alebu <aleboo@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Can I use Ispell dictionaries roe analizers in Lucene?
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I was wondering about methods for analyzing various languages and that 
what I understand (please correct me if I wrong):

1. To analyze non English language I need to use specific analyzer.
Link to already available contributions in sandbox 
http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/analyzers/

2. There are some universal systems in the world such as
    Ispell - http://ficus-www.cs.ucla.edu/geoff/ispell.html
    Snowball - http://snowball.tartarus.org/
    Hunspell - http://sourceforge.net/projects/hunspell
(This info I got from Postgresql documentation chapter about 
full-text-search which is part of core distribution from version 8.3 
(beta 2 for that moment) )
Here is link too: 
http://www.postgresql.org/docs/8.3/static/textsearch-dictionaries.html

Each of such engines has various dictionaries for various languages.

3. Snowball is already supported by Lucene.
http://svn.apache.org/repos/asf/lucene/java/trunk/contrib/snowball

And here goes my question :) ...

Can I use Ispell dictionaries with Lucene? And if no, then why? Are 
there some juridical issues with it or just no implementation exists jet?
If no implementation, then maybe there is some motivation not to support 
it (maybe it just not worth to do), or because of complexity
or no one ever tried jet?

The problem is that I need to support some languages not listed in 
snowball supported dictionaries list, but existing in Ispell, so
it is naturally to try to use Ispell in this situation.

P.S. Postgresql full text search has it, so Lucene probably need one 
too, I think.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31062-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 19:23:48 2007
Return-Path: <java-user-return-31062-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14944 invoked from network); 18 Nov 2007 19:23:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 19:23:45 -0000
Received: (qmail 82915 invoked by uid 500); 18 Nov 2007 19:23:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82867 invoked by uid 500); 18 Nov 2007 19:23:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82856 invoked by uid 99); 18 Nov 2007 19:23:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 11:23:26 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.29.29 as permitted sender)
Received: from [80.67.29.29] (HELO smtprelay12.ispgateway.de) (80.67.29.29)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 19:23:13 +0000
Received: (qmail 12153 invoked from network); 18 Nov 2007 19:23:03 -0000
Received: from unknown (HELO p54bfcc52.dip.t-dialin.net) (695637@[84.191.204.82])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay12.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 18 Nov 2007 19:23:03 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: Can I use Ispell dictionaries roe analizers in Lucene?
Date: Sun, 18 Nov 2007 20:24:31 +0100
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <47407FF4.7010101@gmail.com>
In-Reply-To: <47407FF4.7010101@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711182024.31209@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Sonntag, 18. November 2007, Alebu wrote:

> 1. To analyze non English language I need to use specific analyzer.

You don't have to, but it helps improving recall.

> Can I use Ispell dictionaries with Lucene?

It depends on the dictionary. Some dictionary authors use the ispell 
flagging system just to save space, others use it in a way so that it 
really expresses the linguistic relation between a base form 
(e.g. "house") and its text forms (e.g. "houses"). Only in the later case, 
you could expand the dictionary to a "text form -> base form" mapping and 
use it.

Some dictionaries are GPL, so they cannot be part of Lucene. But you can 
use them anyway. So the reason that there are no more advanced 
(dictionary-based) analyzers for Lucene are mostly because nobody has 
developed and published them. Of course, an increased recall often comes 
with a decrease in precision.

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31063-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 20:12:46 2007
Return-Path: <java-user-return-31063-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24726 invoked from network); 18 Nov 2007 20:12:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 20:12:46 -0000
Received: (qmail 19027 invoked by uid 500); 18 Nov 2007 20:12:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18984 invoked by uid 500); 18 Nov 2007 20:12:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18972 invoked by uid 99); 18 Nov 2007 20:12:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 12:12:27 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of aleboo@gmail.com designates 64.233.182.186 as permitted sender)
Received: from [64.233.182.186] (HELO nf-out-0910.google.com) (64.233.182.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 20:12:16 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1083655nfc
        for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 12:12:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=I+eTiEIKbATidIr8QWjUK2o4erZusCYzsTw8hEY4AkM=;
        b=bFp4qcSuy+C+5WYu6MMCHawWMVcmjHdOwlx8oREGjmYl5weziv2vGg2Uf/h2dmsYeplr9sWI5U86EVGEceuUdbi7VBSd9Y+WgVN3WbR+867k73zMGiaVdbH+kIyz4LOOWUWXoaGx9lSlluM9tg8mEhRGagCA0R5G+KQsmEj4gXo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=EOhUOd+fZqZNjD0Jd/oHJMAAiMlR4Yjdxsn7JYvYb1b4HSq/oNNBI3SLJ2jvogVEw1kXtRgHfP+b1oH2norb3UIZ0X22dvHBDzm/6kZjzj3ZO8bKuOfXJyDCt9zysmbRgX3NhoBK94bnjT1Wnz1g3r0TXCGcwSYMC83fpNcNaK4=
Received: by 10.86.77.5 with SMTP id z5mr2279122fga.1195416727423;
        Sun, 18 Nov 2007 12:12:07 -0800 (PST)
Received: from ?213.164.101.224? ( [213.164.101.224])
        by mx.google.com with ESMTPS id d6sm5941166fga.2007.11.18.12.12.06
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 18 Nov 2007 12:12:07 -0800 (PST)
Message-ID: <4740AAE1.20508@gmail.com>
Date: Sun, 18 Nov 2007 22:13:05 +0100
From: Alebu <aleboo@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Can I use Ispell dictionaries roe analizers in Lucene?
References: <47407FF4.7010101@gmail.com> <200711182024.31209@danielnaber.de>
In-Reply-To: <200711182024.31209@danielnaber.de>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

So what ispell dictionary actually is? List of rules for translation 
some words (or sentence?) to 'base form'? Or what?
If it is so, then as I understand it is actually possible to create some 
analyzer which gets ispell dictionary as parameter
and this way to get a full power of ispell dictionaries in Lucene? Or am 
I wrong somewhere?

Daniel Naber wrote:
> On Sonntag, 18. November 2007, Alebu wrote:
>
>   
>> 1. To analyze non English language I need to use specific analyzer.
>>     
>
> You don't have to, but it helps improving recall.
>
>   
>> Can I use Ispell dictionaries with Lucene?
>>     
>
> It depends on the dictionary. Some dictionary authors use the ispell 
> flagging system just to save space, others use it in a way so that it 
> really expresses the linguistic relation between a base form 
> (e.g. "house") and its text forms (e.g. "houses"). Only in the later case, 
> you could expand the dictionary to a "text form -> base form" mapping and 
> use it.
>
> Some dictionaries are GPL, so they cannot be part of Lucene. But you can 
> use them anyway. So the reason that there are no more advanced 
> (dictionary-based) analyzers for Lucene are mostly because nobody has 
> developed and published them. Of course, an increased recall often comes 
> with a decrease in precision.
>
> Regards
>  Daniel
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31064-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 20:29:01 2007
Return-Path: <java-user-return-31064-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26573 invoked from network); 18 Nov 2007 20:29:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 20:29:01 -0000
Received: (qmail 29307 invoked by uid 500); 18 Nov 2007 20:28:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29270 invoked by uid 500); 18 Nov 2007 20:28:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29259 invoked by uid 99); 18 Nov 2007 20:28:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 12:28:42 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.16 as permitted sender)
Received: from [80.67.18.16] (HELO smtprelay04.ispgateway.de) (80.67.18.16)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 20:28:29 +0000
Received: (qmail 7635 invoked from network); 18 Nov 2007 20:28:20 -0000
Received: from unknown (HELO p54bff439.dip.t-dialin.net) (695637@[84.191.244.57])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay04.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 18 Nov 2007 20:28:20 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: Can I use Ispell dictionaries roe analizers in Lucene?
Date: Sun, 18 Nov 2007 21:29:47 +0100
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <47407FF4.7010101@gmail.com> <200711182024.31209@danielnaber.de> <4740AAE1.20508@gmail.com>
In-Reply-To: <4740AAE1.20508@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711182129.47857@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Sonntag, 18. November 2007, Alebu wrote:

> So what ispell dictionary actually is? List of rules for translation
> some words (or sentence?) to 'base form'? Or what?

It's a list of terms with optional flags. For example:

walk/xy

In a different file, the flag "x" would then be defined as "append 'ed'" 
and y as "append 'ing'" so that the expanded version is:

walk
walked
walking

The term in the dictionary does not have to be a real word. So in this 
example, if normalization from "walking" and "walked" to "walk" is what 
you want, you could use ispell. It just won't work for irregualar forms 
(e.g. went -> go)

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31065-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 21:32:45 2007
Return-Path: <java-user-return-31065-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42045 invoked from network); 18 Nov 2007 21:32:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 21:32:45 -0000
Received: (qmail 76833 invoked by uid 500); 18 Nov 2007 21:32:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76802 invoked by uid 500); 18 Nov 2007 21:32:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76791 invoked by uid 99); 18 Nov 2007 21:32:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 13:32:27 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 209.85.162.180 as permitted sender)
Received: from [209.85.162.180] (HELO el-out-1112.google.com) (209.85.162.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 21:32:17 +0000
Received: by el-out-1112.google.com with SMTP id o28so536066ele
        for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 13:32:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=cLEu8kZz3g9hp0D2dDzORhq3huQ6spy/QXE/PCcOsXY=;
        b=KHZPmoF3RqL47A9FBFo5I9DkKhhIKyz9wKL2mKwehrGxDCHmCKFX1ZvcxzXckHMDQuHLkUL+dQQMy1XdOyAtHPrQoSLX8D4DPiPwDBZLIavSxeEBk6NYd5xXEuIQMu3Gs4hWqcaAW+Yg3aGud4uTnbOuAUBkK8LGZn9qvC2hGt0=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=TutpnFZobxtoLHo9otPleQPBchveHetZ9VxjFhc7YrntjcE8AAQza9F7dpdUrHxa+J1LaduPOH1FprLmiB9r+rUYksMksHTs/hNHb9Wbqclsb37UNJ5CsJTb7RIZCv6kVW7OwWZwG3VZPWkFpMXCJrpmoc5EOaoLFR2JH3VmJbE=
Received: by 10.151.9.1 with SMTP id m1mr474649ybi.1195421527633;
        Sun, 18 Nov 2007 13:32:07 -0800 (PST)
Received: by 10.150.153.16 with HTTP; Sun, 18 Nov 2007 13:32:07 -0800 (PST)
Message-ID: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
Date: Sun, 18 Nov 2007 18:32:07 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Time of processing hits.doc()
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

I have a problem of performance when I need group the result do search

I have the code below:

   for (int i = 0; i < hits.length(); i++) {
                    doc = hits.doc(i);

                    obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
                    obj2 = doc.get(xxx);
                    ...
   }

  I work with volume of data very big. The search process in 0.300
seconds but when the object hits have much results, the time for get
all objects is very big. The command hits.doc(i) is processed in 2
second.

  Por exemplo. For hits.length() equals the 25.000 results, the time
of "pos search" is 7 seconds.

  I get all result because I need group the result (remove the
duplicate results).

  Is there any form in Lucene that group the result. I need of
anything as the command "group by" of sql.

  Thanks.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31066-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 21:58:23 2007
Return-Path: <java-user-return-31066-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45690 invoked from network); 18 Nov 2007 21:58:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 21:58:22 -0000
Received: (qmail 99385 invoked by uid 500); 18 Nov 2007 21:58:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99361 invoked by uid 500); 18 Nov 2007 21:58:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99350 invoked by uid 99); 18 Nov 2007 21:58:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 13:58:04 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.191.106.145] (HELO smtp114.plus.mail.mud.yahoo.com) (209.191.106.145)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 18 Nov 2007 21:57:53 +0000
Received: (qmail 86131 invoked from network); 18 Nov 2007 21:57:45 -0000
Received: from unknown (HELO ?192.168.1.100?) (nhira@cognocys.com@75.168.21.119 with plain)
  by smtp114.plus.mail.mud.yahoo.com with SMTP; 18 Nov 2007 21:57:45 -0000
X-YMail-OSG: ku.wOWwVM1l7dzJ08FLELdMmNsQAgUmq8XJZ6..GyF6IWkc_F.YjKY8EQeuuzevEaqmM9_.THw--
Mime-Version: 1.0 (Apple Message framework v752.3)
In-Reply-To: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
Message-Id: <069C2956-1570-4CA9-91F9-736684CD0AE7@cognocys.com>
Content-Transfer-Encoding: 7bit
From: "N. Hira" <nhira@cognocys.com>
Subject: Re: Time of processing hits.doc()
Date: Sun, 18 Nov 2007 15:57:43 -0600
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.752.3)
X-Virus-Checked: Checked by ClamAV on apache.org

Can you explain the problem you're trying to address from the user's  
perspective?

 From the description you've provided, you may want to look up  
"Faceted Searching".  Another option may be to use a HitCollector,  
but it would help us if you could describe the problem at a higher  
level.

Regards,

-h
----------------------------------------------------------------------
Hira, N.R.
Solutions Architect
Cognocys, Inc.

On 18-Nov-2007, at 3:32 PM, Haroldo Nascimento wrote:

> I have a problem of performance when I need group the result do search
>
> I have the code below:
>
>    for (int i = 0; i < hits.length(); i++) {
>                     doc = hits.doc(i);
>
>                     obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
>                     obj2 = doc.get(xxx);
>                     ...
>    }
>
>   I work with volume of data very big. The search process in 0.300
> seconds but when the object hits have much results, the time for get
> all objects is very big. The command hits.doc(i) is processed in 2
> second.
>
>   Por exemplo. For hits.length() equals the 25.000 results, the time
> of "pos search" is 7 seconds.
>
>   I get all result because I need group the result (remove the
> duplicate results).
>
>   Is there any form in Lucene that group the result. I need of
> anything as the command "group by" of sql.
>
>   Thanks.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31067-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 22:11:24 2007
Return-Path: <java-user-return-31067-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48229 invoked from network); 18 Nov 2007 22:11:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 22:11:24 -0000
Received: (qmail 18235 invoked by uid 500); 18 Nov 2007 22:11:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 17175 invoked by uid 500); 18 Nov 2007 22:11:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 17154 invoked by uid 99); 18 Nov 2007 22:11:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 14:11:05 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of pgwillia@uwaterloo.ca designates 129.97.152.18 as permitted sender)
Received: from [129.97.152.18] (HELO services10.student.cs.uwaterloo.ca) (129.97.152.18)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 22:10:54 +0000
Received: from [192.168.1.111] (d66-222-166-22.abhsia.telus.net [66.222.166.22])
	(authenticated bits=0)
	by services10.student.cs.uwaterloo.ca (8.13.8/8.13.8) with ESMTP id lAIMAgUP029143
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO);
	Sun, 18 Nov 2007 17:10:45 -0500 (EST)
Message-ID: <4740B862.5020007@uwaterloo.ca>
Date: Sun, 18 Nov 2007 15:10:42 -0700
From: Tricia Williams <pgwillia@uwaterloo.ca>
User-Agent: Thunderbird 2.0.0.6 (X11/20071022)
MIME-Version: 1.0
To: java-user@lucene.apache.org, solr-user@lucene.apache.org
Subject: Re: Payloads, Tokenizers, and Filters.  Oh My!
References: <473E61EB.8030502@uwaterloo.ca>
In-Reply-To: <473E61EB.8030502@uwaterloo.ca>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Greylist: Sender succeeded SMTP AUTH authentication, not delayed by milter-greylist-3.0 (services10.student.cs.uwaterloo.ca [129.97.152.13]); Sun, 18 Nov 2007 17:10:46 -0500 (EST)
X-Miltered: at mailchk-m02 with ID 4740B862.000 by Joe's j-chkmail (http://j-chkmail.ensmp.fr)!
X-Virus-Scanned: ClamAV version 0.91.2, clamav-milter version 0.91.2 on localhost
X-Virus-Status: Clean
X-UUID: 5a0c32cc-6d0e-41f5-8a89-7fbf6bda4c45
X-Virus-Checked: Checked by ClamAV on apache.org

I apologize for cross-posting but  I believe both Solr and Lucene users 
and developers should be concerned with this.  I am not aware of a 
better way to reach both communities.

In this email I'm looking for comments on:

    * Do TokenFilters belong in the Solr code base at all?
    * How to deal with TokenFilters that add new Tokens to the stream?
    * How to patch TokenFilters and Tokenizers using the model of
      LUCENE-969 in the Solr code base and in Lucene contrib?

Earlier in this thread I identified that at least one TokenFilter is 
eating Payloads (WordDelimiterFilter).

Yonik pointed out:
>> Yes, this will be an issue for many custom tokenizers that don't yet
>> know about payloads but that create tokens.  It's not clear what to do
>> in some cases when multiple tokens are created from one... should
>> identical payloads be created for the new tokens... it depends on what
>> the semantics of those payloads are.
>>
And I responded: 
> I suppose that it is only fair to take this on a case by case basis.  
> Maybe we will have to write new TokenFilters for each Tokenzier that 
> uses Payloads (but I sure hope not!).  Maybe we can build some 
> optional configuration options into the TokenFilter constructor that 
> guide their behavior with regard to Payloads.  Maybe there is 
> something stored in the TokenStream that dictates how the Payloads are 
> handled by the TokenFilters.  Maybe there is no case where identical 
> payloads would not be created for new tokens and we can just change 
> the TokenFilter to deal with payloads directly in a uniform way. 

I thought it might be useful to figure out which existing TokenFilters 
need to know about Payloads.  To this end I have taken an inventory of 
the TokenFilters out there.  I think it is fair to categorize them by 
Add (A), Delete (D), Modify (M), Observe (O):

*org.apache.solr.analysis.*HyphenatedWordsFilter, DM
*org.apache.solr.analysis.*KeepWordFilter, D
*org.apache.solr.analysis.*LengthFilter, D
*org.apache.solr.analysis.*PatternReplaceFilter, M
*org.apache.solr.analysis.*PhoneticFilter, AM
*org.apache.solr.analysis.*RemoveDuplicatesTokenFilter, D
*org.apache.solr.analysis.*SynonymFilter, ADM
*org.apache.solr.analysis.*TrimFilter, M
*org.apache.solr.analysis.*WordDelimiterFilter, AM
*org.apache.lucene.analysis.*CachingTokenFilter, O
*org.apache.lucene.analysis.*ISOLatin1AccentFilter, M
*org.apache.lucene.analysis.*LengthFilter, D
*org.apache.lucene.analysis.*LowerCaseFilter, M
*org.apache.lucene.analysis.*PorterStemFilter, M
*org.apache.lucene.analysis.*StopFilter, D
*org.apache.lucene.analysis.standard*.StandardFilter, M*
org.apache.lucene.analysis.br.*BrazilianStemFilter, M
*org.apache.lucene.analysis.cn.*ChineseFilter, D*
org.apache.lucene.analysis.de.*GermanStemFilter, M
*org.apache.lucene.analysis.el.*GreekLowerCaseFilter, M
*org.apache.lucene.analysis.fr.*ElisionFilter, M
*org.apache.lucene.analysis.fr.*FrenchStemFilter, M
*org.apache.lucene.analysis.ngram.*EdgeNGramTokenFilter, AM
*org.apache.lucene.analysis.ngram.*NGramTokenFilter, AM
*org.apache.lucene.analysis.nl.*DutchStemFilter, M
*org.apache.lucene.analysis.ru.*RussianLowerCaseFilter, M
*org.apache.lucene.analysis.ru.*RussianStemFilter, M
*org.apache.lucene.analysis.th.*ThaiWordFilter, AM
*org.apache.lucene.analysis.snowball.*SnowballFilter, M

Some characteristics of Add (A), Delete (D), Modify (M), Observe (O)
Add: new Token() and buffer of Tokens to consider before addressing 
input.next()
Delete: loop ignoring tokens based on some criteria
Modify: new Token(), or use of Token set methods
Observe: rare CachingTokenFilter

The categories of TokenFilters that are affected by Payloads are add and 
modify.  The default behavior of TokenFilters which only delete or 
observe return the Token fed through intact, hence the Payload will 
remain intact.

Maybe the Lucene community has thought about this problem?  I noticed 
that the org.apache.lucene.analysis TokenFilters in the modify category 
(there are none in the add category) refrain from using new Token().  
That led me to the comment in the JavaDocs:
>
> *NOTE:* As of 2.3, Token stores the term text internally as a 
> malleable char[] termBuffer instead of String termText. The indexing 
> code and core tokenizers have been changed re-use a single Token 
> instance, changing its buffer and other fields in-place as the Token 
> is processed. This provides substantially better indexing performance 
> as it saves the GC cost of new'ing a Token and String for every term. 
> The APIs that accept String termText are still available but a warning 
> about the associated performance cost has been added (below). The 
> |termText()| 
> <http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/analysis/Token.html#termText%28%29> 
> method has been deprecated.
>
> Tokenizers and filters should try to re-use a Token instance when 
> possible for best performance, by implementing the 
> |TokenStream.next(Token)| 
> <http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/analysis/TokenStream.html#next%28org.apache.lucene.analysis.Token%29> 
> API. Failing that, to create a new Token you should first use one of 
> the constructors that starts with null text. Then you should call 
> either |termBuffer()| 
> <http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/analysis/Token.html#termBuffer%28%29> 
> or |resizeTermBuffer(int)| 
> <http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/analysis/Token.html#resizeTermBuffer%28int%29> 
> to retrieve the Token's termBuffer. Fill in the characters of your 
> term into this buffer, and finally call |setTermLength(int)| 
> <http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/analysis/Token.html#setTermLength%28int%29> 
> to set the length of the term text. See LUCENE-969 
> <https://issues.apache.org/jira/browse/LUCENE-969> for details.
>
The patch mentioned modifies the Tokenizers and TokenFilters in the 
Lucene core code base to abide by the suggestions made.  This would mean 
that the TokenFilters in my modify category would have the default 
behavior of the Payload of the modified Token remaining intact.  I would 
argue that when/if the Solr community starts using Lucene 2.3 that a 
similar patch should be created for the TokenFilters there but I wonder 
if the TokenFilters belong in Solr's domain at all.  At some point the 
TokenFilters and Tokenizers in the contrib sections of Lucene should 
also be patched with the suggestions.

If this occurs then we only have to consider the add case.  I don't 
think we can avoid looking at this on a case by case basis, but most of 
the add cases are providing alternate terms for the same position.  In 
that case the payload would simply be copied to the new Token much like 
the Token's positionIncrement.

Thanks for your input,
Tricia

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31068-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 22:16:45 2007
Return-Path: <java-user-return-31068-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49529 invoked from network); 18 Nov 2007 22:16:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 22:16:45 -0000
Received: (qmail 21530 invoked by uid 500); 18 Nov 2007 22:16:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21499 invoked by uid 500); 18 Nov 2007 22:16:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21488 invoked by uid 99); 18 Nov 2007 22:16:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 14:16:27 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 22:16:14 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1ItsQx-00047C-QJ
	for java-user@lucene.apache.org; Sun, 18 Nov 2007 14:16:07 -0800
Message-ID: <13824599.post@talk.nabble.com>
Date: Sun, 18 Nov 2007 14:16:07 -0800 (PST)
From: flateric <eballnath@yahoo.de>
To: java-user@lucene.apache.org
Subject: neither IndexWriter nor IndexReader would delete documents
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: eballnath@yahoo.de
X-Virus-Checked: Checked by ClamAV on apache.org


Hallo *;

I went through some examples of the Lucene in Action book to find that the
API has changed and then applied the corrections with the help of this
forum.
One runtime problem however remains. I cannot delete any documents.
I store documents like this:

IndexWriter iw = new IndexWriter(
	new File(Constants.INDEX_FILENAME), new StandardAnalyzer());
Document document = new Document();
...
document.add(new Field("doc", doc, Field.Store.YES, Field.Index.NO));
iw.addDocument(document);
iw.optimize();
iw.close(); 

Which works fine. But deleting them like this:

Directory fsDir = FSDirectory.getDirectory(new File(
	Constants.INDEX_FILENAME));
IndexReader ir = IndexReader.open(fsDir);
ir.deleteDocuments(new Term("uid", uid));
ir.close();

Has absolutely no effect. I also tried delete on the IndexWriter - no
effect.
Please help! I don't know where to investigate any further!

Thx Eric
-- 
View this message in context: http://www.nabble.com/neither-IndexWriter-nor-IndexReader-would-delete-documents-tf4832123.html#a13824599
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31069-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 23:07:27 2007
Return-Path: <java-user-return-31069-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64051 invoked from network); 18 Nov 2007 23:07:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 23:07:27 -0000
Received: (qmail 57568 invoked by uid 500); 18 Nov 2007 23:07:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57523 invoked by uid 500); 18 Nov 2007 23:07:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57512 invoked by uid 99); 18 Nov 2007 23:07:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 15:07:08 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.29.7 as permitted sender)
Received: from [80.67.29.7] (HELO smtprelay07.ispgateway.de) (80.67.29.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 23:06:55 +0000
Received: (qmail 23839 invoked from network); 18 Nov 2007 23:06:46 -0000
Received: from unknown (HELO p54bfdfc2.dip.t-dialin.net) (695637@[84.191.223.194])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay07.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 18 Nov 2007 23:06:46 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: neither IndexWriter nor IndexReader would delete documents
Date: Mon, 19 Nov 2007 00:08:14 +0100
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <13824599.post@talk.nabble.com>
In-Reply-To: <13824599.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711190008.14264@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Sonntag, 18. November 2007, flateric wrote:

> Has absolutely no effect. I also tried delete on the IndexWriter - no
> effect.

Please use the tool Luke to have a look inside your index to see if a 
document with field "uid" and the uid you're expecting really exists. The 
field should be UN_TOKENIZED, it does not have to be stored (but that 
doesn't hurt).

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31070-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 23:10:37 2007
Return-Path: <java-user-return-31070-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64418 invoked from network); 18 Nov 2007 23:10:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 23:10:36 -0000
Received: (qmail 60701 invoked by uid 500); 18 Nov 2007 23:10:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60663 invoked by uid 500); 18 Nov 2007 23:10:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60652 invoked by uid 99); 18 Nov 2007 23:10:18 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 15:10:18 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 72.14.204.224 as permitted sender)
Received: from [72.14.204.224] (HELO qb-out-0506.google.com) (72.14.204.224)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 23:10:03 +0000
Received: by qb-out-0506.google.com with SMTP id o21so731220qba
        for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 15:09:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=h9PHw5itBtTg+nU5sGz7xuLs7E23Wa9XlXLYa3nx7BU=;
        b=KnXaER8QOoG3pLg4mOOOkj8ucUZ9FIOaDB+REl2Dt9WhsF8sFmBKE0laREhFMkGzSqmKYE2vKT4XYkk+e66w+0QfHm8tvNLx+f8NT92qdS5zKizSfAkSSJKxN+oXCNqY0sA3XWOkp1hrpYEMhbt8SVN3B0oQWISkqtCe1kZhmpI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=EPGOZ3T9hHk7l5B/1kP0lVDDQuQp7COeLvJJ0uHCaT2TZ6aijl2Z6xquCacKEFZP/DMW0aAj2+PMljeDtqaYrrKCD1eAftnSPbkFDKQsRKtj6oN8tf/FXPZ/HRlZAWwOXOsz20Lcr9EgA7WEFD8ggeocmcLJihHv0HmaLlDSAwk=
Received: by 10.65.103.14 with SMTP id f14mr9945676qbm.1195427395197;
        Sun, 18 Nov 2007 15:09:55 -0800 (PST)
Received: from ?192.168.1.102? ( [69.124.234.183])
        by mx.google.com with ESMTPS id f17sm3542726qba.2007.11.18.15.09.54
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 18 Nov 2007 15:09:54 -0800 (PST)
Message-ID: <4740C637.2010809@gmail.com>
Date: Sun, 18 Nov 2007 18:09:43 -0500
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
In-Reply-To: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hey Haroldo.

First thing you need to do is *stop* using Hits in your searches. Hits 
is optimized for some pretty specific use cases and you will get along 
much better by using a HitCollector.

Hits has three main functions:

It caches documents, normalizes scores, and stores ids associated with 
scores (a HitDoc). If you attempt to retrieve a HitDoc past the first 
100 from Hits, a new search will be issued to grab double the required 
HitDocs needed to satisfy your HitDoc retrieval attempt. This will be 
repeated everytime you ask for a HitDoc beyond the current cache (which 
began at 100). This means that if you need to get a HitDoc beyond 100, 
Hits is not a great choice for you. You will want to use the 
HitCollector instead...but remember that you are losing the normalized 
scores (simple to copy code if you still want it) and the document 
caching (I rarely want that anyway).

An issue to watch out for: with Hits, you do not have to ask for how 
many docs to get back, but with a HitCollector solution you will need 
to. This is a minor dilema if you want to go over all of the hits no 
matter what. You can pass a huge number to ensure you get everything, 
but you will be creating large data structures if you do this, as 
structure sizes may be initialized by the number you pass. Also, passing 
the maximum integer will cause an error (negative init size) as Lucene 
initializes a data structure to hold the hits as n+1.

- Mark

Haroldo Nascimento wrote:
> I have a problem of performance when I need group the result do search
>
> I have the code below:
>
>    for (int i = 0; i < hits.length(); i++) {
>                     doc = hits.doc(i);
>
>                     obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
>                     obj2 = doc.get(xxx);
>                     ...
>    }
>
>   I work with volume of data very big. The search process in 0.300
> seconds but when the object hits have much results, the time for get
> all objects is very big. The command hits.doc(i) is processed in 2
> second.
>
>   Por exemplo. For hits.length() equals the 25.000 results, the time
> of "pos search" is 7 seconds.
>
>   I get all result because I need group the result (remove the
> duplicate results).
>
>   Is there any form in Lucene that group the result. I need of
> anything as the command "group by" of sql.
>
>   Thanks.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>   

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31071-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 18 23:17:13 2007
Return-Path: <java-user-return-31071-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67879 invoked from network); 18 Nov 2007 23:17:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 18 Nov 2007 23:17:13 -0000
Received: (qmail 66512 invoked by uid 500); 18 Nov 2007 23:16:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66473 invoked by uid 500); 18 Nov 2007 23:16:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66462 invoked by uid 99); 18 Nov 2007 23:16:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 15:16:54 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.166.180 as permitted sender)
Received: from [64.233.166.180] (HELO py-out-1112.google.com) (64.233.166.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 23:16:44 +0000
Received: by py-out-1112.google.com with SMTP id d32so10016895pye
        for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 15:16:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=GdCwyFMzSa9XRMfAy6FTCKGcJxbcqiy30rcl86cp3g4=;
        b=Wh52IdAgKjjuanrgrkKYVztoffmJYQvLBq9gKAdvGdRAzgBcLu2Ir7PyUu5mnpukdokqp4gi0coIkaoiSdMDwHpRtJuPWozM/siHiVRi/XPfXBUJaxKxqZdop9BcOnAhg4X2msWX7X/IFhcTCLrXHEYnQmFvFdV4EwtRBr/Mtr8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=CqSCubhXqTMBEPifFPvB1PsCM93YLToALKfhtbl5aahxoeWspAfXqpoH1fcFzi4rAuv7uYfBmaoTHF0tl86e/QplwENrRPOVkZet9hDzwa+TtmPScrIrvOjoY8vA2Hgg/SU5hXo26QdNpv8PsL+c2Q1AmpSkndSzjyiiyF515qI=
Received: by 10.65.233.16 with SMTP id k16mr9939536qbr.1195427797228;
        Sun, 18 Nov 2007 15:16:37 -0800 (PST)
Received: from ?192.168.1.102? ( [69.124.234.183])
        by mx.google.com with ESMTPS id e18sm3555834qba.2007.11.18.15.16.35
        (version=SSLv3 cipher=RC4-MD5);
        Sun, 18 Nov 2007 15:16:36 -0800 (PST)
Message-ID: <4740C7C8.6010801@gmail.com>
Date: Sun, 18 Nov 2007 18:16:24 -0500
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com> <4740C637.2010809@gmail.com>
In-Reply-To: <4740C637.2010809@gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Correction: that issue to watch out for is in regards to the TopDocs 
HitCollector. If you where to go with your own HitCollector rather than 
TopDocs you might not necessarily have this problem (or at the least you 
can code around it).

Mark Miller wrote:
> Hey Haroldo.
>
> First thing you need to do is *stop* using Hits in your searches. Hits 
> is optimized for some pretty specific use cases and you will get along 
> much better by using a HitCollector.
>
> Hits has three main functions:
>
> It caches documents, normalizes scores, and stores ids associated with 
> scores (a HitDoc). If you attempt to retrieve a HitDoc past the first 
> 100 from Hits, a new search will be issued to grab double the required 
> HitDocs needed to satisfy your HitDoc retrieval attempt. This will be 
> repeated everytime you ask for a HitDoc beyond the current cache 
> (which began at 100). This means that if you need to get a HitDoc 
> beyond 100, Hits is not a great choice for you. You will want to use 
> the HitCollector instead...but remember that you are losing the 
> normalized scores (simple to copy code if you still want it) and the 
> document caching (I rarely want that anyway).
>
> An issue to watch out for: with Hits, you do not have to ask for how 
> many docs to get back, but with a HitCollector solution you will need 
> to. This is a minor dilema if you want to go over all of the hits no 
> matter what. You can pass a huge number to ensure you get everything, 
> but you will be creating large data structures if you do this, as 
> structure sizes may be initialized by the number you pass. Also, 
> passing the maximum integer will cause an error (negative init size) 
> as Lucene initializes a data structure to hold the hits as n+1.
>
> - Mark
>
> Haroldo Nascimento wrote:
>> I have a problem of performance when I need group the result do search
>>
>> I have the code below:
>>
>>    for (int i = 0; i < hits.length(); i++) {
>>                     doc = hits.doc(i);
>>
>>                     obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
>>                     obj2 = doc.get(xxx);
>>                     ...
>>    }
>>
>>   I work with volume of data very big. The search process in 0.300
>> seconds but when the object hits have much results, the time for get
>> all objects is very big. The command hits.doc(i) is processed in 2
>> second.
>>
>>   Por exemplo. For hits.length() equals the 25.000 results, the time
>> of "pos search" is 7 seconds.
>>
>>   I get all result because I need group the result (remove the
>> duplicate results).
>>
>>   Is there any form in Lucene that group the result. I need of
>> anything as the command "group by" of sql.
>>
>>   Thanks.
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>   
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31072-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 03:44:05 2007
Return-Path: <java-user-return-31072-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53031 invoked from network); 19 Nov 2007 03:44:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 03:44:05 -0000
Received: (qmail 5444 invoked by uid 500); 19 Nov 2007 03:43:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5409 invoked by uid 500); 19 Nov 2007 03:43:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5398 invoked by uid 99); 19 Nov 2007 03:43:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 19:43:46 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 03:43:35 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1ItxXk-0002eS-QT
	for java-user@lucene.apache.org; Sun, 18 Nov 2007 19:43:28 -0800
Message-ID: <13827336.post@talk.nabble.com>
Date: Sun, 18 Nov 2007 19:43:28 -0800 (PST)
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Subject: XML parsing using Lucene in Java
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fayyazuddin@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Dear Fellow Lucene Developers:

I am a java/jsp developer and have started learning lucene for the purpose
of creating a search engine for some books that I have in xml format.  The
XML document is actually quite large, and would like to provide as accurate
results as possible to the user searching through these books.  My question
is, which xml parser do you recommend using, SAX or Digester?  Is there a
difference?  Does one parser provide better results than the other?  What
about performance issues?

Any help that you can provide is greatly appreciated.  I look forward to
hearing from you soon.

Take care.
Sincerely;
Fayyaz

-- 
View this message in context: http://www.nabble.com/XML-parsing-using-Lucene-in-Java-tf4833124.html#a13827336
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31073-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 03:50:00 2007
Return-Path: <java-user-return-31073-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 60669 invoked from network); 19 Nov 2007 03:50:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 03:50:00 -0000
Received: (qmail 14331 invoked by uid 500); 19 Nov 2007 03:49:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13887 invoked by uid 500); 19 Nov 2007 03:49:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13876 invoked by uid 99); 19 Nov 2007 03:49:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 19:49:41 -0800
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp2.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 03:49:31 +0000
Received: from smtp1.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp2.akamai.com (8.13.8/8.12.10) with ESMTP id lAJ3oFwj027365
	for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 22:50:15 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lAJ3lCqx001090
	for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 22:47:12 -0500 (EST)
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Sun, 18 Nov 2007 22:49:19 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Time of processing hits.doc()
Date: Mon, 19 Nov 2007 09:19:17 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A620256C36D@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Time of processing hits.doc()
Thread-Index: AcgqKpmF8I36HLjJR4a4FRTuSsi29QANGV6Q
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 19 Nov 2007 03:49:19.0458 (UTC) FILETIME=[29FA2C20:01C82A5F]
X-Virus-Checked: Checked by ClamAV on apache.org

Hey!
Search for the topic "Aggregating Category Hits" in the list. You'll get
a few approaches that you may use to implement "groupby".

Regards,
kapilChhabra

-----Original Message-----
From: Haroldo Nascimento [mailto:haroldo.araras@gmail.com]=20
Sent: Monday, November 19, 2007 3:02 AM
To: java-user@lucene.apache.org
Subject: Time of processing hits.doc()

I have a problem of performance when I need group the result do search

I have the code below:

   for (int i =3D 0; i < hits.length(); i++) {
                    doc =3D hits.doc(i);

                    obj1 =3D doc.get(Constants.STATE_DESC_FIELD_LABEL);
                    obj2 =3D doc.get(xxx);
                    ...
   }

  I work with volume of data very big. The search process in 0.300
seconds but when the object hits have much results, the time for get all
objects is very big. The command hits.doc(i) is processed in 2 second.

  Por exemplo. For hits.length() equals the 25.000 results, the time of
"pos search" is 7 seconds.

  I get all result because I need group the result (remove the duplicate
results).

  Is there any form in Lucene that group the result. I need of anything
as the command "group by" of sql.

  Thanks.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31074-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 03:58:12 2007
Return-Path: <java-user-return-31074-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 61816 invoked from network); 19 Nov 2007 03:58:12 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 03:58:12 -0000
Received: (qmail 18780 invoked by uid 500); 19 Nov 2007 03:57:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18748 invoked by uid 500); 19 Nov 2007 03:57:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18737 invoked by uid 99); 19 Nov 2007 03:57:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 19:57:53 -0800
X-ASF-Spam-Status: No, hits=-0.8 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp2.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 03:57:41 +0000
Received: from smtp1.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp2.akamai.com (8.13.8/8.12.10) with ESMTP id lAJ3wS2Z000355
	for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 22:58:28 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lAJ3tP8T004030
	for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 22:55:25 -0500 (EST)
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Sun, 18 Nov 2007 22:57:32 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: neither IndexWriter nor IndexReader would delete documents
Date: Mon, 19 Nov 2007 09:27:29 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A620256C370@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <13824599.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: neither IndexWriter nor IndexReader would delete documents
Thread-Index: AcgqMLmUcd0qGYDFQ1moJ74vbU8ougAL2IrA
References: <13824599.post@talk.nabble.com>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 19 Nov 2007 03:57:32.0636 (UTC) FILETIME=[4FEF29C0:01C82A60]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,
Checkout for the following lines in the documentation of IndexReader:

* "An IndexReader can be opened on a directory for which an IndexWriter
is opened already, but it cannot be used to delete documents from the
index then. "
* "Once a document is deleted it will not appear in TermDocs or
TermPostitions enumerations. Attempts to read its field with the
document(int)  method will result in an error. The presence of this
document may still be reflected in the
docFreq(org.apache.lucene.index.Term) statistic, though this will be
corrected eventually as the index is further modified."

Hope this helps.

Regards,
kapilChhabra


-----Original Message-----
From: flateric [mailto:eballnath@yahoo.de]=20
Sent: Monday, November 19, 2007 3:46 AM
To: java-user@lucene.apache.org
Subject: neither IndexWriter nor IndexReader would delete documents


Hallo *;

I went through some examples of the Lucene in Action book to find that
the API has changed and then applied the corrections with the help of
this forum.
One runtime problem however remains. I cannot delete any documents.
I store documents like this:

IndexWriter iw =3D new IndexWriter(
	new File(Constants.INDEX_FILENAME), new StandardAnalyzer());
Document document =3D new Document(); ...
document.add(new Field("doc", doc, Field.Store.YES, Field.Index.NO));
iw.addDocument(document); iw.optimize(); iw.close();=20

Which works fine. But deleting them like this:

Directory fsDir =3D FSDirectory.getDirectory(new File(
	Constants.INDEX_FILENAME));
IndexReader ir =3D IndexReader.open(fsDir); ir.deleteDocuments(new
Term("uid", uid)); ir.close();

Has absolutely no effect. I also tried delete on the IndexWriter - no
effect.
Please help! I don't know where to investigate any further!

Thx Eric
--
View this message in context:
http://www.nabble.com/neither-IndexWriter-nor-IndexReader-would-delete-d
ocuments-tf4832123.html#a13824599
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31075-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 04:01:28 2007
Return-Path: <java-user-return-31075-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62281 invoked from network); 19 Nov 2007 04:01:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 04:01:28 -0000
Received: (qmail 21838 invoked by uid 500); 19 Nov 2007 04:01:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21806 invoked by uid 500); 19 Nov 2007 04:01:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21791 invoked by uid 99); 19 Nov 2007 04:01:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 20:01:09 -0800
X-ASF-Spam-Status: No, hits=-0.8 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp2.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 04:00:58 +0000
Received: from smtp1.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp2.akamai.com (8.13.8/8.12.10) with ESMTP id lAJ41kCs001497
	for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 23:01:46 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lAJ3whrc005189
	for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 22:58:43 -0500 (EST)
Received: from MAVS2.kendall.corp.akamai.com ([172.17.33.20]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Sun, 18 Nov 2007 23:00:50 -0500
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by MAVS2.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Sun, 18 Nov 2007 23:00:50 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: XML parsing using Lucene in Java
Date: Mon, 19 Nov 2007 09:30:46 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A620256C371@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <13827336.post@talk.nabble.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: XML parsing using Lucene in Java
Thread-Index: AcgqXnD4ByUYzHeLRDKMP3dvj7v9awAAgZOw
References: <13827336.post@talk.nabble.com>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 19 Nov 2007 04:00:50.0398 (UTC) FILETIME=[C5CF3FE0:01C82A60]
X-Virus-Checked: Checked by ClamAV on apache.org

Checkout for "http://www.ibm.com/developerworks/web/library/j-lucene/"
Though this page does not list a comparison between SAX and Digester, it
convinced me enough to use Digester

Regards,
kapilChhabra

-----Original Message-----
From: syedfa [mailto:fayyazuddin@gmail.com]=20
Sent: Monday, November 19, 2007 9:13 AM
To: java-user@lucene.apache.org
Subject: XML parsing using Lucene in Java


Dear Fellow Lucene Developers:

I am a java/jsp developer and have started learning lucene for the
purpose of creating a search engine for some books that I have in xml
format.  The XML document is actually quite large, and would like to
provide as accurate results as possible to the user searching through
these books.  My question is, which xml parser do you recommend using,
SAX or Digester?  Is there a difference?  Does one parser provide better
results than the other?  What about performance issues?

Any help that you can provide is greatly appreciated.  I look forward to
hearing from you soon.

Take care.
Sincerely;
Fayyaz

--
View this message in context:
http://www.nabble.com/XML-parsing-using-Lucene-in-Java-tf4833124.html#a1
3827336
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31076-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 04:53:03 2007
Return-Path: <java-user-return-31076-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70953 invoked from network); 19 Nov 2007 04:53:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 04:53:02 -0000
Received: (qmail 40061 invoked by uid 500); 19 Nov 2007 04:52:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40027 invoked by uid 500); 19 Nov 2007 04:52:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40016 invoked by uid 99); 19 Nov 2007 04:52:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 20:52:44 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mrrohitsaini@gmail.com designates 72.14.202.177 as permitted sender)
Received: from [72.14.202.177] (HELO ro-out-1112.google.com) (72.14.202.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 04:52:32 +0000
Received: by ro-out-1112.google.com with SMTP id m6so211981roe
        for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 20:52:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=O4feN4joXdnzyB9wCs8FG431NJ8iAU0R8gL9mM2CpdI=;
        b=di5cZrjiiQLruK7d0+Ri2aMW6HPcz3x5ElJmz3MY1/Z+xH5m6/DuIao33ZyeaojIvWETgLJmF55TJTQd5vV0F/yY4EDx/hzwVzvpNfsLL5UH0BX5YcKGoPq40JfEAPKmMNruUmCRA8qJVbxBoqX8b6E9yN6iuMflxb1PMzlpZ/M=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=GTlNzQFHe0iHzM/utRI4W/RBDbc3wJ6vSX8vKshRj/94rlBvH2YIhPEnfAA50/MkJzciQRzCWHQTfmQ+SR1CqGjTnVNoSH9G1NGakUwwWVLIlYOF0Cisj3ZGgMF/70SrYPCCVn/LG0/N1x6RKMrW6VyrFJuZ6SSUTmvQcIz6EZs=
Received: by 10.35.96.11 with SMTP id y11mr5720873pyl.1195447943846;
        Sun, 18 Nov 2007 20:52:23 -0800 (PST)
Received: by 10.35.118.15 with HTTP; Sun, 18 Nov 2007 20:52:23 -0800 (PST)
Message-ID: <3cb8ef760711182052t238125adldb660a5a37236709@mail.gmail.com>
Date: Mon, 19 Nov 2007 10:22:23 +0530
From: "rohit saini" <mrrohitsaini@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: urgent
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E9300@hstmsg005.corp.satyam.ad>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5757_21051468.1195447943836"
References: <70CC07CE-5F57-4884-8E23-35F541FCE1CD@apache.org>
	 <9312093579B72048B1E5659DC3EC7F39022E9300@hstmsg005.corp.satyam.ad>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5757_21051468.1195447943836
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,
I think u may need to use escape function to escape the words which does not
come in searching....

Rohit


On 11/17/07, Shakti_Sareen <Shakti_Sareen@satyam.com> wrote:
>
> Hi
>
>
>
> I am facing problem in searching the word containing forward slash (/).
>
> My index file contains more then one documents.
>
> On searching for the word "U/S" in the claims field I am getting hits.
>
> But the word "U/S" is actually not there in the document.
>
>
>
> Below is the code I am using for searching.
>
> Analyzer analyzer = null;
>
>                                analyzer = new StandardAnalyzer();
>
>                                IndexSearcher searcher = new
> IndexSearcher(fIndexFolder.getAbsolutePath());
>
>                                QueryParser parser = new
> QueryParser("Claim",analyzer);
>
>                                Query query = parser.parse("U/S");
>
>
>                                Hits hits = searcher.search(query);
>
>                                LOGGER.info("Hits of word U/S in claims
> ::::::::  " + hits.length());
>
>                                for (int i = 0; i < hits.length(); i++)
> {
>
>                                                docum = hits.doc(i);
>
>                                                LOGGER.info("file NUMBER
> >>>>   " + docum.get("PatentNumber"));
>
>                                }
>
>
>
> Regards
> SHAKTI SAREEN
>
>
> DISCLAIMER:
> This email (including any attachments) is intended for the sole use of the
> intended recipient/s and may contain material that is CONFIDENTIAL AND
> PRIVATE COMPANY INFORMATION. Any review or reliance by others or copying or
> distribution or forwarding of any or all of the contents in this message is
> STRICTLY PROHIBITED. If you are not the intended recipient, please contact
> the sender by email and delete all copies; your cooperation in this regard
> is appreciated.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
VANDE - MATRAM

------=_Part_5757_21051468.1195447943836--

From java-user-return-31077-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 07:25:41 2007
Return-Path: <java-user-return-31077-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14438 invoked from network); 19 Nov 2007 07:25:41 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 07:25:41 -0000
Received: (qmail 28270 invoked by uid 500); 19 Nov 2007 07:25:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28237 invoked by uid 500); 19 Nov 2007 07:25:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28226 invoked by uid 99); 19 Nov 2007 07:25:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Nov 2007 23:25:22 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of tzvika.barenholz@gmail.com designates 64.233.182.184 as permitted sender)
Received: from [64.233.182.184] (HELO nf-out-0910.google.com) (64.233.182.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 07:25:11 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1176505nfc
        for <java-user@lucene.apache.org>; Sun, 18 Nov 2007 23:25:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=na3XQl93F5rzwcECSf51tJWIUI4qbexjFVVuPEw4Olo=;
        b=TaT3cSjsCSfTGZJy2ywMkGFYxDH+IhN6ldqZMjQDiNsM2FxJClzwJ27IO/6uU7Jej567s6F4aLDHM+ammXiEHm3RoKRSITlYcbjhonB3vbwtlnJC6/mCErynIx0r0wzHtonNMRfzZIna6btNexLGwvuPz5IxuN+K0u6Sdz5tOdk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=sBHBbXV/yW4aIPIhwsGpoOCmlZG7IB4hBewwZL4BXlToixzRTmJVtnV0u0dBG55g32wTZKQLpM00cMq109ZxKwauAPWDngicMSkx3HaNQ40iULB+ty4+AFrH38j3SfK7fI934xYUrJpHI30jZJoH0YTB43z3bR1+YGX6180xhvw=
Received: by 10.78.168.1 with SMTP id q1mr4715976hue.1195457103000;
        Sun, 18 Nov 2007 23:25:03 -0800 (PST)
Received: by 10.78.70.17 with HTTP; Sun, 18 Nov 2007 23:25:02 -0800 (PST)
Message-ID: <e28521e30711182325h5c52da95ta97f900c170fbd6e@mail.gmail.com>
Date: Mon, 19 Nov 2007 09:25:02 +0200
From: "Tzvika Barenholz" <tzvika.barenholz@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3028_22989875.1195457102991"
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3028_22989875.1195457102991
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

You can feed the hits vector into Quaere (http://quaere.codehaus.org/) to
accomplish the SQL-like grouping you desire, very easily. But I'm not sure
it'll be that much quicker. Worth a shot.

T

On 11/18/07, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
>
> I have a problem of performance when I need group the result do search
>
> I have the code below:
>
>    for (int i = 0; i < hits.length(); i++) {
>                     doc = hits.doc(i);
>
>                     obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
>                     obj2 = doc.get(xxx);
>                     ...
>    }
>
>   I work with volume of data very big. The search process in 0.300
> seconds but when the object hits have much results, the time for get
> all objects is very big. The command hits.doc(i) is processed in 2
> second.
>
>   Por exemplo. For hits.length() equals the 25.000 results, the time
> of "pos search" is 7 seconds.
>
>   I get all result because I need group the result (remove the
> duplicate results).
>
>   Is there any form in Lucene that group the result. I need of
> anything as the command "group by" of sql.
>
>   Thanks.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_3028_22989875.1195457102991--

From java-user-return-31078-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 08:32:26 2007
Return-Path: <java-user-return-31078-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73400 invoked from network); 19 Nov 2007 08:32:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 08:32:26 -0000
Received: (qmail 84707 invoked by uid 500); 19 Nov 2007 08:32:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84680 invoked by uid 500); 19 Nov 2007 08:32:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84669 invoked by uid 99); 19 Nov 2007 08:32:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 00:32:07 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.142.200.43] (HELO web31110.mail.mud.yahoo.com) (68.142.200.43)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 19 Nov 2007 08:31:55 +0000
Received: (qmail 45034 invoked by uid 60001); 19 Nov 2007 08:31:48 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=ZcCUDpMnQoSmnpo+C+YEl6m+HkeRhq8WwYjcvUaPZnNQYooXyFgYhSFlc/KYuWbAkxO6+DuPUzY43DB/hNu0T8VCFExNeWPZF20LkM9++hlgebnQc7sosauTx+XdUfAZbenN6ZogsYw93iJ1VgqZN2aOPZrLOErJ2PlvhqyOly0=;
X-YMail-OSG: 6YULJqcVM1k31V6ortD.d9MDS08CrHqxpKyh_FY0BQ0JKaRUZDWtm9FE2GSJ9oGDIwzgci7m.9LxwajtADxrVLQyE8H4tnGYupg4SvRXTUzVg8_v4aY-
Received: from [80.97.2.39] by web31110.mail.mud.yahoo.com via HTTP; Mon, 19 Nov 2007 00:31:47 PST
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.157
Date: Mon, 19 Nov 2007 00:31:47 -0800 (PST)
From: Catalin Mititelu <catalinmititelu@yahoo.com>
Subject: Re: XML parsing using Lucene in Java
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-253457935-1195461107=:44638"
Message-ID: <55963.44638.qm@web31110.mail.mud.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-253457935-1195461107=:44638
Content-Type: text/plain; charset=us-ascii

Hi Fayyaz,
I recommend to use SAX or, maybe, a custom parser for large xml files .It should be faster than using Digester. The main difference between those xml parsers is that Digester needs to load the entire xml document in memory when it creates those objects, meanwhile you can parse the document and add its content in Lucene index on the fly using SAX. On the other hand with Digester the documents are parsed twice: once to transform the xml to Digester object and second you should use this object to add its content to Lucene index.
Digester is very good for small documents and if you don't want to worry about the xml parsing problems.
A custom parser maybe is the best solution if you want to have best performances. I chose this solution.

Regards,
Catalin

----- Original Message ----
From: syedfa <fayyazuddin@gmail.com>
To: java-user@lucene.apache.org
Sent: Monday, November 19, 2007 5:43:28 AM
Subject: XML parsing using Lucene in Java


Dear Fellow Lucene Developers:

I am a java/jsp developer and have started learning lucene for the
 purpose
of creating a search engine for some books that I have in xml format.
  The
XML document is actually quite large, and would like to provide as
 accurate
results as possible to the user searching through these books.  My
 question
is, which xml parser do you recommend using, SAX or Digester?  Is there
 a
difference?  Does one parser provide better results than the other?
  What
about performance issues?

Any help that you can provide is greatly appreciated.  I look forward
 to
hearing from you soon.

Take care.
Sincerely;
Fayyaz

-- 
View this message in context:
 http://www.nabble.com/XML-parsing-using-Lucene-in-Java-tf4833124.html#a13827336
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org







      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs
--0-253457935-1195461107=:44638--

From java-user-return-31079-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 10:43:16 2007
Return-Path: <java-user-return-31079-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19529 invoked from network); 19 Nov 2007 10:43:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 10:43:16 -0000
Received: (qmail 42907 invoked by uid 500); 19 Nov 2007 10:42:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42869 invoked by uid 500); 19 Nov 2007 10:42:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42858 invoked by uid 99); 19 Nov 2007 10:42:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 02:42:57 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 66.249.92.170 as permitted sender)
Received: from [66.249.92.170] (HELO ug-out-1314.google.com) (66.249.92.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 10:42:47 +0000
Received: by ug-out-1314.google.com with SMTP id h3so956340ugf
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 02:42:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=FIEEcpBA6BMl2Nqjqv7EItDCIJ5eC2NhtjF2FUw5npI=;
        b=DkBj8WRgjhcq1a/ykRxerWvEj4Nc5GJZGEyfYIjSjc39OTNuheZWAKAmdHdOXtWDVHaYVRUal08/+U1rt303VP/9xJX23f/8iTTZi5hM4oPYuskcUq6R4oAZBlAWnnCOuFwcjKkyO8UVY3wvgGw75Y/HpO6ocxKElH0KzZ6X3JM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=jKLwFzBdhJ98hrxXL/SnmKjgS7DWd63W1VE5iFSM9LFHSTEoKz4jq7NbanJF9/Yg096Ktwgv8lCTTb0fURjrrrqpRx9AVn2vSB0fkwIbAhicgRMBJwE+8Ig2f2heictJiBNH3kCoLayZeS/r1zvkTXOmTbAo7x7mSEElWpOjVJ0=
Received: by 10.66.219.16 with SMTP id r16mr104386ugg.1195468954778;
        Mon, 19 Nov 2007 02:42:34 -0800 (PST)
Received: from ?10.0.46.246? ( [202.125.143.67])
        by mx.google.com with ESMTPS id j4sm5027169ugf.2007.11.19.02.42.31
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 19 Nov 2007 02:42:33 -0800 (PST)
Message-ID: <47416890.4030805@gmail.com>
Date: Mon, 19 Nov 2007 15:42:24 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene setting
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


Hi All,

Can some explain to me this line. I encounter this line while setting up 
Lucene...

Connect to the top-level of your Lucene installation


Kindly guide me in this regard.

Liaqat Ali


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31080-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 10:44:14 2007
Return-Path: <java-user-return-31080-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19776 invoked from network); 19 Nov 2007 10:44:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 10:44:14 -0000
Received: (qmail 45162 invoked by uid 500); 19 Nov 2007 10:43:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44785 invoked by uid 500); 19 Nov 2007 10:43:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44757 invoked by uid 99); 19 Nov 2007 10:43:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 02:43:55 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of german.kondolf@gmail.com designates 209.85.146.177 as permitted sender)
Received: from [209.85.146.177] (HELO wa-out-1112.google.com) (209.85.146.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 10:43:45 +0000
Received: by wa-out-1112.google.com with SMTP id j40so2111836wah
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 02:43:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=s60yzWCdgorYoiDHWU7p6bunt/A/JN+UxWc5ox+tAmY=;
        b=aWKLGJrW4WYqJKRZmncMMxCeqgQiMr/f0g/JDRDNgvoiv1LhOqLN514kRszk+oWJwC2INoRg6ilPl0fKSPXuBLH/8GcSXWwXP50xdWtAYFKGQj6QDwIZlZ/2RJUAdZLy10KnAFU5mEJayWLNnZHP4pHY77X6u2HGQfA+ycBBQbg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=efN0+2a4r6i5rYHsc1OEyT4aroaSO50P3S+9aDnH1kp6IxqVhez5bRmYbw9uGvlP1HCandd5CYagX6p9quKp8yKz20oVnRHFRt1jGS7lTLrVMLjP4XIFFVYY4hSCM2oD1udcFjfsU0kiBRpi/NjIIABw6b/RqERzls4vD2HmAiM=
Received: by 10.114.146.1 with SMTP id t1mr366514wad.1195469018842;
        Mon, 19 Nov 2007 02:43:38 -0800 (PST)
Received: by 10.114.124.18 with HTTP; Mon, 19 Nov 2007 02:43:38 -0800 (PST)
Message-ID: <76df56980711190243r2a4e12c6u3470ddd2600a701f@mail.gmail.com>
Date: Mon, 19 Nov 2007 07:43:38 -0300
From: "German Kondolf" <german.kondolf@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

You sould never use the hits for other use than retrieving a group of
results (usually a page of 10-20-30 docs).

You could see Apache Solr's implementation of faceted search.
I've use that code as a guide to group & count diferent facets (or
conditions, fields as you wanna call it), is pretty fast, and you have
endless optimization approaches.

Regards,
German K.

On Nov 18, 2007 6:32 PM, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
> I have a problem of performance when I need group the result do search
>
> I have the code below:
>
>    for (int i = 0; i < hits.length(); i++) {
>                     doc = hits.doc(i);
>
>                     obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
>                     obj2 = doc.get(xxx);
>                     ...
>    }
>
>   I work with volume of data very big. The search process in 0.300
> seconds but when the object hits have much results, the time for get
> all objects is very big. The command hits.doc(i) is processed in 2
> second.
>
>   Por exemplo. For hits.length() equals the 25.000 results, the time
> of "pos search" is 7 seconds.
>
>   I get all result because I need group the result (remove the
> duplicate results).
>
>   Is there any form in Lucene that group the result. I need of
> anything as the command "group by" of sql.
>
>   Thanks.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31081-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 11:19:24 2007
Return-Path: <java-user-return-31081-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38702 invoked from network); 19 Nov 2007 11:19:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 11:19:24 -0000
Received: (qmail 93289 invoked by uid 500); 19 Nov 2007 11:19:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93250 invoked by uid 500); 19 Nov 2007 11:19:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93238 invoked by uid 99); 19 Nov 2007 11:19:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 03:19:05 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 11:18:52 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Iu4eM-00058K-Il
	for java-user@lucene.apache.org; Mon, 19 Nov 2007 03:18:46 -0800
Message-ID: <13833730.post@talk.nabble.com>
Date: Mon, 19 Nov 2007 03:18:46 -0800 (PST)
From: flateric <eballnath@yahoo.de>
To: java-user@lucene.apache.org
Subject: RE: neither IndexWriter nor IndexReader would delete documents
In-Reply-To: <4FA8C6AEE609B644B38DE471A3657A620256C370@INVS1.bangalore.corp.akamai.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: eballnath@yahoo.de
References: <13824599.post@talk.nabble.com> <4FA8C6AEE609B644B38DE471A3657A620256C370@INVS1.bangalore.corp.akamai.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Hallo Kapil;

thanks for your quick answer:
* "An IndexReader can be opened on a directory for which an IndexWriter
is opened already, but it cannot be used to delete documents from the
index then. "
sounded like a match, but I checked that and the IndexWriter is definitely
closed.

Regards,
Eric



Chhabra, Kapil wrote:
> 
> Hi,
> Checkout for the following lines in the documentation of IndexReader:
> 
> * "An IndexReader can be opened on a directory for which an IndexWriter
> is opened already, but it cannot be used to delete documents from the
> index then. "
> * "Once a document is deleted it will not appear in TermDocs or
> TermPostitions enumerations. Attempts to read its field with the
> document(int)  method will result in an error. The presence of this
> document may still be reflected in the
> docFreq(org.apache.lucene.index.Term) statistic, though this will be
> corrected eventually as the index is further modified."
> 
> Hope this helps.
> 
> Regards,
> kapilChhabra
> 
> 
> -----Original Message-----
> From: flateric [mailto:eballnath@yahoo.de] 
> Sent: Monday, November 19, 2007 3:46 AM
> To: java-user@lucene.apache.org
> Subject: neither IndexWriter nor IndexReader would delete documents
> 
> 
> Hallo *;
> 
> I went through some examples of the Lucene in Action book to find that
> the API has changed and then applied the corrections with the help of
> this forum.
> One runtime problem however remains. I cannot delete any documents.
> I store documents like this:
> 
> IndexWriter iw = new IndexWriter(
> 	new File(Constants.INDEX_FILENAME), new StandardAnalyzer());
> Document document = new Document(); ...
> document.add(new Field("doc", doc, Field.Store.YES, Field.Index.NO));
> iw.addDocument(document); iw.optimize(); iw.close(); 
> 
> Which works fine. But deleting them like this:
> 
> Directory fsDir = FSDirectory.getDirectory(new File(
> 	Constants.INDEX_FILENAME));
> IndexReader ir = IndexReader.open(fsDir); ir.deleteDocuments(new
> Term("uid", uid)); ir.close();
> 
> Has absolutely no effect. I also tried delete on the IndexWriter - no
> effect.
> Please help! I don't know where to investigate any further!
> 
> Thx Eric
> --
> View this message in context:
> http://www.nabble.com/neither-IndexWriter-nor-IndexReader-would-delete-d
> ocuments-tf4832123.html#a13824599
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/neither-IndexWriter-nor-IndexReader-would-delete-documents-tf4832123.html#a13833730
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31082-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 11:21:56 2007
Return-Path: <java-user-return-31082-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39580 invoked from network); 19 Nov 2007 11:21:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 11:21:56 -0000
Received: (qmail 97436 invoked by uid 500); 19 Nov 2007 11:21:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 97406 invoked by uid 500); 19 Nov 2007 11:21:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 97395 invoked by uid 99); 19 Nov 2007 11:21:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 03:21:36 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 11:21:25 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Iu4go-0005B6-M5
	for java-user@lucene.apache.org; Mon, 19 Nov 2007 03:21:18 -0800
Message-ID: <13833734.post@talk.nabble.com>
Date: Mon, 19 Nov 2007 03:21:18 -0800 (PST)
From: flateric <eballnath@yahoo.de>
To: java-user@lucene.apache.org
Subject: Re: neither IndexWriter nor IndexReader would delete documents
In-Reply-To: <200711190008.14264@danielnaber.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: eballnath@yahoo.de
References: <13824599.post@talk.nabble.com> <200711190008.14264@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org


Hallo Daniel;

thank you for your quick reply.
The "uid" field exists (UN_TOKENIZED and stored). The IndexWriter is also
closed while I'm using the IndexReader to delete.

Thanks,
Eric


Daniel Naber-10 wrote:
> 
> On Sonntag, 18. November 2007, flateric wrote:
> 
>> Has absolutely no effect. I also tried delete on the IndexWriter - no
>> effect.
> 
> Please use the tool Luke to have a look inside your index to see if a 
> document with field "uid" and the uid you're expecting really exists. The 
> field should be UN_TOKENIZED, it does not have to be stored (but that 
> doesn't hurt).
> 
> Regards
>  Daniel
> 
> -- 
> http://www.danielnaber.de
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/neither-IndexWriter-nor-IndexReader-would-delete-documents-tf4832123.html#a13833734
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31083-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 11:43:29 2007
Return-Path: <java-user-return-31083-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 47765 invoked from network); 19 Nov 2007 11:43:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 11:43:29 -0000
Received: (qmail 23691 invoked by uid 500); 19 Nov 2007 11:43:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23665 invoked by uid 500); 19 Nov 2007 11:43:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23654 invoked by uid 99); 19 Nov 2007 11:43:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 03:43:09 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.13 as permitted sender)
Received: from [80.67.18.13] (HELO smtprelay01.ispgateway.de) (80.67.18.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 11:42:56 +0000
Received: (qmail 20562 invoked from network); 19 Nov 2007 11:42:48 -0000
Received: from unknown (HELO p54bff304.dip.t-dialin.net) (695637@[84.191.243.4])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay01.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 19 Nov 2007 11:42:48 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: neither IndexWriter nor IndexReader would delete documents
Date: Mon, 19 Nov 2007 12:42:48 +0100
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <13824599.post@talk.nabble.com>
In-Reply-To: <13824599.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711191242.48449@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Sonntag, 18. November 2007, flateric wrote:

> IndexReader ir = IndexReader.open(fsDir);
> ir.deleteDocuments(new Term("uid", uid));
> ir.close();
>
> Has absolutely no effect.

What number does ir.deleteDocuments return? If it's 0, the uid cannot be 
found. If it's > 0: note that you need to re-open your searcher/reader to 
see any changes to your index.

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31084-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 13:21:55 2007
Return-Path: <java-user-return-31084-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92663 invoked from network); 19 Nov 2007 13:21:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 13:21:54 -0000
Received: (qmail 36827 invoked by uid 500); 19 Nov 2007 13:21:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36800 invoked by uid 500); 19 Nov 2007 13:21:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36789 invoked by uid 99); 19 Nov 2007 13:21:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 05:21:35 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a14.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 13:21:23 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a14.g.dreamhost.com (Postfix) with ESMTP id 07E6C190E32
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 05:21:15 -0800 (PST)
Message-Id: <9DABF1F4-B850-4217-91CA-43DD6BA1C904@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <47416890.4030805@gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Lucene setting
Date: Mon, 19 Nov 2007 08:21:14 -0500
References: <47416890.4030805@gmail.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Can you provide more details?  Are you actually using Lucene or some  
third party product that uses Lucene?  What steps did you take to get  
this?

-Grant

On Nov 19, 2007, at 5:42 AM, Liaqat Ali wrote:

>
> Hi All,
>
> Can some explain to me this line. I encounter this line while  
> setting up Lucene...
>
> Connect to the top-level of your Lucene installation
>
>
> Kindly guide me in this regard.
>
> Liaqat Ali
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31085-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 13:36:05 2007
Return-Path: <java-user-return-31085-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1305 invoked from network); 19 Nov 2007 13:36:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 13:36:04 -0000
Received: (qmail 57516 invoked by uid 500); 19 Nov 2007 13:35:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 57490 invoked by uid 500); 19 Nov 2007 13:35:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57472 invoked by uid 99); 19 Nov 2007 13:35:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 05:35:39 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 66.249.92.172 as permitted sender)
Received: from [66.249.92.172] (HELO ug-out-1314.google.com) (66.249.92.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 13:35:28 +0000
Received: by ug-out-1314.google.com with SMTP id h3so986076ugf
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 05:35:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=u0iSD+MDPjPOo9yWfWRfhw+W41DfNlcF7YXr9ufHPKU=;
        b=Pc9JWL53UiAJl6zBZxVhcAP9xRFj6l4lfWK3sVKSEtF+JdaR1RnR+mY5STnnmVTeERvhxSBGjSSHV+gJmWx4UIzaVyB7S/zlFq9inuPS227ywPFh74vwnlidAcUc2KRTBrO4OIPZmVGFo+uGSe//iLpo0HmwHZ8O47FNR4Sv8wM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=Zm6Jsf6b98ARIJ7Bx34hNaDRRccKODjLTiwR2PFi2pHpp4FQa8RH2dA9mHOH3OPbF3cdQrSwxrUrdSvlgoK+dgSG32zSHTM0QMroq9Q7i3EXry8bqQllHjsHAq1wABywROJx5UUvQLPg+lL70uGeM24Ciy0IpEJ6d7ngjzPtDOg=
Received: by 10.66.255.7 with SMTP id c7mr352097ugi.1195479320889;
        Mon, 19 Nov 2007 05:35:20 -0800 (PST)
Received: from ?10.0.63.9? ( [202.125.143.65])
        by mx.google.com with ESMTPS id 27sm6452179ugp.2007.11.19.05.35.13
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 19 Nov 2007 05:35:18 -0800 (PST)
Message-ID: <474190FE.2000105@gmail.com>
Date: Mon, 19 Nov 2007 18:34:54 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Lucene Setting
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I m new to lucene and want to clear about some questions.

When I unpacked the Lucene, which i downloaded from Apache site.

I ran the Build.txt file and there are five steps to set up lucene.

Lucene Build Instructions

$Id: BUILD.txt 476955 2006-11-19 22:28:41Z hossman $

Basic steps:
  0) Install JDK 1.4 (or greater), Ant 1.6.2 (or greater)

  1) Download Lucene from Apache and unpack it

  Step 2) Connect to the top-level of your Lucene installation

                            Lucene's top-level directory contains the 
build.xml file. By default,
                            you do not need to change any of the 
settings in this file, but you do
                            need to run ant from this location so it 
knows where to find build.xml.
   
                            If you would like to change settings you can 
do so by creating one
                            or more of the following files and placing 
your own property settings
                            in there:

                            ~/lucene.build.properties
                            ~/build.properties
                                lucene-x.y/build.properties

                            The first property which is found in the 
order with which the files are
                            loaded becomes the property setting which is 
used by the Ant build
                            system.

                            NOTE: the ~ character represents your user 
account home directory.

  3) Install JavaCC (optional)
  4) Run ant

I am not getting the 3rd instruction. Can you explain this line to me.

And one question more. is it necessary to build lucene using Ant or any 
other tool. What is the purpose of this?


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31086-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 13:44:47 2007
Return-Path: <java-user-return-31086-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5140 invoked from network); 19 Nov 2007 13:44:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 13:44:47 -0000
Received: (qmail 69164 invoked by uid 500); 19 Nov 2007 13:44:28 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69134 invoked by uid 500); 19 Nov 2007 13:44:28 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69123 invoked by uid 99); 19 Nov 2007 13:44:28 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 05:44:28 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 66.249.92.174 as permitted sender)
Received: from [66.249.92.174] (HELO ug-out-1314.google.com) (66.249.92.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 13:44:18 +0000
Received: by ug-out-1314.google.com with SMTP id h3so987715ugf
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 05:44:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=Cp3yu9P+1CjA7NLRPgQBn2et1rTFMlgogYqtEl9m7S4=;
        b=e5dg1BGAKCNGqN1cCqG/q7LpYib+L4Bpql72NcRZGRWrsRNtmP7s/XK9YO056095qFUCJ3QUQxa9sECft6t3h0Oy+ev+YWl5G77hdrKjDspQszkdJZfnbSQeJDFxPBBx816mkRr4uOpeeZ08QSZqne1M2rfjPjW/9LFv0bqLh4U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=P/Z/G/Hw32z1bxBo1pBjBHd4l1MpQ2kgizWNimCSMdqcB6468vlmWsQmAvI4xWxDNe8hZuOrrXErNakELXNEBXjtySCuYniDtRhcZpVG6Zh4wd2EvA2PR0Qly7X4f8grL7fwBVqCbMe7A1CQKDRyV2gDWDPdyvO/m/iaCsjlKss=
Received: by 10.67.106.19 with SMTP id i19mr1319585ugm.1195479850954;
        Mon, 19 Nov 2007 05:44:10 -0800 (PST)
Received: from ?10.0.63.9? ( [202.125.143.65])
        by mx.google.com with ESMTPS id g30sm13883788ugd.2007.11.19.05.43.42
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 19 Nov 2007 05:44:09 -0800 (PST)
Message-ID: <47419302.2020905@gmail.com>
Date: Mon, 19 Nov 2007 18:43:30 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Problem in Running Lucene Demo
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

I m new to Lucene. I m facing problem while running the Lucene Demo to 
index lucene src code.   I download the 2.1.0 version of Lucene and 
extracted it binary to C:\lucene-2.1.0.

I also set up the CLASSPATH to Lucene-Core and Lucene Demo Jar files. 
But when i execute the following command in command prompt

c:\java org.apache.lucene.demo.IndexFiles c:\lucene-2.1.0\src


I encounter the following error:

Exception in Thread "main" java.lang.NoClassDefoundError: 
org.apache.lucene.demo


I guess i m missing something in CLASSPATH setting. Kindly guide me in 
this Regard

Liaqat Ali







---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31087-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 13:55:06 2007
Return-Path: <java-user-return-31087-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7985 invoked from network); 19 Nov 2007 13:55:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 13:55:06 -0000
Received: (qmail 79978 invoked by uid 500); 19 Nov 2007 13:54:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79209 invoked by uid 500); 19 Nov 2007 13:54:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79192 invoked by uid 99); 19 Nov 2007 13:54:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 05:54:47 -0800
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp1.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 13:54:37 +0000
Received: from smtp1.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lAJDqMJA011212
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 08:52:22 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lAJDqL2X011209
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 08:52:21 -0500 (EST)
Received: from MAVS1.kendall.corp.akamai.com ([172.17.33.15]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 19 Nov 2007 08:54:28 -0500
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by MAVS1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 19 Nov 2007 08:54:28 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Lucene Setting
Date: Mon, 19 Nov 2007 19:24:25 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A620256C51E@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <474190FE.2000105@gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene Setting
Thread-Index: AcgqsSHNN/giWMBJQ+WFF7duk3mA1gAANj6g
References: <474190FE.2000105@gmail.com>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 19 Nov 2007 13:54:28.0544 (UTC) FILETIME=[B3E10400:01C82AB3]
X-Virus-Checked: Checked by ClamAV on apache.org

Liaqat,
What exactly are you looking for? Are you sure you want to build the
source of lucene and then use it? Alternatively you could simply use the
lucene jar file (ie. already built for you) and start playing around
with it. This jar file is bundled in the archive that you might have
downloaded. Look for lucene-core-2.2.0.jar

All the best

kapilChhabra


-----Original Message-----
From: Liaqat Ali [mailto:liaqatalimian@gmail.com]=20
Sent: Monday, November 19, 2007 7:05 PM
To: java-user@lucene.apache.org
Subject: Lucene Setting

I m new to lucene and want to clear about some questions.

When I unpacked the Lucene, which i downloaded from Apache site.

I ran the Build.txt file and there are five steps to set up lucene.

Lucene Build Instructions

$Id: BUILD.txt 476955 2006-11-19 22:28:41Z hossman $

Basic steps:
  0) Install JDK 1.4 (or greater), Ant 1.6.2 (or greater)

  1) Download Lucene from Apache and unpack it

  Step 2) Connect to the top-level of your Lucene installation

                            Lucene's top-level directory contains the
build.xml file. By default,
                            you do not need to change any of the
settings in this file, but you do
                            need to run ant from this location so it
knows where to find build.xml.
  =20
                            If you would like to change settings you can
do so by creating one
                            or more of the following files and placing
your own property settings
                            in there:

                            ~/lucene.build.properties
                            ~/build.properties
                                lucene-x.y/build.properties

                            The first property which is found in the
order with which the files are
                            loaded becomes the property setting which is
used by the Ant build
                            system.

                            NOTE: the ~ character represents your user
account home directory.

  3) Install JavaCC (optional)
  4) Run ant

I am not getting the 3rd instruction. Can you explain this line to me.

And one question more. is it necessary to build lucene using Ant or any
other tool. What is the purpose of this?


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31088-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 13:56:15 2007
Return-Path: <java-user-return-31088-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8412 invoked from network); 19 Nov 2007 13:56:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 13:56:14 -0000
Received: (qmail 82417 invoked by uid 500); 19 Nov 2007 13:55:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82381 invoked by uid 500); 19 Nov 2007 13:55:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82366 invoked by uid 99); 19 Nov 2007 13:55:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 05:55:55 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.177] (HELO spunkymail-a17.g.dreamhost.com) (208.97.132.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 13:55:44 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a17.g.dreamhost.com (Postfix) with ESMTP id 43AD374EB6
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 05:55:35 -0800 (PST)
Message-Id: <C19CFE98-3A03-40B1-B713-3842FC711030@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <474190FE.2000105@gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Lucene Setting
Date: Mon, 19 Nov 2007 08:55:34 -0500
References: <474190FE.2000105@gmail.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Ah, I see.  This just means change into the directory via the command  
line where you unpacked the installation.

HTH,
Grant

On Nov 19, 2007, at 8:34 AM, Liaqat Ali wrote:

> I m new to lucene and want to clear about some questions.
>
> When I unpacked the Lucene, which i downloaded from Apache site.
>
> I ran the Build.txt file and there are five steps to set up lucene.
>
> Lucene Build Instructions
>
> $Id: BUILD.txt 476955 2006-11-19 22:28:41Z hossman $
>
> Basic steps:
> 0) Install JDK 1.4 (or greater), Ant 1.6.2 (or greater)
>
> 1) Download Lucene from Apache and unpack it
>
> Step 2) Connect to the top-level of your Lucene installation
>
>                           Lucene's top-level directory contains the  
> build.xml file. By default,
>                           you do not need to change any of the  
> settings in this file, but you do
>                           need to run ant from this location so it  
> knows where to find build.xml.
>                             If you would like to change settings you  
> can do so by creating one
>                           or more of the following files and placing  
> your own property settings
>                           in there:
>
>                           ~/lucene.build.properties
>                           ~/build.properties
>                               lucene-x.y/build.properties
>
>                           The first property which is found in the  
> order with which the files are
>                           loaded becomes the property setting which  
> is used by the Ant build
>                           system.
>
>                           NOTE: the ~ character represents your user  
> account home directory.
>
> 3) Install JavaCC (optional)
> 4) Run ant
>
> I am not getting the 3rd instruction. Can you explain this line to me.
>
> And one question more. is it necessary to build lucene using Ant or  
> any other tool. What is the purpose of this?
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31089-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 14:13:12 2007
Return-Path: <java-user-return-31089-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12631 invoked from network); 19 Nov 2007 14:13:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 14:13:11 -0000
Received: (qmail 10138 invoked by uid 500); 19 Nov 2007 14:12:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9703 invoked by uid 500); 19 Nov 2007 14:12:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 9692 invoked by uid 99); 19 Nov 2007 14:12:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 06:12:52 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 72.14.246.251 as permitted sender)
Received: from [72.14.246.251] (HELO ag-out-0708.google.com) (72.14.246.251)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 14:12:42 +0000
Received: by ag-out-0708.google.com with SMTP id 5so1109883agb
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 06:12:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=unXY3KieZk0pV85DJkH8W/Biz3NrWiqFNla4Oxs7yUY=;
        b=O3JM58WaFhqHrxkadsL5Y0BQ3/VIX2aImLYv0+abwEdefTOujM3KtYI84bAqzdC6ifEflr026K9DDfKA+N5e52v6xcY4uzmUJbGGjZbGGvbP6gQyZIWNCwwHzhQfoNzK0FEFQyMMDWiZWh5e5sKGfw3TMsl4/LQNHOME/Zom6VY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=nHXZUrAFYwMChdtMg2a+M7Zm3DGN1g5XK4Zafv7vC8I0JGUCFrRTlum10GTPb8p630PvlkvHUQIV4SucvLfnkogAMzPIc9tEc7aeddzt/x9fFk38s7ztDu5aFbAuXCig0o3uCuNoxleYQXO1DFuGzRu5Pltiej6hmPuGCQPxjDc=
Received: by 10.150.91.20 with SMTP id o20mr543466ybb.1195481554387;
        Mon, 19 Nov 2007 06:12:34 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Mon, 19 Nov 2007 06:12:34 -0800 (PST)
Message-ID: <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
Date: Mon, 19 Nov 2007 11:12:34 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <4740C637.2010809@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
	 <4740C637.2010809@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Mark,

  How I can get the information of Document. I think that is in the
implementation do method abstract collect. How I can get it .

  Below is the example of javadoc the Lucene.

Searcher searcher = new IndexSearcher(indexReader);
   final BitSet bits = new BitSet(indexReader.maxDoc());
   searcher.search(query, new HitCollector() {
       public void collect(int doc, float score) {
         bits.set(doc);
       }
     });

 Thanks


On Nov 18, 2007 8:09 PM, Mark Miller <markrmiller@gmail.com> wrote:
> Hey Haroldo.
>
> First thing you need to do is *stop* using Hits in your searches. Hits
> is optimized for some pretty specific use cases and you will get along
> much better by using a HitCollector.
>
> Hits has three main functions:
>
> It caches documents, normalizes scores, and stores ids associated with
> scores (a HitDoc). If you attempt to retrieve a HitDoc past the first
> 100 from Hits, a new search will be issued to grab double the required
> HitDocs needed to satisfy your HitDoc retrieval attempt. This will be
> repeated everytime you ask for a HitDoc beyond the current cache (which
> began at 100). This means that if you need to get a HitDoc beyond 100,
> Hits is not a great choice for you. You will want to use the
> HitCollector instead...but remember that you are losing the normalized
> scores (simple to copy code if you still want it) and the document
> caching (I rarely want that anyway).
>
> An issue to watch out for: with Hits, you do not have to ask for how
> many docs to get back, but with a HitCollector solution you will need
> to. This is a minor dilema if you want to go over all of the hits no
> matter what. You can pass a huge number to ensure you get everything,
> but you will be creating large data structures if you do this, as
> structure sizes may be initialized by the number you pass. Also, passing
> the maximum integer will cause an error (negative init size) as Lucene
> initializes a data structure to hold the hits as n+1.
>
> - Mark
>
>
> Haroldo Nascimento wrote:
> > I have a problem of performance when I need group the result do search
> >
> > I have the code below:
> >
> >    for (int i = 0; i < hits.length(); i++) {
> >                     doc = hits.doc(i);
> >
> >                     obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
> >                     obj2 = doc.get(xxx);
> >                     ...
> >    }
> >
> >   I work with volume of data very big. The search process in 0.300
> > seconds but when the object hits have much results, the time for get
> > all objects is very big. The command hits.doc(i) is processed in 2
> > second.
> >
> >   Por exemplo. For hits.length() equals the 25.000 results, the time
> > of "pos search" is 7 seconds.
> >
> >   I get all result because I need group the result (remove the
> > duplicate results).
> >
> >   Is there any form in Lucene that group the result. I need of
> > anything as the command "group by" of sql.
> >
> >   Thanks.
> >
>
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31090-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 14:23:05 2007
Return-Path: <java-user-return-31090-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17188 invoked from network); 19 Nov 2007 14:23:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 14:23:05 -0000
Received: (qmail 25909 invoked by uid 500); 19 Nov 2007 14:22:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25871 invoked by uid 500); 19 Nov 2007 14:22:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25860 invoked by uid 99); 19 Nov 2007 14:22:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 06:22:46 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of DORONC@il.ibm.com designates 195.212.29.155 as permitted sender)
Received: from [195.212.29.155] (HELO mtagate6.de.ibm.com) (195.212.29.155)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 14:22:34 +0000
Received: from d12nrmr1607.megacenter.de.ibm.com (d12nrmr1607.megacenter.de.ibm.com [9.149.167.49])
	by mtagate6.de.ibm.com (8.13.8/8.13.8) with ESMTP id lAJEMPVZ489108
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 14:22:25 GMT
Received: from d12av04.megacenter.de.ibm.com (d12av04.megacenter.de.ibm.com [9.149.165.229])
	by d12nrmr1607.megacenter.de.ibm.com (8.13.8/8.13.8/NCO v8.6) with ESMTP id lAJEMOXG2936858
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 15:22:24 +0100
Received: from d12av04.megacenter.de.ibm.com (loopback [127.0.0.1])
	by d12av04.megacenter.de.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id lAJEMOjh010336
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 15:22:24 +0100
Received: from d12mc102.megacenter.de.ibm.com (d12mc102.megacenter.de.ibm.com [9.149.167.114])
	by d12av04.megacenter.de.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id lAJEMOu9010333
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 15:22:24 +0100
In-Reply-To: <47419302.2020905@gmail.com>
Subject: Re: Problem in Running Lucene Demo
To: java-user@lucene.apache.org
X-Mailer: Lotus Notes Release 7.0 HF277 June 21, 2006
Message-ID: <OFCE6E85CA.A782E1DA-ONC2257398.004E8837-C2257398.004ECF57@il.ibm.com>
From: Doron Cohen <DORONC@il.ibm.com>
Date: Mon, 19 Nov 2007 16:20:48 +0200
X-MIMETrack: Serialize by Router on D12MC102/12/M/IBM(Release 7.0.2HF71 | November 3, 2006) at
 19/11/2007 16:22:24
MIME-Version: 1.0
Content-type: text/plain; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org

Try "java -verbose" to see more info on class loading.
Also try "java -classpath=yourClassPath" from command line.
Note that separators in the classpath may differ between operating
systems - e.g. ";" in Windows but ":" in Linux...

Doron

Liaqat Ali <liaqatalimian@gmail.com> wrote on 19/11/2007 15:43:30:

> Hi All,
>
> I m new to Lucene. I m facing problem while running the Lucene Demo to
> index lucene src code.   I download the 2.1.0 version of Lucene and
> extracted it binary to C:\lucene-2.1.0.
>
> I also set up the CLASSPATH to Lucene-Core and Lucene Demo Jar files.
> But when i execute the following command in command prompt
>
> c:\java org.apache.lucene.demo.IndexFiles c:\lucene-2.1.0\src
>
>
> I encounter the following error:
>
> Exception in Thread "main" java.lang.NoClassDefoundError:
> org.apache.lucene.demo
>
>
> I guess i m missing something in CLASSPATH setting. Kindly guide me in
> this Regard
>
> Liaqat Ali


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31091-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 14:38:03 2007
Return-Path: <java-user-return-31091-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21746 invoked from network); 19 Nov 2007 14:38:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 14:38:03 -0000
Received: (qmail 42839 invoked by uid 500); 19 Nov 2007 14:37:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41932 invoked by uid 500); 19 Nov 2007 14:37:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41921 invoked by uid 99); 19 Nov 2007 14:37:44 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 06:37:44 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of german.kondolf@gmail.com designates 209.85.146.177 as permitted sender)
Received: from [209.85.146.177] (HELO wa-out-1112.google.com) (209.85.146.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 14:37:32 +0000
Received: by wa-out-1112.google.com with SMTP id j40so2182769wah
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 06:37:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=k41Sz1h4OF3l7Rc3jHD1Lyw3nX+0PvvzvNXHXMazEc0=;
        b=hI4hFb7X7fdEXVqKaQejQyaZqZmVZketfLIuzyvTOBkjBepTz82W46+qJdVa4G/MiDG1dr8KHw0mDWgcFUEhjLlgxyNiC3ZDeSyMjzI/D6qplprws1PTwcBp9m1z8iU2pQ4i+i849SHudQ1p9PJWxy9NziZX2ZiP+Fb71XqsSPY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=ABECT/pJZIEvr2A8LQj0rQag6ozyozpSVA3Q1OKQ5TOJxW/cFrDiCdaKd+AGfqkx7ccV4exRmX9Rr+X3D1M5y2127EpxiABRTe9ewhGUIs+ONpyZhkin1uV1ZKvwnEByvBd5AA9MQmaDXaBwfJtSA90fWOnctXFCNAkHzZ9/CS0=
Received: by 10.114.13.1 with SMTP id 1mr478843wam.1195483046358;
        Mon, 19 Nov 2007 06:37:26 -0800 (PST)
Received: by 10.114.124.18 with HTTP; Mon, 19 Nov 2007 06:37:26 -0800 (PST)
Message-ID: <76df56980711190637k68b19412nefc9ca668c22dff@mail.gmail.com>
Date: Mon, 19 Nov 2007 11:37:26 -0300
From: "German Kondolf" <german.kondolf@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
	 <4740C637.2010809@gmail.com>
	 <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Why do you need the doc's info?
If you're grouping you may not need detail on each group condition.

Here is a sample of faceted (grouped) search:
http://listados.deremate.com.ar/mp3

(Sorry, it's in spanish)

Simply I collect every facet's bitset and intersect it against the
result's bitset (keyword).
I've got an LRU cache of the bitsets using OSCache and works great!

German K.

On Nov 19, 2007 11:12 AM, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
> Mark,
>
>   How I can get the information of Document. I think that is in the
> implementation do method abstract collect. How I can get it .
>
>   Below is the example of javadoc the Lucene.
>
> Searcher searcher = new IndexSearcher(indexReader);
>    final BitSet bits = new BitSet(indexReader.maxDoc());
>    searcher.search(query, new HitCollector() {
>        public void collect(int doc, float score) {
>          bits.set(doc);
>        }
>      });
>
>  Thanks
>
>
>
> On Nov 18, 2007 8:09 PM, Mark Miller <markrmiller@gmail.com> wrote:
> > Hey Haroldo.
> >
> > First thing you need to do is *stop* using Hits in your searches. Hits
> > is optimized for some pretty specific use cases and you will get along
> > much better by using a HitCollector.
> >
> > Hits has three main functions:
> >
> > It caches documents, normalizes scores, and stores ids associated with
> > scores (a HitDoc). If you attempt to retrieve a HitDoc past the first
> > 100 from Hits, a new search will be issued to grab double the required
> > HitDocs needed to satisfy your HitDoc retrieval attempt. This will be
> > repeated everytime you ask for a HitDoc beyond the current cache (which
> > began at 100). This means that if you need to get a HitDoc beyond 100,
> > Hits is not a great choice for you. You will want to use the
> > HitCollector instead...but remember that you are losing the normalized
> > scores (simple to copy code if you still want it) and the document
> > caching (I rarely want that anyway).
> >
> > An issue to watch out for: with Hits, you do not have to ask for how
> > many docs to get back, but with a HitCollector solution you will need
> > to. This is a minor dilema if you want to go over all of the hits no
> > matter what. You can pass a huge number to ensure you get everything,
> > but you will be creating large data structures if you do this, as
> > structure sizes may be initialized by the number you pass. Also, passing
> > the maximum integer will cause an error (negative init size) as Lucene
> > initializes a data structure to hold the hits as n+1.
> >
> > - Mark
> >
> >
> > Haroldo Nascimento wrote:
> > > I have a problem of performance when I need group the result do search
> > >
> > > I have the code below:
> > >
> > >    for (int i = 0; i < hits.length(); i++) {
> > >                     doc = hits.doc(i);
> > >
> > >                     obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
> > >                     obj2 = doc.get(xxx);
> > >                     ...
> > >    }
> > >
> > >   I work with volume of data very big. The search process in 0.300
> > > seconds but when the object hits have much results, the time for get
> > > all objects is very big. The command hits.doc(i) is processed in 2
> > > second.
> > >
> > >   Por exemplo. For hits.length() equals the 25.000 results, the time
> > > of "pos search" is 7 seconds.
> > >
> > >   I get all result because I need group the result (remove the
> > > duplicate results).
> > >
> > >   Is there any form in Lucene that group the result. I need of
> > > anything as the command "group by" of sql.
> > >
> > >   Thanks.
> > >
> >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31092-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 15:06:28 2007
Return-Path: <java-user-return-31092-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36275 invoked from network); 19 Nov 2007 15:06:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 15:06:28 -0000
Received: (qmail 96108 invoked by uid 500); 19 Nov 2007 15:06:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96079 invoked by uid 500); 19 Nov 2007 15:06:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96068 invoked by uid 99); 19 Nov 2007 15:06:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 07:06:09 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a8.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 15:05:57 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a8.g.dreamhost.com (Postfix) with ESMTP id 68A1510BBB4
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 07:05:47 -0800 (PST)
Message-Id: <CE28066E-E8D1-4BC4-8922-7B848D8B08FA@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Time of processing hits.doc()
Date: Mon, 19 Nov 2007 10:05:48 -0500
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com> <4740C637.2010809@gmail.com> <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

I think, based on your previous question, that you just need to use  
the search() method that returns TopDocs, not the lower-level  
HitCollector method.  From the TopDocs, you can then access the  
ScoreDoc, which will give you info about the doc and the score.  See http://www.lucenebootcamp.com/LuceneBootCamp/training/src/test/java/com/lucenebootcamp/training/basic/TopDocsTest.java 
  from my Lucene Boot Camp training class for a really simple example.

-Grant

On Nov 19, 2007, at 9:12 AM, Haroldo Nascimento wrote:

> Mark,
>
>  How I can get the information of Document. I think that is in the
> implementation do method abstract collect. How I can get it .
>
>  Below is the example of javadoc the Lucene.
>
> Searcher searcher = new IndexSearcher(indexReader);
>   final BitSet bits = new BitSet(indexReader.maxDoc());
>   searcher.search(query, new HitCollector() {
>       public void collect(int doc, float score) {
>         bits.set(doc);
>       }
>     });
>
> Thanks
>
>
> On Nov 18, 2007 8:09 PM, Mark Miller <markrmiller@gmail.com> wrote:
>> Hey Haroldo.
>>
>> First thing you need to do is *stop* using Hits in your searches.  
>> Hits
>> is optimized for some pretty specific use cases and you will get  
>> along
>> much better by using a HitCollector.
>>
>> Hits has three main functions:
>>
>> It caches documents, normalizes scores, and stores ids associated  
>> with
>> scores (a HitDoc). If you attempt to retrieve a HitDoc past the first
>> 100 from Hits, a new search will be issued to grab double the  
>> required
>> HitDocs needed to satisfy your HitDoc retrieval attempt. This will be
>> repeated everytime you ask for a HitDoc beyond the current cache  
>> (which
>> began at 100). This means that if you need to get a HitDoc beyond  
>> 100,
>> Hits is not a great choice for you. You will want to use the
>> HitCollector instead...but remember that you are losing the  
>> normalized
>> scores (simple to copy code if you still want it) and the document
>> caching (I rarely want that anyway).
>>
>> An issue to watch out for: with Hits, you do not have to ask for how
>> many docs to get back, but with a HitCollector solution you will need
>> to. This is a minor dilema if you want to go over all of the hits no
>> matter what. You can pass a huge number to ensure you get everything,
>> but you will be creating large data structures if you do this, as
>> structure sizes may be initialized by the number you pass. Also,  
>> passing
>> the maximum integer will cause an error (negative init size) as  
>> Lucene
>> initializes a data structure to hold the hits as n+1.
>>
>> - Mark
>>
>>
>> Haroldo Nascimento wrote:
>>> I have a problem of performance when I need group the result do  
>>> search
>>>
>>> I have the code below:
>>>
>>>   for (int i = 0; i < hits.length(); i++) {
>>>                    doc = hits.doc(i);
>>>
>>>                    obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
>>>                    obj2 = doc.get(xxx);
>>>                    ...
>>>   }
>>>
>>>  I work with volume of data very big. The search process in 0.300
>>> seconds but when the object hits have much results, the time for get
>>> all objects is very big. The command hits.doc(i) is processed in 2
>>> second.
>>>
>>>  Por exemplo. For hits.length() equals the 25.000 results, the time
>>> of "pos search" is 7 seconds.
>>>
>>>  I get all result because I need group the result (remove the
>>> duplicate results).
>>>
>>>  Is there any form in Lucene that group the result. I need of
>>> anything as the command "group by" of sql.
>>>
>>>  Thanks.
>>>
>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31093-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 16:06:26 2007
Return-Path: <java-user-return-31093-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73235 invoked from network); 19 Nov 2007 16:06:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 16:06:26 -0000
Received: (qmail 91333 invoked by uid 500); 19 Nov 2007 16:06:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91293 invoked by uid 500); 19 Nov 2007 16:06:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91282 invoked by uid 99); 19 Nov 2007 16:06:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 08:06:07 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [209.73.178.145] (HELO web60417.mail.yahoo.com) (209.73.178.145)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 19 Nov 2007 16:05:56 +0000
Received: (qmail 40357 invoked by uid 60001); 19 Nov 2007 16:05:48 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=H1Woz70w6y/yhaN6vD57HYT/8ZM+cQJ6fbpOFQc1iepVnLJfKNkKkKOwdrGV4RK/UtcWePihAbuSuT6Oln/Fg1USMOc0JauysX5iTRNS19DEDf/mnXAr9DmIrqMUsYTNrEEILFNPjmDB4KsQfu4w8x4eFbw616M/wZ0iPQuHAFc=;
X-YMail-OSG: B1O5gOMVM1kOpxJ7UsCgHjOc5qd78utHfJlrsYDewMrwtgBxBAAZa2GkfIk1YBiaIgCz5PCgYsS.WPI2nnVQubClbwgsBJTH299r08709vjHvztSwkfo
Received: from [141.217.223.215] by web60417.mail.yahoo.com via HTTP; Mon, 19 Nov 2007 08:05:48 PST
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.157
Date: Mon, 19 Nov 2007 08:05:48 -0800 (PST)
From: HAIDUC SONIA <haiduc_sonia@yahoo.com>
Subject: Scoring for all the documents in the index relative to a query
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-97721374-1195488348=:39834"
Message-ID: <604180.39834.qm@web60417.mail.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-97721374-1195488348=:39834
Content-Type: text/plain; charset=us-ascii

Hi everyone,

I am trying to obtain the score for each document in the index relative to a given query. For example, if I have the query "search file", I am trying to get the list of all documents in the index and their scores relative to the given query. I tried first using Hits, which gave me the normalized score. I thought that I don't see the whole list of documents and their scores because of the normalization, so I tried using HitsCollector. But even after using HitsCollector, I get the same number of matching documents, so the normalization didn't exclude documents because of negative scoring. Does Lucene actually compute the score for all the documents in the index or just for matching documents? I really need to have the scores for all the documents in the index relative to the query (even if negative), not just the ones that contain the query terms(this is what Lucene considers "matching documents", right?). Is this possible using Lucene?

I really appreciate your time and effort!
Thanks,
Sonia




      ____________________________________________________________________________________
Get easy, one-click access to your favorites. 
Make Yahoo! your homepage.
http://www.yahoo.com/r/hs 
--0-97721374-1195488348=:39834--

From java-user-return-31094-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 16:06:35 2007
Return-Path: <java-user-return-31094-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73350 invoked from network); 19 Nov 2007 16:06:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 16:06:35 -0000
Received: (qmail 93012 invoked by uid 500); 19 Nov 2007 16:06:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92973 invoked by uid 500); 19 Nov 2007 16:06:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92962 invoked by uid 99); 19 Nov 2007 16:06:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 08:06:15 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 72.14.246.248 as permitted sender)
Received: from [72.14.246.248] (HELO ag-out-0708.google.com) (72.14.246.248)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 16:06:03 +0000
Received: by ag-out-0708.google.com with SMTP id 5so1139518agb
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 08:05:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=NID4GFlRpnC12Mk2ldTMcYIqYTGeDL/OA0uwjNrjktc=;
        b=FBit+aBTByoLlikOqmh2js0YXN9YD/DLDQRQ+APnNJ9iNS4BLcfYv2/MX00Z3oJvYUSOP57qOkbpDXf3p2tHSvQENgvRxFEgk9j/rvRfo/Tjh0twWnqhBUN9X+YyVi2NWAA+5wM2qByI6EMh5V8UoYTxeczKgUi88gOufy31zUU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=JiQypVnliQVujcRAX+UbCxvF/0wIlntrYmHCJU7HoBm6LQ92REYf9T5cLsVhsXYeTw0uPp9dU4j6MEZbYxvg1X2jlXiaKc9fUM3ETsJAww1aGwSWxRvT09GAQ+bT1z38ihO13eSNmdtJlH8VHxr5hp+PuUtUfpNSsdat4IJBsnQ=
Received: by 10.151.12.1 with SMTP id p1mr591074ybi.1195488355790;
        Mon, 19 Nov 2007 08:05:55 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Mon, 19 Nov 2007 08:05:55 -0800 (PST)
Message-ID: <718789d20711190805p4b49241epdbdf63ddee32c93b@mail.gmail.com>
Date: Mon, 19 Nov 2007 13:05:55 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <CE28066E-E8D1-4BC4-8922-7B848D8B08FA@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
	 <4740C637.2010809@gmail.com>
	 <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
	 <CE28066E-E8D1-4BC4-8922-7B848D8B08FA@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

German,

  What I need is similar to the your site
http://listados.deremate.com.ar/panaderia .
  I have many results of search, but I show any result (for example:
first 10 for first page) , but for create the options of filter of
location I need read all results fof search. The problem of
performance is when I have 30.000 results.

  How you get the filter the "ubication" ? You need read all results ?

  thanks

On Nov 19, 2007 12:05 PM, Grant Ingersoll <gsingers@apache.org> wrote:
> I think, based on your previous question, that you just need to use
> the search() method that returns TopDocs, not the lower-level
> HitCollector method.  From the TopDocs, you can then access the
> ScoreDoc, which will give you info about the doc and the score.  See http://www.lucenebootcamp.com/LuceneBootCamp/training/src/test/java/com/lucenebootcamp/training/basic/TopDocsTest.java
>  from my Lucene Boot Camp training class for a really simple example.
>
> -Grant
>
>
> On Nov 19, 2007, at 9:12 AM, Haroldo Nascimento wrote:
>
> > Mark,
> >
> >  How I can get the information of Document. I think that is in the
> > implementation do method abstract collect. How I can get it .
> >
> >  Below is the example of javadoc the Lucene.
> >
> > Searcher searcher = new IndexSearcher(indexReader);
> >   final BitSet bits = new BitSet(indexReader.maxDoc());
> >   searcher.search(query, new HitCollector() {
> >       public void collect(int doc, float score) {
> >         bits.set(doc);
> >       }
> >     });
> >
> > Thanks
> >
> >
> > On Nov 18, 2007 8:09 PM, Mark Miller <markrmiller@gmail.com> wrote:
> >> Hey Haroldo.
> >>
> >> First thing you need to do is *stop* using Hits in your searches.
> >> Hits
> >> is optimized for some pretty specific use cases and you will get
> >> along
> >> much better by using a HitCollector.
> >>
> >> Hits has three main functions:
> >>
> >> It caches documents, normalizes scores, and stores ids associated
> >> with
> >> scores (a HitDoc). If you attempt to retrieve a HitDoc past the first
> >> 100 from Hits, a new search will be issued to grab double the
> >> required
> >> HitDocs needed to satisfy your HitDoc retrieval attempt. This will be
> >> repeated everytime you ask for a HitDoc beyond the current cache
> >> (which
> >> began at 100). This means that if you need to get a HitDoc beyond
> >> 100,
> >> Hits is not a great choice for you. You will want to use the
> >> HitCollector instead...but remember that you are losing the
> >> normalized
> >> scores (simple to copy code if you still want it) and the document
> >> caching (I rarely want that anyway).
> >>
> >> An issue to watch out for: with Hits, you do not have to ask for how
> >> many docs to get back, but with a HitCollector solution you will need
> >> to. This is a minor dilema if you want to go over all of the hits no
> >> matter what. You can pass a huge number to ensure you get everything,
> >> but you will be creating large data structures if you do this, as
> >> structure sizes may be initialized by the number you pass. Also,
> >> passing
> >> the maximum integer will cause an error (negative init size) as
> >> Lucene
> >> initializes a data structure to hold the hits as n+1.
> >>
> >> - Mark
> >>
> >>
> >> Haroldo Nascimento wrote:
> >>> I have a problem of performance when I need group the result do
> >>> search
> >>>
> >>> I have the code below:
> >>>
> >>>   for (int i = 0; i < hits.length(); i++) {
> >>>                    doc = hits.doc(i);
> >>>
> >>>                    obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
> >>>                    obj2 = doc.get(xxx);
> >>>                    ...
> >>>   }
> >>>
> >>>  I work with volume of data very big. The search process in 0.300
> >>> seconds but when the object hits have much results, the time for get
> >>> all objects is very big. The command hits.doc(i) is processed in 2
> >>> second.
> >>>
> >>>  Por exemplo. For hits.length() equals the 25.000 results, the time
> >>> of "pos search" is 7 seconds.
> >>>
> >>>  I get all result because I need group the result (remove the
> >>> duplicate results).
> >>>
> >>>  Is there any form in Lucene that group the result. I need of
> >>> anything as the command "group by" of sql.
> >>>
> >>>  Thanks.
> >>>
> >>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>>
> >>>
> >>>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> For additional commands, e-mail: java-user-help@lucene.apache.org
> >>
> >>
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31095-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 16:10:04 2007
Return-Path: <java-user-return-31095-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74743 invoked from network); 19 Nov 2007 16:10:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 16:10:03 -0000
Received: (qmail 297 invoked by uid 500); 19 Nov 2007 16:09:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 272 invoked by uid 500); 19 Nov 2007 16:09:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 261 invoked by uid 99); 19 Nov 2007 16:09:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 08:09:43 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 72.14.214.232 as permitted sender)
Received: from [72.14.214.232] (HELO hu-out-0506.google.com) (72.14.214.232)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 16:09:30 +0000
Received: by hu-out-0506.google.com with SMTP id 27so1099509hub
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 08:09:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=2/cLj60P1FyVdHbiysjl0VBBnGV5/twyID/GfiyIYaU=;
        b=dvj8I+TWz2dU3yWrz5dlq9GHH480fSueQvRysrsViMudA+dlULGxFr00shoWMPVAOA1rXss72pfbQyAWUH2+SaunDYi5YnHIcuELP9XDA47dKjGCIf2Tnv0YJZCRYSexphfxdCFphEXkmH29eMAd8wZZ6NI8qy/dDGkA8mcNzME=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=oIE5IMkaK/8A1OM91/j5tSpOfnZ6Aw3MkmyJwolS9Y0bed0ExadTE+1By4iKnYc35RfWWBhCzqyRSH/MjcXBqUHh9YxJ6s4eI5BkVZMDY975RR9GxEx5wcVt+zzW5tNqYin2ejp9lRD71pSBx0zJ9eeSbYpqx/cvhj804zoXpns=
Received: by 10.150.152.17 with SMTP id z17mr592101ybd.1195488561505;
        Mon, 19 Nov 2007 08:09:21 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Mon, 19 Nov 2007 08:09:21 -0800 (PST)
Message-ID: <718789d20711190809w4c8c7a53k4324f4b01d7c608e@mail.gmail.com>
Date: Mon, 19 Nov 2007 13:09:21 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <718789d20711190805p4b49241epdbdf63ddee32c93b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
	 <4740C637.2010809@gmail.com>
	 <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
	 <CE28066E-E8D1-4BC4-8922-7B848D8B08FA@apache.org>
	 <718789d20711190805p4b49241epdbdf63ddee32c93b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

German,

When You said:
 "I collect every facet's bitset ... "
  what is a facet ? Is there the each option of filter of your site ?
How you get the every facets ?





On Nov 19, 2007 1:05 PM, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
> German,
>
>  What I need is similar to the your site
> http://listados.deremate.com.ar/panaderia .
>  I have many results of search, but I show any result (for example:
> first 10 for first page) , but for create the options of filter of
> location I need read all results fof search. The problem of
> performance is when I have 30.000 results.
>
>  How you get the filter the "ubication" ? You need read all results ?
>
>  thanks
>
>
> On Nov 19, 2007 12:05 PM, Grant Ingersoll <gsingers@apache.org> wrote:
> > I think, based on your previous question, that you just need to use
> > the search() method that returns TopDocs, not the lower-level
> > HitCollector method.  From the TopDocs, you can then access the
> > ScoreDoc, which will give you info about the doc and the score.  See http://www.lucenebootcamp.com/LuceneBootCamp/training/src/test/java/com/lucenebootcamp/training/basic/TopDocsTest.java
> >  from my Lucene Boot Camp training class for a really simple example.
> >
> > -Grant
> >
> >
> > On Nov 19, 2007, at 9:12 AM, Haroldo Nascimento wrote:
> >
> > > Mark,
> > >
> > >  How I can get the information of Document. I think that is in the
> > > implementation do method abstract collect. How I can get it .
> > >
> > >  Below is the example of javadoc the Lucene.
> > >
> > > Searcher searcher = new IndexSearcher(indexReader);
> > >   final BitSet bits = new BitSet(indexReader.maxDoc());
> > >   searcher.search(query, new HitCollector() {
> > >       public void collect(int doc, float score) {
> > >         bits.set(doc);
> > >       }
> > >     });
> > >
> > > Thanks
> > >
> > >
> > > On Nov 18, 2007 8:09 PM, Mark Miller <markrmiller@gmail.com> wrote:
> > >> Hey Haroldo.
> > >>
> > >> First thing you need to do is *stop* using Hits in your searches.
> > >> Hits
> > >> is optimized for some pretty specific use cases and you will get
> > >> along
> > >> much better by using a HitCollector.
> > >>
> > >> Hits has three main functions:
> > >>
> > >> It caches documents, normalizes scores, and stores ids associated
> > >> with
> > >> scores (a HitDoc). If you attempt to retrieve a HitDoc past the first
> > >> 100 from Hits, a new search will be issued to grab double the
> > >> required
> > >> HitDocs needed to satisfy your HitDoc retrieval attempt. This will be
> > >> repeated everytime you ask for a HitDoc beyond the current cache
> > >> (which
> > >> began at 100). This means that if you need to get a HitDoc beyond
> > >> 100,
> > >> Hits is not a great choice for you. You will want to use the
> > >> HitCollector instead...but remember that you are losing the
> > >> normalized
> > >> scores (simple to copy code if you still want it) and the document
> > >> caching (I rarely want that anyway).
> > >>
> > >> An issue to watch out for: with Hits, you do not have to ask for how
> > >> many docs to get back, but with a HitCollector solution you will need
> > >> to. This is a minor dilema if you want to go over all of the hits no
> > >> matter what. You can pass a huge number to ensure you get everything,
> > >> but you will be creating large data structures if you do this, as
> > >> structure sizes may be initialized by the number you pass. Also,
> > >> passing
> > >> the maximum integer will cause an error (negative init size) as
> > >> Lucene
> > >> initializes a data structure to hold the hits as n+1.
> > >>
> > >> - Mark
> > >>
> > >>
> > >> Haroldo Nascimento wrote:
> > >>> I have a problem of performance when I need group the result do
> > >>> search
> > >>>
> > >>> I have the code below:
> > >>>
> > >>>   for (int i = 0; i < hits.length(); i++) {
> > >>>                    doc = hits.doc(i);
> > >>>
> > >>>                    obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
> > >>>                    obj2 = doc.get(xxx);
> > >>>                    ...
> > >>>   }
> > >>>
> > >>>  I work with volume of data very big. The search process in 0.300
> > >>> seconds but when the object hits have much results, the time for get
> > >>> all objects is very big. The command hits.doc(i) is processed in 2
> > >>> second.
> > >>>
> > >>>  Por exemplo. For hits.length() equals the 25.000 results, the time
> > >>> of "pos search" is 7 seconds.
> > >>>
> > >>>  I get all result because I need group the result (remove the
> > >>> duplicate results).
> > >>>
> > >>>  Is there any form in Lucene that group the result. I need of
> > >>> anything as the command "group by" of sql.
> > >>>
> > >>>  Thanks.
> > >>>
> > >>
> > >>> ---------------------------------------------------------------------
> > >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>>
> > >>>
> > >>>
> > >>
> > >> ---------------------------------------------------------------------
> > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>
> > >>
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> >
> > --------------------------
> > Grant Ingersoll
> > http://lucene.grantingersoll.com
> >
> > Lucene Helpful Hints:
> > http://wiki.apache.org/lucene-java/BasicsOfPerformance
> > http://wiki.apache.org/lucene-java/LuceneFAQ
> >
> >
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31096-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 16:20:20 2007
Return-Path: <java-user-return-31096-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77891 invoked from network); 19 Nov 2007 16:20:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 16:20:20 -0000
Received: (qmail 18398 invoked by uid 500); 19 Nov 2007 16:20:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 18126 invoked by uid 500); 19 Nov 2007 16:20:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 18115 invoked by uid 99); 19 Nov 2007 16:20:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 08:20:00 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of german.kondolf@gmail.com designates 64.233.162.233 as permitted sender)
Received: from [64.233.162.233] (HELO nz-out-0506.google.com) (64.233.162.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 16:19:49 +0000
Received: by nz-out-0506.google.com with SMTP id i28so1303575nzi
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 08:19:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=XueCr+xitE+/IMjroyUWEuOU7NaD0MrszA0OJQDhPJc=;
        b=nER1stV0JFy7v92PbbY6vJTkrvAHLKmBFDSFbDN/2esF0etz5SfVlemEo6GwnUXR3xoqpgh2ggunLQOV7gBz1tkdBTTq8PRVSwVkLIhENuq93LZKqqtZmklv31gP58VSGKiyWMwg2a3OnN9SiZ14N5H8SUn0WK5LwsMagxNTXcU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=AaJojuqdY57HZwzp8UnO4fE+1gHZ63Utylo1cpesG24krGP/1GIqaTRihbi1KhwNEAH959NfaiX+DBqGfgiMJg1zq+CD155QukOkgjfVMXgPm1oJX8O2VoxPQ7U+NF6tZHqnsdLaKDQWze/5FIiGvoikKgH8qj4+gnU4o+Q9ssc=
Received: by 10.114.177.1 with SMTP id z1mr249988wae.1195489180061;
        Mon, 19 Nov 2007 08:19:40 -0800 (PST)
Received: by 10.114.124.18 with HTTP; Mon, 19 Nov 2007 08:19:39 -0800 (PST)
Message-ID: <76df56980711190819o9acd211q798412af04a770d4@mail.gmail.com>
Date: Mon, 19 Nov 2007 13:19:39 -0300
From: "German Kondolf" <german.kondolf@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <718789d20711190805p4b49241epdbdf63ddee32c93b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
	 <4740C637.2010809@gmail.com>
	 <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
	 <CE28066E-E8D1-4BC4-8922-7B848D8B08FA@apache.org>
	 <718789d20711190805p4b49241epdbdf63ddee32c93b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I have already defined a Lucene Filter for every "id" of "ubicacion".
I just create the bitset for every value, and count it against the result.

One possible optimization is to read the terms of the field you're
trying to "group", that's the optimization we'll be working soon on
our app.

I never read all the results.

On Nov 19, 2007 1:05 PM, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
> German,
>
>   What I need is similar to the your site
> http://listados.deremate.com.ar/panaderia .
>   I have many results of search, but I show any result (for example:
> first 10 for first page) , but for create the options of filter of
> location I need read all results fof search. The problem of
> performance is when I have 30.000 results.
>
>   How you get the filter the "ubication" ? You need read all results ?
>
>   thanks
>
> On Nov 19, 2007 12:05 PM, Grant Ingersoll <gsingers@apache.org> wrote:
> > I think, based on your previous question, that you just need to use
> > the search() method that returns TopDocs, not the lower-level
> > HitCollector method.  From the TopDocs, you can then access the
> > ScoreDoc, which will give you info about the doc and the score.  See http://www.lucenebootcamp.com/LuceneBootCamp/training/src/test/java/com/lucenebootcamp/training/basic/TopDocsTest.java
> >  from my Lucene Boot Camp training class for a really simple example.
> >
> > -Grant
>
> >
> >
> > On Nov 19, 2007, at 9:12 AM, Haroldo Nascimento wrote:
> >
> > > Mark,
> > >
> > >  How I can get the information of Document. I think that is in the
> > > implementation do method abstract collect. How I can get it .
> > >
> > >  Below is the example of javadoc the Lucene.
> > >
> > > Searcher searcher = new IndexSearcher(indexReader);
> > >   final BitSet bits = new BitSet(indexReader.maxDoc());
> > >   searcher.search(query, new HitCollector() {
> > >       public void collect(int doc, float score) {
> > >         bits.set(doc);
> > >       }
> > >     });
> > >
> > > Thanks
> > >
> > >
> > > On Nov 18, 2007 8:09 PM, Mark Miller <markrmiller@gmail.com> wrote:
> > >> Hey Haroldo.
> > >>
> > >> First thing you need to do is *stop* using Hits in your searches.
> > >> Hits
> > >> is optimized for some pretty specific use cases and you will get
> > >> along
> > >> much better by using a HitCollector.
> > >>
> > >> Hits has three main functions:
> > >>
> > >> It caches documents, normalizes scores, and stores ids associated
> > >> with
> > >> scores (a HitDoc). If you attempt to retrieve a HitDoc past the first
> > >> 100 from Hits, a new search will be issued to grab double the
> > >> required
> > >> HitDocs needed to satisfy your HitDoc retrieval attempt. This will be
> > >> repeated everytime you ask for a HitDoc beyond the current cache
> > >> (which
> > >> began at 100). This means that if you need to get a HitDoc beyond
> > >> 100,
> > >> Hits is not a great choice for you. You will want to use the
> > >> HitCollector instead...but remember that you are losing the
> > >> normalized
> > >> scores (simple to copy code if you still want it) and the document
> > >> caching (I rarely want that anyway).
> > >>
> > >> An issue to watch out for: with Hits, you do not have to ask for how
> > >> many docs to get back, but with a HitCollector solution you will need
> > >> to. This is a minor dilema if you want to go over all of the hits no
> > >> matter what. You can pass a huge number to ensure you get everything,
> > >> but you will be creating large data structures if you do this, as
> > >> structure sizes may be initialized by the number you pass. Also,
> > >> passing
> > >> the maximum integer will cause an error (negative init size) as
> > >> Lucene
> > >> initializes a data structure to hold the hits as n+1.
> > >>
> > >> - Mark
> > >>
> > >>
> > >> Haroldo Nascimento wrote:
> > >>> I have a problem of performance when I need group the result do
> > >>> search
> > >>>
> > >>> I have the code below:
> > >>>
> > >>>   for (int i = 0; i < hits.length(); i++) {
> > >>>                    doc = hits.doc(i);
> > >>>
> > >>>                    obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
> > >>>                    obj2 = doc.get(xxx);
> > >>>                    ...
> > >>>   }
> > >>>
> > >>>  I work with volume of data very big. The search process in 0.300
> > >>> seconds but when the object hits have much results, the time for get
> > >>> all objects is very big. The command hits.doc(i) is processed in 2
> > >>> second.
> > >>>
> > >>>  Por exemplo. For hits.length() equals the 25.000 results, the time
> > >>> of "pos search" is 7 seconds.
> > >>>
> > >>>  I get all result because I need group the result (remove the
> > >>> duplicate results).
> > >>>
> > >>>  Is there any form in Lucene that group the result. I need of
> > >>> anything as the command "group by" of sql.
> > >>>
> > >>>  Thanks.
> > >>>
> > >>
> > >>> ---------------------------------------------------------------------
> > >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>>
> > >>>
> > >>>
> > >>
> > >> ---------------------------------------------------------------------
> > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > >>
> > >>
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> >
> > --------------------------
> > Grant Ingersoll
> > http://lucene.grantingersoll.com
> >
> > Lucene Helpful Hints:
> > http://wiki.apache.org/lucene-java/BasicsOfPerformance
> > http://wiki.apache.org/lucene-java/LuceneFAQ
>
> >
> >
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31097-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 16:21:08 2007
Return-Path: <java-user-return-31097-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78433 invoked from network); 19 Nov 2007 16:21:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 16:21:08 -0000
Received: (qmail 21855 invoked by uid 500); 19 Nov 2007 16:20:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21830 invoked by uid 500); 19 Nov 2007 16:20:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21819 invoked by uid 99); 19 Nov 2007 16:20:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 08:20:48 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of german.kondolf@gmail.com designates 209.85.146.181 as permitted sender)
Received: from [209.85.146.181] (HELO wa-out-1112.google.com) (209.85.146.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 16:20:37 +0000
Received: by wa-out-1112.google.com with SMTP id j40so2218676wah
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 08:20:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=WADAkNsKsGvLKq3LZsWXmpjoBeXTUFKkaUnglBm/TE4=;
        b=HtpGRqpl9+h/RzNjUCpaR2TIdR7wLqUsYX1UZlXjfC0uEWrmyAqPI1KxuW6l1hrRkijWc+Tw4FpLJCK2JkUedBEQvdC6tegzFsYrnwrEQ/EZtTWMEv4Uw1AToGuR5x5VJaEc0euczZ9z0vrTPlq//12wYw/UCWAwVMFl8Qqx3hg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=N8vjmYw59yAiDbLwbekT6KoZ3Ow5Xa9Fbh0YacyPkt7vfyDpSUrPexhq1iR02Pta0ctFpQtIIHXXFaPt6xe6XT9CRjTt2eaIs7d8H07sp79PG3teVqxyiyJfgfkh92DEmuHSi7a9+t+niCJXrC9kcFEAQJryqDNWODcnQaD/XRk=
Received: by 10.115.92.2 with SMTP id u2mr711766wal.1195489230888;
        Mon, 19 Nov 2007 08:20:30 -0800 (PST)
Received: by 10.114.124.18 with HTTP; Mon, 19 Nov 2007 08:20:30 -0800 (PST)
Message-ID: <76df56980711190820n7fb8942ai6d6cc1bcb1195664@mail.gmail.com>
Date: Mon, 19 Nov 2007 13:20:30 -0300
From: "German Kondolf" <german.kondolf@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <718789d20711190809w4c8c7a53k4324f4b01d7c608e@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
	 <4740C637.2010809@gmail.com>
	 <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
	 <CE28066E-E8D1-4BC4-8922-7B848D8B08FA@apache.org>
	 <718789d20711190805p4b49241epdbdf63ddee32c93b@mail.gmail.com>
	 <718789d20711190809w4c8c7a53k4324f4b01d7c608e@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

A facet is a group condition, could be a single value of the doc or a
set of filters.

On Nov 19, 2007 1:09 PM, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
> German,
>
> When You said:
>  "I collect every facet's bitset ... "
>   what is a facet ? Is there the each option of filter of your site ?
> How you get the every facets ?
>
>
>
>
>
>
> On Nov 19, 2007 1:05 PM, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
> > German,
> >
> >  What I need is similar to the your site
> > http://listados.deremate.com.ar/panaderia .
> >  I have many results of search, but I show any result (for example:
> > first 10 for first page) , but for create the options of filter of
> > location I need read all results fof search. The problem of
> > performance is when I have 30.000 results.
> >
> >  How you get the filter the "ubication" ? You need read all results ?
> >
> >  thanks
> >
> >
> > On Nov 19, 2007 12:05 PM, Grant Ingersoll <gsingers@apache.org> wrote:
> > > I think, based on your previous question, that you just need to use
> > > the search() method that returns TopDocs, not the lower-level
> > > HitCollector method.  From the TopDocs, you can then access the
> > > ScoreDoc, which will give you info about the doc and the score.  See http://www.lucenebootcamp.com/LuceneBootCamp/training/src/test/java/com/lucenebootcamp/training/basic/TopDocsTest.java
> > >  from my Lucene Boot Camp training class for a really simple example.
> > >
> > > -Grant
> > >
> > >
> > > On Nov 19, 2007, at 9:12 AM, Haroldo Nascimento wrote:
> > >
> > > > Mark,
> > > >
> > > >  How I can get the information of Document. I think that is in the
> > > > implementation do method abstract collect. How I can get it .
> > > >
> > > >  Below is the example of javadoc the Lucene.
> > > >
> > > > Searcher searcher = new IndexSearcher(indexReader);
> > > >   final BitSet bits = new BitSet(indexReader.maxDoc());
> > > >   searcher.search(query, new HitCollector() {
> > > >       public void collect(int doc, float score) {
> > > >         bits.set(doc);
> > > >       }
> > > >     });
> > > >
> > > > Thanks
> > > >
> > > >
> > > > On Nov 18, 2007 8:09 PM, Mark Miller <markrmiller@gmail.com> wrote:
> > > >> Hey Haroldo.
> > > >>
> > > >> First thing you need to do is *stop* using Hits in your searches.
> > > >> Hits
> > > >> is optimized for some pretty specific use cases and you will get
> > > >> along
> > > >> much better by using a HitCollector.
> > > >>
> > > >> Hits has three main functions:
> > > >>
> > > >> It caches documents, normalizes scores, and stores ids associated
> > > >> with
> > > >> scores (a HitDoc). If you attempt to retrieve a HitDoc past the first
> > > >> 100 from Hits, a new search will be issued to grab double the
> > > >> required
> > > >> HitDocs needed to satisfy your HitDoc retrieval attempt. This will be
> > > >> repeated everytime you ask for a HitDoc beyond the current cache
> > > >> (which
> > > >> began at 100). This means that if you need to get a HitDoc beyond
> > > >> 100,
> > > >> Hits is not a great choice for you. You will want to use the
> > > >> HitCollector instead...but remember that you are losing the
> > > >> normalized
> > > >> scores (simple to copy code if you still want it) and the document
> > > >> caching (I rarely want that anyway).
> > > >>
> > > >> An issue to watch out for: with Hits, you do not have to ask for how
> > > >> many docs to get back, but with a HitCollector solution you will need
> > > >> to. This is a minor dilema if you want to go over all of the hits no
> > > >> matter what. You can pass a huge number to ensure you get everything,
> > > >> but you will be creating large data structures if you do this, as
> > > >> structure sizes may be initialized by the number you pass. Also,
> > > >> passing
> > > >> the maximum integer will cause an error (negative init size) as
> > > >> Lucene
> > > >> initializes a data structure to hold the hits as n+1.
> > > >>
> > > >> - Mark
> > > >>
> > > >>
> > > >> Haroldo Nascimento wrote:
> > > >>> I have a problem of performance when I need group the result do
> > > >>> search
> > > >>>
> > > >>> I have the code below:
> > > >>>
> > > >>>   for (int i = 0; i < hits.length(); i++) {
> > > >>>                    doc = hits.doc(i);
> > > >>>
> > > >>>                    obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
> > > >>>                    obj2 = doc.get(xxx);
> > > >>>                    ...
> > > >>>   }
> > > >>>
> > > >>>  I work with volume of data very big. The search process in 0.300
> > > >>> seconds but when the object hits have much results, the time for get
> > > >>> all objects is very big. The command hits.doc(i) is processed in 2
> > > >>> second.
> > > >>>
> > > >>>  Por exemplo. For hits.length() equals the 25.000 results, the time
> > > >>> of "pos search" is 7 seconds.
> > > >>>
> > > >>>  I get all result because I need group the result (remove the
> > > >>> duplicate results).
> > > >>>
> > > >>>  Is there any form in Lucene that group the result. I need of
> > > >>> anything as the command "group by" of sql.
> > > >>>
> > > >>>  Thanks.
> > > >>>
> > > >>
> > > >>> ---------------------------------------------------------------------
> > > >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >>>
> > > >>>
> > > >>>
> > > >>
> > > >> ---------------------------------------------------------------------
> > > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >>
> > > >>
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > >
> > > --------------------------
> > > Grant Ingersoll
> > > http://lucene.grantingersoll.com
> > >
> > > Lucene Helpful Hints:
> > > http://wiki.apache.org/lucene-java/BasicsOfPerformance
> > > http://wiki.apache.org/lucene-java/LuceneFAQ
> > >
> > >
> > >
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31098-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 16:48:15 2007
Return-Path: <java-user-return-31098-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90661 invoked from network); 19 Nov 2007 16:48:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 16:48:14 -0000
Received: (qmail 62743 invoked by uid 500); 19 Nov 2007 16:47:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62711 invoked by uid 500); 19 Nov 2007 16:47:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62678 invoked by uid 99); 19 Nov 2007 16:47:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 08:47:54 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.191 as permitted sender)
Received: from [209.85.134.191] (HELO mu-out-0910.google.com) (209.85.134.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 16:47:42 +0000
Received: by mu-out-0910.google.com with SMTP id i10so1927783mue
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 08:47:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=bLMgAEkEaNHZ6zI/vhdrd8EZ4Zo3t2/6N/I4LjSgv/M=;
        b=P/IqcjM6dnWOEqaUB6Hl+piygSjrbqEJt7jFr7Gt+quOJX3eTa4tmRgt31EYhpTogN++L+xOHCpa5cBL2rUyh3dgX0mtHLDL6cemoXnuoSq2e9brKYYoc6jumci73VoIQAiSF2KL9HvIYP/P86b1fdUSzyBOoO8+E8WU5wuflvY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=TQKmf43lkiYCtPpCkTzvoLyovGCVavO2R6U8ud9pXDkGJWSFoo9RIDQ64AMaLPZlp8Cudqr46W14d/xKEr8ymdtEzH/KVrl5Yo6CsFeGk9ZuPYChqrd2j728Y9RdZrWo/XX40+p/f2M6RSm+Inj6HzZM202I0QGxJRap67+EQwY=
Received: by 10.82.155.10 with SMTP id c10mr14426121bue.1195490854251;
        Mon, 19 Nov 2007 08:47:34 -0800 (PST)
Received: by 10.82.151.7 with HTTP; Mon, 19 Nov 2007 08:47:34 -0800 (PST)
Message-ID: <359a92830711190847s1c12c274i9f346a3a7a84ca8f@mail.gmail.com>
Date: Mon, 19 Nov 2007 11:47:34 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: neither IndexWriter nor IndexReader would delete documents
In-Reply-To: <200711191242.48449@danielnaber.de>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13584_11271753.1195490854223"
References: <13824599.post@talk.nabble.com> <200711191242.48449@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13584_11271753.1195490854223
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Also, are you re-opening the reader underlying your *searcher* before
you query and still get the deleted docs?

Also, look with Luke to see if the specific uid you *think* you've deleted
is really gone.

Best
Erick

On Nov 19, 2007 6:42 AM, Daniel Naber <lucenelist2007@danielnaber.de> wrote:

> On Sonntag, 18. November 2007, flateric wrote:
>
> > IndexReader ir = IndexReader.open(fsDir);
> > ir.deleteDocuments(new Term("uid", uid));
> > ir.close();
> >
> > Has absolutely no effect.
>
> What number does ir.deleteDocuments return? If it's 0, the uid cannot be
> found. If it's > 0: note that you need to re-open your searcher/reader to
> see any changes to your index.
>
> Regards
>  Daniel
>
> --
> http://www.danielnaber.de
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_13584_11271753.1195490854223--

From java-user-return-31099-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 16:55:39 2007
Return-Path: <java-user-return-31099-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94998 invoked from network); 19 Nov 2007 16:55:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 16:55:38 -0000
Received: (qmail 73723 invoked by uid 500); 19 Nov 2007 16:55:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 73695 invoked by uid 500); 19 Nov 2007 16:55:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 73684 invoked by uid 99); 19 Nov 2007 16:55:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 08:55:19 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 209.85.134.189 as permitted sender)
Received: from [209.85.134.189] (HELO mu-out-0910.google.com) (209.85.134.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 16:55:22 +0000
Received: by mu-out-0910.google.com with SMTP id i10so1930393mue
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 08:55:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=C3GO0Vwrv/h/WFM9QC7QAo8hQdCDI6ck+o5FTya/vL4=;
        b=T7L1StHT//Md0IDEkk0vNMcKsDLU0w98MK/E/F7iWDkK/jNki43sPc9OGij99YUhF6ni6X+KHICtBb79LZCvle+v+5BHEBesPwGXr04c0wxF8YPSo12oiYgrh7JCL5V9BoCviW/nsw0CwpZKB2B8Cne6BWrBM1axg3Ul0yWoaf4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=BjSwfFpmTHpqTq05VvgzmmeEqMGpKCRmeY9VgDL5WcRu6GyBxvNWZzFRhFtcjyhHk5y/YFT+4Hw0OMQ09LC4ywcBTOUBk/FcStk+u5UE2Wbwim5AtqEPTcXfuXVGkfWGIwViWYFKN4nhu8YBqUQtCpssTjQLFqBaBZdxFRxWWP4=
Received: by 10.82.140.20 with SMTP id n20mr13868699bud.1195491300448;
        Mon, 19 Nov 2007 08:55:00 -0800 (PST)
Received: by 10.82.151.7 with HTTP; Mon, 19 Nov 2007 08:55:00 -0800 (PST)
Message-ID: <359a92830711190855l77f66321kf53fc4020af2ba4b@mail.gmail.com>
Date: Mon, 19 Nov 2007 11:55:00 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Scoring for all the documents in the index relative to a query
In-Reply-To: <604180.39834.qm@web60417.mail.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13606_33365859.1195491300402"
References: <604180.39834.qm@web60417.mail.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13606_33365859.1195491300402
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Could you explain a bit more what problem you're trying to solve?
The reason I ask is that your question doesn't make sense to me,
since I have no idea what you expect by the term "negative score".

My simplistic view has been that all the docs returned via Hits
or HitCollector have scores > 0, and all the rest have scores of 0,
and this view is supported by the explanation of
HitCollector.collect

" Called once for every non-zero scoring document, with the
document number and its score."

You might also get value from this page:
http://lucene.apache.org/java/docs/scoring.html#Scoring

Best
Erick

On Nov 19, 2007 11:05 AM, HAIDUC SONIA <haiduc_sonia@yahoo.com> wrote:

> Hi everyone,
>
> I am trying to obtain the score for each document in the index relative to
> a given query. For example, if I have the query "search file", I am trying
> to get the list of all documents in the index and their scores relative to
> the given query. I tried first using Hits, which gave me the normalized
> score. I thought that I don't see the whole list of documents and their
> scores because of the normalization, so I tried using HitsCollector. But
> even after using HitsCollector, I get the same number of matching documents,
> so the normalization didn't exclude documents because of negative scoring.
> Does Lucene actually compute the score for all the documents in the index or
> just for matching documents? I really need to have the scores for all the
> documents in the index relative to the query (even if negative), not just
> the ones that contain the query terms(this is what Lucene considers
> "matching documents", right?). Is this possible using Lucene?
>
> I really appreciate your time and effort!
> Thanks,
> Sonia
>
>
>
>
>
>  ____________________________________________________________________________________
> Get easy, one-click access to your favorites.
> Make Yahoo! your homepage.
> http://www.yahoo.com/r/hs
>

------=_Part_13606_33365859.1195491300402--

From java-user-return-31100-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 18:25:43 2007
Return-Path: <java-user-return-31100-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32909 invoked from network); 19 Nov 2007 18:25:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 18:25:43 -0000
Received: (qmail 7479 invoked by uid 500); 19 Nov 2007 18:25:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 7448 invoked by uid 500); 19 Nov 2007 18:25:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 7437 invoked by uid 99); 19 Nov 2007 18:25:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 10:25:24 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.73.178.156] (HELO web60413.mail.yahoo.com) (209.73.178.156)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 19 Nov 2007 18:25:26 +0000
Received: (qmail 86831 invoked by uid 60001); 19 Nov 2007 18:25:05 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=q/Ud7hHqElUCRhcFsNwjSYZClQEUZ5yTmkSYb5CXEOmHAFLD5iJfZflV0cLgcHRFzt1dYpSFQlzGimi67McvmNeoB/Y0JD4NzdzzTBDugLID8PLqB/gk3zpaNxc3I8ISL1XKfwrZzYgla3p1p/uXtTZYSINhCJi07aLURgNFTcI=;
X-YMail-OSG: _4bKhnoVM1m2N3hX7DOZI9OpRmCvTSjzy1.VHafd.hHuE79VuwONoeaJwfYO64hsIg--
Received: from [141.217.87.154] by web60413.mail.yahoo.com via HTTP; Mon, 19 Nov 2007 10:25:04 PST
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.157
Date: Mon, 19 Nov 2007 10:25:04 -0800 (PST)
From: HAIDUC SONIA <haiduc_sonia@yahoo.com>
Subject: Re: Scoring for all the documents in the index relative to a query
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1617004257-1195496704=:85955"
Message-ID: <870644.85955.qm@web60413.mail.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1617004257-1195496704=:85955
Content-Type: text/plain; charset=us-ascii

I am trying to order all the documents in the index according to their similarity to a given query. I am interested in having a complete list of *all* the documents in the index with their score. From what I understood by reading some documentation, Lucene internally assigns scores to all the documents in the index according to their similarity to the query, but when returning the hits, all the scores that are less than 0 are rounded to 0 and only the documents with the score > 0 are returned as hits. But what I would like to get is the list before this intermediate processing, so the list of all the documents with their raw score. I am trying to compare Lucene with LSI and for the comparison I want to do, I need the entire list of documents. Is there a way that I can get that with Lucene?
I hope I explained it clearly this time. If you need more details let me know.

Thank you,
Sonia

----- Original Message ----
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Sent: Monday, November 19, 2007 11:55:00 AM
Subject: Re: Scoring for all the documents in the index relative to a query


Could you explain a bit more what problem you're trying to solve?
The reason I ask is that your question doesn't make sense to me,
since I have no idea what you expect by the term "negative score".

My simplistic view has been that all the docs returned via Hits
or HitCollector have scores > 0, and all the rest have scores of 0,
and this view is supported by the explanation of
HitCollector.collect

" Called once for every non-zero scoring document, with the
document number and its score."

You might also get value from this page:
http://lucene.apache.org/java/docs/scoring.html#Scoring

Best
Erick

On Nov 19, 2007 11:05 AM, HAIDUC SONIA <haiduc_sonia@yahoo.com> wrote:

> Hi everyone,
>
> I am trying to obtain the score for each document in the index
 relative to
> a given query. For example, if I have the query "search file", I am
 trying
> to get the list of all documents in the index and their scores
 relative to
> the given query. I tried first using Hits, which gave me the
 normalized
> score. I thought that I don't see the whole list of documents and
 their
> scores because of the normalization, so I tried using HitsCollector.
 But
> even after using HitsCollector, I get the same number of matching
 documents,
> so the normalization didn't exclude documents because of negative
 scoring.
> Does Lucene actually compute the score for all the documents in the
 index or
> just for matching documents? I really need to have the scores for all
 the
> documents in the index relative to the query (even if negative), not
 just
> the ones that contain the query terms(this is what Lucene considers
> "matching documents", right?). Is this possible using Lucene?
>
> I really appreciate your time and effort!
> Thanks,
> Sonia
>
>
>
>
>
>
  ____________________________________________________________________________________
> Get easy, one-click access to your favorites.
> Make Yahoo! your homepage.
> http://www.yahoo.com/r/hs
>






      ____________________________________________________________________________________
Get easy, one-click access to your favorites. 
Make Yahoo! your homepage.
http://www.yahoo.com/r/hs 
--0-1617004257-1195496704=:85955--

From java-user-return-31101-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 18:25:51 2007
Return-Path: <java-user-return-31101-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33048 invoked from network); 19 Nov 2007 18:25:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 18:25:51 -0000
Received: (qmail 9004 invoked by uid 500); 19 Nov 2007 18:25:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8972 invoked by uid 500); 19 Nov 2007 18:25:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8961 invoked by uid 99); 19 Nov 2007 18:25:31 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 10:25:31 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.73.178.153] (HELO web60425.mail.yahoo.com) (209.73.178.153)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 19 Nov 2007 18:25:34 +0000
Received: (qmail 96096 invoked by uid 60001); 19 Nov 2007 18:25:13 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=fozvrkpSFyBlWWnezoMIQx4GOz3z0kaAiZ8Rrzto27BFnG3x32kHBkBxwETfwM1bMk1S72U0MGtD1xXOsyoYJmn9Vu1yC5rtJ3QjdWhTO4daBCp4fALwXAPxM01yczbtz6HyfLgq5zNpF2gspFi1enF/5vYkwURGgluDeXkr94w=;
X-YMail-OSG: H.JrhvwVM1kUCAYRKzOzQ9TN0U5S35LZyQN1oE8X.iS.HF1sV6wY5TWj6j6pIoWeFT5id4LjYDe72fkO0dgQn0yEct2QLq9qbWMKzi8pz9NsRPIlUKiw
Received: from [141.217.87.154] by web60425.mail.yahoo.com via HTTP; Mon, 19 Nov 2007 10:25:13 PST
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.157
Date: Mon, 19 Nov 2007 10:25:13 -0800 (PST)
From: HAIDUC SONIA <haiduc_sonia@yahoo.com>
Subject: Re: Scoring for all the documents in the index relative to a query
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1547186948-1195496713=:95674"
Message-ID: <182042.95674.qm@web60425.mail.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1547186948-1195496713=:95674
Content-Type: text/plain; charset=us-ascii

I am trying to order all the documents in the index according to their similarity to a given query. I am interested in having a complete list of *all* the documents in the index with their score. From what I understood by reading some documentation, Lucene internally assigns scores to all the documents in the index according to their similarity to the query, but when returning the hits, all the scores that are less than 0 are rounded to 0 and only the documents with the score > 0 are returned as hits. But what I would like to get is the list before this intermediate processing, so the list of all the documents with their raw score. I am trying to compare Lucene with LSI and for the comparison I want to do, I need the entire list of documents. Is there a way that I can get that with Lucene?
I hope I explained it clearly this time. If you need more details let me know.

Thank you,
Sonia

----- Original Message ----
From: Erick Erickson <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Sent: Monday, November 19, 2007 11:55:00 AM
Subject: Re: Scoring for all the documents in the index relative to a query


Could you explain a bit more what problem you're trying to solve?
The reason I ask is that your question doesn't make sense to me,
since I have no idea what you expect by the term "negative score".

My simplistic view has been that all the docs returned via Hits
or HitCollector have scores > 0, and all the rest have scores of 0,
and this view is supported by the explanation of
HitCollector.collect

" Called once for every non-zero scoring document, with the
document number and its score."

You might also get value from this page:
http://lucene.apache.org/java/docs/scoring.html#Scoring

Best
Erick

On Nov 19, 2007 11:05 AM, HAIDUC SONIA <haiduc_sonia@yahoo.com> wrote:

> Hi everyone,
>
> I am trying to obtain the score for each document in the index
 relative to
> a given query. For example, if I have the query "search file", I am
 trying
> to get the list of all documents in the index and their scores
 relative to
> the given query. I tried first using Hits, which gave me the
 normalized
> score. I thought that I don't see the whole list of documents and
 their
> scores because of the normalization, so I tried using HitsCollector.
 But
> even after using HitsCollector, I get the same number of matching
 documents,
> so the normalization didn't exclude documents because of negative
 scoring.
> Does Lucene actually compute the score for all the documents in the
 index or
> just for matching documents? I really need to have the scores for all
 the
> documents in the index relative to the query (even if negative), not
 just
> the ones that contain the query terms(this is what Lucene considers
> "matching documents", right?). Is this possible using Lucene?
>
> I really appreciate your time and effort!
> Thanks,
> Sonia
>
>
>
>
>
>
  ____________________________________________________________________________________
> Get easy, one-click access to your favorites.
> Make Yahoo! your homepage.
> http://www.yahoo.com/r/hs
>






      ____________________________________________________________________________________
Never miss a thing.  Make Yahoo your home page. 
http://www.yahoo.com/r/hs
--0-1547186948-1195496713=:95674--

From java-user-return-31102-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 18:34:53 2007
Return-Path: <java-user-return-31102-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38696 invoked from network); 19 Nov 2007 18:34:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 18:34:53 -0000
Received: (qmail 19523 invoked by uid 500); 19 Nov 2007 18:34:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19495 invoked by uid 500); 19 Nov 2007 18:34:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19484 invoked by uid 99); 19 Nov 2007 18:34:34 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 10:34:34 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of buschmic@gmail.com designates 66.249.92.170 as permitted sender)
Received: from [66.249.92.170] (HELO ug-out-1314.google.com) (66.249.92.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 18:34:24 +0000
Received: by ug-out-1314.google.com with SMTP id h3so1054496ugf
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 10:34:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=bgtBocw8JVchVpN6ftGPQa8cWS5/CRFTaCxAtjDybH0=;
        b=BnQbrfNGJjl0RvWL7JfSh2P4pqUk61WZQAIAu6aE80yhn/Lz4fW6BwKtBMs2gaHqQIX16yjz6NAUue8G06Tf3IPp438fzK03jwiYokjT8ShSKlRHFN6BMKq1GJ2V3ybgP4T7hcjDoXfOsMcrIzeLApsU7sgqQnExlShr6sYtR7w=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=g1/KCc2Lv7n79l2tELq/sTRfgElskRrbKTjQL91IZ7/VcVL9hxs1H+APNzqb/WLbucDrbj9K2u/sAX8fuiRG20bJULDtTDeJdJ/Gqnt37rHIF38CTLFNjPM9zvdTv66qDb0t2tsA5NOSTnWGgClnG5gqPzSB/yBqXpMBEv7geX8=
Received: by 10.150.157.11 with SMTP id f11mr647985ybe.1195497256256;
        Mon, 19 Nov 2007 10:34:16 -0800 (PST)
Received: from ?9.30.38.137? ( [129.42.184.35])
        by mx.google.com with ESMTPS id 24sm5831036nzn.2007.11.19.10.34.14
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Mon, 19 Nov 2007 10:34:15 -0800 (PST)
Message-ID: <4741D6CF.9010204@gmail.com>
Date: Mon, 19 Nov 2007 10:32:47 -0800
From: Michael Busch <buschmic@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Scoring for all the documents in the index relative to a query
References: <182042.95674.qm@web60425.mail.yahoo.com>
In-Reply-To: <182042.95674.qm@web60425.mail.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Sonia,

I agree with Erick here. Negative scores don't make sense and Lucene
never computes scores for documents that don't match a query.

E. g. if your query is: "term1 OR term2", then every document that
contains term1 or term2 or both will have a score greater than 0. But if
two docs don't contain either of the two terms, why should one of them
have a lower score than the other one? Both would have 0.

-Michael

HAIDUC SONIA wrote:
> I am trying to order all the documents in the index according to their similarity to a given query. I am interested in having a complete list of *all* the documents in the index with their score. From what I understood by reading some documentation, Lucene internally assigns scores to all the documents in the index according to their similarity to the query, but when returning the hits, all the scores that are less than 0 are rounded to 0 and only the documents with the score > 0 are returned as hits. But what I would like to get is the list before this intermediate processing, so the list of all the documents with their raw score. I am trying to compare Lucene with LSI and for the comparison I want to do, I need the entire list of documents. Is there a way that I can get that with Lucene?
> I hope I explained it clearly this time. If you need more details let me know.
> 
> Thank you,
> Sonia
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31103-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 18:39:15 2007
Return-Path: <java-user-return-31103-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42476 invoked from network); 19 Nov 2007 18:39:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 18:39:15 -0000
Received: (qmail 31081 invoked by uid 500); 19 Nov 2007 18:38:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31057 invoked by uid 500); 19 Nov 2007 18:38:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31046 invoked by uid 99); 19 Nov 2007 18:38:56 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 10:38:56 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a13.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 18:38:56 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a13.g.dreamhost.com (Postfix) with ESMTP id B75B4129B20
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 10:38:32 -0800 (PST)
Message-Id: <569C717C-DE1A-4875-AE0B-3D3E80B8186B@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <870644.85955.qm@web60413.mail.yahoo.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Scoring for all the documents in the index relative to a query
Date: Mon, 19 Nov 2007 13:38:32 -0500
References: <870644.85955.qm@web60413.mail.yahoo.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Lucene only scores those documents that have at least one match term,  
it doesn't implement a pure vector space model whereby all documents  
are scored (it uses a combination of the Boolean Model and VSM).   
Thus, I am not sure you can do a pure comparison.  I suppose you could  
simulating the relevance by using TermVectors and looping over all  
documents, but I think one could argue this isn't exactly what Lucene  
does, so it isn't comparable.

http://lucene.apache.org/java/docs/scoring.html might help in  
understanding this stuff.

HTH,
Grant

On Nov 19, 2007, at 1:25 PM, HAIDUC SONIA wrote:

> I am trying to order all the documents in the index according to  
> their similarity to a given query. I am interested in having a  
> complete list of *all* the documents in the index with their score.  
> From what I understood by reading some documentation, Lucene  
> internally assigns scores to all the documents in the index  
> according to their similarity to the query, but when returning the  
> hits, all the scores that are less than 0 are rounded to 0 and only  
> the documents with the score > 0 are returned as hits. But what I  
> would like to get is the list before this intermediate processing,  
> so the list of all the documents with their raw score. I am trying  
> to compare Lucene with LSI and for the comparison I want to do, I  
> need the entire list of documents. Is there a way that I can get  
> that with Lucene?
> I hope I explained it clearly this time. If you need more details  
> let me know.
>
> Thank you,
> Sonia
>
> ----- Original Message ----
> From: Erick Erickson <erickerickson@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Monday, November 19, 2007 11:55:00 AM
> Subject: Re: Scoring for all the documents in the index relative to  
> a query
>
>
> Could you explain a bit more what problem you're trying to solve?
> The reason I ask is that your question doesn't make sense to me,
> since I have no idea what you expect by the term "negative score".
>
> My simplistic view has been that all the docs returned via Hits
> or HitCollector have scores > 0, and all the rest have scores of 0,
> and this view is supported by the explanation of
> HitCollector.collect
>
> " Called once for every non-zero scoring document, with the
> document number and its score."
>
> You might also get value from this page:
> http://lucene.apache.org/java/docs/scoring.html#Scoring
>
> Best
> Erick
>
> On Nov 19, 2007 11:05 AM, HAIDUC SONIA <haiduc_sonia@yahoo.com> wrote:
>
>> Hi everyone,
>>
>> I am trying to obtain the score for each document in the index
> relative to
>> a given query. For example, if I have the query "search file", I am
> trying
>> to get the list of all documents in the index and their scores
> relative to
>> the given query. I tried first using Hits, which gave me the
> normalized
>> score. I thought that I don't see the whole list of documents and
> their
>> scores because of the normalization, so I tried using HitsCollector.
> But
>> even after using HitsCollector, I get the same number of matching
> documents,
>> so the normalization didn't exclude documents because of negative
> scoring.
>> Does Lucene actually compute the score for all the documents in the
> index or
>> just for matching documents? I really need to have the scores for all
> the
>> documents in the index relative to the query (even if negative), not
> just
>> the ones that contain the query terms(this is what Lucene considers
>> "matching documents", right?). Is this possible using Lucene?
>>
>> I really appreciate your time and effort!
>> Thanks,
>> Sonia
>>
>>
>>
>>
>>
>>
>   
> ____________________________________________________________________________________
>> Get easy, one-click access to your favorites.
>> Make Yahoo! your homepage.
>> http://www.yahoo.com/r/hs
>>
>
>
>
>
>
>
>       
> ____________________________________________________________________________________
> Get easy, one-click access to your favorites.
> Make Yahoo! your homepage.
> http://www.yahoo.com/r/hs

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31104-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 18:46:21 2007
Return-Path: <java-user-return-31104-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 46460 invoked from network); 19 Nov 2007 18:46:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 18:46:21 -0000
Received: (qmail 42648 invoked by uid 500); 19 Nov 2007 18:46:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42240 invoked by uid 500); 19 Nov 2007 18:46:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42229 invoked by uid 99); 19 Nov 2007 18:46:01 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 10:46:01 -0800
X-ASF-Spam-Status: No, hits=-2.0 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gresh@us.ibm.com designates 32.97.182.144 as permitted sender)
Received: from [32.97.182.144] (HELO e4.ny.us.ibm.com) (32.97.182.144)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 18:46:03 +0000
Received: from d01relay04.pok.ibm.com (d01relay04.pok.ibm.com [9.56.227.236])
	by e4.ny.us.ibm.com (8.13.8/8.13.8) with ESMTP id lAJIjg4u012706
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 13:45:42 -0500
Received: from d01av03.pok.ibm.com (d01av03.pok.ibm.com [9.56.224.217])
	by d01relay04.pok.ibm.com (8.13.8/8.13.8/NCO v8.6) with ESMTP id lAJIjgjl127930
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 13:45:42 -0500
Received: from d01av03.pok.ibm.com (loopback [127.0.0.1])
	by d01av03.pok.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id lAJIjfAW001116
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 13:45:41 -0500
Received: from d01ml605.pok.ibm.com (d01ml605.pok.ibm.com [9.56.227.91])
	by d01av03.pok.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id lAJIjfTP001111
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 13:45:41 -0500
In-Reply-To: <182042.95674.qm@web60425.mail.yahoo.com>
To: java-user@lucene.apache.org
MIME-Version: 1.0
Subject: Re: Scoring for all the documents in the index relative to a query
X-Mailer: Lotus Notes Release 7.0 HF277 June 21, 2006
From: Donna L Gresh <gresh@us.ibm.com>
Message-ID: <OFFE13BFED.7D245082-ON85257398.0066B97A-85257398.00670610@us.ibm.com>
Date: Mon, 19 Nov 2007 13:45:39 -0500
X-MIMETrack: Serialize by Router on D01ML605/01/M/IBM(Release 8.0|August 02, 2007) at 11/19/2007
 13:45:40,
	Serialize complete at 11/19/2007 13:45:40
Content-Type: multipart/alternative; boundary="=_alternative 0067059185257398_="
X-Virus-Checked: Checked by ClamAV on apache.org

--=_alternative 0067059185257398_=
Content-Type: text/plain; charset="US-ASCII"

I could be mistaken, but I think the earlier answer was right; a document 
with no terms matching has a score of 0, so you can assume that all 
documents NOT returned by the query have a score of 0. If you look at the 
scoring formula on this page, it is hard to see how you can get a negative 
score. 

http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/Similarity.html



HAIDUC SONIA <haiduc_sonia@yahoo.com> wrote on 11/19/2007 01:25:13 PM:

> I am trying to order all the documents in the index according to 
> their similarity to a given query. I am interested in having a 
> complete list of *all* the documents in the index with their score. 
> From what I understood by reading some documentation, Lucene 
> internally assigns scores to all the documents in the index 
> according to their similarity to the query, but when returning the 
> hits, all the scores that are less than 0 are rounded to 0 and only 
> the documents with the score > 0 are returned as hits. But what I 
> would like to get is the list before this intermediate processing, 
> so the list of all the documents with their raw score. I am trying 
> to compare Lucene with LSI and for the comparison I want to do, I 
> need the entire list of documents. Is there a way that I can get 
> that with Lucene?
> I hope I explained it clearly this time. If you need more details let me 
know.
> 
> Thank you,
> Sonia
> 
> ----- Original Message ----
> From: Erick Erickson <erickerickson@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Monday, November 19, 2007 11:55:00 AM
> Subject: Re: Scoring for all the documents in the index relative to a 
query
> 
> 
> Could you explain a bit more what problem you're trying to solve?
> The reason I ask is that your question doesn't make sense to me,
> since I have no idea what you expect by the term "negative score".
> 
> My simplistic view has been that all the docs returned via Hits
> or HitCollector have scores > 0, and all the rest have scores of 0,
> and this view is supported by the explanation of
> HitCollector.collect
> 
> " Called once for every non-zero scoring document, with the
> document number and its score."
> 
> You might also get value from this page:
> http://lucene.apache.org/java/docs/scoring.html#Scoring
> 
> Best
> Erick
> 
> On Nov 19, 2007 11:05 AM, HAIDUC SONIA <haiduc_sonia@yahoo.com> wrote:
> 
> > Hi everyone,
> >
> > I am trying to obtain the score for each document in the index
>  relative to
> > a given query. For example, if I have the query "search file", I am
>  trying
> > to get the list of all documents in the index and their scores
>  relative to
> > the given query. I tried first using Hits, which gave me the
>  normalized
> > score. I thought that I don't see the whole list of documents and
>  their
> > scores because of the normalization, so I tried using HitsCollector.
>  But
> > even after using HitsCollector, I get the same number of matching
>  documents,
> > so the normalization didn't exclude documents because of negative
>  scoring.
> > Does Lucene actually compute the score for all the documents in the
>  index or
> > just for matching documents? I really need to have the scores for all
>  the
> > documents in the index relative to the query (even if negative), not
>  just
> > the ones that contain the query terms(this is what Lucene considers
> > "matching documents", right?). Is this possible using Lucene?
> >
> > I really appreciate your time and effort!
> > Thanks,
> > Sonia
> >
> >
> >
> >
> >
> >
> 
> 
____________________________________________________________________________________
> > Get easy, one-click access to your favorites.
> > Make Yahoo! your homepage.
> > http://www.yahoo.com/r/hs
> >
> 
> 
> 
> 
> 
> 
> 
> 
____________________________________________________________________________________
> Never miss a thing.  Make Yahoo your home page. 
> http://www.yahoo.com/r/hs
--=_alternative 0067059185257398_=--

From java-user-return-31105-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 18:55:22 2007
Return-Path: <java-user-return-31105-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50226 invoked from network); 19 Nov 2007 18:55:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 18:55:21 -0000
Received: (qmail 67008 invoked by uid 500); 19 Nov 2007 18:55:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66983 invoked by uid 500); 19 Nov 2007 18:55:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66972 invoked by uid 99); 19 Nov 2007 18:55:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 10:55:02 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [209.73.178.156] (HELO web60413.mail.yahoo.com) (209.73.178.156)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 19 Nov 2007 18:55:05 +0000
Received: (qmail 97690 invoked by uid 60001); 19 Nov 2007 18:54:44 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=l7utAAWgjWDM0SE65F/UO6ILQZikzWMQYSnD40h7gcFYNGCLWcDLT/7HMQ0pct8BVnfJSTu5KdC+fp7gpYxP2A9bej3bFlUK1fpPHX2xojIlmJpepfu+VOo60Qe2ao092R+p8fi7MB2pq7G4OQTYmZKkQj8DaVuHTQKRizMHvkA=;
X-YMail-OSG: yChWq_sVM1noKPVnNxEAv5aOTMxw30NP5V7WHDmstO89wFAcb9IAJuLMLCYePdzEzZn32qA_MxPd3vskboBCcaxZXmCyhEVy2K0qb4.iUygd3qiAQUCW
Received: from [141.217.87.154] by web60413.mail.yahoo.com via HTTP; Mon, 19 Nov 2007 10:54:43 PST
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.157
Date: Mon, 19 Nov 2007 10:54:43 -0800 (PST)
From: HAIDUC SONIA <haiduc_sonia@yahoo.com>
Subject: Re: Scoring for all the documents in the index relative to a query
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-2075216821-1195498483=:95932"
Message-ID: <46675.95932.qm@web60413.mail.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-2075216821-1195498483=:95932
Content-Type: text/plain; charset=us-ascii

Thank you guys for your prompt answers. I'm a beginner with Lucene and I still had some unclarities regarding its scoring function. Your answers really cleared things up for me. I guess a direct comparison with LSI is not possible after all, only the comparison between LSI and the pure VSM. 

Thanks again,
Sonia






      ____________________________________________________________________________________
Be a better pen pal. 
Text or chat with friends inside Yahoo! Mail. See how.  http://overview.mail.yahoo.com/
--0-2075216821-1195498483=:95932--

From java-user-return-31106-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 20:41:24 2007
Return-Path: <java-user-return-31106-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82842 invoked from network); 19 Nov 2007 20:41:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 20:41:24 -0000
Received: (qmail 61978 invoked by uid 500); 19 Nov 2007 20:41:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61944 invoked by uid 500); 19 Nov 2007 20:41:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61933 invoked by uid 99); 19 Nov 2007 20:41:04 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 12:41:04 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 20:41:06 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IuDQE-0006LB-3z
	for java-user@lucene.apache.org; Mon, 19 Nov 2007 12:40:46 -0800
Message-ID: <13844914.post@talk.nabble.com>
Date: Mon, 19 Nov 2007 12:40:46 -0800 (PST)
From: flateric <eballnath@yahoo.de>
To: java-user@lucene.apache.org
Subject: Re: neither IndexWriter nor IndexReader would delete documents
In-Reply-To: <200711191242.48449@danielnaber.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: eballnath@yahoo.de
References: <13824599.post@talk.nabble.com> <200711191242.48449@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org


Hallo Daniel;

the number returned by delete is 0, but the "uid" shows up in Luke so it is
there.
I close the reader after every delete and then re-open it for the next
delete (see my code snippets below).

Eric


Daniel Naber-10 wrote:
> 
> On Sonntag, 18. November 2007, flateric wrote:
> 
>> IndexReader ir = IndexReader.open(fsDir);
>> ir.deleteDocuments(new Term("uid", uid));
>> ir.close();
>>
>> Has absolutely no effect.
> 
> What number does ir.deleteDocuments return? If it's 0, the uid cannot be 
> found. If it's > 0: note that you need to re-open your searcher/reader to 
> see any changes to your index.
> 
> Regards
>  Daniel
> 
> -- 
> http://www.danielnaber.de
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/neither-IndexWriter-nor-IndexReader-would-delete-documents-tf4832123.html#a13844914
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31107-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 21:14:45 2007
Return-Path: <java-user-return-31107-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94089 invoked from network); 19 Nov 2007 21:14:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 21:14:45 -0000
Received: (qmail 10944 invoked by uid 500); 19 Nov 2007 21:14:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10904 invoked by uid 500); 19 Nov 2007 21:14:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10880 invoked by uid 99); 19 Nov 2007 21:14:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 13:14:25 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 64.233.170.190 as permitted sender)
Received: from [64.233.170.190] (HELO rn-out-0102.google.com) (64.233.170.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 21:14:13 +0000
Received: by rn-out-0102.google.com with SMTP id v46so1206998rnb
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 13:14:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=iGK/mtolpDgQ6Fuic8Ct1SdKznzrdx4nm1uJD48NXmM=;
        b=BorUfErt1h7be/o0XAbiv6pxqTfVG9S/KSvmzc1hHkhAOa9uMO+RHKrL5wRXSo8rYBAJxoRL/U05mpWvMdEgH+BFOBEKmVkHHWhmYP3xgdrJ+YAYyP9gaV5Rjg82M4GrZmd+hetdGncoj1Pi1K0wLk7XpH0UPoiOV9pyuzQOE3o=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=f1AREPPy9rOmaFwD9pPJhNjbuESDiuLMvXYUDA0e1mDgteCvo0tp9sAO+gS1hi43me7ojrMAE9Avw8FKrvAo5ijoYunvDiT/UH3V4Ub/ROmVfS+Kw7vaXWX6Q69jKBiz8VDrSCh7u5mTrxtQZHNbTjLgG/CVETQkPgYWLwtxvFc=
Received: by 10.150.135.2 with SMTP id i2mr710936ybd.1195506845982;
        Mon, 19 Nov 2007 13:14:05 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Mon, 19 Nov 2007 13:14:05 -0800 (PST)
Message-ID: <718789d20711191314n16570772nad884322b7ba5569@mail.gmail.com>
Date: Mon, 19 Nov 2007 18:14:05 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <76df56980711190819o9acd211q798412af04a770d4@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
	 <4740C637.2010809@gmail.com>
	 <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
	 <CE28066E-E8D1-4BC4-8922-7B848D8B08FA@apache.org>
	 <718789d20711190805p4b49241epdbdf63ddee32c93b@mail.gmail.com>
	 <76df56980711190819o9acd211q798412af04a770d4@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

German,

  How would be it ?

  You have 2 index ?. One for seach main (keyword) and other for location ?

  You do 2 search, The first is the search main e the second is the
search location ,but insert the filter.

  What type of Filter do use ?

  I have the bitset of search main (keyword), but I dont know how get
the bitset that define the location of advertising of search main.

  thanks







On Nov 19, 2007 1:19 PM, German Kondolf <german.kondolf@gmail.com> wrote:
> I have already defined a Lucene Filter for every "id" of "ubicacion".
> I just create the bitset for every value, and count it against the result.
>
> One possible optimization is to read the terms of the field you're
> trying to "group", that's the optimization we'll be working soon on
> our app.
>
> I never read all the results.
>
> On Nov 19, 2007 1:05 PM, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
>
> > German,
> >
> >   What I need is similar to the your site
> > http://listados.deremate.com.ar/panaderia .
> >   I have many results of search, but I show any result (for example:
> > first 10 for first page) , but for create the options of filter of
> > location I need read all results fof search. The problem of
> > performance is when I have 30.000 results.
> >
> >   How you get the filter the "ubication" ? You need read all results ?
> >
> >   thanks
> >
> > On Nov 19, 2007 12:05 PM, Grant Ingersoll <gsingers@apache.org> wrote:
> > > I think, based on your previous question, that you just need to use
> > > the search() method that returns TopDocs, not the lower-level
> > > HitCollector method.  From the TopDocs, you can then access the
> > > ScoreDoc, which will give you info about the doc and the score.  See http://www.lucenebootcamp.com/LuceneBootCamp/training/src/test/java/com/lucenebootcamp/training/basic/TopDocsTest.java
> > >  from my Lucene Boot Camp training class for a really simple example.
> > >
> > > -Grant
> >
> > >
> > >
> > > On Nov 19, 2007, at 9:12 AM, Haroldo Nascimento wrote:
> > >
> > > > Mark,
> > > >
> > > >  How I can get the information of Document. I think that is in the
> > > > implementation do method abstract collect. How I can get it .
> > > >
> > > >  Below is the example of javadoc the Lucene.
> > > >
> > > > Searcher searcher = new IndexSearcher(indexReader);
> > > >   final BitSet bits = new BitSet(indexReader.maxDoc());
> > > >   searcher.search(query, new HitCollector() {
> > > >       public void collect(int doc, float score) {
> > > >         bits.set(doc);
> > > >       }
> > > >     });
> > > >
> > > > Thanks
> > > >
> > > >
> > > > On Nov 18, 2007 8:09 PM, Mark Miller <markrmiller@gmail.com> wrote:
> > > >> Hey Haroldo.
> > > >>
> > > >> First thing you need to do is *stop* using Hits in your searches.
> > > >> Hits
> > > >> is optimized for some pretty specific use cases and you will get
> > > >> along
> > > >> much better by using a HitCollector.
> > > >>
> > > >> Hits has three main functions:
> > > >>
> > > >> It caches documents, normalizes scores, and stores ids associated
> > > >> with
> > > >> scores (a HitDoc). If you attempt to retrieve a HitDoc past the first
> > > >> 100 from Hits, a new search will be issued to grab double the
> > > >> required
> > > >> HitDocs needed to satisfy your HitDoc retrieval attempt. This will be
> > > >> repeated everytime you ask for a HitDoc beyond the current cache
> > > >> (which
> > > >> began at 100). This means that if you need to get a HitDoc beyond
> > > >> 100,
> > > >> Hits is not a great choice for you. You will want to use the
> > > >> HitCollector instead...but remember that you are losing the
> > > >> normalized
> > > >> scores (simple to copy code if you still want it) and the document
> > > >> caching (I rarely want that anyway).
> > > >>
> > > >> An issue to watch out for: with Hits, you do not have to ask for how
> > > >> many docs to get back, but with a HitCollector solution you will need
> > > >> to. This is a minor dilema if you want to go over all of the hits no
> > > >> matter what. You can pass a huge number to ensure you get everything,
> > > >> but you will be creating large data structures if you do this, as
> > > >> structure sizes may be initialized by the number you pass. Also,
> > > >> passing
> > > >> the maximum integer will cause an error (negative init size) as
> > > >> Lucene
> > > >> initializes a data structure to hold the hits as n+1.
> > > >>
> > > >> - Mark
> > > >>
> > > >>
> > > >> Haroldo Nascimento wrote:
> > > >>> I have a problem of performance when I need group the result do
> > > >>> search
> > > >>>
> > > >>> I have the code below:
> > > >>>
> > > >>>   for (int i = 0; i < hits.length(); i++) {
> > > >>>                    doc = hits.doc(i);
> > > >>>
> > > >>>                    obj1 = doc.get(Constants.STATE_DESC_FIELD_LABEL);
> > > >>>                    obj2 = doc.get(xxx);
> > > >>>                    ...
> > > >>>   }
> > > >>>
> > > >>>  I work with volume of data very big. The search process in 0.300
> > > >>> seconds but when the object hits have much results, the time for get
> > > >>> all objects is very big. The command hits.doc(i) is processed in 2
> > > >>> second.
> > > >>>
> > > >>>  Por exemplo. For hits.length() equals the 25.000 results, the time
> > > >>> of "pos search" is 7 seconds.
> > > >>>
> > > >>>  I get all result because I need group the result (remove the
> > > >>> duplicate results).
> > > >>>
> > > >>>  Is there any form in Lucene that group the result. I need of
> > > >>> anything as the command "group by" of sql.
> > > >>>
> > > >>>  Thanks.
> > > >>>
> > > >>
> > > >>> ---------------------------------------------------------------------
> > > >>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >>> For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >>>
> > > >>>
> > > >>>
> > > >>
> > > >> ---------------------------------------------------------------------
> > > >> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > >> For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >>
> > > >>
> > > >
> > > > ---------------------------------------------------------------------
> > > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > > >
> > >
> > > --------------------------
> > > Grant Ingersoll
> > > http://lucene.grantingersoll.com
> > >
> > > Lucene Helpful Hints:
> > > http://wiki.apache.org/lucene-java/BasicsOfPerformance
> > > http://wiki.apache.org/lucene-java/LuceneFAQ
> >
> > >
> > >
> > >
> > >
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31108-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 21:14:52 2007
Return-Path: <java-user-return-31108-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94146 invoked from network); 19 Nov 2007 21:14:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 21:14:51 -0000
Received: (qmail 11274 invoked by uid 500); 19 Nov 2007 21:14:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11245 invoked by uid 500); 19 Nov 2007 21:14:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11222 invoked by uid 99); 19 Nov 2007 21:14:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 13:14:26 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 64.233.182.185 as permitted sender)
Received: from [64.233.182.185] (HELO nf-out-0910.google.com) (64.233.182.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 21:14:16 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1380173nfc
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 13:14:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=ltB5xD6WPEo/32VPD4Wjzqvdq3CD66dMcnlKjmtnEfE=;
        b=V038wE3F9INHlNlPrp9VliDekcpOS+FwZek6ClOqkv2Z9VTIJd+JN7WAM4ukuknFjEfmo7MYTqlimj5va5UHiDC9yJX1535pvDVMzXxzOhWf/oLbrAFYV+UMVyTkMXabZuIuTStSg8IIR3rQ7xpRELAiz5rM1nFpUaBmFa7kgAk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=JrDM7NDShxon32VpcHzc6uKRK6OPfmnussuxRW59gz5O227rUn43TqtcFQndCg2PZwRIfrbUoTjOH2/5c8ukznj3HJG/0cj5YcOjQ+8qw5ucrn4E7IEb0tHp6h5+j3Tm/RNIjYaGqMn+gYbD+TK86VF4pQqizgxhCrN9OZzTvhg=
Received: by 10.86.84.5 with SMTP id h5mr5445247fgb.1195506848806;
        Mon, 19 Nov 2007 13:14:08 -0800 (PST)
Received: by 10.86.59.11 with HTTP; Mon, 19 Nov 2007 13:14:08 -0800 (PST)
Message-ID: <8837fb770711191314x223f4bfdie7c661c66e86e4e2@mail.gmail.com>
Date: Mon, 19 Nov 2007 13:14:08 -0800
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: setting position value at indexing time
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi:

   What is the right way of setting customized position value on a
token at indexing time.

Thanks

-John

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31109-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 21:24:01 2007
Return-Path: <java-user-return-31109-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98133 invoked from network); 19 Nov 2007 21:24:01 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 21:24:01 -0000
Received: (qmail 28993 invoked by uid 500); 19 Nov 2007 21:23:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28628 invoked by uid 500); 19 Nov 2007 21:23:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28602 invoked by uid 99); 19 Nov 2007 21:23:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 13:23:43 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 209.85.162.177 as permitted sender)
Received: from [209.85.162.177] (HELO el-out-1112.google.com) (209.85.162.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 21:23:33 +0000
Received: by el-out-1112.google.com with SMTP id o28so671211ele
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 13:22:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=ceNLZH9+mEn4ENkpn9p7AldJy/CbkqtI2dlar+cZZ2Y=;
        b=MUmAy6IuNg39b/yDlMl8RctMOK89xT73JRLkq2+uogkIw4YENcn1CZcl9/2fXtvGy7glwLeXfE62wyLrDuzLD+lmYRzdXDZVQFdQL7tK10a3ywdLtdlXvYA5oaRqlfIp+/VhXd1Ql41zUXaWDoC+hcr5XOyH9ds8ANUCfbv1YTQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=QmoyAhVP9RinnaSXwe/uD6MVVRYf8UBxuZRNzlMkIIBuhuU5vbJzgGH0cJ4wOaSHpJ4gCQrKWmdJxdLtoYHvJLFidIg24GxUsZpe+PlPb8z2/xLQThJPbTvPnhZOYqxaA3Gf4U5WorQ0lBExxt4IAEuSDc9AAdbQ28lqQAsfYXw=
Received: by 10.142.213.9 with SMTP id l9mr216757wfg.1195507372182;
        Mon, 19 Nov 2007 13:22:52 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Mon, 19 Nov 2007 13:22:52 -0800 (PST)
Message-ID: <c68e39170711191322x3c3476c6u993bb60fb2094a0b@mail.gmail.com>
Date: Mon, 19 Nov 2007 16:22:52 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: setting position value at indexing time
In-Reply-To: <8837fb770711191314x223f4bfdie7c661c66e86e4e2@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <8837fb770711191314x223f4bfdie7c661c66e86e4e2@mail.gmail.com>
X-Google-Sender-Auth: f644a4d7a6b6857c
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 19, 2007 4:14 PM, John Wang <john.wang@gmail.com> wrote:
>    What is the right way of setting customized position value on a
> token at indexing time.

You set the positionIncrement, and the lucene indexing code determines
the absolute position.  You can't set an absolute position yourself.

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31110-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 22:04:27 2007
Return-Path: <java-user-return-31110-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 14989 invoked from network); 19 Nov 2007 22:04:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 22:04:27 -0000
Received: (qmail 89409 invoked by uid 500); 19 Nov 2007 22:04:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89360 invoked by uid 500); 19 Nov 2007 22:04:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89322 invoked by uid 99); 19 Nov 2007 22:04:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 14:04:08 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 22:03:58 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id B2DAE71C214; Mon, 19 Nov 2007 14:03:51 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id AFA9C71C1F1
	for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 14:03:51 -0800 (PST)
Date: Mon, 19 Nov 2007 14:03:51 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Scoring for all the documents in the index relative to a query
In-Reply-To: <359a92830711190855l77f66321kf53fc4020af2ba4b@mail.gmail.com>
Message-ID: <Pine.LNX.4.62.0711191350350.16033@radix.cryptio.net>
References: <604180.39834.qm@web60417.mail.yahoo.com>
 <359a92830711190855l77f66321kf53fc4020af2ba4b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: My simplistic view has been that all the docs returned via Hits
: or HitCollector have scores > 0, and all the rest have scores of 0,
: and this view is supported by the explanation of
: HitCollector.collect
: 
: " Called once for every non-zero scoring document, with the
: document number and its score."

(Hmmm... i thought those javadocs had been fixed a while back?  oh well, 
i just did: r596462)

Strictly speaking there's nothing to stop a document from having a zero or 
negative *raw* score for a query (ie: a ValueSourceQuery for example) it's 
just not common.

the HitCollector.collect method is called for every *matching* document, 
with it's raw score.

(I'm not actually sure how the Hits class treats negative values ... odds 
are no one using the Hits class is going to be dealing with a query that 
can product negative scores though)




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31111-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 22:35:44 2007
Return-Path: <java-user-return-31111-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 24065 invoked from network); 19 Nov 2007 22:35:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 22:35:44 -0000
Received: (qmail 28041 invoked by uid 500); 19 Nov 2007 22:35:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28018 invoked by uid 500); 19 Nov 2007 22:35:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28007 invoked by uid 99); 19 Nov 2007 22:35:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 14:35:25 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 64.233.162.231 as permitted sender)
Received: from [64.233.162.231] (HELO nz-out-0506.google.com) (64.233.162.231)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 22:35:15 +0000
Received: by nz-out-0506.google.com with SMTP id i28so1401101nzi
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 14:35:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=UlTmNJIUhHs1G/iuDuro0geKKPM6+S4N0sJ2jRQi92Y=;
        b=GoazPf915sbqLjmm0Buzz+ePfg10trEJt3R/Q+Zf17+mTGbt9hMGpNhrn2jG6b19pEjgSY3K9p/c3K9xcTLlMRybnNLISEEsBQzgQMzoB+SBtRVLYEKHm4LvespQ1XeWsaCYXeAkIqdMTVQZyL3gzU91YlnLGiDht4aLBlEGjoE=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=gqicSsml88zjVc2Y41a2ZeSBJbKZ8wznlzWl1u9smNhbMtU84RjZQht+Aw42ifgG6M3B3UHbpY0GZw+Ar/R+7+Q1dKoUmtZuunc6J4yNF4cX0bMZ1ZHRHGxMaGHoYlTD60nf37dWYjwGPooI/rAnUx6vFSpAjBoInnY83iKL+zk=
Received: by 10.142.217.17 with SMTP id p17mr1360659wfg.1195511708017;
        Mon, 19 Nov 2007 14:35:08 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Mon, 19 Nov 2007 14:35:07 -0800 (PST)
Message-ID: <c68e39170711191435h722c2599yc424908a680b315f@mail.gmail.com>
Date: Mon, 19 Nov 2007 17:35:07 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: Scoring for all the documents in the index relative to a query
In-Reply-To: <Pine.LNX.4.62.0711191350350.16033@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <604180.39834.qm@web60417.mail.yahoo.com>
	 <359a92830711190855l77f66321kf53fc4020af2ba4b@mail.gmail.com>
	 <Pine.LNX.4.62.0711191350350.16033@radix.cryptio.net>
X-Google-Sender-Auth: 87f234e8f7515dd3
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 19, 2007 5:03 PM, Chris Hostetter <hossman_lucene@fucit.org> wrote:
> (I'm not actually sure how the Hits class treats negative values

All Lucene search methods except ones that take a HitCollector filter
out final scores <= 0

Solr does allow scores <=0 through since it had different collection
methods to avoid score normalization (back when Lucene still did it
for TopDocs).

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31112-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 22:41:28 2007
Return-Path: <java-user-return-31112-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26618 invoked from network); 19 Nov 2007 22:41:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 22:41:27 -0000
Received: (qmail 37911 invoked by uid 500); 19 Nov 2007 22:41:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37875 invoked by uid 500); 19 Nov 2007 22:41:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37858 invoked by uid 99); 19 Nov 2007 22:41:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 14:41:08 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 64.233.170.187 as permitted sender)
Received: from [64.233.170.187] (HELO rn-out-0102.google.com) (64.233.170.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 22:40:59 +0000
Received: by rn-out-0102.google.com with SMTP id v46so1229371rnb
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 14:40:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=Su+R8or2It5cE7P1mrNo+578vLOJS4vHbHKzgpcNrZQ=;
        b=YQUIBUuZHLpSr8E8sYVVBYD4HA/r5emx9H35Mxgz52yrjpqyYv8Nw+7cQ1+hsFoWmqYcPiiClHDX1NU8aq4zzg/PuTixNBLILA4VMzmYo7rS3im3yYGErvPcOWir8ewSuzJzUQbQ2A6rrD4bNCNJa93LoU0LLooVKUl60fzGvBI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=UEm96prpZZ58UYXGsI9Jas1G+N/bvKhz3A7vWupr3+kJZfvj1zE2K0JDNMnqL0iBWEB6hoQt+rO0SHh5eUq9b4p5UWJF+CZjxUk0IhryCd5pvvkaWYEjMCwmB1GpgId4ps0RUg4mRK6GQA88XaaQ9f+8UJQGaYIrNohrrM8azyA=
Received: by 10.151.8.8 with SMTP id l8mr739518ybi.1195512052660;
        Mon, 19 Nov 2007 14:40:52 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Mon, 19 Nov 2007 14:40:52 -0800 (PST)
Message-ID: <718789d20711191440y43de7337sd6fafea4f035a8d3@mail.gmail.com>
Date: Mon, 19 Nov 2007 19:40:52 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Time of processing hits.doc()
In-Reply-To: <718789d20711191314n16570772nad884322b7ba5569@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711181332l1eeac315v732a5c6438ad0939@mail.gmail.com>
	 <4740C637.2010809@gmail.com>
	 <718789d20711190612p5af71ddesa64dccfced56891e@mail.gmail.com>
	 <CE28066E-E8D1-4BC4-8922-7B848D8B08FA@apache.org>
	 <718789d20711190805p4b49241epdbdf63ddee32c93b@mail.gmail.com>
	 <76df56980711190819o9acd211q798412af04a770d4@mail.gmail.com>
	 <718789d20711191314n16570772nad884322b7ba5569@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

In the sample TestSort represents my problem:

  In the info below I need get the list of  "contents" that contains
"x" (A,C,E,G,I) and other list of index  (5,2,3) that not contain info
replicated.

  The first list I get using any query of type: query = new TermQuery
(new Term ("contents", "x")) and after of serach I get the docId using

  final TopDocs topDocs = full.search(query,null,nDocs,sort);
  final ScoreDoc[] scoreDocs = topDocs.scoreDocs;

but I know how that the second list using the SetBit of the first search.

 There is any example the show how I do it ?


     private String[][] data = new String[][] {
            // tracer  contents         index            float
  string   custom   i18n
            {   "A",   "x a",           "5",           "4f",
"c",     "A-3",   "p\u00EAche"},
            {   "B",   "y a",           "5",           "3.4028235E38",
"i",     "B-10",  "HAT"},
            {   "C",   "x a b c",       "2",  "1.0",          "j",
"A-2",   "p\u00E9ch\u00E9"},
            {   "D",   "y a b c",       "-1",          "0.0f",
"a",     "C-0",   "HUT"},
            {   "E",   "x a b c d",     "5",           "2f",
"h",     "B-8",   "peach"},
            {   "F",   "y a b c d",     "2",           "3.14159f",
"g",     "B-1",   "H\u00C5T"},
            {   "G",   "x a b c d",     "3",           "-1.0",
"f",     "C-100", "sin"},
            {   "H",   "y a b c d",     "0",           "1.4E-45",
"e",     "C-88",  "H\u00D8T"},
            {   "I",   "x a b c d e f",  "2", "1.0e+0",       "d",
"A-10",  "s\u00EDn"},
            {   "J",   "y a b c d e f",  "4",           ".5",
 "b",     "C-7",   "HOT"},
            {   "W",   "g",                "1",           null,
   null,    null,    null},
            {   "X",   "g",             "1",           "0.1",
null,    null,    null},
            {   "Y",   "g",             "1",           "0.2",
null,    null,    null},
            {   "Z",   "f g",           null,          null,
null,    null,    null}
            };

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31113-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 23:09:39 2007
Return-Path: <java-user-return-31113-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34719 invoked from network); 19 Nov 2007 23:09:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 23:09:39 -0000
Received: (qmail 79682 invoked by uid 500); 19 Nov 2007 23:09:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79646 invoked by uid 500); 19 Nov 2007 23:09:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79635 invoked by uid 99); 19 Nov 2007 23:09:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 15:09:20 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.30] (HELO smtp-vbr10.xs4all.nl) (194.109.24.30)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 23:09:23 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr10.xs4all.nl (8.13.8/8.13.8) with ESMTP id lAJN93T9038774
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 00:09:03 +0100 (CET)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Scoring for all the documents in the index relative to a query
Date: Tue, 20 Nov 2007 00:09:02 +0100
User-Agent: KMail/1.9.6 (enterprise 0.20070907.709405)
References: <604180.39834.qm@web60417.mail.yahoo.com> <Pine.LNX.4.62.0711191350350.16033@radix.cryptio.net> <c68e39170711191435h722c2599yc424908a680b315f@mail.gmail.com>
In-Reply-To: <c68e39170711191435h722c2599yc424908a680b315f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711200009.02857.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Gentlefolk,

Well, the javadocs as patched at LUCENE-584 try to change all
the cases of zero scoring to 'non matching'.

I'm happily bracing for a minor conflict with that patch. In case
someone wants to take another look at the javadocs as
patched there, don't let me stop you...

Regards,
Paul Elschot




On Monday 19 November 2007 23:35:07 Yonik Seeley wrote:
> On Nov 19, 2007 5:03 PM, Chris Hostetter <hossman_lucene@fucit.org> wrote:
> > (I'm not actually sure how the Hits class treats negative values
>
> All Lucene search methods except ones that take a HitCollector filter
> out final scores <= 0
>
> Solr does allow scores <=0 through since it had different collection
> methods to avoid score normalization (back when Lucene still did it
> for TopDocs).
>
> -Yonik
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31114-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 19 23:40:02 2007
Return-Path: <java-user-return-31114-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42012 invoked from network); 19 Nov 2007 23:40:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 19 Nov 2007 23:40:02 -0000
Received: (qmail 23776 invoked by uid 500); 19 Nov 2007 23:39:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23295 invoked by uid 500); 19 Nov 2007 23:39:42 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23279 invoked by uid 99); 19 Nov 2007 23:39:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 15:39:42 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 66.249.92.174 as permitted sender)
Received: from [66.249.92.174] (HELO ug-out-1314.google.com) (66.249.92.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 23:39:32 +0000
Received: by ug-out-1314.google.com with SMTP id h3so1119746ugf
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 15:39:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=VlXJjLOhsIrsQMN0J1DJpbAMS4Og4dZtYj61/7+iA9I=;
        b=BMAqAa3qFZ+i2J7t3juPV3pb8mCgEocmsvS/to2Qa6ZE4KFvfUrwtjXGAe37kp3FA1oCngHXkR1ImeAs2+nDKXyU4Jk+FHA+KXTFM9asJ1RTQjlCuumyyjYnmI7WQLbXBfo+XFRkLQxpXp82zZCml56SCHtB34zOFTFz+Mng6NA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=N6hQo6HfOQbut4r2scA/okAPM2Cbtl+MENqPK06safqJKiS44hsC8RptluiLD/jIoDpSTXmJWTai3BZs3qjsdp9PJW4l/viI3bk9NOxUt1KnR6yhnOMWEv1U5zRm7naxIC00Hy5/0Pghr4QJzRyuYO4d5DPMzjPhASUSsaLdd4o=
Received: by 10.86.53.8 with SMTP id b8mr5540889fga.1195515565133;
        Mon, 19 Nov 2007 15:39:25 -0800 (PST)
Received: by 10.86.59.11 with HTTP; Mon, 19 Nov 2007 15:39:24 -0800 (PST)
Message-ID: <8837fb770711191539i4105436aj3ec32d436cc73e9b@mail.gmail.com>
Date: Mon, 19 Nov 2007 15:39:24 -0800
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: setting position value at indexing time
In-Reply-To: <c68e39170711191322x3c3476c6u993bb60fb2094a0b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <8837fb770711191314x223f4bfdie7c661c66e86e4e2@mail.gmail.com>
	 <c68e39170711191322x3c3476c6u993bb60fb2094a0b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

oh, is there a way of opening that?

In the UID example Mike gave, it seems that uid can be stored in the
position part of the data.
It would be very efficient in both load time and index size to be able
to do that.

Thanks

-john

On Nov 19, 2007 1:22 PM, Yonik Seeley <yonik@apache.org> wrote:
> On Nov 19, 2007 4:14 PM, John Wang <john.wang@gmail.com> wrote:
> >    What is the right way of setting customized position value on a
> > token at indexing time.
>
> You set the positionIncrement, and the lucene indexing code determines
> the absolute position.  You can't set an absolute position yourself.
>
> -Yonik
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31115-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 00:29:25 2007
Return-Path: <java-user-return-31115-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57275 invoked from network); 20 Nov 2007 00:29:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 00:29:25 -0000
Received: (qmail 58452 invoked by uid 500); 20 Nov 2007 00:29:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58417 invoked by uid 500); 20 Nov 2007 00:29:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58406 invoked by uid 99); 20 Nov 2007 00:29:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 16:29:06 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of yseeley@gmail.com designates 64.233.170.188 as permitted sender)
Received: from [64.233.170.188] (HELO rn-out-0102.google.com) (64.233.170.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 00:28:56 +0000
Received: by rn-out-0102.google.com with SMTP id v46so1253616rnb
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 16:28:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        bh=rkvD6c8mFL+KbNUPrkae9iVo9v4blpBM3j87fiB9iO8=;
        b=b9AFczM9DggNNATHt9Qak0NlMs21CmVaSgsQoFjf8rvIpWXcl+iKQN+ulmfcIN30s5u+MUyhSaR2HJPNnzdhLiVhTpDR3KwOctAvyqWvw/3GAbZUcjpuYtnb7qbUaJnI5sa4tYiQ+t0FAKJJ851FmqjaERZonPP4x+ajSYlAlgI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references:x-google-sender-auth;
        b=c1eDB97a3EVx7sBYy0uVx2dMB4m+2rsrmhOFf4Qoi5c/wyFuWPcudYzf1EcD8aIB7qz5rmiC2Ft3MLxkpce2tZqbwjZgu/g2hUi5SPyaP798zGZK7K2RN6caHPxG0jZ+BYiNr6Fm3ezCs4Hln+OPGtHWKOqBXxruhH5zJP92ZSQ=
Received: by 10.142.231.7 with SMTP id d7mr1376951wfh.1195518528059;
        Mon, 19 Nov 2007 16:28:48 -0800 (PST)
Received: by 10.143.165.13 with HTTP; Mon, 19 Nov 2007 16:28:48 -0800 (PST)
Message-ID: <c68e39170711191628n112af979t1fadf9003c4bad61@mail.gmail.com>
Date: Mon, 19 Nov 2007 19:28:48 -0500
From: "Yonik Seeley" <yonik@apache.org>
Sender: yseeley@gmail.com
To: java-user@lucene.apache.org
Subject: Re: setting position value at indexing time
In-Reply-To: <8837fb770711191539i4105436aj3ec32d436cc73e9b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <8837fb770711191314x223f4bfdie7c661c66e86e4e2@mail.gmail.com>
	 <c68e39170711191322x3c3476c6u993bb60fb2094a0b@mail.gmail.com>
	 <8837fb770711191539i4105436aj3ec32d436cc73e9b@mail.gmail.com>
X-Google-Sender-Auth: e15bf2711a2741d6
X-Virus-Checked: Checked by ClamAV on apache.org

On Nov 19, 2007 6:39 PM, John Wang <john.wang@gmail.com> wrote:
> oh, is there a way of opening that?

Well, you can keep track of position increments yourself and then
choose the correct position increment so that the position you want is
indexed.  AFAIK, positions increments must be positive , so you can't
go backwards.

It sounds like you are trying to use positions as payloads?

-Yonik

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31116-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 03:12:55 2007
Return-Path: <java-user-return-31116-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11424 invoked from network); 20 Nov 2007 03:12:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 03:12:55 -0000
Received: (qmail 71500 invoked by uid 500); 20 Nov 2007 03:12:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71464 invoked by uid 500); 20 Nov 2007 03:12:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71453 invoked by uid 99); 20 Nov 2007 03:12:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Nov 2007 19:12:36 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of john.wang@gmail.com designates 64.233.182.185 as permitted sender)
Received: from [64.233.182.185] (HELO nf-out-0910.google.com) (64.233.182.185)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 03:12:26 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1444062nfc
        for <java-user@lucene.apache.org>; Mon, 19 Nov 2007 19:12:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=BvkRI2Ps7PZPK/w9TY1fqsVwye4c4E2LRk41Xq6TpFs=;
        b=GitgIY2I5zQ3S7cwhHnnA0A7UM8BUkOgwAQyOnds6GBWAP/UplDJZjMEk3WuJAme1RR1AYCuxvGNjBjhvQUxifjqtJ4pnFYjusYNunljgIZRsOipM/cZOloI1QhISLqhE5BcLmkMIbSK2k3Rq2PynafOU0Ol0Qf3isA0CQVd4E4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=h+lTuKBjhnBW6ww6ZyWe0qhxM9jh7t2wsz6tIyaUjzPqBf6tL1bZfKK8+5xIZ7fSuz5uWE92rSIWyI93kP0EyZkHTzFFDNccuFR2janX2Qoh1nv8ahFOKQhyBdttBz6dU+gURCIu+7vB/CENpR8maLlfDrhNt5iCqNT70NLrgoU=
Received: by 10.86.100.7 with SMTP id x7mr5676443fgb.1195528338588;
        Mon, 19 Nov 2007 19:12:18 -0800 (PST)
Received: by 10.86.59.11 with HTTP; Mon, 19 Nov 2007 19:12:18 -0800 (PST)
Message-ID: <8837fb770711191912t704dd1e8wd7f23fd30ad53a7f@mail.gmail.com>
Date: Mon, 19 Nov 2007 19:12:18 -0800
From: "John Wang" <john.wang@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: setting position value at indexing time
In-Reply-To: <c68e39170711191628n112af979t1fadf9003c4bad61@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <8837fb770711191314x223f4bfdie7c661c66e86e4e2@mail.gmail.com>
	 <c68e39170711191322x3c3476c6u993bb60fb2094a0b@mail.gmail.com>
	 <8837fb770711191539i4105436aj3ec32d436cc73e9b@mail.gmail.com>
	 <c68e39170711191628n112af979t1fadf9003c4bad61@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, I am.

The UID example Michael gave provides a way for us not to branch from
lucene code base.

I am trying to improve on it by storing the uid using position (since
position info is not used for ids) which would buy use in load time
quite a bit.

-John

On Nov 19, 2007 4:28 PM, Yonik Seeley <yonik@apache.org> wrote:
> On Nov 19, 2007 6:39 PM, John Wang <john.wang@gmail.com> wrote:
> > oh, is there a way of opening that?
>
> Well, you can keep track of position increments yourself and then
> choose the correct position increment so that the position you want is
> indexed.  AFAIK, positions increments must be positive , so you can't
> go backwards.
>
> It sounds like you are trying to use positions as payloads?
>
>
> -Yonik
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31117-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 08:31:30 2007
Return-Path: <java-user-return-31117-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 35010 invoked from network); 20 Nov 2007 08:31:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 08:31:30 -0000
Received: (qmail 85328 invoked by uid 500); 20 Nov 2007 08:31:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84339 invoked by uid 500); 20 Nov 2007 08:31:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84328 invoked by uid 99); 20 Nov 2007 08:31:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 00:31:11 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 08:31:01 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IuOVT-0006VV-47
	for java-user@lucene.apache.org; Tue, 20 Nov 2007 00:30:55 -0800
Message-ID: <13852774.post@talk.nabble.com>
Date: Tue, 20 Nov 2007 00:30:55 -0800 (PST)
From: crazy <elhatri.ouidad@gmail.com>
To: java-user@lucene.apache.org
Subject: indexing excel file
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: elhatri.ouidad@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi, i want to index an excel file with nutch and i have the following error:

http://dev.torrez.us/public/2006/pundit/java/src/plugin/parse-msexcel/sample/test.xls:
failed(2,0): Can't be handled as Microsoft document.
java.lang.ArrayIndexOutOfBoundsException: No cell at position col1, row 0.

I already add msexcel in the plugin.includes:

<name>plugin.includes</name>
  <value>protocol-http|urlfilter-regex|parse-(text|html|htm|js|pdf|
msword|mspowerpoint|msexcel)|index-basic|query-(basic|site|url)|summary-
msword|mspowerpoint|basic|
scoring-opic|urlnormalizer-(pass|regex|basic)</value>

 i don't now where is the probleme
help plz 
-- 
View this message in context: http://www.nabble.com/indexing-excel-file-tf4841913.html#a13852774
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31118-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 10:53:35 2007
Return-Path: <java-user-return-31118-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 7893 invoked from network); 20 Nov 2007 10:53:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 10:53:34 -0000
Received: (qmail 11541 invoked by uid 500); 20 Nov 2007 10:53:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 11515 invoked by uid 500); 20 Nov 2007 10:53:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 11502 invoked by uid 99); 20 Nov 2007 10:53:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 02:53:16 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.43 as permitted sender)
Received: from [80.67.18.43] (HELO smtprelay05.ispgateway.de) (80.67.18.43)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 10:53:03 +0000
Received: (qmail 7973 invoked from network); 20 Nov 2007 10:52:54 -0000
Received: from unknown (HELO p54bfccb1.dip.t-dialin.net) (695637@[84.191.204.177])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay05.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 20 Nov 2007 10:52:54 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: neither IndexWriter nor IndexReader would delete documents
Date: Tue, 20 Nov 2007 11:53:00 +0100
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <13824599.post@talk.nabble.com> <200711191242.48449@danielnaber.de> <13844914.post@talk.nabble.com>
In-Reply-To: <13844914.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711201153.00445@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Montag, 19. November 2007, flateric wrote:

> the number returned by delete is 0, but the "uid" shows up in Luke so it
> is there.

Not sure what the problem might be, but it can surely be analyzed if you 
write a small self-contained test-case and post it here.

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31119-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 11:30:21 2007
Return-Path: <java-user-return-31119-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25551 invoked from network); 20 Nov 2007 11:30:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 11:30:21 -0000
Received: (qmail 66821 invoked by uid 500); 20 Nov 2007 11:30:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66794 invoked by uid 500); 20 Nov 2007 11:30:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66783 invoked by uid 99); 20 Nov 2007 11:30:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 03:30:02 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 11:30:05 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IuRIW-00039n-Cu
	for java-user@lucene.apache.org; Tue, 20 Nov 2007 03:29:44 -0800
Message-ID: <13855272.post@talk.nabble.com>
Date: Tue, 20 Nov 2007 03:29:44 -0800 (PST)
From: kumarlimbu <kumarlimbu@gmail.com>
To: java-user@lucene.apache.org
Subject: Is storing 20 fields in a lucene document desirable?
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable
X-Nabble-From: kumarlimbu@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Our document contains a total of 23 fields in one document and we STORE all
of them in lucene index.=20

We have recently had some performance issues and our analysis has shown the
bottleneck to be lucene search and retrieval.

We have been thinking about reducing the number of fields per document by
removing unnecessary fields and by merging fields with similar weightings.
Will reducing the number of fields help to optimize performance?

Another issue is we are currently retrieving around 9 fields after we do a
search. Some are long text of up to 1000 words. Is it a large overhead to
retrieve long fields?=20

We are considering the option of separating the search and retrieve parts s=
o
that Lucene performs the search, MYSQL stores the data. We just store the
INDEXED field and primary key in the lucene index. After searching we only
return 1 field (primary key) instead of 9 fields. This field will be used
for retrieving the actual information from the MySQL database. Will reducin=
g
the number of fields retrieved from lucene reduce the response time or will
using MySQL database make it worse?=20

So our main concern is to find if retrieving fields usually takes longer
than searching or not? What does lucene spend most time doing =E2=80=93 sea=
rch or
retrieval? We are also concerned that using MySQL will have performance
issues because we will be doing I/O for MySQL as well as Lucene. We also ad=
d
around 100k documents each day and remove around the same number of
documents. Will this frequent read and write have impact on performance?

Our current index size is around 8G and contains around 3M documents.

If there are any suggestions or questions, please reply.

Thanks you all!

Regards,
Kumar

--=20
View this message in context: http://www.nabble.com/Is-storing-20-fields-in=
-a-lucene-document-desirable--tf4842930.html#a13855272
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31120-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 12:21:42 2007
Return-Path: <java-user-return-31120-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54753 invoked from network); 20 Nov 2007 12:21:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 12:21:42 -0000
Received: (qmail 24859 invoked by uid 500); 20 Nov 2007 12:21:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 24826 invoked by uid 500); 20 Nov 2007 12:21:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 24815 invoked by uid 99); 20 Nov 2007 12:21:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 04:21:22 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a20.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 12:21:10 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a20.g.dreamhost.com (Postfix) with ESMTP id 30988E2517
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 04:21:02 -0800 (PST)
Message-Id: <C8DCFA59-9540-4DE1-8677-62FE41CD7192@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <13855272.post@talk.nabble.com>
Content-Type: text/plain; charset=WINDOWS-1252; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Is storing 20 fields in a lucene document desirable?
Date: Tue, 20 Nov 2007 07:21:01 -0500
References: <13855272.post@talk.nabble.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org


On Nov 20, 2007, at 6:29 AM, kumarlimbu wrote:

>
> Our document contains a total of 23 fields in one document and we =20
> STORE all
> of them in lucene index.
>
> We have recently had some performance issues and our analysis has =20
> shown the
> bottleneck to be lucene search and retrieval.

Perhaps you can share your information on java-dev along with any =20
detailed tests, etc. so that we can see if there is anything we can =20
improve.

>
>
> We have been thinking about reducing the number of fields per =20
> document by
> removing unnecessary fields and by merging fields with similar =20
> weightings.
> Will reducing the number of fields help to optimize performance?

Yes

>
>
> Another issue is we are currently retrieving around 9 fields after =20
> we do a
> search. Some are long text of up to 1000 words. Is it a large =20
> overhead to
> retrieve long fields?

Yes.  Are you using FieldSelector?  Also, I would only STORE those =20
fields that you actually need to display, not all 23.  Do you display =20=

all 9 fields right away or are some only when you choose a document?  =20=

If so, try the Lazy Loading piece of FieldSelector.

>
>
> We are considering the option of separating the search and retrieve =20=

> parts so
> that Lucene performs the search, MYSQL stores the data. We just =20
> store the
> INDEXED field and primary key in the lucene index. After searching =20
> we only
> return 1 field (primary key) instead of 9 fields. This field will be =20=

> used
> for retrieving the actual information from the MySQL database. Will =20=

> reducing
> the number of fields retrieved from lucene reduce the response time =20=

> or will
> using MySQL database make it worse?

Hard to say, you will likely have to try it out.

>
>
> So our main concern is to find if retrieving fields usually takes =20
> longer
> than searching or not? What does lucene spend most time doing =96 =20
> search or
> retrieval? We are also concerned that using MySQL will have =20
> performance
> issues because we will be doing I/O for MySQL as well as Lucene. We =20=

> also add
> around 100k documents each day and remove around the same number of
> documents. Will this frequent read and write have impact on =20
> performance?
>

What version of Lucene are you using?  Naturally, if you are updating =20=

things that will have an effect, but that may not be a factor.  I =20
would check out http://wiki.apache.org/lucene-java/BasicsOfPerformance

Also, you may want to try out (not in production) the trunk version of =20=

Lucene.

Last, but not least, do you have some sort of cache for your =20
Documents?  Obviously, you need to have appropriate semantics for when =20=

the underlying docs change, but using a cache makes sense, too.

-Grant


--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31121-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 12:28:25 2007
Return-Path: <java-user-return-31121-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56372 invoked from network); 20 Nov 2007 12:28:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 12:28:25 -0000
Received: (qmail 29999 invoked by uid 500); 20 Nov 2007 12:28:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29964 invoked by uid 500); 20 Nov 2007 12:28:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29953 invoked by uid 99); 20 Nov 2007 12:28:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 04:28:06 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of DORONC@il.ibm.com designates 195.212.29.153 as permitted sender)
Received: from [195.212.29.153] (HELO mtagate4.de.ibm.com) (195.212.29.153)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 12:27:54 +0000
Received: from d12nrmr1607.megacenter.de.ibm.com (d12nrmr1607.megacenter.de.ibm.com [9.149.167.49])
	by mtagate4.de.ibm.com (8.13.8/8.13.8) with ESMTP id lAKCRjFD125556
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 12:27:45 GMT
Received: from d12av02.megacenter.de.ibm.com (d12av02.megacenter.de.ibm.com [9.149.165.228])
	by d12nrmr1607.megacenter.de.ibm.com (8.13.8/8.13.8/NCO v8.6) with ESMTP id lAKCRjNH1552622
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 13:27:45 +0100
Received: from d12av02.megacenter.de.ibm.com (loopback [127.0.0.1])
	by d12av02.megacenter.de.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id lAKCRjXP030813
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 13:27:45 +0100
Received: from d12mc102.megacenter.de.ibm.com (d12mc102.megacenter.de.ibm.com [9.149.167.114])
	by d12av02.megacenter.de.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id lAKCRjwx030809
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 13:27:45 +0100
In-Reply-To: <870644.85955.qm@web60413.mail.yahoo.com>
Subject: Re: Scoring for all the documents in the index relative to a query
To: java-user@lucene.apache.org
X-Mailer: Lotus Notes Release 7.0 HF277 June 21, 2006
Message-ID: <OF82B2996E.9DE73F0A-ONC2257399.00425DE7-C2257399.0044110E@il.ibm.com>
From: Doron Cohen <DORONC@il.ibm.com>
Date: Tue, 20 Nov 2007 14:23:28 +0200
X-MIMETrack: Serialize by Router on D12MC102/12/M/IBM(Release 7.0.2HF71 | November 3, 2006) at
 20/11/2007 14:27:44
MIME-Version: 1.0
Content-type: text/plain; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org

You can also rely on that by default documents are
collected in-docid-order. You can therefore use your own
hit collector that when collecting doc with id n2,
assuming the previous doc collected had id n1,
would (know to) assign score 0 to all docs
with: n1 < id < n2.

In other words, you can know earlier that a certain
doc is a non-match, not having to wait until all
matching docs were collected. (well, at least I had
the impression that something like this might help you.)

Doron

HAIDUC SONIA wrote:
> I am trying to order all the documents in the index according
> to their similarity to a given query. I am interested in having
> a complete list of *all* the documents in the index with their
> score. From what I understood by reading some documentation,
> Lucene internally assigns scores to all the documents in the
> index according to their similarity to the query, but when
> returning the hits, all the scores that are less than 0 are
> rounded to 0 and only the documents with the score > 0 are
> returned as hits. But what I would like to get is the list
> before this intermediate processing, so the list of all the
> documents with their raw score. I am trying to compare Lucene
> with LSI and for the comparison I want to do, I need the entire
> list of documents. Is there a way that I can get that with Lucene?
> I hope I explained it clearly this time. If you need more
> details let me know.
>
> Thank you,
> Sonia


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31122-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 12:56:13 2007
Return-Path: <java-user-return-31122-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67179 invoked from network); 20 Nov 2007 12:56:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 12:56:13 -0000
Received: (qmail 61235 invoked by uid 500); 20 Nov 2007 12:55:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61206 invoked by uid 500); 20 Nov 2007 12:55:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61195 invoked by uid 99); 20 Nov 2007 12:55:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 04:55:54 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [84.14.163.131] (HELO trinity.anyware-tech.com) (84.14.163.131)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 12:55:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by trinity.anyware-tech.com (Postfix) with ESMTP id D52A5400052
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 13:55:33 +0100 (CET)
Received: from trinity.anyware-tech.com ([127.0.0.1])
	by localhost (trinity.anyware-tech.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 31876-06 for <java-user@lucene.apache.org>;
	Tue, 20 Nov 2007 13:55:28 +0100 (CET)
Received: from almeda.anyware (almeda.anyware [10.0.3.16])
	by trinity.anyware-tech.com (Postfix) with ESMTP id DE6E0400048
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 13:55:27 +0100 (CET)
From: Nicolas =?iso-8859-1?q?Lalev=E9e?= <nicolas.lalevee@anyware-tech.com>
Organization: Anyware Technologies
To: java-user@lucene.apache.org
Subject: Custom query parser
Date: Tue, 20 Nov 2007 13:55:28 +0100
User-Agent: KMail/1.9.7
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711201355.28973.nicolas.lalevee@anyware-tech.com>
X-Virus-Scanned: Debian amavisd-new at anyware-tech.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I am willing to have a query parser which is fault tolerant. I have search 
over the archive, and I have found this :
http://www.nabble.com/Error-tolerant-query-parsing-tf108987.html#a300382

I also want my parser to have very simple feature : phrase search and field 
search. So I need to develop a simple query parser myself : not that hard, a 
simple state machine will be the trick.

But here I loose an important feature of the Lucene query parser : creating 
queries regarding an analyzer. In fact I loose that very usefull function :
http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/queryParser/QueryParser.html#getFieldQuery(java.lang.String,
%20java.lang.String)

So is there any proper way to create a custom query parser without duplicating 
the code ?

cheers,
Nicolas

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31123-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 15:36:02 2007
Return-Path: <java-user-return-31123-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23973 invoked from network); 20 Nov 2007 15:36:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 15:36:02 -0000
Received: (qmail 32091 invoked by uid 500); 20 Nov 2007 15:35:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31637 invoked by uid 500); 20 Nov 2007 15:35:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31626 invoked by uid 99); 20 Nov 2007 15:35:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 07:35:43 -0800
X-ASF-Spam-Status: No, hits=-2.0 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of gresh@us.ibm.com designates 32.97.182.142 as permitted sender)
Received: from [32.97.182.142] (HELO e2.ny.us.ibm.com) (32.97.182.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 15:35:31 +0000
Received: from d01relay04.pok.ibm.com (d01relay04.pok.ibm.com [9.56.227.236])
	by e2.ny.us.ibm.com (8.13.8/8.13.8) with ESMTP id lAKFZOSC015603
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 10:35:24 -0500
Received: from d01av03.pok.ibm.com (d01av03.pok.ibm.com [9.56.224.217])
	by d01relay04.pok.ibm.com (8.13.8/8.13.8/NCO v8.6) with ESMTP id lAKFZOij122854
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 10:35:24 -0500
Received: from d01av03.pok.ibm.com (loopback [127.0.0.1])
	by d01av03.pok.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id lAKFZO5h016491
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 10:35:24 -0500
Received: from d01ml605.pok.ibm.com (d01ml605.pok.ibm.com [9.56.227.91])
	by d01av03.pok.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id lAKFZOdJ016488
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 10:35:24 -0500
To: java-user@lucene.apache.org
MIME-Version: 1.0
Subject: MoreLikeThis and setBoost
X-Mailer: Lotus Notes Release 7.0 HF277 June 21, 2006
From: Donna L Gresh <gresh@us.ibm.com>
Message-ID: <OF04A64932.BEBB0482-ON85257399.0054D4B4-85257399.00559A7F@us.ibm.com>
Date: Tue, 20 Nov 2007 10:35:23 -0500
X-MIMETrack: Serialize by Router on D01ML605/01/M/IBM(Release 8.0|August 02, 2007) at 11/20/2007
 10:35:23,
	Serialize complete at 11/20/2007 10:35:23
Content-Type: multipart/alternative; boundary="=_alternative 005599AF85257399_="
X-Virus-Checked: Checked by ClamAV on apache.org

--=_alternative 005599AF85257399_=
Content-Type: text/plain; charset="US-ASCII"

I've been stepping through the contrib MoreLikeThis class and was 
wondering if people can give opinions on why you would or would not use 
setBoost(true) for the MoreLikeThis object. It seems a bit odd (at least 
to me) to boost the "good" terms in the query (based on the term's score), 
since won't the final score (once you use the query) in some sense 
"reflect" the effect of good terms already through the tf-idf? Is using 
boost in some way trying to "make up" for the fact that the returned query 
for the MLT object "loses" the term frequency of the terms in the 
reference document (that is, no matter how many times a term is in the 
reference document, the query remains the same, assuming that the term 
makes it into the query via the MLT heuristics).

Thanks for any words of wisdom--
Donna
--=_alternative 005599AF85257399_=--

From java-user-return-31124-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 15:57:10 2007
Return-Path: <java-user-return-31124-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34511 invoked from network); 20 Nov 2007 15:57:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 15:57:10 -0000
Received: (qmail 86321 invoked by uid 500); 20 Nov 2007 15:56:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86297 invoked by uid 500); 20 Nov 2007 15:56:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86286 invoked by uid 99); 20 Nov 2007 15:56:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 07:56:50 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of erickerickson@gmail.com designates 64.233.182.187 as permitted sender)
Received: from [64.233.182.187] (HELO nf-out-0910.google.com) (64.233.182.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 15:56:50 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1619139nfc
        for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 07:56:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=NMQkk+hccxYOZOPniTrPzkib9ielHIjr1gRF9TYUZMc=;
        b=i351jd/bnhfa5WUdxdu37M2owXtD/cFvt+8mmSZLhEauebsFqBFZ/Dk+gqaUgvsnBj2iDSt4verxrNFeMjSHhXsuZcV/UTKpmj7xj9e1P5CXmS0/Yor1Lm8Cb5SaIYs8wHmIC2+uhBUQCENJUdpJy2Vu0DR+vQFCDacw9S5kVw8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=k+2SivYePsUc1cw6OfXFKc6YOhkJft4aLc07MdpaOL4CKf/rTfv/rQdwx440LChiarr/418U6OreGAKrMkV9k5ed8STb7xNljkBtxrBneisjW8K5V7Il9Jt7LtQ9kFVZaPXH93NoWXoSA3dETtMZtC/5M3mDKzAnc5mLEPsrBCY=
Received: by 10.82.183.19 with SMTP id g19mr17587613buf.1195574188843;
        Tue, 20 Nov 2007 07:56:28 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Tue, 20 Nov 2007 07:56:28 -0800 (PST)
Message-ID: <359a92830711200756t7005280bx4d2888f886a30c1e@mail.gmail.com>
Date: Tue, 20 Nov 2007 10:56:28 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Is storing 20 fields in a lucene document desirable?
In-Reply-To: <C8DCFA59-9540-4DE1-8677-62FE41CD7192@apache.org>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_18886_23706984.1195574188804"
References: <13855272.post@talk.nabble.com>
	 <C8DCFA59-9540-4DE1-8677-62FE41CD7192@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_18886_23706984.1195574188804
Content-Type: text/plain; charset=WINDOWS-1252
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

How are you doing your search? When you say "lucene is the
bottleneck", that encompasses a lot. You really need to pinpoint things
a bit more....

1> are you iterating over the hits object for many docs? This is bad.

2> are you using a HitCollector and reading the doc each time you get
to the collect method? This is bad.

3> Is it the *search* or the fetch that's eating the time? Time *just* the
search call (making sure it doesn't go through a HitCollector) to answer
this.

4> How many documents are you returning? 5? 5,000? the answer may
tell us a lot.

5> are you opening a new reader each time you search? this is bad.

6> Have you looked over
http://wiki.apache.org/lucene-java/ImproveSearchingSpeed?

Before you try and implement an solution, you *must* figure out what
operation is
actually taking the time. an 8G index isn't that big, so I suspect that
there's
something else going on. What kind of throughput are you seeing? What
do you need? Can you post some sample timings? Can you post some sample
search code?

I can't tell you how many times I've been *sure* I knew what the problem
was, but
in the process of analyzing the problem discovered that my real issue was
something totally different.....

Best
Erick

On Nov 20, 2007 7:21 AM, Grant Ingersoll <gsingers@apache.org> wrote:

>
> On Nov 20, 2007, at 6:29 AM, kumarlimbu wrote:
>
> >
> > Our document contains a total of 23 fields in one document and we
> > STORE all
> > of them in lucene index.
> >
> > We have recently had some performance issues and our analysis has
> > shown the
> > bottleneck to be lucene search and retrieval.
>
> Perhaps you can share your information on java-dev along with any
> detailed tests, etc. so that we can see if there is anything we can
> improve.
>
> >
> >
> > We have been thinking about reducing the number of fields per
> > document by
> > removing unnecessary fields and by merging fields with similar
> > weightings.
> > Will reducing the number of fields help to optimize performance?
>
> Yes
>
> >
> >
> > Another issue is we are currently retrieving around 9 fields after
> > we do a
> > search. Some are long text of up to 1000 words. Is it a large
> > overhead to
> > retrieve long fields?
>
> Yes.  Are you using FieldSelector?  Also, I would only STORE those
> fields that you actually need to display, not all 23.  Do you display
> all 9 fields right away or are some only when you choose a document?
> If so, try the Lazy Loading piece of FieldSelector.
>
> >
> >
> > We are considering the option of separating the search and retrieve
> > parts so
> > that Lucene performs the search, MYSQL stores the data. We just
> > store the
> > INDEXED field and primary key in the lucene index. After searching
> > we only
> > return 1 field (primary key) instead of 9 fields. This field will be
> > used
> > for retrieving the actual information from the MySQL database. Will
> > reducing
> > the number of fields retrieved from lucene reduce the response time
> > or will
> > using MySQL database make it worse?
>
> Hard to say, you will likely have to try it out.
>
> >
> >
> > So our main concern is to find if retrieving fields usually takes
> > longer
> > than searching or not? What does lucene spend most time doing =96
> > search or
> > retrieval? We are also concerned that using MySQL will have
> > performance
> > issues because we will be doing I/O for MySQL as well as Lucene. We
> > also add
> > around 100k documents each day and remove around the same number of
> > documents. Will this frequent read and write have impact on
> > performance?
> >
>
> What version of Lucene are you using?  Naturally, if you are updating
> things that will have an effect, but that may not be a factor.  I
> would check out http://wiki.apache.org/lucene-java/BasicsOfPerformance
>
> Also, you may want to try out (not in production) the trunk version of
> Lucene.
>
> Last, but not least, do you have some sort of cache for your
> Documents?  Obviously, you need to have appropriate semantics for when
> the underlying docs change, but using a cache makes sense, too.
>
> -Grant
>
>
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
>
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_18886_23706984.1195574188804--

From java-user-return-31125-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 17:34:05 2007
Return-Path: <java-user-return-31125-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80355 invoked from network); 20 Nov 2007 17:34:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 17:34:05 -0000
Received: (qmail 62708 invoked by uid 500); 20 Nov 2007 17:33:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62465 invoked by uid 500); 20 Nov 2007 17:33:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62454 invoked by uid 99); 20 Nov 2007 17:33:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 09:33:45 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 17:33:48 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id DD5EE71C1AA; Tue, 20 Nov 2007 09:33:26 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id D3DA771C0B5
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 09:33:26 -0800 (PST)
Date: Tue, 20 Nov 2007 09:33:26 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Scoring for all the documents in the index relative to a query
In-Reply-To: <200711200009.02857.paul.elschot@xs4all.nl>
Message-ID: <Pine.LNX.4.62.0711200928170.2328@radix.cryptio.net>
References: <604180.39834.qm@web60417.mail.yahoo.com>
 <Pine.LNX.4.62.0711191350350.16033@radix.cryptio.net>
 <c68e39170711191435h722c2599yc424908a680b315f@mail.gmail.com>
 <200711200009.02857.paul.elschot@xs4all.nl>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Well, the javadocs as patched at LUCENE-584 try to change all
: the cases of zero scoring to 'non matching'.

I'm very out of the loop on LUCENE-584, but i think supporting scores <= 0 
is an important use case that shouldn't go away ... it makes 
CustomScoringQueries a lot morepowerful, and easier to understand.

if nothing else, we want to ensure that 
if...
  search("+foo^0 bar baz yak") => returns X results
then...
  search("foo^0") => returns the same X results even if all scores are 0




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31126-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 18:22:59 2007
Return-Path: <java-user-return-31126-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 1446 invoked from network); 20 Nov 2007 18:22:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 18:22:59 -0000
Received: (qmail 47617 invoked by uid 500); 20 Nov 2007 18:22:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47576 invoked by uid 500); 20 Nov 2007 18:22:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47535 invoked by uid 99); 20 Nov 2007 18:22:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 10:22:38 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 18:11:29 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id F108B71C0C5; Tue, 20 Nov 2007 10:11:07 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id ED86571C046
	for <java-user@lucene.apache.org>; Tue, 20 Nov 2007 10:11:07 -0800 (PST)
Date: Tue, 20 Nov 2007 10:11:07 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: indexing excel file
In-Reply-To: <13852774.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.62.0711201003500.2328@radix.cryptio.net>
References: <13852774.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


There is absolutely no reason to send seperate, identical, emails to 
solr-user, nutch-user, and java-user ... particularly when it's clear from 
past emails you knew your question was specific to nutch since you'd 
already asked it on nutch-user 4 days earlier...

http://www.nabble.com/indexing-word-file-tf4819567.html#a13829977


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31127-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 18:39:26 2007
Return-Path: <java-user-return-31127-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 8855 invoked from network); 20 Nov 2007 18:39:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 18:39:25 -0000
Received: (qmail 84884 invoked by uid 500); 20 Nov 2007 18:39:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84810 invoked by uid 500); 20 Nov 2007 18:39:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84791 invoked by uid 99); 20 Nov 2007 18:39:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 10:39:02 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 18:38:52 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 31DCB71C0DA; Tue, 20 Nov 2007 10:38:46 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 2D0B371C046;
	Tue, 20 Nov 2007 10:38:46 -0800 (PST)
Date: Tue, 20 Nov 2007 10:38:46 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: Lucene Users <java-user@lucene.apache.org>
cc: solr-user@lucene.apache.org
Subject: Re: Payloads, Tokenizers, and Filters.  Oh My!
In-Reply-To: <4740B862.5020007@uwaterloo.ca>
Message-ID: <Pine.LNX.4.62.0711201020130.10642@radix.cryptio.net>
References: <473E61EB.8030502@uwaterloo.ca> <4740B862.5020007@uwaterloo.ca>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: I apologize for cross-posting but  I believe both Solr and Lucene users and
: developers should be concerned with this.  I am not aware of a better way to
: reach both communities.

some of these questions strike me as being largely unrelated.  if 
anyone wishes to followup on them further, let's do it in (new) seperate 
threads for each topic, on the specific list appropriate to the topic...

:    * Do TokenFilters belong in the Solr code base at all?

Yes, in so much as any java code belongs in the Solr code base (or the 
nutch code base for that matter).  They are seperate projects with 
seperate communities and seperate needs -- that doesn't mean that there 
isn't code in Solr which could be useful to the broader community of 
lucene-java; in that case the appropriate course of action is to open a 
LUCENE issue to "promote" the code up into lucene-java, and a dependent 
issue in SOLR to deprecate the current code and use the newer code 
instead.

as some people may be aware, there was a discussion aboutthis sort of 
thing at ApacheCon during the Lucene BOF -- some reasons this doesn't 
happen as often as it seems like it should are:
  * the code may have subtle dependency tendrals that make it hard to 
    refactor from one code base to the other.
  * the tests are frequently harder to "promote" then the code (in the 
    case of most Solr tests that use the TestHarness, it's probably easier 
    to write new tests from scratch)
  * when promoting the code, it's the best time to consider wether the 
    existing API is really the "best" API before a lot of new people start 
    using it (compare Solr's FunctionQuery and Lucenes CustomScoreQuery 
    for example)
  * someone needs to care enough to follow through on the promotion.

...further discussion is best suited for java-dev since the topic is not 
Solr specific (there's a lot of Nutch code out there that people have sked 
about promoting as well)

:    * How to deal with TokenFilters that add new Tokens to the stream?

This is specificly regarding Payloads yes?  also a pretty clear cut 
java-dev discussion (and one possibly already being discussed in the 
monolithic Payload API thread i haven't started reading yet).  
lucene-java sets the API and the semantics ... Solr code will follow them.

:    * How to patch TokenFilters and Tokenizers using the model of
:      LUCENE-969 in the Solr code base and in Lucene contrib?

open SOLR issues containing a patchs for any Solr code that needs 
changed, and LUCENE issues containing patches for contrib code that needs 
changed.

: I thought it might be useful to figure out which existing TokenFilters need to
: know about Payloads.  To this end I have taken an inventory of the
: TokenFilters out there.  I think it is fair to categorize them by Add (A),
: Delete (D), Modify (M), Observe (O):

again: this is a straight forward luence-java question ... once the 
semantics have been worked out, then there can be a Solr specific 
discussion about following them.

(which is not to say that the Solr classes/use-cases shouldn't be 
considered in the discussion, just that java-dev is the right place to 
have the conversation)




-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31128-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 20 23:10:09 2007
Return-Path: <java-user-return-31128-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22611 invoked from network); 20 Nov 2007 23:10:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 20 Nov 2007 23:10:09 -0000
Received: (qmail 13442 invoked by uid 500); 20 Nov 2007 23:09:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13406 invoked by uid 500); 20 Nov 2007 23:09:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13395 invoked by uid 99); 20 Nov 2007 23:09:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 15:09:49 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.37] (HELO smtp-vbr17.xs4all.nl) (194.109.24.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Nov 2007 23:09:52 +0000
Received: from k8u.lan (porta.xs4all.nl [80.127.24.69])
	by smtp-vbr17.xs4all.nl (8.13.8/8.13.8) with ESMTP id lAKN9VM0099666
	for <java-user@lucene.apache.org>; Wed, 21 Nov 2007 00:09:32 +0100 (CET)
	(envelope-from paul.elschot@xs4all.nl)
From: Paul Elschot <paul.elschot@xs4all.nl>
To: java-user@lucene.apache.org
Subject: Re: Scoring for all the documents in the index relative to a query
Date: Wed, 21 Nov 2007 00:09:31 +0100
User-Agent: KMail/1.9.6 (enterprise 0.20070907.709405)
References: <604180.39834.qm@web60417.mail.yahoo.com> <200711200009.02857.paul.elschot@xs4all.nl> <Pine.LNX.4.62.0711200928170.2328@radix.cryptio.net>
In-Reply-To: <Pine.LNX.4.62.0711200928170.2328@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711210009.31726.paul.elschot@xs4all.nl>
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

On Tuesday 20 November 2007 18:33:26 Chris Hostetter wrote:
> : Well, the javadocs as patched at LUCENE-584 try to change all
> : the cases of zero scoring to 'non matching'.
>
> I'm very out of the loop on LUCENE-584, but i think supporting scores <= 0
> is an important use case that shouldn't go away ... it makes
> CustomScoringQueries a lot morepowerful, and easier to understand.
>
> if nothing else, we want to ensure that
> if...
>   search("+foo^0 bar baz yak") => returns X results
> then...
>   search("foo^0") => returns the same X results even if all scores are 0

In the patch, Matcher is a superclass of Scorer and it does not have the 
score() method, so 'matching' is independent of the any score value.
The matching docs are determined by the next(), skipTo() and doc() methods 
only.


Regards,
Paul Elschot

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31129-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 21 19:10:20 2007
Return-Path: <java-user-return-31129-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 11054 invoked from network); 21 Nov 2007 19:10:20 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 Nov 2007 19:10:20 -0000
Received: (qmail 15688 invoked by uid 500); 21 Nov 2007 19:10:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15663 invoked by uid 500); 21 Nov 2007 19:10:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15652 invoked by uid 99); 21 Nov 2007 19:10:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Nov 2007 11:10:00 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [213.239.241.56] (HELO server01.i-net-space.de) (213.239.241.56)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Nov 2007 19:09:46 +0000
Received: from localhost (localhost.localdomain [127.0.0.1])
	by server01.i-net-space.de (Postfix) with ESMTP id 94A0C1C8E65
	for <java-user@lucene.apache.org>; Wed, 21 Nov 2007 20:09:38 +0100 (CET)
Received: from [192.168.178.22] (p5B13AD68.dip0.t-ipconnect.de [91.19.173.104])
	by server01.i-net-space.de (Postfix) with ESMTP id 678F91C8E64
	for <java-user@lucene.apache.org>; Wed, 21 Nov 2007 20:09:38 +0100 (CET)
Mime-Version: 1.0 (Apple Message framework v752.3)
Content-Transfer-Encoding: 7bit
Message-Id: <3BBF4DA1-7C24-46E3-84B2-28401009DA9F@hasabajan.de>
Content-Type: text/plain; charset=US-ASCII; delsp=yes; format=flowed
To: java-user@lucene.apache.org
From: Jonas Koenemann <its-me@hasabajan.de>
Subject: lucene in action
Date: Wed, 21 Nov 2007 20:09:30 +0100
X-Mailer: Apple Mail (2.752.3)
X-Virus-Scanned: by amavisd-new at server01.i-net-space.de
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

can anyone send me the Source Code File LuceneInAction.zip of the  
book to its-me@hasabajan.de ?
The link on the website http://www.manning.com/hatcher2/ is broken.

thanks
Jonas

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31130-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 21 19:16:50 2007
Return-Path: <java-user-return-31130-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12820 invoked from network); 21 Nov 2007 19:16:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 21 Nov 2007 19:16:50 -0000
Received: (qmail 26941 invoked by uid 500); 21 Nov 2007 19:16:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26909 invoked by uid 500); 21 Nov 2007 19:16:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26890 invoked by uid 99); 21 Nov 2007 19:16:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Nov 2007 11:16:31 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lybecker@gmail.com designates 64.233.162.226 as permitted sender)
Received: from [64.233.162.226] (HELO nz-out-0506.google.com) (64.233.162.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Nov 2007 19:16:21 +0000
Received: by nz-out-0506.google.com with SMTP id i28so1979792nzi
        for <java-user@lucene.apache.org>; Wed, 21 Nov 2007 11:16:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:sender:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition:x-google-sender-auth;
        bh=nAnWbC3lXASuEkHMzS3++UEMPqGNJ2hWM13e5PFGEUA=;
        b=ZTBWQMO8KtXodHwdyjbKn0XeRLUiAB9qgRKs6I7Jvn1eP8IAv+JgRLY9bPM+Gz0YMWWnFuS550VeQPQXg/xME5MpILuzVptZnKnyf70sJm0VVV4azQbnu3+/N4VrnisRQ95OhG/lGcti9S7VJWpRr8VSMX6D+0RGN6EPWnibR/U=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:sender:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition:x-google-sender-auth;
        b=VH2Z2fBaD7RDYu7VQufOpOjC5/j45JkFg+3P62B9JDr8Sjn8Bn43r3WwCnMuzIZm7hm+yFuNBiqS6GHcwYZ3FDOIC0tveCHS0QlqwA9cBcPQ//h85GwkPjPsupFIMuLuZVBECElzHGPTAQYSjbr/C4heg7zY087BxN3+2zKyHvw=
Received: by 10.142.76.4 with SMTP id y4mr2208799wfa.1195672574657;
        Wed, 21 Nov 2007 11:16:14 -0800 (PST)
Received: by 10.142.199.19 with HTTP; Wed, 21 Nov 2007 11:16:14 -0800 (PST)
Message-ID: <f4ea65560711211116y35dc176bk35940e304bec95b0@mail.gmail.com>
Date: Wed, 21 Nov 2007 20:16:14 +0100
From: "Anders Lybecker" <aly@miracleas.dk>
Sender: lybecker@gmail.com
To: java-user@lucene.apache.org
Subject: Force MultiFieldQueryParser always to use PrefixQuery
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Google-Sender-Auth: 0d34b5365426b78b
X-Virus-Checked: Checked by ClamAV on apache.org

How do I force the MultiFieldQueryParser to interpret a string like
"dock boat" as "dock* boat*" and therefore use PrefixQuery instead of
TemQuery?

The customer wants always to search with <word>* as default when entering <word>

:-)
Anders Lybecker

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31131-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 09:19:42 2007
Return-Path: <java-user-return-31131-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71600 invoked from network); 22 Nov 2007 09:19:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 09:19:42 -0000
Received: (qmail 88039 invoked by uid 500); 22 Nov 2007 09:19:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88000 invoked by uid 500); 22 Nov 2007 09:19:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87989 invoked by uid 99); 22 Nov 2007 09:19:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 01:19:22 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.24] (HELO smtp-vbr4.xs4all.nl) (194.109.24.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 09:19:09 +0000
Received: from [192.168.89.206] (impressie.xs4all.nl [82.93.53.149])
	by smtp-vbr4.xs4all.nl (8.13.8/8.13.8) with ESMTP id lAM9J1ah081247
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 10:19:01 +0100 (CET)
	(envelope-from matthijs@impressie.nl)
Message-ID: <4745498B.3060801@impressie.nl>
Date: Thu, 22 Nov 2007 10:19:07 +0100
From: Matthijs Bierman <matthijs@impressie.nl>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Custom query parser
References: <200711201355.28973.nicolas.lalevee@anyware-tech.com>
In-Reply-To: <200711201355.28973.nicolas.lalevee@anyware-tech.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 8bit
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Nicolas,

Why can't you extend the QueryParser and override the methods you want 
to modify?

Cheers,
Matthijs

Nicolas Laleve wrote:
> Hi,
>
> I am willing to have a query parser which is fault tolerant. I have search 
> over the archive, and I have found this :
> http://www.nabble.com/Error-tolerant-query-parsing-tf108987.html#a300382
>
> I also want my parser to have very simple feature : phrase search and field 
> search. So I need to develop a simple query parser myself : not that hard, a 
> simple state machine will be the trick.
>
> But here I loose an important feature of the Lucene query parser : creating 
> queries regarding an analyzer. In fact I loose that very usefull function :
> http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/queryParser/QueryParser.html#getFieldQuery(java.lang.String,
> %20java.lang.String)
>
> So is there any proper way to create a custom query parser without duplicating 
> the code ?
>
> cheers,
> Nicolas
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31132-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 11:07:54 2007
Return-Path: <java-user-return-31132-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26906 invoked from network); 22 Nov 2007 11:07:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 11:07:54 -0000
Received: (qmail 19181 invoked by uid 500); 22 Nov 2007 11:07:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19156 invoked by uid 500); 22 Nov 2007 11:07:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19145 invoked by uid 99); 22 Nov 2007 11:07:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 03:07:34 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 11:07:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Iv9ts-0001uQ-5J
	for java-user@lucene.apache.org; Thu, 22 Nov 2007 03:07:16 -0800
Message-ID: <13894829.post@talk.nabble.com>
Date: Thu, 22 Nov 2007 03:07:16 -0800 (PST)
From: Rapthor <rapthor@lycos.de>
To: java-user@lucene.apache.org
Subject: AND query in SHOULD
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: rapthor@lycos.de
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

I want to realize a search that finds the exact phrase I provide. If the
word I am searching for is "green tree", I do NOT want to get results for
"green" or "tree", but only results for "green tree" within the given field.

This doesn't work so far for me. When providing a word that contains white
spaces, Lucene does not give any results at all even though there are
documents with the terms within the word in that order. This is what my
source looks:

BooleanQuery bq = new BooleanQuery();
for (String word : words) {
	for (String field : fields) {
		bq.add(new TermQuery(new Term(field, word)), Occur.SHOULD);
	}
}
Hits hits = indexSearcher.search(bq);

What's wrong? How to achieve the functionality?

Thanks in advance.
-- 
View this message in context: http://www.nabble.com/AND-query-in-SHOULD-tf4855719.html#a13894829
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31133-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 11:54:29 2007
Return-Path: <java-user-return-31133-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55071 invoked from network); 22 Nov 2007 11:54:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 11:54:29 -0000
Received: (qmail 83909 invoked by uid 500); 22 Nov 2007 11:54:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82937 invoked by uid 500); 22 Nov 2007 11:54:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82924 invoked by uid 99); 22 Nov 2007 11:54:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 03:54:10 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.15 as permitted sender)
Received: from [80.67.18.15] (HELO smtprelay03.ispgateway.de) (80.67.18.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 11:53:57 +0000
Received: (qmail 21463 invoked from network); 22 Nov 2007 11:53:48 -0000
Received: from unknown (HELO p54bff943.dip.t-dialin.net) (695637@[84.191.249.67])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay03.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 22 Nov 2007 11:53:48 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: AND query in SHOULD
Date: Thu, 22 Nov 2007 12:54:03 +0100
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <13894829.post@talk.nabble.com>
In-Reply-To: <13894829.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711221254.03998@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Donnerstag, 22. November 2007, Rapthor wrote:

> I want to realize a search that finds the exact phrase I provide.

You simply need to create a PhraseQuery.

See 
http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/org/apache/lucene/search/PhraseQuery.html

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31134-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 12:18:27 2007
Return-Path: <java-user-return-31134-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65914 invoked from network); 22 Nov 2007 12:18:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 12:18:27 -0000
Received: (qmail 13294 invoked by uid 500); 22 Nov 2007 12:18:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13265 invoked by uid 500); 22 Nov 2007 12:18:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13254 invoked by uid 99); 22 Nov 2007 12:18:08 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 04:18:08 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 12:18:11 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IvB0A-0003tQ-8O
	for java-user@lucene.apache.org; Thu, 22 Nov 2007 04:17:50 -0800
Message-ID: <13895700.post@talk.nabble.com>
Date: Thu, 22 Nov 2007 04:17:50 -0800 (PST)
From: Rapthor <rapthor@lycos.de>
To: java-user@lucene.apache.org
Subject: Re: AND query in SHOULD
In-Reply-To: <13894829.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: rapthor@lycos.de
References: <13894829.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org


There is no option to provide an Occur.SHOULD to the PhraseQuery. So where
does it go? I changed the source to look like this:

PhraseQuery pq = new PhraseQuery();
for (String word : words) {
	for (String field : fields) {
		pq.add(new Term(field, word));
	}
}
Hits hits = indexSearcher.search(pq);

However, I get an exception:
java.lang.IllegalArgumentException: All phrase terms must be in the same
field: description:green tree

I don't understand how to a) search for combinations of words like "green
tree", b) search in multiple fields (description, text, ...) and c) search
by a SHOULD restriction.
-- 
View this message in context: http://www.nabble.com/AND-query-in-SHOULD-tf4855719.html#a13895700
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31135-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 13:27:07 2007
Return-Path: <java-user-return-31135-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92106 invoked from network); 22 Nov 2007 13:27:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 13:27:07 -0000
Received: (qmail 77735 invoked by uid 500); 22 Nov 2007 13:26:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77706 invoked by uid 500); 22 Nov 2007 13:26:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77695 invoked by uid 99); 22 Nov 2007 13:26:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 05:26:48 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 64.233.182.190 as permitted sender)
Received: from [64.233.182.190] (HELO nf-out-0910.google.com) (64.233.182.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 13:26:37 +0000
Received: by nf-out-0910.google.com with SMTP id d3so2212585nfc
        for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 05:26:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=QFFIj7cN3T4RI92AhSt1jqrcs8IfgnQh8vdXaoxbDC8=;
        b=PVTojOgwLsaHGGgeDacptrV0YAycuEXmK8aFNhh/iCC6FKcUwa83YieIZRLQ0Y/LAHul0U1r0UeecatMPcE8vFdfpLMyPDwHBaJfcbiXS5H/SAu3BLne1KWPuIjEnmfLL6RoZkABw5Uig5EmZZRjBMJzIyOzVe4iqaTcTLdDq+E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=e0D+pk416Vz644MZxMAYDhKXUmvSpOt4Xfw5F44lSKR3p9+5D56oKKAEDHeZS94NPP+x3tQb7hvqYUFs04O+DWyw4kLhBYhiK+b0tLTswL7ljfrtSuuveSg3xUsc7Cu9pJICQPmpIbvMXGpy1B6kuNgMW7WO0RgY2DAKECoVWJw=
Received: by 10.82.173.19 with SMTP id v19mr1658515bue.1195737987902;
        Thu, 22 Nov 2007 05:26:27 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Thu, 22 Nov 2007 05:26:27 -0800 (PST)
Message-ID: <359a92830711220526u4bd0491cra131da13d3eb31e4@mail.gmail.com>
Date: Thu, 22 Nov 2007 08:26:27 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: AND query in SHOULD
In-Reply-To: <13895700.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_26267_9439521.1195737987896"
References: <13894829.post@talk.nabble.com> <13895700.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_26267_9439521.1195737987896
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

The semantics of the phrase query you're constructing probably aren't
what you think. As best I can infer, you are trying to do something
like

"green tree" in field1
or
"green tree" in field 2

but that's not even close to what you're constructing.

It would help a show what the query you want is in some form
like that above before trying to code it, because the actual
query you're making is something like asking for the phrase
"word1 in field1 word1 in field2 word2 in field1 word2 in field2"

Actually, I can't render the semantics of what you're doing int English.
And Lucene can't parse it either.

I suspect you want something like
PhraseQuery pq1
PhraseQuery pq2
for (String word : words) {
   pq1.add(...);
   pq2.add(...)
}
BooleanQuery bq().
bq.add(p1, ....  SHOULD);
bq.add(p2, ... SHOULD);

Index.search(bq);

Best
Erick

On Nov 22, 2007 7:17 AM, Rapthor <rapthor@lycos.de> wrote:

>
> There is no option to provide an Occur.SHOULD to the PhraseQuery. So where
> does it go? I changed the source to look like this:
>
> PhraseQuery pq = new PhraseQuery();
> for (String word : words) {
>        for (String field : fields) {
>                pq.add(new Term(field, word));
>        }
> }
> Hits hits = indexSearcher.search(pq);
>
> However, I get an exception:
> java.lang.IllegalArgumentException: All phrase terms must be in the same
> field: description:green tree
>
> I don't understand how to a) search for combinations of words like "green
> tree", b) search in multiple fields (description, text, ...) and c) search
> by a SHOULD restriction.
> --
> View this message in context:
> http://www.nabble.com/AND-query-in-SHOULD-tf4855719.html#a13895700
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_26267_9439521.1195737987896--

From java-user-return-31136-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 13:36:33 2007
Return-Path: <java-user-return-31136-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94555 invoked from network); 22 Nov 2007 13:36:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 13:36:33 -0000
Received: (qmail 89000 invoked by uid 500); 22 Nov 2007 13:36:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88966 invoked by uid 500); 22 Nov 2007 13:36:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88955 invoked by uid 99); 22 Nov 2007 13:36:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 05:36:15 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 64.233.182.188 as permitted sender)
Received: from [64.233.182.188] (HELO nf-out-0910.google.com) (64.233.182.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 13:36:05 +0000
Received: by nf-out-0910.google.com with SMTP id d3so2214997nfc
        for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 05:35:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=sXGZxwJ0Q1/ox+HDlMJEzQrdcW3D8DKwtg0E4WPgQ64=;
        b=pDkJ8s8wOUDusaV7ESNtWrCd7Gema7TmWw5shro0z8LSnB0mK4Lsm7HB9g/ljSXLbY2rZir/mwW1XmETddSmxetEO7Lmjf3F9zreUSC4eNwUoHwBYqwTvrhhJc3cwFrZG/1UpfOgwYve+MzNd/nn7hb0vZXJyyFXbQFv0sQLAvI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=OF9bAIWDzL6SkoMdCwtPqCzq9G7lQWX1LQZrBAGa6UO++hOfUKe3X0VsSJQcuJMF3ON5g8//18gAm9We2kMwK5lqBEJpS5LFUzsqnMV+ZNxUa6kliQKSZXm2W+8e0O3Y3PUgWSU2wTyLdpWHhYlmO2JqqSYFWQWfTTuoz9RtIvc=
Received: by 10.82.149.8 with SMTP id w8mr1429197bud.1195738557760;
        Thu, 22 Nov 2007 05:35:57 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Thu, 22 Nov 2007 05:35:57 -0800 (PST)
Message-ID: <359a92830711220535g205e54fctbc9ae836610ad096@mail.gmail.com>
Date: Thu, 22 Nov 2007 08:35:57 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Force MultiFieldQueryParser always to use PrefixQuery
In-Reply-To: <f4ea65560711211116y35dc176bk35940e304bec95b0@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_26278_17337850.1195738557755"
References: <f4ea65560711211116y35dc176bk35940e304bec95b0@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_26278_17337850.1195738557755
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

The simplest way would be to pre-process the query. That
is, just split on words and add the '*' as appropriate.

Erick

On Nov 21, 2007 2:16 PM, Anders Lybecker <aly@miracleas.dk> wrote:

> How do I force the MultiFieldQueryParser to interpret a string like
> "dock boat" as "dock* boat*" and therefore use PrefixQuery instead of
> TemQuery?
>
> The customer wants always to search with <word>* as default when entering
> <word>
>
> :-)
> Anders Lybecker
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_26278_17337850.1195738557755--

From java-user-return-31137-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 14:27:42 2007
Return-Path: <java-user-return-31137-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10603 invoked from network); 22 Nov 2007 14:27:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 14:27:42 -0000
Received: (qmail 50267 invoked by uid 500); 22 Nov 2007 14:27:24 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50227 invoked by uid 500); 22 Nov 2007 14:27:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50198 invoked by uid 99); 22 Nov 2007 14:27:24 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 06:27:24 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 64.233.166.181 as permitted sender)
Received: from [64.233.166.181] (HELO py-out-1112.google.com) (64.233.166.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 14:27:11 +0000
Received: by py-out-1112.google.com with SMTP id d32so14627273pye
        for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 06:27:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=JD9xjjBqaA3kRgRwmxKRNqL03UrhC0h22ucT/11GdA8=;
        b=M1Zv3BGfxUi740oyTOaeLJRcx6zqNMth7JGReY59vfTqk7oL8huNNKqCag4nD1ZHUfaXLayEe+qFq1SDeiXjeJSPIrSbz/4s5rSTta2GJx9QL4nJDGXe0IQyLfjjxgsu0OF3XtZfSeNEV5aOReosuhbbRDq6WhDmkf7IRIuLjIk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=Mwbu6Rm4DUVdeD2GQU5xryVuuCm2RqMjGZBh3KSeCTtNeuwvzFXOQVSMJM3Fo761B+ga+aRSozBfJqeQioJ2SI9QCiGQQn0dgM5K2vCLcR+mfpGWomMQW6y3zmZE8cAImD+1fHGjQoykQdPGnCihquykfbW6b3+Kpz4XwS+zGsc=
Received: by 10.65.244.15 with SMTP id w15mr19704321qbr.1195741624044;
        Thu, 22 Nov 2007 06:27:04 -0800 (PST)
Received: by 10.64.181.13 with HTTP; Thu, 22 Nov 2007 06:27:03 -0800 (PST)
Message-ID: <786fde50711220627qe6765afj961bfda5d2368b@mail.gmail.com>
Date: Thu, 22 Nov 2007 16:27:03 +0200
From: "Shai Erera" <serera@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: AND query in SHOULD
In-Reply-To: <359a92830711220526u4bd0491cra131da13d3eb31e4@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_23760_30250400.1195741624008"
References: <13894829.post@talk.nabble.com> <13895700.post@talk.nabble.com>
	 <359a92830711220526u4bd0491cra131da13d3eb31e4@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_23760_30250400.1195741624008
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

How about using MultiFieldQueryParser. Here is a short main I wrote:

        Directory dir = new RAMDirectory();
        Analyzer analyzer = new StandardAnalyzer();
        IndexWriter writer = new IndexWriter(dir, analyzer);
        Document doc = new Document();
        doc.add(new Field("field1", "green tree", Store.NO, Index.TOKENIZED
));
        writer.addDocument(doc);
        doc = new Document();
        doc.add(new Field("field2", "green tree", Store.NO, Index.TOKENIZED
));
        writer.addDocument(doc);
        writer.close();

        IndexSearcher searcher = new IndexSearcher(dir);
        MultiFieldQueryParser qp = new MultiFieldQueryParser(new String[] {
"field1", "field2" }, analyzer);
        Query q = qp.parse("\"green tree\"");
        if (q instanceof BooleanQuery /* Basically this should almost always
be true */) {
            BooleanClause[] clauses = ((BooleanQuery) q).getClauses();
            for (int i = 0; i < clauses.length; i++) {
                clauses[i].setOccur(Occur.SHOULD); /* This is their setting
by default though */
            }
        }
        Hits hits = searcher.search(q);
        System.out.println(hits.length()); /* Should print 2. */
        searcher.close();


On Nov 22, 2007 3:26 PM, Erick Erickson <erickerickson@gmail.com> wrote:

> The semantics of the phrase query you're constructing probably aren't
> what you think. As best I can infer, you are trying to do something
> like
>
> "green tree" in field1
> or
> "green tree" in field 2
>
> but that's not even close to what you're constructing.
>
> It would help a show what the query you want is in some form
> like that above before trying to code it, because the actual
> query you're making is something like asking for the phrase
> "word1 in field1 word1 in field2 word2 in field1 word2 in field2"
>
> Actually, I can't render the semantics of what you're doing int English.
> And Lucene can't parse it either.
>
> I suspect you want something like
> PhraseQuery pq1
> PhraseQuery pq2
> for (String word : words) {
>   pq1.add(...);
>   pq2.add(...)
> }
> BooleanQuery bq().
> bq.add(p1, ....  SHOULD);
> bq.add(p2, ... SHOULD);
>
> Index.search(bq);
>
> Best
> Erick
>
> On Nov 22, 2007 7:17 AM, Rapthor <rapthor@lycos.de> wrote:
>
> >
> > There is no option to provide an Occur.SHOULD to the PhraseQuery. So
> where
> > does it go? I changed the source to look like this:
> >
> > PhraseQuery pq = new PhraseQuery();
> > for (String word : words) {
> >        for (String field : fields) {
> >                pq.add(new Term(field, word));
> >        }
> > }
> > Hits hits = indexSearcher.search(pq);
> >
> > However, I get an exception:
> > java.lang.IllegalArgumentException: All phrase terms must be in the same
> > field: description:green tree
> >
> > I don't understand how to a) search for combinations of words like
> "green
> > tree", b) search in multiple fields (description, text, ...) and c)
> search
> > by a SHOULD restriction.
> > --
> > View this message in context:
> > http://www.nabble.com/AND-query-in-SHOULD-tf4855719.html#a13895700
> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>



-- 
Regards,

Shai Erera

------=_Part_23760_30250400.1195741624008--

From java-user-return-31138-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 15:47:28 2007
Return-Path: <java-user-return-31138-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39393 invoked from network); 22 Nov 2007 15:47:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 15:47:28 -0000
Received: (qmail 52335 invoked by uid 500); 22 Nov 2007 15:47:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52309 invoked by uid 500); 22 Nov 2007 15:47:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52298 invoked by uid 99); 22 Nov 2007 15:47:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 07:47:09 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [124.30.170.13] (HELO hydmail1.satyam.com) (124.30.170.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 15:47:12 +0000
Received: from hyd.satyam.com (hyd.satyam.com [204.252.161.226])
	by hydmail1.satyam.com (8.13.4/8.13.4) with ESMTP id lAMFQ1ks001701
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 20:56:01 +0530
Received: from Disclaimerhyd.corp.satyam.ad (hhtbh.satyam.com [172.16.186.212])
	by hyd.satyam.com (8.13.1/8.13.1) with ESMTP id lAMFiGmu026195
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 21:14:18 +0530
Received: from hstmsg005.corp.satyam.ad ([172.16.186.216]) by Disclaimerhyd.corp.satyam.ad with Microsoft SMTPSVC(6.0.3790.211); Thu, 22 Nov 2007 21:16:08 +0530
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.607
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Priority: normal
Importance: normal
Content-Transfer-Encoding: quoted-printable
Subject: help required urgent!!!!!!!!!!!
Date: Thu, 22 Nov 2007 21:16:06 +0530
Message-ID: <9312093579B72048B1E5659DC3EC7F39022E9307@hstmsg005.corp.satyam.ad>
In-Reply-To: <C8DCFA59-9540-4DE1-8677-62FE41CD7192@apache.org>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: help required urgent!!!!!!!!!!!
Thread-Index: Acgrb/EJigqR3EMiTXe2hPW+KOcTnABfEPgA
From: "Shakti_Sareen" <Shakti_Sareen@satyam.com>
To: <java-user@lucene.apache.org>
Cc: "MadhusudanRao_N" <MadhusudanRao_N@satyam.com>
X-OriginalArrivalTime: 22 Nov 2007 15:46:08.0162 (UTC) FILETIME=[CC66D820:01C82D1E]
X-Virus-Scanned: ClamAV version 0.88.4, clamav-milter version 0.88.4 on hyd.satyam.com
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

Hi=20
I am using StandardAnalyser() to index the data.
But I want to do a like search on a word containing Hyphen
For example it want to search a word "soft-wa*"

I am getting no hits for that. It is said that if the hyphen is there in
the word, then we should include that word in the double quotes ("). But
enclosing the word in a double quotes (") means the exact word search.

How can I perform the like search on a word containing hyphen???????

Please help.

Regards,
Shakti Sareen





DISCLAIMER:
This email (including any attachments) is intended for the sole use of =
the intended recipient/s and may contain material that is CONFIDENTIAL =
AND PRIVATE COMPANY INFORMATION. Any review or reliance by others or =
copying or distribution or forwarding of any or all of the contents in =
this message is STRICTLY PROHIBITED. If you are not the intended =
recipient, please contact the sender by email and delete all copies; =
your cooperation in this regard is appreciated.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31139-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 15:55:33 2007
Return-Path: <java-user-return-31139-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41357 invoked from network); 22 Nov 2007 15:55:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 15:55:33 -0000
Received: (qmail 72772 invoked by uid 500); 22 Nov 2007 15:55:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 72743 invoked by uid 500); 22 Nov 2007 15:55:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 72732 invoked by uid 99); 22 Nov 2007 15:55:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 07:55:09 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 64.233.166.181 as permitted sender)
Received: from [64.233.166.181] (HELO py-out-1112.google.com) (64.233.166.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 15:54:58 +0000
Received: by py-out-1112.google.com with SMTP id d32so14696142pye
        for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 07:54:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=pAqIxdJh1Znao0BHl+2VQ99bKZ//cZnCYokTZRTSIY4=;
        b=Lvf01+UTVGXNkycAkzSYx2z7l6YLb6CEq5KLRvWack5CR/ECYPAEZ8Bn5xjNyS5K16oeRWNSsAFim2+PNl7RIxCIaC+A74E5mZhDLZgOjOs38g9LgDZOt4ikegzdhf+p+c1aW/J8AP5qG4aItGueL1lPJubzSzAupXDwy3vc6gk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=qLCXS5O+umjRwHkV+4T2pvhDdyACwoL+CdID3fJw735O2Eak0j7yD1Dxs61+O3TNVbo4DASktFE2Q8l6fspYMxx1F1HT8A7fqtUTCLm6kNw/CjUKq0iW9te63qdqeW/SIGPBAZFJT6nDJ0Zw49PzTRuNYq3MxPiH7vnzlwKamnw=
Received: by 10.65.116.10 with SMTP id t10mr19896987qbm.1195746891081;
        Thu, 22 Nov 2007 07:54:51 -0800 (PST)
Received: by 10.64.181.13 with HTTP; Thu, 22 Nov 2007 07:54:51 -0800 (PST)
Message-ID: <786fde50711220754n7d2dd206u61e2b73f641793d@mail.gmail.com>
Date: Thu, 22 Nov 2007 17:54:51 +0200
From: "Shai Erera" <serera@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: help required urgent!!!!!!!!!!!
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E9307@hstmsg005.corp.satyam.ad>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_24056_15911597.1195746891077"
References: <C8DCFA59-9540-4DE1-8677-62FE41CD7192@apache.org>
	 <9312093579B72048B1E5659DC3EC7F39022E9307@hstmsg005.corp.satyam.ad>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_24056_15911597.1195746891077
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi

You can simply create a PrefixQuery. However, if you're using
StandardAnalyzer, and the word is added as Index.TOKENIZED,
sotf-wa<something> will be broken to 'soft' and 'wa<something>'. Therefore
you'll need to add the word as Index.UN_TOKENIZED, or use a different
Analyzer when you index the data (for this field at least).

Here's a sample code:

        // Indexing.
        Document doc = new Document();
        doc.add(new Field("field", "soft-wash", Store.NO, Index.UN_TOKENIZED
));

        // Search
        Query q = new PrefixQuery(new Term("field", "soft-wa"));

Does that help?

On Nov 22, 2007 5:46 PM, Shakti_Sareen <Shakti_Sareen@satyam.com> wrote:

> Hi
> I am using StandardAnalyser() to index the data.
> But I want to do a like search on a word containing Hyphen
> For example it want to search a word "soft-wa*"
>
> I am getting no hits for that. It is said that if the hyphen is there in
> the word, then we should include that word in the double quotes ("). But
> enclosing the word in a double quotes (") means the exact word search.
>
> How can I perform the like search on a word containing hyphen???????
>
> Please help.
>
> Regards,
> Shakti Sareen
>
>
>
>
>
> DISCLAIMER:
> This email (including any attachments) is intended for the sole use of the
> intended recipient/s and may contain material that is CONFIDENTIAL AND
> PRIVATE COMPANY INFORMATION. Any review or reliance by others or copying or
> distribution or forwarding of any or all of the contents in this message is
> STRICTLY PROHIBITED. If you are not the intended recipient, please contact
> the sender by email and delete all copies; your cooperation in this regard
> is appreciated.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Regards,

Shai Erera

------=_Part_24056_15911597.1195746891077--

From java-user-return-31140-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 16:03:42 2007
Return-Path: <java-user-return-31140-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44782 invoked from network); 22 Nov 2007 16:03:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 16:03:42 -0000
Received: (qmail 90428 invoked by uid 500); 22 Nov 2007 16:03:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89439 invoked by uid 500); 22 Nov 2007 16:03:24 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89428 invoked by uid 99); 22 Nov 2007 16:03:24 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 08:03:24 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [124.30.170.13] (HELO hydmail1.satyam.com) (124.30.170.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 16:03:25 +0000
Received: from hyd.satyam.com (hyd.satyam.com [204.252.161.226])
	by hydmail1.satyam.com (8.13.4/8.13.4) with ESMTP id lAMFgFck002600
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 21:12:15 +0530
Received: from Disclaimerhyd.corp.satyam.ad (hhtbh.satyam.com [172.16.186.212])
	by hyd.satyam.com (8.13.1/8.13.1) with ESMTP id lAMG0hjQ003300
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 21:30:45 +0530
Received: from hstmsg005.corp.satyam.ad ([172.16.186.216]) by Disclaimerhyd.corp.satyam.ad with Microsoft SMTPSVC(6.0.3790.211); Thu, 22 Nov 2007 21:32:11 +0530
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.607
Content-Transfer-Encoding: 7bit
Content-class: urn:content-classes:message
MIME-Version: 1.0
Priority: normal
Importance: normal
Content-Type: multipart/mixed;
	boundary="----_=_NextPart_001_01C82D21.0A3526E1"
Subject: RE: help required urgent!!!!!!!!!!!
Date: Thu, 22 Nov 2007 21:32:10 +0530
Message-ID: <9312093579B72048B1E5659DC3EC7F39022E9308@hstmsg005.corp.satyam.ad>
In-Reply-To: <786fde50711220754n7d2dd206u61e2b73f641793d@mail.gmail.com>
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator: 
Thread-Topic: help required urgent!!!!!!!!!!!
Thread-Index: AcgtIDUkTDdqlQVkQEqSH843o/ngAgAAUJCA
From: "Shakti_Sareen" <Shakti_Sareen@satyam.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 22 Nov 2007 16:02:11.0625 (UTC) FILETIME=[0AABA190:01C82D21]
X-Virus-Scanned: ClamAV version 0.88.4, clamav-milter version 0.88.4 on hyd.satyam.com
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C82D21.0A3526E1
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi

But the file I am indexing is very big and I don't know which word will
contain the hyphen. The thing you suggest can be implemented only if
there are some specific words in the file.

Apart from StandardAnalyzer I have got no option.

Thanks a lot for your reply.

Please suggest me how can I go ahead.

=20
SHAKTI SAREEN
GE-GDC
STC HYDERABAD
9948777794

-----Original Message-----
From: Shai Erera [mailto:serera@gmail.com]=20
Sent: Thursday, November 22, 2007 9:25 PM
To: java-user@lucene.apache.org
Subject: Re: help required urgent!!!!!!!!!!!

Hi

You can simply create a PrefixQuery. However, if you're using
StandardAnalyzer, and the word is added as Index.TOKENIZED,
sotf-wa<something> will be broken to 'soft' and 'wa<something>'.
Therefore
you'll need to add the word as Index.UN_TOKENIZED, or use a different
Analyzer when you index the data (for this field at least).

Here's a sample code:

        // Indexing.
        Document doc =3D new Document();
        doc.add(new Field("field", "soft-wash", Store.NO,
Index.UN_TOKENIZED
));

        // Search
        Query q =3D new PrefixQuery(new Term("field", "soft-wa"));

Does that help?

On Nov 22, 2007 5:46 PM, Shakti_Sareen <Shakti_Sareen@satyam.com> wrote:

> Hi
> I am using StandardAnalyser() to index the data.
> But I want to do a like search on a word containing Hyphen
> For example it want to search a word "soft-wa*"
>
> I am getting no hits for that. It is said that if the hyphen is there
in
> the word, then we should include that word in the double quotes (").
But
> enclosing the word in a double quotes (") means the exact word search.
>
> How can I perform the like search on a word containing hyphen???????
>
> Please help.
>
> Regards,
> Shakti Sareen
>
>
>
>
>
> DISCLAIMER:
> This email (including any attachments) is intended for the sole use of
the
> intended recipient/s and may contain material that is CONFIDENTIAL AND
> PRIVATE COMPANY INFORMATION. Any review or reliance by others or
copying or
> distribution or forwarding of any or all of the contents in this
message is
> STRICTLY PROHIBITED. If you are not the intended recipient, please
contact
> the sender by email and delete all copies; your cooperation in this
regard
> is appreciated.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


--=20
Regards,

Shai Erera


DISCLAIMER:
This email (including any attachments) is intended for the sole use of =
the intended recipient/s and may contain material that is CONFIDENTIAL =
AND PRIVATE COMPANY INFORMATION. Any review or reliance by others or =
copying or distribution or forwarding of any or all of the contents in =
this message is STRICTLY PROHIBITED. If you are not the intended =
recipient, please contact the sender by email and delete all copies; =
your cooperation in this regard is appreciated.


------_=_NextPart_001_01C82D21.0A3526E1
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
------_=_NextPart_001_01C82D21.0A3526E1--

From java-user-return-31141-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 16:04:19 2007
Return-Path: <java-user-return-31141-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44900 invoked from network); 22 Nov 2007 16:04:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 16:04:19 -0000
Received: (qmail 91466 invoked by uid 500); 22 Nov 2007 16:04:01 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91434 invoked by uid 500); 22 Nov 2007 16:04:01 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91423 invoked by uid 99); 22 Nov 2007 16:04:01 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 08:04:01 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 64.233.166.177 as permitted sender)
Received: from [64.233.166.177] (HELO py-out-1112.google.com) (64.233.166.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 16:03:51 +0000
Received: by py-out-1112.google.com with SMTP id d32so14702986pye
        for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 08:03:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=lo+uy1zOJtCSBAcHJvXWgGh9UhiW4+0fD5RpeN8E3GE=;
        b=VoIfRD+H1dfgG9cRnbpI4MD27zczqNjVn7m4TdCk0JMR8qva3xvlng/faZtBOC5GEL0kHobUNW8GD3gN/n/LR5Ncqa0MdMBcwgkNYZELgY+i1UhhxeQUa+EtAWNZkEOrboYVXaU7f9aJ3E3yENPBa74bWg7gMds1xkWXH3edd7Q=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=n2cT2V8kdoxOOKIPxkZeAwbemSq0t4R/X1eA9L4yQ1Il9/95SmITc/m62SHSkvdpG9Lk1nlgXEMk6FSQfTaF5Vqv2NB5RT6EPoOhg4KwJRZBToFeJ6GuE5GxKQxRBWcOg+Yjo/CxcteEkQ85W6okS8teJH5Wa8avyFUQL1KxkTA=
Received: by 10.64.149.15 with SMTP id w15mr19861458qbd.1195747424615;
        Thu, 22 Nov 2007 08:03:44 -0800 (PST)
Received: by 10.64.181.13 with HTTP; Thu, 22 Nov 2007 08:03:44 -0800 (PST)
Message-ID: <786fde50711220803q14e337a7h47c3f5c90638e344@mail.gmail.com>
Date: Thu, 22 Nov 2007 18:03:44 +0200
From: "Shai Erera" <serera@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Force MultiFieldQueryParser always to use PrefixQuery
In-Reply-To: <359a92830711220535g205e54fctbc9ae836610ad096@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_24072_5411193.1195747424606"
References: <f4ea65560711211116y35dc176bk35940e304bec95b0@mail.gmail.com>
	 <359a92830711220535g205e54fctbc9ae836610ad096@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_24072_5411193.1195747424606
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi

I wrote the following class:

    public class AlwaysPrefixMultiFieldQP extends MultiFieldQueryParser {

        public MyQP(String[] fields, Analyzer analyzer) {
            super(fields, analyzer);
        }

        protected Query getFieldQuery(String field, String queryText) throws
ParseException {
            if (field != null) {
                return new PrefixQuery(new Term(field, queryText));
            }
            return super.getFieldQuery(field, queryText);
        }
    }

What it does is override getFieldQuery. If the field is not null, it creates
a new PrefixQuery. Following is a sample code:
       AlwaysPrefixMultiFieldQP m = new AlwaysPrefixMultiFieldQP(new
String[] { "field" }, analyzer);
       Query q = m.parse("sof was");
       System.out.println(q);

This code prints: (field:sof*) (field:was*), which is I believe what you
need.

As for splitting the query (pre processing) - this is not recommended. It
may work great for space separated languages, however may produce poor
results for Asian languages (for example). The way I propose above makes use
of the Analyzer you use, thus guarantees you append a '*' to all the words
in the query.

Hope this helps.

On Nov 22, 2007 3:35 PM, Erick Erickson <erickerickson@gmail.com> wrote:

> The simplest way would be to pre-process the query. That
> is, just split on words and add the '*' as appropriate.
>
> Erick
>
> On Nov 21, 2007 2:16 PM, Anders Lybecker <aly@miracleas.dk> wrote:
>
> > How do I force the MultiFieldQueryParser to interpret a string like
> > "dock boat" as "dock* boat*" and therefore use PrefixQuery instead of
> > TemQuery?
> >
> > The customer wants always to search with <word>* as default when
> entering
> > <word>
> >
> > :-)
> > Anders Lybecker
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>



-- 
Regards,

Shai Erera

------=_Part_24072_5411193.1195747424606--

From java-user-return-31142-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 16:20:15 2007
Return-Path: <java-user-return-31142-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51164 invoked from network); 22 Nov 2007 16:20:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 16:20:15 -0000
Received: (qmail 28064 invoked by uid 500); 22 Nov 2007 16:19:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 27763 invoked by uid 500); 22 Nov 2007 16:19:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 27509 invoked by uid 99); 22 Nov 2007 16:19:53 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 08:19:52 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.212] (HELO web26001.mail.ukl.yahoo.com) (217.12.10.212)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 22 Nov 2007 16:19:54 +0000
Received: (qmail 94192 invoked by uid 60001); 22 Nov 2007 16:19:33 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=4APu20YjA3/D2CbKEJahVSKg5FesBQn3890gLiHfSiasdYlqcLxIb3azhF+PkI5mhs2uq7FQkIs1W+1I/4DhVmcdcmKV/nGqcUIVOblcbu62g8PlCsDKsT83HZqi9mv+Whl22pPSfJRfx+zS3WZh3EMBSWp8Lvm7XZrw6p1qWgg=;
X-YMail-OSG: FVTgaggVM1k.bnuMBjrk0Elb2Ywml9pj9dCOtfC0TmvRFL2Jh0ystc9WsX2R9VMTVbMEx7WlwrS4L7itqdgqavOOu6ybT_dBtN4FJrO9rNLjymIu14jg3J9yXgI-
Received: from [193.36.230.96] by web26001.mail.ukl.yahoo.com via HTTP; Thu, 22 Nov 2007 16:19:32 GMT
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.157
Date: Thu, 22 Nov 2007 16:19:32 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: help required urgent!!!!!!!!!!!
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <888447.93968.qm@web26001.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

>>Re: help required urgent!!!!!!!!!!!=0A=0AYikes!!!!!!!!!!!!!!!!!!!!!!!!!!!=
!!!!!!!!!!!=0A=0AI'm guessing that the question was more about how to suppo=
rt this in the standard query syntax where there are multiple words.=0A=0Ai=
.e.  http://www.google.com/search?q=3Dlucene+wildcard+in+phrase=0A=0AThis p=
ost seems close to a solution to that problem:=0Ahttp://mail-archives.apach=
e.org/mod_mbox/lucene-java-user/200607.mbox/%3CB50FE8BF4F9CF24FB800E28DBB1A=
2FE026D681@gaia.2at.local%3E=0A=0A=0ACheers,=0AMark=0A=0A=0A----- Original =
Message ----=0AFrom: Shai Erera <serera@gmail.com>=0ATo: java-user@lucene.a=
pache.org=0ASent: Thursday, 22 November, 2007 3:54:51 PM=0ASubject: Re: hel=
p required urgent!!!!!!!!!!!=0A=0AHi=0A=0AYou can simply create a PrefixQue=
ry. However, if you're using=0AStandardAnalyzer, and the word is added as I=
ndex.TOKENIZED,=0Asotf-wa<something> will be broken to 'soft' and 'wa<somet=
hing>'.=0A Therefore=0Ayou'll need to add the word as Index.UN_TOKENIZED, o=
r use a different=0AAnalyzer when you index the data (for this field at lea=
st).=0A=0AHere's a sample code:=0A=0A        // Indexing.=0A        Documen=
t doc =3D new Document();=0A        doc.add(new Field("field", "soft-wash",=
 Store.NO,=0A Index.UN_TOKENIZED=0A));=0A=0A        // Search=0A        Que=
ry q =3D new PrefixQuery(new Term("field", "soft-wa"));=0A=0ADoes that help=
?=0A=0AOn Nov 22, 2007 5:46 PM, Shakti_Sareen <Shakti_Sareen@satyam.com>=0A=
 wrote:=0A=0A> Hi=0A> I am using StandardAnalyser() to index the data.=0A> =
But I want to do a like search on a word containing Hyphen=0A> For example =
it want to search a word "soft-wa*"=0A>=0A> I am getting no hits for that. =
It is said that if the hyphen is there=0A in=0A> the word, then we should i=
nclude that word in the double quotes (").=0A But=0A> enclosing the word in=
 a double quotes (") means the exact word=0A search.=0A>=0A> How can I perf=
orm the like search on a word containing hyphen???????=0A>=0A> Please help.=
=0A>=0A> Regards,=0A> Shakti Sareen=0A>=0A>=0A>=0A>=0A>=0A> DISCLAIMER:=0A>=
 This email (including any attachments) is intended for the sole use=0A of =
the=0A> intended recipient/s and may contain material that is CONFIDENTIAL=
=0A AND=0A> PRIVATE COMPANY INFORMATION. Any review or reliance by others o=
r=0A copying or=0A> distribution or forwarding of any or all of the content=
s in this=0A message is=0A> STRICTLY PROHIBITED. If you are not the intende=
d recipient, please=0A contact=0A> the sender by email and delete all copie=
s; your cooperation in this=0A regard=0A> is appreciated.=0A>=0A> ---------=
------------------------------------------------------------=0A> To unsubsc=
ribe, e-mail: java-user-unsubscribe@lucene.apache.org=0A> For additional co=
mmands, e-mail: java-user-help@lucene.apache.org=0A>=0A>=0A=0A=0A-- =0ARega=
rds,=0A=0AShai Erera=0A=0A=0A=0A=0A=0A      _______________________________=
____________________________ =0AWant ideas for reducing your carbon footpri=
nt? Visit Yahoo! For Good  http://uk.promotions.yahoo.com/forgood/environme=
nt.html

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31143-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 16:23:48 2007
Return-Path: <java-user-return-31143-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51922 invoked from network); 22 Nov 2007 16:23:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 16:23:47 -0000
Received: (qmail 34562 invoked by uid 500); 22 Nov 2007 16:23:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34526 invoked by uid 500); 22 Nov 2007 16:23:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34515 invoked by uid 99); 22 Nov 2007 16:23:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 08:23:29 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 64.233.166.179 as permitted sender)
Received: from [64.233.166.179] (HELO py-out-1112.google.com) (64.233.166.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 16:23:17 +0000
Received: by py-out-1112.google.com with SMTP id d32so14718218pye
        for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 08:23:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=AM6jVcFa8VY71t3fjp7lyeShU3AydAFfLeFmqsYbtR0=;
        b=K7en+9pn7a29MuYjf/mMe3NfityXb3TVHOVxibf0TMGlc8dyxPNHCgmYKNcuTrUBLdmzGR6yQpE09EuL2dWqlFXq08wzMCIH34C0pdNheXQM2mXPq07hJ67UPqYSZCB8ZmGBfRtfwqR3xtobXHGKukTAIOjtSrt57QVfXtfRUK8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=MLPdBx5+4RDLU+0bZkyvklcJyeEcdndLGUb8I4v2cpHoL+sOPPs9QjuCzF9mg7xxJCcKMKhxY+PE2Ue9OhAFrT0TLa9N9YEXzk1daG0eYOkyJS/Qz/uLpU7fuh9dxZHIgEv6YOf/NmHllo2JwACi3CWg/6bTc6ZgCog036RimM0=
Received: by 10.65.214.19 with SMTP id r19mr19947694qbq.1195748587912;
        Thu, 22 Nov 2007 08:23:07 -0800 (PST)
Received: by 10.64.181.13 with HTTP; Thu, 22 Nov 2007 08:23:07 -0800 (PST)
Message-ID: <786fde50711220823t12dbf96ckcf667e2138698867@mail.gmail.com>
Date: Thu, 22 Nov 2007 18:23:07 +0200
From: "Shai Erera" <serera@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: help required urgent!!!!!!!!!!!
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E9308@hstmsg005.corp.satyam.ad>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_24134_29519705.1195748587902"
References: <786fde50711220754n7d2dd206u61e2b73f641793d@mail.gmail.com>
	 <9312093579B72048B1E5659DC3EC7F39022E9308@hstmsg005.corp.satyam.ad>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_24134_29519705.1195748587902
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

The thing is - StandardAnalyzer breaks on hyphen. You'll need to work around
this by either extend StandardAnalyzer

>From StandardTokenizer's documentation (which is used by StandardAnalyzer):
*   <li> *Splits words at hyphens, unless there's a number in the token, in
which case
 *     the whole token is interpreted as a product number and is not split.*

I've investigated StandardAnalyzer's tokenization and it doesn't look simple
to disable that behavior. What you can do is extend StandardAnalyzer and
override its tokenStream method to create a TokenStream of your own. If you
know your text is space separated, you can use StringTokenizer to split the
text on spaces. If a token contains '-', don't break it, otherwise pass it
forward the the TokenStream returned by StandardAnalyzer.

Maybe someone else has a better answer, but if you insist on using
StandardAnalyzer, I have a feeling it will be problematic.

On Nov 22, 2007 6:02 PM, Shakti_Sareen < Shakti_Sareen@satyam.com> wrote:

> Hi
>
> But the file I am indexing is very big and I don't know which word will
> contain the hyphen. The thing you suggest can be implemented only if
> there are some specific words in the file.
>
> Apart from StandardAnalyzer I have got no option.
>
> Thanks a lot for your reply.
>
> Please suggest me how can I go ahead.
>
>
> SHAKTI SAREEN
> GE-GDC
> STC HYDERABAD
> 9948777794
>
> -----Original Message-----
> From: Shai Erera [mailto:serera@gmail.com]
> Sent: Thursday, November 22, 2007 9:25 PM
> To: java-user@lucene.apache.org
> Subject: Re: help required urgent!!!!!!!!!!!
>
> Hi
>
> You can simply create a PrefixQuery. However, if you're using
> StandardAnalyzer, and the word is added as Index.TOKENIZED,
> sotf-wa<something> will be broken to 'soft' and 'wa<something>'.
> Therefore
> you'll need to add the word as Index.UN_TOKENIZED, or use a different
> Analyzer when you index the data (for this field at least).
>
> Here's a sample code:
>
>        // Indexing.
>        Document doc = new Document();
>        doc.add(new Field("field", "soft-wash", Store.NO,
> Index.UN_TOKENIZED
> ));
>
>        // Search
>        Query q = new PrefixQuery(new Term("field", "soft-wa"));
>
> Does that help?
>
> On Nov 22, 2007 5:46 PM, Shakti_Sareen < Shakti_Sareen@satyam.com> wrote:
>
> > Hi
> > I am using StandardAnalyser() to index the data.
> > But I want to do a like search on a word containing Hyphen
> > For example it want to search a word "soft-wa*"
> >
> > I am getting no hits for that. It is said that if the hyphen is there
> in
> > the word, then we should include that word in the double quotes (").
> But
> > enclosing the word in a double quotes (") means the exact word search.
> >
> > How can I perform the like search on a word containing hyphen???????
> >
> > Please help.
> >
> > Regards,
> > Shakti Sareen
> >
> >
> >
> >
> >
> > DISCLAIMER:
> > This email (including any attachments) is intended for the sole use of
> the
> > intended recipient/s and may contain material that is CONFIDENTIAL AND
> > PRIVATE COMPANY INFORMATION. Any review or reliance by others or
> copying or
> > distribution or forwarding of any or all of the contents in this
> message is
> > STRICTLY PROHIBITED. If you are not the intended recipient, please
> contact
> > the sender by email and delete all copies; your cooperation in this
> regard
> > is appreciated.
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> --
> Regards,
>
> Shai Erera
>
>
> DISCLAIMER:
> This email (including any attachments) is intended for the sole use of the
> intended recipient/s and may contain material that is CONFIDENTIAL AND
> PRIVATE COMPANY INFORMATION. Any review or reliance by others or copying or
> distribution or forwarding of any or all of the contents in this message is
> STRICTLY PROHIBITED. If you are not the intended recipient, please contact
> the sender by email and delete all copies; your cooperation in this regard
> is appreciated.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>



-- 
Regards,

Shai Erera

------=_Part_24134_29519705.1195748587902--

From java-user-return-31144-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 16:31:44 2007
Return-Path: <java-user-return-31144-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54138 invoked from network); 22 Nov 2007 16:31:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 16:31:44 -0000
Received: (qmail 50760 invoked by uid 500); 22 Nov 2007 16:31:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50735 invoked by uid 500); 22 Nov 2007 16:31:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50724 invoked by uid 99); 22 Nov 2007 16:31:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 08:31:26 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 64.233.166.176 as permitted sender)
Received: from [64.233.166.176] (HELO py-out-1112.google.com) (64.233.166.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 16:31:15 +0000
Received: by py-out-1112.google.com with SMTP id d32so14725246pye
        for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 08:31:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=MaFo127ACSAqyxsvFZTUHvQ20nwOyILlJGSCHHEvcPE=;
        b=RPUQlTPsSn0UXn0E/2VtLMVcPVGFb5QH34Ut3xI10GjQJhH87TkWnMOrRZ7T+x+Jraht3R/aDiEUt6DxroX8rNZc44/duwB9ruTwHTXaa7utzelnDbsxgneNwS6Ao7mXeElqlUcCFjWFR/5sBObOpQGfaBXCg3rf8Va71jAR/Lw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=SHoiA7KkwAkds0bMemKNpRj+El1BZ6U8qDd9GjEfNBlgSFprzkCrHaHIb0A3hzsAcdOyVXjIaMEHgchAJtvR57ibMlcZOpB771S6C24LEjr21CsSAXEhgl3sbAgaxFHjT3YHYUnodMLuucaQNwOmzKLwMEppEm+KiOrLyj4jH/k=
Received: by 10.65.54.9 with SMTP id g9mr19915325qbk.1195749068060;
        Thu, 22 Nov 2007 08:31:08 -0800 (PST)
Received: by 10.64.181.13 with HTTP; Thu, 22 Nov 2007 08:31:07 -0800 (PST)
Message-ID: <786fde50711220831l5550e0a5l9927afa4f4c83fa9@mail.gmail.com>
Date: Thu, 22 Nov 2007 18:31:07 +0200
From: "Shai Erera" <serera@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: help required urgent!!!!!!!!!!!
In-Reply-To: <888447.93968.qm@web26001.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_24143_14236528.1195749068050"
References: <888447.93968.qm@web26001.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_24143_14236528.1195749068050
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Yep - that's a good one. Only it may be a very heavy query, and throw
TooManyClausesException, if the number of terms that start with the prefix
is too much. But that certainly would work.
BTW - MultiPhraseQuery's documentation specifically explains how to use it
for exactly the same purpose.

On Nov 22, 2007 6:19 PM, mark harwood <markharw00d@yahoo.co.uk> wrote:

> >>Re: help required urgent!!!!!!!!!!!
>
> Yikes!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
>
> I'm guessing that the question was more about how to support this in the
> standard query syntax where there are multiple words.
>
> i.e.  http://www.google.com/search?q=lucene+wildcard+in+phrase
>
> This post seems close to a solution to that problem:
>
> http://mail-archives.apache.org/mod_mbox/lucene-java-user/200607.mbox/%3CB50FE8BF4F9CF24FB800E28DBB1A2FE026D681@gaia.2at.local%3E
>
>
> Cheers,
> Mark
>
>
> ----- Original Message ----
> From: Shai Erera <serera@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Thursday, 22 November, 2007 3:54:51 PM
> Subject: Re: help required urgent!!!!!!!!!!!
>
> Hi
>
> You can simply create a PrefixQuery. However, if you're using
> StandardAnalyzer, and the word is added as Index.TOKENIZED,
> sotf-wa<something> will be broken to 'soft' and 'wa<something>'.
>  Therefore
> you'll need to add the word as Index.UN_TOKENIZED, or use a different
> Analyzer when you index the data (for this field at least).
>
> Here's a sample code:
>
>        // Indexing.
>        Document doc = new Document();
>        doc.add(new Field("field", "soft-wash", Store.NO,
>  Index.UN_TOKENIZED
> ));
>
>        // Search
>        Query q = new PrefixQuery(new Term("field", "soft-wa"));
>
> Does that help?
>
> On Nov 22, 2007 5:46 PM, Shakti_Sareen <Shakti_Sareen@satyam.com>
>  wrote:
>
> > Hi
> > I am using StandardAnalyser() to index the data.
> > But I want to do a like search on a word containing Hyphen
> > For example it want to search a word "soft-wa*"
> >
> > I am getting no hits for that. It is said that if the hyphen is there
>  in
> > the word, then we should include that word in the double quotes (").
>  But
> > enclosing the word in a double quotes (") means the exact word
>  search.
> >
> > How can I perform the like search on a word containing hyphen???????
> >
> > Please help.
> >
> > Regards,
> > Shakti Sareen
> >
> >
> >
> >
> >
> > DISCLAIMER:
> > This email (including any attachments) is intended for the sole use
>  of the
> > intended recipient/s and may contain material that is CONFIDENTIAL
>  AND
> > PRIVATE COMPANY INFORMATION. Any review or reliance by others or
>  copying or
> > distribution or forwarding of any or all of the contents in this
>  message is
> > STRICTLY PROHIBITED. If you are not the intended recipient, please
>  contact
> > the sender by email and delete all copies; your cooperation in this
>  regard
> > is appreciated.
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> --
> Regards,
>
> Shai Erera
>
>
>
>
>
>      ___________________________________________________________
> Want ideas for reducing your carbon footprint? Visit Yahoo! For Good
> http://uk.promotions.yahoo.com/forgood/environment.html
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Regards,

Shai Erera

------=_Part_24143_14236528.1195749068050--

From java-user-return-31145-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 16:50:29 2007
Return-Path: <java-user-return-31145-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58106 invoked from network); 22 Nov 2007 16:50:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 16:50:28 -0000
Received: (qmail 64337 invoked by uid 500); 22 Nov 2007 16:50:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64299 invoked by uid 500); 22 Nov 2007 16:50:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64288 invoked by uid 99); 22 Nov 2007 16:50:10 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 08:50:10 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [84.14.163.131] (HELO trinity.anyware-tech.com) (84.14.163.131)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 16:50:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by trinity.anyware-tech.com (Postfix) with ESMTP id 4EA3F400051
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 17:49:49 +0100 (CET)
Received: from trinity.anyware-tech.com ([127.0.0.1])
	by localhost (trinity.anyware-tech.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 21846-02 for <java-user@lucene.apache.org>;
	Thu, 22 Nov 2007 17:49:43 +0100 (CET)
Received: from almeda.anyware (almeda.anyware [10.0.3.16])
	by trinity.anyware-tech.com (Postfix) with ESMTP id 78BF240004B
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 17:49:43 +0100 (CET)
From: Nicolas =?iso-8859-1?q?Lalev=E9e?= <nicolas.lalevee@anyware-tech.com>
Organization: Anyware Technologies
To: java-user@lucene.apache.org
Subject: Re: Custom query parser
Date: Thu, 22 Nov 2007 17:49:42 +0100
User-Agent: KMail/1.9.7
References: <200711201355.28973.nicolas.lalevee@anyware-tech.com> <4745498B.3060801@impressie.nl>
In-Reply-To: <4745498B.3060801@impressie.nl>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
Message-Id: <200711221749.42670.nicolas.lalevee@anyware-tech.com>
X-Virus-Scanned: Debian amavisd-new at anyware-tech.com
X-Virus-Checked: Checked by ClamAV on apache.org

Le jeudi 22 novembre 2007, Matthijs Bierman a =E9crit=A0:
> Hi Nicolas,
>
> Why can't you extend the QueryParser and override the methods you want
> to modify?

Because the query parser I would like to have is a very basic user one, ala=
=20
google. The syntax I would like is nothing more than :
"type:text OR foo -bar"
I also don't want the user to be popuped with parsing error, and further mo=
re,=20
even with errors, I don't want to drop the failing terms. A search=20
for "bla:foo:bar" should fallback to "bla foo bar".

So I have the parser, but it seems, unless I have missed something, that I=
=20
have to reimplement (copy and paste) the QueryParser#getFieldQuery

Nicolas

>
> Cheers,
> Matthijs
>
> Nicolas Lalev=E9e wrote:
> > Hi,
> >
> > I am willing to have a query parser which is fault tolerant. I have
> > search over the archive, and I have found this :
> > http://www.nabble.com/Error-tolerant-query-parsing-tf108987.html#a300382
> >
> > I also want my parser to have very simple feature : phrase search and
> > field search. So I need to develop a simple query parser myself : not
> > that hard, a simple state machine will be the trick.
> >
> > But here I loose an important feature of the Lucene query parser :
> > creating queries regarding an analyzer. In fact I loose that very usefu=
ll
> > function :
> > http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/o=
rg
> >/apache/lucene/queryParser/QueryParser.html#getFieldQuery(java.lang.Stri=
ng
> >, %20java.lang.String)
> >
> > So is there any proper way to create a custom query parser without
> > duplicating the code ?
> >
> > cheers,
> > Nicolas
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



=2D-=20
Nicolas LALEV=C9E
ANYWARE TECHNOLOGIES
Tel : +33 (0)5 61 00 52 90
=46ax : +33 (0)5 61 00 51 46
http://www.anyware-tech.com

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31146-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 16:51:48 2007
Return-Path: <java-user-return-31146-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 58265 invoked from network); 22 Nov 2007 16:51:47 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 16:51:47 -0000
Received: (qmail 66054 invoked by uid 500); 22 Nov 2007 16:51:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66029 invoked by uid 500); 22 Nov 2007 16:51:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66018 invoked by uid 99); 22 Nov 2007 16:51:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 08:51:29 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.28] (HELO smtp-vbr8.xs4all.nl) (194.109.24.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 16:51:16 +0000
Received: from [192.168.89.206] (impressie.xs4all.nl [82.93.53.149])
	by smtp-vbr8.xs4all.nl (8.13.8/8.13.8) with ESMTP id lAMGp8L8022229
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 17:51:08 +0100 (CET)
	(envelope-from matthijs@impressie.nl)
Message-ID: <4745B382.8010509@impressie.nl>
Date: Thu, 22 Nov 2007 17:51:14 +0100
From: Matthijs Bierman <matthijs@impressie.nl>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: help required urgent!!!!!!!!!!!
References: <9312093579B72048B1E5659DC3EC7F39022E9308@hstmsg005.corp.satyam.ad>
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E9308@hstmsg005.corp.satyam.ad>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Hi

Simply create your own analyzer with JavaCC. See the repository for the 
latest StandardAnalyzer.jj file, make sure the Analyzer accepts anything 
with a hypen as a single token.
And try not to yell, please. Most of the questions are urgent, there is 
no need for emphasis - especially in this manner.

Good luck,
Matthijs



Shakti_Sareen wrote:
> Hi
>
> But the file I am indexing is very big and I don't know which word will
> contain the hyphen. The thing you suggest can be implemented only if
> there are some specific words in the file.
>
> Apart from StandardAnalyzer I have got no option.
>
> Thanks a lot for your reply.
>
> Please suggest me how can I go ahead.
>
>  
> SHAKTI SAREEN
> GE-GDC
> STC HYDERABAD
> 9948777794
>
> -----Original Message-----
> From: Shai Erera [mailto:serera@gmail.com] 
> Sent: Thursday, November 22, 2007 9:25 PM
> To: java-user@lucene.apache.org
> Subject: Re: help required urgent!!!!!!!!!!!
>
> Hi
>
> You can simply create a PrefixQuery. However, if you're using
> StandardAnalyzer, and the word is added as Index.TOKENIZED,
> sotf-wa<something> will be broken to 'soft' and 'wa<something>'.
> Therefore
> you'll need to add the word as Index.UN_TOKENIZED, or use a different
> Analyzer when you index the data (for this field at least).
>
> Here's a sample code:
>
>         // Indexing.
>         Document doc = new Document();
>         doc.add(new Field("field", "soft-wash", Store.NO,
> Index.UN_TOKENIZED
> ));
>
>         // Search
>         Query q = new PrefixQuery(new Term("field", "soft-wa"));
>
> Does that help?
>
> On Nov 22, 2007 5:46 PM, Shakti_Sareen <Shakti_Sareen@satyam.com> wrote:
>
>   
>> Hi
>> I am using StandardAnalyser() to index the data.
>> But I want to do a like search on a word containing Hyphen
>> For example it want to search a word "soft-wa*"
>>
>> I am getting no hits for that. It is said that if the hyphen is there
>>     
> in
>   
>> the word, then we should include that word in the double quotes (").
>>     
> But
>   
>> enclosing the word in a double quotes (") means the exact word search.
>>
>> How can I perform the like search on a word containing hyphen???????
>>
>> Please help.
>>
>> Regards,
>> Shakti Sareen
>>
>>
>>
>>
>>
>> DISCLAIMER:
>> This email (including any attachments) is intended for the sole use of
>>     
> the
>   
>> intended recipient/s and may contain material that is CONFIDENTIAL AND
>> PRIVATE COMPANY INFORMATION. Any review or reliance by others or
>>     
> copying or
>   
>> distribution or forwarding of any or all of the contents in this
>>     
> message is
>   
>> STRICTLY PROHIBITED. If you are not the intended recipient, please
>>     
> contact
>   
>> the sender by email and delete all copies; your cooperation in this
>>     
> regard
>   
>> is appreciated.
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
>
>   
> ------------------------------------------------------------------------
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31147-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 19:28:13 2007
Return-Path: <java-user-return-31147-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4466 invoked from network); 22 Nov 2007 19:28:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 19:28:13 -0000
Received: (qmail 4943 invoked by uid 500); 22 Nov 2007 19:27:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4601 invoked by uid 500); 22 Nov 2007 19:27:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4584 invoked by uid 99); 22 Nov 2007 19:27:54 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 11:27:54 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [134.60.1.11] (HELO mail.uni-ulm.de) (134.60.1.11)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 19:27:56 +0000
Received: from [192.168.178.20] (dslb-084-056-128-124.pools.arcor-ip.net [84.56.128.124])
	(authenticated bits=0)
	by mail.uni-ulm.de (8.14.1/8.14.1) with ESMTP id lAMJRYJZ020849
	(version=TLSv1/SSLv3 cipher=AES128-SHA bits=128 verify=NOT)
	for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 20:27:35 +0100 (MET)
Mime-Version: 1.0 (Apple Message framework v752.3)
Content-Transfer-Encoding: quoted-printable
Message-Id: <9CCE6F6E-5FCD-4F52-8F14-3E38EB7B2BC2@uni-ulm.de>
Content-Type: text/plain; charset=ISO-8859-1; delsp=yes; format=flowed
To: java-user@lucene.apache.org
From: Christian Aschoff <christian.aschoff@uni-ulm.de>
Subject: Where to place a filter...
Date: Thu, 22 Nov 2007 20:27:20 +0100
X-Mailer: Apple Mail (2.752.3)
X-DCC-SIHOPE-DCC-3-Metrics: triton 1085; Body=1 Fuz1=1 Fuz2=1
X-Virus-Scanned: by amavisd-new
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

as a prolog, i have no problems and everything works the way i want :-)

I am more interested in a tip if i am using the right way or pattern. =20=

I want to strip accents before data goes into my index, so i wrote =20
the code following below. I did not find an example of where to place =20=

a filter (for indexing) with google, so this is my guess of how to do =20=

it.

My question is: Is this the correct pattern for the usage of a filter =20=

or where should it be placed?

Thank you in advantage for any comments,
Christian

---------------------------------------------------------------
/*
  * RetroBibAnalyzer.java
  *
  * Created on 22. November 2007, 12:42
  *
  */

package de.retrobib.lucene;

import java.io.Reader;
import org.apache.log4j.Logger;
import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.analysis.TokenStream;
import org.apache.lucene.analysis.de.GermanAnalyzer;
import org.apache.lucene.analysis.snowball.SnowballAnalyzer;

/**
  * Analyzer f=FCr den Lucene-Index. Zu Zeit nur ein
  * Wrapper um sp=E4tere Erweiterungen zu erleichtern.
  *
  * @author caschoff
  * @version 1.0
  */
public class RetroBibAnalyzer extends Analyzer {

     /**
      * <b>Jede</b> Klasse hat ihren Logger.
      */
     private static final Logger logger =3D Logger.getLogger=20
(RetroBibAnalyzer.class);

     /** Der Analyzer. */
     private static final SnowballAnalyzer analyzer =3D new =20
SnowballAnalyzer("German", GermanAnalyzer.GERMAN_STOP_WORDS);

     /** Creates a new instance of RetroBibAnalyzer */
     public RetroBibAnalyzer() {
         super();
     }

     /**
      * Den Tokenstream verarbeiten.
      *
      * @param fieldName Der Name des Feldes.
      * @param reader Der reader.
      * @return Der TokenStream.
      */
     public TokenStream tokenStream(String fieldName, Reader reader) {
         return new UTF8AccentFilter(analyzer.tokenStream(fieldName, =20
reader));
     }

}
---------------------------------------------------------------

---
Dipl. Ing. (FH) Christian Aschoff

B=FCro:
Universit=E4t Ulm
Kommunikations- und Informationszentrum
Abt. Informationssysteme
Raum O26/5403
Albert-Einstein-Allee 11
89081 Ulm

Tel. 0731 50-22432
Fax. 0731 50-22471
christian.aschoff@uni-ulm.de

Privat:
Fabristr. 13
89075 Ulm
Deutschland/Old Europe

Tel. 0731 602 803 60
Fax. 0731 602 803 61
Mob. 0171 272 03 04
caschoff@mac.com

Helfen Sie mit: www.retrobibliothek.de




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31148-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 22 21:49:31 2007
Return-Path: <java-user-return-31148-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 39846 invoked from network); 22 Nov 2007 21:49:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 22 Nov 2007 21:49:31 -0000
Received: (qmail 92412 invoked by uid 500); 22 Nov 2007 21:49:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92377 invoked by uid 500); 22 Nov 2007 21:49:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92366 invoked by uid 99); 22 Nov 2007 21:49:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 13:49:13 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of mike.klaas@gmail.com designates 209.85.146.179 as permitted sender)
Received: from [209.85.146.179] (HELO wa-out-1112.google.com) (209.85.146.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Nov 2007 21:49:02 +0000
Received: by wa-out-1112.google.com with SMTP id j40so3606364wah
        for <java-user@lucene.apache.org>; Thu, 22 Nov 2007 13:48:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:mime-version:in-reply-to:references:content-type:message-id:content-transfer-encoding:from:subject:date:to:x-mailer;
        bh=zJKonZpLWykSsSeQCYHYrmSMP8hZ89e8iuGp5IKpQCM=;
        b=dz11Xc/ywLzJ6URPkrn2AlPOij0QmtLuy/wEGGlSUu3cf0wiZE4Ro4PDBtTBA8NU93gsYd+G9RnleSoNosb0vaeB6zpUYXYyqNzRDYbRwzht2NiR+Ccp/jy/v0mVuUDVORF3FnR/dINYB4SRxBzwi894EgSO5dc5FMQ4VXEdCxg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:mime-version:in-reply-to:references:content-type:message-id:content-transfer-encoding:from:subject:date:to:x-mailer;
        b=i4AdHv5JT/oLCNVaIFf8zEmDPUyIwjUfSPyAWc95RDF2nP6hU2EluVUA7ISPaPoSPA5bFxWqzvLeFryXlT27nzdY7F8saMryTfmLRv+blXnduqCO7i32IqiUHYmn2vX1ocdXe+joaWdkQRuX/hOE8nZes6lH+cw1g6gBKaOFn/s=
Received: by 10.114.149.2 with SMTP id w2mr52798wad.1195768135981;
        Thu, 22 Nov 2007 13:48:55 -0800 (PST)
Received: from ?192.168.1.103? ( [24.82.155.191])
        by mx.google.com with ESMTPS id k35sm1677181waf.2007.11.22.13.48.55
        (version=TLSv1/SSLv3 cipher=OTHER);
        Thu, 22 Nov 2007 13:48:55 -0800 (PST)
Mime-Version: 1.0 (Apple Message framework v752.2)
In-Reply-To: <200711221749.42670.nicolas.lalevee@anyware-tech.com>
References: <200711201355.28973.nicolas.lalevee@anyware-tech.com> <4745498B.3060801@impressie.nl> <200711221749.42670.nicolas.lalevee@anyware-tech.com>
Content-Type: text/plain; charset=ISO-8859-1; delsp=yes; format=flowed
Message-Id: <9796AB6C-E9E9-4935-B2A5-95AB810FE7A9@gmail.com>
Content-Transfer-Encoding: quoted-printable
From: Mike Klaas <mike.klaas@gmail.com>
Subject: Re: Custom query parser
Date: Thu, 22 Nov 2007 13:48:55 -0800
To: java-user@lucene.apache.org
X-Mailer: Apple Mail (2.752.2)
X-Virus-Checked: Checked by ClamAV on apache.org

On 22-Nov-07, at 8:49 AM, Nicolas Lalev=E9e wrote:

> Le jeudi 22 novembre 2007, Matthijs Bierman a =E9crit :
>> Hi Nicolas,
>>
>> Why can't you extend the QueryParser and override the methods you =20
>> want
>> to modify?
>
> Because the query parser I would like to have is a very basic user =20
> one, ala
> google. The syntax I would like is nothing more than :
> "type:text OR foo -bar"
> I also don't want the user to be popuped with parsing error, and =20
> further more,
> even with errors, I don't want to drop the failing terms. A search
> for "bla:foo:bar" should fallback to "bla foo bar".

This is usually best handled by preprocessing the query and =20
validating it yourself.

> So I have the parser, but it seems, unless I have missed something, =20=

> that I
> have to reimplement (copy and paste) the QueryParser#getFieldQuery

You could override it, call the super method, then if the resulting =20
query is a PhraseQuery, extract the components and replace the query =20
with a span query of prefix queries, or somesuch.

-Mike=

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31149-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 23 10:36:43 2007
Return-Path: <java-user-return-31149-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99022 invoked from network); 23 Nov 2007 10:36:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 Nov 2007 10:36:43 -0000
Received: (qmail 47561 invoked by uid 500); 23 Nov 2007 10:36:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47530 invoked by uid 500); 23 Nov 2007 10:36:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47518 invoked by uid 99); 23 Nov 2007 10:36:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 02:36:23 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lybecker@gmail.com designates 64.233.184.226 as permitted sender)
Received: from [64.233.184.226] (HELO wr-out-0506.google.com) (64.233.184.226)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 10:36:12 +0000
Received: by wr-out-0506.google.com with SMTP id c46so2557101wra
        for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 02:36:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:to:references:in-reply-to:subject:date:message-id:mime-version:content-type:content-transfer-encoding:x-mailer:thread-index:content-language:from:sender;
        bh=TXGZ/WJBbYVfKadOBXphwoFvC0T8zA+f3Vza82LS8PQ=;
        b=A1T2aWi6dkQZWQ2QA+/zWhLe1RuQBFB/Fh6BB89FofQ8EW1SS945JzB8WRRA+psHEtJXR1zhd5i9zOy7F9sTRqrFDimnYVoHvf/DP1QQNAMRBGDQlA4mv2FBV/d9/6egFDtO0A17SG0s1H1CotaKeKg27x1YEBe/floJA3CIfPw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:to:references:in-reply-to:subject:date:message-id:mime-version:content-type:content-transfer-encoding:x-mailer:thread-index:content-language:from:sender;
        b=dhoRCGv+hfi/xRPl5hxM7OINyNDJz6p55fRKZA5kYCqJOOsUDCXNQwl1lt5mbrV9cWk3uQ2NYNqmxn6eW+s8jcFjNdtWCEoq8Y54Dj2gkgtOIVJWc8kbS8O6eMqMBy1nnK5FFeIuB3AOrhd7bdgDjsa9JrQUeVigLjoPWRcHooQ=
Received: by 10.78.193.5 with SMTP id q5mr10743945huf.1195814164355;
        Fri, 23 Nov 2007 02:36:04 -0800 (PST)
Received: from MiracleALY ( [194.255.38.201])
        by mx.google.com with ESMTPS id 1sm1762520nfv.2007.11.23.02.36.02
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 23 Nov 2007 02:36:03 -0800 (PST)
To: <java-user@lucene.apache.org>
References: <f4ea65560711211116y35dc176bk35940e304bec95b0@mail.gmail.com> <359a92830711220535g205e54fctbc9ae836610ad096@mail.gmail.com> <786fde50711220803q14e337a7h47c3f5c90638e344@mail.gmail.com>
In-Reply-To: <786fde50711220803q14e337a7h47c3f5c90638e344@mail.gmail.com>
Subject: RE: Force MultiFieldQueryParser always to use PrefixQuery
Date: Fri, 23 Nov 2007 11:36:00 +0100
Message-ID: <000901c82dbc$a537d3a0$efa77ae0$@dk>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="windows-1250"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
thread-index: AcgtIVVm062okt8UQpughei6a4PDiAAmdjTg
Content-Language: da
From: Anders Lybecker <aly@miracleas.dk>
Sender: Anders Lybecker <lybecker@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I thought about appending a * at the end of each word like <word>*. I did
not like the idea and it becomes cumbersome when using the complex
QueryParser syntax.

I also investigated the option of overriding the getFieldQuery via
inheritance, but I doubt it works at the method does more than just return a
TermQuery. For instance it also returns PhraseQuery, MultiPhraseQuery and
BooleanQuery.

My solution to the problem is post-processing of the returned query from the
MultiFieldQueryParser.

I iterate over the query graph and replaces each TermQuery with a
PrefixQuery.

This is how I do it. Beware! It's C# code, but I'm pretty sure that you will
be able to interpret it anyway :-)

    public static class QueryModifier
    {
        public static Query AppendWildcard(Query q)
        {
            BooleanQuery boolQuery = q as BooleanQuery;

            if (boolQuery != null)
            {
                Iterate(ref boolQuery);

                return boolQuery;
            }
            TermQuery termQuery = q as TermQuery;

            if (termQuery != null)
                return new PrefixQuery(termQuery.GetTerm());

            return q;
        }

        private static void Iterate(ref BooleanQuery boolQuery)
        {
            BooleanClause[] boolClauses = boolQuery.GetClauses();

            BooleanClause clause;

            for (int i = 0; i < boolClauses.Length; i++)
            {
                clause = boolClauses[i];

                Query clauseQuery = clause.GetQuery();

                BooleanQuery boolClauseQuery = clauseQuery as BooleanQuery;

                if (boolClauseQuery != null)
                {
                    Iterate(ref boolClauseQuery);

                    boolClauses[i] = new BooleanClause(boolClauseQuery,
boolClauses[i].GetOccur()); ;
                }

                TermQuery termClauseQuery = clauseQuery as TermQuery;

                if (termClauseQuery != null)
                {
                    // Change TermQuery -> PrefixQuery to wildcard search
like <word>*
                    PrefixQuery prefixQuery = new
PrefixQuery(termClauseQuery.GetTerm());

                    boolClauses[i] = new BooleanClause(prefixQuery,
boolClauses[i].GetOccur());
                }
            }

            boolQuery = new BooleanQuery(boolQuery.IsCoordDisabled());
            foreach (BooleanClause claus in boolClauses)
            {
                boolQuery.Add(claus);
            }
        }
    }

Thanks for the suggestions.

:-)
Anders Lybecker

-----Original Message-----
From: Shai Erera [mailto:serera@gmail.com] 
Sent: 22. november 2007 17:04
To: java-user@lucene.apache.org
Subject: Re: Force MultiFieldQueryParser always to use PrefixQuery

Hi

I wrote the following class:

    public class AlwaysPrefixMultiFieldQP extends MultiFieldQueryParser {

        public MyQP(String[] fields, Analyzer analyzer) {
            super(fields, analyzer);
        }

        protected Query getFieldQuery(String field, String queryText) throws
ParseException {
            if (field != null) {
                return new PrefixQuery(new Term(field, queryText));
            }
            return super.getFieldQuery(field, queryText);
        }
    }

What it does is override getFieldQuery. If the field is not null, it creates
a new PrefixQuery. Following is a sample code:
       AlwaysPrefixMultiFieldQP m = new AlwaysPrefixMultiFieldQP(new
String[] { "field" }, analyzer);
       Query q = m.parse("sof was");
       System.out.println(q);

This code prints: (field:sof*) (field:was*), which is I believe what you
need.

As for splitting the query (pre processing) - this is not recommended. It
may work great for space separated languages, however may produce poor
results for Asian languages (for example). The way I propose above makes use
of the Analyzer you use, thus guarantees you append a '*' to all the words
in the query.

Hope this helps.

On Nov 22, 2007 3:35 PM, Erick Erickson <erickerickson@gmail.com> wrote:

> The simplest way would be to pre-process the query. That
> is, just split on words and add the '*' as appropriate.
>
> Erick
>
> On Nov 21, 2007 2:16 PM, Anders Lybecker <aly@miracleas.dk> wrote:
>
> > How do I force the MultiFieldQueryParser to interpret a string like
> > "dock boat" as "dock* boat*" and therefore use PrefixQuery instead of
> > TemQuery?
> >
> > The customer wants always to search with <word>* as default when
> entering
> > <word>
> >
> > :-)
> > Anders Lybecker
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>



-- 
Regards,

Shai Erera

No virus found in this incoming message.
Checked by AVG Free Edition. 
Version: 7.5.503 / Virus Database: 269.16.4/1146 - Release Date: 22-11-2007
18:55
 

No virus found in this outgoing message.
Checked by AVG Free Edition. 
Version: 7.5.503 / Virus Database: 269.16.4/1146 - Release Date: 22-11-2007
18:55
 


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31150-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 23 11:41:05 2007
Return-Path: <java-user-return-31150-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15060 invoked from network); 23 Nov 2007 11:41:05 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 Nov 2007 11:41:05 -0000
Received: (qmail 19230 invoked by uid 500); 23 Nov 2007 11:40:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 19187 invoked by uid 500); 23 Nov 2007 11:40:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 19012 invoked by uid 99); 23 Nov 2007 11:40:43 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 03:40:43 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [124.30.170.13] (HELO hydmail1.satyam.com) (124.30.170.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 11:40:30 +0000
Received: from hyd.satyam.com (hyd.satyam.com [204.252.161.226])
	by hydmail1.satyam.com (8.13.4/8.13.4) with ESMTP id lANBJR65006732
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 16:49:27 +0530
Received: from Disclaimerhyd.corp.satyam.ad (hhtbh.satyam.com [172.16.186.212])
	by hyd.satyam.com (8.13.1/8.13.1) with ESMTP id lANBc4If009560
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 17:08:08 +0530
Received: from hstmsg005.corp.satyam.ad ([172.16.186.216]) by Disclaimerhyd.corp.satyam.ad with Microsoft SMTPSVC(6.0.3790.211); Fri, 23 Nov 2007 17:09:28 +0530
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.607
Content-Transfer-Encoding: 7bit
Content-class: urn:content-classes:message
MIME-Version: 1.0
Priority: normal
Importance: normal
Content-Type: multipart/mixed;
	boundary="----_=_NextPart_001_01C82DC5.81136B51"
Subject: help required
Date: Fri, 23 Nov 2007 17:09:27 +0530
Message-ID: <9312093579B72048B1E5659DC3EC7F39022E9309@hstmsg005.corp.satyam.ad>
In-Reply-To: <786fde50711220823t12dbf96ckcf667e2138698867@mail.gmail.com>
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator: 
Thread-Topic: help required
Thread-Index: AcgtJBx5x6+VWjzPS06661wLYeILzwAoaVag
From: "Shakti_Sareen" <Shakti_Sareen@satyam.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 23 Nov 2007 11:39:28.0950 (UTC) FILETIME=[81CC0D60:01C82DC5]
X-Virus-Scanned: ClamAV version 0.88.4, clamav-milter version 0.88.4 on hyd.satyam.com
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C82DC5.81136B51
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi=20

Can anyone help me with a code having a class which extends the
StandardAnalyzer and that analyzer should not tokenize the word across
hyphen

=20
SHAKTI SAREEN

-----Original Message-----
From: Shai Erera [mailto:serera@gmail.com]=20
Sent: Thursday, November 22, 2007 9:53 PM
To: java-user@lucene.apache.org
Subject: Re: help required urgent!!!!!!!!!!!

The thing is - StandardAnalyzer breaks on hyphen. You'll need to work
around
this by either extend StandardAnalyzer

>From StandardTokenizer's documentation (which is used by
StandardAnalyzer):
*   <li> *Splits words at hyphens, unless there's a number in the token,
in
which case
 *     the whole token is interpreted as a product number and is not
split.*

I've investigated StandardAnalyzer's tokenization and it doesn't look
simple
to disable that behavior. What you can do is extend StandardAnalyzer and
override its tokenStream method to create a TokenStream of your own. If
you
know your text is space separated, you can use StringTokenizer to split
the
text on spaces. If a token contains '-', don't break it, otherwise pass
it
forward the the TokenStream returned by StandardAnalyzer.

Maybe someone else has a better answer, but if you insist on using
StandardAnalyzer, I have a feeling it will be problematic.

On Nov 22, 2007 6:02 PM, Shakti_Sareen < Shakti_Sareen@satyam.com>
wrote:

> Hi
>
> But the file I am indexing is very big and I don't know which word
will
> contain the hyphen. The thing you suggest can be implemented only if
> there are some specific words in the file.
>
> Apart from StandardAnalyzer I have got no option.
>
> Thanks a lot for your reply.
>
> Please suggest me how can I go ahead.
>
>
> SHAKTI SAREEN
> GE-GDC
> STC HYDERABAD
> 9948777794
>
> -----Original Message-----
> From: Shai Erera [mailto:serera@gmail.com]
> Sent: Thursday, November 22, 2007 9:25 PM
> To: java-user@lucene.apache.org
> Subject: Re: help required urgent!!!!!!!!!!!
>
> Hi
>
> You can simply create a PrefixQuery. However, if you're using
> StandardAnalyzer, and the word is added as Index.TOKENIZED,
> sotf-wa<something> will be broken to 'soft' and 'wa<something>'.
> Therefore
> you'll need to add the word as Index.UN_TOKENIZED, or use a different
> Analyzer when you index the data (for this field at least).
>
> Here's a sample code:
>
>        // Indexing.
>        Document doc =3D new Document();
>        doc.add(new Field("field", "soft-wash", Store.NO,
> Index.UN_TOKENIZED
> ));
>
>        // Search
>        Query q =3D new PrefixQuery(new Term("field", "soft-wa"));
>
> Does that help?
>
> On Nov 22, 2007 5:46 PM, Shakti_Sareen < Shakti_Sareen@satyam.com>
wrote:
>
> > Hi
> > I am using StandardAnalyser() to index the data.
> > But I want to do a like search on a word containing Hyphen
> > For example it want to search a word "soft-wa*"
> >
> > I am getting no hits for that. It is said that if the hyphen is
there
> in
> > the word, then we should include that word in the double quotes (").
> But
> > enclosing the word in a double quotes (") means the exact word
search.
> >
> > How can I perform the like search on a word containing hyphen???????
> >
> > Please help.
> >
> > Regards,
> > Shakti Sareen
> >
> >
> >
> >
> >
> > DISCLAIMER:
> > This email (including any attachments) is intended for the sole use
of
> the
> > intended recipient/s and may contain material that is CONFIDENTIAL
AND
> > PRIVATE COMPANY INFORMATION. Any review or reliance by others or
> copying or
> > distribution or forwarding of any or all of the contents in this
> message is
> > STRICTLY PROHIBITED. If you are not the intended recipient, please
> contact
> > the sender by email and delete all copies; your cooperation in this
> regard
> > is appreciated.
> >
> >
---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
>
> --
> Regards,
>
> Shai Erera
>
>
> DISCLAIMER:
> This email (including any attachments) is intended for the sole use of
the
> intended recipient/s and may contain material that is CONFIDENTIAL AND
> PRIVATE COMPANY INFORMATION. Any review or reliance by others or
copying or
> distribution or forwarding of any or all of the contents in this
message is
> STRICTLY PROHIBITED. If you are not the intended recipient, please
contact
> the sender by email and delete all copies; your cooperation in this
regard
> is appreciated.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>



--=20
Regards,

Shai Erera


DISCLAIMER:
This email (including any attachments) is intended for the sole use of =
the intended recipient/s and may contain material that is CONFIDENTIAL =
AND PRIVATE COMPANY INFORMATION. Any review or reliance by others or =
copying or distribution or forwarding of any or all of the contents in =
this message is STRICTLY PROHIBITED. If you are not the intended =
recipient, please contact the sender by email and delete all copies; =
your cooperation in this regard is appreciated.


------_=_NextPart_001_01C82DC5.81136B51
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
------_=_NextPart_001_01C82DC5.81136B51--

From java-user-return-31151-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 23 13:29:16 2007
Return-Path: <java-user-return-31151-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50344 invoked from network); 23 Nov 2007 13:29:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 Nov 2007 13:29:15 -0000
Received: (qmail 29736 invoked by uid 500); 23 Nov 2007 13:28:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29703 invoked by uid 500); 23 Nov 2007 13:28:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29691 invoked by uid 99); 23 Nov 2007 13:28:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 05:28:57 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of markrmiller@gmail.com designates 64.233.162.237 as permitted sender)
Received: from [64.233.162.237] (HELO nz-out-0506.google.com) (64.233.162.237)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 13:28:44 +0000
Received: by nz-out-0506.google.com with SMTP id i28so2428490nzi
        for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 05:28:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=FRLBSjCfY3/nAowk8LsBsM8S1fikWuQ92CloikQbB/0=;
        b=cck3yY7b82J+4SiTgsDYVgH4LLFQDC4nP0f4r2zVAJZfPnq9gw8bJp4xMCbE1MwVuwe4911DyG/zSo3xParOWNtH7QtbsE6wtDVKBwRfBk9Bi+Eez5i288XaWtbFKxsZWtesy0tGiPyBiMoMUN2Xv7DjKzjR2zVFUZNhzbnxxg8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=bqwXBpz7TBH3IvrQt3kDZh2H+sH8ODIAIKXU/jq6vvEU8XN65dfCyPZnllGOdO2/9TChuefeslwJ4MWrMAG99hcMDIzFH8h3cjIBCHFr83MIhO8WcahtZez3mjsk5DmVHCOvmHUQeSCnTxFZZR4bfNgR14ICCGlTcFQaBTED9oA=
Received: by 10.65.254.5 with SMTP id g5mr22096296qbs.1195824517453;
        Fri, 23 Nov 2007 05:28:37 -0800 (PST)
Received: from ?192.168.1.102? ( [69.124.234.183])
        by mx.google.com with ESMTPS id q15sm1439940qbq.2007.11.23.05.28.36
        (version=SSLv3 cipher=RC4-MD5);
        Fri, 23 Nov 2007 05:28:36 -0800 (PST)
Message-ID: <4746D57B.9040209@gmail.com>
Date: Fri, 23 Nov 2007 08:28:27 -0500
From: Mark Miller <markrmiller@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: help required
References: <9312093579B72048B1E5659DC3EC7F39022E9309@hstmsg005.corp.satyam.ad>
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E9309@hstmsg005.corp.satyam.ad>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Copy the current Standard Analyzer and add '-' to the definition of a 
LETTER. You might work with the StandardAnazlyer on the trunk which uses 
JFlex rather than the current JavaCC flavor...the new one is something 
like 6-10 times faster.

- Mark

Shakti_Sareen wrote:
> Hi 
>
> Can anyone help me with a code having a class which extends the
> StandardAnalyzer and that analyzer should not tokenize the word across
> hyphen
>
>  
> SHAKTI SAREEN
>
> -----Original Message-----
> From: Shai Erera [mailto:serera@gmail.com] 
> Sent: Thursday, November 22, 2007 9:53 PM
> To: java-user@lucene.apache.org
> Subject: Re: help required urgent!!!!!!!!!!!
>
> The thing is - StandardAnalyzer breaks on hyphen. You'll need to work
> around
> this by either extend StandardAnalyzer
>
> >From StandardTokenizer's documentation (which is used by
> StandardAnalyzer):
> *   <li> *Splits words at hyphens, unless there's a number in the token,
> in
> which case
>  *     the whole token is interpreted as a product number and is not
> split.*
>
> I've investigated StandardAnalyzer's tokenization and it doesn't look
> simple
> to disable that behavior. What you can do is extend StandardAnalyzer and
> override its tokenStream method to create a TokenStream of your own. If
> you
> know your text is space separated, you can use StringTokenizer to split
> the
> text on spaces. If a token contains '-', don't break it, otherwise pass
> it
> forward the the TokenStream returned by StandardAnalyzer.
>
> Maybe someone else has a better answer, but if you insist on using
> StandardAnalyzer, I have a feeling it will be problematic.
>
> On Nov 22, 2007 6:02 PM, Shakti_Sareen < Shakti_Sareen@satyam.com>
> wrote:
>
>   
>> Hi
>>
>> But the file I am indexing is very big and I don't know which word
>>     
> will
>   
>> contain the hyphen. The thing you suggest can be implemented only if
>> there are some specific words in the file.
>>
>> Apart from StandardAnalyzer I have got no option.
>>
>> Thanks a lot for your reply.
>>
>> Please suggest me how can I go ahead.
>>
>>
>> SHAKTI SAREEN
>> GE-GDC
>> STC HYDERABAD
>> 9948777794
>>
>> -----Original Message-----
>> From: Shai Erera [mailto:serera@gmail.com]
>> Sent: Thursday, November 22, 2007 9:25 PM
>> To: java-user@lucene.apache.org
>> Subject: Re: help required urgent!!!!!!!!!!!
>>
>> Hi
>>
>> You can simply create a PrefixQuery. However, if you're using
>> StandardAnalyzer, and the word is added as Index.TOKENIZED,
>> sotf-wa<something> will be broken to 'soft' and 'wa<something>'.
>> Therefore
>> you'll need to add the word as Index.UN_TOKENIZED, or use a different
>> Analyzer when you index the data (for this field at least).
>>
>> Here's a sample code:
>>
>>        // Indexing.
>>        Document doc = new Document();
>>        doc.add(new Field("field", "soft-wash", Store.NO,
>> Index.UN_TOKENIZED
>> ));
>>
>>        // Search
>>        Query q = new PrefixQuery(new Term("field", "soft-wa"));
>>
>> Does that help?
>>
>> On Nov 22, 2007 5:46 PM, Shakti_Sareen < Shakti_Sareen@satyam.com>
>>     
> wrote:
>   
>>> Hi
>>> I am using StandardAnalyser() to index the data.
>>> But I want to do a like search on a word containing Hyphen
>>> For example it want to search a word "soft-wa*"
>>>
>>> I am getting no hits for that. It is said that if the hyphen is
>>>       
> there
>   
>> in
>>     
>>> the word, then we should include that word in the double quotes (").
>>>       
>> But
>>     
>>> enclosing the word in a double quotes (") means the exact word
>>>       
> search.
>   
>>> How can I perform the like search on a word containing hyphen???????
>>>
>>> Please help.
>>>
>>> Regards,
>>> Shakti Sareen
>>>
>>>
>>>
>>>
>>>
>>> DISCLAIMER:
>>> This email (including any attachments) is intended for the sole use
>>>       
> of
>   
>> the
>>     
>>> intended recipient/s and may contain material that is CONFIDENTIAL
>>>       
> AND
>   
>>> PRIVATE COMPANY INFORMATION. Any review or reliance by others or
>>>       
>> copying or
>>     
>>> distribution or forwarding of any or all of the contents in this
>>>       
>> message is
>>     
>>> STRICTLY PROHIBITED. If you are not the intended recipient, please
>>>       
>> contact
>>     
>>> the sender by email and delete all copies; your cooperation in this
>>>       
>> regard
>>     
>>> is appreciated.
>>>
>>>
>>>       
> ---------------------------------------------------------------------
>   
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>>
>>>       
>> --
>> Regards,
>>
>> Shai Erera
>>
>>
>> DISCLAIMER:
>> This email (including any attachments) is intended for the sole use of
>>     
> the
>   
>> intended recipient/s and may contain material that is CONFIDENTIAL AND
>> PRIVATE COMPANY INFORMATION. Any review or reliance by others or
>>     
> copying or
>   
>> distribution or forwarding of any or all of the contents in this
>>     
> message is
>   
>> STRICTLY PROHIBITED. If you are not the intended recipient, please
>>     
> contact
>   
>> the sender by email and delete all copies; your cooperation in this
>>     
> regard
>   
>> is appreciated.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>     
>
>
>
>   
> ------------------------------------------------------------------------
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31152-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 23 15:18:11 2007
Return-Path: <java-user-return-31152-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81947 invoked from network); 23 Nov 2007 15:18:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 Nov 2007 15:18:10 -0000
Received: (qmail 28963 invoked by uid 500); 23 Nov 2007 15:17:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28932 invoked by uid 500); 23 Nov 2007 15:17:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28921 invoked by uid 99); 23 Nov 2007 15:17:50 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 07:17:50 -0800
X-ASF-Spam-Status: No, hits=-3.8 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of DORONC@il.ibm.com designates 195.212.29.152 as permitted sender)
Received: from [195.212.29.152] (HELO mtagate3.de.ibm.com) (195.212.29.152)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 15:17:37 +0000
Received: from d12nrmr1607.megacenter.de.ibm.com (d12nrmr1607.megacenter.de.ibm.com [9.149.167.49])
	by mtagate3.de.ibm.com (8.13.8/8.13.8) with ESMTP id lANFHU46102096
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 15:17:30 GMT
Received: from d12av04.megacenter.de.ibm.com (d12av04.megacenter.de.ibm.com [9.149.165.229])
	by d12nrmr1607.megacenter.de.ibm.com (8.13.8/8.13.8/NCO v8.7) with ESMTP id lANFHTD32900172
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 16:17:29 +0100
Received: from d12av04.megacenter.de.ibm.com (loopback [127.0.0.1])
	by d12av04.megacenter.de.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id lANFHT7k005420
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 16:17:29 +0100
Received: from d12mc102.megacenter.de.ibm.com (d12mc102.megacenter.de.ibm.com [9.149.167.114])
	by d12av04.megacenter.de.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id lANFHSsN005410
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 16:17:28 +0100
In-Reply-To: <9CCE6F6E-5FCD-4F52-8F14-3E38EB7B2BC2@uni-ulm.de>
Subject: Re: Where to place a filter...
To: java-user@lucene.apache.org
X-Mailer: Lotus Notes Release 7.0 HF277 June 21, 2006
Message-ID: <OF17AAB820.8569FDC5-ONC225739C.0052F4B6-C225739C.00539471@il.ibm.com>
From: Doron Cohen <DORONC@il.ibm.com>
Date: Fri, 23 Nov 2007 17:12:54 +0200
X-MIMETrack: Serialize by Router on D12MC102/12/M/IBM(Release 7.0.2HF71 | November 3, 2006) at
 23/11/2007 17:17:28
MIME-Version: 1.0
Content-type: text/plain; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org

Seems your ask if to remove accents before or after stemming.
Here is a discussion on similar question (for Spanish) -

http://www.nabble.com/Snowball-and-accents-filter...--tf3653720.html#a10207399

Hope this helps,
Doron

Christian Aschoff <christian.aschoff@uni-ulm.de> wrote on 22/11/2007
21:27:20:

> Hello,
>
> as a prolog, i have no problems and everything works the way i want :-)
>
> I am more interested in a tip if i am using the right way or pattern.
> I want to strip accents before data goes into my index, so i wrote
> the code following below. I did not find an example of where to place
> a filter (for indexing) with google, so this is my guess of how to do
> it.
>
> My question is: Is this the correct pattern for the usage of a filter
> or where should it be placed?
>
> Thank you in advantage for any comments,
> Christian
...
>      private static final SnowballAnalyzer analyzer = new
> SnowballAnalyzer("German", GermanAnalyzer.GERMAN_STOP_WORDS);
...
>      public TokenStream tokenStream(String fieldName, Reader reader) {
>          return new UTF8AccentFilter(analyzer.tokenStream(fieldName,


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31153-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 23 16:37:46 2007
Return-Path: <java-user-return-31153-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15017 invoked from network); 23 Nov 2007 16:37:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 Nov 2007 16:37:46 -0000
Received: (qmail 49973 invoked by uid 500); 23 Nov 2007 16:37:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 49942 invoked by uid 500); 23 Nov 2007 16:37:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 49930 invoked by uid 99); 23 Nov 2007 16:37:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 08:37:27 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 66.249.92.170 as permitted sender)
Received: from [66.249.92.170] (HELO ug-out-1314.google.com) (66.249.92.170)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 16:37:16 +0000
Received: by ug-out-1314.google.com with SMTP id h3so563567ugf
        for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 08:37:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=Jx9NT369t3Hdln36Xrdb8hmJ46xDQlEIss2SipPhUfU=;
        b=yD1xIcyam37o3A87m6lCfwBiizvsMzwlJzFnZwQ9R84YBWRPx76fsBpLGjUqyMIH3TXCUMMUbu0iSSDEM0OElX1N6sFS2PjYfKnFlAa8rNkEZgziAxs/4rk6EAqm50ZifCCwHdJvv4HQtDjzkQ9PIbjmaUqz+7+8KepPA9zqinM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=mqcQi9Pkp3ejmczdmg2HU18sTsLnVKPj09hQzL6o91SwhVsmDQcDg351uxZtuyHNGG6ZIy5JbfzEVdu26B4w3H1WFxNPVpiLY5rcE1py0ll/jitsQ8IH+xVIv7PVq14X8nJidreQ1KxZB9DKFAYC9BlTF9NVDqtHzaa5vlidoZU=
Received: by 10.66.237.9 with SMTP id k9mr1434127ugh.1195835828451;
        Fri, 23 Nov 2007 08:37:08 -0800 (PST)
Received: from ?10.0.32.24? ( [202.125.143.67])
        by mx.google.com with ESMTPS id 25sm1010045ugn.2007.11.23.08.37.01
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 23 Nov 2007 08:37:06 -0800 (PST)
Message-ID: <4747019F.5050701@gmail.com>
Date: Fri, 23 Nov 2007 21:36:47 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Help needed
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


I m facing problem while using a small indexing example;

        IndexWriter writer =
                    new IndexWriter(indexDir, analyzer, createFlag);
            Document document  = new Document();
            document.add(Field.Text("fieldname", text));
            writer.addDocument(document);
            writer.close();



When i run that small program, this portion generates error.

*Can not find symbol:   method Text (java.lang.String, java.lang.String)
location: class org.apache.lucene.document.Field
document.add(Field.Text("fieldname", text));
*

Kindly guide me in this regard

Liaqat Ali

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31154-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 23 16:51:57 2007
Return-Path: <java-user-return-31154-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25001 invoked from network); 23 Nov 2007 16:51:57 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 Nov 2007 16:51:57 -0000
Received: (qmail 70277 invoked by uid 500); 23 Nov 2007 16:51:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 70029 invoked by uid 500); 23 Nov 2007 16:51:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 70018 invoked by uid 99); 23 Nov 2007 16:51:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 08:51:37 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of hasan.diwan@gmail.com designates 209.85.146.183 as permitted sender)
Received: from [209.85.146.183] (HELO wa-out-1112.google.com) (209.85.146.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 16:51:27 +0000
Received: by wa-out-1112.google.com with SMTP id j40so3923798wah
        for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 08:51:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=kNjj2co16Zt+oADlYsVq37fTV+zIVB7SidtRXMgcjvo=;
        b=jRCmgcCaJPKFhbSvot1dCuT/MT17Ayr7jegE+yZGDNeD54wCC8oDW26ZUja3PuxejYD+gZWBSxD1v1kZmdlr+V+p56h6rJemsPXmNEcZX9Z9Dp2elZ9JGaV9o/7qkWK6qdaIuiFEiYG7kexU51WRaQ8y4PWG7ie4Of3tswTPqBs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=gSWm0SElNmenUFkRigDly0Oa80Y/SPz4qptRCZu3kBGaHWu/D7MRomYAVE1ExR0Lf9DWhrlTV6NZcSPrs8nJgSClPXuBsu6EJohTkecQD5y8I1SqbDF916acurN/MX7Yh7VUxy9L484Pv064GAzLKydrHupSYUMV0y/gjgYs6Fc=
Received: by 10.114.67.2 with SMTP id p2mr266684waa.1195836680845;
        Fri, 23 Nov 2007 08:51:20 -0800 (PST)
Received: by 10.114.156.19 with HTTP; Fri, 23 Nov 2007 08:51:20 -0800 (PST)
Message-ID: <2cda2fc90711230851i43ea03deha815aa5c7724fc9a@mail.gmail.com>
Date: Fri, 23 Nov 2007 11:51:20 -0500
From: "Hasan Diwan" <hasan.diwan@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Help needed
In-Reply-To: <4747019F.5050701@gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <4747019F.5050701@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

On 23/11/2007, Liaqat Ali <liaqatalimian@gmail.com> wrote:
> *Can not find symbol:   method Text (java.lang.String, java.lang.String)
> location: class org.apache.lucene.document.Field
> document.add(Field.Text("fieldname", text));
> *

If you're using Lucene 2.x.x, the static methods of the Field class
have gone away. I'd use the following in your case:
document.add(new Field("fieldname", text, Field.Store.YES,
Field.Index.TOKENIZED);
to do what you wish.
-- 
Cheers,
Hasan Diwan <hasan.diwan@gmail.com>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31155-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 23 20:46:59 2007
Return-Path: <java-user-return-31155-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88272 invoked from network); 23 Nov 2007 20:46:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 Nov 2007 20:46:59 -0000
Received: (qmail 83021 invoked by uid 500); 23 Nov 2007 20:46:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82990 invoked by uid 500); 23 Nov 2007 20:46:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82979 invoked by uid 99); 23 Nov 2007 20:46:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 12:46:39 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 64.233.170.189 as permitted sender)
Received: from [64.233.170.189] (HELO rn-out-0102.google.com) (64.233.170.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 20:46:19 +0000
Received: by rn-out-0102.google.com with SMTP id v46so2260697rnb
        for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 12:46:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=GQU2ZHtGytQwTTvM27Jo27SXo9Wxu0p8PycbW+zcTIY=;
        b=dsEY+oni76UM0jLpvpA9svOt2CKgetom+wdKvJ/RC1mzTJvpH23e9NMEJRj5EuFLIN1OV+TB5MboICko6t8vlrrD7lqaxy+sxnyrYtlBVshHJObHg1/q/7lTGK+VZl5Ew4KevTlHQxHXU9Kiw7kUV/5IHYTJ9snmZQ3JAU9YY+A=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=ZT9uMR2s/ITcr9kJhcnJhscMZZ0mZH6qEE8V/BbPMKnQek0PB1QCfbZpvSbkaeY5KO72MeI2MkOktN8eHN0eMCtdTm9r3kGGa6yFjTJlAMpnWa6x4TyjYo7ENUC5NoAW3qV0a0vnd49QIb0Cez4nI0GbF+MiRzrwJmTk/FB2FdM=
Received: by 10.150.200.8 with SMTP id x8mr2033322ybf.1195850781149;
        Fri, 23 Nov 2007 12:46:21 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Fri, 23 Nov 2007 12:46:21 -0800 (PST)
Message-ID: <718789d20711231246u4d763b43id0bc339f57a80ecb@mail.gmail.com>
Date: Fri, 23 Nov 2007 17:46:21 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Sorting and TopDocCollector
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

  I am using TopDocCollector in IndexerSearher.search(...) for get the
BitSet of result, but I need of sort the result by two variable:  by
any term of document and by score. Is possible do it using Collector ?

  Have any form of use the method search(..., sort) and after get the
BitSet of result ?

  Thanks

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31156-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 23 23:23:37 2007
Return-Path: <java-user-return-31156-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25891 invoked from network); 23 Nov 2007 23:23:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 23 Nov 2007 23:23:35 -0000
Received: (qmail 90027 invoked by uid 500); 23 Nov 2007 23:23:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89990 invoked by uid 500); 23 Nov 2007 23:23:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89979 invoked by uid 99); 23 Nov 2007 23:23:16 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 15:23:16 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [65.89.232.7] (HELO thebluezone.net) (65.89.232.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 23:23:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by thebluezone.net (Postfix) with ESMTP id F2E1D286C34
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 16:22:54 -0700 (MST)
Received: from thebluezone.net ([127.0.0.1])
	by localhost (mail1 [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
	id 06074-04 for <java-user@lucene.apache.org>;
	Fri, 23 Nov 2007 16:22:53 -0700 (MST)
Received: from desktop (unknown [65.89.233.61])
	by thebluezone.net (Postfix) with ESMTP id E4942286C14
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 16:22:52 -0700 (MST)
From: "John Griffin" <jgriffin@thebluezone.net>
To: <java-user@lucene.apache.org>
Subject: Explanation
Date: Fri, 23 Nov 2007 16:22:44 -0700
Message-ID: <000c01c82e27$c02a2990$407e7cb0$@net>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_000D_01C82DED.13CB5190"
X-Mailer: Microsoft Office Outlook 12.0
thread-index: AcguJ7+ULnBN3TU9RNuOD/fVQbFM8w==
Content-Language: en-us
X-Virus-Scanned: by thebluezone.net
X-Virus-Checked: Checked by ClamAV on apache.org

------=_NextPart_000_000D_01C82DED.13CB5190
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit

Is there a problem with the term frequency count (tf) and the
IndexSearcher.explain method? I'm searching the following string (fieldname
is description) for the term 'salesman' and receive the accompanying
explanation from IndexSearcher.explain(.). I've highlighted salesman.

 

score => 0.3362463

.

any agent who fails to meet his quota of sales "leads" (i.e., potential
buyers) will lose his job. This intense ultimatum is a boon for the office
superstar (Pacino), but a once-successful salesman (Lemmon) now finds
himself clinging nervously to faded glory. Political and personal rivalries
erupt under pressure when the other agents (Alan Arkin, Ed Harris) suspect
the office manager (Kevin Spacey) of foul play. This cauldron of anxiety,
tension, and sheer desperation provides fertile soil 

.

 

0.0 = (NON-MATCH) fieldWeight(description:salesman in 4), product of:

  0.0 = tf(termFreq(description:salesman)=0)

  5.379941 = idf(docFreq=5)

  0.15625 = fieldNorm(field=description, doc=4)

 

In other queries I also get the same termFreq response of 0.

 

Here's my code:

        IndexSearcher indexSearcher =

                new IndexSearcher(".");

        TermQuery query = new TermQuery(new Term("description",
"salesman"));

 

        Hits hits = indexSearcher.search(query);

 

        int hitCount = hits.length();

        int counter = 0;

        for (Iterator iter = hits.iterator(); iter.hasNext();)

        {

            Hit hit = (Hit)iter.next();

            System.out.println("score => " + hit.getScore());

            Document doc = hit.getDocument();

            System.out.println(doc.get("description"));

            System.out.println(indexSearcher.explain(query,
counter).toString());

            counter++;

        }

 

Thanks in advance.


------=_NextPart_000_000D_01C82DED.13CB5190--


From java-user-return-31157-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 00:52:27 2007
Return-Path: <java-user-return-31157-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55598 invoked from network); 24 Nov 2007 00:52:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 00:52:27 -0000
Received: (qmail 44317 invoked by uid 500); 24 Nov 2007 00:52:08 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44281 invoked by uid 500); 24 Nov 2007 00:52:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44270 invoked by uid 99); 24 Nov 2007 00:52:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 16:52:08 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucenelist2007@danielnaber.de designates 80.67.18.16 as permitted sender)
Received: from [80.67.18.16] (HELO smtprelay04.ispgateway.de) (80.67.18.16)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 00:51:47 +0000
Received: (qmail 3412 invoked from network); 24 Nov 2007 00:51:47 -0000
Received: from unknown (HELO p54bfc053.dip.t-dialin.net) (695637@[84.191.192.83])
          (envelope-sender <lucenelist2007@danielnaber.de>)
          by smtprelay04.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 24 Nov 2007 00:51:47 -0000
From: Daniel Naber <lucenelist2007@danielnaber.de>
To: java-user@lucene.apache.org
Subject: Re: Explanation
Date: Sat, 24 Nov 2007 01:52:10 +0100
User-Agent: KMail/1.9.6 (enterprise 20070904.708012)
References: <000c01c82e27$c02a2990$407e7cb0$@net>
In-Reply-To: <000c01c82e27$c02a2990$407e7cb0$@net>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
Message-Id: <200711240152.10663@danielnaber.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Samstag, 24. November 2007, John Griffin wrote:

> =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 System.out.println(indexSearche=
r.explain(query,
> counter).toString());

I think you need to use hits.id() instead of counter.

Regards
 Daniel

=2D-=20
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31158-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 02:10:27 2007
Return-Path: <java-user-return-31158-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83116 invoked from network); 24 Nov 2007 02:10:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 02:10:25 -0000
Received: (qmail 82724 invoked by uid 500); 24 Nov 2007 02:10:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82701 invoked by uid 500); 24 Nov 2007 02:10:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82690 invoked by uid 99); 24 Nov 2007 02:10:07 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 18:10:07 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.196.101.38] (HELO web59212.mail.re1.yahoo.com) (66.196.101.38)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 24 Nov 2007 02:09:47 +0000
Received: (qmail 29287 invoked by uid 60001); 24 Nov 2007 02:09:49 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=tkna85BKyR/pBzubaN9SpzTxWV8cKeQhXfoxvWhoWbA+mePXBAi+UXwIhTPc753VM/WWTZOc9pLNSAgnkE4pQrmJCfWSVrHXUFmn/IRt91VEJULcHCsZoqpCg+8Uq6zzpz3hkIWonXrgvHLH20SreWgLQhEpNRxRXJTxFjpGxwg=;
X-YMail-OSG: a3_tM8wVM1n_cCH8hXgcqIuixia9FT3g_X71K3pdAP0wMmLB41RDTkG9ZLYhcv6unRIvGnTNWGHAwH3IMzkeNU2mgoNVc07trk19OV4H1t2kOAYDfA--
Received: from [72.231.21.213] by web59212.mail.re1.yahoo.com via HTTP; Fri, 23 Nov 2007 18:09:49 PST
Date: Fri, 23 Nov 2007 18:09:49 -0800 (PST)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Help on FuzzyLikeThisQuery 
To: java-user@lucene.apache.org
In-Reply-To: <000c01c82e27$c02a2990$407e7cb0$@net>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-161874044-1195870189=:26212"
Content-Transfer-Encoding: 8bit
Message-ID: <20767.26212.qm@web59212.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-161874044-1195870189=:26212
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Hello,
          I am trying to use FuzzyLikeThisQuery to search my help system  and  show set of help entries for user selected Help topic. For any selected Help topic, System needs to display all related topics. This works somehow, but if query contains generic terms then result returned by FuzzyLikeThisQuery contains all irrelevant topics. E.g. 
  if query is "product blog update" then I am getting results like
   
  fuzzyLikeQuery.addTerms("product blog update", "title", 0.75f, FuzzyQuery.defaultPrefixLength);
   
  --Slide Show Update - Full Control Panel
  --Product manager: sent a mail to xyz@hy.com
   
  I would expect at least terms like "product" and "blog" should appear in the result. 
  Is there anyway I can specify which terms are "MUST", I mean they have to appear in the result and some terms are optional, I mean they need not appear in the result. 
   
  Previously, I was using PhraseQuery, but it looks for an exact match. 
  I would appreciate your suggestion?
   
  - BR
   

       
---------------------------------
Get easy, one-click access to your favorites.  Make Yahoo! your homepage.
--0-161874044-1195870189=:26212--

From java-user-return-31159-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 03:10:50 2007
Return-Path: <java-user-return-31159-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94446 invoked from network); 24 Nov 2007 03:10:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 03:10:50 -0000
Received: (qmail 3311 invoked by uid 500); 24 Nov 2007 03:10:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 3281 invoked by uid 500); 24 Nov 2007 03:10:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 3270 invoked by uid 99); 24 Nov 2007 03:10:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Nov 2007 19:10:32 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [65.89.232.7] (HELO thebluezone.net) (65.89.232.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 03:10:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by thebluezone.net (Postfix) with ESMTP id 33806286C0B
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 20:10:13 -0700 (MST)
Received: from thebluezone.net ([127.0.0.1])
	by localhost (mail1 [127.0.0.1]) (amavisd-new, port 10024) with ESMTP
	id 09968-06 for <java-user@lucene.apache.org>;
	Fri, 23 Nov 2007 20:10:11 -0700 (MST)
Received: from desktop (unknown [65.89.233.61])
	by thebluezone.net (Postfix) with ESMTP id 32A47286C0C
	for <java-user@lucene.apache.org>; Fri, 23 Nov 2007 20:10:11 -0700 (MST)
From: "John Griffin" <jgriffin@thebluezone.net>
To: <java-user@lucene.apache.org>
References: <000c01c82e27$c02a2990$407e7cb0$@net> <200711240152.10663@danielnaber.de>
In-Reply-To: <200711240152.10663@danielnaber.de>
Subject: RE: Explanation
Date: Fri, 23 Nov 2007 20:10:02 -0700
Message-ID: <000001c82e47$818f0a50$84ad1ef0$@net>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AcguNFY7RweC9KLyTLaDwlfFoaYTrQAEwjsw
Content-Language: en-us
X-Virus-Scanned: by thebluezone.net
X-Virus-Checked: Checked by ClamAV on apache.org

Oh, duh! Of course it is. I've done that before.
Thanks Daniel.

John G.

-----Original Message-----
From: Daniel Naber [mailto:lucenelist2007@danielnaber.de] 
Sent: Friday, November 23, 2007 5:52 PM
To: java-user@lucene.apache.org
Subject: Re: Explanation

On Samstag, 24. November 2007, John Griffin wrote:

>             System.out.println(indexSearcher.explain(query,
> counter).toString());

I think you need to use hits.id() instead of counter.

Regards
 Daniel

-- 
http://www.danielnaber.de

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31160-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 08:27:00 2007
Return-Path: <java-user-return-31160-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31769 invoked from network); 24 Nov 2007 08:27:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 08:27:00 -0000
Received: (qmail 99671 invoked by uid 500); 24 Nov 2007 08:26:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99635 invoked by uid 500); 24 Nov 2007 08:26:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99624 invoked by uid 99); 24 Nov 2007 08:26:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 00:26:41 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 08:26:20 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IvqLG-0004Xy-1i
	for java-user@lucene.apache.org; Sat, 24 Nov 2007 00:26:22 -0800
Message-ID: <13923009.post@talk.nabble.com>
Date: Sat, 24 Nov 2007 00:26:21 -0800 (PST)
From: Rapthor <rapthor@lycos.de>
To: java-user@lucene.apache.org
Subject: Re: AND query in SHOULD
In-Reply-To: <786fde50711220627qe6765afj961bfda5d2368b@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: rapthor@lycos.de
References: <13894829.post@talk.nabble.com> <13895700.post@talk.nabble.com> <359a92830711220526u4bd0491cra131da13d3eb31e4@mail.gmail.com> <786fde50711220627qe6765afj961bfda5d2368b@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Thanks for this example. I am uncertain about one detail: How do I achieve a
search for multiple keywords. Not just "green tree" but also "short road",
"sky", "bird"? Is there a chance to add those keywords to the "Query q =
qp.parse("\"green tree\"");" command?


Shai Erera wrote:
> 
> How about using MultiFieldQueryParser. Here is a short main I wrote:
> 
>         Directory dir = new RAMDirectory();
>         Analyzer analyzer = new StandardAnalyzer();
>         IndexWriter writer = new IndexWriter(dir, analyzer);
>         Document doc = new Document();
>         doc.add(new Field("field1", "green tree", Store.NO,
> Index.TOKENIZED
> ));
>         writer.addDocument(doc);
>         doc = new Document();
>         doc.add(new Field("field2", "green tree", Store.NO,
> Index.TOKENIZED
> ));
>         writer.addDocument(doc);
>         writer.close();
> 
>         IndexSearcher searcher = new IndexSearcher(dir);
>         MultiFieldQueryParser qp = new MultiFieldQueryParser(new String[]
> {
> "field1", "field2" }, analyzer);
>         Query q = qp.parse("\"green tree\"");
>         if (q instanceof BooleanQuery /* Basically this should almost
> always
> be true */) {
>             BooleanClause[] clauses = ((BooleanQuery) q).getClauses();
>             for (int i = 0; i < clauses.length; i++) {
>                 clauses[i].setOccur(Occur.SHOULD); /* This is their
> setting
> by default though */
>             }
>         }
>         Hits hits = searcher.search(q);
>         System.out.println(hits.length()); /* Should print 2. */
>         searcher.close();
> 
> 
> On Nov 22, 2007 3:26 PM, Erick Erickson <erickerickson@gmail.com> wrote:
> 
>> The semantics of the phrase query you're constructing probably aren't
>> what you think. As best I can infer, you are trying to do something
>> like
>>
>> "green tree" in field1
>> or
>> "green tree" in field 2
>>
>> but that's not even close to what you're constructing.
>>
>> It would help a show what the query you want is in some form
>> like that above before trying to code it, because the actual
>> query you're making is something like asking for the phrase
>> "word1 in field1 word1 in field2 word2 in field1 word2 in field2"
>>
>> Actually, I can't render the semantics of what you're doing int English.
>> And Lucene can't parse it either.
>>
>> I suspect you want something like
>> PhraseQuery pq1
>> PhraseQuery pq2
>> for (String word : words) {
>>   pq1.add(...);
>>   pq2.add(...)
>> }
>> BooleanQuery bq().
>> bq.add(p1, ....  SHOULD);
>> bq.add(p2, ... SHOULD);
>>
>> Index.search(bq);
>>
>> Best
>> Erick
>>
>> On Nov 22, 2007 7:17 AM, Rapthor <rapthor@lycos.de> wrote:
>>
>> >
>> > There is no option to provide an Occur.SHOULD to the PhraseQuery. So
>> where
>> > does it go? I changed the source to look like this:
>> >
>> > PhraseQuery pq = new PhraseQuery();
>> > for (String word : words) {
>> >        for (String field : fields) {
>> >                pq.add(new Term(field, word));
>> >        }
>> > }
>> > Hits hits = indexSearcher.search(pq);
>> >
>> > However, I get an exception:
>> > java.lang.IllegalArgumentException: All phrase terms must be in the
>> same
>> > field: description:green tree
>> >
>> > I don't understand how to a) search for combinations of words like
>> "green
>> > tree", b) search in multiple fields (description, text, ...) and c)
>> search
>> > by a SHOULD restriction.
>> > --
>> > View this message in context:
>> > http://www.nabble.com/AND-query-in-SHOULD-tf4855719.html#a13895700
>> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>> >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
> 
> 
> 
> -- 
> Regards,
> 
> Shai Erera
> 
> 

-- 
View this message in context: http://www.nabble.com/AND-query-in-SHOULD-tf4855719.html#a13923009
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31161-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 09:46:06 2007
Return-Path: <java-user-return-31161-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41075 invoked from network); 24 Nov 2007 09:46:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 09:46:06 -0000
Received: (qmail 22455 invoked by uid 500); 24 Nov 2007 09:45:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22417 invoked by uid 500); 24 Nov 2007 09:45:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22406 invoked by uid 99); 24 Nov 2007 09:45:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 01:45:47 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [217.12.11.63] (HELO smtp009.mail.ukl.yahoo.com) (217.12.11.63)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 24 Nov 2007 09:45:27 +0000
Received: (qmail 87165 invoked from network); 24 Nov 2007 09:45:28 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-YMail-OSG:Message-ID:Date:From:User-Agent:MIME-Version:To:Subject:References:In-Reply-To:Content-Type:Content-Transfer-Encoding;
  b=AV7Gzb0vWuv1p/ZCPNjrk27PDptXAxhHeygkexup/jNx7Dh9ynPaq4eNWHHLBKgXcV86gODcUXfslDmxlSjZFwaJGNpic9pyPC9oWB3GUxEizsMOw+GAyrMhqELmHSiH/ZYtvgKO0+L4n1jRraJrhx0q0jZH9+nBosjTzyv990g=  ;
Received: from unknown (HELO ?127.0.0.1?) (markharw00d@194.106.34.5 with plain)
  by smtp009.mail.ukl.yahoo.com with SMTP; 24 Nov 2007 09:45:28 -0000
X-YMail-OSG: oBlNLTkVM1nHI_PBmBX2WT9EVdAta86bymLtpuKTLJ9TLTY36F.k1z_kgIX.s0xlA.6nWG0N2Q--
Message-ID: <4747F2B1.9000301@yahoo.co.uk>
Date: Sat, 24 Nov 2007 09:45:21 +0000
From: markharw00d <markharw00d@yahoo.co.uk>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Help on FuzzyLikeThisQuery
References: <20767.26212.qm@web59212.mail.re1.yahoo.com>
In-Reply-To: <20767.26212.qm@web59212.mail.re1.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Cool Coder wrote:
 >> Is there anyway I can specify which terms are "MUST", I mean they 
have to appear in the result and some terms are optional,

One "hands off" approach you could try with this is to rewrite the 
fuzzyQuery and then set the minimum number of terms you want a match on. 
e.g.

        FuzzyLikeThisQuery flt=new FuzzyLikeThisQuery(50,new 
StandardAnalyzer());
        flt.addTerms("product critical update", "title", 0.75f, 
FuzzyQuery.defaultPrefixLength);
        BooleanQuery q = (BooleanQuery) flt.rewrite(r);
        int minNumClauseMatches=Math.round(q.clauses().size()*0.5f);
        q.setMinimumNumberShouldMatch(minNumClauseMatches);

In the above code I'm specifying at least half of the input terms must 
have a match.

If a user wants more control then they really need to be more "hands on" 
and specify precisely which of these words are important to them in the 
actual query syntax.

Cheers
Mark

> Hello,
>           I am trying to use FuzzyLikeThisQuery to search my help system  and  show set of help entries for user selected Help topic. For any selected Help topic, System needs to display all related topics. This works somehow, but if query contains generic terms then result returned by FuzzyLikeThisQuery contains all irrelevant topics. E.g. 
>   if query is "product blog update" then I am getting results like
>    
>   fuzzyLikeQuery.addTerms("product blog update", "title", 0.75f, FuzzyQuery.defaultPrefixLength);
>    
>   --Slide Show Update - Full Control Panel
>   --Product manager: sent a mail to xyz@hy.com
>    
>   I would expect at least terms like "product" and "blog" should appear in the result. 
>   Is there anyway I can specify which terms are "MUST", I mean they have to appear in the result and some terms are optional, I mean they need not appear in the result. 
>    
>   Previously, I was using PhraseQuery, but it looks for an exact match. 
>   I would appreciate your suggestion?
>    
>   - BR
>    
>
>        
> ---------------------------------
> Get easy, one-click access to your favorites.  Make Yahoo! your homepage.
>   



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31162-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 15:13:39 2007
Return-Path: <java-user-return-31162-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86459 invoked from network); 24 Nov 2007 15:13:39 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 15:13:39 -0000
Received: (qmail 33787 invoked by uid 500); 24 Nov 2007 15:13:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33745 invoked by uid 500); 24 Nov 2007 15:13:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33734 invoked by uid 99); 24 Nov 2007 15:13:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 07:13:20 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 64.233.166.178 as permitted sender)
Received: from [64.233.166.178] (HELO py-out-1112.google.com) (64.233.166.178)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 15:12:58 +0000
Received: by py-out-1112.google.com with SMTP id d32so414754pye
        for <java-user@lucene.apache.org>; Sat, 24 Nov 2007 07:13:00 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=ojS0FpCGYoCSFsJ9hW5Vk5DT371QL9rawpyg8OuzWo8=;
        b=m8530YgOfaRWWX0yNslrEf5AUZg7nyfXx+W60O5ZQGI/L/r57DLjUTeVNadX/OwzNKCjp4taTm0fxOF4Nfq4ydU9DehbRcCg/ks8VXe4kiNFDTH6k/8DHKVFNnVUkutp5StE6mUc9a5sUvuqwHTPD8Mj/7civ+mM+3N6sS4ahcg=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=VUXjIfSsyQfCl3/aubNpEX5rQRIpvj9KWj2aa1j4R5zToG756AqEEe8F1ItzCRlWEM8X0E9G614gWODuK9Wb7VaSnS4ezSu2UR76lAFilqKNMuPye+D+aCkBG7EVmE0Jt81gtuS0UCkJYomERUha8VHIrHq/pPkpJjH/LhZmW0Y=
Received: by 10.65.43.5 with SMTP id v5mr1176544qbj.1195917179864;
        Sat, 24 Nov 2007 07:12:59 -0800 (PST)
Received: by 10.64.181.13 with HTTP; Sat, 24 Nov 2007 07:12:59 -0800 (PST)
Message-ID: <786fde50711240712p55c13df1se5198cb30519e122@mail.gmail.com>
Date: Sat, 24 Nov 2007 17:12:59 +0200
From: "Shai Erera" <serera@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: AND query in SHOULD
In-Reply-To: <13923009.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_27372_5685813.1195917179813"
References: <13894829.post@talk.nabble.com> <13895700.post@talk.nabble.com>
	 <359a92830711220526u4bd0491cra131da13d3eb31e4@mail.gmail.com>
	 <786fde50711220627qe6765afj961bfda5d2368b@mail.gmail.com>
	 <13923009.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_27372_5685813.1195917179813
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi

Not sure I understand the question. You can add as many keywords as you want
to the query (like \"green tree\" \"short road\" sky bird) and it should
behave the same (i.e., search in each field.

Shai

On Nov 24, 2007 10:26 AM, Rapthor <rapthor@lycos.de> wrote:

>
> Thanks for this example. I am uncertain about one detail: How do I achieve
> a
> search for multiple keywords. Not just "green tree" but also "short road",
> "sky", "bird"? Is there a chance to add those keywords to the "Query q =
> qp.parse("\"green tree\"");" command?
>
>
> Shai Erera wrote:
> >
> > How about using MultiFieldQueryParser. Here is a short main I wrote:
> >
> >         Directory dir = new RAMDirectory();
> >         Analyzer analyzer = new StandardAnalyzer();
> >         IndexWriter writer = new IndexWriter(dir, analyzer);
> >         Document doc = new Document();
> >         doc.add(new Field("field1", "green tree", Store.NO,
> > Index.TOKENIZED
> > ));
> >         writer.addDocument(doc);
> >         doc = new Document();
> >         doc.add(new Field("field2", "green tree", Store.NO,
> > Index.TOKENIZED
> > ));
> >         writer.addDocument(doc);
> >         writer.close();
> >
> >         IndexSearcher searcher = new IndexSearcher(dir);
> >         MultiFieldQueryParser qp = new MultiFieldQueryParser(new
> String[]
> > {
> > "field1", "field2" }, analyzer);
> >         Query q = qp.parse("\"green tree\"");
> >         if (q instanceof BooleanQuery /* Basically this should almost
> > always
> > be true */) {
> >             BooleanClause[] clauses = ((BooleanQuery) q).getClauses();
> >             for (int i = 0; i < clauses.length; i++) {
> >                 clauses[i].setOccur(Occur.SHOULD); /* This is their
> > setting
> > by default though */
> >             }
> >         }
> >         Hits hits = searcher.search(q);
> >         System.out.println(hits.length()); /* Should print 2. */
> >         searcher.close();
> >
> >
> > On Nov 22, 2007 3:26 PM, Erick Erickson <erickerickson@gmail.com> wrote:
> >
> >> The semantics of the phrase query you're constructing probably aren't
> >> what you think. As best I can infer, you are trying to do something
> >> like
> >>
> >> "green tree" in field1
> >> or
> >> "green tree" in field 2
> >>
> >> but that's not even close to what you're constructing.
> >>
> >> It would help a show what the query you want is in some form
> >> like that above before trying to code it, because the actual
> >> query you're making is something like asking for the phrase
> >> "word1 in field1 word1 in field2 word2 in field1 word2 in field2"
> >>
> >> Actually, I can't render the semantics of what you're doing int
> English.
> >> And Lucene can't parse it either.
> >>
> >> I suspect you want something like
> >> PhraseQuery pq1
> >> PhraseQuery pq2
> >> for (String word : words) {
> >>   pq1.add(...);
> >>   pq2.add(...)
> >> }
> >> BooleanQuery bq().
> >> bq.add(p1, ....  SHOULD);
> >> bq.add(p2, ... SHOULD);
> >>
> >> Index.search(bq);
> >>
> >> Best
> >> Erick
> >>
> >> On Nov 22, 2007 7:17 AM, Rapthor <rapthor@lycos.de> wrote:
> >>
> >> >
> >> > There is no option to provide an Occur.SHOULD to the PhraseQuery. So
> >> where
> >> > does it go? I changed the source to look like this:
> >> >
> >> > PhraseQuery pq = new PhraseQuery();
> >> > for (String word : words) {
> >> >        for (String field : fields) {
> >> >                pq.add(new Term(field, word));
> >> >        }
> >> > }
> >> > Hits hits = indexSearcher.search(pq);
> >> >
> >> > However, I get an exception:
> >> > java.lang.IllegalArgumentException: All phrase terms must be in the
> >> same
> >> > field: description:green tree
> >> >
> >> > I don't understand how to a) search for combinations of words like
> >> "green
> >> > tree", b) search in multiple fields (description, text, ...) and c)
> >> search
> >> > by a SHOULD restriction.
> >> > --
> >> > View this message in context:
> >> > http://www.nabble.com/AND-query-in-SHOULD-tf4855719.html#a13895700
> >> > Sent from the Lucene - Java Users mailing list archive at Nabble.com.
> >> >
> >> >
> >> > ---------------------------------------------------------------------
> >> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> >> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >> >
> >> >
> >>
> >
> >
> >
> > --
> > Regards,
> >
> > Shai Erera
> >
> >
>
> --
> View this message in context:
> http://www.nabble.com/AND-query-in-SHOULD-tf4855719.html#a13923009
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Regards,

Shai Erera

------=_Part_27372_5685813.1195917179813--

From java-user-return-31163-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 15:26:52 2007
Return-Path: <java-user-return-31163-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87808 invoked from network); 24 Nov 2007 15:26:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 15:26:52 -0000
Received: (qmail 41566 invoked by uid 500); 24 Nov 2007 15:26:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41535 invoked by uid 500); 24 Nov 2007 15:26:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41524 invoked by uid 99); 24 Nov 2007 15:26:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 07:26:35 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 66.249.82.229 as permitted sender)
Received: from [66.249.82.229] (HELO wx-out-0506.google.com) (66.249.82.229)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 15:26:16 +0000
Received: by wx-out-0506.google.com with SMTP id i28so130460wxd
        for <java-user@lucene.apache.org>; Sat, 24 Nov 2007 07:26:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=luIhg3dZE97qnLZY7Kko4sNthj+qMSyIOhLyykQuXKA=;
        b=K1TD/JMUWOiUwroG+B7nJna4KMdDExtb2AyWILsNW1nZOznio9TyZT85GYSD8l3c/Kk6gEKxUCE8ohrmFJZrtT7G9aQdgz+jAQd8Yevu51Qt7lyx8WjxJUePJMYcrfJ/IbL0be8u3n2jVHTWwroEuEUW104Djk4SXeEPpNcndXU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=KFmRgGiHAGJj+IQvZ/Ra/imY3woTBTXx5WY/J1JvcWTHcVG1h0wnGXElUubmyvptR4xGcul1yWqLcDmOzz7XSTrx8YgDAmjs3UVwySu9OlGpUWEogYWaWQfnjOHKmvMAvm+uBqYw9fszgr/qJk13LF1ayaXmsPqKbqvrVuCXAOw=
Received: by 10.150.135.2 with SMTP id i2mr30996ybd.1195917978799;
        Sat, 24 Nov 2007 07:26:18 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Sat, 24 Nov 2007 07:26:18 -0800 (PST)
Message-ID: <718789d20711240726r7eaf4a60s77c5e71ecde63619@mail.gmail.com>
Date: Sat, 24 Nov 2007 12:26:18 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Index: mixing the structure of persistence
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

  I have a question ?

  Lucene offers a mixing structure of storage of index, that is, first
do search in memoria (ARMDirectory) and in case of not found do search
in index file automatically ? For example: Load part of index in
memory for do the search fastest.

  Thnaks

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31164-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 16:36:36 2007
Return-Path: <java-user-return-31164-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98251 invoked from network); 24 Nov 2007 16:36:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 16:36:36 -0000
Received: (qmail 80691 invoked by uid 500); 24 Nov 2007 16:36:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80656 invoked by uid 500); 24 Nov 2007 16:36:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80645 invoked by uid 99); 24 Nov 2007 16:36:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 08:36:19 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucene@nitwit.de designates 80.67.29.23 as permitted sender)
Received: from [80.67.29.23] (HELO smtprelay09.ispgateway.de) (80.67.29.23)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 16:35:58 +0000
Received: (qmail 25230 invoked from network); 24 Nov 2007 16:35:57 -0000
Received: from unknown (HELO server.localdomain) ([pbs]153383@[85.178.227.164])
          (envelope-sender <lucene@nitwit.de>)
          by smtprelay09.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 24 Nov 2007 16:35:57 -0000
Received: from localhost (localhost [127.0.0.1])
	by server.localdomain (Postfix) with ESMTP id 11BF5214790
	for <java-user@lucene.apache.org>; Sat, 24 Nov 2007 17:36:35 +0100 (CET)
From: Timo Nentwig <lucene@nitwit.de>
To: java-user@lucene.apache.org
Subject: Why exactly are fuzzy queries so slow?
Date: Sat, 24 Nov 2007 17:36:34 +0100
User-Agent: KMail/1.9.7
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711241736.34876.lucene@nitwit.de>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi!

I search an 1.5 gig index and fuzzy queries are really slow; something like 
avg. ~500ms (IndexSearcher.search(Query, HitCollector)). 

When performing exact queries I archieve response times <25ms. What is it that 
makes fuzzy queries so slow? Increased index access due to more terms, i.e. 
disk IO?

And no, my fuzzy queries (fuzzy factor 0.8) don't blow up to a boolean query 
with 100s clauses but maybe something...less than 10.

Thanks
Timo

P.S. arent' there any "best practices" for lucene? Does everybody have to find 
out on his own (over and over again) and spend a lot of time reading and 
understanding lucene's code base?

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31165-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 17:48:56 2007
Return-Path: <java-user-return-31165-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9923 invoked from network); 24 Nov 2007 17:48:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 17:48:56 -0000
Received: (qmail 20731 invoked by uid 500); 24 Nov 2007 17:48:39 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20687 invoked by uid 500); 24 Nov 2007 17:48:39 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20676 invoked by uid 99); 24 Nov 2007 17:48:39 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 09:48:39 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.27.42.28] (HELO smtp2-g19.free.fr) (212.27.42.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 17:48:19 +0000
Received: from smtp2-g19.free.fr (localhost.localdomain [127.0.0.1])
	by smtp2-g19.free.fr (Postfix) with ESMTP id 9914112B704
	for <java-user@lucene.apache.org>; Sat, 24 Nov 2007 18:48:19 +0100 (CET)
Received: from [192.168.2.152] (dau94-4-82-227-122-98.fbx.proxad.net [82.227.122.98])
	by smtp2-g19.free.fr (Postfix) with ESMTP id 4E1DE12B700
	for <java-user@lucene.apache.org>; Sat, 24 Nov 2007 18:48:19 +0100 (CET)
Message-Id: <F2377918-4642-474C-92FD-EA06A55CA0A7@garambrogne.net>
From: Mathieu Lecarme <mathieu@garambrogne.net>
To: java-user@lucene.apache.org
In-Reply-To: <200711241736.34876.lucene@nitwit.de>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Why exactly are fuzzy queries so slow?
Date: Sat, 24 Nov 2007 18:48:18 +0100
References: <200711241736.34876.lucene@nitwit.de>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

fuzzy are simply not indexed.
If you wont to search quickly with fuzzy search, you should index word =20=

and their ngrams, it's the "do you mean" pattern.

you first select used word wich share ngram with the query word, the =20
distance is computed with levenstein, and you use this word as a =20
synonym.

M.

Le 24 nov. 07 =E0 17:36, Timo Nentwig a =E9crit :

> Hi!
>
> I search an 1.5 gig index and fuzzy queries are really slow; =20
> something like
> avg. ~500ms (IndexSearcher.search(Query, HitCollector)).
>
> When performing exact queries I archieve response times <25ms. What =20=

> is it that
> makes fuzzy queries so slow? Increased index access due to more =20
> terms, i.e.
> disk IO?
>
> And no, my fuzzy queries (fuzzy factor 0.8) don't blow up to a =20
> boolean query
> with 100s clauses but maybe something...less than 10.
>
> Thanks
> Timo
>
> P.S. arent' there any "best practices" for lucene? Does everybody =20
> have to find
> out on his own (over and over again) and spend a lot of time reading =20=

> and
> understanding lucene's code base?
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31166-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 18:34:11 2007
Return-Path: <java-user-return-31166-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 23386 invoked from network); 24 Nov 2007 18:34:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 18:34:10 -0000
Received: (qmail 52228 invoked by uid 500); 24 Nov 2007 18:33:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52191 invoked by uid 500); 24 Nov 2007 18:33:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52180 invoked by uid 99); 24 Nov 2007 18:33:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 10:33:52 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of liaqatalimian@gmail.com designates 66.249.82.231 as permitted sender)
Received: from [66.249.82.231] (HELO wx-out-0506.google.com) (66.249.82.231)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 18:33:56 +0000
Received: by wx-out-0506.google.com with SMTP id i28so163295wxd
        for <java-user@lucene.apache.org>; Sat, 24 Nov 2007 10:33:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=u9cP1CpHz3jDbew3jCW8VJJWJoYdVZBvyV+lte8wRVc=;
        b=abHab1bQ/X9f3dU7q1ut2zcnFfiZ4/JsAi+3gWrLVefTNT0Oy/T8lVcf8opF0axQLOFHLmNiH6mJSwbAmUHe8zg0FlYFwpxPXRufK4Wr+zxgsRhcSRoGGGh2Ix6USLRJBoNvgR0zbwDtLg9t2RliKZlPPh7LMifDiMbqH5D+ggY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=drvAYXXN3JX4sjqxz57l/xYyoksGaNKcKmuERktHNNVF+TbbREFpkB08ts8AjI+o69G57rr+/Ruvd/LIFSzaMAGQTZUSE5bYA+ceO0Kt4gR+DRG6+/RGeMKehB4oLAWFes7W/oye7abj0nvaxXOy5zm7RBxbHLvypQt7QbZ72y8=
Received: by 10.151.13.7 with SMTP id q7mr90737ybi.1195927681932;
        Sat, 24 Nov 2007 10:08:01 -0800 (PST)
Received: by 10.35.38.10 with HTTP; Sat, 24 Nov 2007 10:08:01 -0800 (PST)
Message-ID: <afb14f380711241008id02a71cpbf27d3fdb260ecc8@mail.gmail.com>
Date: Sat, 24 Nov 2007 23:08:01 +0500
From: "Liaqat Ali" <liaqatalimian@gmail.com>
To: java-user@lucene.apache.org
Subject: Problem with indexing
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Hi All,

I have one question. I have a small demonstration program in Java to
index a single fine stored on the disk. When i index a file with .txt
extension containing  English  text  and then use LUKE  to retrieve
information from Index it retrieves a little bit data. But the problem
occurs when I index a file with .txt extension containing URDU
(variant of Arabic and Persian) stored in UTF-8. the index which i get
containing fieldnames and text in Unicode codes not the original text,
as compared to the the Index of file containing English language.

What should you suggest in this situation. Kindly guide me in this regard..

Liaqat Ali

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31167-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 19:20:57 2007
Return-Path: <java-user-return-31167-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29732 invoked from network); 24 Nov 2007 19:20:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 19:20:56 -0000
Received: (qmail 71965 invoked by uid 500); 24 Nov 2007 19:20:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71924 invoked by uid 500); 24 Nov 2007 19:20:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71913 invoked by uid 99); 24 Nov 2007 19:20:38 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 11:20:38 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.196.101.28] (HELO web59202.mail.re1.yahoo.com) (66.196.101.28)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 24 Nov 2007 19:20:16 +0000
Received: (qmail 28146 invoked by uid 60001); 24 Nov 2007 19:20:18 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=Le2GEEKTq3G1E901Qswg3K/MBlEv+HK4DtOtVF0eQHeFho/YALBIZquJQnZyYprkMABw4ywvlUw4W5aRZ/tu1nzAFa0WN59ELWGrHP+vfAsDjYurz750YuBOFnyDSc46C1wBMOHj7ot6yiF2XQjFkwsXCvt+G+rWmdNopRP9UCQ=;
X-YMail-OSG: nSppIEUVM1nee467xeaiQUcd3X3bdSJArNqlVun7RoB8MuR6p3Udk2YQK0E74tpkK2i_55IJkCyEKt5lg03QMYMfQLfaMiMXbNNcLAshDiNBpIu0pm33LQ--
Received: from [72.231.21.213] by web59202.mail.re1.yahoo.com via HTTP; Sat, 24 Nov 2007 11:20:17 PST
Date: Sat, 24 Nov 2007 11:20:17 -0800 (PST)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Re: Help on FuzzyLikeThisQuery
To: java-user@lucene.apache.org
In-Reply-To: <4747F2B1.9000301@yahoo.co.uk>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-913369488-1195932017=:27594"
Content-Transfer-Encoding: 8bit
Message-ID: <267540.27594.qm@web59202.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-913369488-1195932017=:27594
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Now I can see lot improvement on my "related" help search result. Let me tell you that I have a non-token list which removes all irrelevant tokens from selected help topic. So after filtering all non tokens from the selected help topic, I search help system and show all results. But I am somehow not confident on non-token list, and I feel it can be improved or maybe I am looking for some sort of Human readable kind of tokenizer that can generate equivalent query. Needless to mention here that I am taking help of SANDBOX/wordnet to generated all synonym queries for User selected help topic. SO my system works something
   
  - Remove all non-tokens from User selected help topic using non-token list
  - Generate synonym queries using Lucene Sandbox/wordnet API
  - Search Help system using FuzzyLikeThisQuery.
  - Combine all results by using lucene ranking
  - Show only first 10 results to Users
   
  As I have mentioned this works fine but does not work as expected for generic topics.
   
  Somebody suggested me to user JAMA(http://math.nist.gov/javanumerics/jama/) with Lucene. But I am not sure whether I can afford resources for R&D on Jama and use it with Lucene. Rather I would definitely be satisfied with your suggested query and keep improving non-token list filter.
   
  Also I would appreciate your suggestion.
   
  - RB
markharw00d <markharw00d@yahoo.co.uk> wrote:
  Cool Coder wrote:
>> Is there anyway I can specify which terms are "MUST", I mean they 
have to appear in the result and some terms are optional,

One "hands off" approach you could try with this is to rewrite the 
fuzzyQuery and then set the minimum number of terms you want a match on. 
e.g.

FuzzyLikeThisQuery flt=new FuzzyLikeThisQuery(50,new 
StandardAnalyzer());
flt.addTerms("product critical update", "title", 0.75f, 
FuzzyQuery.defaultPrefixLength);
BooleanQuery q = (BooleanQuery) flt.rewrite(r);
int minNumClauseMatches=Math.round(q.clauses().size()*0.5f);
q.setMinimumNumberShouldMatch(minNumClauseMatches);

In the above code I'm specifying at least half of the input terms must 
have a match.

If a user wants more control then they really need to be more "hands on" 
and specify precisely which of these words are important to them in the 
actual query syntax.

Cheers
Mark

> Hello,
> I am trying to use FuzzyLikeThisQuery to search my help system and show set of help entries for user selected Help topic. For any selected Help topic, System needs to display all related topics. This works somehow, but if query contains generic terms then result returned by FuzzyLikeThisQuery contains all irrelevant topics. E.g. 
> if query is "product blog update" then I am getting results like
> 
> fuzzyLikeQuery.addTerms("product blog update", "title", 0.75f, FuzzyQuery.defaultPrefixLength);
> 
> --Slide Show Update - Full Control Panel
> --Product manager: sent a mail to xyz@hy.com
> 
> I would expect at least terms like "product" and "blog" should appear in the result. 
> Is there anyway I can specify which terms are "MUST", I mean they have to appear in the result and some terms are optional, I mean they need not appear in the result. 
> 
> Previously, I was using PhraseQuery, but it looks for an exact match. 
> I would appreciate your suggestion?
> 
> - BR
> 
>
> 
> ---------------------------------
> Get easy, one-click access to your favorites. Make Yahoo! your homepage.
> 



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



       
---------------------------------
Never miss a thing.   Make Yahoo your homepage.
--0-913369488-1195932017=:27594--

From java-user-return-31168-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sat Nov 24 19:47:00 2007
Return-Path: <java-user-return-31168-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33367 invoked from network); 24 Nov 2007 19:47:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 24 Nov 2007 19:47:00 -0000
Received: (qmail 89575 invoked by uid 500); 24 Nov 2007 19:46:42 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89269 invoked by uid 500); 24 Nov 2007 19:46:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89258 invoked by uid 99); 24 Nov 2007 19:46:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 11:46:41 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [217.12.11.79] (HELO smtp010.mail.ukl.yahoo.com) (217.12.11.79)
    by apache.org (qpsmtpd/0.29) with SMTP; Sat, 24 Nov 2007 19:46:44 +0000
Received: (qmail 97751 invoked from network); 24 Nov 2007 17:28:52 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-YMail-OSG:Message-ID:Date:From:User-Agent:MIME-Version:To:Subject:References:In-Reply-To:Content-Type:Content-Transfer-Encoding;
  b=runUDABp1OEI2kLlzCNGkfyXVOV7KHdCNPOwDV+vTM5C/EKTxFHjbZLp2xnl7pcR88Fb1OMQCa8LtHiexCp2yU3NwuouuPaFO5d2O4CAz3/yUo4DRfMjUvtyHXtufVUXtwjjHDZK+PQWZCm1YPaQRYIK86ATMZm78Gm5Tc5ERdk=  ;
Received: from unknown (HELO ?127.0.0.1?) (markharw00d@194.106.34.5 with plain)
  by smtp010.mail.ukl.yahoo.com with SMTP; 24 Nov 2007 17:28:52 -0000
X-YMail-OSG: BepVRykVM1mUwy0RrnLFbS0jfEgV6pKQPeF9Di5sQGXOk20b457n3hyhjy1iR4af4pxrfDb7Ag--
Message-ID: <47485F50.3090209@yahoo.co.uk>
Date: Sat, 24 Nov 2007 17:28:48 +0000
From: markharw00d <markharw00d@yahoo.co.uk>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Why exactly are fuzzy queries so slow?
References: <200711241736.34876.lucene@nitwit.de>
In-Reply-To: <200711241736.34876.lucene@nitwit.de>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

The added IO is one factor. Another is the CPU load from doing many 
edit-distance comparisons between index terms and the provided search 
term. You can limit the number of edit distance comparisons conducted by 
setting the minimum prefix length. This is a property of the QueryParser 
if parsing queries and a property of FuzzyQuery if constructing 
programatically.

 >>P.S. arent' there any "best practices" for lucene?

Yes. The front page of the the WIKI has a "Basics of Performace". I've 
added a note on FuzzyQueries to the "ImproveSearchingSpeed" page

Cheers
Mark





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31169-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 03:00:08 2007
Return-Path: <java-user-return-31169-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 10531 invoked from network); 25 Nov 2007 03:00:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 03:00:08 -0000
Received: (qmail 30573 invoked by uid 500); 25 Nov 2007 02:59:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30545 invoked by uid 500); 25 Nov 2007 02:59:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30534 invoked by uid 99); 25 Nov 2007 02:59:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Nov 2007 18:59:50 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.196.101.29] (HELO web59203.mail.re1.yahoo.com) (66.196.101.29)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 25 Nov 2007 02:59:52 +0000
Received: (qmail 7391 invoked by uid 60001); 25 Nov 2007 02:59:31 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=PbCUpR2xDivknwDza2MgznNUNIMWniiRPB6WBtMcBb2l4lFF0CDBr/9ZCQ0zXlKHBU5teFFB02JIuGLXtzR3e9DCXa9JnKJXTa3GQNtMykUY3wtw/FsKex7xVPz/Q4NOfUPS6N6oR8XLpEZaPkR9X3kEsq5e7UaKdJonHxfDZKA=;
X-YMail-OSG: QIXscPQVM1mJ4suoPR5rdhAYJvFripO5eb2wGmPOLrxXmbjjtLkrkohXKSQqRX538cT_tUmq6i8FQz0u3.5BTJXyeI3GTDa8tsN9rMfV0G__WQjPd9L8L0TavAtaDciPFQx5er.TyHVcm3E-
Received: from [72.231.21.213] by web59203.mail.re1.yahoo.com via HTTP; Sat, 24 Nov 2007 18:59:31 PST
Date: Sat, 24 Nov 2007 18:59:31 -0800 (PST)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: How to delete old index
To: java-user@lucene.apache.org
In-Reply-To: <267540.27594.qm@web59202.mail.re1.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-501641930-1195959571=:7387"
Content-Transfer-Encoding: 8bit
Message-ID: <214323.7387.qm@web59203.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-501641930-1195959571=:7387
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

Hi,
      I used have index refreshed in every 4 hr. However after each refresh, I can see two index. I am not sure how can I delete old index.
   
  On starting of indexing process, I create Writer
  writer = new IndexWriter(luceneDirectory,false,luceneAnalyzer,true);
   
  At the end of Indexing process:
  writer.flush();
  writer.close();
   
  and reopen the indexreader
   
  luceneDirectory = FSDirectory.getDirectory(indexPath);
  
  reader = IndexReader.open(luceneDirectory);
  searcher = new IndexSearcher(reader);
  Is this the right way or I am missing something?
  Let me tell you that I dont want to update index rather I just want to delete the old index.
  Your help would be appreciated.
   
  - BR

       
---------------------------------
Get easy, one-click access to your favorites.  Make Yahoo! your homepage.
--0-501641930-1195959571=:7387--

From java-user-return-31170-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 09:42:34 2007
Return-Path: <java-user-return-31170-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50859 invoked from network); 25 Nov 2007 09:42:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 09:42:34 -0000
Received: (qmail 38193 invoked by uid 500); 25 Nov 2007 09:42:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38151 invoked by uid 500); 25 Nov 2007 09:42:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38140 invoked by uid 99); 25 Nov 2007 09:42:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 01:42:16 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucene@nitwit.de designates 80.67.29.23 as permitted sender)
Received: from [80.67.29.23] (HELO smtprelay09.ispgateway.de) (80.67.29.23)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 09:41:54 +0000
Received: (qmail 31485 invoked from network); 25 Nov 2007 09:41:55 -0000
Received: from unknown (HELO server.localdomain) ([pbs]153383@[85.178.241.15])
          (envelope-sender <lucene@nitwit.de>)
          by smtprelay09.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 25 Nov 2007 09:41:55 -0000
Received: from localhost (localhost [127.0.0.1])
	by server.localdomain (Postfix) with ESMTP id 739321B8D92
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 10:42:37 +0100 (CET)
From: Timo Nentwig <lucene@nitwit.de>
To: java-user@lucene.apache.org
Subject: Re: Why exactly are fuzzy queries so slow?
Date: Sun, 25 Nov 2007 10:42:36 +0100
User-Agent: KMail/1.9.7
References: <200711241736.34876.lucene@nitwit.de> <47485F50.3090209@yahoo.co.uk>
In-Reply-To: <47485F50.3090209@yahoo.co.uk>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711251042.37056.lucene@nitwit.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Saturday 24 November 2007 18:28:48 markharw00d wrote:
> The added IO is one factor. Another is the CPU load from doing many
> edit-distance comparisons between index terms and the provided search

You mean FuzzyQuery.rewrite(). Are you sure this is a CPU and not an IO issue 
(reading the terms from the index)? I thought about introducing a cache here 
because the fuzzy factory remains constant.

> term. You can limit the number of edit distance comparisons conducted by
> setting the minimum prefix length. This is a property of the QueryParser
> if parsing queries and a property of FuzzyQuery if constructing
> programatically.
>
>  >>P.S. arent' there any "best practices" for lucene?
>
> Yes. The front page of the the WIKI has a "Basics of Performace". I've
> added a note on FuzzyQueries to the "ImproveSearchingSpeed" page

Thanks! I didn't know there's a wiki...

I heard rumors that I am supposed to use a single IndexSearcher. Now I read 
this on the mentioned page. Why? In fact I pool IndexSearchers (and therefore 
IndexReaders) because I ran in a synchronized() bottleneck when doing IO.

I also heard that this problem would decrease with an MMapDirectory however so 
far I wasn't able to get my hands on a proper 64bit machine...

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31171-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 09:48:15 2007
Return-Path: <java-user-return-31171-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51199 invoked from network); 25 Nov 2007 09:48:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 09:48:15 -0000
Received: (qmail 40465 invoked by uid 500); 25 Nov 2007 09:47:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 40433 invoked by uid 500); 25 Nov 2007 09:47:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 40421 invoked by uid 99); 25 Nov 2007 09:47:58 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 01:47:58 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lucene@nitwit.de designates 80.67.29.23 as permitted sender)
Received: from [80.67.29.23] (HELO smtprelay09.ispgateway.de) (80.67.29.23)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 09:47:58 +0000
Received: (qmail 939 invoked from network); 25 Nov 2007 09:47:38 -0000
Received: from unknown (HELO server.localdomain) ([pbs]153383@[85.178.241.15])
          (envelope-sender <lucene@nitwit.de>)
          by smtprelay09.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 25 Nov 2007 09:47:38 -0000
Received: from localhost (localhost [127.0.0.1])
	by server.localdomain (Postfix) with ESMTP id A71F0214181
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 10:48:20 +0100 (CET)
From: Timo Nentwig <lucene@nitwit.de>
To: java-user@lucene.apache.org
Subject: Re: Why exactly are fuzzy queries so slow?
Date: Sun, 25 Nov 2007 10:48:20 +0100
User-Agent: KMail/1.9.7
References: <200711241736.34876.lucene@nitwit.de> <F2377918-4642-474C-92FD-EA06A55CA0A7@garambrogne.net>
In-Reply-To: <F2377918-4642-474C-92FD-EA06A55CA0A7@garambrogne.net>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline
Message-Id: <200711251048.20449.lucene@nitwit.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Saturday 24 November 2007 18:48:18 Mathieu Lecarme wrote:
> fuzzy are simply not indexed.
> If you wont to search quickly with fuzzy search, you should index word
> and their ngrams, it's the "do you mean" pattern.

replacing fuzzy with "did you mean" is indeed my favourite option however s=
o=20
far I don't know how to do it (in my case). Are there some examples to look=
=20
at?

I think one of the problem with a fuzzy queries is that it searches for all=
=20
terms that match the given levenstein distance. I doesn't care whether a=20
particular term might be in a document or field that I'm not interested in =
at=20
all.

> you first select used word wich share ngram with the query word, the
> distance is computed with levenstein, and you use this word as a
> synonym.
>
> M.
>
> Le 24 nov. 07 =E0 17:36, Timo Nentwig a =E9crit :
> > Hi!
> >
> > I search an 1.5 gig index and fuzzy queries are really slow;
> > something like
> > avg. ~500ms (IndexSearcher.search(Query, HitCollector)).
> >
> > When performing exact queries I archieve response times <25ms. What
> > is it that
> > makes fuzzy queries so slow? Increased index access due to more
> > terms, i.e.
> > disk IO?
> >
> > And no, my fuzzy queries (fuzzy factor 0.8) don't blow up to a
> > boolean query
> > with 100s clauses but maybe something...less than 10.
> >
> > Thanks
> > Timo
> >
> > P.S. arent' there any "best practices" for lucene? Does everybody
> > have to find
> > out on his own (over and over again) and spend a lot of time reading
> > and
> > understanding lucene's code base?
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31172-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 09:52:29 2007
Return-Path: <java-user-return-31172-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51597 invoked from network); 25 Nov 2007 09:52:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 09:52:29 -0000
Received: (qmail 42515 invoked by uid 500); 25 Nov 2007 09:52:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 42482 invoked by uid 500); 25 Nov 2007 09:52:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 42471 invoked by uid 99); 25 Nov 2007 09:52:11 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 01:52:11 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 09:52:14 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 9A84F5428E
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 04:51:51 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Sun, 25 Nov 2007 04:51:51 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 6FEDB94; Sun, 25 Nov 2007 04:51:51 -0500 (EST)
Message-Id: <1195984311.9718.1223076983@webmail.messagingengine.com>
X-Sasl-Enc: BvNAX+vqMIyNcPj6UxAev8dHra1lvAIdRAsagUITTJym 1195984311
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <214323.7387.qm@web59203.mail.re1.yahoo.com>
Subject: Re: How to delete old index
In-Reply-To: <214323.7387.qm@web59203.mail.re1.yahoo.com>
Date: Sun, 25 Nov 2007 04:51:51 -0500
X-Virus-Checked: Checked by ClamAV on apache.org

"Cool Coder" <techcool.kumar@yahoo.com> wrote:
> Hi,
>       I used have index refreshed in every 4 hr. However after each
>       refresh, I can see two index. I am not sure how can I delete old
>       index.

What do you mean by "you can see two index"?
    
>   On starting of indexing process, I create Writer
>   writer = new IndexWriter(luceneDirectory,false,luceneAnalyzer,true);

This is exactly right.  That final true (which is the "create" arg) will
clear out the index.
    
>   At the end of Indexing process:
>   writer.flush();
>   writer.close();

The writer.flush() isn't necessary: writer.close() will always flush.

>   and reopen the indexreader
>    
>   luceneDirectory = FSDirectory.getDirectory(indexPath);
>   
>   reader = IndexReader.open(luceneDirectory);
>   searcher = new IndexSearcher(reader);
>   Is this the right way or I am missing something?
>   Let me tell you that I dont want to update index rather I just want to
>   delete the old index.
>   Your help would be appreciated.

This looks right to me!

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31173-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 10:27:51 2007
Return-Path: <java-user-return-31173-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54128 invoked from network); 25 Nov 2007 10:27:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 10:27:51 -0000
Received: (qmail 51186 invoked by uid 500); 25 Nov 2007 10:27:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51143 invoked by uid 500); 25 Nov 2007 10:27:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51129 invoked by uid 99); 25 Nov 2007 10:27:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 02:27:33 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucene@nitwit.de designates 80.67.18.13 as permitted sender)
Received: from [80.67.18.13] (HELO smtprelay01.ispgateway.de) (80.67.18.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 10:27:13 +0000
Received: (qmail 15583 invoked from network); 25 Nov 2007 10:27:14 -0000
Received: from unknown (HELO server.localdomain) ([pbs]153383@[85.178.241.15])
          (envelope-sender <lucene@nitwit.de>)
          by smtprelay01.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 25 Nov 2007 10:27:14 -0000
Received: from localhost (localhost [127.0.0.1])
	by server.localdomain (Postfix) with ESMTP id 2293EFF21A
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 11:27:57 +0100 (CET)
From: Timo Nentwig <lucene@nitwit.de>
To: java-user@lucene.apache.org
Subject: Re: Why exactly are fuzzy queries so slow?
Date: Sun, 25 Nov 2007 11:27:56 +0100
User-Agent: KMail/1.9.7
References: <200711241736.34876.lucene@nitwit.de> <47485F50.3090209@yahoo.co.uk>
In-Reply-To: <47485F50.3090209@yahoo.co.uk>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711251127.56874.lucene@nitwit.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Saturday 24 November 2007 18:28:48 markharw00d wrote:
> term. You can limit the number of edit distance comparisons conducted by
> setting the minimum prefix length. This is a property of the QueryParser

Well, javadoc: "prefixLength - length of common (non-fuzzy) prefix". So, this 
is some kind of "wildcard fuzzy" but not real fuzzy anymore. 

I understand the optimitation but right now I hardly can image a reasonable 
use-case. Who care whether the levenstein distance is a the beginnen, middle 
or end of word, .e.g when searching fuzzy for "philes" I want to 
find "files"...

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31174-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 10:54:56 2007
Return-Path: <java-user-return-31174-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55469 invoked from network); 25 Nov 2007 10:54:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 10:54:56 -0000
Received: (qmail 55076 invoked by uid 500); 25 Nov 2007 10:54:38 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55040 invoked by uid 500); 25 Nov 2007 10:54:38 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55029 invoked by uid 99); 25 Nov 2007 10:54:38 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 02:54:38 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [217.12.11.35] (HELO smtp004.mail.ukl.yahoo.com) (217.12.11.35)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 25 Nov 2007 10:54:40 +0000
Received: (qmail 53457 invoked from network); 25 Nov 2007 10:54:19 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-YMail-OSG:Message-ID:Date:From:User-Agent:MIME-Version:To:Subject:References:In-Reply-To:Content-Type:Content-Transfer-Encoding;
  b=lwAeNKt2GzM0GGC/o/LK0t35N9cwVrqEybmxo9sP+hQ95mf+wDWwLyaUsUoJHsXpXqDjhaLKXOCCphAdZr4Ox+f9UHZofkGtgqrolNFa4yCPF6Ix913stjnRDErTR5OwaMg6Vxkr/CrIH7/tqAvWh1c4szgADwK0IB0ECbMsOd0=  ;
Received: from unknown (HELO ?127.0.0.1?) (markharw00d@194.106.34.5 with plain)
  by smtp004.mail.ukl.yahoo.com with SMTP; 25 Nov 2007 10:54:19 -0000
X-YMail-OSG: 1RRlc.cVM1kyt7Hp0I29muebdnV_0fnyY3gGzLtKVL68Q03EDJ6TlAl3XQ2Mqq.d3VxqTHaogl9IqVdS2NihaLcqdugJ
Message-ID: <47495457.9010401@yahoo.co.uk>
Date: Sun, 25 Nov 2007 10:54:15 +0000
From: markharw00d <markharw00d@yahoo.co.uk>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Why exactly are fuzzy queries so slow?
References: <200711241736.34876.lucene@nitwit.de> <47485F50.3090209@yahoo.co.uk> <200711251127.56874.lucene@nitwit.de>
In-Reply-To: <200711251127.56874.lucene@nitwit.de>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

For "fuzzy" you're going to pay one way or another.
You can use ngram analyzers on indexed content and queries which will 
add IO costs ("files" becomes "fi","fil", "file","il","ile","iles" in 
both your query and index) or you can use some form of query-time edit 
distance comparison on "files" and pay the CPU costs. You can use 
WordNet and "files" becomes "registers". You can examine large volumes 
of user queries and look at what is the most likely interpretation. You 
can use Soundex and then if you're lucky files==philes but there's no 
room for error and they either match or they dont - there is no measure 
of similarity.

There's no free lunch here.

Timo Nentwig wrote:
> On Saturday 24 November 2007 18:28:48 markharw00d wrote:
>   
>> term. You can limit the number of edit distance comparisons conducted by
>> setting the minimum prefix length. This is a property of the QueryParser
>>     
>
> Well, javadoc: "prefixLength - length of common (non-fuzzy) prefix". So, this 
> is some kind of "wildcard fuzzy" but not real fuzzy anymore. 
>
> I understand the optimitation but right now I hardly can image a reasonable 
> use-case. Who care whether the levenstein distance is a the beginnen, middle 
> or end of word, .e.g when searching fuzzy for "philes" I want to 
> find "files"...
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>   



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31175-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 11:03:17 2007
Return-Path: <java-user-return-31175-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 56206 invoked from network); 25 Nov 2007 11:03:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 11:03:16 -0000
Received: (qmail 59073 invoked by uid 500); 25 Nov 2007 11:02:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59033 invoked by uid 500); 25 Nov 2007 11:02:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59022 invoked by uid 99); 25 Nov 2007 11:02:58 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 03:02:58 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [212.27.42.28] (HELO smtp2-g19.free.fr) (212.27.42.28)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 11:02:38 +0000
Received: from smtp2-g19.free.fr (localhost.localdomain [127.0.0.1])
	by smtp2-g19.free.fr (Postfix) with ESMTP id 5E80512B6FB
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 12:02:38 +0100 (CET)
Received: from [192.168.2.152] (dau94-4-82-227-122-98.fbx.proxad.net [82.227.122.98])
	by smtp2-g19.free.fr (Postfix) with ESMTP id D6EA712B6F4
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 12:02:37 +0100 (CET)
Message-Id: <EAA59BEA-4C3B-4FFD-A968-E82476F15C68@garambrogne.net>
From: Mathieu Lecarme <mathieu@garambrogne.net>
To: java-user@lucene.apache.org
In-Reply-To: <200711251127.56874.lucene@nitwit.de>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Why exactly are fuzzy queries so slow?
Date: Sun, 25 Nov 2007 12:02:23 +0100
References: <200711241736.34876.lucene@nitwit.de> <47485F50.3090209@yahoo.co.uk> <200711251127.56874.lucene@nitwit.de>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

> Well, javadoc: "prefixLength - length of common (non-fuzzy) prefix".  
> So, this
> is some kind of "wildcard fuzzy" but not real fuzzy anymore.
>
> I understand the optimitation but right now I hardly can image a  
> reasonable
> use-case. Who care whether the levenstein distance is a the  
> beginnen, middle
> or end of word, .e.g when searching fuzzy for "philes" I want to
> find "files"...

with a ngram size of 3, "files" => fil, ile, les, and "philes" => phi,  
hil, ile, les
you restrict also the size of the word with -1, +1
when you fuzzy search "philes", you are looking for word of size 5, 6  
or 7, wich may contains its ngrams. Lucene query will send you, in  
sorted order, word with most ngrams in commons. You can clean sort  
order with a levenstein distance (to exclude anagram).
If you wont to match "ph" and "f", you have to compute with phonetic  
forms.

M.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31176-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 15:42:45 2007
Return-Path: <java-user-return-31176-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95472 invoked from network); 25 Nov 2007 15:42:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 15:42:45 -0000
Received: (qmail 59187 invoked by uid 500); 25 Nov 2007 15:42:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 59138 invoked by uid 500); 25 Nov 2007 15:42:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 59127 invoked by uid 99); 25 Nov 2007 15:42:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 07:42:26 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 66.249.92.168 as permitted sender)
Received: from [66.249.92.168] (HELO ug-out-1314.google.com) (66.249.92.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 15:42:06 +0000
Received: by ug-out-1314.google.com with SMTP id h3so798410ugf
        for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 07:42:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=Jrs2rausjF7iZYYF/uYSQZOq9QZ9RdSvNIGlIs+RvvQ=;
        b=Ghl4RnWCvznkDFmEYPOmFdtTfBaAtYbGV3CgK7tW4r4X3MAJ/lZSLsiQgw9CJxZujQXR3w5t697yqfY67FRLY3tkImKoNsClOtxdfUSQzGGm6QRUEW5jqQu0gVD+9FLGH0oRDM31rBBYC7nTQZSTAP9E+NfdrdXHqpx+tO8AC0g=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=dAduf87UzQC0nm22vZb2Kg23IEqgier5b6vLOPHVMKrUrbwrvOQvBTIvc2+T2WGQGqt1jA+EgyWY5/Rkrw96NfrAuV5bu49wQG5HBEdvN5eTsE+xELloiPBC9+qj72XduxMFVNb7WdBeoTxWoKteLrJui4/Ixmizu2xs3OUZDjg=
Received: by 10.66.222.9 with SMTP id u9mr2618529ugg.1196005327702;
        Sun, 25 Nov 2007 07:42:07 -0800 (PST)
Received: from ?10.0.46.80? ( [202.125.143.69])
        by mx.google.com with ESMTPS id e1sm1028221ugf.2007.11.25.07.41.59
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Sun, 25 Nov 2007 07:42:04 -0800 (PST)
Message-ID: <474997AC.3050509@gmail.com>
Date: Sun, 25 Nov 2007 20:41:32 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: LIA example problem
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello


I m studying Lucene In Action. In chapter 2 the first example in 
generating errors in this part of code.

 doc.add(Field.Keyword("id", keywords[i]));
      doc.add(Field.UnIndexed("country", unindexed[i]));
      doc.add(Field.UnStored("contents", unstored[i]));
      doc.add(Field.Text("city", text[i]));




This four statements generate errors. These API are deprecated.


Kindly guide in this regard..



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31177-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 16:32:48 2007
Return-Path: <java-user-return-31177-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 9440 invoked from network); 25 Nov 2007 16:32:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 16:32:48 -0000
Received: (qmail 89773 invoked by uid 500); 25 Nov 2007 16:32:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89734 invoked by uid 500); 25 Nov 2007 16:32:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89723 invoked by uid 99); 25 Nov 2007 16:32:30 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 08:32:30 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a18.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 16:32:32 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a18.g.dreamhost.com (Postfix) with ESMTP id D41D15B52E
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 08:32:11 -0800 (PST)
Message-Id: <8C76E1B0-5E0D-4837-B2E0-B886C8346B83@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <474997AC.3050509@gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: LIA example problem
Date: Sun, 25 Nov 2007 11:32:08 -0500
References: <474997AC.3050509@gmail.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

LIA is based on 1.4.3 of Lucene.  The Field.Keyword, etc. methods have  
been removed in place of just using constructors.

-Grant

On Nov 25, 2007, at 10:41 AM, Liaqat Ali wrote:

> Hello
>
>
> I m studying Lucene In Action. In chapter 2 the first example in  
> generating errors in this part of code.
>
> doc.add(Field.Keyword("id", keywords[i]));
>     doc.add(Field.UnIndexed("country", unindexed[i]));
>     doc.add(Field.UnStored("contents", unstored[i]));
>     doc.add(Field.Text("city", text[i]));
>
>
>
>
> This four statements generate errors. These API are deprecated.
>
>
> Kindly guide in this regard..
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31178-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 20:06:04 2007
Return-Path: <java-user-return-31178-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66717 invoked from network); 25 Nov 2007 20:06:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 20:06:04 -0000
Received: (qmail 64638 invoked by uid 500); 25 Nov 2007 20:05:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64603 invoked by uid 500); 25 Nov 2007 20:05:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64592 invoked by uid 99); 25 Nov 2007 20:05:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 12:05:45 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.196.101.29] (HELO web59203.mail.re1.yahoo.com) (66.196.101.29)
    by apache.org (qpsmtpd/0.29) with SMTP; Sun, 25 Nov 2007 20:05:47 +0000
Received: (qmail 64980 invoked by uid 60001); 25 Nov 2007 20:05:26 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=5dP4nMpy9yFm2U0nZOGr8x+8XUxhUZyyCLk0LO0iSneR5NEhK2rJPjz1QPfdVruSFGNKzMsz4XOs48eiLbYo/ROlLguKMvNhBRlCw496q1WDB+V2fGpbX7iOrnPbCcWJDz/cE2CazlUpNymdgTu61myHzIndUtSrbvCCb64vvso=;
X-YMail-OSG: 06W0hfsVM1n_97GfyBjR1OatBAR9RDATNK.mvjvPBIe11w52XnyeFq7zWY8oKIYFXA--
Received: from [72.231.21.213] by web59203.mail.re1.yahoo.com via HTTP; Sun, 25 Nov 2007 12:05:26 PST
Date: Sun, 25 Nov 2007 12:05:26 -0800 (PST)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Re: How to delete old index
To: java-user@lucene.apache.org
In-Reply-To: <1195984311.9718.1223076983@webmail.messagingengine.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1142180257-1196021126=:64048"
Content-Transfer-Encoding: 8bit
Message-ID: <343958.64048.qm@web59203.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1142180257-1196021126=:64048
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

>What do you mean by "you can see two index"?
  I can see two sets of lucene index files with same size and time stamp difference is 4 hrs.
   
  E.g. At start up , the lucence generated index file 
   
  _8w.cfs (also some more files)  with size 4 MB and time stamp  November 24, 2007, 2:57:48 PM

  After 4 hr, it generated another set of files like _32.cfs(also some more files) with size 4MB and timestamp November 24, 2007, 6:59:48 PM.
   
  But at the sametime, old index files did not get deleted. I think that all old index files should get deleted once new index is created and IndexReader is reopened.
   
  Can you tell me why this is not happening?
   
  - BR

  
Michael McCandless <lucene@mikemccandless.com> wrote:
  "Cool Coder" wrote:
> Hi,
> I used have index refreshed in every 4 hr. However after each
> refresh, I can see two index. I am not sure how can I delete old
> index.

What do you mean by "you can see two index"?

> On starting of indexing process, I create Writer
> writer = new IndexWriter(luceneDirectory,false,luceneAnalyzer,true);

This is exactly right. That final true (which is the "create" arg) will
clear out the index.

> At the end of Indexing process:
> writer.flush();
> writer.close();

The writer.flush() isn't necessary: writer.close() will always flush.

> and reopen the indexreader
> 
> luceneDirectory = FSDirectory.getDirectory(indexPath);
> 
> reader = IndexReader.open(luceneDirectory);
> searcher = new IndexSearcher(reader);
> Is this the right way or I am missing something?
> Let me tell you that I dont want to update index rather I just want to
> delete the old index.
> Your help would be appreciated.

This looks right to me!

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



       
---------------------------------
Be a better pen pal. Text or chat with friends inside Yahoo! Mail. See how.
--0-1142180257-1196021126=:64048--

From java-user-return-31179-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 20:27:36 2007
Return-Path: <java-user-return-31179-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75515 invoked from network); 25 Nov 2007 20:27:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 20:27:36 -0000
Received: (qmail 76531 invoked by uid 500); 25 Nov 2007 20:27:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 76495 invoked by uid 500); 25 Nov 2007 20:27:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 76484 invoked by uid 99); 25 Nov 2007 20:27:18 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 12:27:18 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 20:27:21 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id D2A0250D07
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 15:26:59 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Sun, 25 Nov 2007 15:26:59 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id A312C1EAAE; Sun, 25 Nov 2007 15:26:59 -0500 (EST)
Message-Id: <1196022419.32403.1223128505@webmail.messagingengine.com>
X-Sasl-Enc: vhUjQ6Ztely+bWY9TuyT7sxIHCHWG88jxBGdUstCg+wF 1196022419
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <343958.64048.qm@web59203.mail.re1.yahoo.com>
Subject: Re: How to delete old index
In-Reply-To: <343958.64048.qm@web59203.mail.re1.yahoo.com>
Date: Sun, 25 Nov 2007 15:26:59 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


Ahh, OK.  Are you leaving your old IndexReader open against the index while your new IndexWriter is creating the new index?  Are you running on Windows?

If so, then this behavior makes sense: the old IndexReader will prevent deletion of all files it is using (which is all files in the index when the reader was first opened).  Only when you re-open the IndexReader will those files be deletable.  However, they will not actually be deleted until you next open a writer.

You could simply open then close a new IndexWriter with create=false, after you've closed the old reader.  This will "touch" the index and delete the files that are now deletable, which should be all files for your old index.

Mike

"Cool Coder" <techcool.kumar@yahoo.com> wrote:
> >What do you mean by "you can see two index"?
>   I can see two sets of lucene index files with same size and time stamp
>   difference is 4 hrs.
>    
>   E.g. At start up , the lucence generated index file 
>    
>   _8w.cfs (also some more files)  with size 4 MB and time stamp  November
>   24, 2007, 2:57:48 PM
> 
>   After 4 hr, it generated another set of files like _32.cfs(also some
>   more files) with size 4MB and timestamp November 24, 2007, 6:59:48 PM.
>    
>   But at the sametime, old index files did not get deleted. I think that
>   all old index files should get deleted once new index is created and
>   IndexReader is reopened.
>    
>   Can you tell me why this is not happening?
>    
>   - BR
> 
>   
> Michael McCandless <lucene@mikemccandless.com> wrote:
>   "Cool Coder" wrote:
> > Hi,
> > I used have index refreshed in every 4 hr. However after each
> > refresh, I can see two index. I am not sure how can I delete old
> > index.
> 
> What do you mean by "you can see two index"?
> 
> > On starting of indexing process, I create Writer
> > writer = new IndexWriter(luceneDirectory,false,luceneAnalyzer,true);
> 
> This is exactly right. That final true (which is the "create" arg) will
> clear out the index.
> 
> > At the end of Indexing process:
> > writer.flush();
> > writer.close();
> 
> The writer.flush() isn't necessary: writer.close() will always flush.
> 
> > and reopen the indexreader
> > 
> > luceneDirectory = FSDirectory.getDirectory(indexPath);
> > 
> > reader = IndexReader.open(luceneDirectory);
> > searcher = new IndexSearcher(reader);
> > Is this the right way or I am missing something?
> > Let me tell you that I dont want to update index rather I just want to
> > delete the old index.
> > Your help would be appreciated.
> 
> This looks right to me!
> 
> Mike
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
>        
> ---------------------------------
> Be a better pen pal. Text or chat with friends inside Yahoo! Mail. See
> how.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31180-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Sun Nov 25 20:56:27 2007
Return-Path: <java-user-return-31180-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81225 invoked from network); 25 Nov 2007 20:56:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 25 Nov 2007 20:56:27 -0000
Received: (qmail 88391 invoked by uid 500); 25 Nov 2007 20:56:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88356 invoked by uid 500); 25 Nov 2007 20:56:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88345 invoked by uid 99); 25 Nov 2007 20:56:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 12:56:09 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 64.233.182.187 as permitted sender)
Received: from [64.233.182.187] (HELO nf-out-0910.google.com) (64.233.182.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 20:55:50 +0000
Received: by nf-out-0910.google.com with SMTP id d3so394888nfc
        for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 12:55:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=9D1iSdZ+0TETZn5Ccs6VHHar7i3duV07YHHg+biS5bQ=;
        b=HKTWITCOS8r/1VVfIj77cE3zktLALhsKndBV9GKDqUVlyE/Q9MgqcDDiQD0FY0h8GxjNMjcx4HHffcOVYxzPuuwoEOS4WnXcrn44zBf8ATbpoy842l7pSgSuD37kZpGCmk72iSv9CgFJGtzxdgsJbvY8wzaLTD5qc7ffMnVBCZ4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=TgV1Qr7Zli/tdc9GaNvaNIgzdSbrZepRreLCyLvPYWEqRgOctMlOqi3+hHQrksK2ZJMDIjVv8DfyYThGS8bts5UFjaZdE3BiMfkqLttdCxwv7Njl0WNmZWQk5ZFM9BR1wYbF7sXQimMdLdTZBZt2ww/G2ZJarHBvrStlLXy8oKA=
Received: by 10.82.175.17 with SMTP id x17mr5298041bue.1196024150649;
        Sun, 25 Nov 2007 12:55:50 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Sun, 25 Nov 2007 12:55:50 -0800 (PST)
Message-ID: <359a92830711251255y95530f4h9a947eebfb91183f@mail.gmail.com>
Date: Sun, 25 Nov 2007 15:55:50 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Index: mixing the structure of persistence
In-Reply-To: <718789d20711240726r7eaf4a60s77c5e71ecde63619@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_32915_13129965.1196024150611"
References: <718789d20711240726r7eaf4a60s77c5e71ecde63619@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_32915_13129965.1196024150611
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

As I understand, Lucene does a fair amount of caching of terms in
memory without you having to specify anything.

But it's hard to see how your question relates. Remember that Lucene is
finding *all* matching docs. So searching in a RAMdirectory and then
searching in the file doesn't really seem possible since Lucene has to
search
the entire index every time to score the docs. It doesn't stop after
the first hit, since the next hit may score higher.

But I'm sure Lucene *does* cache portions of the index in RAM when
possible, but I've never had occasion to dig into the details.

Which leads me to ask "Why do you care?". Is there a specific
situation you're trying to get better performance from or is this more
of a background question? If you have a specific situation, please describe
it in some detail so better minds than mine can give you a better
response <G>....

Best
Erick

On Nov 24, 2007 10:26 AM, Haroldo Nascimento <haroldo.araras@gmail.com>
wrote:

> Hi,
>
>  I have a question ?
>
>  Lucene offers a mixing structure of storage of index, that is, first
> do search in memoria (ARMDirectory) and in case of not found do search
> in index file automatically ? For example: Load part of index in
> memory for do the search fastest.
>
>  Thnaks
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_32915_13129965.1196024150611--

From java-user-return-31181-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 00:52:35 2007
Return-Path: <java-user-return-31181-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42871 invoked from network); 26 Nov 2007 00:52:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 00:52:35 -0000
Received: (qmail 90503 invoked by uid 500); 26 Nov 2007 00:52:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 90472 invoked by uid 500); 26 Nov 2007 00:52:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 90460 invoked by uid 99); 26 Nov 2007 00:52:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 16:52:17 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.196.101.30] (HELO web59204.mail.re1.yahoo.com) (66.196.101.30)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 26 Nov 2007 00:51:56 +0000
Received: (qmail 81146 invoked by uid 60001); 26 Nov 2007 00:51:58 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=ksEwLFBYs79slbSLJK/KyjRk1s4CKCeDt4P9xYtk/nAZjjLfiVuzHow6XrXofha6ylUYJn+tjaI21gJAkW6of3CNcG2QH9MXjJmCq+KdVqa0YEHgIrZFKr4k45SlTEHbVII3XL8GhvzPiID+lRS2M6/kbCIejbNCCZjE2PYuQOU=;
X-YMail-OSG: UgGAj1AVM1lGzZIKG0k8BvWjnph7wz7oKL9T5G6TFQblRIp4Fi1bisFliqyasWJcb2PeG1AEdaxtcHzAVU2HWjLYsw--
Received: from [72.231.21.213] by web59204.mail.re1.yahoo.com via HTTP; Sun, 25 Nov 2007 16:51:57 PST
Date: Sun, 25 Nov 2007 16:51:57 -0800 (PST)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Re: How to delete old index
To: java-user@lucene.apache.org
In-Reply-To: <1196022419.32403.1223128505@webmail.messagingengine.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1356517522-1196038317=:80313"
Content-Transfer-Encoding: 8bit
Message-ID: <123201.80313.qm@web59204.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1356517522-1196038317=:80313
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

>Ahh, OK. Are you leaving your old IndexReader open against the index while your   >new IndexWriter is creating the new index? Are you running on Windows?
   
  Yes. Because I cannot close IndexReader in the live system. And also I am running on Windows server. 
  At the end of index writing, I close writer and also reopen reader
   
  writer.close()
  reader.close();
  reader = IndexReader.open(luceneDirectory);
  searcher = new IndexSearcher(reader);
   
  Still I can see old files. Is there still a way to delete old index files.
   
   
  - BR
  

Michael McCandless <lucene@mikemccandless.com> wrote:
    
Ahh, OK. Are you leaving your old IndexReader open against the index while your 
  new IndexWriter is creating the new index? Are you running on Windows?

If so, then this behavior makes sense: the old IndexReader will prevent deletion of all files it is using (which is all files in the index when the reader was first opened). Only when you re-open the IndexReader will those files be deletable. However, they will not actually be deleted until you next open a writer.

You could simply open then close a new IndexWriter with create=false, after you've closed the old reader. This will "touch" the index and delete the files that are now deletable, which should be all files for your old index.

Mike

"Cool Coder" wrote:
> >What do you mean by "you can see two index"?
> I can see two sets of lucene index files with same size and time stamp
> difference is 4 hrs.
> 
> E.g. At start up , the lucence generated index file 
> 
> _8w.cfs (also some more files) with size 4 MB and time stamp November
> 24, 2007, 2:57:48 PM
> 
> After 4 hr, it generated another set of files like _32.cfs(also some
> more files) with size 4MB and timestamp November 24, 2007, 6:59:48 PM.
> 
> But at the sametime, old index files did not get deleted. I think that
> all old index files should get deleted once new index is created and
> IndexReader is reopened.
> 
> Can you tell me why this is not happening?
> 
> - BR
> 
> 
> Michael McCandless wrote:
> "Cool Coder" wrote:
> > Hi,
> > I used have index refreshed in every 4 hr. However after each
> > refresh, I can see two index. I am not sure how can I delete old
> > index.
> 
> What do you mean by "you can see two index"?
> 
> > On starting of indexing process, I create Writer
> > writer = new IndexWriter(luceneDirectory,false,luceneAnalyzer,true);
> 
> This is exactly right. That final true (which is the "create" arg) will
> clear out the index.
> 
> > At the end of Indexing process:
> > writer.flush();
> > writer.close();
> 
> The writer.flush() isn't necessary: writer.close() will always flush.
> 
> > and reopen the indexreader
> > 
> > luceneDirectory = FSDirectory.getDirectory(indexPath);
> > 
> > reader = IndexReader.open(luceneDirectory);
> > searcher = new IndexSearcher(reader);
> > Is this the right way or I am missing something?
> > Let me tell you that I dont want to update index rather I just want to
> > delete the old index.
> > Your help would be appreciated.
> 
> This looks right to me!
> 
> Mike
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 
> 
> ---------------------------------
> Be a better pen pal. Text or chat with friends inside Yahoo! Mail. See
> how.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org




       
---------------------------------
Never miss a thing.   Make Yahoo your homepage.
--0-1356517522-1196038317=:80313--

From java-user-return-31182-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 01:01:10 2007
Return-Path: <java-user-return-31182-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44105 invoked from network); 26 Nov 2007 01:01:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 01:01:10 -0000
Received: (qmail 94723 invoked by uid 500); 26 Nov 2007 01:00:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 94678 invoked by uid 500); 26 Nov 2007 01:00:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 94667 invoked by uid 99); 26 Nov 2007 01:00:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 17:00:52 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 01:00:32 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 9B1624CE58
	for <java-user@lucene.apache.org>; Sun, 25 Nov 2007 20:00:34 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Sun, 25 Nov 2007 20:00:34 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 6EEDCCAE; Sun, 25 Nov 2007 20:00:34 -0500 (EST)
Message-Id: <1196038834.7272.1223157885@webmail.messagingengine.com>
X-Sasl-Enc: Ob2sbyytFlTbWQ5oMYGFN0TilGtaIbGaVOXs/pEl56Py 1196038834
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <123201.80313.qm@web59204.mail.re1.yahoo.com>
Subject: Re: How to delete old index
In-Reply-To: <123201.80313.qm@web59204.mail.re1.yahoo.com>
Date: Sun, 25 Nov 2007 20:00:34 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Cool Coder" <techcool.kumar@yahoo.com> wrote:
>   Yes. Because I cannot close IndexReader in the live system. And also I
>   am running on Windows server. 
>   At the end of index writing, I close writer and also reopen reader

OK, I'm glad we have it explained!

>   writer.close()
>   reader.close();
>   reader = IndexReader.open(luceneDirectory);
>   searcher = new IndexSearcher(reader);
>    
>   Still I can see old files. Is there still a way to delete old index
>   files.

Just insert this:

  new IndexWriter(luceneDirectory, analyzer).close();

after you've reopened your reader above.  That should prune all deletable files from the index.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31183-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 02:15:45 2007
Return-Path: <java-user-return-31183-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 69862 invoked from network); 26 Nov 2007 02:15:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 02:15:44 -0000
Received: (qmail 22352 invoked by uid 500); 26 Nov 2007 02:15:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22316 invoked by uid 500); 26 Nov 2007 02:15:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22305 invoked by uid 99); 26 Nov 2007 02:15:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 18:15:27 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.196.101.34] (HELO web59208.mail.re1.yahoo.com) (66.196.101.34)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 26 Nov 2007 02:15:29 +0000
Received: (qmail 8207 invoked by uid 60001); 26 Nov 2007 02:15:06 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:In-Reply-To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=n0DjDupeu/vXjkrRfx0ZOAcMfqrhgs1iyiGIRdC1+/VZRE4T74XwqtV4pzztfEXa2ukMEtL0YpSogbUylnX4WQNcB5MTWs2IHBfLgRqNRZNMTL7dA5prtF2rw29Qd2rkbO7iTDINxVrZMfuC8+JrCgs5JyJVGyKSWmrCxAYlMgM=;
X-YMail-OSG: bCM0EzwVM1lG9RZiZVGufcgXggZUihFKc0qH_WO62qhjEuqhzxwG.oSbpOFX4sYn8iKN8l3ASjCk4HMUIehQ0EVzEKYjjaucaXcTOEDjK9xXpINr.Qg-
Received: from [72.231.21.213] by web59208.mail.re1.yahoo.com via HTTP; Sun, 25 Nov 2007 18:15:06 PST
Date: Sun, 25 Nov 2007 18:15:06 -0800 (PST)
From: Cool Coder <techcool.kumar@yahoo.com>
Subject: Re: How to delete old index
To: java-user@lucene.apache.org
In-Reply-To: <1196038834.7272.1223157885@webmail.messagingengine.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1499380161-1196043306=:7765"
Content-Transfer-Encoding: 8bit
Message-ID: <493452.7765.qm@web59208.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1499380161-1196043306=:7765
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

I tried with your suggestion but still it did not delete old index files. Anyway I closed reader before closing writer and reopened reader after closing writer which deleted all old index files.
   
  reader.close();
  writer.close();
  reader.open();
   
  - RB

Michael McCandless <lucene@mikemccandless.com> wrote:
  
"Cool Coder" wrote:
> Yes. Because I cannot close IndexReader in the live system. And also I
> am running on Windows server. 
> At the end of index writing, I close writer and also reopen reader

OK, I'm glad we have it explained!

> writer.close()
> reader.close();
> reader = IndexReader.open(luceneDirectory);
> searcher = new IndexSearcher(reader);
> 
> Still I can see old files. Is there still a way to delete old index
> files.

Just insert this:

new IndexWriter(luceneDirectory, analyzer).close();

after you've reopened your reader above. That should prune all deletable files from the index.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org



       
---------------------------------
Never miss a thing.   Make Yahoo your homepage.
--0-1499380161-1196043306=:7765--

From java-user-return-31184-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 05:53:59 2007
Return-Path: <java-user-return-31184-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20347 invoked from network); 26 Nov 2007 05:53:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 05:53:59 -0000
Received: (qmail 28574 invoked by uid 500); 26 Nov 2007 05:53:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28547 invoked by uid 500); 26 Nov 2007 05:53:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28536 invoked by uid 99); 26 Nov 2007 05:53:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Nov 2007 21:53:41 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of adb@teamware.com designates 212.226.92.15 as permitted sender)
Received: from [212.226.92.15] (HELO monkey.teamware.com) (212.226.92.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 05:53:22 +0000
Received: from intrepid.teamw.com (intrepid.teamw.com [10.142.128.11])
	by monkey.teamware.com (8.13.1/8.13.1) with ESMTP id lAQ5rFIo016169
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 07:53:15 +0200
Received: from [10.142.3.10] ([10.142.3.10]) by nimitz.teamw.com with ESMTP
	 id mbq7gh5e; 26 Nov 2007 07:52:00 +0200
Message-ID: <474A5F36.8060207@teamware.com>
Date: Mon, 26 Nov 2007 16:52:54 +1100
From: Antony Bowesman <adb@teamware.com>
Organization: Teamware Group
User-Agent: Thunderbird 1.5.0.10 (Windows/20070221)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: deleteDocuments by Term[] for ALL terms
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Greylist: Sender IP whitelisted, not delayed by milter-greylist-1.6 (monkey.teamware.com [212.226.92.15]); Mon, 26 Nov 2007 07:53:15 +0200 (EET)
X-TWG-MailScanner-Information: See www.mailscanner.info for information
X-TWG-MailScanner: Found to be clean
X-TWG-MailScanner-SpamCheck: not spam, SpamAssassin (score=0.001, required 5,
	autolearn=not spam, BAYES_50 0.00)
X-MailScanner-From: adb@teamware.com
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I'm using IndexReader.deleteDocuments(Term) to delete documents in batches.  I 
need the deleted count, so I cannot use IndexWriter.deleteDocuments().

What I want to do is delete documents based on more than one term, but not like 
IndexWriter.deleteDocuments(Term[]) which deletes all documents with ANY term. 
I want it to delete documents which have ALL terms, e.g.

Term("owner", "ownerUID") AND Term("subject", "something");

I have a new reader being used, so I could make a new IndexSearcher and query 
the documents with all terms in a BooleanQuery and then iterate the results, but 
that would either mean using the Hits mechanism or TopDocs and seems like a 
heavyweight way to do things.

What I want to be able to do is to delete sequentially without storing up a 
result set as I may want to delete all and ALL may be rather big.

I see the implementation uses reader.termDocs() to do the deletion for a single 
Term, which of course is easy, but is there a simple way to make a deletion for 
multiple terms with AND via the reader using, say termDocs, that will not 
potentially use large amounts of memory, or should I just go with the searcher 
TopDocs mechanism and do that also in batches to avoid the risk of a large 
memory hit.

I know there's lots of clever 'expert-mode' stuff under the Lucene API hood, but 
does anyone know any good way to do this or have I missed anything obvious in 
the API docs?

Thanks
Antony




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31185-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 09:13:17 2007
Return-Path: <java-user-return-31185-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53572 invoked from network); 26 Nov 2007 09:13:17 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 09:13:17 -0000
Received: (qmail 67450 invoked by uid 500); 26 Nov 2007 09:12:59 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67420 invoked by uid 500); 26 Nov 2007 09:12:59 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67409 invoked by uid 99); 26 Nov 2007 09:12:59 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 01:12:59 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [89.213.91.233] (HELO mail.ardentiasearch.com) (89.213.91.233)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 09:12:38 +0000
Received: from biscuit.ARDENTIASEARCH.local ([10.0.0.9]) by
 biscuit.ARDENTIASEARCH.local ([10.0.0.9]) with mapi; Mon, 26 Nov 2007
 09:12:38 +0000
From: Mike Streeton <mike.streeton@ardentiasearch.com>
To: "java-user@lucene.apache.org" <java-user@lucene.apache.org>
Date: Mon, 26 Nov 2007 09:12:38 +0000
Subject: Lucene jdbc
Thread-Topic: Lucene jdbc
Thread-Index: AcgwDH21dMNIpuhhRlGcFDr3ItKDtw==
Message-ID: <DFE6314F5CE91344A74BD2AA612C93B6143C3424D7@biscuit.ARDENTIASEARCH.local>
Accept-Language: en-US, en-GB
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
acceptlanguage: en-US, en-GB
Content-Type: multipart/alternative;
	boundary="_000_DFE6314F5CE91344A74BD2AA612C93B6143C3424D7biscuitARDENT_"
MIME-Version: 1.0
X-Virus-Checked: Checked by ClamAV on apache.org

--_000_DFE6314F5CE91344A74BD2AA612C93B6143C3424D7biscuitARDENT_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Is their such a thing as a jdbc driver for Lucene that allows you to run SQ=
L to select from an index.

Many Thanks

Mike

--_000_DFE6314F5CE91344A74BD2AA612C93B6143C3424D7biscuitARDENT_--

From java-user-return-31186-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 10:16:41 2007
Return-Path: <java-user-return-31186-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79349 invoked from network); 26 Nov 2007 10:16:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 10:16:40 -0000
Received: (qmail 67981 invoked by uid 500); 26 Nov 2007 10:16:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 67738 invoked by uid 500); 26 Nov 2007 10:16:22 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 67727 invoked by uid 99); 26 Nov 2007 10:16:22 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 02:16:22 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 10:16:01 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 470E357985
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 05:16:03 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Mon, 26 Nov 2007 05:16:03 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id C1DE03DE90; Mon, 26 Nov 2007 05:16:00 -0500 (EST)
Message-Id: <1196072160.25863.1223214311@webmail.messagingengine.com>
X-Sasl-Enc: B1ibY/IjaT2m47pmGDY32zW5+WPQ8VtoLmJkRL5tuCk9 1196072160
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <493452.7765.qm@web59208.mail.re1.yahoo.com>
Subject: Re: How to delete old index
In-Reply-To: <493452.7765.qm@web59208.mail.re1.yahoo.com>
Date: Mon, 26 Nov 2007 05:16:00 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Cool Coder" <techcool.kumar@yahoo.com> wrote:
> I tried with your suggestion but still it did not delete old index files.

That's very odd.  Are you sure you added that line after your first reader
was closed & second one was opened?  It's that first reader that prevents
deleting of the old index files.

> Anyway I closed reader before closing writer and reopened reader after
> closing writer which deleted all old index files.
>    
>   reader.close();
>   writer.close();
>   reader.open();

This should work as well, but there is a risk that you have a somewhat
longish time during which you have no reader to service queries.  EG if
writer.close() kicks off a series of merges it could take quite a while.

Though if the index is small in your case this may be a non-issue in
practice...

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31187-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 10:49:53 2007
Return-Path: <java-user-return-31187-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84743 invoked from network); 26 Nov 2007 10:49:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 10:49:53 -0000
Received: (qmail 4209 invoked by uid 500); 26 Nov 2007 10:49:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4166 invoked by uid 500); 26 Nov 2007 10:49:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4155 invoked by uid 99); 26 Nov 2007 10:49:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 02:49:35 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 10:49:14 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 5D46956CD4
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 05:49:16 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Mon, 26 Nov 2007 05:49:16 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 33ED44DE52; Mon, 26 Nov 2007 05:49:16 -0500 (EST)
Message-Id: <1196074156.30488.1223219125@webmail.messagingengine.com>
X-Sasl-Enc: PKUtrKtlR8GkqGAeNrp5Nelo9zdLKMu2SA1XNwwarQ3/ 1196074156
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <474A5F36.8060207@teamware.com>
Subject: Re: deleteDocuments by Term[] for ALL terms
In-Reply-To: <474A5F36.8060207@teamware.com>
Date: Mon, 26 Nov 2007 05:49:16 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


You can just create a query with your and'd terms, and then do this:

  Weight weight = query.weight(indexSearcher);
  IndexReader reader = indexSearcher.getIndexReader();
  Scorer scorer = weight.scorer(reader);
  int delCount = 0;
  while(scorer.next()) {
    reader.deleteDocument(scorer.doc());
    delCount++;
  }

that iterates over all the docIDs without scoring them and without
building up a Hit for each, etc.

Mike

"Antony Bowesman" <adb@teamware.com> wrote:
> Hi,
> 
> I'm using IndexReader.deleteDocuments(Term) to delete documents in
> batches.  I 
> need the deleted count, so I cannot use IndexWriter.deleteDocuments().
> 
> What I want to do is delete documents based on more than one term, but
> not like 
> IndexWriter.deleteDocuments(Term[]) which deletes all documents with ANY
> term. 
> I want it to delete documents which have ALL terms, e.g.
> 
> Term("owner", "ownerUID") AND Term("subject", "something");
> 
> I have a new reader being used, so I could make a new IndexSearcher and
> query 
> the documents with all terms in a BooleanQuery and then iterate the
> results, but 
> that would either mean using the Hits mechanism or TopDocs and seems like
> a 
> heavyweight way to do things.
> 
> What I want to be able to do is to delete sequentially without storing up
> a 
> result set as I may want to delete all and ALL may be rather big.
> 
> I see the implementation uses reader.termDocs() to do the deletion for a
> single 
> Term, which of course is easy, but is there a simple way to make a
> deletion for 
> multiple terms with AND via the reader using, say termDocs, that will not 
> potentially use large amounts of memory, or should I just go with the
> searcher 
> TopDocs mechanism and do that also in batches to avoid the risk of a
> large 
> memory hit.
> 
> I know there's lots of clever 'expert-mode' stuff under the Lucene API
> hood, but 
> does anyone know any good way to do this or have I missed anything
> obvious in 
> the API docs?
> 
> Thanks
> Antony
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31188-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 11:42:51 2007
Return-Path: <java-user-return-31188-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99430 invoked from network); 26 Nov 2007 11:42:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 11:42:51 -0000
Received: (qmail 77714 invoked by uid 500); 26 Nov 2007 11:42:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77459 invoked by uid 500); 26 Nov 2007 11:42:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77448 invoked by uid 99); 26 Nov 2007 11:42:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 03:42:32 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [124.30.170.13] (HELO hydmail1.satyam.com) (124.30.170.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 11:42:32 +0000
Received: from hyd.satyam.com (hyd.satyam.com [204.252.161.226])
	by hydmail1.satyam.com (8.13.4/8.13.4) with ESMTP id lAQBKfiM014056
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 16:50:41 +0530
Received: from Disclaimerhyd.corp.satyam.ad (hhtbh.satyam.com [172.16.186.212])
	by hyd.satyam.com (8.13.1/8.13.1) with ESMTP id lAQBdGPk024705
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 17:09:17 +0530
Received: from hstmsg005.corp.satyam.ad ([172.16.186.216]) by Disclaimerhyd.corp.satyam.ad with Microsoft SMTPSVC(6.0.3790.211); Mon, 26 Nov 2007 17:12:12 +0530
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.607
Content-Transfer-Encoding: 7bit
Content-class: urn:content-classes:message
MIME-Version: 1.0
Priority: normal
Importance: normal
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C83021.61686D89"
Subject: how to increase the performance!!!
Date: Mon, 26 Nov 2007 17:12:10 +0530
Message-ID: <9312093579B72048B1E5659DC3EC7F39022E930D@hstmsg005.corp.satyam.ad>
In-Reply-To: <4740AAE1.20508@gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: how to increase the performance!!!
Thread-Index: AcgqH2yPQ8pgSpRuQrunkKkSl3u7XgGAgdRQ
From: "Shakti_Sareen" <Shakti_Sareen@satyam.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 26 Nov 2007 11:42:12.0359 (UTC) FILETIME=[626F8970:01C83021]
X-Virus-Scanned: ClamAV version 0.88.4, clamav-milter version 0.88.4 on hyd.satyam.com
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C83021.61686D89
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi all,

I am using Searching is taking a lot of time.

The size of the folder where I am keeping the index files is 160 MB
containing 3277 documents.

=20

I am using...=20

query =3D parser.parse("ANY");

hits =3D searcher.search(query);

=20

How can I improve the performance of searching?

=20

Regards

Shakti Sareen

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20



DISCLAIMER:
This email (including any attachments) is intended for the sole use of =
the intended recipient/s and may contain material that is CONFIDENTIAL =
AND PRIVATE COMPANY INFORMATION. Any review or reliance by others or =
copying or distribution or forwarding of any or all of the contents in =
this message is STRICTLY PROHIBITED. If you are not the intended =
recipient, please contact the sender by email and delete all copies; =
your cooperation in this regard is appreciated.

------_=_NextPart_001_01C83021.61686D89--

From java-user-return-31189-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 11:51:16 2007
Return-Path: <java-user-return-31189-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4238 invoked from network); 26 Nov 2007 11:51:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 11:51:16 -0000
Received: (qmail 93504 invoked by uid 500); 26 Nov 2007 11:50:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 93484 invoked by uid 500); 26 Nov 2007 11:50:58 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 93473 invoked by uid 99); 26 Nov 2007 11:50:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 03:50:57 -0800
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp1.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 11:50:36 +0000
Received: from smtp2.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lAQBmNps022474
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 06:48:23 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp2.akamai.com (8.13.8/8.12.10) with ESMTP id lAQBpYIs005782
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 06:51:34 -0500 (EST)
Received: from MAVS1.kendall.corp.akamai.com ([172.17.33.15]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 26 Nov 2007 06:50:34 -0500
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by MAVS1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Mon, 26 Nov 2007 06:50:34 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: how to increase the performance!!!
Date: Mon, 26 Nov 2007 17:20:31 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A62026E72D2@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E930D@hstmsg005.corp.satyam.ad>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: how to increase the performance!!!
Thread-Index: AcgqH2yPQ8pgSpRuQrunkKkSl3u7XgGAgdRQAAAl5sA=
References: <4740AAE1.20508@gmail.com> <9312093579B72048B1E5659DC3EC7F39022E930D@hstmsg005.corp.satyam.ad>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 26 Nov 2007 11:50:34.0442 (UTC) FILETIME=[8DB352A0:01C83022]
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Shakti,

> I am using Searching is taking a lot of time.
What do you mean by a lot of time? How much time is it taking?=20
There are a lot of factors that affect the search speed.

> The size of the folder where I am keeping the index files is 160 MB
containing 3277 documents.
That's not too much. If you are doing things right, search should not
take much time.

> How can I improve the performance of searching?
Go through this:
http://wiki.apache.org/lucene-java/ImproveSearchingSpeed

Hope this helps!

Best Regards,
kapilChhabra


-----Original Message-----
From: Shakti_Sareen [mailto:Shakti_Sareen@satyam.com]=20
Sent: Monday, November 26, 2007 5:12 PM
To: java-user@lucene.apache.org
Subject: how to increase the performance!!!

Hi all,

I am using Searching is taking a lot of time.

The size of the folder where I am keeping the index files is 160 MB
containing 3277 documents.

=20

I am using...=20

query =3D parser.parse("ANY");

hits =3D searcher.search(query);

=20

How can I improve the performance of searching?

=20

Regards

Shakti Sareen

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20

=20



DISCLAIMER:
This email (including any attachments) is intended for the sole use of
the intended recipient/s and may contain material that is CONFIDENTIAL
AND PRIVATE COMPANY INFORMATION. Any review or reliance by others or
copying or distribution or forwarding of any or all of the contents in
this message is STRICTLY PROHIBITED. If you are not the intended
recipient, please contact the sender by email and delete all copies;
your cooperation in this regard is appreciated.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31190-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 13:20:19 2007
Return-Path: <java-user-return-31190-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 41112 invoked from network); 26 Nov 2007 13:20:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 13:20:19 -0000
Received: (qmail 71185 invoked by uid 500); 26 Nov 2007 13:20:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 71146 invoked by uid 500); 26 Nov 2007 13:20:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 71135 invoked by uid 99); 26 Nov 2007 13:20:02 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 05:20:02 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lukas.vlcek@gmail.com designates 209.85.198.189 as permitted sender)
Received: from [209.85.198.189] (HELO rv-out-0910.google.com) (209.85.198.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 13:19:38 +0000
Received: by rv-out-0910.google.com with SMTP id k20so485585rvb
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 05:19:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=GhQWpZjBp+M7Q/F9seOM/b8bptnSwJqlerGyIHKG7yI=;
        b=T0Bf8gh6cTmKz21W+dmg79iJMdqwPmDXrdPCqy2Zl9+ppHQup4dWkJu2Ru5pwVhQp0Eay9ILYAqoN/trVnkESgbRiH6SMrCgWvzS4quKBdff0eF2Ist/rjEb8vT3ahRDPiQxzCko3uYAxaYU2beB/3wd6jjGci+0/Fnh26FY0sM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=WoZULnqRG3MHfOiy3QKa3HajZeLjryhGPtkGxFBqkpzAHnEsF/OSHHm4ZKuVZEJFvScIY9oShpyfe30dR2xOVfHO7F9w19gbWY0yMkre+OcTVSnySfkZODdG9VS5pXVDUk3twDDkrOzJm3YZDuYRoZBQ7IOmkP9m/J17CgCsKno=
Received: by 10.140.164.1 with SMTP id m1mr1117651rve.1196083179820;
        Mon, 26 Nov 2007 05:19:39 -0800 (PST)
Received: by 10.141.164.3 with HTTP; Mon, 26 Nov 2007 05:19:39 -0800 (PST)
Message-ID: <52c3ddca0711260519x4678e7c0n6858f4d6b5aeb8e0@mail.gmail.com>
Date: Mon, 26 Nov 2007 14:19:39 +0100
From: "Lukas Vlcek" <lukas.vlcek@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene jdbc
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6143C3424D7@biscuit.ARDENTIASEARCH.local>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_8213_11083458.1196083179833"
References: <DFE6314F5CE91344A74BD2AA612C93B6143C3424D7@biscuit.ARDENTIASEARCH.local>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_8213_11083458.1196083179833
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

AFAIK no.
Lucene is revelance based query engine not relation based engine like SQL
database.
However, if you really want to use SQL on top of Lucene index then there can
be a way. You need to store index into database (see
here<http://wiki.apache.org/lucene-java/LuceneFAQ#head-e55d8e6971f9f01daaf3e14ce1d2f34485adba6e>)
and then you can monkey around...

Regards,
Lukas

On Nov 26, 2007 10:12 AM, Mike Streeton <mike.streeton@ardentiasearch.com>
wrote:

> Is their such a thing as a jdbc driver for Lucene that allows you to run
> SQL to select from an index.
>
> Many Thanks
>
> Mike
>



-- 
http://blog.lukas-vlcek.com/

------=_Part_8213_11083458.1196083179833--

From java-user-return-31191-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 14:28:15 2007
Return-Path: <java-user-return-31191-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62614 invoked from network); 26 Nov 2007 14:28:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 14:28:15 -0000
Received: (qmail 62928 invoked by uid 500); 26 Nov 2007 14:27:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 62905 invoked by uid 500); 26 Nov 2007 14:27:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 62894 invoked by uid 99); 26 Nov 2007 14:27:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 06:27:57 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 64.233.170.190 as permitted sender)
Received: from [64.233.170.190] (HELO rn-out-0102.google.com) (64.233.170.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 14:27:35 +0000
Received: by rn-out-0102.google.com with SMTP id v46so200405rnb
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 06:27:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=av1G5k4Tla3jHBtBWMPaObLCt8yD13tobvDbTWnHXyg=;
        b=xAKCW9cNil2e2LseepFslLZK/5aUS6ZVUxkGIWFPpliTOFUDeUK7lkdLIfjPwF3LVOYI2tD6uDAwA9AeV0y4tm85l+d2zTY4NioCRTmFlQbCVOE2A8W9wQcmBiasRkvLQyMiTb/61sgF9NDAuH8SCGhGG22zUMU/7x8OvJFywgk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=af5F1EMLGKW0kcKl06OnqHK0xAtdZjoIqYqSdzvem4z3uTjDnoA9BItVsdJaaTC4Um6d/sQsrU/F7VOHscf3GWIU1zSPWKzIDvrgPr+GdgD93ew3z3+X1meqsNAAG6Nttlg1gBjBPRtrEm6HgETrEdlksyZ669QAyTaiVp9sroc=
Received: by 10.150.58.5 with SMTP id g5mr386529yba.1196087257600;
        Mon, 26 Nov 2007 06:27:37 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Mon, 26 Nov 2007 06:27:37 -0800 (PST)
Message-ID: <718789d20711260627k6f755c59s8dbe2ac67cf76cd7@mail.gmail.com>
Date: Mon, 26 Nov 2007 11:27:37 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Index: mixing the structure of persistence
In-Reply-To: <359a92830711251255y95530f4h9a947eebfb91183f@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <718789d20711240726r7eaf4a60s77c5e71ecde63619@mail.gmail.com>
	 <359a92830711251255y95530f4h9a947eebfb91183f@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

  I have a very great volume of data (6.000.000 of documents) and I
need to have a very fast search. I am thinking about using Terracotta
(with Lucene) for clustering the solution.

  One of the advantages of the Terracotta is that part of the index is
stored in memory and part is persisted em disk. If not to find in
memory the application searchs in disk. This is transparent for the
user. The problem would be in the process of updat of index.

  Another solution would be to persist the index using only Lucene,
but I believe that the reply time very using disk either bigger that
the solution in memory.

  You know some document comparative about the solution em memory
(RAMDirectory) and solution em disk using Lucene?

  Tip: In another application I am using the solution index in memory
(RAMDirectory), to initiate the process of load of the indice I
serialized the RAMDirectory object. For it I need  insert "implements
Serializable" in some classrooms of Lucene.



On Nov 25, 2007 5:55 PM, Erick Erickson <erickerickson@gmail.com> wrote:
> As I understand, Lucene does a fair amount of caching of terms in
> memory without you having to specify anything.
>
> But it's hard to see how your question relates. Remember that Lucene is
> finding *all* matching docs. So searching in a RAMdirectory and then
> searching in the file doesn't really seem possible since Lucene has to
> search
> the entire index every time to score the docs. It doesn't stop after
> the first hit, since the next hit may score higher.
>
> But I'm sure Lucene *does* cache portions of the index in RAM when
> possible, but I've never had occasion to dig into the details.
>
> Which leads me to ask "Why do you care?". Is there a specific
> situation you're trying to get better performance from or is this more
> of a background question? If you have a specific situation, please describe
> it in some detail so better minds than mine can give you a better
> response <G>....
>
> Best
> Erick
>
> On Nov 24, 2007 10:26 AM, Haroldo Nascimento <haroldo.araras@gmail.com>
> wrote:
>
>
> > Hi,
> >
> >  I have a question ?
> >
> >  Lucene offers a mixing structure of storage of index, that is, first
> > do search in memoria (ARMDirectory) and in case of not found do search
> > in index file automatically ? For example: Load part of index in
> > memory for do the search fastest.
> >
> >  Thnaks
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31192-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 14:40:31 2007
Return-Path: <java-user-return-31192-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65988 invoked from network); 26 Nov 2007 14:40:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 14:40:30 -0000
Received: (qmail 78653 invoked by uid 500); 26 Nov 2007 14:40:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78621 invoked by uid 500); 26 Nov 2007 14:40:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78610 invoked by uid 99); 26 Nov 2007 14:40:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 06:40:12 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 64.233.182.186 as permitted sender)
Received: from [64.233.182.186] (HELO nf-out-0910.google.com) (64.233.182.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 14:39:50 +0000
Received: by nf-out-0910.google.com with SMTP id d3so610191nfc
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 06:39:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=jQgmRVxIxfTsUoJvTPU1lE0T+De8Q6G3XcadmLvqur0=;
        b=tsOG3DBIQfi662ZTuuoJIBEIE7JfW71L3EQMwMNrqJvTMdrxRy5WcK364vkcQqUP7XrCxMoQr64iO6UfNWYvzS88Jy4LGEQgzSglkK78c3BDoqnfAAAGN2ma8ebtHMDVSZHLQrHZlTEZ6g84Pz5kqGvRuhM1hgto+IafwsFnzLs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=WIX/4wEnfUaODGmAmt9muPElgpGCRYa95kYPeHWCk+RJtUKc/Mw/sYC+1Nd0DH9pPCWKp0dVqvIIA2TfCjnYYW15MmhxwAnqqnbVHWqy2KHlRGGtXEaU5h5eYh27hG2cXpfE9GAYEpUOpsXKPVr4dYwHUkleAEFsgGUuaOUW7Fw=
Received: by 10.82.134.12 with SMTP id h12mr7437963bud.1196087990345;
        Mon, 26 Nov 2007 06:39:50 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Mon, 26 Nov 2007 06:39:50 -0800 (PST)
Message-ID: <359a92830711260639t1a50d039x6ee8ce8fabee708c@mail.gmail.com>
Date: Mon, 26 Nov 2007 09:39:50 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Index: mixing the structure of persistence
In-Reply-To: <718789d20711260627k6f755c59s8dbe2ac67cf76cd7@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_35062_22806396.1196087990270"
References: <718789d20711240726r7eaf4a60s77c5e71ecde63619@mail.gmail.com>
	 <359a92830711251255y95530f4h9a947eebfb91183f@mail.gmail.com>
	 <718789d20711260627k6f755c59s8dbe2ac67cf76cd7@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_35062_22806396.1196087990270
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Unfortunately, there's not much anyone can say. If I can paraphrase
what you're asking, it's "Will a Lucene search be fast enough?" The
answer is "it depends". Asking the question "is part of the index stored
in RAM" isn't really relevant.

Yes, some parts of the index are cached in RAM. Yes, that is handled
transparently under the covers. That information is entirely useless
for answering the question "is the search fast enough".

All you can do is create an index and test. This is especially true since
you've supplied no information that helps. 6M documents is the only hard
figure you've provided. Are you indexing 1 field per doc? 100 fields per
doc?
Do you expect to have to do lots of sorting? Complex queries? What
is acceptable performance? How fast is "fast"? How many requests do
you anticipate per second/minute/hour? And on and on.

But even with those pieces of information, we still can't help much because
there are just so many variables.

My suggestion:
Create a simple Lucene index of your documenta and measure. Read the
FAQ and other documentation on the Lucene website and on the Lucene
Wiki to get some pointers on how to structure your index for speed.
And experiment. Nothing else will give you a feel for the speed. Creating
the index should take you about a day. It'll be time well spent.

Best
Erick

On Nov 26, 2007 9:27 AM, Haroldo Nascimento <haroldo.araras@gmail.com>
wrote:

> Hi,
>
>  I have a very great volume of data (6.000.000 of documents) and I
> need to have a very fast search. I am thinking about using Terracotta
> (with Lucene) for clustering the solution.
>
>  One of the advantages of the Terracotta is that part of the index is
> stored in memory and part is persisted em disk. If not to find in
> memory the application searchs in disk. This is transparent for the
> user. The problem would be in the process of updat of index.
>
>  Another solution would be to persist the index using only Lucene,
> but I believe that the reply time very using disk either bigger that
> the solution in memory.
>
>  You know some document comparative about the solution em memory
> (RAMDirectory) and solution em disk using Lucene?
>
>  Tip: In another application I am using the solution index in memory
> (RAMDirectory), to initiate the process of load of the indice I
> serialized the RAMDirectory object. For it I need  insert "implements
> Serializable" in some classrooms of Lucene.
>
>
>
> On Nov 25, 2007 5:55 PM, Erick Erickson <erickerickson@gmail.com> wrote:
> > As I understand, Lucene does a fair amount of caching of terms in
> > memory without you having to specify anything.
> >
> > But it's hard to see how your question relates. Remember that Lucene is
> > finding *all* matching docs. So searching in a RAMdirectory and then
> > searching in the file doesn't really seem possible since Lucene has to
> > search
> > the entire index every time to score the docs. It doesn't stop after
> > the first hit, since the next hit may score higher.
> >
> > But I'm sure Lucene *does* cache portions of the index in RAM when
> > possible, but I've never had occasion to dig into the details.
> >
> > Which leads me to ask "Why do you care?". Is there a specific
> > situation you're trying to get better performance from or is this more
> > of a background question? If you have a specific situation, please
> describe
> > it in some detail so better minds than mine can give you a better
> > response <G>....
> >
> > Best
> > Erick
> >
> > On Nov 24, 2007 10:26 AM, Haroldo Nascimento <haroldo.araras@gmail.com>
> > wrote:
> >
> >
> > > Hi,
> > >
> > >  I have a question ?
> > >
> > >  Lucene offers a mixing structure of storage of index, that is, first
> > > do search in memoria (ARMDirectory) and in case of not found do search
> > > in index file automatically ? For example: Load part of index in
> > > memory for do the search fastest.
> > >
> > >  Thnaks
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> > >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_35062_22806396.1196087990270--

From java-user-return-31193-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 15:05:31 2007
Return-Path: <java-user-return-31193-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74062 invoked from network); 26 Nov 2007 15:05:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 15:05:30 -0000
Received: (qmail 25781 invoked by uid 500); 26 Nov 2007 15:05:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25753 invoked by uid 500); 26 Nov 2007 15:05:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25742 invoked by uid 99); 26 Nov 2007 15:05:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 07:05:13 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [124.30.170.13] (HELO hydmail1.satyam.com) (124.30.170.13)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 15:04:47 +0000
Received: from hyd.satyam.com (hyd.satyam.com [204.252.161.226])
	by hydmail1.satyam.com (8.13.4/8.13.4) with ESMTP id lAQEhH05011188
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=NO)
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 20:13:17 +0530
Received: from Disclaimerhyd.corp.satyam.ad (hhtbh.satyam.com [172.16.186.212])
	by hyd.satyam.com (8.13.1/8.13.1) with ESMTP id lAQF1qpo000496
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 20:31:53 +0530
Received: from hstmsg005.corp.satyam.ad ([172.16.186.216]) by Disclaimerhyd.corp.satyam.ad with Microsoft SMTPSVC(6.0.3790.211); Mon, 26 Nov 2007 20:34:15 +0530
X-MimeOLE: Produced By Microsoft MimeOLE V6.00.3790.607
Content-Transfer-Encoding: 7bit
Content-class: urn:content-classes:message
MIME-Version: 1.0
Priority: normal
Importance: normal
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C8303D.9C8B9281"
Subject: RE: how to increase the performance!!!
Date: Mon, 26 Nov 2007 20:34:15 +0530
Message-ID: <9312093579B72048B1E5659DC3EC7F39022E930E@hstmsg005.corp.satyam.ad>
In-Reply-To: <4FA8C6AEE609B644B38DE471A3657A62026E72D2@INVS1.bangalore.corp.akamai.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: how to increase the performance!!!
Thread-Index: AcgqH2yPQ8pgSpRuQrunkKkSl3u7XgGAgdRQAAAl5sAAAzKP0A==
From: "Shakti_Sareen" <Shakti_Sareen@satyam.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 26 Nov 2007 15:04:15.0875 (UTC) FILETIME=[9C9D4530:01C8303D]
X-Virus-Scanned: ClamAV version 0.88.4, clamav-milter version 0.88.4 on hyd.satyam.com
X-Virus-Status: Clean
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C8303D.9C8B9281
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hi all,

The size of the folder where I am keeping the index files is 160 MB

containing 3277 documents.

That's not too much. If you are doing things right, search should not
take much time.

=20

=20

Below is the code :

String sNumber =3D null;

hits =3D searcher.search(query);

for (int i =3D 0;i < hits.length();i++) {

 doc =3D hits.doc(i);

 sdocNumber =3D doc.get("NUMBER");

 if (sNumber.equalsIgnoreCase(sdocNumber)) {

    LOGGER.info("Match found - " + sdocNumber);

    }=20

}

=20

=20

Can anyone help???

=20

Regards

Shakti Sareen

=20



DISCLAIMER:
This email (including any attachments) is intended for the sole use of =
the intended recipient/s and may contain material that is CONFIDENTIAL =
AND PRIVATE COMPANY INFORMATION. Any review or reliance by others or =
copying or distribution or forwarding of any or all of the contents in =
this message is STRICTLY PROHIBITED. If you are not the intended =
recipient, please contact the sender by email and delete all copies; =
your cooperation in this regard is appreciated.

------_=_NextPart_001_01C8303D.9C8B9281--

From java-user-return-31194-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 15:20:57 2007
Return-Path: <java-user-return-31194-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79673 invoked from network); 26 Nov 2007 15:20:56 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 15:20:56 -0000
Received: (qmail 58034 invoked by uid 500); 26 Nov 2007 15:20:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58004 invoked by uid 500); 26 Nov 2007 15:20:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 57993 invoked by uid 99); 26 Nov 2007 15:20:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 07:20:37 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of marcelo.ochoa@gmail.com designates 209.85.198.191 as permitted sender)
Received: from [209.85.198.191] (HELO rv-out-0910.google.com) (209.85.198.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 15:20:15 +0000
Received: by rv-out-0910.google.com with SMTP id k20so519669rvb
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 07:20:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=1p/r6uthwhJHwWmAQjHMt/vG1jdo4W6EelW0akRjbB8=;
        b=ocm1BMXaN/nwPEhbzy6DAC9Ir1iWWCZGGagt+xevZIcG5Zf3DBt2HdXQ+MaGqud/O+AQ3Go/H/SjJ39PX200ZWaPFPZyYkqK5awPtWdeHIUDsbWuztB4myZy4yTF5epgNIc+MaOxtOFgoL/CNTUWfSDMO1eH9qWNgbA1IC4rDcI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=qbXRqtBNK4IWuvjZ4NKSeO/YMSWgWwVLpM+ToL9gb2GZyndvyJjWJQwWesStwMQgC3zHYI721gpSU9OThu3vC7TDLYTuLaFkq6Q4kRVkW26CBgcvmbsa3mvTblCE6z6cBS0VY7p/kKfjm5NuJYpzPQy0g+TDcHdsC7Te8LSmyLk=
Received: by 10.141.22.1 with SMTP id z1mr1196004rvi.1196090407522;
        Mon, 26 Nov 2007 07:20:07 -0800 (PST)
Received: by 10.140.201.1 with HTTP; Mon, 26 Nov 2007 07:20:07 -0800 (PST)
Message-ID: <126142c0711260720x2a6d127fqafa8e76effd82f7d@mail.gmail.com>
Date: Mon, 26 Nov 2007 12:20:07 -0300
From: "Marcelo Ochoa" <marcelo.ochoa@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene jdbc
In-Reply-To: <52c3ddca0711260519x4678e7c0n6858f4d6b5aeb8e0@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <DFE6314F5CE91344A74BD2AA612C93B6143C3424D7@biscuit.ARDENTIASEARCH.local>
	 <52c3ddca0711260519x4678e7c0n6858f4d6b5aeb8e0@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Mike:
  If you work with Oracle databases you can take a look at Oracle
Lucene integration.
http://www.infoq.com/news/2007/10/lucene-oracle
http://issues.apache.org/jira/browse/LUCENE-724
  By using OJVMDirectory you have Lucene integrated at the Oracle
Engine as a new Domain Index, so you can use lcontains() and lscore()
operators inside your SQL queries.
  Best regards, Marcelo.

On Nov 26, 2007 10:19 AM, Lukas Vlcek <lukas.vlcek@gmail.com> wrote:
> AFAIK no.
> Lucene is revelance based query engine not relation based engine like SQL
> database.
> However, if you really want to use SQL on top of Lucene index then there can
> be a way. You need to store index into database (see
> here<http://wiki.apache.org/lucene-java/LuceneFAQ#head-e55d8e6971f9f01daaf3e14ce1d2f34485adba6e>)
> and then you can monkey around...
>
> Regards,
> Lukas
>
> On Nov 26, 2007 10:12 AM, Mike Streeton <mike.streeton@ardentiasearch.com>
> wrote:
>
>
> > Is their such a thing as a jdbc driver for Lucene that allows you to run
> > SQL to select from an index.
> >
> > Many Thanks
> >
> > Mike
> >
>
>
>
> --
> http://blog.lukas-vlcek.com/
>



-- 
Marcelo F. Ochoa
http://marceloochoa.blogspot.com/
http://marcelo.ochoa.googlepages.com/home
______________
Do you Know DBPrism? Look @ DB Prism's Web Site
http://www.dbprism.com.ar/index.html
More info?
Chapter 17 of the book "Programming the Oracle Database using Java &
Web Services"
http://www.amazon.com/gp/product/1555583296/
Chapter 21 of the book "Professional XML Databases" - Wrox Press
http://www.amazon.com/gp/product/1861003587/
Chapter 8 of the book "Oracle & Open Source" - O'Reilly
http://www.oreilly.com/catalog/oracleopen/

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31195-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 15:48:27 2007
Return-Path: <java-user-return-31195-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97855 invoked from network); 26 Nov 2007 15:48:27 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 15:48:27 -0000
Received: (qmail 9042 invoked by uid 500); 26 Nov 2007 15:48:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 9005 invoked by uid 500); 26 Nov 2007 15:48:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8994 invoked by uid 99); 26 Nov 2007 15:48:09 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 07:48:09 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.245] (HELO web26208.mail.ukl.yahoo.com) (217.12.10.245)
    by apache.org (qpsmtpd/0.29) with SMTP; Mon, 26 Nov 2007 15:47:47 +0000
Received: (qmail 88729 invoked by uid 60001); 26 Nov 2007 15:47:47 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.es;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Message-ID;
  b=EuW6tdAS2w8SgE9TbCL7ZxUCuk6CD98ul9PImGcODyvaX3uRdtZ8+PHIlD3R33X+O8IMaxV2ntKZMGsqmvoXdil5cdANoCppaj5p1a6L313718zxisO6rDqDLIcCH3VUqB66uOlq+tNOzKsGtT1PrTa6PP2xOE2P6Ki85damlmM=;
X-YMail-OSG: zlJQoLAVM1lvqjlwdMqVU5spjU7HH10X7zzDk1DZf1Dks_EHJAVLG7pP89jQD4DA5CUjv6LsbMoswnZLJKu1mRNiwq7LhswcBXESuENB4BehaIM6hW8cBmWorI6.qaCqkoE-
Received: from [91.117.124.2] by web26208.mail.ukl.yahoo.com via HTTP; Mon, 26 Nov 2007 15:47:47 GMT
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.157
Date: Mon, 26 Nov 2007 15:47:47 +0000 (GMT)
From: Eugenio Martinez <efmpacheco@yahoo.es>
Subject: I have found a kind of strange behavior in StandardAnalyzer
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-237113349-1196092067=:86266"
Message-ID: <352950.86266.qm@web26208.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-237113349-1196092067=:86266
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable

I am indexing with Lucene a hughe set of logfiles, about 130GB of plain tex=
t in disk (up to now), planning to build a system capable of perform search=
es over Terabytes of such info in a kind of metaindex built from a mesh of =
little ones, all of them created and maintained with Lucene.=0A=0AI have ra=
ndomly variable file sizes, from 1KB to several hundreds of MB of plain tex=
t, and I have done tests with files about 2GB, obtaning very good performan=
ce in time and search. Of course, once we can get search results from such =
system we get confident that Lucene was capable of doing right its job, i.e=
., split all contents and index all tokens correctly.=0A=0ABut last week, w=
ith our first beta release in our LAN environment, some problems arose. In =
certain situations we've found that the Analysis stage "fails", or better, =
has anomalies in its activity. We have isolated one, that can be reproduced=
 with LUKE in its Search window: parsing URL domains that end with a point,=
 as in "www.my.domain.es." becomes in a token with the following text: "www=
mydomaines".=0A=0AMaybe this behavior extends to emails, as we aren=C2=B4t =
able to get search results with some emails that are indeed in the contents=
 of the logfile, and with words too.=0A=0ASuch behavior is not acceptable f=
or nobody, as in natural speaking is possible to find such URLs at the end =
of a sentence. Is this an effect of document vectorization? I write this as=
 log's content structure doesn't match for natural language rules...=0A=0AA=
ny notice about this?=0A=0AWe are working on an Log Analyzer now, but i'm s=
ure i'm not the only fellow with this issue in the world... Did you know an=
yone else?=0A=0AThanks for your attention.=0A =0AEugenio F. Mart=C3=ADnez P=
acheco=0A=0AFundaci=C3=B3n Instituto Tecnol=C3=B3gico de Galicia - =C3=81re=
a TIC=0A=0ATFN: 981 173 206            FAX: 981 173 223=0A=0AVIDEOCONFERENC=
IA: 981 173 596 =0A=0Aemartinez@itg.es=0A=0A=0A=0A=0A=0A=0A       =0A______=
________________________________________ =0A=C2=BFChef por primera vez?=0AS=
=C3=A9 un mejor Cocinillas. =0Ahttp://es.answers.yahoo.com/info/welcome
--0-237113349-1196092067=:86266--

From java-user-return-31196-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 15:52:23 2007
Return-Path: <java-user-return-31196-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99219 invoked from network); 26 Nov 2007 15:52:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 15:52:23 -0000
Received: (qmail 21019 invoked by uid 500); 26 Nov 2007 15:52:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20993 invoked by uid 500); 26 Nov 2007 15:52:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20982 invoked by uid 99); 26 Nov 2007 15:52:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 07:52:05 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.207] (HELO spunkymail-a17.g.dreamhost.com) (208.97.132.207)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 15:51:43 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a17.g.dreamhost.com (Postfix) with ESMTP id 961AF74EB7
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 07:51:44 -0800 (PST)
Message-Id: <25340215-1DB9-4593-844D-4F3A6D2870F7@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E930E@hstmsg005.corp.satyam.ad>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: how to increase the performance!!!
Date: Mon, 26 Nov 2007 10:51:43 -0500
References: <9312093579B72048B1E5659DC3EC7F39022E930E@hstmsg005.corp.satyam.ad>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Are you opening your Searcher every time you query?  Are your  
documents really large?  Have you worked through http://wiki.apache.org/lucene-java/BasicsOfPerformance 
  ?

-Grant

On Nov 26, 2007, at 10:04 AM, Shakti_Sareen wrote:

> Hi all,
>
> The size of the folder where I am keeping the index files is 160 MB
>
> containing 3277 documents.
>
> That's not too much. If you are doing things right, search should not
> take much time.
>
>
>
>
>
> Below is the code :
>
> String sNumber = null;
>
> hits = searcher.search(query);
>
> for (int i = 0;i < hits.length();i++) {
>
> doc = hits.doc(i);
>
> sdocNumber = doc.get("NUMBER");
>
> if (sNumber.equalsIgnoreCase(sdocNumber)) {
>
>    LOGGER.info("Match found - " + sdocNumber);
>
>    }
>
> }
>
>
>
>
>
> Can anyone help???
>
>
>
> Regards
>
> Shakti Sareen
>
>
>
>
>
> DISCLAIMER:
> This email (including any attachments) is intended for the sole use  
> of the intended recipient/s and may contain material that is  
> CONFIDENTIAL AND PRIVATE COMPANY INFORMATION. Any review or reliance  
> by others or copying or distribution or forwarding of any or all of  
> the contents in this message is STRICTLY PROHIBITED. If you are not  
> the intended recipient, please contact the sender by email and  
> delete all copies; your cooperation in this regard is appreciated.

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31197-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 16:31:43 2007
Return-Path: <java-user-return-31197-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 15747 invoked from network); 26 Nov 2007 16:31:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 16:31:43 -0000
Received: (qmail 21547 invoked by uid 500); 26 Nov 2007 16:31:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21520 invoked by uid 500); 26 Nov 2007 16:31:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21496 invoked by uid 99); 26 Nov 2007 16:31:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 08:31:25 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 64.233.182.188 as permitted sender)
Received: from [64.233.182.188] (HELO nf-out-0910.google.com) (64.233.182.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 16:31:01 +0000
Received: by nf-out-0910.google.com with SMTP id d3so649536nfc
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 08:31:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=p+ceVupBvxqJRSS2FLuxfzNrlWGO5ksqx3H72GNoPSk=;
        b=pOU2iKFig+UQJpARbhuqhrbAq10cc3xC9DEaxyVsQfT1zl/peAdeKRMwVeUgz2QqhiZPa/ZKgoWZyXo4hg/HYiXlE2ATByGAWK24HnoHlf+z/Bk9VunRof+R5eZETWPRRzBz4Yu3LDAZc8aHuJeCrWtsLtXnP8VJsYJ+hCCbvFk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=jd6PCW6zyNADMlMZ/rBu+QAkBr4/xQpOnJhzfapx3T1iX2iUCiCYNBFqN6hmz0E39cIWt8Uox8gBsQcArFfIRaxHOsD7RFaUdFrQCYLK9QyOpi6WxKQE2HXVVikDT1EzNr592IznbTxoGjaOHhT8TopQHfC+ufTYZ4VYGOVVtGg=
Received: by 10.82.121.15 with SMTP id t15mr2461447buc.1196094093025;
        Mon, 26 Nov 2007 08:21:33 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Mon, 26 Nov 2007 08:21:32 -0800 (PST)
Message-ID: <359a92830711260821w6ddc8c62x2ec8d98865bdc838@mail.gmail.com>
Date: Mon, 26 Nov 2007 11:21:32 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: how to increase the performance!!!
In-Reply-To: <9312093579B72048B1E5659DC3EC7F39022E930E@hstmsg005.corp.satyam.ad>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_35398_1277023.1196094093021"
References: <4FA8C6AEE609B644B38DE471A3657A62026E72D2@INVS1.bangalore.corp.akamai.com>
	 <9312093579B72048B1E5659DC3EC7F39022E930E@hstmsg005.corp.satyam.ad>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_35398_1277023.1196094093021
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Do all your docs match your query? in which case iterating over the Hits
object is very inefficient (see the docs Grant points you to).

Erick

On Nov 26, 2007 10:04 AM, Shakti_Sareen <Shakti_Sareen@satyam.com> wrote:

> Hi all,
>
> The size of the folder where I am keeping the index files is 160 MB
>
> containing 3277 documents.
>
> That's not too much. If you are doing things right, search should not
> take much time.
>
>
>
>
>
> Below is the code :
>
> String sNumber = null;
>
> hits = searcher.search(query);
>
> for (int i = 0;i < hits.length();i++) {
>
>  doc = hits.doc(i);
>
>  sdocNumber = doc.get("NUMBER");
>
>  if (sNumber.equalsIgnoreCase(sdocNumber)) {
>
>    LOGGER.info("Match found - " + sdocNumber);
>
>    }
>
> }
>
>
>
>
>
> Can anyone help???
>
>
>
> Regards
>
> Shakti Sareen
>
>
>
>
>
> DISCLAIMER:
> This email (including any attachments) is intended for the sole use of the
> intended recipient/s and may contain material that is CONFIDENTIAL AND
> PRIVATE COMPANY INFORMATION. Any review or reliance by others or copying or
> distribution or forwarding of any or all of the contents in this message is
> STRICTLY PROHIBITED. If you are not the intended recipient, please contact
> the sender by email and delete all copies; your cooperation in this regard
> is appreciated.
>

------=_Part_35398_1277023.1196094093021--

From java-user-return-31198-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 16:40:53 2007
Return-Path: <java-user-return-31198-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20572 invoked from network); 26 Nov 2007 16:40:52 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 16:40:52 -0000
Received: (qmail 41646 invoked by uid 500); 26 Nov 2007 16:40:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41597 invoked by uid 500); 26 Nov 2007 16:40:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41586 invoked by uid 99); 26 Nov 2007 16:40:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 08:40:35 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of chris.lu@gmail.com designates 66.249.92.168 as permitted sender)
Received: from [66.249.92.168] (HELO ug-out-1314.google.com) (66.249.92.168)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 16:40:12 +0000
Received: by ug-out-1314.google.com with SMTP id h3so1011785ugf
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 08:40:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=fzSj0elHQ1EQU3Iz4TGLtEWEnyN0sTlC1UMbqipdVt4=;
        b=b8PNQSWuzJNReSbSI++effTPfogmezo677vfQyRbDBnxcF7Ji60aWNjd+DivI+QHFqYUpTPwTvwZaM7QNs3S8ocrzkQ2QqvQpAxAhKZmsim5WeGmVZQU+ItXaAkpDiX3CtbB05AAkoqdcoTrA4umQ0Qm8eP0eqhQ7mW1Y9CVqNc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=kq1IsG2kyN2kgBD3LF/8g4HMFD+aEWpUw3Qvra3G1cSOQr3kLzE9ht5IKw+ly+RTcD0YUABjleUsiIthjt1pyof9wM4j96L0PqEhw0XZ1GGmDF/Jrzv3eT5JL2iW/KI33XGO1z7n2DFn7DPMeZJA4LKwfKazwEFk9Wkg9MQSkv4=
Received: by 10.78.150.7 with SMTP id x7mr3107155hud.1196095212505;
        Mon, 26 Nov 2007 08:40:12 -0800 (PST)
Received: by 10.78.155.15 with HTTP; Mon, 26 Nov 2007 08:40:12 -0800 (PST)
Message-ID: <6e3ae6310711260840j175678f7j8219a317b89c614a@mail.gmail.com>
Date: Mon, 26 Nov 2007 08:40:12 -0800
From: "Chris Lu" <chris.lu@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Lucene jdbc
In-Reply-To: <DFE6314F5CE91344A74BD2AA612C93B6143C3424D7@biscuit.ARDENTIASEARCH.local>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_43235_3283936.1196095212482"
References: <DFE6314F5CE91344A74BD2AA612C93B6143C3424D7@biscuit.ARDENTIASEARCH.local>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_43235_3283936.1196095212482
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

If you mean you want a jdbc driver that you can send
 "select * from lucene_index1 where name like '%abc%' "

This would require the jdbc driver to translate SQL into Lucene query. An
interesting idea, but never seen that before. The reason is that although
look similar, SQL and Lucene query are quite different.

-- 
Chris Lu
-------------------------
Instant Scalable Full-Text Search On Any Database/Application
site: http://www.dbsight.net
demo: http://search.dbsight.com
Lucene Database Search in 3 minutes:
http://wiki.dbsight.com/index.php?title=Create_Lucene_Database_Search_in_3_minutes

On Nov 26, 2007 1:12 AM, Mike Streeton <mike.streeton@ardentiasearch.com>
wrote:

> Is their such a thing as a jdbc driver for Lucene that allows you to run
> SQL to select from an index.
>
> Many Thanks
>
> Mike
>

------=_Part_43235_3283936.1196095212482--

From java-user-return-31199-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 16:41:31 2007
Return-Path: <java-user-return-31199-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20649 invoked from network); 26 Nov 2007 16:41:31 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 16:41:31 -0000
Received: (qmail 43732 invoked by uid 500); 26 Nov 2007 16:41:14 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43363 invoked by uid 500); 26 Nov 2007 16:41:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43352 invoked by uid 99); 26 Nov 2007 16:41:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 08:41:13 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lukas.vlcek@gmail.com designates 64.233.166.180 as permitted sender)
Received: from [64.233.166.180] (HELO py-out-1112.google.com) (64.233.166.180)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 16:40:51 +0000
Received: by py-out-1112.google.com with SMTP id d32so2487412pye
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 08:40:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=pP3QHS3wgdf668AWKoyT72LDQ1WkzzdBBbE3WkLiNH4=;
        b=VBRa17flyws4jnSgcgTWrDGfGndtIH+YugfFvKeK8iZktZbn8V7J0FIHHgt3kvALrRZStaFD0r1+LSjlO9ShtuIeYi9HvTGHtUpibl7zGiZ7k5/5+jS9t0On2jCoLTA0E6/cRTSF+gNC26L9cf4Hd4a67T35UG73Nbikp2xg9fM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=rlz+1aPXet4Bw9VIPGoBNPApZ1xYE3DoZ4AfEwZsl47JE5o//5GpNwc8wa30wYmX9TJ5A7lhFhtxQk6wNSzbrrCQM7DqzmTz5DcsYlnWxYLG3b6J7yibSsUeJdS70tpNDcLn6iPB2J/iWI1gwWPmbs5/15JzWMneLSaFEt5zRRg=
Received: by 10.141.203.7 with SMTP id f7mr1261232rvq.1196095250634;
        Mon, 26 Nov 2007 08:40:50 -0800 (PST)
Received: by 10.141.164.3 with HTTP; Mon, 26 Nov 2007 08:40:50 -0800 (PST)
Message-ID: <52c3ddca0711260840k65bcae5ex8fcfbd94ac61b744@mail.gmail.com>
Date: Mon, 26 Nov 2007 17:40:50 +0100
From: "Lukas Vlcek" <lukas.vlcek@gmail.com>
To: java-user@lucene.apache.org
Subject: ApacheCon 2008 Europe - Lucene stuff
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_8853_32787443.1196095250627"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_8853_32787443.1196095250627
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

Is anybody going to present anything about Lucene (and related technologies
- Solr, Hadoop, ...) at ApacheCon 2008 Europe? Any training sessions,
invited talks and/or specific track?
The conference pages (http://www.eu.apachecon.com/) does not contain any
details yet.

Regards,
Lukas
-- 
http://blog.lukas-vlcek.com/

------=_Part_8853_32787443.1196095250627--

From java-user-return-31200-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 16:45:01 2007
Return-Path: <java-user-return-31200-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 22424 invoked from network); 26 Nov 2007 16:45:00 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 16:45:00 -0000
Received: (qmail 46273 invoked by uid 500); 26 Nov 2007 16:44:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 46239 invoked by uid 500); 26 Nov 2007 16:44:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 46220 invoked by uid 99); 26 Nov 2007 16:44:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 08:44:43 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of serera@gmail.com designates 64.233.166.183 as permitted sender)
Received: from [64.233.166.183] (HELO py-out-1112.google.com) (64.233.166.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 16:44:42 +0000
Received: by py-out-1112.google.com with SMTP id d32so2493356pye
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 08:44:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=POeKnRrgeGFGZYUpVK0+Z7TdMgrQVJEXQMtd4cJQk5g=;
        b=eFfmKTc3cXFs7z8UKqlAyYwjaHStW0HLTONEitEwVVQyHaAhhV/buyFf6GjQIGWijzOxqr9kj2pd6MIIHdujixhW3nPfx6Oquryo9oQ/j7lQ++cMyU/KAYtSSQ7j6na4n8EplJLpY3vEJ9y+3PqtxvVwbWSpKRnvmERBe+gqmzA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=UzWb8ivV5EG0vqit2V1SuwPvvyX7s5ga8Tsmxvfsjvzu+tY/HcsnyS8MMkCdaQcyWZ01i7xpXDcGNHzN9h5K5H52yJbq7VIJv4KkhOGeJ5btNf7pTZNSHHI0RLMSerqrpK0hiiSAyjICAArvYHa9o9+LWjXOSV0ca+VF1ng6vbU=
Received: by 10.65.180.9 with SMTP id h9mr6336221qbp.1196095459551;
        Mon, 26 Nov 2007 08:44:19 -0800 (PST)
Received: by 10.65.15.8 with HTTP; Mon, 26 Nov 2007 08:44:19 -0800 (PST)
Message-ID: <786fde50711260844n775e853exb17f1ad7168bd635@mail.gmail.com>
Date: Mon, 26 Nov 2007 18:44:19 +0200
From: "Shai Erera" <serera@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: I have found a kind of strange behavior in StandardAnalyzer
In-Reply-To: <352950.86266.qm@web26208.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_6618_22627958.1196095459541"
References: <352950.86266.qm@web26208.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_6618_22627958.1196095459541
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: quoted-printable
Content-Disposition: inline

Hi

I tried this code:

        TokenStream ts =3D analyzer.tokenStream("content", new StringReader=
("
www.abc.com"));
        Token t;
        while ((t =3D ts.next()) !=3D null) {
            System.out.println(t);
        }
If I pass "www.abc.com" (without an extra '.'), it prints
(www.abc.com,0,11,type=3D<HOST>)
---> it recognizes the type HOST.
If I pass "www.abc.com." (with an extra '.'), it prints
(wwwabccom,0,12,type=3D<ACRONYM>) ---> it recognizes the type ACRONYM.

Personally, I think it is a bug, as ACRONYMs are usually of the form A.B.C.
and not ABC.DEF. ... maybe you can try the java-dev mailing list and consul=
t
them if you should open an issue on that ...

On Nov 26, 2007 5:47 PM, Eugenio Martinez <efmpacheco@yahoo.es> wrote:

> I am indexing with Lucene a hughe set of logfiles, about 130GB of plain
> text in disk (up to now), planning to build a system capable of perform
> searches over Terabytes of such info in a kind of metaindex built from a
> mesh of little ones, all of them created and maintained with Lucene.
>
> I have randomly variable file sizes, from 1KB to several hundreds of MB o=
f
> plain text, and I have done tests with files about 2GB, obtaning very goo=
d
> performance in time and search. Of course, once we can get search results
> from such system we get confident that Lucene was capable of doing right =
its
> job, i.e., split all contents and index all tokens correctly.
>
> But last week, with our first beta release in our LAN environment, some
> problems arose. In certain situations we've found that the Analysis stage
> "fails", or better, has anomalies in its activity. We have isolated one,
> that can be reproduced with LUKE in its Search window: parsing URL domain=
s
> that end with a point, as in "www.my.domain.es." becomes in a token with
> the following text: "wwwmydomaines".
>
> Maybe this behavior extends to emails, as we aren=B4t able to get search
> results with some emails that are indeed in the contents of the logfile, =
and
> with words too.
>
> Such behavior is not acceptable for nobody, as in natural speaking is
> possible to find such URLs at the end of a sentence. Is this an effect of
> document vectorization? I write this as log's content structure doesn't
> match for natural language rules...
>
> Any notice about this?
>
> We are working on an Log Analyzer now, but i'm sure i'm not the only
> fellow with this issue in the world... Did you know anyone else?
>
> Thanks for your attention.
>
> Eugenio F. Mart=EDnez Pacheco
>
> Fundaci=F3n Instituto Tecnol=F3gico de Galicia - =C1rea TIC
>
> TFN: 981 173 206            FAX: 981 173 223
>
> VIDEOCONFERENCIA: 981 173 596
>
> emartinez@itg.es
>
>
>
>
>
>
>
> ______________________________________________
> =BFChef por primera vez?
> S=E9 un mejor Cocinillas.
> http://es.answers.yahoo.com/info/welcome
>



--=20
Regards,

Shai Erera

------=_Part_6618_22627958.1196095459541--

From java-user-return-31201-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 17:56:36 2007
Return-Path: <java-user-return-31201-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62209 invoked from network); 26 Nov 2007 17:56:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 17:56:35 -0000
Received: (qmail 96584 invoked by uid 500); 26 Nov 2007 17:56:18 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96542 invoked by uid 500); 26 Nov 2007 17:56:18 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96531 invoked by uid 99); 26 Nov 2007 17:56:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 09:56:17 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.202] (HELO spunkymail-a11.g.dreamhost.com) (208.97.132.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 17:56:17 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a11.g.dreamhost.com (Postfix) with ESMTP id 31C2DB7799
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 09:55:52 -0800 (PST)
Message-Id: <398B4C17-CEBB-4A6C-9CF8-AF91EDA32AA1@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <52c3ddca0711260840k65bcae5ex8fcfbd94ac61b744@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: ApacheCon 2008 Europe - Lucene stuff
Date: Mon, 26 Nov 2007 12:55:51 -0500
References: <52c3ddca0711260840k65bcae5ex8fcfbd94ac61b744@mail.gmail.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

They have not announced the schedule yet.  I know there were a number  
of Lucene related submissions and I would suspect Lucene will be well  
represented, as it was this year in Atlanta.

-Grant

On Nov 26, 2007, at 11:40 AM, Lukas Vlcek wrote:

> Hi,
>
> Is anybody going to present anything about Lucene (and related  
> technologies
> - Solr, Hadoop, ...) at ApacheCon 2008 Europe? Any training sessions,
> invited talks and/or specific track?
> The conference pages (http://www.eu.apachecon.com/) does not contain  
> any
> details yet.
>
> Regards,
> Lukas
> -- 
> http://blog.lukas-vlcek.com/

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31202-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 18:17:38 2007
Return-Path: <java-user-return-31202-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 67895 invoked from network); 26 Nov 2007 18:17:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 18:17:37 -0000
Received: (qmail 32688 invoked by uid 500); 26 Nov 2007 18:17:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32621 invoked by uid 500); 26 Nov 2007 18:17:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32610 invoked by uid 99); 26 Nov 2007 18:17:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 10:17:20 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 18:17:21 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IwiVw-000141-A4
	for java-user@lucene.apache.org; Mon, 26 Nov 2007 10:17:00 -0800
Message-ID: <13954702.post@talk.nabble.com>
Date: Mon, 26 Nov 2007 10:17:00 -0800 (PST)
From: "chris.b" <omelhornomedomundo@gmail.com>
To: java-user@lucene.apache.org
Subject: Problem indexing Word Documents
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: omelhornomedomundo@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


okay, so i'm very new to lucene, so it may be my bad, but i can get it to
index .txt files, and when trying to index word documents (using poi), the
program starts running and when it reaches a .doc file, i get the following
errors:

Exception in thread "main"
org.apache.poi.hpsf.IllegalPropertySetDataException: The property set claims
to have a size of 16 bytes. However, it exceeds 16 bytes.
	at org.apache.poi.hpsf.Section.<init>(Section.java:255)
	at org.apache.poi.hpsf.PropertySet.init(PropertySet.java:454)
	at org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:249)
	at
org.apache.poi.hpsf.PropertySetFactory.create(PropertySetFactory.java:61)
	at org.apache.poi.POIDocument.getPropertySet(POIDocument.java:92)
	at org.apache.poi.POIDocument.readProperties(POIDocument.java:69)
	at org.apache.poi.hwpf.HWPFDocument.<init>(HWPFDocument.java:147)
	at
org.apache.poi.hwpf.extractor.WordExtractor.<init>(WordExtractor.java:56)
	at
org.apache.poi.hwpf.extractor.WordExtractor.<init>(WordExtractor.java:48)
	at Indexer.indexFile(Indexer.java:76)
	at Indexer.indexDirectory(Indexer.java:57)
	at Indexer.index(Indexer.java:38)
	at Indexer.main(Indexer.java:20)

and my code is as follows:

	private static void indexFile(IndexWriter writer, File f) throws
IOException {
		if (f.isHidden() || !f.exists() || !f.canRead()) {
			return;
		}

		System.out.println("A acrescentar " + f.getCanonicalPath() + " ao
indice.");

		Document doc = new Document();
		
		// For .doc files
		if (f.getName().endsWith(".doc")){
			FileInputStream docfin = new FileInputStream(f.getAbsolutePath());
			WordExtractor docextractor = new WordExtractor(docfin);
			String content = docextractor.getText();
			doc.add(new Field("contents", content, Field.Store.NO,
Field.Index.TOKENIZED));			
		} // For .txt files
		else if (f.getName().endsWith(".txt")) {
			doc.add(new Field("contents", new FileReader(f)));
		}
		
		doc.add(new Field("filename", f.getCanonicalPath(), Field.Store.YES,
Field.Index.TOKENIZED));
		writer.addDocument(doc);
	}

(I think i included all that's necessary)
Thanks in advance for any help.
-- 
View this message in context: http://www.nabble.com/Problem-indexing-Word-Documents-tf4876643.html#a13954702
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31203-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 18:33:53 2007
Return-Path: <java-user-return-31203-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78985 invoked from network); 26 Nov 2007 18:33:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 18:33:53 -0000
Received: (qmail 56856 invoked by uid 500); 26 Nov 2007 18:33:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56831 invoked by uid 500); 26 Nov 2007 18:33:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56816 invoked by uid 99); 26 Nov 2007 18:33:35 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 10:33:35 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 18:33:16 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id D266771C1F3; Mon, 26 Nov 2007 10:33:18 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id C826971C1E1
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 10:33:18 -0800 (PST)
Date: Mon, 26 Nov 2007 10:33:18 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: Sorting and TopDocCollector
In-Reply-To: <718789d20711231246u4d763b43id0bc339f57a80ecb@mail.gmail.com>
Message-ID: <Pine.LNX.4.62.0711261028380.31836@radix.cryptio.net>
References: <718789d20711231246u4d763b43id0bc339f57a80ecb@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


:   I am using TopDocCollector in IndexerSearher.search(...) for get the
: BitSet of result, but I need of sort the result by two variable:  by
: any term of document and by score. Is possible do it using Collector ?
: 
:   Have any form of use the method search(..., sort) and after get the
: BitSet of result ?

the HitCollector APIs are lower level and somewhat orthoginal to the Sort 
based APIs ... the APIs thattake a HitCollector ar designed to give *your* 
HitCollector all of the matches with as little overhead as possible -- you 
are free to do anything you want in the HitCollector, including keep track 
of the "best" results based on a particular sort.

Perhaps instead of subclassing TopDocCollector, you should look at 
TopFielDocCollector?


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31204-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 18:36:53 2007
Return-Path: <java-user-return-31204-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 79588 invoked from network); 26 Nov 2007 18:36:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 18:36:53 -0000
Received: (qmail 66202 invoked by uid 500); 26 Nov 2007 18:36:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66170 invoked by uid 500); 26 Nov 2007 18:36:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66153 invoked by uid 99); 26 Nov 2007 18:36:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 10:36:26 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lucene@nitwit.de designates 80.67.29.8 as permitted sender)
Received: from [80.67.29.8] (HELO smtprelay08.ispgateway.de) (80.67.29.8)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 18:36:29 +0000
Received: (qmail 2969 invoked from network); 26 Nov 2007 18:36:08 -0000
Received: from unknown (HELO server.localdomain) ([pbs]153383@[85.178.241.167])
          (envelope-sender <lucene@nitwit.de>)
          by smtprelay08.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 26 Nov 2007 18:36:08 -0000
Received: from localhost (localhost [127.0.0.1])
	by server.localdomain (Postfix) with ESMTP id 0F1621B8E1A
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 19:36:11 +0100 (CET)
From: Timo Nentwig <lucene@nitwit.de>
To: java-user@lucene.apache.org
Subject: Re: Why exactly are fuzzy queries so slow?
Date: Mon, 26 Nov 2007 19:36:10 +0100
User-Agent: KMail/1.9.7
References: <200711241736.34876.lucene@nitwit.de> <200711251127.56874.lucene@nitwit.de> <47495457.9010401@yahoo.co.uk>
In-Reply-To: <47495457.9010401@yahoo.co.uk>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="utf-8"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711261936.10850.lucene@nitwit.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Sunday 25 November 2007 11:54:15 markharw00d wrote:
> For "fuzzy" you're going to pay one way or another.

But which one is the cheapest? :)

> You can use ngram analyzers on indexed content and queries which will
> add IO costs ("files" becomes "fi","fil", "file","il","ile","iles" in
> both your query and index) or you can use some form of query-time edit
> distance comparison on "files" and pay the CPU costs. You can use

The ngram approach is probably more powerful regarding the quality of the 
search result (rememberin the "Al Jazeera" example in LIA) however it will 
blow up the index in size tremendously.

Can somebody estimate whether it's more promising to keep the index as small 
as possible and hold it completely in a RAMDirectory (or MMapDirectory, 
LUCENE-1035 whatever)? What is it that takes the time in 
FuzzyQuery.rewrite() - IO or CPU? Or both?

> WordNet and "files" becomes "registers". You can examine large volumes
> of user queries and look at what is the most likely interpretation. You
> can use Soundex and then if you're lucky files==philes but there's no
> room for error and they either match or they dont - there is no measure
> of similarity.
>
> There's no free lunch here.
>
> Timo Nentwig wrote:
> > On Saturday 24 November 2007 18:28:48 markharw00d wrote:
> >> term. You can limit the number of edit distance comparisons conducted by
> >> setting the minimum prefix length. This is a property of the QueryParser
> >
> > Well, javadoc: "prefixLength - length of common (non-fuzzy) prefix". So,
> > this is some kind of "wildcard fuzzy" but not real fuzzy anymore.
> >
> > I understand the optimitation but right now I hardly can image a
> > reasonable use-case. Who care whether the levenstein distance is a the
> > beginnen, middle or end of word, .e.g when searching fuzzy for "philes" I
> > want to find "files"...
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31205-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 18:38:53 2007
Return-Path: <java-user-return-31205-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 80079 invoked from network); 26 Nov 2007 18:38:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 18:38:53 -0000
Received: (qmail 75148 invoked by uid 500); 26 Nov 2007 18:38:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75111 invoked by uid 500); 26 Nov 2007 18:38:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75085 invoked by uid 99); 26 Nov 2007 18:38:41 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 10:38:40 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.119] (HELO spunkymail-a19.g.dreamhost.com) (208.97.132.119)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 18:38:40 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a19.g.dreamhost.com (Postfix) with ESMTP id 9795711D2C
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 10:38:17 -0800 (PST)
Message-Id: <10F29974-C9A1-41BA-A23D-9440CFE82DF5@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <13954702.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Problem indexing Word Documents
Date: Mon, 26 Nov 2007 13:38:16 -0500
References: <13954702.post@talk.nabble.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

I would ask on the POI mailing list.  This doesn't look to be a  
problem with Lucene.

-Grant

On Nov 26, 2007, at 1:17 PM, chris.b wrote:

>
> okay, so i'm very new to lucene, so it may be my bad, but i can get  
> it to
> index .txt files, and when trying to index word documents (using  
> poi), the
> program starts running and when it reaches a .doc file, i get the  
> following
> errors:
>
> Exception in thread "main"
> org.apache.poi.hpsf.IllegalPropertySetDataException: The property  
> set claims
> to have a size of 16 bytes. However, it exceeds 16 bytes.
> 	at org.apache.poi.hpsf.Section.<init>(Section.java:255)
> 	at org.apache.poi.hpsf.PropertySet.init(PropertySet.java:454)
> 	at org.apache.poi.hpsf.PropertySet.<init>(PropertySet.java:249)
> 	at
> org 
> .apache.poi.hpsf.PropertySetFactory.create(PropertySetFactory.java:61)
> 	at org.apache.poi.POIDocument.getPropertySet(POIDocument.java:92)
> 	at org.apache.poi.POIDocument.readProperties(POIDocument.java:69)
> 	at org.apache.poi.hwpf.HWPFDocument.<init>(HWPFDocument.java:147)
> 	at
> org 
> .apache.poi.hwpf.extractor.WordExtractor.<init>(WordExtractor.java:56)
> 	at
> org 
> .apache.poi.hwpf.extractor.WordExtractor.<init>(WordExtractor.java:48)
> 	at Indexer.indexFile(Indexer.java:76)
> 	at Indexer.indexDirectory(Indexer.java:57)
> 	at Indexer.index(Indexer.java:38)
> 	at Indexer.main(Indexer.java:20)
>
> and my code is as follows:
>
> 	private static void indexFile(IndexWriter writer, File f) throws
> IOException {
> 		if (f.isHidden() || !f.exists() || !f.canRead()) {
> 			return;
> 		}
>
> 		System.out.println("A acrescentar " + f.getCanonicalPath() + " ao
> indice.");
>
> 		Document doc = new Document();
> 		
> 		// For .doc files
> 		if (f.getName().endsWith(".doc")){
> 			FileInputStream docfin = new FileInputStream(f.getAbsolutePath());
> 			WordExtractor docextractor = new WordExtractor(docfin);
> 			String content = docextractor.getText();
> 			doc.add(new Field("contents", content, Field.Store.NO,
> Field.Index.TOKENIZED));			
> 		} // For .txt files
> 		else if (f.getName().endsWith(".txt")) {
> 			doc.add(new Field("contents", new FileReader(f)));
> 		}
> 		
> 		doc.add(new Field("filename", f.getCanonicalPath(), Field.Store.YES,
> Field.Index.TOKENIZED));
> 		writer.addDocument(doc);
> 	}
>
> (I think i included all that's necessary)
> Thanks in advance for any help.
> -- 
> View this message in context: http://www.nabble.com/Problem-indexing-Word-Documents-tf4876643.html#a13954702
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31206-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 18:56:22 2007
Return-Path: <java-user-return-31206-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86039 invoked from network); 26 Nov 2007 18:56:22 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 18:56:22 -0000
Received: (qmail 16657 invoked by uid 500); 26 Nov 2007 18:56:03 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 16637 invoked by uid 500); 26 Nov 2007 18:56:03 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 16626 invoked by uid 99); 26 Nov 2007 18:56:03 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 10:56:03 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 18:55:41 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Iwj7Q-0002E8-9U
	for java-user@lucene.apache.org; Mon, 26 Nov 2007 10:55:44 -0800
Message-ID: <13955202.post@talk.nabble.com>
Date: Mon, 26 Nov 2007 10:55:44 -0800 (PST)
From: Orion Letizi <orion@terracotta.org>
To: java-user@lucene.apache.org
Subject: Re: Index: mixing the structure of persistence
In-Reply-To: <718789d20711260627k6f755c59s8dbe2ac67cf76cd7@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: orion@terracotta.org
References: <718789d20711240726r7eaf4a60s77c5e71ecde63619@mail.gmail.com> <359a92830711251255y95530f4h9a947eebfb91183f@mail.gmail.com> <718789d20711260627k6f755c59s8dbe2ac67cf76cd7@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Because Terracotta treats the Lucene indexes as cluster-wide shared objects,
updates to those indexes are made automatically available across the entire
cluster.

On one machine, a plain Lucene index will give you the in-memory caching and
spill-to-disk behavior you are looking for.  Terracotta will give you that
behavior across a cluster of machines.  I wouldn't compare the performance
of a plain Lucene index on one machine with the performance of a clustered
Lucene index on one machine.  Use Terracotta if you need the index available
on multiple machines; use plain Lucene if you want high-performance on a
single machine.

That said, if you need help setting up and tuning a  Terracotta-clustered
Lucene index for your use-case, you can visit the Terracotta forums: 

  http://forums.terracotta.org/

Cheers,
--Orion
http://www.terracotta.org/


Haroldo Nascimento wrote:
> 
> Hi,
> 
>   I have a very great volume of data (6.000.000 of documents) and I
> need to have a very fast search. I am thinking about using Terracotta
> (with Lucene) for clustering the solution.
> 
>   One of the advantages of the Terracotta is that part of the index is
> stored in memory and part is persisted em disk. If not to find in
> memory the application searchs in disk. This is transparent for the
> user. The problem would be in the process of updat of index.
> 
>   Another solution would be to persist the index using only Lucene,
> but I believe that the reply time very using disk either bigger that
> the solution in memory.
> 
>   You know some document comparative about the solution em memory
> (RAMDirectory) and solution em disk using Lucene?
> 
>   Tip: In another application I am using the solution index in memory
> (RAMDirectory), to initiate the process of load of the indice I
> serialized the RAMDirectory object. For it I need  insert "implements
> Serializable" in some classrooms of Lucene.
> 
> 
> 
> On Nov 25, 2007 5:55 PM, Erick Erickson <erickerickson@gmail.com> wrote:
>> As I understand, Lucene does a fair amount of caching of terms in
>> memory without you having to specify anything.
>>
>> But it's hard to see how your question relates. Remember that Lucene is
>> finding *all* matching docs. So searching in a RAMdirectory and then
>> searching in the file doesn't really seem possible since Lucene has to
>> search
>> the entire index every time to score the docs. It doesn't stop after
>> the first hit, since the next hit may score higher.
>>
>> But I'm sure Lucene *does* cache portions of the index in RAM when
>> possible, but I've never had occasion to dig into the details.
>>
>> Which leads me to ask "Why do you care?". Is there a specific
>> situation you're trying to get better performance from or is this more
>> of a background question? If you have a specific situation, please
>> describe
>> it in some detail so better minds than mine can give you a better
>> response <G>....
>>
>> Best
>> Erick
>>
>> On Nov 24, 2007 10:26 AM, Haroldo Nascimento <haroldo.araras@gmail.com>
>> wrote:
>>
>>
>> > Hi,
>> >
>> >  I have a question ?
>> >
>> >  Lucene offers a mixing structure of storage of index, that is, first
>> > do search in memoria (ARMDirectory) and in case of not found do search
>> > in index file automatically ? For example: Load part of index in
>> > memory for do the search fastest.
>> >
>> >  Thnaks
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> > For additional commands, e-mail: java-user-help@lucene.apache.org
>> >
>> >
>>
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Index%3A-mixing-the-structure-of-persistence-tf4866100.html#a13955202
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31207-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 22:25:45 2007
Return-Path: <java-user-return-31207-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65348 invoked from network); 26 Nov 2007 22:25:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 22:25:44 -0000
Received: (qmail 24024 invoked by uid 500); 26 Nov 2007 22:25:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 23995 invoked by uid 500); 26 Nov 2007 22:25:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 23984 invoked by uid 99); 26 Nov 2007 22:25:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 14:25:26 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 22:25:28 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IwmO3-0000qo-4Q
	for java-user@lucene.apache.org; Mon, 26 Nov 2007 14:25:07 -0800
Message-ID: <13960391.post@talk.nabble.com>
Date: Mon, 26 Nov 2007 14:25:07 -0800 (PST)
From: java_user_ <jkraemer@cs.tufts.edu>
To: java-user@lucene.apache.org
Subject: Re: Custom SynonymMap
In-Reply-To: <51ad89b20708171054x605742b3t7d86b7b12da66f86@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: jkraemer@cs.tufts.edu
References: <51ad89b20708171054x605742b3t7d86b7b12da66f86@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Were you able to find the post about a custom SynonymMap?


Antonius Ng-2 wrote:
> 
> Hi all,
> 
> I'd like to add more words into SynonymMap for my application, but the
> HashMap that holds all the words is not visible (private).
> 
> Is there any other Class that I can use to implement SynonymAnalyzer? I am
> using Lucene version 2.2.0
> 
> Antonius Ng
> 
> 

-- 
View this message in context: http://www.nabble.com/Custom-SynonymMap-tf4287265.html#a13960391
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31208-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 22:34:34 2007
Return-Path: <java-user-return-31208-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4997 invoked from network); 26 Nov 2007 22:34:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 22:34:34 -0000
Received: (qmail 36178 invoked by uid 500); 26 Nov 2007 22:34:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 36140 invoked by uid 500); 26 Nov 2007 22:34:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 36127 invoked by uid 99); 26 Nov 2007 22:34:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 14:34:15 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luz290@gmail.com designates 209.85.162.176 as permitted sender)
Received: from [209.85.162.176] (HELO el-out-1112.google.com) (209.85.162.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 22:33:56 +0000
Received: by el-out-1112.google.com with SMTP id m34so249035ele
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 14:33:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        bh=aNe8lkdSENFADiVhG9GEHGFV7AqOb/zbRUpXd+hH37I=;
        b=SaVtkWUcmyETaTlzL4nBvSYfmo2oNpyNmt6MAa54XuKfo0bxZ0UlP2rnkpCrtUJVzQTN4QEEQPYAMikMmJjwwUJetlLsEsHBUpfojYlBleUoWAXarNMx6dBpSRQDT/Xq/XW+PTcEOeOvVybGPlJOZPwK9IA8IB75Yhhm98z+DI8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:mime-version:content-type:content-transfer-encoding:content-disposition;
        b=MHsV3blPHgdIe4AP399hNMNmSiViyKhFJGlrWKsbtM2akciMrHQZ4IMrMNAdfigyNa/1nd88fshbjJECFaDlJCjRExuJD0IRrRHfiVLCsD8OSO2WVkJbTGr7cjHhfEckGr72lFzuXBrrJtTJbQWVx9JXwBsAx49uD8QyrtQ624o=
Received: by 10.142.84.3 with SMTP id h3mr716718wfb.1196116437861;
        Mon, 26 Nov 2007 14:33:57 -0800 (PST)
Received: by 10.142.225.3 with HTTP; Mon, 26 Nov 2007 14:33:57 -0800 (PST)
Message-ID: <cec089090711261433w5c60a838me066d60e20d1e749@mail.gmail.com>
Date: Mon, 26 Nov 2007 17:33:57 -0500
From: "lucene user" <luz290@gmail.com>
To: java-user@lucene.apache.org
Subject: Searching user-private annotations associated with indexed documents
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
X-Virus-Checked: Checked by ClamAV on apache.org

Folks

I have some additional textual data that is user specific, basically
annotations about documents. I would like to be able to do
**combined** searches, looking for some words in the document and some
in my users' private annotations about that document. Any suggestions
about how I should handle this? The annotations are changeable by
users at any time so we have to be ready to delete them and add others
at any time when the user does edit an annotation.

Do I need a second Lucene index? Can I do a query against two indexes
at the same time? If so, how?

The annotations will be very small but highly volatile. The database
of documents will grow large but nothing will be deleted from it.

Thanks!

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31209-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 23:32:35 2007
Return-Path: <java-user-return-31209-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 19932 invoked from network); 26 Nov 2007 23:32:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 23:32:35 -0000
Received: (qmail 92880 invoked by uid 500); 26 Nov 2007 23:32:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92846 invoked by uid 500); 26 Nov 2007 23:32:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92834 invoked by uid 99); 26 Nov 2007 23:32:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 15:32:16 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 64.233.162.238 as permitted sender)
Received: from [64.233.162.238] (HELO nz-out-0506.google.com) (64.233.162.238)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 23:31:57 +0000
Received: by nz-out-0506.google.com with SMTP id i28so510089nzi
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 15:31:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=zElPRitVM6FGGDrWYRiOqDjnvYycqxCrlchNezbBXs8=;
        b=k7Gj+AAQSkMkCiTODOpBUmpoGcKXwJayAws4fCy9heQf2ueJ+6xHkHrZ+gG0OqPKh10OuB0pYLGcp18mk2+MFx92EAMNTdPTgMcFNRmVAoX9RnA1Wzk2n9tuCqr5xypD7szs5Fg60M9IeTlYoex173yxxWkrtN9OS5zsozBd0EY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=fyyo8dOD21MawbWXEJ5Yn0vK+CeXv0sHe+pRspVlPWJLskO06SnfsM3lJUzM8Px8lQ7cDkiLSOdZr4CHUzKDzFoAiaqtGsuYex3NJf7FtaCjEZ0nvXccDVdOxazjG3S8fMKb2Wh6Wc5Et+IeGMN/UDmp6Z1smSiPlRgbshWpdJg=
Received: by 10.150.57.5 with SMTP id f5mr614589yba.1196119913410;
        Mon, 26 Nov 2007 15:31:53 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Mon, 26 Nov 2007 15:31:53 -0800 (PST)
Message-ID: <718789d20711261531l608b7b31sd0ab11fad6918470@mail.gmail.com>
Date: Mon, 26 Nov 2007 20:31:53 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Score: Randomize form
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5544_30330619.1196119913370"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5544_30330619.1196119913370
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi

  I show the results of searches as two criterios of sorting ("priority" and
to after "score") of each document.
  I need present the result with same score of ramdomize form.

 For example:

 *Result of search 1: *
keyword: hotel
POS  PRI  SCORE  DOC
1        5      100         A
2        4       90          B
3        4       80          C
4        4       70          D
5        2      120         E


 Result of search 2:
keyword: hotel
POS  PRI  SCORE  DOC
  1      5      100         A
  2      4       80          C (same score: change position)
  3      4       70          D (same score: change position)
  4      4       90          B (same score: change position)
  5      2      120         E

     I am using a class that extends Similarity, but I dont I know which
formulates to modify to change of the weight of score in random form.

  How I can modify the value of score in search time ?

------=_Part_5544_30330619.1196119913370--

From java-user-return-31210-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Mon Nov 26 23:43:38 2007
Return-Path: <java-user-return-31210-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 21734 invoked from network); 26 Nov 2007 23:43:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 26 Nov 2007 23:43:38 -0000
Received: (qmail 1169 invoked by uid 500); 26 Nov 2007 23:43:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1134 invoked by uid 500); 26 Nov 2007 23:43:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1123 invoked by uid 99); 26 Nov 2007 23:43:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 15:43:20 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luz290@gmail.com designates 64.233.166.176 as permitted sender)
Received: from [64.233.166.176] (HELO py-out-1112.google.com) (64.233.166.176)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 23:43:01 +0000
Received: by py-out-1112.google.com with SMTP id d32so3252100pye
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 15:43:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=afqm/lJqTQ2ckcPaI65NfrPZ+RFdcG4QHJomUt+hUNY=;
        b=M5i4ednJLUfh40Dxig8bQpQW9KoYUbq3yCU98lCob2vy6oiCEdiSpQNsBpbcJkfff80YlxvbVDa+hqaWG35sgPbA2ODAibykyLLpvPaJcoBJBr+C6zdoKrKKeeXay91O6h/hBnKikhYd3ykSc+0XSdJN3VQVDeWZmoXvyGCbtiY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=HBAbr6WKT9cCGqrve4HReEwIJwj2IgqCcqN2RRNJD5ocvsSeauGvGMG6ViDbw3lonO9E7GJ2kWyrMfqkEBJC6wZxL+Vds+bXOQyfQ494J9PBPPS2nhh6XCvxdTtsKxx3sBw/yguiYW/xIqQe407I42Ubs3EYuqx8yPJGATXIkJ0=
Received: by 10.142.217.17 with SMTP id p17mr720287wfg.1196120582441;
        Mon, 26 Nov 2007 15:43:02 -0800 (PST)
Received: by 10.142.225.3 with HTTP; Mon, 26 Nov 2007 15:43:02 -0800 (PST)
Message-ID: <cec089090711261543t3bf0faeewf74fdecf93dff05a@mail.gmail.com>
Date: Mon, 26 Nov 2007 18:43:02 -0500
From: "lucene user" <luz290@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Searching user-private annotations associated with indexed documents
In-Reply-To: <cec089090711261433w5c60a838me066d60e20d1e749@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <cec089090711261433w5c60a838me066d60e20d1e749@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Here are the three options that seem practical to us right now.

(1) Do The annotation search in postgres using LIKE or the
   postgres native full text search. Take the resulting list
   of file ids and use it to build a filter for the lucene query,
   the way we currently do for folders.

(2) Add a second lucene index that contains only annotations.
   First retrieve a list of file ids satisfying the annotation
   query from this index and use it to create a filter for the
   main lucene query on the archive.
   Whenever annotation text is edited,
     if blank, delete annotation from index
     otherwise add or replace annotation in index.

(3) Add a second lucene index that contains contentrefs.
    This index would contain the same fields as the arhicve index
    plus the following:
      database_id: list of systemuser_id and contentref_id.
      annotation:  list of all annotation text for this
                   system user and content ref.
      folders:     list of all folder names for this systemuser and
                   content ref

    Whenever an article is added to or removed from a folder,
    or its annotation text is edited, the following would occur:
      See if it has an entry in the lucene index for the database.
      if so,
        extract the lucene document from the index.
        if the updated list of folders that contain it is empty,
           delete this document from the lucene database index.
        otherwise,
          update the folder and annotation in the document object.
          delete this document from the index.
          add the updated document object to the index.
      if not,
        extract the lucene document for the article from the archive index
        add the database_id, folders, and annotation fields to this object
        add the document object to the lucene database index.

Got a better idea on this?

Thanks!!

On Nov 26, 2007 5:33 PM, lucene user <luz290@gmail.com> wrote:
> Folks
>
> I have some additional textual data that is user specific, basically
> annotations about documents. I would like to be able to do
> **combined** searches, looking for some words in the document and some
> in my users' private annotations about that document. Any suggestions
> about how I should handle this? The annotations are changeable by
> users at any time so we have to be ready to delete them and add others
> at any time when the user does edit an annotation.
>
> Do I need a second Lucene index? Can I do a query against two indexes
> at the same time? If so, how?
>
> The annotations will be very small but highly volatile. The database
> of documents will grow large but nothing will be deleted from it.
>
> Thanks!
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31211-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 00:21:55 2007
Return-Path: <java-user-return-31211-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 38186 invoked from network); 27 Nov 2007 00:21:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 00:21:55 -0000
Received: (qmail 26511 invoked by uid 500); 27 Nov 2007 00:21:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26471 invoked by uid 500); 27 Nov 2007 00:21:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26459 invoked by uid 99); 27 Nov 2007 00:21:37 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 16:21:37 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.188 as permitted sender)
Received: from [209.85.134.188] (HELO mu-out-0910.google.com) (209.85.134.188)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 00:21:17 +0000
Received: by mu-out-0910.google.com with SMTP id i10so1015051mue
        for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 16:21:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=ybqEUgstxGpa4RX2zT30hwsYu/QujIs3bDt0MyZcrVY=;
        b=v2MOIp4qWD8/0dSy1l9sTY63vcSEq7MwbwpR1aRbwEKJp/OiWwJ6CC+S11Xh7xzIrmt7OYn/l2rsXFwAjLuq2n1uQrrRbxvbdfkacXS1efxDZpXLMn6t6a1FO4UEZ2Y5k6ilJ+eH4FzHMTKokRvPH6gflnj+hek8kIrsMj0uepo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=MqXceHa1hztwefwa3sqq0p+bPCssd+Z+xDwxLy8Qo6svffl2GnKcZ0TeUQ9dvIohg3vX+/nXCeFUDoOWsoVrMIdliQJgECty6RQBNYkYVLMCw7ol7d9sgzt46Dj8O1MFduyOmLGobHmbLn2DWZs4GqypH5hGO1UP0wo6hjtFIWU=
Received: by 10.82.150.20 with SMTP id x20mr8892679bud.1196122878421;
        Mon, 26 Nov 2007 16:21:18 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Mon, 26 Nov 2007 16:21:18 -0800 (PST)
Message-ID: <359a92830711261621w1a2e5746w6a5a01a6a357cb70@mail.gmail.com>
Date: Mon, 26 Nov 2007 19:21:18 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Score: Randomize form
In-Reply-To: <718789d20711261531l608b7b31sd0ab11fad6918470@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_36724_21392781.1196122878416"
References: <718789d20711261531l608b7b31sd0ab11fad6918470@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_36724_21392781.1196122878416
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I think you have a couple of problems here. First, you'll have to
normalize the scores to get *any* of them to be the same. Since
the scores are a float, very few of them will be exactly the same.

I really suspect that you need to use a HitCollector (or TopDocs?)
and collect the hits into buckets, then randomize the results. I'd think
about doing your randomization as a post-process.

Which just also says that I have no idea where you'd handle modifying
the score at search time <G>...

Best
Erick

On Nov 26, 2007 6:31 PM, Haroldo Nascimento <haroldo.araras@gmail.com>
wrote:

> Hi
>
>  I show the results of searches as two criterios of sorting ("priority"
> and
> to after "score") of each document.
>  I need present the result with same score of ramdomize form.
>
>  For example:
>
>  *Result of search 1: *
> keyword: hotel
> POS  PRI  SCORE  DOC
> 1        5      100         A
> 2        4       90          B
> 3        4       80          C
> 4        4       70          D
> 5        2      120         E
>
>
>  Result of search 2:
> keyword: hotel
> POS  PRI  SCORE  DOC
>  1      5      100         A
>  2      4       80          C (same score: change position)
>  3      4       70          D (same score: change position)
>  4      4       90          B (same score: change position)
>  5      2      120         E
>
>     I am using a class that extends Similarity, but I dont I know which
> formulates to modify to change of the weight of score in random form.
>
>  How I can modify the value of score in search time ?
>

------=_Part_36724_21392781.1196122878416--

From java-user-return-31212-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 01:18:16 2007
Return-Path: <java-user-return-31212-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 59491 invoked from network); 27 Nov 2007 01:18:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 01:18:16 -0000
Received: (qmail 89543 invoked by uid 500); 27 Nov 2007 01:17:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89519 invoked by uid 500); 27 Nov 2007 01:17:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89508 invoked by uid 99); 27 Nov 2007 01:17:57 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 17:17:57 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 01:17:38 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id 206BB71C23E; Mon, 26 Nov 2007 17:17:40 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id 1C5D171C11E
	for <java-user@lucene.apache.org>; Mon, 26 Nov 2007 17:17:40 -0800 (PST)
Date: Mon, 26 Nov 2007 17:17:40 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: Lucene Users <java-user@lucene.apache.org>
Subject: Re: Score: Randomize form
In-Reply-To: <359a92830711261621w1a2e5746w6a5a01a6a357cb70@mail.gmail.com>
Message-ID: <Pine.LNX.4.62.0711261706050.26378@radix.cryptio.net>
References: <718789d20711261531l608b7b31sd0ab11fad6918470@mail.gmail.com>
 <359a92830711261621w1a2e5746w6a5a01a6a357cb70@mail.gmail.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: I think you have a couple of problems here. First, you'll have to
: normalize the scores to get *any* of them to be the same. Since
: the scores are a float, very few of them will be exactly the same.

it's not as rare as it seems, with lengthNorm byte encoding and low tf 
values it can happen quite a bit -- with a custom Siilarity you can *make*
it happen a lot.

: >  I show the results of searches as two criterios of sorting ("priority"
: > and
: > to after "score") of each document.
: >  I need present the result with same score of ramdomize form.

based on the example you gave, it sounds like you don't really want to 
sort on score at all ... you just want a randomized sort after sorting on 
the priority field.

Solr has a "RandomSortField" which contains a "RandomSort" class that 
don't think has any deep Solr dependencies ... it works by using the 
"field name" arg as a seed for randomizing the order of results, so you 
can iterate/paginate over a consistent "random" ordering as long as you keep 
resuing hte same name ... pick a differnet name everytime (use a counter, 
or a random number) and you'll get a different order.

you could use that as a secondary sort after your priority field (or a 
tertiary sort after score)


-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31213-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 06:55:59 2007
Return-Path: <java-user-return-31213-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45241 invoked from network); 27 Nov 2007 06:55:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 06:55:59 -0000
Received: (qmail 4482 invoked by uid 500); 27 Nov 2007 06:55:41 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4442 invoked by uid 500); 27 Nov 2007 06:55:41 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4431 invoked by uid 99); 27 Nov 2007 06:55:41 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 22:55:41 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [80.76.149.213] (HELO ch-smtp02.sth.basefarm.net) (80.76.149.213)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 06:55:21 +0000
Received: from c80-217-212-147.bredband.comhem.se ([80.217.212.147]:60189 helo=smtp.1und1.com)
	by ch-smtp02.sth.basefarm.net with esmtp (Exim 4.68)
	(envelope-from <hardy@ferentschik.de>)
	id 1IwuLr-0005Cv-7q
	for java-user@lucene.apache.org; Tue, 27 Nov 2007 07:55:23 +0100
Date: Tue, 27 Nov 2007 07:55:22 +0100
To: java-user@lucene.apache.org
Subject: RAMDirectory vs FSDirectory
From: "Hardy Ferentschik" <hardy@ferentschik.de>
Content-Type: text/plain; format=flowed; delsp=yes; charset=iso-8859-15
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Message-ID: <op.t2fuukcyvsesg3@smtp.1und1.com>
User-Agent: Opera Mail/9.22 (Win32)
X-Relayed-By: GPGrelay Version 0.959 (Win32)
X-Originating-IP: 80.217.212.147
X-Scan-Result: No virus found in message 1IwuLr-0005Cv-7q.
X-Scan-Signature: ch-smtp02.sth.basefarm.net 1IwuLr-0005Cv-7q 3aa94ed1a2146b59de3252e5499f4fbb
X-Virus-Checked: Checked by ClamAV on apache.org

Hi there,

I am using currently a FSDirectory to build my index. The reason for using  
a file system based index is that a full index rebuild takes around 30  
minutes and I want to keep a persistent index.
In 'Lucene in Action' I've read that one can improve search performance by  
using a RAMDirectory created from an underlying FSDirectory using one of  
the parameterised constructors. Is this correct? Will a FSDirectory not  
automatically load the index into memory provided enough RAM is available?  
Do I have to explicitly use a RAMDirectory?

--Hardy

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31214-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 07:29:19 2007
Return-Path: <java-user-return-31214-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53164 invoked from network); 27 Nov 2007 07:29:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 07:29:19 -0000
Received: (qmail 25599 invoked by uid 500); 27 Nov 2007 07:29:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 25551 invoked by uid 500); 27 Nov 2007 07:29:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 25540 invoked by uid 99); 27 Nov 2007 07:29:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 23:29:00 -0800
X-ASF-Spam-Status: No, hits=-1.0 required=10.0
	tests=RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [80.67.64.10] (HELO smtp2.akamai.com) (80.67.64.10)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 07:28:40 +0000
Received: from smtp1.akamai.com (vwall.kendall.corp.akamai.com [172.17.4.35])
	by smtp2.akamai.com (8.13.8/8.12.10) with ESMTP id lAR7Thhx003828
	for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 02:29:43 -0500 (EST)
Received: from USMA1EX-GATE1.kendall.corp.akamai.com (usma1ex-gate1.kendall.corp.akamai.com [172.17.0.215])
	by smtp1.akamai.com (8.13.8/8.12.10) with ESMTP id lAR7QTQc023393
	for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 02:26:29 -0500 (EST)
Received: from MAVS1.kendall.corp.akamai.com ([172.17.33.15]) by USMA1EX-GATE1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 27 Nov 2007 02:28:41 -0500
Received: from INVS1.bangalore.corp.akamai.com ([172.21.20.14]) by MAVS1.kendall.corp.akamai.com with Microsoft SMTPSVC(6.0.3790.1830);
	 Tue, 27 Nov 2007 02:28:40 -0500
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
Subject: RE: RAMDirectory vs FSDirectory
Date: Tue, 27 Nov 2007 12:58:37 +0530
Message-ID: <4FA8C6AEE609B644B38DE471A3657A62026E746B@INVS1.bangalore.corp.akamai.com>
In-Reply-To: <op.t2fuukcyvsesg3@smtp.1und1.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: RAMDirectory vs FSDirectory
Thread-Index: AcgwwpR3yLJvHPdYRHG9Djifuh2SzwAA20PQ
References: <op.t2fuukcyvsesg3@smtp.1und1.com>
From: "Chhabra, Kapil" <kchhabra@akamai.com>
To: <java-user@lucene.apache.org>
X-OriginalArrivalTime: 27 Nov 2007 07:28:40.0595 (UTC) FILETIME=[21EE4E30:01C830C7]
X-Virus-Checked: Checked by ClamAV on apache.org

> one can improve search performance by using a RAMDirectory created
from an underlying FSDirectory using one of the parameterised
constructors. Is this correct?
Absolutly

> Will a FSDirectory not automatically load the index into memory
provided enough RAM is available? =20
Not all index files are loaded in the RAM if you are using the
FSDirectory. Though at the same time, queries are cached.

> Do I have to explicitly use a RAMDirectory?
If you want to load the comeplte index in the memory, yes. This increase
the performance a lot as it drastically reduces the number of disk IO.
Obviously at the cost of the RAM. If you have enough RAM available to
accommodate the complete index, you can go ahead with this.

Regards,
kapilChhabra

-----Original Message-----
From: Hardy Ferentschik [mailto:hardy@ferentschik.de]=20
Sent: Tuesday, November 27, 2007 12:25 PM
To: java-user@lucene.apache.org
Subject: RAMDirectory vs FSDirectory

Hi there,

I am using currently a FSDirectory to build my index. The reason for
using a file system based index is that a full index rebuild takes
around 30 minutes and I want to keep a persistent index.
In 'Lucene in Action' I've read that one can improve search performance
by using a RAMDirectory created from an underlying FSDirectory using one
of the parameterised constructors. Is this correct? Will a FSDirectory
not automatically load the index into memory provided enough RAM is
available? =20
Do I have to explicitly use a RAMDirectory?

--Hardy

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31215-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 07:48:09 2007
Return-Path: <java-user-return-31215-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55820 invoked from network); 27 Nov 2007 07:48:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 07:48:09 -0000
Received: (qmail 39517 invoked by uid 500); 27 Nov 2007 07:47:50 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39480 invoked by uid 500); 27 Nov 2007 07:47:50 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39467 invoked by uid 99); 27 Nov 2007 07:47:50 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Nov 2007 23:47:50 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 07:47:53 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IwvAK-0005Sd-Mw
	for java-user@lucene.apache.org; Mon, 26 Nov 2007 23:47:32 -0800
Message-ID: <13966231.post@talk.nabble.com>
Date: Mon, 26 Nov 2007 23:47:32 -0800 (PST)
From: reeja <d.reeja@gmail.com>
To: java-user@lucene.apache.org
Subject: prefix query search problem if a hyphen exist in the search word
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: d.reeja@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,
 I faced some problem with prefix query search when the prefix text contains
a hyphen. i'm using lucene-2.1.
Search query is like this ttl:co-operative it returns more than 50 results,
but if i convert the query like this ttl:co-operat* it  returns no result.
again i entered a query ttl:11-amino it returns some results, then  changed
the above query into ttl:11-amino* it will return some more results than
previous query.
I think if a character or text appeared before the hyphen may  cause the
pbroblem, if the text before hyphen is a number its work fine.
anybody can help me to correct this problem.

Thanks
reeja


-- 
View this message in context: http://www.nabble.com/prefix-query-search-problem-if-a-hyphen-exist-in-the-search-word-tf4880266.html#a13966231
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31216-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 12:32:16 2007
Return-Path: <java-user-return-31216-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44355 invoked from network); 27 Nov 2007 12:32:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 12:32:16 -0000
Received: (qmail 39598 invoked by uid 500); 27 Nov 2007 12:31:58 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39284 invoked by uid 500); 27 Nov 2007 12:31:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39273 invoked by uid 99); 27 Nov 2007 12:31:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 04:31:56 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luz290@gmail.com designates 64.233.162.238 as permitted sender)
Received: from [64.233.162.238] (HELO nz-out-0506.google.com) (64.233.162.238)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 12:31:37 +0000
Received: by nz-out-0506.google.com with SMTP id i28so675239nzi
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 04:31:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=EPMiGt/8E5QdPB9yhVquiYmBnFQR/xCRBBTokyyMGYg=;
        b=PlKTA45bHMPlyGN72lUkcoy7zN1+334rGqaraKKqn1us1Ncu86ClXue8GIthEPjfjjBjHo3I5WwtFfHjijA+nj5qBPa3k+U7JYuq/r+4scXkRgXE/GWxsd81ZxdTxsFWe2fmbGSysVWjLxSXq0/WYvGRvOSpVBOLhrgJnkbGUEc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=Y52CpHl/dq3Q858EAklFpeQ+4HK9+yX6Au9piPsCeKolXIUE3NJXXB3/4nEyqs9AU8XrLv+MoNiSkz3Dtd6K+1kgpc2wU4jEKowbnOqQ1Djr21aHIcpZOA2XMIbgiUNRBMTM3IO2SD2AJnM6NRsIU1C4JGztOydajYjEOuIJTJ0=
Received: by 10.142.82.17 with SMTP id f17mr820067wfb.1196166698774;
        Tue, 27 Nov 2007 04:31:38 -0800 (PST)
Received: by 10.142.225.3 with HTTP; Tue, 27 Nov 2007 04:31:38 -0800 (PST)
Message-ID: <cec089090711270431k70d5ff4bmf6c3ad4472243190@mail.gmail.com>
Date: Tue, 27 Nov 2007 07:31:38 -0500
From: "lucene user" <luz290@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Searching user-private annotations associated with indexed documents
In-Reply-To: <cec089090711261543t3bf0faeewf74fdecf93dff05a@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <cec089090711261433w5c60a838me066d60e20d1e749@mail.gmail.com>
	 <cec089090711261543t3bf0faeewf74fdecf93dff05a@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I'd be VERY grateful for your help, folks! Thanks! I really need some
insight on this. THANKS!!

On Nov 26, 2007 6:43 PM, lucene user <luz290@gmail.com> wrote:
> Here are the three options that seem practical to us right now.
>
> (1) Do The annotation search in postgres using LIKE or the
>    postgres native full text search. Take the resulting list
>    of file ids and use it to build a filter for the lucene query,
>    the way we currently do for folders.
>
> (2) Add a second lucene index that contains only annotations.
>    First retrieve a list of file ids satisfying the annotation
>    query from this index and use it to create a filter for the
>    main lucene query on the archive.
>    Whenever annotation text is edited,
>      if blank, delete annotation from index
>      otherwise add or replace annotation in index.
>
> (3) Add a second lucene index that contains contentrefs.
>     This index would contain the same fields as the arhicve index
>     plus the following:
>       database_id: list of systemuser_id and contentref_id.
>       annotation:  list of all annotation text for this
>                    system user and content ref.
>       folders:     list of all folder names for this systemuser and
>                    content ref
>
>     Whenever an article is added to or removed from a folder,
>     or its annotation text is edited, the following would occur:
>       See if it has an entry in the lucene index for the database.
>       if so,
>         extract the lucene document from the index.
>         if the updated list of folders that contain it is empty,
>            delete this document from the lucene database index.
>         otherwise,
>           update the folder and annotation in the document object.
>           delete this document from the index.
>           add the updated document object to the index.
>       if not,
>         extract the lucene document for the article from the archive index
>         add the database_id, folders, and annotation fields to this object
>         add the document object to the lucene database index.
>
> Got a better idea on this?
>
> Thanks!!
>
>
> On Nov 26, 2007 5:33 PM, lucene user <luz290@gmail.com> wrote:
> > Folks
> >
> > I have some additional textual data that is user specific, basically
> > annotations about documents. I would like to be able to do
> > **combined** searches, looking for some words in the document and some
> > in my users' private annotations about that document. Any suggestions
> > about how I should handle this? The annotations are changeable by
> > users at any time so we have to be ready to delete them and add others
> > at any time when the user does edit an annotation.
> >
> > Do I need a second Lucene index? Can I do a query against two indexes
> > at the same time? If so, how?
> >
> > The annotations will be very small but highly volatile. The database
> > of documents will grow large but nothing will be deleted from it.
> >
> > Thanks!
> >
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31217-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 12:54:40 2007
Return-Path: <java-user-return-31217-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49062 invoked from network); 27 Nov 2007 12:54:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 12:54:40 -0000
Received: (qmail 66673 invoked by uid 500); 27 Nov 2007 12:54:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66645 invoked by uid 500); 27 Nov 2007 12:54:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66634 invoked by uid 99); 27 Nov 2007 12:54:21 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 04:54:21 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy includes SPF record at spf.trusted-forwarder.org)
Received: from [217.12.10.85] (HELO web26011.mail.ukl.yahoo.com) (217.12.10.85)
    by apache.org (qpsmtpd/0.29) with SMTP; Tue, 27 Nov 2007 12:54:01 +0000
Received: (qmail 44702 invoked by uid 60001); 27 Nov 2007 12:54:02 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=X-YMail-OSG:Received:X-Mailer:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=qTuAuKrd7Xg9b+eF1SMYCTDfRLpmc3/BxXui7tusA95+aCGimqIIHakFOo1O5DmLri0yA63TacvYRAGFRMcumz5uXpB60t8HWVJ42qT1OwpPPqA/6ypJrYPSp2kJQKz0jtpr/M5Fcj5p7dSriFi7sx09v4wtwkHbR2qH8txFL58=;
X-YMail-OSG: bt9JJ04VM1nMWSz5dF7LLC7EKQTW7a7.vgikUBDe2t_IRseNFyBkECCb1.b69oyRHA--
Received: from [193.36.230.96] by web26011.mail.ukl.yahoo.com via HTTP; Tue, 27 Nov 2007 12:54:01 GMT
X-Mailer: YahooMailRC/818.27 YahooMailWebService/0.7.157
Date: Tue, 27 Nov 2007 12:54:01 +0000 (GMT)
From: mark harwood <markharw00d@yahoo.co.uk>
Subject: Re: Searching user-private annotations associated with indexed documents
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Message-ID: <59899.43620.qm@web26011.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Do the annotations have positions ?=0A=0ADo you want to do things like phra=
se-search e.g. =0A     "PERSON_ANNOTATION works for Google" =0A=0AOr is you=
r idea of an annotation more simply a del.ici.ous-style tag associated with=
 the whole document?=0A=0ACheers=0AMark=0A=0A----- Original Message ----=0A=
From: lucene user <luz290@gmail.com>=0ATo: java-user@lucene.apache.org=0ASe=
nt: Tuesday, 27 November, 2007 12:31:38 PM=0ASubject: Re: Searching user-pr=
ivate annotations associated with indexed documents=0A=0AI'd be VERY gratef=
ul for your help, folks! Thanks! I really need some=0Ainsight on this. THAN=
KS!!=0A=0AOn Nov 26, 2007 6:43 PM, lucene user <luz290@gmail.com> wrote:=0A=
> Here are the three options that seem practical to us right now.=0A>=0A> (=
1) Do The annotation search in postgres using LIKE or the=0A>    postgres n=
ative full text search. Take the resulting list=0A>    of file ids and use =
it to build a filter for the lucene query,=0A>    the way we currently do f=
or folders.=0A>=0A> (2) Add a second lucene index that contains only annota=
tions.=0A>    First retrieve a list of file ids satisfying the annotation=
=0A>    query from this index and use it to create a filter for the=0A>    =
main lucene query on the archive.=0A>    Whenever annotation text is edited=
,=0A>      if blank, delete annotation from index=0A>      otherwise add or=
 replace annotation in index.=0A>=0A> (3) Add a second lucene index that co=
ntains contentrefs.=0A>     This index would contain the same fields as the=
 arhicve index=0A>     plus the following:=0A>       database_id: list of s=
ystemuser_id and contentref_id.=0A>       annotation:  list of all annotati=
on text for this=0A>                    system user and content ref.=0A>   =
    folders:     list of all folder names for this systemuser and=0A>      =
              content ref=0A>=0A>     Whenever an article is added to or re=
moved from a folder,=0A>     or its annotation text is edited, the followin=
g would occur:=0A>       See if it has an entry in the lucene index for the=
 database.=0A>       if so,=0A>         extract the lucene document from th=
e index.=0A>         if the updated list of folders that contain it is empt=
y,=0A>            delete this document from the lucene database index.=0A> =
        otherwise,=0A>           update the folder and annotation in the do=
cument object.=0A>           delete this document from the index.=0A>      =
     add the updated document object to the index.=0A>       if not,=0A>   =
      extract the lucene document for the article from the archive=0A index=
=0A>         add the database_id, folders, and annotation fields to this=0A=
 object=0A>         add the document object to the lucene database index.=
=0A>=0A> Got a better idea on this?=0A>=0A> Thanks!!=0A>=0A>=0A> On Nov 26,=
 2007 5:33 PM, lucene user <luz290@gmail.com> wrote:=0A> > Folks=0A> >=0A> =
> I have some additional textual data that is user specific,=0A basically=
=0A> > annotations about documents. I would like to be able to do=0A> > **c=
ombined** searches, looking for some words in the document and=0A some=0A> =
> in my users' private annotations about that document. Any=0A suggestions=
=0A> > about how I should handle this? The annotations are changeable by=0A=
> > users at any time so we have to be ready to delete them and add=0A othe=
rs=0A> > at any time when the user does edit an annotation.=0A> >=0A> > Do =
I need a second Lucene index? Can I do a query against two=0A indexes=0A> >=
 at the same time? If so, how?=0A> >=0A> > The annotations will be very sma=
ll but highly volatile. The=0A database=0A> > of documents will grow large =
but nothing will be deleted from it.=0A> >=0A> > Thanks!=0A> >=0A>=0A=0A---=
------------------------------------------------------------------=0ATo uns=
ubscribe, e-mail: java-user-unsubscribe@lucene.apache.org=0AFor additional =
commands, e-mail: java-user-help@lucene.apache.org=0A=0A=0A=0A=0A=0A=0A    =
  ___________________________________________________________=0AYahoo! Answ=
ers - Got a question? Someone out there knows the answer. Try it=0Anow.=0Ah=
ttp://uk.answers.yahoo.com/ 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31218-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 14:36:40 2007
Return-Path: <java-user-return-31218-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 84735 invoked from network); 27 Nov 2007 14:36:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 14:36:40 -0000
Received: (qmail 5864 invoked by uid 500); 27 Nov 2007 14:36:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 5831 invoked by uid 500); 27 Nov 2007 14:36:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 5820 invoked by uid 99); 27 Nov 2007 14:36:20 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 06:36:20 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 64.233.170.190 as permitted sender)
Received: from [64.233.170.190] (HELO rn-out-0102.google.com) (64.233.170.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 14:36:01 +0000
Received: by rn-out-0102.google.com with SMTP id v46so683307rnb
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 06:36:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=4YmT2YjXsTRSn07hjZC/OKdzbtPnZc5+MmVML6/q5TI=;
        b=oWAjh6315GUynjHxj7iEs2wPm7HWAt6+nVo00E/VgZ3oefxOLYkKtiuvlRQ/H7sapYaIGPMpyAKyYIHShd6qfImJ9nT/pMHKxp8FV0e9j50ozVnKFUS5suWFXh3La8A+dP+d6f7fZjEqNsi+b9tnde1RLb2x0mOf0y+UfXLnavk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=IinlmGjsEiBZ9Z9FN9l2YePCTeuej4bzb60YKUBDRo6xsW2DhXNzVQiVN4JNaEEfG6Po9D90VGgoh+hfvsDwh2mO7iyACOSoHzA4B+d15BRlLVm11/8J/kzI516K0GFvdXeBs+sZYV7vXzsZsa+zPvgU2Z9u++tetNcR+wZjz5Y=
Received: by 10.150.191.10 with SMTP id o10mr854713ybf.1196174163769;
        Tue, 27 Nov 2007 06:36:03 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Tue, 27 Nov 2007 06:36:03 -0800 (PST)
Message-ID: <718789d20711270636r722029do5982111bb80f59c@mail.gmail.com>
Date: Tue, 27 Nov 2007 11:36:03 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: RAMDirectory vs FSDirectory
In-Reply-To: <4FA8C6AEE609B644B38DE471A3657A62026E746B@INVS1.bangalore.corp.akamai.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5972_25061789.1196174163766"
References: <op.t2fuukcyvsesg3@smtp.1und1.com>
	 <4FA8C6AEE609B644B38DE471A3657A62026E746B@INVS1.bangalore.corp.akamai.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5972_25061789.1196174163766
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

You can serialize this object RAMDirectory em disk. When start the
application , it read the file .ser and load the object in memory.
The time of load of file .ser is much fast.
You need change any classes of Lucece: Add the "implements Serialzable" in
any classes.



On Nov 27, 2007 4:28 AM, Chhabra, Kapil <kchhabra@akamai.com> wrote:

> > one can improve search performance by using a RAMDirectory created
> from an underlying FSDirectory using one of the parameterised
> constructors. Is this correct?
> Absolutly
>
> > Will a FSDirectory not automatically load the index into memory
> provided enough RAM is available?
> Not all index files are loaded in the RAM if you are using the
> FSDirectory. Though at the same time, queries are cached.
>
> > Do I have to explicitly use a RAMDirectory?
> If you want to load the comeplte index in the memory, yes. This increase
> the performance a lot as it drastically reduces the number of disk IO.
> Obviously at the cost of the RAM. If you have enough RAM available to
> accommodate the complete index, you can go ahead with this.
>
> Regards,
> kapilChhabra
>
> -----Original Message-----
> From: Hardy Ferentschik [mailto:hardy@ferentschik.de]
> Sent: Tuesday, November 27, 2007 12:25 PM
> To: java-user@lucene.apache.org
> Subject: RAMDirectory vs FSDirectory
>
> Hi there,
>
> I am using currently a FSDirectory to build my index. The reason for
> using a file system based index is that a full index rebuild takes
> around 30 minutes and I want to keep a persistent index.
> In 'Lucene in Action' I've read that one can improve search performance
> by using a RAMDirectory created from an underlying FSDirectory using one
> of the parameterised constructors. Is this correct? Will a FSDirectory
> not automatically load the index into memory provided enough RAM is
> available?
> Do I have to explicitly use a RAMDirectory?
>
> --Hardy
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5972_25061789.1196174163766--

From java-user-return-31219-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 14:44:53 2007
Return-Path: <java-user-return-31219-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 86251 invoked from network); 27 Nov 2007 14:44:53 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 14:44:53 -0000
Received: (qmail 21745 invoked by uid 500); 27 Nov 2007 14:44:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 21711 invoked by uid 500); 27 Nov 2007 14:44:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 21700 invoked by uid 99); 27 Nov 2007 14:44:33 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 06:44:33 -0800
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [209.85.132.241] (HELO an-out-0708.google.com) (209.85.132.241)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 14:44:14 +0000
Received: by an-out-0708.google.com with SMTP id c5so209246anc
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 06:44:15 -0800 (PST)
Received: by 10.100.57.6 with SMTP id f6mr6645093ana.1196174655549;
        Tue, 27 Nov 2007 06:44:15 -0800 (PST)
Received: by 10.90.82.3 with HTTP; Tue, 27 Nov 2007 06:44:15 -0800 (PST)
Message-ID: <962ea6660711270644w6696f685g4c5f511e587cc6cc@mail.gmail.com>
Date: Tue, 27 Nov 2007 06:44:15 -0800
From: "Bogdan Ghidireac" <bogdan@ecstend.com>
To: java-user@lucene.apache.org
Subject: CheckIndex tool issues
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1997_21590061.1196174655540"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1997_21590061.1196174655540
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi,

I tried to use the CheckIndex tool (the latest svn code) and I was surprised
to notice that all my indexes from production (around 30) are corrupt. This
is highly unlikely because they were running for about one year and I had no
exception during search so far.

One recurring pattern I observed is that the tool reports the segments with
deleted docs as corrupt. The one without deleted docs are fine.. Here is a
sample output.

index 1

  6 of 7: name=_wxlp docCount=1001
    compound=true
    numFiles=1
    size (MB)=0.213
    no deletions
    test: open reader.........OK
    test: fields, norms.......OK [12 fields]
    test: terms, freq, prox...OK [4142 terms; 8004 terms/docs pairs; 8006
tokens]
    test: stored fields.......OK [12012 total field count; avg 12 fields per
doc]
    test: term vectors........OK [0 total vector count; avg 0 term/freq
vector fields per doc]

  7 of 7: name=_wxqg docCount=178
    compound=true
    numFiles=1
    size (MB)=0.039
    no deletions
    test: open reader.........OK
    test: fields, norms.......OK [12 fields]
    test: terms, freq, prox...OK [819 terms; 1417 terms/docs pairs; 1417
tokens]
    test: stored fields.......OK [2136 total field count; avg 12 fields per
doc]
    test: term vectors........OK [0 total vector count; avg 0 term/freq
vector fields per doc]

index 2

  6 of 7: name=_10hr docCount=1978
    compound=true
    numFiles=2
    size (MB)=3.601
    has deletions [delFileName=_10hr_5.del]
    test: open reader.........OK [17 deleted docs]
    test: fields, norms.......OK [10 fields]
    test: terms, freq, prox...FAILED
    WARNING: would remove reference to this segment (-fix was not
specified); full exception:
java.lang.RuntimeException: term ASIN:342678033X docFreq=5 != num docs seen
4
        at org.apache.lucene.index.CheckIndex.main(CheckIndex.java:217)

  7 of 7: name=_10i0 docCount=196
    compound=true
    numFiles=1
    size (MB)=0.44
    no deletions
    test: open reader.........OK
    test: fields, norms.......OK [10 fields]
    test: terms, freq, prox...OK [8611 terms; 24307 terms/docs pairs; 32841
tokens]
    test: stored fields.......OK [1960 total field count; avg 10 fields per
doc]
    test: term vectors........OK [0 total vector count; avg 0 term/freq
vector fields per doc]


Is this a known issue or my indexes are really corrupt ?

Regards,
Bogdan

------=_Part_1997_21590061.1196174655540--

From java-user-return-31220-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 14:50:51 2007
Return-Path: <java-user-return-31220-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88716 invoked from network); 27 Nov 2007 14:50:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 14:50:51 -0000
Received: (qmail 48091 invoked by uid 500); 27 Nov 2007 14:50:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 48062 invoked by uid 500); 27 Nov 2007 14:50:30 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 48051 invoked by uid 99); 27 Nov 2007 14:50:30 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 06:50:30 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 14:50:10 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 6C9C75806B
	for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 09:50:11 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Tue, 27 Nov 2007 09:50:11 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 3FFD1463; Tue, 27 Nov 2007 09:50:11 -0500 (EST)
Message-Id: <1196175011.19543.1223475441@webmail.messagingengine.com>
X-Sasl-Enc: kpsapOnx8WrN3CC8cBLrvb/iGh+xXEs9lQQ7KuYQD58k 1196175011
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <962ea6660711270644w6696f685g4c5f511e587cc6cc@mail.gmail.com>
Subject: Re: CheckIndex tool issues
In-Reply-To: <962ea6660711270644w6696f685g4c5f511e587cc6cc@mail.gmail.com>
Date: Tue, 27 Nov 2007 09:50:11 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


Woops!  You are right, this is a silly bug in the CheckIndex tool.  It is not
properly taking into account deletions.  I will open an issue & fix it.

Thanks for testing & reporting this, and sorry about that.

Mike

"Bogdan Ghidireac" <bogdan@ecstend.com> wrote:
> Hi,
> 
> I tried to use the CheckIndex tool (the latest svn code) and I was
> surprised
> to notice that all my indexes from production (around 30) are corrupt.
> This
> is highly unlikely because they were running for about one year and I had
> no
> exception during search so far.
> 
> One recurring pattern I observed is that the tool reports the segments
> with
> deleted docs as corrupt. The one without deleted docs are fine.. Here is
> a
> sample output.
> 
> index 1
> 
>   6 of 7: name=_wxlp docCount=1001
>     compound=true
>     numFiles=1
>     size (MB)=0.213
>     no deletions
>     test: open reader.........OK
>     test: fields, norms.......OK [12 fields]
>     test: terms, freq, prox...OK [4142 terms; 8004 terms/docs pairs; 8006
> tokens]
>     test: stored fields.......OK [12012 total field count; avg 12 fields
>     per
> doc]
>     test: term vectors........OK [0 total vector count; avg 0 term/freq
> vector fields per doc]
> 
>   7 of 7: name=_wxqg docCount=178
>     compound=true
>     numFiles=1
>     size (MB)=0.039
>     no deletions
>     test: open reader.........OK
>     test: fields, norms.......OK [12 fields]
>     test: terms, freq, prox...OK [819 terms; 1417 terms/docs pairs; 1417
> tokens]
>     test: stored fields.......OK [2136 total field count; avg 12 fields
>     per
> doc]
>     test: term vectors........OK [0 total vector count; avg 0 term/freq
> vector fields per doc]
> 
> index 2
> 
>   6 of 7: name=_10hr docCount=1978
>     compound=true
>     numFiles=2
>     size (MB)=3.601
>     has deletions [delFileName=_10hr_5.del]
>     test: open reader.........OK [17 deleted docs]
>     test: fields, norms.......OK [10 fields]
>     test: terms, freq, prox...FAILED
>     WARNING: would remove reference to this segment (-fix was not
> specified); full exception:
> java.lang.RuntimeException: term ASIN:342678033X docFreq=5 != num docs
> seen
> 4
>         at org.apache.lucene.index.CheckIndex.main(CheckIndex.java:217)
> 
>   7 of 7: name=_10i0 docCount=196
>     compound=true
>     numFiles=1
>     size (MB)=0.44
>     no deletions
>     test: open reader.........OK
>     test: fields, norms.......OK [10 fields]
>     test: terms, freq, prox...OK [8611 terms; 24307 terms/docs pairs;
>     32841
> tokens]
>     test: stored fields.......OK [1960 total field count; avg 10 fields
>     per
> doc]
>     test: term vectors........OK [0 total vector count; avg 0 term/freq
> vector fields per doc]
> 
> 
> Is this a known issue or my indexes are really corrupt ?
> 
> Regards,
> Bogdan

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31221-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 14:53:26 2007
Return-Path: <java-user-return-31221-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 89375 invoked from network); 27 Nov 2007 14:53:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 14:53:26 -0000
Received: (qmail 55350 invoked by uid 500); 27 Nov 2007 14:53:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55321 invoked by uid 500); 27 Nov 2007 14:53:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55310 invoked by uid 99); 27 Nov 2007 14:53:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 06:53:06 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a8.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 14:53:05 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a8.g.dreamhost.com (Postfix) with ESMTP id 6174D10BAEF
	for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 06:52:43 -0800 (PST)
Message-Id: <6C3A4EB2-C853-4353-9307-31A60681D7A8@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <718789d20711270636r722029do5982111bb80f59c@mail.gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: RAMDirectory vs FSDirectory
Date: Tue, 27 Nov 2007 09:52:42 -0500
References: <op.t2fuukcyvsesg3@smtp.1und1.com> <4FA8C6AEE609B644B38DE471A3657A62026E746B@INVS1.bangalore.corp.akamai.com> <718789d20711270636r722029do5982111bb80f59c@mail.gmail.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

RAMDirectory has a constructor that takes in another Directory and  
loads it into memory.  No Serialization necessary.  Just index to a  
FSDirectory using Lucene's normal indexing methods (it takes care of  
buffering them internally) and then load the FSDirectory into a  
RAMDirectory.  Have a look at the Javadocs for RAMDirectory to see how  
to do this.

-Grant

On Nov 27, 2007, at 9:36 AM, Haroldo Nascimento wrote:

> You can serialize this object RAMDirectory em disk. When start the
> application , it read the file .ser and load the object in memory.
> The time of load of file .ser is much fast.
> You need change any classes of Lucece: Add the "implements  
> Serialzable" in
> any classes.
>
>
>
> On Nov 27, 2007 4:28 AM, Chhabra, Kapil <kchhabra@akamai.com> wrote:
>
>>> one can improve search performance by using a RAMDirectory created
>> from an underlying FSDirectory using one of the parameterised
>> constructors. Is this correct?
>> Absolutly
>>
>>> Will a FSDirectory not automatically load the index into memory
>> provided enough RAM is available?
>> Not all index files are loaded in the RAM if you are using the
>> FSDirectory. Though at the same time, queries are cached.
>>
>>> Do I have to explicitly use a RAMDirectory?
>> If you want to load the comeplte index in the memory, yes. This  
>> increase
>> the performance a lot as it drastically reduces the number of disk  
>> IO.
>> Obviously at the cost of the RAM. If you have enough RAM available to
>> accommodate the complete index, you can go ahead with this.
>>
>> Regards,
>> kapilChhabra
>>
>> -----Original Message-----
>> From: Hardy Ferentschik [mailto:hardy@ferentschik.de]
>> Sent: Tuesday, November 27, 2007 12:25 PM
>> To: java-user@lucene.apache.org
>> Subject: RAMDirectory vs FSDirectory
>>
>> Hi there,
>>
>> I am using currently a FSDirectory to build my index. The reason for
>> using a file system based index is that a full index rebuild takes
>> around 30 minutes and I want to keep a persistent index.
>> In 'Lucene in Action' I've read that one can improve search  
>> performance
>> by using a RAMDirectory created from an underlying FSDirectory  
>> using one
>> of the parameterised constructors. Is this correct? Will a  
>> FSDirectory
>> not automatically load the index into memory provided enough RAM is
>> available?
>> Do I have to explicitly use a RAMDirectory?
>>
>> --Hardy
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31222-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 15:10:14 2007
Return-Path: <java-user-return-31222-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 94533 invoked from network); 27 Nov 2007 15:10:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 15:10:14 -0000
Received: (qmail 92812 invoked by uid 500); 27 Nov 2007 15:09:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 92418 invoked by uid 500); 27 Nov 2007 15:09:55 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 92407 invoked by uid 99); 27 Nov 2007 15:09:55 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 07:09:55 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of german.kondolf@gmail.com designates 209.85.146.183 as permitted sender)
Received: from [209.85.146.183] (HELO wa-out-1112.google.com) (209.85.146.183)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 15:09:36 +0000
Received: by wa-out-1112.google.com with SMTP id j40so1409740wah
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 07:09:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=fNHHP3lwwwRyEFJH9JkgpuhNOIaSrVzZQ9IRpsTwIiY=;
        b=ENArqAe8yyd8uyE0fspkTkbdtlRSHB+OsF2Lpnk90DHpPdqYXEVl8WZxcRYZWvt04Y8OplDRr8JNBMbmQ7Vy2MDxuuG/y6/W8L+X1pwlX58KZCQ6j8tZrwLWLo/hMGW7+1hXLnmGQOh5sXTQcGh+SaTo9//g3atBOlCxMtM+Euc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=m5MhLmwQsNhdicvOXZu4l2omFHm06/5DwfUyeQ2yLhBFxInd3z97fI0Y2HgyL0VGJsn5hY6V1nTG53k83XWg7JYqhxKN9VBrrBzhS4+4EECJPb023yvP0DGLdzxfQmpr0lijAmVkBjardJeIcJ52bfZVsTg9MFfz38xWdcGn3yI=
Received: by 10.114.199.1 with SMTP id w1mr1516750waf.1196176178627;
        Tue, 27 Nov 2007 07:09:38 -0800 (PST)
Received: by 10.114.124.18 with HTTP; Tue, 27 Nov 2007 07:09:38 -0800 (PST)
Message-ID: <76df56980711270709x158ee345u2bd1f7b5d14dd099@mail.gmail.com>
Date: Tue, 27 Nov 2007 12:09:38 -0300
From: "German Kondolf" <german.kondolf@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: RAMDirectory vs FSDirectory
In-Reply-To: <718789d20711270636r722029do5982111bb80f59c@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <op.t2fuukcyvsesg3@smtp.1und1.com>
	 <4FA8C6AEE609B644B38DE471A3657A62026E746B@INVS1.bangalore.corp.akamai.com>
	 <718789d20711270636r722029do5982111bb80f59c@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

There is a constructor in the RAMDirectory that already does that.
http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/store/RAMDirectory.html

I don't think that worth modify the internal Lucene's code to achieve
a extra bit of performance...
What would you do on next version? Modify it again?

On Nov 27, 2007 11:36 AM, Haroldo Nascimento <haroldo.araras@gmail.com> wrote:
> You can serialize this object RAMDirectory em disk. When start the
> application , it read the file .ser and load the object in memory.
> The time of load of file .ser is much fast.
> You need change any classes of Lucece: Add the "implements Serialzable" in
> any classes.
>
>
>
>
> On Nov 27, 2007 4:28 AM, Chhabra, Kapil <kchhabra@akamai.com> wrote:
>
> > > one can improve search performance by using a RAMDirectory created
> > from an underlying FSDirectory using one of the parameterised
> > constructors. Is this correct?
> > Absolutly
> >
> > > Will a FSDirectory not automatically load the index into memory
> > provided enough RAM is available?
> > Not all index files are loaded in the RAM if you are using the
> > FSDirectory. Though at the same time, queries are cached.
> >
> > > Do I have to explicitly use a RAMDirectory?
> > If you want to load the comeplte index in the memory, yes. This increase
> > the performance a lot as it drastically reduces the number of disk IO.
> > Obviously at the cost of the RAM. If you have enough RAM available to
> > accommodate the complete index, you can go ahead with this.
> >
> > Regards,
> > kapilChhabra
> >
> > -----Original Message-----
> > From: Hardy Ferentschik [mailto:hardy@ferentschik.de]
> > Sent: Tuesday, November 27, 2007 12:25 PM
> > To: java-user@lucene.apache.org
> > Subject: RAMDirectory vs FSDirectory
> >
> > Hi there,
> >
> > I am using currently a FSDirectory to build my index. The reason for
> > using a file system based index is that a full index rebuild takes
> > around 30 minutes and I want to keep a persistent index.
> > In 'Lucene in Action' I've read that one can improve search performance
> > by using a RAMDirectory created from an underlying FSDirectory using one
> > of the parameterised constructors. Is this correct? Will a FSDirectory
> > not automatically load the index into memory provided enough RAM is
> > available?
> > Do I have to explicitly use a RAMDirectory?
> >
> > --Hardy
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31223-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 15:24:35 2007
Return-Path: <java-user-return-31223-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 772 invoked from network); 27 Nov 2007 15:24:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 15:24:35 -0000
Received: (qmail 14996 invoked by uid 500); 27 Nov 2007 15:24:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14967 invoked by uid 500); 27 Nov 2007 15:24:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14956 invoked by uid 99); 27 Nov 2007 15:24:15 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 07:24:15 -0800
X-ASF-Spam-Status: No, hits=2.2 required=10.0
	tests=HTML_MESSAGE,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 64.233.182.190 as permitted sender)
Received: from [64.233.182.190] (HELO nf-out-0910.google.com) (64.233.182.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 15:23:55 +0000
Received: by nf-out-0910.google.com with SMTP id d3so840457nfc
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 07:23:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=/IXogFeMrfFB1OFPOJt1T1r1aF/sT67jyAeHngdTAuI=;
        b=mw27oJD6WybpCVak7SuKHbTUtCatGnQGce4NZG42mHQqjzAAhRdglh4EWrLFtN8hw2pjwOfxnMPmko/1qMCFl6a0HJvFhr0pd9rfLi88ozIvsSL9KpHUEHDScqx15bFndMAbek4gHv4XUmLx9So3DOTl/HSlVNeT9VG2xMuy0KU=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=L5Q2WkZxaCIx3ymIch4ZnhCifiT4WujNv1fXi5Q7STaHiIX15fyEJsvz2VPv4oxKAnW+uPVIn4mnhX/9v20G3n7XTGvJeLYXiOK2D5txs2xCMj9Cpe+PgnYSvSYvpCVnAsUyvze9OihUNPG44QE13AfA7w3qRnqLPKNLMdZvPyk=
Received: by 10.82.182.1 with SMTP id e1mr10402449buf.1196177033273;
        Tue, 27 Nov 2007 07:23:53 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Tue, 27 Nov 2007 07:23:53 -0800 (PST)
Message-ID: <359a92830711270723m787e3c96yfda04de9216d94a0@mail.gmail.com>
Date: Tue, 27 Nov 2007 10:23:53 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: prefix query search problem if a hyphen exist in the search word
In-Reply-To: <13966231.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1741_377512.1196177033216"
References: <13966231.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1741_377512.1196177033216
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

What analyzers are you using both at index time and
query time? StandardAnalyzer will, for instance, split
the words at the hyphen.

I would recommend that you get a copy of Luke (google
lucene luke) and examine both the contents of your index,
and the query produced by using various analyzers. Also,
query.toString() will show you a lot about
what is actually happening.

Best
Erick

On Nov 27, 2007 2:47 AM, reeja <d.reeja@gmail.com> wrote:

>
> Hi,
>  I faced some problem with prefix query search when the prefix text
> contains
> a hyphen. i'm using lucene-2.1.
> Search query is like this ttl:co-operative it returns more than 50
> results,
> but if i convert the query like this ttl:co-operat* it  returns no result.
> again i entered a query ttl:11-amino it returns some results, then
>  changed
> the above query into ttl:11-amino* it will return some more results than
> previous query.
> I think if a character or text appeared before the hyphen may  cause the
> pbroblem, if the text before hyphen is a number its work fine.
> anybody can help me to correct this problem.
>
> Thanks
> reeja
>
>
> --
> View this message in context:
> http://www.nabble.com/prefix-query-search-problem-if-a-hyphen-exist-in-the-search-word-tf4880266.html#a13966231
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_1741_377512.1196177033216--

From java-user-return-31224-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 15:50:29 2007
Return-Path: <java-user-return-31224-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13741 invoked from network); 27 Nov 2007 15:50:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 15:50:29 -0000
Received: (qmail 47826 invoked by uid 500); 27 Nov 2007 15:50:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47785 invoked by uid 500); 27 Nov 2007 15:50:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47774 invoked by uid 99); 27 Nov 2007 15:50:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 07:50:10 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of haroldo.araras@gmail.com designates 66.249.92.173 as permitted sender)
Received: from [66.249.92.173] (HELO ug-out-1314.google.com) (66.249.92.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 15:49:51 +0000
Received: by ug-out-1314.google.com with SMTP id m3so199157ugc
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 07:49:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=DLyM4otSMIA6tmGGC+Zr4wMTmrVFO1eK3berRv2WRsA=;
        b=BWwh+yT96dYJJePt3iW3Et46lk0vsSPBLW1qaK32JA4iqXbvLBiIrSCO44tqwtUeBzn6+q1oqTfOdQUMWH+1Jrv2fQXP1UmaYlIDdBhEOmzUPRf2+7NbxHv4TSgxYiM+sCAJTN4E30nzDHLi+8/vmABJqD8oHiRL/yCpcdMTUyA=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=XiyMhsQaOQ43N6ZFVECNzK4umJYk+FFYsAoOdmXsDVTFOHaXcGKJQjU2APb176/NGjG/+zrD6sYmRa/Gy77Xbk+6gX/fvaoJ3/iIDYWUMRsNtUfse6vUQhQuvRGNeMyxZ1Mn4Dv195lBxLLQh/vml1MHlLK4Vk+jP2Yi0Spt3C4=
Received: by 10.150.58.5 with SMTP id g5mr885055yba.1196178565149;
        Tue, 27 Nov 2007 07:49:25 -0800 (PST)
Received: by 10.150.138.12 with HTTP; Tue, 27 Nov 2007 07:49:25 -0800 (PST)
Message-ID: <718789d20711270749l6478d68fkdcfa2baefd65dbcc@mail.gmail.com>
Date: Tue, 27 Nov 2007 12:49:25 -0300
From: "Haroldo Nascimento" <haroldo.araras@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Score: Randomize form
In-Reply-To: <Pine.LNX.4.62.0711261706050.26378@radix.cryptio.net>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_6058_14763076.1196178565165"
References: <718789d20711261531l608b7b31sd0ab11fad6918470@mail.gmail.com>
	 <359a92830711261621w1a2e5746w6a5a01a6a357cb70@mail.gmail.com>
	 <Pine.LNX.4.62.0711261706050.26378@radix.cryptio.net>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_6058_14763076.1196178565165
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Its works. The solution is the implementation of SortComparatorSource
interface.

 Thanks Chris,


On Nov 26, 2007 10:17 PM, Chris Hostetter <hossman_lucene@fucit.org> wrote:

>
> : I think you have a couple of problems here. First, you'll have to
> : normalize the scores to get *any* of them to be the same. Since
> : the scores are a float, very few of them will be exactly the same.
>
> it's not as rare as it seems, with lengthNorm byte encoding and low tf
> values it can happen quite a bit -- with a custom Siilarity you can *make*
> it happen a lot.
>
> : >  I show the results of searches as two criterios of sorting
> ("priority"
> : > and
> : > to after "score") of each document.
> : >  I need present the result with same score of ramdomize form.
>
> based on the example you gave, it sounds like you don't really want to
> sort on score at all ... you just want a randomized sort after sorting on
> the priority field.
>
> Solr has a "RandomSortField" which contains a "RandomSort" class that
> don't think has any deep Solr dependencies ... it works by using the
> "field name" arg as a seed for randomizing the order of results, so you
> can iterate/paginate over a consistent "random" ordering as long as you
> keep
> resuing hte same name ... pick a differnet name everytime (use a counter,
> or a random number) and you'll get a different order.
>
> you could use that as a secondary sort after your priority field (or a
> tertiary sort after score)
>
>
> -Hoss
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_6058_14763076.1196178565165--

From java-user-return-31225-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 16:34:34 2007
Return-Path: <java-user-return-31225-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 33332 invoked from network); 27 Nov 2007 16:34:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 16:34:34 -0000
Received: (qmail 32171 invoked by uid 500); 27 Nov 2007 16:34:15 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 32132 invoked by uid 500); 27 Nov 2007 16:34:15 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 32121 invoked by uid 99); 27 Nov 2007 16:34:15 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 08:34:15 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 16:34:17 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 98B3B56F49
	for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 11:33:55 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Tue, 27 Nov 2007 11:33:55 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 68C3E33EA8; Tue, 27 Nov 2007 11:33:55 -0500 (EST)
Message-Id: <1196181235.6823.1223496915@webmail.messagingengine.com>
X-Sasl-Enc: 0OEkkoDjhaxOZgctOHY3amB+nPdug8jhhwsthwh0wr2V 1196181235
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <962ea6660711270644w6696f685g4c5f511e587cc6cc@mail.gmail.com>
   <1196175011.19543.1223475441@webmail.messagingengine.com>
Subject: Re: CheckIndex tool issues
In-Reply-To: <1196175011.19543.1223475441@webmail.messagingengine.com>
Date: Tue, 27 Nov 2007 11:33:55 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


OK I opened this JIRA issue to track this:

  https://issues.apache.org/jira/browse/LUCENE-1069

Mike

"Michael McCandless" <lucene@mikemccandless.com> wrote:
> 
> Woops!  You are right, this is a silly bug in the CheckIndex tool.  It is not
> properly taking into account deletions.  I will open an issue & fix it.
> 
> Thanks for testing & reporting this, and sorry about that.
> 
> Mike
> 
> "Bogdan Ghidireac" <bogdan@ecstend.com> wrote:
> > Hi,
> > 
> > I tried to use the CheckIndex tool (the latest svn code) and I was
> > surprised
> > to notice that all my indexes from production (around 30) are corrupt.
> > This
> > is highly unlikely because they were running for about one year and I had
> > no
> > exception during search so far.
> > 
> > One recurring pattern I observed is that the tool reports the segments
> > with
> > deleted docs as corrupt. The one without deleted docs are fine.. Here is
> > a
> > sample output.
> > 
> > index 1
> > 
> >   6 of 7: name=_wxlp docCount=1001
> >     compound=true
> >     numFiles=1
> >     size (MB)=0.213
> >     no deletions
> >     test: open reader.........OK
> >     test: fields, norms.......OK [12 fields]
> >     test: terms, freq, prox...OK [4142 terms; 8004 terms/docs pairs; 8006
> > tokens]
> >     test: stored fields.......OK [12012 total field count; avg 12 fields
> >     per
> > doc]
> >     test: term vectors........OK [0 total vector count; avg 0 term/freq
> > vector fields per doc]
> > 
> >   7 of 7: name=_wxqg docCount=178
> >     compound=true
> >     numFiles=1
> >     size (MB)=0.039
> >     no deletions
> >     test: open reader.........OK
> >     test: fields, norms.......OK [12 fields]
> >     test: terms, freq, prox...OK [819 terms; 1417 terms/docs pairs; 1417
> > tokens]
> >     test: stored fields.......OK [2136 total field count; avg 12 fields
> >     per
> > doc]
> >     test: term vectors........OK [0 total vector count; avg 0 term/freq
> > vector fields per doc]
> > 
> > index 2
> > 
> >   6 of 7: name=_10hr docCount=1978
> >     compound=true
> >     numFiles=2
> >     size (MB)=3.601
> >     has deletions [delFileName=_10hr_5.del]
> >     test: open reader.........OK [17 deleted docs]
> >     test: fields, norms.......OK [10 fields]
> >     test: terms, freq, prox...FAILED
> >     WARNING: would remove reference to this segment (-fix was not
> > specified); full exception:
> > java.lang.RuntimeException: term ASIN:342678033X docFreq=5 != num docs
> > seen
> > 4
> >         at org.apache.lucene.index.CheckIndex.main(CheckIndex.java:217)
> > 
> >   7 of 7: name=_10i0 docCount=196
> >     compound=true
> >     numFiles=1
> >     size (MB)=0.44
> >     no deletions
> >     test: open reader.........OK
> >     test: fields, norms.......OK [10 fields]
> >     test: terms, freq, prox...OK [8611 terms; 24307 terms/docs pairs;
> >     32841
> > tokens]
> >     test: stored fields.......OK [1960 total field count; avg 10 fields
> >     per
> > doc]
> >     test: term vectors........OK [0 total vector count; avg 0 term/freq
> > vector fields per doc]
> > 
> > 
> > Is this a known issue or my indexes are really corrupt ?
> > 
> > Regards,
> > Bogdan
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31226-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 19:49:32 2007
Return-Path: <java-user-return-31226-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 17945 invoked from network); 27 Nov 2007 19:49:32 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 19:49:32 -0000
Received: (qmail 34325 invoked by uid 500); 27 Nov 2007 19:49:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 34293 invoked by uid 500); 27 Nov 2007 19:49:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 34282 invoked by uid 99); 27 Nov 2007 19:49:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 11:49:13 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luz290@gmail.com designates 209.85.162.177 as permitted sender)
Received: from [209.85.162.177] (HELO el-out-1112.google.com) (209.85.162.177)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 19:48:54 +0000
Received: by el-out-1112.google.com with SMTP id m34so472032ele
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 11:48:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=MSp13xi3ZWtV6EzxWLcJZ38bq1t9NeBoi/7s1T39qBQ=;
        b=dQnF2K1Kk6S8W4hvLGN6me7nAZBET3V3Iu7vFE3IWKF6Uqz44pJT6xAgJSZdrP6ekI0PZdlMZgc2GpoyX+s8Lu6iGxzfmsH6AszaxmR+EWE26p+xDd4LAnSMbmsQf0Nqo2vIU0f3leNt+xRSJD7qH9WFaB2cceprDymYCiEsWOY=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=gYHVubihwRcItRpBgfomrdin7TmXCTC0mER7bcSXYS7m8y5KrQ259QACeU/WzI1Eb4qOr5XipidXC+/Q/ZXOAsCk0arxYLWR0Rd2Tc6aLEUxpX8tGqf7QIs50FBx3fMlLwDv/PTMYb+Or50/qwODdB7gzVB+UALLkZfQCD6RcKg=
Received: by 10.142.88.20 with SMTP id l20mr1179687wfb.1196192935331;
        Tue, 27 Nov 2007 11:48:55 -0800 (PST)
Received: by 10.142.225.3 with HTTP; Tue, 27 Nov 2007 11:48:55 -0800 (PST)
Message-ID: <cec089090711271148q6f482c18pc4ebc9b5691680a4@mail.gmail.com>
Date: Tue, 27 Nov 2007 14:48:55 -0500
From: "lucene user" <luz290@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Searching user-private annotations associated with indexed documents
In-Reply-To: <59899.43620.qm@web26011.mail.ukl.yahoo.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <59899.43620.qm@web26011.mail.ukl.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

These annotations are not positional within the underlying article.
They are just comments the user associates with the entire underlying
document, i.e., "This article gets the facts wrong about the real
reasons the US went into Iraq." Could be a sentence or a few sentences
about the entire underlying article. Perhaps a few hundred words
associated with a small percentage of the documents we index.

Am I being clear?

I want to do phrase searches BOTH for the underlying article and for
the associated annotation at the same time. So, for example, search
for all articles where the article talks about "US Army" and the
annotation includes the word "reasons"

I don't know what you mean  by "PERSON_ANNOTATION works for Google".

On Nov 27, 2007 7:54 AM, mark harwood <markharw00d@yahoo.co.uk> wrote:
> Do the annotations have positions ?
>
> Do you want to do things like phrase-search e.g.
>      "PERSON_ANNOTATION works for Google"
>
> Or is your idea of an annotation more simply a del.ici.ous-style tag associated with the whole document?
>
> Cheers
> Mark
>
>
> ----- Original Message ----
> From: lucene user <luz290@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Tuesday, 27 November, 2007 12:31:38 PM
> Subject: Re: Searching user-private annotations associated with indexed documents
>
> I'd be VERY grateful for your help, folks! Thanks! I really need some
> insight on this. THANKS!!
>
> On Nov 26, 2007 6:43 PM, lucene user <luz290@gmail.com> wrote:
> > Here are the three options that seem practical to us right now.
> >
> > (1) Do The annotation search in postgres using LIKE or the
> >    postgres native full text search. Take the resulting list
> >    of file ids and use it to build a filter for the lucene query,
> >    the way we currently do for folders.
> >
> > (2) Add a second lucene index that contains only annotations.
> >    First retrieve a list of file ids satisfying the annotation
> >    query from this index and use it to create a filter for the
> >    main lucene query on the archive.
> >    Whenever annotation text is edited,
> >      if blank, delete annotation from index
> >      otherwise add or replace annotation in index.
> >
> > (3) Add a second lucene index that contains contentrefs.
> >     This index would contain the same fields as the arhicve index
> >     plus the following:
> >       database_id: list of systemuser_id and contentref_id.
> >       annotation:  list of all annotation text for this
> >                    system user and content ref.
> >       folders:     list of all folder names for this systemuser and
> >                    content ref
> >
> >     Whenever an article is added to or removed from a folder,
> >     or its annotation text is edited, the following would occur:
> >       See if it has an entry in the lucene index for the database.
> >       if so,
> >         extract the lucene document from the index.
> >         if the updated list of folders that contain it is empty,
> >            delete this document from the lucene database index.
> >         otherwise,
> >           update the folder and annotation in the document object.
> >           delete this document from the index.
> >           add the updated document object to the index.
> >       if not,
> >         extract the lucene document for the article from the archive
>  index
> >         add the database_id, folders, and annotation fields to this
>  object
> >         add the document object to the lucene database index.
> >
> > Got a better idea on this?
> >
> > Thanks!!
> >
> >
> > On Nov 26, 2007 5:33 PM, lucene user <luz290@gmail.com> wrote:
> > > Folks
> > >
> > > I have some additional textual data that is user specific,
>  basically
> > > annotations about documents. I would like to be able to do
> > > **combined** searches, looking for some words in the document and
>  some
> > > in my users' private annotations about that document. Any
>  suggestions
> > > about how I should handle this? The annotations are changeable by
> > > users at any time so we have to be ready to delete them and add
>  others
> > > at any time when the user does edit an annotation.
> > >
> > > Do I need a second Lucene index? Can I do a query against two
>  indexes
> > > at the same time? If so, how?
> > >
> > > The annotations will be very small but highly volatile. The
>  database
> > > of documents will grow large but nothing will be deleted from it.
> > >
> > > Thanks!
> > >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>
>
>       ___________________________________________________________
> Yahoo! Answers - Got a question? Someone out there knows the answer. Try it
> now.
> http://uk.answers.yahoo.com/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31227-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 20:42:35 2007
Return-Path: <java-user-return-31227-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 36178 invoked from network); 27 Nov 2007 20:42:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 20:42:35 -0000
Received: (qmail 12801 invoked by uid 500); 27 Nov 2007 20:42:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 12778 invoked by uid 500); 27 Nov 2007 20:42:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 12767 invoked by uid 99); 27 Nov 2007 20:42:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 12:42:16 -0800
X-ASF-Spam-Status: No, hits=1.0 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_LOW,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [129.128.5.19] (HELO mail7.srv.ualberta.ca) (129.128.5.19)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 20:41:56 +0000
Received: from mailserver.ualibrary.ualberta.ca (mail.library.ualberta.ca [129.128.216.88])
	by mail7.srv.ualberta.ca (8.13.8/8.13.8) with SMTP id lARKfuKi001600
	for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 13:41:57 -0700 (MST)
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C83135.D406FBCD"
X-MimeOLE: Produced By Microsoft Exchange V6.5
Subject: RE: Searching user-private annotations associated with indexed documents
Date: Tue, 27 Nov 2007 13:41:04 -0700
Message-ID: <908893006339C0409519E4065DF3B249031881FC@mailserver.ualibrary.ualberta.ca>
In-Reply-To: <cec089090711271148q6f482c18pc4ebc9b5691680a4@mail.gmail.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Searching user-private annotations associated with indexed documents
Thread-Index: AcgxLp9FOQHyDCBnR2ub24YHof2tngABW3mA
References: <59899.43620.qm@web26011.mail.ukl.yahoo.com> <cec089090711271148q6f482c18pc4ebc9b5691680a4@mail.gmail.com>
From: "Binkley, Peter" <Peter.Binkley@ualberta.ca>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C83135.D406FBCD
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

One approach would be to take advantage of Lucene's ability to handle
different kinds of documents in a single index. You could put the
annotations in the same index as the main articles, but with extra
fields, like this:

Article document:

Id: article1
Type: article
Text: blah blah blah

Annotation document:

Id: user1:article1
Type: annotation
User: user1
Article: article1
Text: comment on blah blah blah

You could then query something like "(type:article AND text:blah) OR
(type:annotation AND user:user1 AND text:blah)". When annotations are
retrieved, it would be up to your application to call up the associated
article (or maybe you repeat the necessary display fields in the
annotation document, e.g. title).

This way your privacy requirement is easy because it's easy to limit a
query to annotations by the current user, and you can update a user's
annotation on a given article without having to reindex the article.
However, the trade-off is that by having the article and annotation in
separate documents, you'll lose the relevance boost you would otherwise
get when the search terms appear both in the annotation and in the
article.

Peter

-----Original Message-----
From: lucene user [mailto:luz290@gmail.com]=20
Sent: Tuesday, November 27, 2007 12:49 PM
To: java-user@lucene.apache.org
Subject: Re: Searching user-private annotations associated with indexed
documents

These annotations are not positional within the underlying article.
They are just comments the user associates with the entire underlying
document, i.e., "This article gets the facts wrong about the real
reasons the US went into Iraq." Could be a sentence or a few sentences
about the entire underlying article. Perhaps a few hundred words
associated with a small percentage of the documents we index.

Am I being clear?

I want to do phrase searches BOTH for the underlying article and for the
associated annotation at the same time. So, for example, search for all
articles where the article talks about "US Army" and the annotation
includes the word "reasons"

I don't know what you mean  by "PERSON_ANNOTATION works for Google".

On Nov 27, 2007 7:54 AM, mark harwood <markharw00d@yahoo.co.uk> wrote:
> Do the annotations have positions ?
>
> Do you want to do things like phrase-search e.g.
>      "PERSON_ANNOTATION works for Google"
>
> Or is your idea of an annotation more simply a del.ici.ous-style tag
associated with the whole document?
>
> Cheers
> Mark
>
>
> ----- Original Message ----
> From: lucene user <luz290@gmail.com>
> To: java-user@lucene.apache.org
> Sent: Tuesday, 27 November, 2007 12:31:38 PM
> Subject: Re: Searching user-private annotations associated with=20
> indexed documents
>
> I'd be VERY grateful for your help, folks! Thanks! I really need some=20
> insight on this. THANKS!!
>
> On Nov 26, 2007 6:43 PM, lucene user <luz290@gmail.com> wrote:
> > Here are the three options that seem practical to us right now.
> >
> > (1) Do The annotation search in postgres using LIKE or the
> >    postgres native full text search. Take the resulting list
> >    of file ids and use it to build a filter for the lucene query,
> >    the way we currently do for folders.
> >
> > (2) Add a second lucene index that contains only annotations.
> >    First retrieve a list of file ids satisfying the annotation
> >    query from this index and use it to create a filter for the
> >    main lucene query on the archive.
> >    Whenever annotation text is edited,
> >      if blank, delete annotation from index
> >      otherwise add or replace annotation in index.
> >
> > (3) Add a second lucene index that contains contentrefs.
> >     This index would contain the same fields as the arhicve index
> >     plus the following:
> >       database_id: list of systemuser_id and contentref_id.
> >       annotation:  list of all annotation text for this
> >                    system user and content ref.
> >       folders:     list of all folder names for this systemuser and
> >                    content ref
> >
> >     Whenever an article is added to or removed from a folder,
> >     or its annotation text is edited, the following would occur:
> >       See if it has an entry in the lucene index for the database.
> >       if so,
> >         extract the lucene document from the index.
> >         if the updated list of folders that contain it is empty,
> >            delete this document from the lucene database index.
> >         otherwise,
> >           update the folder and annotation in the document object.
> >           delete this document from the index.
> >           add the updated document object to the index.
> >       if not,
> >         extract the lucene document for the article from the archive
>  index
> >         add the database_id, folders, and annotation fields to this
>  object
> >         add the document object to the lucene database index.
> >
> > Got a better idea on this?
> >
> > Thanks!!
> >
> >
> > On Nov 26, 2007 5:33 PM, lucene user <luz290@gmail.com> wrote:
> > > Folks
> > >
> > > I have some additional textual data that is user specific,
>  basically
> > > annotations about documents. I would like to be able to do
> > > **combined** searches, looking for some words in the document and
>  some
> > > in my users' private annotations about that document. Any
>  suggestions
> > > about how I should handle this? The annotations are changeable by=20
> > > users at any time so we have to be ready to delete them and add
>  others
> > > at any time when the user does edit an annotation.
> > >
> > > Do I need a second Lucene index? Can I do a query against two
>  indexes
> > > at the same time? If so, how?
> > >
> > > The annotations will be very small but highly volatile. The
>  database
> > > of documents will grow large but nothing will be deleted from it.
> > >
> > > Thanks!
> > >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>
>
>       ___________________________________________________________
> Yahoo! Answers - Got a question? Someone out there knows the answer.=20
> Try it now.
> http://uk.answers.yahoo.com/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


------_=_NextPart_001_01C83135.D406FBCD--

From java-user-return-31228-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 20:50:21 2007
Return-Path: <java-user-return-31228-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 42452 invoked from network); 27 Nov 2007 20:50:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 20:50:21 -0000
Received: (qmail 26460 invoked by uid 500); 27 Nov 2007 20:50:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26433 invoked by uid 500); 27 Nov 2007 20:50:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26422 invoked by uid 99); 27 Nov 2007 20:50:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 12:50:00 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of luz290@gmail.com designates 64.233.162.227 as permitted sender)
Received: from [64.233.162.227] (HELO nz-out-0506.google.com) (64.233.162.227)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 20:49:41 +0000
Received: by nz-out-0506.google.com with SMTP id i28so823815nzi
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 12:49:43 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=OMgxwIbn4stfhpGKMsalAWr4xuZnzdxkYmzuh3rNB7M=;
        b=kt4eyooGOXnnfBD3KiQ98E0Dn6ZnssRq2QqLmBvojRyBPQMe2ioiw1zQoDeLQj0Y4ELhtuuNTd0GgBKEK3mZQMCbmUikeiaar3WlK0SjThw3VdbZlz3ek8xkPdjq+gfILW9EZDjxT89f+pph61MZc1ZtQJ3Zm1BSNK7/XJ1mWDw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=U1IiMIeHNRcBHtQFqzO2DKmsSviOjvlsG4OTJAIHaHYe68pghQEkIB/pbm7zF3E39XwPfuBXb6AVogK853EBQvdPJ5enNZAglkaqumAi+vOHpSgQHtKVA3l2A70bjtIRvX+yuvzuLtlE4YSEoCYut19blxz3Qu8XwQ6sP1tgtxk=
Received: by 10.142.48.14 with SMTP id v14mr1231699wfv.1196196582971;
        Tue, 27 Nov 2007 12:49:42 -0800 (PST)
Received: by 10.142.225.3 with HTTP; Tue, 27 Nov 2007 12:49:42 -0800 (PST)
Message-ID: <cec089090711271249g2dab24cdne06a8caa5aba74fa@mail.gmail.com>
Date: Tue, 27 Nov 2007 15:49:42 -0500
From: "lucene user" <luz290@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Searching user-private annotations associated with indexed documents
In-Reply-To: <908893006339C0409519E4065DF3B249031881FC@mailserver.ualibrary.ualberta.ca>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_60_8577960.1196196582967"
References: <59899.43620.qm@web26011.mail.ukl.yahoo.com>
	 <cec089090711271148q6f482c18pc4ebc9b5691680a4@mail.gmail.com>
	 <908893006339C0409519E4065DF3B249031881FC@mailserver.ualibrary.ualberta.ca>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_60_8577960.1196196582967
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

These annotations are private to a specific user and they can change at any
time. What are the challenges associated with this fact? What are the best
ways to address these challenges? There are likely to be lots of small
changes to these annotations. Can we delete and re-insert these annotation
documents without causing problems for our main index?

Thanks!

On Nov 27, 2007 3:41 PM, Binkley, Peter <Peter.Binkley@ualberta.ca> wrote:

> One approach would be to take advantage of Lucene's ability to handle
> different kinds of documents in a single index. You could put the
> annotations in the same index as the main articles, but with extra
> fields, like this:
>
> Article document:
>
> Id: article1
> Type: article
> Text: blah blah blah
>
> Annotation document:
>
> Id: user1:article1
> Type: annotation
> User: user1
> Article: article1
> Text: comment on blah blah blah
>
> You could then query something like "(type:article AND text:blah) OR
> (type:annotation AND user:user1 AND text:blah)". When annotations are
> retrieved, it would be up to your application to call up the associated
> article (or maybe you repeat the necessary display fields in the
> annotation document, e.g. title).
>
> This way your privacy requirement is easy because it's easy to limit a
> query to annotations by the current user, and you can update a user's
> annotation on a given article without having to reindex the article.
> However, the trade-off is that by having the article and annotation in
> separate documents, you'll lose the relevance boost you would otherwise
> get when the search terms appear both in the annotation and in the
> article.
>
> Peter
>
> -----Original Message-----
> From: lucene user [mailto:luz290@gmail.com]
> Sent: Tuesday, November 27, 2007 12:49 PM
> To: java-user@lucene.apache.org
> Subject: Re: Searching user-private annotations associated with indexed
> documents
>
> These annotations are not positional within the underlying article.
> They are just comments the user associates with the entire underlying
> document, i.e., "This article gets the facts wrong about the real
> reasons the US went into Iraq." Could be a sentence or a few sentences
> about the entire underlying article. Perhaps a few hundred words
> associated with a small percentage of the documents we index.
>
> Am I being clear?
>
> I want to do phrase searches BOTH for the underlying article and for the
> associated annotation at the same time. So, for example, search for all
> articles where the article talks about "US Army" and the annotation
> includes the word "reasons"
>
> I don't know what you mean  by "PERSON_ANNOTATION works for Google".
>
> On Nov 27, 2007 7:54 AM, mark harwood <markharw00d@yahoo.co.uk> wrote:
> > Do the annotations have positions ?
> >
> > Do you want to do things like phrase-search e.g.
> >      "PERSON_ANNOTATION works for Google"
> >
> > Or is your idea of an annotation more simply a del.ici.ous-style tag
> associated with the whole document?
> >
> > Cheers
> > Mark
> >
> >
> > ----- Original Message ----
> > From: lucene user <luz290@gmail.com>
> > To: java-user@lucene.apache.org
> > Sent: Tuesday, 27 November, 2007 12:31:38 PM
> > Subject: Re: Searching user-private annotations associated with
> > indexed documents
> >
> > I'd be VERY grateful for your help, folks! Thanks! I really need some
> > insight on this. THANKS!!
> >
> > On Nov 26, 2007 6:43 PM, lucene user <luz290@gmail.com> wrote:
> > > Here are the three options that seem practical to us right now.
> > >
> > > (1) Do The annotation search in postgres using LIKE or the
> > >    postgres native full text search. Take the resulting list
> > >    of file ids and use it to build a filter for the lucene query,
> > >    the way we currently do for folders.
> > >
> > > (2) Add a second lucene index that contains only annotations.
> > >    First retrieve a list of file ids satisfying the annotation
> > >    query from this index and use it to create a filter for the
> > >    main lucene query on the archive.
> > >    Whenever annotation text is edited,
> > >      if blank, delete annotation from index
> > >      otherwise add or replace annotation in index.
> > >
> > > (3) Add a second lucene index that contains contentrefs.
> > >     This index would contain the same fields as the arhicve index
> > >     plus the following:
> > >       database_id: list of systemuser_id and contentref_id.
> > >       annotation:  list of all annotation text for this
> > >                    system user and content ref.
> > >       folders:     list of all folder names for this systemuser and
> > >                    content ref
> > >
> > >     Whenever an article is added to or removed from a folder,
> > >     or its annotation text is edited, the following would occur:
> > >       See if it has an entry in the lucene index for the database.
> > >       if so,
> > >         extract the lucene document from the index.
> > >         if the updated list of folders that contain it is empty,
> > >            delete this document from the lucene database index.
> > >         otherwise,
> > >           update the folder and annotation in the document object.
> > >           delete this document from the index.
> > >           add the updated document object to the index.
> > >       if not,
> > >         extract the lucene document for the article from the archive
> >  index
> > >         add the database_id, folders, and annotation fields to this
> >  object
> > >         add the document object to the lucene database index.
> > >
> > > Got a better idea on this?
> > >
> > > Thanks!!
> > >
> > >
> > > On Nov 26, 2007 5:33 PM, lucene user <luz290@gmail.com> wrote:
> > > > Folks
> > > >
> > > > I have some additional textual data that is user specific,
> >  basically
> > > > annotations about documents. I would like to be able to do
> > > > **combined** searches, looking for some words in the document and
> >  some
> > > > in my users' private annotations about that document. Any
> >  suggestions
> > > > about how I should handle this? The annotations are changeable by
> > > > users at any time so we have to be ready to delete them and add
> >  others
> > > > at any time when the user does edit an annotation.
> > > >
> > > > Do I need a second Lucene index? Can I do a query against two
> >  indexes
> > > > at the same time? If so, how?
> > > >
> > > > The annotations will be very small but highly volatile. The
> >  database
> > > > of documents will grow large but nothing will be deleted from it.
> > > >
> > > > Thanks!
> > > >
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
> >
> >
> >
> >
> >       ___________________________________________________________
> > Yahoo! Answers - Got a question? Someone out there knows the answer.
> > Try it now.
> > http://uk.answers.yahoo.com/
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_60_8577960.1196196582967--

From java-user-return-31229-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 20:55:24 2007
Return-Path: <java-user-return-31229-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 45552 invoked from network); 27 Nov 2007 20:55:23 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 20:55:23 -0000
Received: (qmail 33260 invoked by uid 500); 27 Nov 2007 20:55:05 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 33233 invoked by uid 500); 27 Nov 2007 20:55:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 33222 invoked by uid 99); 27 Nov 2007 20:55:05 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 12:55:05 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ngvinny@gmail.com designates 64.233.162.231 as permitted sender)
Received: from [64.233.162.231] (HELO nz-out-0506.google.com) (64.233.162.231)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 20:54:46 +0000
Received: by nz-out-0506.google.com with SMTP id i28so825143nzi
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 12:54:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:mime-version:content-type;
        bh=yc0LFZw8GSV4FcneNpUbPwKO0lPJLFo4pdN5RX0zhtE=;
        b=SN2gnXacLYVIU7dWym5gtFK3K5ZEeDHk7e2Tae0tKwD9Nli9C9spiQMEIHhI8COQqumcKM1jAXCylfJFJbIkDShTziLDsY5OBzithSztF1UDYWzlw9VzG73GGnEjmQaKXK8fGVdy2Y0ekSZzxwPDRWcRYF1qyBO9XM9sJEkkhHo=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:mime-version:content-type;
        b=S8ybCTKRM9xw6XMDKnnu8eYpaF3zvM1+RWOyLxhfoSzAvuFtSpL9qYzTWsZR4kAUaGTBANcD/KoEXX3XiDKkf4ljH141VckGycjkG2oaAkqL+MGAflzTIfeEfV7ANjPqLoKvP/341dgrPVQ7/9+qP+EbKBH5etm/wcaTS2FByIo=
Received: by 10.140.147.13 with SMTP id u13mr2169342rvd.1196196886531;
        Tue, 27 Nov 2007 12:54:46 -0800 (PST)
Received: by 10.140.204.13 with HTTP; Tue, 27 Nov 2007 12:54:46 -0800 (PST)
Message-ID: <5db95abe0711271254o2b5cdc90i67d10c11c42f9430@mail.gmail.com>
Date: Tue, 27 Nov 2007 20:54:46 +0000
From: "Ng Vinny" <ngvinny@gmail.com>
To: java-user@lucene.apache.org
Subject: problem with details given by Explanation object
MIME-Version: 1.0
Content-Type: multipart/mixed; 
	boundary="----=_Part_1238_7333170.1196196886506"
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1238_7333170.1196196886506
Content-Type: multipart/alternative; 
	boundary="----=_Part_1239_30769281.1196196886506"

------=_Part_1239_30769281.1196196886506
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi all,

I am having a problem with Lucene 2.2.0 with regard to the contents of the
Explanation objects after a PhraseQuery search. I indexed two documents doc1
and doc2 and then issue an OR Boolean query consisting of two PhraseQuery
pq1 and pq2.

Apparently, the details of the Explanation object for doc1 show that pq1 has
positive tf value even though it doesn't appear in doc1. The tf value is
exactly the same as that of the tf value for pq1 in doc2 (pq1 does appear in
doc2).

The code is attached (the sample pdf files cannot be attached due to size
restriction on the list).

Please help to shed some light on this.

Thank you very much
Ng Vinny

------=_Part_1239_30769281.1196196886506
Content-Type: text/html; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi all, <br><div class="gmail_quote"><br>I am having a problem with Lucene 2.2.0 with regard to the contents of the Explanation objects after a PhraseQuery search. I indexed two documents doc1 and doc2 and then issue an OR Boolean query consisting of two PhraseQuery pq1 and pq2. 
<br><br>Apparently, the details of the Explanation object for doc1 show that pq1 has positive tf value even though it doesn&#39;t appear in doc1. 
The tf value is exactly the same as that of the tf value for pq1 in doc2 (pq1 does appear in doc2). <br><br>The code is attached (the sample pdf files cannot be attached due to size restriction on the list). <br><br>Please help to shed some light on this.
<br><br>Thank you very much<br><font color="#888888">Ng Vinny<br>
</font></div><br>

------=_Part_1239_30769281.1196196886506--


------=_Part_1238_7333170.1196196886506
Content-Type: text/plain; charset=us-ascii

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org
------=_Part_1238_7333170.1196196886506--

From java-user-return-31230-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 22:00:00 2007
Return-Path: <java-user-return-31230-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75730 invoked from network); 27 Nov 2007 21:59:59 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 21:59:59 -0000
Received: (qmail 22947 invoked by uid 500); 27 Nov 2007 21:59:40 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22909 invoked by uid 500); 27 Nov 2007 21:59:40 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22898 invoked by uid 99); 27 Nov 2007 21:59:40 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 13:59:40 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.190 as permitted sender)
Received: from [209.85.134.190] (HELO mu-out-0910.google.com) (209.85.134.190)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 21:59:20 +0000
Received: by mu-out-0910.google.com with SMTP id i10so1450126mue
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 13:59:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=yjOQ6lR3E2BTMkNwYM/8/tdjGZPxALPc9mBOMlhNW+w=;
        b=uEWV3MBCqzb/1vM1eI8JoXTJiLXSqnoKSU5ALFwh2/NyJWGnR9fqZtRlhCzQFjh8iSewyVgOOyYyDHXI+MNrsl3nGK7MIEIQGNWmZtmbMjOljpdYb98pqEQvQNkSPzzZq+w4ZHtkQKJ/vrDK+VE3jtEkAyGTsnn4RFtDEsE6FJs=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=kjcu4dv2iIEaN9fARWAHoI8b4ZhHyc5FVlTXOEbcxuciucXE0jhu/n/HGtH22XFH4UX5jiPKxyORzyXZ8rdTZ1KE21F8VKi1UYPu+l0zw814TIZSr7d1BXIl8cosX9kT4zkl4ci0NgAmFwAh+OL46BxTmvYqTcsM3/jhSdVGEbs=
Received: by 10.82.107.15 with SMTP id f15mr11641993buc.1196200757293;
        Tue, 27 Nov 2007 13:59:17 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Tue, 27 Nov 2007 13:59:17 -0800 (PST)
Message-ID: <359a92830711271359o62648346re89c70720b7f60fe@mail.gmail.com>
Date: Tue, 27 Nov 2007 16:59:17 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: problem with details given by Explanation object
In-Reply-To: <5db95abe0711271254o2b5cdc90i67d10c11c42f9430@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_3335_23241079.1196200757289"
References: <5db95abe0711271254o2b5cdc90i67d10c11c42f9430@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_3335_23241079.1196200757289
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Attachments often do not come through, at least they aren't visible to
me using g-mail. So you might want to re-send them in-line.

But another thing you can do is get a copy of luke and examine
your index to see if the actual contents of doc1 and doc2 are what
you expect. You can even run queries through it (but watch to insure
that you're using the correct analyzer) and see what is returned....

Best
Erick

On Nov 27, 2007 3:54 PM, Ng Vinny <ngvinny@gmail.com> wrote:

> Hi all,
>
> I am having a problem with Lucene 2.2.0 with regard to the contents of the
> Explanation objects after a PhraseQuery search. I indexed two documents doc1
> and doc2 and then issue an OR Boolean query consisting of two PhraseQuery
> pq1 and pq2.
>
> Apparently, the details of the Explanation object for doc1 show that pq1
> has positive tf value even though it doesn't appear in doc1. The tf value is
> exactly the same as that of the tf value for pq1 in doc2 (pq1 does appear in
> doc2).
>
> The code is attached (the sample pdf files cannot be attached due to size
> restriction on the list).
>
> Please help to shed some light on this.
>
> Thank you very much
> Ng Vinny
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

------=_Part_3335_23241079.1196200757289--

From java-user-return-31231-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 22:20:14 2007
Return-Path: <java-user-return-31231-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 81361 invoked from network); 27 Nov 2007 22:20:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 22:20:14 -0000
Received: (qmail 51945 invoked by uid 500); 27 Nov 2007 22:19:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 51907 invoked by uid 500); 27 Nov 2007 22:19:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 51896 invoked by uid 99); 27 Nov 2007 22:19:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 14:19:56 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ngvinny@gmail.com designates 209.85.198.191 as permitted sender)
Received: from [209.85.198.191] (HELO rv-out-0910.google.com) (209.85.198.191)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 22:19:37 +0000
Received: by rv-out-0910.google.com with SMTP id k20so958012rvb
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 14:19:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        bh=M2A0b0ASolND823d+85rwl7a4e8CNmqEGpjdPZN6hpk=;
        b=Q2tPH6jndJRmpKKgmvvjH7kMlBsgJlDTptJapV+bGnUPZ6xfoGCDvkfBP/DvjXkJ0n3AgG3U6wIWW48ZCQUEfd6vwKB8rFmYYLLaJs6K5pIKjCDasDZGbNdPJ3936afG+yinIJTF4N4eourUsR7TIGWZhxXBKQ5K3Va7iPJplkM=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        b=mVhdBud2t1o8TlbludJK1fC+VCNN2LjVHbhFICRtLbcbqdtG9vNns7mseQMvHjuABuSKHxmnLuKDqoxtjyB5jsakjrYa5LDDzhNp1A3u1/U072EGtzzuYWN5isdE+X4+3WLi4oCtieJlMg2dOUrhk/wWJjZ1c36FNsQJORtAl7U=
Received: by 10.141.189.4 with SMTP id r4mr2231839rvp.1196201980341;
        Tue, 27 Nov 2007 14:19:40 -0800 (PST)
Received: by 10.140.204.13 with HTTP; Tue, 27 Nov 2007 14:19:40 -0800 (PST)
Message-ID: <5db95abe0711271419gd5aadd0u142d5c54b7023469@mail.gmail.com>
Date: Tue, 27 Nov 2007 22:19:40 +0000
From: "Ng Vinny" <ngvinny@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: problem with details given by Explanation object
Cc: "Erick Erickson" <erickerickson@gmail.com>
In-Reply-To: <359a92830711271359o62648346re89c70720b7f60fe@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1470_26241487.1196201980336"
References: <5db95abe0711271254o2b5cdc90i67d10c11c42f9430@mail.gmail.com>
	 <359a92830711271359o62648346re89c70720b7f60fe@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1470_26241487.1196201980336
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Hi Erick,

I indexed only files in pdf format so I cannot put them inline here in
email. I did use Luke and put the same query into it and the same thing
happened.

Is there any chance i can send the two pdf files that cause the error to you
to see if the error can be reproduced?

Best,
Ng

On Nov 27, 2007 9:59 PM, Erick Erickson <erickerickson@gmail.com> wrote:

> Attachments often do not come through, at least they aren't visible to
> me using g-mail. So you might want to re-send them in-line.
>
> But another thing you can do is get a copy of luke and examine
> your index to see if the actual contents of doc1 and doc2 are what
> you expect. You can even run queries through it (but watch to insure
> that you're using the correct analyzer) and see what is returned....
>
> Best
> Erick
>
> On Nov 27, 2007 3:54 PM, Ng Vinny <ngvinny@gmail.com> wrote:
>
> > Hi all,
> >
> > I am having a problem with Lucene 2.2.0 with regard to the contents of
> the
> > Explanation objects after a PhraseQuery search. I indexed two documents
> doc1
> > and doc2 and then issue an OR Boolean query consisting of two
> PhraseQuery
> > pq1 and pq2.
> >
> > Apparently, the details of the Explanation object for doc1 show that pq1
> > has positive tf value even though it doesn't appear in doc1. The tf
> value is
> > exactly the same as that of the tf value for pq1 in doc2 (pq1 does
> appear in
> > doc2).
> >
> > The code is attached (the sample pdf files cannot be attached due to
> size
> > restriction on the list).
> >
> > Please help to shed some light on this.
> >
> > Thank you very much
> > Ng Vinny
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>

------=_Part_1470_26241487.1196201980336--

From java-user-return-31232-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 22:23:35 2007
Return-Path: <java-user-return-31232-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 83251 invoked from network); 27 Nov 2007 22:23:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 22:23:35 -0000
Received: (qmail 58334 invoked by uid 500); 27 Nov 2007 22:23:16 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58307 invoked by uid 500); 27 Nov 2007 22:23:16 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58296 invoked by uid 99); 27 Nov 2007 22:23:16 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 14:23:16 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ngvinny@gmail.com designates 209.85.198.186 as permitted sender)
Received: from [209.85.198.186] (HELO rv-out-0910.google.com) (209.85.198.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 22:22:57 +0000
Received: by rv-out-0910.google.com with SMTP id k20so958716rvb
        for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 14:22:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        bh=XIhQ2rteRzkFwCSB4YpnsK6vwaK9uqC8f+Kb9urFQwE=;
        b=JzLkH/txE/CSDrKUrQRXwZUZ2cbmpGnZkzbLyaGOE8Ca5Y2HYm4SUPj3ofwsvAbTsLt88273q4drRmeIHg4a2lFuwbKwzKYHMqW9VI0asyb2GaC/G3eQm+vhqrjxfKs8nTNsCZ/EAD8det1TGP2DQMV0ej4RAZhU+Elm5NsYd1E=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:cc:in-reply-to:mime-version:content-type:references;
        b=itjHLLN1R80PSfrrdb87AuQ0kRslgrnECssaFQUgVn6EnriCkRfMBjy64hZ6BNL2P1DGYhoj50MCiC8Oo00Fac0NtXNGTkilh42mcpL3U4JLEhPXv4d0KVIHZGKlJ49MXc4TLTNFdE7kPyyIse7GQvS1OkOG4wB2iwRcy9T4sVo=
Received: by 10.141.113.6 with SMTP id q6mr2226147rvm.1196202179569;
        Tue, 27 Nov 2007 14:22:59 -0800 (PST)
Received: by 10.140.204.13 with HTTP; Tue, 27 Nov 2007 14:22:59 -0800 (PST)
Message-ID: <5db95abe0711271422y380c538ck91ad16bf7ec2a3e3@mail.gmail.com>
Date: Tue, 27 Nov 2007 22:22:59 +0000
From: "Ng Vinny" <ngvinny@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: problem with details given by Explanation object
Cc: "Erick Erickson" <erickerickson@gmail.com>
In-Reply-To: <359a92830711271359o62648346re89c70720b7f60fe@mail.gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_1478_14096167.1196202179557"
References: <5db95abe0711271254o2b5cdc90i67d10c11c42f9430@mail.gmail.com>
	 <359a92830711271359o62648346re89c70720b7f60fe@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_1478_14096167.1196202179557
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Sorry, if you mean the java code then it's as below:

import java.io.File;

import org.apache.lucene.analysis.standard.StandardAnalyzer;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.queryParser.QueryParser;
import org.apache.lucene.search.BooleanClause;
import org.apache.lucene.search.BooleanQuery;
import org.apache.lucene.search.Explanation;
import org.apache.lucene.search.Hits;
import org.apache.lucene.search.IndexSearcher;
import org.apache.lucene.search.Query;

import org.pdfbox.pdmodel.PDDocument;
import org.pdfbox.util.PDFTextStripper;

public class Test {

    /**
     * @param args
     */
    public static void main(String[] args) throws Exception{

        doIndex("C:/data", "c:/temp");

        BooleanQuery mainQuery= new BooleanQuery() ;
        QueryParser qp= new QueryParser("contents", new CustomAnalyzer());

        Query pQuery= qp.parse("\"text classification\"");
        mainQuery.add(pQuery, BooleanClause.Occur.SHOULD);

        pQuery= qp.parse("\"Information Extraction\"");
        mainQuery.add(pQuery, BooleanClause.Occur.SHOULD);

        IndexSearcher searcher = new IndexSearcher("c:/temp");
        Hits hits = searcher.search(mainQuery);
        if (hits.length()==0) {
            System.out.println("No documents match ");
        }
        else {
            for (int i=0;i<hits.length();i++){
                String path = hits.doc(i).get("path");
                Explanation ex = searcher.explain(mainQuery, hits.id(i));
                System.out.println(path +"\n");
                System.out.println(ex.toString());

            }
        }
    }


    private static void doIndex(String docsDir, String indexDir) throws
Exception {

        File indexDirectory= new File(indexDir);
        File docsDirectory= new File(docsDir);
        IndexWriter writer= new IndexWriter(indexDirectory, new
StandardAnalyzer(),true);
        indexDirectory(writer, docsDirectory);
        writer.optimize();
        writer.close();
    }


    private static void indexFile(IndexWriter writer, File file) throws
Exception {
        if (file.isHidden()|| !file.exists() || !file.canRead()) return;

        String fileContents= getTextFromPDF(file);
        Document doc= new Document();
        Field field1= new Field("contents", fileContents, Field.Store.YES,
Field.Index.TOKENIZED);
        doc.add(field1);
        Field field2= new Field ("path", file.getAbsolutePath(),
Field.Store.YES, Field.Index.UN_TOKENIZED);
        doc.add(field2);

        writer.addDocument(doc);
        doc=null;
    }


    private static void indexDirectory(IndexWriter writer, File
docsDirectory) throws Exception {

        File[] fileList = docsDirectory.listFiles();

        for (int i=0; i< fileList.length;i++){
            File file= fileList[i];
            if (file.isDirectory()){
                indexDirectory(writer, file);
            }
            else if (file.isFile() && file.getName().endsWith(".pdf")){
                indexFile(writer, file);
            }
        }
    }


    private static String getTextFromPDF(File pdfFile) {
        // extract PDF document's textual content
        String docText = null;
        PDDocument pdDoc;
        try {
            pdDoc= PDDocument.load(pdfFile);
            PDFTextStripper stripper = new PDFTextStripper();
            docText = stripper.getText(pdDoc);
            pdDoc.close();
        }
        catch (Exception e) {
            System.out.println(pdfFile.getAbsolutePath());
        }

        return docText;
    }

}


On Nov 27, 2007 9:59 PM, Erick Erickson <erickerickson@gmail.com> wrote:

> Attachments often do not come through, at least they aren't visible to
> me using g-mail. So you might want to re-send them in-line.
>
> But another thing you can do is get a copy of luke and examine
> your index to see if the actual contents of doc1 and doc2 are what
> you expect. You can even run queries through it (but watch to insure
> that you're using the correct analyzer) and see what is returned....
>
> Best
> Erick
>
> On Nov 27, 2007 3:54 PM, Ng Vinny <ngvinny@gmail.com> wrote:
>
> > Hi all,
> >
> > I am having a problem with Lucene 2.2.0 with regard to the contents of
> the
> > Explanation objects after a PhraseQuery search. I indexed two documents
> doc1
> > and doc2 and then issue an OR Boolean query consisting of two
> PhraseQuery
> > pq1 and pq2.
> >
> > Apparently, the details of the Explanation object for doc1 show that pq1
> > has positive tf value even though it doesn't appear in doc1. The tf
> value is
> > exactly the same as that of the tf value for pq1 in doc2 (pq1 does
> appear in
> > doc2).
> >
> > The code is attached (the sample pdf files cannot be attached due to
> size
> > restriction on the list).
> >
> > Please help to shed some light on this.
> >
> > Thank you very much
> > Ng Vinny
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>

------=_Part_1478_14096167.1196202179557--

From java-user-return-31233-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Tue Nov 27 23:13:44 2007
Return-Path: <java-user-return-31233-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3864 invoked from network); 27 Nov 2007 23:13:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 27 Nov 2007 23:13:44 -0000
Received: (qmail 60629 invoked by uid 500); 27 Nov 2007 23:13:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 60606 invoked by uid 500); 27 Nov 2007 23:13:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 60595 invoked by uid 99); 27 Nov 2007 23:13:25 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 15:13:25 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [216.154.214.159] (HELO botspiritcompany.com) (216.154.214.159)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 23:13:27 +0000
Received: from www.botspiritcompany.com (botspiritcompany.com [127.0.0.1])
	by botspiritcompany.com (8.13.1/8.13.1) with ESMTP id lARND6dD015472
	for <java-user@lucene.apache.org>; Tue, 27 Nov 2007 18:13:06 -0500
From: "bbrown" <bbrown@botspiritcompany.com>
To: java-user@lucene.apache.org
Subject: Lucene or nutch for indexing web documents
Date: Tue, 27 Nov 2007 18:13:06 -0500
Message-Id: <20071127230908.M83531@www.botspiritcompany.com>
X-Mailer: Open WebMail 2.51 20050228
X-OriginatingIP: 68.208.8.29 (bbrown)
MIME-Version: 1.0
Content-Type: text/plain;
	charset=iso-8859-1
Received-SPF: pass (botspiritcompany.com: domain of bbrown@www.botspiritcompany.com designates 127.0.0.1 as permitted sender) receiver=botspiritcompany.com; client-ip=127.0.0.1; helo=www.botspiritcompany.com; envelope-from=bbrown@www.botspiritcompany.com; x-software=spfmilter 0.97 http://www.acme.com/software/spfmilter/ with libspf2-1.0.0;
X-Virus-Checked: Checked by ClamAV on apache.org

I was considering not using nutch for indexing web documents.  I was thinking
either extracting the full HTML document or through the use of some kind of
web scraper html parser utility extracting only the text content from a web
page and then indexing that.

I know it is strange, but I feel I have more control on what gets indexed if I
use just Lucene.  Eg, I can add more fields and also I guarantee I will be
able to search what gets indexed.

Is this a bad approach or should I just use nutch?

--
Berlin Brown
[berlin dot brown at gmail dot com]
http://botspiritcompany.com/botlist/?


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31234-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 03:23:51 2007
Return-Path: <java-user-return-31234-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6068 invoked from network); 28 Nov 2007 03:23:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 03:23:51 -0000
Received: (qmail 38940 invoked by uid 500); 28 Nov 2007 03:23:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38897 invoked by uid 500); 28 Nov 2007 03:23:33 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38883 invoked by uid 99); 28 Nov 2007 03:23:33 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 19:23:33 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [217.12.11.95] (HELO smtp006.mail.ukl.yahoo.com) (217.12.11.95)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 28 Nov 2007 03:23:35 +0000
Received: (qmail 84121 invoked from network); 27 Nov 2007 22:52:24 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-YMail-OSG:Message-ID:Date:From:User-Agent:MIME-Version:To:Subject:References:In-Reply-To:Content-Type:Content-Transfer-Encoding;
  b=fFxM/mTWkL1IgPyfgLOGkJ6B04KXOWT+jxqsXMXBw6OI+yUJzM+rsPoBzX6pbzeTLurqkL+iXFqSmo10Ps2jIZJZ58ah2WMFnxF0UOCc8utQ9sBlMqt+DXzatjNyMFFRkmyzK2CBwTqRaaVrvbol3kfOaKvxbJf1cENGBhwn+lg=  ;
Received: from unknown (HELO ?127.0.0.1?) (markharw00d@194.106.34.5 with plain)
  by smtp006.mail.ukl.yahoo.com with SMTP; 27 Nov 2007 22:52:23 -0000
X-YMail-OSG: A8g4jd0VM1mINakZkJFIaMYURbD20eYrtmR56V.pyRZj78VeCI3e51NwHxA1FYIEQG7XU9qQWc0DtVOb1W5Gdrsw4cvPdZTzSY01KZ8T2JK.NLk8RsLFAODj_Mg-
Message-ID: <474C9FA4.3080304@yahoo.co.uk>
Date: Tue, 27 Nov 2007 22:52:20 +0000
From: markharw00d <markharw00d@yahoo.co.uk>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Searching user-private annotations associated with indexed documents
References: <59899.43620.qm@web26011.mail.ukl.yahoo.com> <cec089090711271148q6f482c18pc4ebc9b5691680a4@mail.gmail.com>
In-Reply-To: <cec089090711271148q6f482c18pc4ebc9b5691680a4@mail.gmail.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

lucene user wrote:
> Am I being clear?
>   

Now you are.
> I don't know what you mean  by "PERSON_ANNOTATION works for Google".
>   
I suppose I meant annotations in the sense GATE and UIMA refer to 
annotations. They are like a highlighter pen marking a particular 
section of a document and adding metadata. It is is possible to 
"overlay" such metadata in the token stream so the sentence "Joe Smith 
works for Google" would have a special "person" annotation token 
introduced *at the same position* as "Joe Smith" and a "company" 
annotation token introduced at the same position as "Google". You then 
have a searchable document that contains both highly specific terms 
("Joe Smith", "Google") and their more generic forms("person", 
"company"). You can then conduct queries to find out which people "work 
for Google" and what companies "Joe Smith works for". Sounds like your 
annotations are a different beast.

One way of weaving your "personalisation" functionality cleanly into 
Lucene would be as follows:
1) Pick up the user's authentication from inside a ServletFilter 
(assuming you have a standard webapp) and set a thread-local "user" 
variable.
2) Overide FilterIndexReader with a new "PersonalisedIndexReader" which 
wraps the standard IndexReader. This class supplies an additional 
"annotations" field in the TermEnum/TermDocs which is personalised 
according to the thread-local "user" variable.

This approach allows you to use all of the standard Lucene functionality 
and yet have a personalised view of the index for each user of the 
system. The join between matches on the personalised "annotations" field 
and the standard Lucene text fields can be optimised because of the 
low-level "TermDocs.skipTo" calls the query logic makes when executing 
Boolean logic. This level of optimisation could not be achieved if you 
did this join outside of Lucene.
The hard bit is managing the details behind storage/retrieval of the 
user's annotations and managing references to doc Ids in this reader but 
overall this seems like a clean way of packaging it all together.

Cheers,
Mark









> On Nov 27, 2007 7:54 AM, mark harwood <markharw00d@yahoo.co.uk> wrote:
>   
>> Do the annotations have positions ?
>>
>> Do you want to do things like phrase-search e.g.
>>      "PERSON_ANNOTATION works for Google"
>>
>> Or is your idea of an annotation more simply a del.ici.ous-style tag associated with the whole document?
>>
>> Cheers
>> Mark
>>
>>
>> ----- Original Message ----
>> From: lucene user <luz290@gmail.com>
>> To: java-user@lucene.apache.org
>> Sent: Tuesday, 27 November, 2007 12:31:38 PM
>> Subject: Re: Searching user-private annotations associated with indexed documents
>>
>> I'd be VERY grateful for your help, folks! Thanks! I really need some
>> insight on this. THANKS!!
>>
>> On Nov 26, 2007 6:43 PM, lucene user <luz290@gmail.com> wrote:
>>     
>>> Here are the three options that seem practical to us right now.
>>>
>>> (1) Do The annotation search in postgres using LIKE or the
>>>    postgres native full text search. Take the resulting list
>>>    of file ids and use it to build a filter for the lucene query,
>>>    the way we currently do for folders.
>>>
>>> (2) Add a second lucene index that contains only annotations.
>>>    First retrieve a list of file ids satisfying the annotation
>>>    query from this index and use it to create a filter for the
>>>    main lucene query on the archive.
>>>    Whenever annotation text is edited,
>>>      if blank, delete annotation from index
>>>      otherwise add or replace annotation in index.
>>>
>>> (3) Add a second lucene index that contains contentrefs.
>>>     This index would contain the same fields as the arhicve index
>>>     plus the following:
>>>       database_id: list of systemuser_id and contentref_id.
>>>       annotation:  list of all annotation text for this
>>>                    system user and content ref.
>>>       folders:     list of all folder names for this systemuser and
>>>                    content ref
>>>
>>>     Whenever an article is added to or removed from a folder,
>>>     or its annotation text is edited, the following would occur:
>>>       See if it has an entry in the lucene index for the database.
>>>       if so,
>>>         extract the lucene document from the index.
>>>         if the updated list of folders that contain it is empty,
>>>            delete this document from the lucene database index.
>>>         otherwise,
>>>           update the folder and annotation in the document object.
>>>           delete this document from the index.
>>>           add the updated document object to the index.
>>>       if not,
>>>         extract the lucene document for the article from the archive
>>>       
>>  index
>>     
>>>         add the database_id, folders, and annotation fields to this
>>>       
>>  object
>>     
>>>         add the document object to the lucene database index.
>>>
>>> Got a better idea on this?
>>>
>>> Thanks!!
>>>
>>>
>>> On Nov 26, 2007 5:33 PM, lucene user <luz290@gmail.com> wrote:
>>>       
>>>> Folks
>>>>
>>>> I have some additional textual data that is user specific,
>>>>         
>>  basically
>>     
>>>> annotations about documents. I would like to be able to do
>>>> **combined** searches, looking for some words in the document and
>>>>         
>>  some
>>     
>>>> in my users' private annotations about that document. Any
>>>>         
>>  suggestions
>>     
>>>> about how I should handle this? The annotations are changeable by
>>>> users at any time so we have to be ready to delete them and add
>>>>         
>>  others
>>     
>>>> at any time when the user does edit an annotation.
>>>>
>>>> Do I need a second Lucene index? Can I do a query against two
>>>>         
>>  indexes
>>     
>>>> at the same time? If so, how?
>>>>
>>>> The annotations will be very small but highly volatile. The
>>>>         
>>  database
>>     
>>>> of documents will grow large but nothing will be deleted from it.
>>>>
>>>> Thanks!
>>>>
>>>>         
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>>
>>
>>
>>       ___________________________________________________________
>> Yahoo! Answers - Got a question? Someone out there knows the answer. Try it
>> now.
>> http://uk.answers.yahoo.com/
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>     
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>   



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31235-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 07:13:36 2007
Return-Path: <java-user-return-31235-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 54989 invoked from network); 28 Nov 2007 07:13:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 07:13:36 -0000
Received: (qmail 44081 invoked by uid 500); 28 Nov 2007 07:13:21 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 43292 invoked by uid 500); 28 Nov 2007 07:13:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 43281 invoked by uid 99); 28 Nov 2007 07:13:19 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Nov 2007 23:13:19 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ssmith@mainstreamdata.com designates 209.63.42.201 as permitted sender)
Received: from [209.63.42.201] (HELO nexus1.mainstreamdata.com) (209.63.42.201)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 07:13:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by nexus1.mainstreamdata.com (Postfix) with ESMTP id EA2FA4802F
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 00:13:01 -0700 (MST)
X-Virus-Scanned: Debian amavisd-new at nexus1.mainstreamdata.com
Received: from nexus1.mainstreamdata.com ([127.0.0.1])
	by localhost (nexus1.mainstreamdata.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id wrAZ4j-56BgQ for <java-user@lucene.apache.org>;
	Wed, 28 Nov 2007 00:12:56 -0700 (MST)
Received: from exchange.slc.mainstreamdata.com (exchange.slc.mainstreamdata.com [10.2.1.132])
	by nexus1.mainstreamdata.com (Postfix) with ESMTP id 215724802C
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 00:12:56 -0700 (MST)
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: Lucene highlighting
Date: Wed, 28 Nov 2007 00:12:53 -0700
Message-ID: <55F9EF953014514EB6BEE1F5198CEEB4C7A973@exchange.slc.mainstreamdata.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene highlighting
Thread-Index: AcgxjhYPob+ytx5SRt68irnCUpCe8g==
From: "Scott Smith" <ssmith@mainstreamdata.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

I've been looking at the highlighter examples.  All of them seem to deal =
with fragments.  I need to highlight an entire document as it is =
displayed (i.e., highlight all of the keywords in it).  Can someone =
point me to some examples of this or does the highlighter code not do =
this?
=20
Thanks
=20
Scott

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31236-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 10:27:07 2007
Return-Path: <java-user-return-31236-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 20692 invoked from network); 28 Nov 2007 10:27:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 10:27:07 -0000
Received: (qmail 83702 invoked by uid 500); 28 Nov 2007 10:26:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83668 invoked by uid 500); 28 Nov 2007 10:26:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83657 invoked by uid 99); 28 Nov 2007 10:26:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 02:26:49 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.109.24.24] (HELO smtp-vbr4.xs4all.nl) (194.109.24.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 10:26:28 +0000
Received: from [192.168.89.206] (impressie.xs4all.nl [82.93.53.149])
	by smtp-vbr4.xs4all.nl (8.13.8/8.13.8) with ESMTP id lASAQT0Z044180
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 11:26:29 +0100 (CET)
	(envelope-from matthijs@impressie.nl)
Message-ID: <474D4260.4070208@impressie.nl>
Date: Wed, 28 Nov 2007 11:26:40 +0100
From: Matthijs Bierman <matthijs@impressie.nl>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene highlighting
References: <55F9EF953014514EB6BEE1F5198CEEB4C7A973@exchange.slc.mainstreamdata.com>
In-Reply-To: <55F9EF953014514EB6BEE1F5198CEEB4C7A973@exchange.slc.mainstreamdata.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

Hi Scott,

The highlighter code does not do this. You need to implement your own 
highlighter. What kind of documents are you indexing?

Matthijs

Scott Smith wrote:
> I've been looking at the highlighter examples.  All of them seem to deal with fragments.  I need to highlight an entire document as it is displayed (i.e., highlight all of the keywords in it).  Can someone point me to some examples of this or does the highlighter code not do this?
>  
> Thanks
>  
> Scott
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31237-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 10:45:51 2007
Return-Path: <java-user-return-31237-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25969 invoked from network); 28 Nov 2007 10:45:50 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 10:45:50 -0000
Received: (qmail 4822 invoked by uid 500); 28 Nov 2007 10:45:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4701 invoked by uid 500); 28 Nov 2007 10:45:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4690 invoked by uid 99); 28 Nov 2007 10:45:32 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 02:45:32 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [217.12.11.63] (HELO smtp009.mail.ukl.yahoo.com) (217.12.11.63)
    by apache.org (qpsmtpd/0.29) with SMTP; Wed, 28 Nov 2007 10:45:35 +0000
Received: (qmail 89538 invoked from network); 28 Nov 2007 09:39:24 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.co.uk;
  h=Received:X-YMail-OSG:Message-ID:Date:From:User-Agent:MIME-Version:To:Subject:References:In-Reply-To:Content-Type:Content-Transfer-Encoding;
  b=m7hNX7nRlk1QQPGEI4vfn4wr6YID0ivRozkoTpYzrDVRHJeB66ZYo6cqAHxXXX1AbL3mJ+XTstGY72Ghfv1BddrdoT8bXwoSg7Auqf7CxNNSAjxkREH5O2Xd1iB2cU4qqiSov61l7+635bWogYX7dRgG2zyubDZSGsJDydIV4r4=  ;
Received: from unknown (HELO ?127.0.0.1?) (markharw00d@194.106.34.5 with plain)
  by smtp009.mail.ukl.yahoo.com with SMTP; 28 Nov 2007 09:39:24 -0000
X-YMail-OSG: Eij_gRMVM1nJOTVnxz1Qw2PI29lXvY.ZH.KKYqeaZHXGD.pfUfVMxR34bOcAcJluHKQmy4PQ2w--
Message-ID: <474D3748.5040401@yahoo.co.uk>
Date: Wed, 28 Nov 2007 09:39:20 +0000
From: markharw00d <markharw00d@yahoo.co.uk>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene highlighting
References: <55F9EF953014514EB6BEE1F5198CEEB4C7A973@exchange.slc.mainstreamdata.com>
In-Reply-To: <55F9EF953014514EB6BEE1F5198CEEB4C7A973@exchange.slc.mainstreamdata.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


>  I need to highlight an entire document as it is displayed 

See NullFragmenter



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31238-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 11:42:24 2007
Return-Path: <java-user-return-31238-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 50987 invoked from network); 28 Nov 2007 11:42:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 11:42:24 -0000
Received: (qmail 83741 invoked by uid 500); 28 Nov 2007 11:42:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 83388 invoked by uid 500); 28 Nov 2007 11:42:05 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 83377 invoked by uid 99); 28 Nov 2007 11:42:05 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 03:42:05 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 11:42:07 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IxLIY-0003be-Nx
	for java-user@lucene.apache.org; Wed, 28 Nov 2007 03:41:46 -0800
Message-ID: <13990651.post@talk.nabble.com>
Date: Wed, 28 Nov 2007 03:41:46 -0800 (PST)
From: bigdoginuk <fzsu@comp.leeds.ac.uk>
To: java-user@lucene.apache.org
Subject: Compute the co-occurence beteen a phrase and a word
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fzsu@comp.leeds.ac.uk
X-Virus-Checked: Checked by ClamAV on apache.org


Hi all, 
I want to compute the co-occurence frequency between a word and a phrase(
this phrase contains some words, and the words in it should be successive
and in order). It's like an NEAR operation (like setting slop at 3...)

Does anyone know how to implement this? 

Thanks in advance. 

Rooney
-- 
View this message in context: http://www.nabble.com/Compute-the-co-occurence-beteen-a-phrase-and-a-word-tf4887952.html#a13990651
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31239-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 11:48:42 2007
Return-Path: <java-user-return-31239-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 52611 invoked from network); 28 Nov 2007 11:48:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 11:48:42 -0000
Received: (qmail 91295 invoked by uid 500); 28 Nov 2007 11:48:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 91267 invoked by uid 500); 28 Nov 2007 11:48:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 91253 invoked by uid 99); 28 Nov 2007 11:48:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 03:48:13 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.83] (HELO spunkymail-a18.g.dreamhost.com) (208.97.132.83)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 11:47:51 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a18.g.dreamhost.com (Postfix) with ESMTP id 383795B52D
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 03:47:51 -0800 (PST)
Message-Id: <B42BD588-E92A-44D8-91AA-EA33D676AB93@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <20071127230908.M83531@www.botspiritcompany.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Lucene or nutch for indexing web documents
Date: Wed, 28 Nov 2007 06:47:51 -0500
References: <20071127230908.M83531@www.botspiritcompany.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Seems reasonable to me, but I guess I wonder what kind of control you  
have that you don't in Nutch?  Maybe worth asking on Nutch.  Also, it  
is fairly easy in Nutch to separate the crawling aspect from the  
indexing aspect, such that you could use all of Nutch's power for  
crawling and extracting content, and then index in Lucene or Solr on  
your own.


On Nov 27, 2007, at 6:13 PM, bbrown wrote:

> I was considering not using nutch for indexing web documents.  I was  
> thinking
> either extracting the full HTML document or through the use of some  
> kind of
> web scraper html parser utility extracting only the text content  
> from a web
> page and then indexing that.
>
> I know it is strange, but I feel I have more control on what gets  
> indexed if I
> use just Lucene.  Eg, I can add more fields and also I guarantee I  
> will be
> able to search what gets indexed.
>
> Is this a bad approach or should I just use nutch?
>
> --
> Berlin Brown
> [berlin dot brown at gmail dot com]
> http://botspiritcompany.com/botlist/?
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31240-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 11:50:30 2007
Return-Path: <java-user-return-31240-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53374 invoked from network); 28 Nov 2007 11:50:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 11:50:30 -0000
Received: (qmail 96147 invoked by uid 500); 28 Nov 2007 11:50:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96118 invoked by uid 500); 28 Nov 2007 11:50:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96107 invoked by uid 99); 28 Nov 2007 11:50:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 03:50:12 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.202] (HELO spunkymail-a6.g.dreamhost.com) (208.97.132.202)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 11:49:50 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a6.g.dreamhost.com (Postfix) with ESMTP id 71CBC109F2B
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 03:49:52 -0800 (PST)
Message-Id: <996C3783-A0C2-4793-94E3-CAC8666F18A7@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <13990651.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Compute the co-occurence beteen a phrase and a word
Date: Wed, 28 Nov 2007 06:49:51 -0500
References: <13990651.post@talk.nabble.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Have a look at SpanQuery and it's derivatives.  You will need to do  
some post-processing as well.

-Grant

On Nov 28, 2007, at 6:41 AM, bigdoginuk wrote:

>
> Hi all,
> I want to compute the co-occurence frequency between a word and a  
> phrase(
> this phrase contains some words, and the words in it should be  
> successive
> and in order). It's like an NEAR operation (like setting slop at 3...)
>
> Does anyone know how to implement this?
>
> Thanks in advance.
>
> Rooney
> -- 
> View this message in context: http://www.nabble.com/Compute-the-co-occurence-beteen-a-phrase-and-a-word-tf4887952.html#a13990651
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31241-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 12:58:25 2007
Return-Path: <java-user-return-31241-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88056 invoked from network); 28 Nov 2007 12:58:25 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 12:58:25 -0000
Received: (qmail 70767 invoked by uid 500); 28 Nov 2007 12:58:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 69769 invoked by uid 500); 28 Nov 2007 12:58:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 69758 invoked by uid 99); 28 Nov 2007 12:58:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 04:58:07 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [194.109.24.27] (HELO smtp-vbr7.xs4all.nl) (194.109.24.27)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 12:58:09 +0000
Received: from [192.168.89.206] (impressie.xs4all.nl [82.93.53.149])
	by smtp-vbr7.xs4all.nl (8.13.8/8.13.8) with ESMTP id lASCvnm9057934
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 13:57:49 +0100 (CET)
	(envelope-from matthijs@impressie.nl)
Message-ID: <474D65D8.4030906@impressie.nl>
Date: Wed, 28 Nov 2007 13:58:00 +0100
From: Matthijs Bierman <matthijs@impressie.nl>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Lucene highlighting
References: <55F9EF953014514EB6BEE1F5198CEEB4C7A973@exchange.slc.mainstreamdata.com> <474D3748.5040401@yahoo.co.uk>
In-Reply-To: <474D3748.5040401@yahoo.co.uk>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by XS4ALL Virus Scanner
X-Virus-Checked: Checked by ClamAV on apache.org

This would only highlight plaintext though, not in the original document 
as I suspect the TS would like.

Matthijs

markharw00d wrote:
>
>>  I need to highlight an entire document as it is displayed 
>
> See NullFragmenter
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31242-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 13:08:11 2007
Return-Path: <java-user-return-31242-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90627 invoked from network); 28 Nov 2007 13:08:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 13:08:11 -0000
Received: (qmail 82150 invoked by uid 500); 28 Nov 2007 13:07:53 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82114 invoked by uid 500); 28 Nov 2007 13:07:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82102 invoked by uid 99); 28 Nov 2007 13:07:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 05:07:53 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of odndev@gmail.com designates 64.233.170.186 as permitted sender)
Received: from [64.233.170.186] (HELO rn-out-0102.google.com) (64.233.170.186)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 13:07:33 +0000
Received: by rn-out-0102.google.com with SMTP id v46so1118472rnb
        for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 05:07:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:subject:from:to:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        bh=Sbc5iURxcZ3uo4IWQg4FaFMadVV2tWhiGcSXQ2z3n0Q=;
        b=pxRc/NOcgRZV1oDObkK/DrV9Qg7N0kCV1AdAS4mJG63YD9m23H2RLQcpc8OxTK97CpEGCr1+G/BWDTn3WVsg4YUk18PGzwkXiLUftHpEfaFCU8M0ztlgIj6R+PFDGPyOlxzxhseAj52tOfEyJOzznckygVHr9qi/6gY4J5IZ4w4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:subject:from:to:content-type:date:message-id:mime-version:x-mailer:content-transfer-encoding;
        b=b3M462MxnkbjHL/S59YVv1V3/XAVtLwpmDdnXnS4R3m13huDNdvtOvPxoWl0+PgC/KjUJEOAocjKL+ZAwtju/SIaqna+C9Frs4F+ASwnD1MX+urRIbp047f66VwGxphVbZC0Z7605z0D6k9cFiWzkc9MKtpTTUz0Pn/Q6oQsurs=
Received: by 10.150.140.6 with SMTP id n6mr1171364ybd.1196255251831;
        Wed, 28 Nov 2007 05:07:31 -0800 (PST)
Received: from ?192.168.1.105? ( [65.24.26.102])
        by mx.google.com with ESMTPS id 7sm5191913wrh.2007.11.28.05.07.30
        (version=SSLv3 cipher=RC4-MD5);
        Wed, 28 Nov 2007 05:07:31 -0800 (PST)
Subject: Maven Lucene plugin ?
From: Olivier Dehon <odndev@gmail.com>
To: java-user@lucene.apache.org
Content-Type: text/plain
Date: Wed, 28 Nov 2007 08:07:29 -0500
Message-Id: <1196255249.6803.12.camel@droopy>
Mime-Version: 1.0
X-Mailer: Evolution 2.12.1 
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hello,

Has anyone worked on a lucene maven plugin?

I am thinking of embedding a lucene index as part of a maven artifact,
so that artifact repository managers can do a better job of searching
repositories, by exploiting the index that is customized/tailored for
every type of artifact.

It will also give the developers the ability to control how their
artifact is indexed/searched within the repository manager.

Thank you for any hints/pointers.

-Olivier



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31243-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 13:32:49 2007
Return-Path: <java-user-return-31243-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 99115 invoked from network); 28 Nov 2007 13:32:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 13:32:48 -0000
Received: (qmail 14057 invoked by uid 500); 28 Nov 2007 13:32:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14023 invoked by uid 500); 28 Nov 2007 13:32:31 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14012 invoked by uid 99); 28 Nov 2007 13:32:31 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 05:32:31 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of patrek@gmail.com designates 209.85.132.247 as permitted sender)
Received: from [209.85.132.247] (HELO an-out-0708.google.com) (209.85.132.247)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 13:32:09 +0000
Received: by an-out-0708.google.com with SMTP id c5so299123anc
        for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 05:32:12 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        bh=+cZAKhoUEbsJWrgvsrmq7dxwmyF3SvnJzJDCs3L7EKI=;
        b=PKjDn4LibLosmVzqCw/4m426SgKlLHtuXLZeU3YP5I2+MoiiqGhpfn8L5kvkIhVPFW4q8uuQjdk7/hVdeFgr0rWQ5Wyndt4RR9YJgY6HrnRM6NZR/rG/wHBG+eehg+M6iKuD8WVAIVV+Z2uJfWtYKKwtUt2q08ndxNeV41okAZ8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:references:in-reply-to:content-type:content-transfer-encoding;
        b=pRntabR52iTG5CpVI2JPUsGj9rBHj4PlBNRqolfVdzaYo5Q/E8fjQ9LWfLR1uk5UsJiqKAIrAodvM7mBVII3iWw9dpbHoVMANLjxu37ws1J1g4nANMTPM9UZJ2JV8hihimPB0ji8fBSUF33M2lDMjK3NHJ87SwausGAD3LaDXSo=
Received: by 10.100.202.9 with SMTP id z9mr9060303anf.1196256731851;
        Wed, 28 Nov 2007 05:32:11 -0800 (PST)
Received: from ?192.168.1.61? ( [132.210.142.98])
        by mx.google.com with ESMTPS id 7sm5221586wrh.2007.11.28.05.32.10
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Wed, 28 Nov 2007 05:32:10 -0800 (PST)
Message-ID: <474D6DD8.6030601@gmail.com>
Date: Wed, 28 Nov 2007 08:32:08 -0500
From: Patrick <patrek@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Re: Maven Lucene plugin ?
References: <1196255249.6803.12.camel@droopy>
In-Reply-To: <1196255249.6803.12.camel@droopy>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org


Hi,

Take a look at Proximity (http://proximity.abstracthorizon.org/px1/) a 
Maven Proxy that include Lucene search.

Patrick

Olivier Dehon wrote:
> Hello,
>
> Has anyone worked on a lucene maven plugin?
>
> I am thinking of embedding a lucene index as part of a maven artifact,
> so that artifact repository managers can do a better job of searching
> repositories, by exploiting the index that is customized/tailored for
> every type of artifact.
>
> It will also give the developers the ability to control how their
> artifact is indexed/searched within the repository manager.
>
> Thank you for any hints/pointers.
>
> -Olivier
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31244-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 13:51:19 2007
Return-Path: <java-user-return-31244-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 5939 invoked from network); 28 Nov 2007 13:51:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 13:51:19 -0000
Received: (qmail 31837 invoked by uid 500); 28 Nov 2007 13:51:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 31812 invoked by uid 500); 28 Nov 2007 13:51:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 31798 invoked by uid 99); 28 Nov 2007 13:51:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 05:51:02 -0800
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [209.85.132.244] (HELO an-out-0708.google.com) (209.85.132.244)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 13:51:04 +0000
Received: by an-out-0708.google.com with SMTP id c5so300335anc
        for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 05:50:41 -0800 (PST)
Received: by 10.100.255.10 with SMTP id c10mr9060859ani.1196257841903;
        Wed, 28 Nov 2007 05:50:41 -0800 (PST)
Received: by 10.90.82.3 with HTTP; Wed, 28 Nov 2007 05:50:41 -0800 (PST)
Message-ID: <962ea6660711280550k13f7246aq7272251f38c9044f@mail.gmail.com>
Date: Wed, 28 Nov 2007 05:50:41 -0800
From: "Bogdan Ghidireac" <bogdan@ecstend.com>
To: java-user@lucene.apache.org
Subject: Re: CheckIndex tool issues
In-Reply-To: <1196181235.6823.1223496915@webmail.messagingengine.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_5439_11799357.1196257841909"
References: <962ea6660711270644w6696f685g4c5f511e587cc6cc@mail.gmail.com>
	 <1196175011.19543.1223475441@webmail.messagingengine.com>
	 <1196181235.6823.1223496915@webmail.messagingengine.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_5439_11799357.1196257841909
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Great, everything runs fine now.. Thank you.

Bogdan

On 11/27/07, Michael McCandless <lucene@mikemccandless.com> wrote:
>
>
> OK I opened this JIRA issue to track this:
>
>   https://issues.apache.org/jira/browse/LUCENE-1069
>
> Mike
>
> "Michael McCandless" <lucene@mikemccandless.com> wrote:
> >
> > Woops!  You are right, this is a silly bug in the CheckIndex tool.  It
> is not
> > properly taking into account deletions.  I will open an issue & fix it.
> >
> > Thanks for testing & reporting this, and sorry about that.
> >
> > Mike
> >
> > "Bogdan Ghidireac" <bogdan@ecstend.com> wrote:
> > > Hi,
> > >
> > > I tried to use the CheckIndex tool (the latest svn code) and I was
> > > surprised
> > > to notice that all my indexes from production (around 30) are corrupt.
> > > This
> > > is highly unlikely because they were running for about one year and I
> had
> > > no
> > > exception during search so far.
> > >
> > > One recurring pattern I observed is that the tool reports the segments
> > > with
> > > deleted docs as corrupt. The one without deleted docs are fine.. Here
> is
> > > a
> > > sample output.
> > >
> > > index 1
> > >
> > >   6 of 7: name=_wxlp docCount=1001
> > >     compound=true
> > >     numFiles=1
> > >     size (MB)=0.213
> > >     no deletions
> > >     test: open reader.........OK
> > >     test: fields, norms.......OK [12 fields]
> > >     test: terms, freq, prox...OK [4142 terms; 8004 terms/docs pairs;
> 8006
> > > tokens]
> > >     test: stored fields.......OK [12012 total field count; avg 12
> fields
> > >     per
> > > doc]
> > >     test: term vectors........OK [0 total vector count; avg 0
> term/freq
> > > vector fields per doc]
> > >
> > >   7 of 7: name=_wxqg docCount=178
> > >     compound=true
> > >     numFiles=1
> > >     size (MB)=0.039
> > >     no deletions
> > >     test: open reader.........OK
> > >     test: fields, norms.......OK [12 fields]
> > >     test: terms, freq, prox...OK [819 terms; 1417 terms/docs pairs;
> 1417
> > > tokens]
> > >     test: stored fields.......OK [2136 total field count; avg 12
> fields
> > >     per
> > > doc]
> > >     test: term vectors........OK [0 total vector count; avg 0
> term/freq
> > > vector fields per doc]
> > >
> > > index 2
> > >
> > >   6 of 7: name=_10hr docCount=1978
> > >     compound=true
> > >     numFiles=2
> > >     size (MB)=3.601
> > >     has deletions [delFileName=_10hr_5.del]
> > >     test: open reader.........OK [17 deleted docs]
> > >     test: fields, norms.......OK [10 fields]
> > >     test: terms, freq, prox...FAILED
> > >     WARNING: would remove reference to this segment (-fix was not
> > > specified); full exception:
> > > java.lang.RuntimeException: term ASIN:342678033X docFreq=5 != num docs
> > > seen
> > > 4
> > >         at org.apache.lucene.index.CheckIndex.main(CheckIndex.java
> :217)
> > >
> > >   7 of 7: name=_10i0 docCount=196
> > >     compound=true
> > >     numFiles=1
> > >     size (MB)=0.44
> > >     no deletions
> > >     test: open reader.........OK
> > >     test: fields, norms.......OK [10 fields]
> > >     test: terms, freq, prox...OK [8611 terms; 24307 terms/docs pairs;
> > >     32841
> > > tokens]
> > >     test: stored fields.......OK [1960 total field count; avg 10
> fields
> > >     per
> > > doc]
> > >     test: term vectors........OK [0 total vector count; avg 0
> term/freq
> > > vector fields per doc]
> > >
> > >
> > > Is this a known issue or my indexes are really corrupt ?
> > >
> > > Regards,
> > > Bogdan
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_5439_11799357.1196257841909--

From java-user-return-31245-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 13:54:48 2007
Return-Path: <java-user-return-31245-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 6966 invoked from network); 28 Nov 2007 13:54:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 13:54:48 -0000
Received: (qmail 38372 invoked by uid 500); 28 Nov 2007 13:54:31 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 37781 invoked by uid 500); 28 Nov 2007 13:54:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 37769 invoked by uid 99); 28 Nov 2007 13:54:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 05:54:29 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 13:54:32 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 9AE6651369
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 08:54:11 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Wed, 28 Nov 2007 08:54:11 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 6E2AE9235; Wed, 28 Nov 2007 08:54:11 -0500 (EST)
Message-Id: <1196258051.22221.1223680373@webmail.messagingengine.com>
X-Sasl-Enc: /SJxJe/AS0AmYKlHBssvdLkednv3y2ocMoI1WKPV07Ko 1196258051
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <962ea6660711270644w6696f685g4c5f511e587cc6cc@mail.gmail.com>
   <1196175011.19543.1223475441@webmail.messagingengine.com>
   <1196181235.6823.1223496915@webmail.messagingengine.com>
   <962ea6660711280550k13f7246aq7272251f38c9044f@mail.gmail.com>
Subject: Re: CheckIndex tool issues
In-Reply-To: <962ea6660711280550k13f7246aq7272251f38c9044f@mail.gmail.com>
Date: Wed, 28 Nov 2007 08:54:11 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


Super!  Thanks for catching this.

Mike

"Bogdan Ghidireac" <bogdan@ecstend.com> wrote:
> Great, everything runs fine now.. Thank you.
> 
> Bogdan
> 
> On 11/27/07, Michael McCandless <lucene@mikemccandless.com> wrote:
> >
> >
> > OK I opened this JIRA issue to track this:
> >
> >   https://issues.apache.org/jira/browse/LUCENE-1069
> >
> > Mike
> >
> > "Michael McCandless" <lucene@mikemccandless.com> wrote:
> > >
> > > Woops!  You are right, this is a silly bug in the CheckIndex tool.  It
> > is not
> > > properly taking into account deletions.  I will open an issue & fix it.
> > >
> > > Thanks for testing & reporting this, and sorry about that.
> > >
> > > Mike
> > >
> > > "Bogdan Ghidireac" <bogdan@ecstend.com> wrote:
> > > > Hi,
> > > >
> > > > I tried to use the CheckIndex tool (the latest svn code) and I was
> > > > surprised
> > > > to notice that all my indexes from production (around 30) are corrupt.
> > > > This
> > > > is highly unlikely because they were running for about one year and I
> > had
> > > > no
> > > > exception during search so far.
> > > >
> > > > One recurring pattern I observed is that the tool reports the segments
> > > > with
> > > > deleted docs as corrupt. The one without deleted docs are fine.. Here
> > is
> > > > a
> > > > sample output.
> > > >
> > > > index 1
> > > >
> > > >   6 of 7: name=_wxlp docCount=1001
> > > >     compound=true
> > > >     numFiles=1
> > > >     size (MB)=0.213
> > > >     no deletions
> > > >     test: open reader.........OK
> > > >     test: fields, norms.......OK [12 fields]
> > > >     test: terms, freq, prox...OK [4142 terms; 8004 terms/docs pairs;
> > 8006
> > > > tokens]
> > > >     test: stored fields.......OK [12012 total field count; avg 12
> > fields
> > > >     per
> > > > doc]
> > > >     test: term vectors........OK [0 total vector count; avg 0
> > term/freq
> > > > vector fields per doc]
> > > >
> > > >   7 of 7: name=_wxqg docCount=178
> > > >     compound=true
> > > >     numFiles=1
> > > >     size (MB)=0.039
> > > >     no deletions
> > > >     test: open reader.........OK
> > > >     test: fields, norms.......OK [12 fields]
> > > >     test: terms, freq, prox...OK [819 terms; 1417 terms/docs pairs;
> > 1417
> > > > tokens]
> > > >     test: stored fields.......OK [2136 total field count; avg 12
> > fields
> > > >     per
> > > > doc]
> > > >     test: term vectors........OK [0 total vector count; avg 0
> > term/freq
> > > > vector fields per doc]
> > > >
> > > > index 2
> > > >
> > > >   6 of 7: name=_10hr docCount=1978
> > > >     compound=true
> > > >     numFiles=2
> > > >     size (MB)=3.601
> > > >     has deletions [delFileName=_10hr_5.del]
> > > >     test: open reader.........OK [17 deleted docs]
> > > >     test: fields, norms.......OK [10 fields]
> > > >     test: terms, freq, prox...FAILED
> > > >     WARNING: would remove reference to this segment (-fix was not
> > > > specified); full exception:
> > > > java.lang.RuntimeException: term ASIN:342678033X docFreq=5 != num docs
> > > > seen
> > > > 4
> > > >         at org.apache.lucene.index.CheckIndex.main(CheckIndex.java
> > :217)
> > > >
> > > >   7 of 7: name=_10i0 docCount=196
> > > >     compound=true
> > > >     numFiles=1
> > > >     size (MB)=0.44
> > > >     no deletions
> > > >     test: open reader.........OK
> > > >     test: fields, norms.......OK [10 fields]
> > > >     test: terms, freq, prox...OK [8611 terms; 24307 terms/docs pairs;
> > > >     32841
> > > > tokens]
> > > >     test: stored fields.......OK [1960 total field count; avg 10
> > fields
> > > >     per
> > > > doc]
> > > >     test: term vectors........OK [0 total vector count; avg 0
> > term/freq
> > > > vector fields per doc]
> > > >
> > > >
> > > > Is this a known issue or my indexes are really corrupt ?
> > > >
> > > > Regards,
> > > > Bogdan
> > >
> > > ---------------------------------------------------------------------
> > > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > > For additional commands, e-mail: java-user-help@lucene.apache.org
> > >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> > For additional commands, e-mail: java-user-help@lucene.apache.org
> >
> >

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31246-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 15:46:42 2007
Return-Path: <java-user-return-31246-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 49592 invoked from network); 28 Nov 2007 15:46:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 15:46:42 -0000
Received: (qmail 20499 invoked by uid 500); 28 Nov 2007 15:46:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20463 invoked by uid 500); 28 Nov 2007 15:46:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20452 invoked by uid 99); 28 Nov 2007 15:46:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 07:46:23 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 15:46:02 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1IxP6y-0003BH-Ia
	for java-user@lucene.apache.org; Wed, 28 Nov 2007 07:46:04 -0800
Message-ID: <13995126.post@talk.nabble.com>
Date: Wed, 28 Nov 2007 07:46:04 -0800 (PST)
From: bigdoginuk <fzsu@comp.leeds.ac.uk>
To: java-user@lucene.apache.org
Subject: Re: Compute the co-occurence beteen a phrase and a word
In-Reply-To: <996C3783-A0C2-4793-94E3-CAC8666F18A7@apache.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: fzsu@comp.leeds.ac.uk
References: <13990651.post@talk.nabble.com> <996C3783-A0C2-4793-94E3-CAC8666F18A7@apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org


Hi, thanks for the reply. 

But can anyone give me some more hints? I have checked SpanQuery, but still
haven't found out a solution. 

Thanks. 


Grant Ingersoll-6 wrote:
> 
> Have a look at SpanQuery and it's derivatives.  You will need to do  
> some post-processing as well.
> 
> -Grant
> 
> On Nov 28, 2007, at 6:41 AM, bigdoginuk wrote:
> 
>>
>> Hi all,
>> I want to compute the co-occurence frequency between a word and a  
>> phrase(
>> this phrase contains some words, and the words in it should be  
>> successive
>> and in order). It's like an NEAR operation (like setting slop at 3...)
>>
>> Does anyone know how to implement this?
>>
>> Thanks in advance.
>>
>> Rooney
>> -- 
>> View this message in context:
>> http://www.nabble.com/Compute-the-co-occurence-beteen-a-phrase-and-a-word-tf4887952.html#a13990651
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
> 
> --------------------------
> Grant Ingersoll
> http://lucene.grantingersoll.com
> 
> Lucene Helpful Hints:
> http://wiki.apache.org/lucene-java/BasicsOfPerformance
> http://wiki.apache.org/lucene-java/LuceneFAQ
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Compute-the-co-occurence-beteen-a-phrase-and-a-word-tf4887952.html#a13995126
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31247-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 17:42:35 2007
Return-Path: <java-user-return-31247-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 4387 invoked from network); 28 Nov 2007 17:42:35 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 17:42:35 -0000
Received: (qmail 56888 invoked by uid 500); 28 Nov 2007 17:42:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 56856 invoked by uid 500); 28 Nov 2007 17:42:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 56845 invoked by uid 99); 28 Nov 2007 17:42:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 09:42:17 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 17:42:20 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <172832(2)>; Wed, 28 Nov 2007 09:41:45 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Wed, 28 Nov 2007 09:41:36 PST
To: java-user@lucene.apache.org
Subject: lucene-core-2.2.0.jar broken?  CorruptIndexException?
Date: Wed, 28 Nov 2007 09:41:34 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I've got a DB of about 20000 pages which I thought I'd update to
Lucene 2.2.  I removed the old index (2.0 based) completely, and
started re-indexing all the documents.  I do this in stages, of about
50 pages at a time, serially, starting a new JVM each time, and reading
in the existing index, then adding to it, optimizing, and exiting.  I
know, really inefficient, and not my long-term plan.

Anyway, while I was doing this, I get the following exception in the
optimize step:

org.apache.lucene.index.CorruptIndexException: docs out of order (3760 <= 4083 )
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:368)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:325)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:297)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:261)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:98)
	at org.apache.lucene.index.IndexWriter.mergeSegments(IndexWriter.java:1883)
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1231)
	at com.parc.uplib.indexing.LuceneIndexing.update(LuceneIndexing.java:410)
	at com.parc.uplib.indexing.LuceneIndexing.main(LuceneIndexing.java:655)

This is OS X 10.4.11, PPC, Java 1.5, with 
"-Dorg.apache.lucene.writeLockTimeout=20000".

Do I need to go back to 2.0?

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31248-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 18:24:06 2007
Return-Path: <java-user-return-31248-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27019 invoked from network); 28 Nov 2007 18:24:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 18:24:06 -0000
Received: (qmail 47788 invoked by uid 500); 28 Nov 2007 18:23:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 47751 invoked by uid 500); 28 Nov 2007 18:23:47 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 47740 invoked by uid 99); 28 Nov 2007 18:23:47 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 10:23:47 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 18:23:27 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <173360(2)>; Wed, 28 Nov 2007 10:23:05 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Wed, 28 Nov 2007 10:23:01 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
Comments: In-reply-to Bill Janssen <janssen@parc.com>
    message dated "Wed, 28 Nov 2007 09:41:34 -0800."
Date: Wed, 28 Nov 2007 10:22:54 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Here's the code I'm using:

        try {

            // Now add the documents to the index
            IndexWriter writer = new IndexWriter(index_loc, new StandardAnalyzer(), !index_loc.exists());
            writer.setMaxFieldLength(Integer.MAX_VALUE);

            try {
                for (int i = start;  i < ids.length;  i ++) {
                    docit = build_document_iterator(doc_root_dir, ids[i]);
                    int count = 0;
                    while (docit.hasNext()) {
                        writer.addDocument((Document)(docit.next()));
                        count += 1;
                    }
                    System.out.println("Added " + docit.id + " (" + count + " versions)");
                    System.out.flush();
                }
            } finally {
                // And close the index
                System.out.println("Optimizing...");
                writer.optimize();
                writer.close();
            }

        } catch (Exception e) {
	    e.printStackTrace(System.err);
        }

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31249-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 19:29:50 2007
Return-Path: <java-user-return-31249-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62915 invoked from network); 28 Nov 2007 19:29:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 19:29:49 -0000
Received: (qmail 88888 invoked by uid 500); 28 Nov 2007 19:29:29 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 88848 invoked by uid 500); 28 Nov 2007 19:29:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 88837 invoked by uid 99); 28 Nov 2007 19:29:29 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 11:29:29 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 19:29:09 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <175619(1)>; Wed, 28 Nov 2007 11:28:55 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Wed, 28 Nov 2007 11:28:47 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
Comments: In-reply-to Bill Janssen <janssen@parc.com>
    message dated "Wed, 28 Nov 2007 10:22:54 -0800."
Date: Wed, 28 Nov 2007 11:28:42 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

I just tried re-indexing with lucene-core-2.0.0.jar and the same
indexing code; works great.  So what am I doing wrong with 2.2?

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31250-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 19:38:03 2007
Return-Path: <java-user-return-31250-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66804 invoked from network); 28 Nov 2007 19:38:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 19:38:03 -0000
Received: (qmail 99240 invoked by uid 500); 28 Nov 2007 19:37:44 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 99201 invoked by uid 500); 28 Nov 2007 19:37:44 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 99190 invoked by uid 99); 28 Nov 2007 19:37:44 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 11:37:44 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [208.69.42.181] (HELO radix.cryptio.net) (208.69.42.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 19:37:47 +0000
Received: by radix.cryptio.net (Postfix, from userid 1007)
	id E1AD771C11E; Wed, 28 Nov 2007 11:37:26 -0800 (PST)
Received: from localhost (localhost [127.0.0.1])
	by radix.cryptio.net (Postfix) with ESMTP id DDC1771C0D8
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 11:37:26 -0800 (PST)
Date: Wed, 28 Nov 2007 11:37:26 -0800 (PST)
From: Chris Hostetter <hossman_lucene@fucit.org>
To: java-user@lucene.apache.org
Subject: Re: prefix query search problem if a hyphen exist in the search word
In-Reply-To: <13966231.post@talk.nabble.com>
Message-ID: <Pine.LNX.4.62.0711281134440.23881@radix.cryptio.net>
References: <13966231.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; charset=US-ASCII
X-Virus-Checked: Checked by ClamAV on apache.org


: Search query is like this ttl:co-operative it returns more than 50 results,
: but if i convert the query like this ttl:co-operat* it  returns no result.
: again i entered a query ttl:11-amino it returns some results, then  changed
: the above query into ttl:11-amino* it will return some more results than
: previous query.

if you'd searched the FAQ for "prefix" you would have found this 
question...

  Are Wildcard, Prefix, and Fuzzy queries case sensitive?

that may not seem like it relates to your problem, but if you read the 
answer...

  No, not by default. Unlike other types of Lucene queries, Wildcard, 
  Prefix, and Fuzzy queries are not passed through the Analyzer, which is 
  the component that performs operations such as stemming and lowercasing. 
  The reason for skipping the Analyzer is that if you were searching for 
  "dogs*" you would not want "dogs" first stemmed to "dog", since that would 
  then match "dog*", which is not the intended query. These queries are 
  case-insensitive anyway because QueryParser makes them lowercase. This 
  behavior can be changed using the setLowercaseExpandedTerms(boolean) 
  method.

...the key being that wildcard and prefix queries aren't analyzed, so if 
you are using an Analyzer that does something special with hyphens (like 
split on then perhaps) that would explain the behavior you are seeing.



-Hoss


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31251-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 20:05:15 2007
Return-Path: <java-user-return-31251-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 75863 invoked from network); 28 Nov 2007 20:05:15 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 20:05:15 -0000
Received: (qmail 39670 invoked by uid 500); 28 Nov 2007 20:04:56 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 39626 invoked by uid 500); 28 Nov 2007 20:04:56 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 39615 invoked by uid 99); 28 Nov 2007 20:04:56 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 12:04:56 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 20:04:36 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 5A31957A89
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 15:04:38 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Wed, 28 Nov 2007 15:04:38 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 3E55D342BA; Wed, 28 Nov 2007 15:04:38 -0500 (EST)
Message-Id: <1196280278.23481.1223752059@webmail.messagingengine.com>
X-Sasl-Enc: JcQjhqZlI7Awny7lZvbMQXnve/4Pu9ZSHCiX+9jO0f+S 1196280278
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException?
In-Reply-To: <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
Date: Wed, 28 Nov 2007 15:04:38 -0500
X-Virus-Checked: Checked by ClamAV on apache.org

Are you really sure in your 2.2 test you are starting with no prior
index?

2.2 should in fact work fine with a 2.0 index but it's possible there
was some latent corruption in the 2.0 index if you are accidentally
using it.  That exception looks alot like this dreaded bug:

  https://issues.apache.org/jira/browse/LUCENE-140

which was fixed in 2.1.

Mike

"Bill Janssen" <janssen@parc.com> wrote:
> I just tried re-indexing with lucene-core-2.0.0.jar and the same
> indexing code; works great.  So what am I doing wrong with 2.2?
> 
> Bill
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31252-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 21:02:30 2007
Return-Path: <java-user-return-31252-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 95083 invoked from network); 28 Nov 2007 21:02:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 21:02:30 -0000
Received: (qmail 41730 invoked by uid 500); 28 Nov 2007 21:02:11 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 41659 invoked by uid 500); 28 Nov 2007 21:02:11 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 41648 invoked by uid 99); 28 Nov 2007 21:02:11 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 13:02:11 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 21:01:50 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <222614(1)>; Wed, 28 Nov 2007 13:01:46 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Wed, 28 Nov 2007 13:01:37 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <1196280278.23481.1223752059@webmail.messagingengine.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com>
Comments: In-reply-to "Michael McCandless" <lucene@mikemccandless.com>
    message dated "Wed, 28 Nov 2007 12:04:38 -0800."
Date: Wed, 28 Nov 2007 13:01:29 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov28.130137pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Are you really sure in your 2.2 test you are starting with no prior
> index?

I'd ask that too, but yes, I'm really really sure.  Building a
completely new index each time.

Works with 2.0.0.  Fails with 2.2.0.  Works with 2.2.0 *if* I remove
the optimization step.

Bill


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31253-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Wed Nov 28 21:17:42 2007
Return-Path: <java-user-return-31253-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 970 invoked from network); 28 Nov 2007 21:17:42 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 28 Nov 2007 21:17:42 -0000
Received: (qmail 78378 invoked by uid 500); 28 Nov 2007 21:17:23 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 78356 invoked by uid 500); 28 Nov 2007 21:17:23 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 78344 invoked by uid 99); 28 Nov 2007 21:17:23 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 13:17:23 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 21:17:04 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id A807C58188
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 16:17:05 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Wed, 28 Nov 2007 16:17:05 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 85B1C1D149; Wed, 28 Nov 2007 16:17:05 -0500 (EST)
Message-Id: <1196284625.4114.1223763677@webmail.messagingengine.com>
X-Sasl-Enc: BqCfMmbtxyPwj0wicD03J+f8lR5y2Wjs3rdxOrVLS4HQ 1196284625
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
   <1196280278.23481.1223752059@webmail.messagingengine.com>
   <07Nov28.130137pst."58696"@synergy1.parc.xerox.com>
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException?
In-Reply-To: <07Nov28.130137pst."58696"@synergy1.parc.xerox.com>
Date: Wed, 28 Nov 2007 16:17:05 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


Hmmm ... how many chunks of "about 50 pages" do you do before hitting this?
Roughly how many docs are in the index when it happens?

Can you describe the docs/fields you're adding?

You are not hitting any other exception before this one right?

Can you change your test case so that the "catch" clause is run
before the "finally" clause?  I wonder if you are hitting some
interesting exception and then trying to optimize, which then
masks the original exception.

Mike

"Bill Janssen" <janssen@parc.com> wrote:
> > Are you really sure in your 2.2 test you are starting with no prior
> > index?
> 
> I'd ask that too, but yes, I'm really really sure.  Building a
> completely new index each time.
> 
> Works with 2.0.0.  Fails with 2.2.0.  Works with 2.2.0 *if* I remove
> the optimization step.
> 
> Bill
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31254-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 02:00:36 2007
Return-Path: <java-user-return-31254-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12703 invoked from network); 29 Nov 2007 02:00:36 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 02:00:36 -0000
Received: (qmail 84293 invoked by uid 500); 29 Nov 2007 02:00:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 84265 invoked by uid 500); 29 Nov 2007 02:00:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 84253 invoked by uid 99); 29 Nov 2007 02:00:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 18:00:17 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 02:00:19 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <385799(1)>; Wed, 28 Nov 2007 17:59:46 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Wed, 28 Nov 2007 17:59:38 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <1196284625.4114.1223763677@webmail.messagingengine.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com>
Comments: In-reply-to "Michael McCandless" <lucene@mikemccandless.com>
    message dated "Wed, 28 Nov 2007 13:17:05 -0800."
Date: Wed, 28 Nov 2007 17:59:30 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov28.175938pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> You are not hitting any other exception before this one right?
> 
> Can you change your test case so that the "catch" clause is run
> before the "finally" clause?  I wonder if you are hitting some
> interesting exception and then trying to optimize, which then
> masks the original exception.

Yes, I thought of that.  But when I comment out the call to
"optimize()", no exception is signalled.  So I think it's unlikely.

I'm thinking it might be an endianness issue.  Do you folks test a lot
on big-endian platforms?  Just the kind of thing that affects
bit-string manipulation.  I'm going to run the same software on an
Intel machine and see what happens.

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31255-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 02:51:44 2007
Return-Path: <java-user-return-31255-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31287 invoked from network); 29 Nov 2007 02:51:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 02:51:44 -0000
Received: (qmail 26420 invoked by uid 500); 29 Nov 2007 02:51:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26386 invoked by uid 500); 29 Nov 2007 02:51:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26374 invoked by uid 99); 29 Nov 2007 02:51:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 18:51:26 -0800
X-ASF-Spam-Status: No, hits=3.2 required=10.0
	tests=HTML_MESSAGE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [202.167.225.74] (HELO topsp701-int0.prod.tradingscreen.com) (202.167.225.74)
    by apache.org (qpsmtpd/0.29) with SMTP; Thu, 29 Nov 2007 02:51:29 +0000
Received: from tkdwi001.dev.tradingscreen.com ([172.21.16.56])
 by topsp701-int0.prod.tradingscreen.com (SMSSMTP 4.1.5.31) with SMTP id M2007112911510300539
 for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 11:51:03 +0900
X-MimeOLE: Produced By Microsoft Exchange V6.5.7226.0
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----_=_NextPart_001_01C83232.AE425E99"
Subject: CorruptIndexException
Date: Thu, 29 Nov 2007 11:51:03 +0900
Message-ID: <847893AE8EE17A48A3725E82C10DE9E5011C2A19@tkdwi001.dev.tradingscreen.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: CorruptIndexException
Thread-Index: AcgyMqrToOGMOgJ2Rue7H13CTfdOqA==
From: "Melanie Langlois" <Melanie.Langlois@tradingscreen.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

------_=_NextPart_001_01C83232.AE425E99
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

Hi,

=20

I use Lucli to optimize my index, when my application was stopped. And =
after restarting my application, I could not serahc my index anymore, I =
got the following exception :

=20

org.apache.lucene.index.CorruptIndexException: Unknown format version: =
-4

        at =
org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:204)

        at =
org.apache.lucene.index.IndexReader$1.doBody(IndexReader.java:190)

        at =
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.ja=
va:610)

        at =
org.apache.lucene.index.IndexReader.open(IndexReader.java:185)

        at =
org.apache.lucene.index.IndexReader.open(IndexReader.java:167)

=20

I have two questions:

-why does it occurs ? Should I use another tool to access the index =
outside of my application ?

-do there is way to recover ?

=20

=20

Thanks,

=20

M=E9lanie


------_=_NextPart_001_01C83232.AE425E99--

From java-user-return-31256-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 02:53:07 2007
Return-Path: <java-user-return-31256-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 31685 invoked from network); 29 Nov 2007 02:53:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 02:53:06 -0000
Received: (qmail 28202 invoked by uid 500); 29 Nov 2007 02:52:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 28162 invoked by uid 500); 29 Nov 2007 02:52:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 28149 invoked by uid 99); 29 Nov 2007 02:52:49 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 18:52:49 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 02:52:28 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <385822(1)>; Wed, 28 Nov 2007 18:52:17 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Wed, 28 Nov 2007 18:52:14 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <07Nov28.175938pst."58696"@synergy1.parc.xerox.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.175938pst."58696"@synergy1.parc.xerox.com>
Comments: In-reply-to Bill Janssen <janssen@parc.com>
    message dated "Wed, 28 Nov 2007 17:59:30 -0800."
Date: Wed, 28 Nov 2007 18:52:10 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov28.185214pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> I'm going to run the same software on an
> Intel machine and see what happens.

So, I ran the same codebase with lucene-core-2.2.0.jar on an Intel Mac
Pro, OS X 10.5.0, Java 1.5, and no exception is raised.  Different
corpus, about 50000 pages instead of 20000.  This is reinforcing my
thinking that it's a big-endian issue.

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31257-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 04:22:02 2007
Return-Path: <java-user-return-31257-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 55804 invoked from network); 29 Nov 2007 04:22:02 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 04:22:02 -0000
Received: (qmail 96817 invoked by uid 500); 29 Nov 2007 04:21:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 96776 invoked by uid 500); 29 Nov 2007 04:21:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 96765 invoked by uid 99); 29 Nov 2007 04:21:42 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 20:21:42 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of ssmith@mainstreamdata.com designates 209.63.42.201 as permitted sender)
Received: from [209.63.42.201] (HELO nexus1.mainstreamdata.com) (209.63.42.201)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 04:21:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by nexus1.mainstreamdata.com (Postfix) with ESMTP id CCA146E014
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 21:21:24 -0700 (MST)
X-Virus-Scanned: Debian amavisd-new at nexus1.mainstreamdata.com
Received: from nexus1.mainstreamdata.com ([127.0.0.1])
	by localhost (nexus1.mainstreamdata.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id f6sK3JOeRQgH for <java-user@lucene.apache.org>;
	Wed, 28 Nov 2007 21:21:19 -0700 (MST)
Received: from exchange.slc.mainstreamdata.com (exchange.slc.mainstreamdata.com [10.2.1.132])
	by nexus1.mainstreamdata.com (Postfix) with ESMTP id 1132D6E012
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 21:21:19 -0700 (MST)
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Lucene highlighting
Date: Wed, 28 Nov 2007 21:20:49 -0700
Message-ID: <55F9EF953014514EB6BEE1F5198CEEB4C7A976@exchange.slc.mainstreamdata.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene highlighting
Thread-Index: AcgxqUA4L/bcfRujRQmzbiM+3xoS5gAlfgnY
References: <55F9EF953014514EB6BEE1F5198CEEB4C7A973@exchange.slc.mainstreamdata.com> <474D4260.4070208@impressie.nl>
From: "Scott Smith" <ssmith@mainstreamdata.com>
To: <java-user@lucene.apache.org>,
	<java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

xml with embedded xhtml

________________________________

From: Matthijs Bierman [mailto:matthijs@impressie.nl]
Sent: Wed 11/28/2007 3:26 AM
To: java-user@lucene.apache.org
Subject: Re: Lucene highlighting



Hi Scott,

The highlighter code does not do this. You need to implement your own
highlighter. What kind of documents are you indexing?

Matthijs

Scott Smith wrote:
> I've been looking at the highlighter examples.  All of them seem to =
deal with fragments.  I need to highlight an entire document as it is =
displayed (i.e., highlight all of the keywords in it).  Can someone =
point me to some examples of this or does the highlighter code not do =
this?
>=20
> Thanks
>=20
> Scott
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>
>
> =20


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31258-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 05:01:55 2007
Return-Path: <java-user-return-31258-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 66836 invoked from network); 29 Nov 2007 05:01:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 05:01:55 -0000
Received: (qmail 30071 invoked by uid 500); 29 Nov 2007 05:01:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 30044 invoked by uid 500); 29 Nov 2007 05:01:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 30033 invoked by uid 99); 29 Nov 2007 05:01:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 21:01:36 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of ssmith@mainstreamdata.com designates 209.63.42.201 as permitted sender)
Received: from [209.63.42.201] (HELO nexus1.mainstreamdata.com) (209.63.42.201)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 05:01:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by nexus1.mainstreamdata.com (Postfix) with ESMTP id E1F012E007
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 22:01:18 -0700 (MST)
X-Virus-Scanned: Debian amavisd-new at nexus1.mainstreamdata.com
Received: from nexus1.mainstreamdata.com ([127.0.0.1])
	by localhost (nexus1.mainstreamdata.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id vv+JhE3L0dPV for <java-user@lucene.apache.org>;
	Wed, 28 Nov 2007 22:01:13 -0700 (MST)
Received: from exchange.slc.mainstreamdata.com (exchange.slc.mainstreamdata.com [10.2.1.132])
	by nexus1.mainstreamdata.com (Postfix) with ESMTP id 145CC2E008
	for <java-user@lucene.apache.org>; Wed, 28 Nov 2007 22:01:13 -0700 (MST)
X-MimeOLE: Produced By Microsoft Exchange V6.5
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: Lucene highlighting
Date: Wed, 28 Nov 2007 22:01:17 -0700
Message-ID: <55F9EF953014514EB6BEE1F5198CEEB4C7A977@exchange.slc.mainstreamdata.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: Lucene highlighting
Thread-Index: AcgxvmLrgvTkpRnsRzq9XyEhTXYdjQAhWeg9
References: <55F9EF953014514EB6BEE1F5198CEEB4C7A973@exchange.slc.mainstreamdata.com> <474D3748.5040401@yahoo.co.uk> <474D65D8.4030906@impressie.nl>
From: "Scott Smith" <ssmith@mainstreamdata.com>
To: <java-user@lucene.apache.org>,
	<java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org

Since what I'm dealing with is well-formed html, I wonder if I could =
modify the tokenizer to skip the html elements and then use the =
NullFragmenter.  I can probably isolate the html text.  Sounds like I =
have a plan or at least something to try.
=20
Thanks

________________________________

From: Matthijs Bierman [mailto:matthijs@impressie.nl]
Sent: Wed 11/28/2007 5:58 AM
To: java-user@lucene.apache.org
Subject: Re: Lucene highlighting



This would only highlight plaintext though, not in the original document
as I suspect the TS would like.

Matthijs

markharw00d wrote:
>
>>  I need to highlight an entire document as it is displayed
>
> See NullFragmenter
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31259-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 05:07:46 2007
Return-Path: <java-user-return-31259-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 68765 invoked from network); 29 Nov 2007 05:07:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 05:07:46 -0000
Received: (qmail 35621 invoked by uid 500); 29 Nov 2007 05:07:30 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 35078 invoked by uid 500); 29 Nov 2007 05:07:29 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 35067 invoked by uid 99); 29 Nov 2007 05:07:29 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Nov 2007 21:07:29 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 05:07:31 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <385901(2)>; Wed, 28 Nov 2007 21:06:57 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Wed, 28 Nov 2007 21:06:49 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <1196284625.4114.1223763677@webmail.messagingengine.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com>
Comments: In-reply-to "Michael McCandless" <lucene@mikemccandless.com>
    message dated "Wed, 28 Nov 2007 13:17:05 -0800."
Date: Wed, 28 Nov 2007 21:06:40 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov28.210649pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Hmmm ... how many chunks of "about 50 pages" do you do before hitting this?
> Roughly how many docs are in the index when it happens?

Oh, gosh, not sure.  I'm guessing it's about half done.

> Can you describe the docs/fields you're adding?

I've got 1735 documents, 18969 pages -- average page size 10.9, max
page size 1235 (a physics textbook), 578 one-page documents.  These
are Web pages, PDFs, articles, photos, scanned stuff, technical
papers, etc.  I index six documents at a time, so I guess I'm
averaging about 65 pages per chunk.  For each document, I index the
whole text of the document as a Lucene Document, and I index the text
of each page separately as a Document.  I use the "contents" fields
and "pagecontents" fields for those two uses.  I also add metadata
information to each: "title", multiple "author" fields, "date",
"abstract", etc.

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31260-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 08:26:24 2007
Return-Path: <java-user-return-31260-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 18613 invoked from network); 29 Nov 2007 08:26:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 08:26:24 -0000
Received: (qmail 85206 invoked by uid 500); 29 Nov 2007 08:26:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 85178 invoked by uid 500); 29 Nov 2007 08:26:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 85155 invoked by uid 99); 29 Nov 2007 08:26:06 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 00:26:06 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 66.249.92.174 as permitted sender)
Received: from [66.249.92.174] (HELO ug-out-1314.google.com) (66.249.92.174)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 08:25:45 +0000
Received: by ug-out-1314.google.com with SMTP id m3so714317ugc
        for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 00:25:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=SQIqK8AbSc4DkgLAEKniousr6GDxzDPdldpjVFiWGAs=;
        b=H+jFdklwwkP+vKP2jy0fzmL9UEl+fPB9RHiqgq+bsdZcEipq2fy1udr1sEwqVkrysIGlcCCzaZB7xJKtRWObNGMgbns5UCunlorELl3NkHFYx647YKGXixswDh3h+x2S3rWbR/ysYbvdnTGfjhAZ3f1wLcD428K109+wSAz/NZ4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=QGpR09nNDguZ7WXg/YRweFdI6vkocVWeZDASkFKJfEf/JYXzpUJpE/AFZLYO3Lt4692piQEbeq0XxjogSHdTsH6JE0XRF95MN/6Ik/KV9DENmRh9MKaREITn20iVqo6iZVBglKTTrehef4FHYD2FKHs0Yh+X5LsKWDrvmY7rybA=
Received: by 10.67.115.10 with SMTP id s10mr45169ugm.1196324747087;
        Thu, 29 Nov 2007 00:25:47 -0800 (PST)
Received: from ?10.0.73.122? ( [202.125.143.68])
        by mx.google.com with ESMTPS id 30sm5725624ugf.2007.11.29.00.25.42
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 29 Nov 2007 00:25:46 -0800 (PST)
Message-ID: <474E7774.8070909@gmail.com>
Date: Thu, 29 Nov 2007 13:25:24 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Problem with Add method
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

This code generate error, kindly tell me that what parameters will be 
use when we use constructors.

Document doc = new Document();
      doc.add( Field.Keyword("id", keywords[i]));
      doc.add( Field.UnIndexed("country", unindexed[i]));
      doc.add(Field.UnStored("contents", unstored[i]));
      doc.add( Field.Text("city", text[i]));
      writer.addDocument(doc);


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31261-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 08:43:31 2007
Return-Path: <java-user-return-31261-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 26255 invoked from network); 29 Nov 2007 08:43:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 08:43:30 -0000
Received: (qmail 14005 invoked by uid 500); 29 Nov 2007 08:43:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13980 invoked by uid 500); 29 Nov 2007 08:43:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13969 invoked by uid 99); 29 Nov 2007 08:43:12 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 00:43:12 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 66.249.92.173 as permitted sender)
Received: from [66.249.92.173] (HELO ug-out-1314.google.com) (66.249.92.173)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 08:42:51 +0000
Received: by ug-out-1314.google.com with SMTP id m3so716939ugc
        for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 00:42:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=D9NT5z8RVN3CFec/rugQJJ2l1p5vr8Os+1o/MmhRQF8=;
        b=AnWWnkyzbqs6VQj5MvK4pon6xNDKKJc/gxc2TdChMtzczD4ATPpUNXBE/a9QhfTI8RkulJcmtLIu6NEKRIinq3X1DpFIBsM6K2kA9zzL9Wi/oleqNIL63Jp2RiZfChYLef4hbo1NOJOXO0SS/mhzr3z2G4wMaPZXzFMmhSmv4RQ=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=scWJBTBArjXx33WAaEVjPJZ0gaffwXYd0MzHtEgVvqQkUpFh4wRRR58tiYDCbb8N5BXaQ/JKnsKUfFq6eZe0pRGoB9kbbZQmi5hXCFit1fOU99q7Cx5DsLMAl0kGaKOBsB0Z0O7Ae6f1C/UN7zs8LTum716XwnLafouQsV65FYk=
Received: by 10.67.30.13 with SMTP id h13mr453747ugj.1196325773363;
        Thu, 29 Nov 2007 00:42:53 -0800 (PST)
Received: from ?10.0.73.122? ( [202.125.143.68])
        by mx.google.com with ESMTPS id x33sm3810570ugc.2007.11.29.00.42.48
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Thu, 29 Nov 2007 00:42:51 -0800 (PST)
Message-ID: <474E7B80.5080800@gmail.com>
Date: Thu, 29 Nov 2007 13:42:40 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: Deprecated API
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

i m studying LIA. but there is a problem with code. When i run the code 
i get errorsThe errors are related with the use of deprecated 
APIs.Kindly suggest me the right APIs and also instructions how to 
handle this situation with other code..


package lia.indexing;

import org.apache.lucene.store.Directory;
import org.apache.lucene.store.FSDirectory;
import org.apache.lucene.document.Document;
import org.apache.lucene.document.Field;
import org.apache.lucene.index.IndexWriter;
import org.apache.lucene.index.IndexReader;
import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.analysis.SimpleAnalyzer;

import junit.framework.TestCase;
import java.io.IOException;

/**
 *
 */
public abstract class BaseIndexingTestCase extends TestCase {
  protected String[] keywords = {"1", "2"};
  protected String[] unindexed = {"Netherlands", "Italy"};
  protected String[] unstored = {"Amsterdam has lots of bridges",
                                 "Venice has lots of canals"};
  protected String[] text = {"Amsterdam", "Venice"};
  protected Directory dir;

  protected void setUp() throws IOException {
    String indexDir =
      System.getProperty("java.io.tmpdir", "tmp") +
      System.getProperty("file.separator") + "index-dir";
    dir = FSDirectory.getDirectory(indexDir, true);
    addDocuments(dir);
  }

  protected void addDocuments(Directory dir)
    throws IOException {
    IndexWriter writer = new IndexWriter(dir, getAnalyzer(),
      true);
    writer.setUseCompoundFile(isCompound());
    for (int i = 0; i < keywords.length; i++) {
      Document doc = new Document();
      doc.add(Field.Keyword("id", keywords[i]));
      doc.add(Field.UnIndexed("country", unindexed[i]));
      doc.add(Field.UnStored("contents", unstored[i]));
      doc.add(Field.Text("city", text[i]));
      writer.addDocument(doc);
    }
    writer.optimize();
    writer.close();
  }

  protected Analyzer getAnalyzer() {
    return new SimpleAnalyzer();
  }

  protected boolean isCompound() {
    return true;
  }

  public void testIndexWriter() throws IOException {
    IndexWriter writer = new IndexWriter(dir, getAnalyzer(),
      false);
    assertEquals(keywords.length, writer.docCount());
    writer.close();
  }

  public void testIndexReader() throws IOException {
    IndexReader reader = IndexReader.open(dir);
    assertEquals(keywords.length, reader.maxDoc());
    assertEquals(keywords.length, reader.numDocs());
    reader.close();
  }
}


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31262-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 08:47:43 2007
Return-Path: <java-user-return-31262-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 28284 invoked from network); 29 Nov 2007 08:47:43 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 08:47:43 -0000
Received: (qmail 20762 invoked by uid 500); 29 Nov 2007 08:47:25 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20732 invoked by uid 500); 29 Nov 2007 08:47:25 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20721 invoked by uid 99); 29 Nov 2007 08:47:25 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 00:47:25 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of serera@gmail.com designates 209.85.198.187 as permitted sender)
Received: from [209.85.198.187] (HELO rv-out-0910.google.com) (209.85.198.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 08:47:04 +0000
Received: by rv-out-0910.google.com with SMTP id k20so1357663rvb
        for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 00:47:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=S9ScrCtg+bCBUJF+FPjB3sr8sAa2eR+2MiLhqgQFH3I=;
        b=KSr9F7mGL2HA0+eC1VDnFuKimOpGLpDZDx4AjOBzdU5BysNPpr9VkZeqO1+pvVGvw9k+7GlvarYFhtYKQSTkkjVxnI0HkHVkoHl1aNyIGAAWfJcZEuoQNyP+asPVotSlDV/lamQqTF2WScmD25cDgQnU4DWIpU9zCPlIHeTtfa4=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=QERd41CYsYvePIbwQzJYJQkWPwnXSXcKANdZDr7IjD3WEla9uoil10JS2Cbl9c4MuHZL61ejNpDul3F7pT0W2StLoWfDvoCHp8iANdm8VcaUKm3MLmEPkbvNJj29fd0ZoNaPCI4QYNRdDSXGQjnUetpOP5gtdmuqA5TKnUeub2A=
Received: by 10.141.22.1 with SMTP id z1mr3116270rvi.1196326027001;
        Thu, 29 Nov 2007 00:47:07 -0800 (PST)
Received: by 10.141.70.4 with HTTP; Thu, 29 Nov 2007 00:47:07 -0800 (PST)
Message-ID: <786fde50711290047v27632e12n71e8fd24a08c96d9@mail.gmail.com>
Date: Thu, 29 Nov 2007 10:47:07 +0200
From: "Shai Erera" <serera@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Problem with Add method
In-Reply-To: <474E7774.8070909@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_2144_22463232.1196326027105"
References: <474E7774.8070909@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_2144_22463232.1196326027105
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

Which Lucene version do you use?
If it's 2.2, then Field.Keyword, Field.UnIndexed etc. we removed.
You should instead do:

Document doc = new Document();
     doc.add(new Field("id", keywords[i], Store.NO, Index.UN_TOKENIZED));
     doc.add(new Field("country", unindexed[i], Store.YES,
Index.UN_TOKENIZED));
etc...

On Nov 29, 2007 10:25 AM, Liaqat Ali <liaqatalimian@gmail.com> wrote:

> This code generate error, kindly tell me that what parameters will be
> use when we use constructors.
>
> Document doc = new Document();
>      doc.add( Field.Keyword("id", keywords[i]));
>      doc.add( Field.UnIndexed("country", unindexed[i]));
>      doc.add(Field.UnStored("contents", unstored[i]));
>      doc.add( Field.Text("city", text[i]));
>      writer.addDocument(doc);
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>


-- 
Regards,

Shai Erera

------=_Part_2144_22463232.1196326027105--

From java-user-return-31263-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 09:31:04 2007
Return-Path: <java-user-return-31263-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51918 invoked from network); 29 Nov 2007 09:31:04 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 09:31:04 -0000
Received: (qmail 87590 invoked by uid 500); 29 Nov 2007 09:30:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87548 invoked by uid 500); 29 Nov 2007 09:30:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87537 invoked by uid 99); 29 Nov 2007 09:30:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 01:30:46 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 09:30:27 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 5002F57DBE
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 04:30:28 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Thu, 29 Nov 2007 04:30:28 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 3236BA160; Thu, 29 Nov 2007 04:30:28 -0500 (EST)
Message-Id: <1196328628.19921.1223855201@webmail.messagingengine.com>
X-Sasl-Enc: o79J5X80sJVisuABgcozI1f39oy60Fnm8oE2QVIYwkXX 1196328628
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <847893AE8EE17A48A3725E82C10DE9E5011C2A19@tkdwi001.dev.tradingscreen.com>
Subject: Re: CorruptIndexException
In-Reply-To: <847893AE8EE17A48A3725E82C10DE9E5011C2A19@tkdwi001.dev.tradingscreen.com>
Date: Thu, 29 Nov 2007 04:30:28 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


That exception means your index was written with a newer version of
Lucene than the version you are using to open the IndexReader.

It looks like you used the unreleased (2.3 dev) version of Lucli from
the Lucene trunk and then went back to an older Lucene JAR (maybe 2.2?)
for accessing it?  In general writing an index with a newer version
of Lucene and then trying to access it using an older version of Lucene
doesn't work (whereas the opposite does).

I'm afraid you either have to switch to 2.3-dev for reading your index
(but beware it could have sneaky bugs ...), or, rebuild your index with
the 2.2 version of Lucene and use the 2.2 Lucli in the future.

Mike
=20
"Melanie Langlois" <Melanie.Langlois@tradingscreen.com> wrote:
> Hi,
>=20
>=20=20
>=20
> I use Lucli to optimize my index, when my application was stopped. And
> after restarting my application, I could not serahc my index anymore, I
> got the following exception :
>=20
>=20=20
>=20
> org.apache.lucene.index.CorruptIndexException: Unknown format version: -4
>=20
>         at
>         org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:204)
>=20
>         at
>         org.apache.lucene.index.IndexReader$1.doBody(IndexReader.java:190)
>=20
>         at
>         org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(Segment=
Infos.java:610)
>=20
>         at org.apache.lucene.index.IndexReader.open(IndexReader.java:185)
>=20
>         at org.apache.lucene.index.IndexReader.open(IndexReader.java:167)
>=20
>=20=20
>=20
> I have two questions:
>=20
> -why does it occurs ? Should I use another tool to access the index
> outside of my application ?
>=20
> -do there is way to recover ?
>=20
>=20=20
>=20
>=20=20
>=20
> Thanks,
>=20
>=20=20
>=20
> M=E9lanie
>=20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31264-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 10:11:09 2007
Return-Path: <java-user-return-31264-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64593 invoked from network); 29 Nov 2007 10:11:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 10:11:09 -0000
Received: (qmail 50435 invoked by uid 500); 29 Nov 2007 10:10:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 50407 invoked by uid 500); 29 Nov 2007 10:10:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 50160 invoked by uid 99); 29 Nov 2007 10:10:45 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 02:10:45 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 10:10:24 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id C0F84581D8
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 05:10:25 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Thu, 29 Nov 2007 05:10:25 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id A58FA7505; Thu, 29 Nov 2007 05:10:25 -0500 (EST)
Message-Id: <1196331025.25608.1223860421@webmail.messagingengine.com>
X-Sasl-Enc: nieFoyRg4WKu1eXRnfPEWlp88H8sGSCist2Y7x4C37qL 1196331025
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
   <1196280278.23481.1223752059@webmail.messagingengine.com>
   <07Nov28.130137pst."58696"@synergy1.parc.xerox.com>
   <1196284625.4114.1223763677@webmail.messagingengine.com>
   <07Nov28.210649pst."58696"@synergy1.parc.xerox.com>
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException?
In-Reply-To: <07Nov28.210649pst."58696"@synergy1.parc.xerox.com>
Date: Thu, 29 Nov 2007 05:10:25 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Bill Janssen" <janssen@parc.com> wrote:

> > Hmmm ... how many chunks of "about 50 pages" do you do before
> > hitting this?  Roughly how many docs are in the index when it
> > happens?
>
> Oh, gosh, not sure.  I'm guessing it's about half done.

Ugh, OK.  If we could boil this down to a smaller set that is easily
reproducible (and transferable to me) then I could try to track it
down.

Do you have another PPC machine to reproduce this on?  (To rule out
bad RAM/hard-drive on the first one).

Can you try running with the trunk version of Lucene (2.3-dev) and see
if the error still occurs?  EG you can download this AM's build here:

  http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/288/artifact/artifacts

Another thing to try is turning on the infoStream
(IndexWriter.setInfoStream(...)) and capture & post the resulting log.
It will be very large since it takes quite a while for the error to
occur...

> So, I ran the same codebase with lucene-core-2.2.0.jar on an Intel
> Mac Pro, OS X 10.5.0, Java 1.5, and no exception is raised.
> Different corpus, about 50000 pages instead of 20000.  This is
> reinforcing my thinking that it's a big-endian issue.

That's a good question.

Lucene is endian independent: all writes to files boil eventually down
to a writeByte/writeBytes calls in o.a.l.store.IndexOutput such that
the ordering is controlled by Lucene, not the underlying CPU
architecture.

That said, it is clearly a difference in your test so it seems like a
compelling lead... is it possible to run this different corpus back on
the PPC machine, to rule out a corpus difference leading to the
exception?

> I've got 1735 documents, 18969 pages -- average page size 10.9, max
> page size 1235 (a physics textbook), 578 one-page documents.  These
> are Web pages, PDFs, articles, photos, scanned stuff, technical
> papers, etc.  I index six documents at a time, so I guess I'm
> averaging about 65 pages per chunk.  For each document, I index the
> whole text of the document as a Lucene Document, and I index the
> text of each page separately as a Document.  I use the "contents"
> fields and "pagecontents" fields for those two uses.  I also add
> metadata information to each: "title", multiple "author" fields,
> "date", "abstract", etc.

OK, sounds like a nice rich corpus :) Are you using term vectors,
stored fields, payloads on any of these?

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31265-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 10:33:29 2007
Return-Path: <java-user-return-31265-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 70790 invoked from network); 29 Nov 2007 10:33:28 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 10:33:28 -0000
Received: (qmail 87119 invoked by uid 500); 29 Nov 2007 10:33:07 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 87091 invoked by uid 500); 29 Nov 2007 10:33:07 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 87077 invoked by uid 99); 29 Nov 2007 10:33:07 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 02:33:07 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [212.52.84.46] (HELO smtp-out4.libero.it) (212.52.84.46)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 10:33:10 +0000
Received: from MailRelay10.libero.it (192.168.32.119) by smtp-out4.libero.it (7.3.120)
        id 4688F3500FFC7EFF for java-user@lucene.apache.org; Thu, 29 Nov 2007 11:32:49 +0100
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: AgAAACwkTkeDr0kp/2dsb2JhbAAI
Received: from unknown (HELO libero.it) ([192.168.17.3])
  by outrelay10.libero.it with ESMTP; 29 Nov 2007 11:32:47 +0100
Date: Thu, 29 Nov 2007 11:32:48 +0100
Message-Id: <JS9JYO$7A5C02213D99CC059A92B5A2EA18EA2B@libero.it>
Subject: Error with lucene-core-2.2.0.jar
MIME-Version: 1.0
X-Sensitivity: 3
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: quoted-printable
From: "ing\.sashaa" <ing.sashaa@libero.it>
To: "java-user" <java-user@lucene.apache.org>
X-XaM3-API-Version: 4.3 (R1) (B3pl19)
X-SenderIP: 131.175.73.41
X-Virus-Checked: Checked by ClamAV on apache.org

Hi all,
I'm using a program that use the Lucene Library. I've downloaded lucene-c=
ore-2.2.0.jar file and I'm trying it, but I get this error while trying t=
o index my documents:

Exception in thread "main" java.lang.NoSuchMethodError: 
org.apache.lucene.document.Document.add(Lorg/apache/lucene/document/Field=
;)V

I've searched among old threads and I think that the error is caused by a=
 wrong version of library. So, which one must I use?

Thanks.
Ale


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31266-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 12:23:03 2007
Return-Path: <java-user-return-31266-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25139 invoked from network); 29 Nov 2007 12:23:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 12:23:03 -0000
Received: (qmail 44540 invoked by uid 500); 29 Nov 2007 12:22:45 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44510 invoked by uid 500); 29 Nov 2007 12:22:45 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44498 invoked by uid 99); 29 Nov 2007 12:22:45 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 04:22:45 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a2.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 12:22:45 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a2.g.dreamhost.com (Postfix) with ESMTP id 0E87987FB5
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 04:22:23 -0800 (PST)
Message-Id: <954F7A61-2A92-407A-9A7B-837D1E49EABC@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <474E7B80.5080800@gmail.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Deprecated API
Date: Thu, 29 Nov 2007 07:22:22 -0500
References: <474E7B80.5080800@gmail.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Have a look at the Field.java class and it's constructors.  The other  
option is to look at what was deprecated on Lucene 1.9 and then look  
at Lucene 2.x.

Also, I have some up to date example files of indexing, etc. at http://www.lucenebootcamp.com 
  (follow the link to the SVN repository) which you can check out and  
compare.

Cheers,
Grant

On Nov 29, 2007, at 3:42 AM, Liaqat Ali wrote:

> i m studying LIA. but there is a problem with code. When i run the  
> code i get errorsThe errors are related with the use of deprecated  
> APIs.Kindly suggest me the right APIs and also instructions how to  
> handle this situation with other code..
>
>
> package lia.indexing;
>
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
> import org.apache.lucene.document.Document;
> import org.apache.lucene.document.Field;
> import org.apache.lucene.index.IndexWriter;
> import org.apache.lucene.index.IndexReader;
> import org.apache.lucene.analysis.Analyzer;
> import org.apache.lucene.analysis.SimpleAnalyzer;
>
> import junit.framework.TestCase;
> import java.io.IOException;
>
> /**
> *
> */
> public abstract class BaseIndexingTestCase extends TestCase {
> protected String[] keywords = {"1", "2"};
> protected String[] unindexed = {"Netherlands", "Italy"};
> protected String[] unstored = {"Amsterdam has lots of bridges",
>                                "Venice has lots of canals"};
> protected String[] text = {"Amsterdam", "Venice"};
> protected Directory dir;
>
> protected void setUp() throws IOException {
>   String indexDir =
>     System.getProperty("java.io.tmpdir", "tmp") +
>     System.getProperty("file.separator") + "index-dir";
>   dir = FSDirectory.getDirectory(indexDir, true);
>   addDocuments(dir);
> }
>
> protected void addDocuments(Directory dir)
>   throws IOException {
>   IndexWriter writer = new IndexWriter(dir, getAnalyzer(),
>     true);
>   writer.setUseCompoundFile(isCompound());
>   for (int i = 0; i < keywords.length; i++) {
>     Document doc = new Document();
>     doc.add(Field.Keyword("id", keywords[i]));
>     doc.add(Field.UnIndexed("country", unindexed[i]));
>     doc.add(Field.UnStored("contents", unstored[i]));
>     doc.add(Field.Text("city", text[i]));
>     writer.addDocument(doc);
>   }
>   writer.optimize();
>   writer.close();
> }
>
> protected Analyzer getAnalyzer() {
>   return new SimpleAnalyzer();
> }
>
> protected boolean isCompound() {
>   return true;
> }
>
> public void testIndexWriter() throws IOException {
>   IndexWriter writer = new IndexWriter(dir, getAnalyzer(),
>     false);
>   assertEquals(keywords.length, writer.docCount());
>   writer.close();
> }
>
> public void testIndexReader() throws IOException {
>   IndexReader reader = IndexReader.open(dir);
>   assertEquals(keywords.length, reader.maxDoc());
>   assertEquals(keywords.length, reader.numDocs());
>   reader.close();
> }
> }
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31267-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 14:14:54 2007
Return-Path: <java-user-return-31267-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 93069 invoked from network); 29 Nov 2007 14:14:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 14:14:54 -0000
Received: (qmail 15858 invoked by uid 500); 29 Nov 2007 14:14:35 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 15819 invoked by uid 500); 29 Nov 2007 14:14:35 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 15808 invoked by uid 99); 29 Nov 2007 14:14:35 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 06:14:35 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 14:14:37 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Ixk9h-0007aR-50
	for java-user@lucene.apache.org; Thu, 29 Nov 2007 06:14:17 -0800
Message-ID: <14026451.post@talk.nabble.com>
Date: Thu, 29 Nov 2007 06:14:17 -0800 (PST)
From: Sebastin <sebasmtech@gmail.com>
To: java-user@lucene.apache.org
Subject: how to kill IndexSearcher object after every search
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: sebasmtech@gmail.com
X-Virus-Checked: Checked by ClamAV on apache.org


Hi All,
       Is there any possibility to kill the IndexSearcher Object after every
search.
-- 
View this message in context: http://www.nabble.com/how-to-kill-IndexSearcher-object-after-every-search-tf4897436.html#a14026451
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31268-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 14:21:11 2007
Return-Path: <java-user-return-31268-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97630 invoked from network); 29 Nov 2007 14:21:11 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 14:21:11 -0000
Received: (qmail 27283 invoked by uid 500); 29 Nov 2007 14:20:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26792 invoked by uid 500); 29 Nov 2007 14:20:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26781 invoked by uid 99); 29 Nov 2007 14:20:52 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 06:20:52 -0800
X-ASF-Spam-Status: No, hits=1.4 required=10.0
	tests=SPF_NEUTRAL,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.74] (HELO spunkymail-a14.g.dreamhost.com) (208.97.132.74)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 14:20:52 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a14.g.dreamhost.com (Postfix) with ESMTP id B55A2190E33
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 06:20:29 -0800 (PST)
Message-Id: <B2B2AC4A-0538-4AFC-9A48-3D7EAB3CE4C3@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <13995126.post@talk.nabble.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: Compute the co-occurence beteen a phrase and a word
Date: Thu, 29 Nov 2007 09:20:29 -0500
References: <13990651.post@talk.nabble.com> <996C3783-A0C2-4793-94E3-CAC8666F18A7@apache.org> <13995126.post@talk.nabble.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

You run your SpanQuery, and get back the Spans.  From there, you need  
to load the document (either by reanalyzing the tokens or by using  
Term Vectors) and then you just have to setup your window around the  
position match.  Unfortunately, I don't think there is a better way in  
Lucene to get those terms in a window around a given position.  You  
might be able to if you altered Lucene to support moving both forward  
and backwards over positions, but I am not sure how difficult this is  
to do w/o looking more into it (and it isn't high on my list at the  
moment.)

Also, I adhere to Hoss' philosophy on private email: http://people.apache.org/~hossman/#private_q

-Grant

On Nov 28, 2007, at 10:46 AM, bigdoginuk wrote:

>
> Hi, thanks for the reply.
>
> But can anyone give me some more hints? I have checked SpanQuery,  
> but still
> haven't found out a solution.
>
> Thanks.
>
>
> Grant Ingersoll-6 wrote:
>>
>> Have a look at SpanQuery and it's derivatives.  You will need to do
>> some post-processing as well.
>>
>> -Grant
>>
>> On Nov 28, 2007, at 6:41 AM, bigdoginuk wrote:
>>
>>>
>>> Hi all,
>>> I want to compute the co-occurence frequency between a word and a
>>> phrase(
>>> this phrase contains some words, and the words in it should be
>>> successive
>>> and in order). It's like an NEAR operation (like setting slop at  
>>> 3...)
>>>
>>> Does anyone know how to implement this?
>>>
>>> Thanks in advance.
>>>
>>> Rooney
>>> -- 
>>> View this message in context:
>>> http://www.nabble.com/Compute-the-co-occurence-beteen-a-phrase-and-a-word-tf4887952.html#a13990651
>>> Sent from the Lucene - Java Users mailing list archive at  
>>> Nabble.com.
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>>
>>
>> --------------------------
>> Grant Ingersoll
>> http://lucene.grantingersoll.com
>>
>> Lucene Helpful Hints:
>> http://wiki.apache.org/lucene-java/BasicsOfPerformance
>> http://wiki.apache.org/lucene-java/LuceneFAQ
>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
>>
>
> -- 
> View this message in context: http://www.nabble.com/Compute-the-co-occurence-beteen-a-phrase-and-a-word-tf4887952.html#a13995126
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31269-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 15:15:55 2007
Return-Path: <java-user-return-31269-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32327 invoked from network); 29 Nov 2007 15:15:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 15:15:55 -0000
Received: (qmail 8208 invoked by uid 500); 29 Nov 2007 15:15:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8175 invoked by uid 500); 29 Nov 2007 15:15:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8164 invoked by uid 99); 29 Nov 2007 15:15:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 07:15:36 -0800
X-ASF-Spam-Status: No, hits=4.0 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of dragon-fly999@hotmail.com designates 65.55.175.142 as permitted sender)
Received: from [65.55.175.142] (HELO blu139-omc1-s2.blu139.hotmail.com) (65.55.175.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 15:15:14 +0000
Received: from BLU119-W34 ([65.55.162.183]) by blu139-omc1-s2.blu139.hotmail.com with Microsoft SMTPSVC(6.0.3790.3959);
	 Thu, 29 Nov 2007 07:15:16 -0800
Message-ID: <BLU119-W34438ED0959C475260DDB8B9700@phx.gbl>
Content-Type: multipart/alternative;
	boundary="_32e2d46a-9891-435f-a212-9f6f0c24ae90_"
X-Originating-IP: [71.10.235.86]
From: Dragon Fly <dragon-fly999@hotmail.com>
To: <java-user@lucene.apache.org>
Subject: Closing index searchers ...
Date: Thu, 29 Nov 2007 10:15:16 -0500
Importance: Normal
MIME-Version: 1.0
X-OriginalArrivalTime: 29 Nov 2007 15:15:16.0261 (UTC) FILETIME=[A5796D50:01C8329A]
X-Virus-Checked: Checked by ClamAV on apache.org

--_32e2d46a-9891-435f-a212-9f6f0c24ae90_
Content-Type: text/plain; charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable


Hi,

My application needs to close/open the index searcher periodically so that =
newly added documents are visible.  Is there a way to determine if there ar=
e any pending searches running against an index searcher or do I have to do=
 my own reference counting? Thank you.

_________________________________________________________________
You keep typing, we keep giving. Download Messenger and join the i=92m Init=
iative now.
http://im.live.com/messenger/im/home/?source=3DTAGLM=

--_32e2d46a-9891-435f-a212-9f6f0c24ae90_--

From java-user-return-31270-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 15:41:14 2007
Return-Path: <java-user-return-31270-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 51095 invoked from network); 29 Nov 2007 15:41:14 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 15:41:14 -0000
Received: (qmail 55151 invoked by uid 500); 29 Nov 2007 15:40:55 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55120 invoked by uid 500); 29 Nov 2007 15:40:54 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55109 invoked by uid 99); 29 Nov 2007 15:40:54 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 07:40:54 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of german.kondolf@gmail.com designates 209.85.146.179 as permitted sender)
Received: from [209.85.146.179] (HELO wa-out-1112.google.com) (209.85.146.179)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 15:40:32 +0000
Received: by wa-out-1112.google.com with SMTP id j40so2442031wah
        for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 07:40:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=QY73Axnbhbm834kJ5PUZlpv0TW5f3oeMv+W5OgbWIVs=;
        b=NybygG4HX9Kwcz7PULlovLcmoenr3INFUGw7204H8Z9LGrF1BUrBrsTLl9EEuKczEo/gS68EJ/9NHgwUYM9BBLYlnFURSorL0n1nAg8ntNvFFz7FfnKxg9V5wEY7z/O2SvUmOT81v8xnsnMKTxu1Fem3ECn3+iq2uY4uyqL/hKc=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=YWi0JQtDpvvxrLeDDhpwmY+gJCfCjs51SfMFy42dB31mQ9kqHZ28XBiDbVbrRXX8PhhXycxCspHgtg5VwE8aXco3ke4vnbCqTGyxtJVYCGOh97WxHFCY7Pqu6puVvbKhqYw4ZgVNpkJqyakjKhiNrqsecTlP8rA5yoxKk5dIbwc=
Received: by 10.114.195.19 with SMTP id s19mr41128waf.1196350835457;
        Thu, 29 Nov 2007 07:40:35 -0800 (PST)
Received: by 10.114.124.18 with HTTP; Thu, 29 Nov 2007 07:40:35 -0800 (PST)
Message-ID: <76df56980711290740g5b8cca8bs4b4e8c74c40e7426@mail.gmail.com>
Date: Thu, 29 Nov 2007 12:40:35 -0300
From: "German Kondolf" <german.kondolf@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Closing index searchers ...
In-Reply-To: <BLU119-W34438ED0959C475260DDB8B9700@phx.gbl>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <BLU119-W34438ED0959C475260DDB8B9700@phx.gbl>
X-Virus-Checked: Checked by ClamAV on apache.org

I had the same issue, and end up doing my own reference counting using
"acquire/release" strategy.

I used a single instance per searcher, every "acquire" counts +1 and
every "release" count -1, when a index is switched it receives a
"dispose" signal, then the release checks if there are processing
instances, if all releases were made then the last release closes the
searcher.

The interface looked like this:

public interface Acquirable<R> {

	public R acquire();
	public void release();
	public boolean isAcquired();
	public boolean dispose();

}

In my implementation, I use a threadlocal to attach the searcher's
referenced instance (although it's a single instance per index
switch).

Hope it helps...

German-K

On Nov 29, 2007 12:15 PM, Dragon Fly <dragon-fly999@hotmail.com> wrote:
>
> Hi,
>
> My application needs to close/open the index searcher periodically so that newly added documents are visible.  Is there a way to determine if there are any pending searches running against an index searcher or do I have to do my own reference counting? Thank you.
>
> _________________________________________________________________
> You keep typing, we keep giving. Download Messenger and join the i'm Initiative now.
> http://im.live.com/messenger/im/home/?source=TAGLM

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31271-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 15:44:08 2007
Return-Path: <java-user-return-31271-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 53014 invoked from network); 29 Nov 2007 15:44:08 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 15:44:08 -0000
Received: (qmail 63083 invoked by uid 500); 29 Nov 2007 15:43:49 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 63057 invoked by uid 500); 29 Nov 2007 15:43:49 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 63046 invoked by uid 99); 29 Nov 2007 15:43:49 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 07:43:49 -0800
X-ASF-Spam-Status: No, hits=0.2 required=10.0
	tests=SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of german.kondolf@gmail.com designates 209.85.146.181 as permitted sender)
Received: from [209.85.146.181] (HELO wa-out-1112.google.com) (209.85.146.181)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 15:43:50 +0000
Received: by wa-out-1112.google.com with SMTP id j40so2443312wah
        for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 07:43:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        bh=Fc7WQ8WmBr8IrLWs/+Eeryxce/WHbXKl5KLh/fxJYkw=;
        b=M9FXME3OMNb4VPGlNiF77Sm64v1lYq5wZPVJfQONqNqhW0JMEHL89FxPNB/BIsTE2ESucHZrDx7DQEdbjlTIvaQAO7ZBSzTFWPTpU9p/Fy/ePkRn5LxIK9+09kzTeHlYHBMB2xGVXg9LpADs6sznBHhlaRdd5M/sZZp1JDBOXOw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:content-transfer-encoding:content-disposition:references;
        b=xj6wrheuWduuqa8RUgYcahlOfWIsuN9t5EsXRXxMJVqTWEFWZI8OUZ1zYmXbwGbHdVuAlzO2YpqFxCKuHf1LGneU2Bhq2whTn6ysHLYYddHCY+wwz75tHS1Ts3zsB2atP89Jht+Jlobge2+bpbFFPfxOVpqT5leKhnk4+faIqKE=
Received: by 10.114.127.1 with SMTP id z1mr1892157wac.1196351008911;
        Thu, 29 Nov 2007 07:43:28 -0800 (PST)
Received: by 10.114.124.18 with HTTP; Thu, 29 Nov 2007 07:43:28 -0800 (PST)
Message-ID: <76df56980711290743t5461ee14mce2707b8ccdb72@mail.gmail.com>
Date: Thu, 29 Nov 2007 12:43:28 -0300
From: "German Kondolf" <german.kondolf@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: how to kill IndexSearcher object after every search
In-Reply-To: <14026451.post@talk.nabble.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
References: <14026451.post@talk.nabble.com>
X-Virus-Checked: Checked by ClamAV on apache.org

Yes, you just call "close()" method.

But, why would you like to do that?
The performance tips remarks exactly the opposite, keeping it alive as
long as possible favors internal lucene's caching of terms, query and
other internal objects.

On Nov 29, 2007 11:14 AM, Sebastin <sebasmtech@gmail.com> wrote:
>
> Hi All,
>        Is there any possibility to kill the IndexSearcher Object after every
> search.
> --
> View this message in context: http://www.nabble.com/how-to-kill-IndexSearcher-object-after-every-search-tf4897436.html#a14026451
> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31272-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 15:58:46 2007
Return-Path: <java-user-return-31272-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 64143 invoked from network); 29 Nov 2007 15:58:46 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 15:58:46 -0000
Received: (qmail 89904 invoked by uid 500); 29 Nov 2007 15:58:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 89878 invoked by uid 500); 29 Nov 2007 15:58:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 89867 invoked by uid 99); 29 Nov 2007 15:58:27 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 07:58:27 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 64.233.182.189 as permitted sender)
Received: from [64.233.182.189] (HELO nf-out-0910.google.com) (64.233.182.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 15:58:08 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1622388nfc
        for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 07:58:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=g40Y3f9wQ5TrDQq1yGzJUYKtbhg71NhBGiHwpVytz1M=;
        b=PmubGLilvqKYk+0tTzoy78qsblxfLCUyKwXZkpW9kahIeyqV8Zlp1+1zDlYsWST7dxQ+VHF2xG6/qP8UlEvN8u3uzDXn/Zar2NN3wmS5icXxA/w/bhlZJ8foAVE6MXM1Vsp0vU4loRzfi+QTLdnNl9ZOvYMzgnZhfI1ocpG+xnI=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=EdL8RBbR60BnARDVLjqrFQQ7znqzqKIu9Oxa+u9ATJ12CECp1m7v46FfAMxl2XfqgarvbgZOaPN+pat6bMebzl3MOTlfWyFem1VUrKCgTZfg8GGBsUIakkHvRblDTXIt+9B7smQxvdK0Ebsu3wVvcHTyH7zqTSmINL1wbvWUkKs=
Received: by 10.82.123.16 with SMTP id v16mr5550659buc.1196351888659;
        Thu, 29 Nov 2007 07:58:08 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Thu, 29 Nov 2007 07:58:08 -0800 (PST)
Message-ID: <359a92830711290758lc34a48fke166b3a72919133a@mail.gmail.com>
Date: Thu, 29 Nov 2007 10:58:08 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: Error with lucene-core-2.2.0.jar
In-Reply-To: <JS9JYO$7A5C02213D99CC059A92B5A2EA18EA2B@libero.it>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_9852_31977661.1196351888652"
References: <JS9JYO$7A5C02213D99CC059A92B5A2EA18EA2B@libero.it>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_9852_31977661.1196351888652
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

I'm confused about what's going on here. Could you post the raw java
code that produces this error?

Best
Erick

On Nov 29, 2007 5:32 AM, ing.sashaa <ing.sashaa@libero.it> wrote:

> Hi all,
> I'm using a program that use the Lucene Library. I've downloaded
> lucene-core-2.2.0.jar file and I'm trying it, but I get this error while
> trying to index my documents:
>
> Exception in thread "main" java.lang.NoSuchMethodError:
> org.apache.lucene.document.Document.add
> (Lorg/apache/lucene/document/Field;)V
>
> I've searched among old threads and I think that the error is caused by a
> wrong version of library. So, which one must I use?
>
> Thanks.
> Ale
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_9852_31977661.1196351888652--

From java-user-return-31273-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 16:36:06 2007
Return-Path: <java-user-return-31273-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 90477 invoked from network); 29 Nov 2007 16:36:06 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 16:36:06 -0000
Received: (qmail 61679 invoked by uid 500); 29 Nov 2007 16:35:46 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 61653 invoked by uid 500); 29 Nov 2007 16:35:46 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 61642 invoked by uid 99); 29 Nov 2007 16:35:46 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 08:35:46 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 16:35:25 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <176034(1)>; Thu, 29 Nov 2007 08:34:38 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 08:34:35 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <1196331025.25608.1223860421@webmail.messagingengine.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com>
Comments: In-reply-to "Michael McCandless" <lucene@mikemccandless.com>
    message dated "Thu, 29 Nov 2007 02:10:25 -0800."
Date: Thu, 29 Nov 2007 08:34:30 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.083435pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Do you have another PPC machine to reproduce this on?  (To rule out
> bad RAM/hard-drive on the first one).

I'll dig up an old laptop and try it there.

> Another thing to try is turning on the infoStream
> (IndexWriter.setInfoStream(...)) and capture & post the resulting log.
> It will be very large since it takes quite a while for the error to
> occur...

I can do that.

> Lucene is endian independent: all writes to files boil eventually down
> to a writeByte/writeBytes calls in o.a.l.store.IndexOutput such that
> the ordering is controlled by Lucene, not the underlying CPU
> architecture.

I was actually thinking about the implementation of the bitstrings,
rather than data storage proper.

> Are you using term vectors,
> stored fields, payloads on any of these?

Stored fields.  I store a document ID (a 23-character string) for each.

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31274-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 17:51:55 2007
Return-Path: <java-user-return-31274-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 40806 invoked from network); 29 Nov 2007 17:51:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 17:51:55 -0000
Received: (qmail 4518 invoked by uid 500); 29 Nov 2007 17:51:34 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4475 invoked by uid 500); 29 Nov 2007 17:51:34 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4464 invoked by uid 99); 29 Nov 2007 17:51:34 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 09:51:34 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 17:51:36 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <222267(2)>; Thu, 29 Nov 2007 09:51:07 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 09:51:00 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <07Nov29.083435pst."58696"@synergy1.parc.xerox.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.083435pst."58696"@synergy1.parc.xerox.com>
Comments: In-reply-to Bill Janssen <janssen@parc.com>
    message dated "Thu, 29 Nov 2007 08:34:30 -0800."
Date: Thu, 29 Nov 2007 09:50:54 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.095100pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> > Another thing to try is turning on the infoStream
> > (IndexWriter.setInfoStream(...)) and capture & post the resulting log.
> > It will be very large since it takes quite a while for the error to
> > occur...
> 
> I can do that.

Here's what I see:

Optimizing...
merging segments _ram_a (1 docs) _ram_b (1 docs) _ram_c (1 docs) _ram_d (1 docs) _ram_e (1 docs) _ram_f (1 docs) _ram_g (1 docs) _ram_h (1 docs) _ram_i (1 docs) into _1va (9 docs)
org.apache.lucene.index.IndexFileDeleter@829e6f main: now checkpoint "segments_3ql" [isCommit = true]
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.fnm": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.fdx": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.fdt": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.tii": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.tis": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.frq": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.prx": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.nrm": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main: deleteCommits: now remove commit "segments_3qk"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "segments_3qk": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "segments_3qk"
org.apache.lucene.index.IndexFileDeleter@829e6f main: now checkpoint "segments_3qm" [isCommit = true]
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.cfs": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main: deleteCommits: now remove commit "segments_3ql"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.fnm": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.fnm"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.fdx": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.fdx"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.fdt": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.fdt"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.tii": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.tii"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.tis": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.tis"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.frq": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.frq"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.prx": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.prx"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.nrm": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.nrm"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "segments_3ql": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "segments_3ql"
merging segments _1v4 (19680 docs) _1v5 (10 docs) _1v6 (9 docs) _1v7 (10 docs) _1v8 (9 docs) _1v9 (10 docs) _1va (9 docs)org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.fdt"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.fdt"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.fdx"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.fdx"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.fnm"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.fnm"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.frq"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.frq"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.prx"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.prx"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.tii"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.tii"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.tis"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.tis"
java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 23754
	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
	at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
	at org.apache.lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:98)
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:361)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:325)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:297)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:261)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:98)
	at org.apache.lucene.index.IndexWriter.mergeSegments(IndexWriter.java:1883)
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1231)
	at com.parc.uplib.indexing.LuceneIndexing.update(LuceneIndexing.java:419)
	at com.parc.uplib.indexing.LuceneIndexing.main(LuceneIndexing.java:664)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31275-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 17:56:34 2007
Return-Path: <java-user-return-31275-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 48279 invoked from network); 29 Nov 2007 17:56:33 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 17:56:33 -0000
Received: (qmail 13452 invoked by uid 500); 29 Nov 2007 17:56:13 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 13418 invoked by uid 500); 29 Nov 2007 17:56:13 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 13407 invoked by uid 99); 29 Nov 2007 17:56:13 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 09:56:13 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 17:55:53 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <219030(1)>; Thu, 29 Nov 2007 09:55:47 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 09:55:45 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <07Nov29.083435pst."58696"@synergy1.parc.xerox.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.083435pst."58696"@synergy1.parc.xerox.com>
Comments: In-reply-to Bill Janssen <janssen@parc.com>
    message dated "Thu, 29 Nov 2007 08:34:30 -0800."
Date: Thu, 29 Nov 2007 09:55:43 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.095545pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> > Another thing to try is turning on the infoStream
> > (IndexWriter.setInfoStream(...)) and capture & post the resulting log.
> > It will be very large since it takes quite a while for the error to
> > occur...
> 
> I can do that.

Here's a more complete dump.  I've modified the code so that I now
remove any existing versions of the document before re-indexing it and
its pages.

Bill

/Library/Java/Home/bin/java '-Dcom.parc.uplib.indexing.debugMode=true' '-Dcom.parc.uplib.indexing.indexProperties=contents:title:categories$,*:date@:apparent-mime-type*:authors$\sand\s:comment:abstract:email-message-id*:email-guid*:email-subject:email-from-name:email-from-address*:email-attachment-to*:email-thread-index*:email-references$,*:email-in-reply-to$,*:keywords$,*:album:performer:composer:music-genre*:audio-length:accompaniment:paragraph-ids$,*:sha-hash*' -classpath "/local/uplib/share/UpLib-1.7/code/lucene-core-2.2.0.jar:/local/uplib/share/UpLib-1.7/code/LuceneIndexing.jar" -Dorg.apache.lucene.writeLockTimeout=20000 com.parc.uplib.indexing.LuceneIndexing "/local/janssen-uplib/index" update /local/janssen-uplib/docs 01174-15-2815-270 01174-15-2552-042 01173-98-5675-575 01173-98-4457-188 01173-83-8266-533 01173-80-8759-205
updating
doc_root_dir is /local/janssen-uplib/docs
Working on document /local/janssen-uplib/docs/01174-15-2815-270
  Adding header 'apparent-mime-type' I to 01174-15-2815-270
  Adding header 'authors' IT to 01174-15-2815-270
  Adding header 'categories' I (article) to 01174-15-2815-270
  Adding header 'date' I (20070317) to 01174-15-2815-270
  Adding header 'sha-hash' I to 01174-15-2815-270
  Created empty doc Document<stored/uncompressed,indexed<id:01174-15-2815-270> stored/uncompressed,indexed<uplibdate:20070317> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (3566):  human nature Full-Mental Nudit
    page 1 (3100):  I know what you're thinking: W
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01174-15-2815-270 (3 versions)
Working on document /local/janssen-uplib/docs/01174-15-2552-042
  Adding header 'abstract' IT to 01174-15-2552-042
  Adding header 'apparent-mime-type' I to 01174-15-2552-042
  Adding header 'categories' I (photo) to 01174-15-2552-042
  Adding header 'date' I (20070316) to 01174-15-2552-042
  Adding header 'sha-hash' I to 01174-15-2552-042
  Created empty doc Document<stored/uncompressed,indexed<id:01174-15-2552-042> stored/uncompressed,indexed<uplibdate:20070317> stored/uncompressed,indexed<uplibtype:whole>>
Added 01174-15-2552-042 (1 versions)
Working on document /local/janssen-uplib/docs/01173-98-5675-575
  Adding header 'apparent-mime-type' I to 01173-98-5675-575
  Adding header 'authors' IT to 01173-98-5675-575
  Adding header 'categories' I (article) to 01173-98-5675-575
  Adding header 'categories' I (medical) to 01173-98-5675-575
  Adding header 'date' I (20070313) to 01173-98-5675-575
  Adding header 'sha-hash' I to 01173-98-5675-575
  Created empty doc Document<stored/uncompressed,indexed<id:01173-98-5675-575> stored/uncompressed,indexed<uplibdate:20070315> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (2730):  March 13, 2007 DOW JONES REPRI
    page 1 (4445):  But just how far -- and how fa
    page 2 (2638):  "We don't sell snow tires," sa
    page 3 (981):  A spokeswoman for Rite Aid say
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01173-98-5675-575 (5 versions)
Working on document /local/janssen-uplib/docs/01173-98-4457-188
  Adding header 'apparent-mime-type' I to 01173-98-4457-188
  Adding header 'authors' IT to 01173-98-4457-188
  Adding header 'categories' I (article) to 01173-98-4457-188
  Adding header 'date' I (19911006) to 01173-98-4457-188
  Adding header 'sha-hash' I to 01173-98-4457-188
  Created empty doc Document<stored/uncompressed,indexed<id:01173-98-4457-188> stored/uncompressed,indexed<uplibdate:20070315> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (2897):  The Economics of the Colonial 
merging segments _ram_0 (1 docs) _ram_1 (1 docs) _ram_2 (1 docs) _ram_3 (1 docs) _ram_4 (1 docs) _ram_5 (1 docs) _ram_6 (1 docs) _ram_7 (1 docs) _ram_8 (1 docs) _ram_9 (1 docs) into _1v9 (10 docs)
flush 6 buffered deleted terms on 6 segments.
org.apache.lucene.index.IndexFileDeleter@829e6f main: now checkpoint "segments_3qj" [isCommit = true]
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7_1.del": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8_1.del": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.fnm": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.fdx": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.fdt": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.tii": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.tis": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.frq": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.prx": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.nrm": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main: deleteCommits: now remove commit "segments_3qi"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "segments_3qi": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "segments_3qi"
org.apache.lucene.index.IndexFileDeleter@829e6f main: now checkpoint "segments_3qk" [isCommit = true]
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.cfs": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main: deleteCommits: now remove commit "segments_3qj"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.fnm": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1v9.fnm"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.fdx": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1v9.fdx"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.fdt": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1v9.fdt"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.tii": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1v9.tii"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.tis": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1v9.tis"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.frq": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1v9.frq"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.prx": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1v9.prx"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.nrm": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1v9.nrm"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "segments_3qj": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "segments_3qj"
    page 1 (3372):  Newsweek. I rely on The Econom
    page 2 (3395):  print, I rely on the Wall Str
    page 3 (3032):  British condescension toward t
    page 4 (1100):  The that being so style of d
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01173-98-4457-188 (6 versions)
Working on document /local/janssen-uplib/docs/01173-83-8266-533
  Adding header 'apparent-mime-type' I to 01173-83-8266-533
  Adding header 'categories' I (article) to 01173-83-8266-533
  Adding header 'categories' I (medical) to 01173-83-8266-533
  Adding header 'categories' I (medical/aging) to 01173-83-8266-533
  Adding header 'categories' I (medical) to 01173-83-8266-533
  Adding header 'categories' I (medical/exercise) to 01173-83-8266-533
  Adding header 'categories' I (medical) to 01173-83-8266-533
  Adding header 'date' I (20070313) to 01173-83-8266-533
  Adding header 'sha-hash' I to 01173-83-8266-533
  Adding header 'source' IT to 01173-83-8266-533
  Adding header 'title' IT (Study shows why exercise boosts brainpower) to 01173-83-8266-533
  Created empty doc Document<stored/uncompressed,indexed<id:01173-83-8266-533> stored/uncompressed,indexed<uplibdate:20070313> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (2282):  Powered by SAVE THIS | EMAIL T
    page 1 (1040):  Exercise generated blood flow 
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01173-83-8266-533 (3 versions)
Working on document /local/janssen-uplib/docs/01173-80-8759-205
  Adding header 'apparent-mime-type' I to 01173-80-8759-205
  Adding header 'categories' I (photo) to 01173-80-8759-205
  Adding header 'categories' I (apple) to 01173-80-8759-205
  Adding header 'categories' I (apple) to 01173-80-8759-205
  Adding header 'date' I (20070312) to 01173-80-8759-205
  Adding header 'sha-hash' I to 01173-80-8759-205
  Adding header 'title' IT (Apple Store New York showing iPhone ad on March 12th, 2007) to 01173-80-8759-205
  Created empty doc Document<stored/uncompressed,indexed<id:01173-80-8759-205> stored/uncompressed,indexed<uplibdate:20070313> stored/uncompressed,indexed<uplibtype:whole>>
Added 01173-80-8759-205 (1 versions)
Optimizing...
merging segments _ram_a (1 docs) _ram_b (1 docs) _ram_c (1 docs) _ram_d (1 docs) _ram_e (1 docs) _ram_f (1 docs) _ram_g (1 docs) _ram_h (1 docs) _ram_i (1 docs) into _1va (9 docs)
org.apache.lucene.index.IndexFileDeleter@829e6f main: now checkpoint "segments_3ql" [isCommit = true]
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.fnm": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.fdx": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.fdt": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.tii": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.tis": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.frq": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.prx": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.nrm": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main: deleteCommits: now remove commit "segments_3qk"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "segments_3qk": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "segments_3qk"
org.apache.lucene.index.IndexFileDeleter@829e6f main: now checkpoint "segments_3qm" [isCommit = true]
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v4_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v5_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v6_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v7_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v8_1.del": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1v9.cfs": pre-incr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main:   IncRef "_1va.cfs": pre-incr count is 0
org.apache.lucene.index.IndexFileDeleter@829e6f main: deleteCommits: now remove commit "segments_3ql"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v4_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v5_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v6_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v7_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v8_1.del": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1v9.cfs": pre-decr count is 2
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.fnm": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.fnm"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.fdx": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.fdx"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.fdt": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.fdt"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.tii": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.tii"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.tis": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.tis"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.frq": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.frq"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.prx": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.prx"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "_1va.nrm": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1va.nrm"
org.apache.lucene.index.IndexFileDeleter@829e6f main:   DecRef "segments_3ql": pre-decr count is 1
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "segments_3ql"
merging segments _1v4 (19680 docs) _1v5 (10 docs) _1v6 (9 docs) _1v7 (10 docs) _1v8 (9 docs) _1v9 (10 docs) _1va (9 docs)org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.fdt"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.fdt"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.fdx"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.fdx"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.fnm"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.fnm"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.frq"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.frq"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.prx"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.prx"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.tii"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.tii"
org.apache.lucene.index.IndexFileDeleter@829e6f main: refresh: removing newly created unreferenced file "_1vb.tis"
org.apache.lucene.index.IndexFileDeleter@829e6f main: delete "_1vb.tis"
java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 23754
	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
	at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
	at org.apache.lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:98)
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:361)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:325)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:297)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:261)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:98)
	at org.apache.lucene.index.IndexWriter.mergeSegments(IndexWriter.java:1883)
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1231)
	at com.parc.uplib.indexing.LuceneIndexing.update(LuceneIndexing.java:419)
	at com.parc.uplib.indexing.LuceneIndexing.main(LuceneIndexing.java:664)

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31276-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 18:35:48 2007
Return-Path: <java-user-return-31276-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 88965 invoked from network); 29 Nov 2007 18:35:48 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 18:35:48 -0000
Received: (qmail 86545 invoked by uid 500); 29 Nov 2007 18:35:27 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86511 invoked by uid 500); 29 Nov 2007 18:35:27 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86500 invoked by uid 99); 29 Nov 2007 18:35:27 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 10:35:27 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 18:35:25 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <222848(2)>; Thu, 29 Nov 2007 10:34:58 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 10:34:56 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <1196331025.25608.1223860421@webmail.messagingengine.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com>
Comments: In-reply-to "Michael McCandless" <lucene@mikemccandless.com>
    message dated "Thu, 29 Nov 2007 02:10:25 -0800."
Date: Thu, 29 Nov 2007 10:34:46 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.103456pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Can you try running with the trunk version of Lucene (2.3-dev) and see
> if the error still occurs?  EG you can download this AM's build here:
> 
>   http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/288/artifact/artifacts

Still there.  Here's the dump with last night's build:

/Library/Java/Home/bin/java '-Dcom.parc.uplib.indexing.debugMode=true' '-Dcom.parc.uplib.indexing.indexProperties=contents:title:categories$,*:date@:apparent-mime-type*:authors$\sand\s:comment:abstract:email-message-id*:email-guid*:email-subject:email-from-name:email-from-address*:email-attachment-to*:email-thread-index*:email-references$,*:email-in-reply-to$,*:keywords$,*:album:performer:composer:music-genre*:audio-length:accompaniment:paragraph-ids$,*:sha-hash*' -classpath "/local/uplib/share/UpLib-1.7/code/lucene-core-2.3-2007-11-29_02-49-31.jar:/local/uplib/share/UpLib-1.7/code/LuceneIndexing.jar" -Dorg.apache.lucene.writeLockTimeout=20000 com.parc.uplib.indexing.LuceneIndexing "/local/janssen-uplib/index" update /local/janssen-uplib/docs 01179-00-0750-547 01178-90-9186-558 01178-81-4212-772 01178-81-3305-217 01178-73-1029-141 01178-72-8365-803
updating
doc_root_dir is /local/janssen-uplib/docs
IFD [main]: setInfoStream deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@462851
IW 0 [main]: setInfoStream: dir=org.apache.lucene.store.FSDirectory@/local/janssen-uplib/index autoCommit=true mergePolicy=org.apache.lucene.index.LogByteSizeMergePolicy@c56c60 mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@4e280c ramBufferSizeMB=16.0 maxBuffereDocs=-1 maxBuffereDeleteTerms=-1 maxFieldLength=10000 index=_21:c19686 _22:c92
IW 0 [main]: setMaxFieldLength 2147483647
Working on document /local/janssen-uplib/docs/01179-00-0750-547
  Adding header 'abstract' IT to 01179-00-0750-547
  Adding header 'apparent-mime-type' I to 01179-00-0750-547
  Adding header 'authors' IT to 01179-00-0750-547
  Adding header 'categories' I (ebooks) to 01179-00-0750-547
  Adding header 'categories' I (economics) to 01179-00-0750-547
  Adding header 'categories' I (paper) to 01179-00-0750-547
  Adding header 'citation' I to 01179-00-0750-547
  Adding header 'date' I (20070128) to 01179-00-0750-547
  Adding header 'sha-hash' I to 01179-00-0750-547
  Adding header 'title' IT (Heterogeneity in Price Stickiness and the Real Effects of Monetary Shocks) to 01179-00-0750-547
  Created empty doc Document<stored/uncompressed,indexed<id:01179-00-0750-547> stored/uncompressed,indexed<uplibdate:20070512> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (2181):  Heterogeneity in Price Stickin
    page 1 (2927):  1 Introduction There is ample 
    page 2 (3135):  In the presence of strategic c
    page 3 (3128):  Motivated by those questions, 
    page 4 (3214):  ploring the tractability of th
    page 5 (2491):  model with Taylor staggered wa
    page 6 (1548):  real rigidities (Ball and Rome
    page 7 (3098):  2.2 Calibrating the sectoral d
    page 8 (1913):  distribution of price stickine
    page 9 (1952):  reported in Table 1. Hencefort
    page 10 (1635):  Figure 2 presents analogous re
    page 11 (1743):  In the absence of strategic co
    page 12 (2806):  Corollary 1 For an arbitrary h
    page 13 (2380):  2.4.2 Growth rate shocks In th
    page 14 (2962):  price changes. With heterogene
    page 15 (3265):  ties and heterogeneity in the 
    page 16 (1962):  complementarities. The results
    page 17 (751):  to the response of the heterog
    page 18 (489):  economies are embedded into th
    page 19 (3295):  2.6 Fitting IRFs with an ident
    page 20 (2066):  Table 3a: Best-Fitting Duratio
    page 21 (2444):  This is an important step beca
    page 22 (1976):  where ? is the discount factor
    page 23 (1183):  Et "? Ct+1 Ct ?? It Pt Pt+1 #
    page 24 (2188):  can be rewritten as: Pk,t =  
    page 25 (1370):  pt = Z 1 0 f (k) pk,tdk, (10) 
    page 26 (3269):  Heterogeneity in price stickin
    page 27 (3117):  Irrespective of the net effect
    page 28 (2084):  set of parameters involve high
    page 29 (575):  0 5 10 15 20 25 30 35 40 0 x 1
    page 30 (2185):  output and falling prices in a
    page 31 (2358):  price changes that minimizes t
    page 32 (2689):  These results are fully consis
    page 33 (3600):  different sources of real rigi
    page 34 (3168):  work in a model with heterogen
    page 35 (2557):  single equation estimation of 
    page 36 (1326):  Taking the limit as  ? 0 in e
    page 37 (1796):  The output gap is constant at 
    page 38 (1066):  The corresponding path for the
    page 39 (1347):  4) Proof of Corollaries 1 and 
    page 40 (2421):  Therefore, for ?  0, the expe
    page 41 (1343):  p (t) = Z 1 0 f (k) ? ?? ?? R 
    page 42 (2117):  As ? ? 0, this clearly converg
    page 43 (1375):  model around the zero inflatio
    page 44 (1497):  pt = Z 1 0 f (k) pk,tdk, yt = 
    page 45 (1128):  Table A.3: Best-Fitting Durati
    page 46 (898):  Multiplying by f (k) ?k and in
    page 47 (1072):  Now, from (23): ?kxk,t = pk,t 
    page 48 (268):  Finally, let t ? pt ? pt?1 de
    page 49 (1694):  References [1] Altissimo, F., 
    page 50 (1874):  [14] Bils, M., P. Klenow and O
    page 51 (2091):  [27] Carlton, D. (1986), The 
    page 52 (1846):  [39] Dixon, H. and E. Kara (20
    page 53 (1530):  [51] Ohanian, L., A. Stockman 
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01179-00-0750-547 (55 versions)
Working on document /local/janssen-uplib/docs/01178-90-9186-558
  Adding header 'abstract' IT to 01178-90-9186-558
  Adding header 'apparent-mime-type' I to 01178-90-9186-558
  Adding header 'authors' IT to 01178-90-9186-558
  Adding header 'authors' IT to 01178-90-9186-558
  Adding header 'authors' IT to 01178-90-9186-558
  Adding header 'authors' IT to 01178-90-9186-558
  Adding header 'authors' IT to 01178-90-9186-558
  Adding header 'categories' I (paper) to 01178-90-9186-558
  Adding header 'categories' I (ebooks) to 01178-90-9186-558
  Adding header 'date' I (20050500) to 01178-90-9186-558
  Adding header 'sha-hash' I to 01178-90-9186-558
  Adding header 'title' IT (Visual-Syntactic Text Formatting: A New Method to Enhance Online) to 01178-90-9186-558
  Created empty doc Document<stored/uncompressed,indexed<id:01178-90-9186-558> stored/uncompressed,indexed<uplibdate:20070511> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (3332):  Visual-Syntactic Text Formatti
    page 1 (1461):  into this: To make these chang
    page 2 (4620):  complex than a simple, concate
    page 3 (4723):  Among some poorer readers, met
    page 4 (3827):  method does not extract or dir
    page 5 (3388):  (ACT scores) with gains in com
    page 6 (3693):  digital text actually improve 
    page 7 (3400):  exam were administered. For re
    page 8 (3413):  Intermediate and long-term ret
    page 9 (4219):  Student preference and survey 
    page 10 (4417):  Discussion In print media, sim
    page 11 (4358):  time; however, the opposite tr
    page 12 (3950):  More time spent actually readi
    page 13 (4184):  In education, the VSTF method 
    page 14 (3270):  References Armbruster, B.B. (2
    page 15 (3176):  April 1920). Neuroimaging, la
    page 16 (3350):  Klare, G.R., Nichols, W.H., & 
    page 17 (4098):  and narrative skills connect w
    page 18 (3070):  He has conducted laboratory-ba
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01178-90-9186-558 (20 versions)
Working on document /local/janssen-uplib/docs/01178-81-4212-772
  Adding header 'abstract' IT to 01178-81-4212-772
  Adding header 'apparent-mime-type' I to 01178-81-4212-772
  Adding header 'categories' I (newspaper) to 01178-81-4212-772
  Adding header 'categories' I (article) to 01178-81-4212-772
  Adding header 'categories' I (fun) to 01178-81-4212-772
  Adding header 'categories' I (historical) to 01178-81-4212-772
  Adding header 'date' I (19340429) to 01178-81-4212-772
  Adding header 'sha-hash' I to 01178-81-4212-772
  Adding header 'title' IT (Gigantic Robots, Controlled by Wireless, to Fight Our Battles) to 01178-81-4212-772
  Created empty doc Document<stored/uncompressed,indexed<id:01178-81-4212-772> stored/uncompressed,indexed<uplibdate:20070510> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (261):  iganlic obok ntroIIed b ireles
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01178-81-4212-772 (2 versions)
Working on document /local/janssen-uplib/docs/01178-81-3305-217
  Adding header 'apparent-mime-type' I to 01178-81-3305-217
  Adding header 'authors' IT to 01178-81-3305-217
  Adding header 'categories' I (cartoon) to 01178-81-3305-217
  Adding header 'keywords' I (incentive) to 01178-81-3305-217
  Adding header 'sha-hash' I to 01178-81-3305-217
  Created empty doc Document<stored/uncompressed,indexed<id:01178-81-3305-217> stored/uncompressed,indexed<uplibdate:20070510> stored/uncompressed,indexed<uplibtype:whole>>
Added 01178-81-3305-217 (1 versions)
Working on document /local/janssen-uplib/docs/01178-73-1029-141
  Adding header 'apparent-mime-type' I to 01178-73-1029-141
  Adding header 'authors' IT to 01178-73-1029-141
  Adding header 'categories' I (article) to 01178-73-1029-141
  Adding header 'date' I (20070514) to 01178-73-1029-141
  Adding header 'sha-hash' I to 01178-73-1029-141
  Adding header 'title' IT (Critical Mass:  Everyone listens to Walter Mossberg) to 01178-73-1029-141
  Created empty doc Document<stored/uncompressed,indexed<id:01178-73-1029-141> stored/uncompressed,indexed<uplibdate:20070509> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (328):  Go Back Print this page Skip t
    page 1 (1024):  Mossberg assesses technology p
    page 2 (4281):  that Mossberg has since descri
    page 3 (2610):  Titus said, It will come with
    page 4 (4412):  Wed love that, Mermelstein 
    page 5 (4035):  half years, and then transferr
    page 6 (4952):  partly to the clout of the new
    page 7 (5049):  Mossberg will often be the fir
    page 8 (4330):  Of the blogs that review produ
    page 9 (31):   Del.icio.us  Reddit Object 
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01178-73-1029-141 (11 versions)
Working on document /local/janssen-uplib/docs/01178-72-8365-803
  Adding header 'apparent-mime-type' I to 01178-72-8365-803
  Adding header 'authors' IT to 01178-72-8365-803
  Adding header 'categories' I (ebooks) to 01178-72-8365-803
  Adding header 'categories' I (article) to 01178-72-8365-803
  Adding header 'date' I (20061104) to 01178-72-8365-803
  Adding header 'sha-hash' I to 01178-72-8365-803
  Adding header 'title' IT (Selling Ebooks on the Web via MHTML) to 01178-72-8365-803
  Created empty doc Document<stored/uncompressed,indexed<id:01178-72-8365-803> stored/uncompressed,indexed<uplibdate:20070509> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (3499):  To: ebook-community@yahoogroup
    page 1 (2904):  the IETF world, to be the resp
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01178-72-8365-803 (3 versions)
Optimizing...
IW 0 [main]: optimize: index now _21:c19686 _22:c92
IW 0 [main]:   flush: segment=_23 docStoreSegment=_23 docStoreOffset=0 flushDocs=true flushDeletes=true flushDocStores=true numDocs=92 numBufDelTerms=6
IW 0 [main]:   index before flush _21:c19686 _22:c92

closeDocStore: 2 files to flush to segment _23

flush postings as segment _23 numDocs=92
  oldRAMSize=528092 newFlushedSize=263152 docs/MB=366.59 new/old=49.831%
IW 0 [main]: flush 6 buffered deleted terms on 3 segments.
flushed 92 deleted documents
IW 0 [main]: checkpoint: wrote segments file "segments_48"
IFD [main]: now checkpoint "segments_48" [3 segments ; isCommit = true]
IFD [main]: deleteCommits: now remove commit "segments_47"
IFD [main]: delete "segments_47"
IW 0 [main]: checkpoint: wrote segments file "segments_49"
IFD [main]: now checkpoint "segments_49" [3 segments ; isCommit = true]
IFD [main]: deleteCommits: now remove commit "segments_48"
IFD [main]: delete "_23.fnm"
IFD [main]: delete "_23.frq"
IFD [main]: delete "_23.prx"
IFD [main]: delete "_23.tis"
IFD [main]: delete "_23.tii"
IFD [main]: delete "_23.nrm"
IFD [main]: delete "_23.fdx"
IFD [main]: delete "_23.fdt"
IFD [main]: delete "segments_48"
IW 0 [main]: LMP: findMerges: 3 segments
IW 0 [main]: LMP:   level 6.744677 to 7.494677: 1 segments
IW 0 [main]: LMP:   level -1.0 to 5.513348: 2 segments
IW 0 [main]: CMS: now merge
IW 0 [main]: CMS:   index: _21:c19686 _22:c92 _23:c92
IW 0 [main]: CMS:   no more merges pending; now return
IW 0 [main]: add merge to pendingMerges: _21:c19686 _22:c92 _23:c92 [optimize] [total 1 pending]
IW 0 [main]: CMS: now merge
IW 0 [main]: CMS:   index: _21:c19686 _22:c92 _23:c92
IW 0 [main]: CMS:   consider merge _21:c19686 _22:c92 _23:c92 into _24 [optimize]
IW 0 [main]: CMS:     launch new thread [Thread-0]
IW 0 [Thread-0]: CMS:   merge thread: start
IW 0 [main]: CMS:   no more merges pending; now return
IW 0 [Thread-0]: now merge
  merge=_21:c19686 _22:c92 _23:c92 into _24 [optimize]
  index=_21:c19686 _22:c92 _23:c92
IW 0 [Thread-0]: merging _21:c19686 _22:c92 _23:c92 into _24 [optimize]
IW 0 [Thread-0]: merge: total 19686 docs
IW 0 [Thread-0]: hit exception during merge; now refresh deleter on segment _24
IFD [Thread-0]: refresh [prefix=_24]: removing newly created unreferenced file "_24.fdt"
IFD [Thread-0]: delete "_24.fdt"
IFD [Thread-0]: refresh [prefix=_24]: removing newly created unreferenced file "_24.fdx"
IFD [Thread-0]: delete "_24.fdx"
IFD [Thread-0]: refresh [prefix=_24]: removing newly created unreferenced file "_24.fnm"
IFD [Thread-0]: delete "_24.fnm"
IFD [Thread-0]: refresh [prefix=_24]: removing newly created unreferenced file "_24.frq"
IFD [Thread-0]: delete "_24.frq"
IFD [Thread-0]: refresh [prefix=_24]: removing newly created unreferenced file "_24.prx"
IFD [Thread-0]: delete "_24.prx"
IFD [Thread-0]: refresh [prefix=_24]: removing newly created unreferenced file "_24.tii"
IFD [Thread-0]: delete "_24.tii"
IFD [Thread-0]: refresh [prefix=_24]: removing newly created unreferenced file "_24.tis"
IFD [Thread-0]: delete "_24.tis"
IW 0 [Thread-0]: hit exception during merge
Exception in thread "Thread-0" org.apache.lucene.index.MergePolicy$MergeException: java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 20672
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:274)
Caused by: java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 20672
	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
	at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
	at org.apache.lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:95)
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:467)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:430)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:402)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:366)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:123)
	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3002)
	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:240)
java.io.IOException: background merge hit exception: _21:c19686 _22:c92 _23:c92 into _24 [optimize]
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1705)
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1654)
	at com.parc.uplib.indexing.LuceneIndexing.update(LuceneIndexing.java:419)
	at com.parc.uplib.indexing.LuceneIndexing.main(LuceneIndexing.java:664)
Caused by: java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 20672
	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
	at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
	at org.apache.lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:95)
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:467)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:430)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:402)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:366)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:123)
	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3002)
	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:240)
janssen-home : /u 75 % 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31277-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 18:53:37 2007
Return-Path: <java-user-return-31277-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 97073 invoked from network); 29 Nov 2007 18:53:37 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 18:53:37 -0000
Received: (qmail 22220 invoked by uid 500); 29 Nov 2007 18:53:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22191 invoked by uid 500); 29 Nov 2007 18:53:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22180 invoked by uid 99); 29 Nov 2007 18:53:17 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 10:53:17 -0800
X-ASF-Spam-Status: No, hits=3.0 required=10.0
	tests=MIME_QP_LONG_LINE,SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.5] (HELO spunkymail-a14.g.dreamhost.com) (208.97.132.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 18:52:54 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a14.g.dreamhost.com (Postfix) with ESMTP id ACA36190E36
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 10:52:54 -0800 (PST)
Message-Id: <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <07Nov29.103456pst."58696"@synergy1.parc.xerox.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed; delsp=yes
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
Date: Thu, 29 Nov 2007 13:52:53 -0500
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Are you still getting the original exception too or just the Array out =20=

of bounds one now?  Also, are you doing anything else to the index =20
while this is happening?  The code at the point in the exception below =20=

is trying to properly handle deleted documents.

-Grant

On Nov 29, 2007, at 1:34 PM, Bill Janssen wrote:

>> Can you try running with the trunk version of Lucene (2.3-dev) and =20=

>> see
>> if the error still occurs?  EG you can download this AM's build here:
>>
>>  =
http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/288/artifact=
/artifacts
>
> Still there.  Here's the dump with last night's build:
>
> /Library/Java/Home/bin/java '-=20
> Dcom.parc.uplib.indexing.debugMode=3Dtrue' '-=20
> Dcom.parc.uplib.indexing.indexProperties=3Dcontents:title:categories=20=

> $,*:date@:apparent-mime-type*:authors$\sand\s:comment:abstract:email-=20=

> message-id*:email-guid*:email-subject:email-from-name:email-from-=20
> address*:email-attachment-to*:email-thread-index*:email-references=20
> $,*:email-in-reply-to$,*:keywords$,*:album:performer:composer:music-=20=

> genre*:audio-length:accompaniment:paragraph-ids$,*:sha-hash*' -=20
> classpath "/local/uplib/share/UpLib-1.7/code/lucene-=20
> core-2.3-2007-11-29_02-49-31.jar:/local/uplib/share/UpLib-1.7/code/=20
> LuceneIndexing.jar" -Dorg.apache.lucene.writeLockTimeout=3D20000 =20
> com.parc.uplib.indexing.LuceneIndexing "/local/janssen-uplib/index" =20=

> update /local/janssen-uplib/docs 01179-00-0750-547 01178-90-9186-558 =20=

> 01178-81-4212-772 01178-81-3305-217 01178-73-1029-141 =20
> 01178-72-8365-803
> updating
> doc_root_dir is /local/janssen-uplib/docs
> IFD [main]: setInfoStream =20
> deletionPolicy=20
> =3Dorg.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@462851
> IW 0 [main]: setInfoStream: dir=3Dorg.apache.lucene.store.FSDirectory@/=20=

> local/janssen-uplib/index autoCommit=3Dtrue =20
> mergePolicy=3Dorg.apache.lucene.index.LogByteSizeMergePolicy@c56c60 =20=

> mergeScheduler=20
> =3Dorg.apache.lucene.index.ConcurrentMergeScheduler@4e280c =20
> ramBufferSizeMB=3D16.0 maxBuffereDocs=3D-1 maxBuffereDeleteTerms=3D-1 =20=

> maxFieldLength=3D10000 index=3D_21:c19686 _22:c92
> IW 0 [main]: setMaxFieldLength 2147483647
> Working on document /local/janssen-uplib/docs/01179-00-0750-547
>  Adding header 'abstract' IT to 01179-00-0750-547
>  Adding header 'apparent-mime-type' I to 01179-00-0750-547
>  Adding header 'authors' IT to 01179-00-0750-547
>  Adding header 'categories' I (ebooks) to 01179-00-0750-547
>  Adding header 'categories' I (economics) to 01179-00-0750-547
>  Adding header 'categories' I (paper) to 01179-00-0750-547
>  Adding header 'citation' I to 01179-00-0750-547
>  Adding header 'date' I (20070128) to 01179-00-0750-547
>  Adding header 'sha-hash' I to 01179-00-0750-547
>  Adding header 'title' IT (Heterogeneity in Price Stickiness and the =20=

> Real Effects of Monetary Shocks) to 01179-00-0750-547
>  Created empty doc Document<stored/uncompressed,indexed<id:=20
> 01179-00-0750-547> stored/uncompressed,indexed<uplibdate:20070512> =20
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (2181):  Heterogeneity in Price Stickin
>    page 1 (2927):  1 Introduction There is ample
>    page 2 (3135):  In the presence of strategic c
>    page 3 (3128):  Motivated by those questions,
>    page 4 (3214):  ploring the tractability of th
>    page 5 (2491):  model with Taylor staggered wa
>    page 6 (1548):  real rigidities (Ball and Rome
>    page 7 (3098):  2.2 Calibrating the sectoral d
>    page 8 (1913):  distribution of price stickine
>    page 9 (1952):  reported in Table 1. Hencefort
>    page 10 (1635):  Figure 2 presents analogous re
>    page 11 (1743):  In the absence of strategic co
>    page 12 (2806):  Corollary 1 For an arbitrary h
>    page 13 (2380):  2.4.2 Growth rate shocks In th
>    page 14 (2962):  price changes. With heterogene
>    page 15 (3265):  ties and heterogeneity in the
>    page 16 (1962):  complementarities. The results
>    page 17 (751):  to the response of the heterog
>    page 18 (489):  economies are embedded into th
>    page 19 (3295):  2.6 Fitting IRFs with an ident
>    page 20 (2066):  Table 3a: Best-Fitting Duratio
>    page 21 (2444):  This is an important step beca
>    page 22 (1976):  where ? is the discount factor
>    page 23 (1183):  Et "? Ct+1 Ct =A6?? It Pt Pt+1 #
>    page 24 (2188):  can be rewritten as: Pk,t =3D =A3
>    page 25 (1370):  pt =3D Z 1 0 f (k) pk,tdk, (10)
>    page 26 (3269):  Heterogeneity in price stickin
>    page 27 (3117):  Irrespective of the net effect
>    page 28 (2084):  set of parameters involve high
>    page 29 (575):  0 5 10 15 20 25 30 35 40 0 x 1
>    page 30 (2185):  output and falling prices in a
>    page 31 (2358):  price changes that minimizes t
>    page 32 (2689):  These results are fully consis
>    page 33 (3600):  different sources of real rigi
>    page 34 (3168):  work in a model with heterogen
>    page 35 (2557):  single equation estimation of
>    page 36 (1326):  Taking the limit as =C6 ? 0 in e
>    page 37 (1796):  The output gap is constant at
>    page 38 (1066):  The corresponding path for the
>    page 39 (1347):  4) Proof of Corollaries 1 and
>    page 40 (2421):  Therefore, for ? =C5 0, the expe
>    page 41 (1343):  p (t) =3D Z 1 0 f (k) ? ?? ?? R
>    page 42 (2117):  As ? ? 0, this clearly converg
>    page 43 (1375):  model around the zero inflatio
>    page 44 (1497):  pt =3D Z 1 0 f (k) pk,tdk, yt =3D
>    page 45 (1128):  Table A.3: Best-Fitting Durati
>    page 46 (898):  Multiplying by f (k) ?k and in
>    page 47 (1072):  Now, from (23): ?kxk,t =3D pk,t
>    page 48 (268):  Finally, let =B9t ? pt ? pt?1 de
>    page 49 (1694):  References [1] Altissimo, F.,
>    page 50 (1874):  [14] Bils, M., P. Klenow and O
>    page 51 (2091):  [27] Carlton, D. (1986), =D2The
>    page 52 (1846):  [39] Dixon, H. and E. Kara (20
>    page 53 (1530):  [51] Ohanian, L., A. Stockman
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01179-00-0750-547 (55 versions)
> Working on document /local/janssen-uplib/docs/01178-90-9186-558
>  Adding header 'abstract' IT to 01178-90-9186-558
>  Adding header 'apparent-mime-type' I to 01178-90-9186-558
>  Adding header 'authors' IT to 01178-90-9186-558
>  Adding header 'authors' IT to 01178-90-9186-558
>  Adding header 'authors' IT to 01178-90-9186-558
>  Adding header 'authors' IT to 01178-90-9186-558
>  Adding header 'authors' IT to 01178-90-9186-558
>  Adding header 'categories' I (paper) to 01178-90-9186-558
>  Adding header 'categories' I (ebooks) to 01178-90-9186-558
>  Adding header 'date' I (20050500) to 01178-90-9186-558
>  Adding header 'sha-hash' I to 01178-90-9186-558
>  Adding header 'title' IT (Visual-Syntactic Text Formatting: A New =20
> Method to Enhance Online) to 01178-90-9186-558
>  Created empty doc Document<stored/uncompressed,indexed<id:=20
> 01178-90-9186-558> stored/uncompressed,indexed<uplibdate:20070511> =20
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (3332):  Visual-Syntactic Text Formatti
>    page 1 (1461):  into this: To make these chang
>    page 2 (4620):  complex than a simple, concate
>    page 3 (4723):  Among some poorer readers, met
>    page 4 (3827):  method does not extract or dir
>    page 5 (3388):  (ACT scores) with gains in com
>    page 6 (3693):  digital text actually improve
>    page 7 (3400):  exam were administered. For re
>    page 8 (3413):  Intermediate and long-term ret
>    page 9 (4219):  Student preference and survey
>    page 10 (4417):  Discussion In print media, sim
>    page 11 (4358):  time; however, the opposite tr
>    page 12 (3950):  More time spent actually readi
>    page 13 (4184):  In education, the VSTF method
>    page 14 (3270):  References Armbruster, B.B. (2
>    page 15 (3176):  April 19=D020). Neuroimaging, la
>    page 16 (3350):  Klare, G.R., Nichols, W.H., &
>    page 17 (4098):  and narrative skills connect w
>    page 18 (3070):  He has conducted laboratory-ba
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01178-90-9186-558 (20 versions)
> Working on document /local/janssen-uplib/docs/01178-81-4212-772
>  Adding header 'abstract' IT to 01178-81-4212-772
>  Adding header 'apparent-mime-type' I to 01178-81-4212-772
>  Adding header 'categories' I (newspaper) to 01178-81-4212-772
>  Adding header 'categories' I (article) to 01178-81-4212-772
>  Adding header 'categories' I (fun) to 01178-81-4212-772
>  Adding header 'categories' I (historical) to 01178-81-4212-772
>  Adding header 'date' I (19340429) to 01178-81-4212-772
>  Adding header 'sha-hash' I to 01178-81-4212-772
>  Adding header 'title' IT (Gigantic Robots, Controlled by Wireless, =20=

> to Fight Our Battles) to 01178-81-4212-772
>  Created empty doc Document<stored/uncompressed,indexed<id:=20
> 01178-81-4212-772> stored/uncompressed,indexed<uplibdate:20070510> =20
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (261):  iganlic obok ntroIIed b ireles
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01178-81-4212-772 (2 versions)
> Working on document /local/janssen-uplib/docs/01178-81-3305-217
>  Adding header 'apparent-mime-type' I to 01178-81-3305-217
>  Adding header 'authors' IT to 01178-81-3305-217
>  Adding header 'categories' I (cartoon) to 01178-81-3305-217
>  Adding header 'keywords' I (incentive) to 01178-81-3305-217
>  Adding header 'sha-hash' I to 01178-81-3305-217
>  Created empty doc Document<stored/uncompressed,indexed<id:=20
> 01178-81-3305-217> stored/uncompressed,indexed<uplibdate:20070510> =20
> stored/uncompressed,indexed<uplibtype:whole>>
> Added 01178-81-3305-217 (1 versions)
> Working on document /local/janssen-uplib/docs/01178-73-1029-141
>  Adding header 'apparent-mime-type' I to 01178-73-1029-141
>  Adding header 'authors' IT to 01178-73-1029-141
>  Adding header 'categories' I (article) to 01178-73-1029-141
>  Adding header 'date' I (20070514) to 01178-73-1029-141
>  Adding header 'sha-hash' I to 01178-73-1029-141
>  Adding header 'title' IT (Critical Mass:  Everyone listens to =20
> Walter Mossberg) to 01178-73-1029-141
>  Created empty doc Document<stored/uncompressed,indexed<id:=20
> 01178-73-1029-141> stored/uncompressed,indexed<uplibdate:20070509> =20
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (328):  Go Back Print this page Skip t
>    page 1 (1024):  Mossberg assesses technology p
>    page 2 (4281):  that Mossberg has since descri
>    page 3 (2610):  Titus said, =D2It will come with
>    page 4 (4412):  =D2We=D5d love that,=D3 Mermelstein
>    page 5 (4035):  half years, and then transferr
>    page 6 (4952):  partly to the clout of the new
>    page 7 (5049):  Mossberg will often be the fir
>    page 8 (4330):  Of the blogs that review produ
>    page 9 (31):  =A5 Del.icio.us =A5 Reddit Object
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01178-73-1029-141 (11 versions)
> Working on document /local/janssen-uplib/docs/01178-72-8365-803
>  Adding header 'apparent-mime-type' I to 01178-72-8365-803
>  Adding header 'authors' IT to 01178-72-8365-803
>  Adding header 'categories' I (ebooks) to 01178-72-8365-803
>  Adding header 'categories' I (article) to 01178-72-8365-803
>  Adding header 'date' I (20061104) to 01178-72-8365-803
>  Adding header 'sha-hash' I to 01178-72-8365-803
>  Adding header 'title' IT (Selling Ebooks on the Web via MHTML) to =20
> 01178-72-8365-803
>  Created empty doc Document<stored/uncompressed,indexed<id:=20
> 01178-72-8365-803> stored/uncompressed,indexed<uplibdate:20070509> =20
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (3499):  To: ebook-community@yahoogroup
>    page 1 (2904):  the IETF world, to be the resp
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01178-72-8365-803 (3 versions)
> Optimizing...
> IW 0 [main]: optimize: index now _21:c19686 _22:c92
> IW 0 [main]:   flush: segment=3D_23 docStoreSegment=3D_23 =20
> docStoreOffset=3D0 flushDocs=3Dtrue flushDeletes=3Dtrue =20
> flushDocStores=3Dtrue numDocs=3D92 numBufDelTerms=3D6
> IW 0 [main]:   index before flush _21:c19686 _22:c92
>
> closeDocStore: 2 files to flush to segment _23
>
> flush postings as segment _23 numDocs=3D92
>  oldRAMSize=3D528092 newFlushedSize=3D263152 docs/MB=3D366.59 new/=20
> old=3D49.831%
> IW 0 [main]: flush 6 buffered deleted terms on 3 segments.
> flushed 92 deleted documents
> IW 0 [main]: checkpoint: wrote segments file "segments_48"
> IFD [main]: now checkpoint "segments_48" [3 segments ; isCommit =3D =20=

> true]
> IFD [main]: deleteCommits: now remove commit "segments_47"
> IFD [main]: delete "segments_47"
> IW 0 [main]: checkpoint: wrote segments file "segments_49"
> IFD [main]: now checkpoint "segments_49" [3 segments ; isCommit =3D =20=

> true]
> IFD [main]: deleteCommits: now remove commit "segments_48"
> IFD [main]: delete "_23.fnm"
> IFD [main]: delete "_23.frq"
> IFD [main]: delete "_23.prx"
> IFD [main]: delete "_23.tis"
> IFD [main]: delete "_23.tii"
> IFD [main]: delete "_23.nrm"
> IFD [main]: delete "_23.fdx"
> IFD [main]: delete "_23.fdt"
> IFD [main]: delete "segments_48"
> IW 0 [main]: LMP: findMerges: 3 segments
> IW 0 [main]: LMP:   level 6.744677 to 7.494677: 1 segments
> IW 0 [main]: LMP:   level -1.0 to 5.513348: 2 segments
> IW 0 [main]: CMS: now merge
> IW 0 [main]: CMS:   index: _21:c19686 _22:c92 _23:c92
> IW 0 [main]: CMS:   no more merges pending; now return
> IW 0 [main]: add merge to pendingMerges: _21:c19686 _22:c92 _23:c92 =20=

> [optimize] [total 1 pending]
> IW 0 [main]: CMS: now merge
> IW 0 [main]: CMS:   index: _21:c19686 _22:c92 _23:c92
> IW 0 [main]: CMS:   consider merge _21:c19686 _22:c92 _23:c92 into =20
> _24 [optimize]
> IW 0 [main]: CMS:     launch new thread [Thread-0]
> IW 0 [Thread-0]: CMS:   merge thread: start
> IW 0 [main]: CMS:   no more merges pending; now return
> IW 0 [Thread-0]: now merge
>  merge=3D_21:c19686 _22:c92 _23:c92 into _24 [optimize]
>  index=3D_21:c19686 _22:c92 _23:c92
> IW 0 [Thread-0]: merging _21:c19686 _22:c92 _23:c92 into _24 =20
> [optimize]
> IW 0 [Thread-0]: merge: total 19686 docs
> IW 0 [Thread-0]: hit exception during merge; now refresh deleter on =20=

> segment _24
> IFD [Thread-0]: refresh [prefix=3D_24]: removing newly created =20
> unreferenced file "_24.fdt"
> IFD [Thread-0]: delete "_24.fdt"
> IFD [Thread-0]: refresh [prefix=3D_24]: removing newly created =20
> unreferenced file "_24.fdx"
> IFD [Thread-0]: delete "_24.fdx"
> IFD [Thread-0]: refresh [prefix=3D_24]: removing newly created =20
> unreferenced file "_24.fnm"
> IFD [Thread-0]: delete "_24.fnm"
> IFD [Thread-0]: refresh [prefix=3D_24]: removing newly created =20
> unreferenced file "_24.frq"
> IFD [Thread-0]: delete "_24.frq"
> IFD [Thread-0]: refresh [prefix=3D_24]: removing newly created =20
> unreferenced file "_24.prx"
> IFD [Thread-0]: delete "_24.prx"
> IFD [Thread-0]: refresh [prefix=3D_24]: removing newly created =20
> unreferenced file "_24.tii"
> IFD [Thread-0]: delete "_24.tii"
> IFD [Thread-0]: refresh [prefix=3D_24]: removing newly created =20
> unreferenced file "_24.tis"
> IFD [Thread-0]: delete "_24.tis"
> IW 0 [Thread-0]: hit exception during merge
> Exception in thread "Thread-0" org.apache.lucene.index.MergePolicy=20
> $MergeException: java.lang.ArrayIndexOutOfBoundsException: Array =20
> index out of range: 20672
> 	at org.apache.lucene.index.ConcurrentMergeScheduler=20
> $MergeThread.run(ConcurrentMergeScheduler.java:274)
> Caused by: java.lang.ArrayIndexOutOfBoundsException: Array index out =20=

> of range: 20672
> 	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
> 	at =20
> org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
> 	at =20
> org=20
> .apache=20
> .lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:95)
> 	at =20
> org=20
> .apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:=20=

> 467)
> 	at =20
> org=20
> .apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:=20=

> 430)
> 	at =20
> org=20
> .apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:=20=

> 402)
> 	at =20
> org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:=20=

> 366)
> 	at =
org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:=20
> 123)
> 	at =
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:=20
> 3002)
> 	at =
org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
> 	at org.apache.lucene.index.ConcurrentMergeScheduler=20
> $MergeThread.run(ConcurrentMergeScheduler.java:240)
> java.io.IOException: background merge hit exception: _21:c19686 =20
> _22:c92 _23:c92 into _24 [optimize]
> 	at =
org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:=20
> 1705)
> 	at =
org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:=20
> 1654)
> 	at =20
> com.parc.uplib.indexing.LuceneIndexing.update(LuceneIndexing.java:419)
> 	at =
com.parc.uplib.indexing.LuceneIndexing.main(LuceneIndexing.java:=20
> 664)
> Caused by: java.lang.ArrayIndexOutOfBoundsException: Array index out =20=

> of range: 20672
> 	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
> 	at =20
> org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
> 	at =20
> org=20
> .apache=20
> .lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:95)
> 	at =20
> org=20
> .apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:=20=

> 467)
> 	at =20
> org=20
> .apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:=20=

> 430)
> 	at =20
> org=20
> .apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:=20=

> 402)
> 	at =20
> org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:=20=

> 366)
> 	at =
org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:=20
> 123)
> 	at =
org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:=20
> 3002)
> 	at =
org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
> 	at org.apache.lucene.index.ConcurrentMergeScheduler=20
> $MergeThread.run(ConcurrentMergeScheduler.java:240)
> janssen-home : /u 75 %
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31278-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 19:28:03 2007
Return-Path: <java-user-return-31278-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12890 invoked from network); 29 Nov 2007 19:28:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 19:28:03 -0000
Received: (qmail 86193 invoked by uid 500); 29 Nov 2007 19:27:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 86167 invoked by uid 500); 29 Nov 2007 19:27:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 86156 invoked by uid 99); 29 Nov 2007 19:27:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 11:27:43 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 19:27:46 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <318029(2)>; Thu, 29 Nov 2007 11:27:08 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 11:27:01 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org>
Comments: In-reply-to Grant Ingersoll <gsingers@apache.org>
    message dated "Thu, 29 Nov 2007 10:52:53 -0800."
Date: Thu, 29 Nov 2007 11:26:58 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.112701pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Are you still getting the original exception too or just the Array out =20=
> 
> of bounds one now?  Also, are you doing anything else to the index =20
> while this is happening?  The code at the point in the exception below =20=
> 
> is trying to properly handle deleted documents.

Just the array-out-of-bounds one, now.  The current version of the
code creates a writer, then deletes all old Lucene 'Document'
instances belonging to the specified UpLib doc-id, using that writer,
then re-indexes that UpLib doc-id (which consists of one-to-N Lucene
'Document's).  After doing the six UpLib documents, it calls
optimize().

I'm going back to the old code now.  It uses the 2.0 APIs, so it uses
an IndexReader to delete the existing instances, then closes that
reader (which if I understand it properly should flush the index back
to disk), then creates a new writer to re-index the same documents,
then does the optimize with that writer, which is where the
CorruptIndexException started coming up.  I'm going to run that again
with 2.0, then with last night's build.

I'm not sure if the success with 2.0 meant that a corrupted index
wasn't being detected, or if it wasn't being corrupted in the first
place.

Bill



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31279-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 20:14:32 2007
Return-Path: <java-user-return-31279-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 32232 invoked from network); 29 Nov 2007 20:14:29 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 20:14:29 -0000
Received: (qmail 67126 invoked by uid 500); 29 Nov 2007 20:14:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 66747 invoked by uid 500); 29 Nov 2007 20:14:09 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 66736 invoked by uid 99); 29 Nov 2007 20:14:09 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 12:14:09 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 20:14:12 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id 4F584482DA
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 15:13:51 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Thu, 29 Nov 2007 15:13:51 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 38877AB6B; Thu, 29 Nov 2007 15:13:51 -0500 (EST)
Message-Id: <1196367231.3730.1223964045@webmail.messagingengine.com>
X-Sasl-Enc: Y9TkQJTptrwz2pdJwbiEraSNZY0mTTZSqoW6AZNBe1VP 1196367231
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
   <1196280278.23481.1223752059@webmail.messagingengine.com>
   <07Nov28.130137pst."58696"@synergy1.parc.xerox.com>
   <1196284625.4114.1223763677@webmail.messagingengine.com>
   <07Nov28.210649pst."58696"@synergy1.parc.xerox.com>
   <1196331025.25608.1223860421@webmail.messagingengine.com>
   <07Nov29.103456pst."58696"@synergy1.parc.xerox.com>
   <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org>
   <07Nov29.112701pst."58696"@synergy1.parc.xerox.com>
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException?
In-Reply-To: <07Nov29.112701pst."58696"@synergy1.parc.xerox.com>
Date: Thu, 29 Nov 2007 15:13:51 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Bill Janssen" <janssen@parc.com> wrote:
> Here's the dump with last night's build:

Those logs look healthy up until the exception.

One odd thing is when you instantiate your writer, your index has 2
segments in it.  I expected only 1 since each time you visit your
index you leave it optimized.  (Or, maybe you're not calling
setInfoStream immediately after opening the writer?).

The error still only happens on the one PPC machine, even after
upgrading to trunk?  EG not on an Intel box?

Have you tried another PPC machine?

> I'm going back to the old code now.  It uses the 2.0 APIs, so it
> uses an IndexReader to delete the existing instances, then closes
> that reader (which if I understand it properly should flush the
> index back to disk), then creates a new writer to re-index the same
> documents, then does the optimize with that writer, which is where
> the CorruptIndexException started coming up.  I'm going to run that
> again with 2.0, then with last night's build.

Could you post this part of the code (deleting) too?

> I'm not sure if the success with 2.0 meant that a corrupted index
> wasn't being detected, or if it wasn't being corrupted in the first
> place.

Likely the corruption really isn't happening.  That particular check
for "docs out of order" is present in 2.0 as well.

Is it possible to whittle down your test to a smaller set of documents?
EG if you only re-index one document at a time, does the exception
happen sooner?  Ideally we can reduce this to a test I can reproduce
then I can track it down...

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31280-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 20:54:30 2007
Return-Path: <java-user-return-31280-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 44054 invoked from network); 29 Nov 2007 20:54:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 20:54:30 -0000
Received: (qmail 26773 invoked by uid 500); 29 Nov 2007 20:54:10 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 26740 invoked by uid 500); 29 Nov 2007 20:54:10 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 26729 invoked by uid 99); 29 Nov 2007 20:54:10 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 12:54:10 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.119] (HELO spunkymail-a12.g.dreamhost.com) (208.97.132.119)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 20:53:50 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a12.g.dreamhost.com (Postfix) with ESMTP id 5FF9B7FBB
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 12:53:52 -0800 (PST)
Message-Id: <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <07Nov29.112701pst."58696"@synergy1.parc.xerox.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
Date: Thu, 29 Nov 2007 15:53:50 -0500
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> <07Nov29.112701pst."58696"@synergy1.parc.xerox.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org


On Nov 29, 2007, at 2:26 PM, Bill Janssen wrote:

>> Are you still getting the original exception too or just the Array  
>> out =20=
>>
>> of bounds one now?  Also, are you doing anything else to the index  
>> =20
>> while this is happening?  The code at the point in the exception  
>> below =20=
>>
>> is trying to properly handle deleted documents.
>
> Just the array-out-of-bounds one, now.  The current version of the
> code creates a writer, then deletes all old Lucene 'Document'
> instances belonging to the specified UpLib doc-id, using that writer,
> then re-indexes that UpLib doc-id (which consists of one-to-N Lucene
> 'Document's).  After doing the six UpLib documents, it calls
> optimize().

I'm curious what happens if you call optimize after doing the deletion  
but before the re-indexing.

Also, could you try out the CheckIndex tool in 2.3-dev before and  
after the deletes?

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31281-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 21:34:24 2007
Return-Path: <java-user-return-31281-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 57957 invoked from network); 29 Nov 2007 21:34:24 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 21:34:24 -0000
Received: (qmail 76036 invoked by uid 500); 29 Nov 2007 21:34:04 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 75998 invoked by uid 500); 29 Nov 2007 21:34:04 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 75987 invoked by uid 99); 29 Nov 2007 21:34:04 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 13:34:04 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 21:33:44 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Ixr10-0005kG-Ms
	for java-user@lucene.apache.org; Thu, 29 Nov 2007 13:33:46 -0800
Message-ID: <14035572.post@talk.nabble.com>
Date: Thu, 29 Nov 2007 13:33:46 -0800 (PST)
From: java_user_ <jkraemer@cs.tufts.edu>
To: java-user@lucene.apache.org
Subject: Boost One Term Query
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: jkraemer@cs.tufts.edu
X-Virus-Checked: Checked by ClamAV on apache.org


Boosting a one term query does not have an affect on the score.

For example:
apple

Has the same score as:
apple^3

But repeating the term will up the score
apple apple apple

I expected the score to go up when boosting a one term query.  Is that a
wrong expectation?

Thanks!
-- 
View this message in context: http://www.nabble.com/Boost-One-Term-Query-tf4900128.html#a14035572
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31282-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 21:47:26 2007
Return-Path: <java-user-return-31282-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62966 invoked from network); 29 Nov 2007 21:47:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 21:47:26 -0000
Received: (qmail 1297 invoked by uid 500); 29 Nov 2007 21:47:06 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 1266 invoked by uid 500); 29 Nov 2007 21:47:06 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 1255 invoked by uid 99); 29 Nov 2007 21:47:06 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 13:47:06 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 21:47:07 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <386244(2)>; Thu, 29 Nov 2007 13:46:38 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 13:46:32 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <1196367231.3730.1223964045@webmail.messagingengine.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> <07Nov29.112701pst."58696"@synergy1.parc.xerox.com> <1196367231.3730.1223964045@webmail.messagingengine.com>
Comments: In-reply-to "Michael McCandless" <lucene@mikemccandless.com>
    message dated "Thu, 29 Nov 2007 12:13:51 -0800."
Date: Thu, 29 Nov 2007 13:46:30 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.134632pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Have you tried another PPC machine?

No.  It's in another location, but perhaps I can get it tomorrow.  On
the other hand, the success when using 2.0 makes it likely to me that
the machine isn't the problem.

OK, I've reverted to my original codebase (where I first create a
reader and do the deletions, then create a writer and do the additions
and optimize), and it works fine with lucene-core-2.0.0, but fails
with lucene-core-2.3.-whatever (last night's build).  Here's the dump:

indexing with /Library/Java/Home/bin/java  -Dcom.parc.uplib.indexing.debugMode=true "-Dcom.parc.uplib.indexing.indexProperties=contents:title:categories$,*:date@:apparent-mime-type*:authors$\sand\s:comment:abstract:email-message-id*:email-guid*:email-subject:email-from-name:email-from-address*:email-attachment-to*:email-thread-index*:email-references$,*:email-in-reply-to$,*:keywords$,*:album:performer:composer:music-genre*:audio-length:accompaniment:paragraph-ids$,*:sha-hash*" -classpath "/local/uplib/share/UpLib-1.7/code/lucene-core-2.3-2007-11-29_02-49-31.jar:/local/uplib/share/UpLib-1.7/code/LuceneIndexing.jar" -Dorg.apache.lucene.writeLockTimeout=20000 com.parc.uplib.indexing.LuceneIndexing "/local/janssen-uplib/index" update /local/janssen-uplib/docs 01160-06-3246-773 01159-97-2914-663 01159-89-7507-719 01159-89-5614-073 01159-89-1159-244 01159-89-0665-499
thr001: acquiring lock:  LuceneIndex...
thr001: acquired lock:  LuceneIndex*
thr001: releasing lock:  LuceneIndex*
thr001:   indexing output is <updating
doc_root_dir is /local/janssen-uplib/docs
index file is /local/janssen-uplib/index and it exists.
Deleted 1 existing instances of 01160-06-3246-773
Deleted 1 existing instances of 01159-97-2914-663
Deleted 5 existing instances of 01159-89-7507-719
Deleted 26 existing instances of 01159-89-5614-073
Deleted 5 existing instances of 01159-89-1159-244
Deleted 6 existing instances of 01159-89-0665-499
IFD [main]: setInfoStream deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@9b42e6
IW 0 [main]: setInfoStream: dir=org.apache.lucene.store.FSDirectory@/local/janssen-uplib/index autoCommit=true mergePolicy=org.apache.lucene.index.LogByteSizeMergePolicy@6c79d7 mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@b33d0a ramBufferSizeMB=16.0 maxBuffereDocs=-1 maxBuffereDeleteTerms=-1 maxFieldLength=10000 index=_4j:c19686
IW 0 [main]: setMaxFieldLength 2147483647
Working on document /local/janssen-uplib/docs/01160-06-3246-773
  Adding header 'apparent-mime-type' I to 01160-06-3246-773
  Adding header 'authors' IT to 01160-06-3246-773
  Adding header 'categories' I (cartoon) to 01160-06-3246-773
  Adding header 'date' I (19951005) to 01160-06-3246-773
  Adding header 'sha-hash' I to 01160-06-3246-773
  Created empty doc Document<stored/uncompressed,indexed<id:01160-06-3246-773> stored/uncompressed,indexed<uplibdate:20061005> stored/uncompressed,indexed<uplibtype:whole>>
Added 01160-06-3246-773 (1 versions)
Working on document /local/janssen-uplib/docs/01159-97-2914-663
  Adding header 'apparent-mime-type' I to 01159-97-2914-663
  Adding header 'authors' IT to 01159-97-2914-663
  Adding header 'categories' I (cartoon) to 01159-97-2914-663
  Adding header 'date' I (19951004) to 01159-97-2914-663
  Adding header 'sha-hash' I to 01159-97-2914-663
  Created empty doc Document<stored/uncompressed,indexed<id:01159-97-2914-663> stored/uncompressed,indexed<uplibdate:20061004> stored/uncompressed,indexed<uplibtype:whole>>
Added 01159-97-2914-663 (1 versions)
Working on document /local/janssen-uplib/docs/01159-89-7507-719
  Adding header 'apparent-mime-type' I to 01159-89-7507-719
  Adding header 'sha-hash' I to 01159-89-7507-719
  Adding header 'title' IT (Photoshop Metal Texture) to 01159-89-7507-719
  Created empty doc Document<stored/uncompressed,indexed<id:01159-89-7507-719> stored/uncompressed,indexed<uplibdate:20061003> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (580):  Tutorials\xa5 News\xa5 Exclusives\xa5 S
    page 1 (1680):  On a new layer create a gradie
    page 2 (1118):  Scrapes and scratches are irre
    page 3 (470):  Bevel Settings\xa5 Contour Settin
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01159-89-7507-719 (5 versions)
Working on document /local/janssen-uplib/docs/01159-89-5614-073
  Adding header 'apparent-mime-type' I to 01159-89-5614-073
  Adding header 'sha-hash' I to 01159-89-5614-073
  Adding header 'title' IT (Creating Virtual Mats and Frames with The GIMP) to 01159-89-5614-073
  Created empty doc Document<stored/uncompressed,indexed<id:01159-89-5614-073> stored/uncompressed,indexed<uplibdate:20061003> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (663):  All photographs and articles o
    page 1 (600):  Although real mats and frames 
    page 2 (999):  The Procedure First of all you
    page 3 (615):  Run the Add Mat script (Script
    page 4 (693):  in the GIMP toolbox Pattern: U
    page 5 (703):  3D lighted/shaded appearance. 
    page 6 (719):  Bevel Fill Color, pops up a di
    page 7 (714):  texture afterwards. Default: o
    page 8 (797):  recommended, especially if you
    page 9 (461):  moving outwards, as in adding 
    page 10 (67):  11 Creating Virtual Mats and F
    page 11 (67):  12 Creating Virtual Mats and F
    page 12 (378):  Time to add a frame. Run Scrip
    page 13 (498):  in Frame Fill Color FG color: 
    page 14 (717):  and background colors, not in 
    page 15 (685):  the pattern to for texturing t
    page 16 (721):  added along the inner boundary
    page 17 (1006):  leave a selection in place cov
    page 18 (904):  A drop shadow on the entire fr
    page 19 (629):  threshold sliders to the right
    page 20 (901):  Bump Map" and fill it with whi
    page 21 (786):  image window, do a Select All 
    page 22 (393):  In the Layers dialog, choose t
    page 23 (937):  "Keep Trans." option near the 
    page 24 (239):  Last modified: Mon May 9 23:36
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01159-89-5614-073 (26 versions)
Working on document /local/janssen-uplib/docs/01159-89-1159-244
  Adding header 'apparent-mime-type' I to 01159-89-1159-244
  Adding header 'authors' IT to 01159-89-1159-244
  Adding header 'categories' I (ebooks) to 01159-89-1159-244
  Adding header 'categories' I (article) to 01159-89-1159-244
  Adding header 'date' I (20050100) to 01159-89-1159-244
  Adding header 'sha-hash' I to 01159-89-1159-244
  Adding header 'title' IT (The Future of Books) to 01159-89-1159-244
  Created empty doc Document<stored/uncompressed,indexed<id:01159-89-1159-244> stored/uncompressed,indexed<uplibdate:20061003> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (3649):  Close Window The Future of Boo
    page 1 (4291):  Ken agreed and suggested that 
    page 2 (3934):  Catalog online but instead auc
    page 3 (2331):  At Marsh's workshop we watched
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01159-89-1159-244 (5 versions)
Working on document /local/janssen-uplib/docs/01159-89-0665-499
  Adding header 'apparent-mime-type' I to 01159-89-0665-499
  Adding header 'authors' IT to 01159-89-0665-499
  Adding header 'categories' I (review) to 01159-89-0665-499
  Adding header 'categories' I (article) to 01159-89-0665-499
  Adding header 'categories' I (ebooks) to 01159-89-0665-499
  Adding header 'date' I (20061019) to 01159-89-0665-499
  Adding header 'sha-hash' I to 01159-89-0665-499
  Adding header 'title' IT (Books@Google) to 01159-89-0665-499
  Created empty doc Document<stored/uncompressed,indexed<id:01159-89-0665-499> stored/uncompressed,indexed<uplibdate:20061003> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (1595):  Home \xe1 Your account \xe1 Current 
    page 1 (4636):  sapienscompelled the invention
    page 2 (4341):  to a base population of 40,000
    page 3 (5113):  The privacy policy and the Chi
    page 4 (792):  Notes [1] Wikipedia, unlike Go
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01159-89-0665-499 (6 versions)
Optimizing...
IW 0 [main]: optimize: index now _4j:c19686
IW 0 [main]:   flush: segment=_4k docStoreSegment=_4k docStoreOffset=0 flushDocs=true flushDeletes=false flushDocStores=true numDocs=44 numBufDelTerms=0
IW 0 [main]:   index before flush _4j:c19686

closeDocStore: 2 files to flush to segment _4k

flush postings as segment _4k numDocs=44
  oldRAMSize=141248 newFlushedSize=67003 docs/MB=688.586 new/old=47.436%
IW 0 [main]: checkpoint: wrote segments file "segments_be"
IFD [main]: now checkpoint "segments_be" [2 segments ; isCommit = true]
IFD [main]: deleteCommits: now remove commit "segments_bd"
IFD [main]: delete "segments_bd"
IW 0 [main]: checkpoint: wrote segments file "segments_bf"
IFD [main]: now checkpoint "segments_bf" [2 segments ; isCommit = true]
IFD [main]: deleteCommits: now remove commit "segments_be"
IFD [main]: delete "_4k.fnm"
IFD [main]: delete "_4k.frq"
IFD [main]: delete "_4k.prx"
IFD [main]: delete "_4k.tis"
IFD [main]: delete "_4k.tii"
IFD [main]: delete "_4k.nrm"
IFD [main]: delete "_4k.fdx"
IFD [main]: delete "_4k.fdt"
IFD [main]: delete "segments_be"
IW 0 [main]: LMP: findMerges: 2 segments
IW 0 [main]: LMP:   level 6.744767 to 7.494767: 1 segments
IW 0 [main]: LMP:   level -1.0 to 4.842865: 1 segments
IW 0 [main]: CMS: now merge
IW 0 [main]: CMS:   index: _4j:c19686 _4k:c44
IW 0 [main]: CMS:   no more merges pending; now return
IW 0 [main]: add merge to pendingMerges: _4j:c19686 _4k:c44 [optimize] [total 1 pending]
IW 0 [main]: CMS: now merge
IW 0 [main]: CMS:   index: _4j:c19686 _4k:c44
IW 0 [main]: CMS:   consider merge _4j:c19686 _4k:c44 into _4l [optimize]
IW 0 [main]: CMS:     launch new thread [Thread-0]
IW 0 [main]: CMS:   no more merges pending; now return
IW 0 [Thread-0]: CMS:   merge thread: start
IW 0 [Thread-0]: now merge
  merge=_4j:c19686 _4k:c44 into _4l [optimize]
  index=_4j:c19686 _4k:c44
IW 0 [Thread-0]: merging _4j:c19686 _4k:c44 into _4l [optimize]
IW 0 [Thread-0]: merge: total 19686 docs
IW 0 [Thread-0]: hit exception during merge; now refresh deleter on segment _4l
IFD [Thread-0]: refresh [prefix=_4l]: removing newly created unreferenced file "_4l.fdt"
IFD [Thread-0]: delete "_4l.fdt"
IFD [Thread-0]: refresh [prefix=_4l]: removing newly created unreferenced file "_4l.fdx"
IFD [Thread-0]: delete "_4l.fdx"
IFD [Thread-0]: refresh [prefix=_4l]: removing newly created unreferenced file "_4l.fnm"
IFD [Thread-0]: delete "_4l.fnm"
IFD [Thread-0]: refresh [prefix=_4l]: removing newly created unreferenced file "_4l.frq"
IFD [Thread-0]: delete "_4l.frq"
IFD [Thread-0]: refresh [prefix=_4l]: removing newly created unreferenced file "_4l.prx"
IFD [Thread-0]: delete "_4l.prx"
IFD [Thread-0]: refresh [prefix=_4l]: removing newly created unreferenced file "_4l.tii"
IFD [Thread-0]: delete "_4l.tii"
IFD [Thread-0]: refresh [prefix=_4l]: removing newly created unreferenced file "_4l.tis"
IFD [Thread-0]: delete "_4l.tis"
IW 0 [Thread-0]: hit exception during merge
java.io.IOException: background merge hit exception: _4j:c19686 _4k:c44 into _4l [optimize]
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1705)
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1654)
	at com.parc.uplib.indexing.LuceneIndexing.update(LuceneIndexing.java:414)
	at com.parc.uplib.indexing.LuceneIndexing.main(LuceneIndexing.java:659)
Caused by: java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 21352
	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
	at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
	at org.apache.lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:95)
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:467)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:430)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:402)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:366)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:123)
	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3002)
	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:240)
Exception in thread "Thread-0" org.apache.lucene.index.MergePolicy$MergeException: java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 21352
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:274)
Caused by: java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 21352
	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
	at org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
	at org.apache.lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:95)
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:467)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:430)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:402)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:366)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:123)
	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3002)
	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:240)
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31283-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 21:49:54 2007
Return-Path: <java-user-return-31283-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 63777 invoked from network); 29 Nov 2007 21:49:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 21:49:54 -0000
Received: (qmail 8070 invoked by uid 500); 29 Nov 2007 21:49:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 8035 invoked by uid 500); 29 Nov 2007 21:49:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 8023 invoked by uid 99); 29 Nov 2007 21:49:36 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 13:49:35 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 21:49:14 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <386245(2)>; Thu, 29 Nov 2007 13:49:09 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 13:49:07 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <1196367231.3730.1223964045@webmail.messagingengine.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> <07Nov29.112701pst."58696"@synergy1.parc.xerox.com> <1196367231.3730.1223964045@webmail.messagingengine.com>
Comments: In-reply-to "Michael McCandless" <lucene@mikemccandless.com>
    message dated "Thu, 29 Nov 2007 12:13:51 -0800."
Date: Thu, 29 Nov 2007 13:49:06 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.134907pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Could you post this part of the code (deleting) too?

Here it is:


    private static void remove (File index_file, String[] doc_ids, int start) {

        String number;
        String list;
        Term term;
        TermDocs matches;

        if (debug_mode)
            System.err.println("index file is " + index_file + " and it " + (index_file.exists() ? "exists." : "does not exist."));

        try {

            if (index_file.exists() && (doc_ids.length > start)) {
                IndexReader reader = IndexReader.open(index_file);
                try {
                    for (int i = start;  i < doc_ids.length;  i++) {
                        term = new Term("id", doc_ids[i]);
                        int deleted = reader.deleteDocuments(term);
                        System.out.println("Deleted " + deleted + " existing instances of " + doc_ids[i]);
                    }
                } finally {
                    reader.close();
                }
            }

        } catch (Exception e) {
	    if (debug_mode) {
              e.printStackTrace(System.err);
            } else {
                System.out.println("* LuceneIndexing 'remove' raised " + e.getClass() + " with message " + e.getMessage());
                System.err.println("LuceneIndexing 'remove': caught a " + e.getClass() +
                                   "\n with message: " + e.getMessage());
                System.out.flush();
            }
            System.exit(JAVA_EXCEPTION);
        }
        System.out.flush();
    }

    private static void update (File index_file, File doc_root_dir, String[] ids, int start) {

        ExtractIndexingInfo.DocumentIterator docit;
        String number;

        remove (index_file, ids, start);

        try {

            // Now add the documents to the index
            IndexWriter writer = new IndexWriter(index_file, new StandardAnalyzer(), !index_file.exists());
            if (debug_mode)
                writer.setInfoStream(System.err);
            writer.setMaxFieldLength(Integer.MAX_VALUE);

            try {
                for (int i = start;  i < ids.length;  i ++) {
                    docit = build_document_iterator(doc_root_dir, ids[i]);
                    int count = 0;
                    while (docit.hasNext()) {
                        writer.addDocument((Document)(docit.next()));
                        count += 1;
                    }
                    System.out.println("Added " + docit.id + " (" + count + " versions)");
                    System.out.flush();
                }
            } finally {
                // And close the index
                System.out.println("Optimizing...");
                // See http://www.gossamer-threads.com/lists/lucene/java-dev/47895 about optimize
                // Can fail if low on disk space
                writer.optimize();
                writer.close();
            }

        } catch (Exception e) {
            if (debug_mode) {
                e.printStackTrace(System.err);
            } else {
                System.out.println("* Lucene search engine raised " + e.getClass() + " with message " + e.getMessage());
                System.err.println(" 'update' caught a " + e.getClass() +
                                   "\n with message: " + e.getMessage());
                System.out.flush();
            }
            System.exit(JAVA_EXCEPTION);
        }
        System.out.flush();
    }

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31284-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 21:56:16 2007
Return-Path: <java-user-return-31284-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 65254 invoked from network); 29 Nov 2007 21:56:16 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 21:56:16 -0000
Received: (qmail 22495 invoked by uid 500); 29 Nov 2007 21:55:57 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 22466 invoked by uid 500); 29 Nov 2007 21:55:57 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 22454 invoked by uid 99); 29 Nov 2007 21:55:57 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 13:55:57 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 21:55:59 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <386251(2)>; Thu, 29 Nov 2007 13:55:28 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 13:55:23 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> <07Nov29.112701pst."58696"@synergy1.parc.xerox.com> <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org>
Comments: In-reply-to Grant Ingersoll <gsingers@apache.org>
    message dated "Thu, 29 Nov 2007 12:53:50 -0800."
Date: Thu, 29 Nov 2007 13:55:13 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.135523pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Also, could you try out the CheckIndex tool in 2.3-dev before and  
> after the deletes?

Great idea!  I don't suppose there's a jar file of it?

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31285-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 22:22:14 2007
Return-Path: <java-user-return-31285-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 73450 invoked from network); 29 Nov 2007 22:22:13 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 22:22:13 -0000
Received: (qmail 55316 invoked by uid 500); 29 Nov 2007 22:21:54 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 55281 invoked by uid 500); 29 Nov 2007 22:21:53 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 55270 invoked by uid 99); 29 Nov 2007 22:21:53 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 14:21:53 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 22:21:33 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <143099(2)>; Thu, 29 Nov 2007 14:16:08 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Thu, 29 Nov 2007 14:16:03 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> <07Nov29.112701pst."58696"@synergy1.parc.xerox.com> <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org>
Comments: In-reply-to Grant Ingersoll <gsingers@apache.org>
    message dated "Thu, 29 Nov 2007 12:53:50 -0800."
Date: Thu, 29 Nov 2007 14:15:54 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov29.141603pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

So, it's a little clearer.  I get the Array-out-of-bounds exception if
I'm re-indexing some already indexed documents -- if there are
deletions involved.  I get the CorruptIndexException if I'm indexing
freshly -- no deletions.  Here's an example of that (with the latest
nightly).  I removed the existing index, then reindexed the collection
six UpLib docs at a time, till I hit the corruption.

Bill

/Library/Java/Home/bin/java  -Dcom.parc.uplib.indexing.debugMode=true "-Dcom.parc.uplib.indexing.indexProperties=contents:title:categories$,*:date@:apparent-mime-type*:authors$\sand\s:comment:abstract:email-message-id*:email-guid*:email-subject:email-from-name:email-from-address*:email-attachment-to*:email-thread-index*:email-references$,*:email-in-reply-to$,*:keywords$,*:album:performer:composer:music-genre*:audio-length:accompaniment:paragraph-ids$,*:sha-hash*" -classpath "/local/uplib/share/UpLib-1.7/code/lucene-core-2.3-2007-11-29_02-49-31.jar:/local/uplib/share/UpLib-1.7/code/LuceneIndexing.jar" -Dorg.apache.lucene.writeLockTimeout=20000 com.parc.uplib.indexing.LuceneIndexing "/local/janssen-uplib/index" update /local/janssen-uplib/docs 01113-86-6099-767 01113-86-5485-936 01113-86-0975-795 01113-62-2881-882 01113-44-7730-580 01113-44-7684-477
thr002: acquiring lock:  LuceneIndex...
thr002: acquired lock:  LuceneIndex*
thr002: releasing lock:  LuceneIndex*
thr002:   indexing output is <updating
doc_root_dir is /local/janssen-uplib/docs
index file is /local/janssen-uplib/index and it exists.
Deleted 0 existing instances of 01113-86-6099-767
Deleted 0 existing instances of 01113-86-5485-936
Deleted 0 existing instances of 01113-86-0975-795
Deleted 0 existing instances of 01113-62-2881-882
Deleted 0 existing instances of 01113-44-7730-580
Deleted 0 existing instances of 01113-44-7684-477
IFD [main]: setInfoStream deletionPolicy=org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@4865ce
IW 0 [main]: setInfoStream: dir=org.apache.lucene.store.FSDirectory@/local/janssen-uplib/index autoCommit=true mergePolicy=org.apache.lucene.index.LogByteSizeMergePolicy@4ae2c1 mergeScheduler=org.apache.lucene.index.ConcurrentMergeScheduler@6d2702 ramBufferSizeMB=16.0 maxBuffereDocs=-1 maxBuffereDeleteTerms=-1 maxFieldLength=10000 index=_94:c8686
IW 0 [main]: setMaxFieldLength 2147483647
Working on document /local/janssen-uplib/docs/01113-86-6099-767
  Adding header 'abstract' IT to 01113-86-6099-767
  Adding header 'apparent-mime-type' I to 01113-86-6099-767
  Adding header 'authors' IT to 01113-86-6099-767
  Adding header 'categories' I (flowport) to 01113-86-6099-767
  Adding header 'categories' I (article) to 01113-86-6099-767
  Adding header 'categories' I (flowport) to 01113-86-6099-767
  Adding header 'categories' I (flowport) to 01113-86-6099-767
  Adding header 'citation' I to 01113-86-6099-767
  Adding header 'date' I (20030800) to 01113-86-6099-767
  Adding header 'sha-hash' I to 01113-86-6099-767
  Adding header 'title' IT (The Great Chive Division) to 01113-86-6099-767
  Created empty doc Document<stored/uncompressed,indexed<id:01113-86-6099-767> stored/uncompressed,indexed<uplibdate:20050418> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (4219):  Question: My chives have grown
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01113-86-6099-767 (2 versions)
Working on document /local/janssen-uplib/docs/01113-86-5485-936
  Adding header 'abstract' IT to 01113-86-5485-936
  Adding header 'apparent-mime-type' I to 01113-86-5485-936
  Adding header 'authors' IT to 01113-86-5485-936
  Adding header 'categories' I (paper) to 01113-86-5485-936
  Adding header 'categories' I (sensepad) to 01113-86-5485-936
  Adding header 'citation' I to 01113-86-5485-936
  Adding header 'date' I (20040524) to 01113-86-5485-936
  Adding header 'sha-hash' I to 01113-86-5485-936
  Adding header 'title' IT (Designing Interaction, not Interfaces) to 01113-86-5485-936
  Created empty doc Document<stored/uncompressed,indexed<id:01113-86-5485-936> stored/uncompressed,indexed<uplibdate:20050418> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (3855):  Designing Interaction, not Int
    page 1 (5688):  Figure 1. Interaction as a phe
    page 2 (5831):  Interaction models can be eval
    page 3 (5770):  Reification turns concepts and
    page 4 (5558):  Figure 6. A mock-up of the DPI
    page 5 (5963):  In joint work with Yves Guiard
    page 6 (6819):  I propose making interactions 
    page 7 (5622):  Graphical Application. Proc. A
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01113-86-5485-936 (9 versions)
Working on document /local/janssen-uplib/docs/01113-86-0975-795
  Adding header 'apparent-mime-type' I to 01113-86-0975-795
  Adding header 'categories' I (article) to 01113-86-0975-795
  Adding header 'date' I (20050414) to 01113-86-0975-795
  Adding header 'sha-hash' I to 01113-86-0975-795
  Adding header 'source' IT to 01113-86-0975-795
  Created empty doc Document<stored/uncompressed,indexed<id:01113-86-0975-795> stored/uncompressed,indexed<uplibdate:20050418> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (1851):  About sponsorship Simplifying 
    page 1 (2900):  Latvia and Lithuania, Estonia'
    page 2 (3088):  How much fairness is gained fo
    page 3 (5317):  At the time of its reform, Est
    page 4 (1101):  In part, the tax system is bur
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01113-86-0975-795 (6 versions)
Working on document /local/janssen-uplib/docs/01113-62-2881-882
  Adding header 'apparent-mime-type' I to 01113-62-2881-882
  Adding header 'categories' I (article) to 01113-62-2881-882
  Adding header 'date' I (20050328) to 01113-62-2881-882
  Adding header 'keywords' I (neuroeconomics) to 01113-62-2881-882
  Adding header 'sha-hash' I to 01113-62-2881-882
  Adding header 'title' IT (Neuroeconomics:  Why Logic Often Takes a Backseat) to 01113-62-2881-882
  Created empty doc Document<stored/uncompressed,indexed<id:01113-62-2881-882> stored/uncompressed,indexed<uplibdate:20050415> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (2957):  Close Window MARCH 28, 2005 EC
    page 1 (3856):  these attacks on rationality ?
    page 2 (484):  Even believers in neuroeconomi
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01113-62-2881-882 (4 versions)
Working on document /local/janssen-uplib/docs/01113-44-7730-580
  Adding header 'apparent-mime-type' I to 01113-44-7730-580
  Adding header 'categories' I (flowport) to 01113-44-7730-580
  Adding header 'categories' I (receipt) to 01113-44-7730-580
  Adding header 'categories' I (flowport) to 01113-44-7730-580
  Adding header 'categories' I (flowport) to 01113-44-7730-580
  Adding header 'comment' IT to 01113-44-7730-580
  Adding header 'sha-hash' I to 01113-44-7730-580
  Adding header 'title' IT (fax receipt for JCDL 2005 demo submission document) to 01113-44-7730-580
  Created empty doc Document<stored/uncompressed,indexed<id:01113-44-7730-580> stored/uncompressed,indexed<uplibdate:20050413> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (3383):  Transmission fleport Dare T lo
    page 1 (2697):  ACM Permission and Release For
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01113-44-7730-580 (3 versions)
Working on document /local/janssen-uplib/docs/01113-44-7684-477
  Adding header 'apparent-mime-type' I to 01113-44-7684-477
  Adding header 'authors' IT to 01113-44-7684-477
  Adding header 'categories' I (flowport) to 01113-44-7684-477
  Adding header 'categories' I (article) to 01113-44-7684-477
  Adding header 'categories' I (ebook) to 01113-44-7684-477
  Adding header 'categories' I (flowport) to 01113-44-7684-477
  Adding header 'categories' I (flowport) to 01113-44-7684-477
  Adding header 'citation' I to 01113-44-7684-477
  Adding header 'date' I (20050117) to 01113-44-7684-477
  Adding header 'sha-hash' I to 01113-44-7684-477
  Adding header 'title' IT (Signs of Life for E-books in 2004) to 01113-44-7684-477
  Created empty doc Document<stored/uncompressed,indexed<id:01113-44-7684-477> stored/uncompressed,indexed<uplibdate:20050413> stored/uncompressed,indexed<uplibtype:whole>>
  Using charset utf8 for contents.txt
  Using language en for contents.txt
    page 0 (6514):  Signs ofLife for E-books in 20
  Using charset utf8 for contents.txt
  Using language en for contents.txt
Added 01113-44-7684-477 (2 versions)
Optimizing...
IW 0 [main]: optimize: index now _94:c8686
IW 0 [main]:   flush: segment=_95 docStoreSegment=_95 docStoreOffset=0 flushDocs=true flushDeletes=false flushDocStores=true numDocs=26 numBufDelTerms=0
IW 0 [main]:   index before flush _94:c8686

closeDocStore: 2 files to flush to segment _95

flush postings as segment _95 numDocs=26
  oldRAMSize=269104 newFlushedSize=114988 docs/MB=237.094 new/old=42.73%
IW 0 [main]: checkpoint: wrote segments file "segments_ic"
IFD [main]: now checkpoint "segments_ic" [2 segments ; isCommit = true]
IFD [main]: deleteCommits: now remove commit "segments_ib"
IFD [main]: delete "segments_ib"
IW 0 [main]: checkpoint: wrote segments file "segments_id"
IFD [main]: now checkpoint "segments_id" [2 segments ; isCommit = true]
IFD [main]: deleteCommits: now remove commit "segments_ic"
IFD [main]: delete "_95.fnm"
IFD [main]: delete "_95.frq"
IFD [main]: delete "_95.prx"
IFD [main]: delete "_95.tis"
IFD [main]: delete "_95.tii"
IFD [main]: delete "_95.nrm"
IFD [main]: delete "_95.fdx"
IFD [main]: delete "_95.fdt"
IFD [main]: delete "segments_ic"
IW 0 [main]: LMP: findMerges: 2 segments
IW 0 [main]: LMP:   level 6.4501038 to 7.2001038: 1 segments
IW 0 [main]: LMP:   level -1.0 to 5.070234: 1 segments
IW 0 [main]: CMS: now merge
IW 0 [main]: CMS:   index: _94:c8686 _95:c26
IW 0 [main]: CMS:   no more merges pending; now return
IW 0 [main]: add merge to pendingMerges: _94:c8686 _95:c26 [optimize] [total 1 pending]
IW 0 [main]: CMS: now merge
IW 0 [main]: CMS:   index: _94:c8686 _95:c26
IW 0 [main]: CMS:   consider merge _94:c8686 _95:c26 into _96 [optimize]
IW 0 [main]: CMS:     launch new thread [Thread-0]
IW 0 [Thread-0]: CMS:   merge thread: start
IW 0 [main]: CMS:   no more merges pending; now return
IW 0 [Thread-0]: now merge
  merge=_94:c8686 _95:c26 into _96 [optimize]
  index=_94:c8686 _95:c26
IW 0 [Thread-0]: merging _94:c8686 _95:c26 into _96 [optimize]
IW 0 [Thread-0]: merge: total 8712 docs
IW 0 [Thread-0]: hit exception during merge; now refresh deleter on segment _96
IFD [Thread-0]: refresh [prefix=_96]: removing newly created unreferenced file "_96.fdt"
IFD [Thread-0]: delete "_96.fdt"
IFD [Thread-0]: refresh [prefix=_96]: removing newly created unreferenced file "_96.fdx"
IFD [Thread-0]: delete "_96.fdx"
IFD [Thread-0]: refresh [prefix=_96]: removing newly created unreferenced file "_96.fnm"
IFD [Thread-0]: delete "_96.fnm"
IFD [Thread-0]: refresh [prefix=_96]: removing newly created unreferenced file "_96.frq"
IFD [Thread-0]: delete "_96.frq"
IFD [Thread-0]: refresh [prefix=_96]: removing newly created unreferenced file "_96.prx"
IFD [Thread-0]: delete "_96.prx"
IFD [Thread-0]: refresh [prefix=_96]: removing newly created unreferenced file "_96.tii"
IFD [Thread-0]: delete "_96.tii"
IFD [Thread-0]: refresh [prefix=_96]: removing newly created unreferenced file "_96.tis"
IFD [Thread-0]: delete "_96.tis"
IW 0 [Thread-0]: hit exception during merge
java.io.IOException: background merge hit exception: _94:c8686 _95:c26 into _96 [optimize]
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1705)
	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java:1654)
	at com.parc.uplib.indexing.LuceneIndexing.update(LuceneIndexing.java:414)
	at com.parc.uplib.indexing.LuceneIndexing.main(LuceneIndexing.java:659)
Caused by: org.apache.lucene.index.CorruptIndexException: docs out of order (8692 <= 10221 )
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:474)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:430)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:402)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:366)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:123)
	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3002)
	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:240)
Exception in thread "Thread-0" org.apache.lucene.index.MergePolicy$MergeException: org.apache.lucene.index.CorruptIndexException: docs out of order (8692 <= 10221 )
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:274)
Caused by: org.apache.lucene.index.CorruptIndexException: docs out of order (8692 <= 10221 )
	at org.apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java:474)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java:430)
	at org.apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java:402)
	at org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java:366)
	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:123)
	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java:3002)
	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
	at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:240)
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31286-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 22:22:45 2007
Return-Path: <java-user-return-31286-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 74861 invoked from network); 29 Nov 2007 22:22:45 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 22:22:45 -0000
Received: (qmail 58107 invoked by uid 500); 29 Nov 2007 22:22:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 58077 invoked by uid 500); 29 Nov 2007 22:22:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 58066 invoked by uid 99); 29 Nov 2007 22:22:26 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 14:22:26 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 22:22:07 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id D66B5583EB
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 17:22:09 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Thu, 29 Nov 2007 17:22:09 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id B886AAE87; Thu, 29 Nov 2007 17:22:09 -0500 (EST)
Message-Id: <1196374929.29613.1223986545@webmail.messagingengine.com>
X-Sasl-Enc: lWA2t7zFml7KSKs+9LfRUtT5Y96ieJ+hRyBF7C5gP1Sw 1196374929
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
   <1196280278.23481.1223752059@webmail.messagingengine.com>
   <07Nov28.130137pst."58696"@synergy1.parc.xerox.com>
   <1196284625.4114.1223763677@webmail.messagingengine.com>
   <07Nov28.210649pst."58696"@synergy1.parc.xerox.com>
   <1196331025.25608.1223860421@webmail.messagingengine.com>
   <07Nov29.103456pst."58696"@synergy1.parc.xerox.com>
   <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org>
   <07Nov29.112701pst."58696"@synergy1.parc.xerox.com>
   <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org>
   <07Nov29.135523pst."58696"@synergy1.parc.xerox.com>
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException?
In-Reply-To: <07Nov29.135523pst."58696"@synergy1.parc.xerox.com>
Date: Thu, 29 Nov 2007 17:22:09 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


This is in the nightly JAR.  It's o.a.l.index.CheckIndex (it defines
a static main).

Mike

"Bill Janssen" <janssen@parc.com> wrote:
> > Also, could you try out the CheckIndex tool in 2.3-dev before and  
> > after the deletes?
> 
> Great idea!  I don't suppose there's a jar file of it?
> 
> Bill
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31287-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 22:30:40 2007
Return-Path: <java-user-return-31287-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 78282 invoked from network); 29 Nov 2007 22:30:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 22:30:40 -0000
Received: (qmail 64736 invoked by uid 500); 29 Nov 2007 22:30:20 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 64702 invoked by uid 500); 29 Nov 2007 22:30:20 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 64691 invoked by uid 99); 29 Nov 2007 22:30:20 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 14:30:20 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a20.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 22:30:20 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a20.g.dreamhost.com (Postfix) with ESMTP id 2C024E24DA
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 14:29:57 -0800 (PST)
Message-Id: <D35EC442-B979-41E3-9712-A61463E58795@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <07Nov29.134632pst."58696"@synergy1.parc.xerox.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
Date: Thu, 29 Nov 2007 17:29:55 -0500
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> <07Nov29.112701pst."58696"@synergy1.parc.xerox.com> <1196367231.3730.1223964045@webmail.messagingengine.com> <07Nov29.134632pst."58696"@synergy1.parc.xerox.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Just a theory (make that a guess), Mike, but is it possible that the  
one merge scheduler is hitting a synchronization issue with the  
deletedDocuments bit vector?  That is one thread is cleaning it up and  
the other is accessing and they aren't synchronizing their access?

This doesn't explain the original problem, but maybe this one?

On Nov 29, 2007, at 4:46 PM, Bill Janssen wrote:

>> Have you tried another PPC machine?
>
> No.  It's in another location, but perhaps I can get it tomorrow.  On
> the other hand, the success when using 2.0 makes it likely to me that
> the machine isn't the problem.
>
> OK, I've reverted to my original codebase (where I first create a
> reader and do the deletions, then create a writer and do the additions
> and optimize), and it works fine with lucene-core-2.0.0, but fails
> with lucene-core-2.3.-whatever (last night's build).  Here's the dump:
>
> indexing with /Library/Java/Home/bin/java  - 
> Dcom.parc.uplib.indexing.debugMode=true "- 
> Dcom.parc.uplib.indexing.indexProperties=contents:title:categories 
> $,*:date@:apparent-mime-type*:authors$\sand\s:comment:abstract:email- 
> message-id*:email-guid*:email-subject:email-from-name:email-from- 
> address*:email-attachment-to*:email-thread-index*:email-references 
> $,*:email-in-reply-to$,*:keywords$,*:album:performer:composer:music- 
> genre*:audio-length:accompaniment:paragraph-ids$,*:sha-hash*" - 
> classpath "/local/uplib/share/UpLib-1.7/code/lucene- 
> core-2.3-2007-11-29_02-49-31.jar:/local/uplib/share/UpLib-1.7/code/ 
> LuceneIndexing.jar" -Dorg.apache.lucene.writeLockTimeout=20000  
> com.parc.uplib.indexing.LuceneIndexing "/local/janssen-uplib/index"  
> update /local/janssen-uplib/docs 01160-06-3246-773 01159-97-2914-663  
> 01159-89-7507-719 01159-89-5614-073 01159-89-1159-244  
> 01159-89-0665-499
> thr001: acquiring lock:  LuceneIndex...
> thr001: acquired lock:  LuceneIndex*
> thr001: releasing lock:  LuceneIndex*
> thr001:   indexing output is <updating
> doc_root_dir is /local/janssen-uplib/docs
> index file is /local/janssen-uplib/index and it exists.
> Deleted 1 existing instances of 01160-06-3246-773
> Deleted 1 existing instances of 01159-97-2914-663
> Deleted 5 existing instances of 01159-89-7507-719
> Deleted 26 existing instances of 01159-89-5614-073
> Deleted 5 existing instances of 01159-89-1159-244
> Deleted 6 existing instances of 01159-89-0665-499
> IFD [main]: setInfoStream  
> deletionPolicy 
> =org.apache.lucene.index.KeepOnlyLastCommitDeletionPolicy@9b42e6
> IW 0 [main]: setInfoStream: dir=org.apache.lucene.store.FSDirectory@/ 
> local/janssen-uplib/index autoCommit=true  
> mergePolicy=org.apache.lucene.index.LogByteSizeMergePolicy@6c79d7  
> mergeScheduler 
> =org.apache.lucene.index.ConcurrentMergeScheduler@b33d0a  
> ramBufferSizeMB=16.0 maxBuffereDocs=-1 maxBuffereDeleteTerms=-1  
> maxFieldLength=10000 index=_4j:c19686
> IW 0 [main]: setMaxFieldLength 2147483647
> Working on document /local/janssen-uplib/docs/01160-06-3246-773
>  Adding header 'apparent-mime-type' I to 01160-06-3246-773
>  Adding header 'authors' IT to 01160-06-3246-773
>  Adding header 'categories' I (cartoon) to 01160-06-3246-773
>  Adding header 'date' I (19951005) to 01160-06-3246-773
>  Adding header 'sha-hash' I to 01160-06-3246-773
>  Created empty doc Document<stored/uncompressed,indexed<id: 
> 01160-06-3246-773> stored/uncompressed,indexed<uplibdate:20061005>  
> stored/uncompressed,indexed<uplibtype:whole>>
> Added 01160-06-3246-773 (1 versions)
> Working on document /local/janssen-uplib/docs/01159-97-2914-663
>  Adding header 'apparent-mime-type' I to 01159-97-2914-663
>  Adding header 'authors' IT to 01159-97-2914-663
>  Adding header 'categories' I (cartoon) to 01159-97-2914-663
>  Adding header 'date' I (19951004) to 01159-97-2914-663
>  Adding header 'sha-hash' I to 01159-97-2914-663
>  Created empty doc Document<stored/uncompressed,indexed<id: 
> 01159-97-2914-663> stored/uncompressed,indexed<uplibdate:20061004>  
> stored/uncompressed,indexed<uplibtype:whole>>
> Added 01159-97-2914-663 (1 versions)
> Working on document /local/janssen-uplib/docs/01159-89-7507-719
>  Adding header 'apparent-mime-type' I to 01159-89-7507-719
>  Adding header 'sha-hash' I to 01159-89-7507-719
>  Adding header 'title' IT (Photoshop Metal Texture) to  
> 01159-89-7507-719
>  Created empty doc Document<stored/uncompressed,indexed<id: 
> 01159-89-7507-719> stored/uncompressed,indexed<uplibdate:20061003>  
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (580):  Tutorials\xa5 News\xa5 Exclusives\xa5 S
>    page 1 (1680):  On a new layer create a gradie
>    page 2 (1118):  Scrapes and scratches are irre
>    page 3 (470):  Bevel Settings\xa5 Contour Settin
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01159-89-7507-719 (5 versions)
> Working on document /local/janssen-uplib/docs/01159-89-5614-073
>  Adding header 'apparent-mime-type' I to 01159-89-5614-073
>  Adding header 'sha-hash' I to 01159-89-5614-073
>  Adding header 'title' IT (Creating Virtual Mats and Frames with The  
> GIMP) to 01159-89-5614-073
>  Created empty doc Document<stored/uncompressed,indexed<id: 
> 01159-89-5614-073> stored/uncompressed,indexed<uplibdate:20061003>  
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (663):  All photographs and articles o
>    page 1 (600):  Although real mats and frames
>    page 2 (999):  The Procedure First of all you
>    page 3 (615):  Run the Add Mat script (Script
>    page 4 (693):  in the GIMP toolbox Pattern: U
>    page 5 (703):  3D lighted/shaded appearance.
>    page 6 (719):  Bevel Fill Color, pops up a di
>    page 7 (714):  texture afterwards. Default: o
>    page 8 (797):  recommended, especially if you
>    page 9 (461):  moving outwards, as in adding
>    page 10 (67):  11 Creating Virtual Mats and F
>    page 11 (67):  12 Creating Virtual Mats and F
>    page 12 (378):  Time to add a frame. Run Scrip
>    page 13 (498):  in Frame Fill Color FG color:
>    page 14 (717):  and background colors, not in
>    page 15 (685):  the pattern to for texturing t
>    page 16 (721):  added along the inner boundary
>    page 17 (1006):  leave a selection in place cov
>    page 18 (904):  A drop shadow on the entire fr
>    page 19 (629):  threshold sliders to the right
>    page 20 (901):  Bump Map" and fill it with whi
>    page 21 (786):  image window, do a Select All
>    page 22 (393):  In the Layers dialog, choose t
>    page 23 (937):  "Keep Trans." option near the
>    page 24 (239):  Last modified: Mon May 9 23:36
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01159-89-5614-073 (26 versions)
> Working on document /local/janssen-uplib/docs/01159-89-1159-244
>  Adding header 'apparent-mime-type' I to 01159-89-1159-244
>  Adding header 'authors' IT to 01159-89-1159-244
>  Adding header 'categories' I (ebooks) to 01159-89-1159-244
>  Adding header 'categories' I (article) to 01159-89-1159-244
>  Adding header 'date' I (20050100) to 01159-89-1159-244
>  Adding header 'sha-hash' I to 01159-89-1159-244
>  Adding header 'title' IT (The Future of Books) to 01159-89-1159-244
>  Created empty doc Document<stored/uncompressed,indexed<id: 
> 01159-89-1159-244> stored/uncompressed,indexed<uplibdate:20061003>  
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (3649):  Close Window The Future of Boo
>    page 1 (4291):  Ken agreed and suggested that
>    page 2 (3934):  Catalog online but instead auc
>    page 3 (2331):  At Marsh's workshop we watched
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01159-89-1159-244 (5 versions)
> Working on document /local/janssen-uplib/docs/01159-89-0665-499
>  Adding header 'apparent-mime-type' I to 01159-89-0665-499
>  Adding header 'authors' IT to 01159-89-0665-499
>  Adding header 'categories' I (review) to 01159-89-0665-499
>  Adding header 'categories' I (article) to 01159-89-0665-499
>  Adding header 'categories' I (ebooks) to 01159-89-0665-499
>  Adding header 'date' I (20061019) to 01159-89-0665-499
>  Adding header 'sha-hash' I to 01159-89-0665-499
>  Adding header 'title' IT (Books@Google) to 01159-89-0665-499
>  Created empty doc Document<stored/uncompressed,indexed<id: 
> 01159-89-0665-499> stored/uncompressed,indexed<uplibdate:20061003>  
> stored/uncompressed,indexed<uplibtype:whole>>
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
>    page 0 (1595):  Home \xe1 Your account \xe1 Current
>    page 1 (4636):  sapienscompelled the invention
>    page 2 (4341):  to a base population of 40,000
>    page 3 (5113):  The privacy policy and the Chi
>    page 4 (792):  Notes [1] Wikipedia, unlike Go
>  Using charset utf8 for contents.txt
>  Using language en for contents.txt
> Added 01159-89-0665-499 (6 versions)
> Optimizing...
> IW 0 [main]: optimize: index now _4j:c19686
> IW 0 [main]:   flush: segment=_4k docStoreSegment=_4k  
> docStoreOffset=0 flushDocs=true flushDeletes=false  
> flushDocStores=true numDocs=44 numBufDelTerms=0
> IW 0 [main]:   index before flush _4j:c19686
>
> closeDocStore: 2 files to flush to segment _4k
>
> flush postings as segment _4k numDocs=44
>  oldRAMSize=141248 newFlushedSize=67003 docs/MB=688.586 new/ 
> old=47.436%
> IW 0 [main]: checkpoint: wrote segments file "segments_be"
> IFD [main]: now checkpoint "segments_be" [2 segments ; isCommit =  
> true]
> IFD [main]: deleteCommits: now remove commit "segments_bd"
> IFD [main]: delete "segments_bd"
> IW 0 [main]: checkpoint: wrote segments file "segments_bf"
> IFD [main]: now checkpoint "segments_bf" [2 segments ; isCommit =  
> true]
> IFD [main]: deleteCommits: now remove commit "segments_be"
> IFD [main]: delete "_4k.fnm"
> IFD [main]: delete "_4k.frq"
> IFD [main]: delete "_4k.prx"
> IFD [main]: delete "_4k.tis"
> IFD [main]: delete "_4k.tii"
> IFD [main]: delete "_4k.nrm"
> IFD [main]: delete "_4k.fdx"
> IFD [main]: delete "_4k.fdt"
> IFD [main]: delete "segments_be"
> IW 0 [main]: LMP: findMerges: 2 segments
> IW 0 [main]: LMP:   level 6.744767 to 7.494767: 1 segments
> IW 0 [main]: LMP:   level -1.0 to 4.842865: 1 segments
> IW 0 [main]: CMS: now merge
> IW 0 [main]: CMS:   index: _4j:c19686 _4k:c44
> IW 0 [main]: CMS:   no more merges pending; now return
> IW 0 [main]: add merge to pendingMerges: _4j:c19686 _4k:c44  
> [optimize] [total 1 pending]
> IW 0 [main]: CMS: now merge
> IW 0 [main]: CMS:   index: _4j:c19686 _4k:c44
> IW 0 [main]: CMS:   consider merge _4j:c19686 _4k:c44 into _4l  
> [optimize]
> IW 0 [main]: CMS:     launch new thread [Thread-0]
> IW 0 [main]: CMS:   no more merges pending; now return
> IW 0 [Thread-0]: CMS:   merge thread: start
> IW 0 [Thread-0]: now merge
>  merge=_4j:c19686 _4k:c44 into _4l [optimize]
>  index=_4j:c19686 _4k:c44
> IW 0 [Thread-0]: merging _4j:c19686 _4k:c44 into _4l [optimize]
> IW 0 [Thread-0]: merge: total 19686 docs
> IW 0 [Thread-0]: hit exception during merge; now refresh deleter on  
> segment _4l
> IFD [Thread-0]: refresh [prefix=_4l]: removing newly created  
> unreferenced file "_4l.fdt"
> IFD [Thread-0]: delete "_4l.fdt"
> IFD [Thread-0]: refresh [prefix=_4l]: removing newly created  
> unreferenced file "_4l.fdx"
> IFD [Thread-0]: delete "_4l.fdx"
> IFD [Thread-0]: refresh [prefix=_4l]: removing newly created  
> unreferenced file "_4l.fnm"
> IFD [Thread-0]: delete "_4l.fnm"
> IFD [Thread-0]: refresh [prefix=_4l]: removing newly created  
> unreferenced file "_4l.frq"
> IFD [Thread-0]: delete "_4l.frq"
> IFD [Thread-0]: refresh [prefix=_4l]: removing newly created  
> unreferenced file "_4l.prx"
> IFD [Thread-0]: delete "_4l.prx"
> IFD [Thread-0]: refresh [prefix=_4l]: removing newly created  
> unreferenced file "_4l.tii"
> IFD [Thread-0]: delete "_4l.tii"
> IFD [Thread-0]: refresh [prefix=_4l]: removing newly created  
> unreferenced file "_4l.tis"
> IFD [Thread-0]: delete "_4l.tis"
> IW 0 [Thread-0]: hit exception during merge
> java.io.IOException: background merge hit exception: _4j:c19686  
> _4k:c44 into _4l [optimize]
> 	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java: 
> 1705)
> 	at org.apache.lucene.index.IndexWriter.optimize(IndexWriter.java: 
> 1654)
> 	at  
> com.parc.uplib.indexing.LuceneIndexing.update(LuceneIndexing.java:414)
> 	at com.parc.uplib.indexing.LuceneIndexing.main(LuceneIndexing.java: 
> 659)
> Caused by: java.lang.ArrayIndexOutOfBoundsException: Array index out  
> of range: 21352
> 	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
> 	at  
> org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
> 	at  
> org 
> .apache 
> .lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:95)
> 	at  
> org 
> .apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java: 
> 467)
> 	at  
> org 
> .apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java: 
> 430)
> 	at  
> org 
> .apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java: 
> 402)
> 	at  
> org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java: 
> 366)
> 	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java: 
> 123)
> 	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java: 
> 3002)
> 	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
> 	at org.apache.lucene.index.ConcurrentMergeScheduler 
> $MergeThread.run(ConcurrentMergeScheduler.java:240)
> Exception in thread "Thread-0" org.apache.lucene.index.MergePolicy 
> $MergeException: java.lang.ArrayIndexOutOfBoundsException: Array  
> index out of range: 21352
> 	at org.apache.lucene.index.ConcurrentMergeScheduler 
> $MergeThread.run(ConcurrentMergeScheduler.java:274)
> Caused by: java.lang.ArrayIndexOutOfBoundsException: Array index out  
> of range: 21352
> 	at org.apache.lucene.util.BitVector.get(BitVector.java:72)
> 	at  
> org.apache.lucene.index.SegmentTermDocs.next(SegmentTermDocs.java:118)
> 	at  
> org 
> .apache 
> .lucene.index.SegmentTermPositions.next(SegmentTermPositions.java:95)
> 	at  
> org 
> .apache.lucene.index.SegmentMerger.appendPostings(SegmentMerger.java: 
> 467)
> 	at  
> org 
> .apache.lucene.index.SegmentMerger.mergeTermInfo(SegmentMerger.java: 
> 430)
> 	at  
> org 
> .apache.lucene.index.SegmentMerger.mergeTermInfos(SegmentMerger.java: 
> 402)
> 	at  
> org.apache.lucene.index.SegmentMerger.mergeTerms(SegmentMerger.java: 
> 366)
> 	at org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java: 
> 123)
> 	at org.apache.lucene.index.IndexWriter.mergeMiddle(IndexWriter.java: 
> 3002)
> 	at org.apache.lucene.index.IndexWriter.merge(IndexWriter.java:2751)
> 	at org.apache.lucene.index.ConcurrentMergeScheduler 
> $MergeThread.run(ConcurrentMergeScheduler.java:240)
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31288-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 22:37:40 2007
Return-Path: <java-user-return-31288-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 82592 invoked from network); 29 Nov 2007 22:37:40 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 22:37:40 -0000
Received: (qmail 75081 invoked by uid 500); 29 Nov 2007 22:37:22 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74854 invoked by uid 500); 29 Nov 2007 22:37:21 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74843 invoked by uid 99); 29 Nov 2007 22:37:21 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 14:37:21 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 22:37:25 +0000
Received: from compute2.internal (compute2.internal [10.202.2.42])
	by out1.messagingengine.com (Postfix) with ESMTP id 9850258439
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 17:37:03 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute2.internal (MEProxy); Thu, 29 Nov 2007 17:37:03 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 77252C861; Thu, 29 Nov 2007 17:37:03 -0500 (EST)
Message-Id: <1196375823.32362.1223988889@webmail.messagingengine.com>
X-Sasl-Enc: jcyysSqGx6vYBqcnAJGBFpKE1uKWudi2KEUHNBiUuFIW 1196375823
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
   <1196280278.23481.1223752059@webmail.messagingengine.com>
   <07Nov28.130137pst."58696"@synergy1.parc.xerox.com>
   <1196284625.4114.1223763677@webmail.messagingengine.com>
   <07Nov28.210649pst."58696"@synergy1.parc.xerox.com>
   <1196331025.25608.1223860421@webmail.messagingengine.com>
   <07Nov29.103456pst."58696"@synergy1.parc.xerox.com>
   <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org>
   <07Nov29.112701pst."58696"@synergy1.parc.xerox.com>
   <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org>
   <07Nov29.141603pst."58696"@synergy1.parc.xerox.com>
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException?
In-Reply-To: <07Nov29.141603pst."58696"@synergy1.parc.xerox.com>
Date: Thu, 29 Nov 2007 17:37:03 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Bill Janssen" <janssen@parc.com> wrote:
> No.  It's in another location, but perhaps I can get it tomorrow.
> On the other hand, the success when using 2.0 makes it likely to me
> that the machine isn't the problem.

Yeah good point.  Seems like a long shot (wishful thinking on my
part!).

Your errors seem to happen around the same area (~20K docs).  If you
skip the first say ~18K docs does the error still happen?  We need to
somehow narrow this down.

Or is there any way I could get a temporary account to log into this
box and try to track this down?  (If indeed it doesn't happen on an
x86 box -- I unfortunately don't have access to a PPC machine).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31289-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 22:44:03 2007
Return-Path: <java-user-return-31289-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 85648 invoked from network); 29 Nov 2007 22:44:03 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 22:44:03 -0000
Received: (qmail 82446 invoked by uid 500); 29 Nov 2007 22:43:43 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 82414 invoked by uid 500); 29 Nov 2007 22:43:43 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 82402 invoked by uid 99); 29 Nov 2007 22:43:43 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 14:43:43 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [66.111.4.25] (HELO out1.smtp.messagingengine.com) (66.111.4.25)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 22:43:46 +0000
Received: from compute1.internal (compute1.internal [10.202.2.41])
	by out1.messagingengine.com (Postfix) with ESMTP id BB80D566AE
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 17:43:24 -0500 (EST)
Received: from web8.messagingengine.com ([10.202.2.217])
  by compute1.internal (MEProxy); Thu, 29 Nov 2007 17:43:24 -0500
Received: by web8.messagingengine.com (Postfix, from userid 99)
	id 9F080E4BA; Thu, 29 Nov 2007 17:43:24 -0500 (EST)
Message-Id: <1196376204.923.1223989107@webmail.messagingengine.com>
X-Sasl-Enc: DojQNDS/mccInUItxF89PIAeM1DLw4lNUFXRH6kYWjjJ 1196376204
From: "Michael McCandless" <lucene@mikemccandless.com>
To: java-user@lucene.apache.org
Content-Disposition: inline
Content-Transfer-Encoding: 7bit
Content-Type: text/plain; charset="ISO-8859-1"
MIME-Version: 1.0
X-Mailer: MessagingEngine.com Webmail Interface
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.102301pst."58696"@synergy1.parc.xerox.com>
   <07Nov28.112847pst."58696"@synergy1.parc.xerox.com>
   <1196280278.23481.1223752059@webmail.messagingengine.com>
   <07Nov28.130137pst."58696"@synergy1.parc.xerox.com>
   <1196284625.4114.1223763677@webmail.messagingengine.com>
   <07Nov28.210649pst."58696"@synergy1.parc.xerox.com>
   <1196331025.25608.1223860421@webmail.messagingengine.com>
   <07Nov29.103456pst."58696"@synergy1.parc.xerox.com>
   <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org>
   <07Nov29.112701pst."58696"@synergy1.parc.xerox.com>
   <1196367231.3730.1223964045@webmail.messagingengine.com>
   <07Nov29.134632pst."58696"@synergy1.parc.xerox.com>
   <D35EC442-B979-41E3-9712-A61463E58795@apache.org>
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException?
In-Reply-To: <D35EC442-B979-41E3-9712-A61463E58795@apache.org>
Date: Thu, 29 Nov 2007 17:43:24 -0500
X-Virus-Checked: Checked by ClamAV on apache.org


"Grant Ingersoll" <gsingers@apache.org> wrote:
> Just a theory (make that a guess), Mike, but is it possible that the  
> one merge scheduler is hitting a synchronization issue with the  
> deletedDocuments bit vector?  That is one thread is cleaning it up and  
> the other is accessing and they aren't synchronizing their access?

Well, in trunk I think we are hitting the bit vector in synchronized
contexts, correctly.  (I sure think/hope so :).  Also, in the context
of merging, the deleted docs bit vector is read only.

This sure does spookily sound like LUCENE-140!!  I hope that one is not
coming back from the dead!

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31290-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Thu Nov 29 23:26:38 2007
Return-Path: <java-user-return-31290-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 12166 invoked from network); 29 Nov 2007 23:26:38 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 29 Nov 2007 23:26:38 -0000
Received: (qmail 52906 invoked by uid 500); 29 Nov 2007 23:26:19 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 52878 invoked by uid 500); 29 Nov 2007 23:26:19 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 52866 invoked by uid 99); 29 Nov 2007 23:26:19 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 15:26:19 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.66] (HELO spunkymail-a11.g.dreamhost.com) (208.97.132.66)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 23:26:20 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a11.g.dreamhost.com (Postfix) with ESMTP id 144AAB7A97
	for <java-user@lucene.apache.org>; Thu, 29 Nov 2007 15:25:59 -0800 (PST)
Message-Id: <1C6FD45F-7AAF-40DA-AC58-9BCB5956E881@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <1196375823.32362.1223988889@webmail.messagingengine.com>
Content-Type: text/plain; charset=US-ASCII; format=flowed
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException?
Date: Thu, 29 Nov 2007 18:25:56 -0500
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> <07Nov29.112701pst."58696"@synergy1.parc.xerox.com> <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org> <07Nov29.141603pst."58696"@synergy1.parc.xerox.com> <1196375823.32362.1223988889@webmail.messagingengine.com>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

I have PPC and Intel access if that helps.  Just need a test case.

On Nov 29, 2007, at 5:37 PM, Michael McCandless wrote:

>
> "Bill Janssen" <janssen@parc.com> wrote:
>> No.  It's in another location, but perhaps I can get it tomorrow.
>> On the other hand, the success when using 2.0 makes it likely to me
>> that the machine isn't the problem.
>
> Yeah good point.  Seems like a long shot (wishful thinking on my
> part!).
>
> Your errors seem to happen around the same area (~20K docs).  If you
> skip the first say ~18K docs does the error still happen?  We need to
> somehow narrow this down.
>
> Or is there any way I could get a temporary account to log into this
> box and try to track this down?  (If indeed it doesn't happen on an
> x86 box -- I unfortunately don't have access to a PPC machine).
>
> Mike
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31291-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 00:53:55 2007
Return-Path: <java-user-return-31291-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 43925 invoked from network); 30 Nov 2007 00:53:55 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 00:53:55 -0000
Received: (qmail 20854 invoked by uid 500); 30 Nov 2007 00:53:37 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 20827 invoked by uid 500); 30 Nov 2007 00:53:37 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 20816 invoked by uid 99); 30 Nov 2007 00:53:37 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Nov 2007 16:53:37 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [202.167.225.74] (HELO topsp701-int0.prod.tradingscreen.com) (202.167.225.74)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 30 Nov 2007 00:53:39 +0000
Received: from tkdwi001.dev.tradingscreen.com ([172.21.16.56])
 by topsp701-int0.prod.tradingscreen.com (SMSSMTP 4.1.5.31) with SMTP id M2007113009531500245
 for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 09:53:15 +0900
X-MimeOLE: Produced By Microsoft Exchange V6.5.7226.0
Content-class: urn:content-classes:message
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
Subject: RE: CorruptIndexException
Date: Fri, 30 Nov 2007 09:53:15 +0900
Message-ID: <847893AE8EE17A48A3725E82C10DE9E5011C2A24@tkdwi001.dev.tradingscreen.com>
In-Reply-To: <1196328628.19921.1223855201@webmail.messagingengine.com>
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
Thread-Topic: CorruptIndexException
Thread-Index: AcgyapPCupxb8uvZQhOiEMzf+2fyWAAgLqsg
From: "Melanie Langlois" <Melanie.Langlois@tradingscreen.com>
To: <java-user@lucene.apache.org>
X-Virus-Checked: Checked by ClamAV on apache.org


Thank you, I indeed use newer version of Lucli by mistake.

-----Original Message-----
From: Michael McCandless [mailto:lucene@mikemccandless.com]=20
Sent: Thursday, November 29, 2007 6:30 PM
To: java-user@lucene.apache.org
Subject: Re: CorruptIndexException


That exception means your index was written with a newer version of
Lucene than the version you are using to open the IndexReader.

It looks like you used the unreleased (2.3 dev) version of Lucli from
the Lucene trunk and then went back to an older Lucene JAR (maybe 2.2?)
for accessing it?  In general writing an index with a newer version
of Lucene and then trying to access it using an older version of Lucene
doesn't work (whereas the opposite does).

I'm afraid you either have to switch to 2.3-dev for reading your index
(but beware it could have sneaky bugs ...), or, rebuild your index with
the 2.2 version of Lucene and use the 2.2 Lucli in the future.

Mike
=20
"Melanie Langlois" <Melanie.Langlois@tradingscreen.com> wrote:
> Hi,
>=20
> =20
>=20
> I use Lucli to optimize my index, when my application was stopped. And
> after restarting my application, I could not serahc my index anymore, =
I
> got the following exception :
>=20
> =20
>=20
> org.apache.lucene.index.CorruptIndexException: Unknown format version: =
-4
>=20
>         at
>         =
org.apache.lucene.index.SegmentInfos.read(SegmentInfos.java:204)
>=20
>         at
>         =
org.apache.lucene.index.IndexReader$1.doBody(IndexReader.java:190)
>=20
>         at
>         =
org.apache.lucene.index.SegmentInfos$FindSegmentsFile.run(SegmentInfos.ja=
va:610)
>=20
>         at =
org.apache.lucene.index.IndexReader.open(IndexReader.java:185)
>=20
>         at =
org.apache.lucene.index.IndexReader.open(IndexReader.java:167)
>=20
> =20
>=20
> I have two questions:
>=20
> -why does it occurs ? Should I use another tool to access the index
> outside of my application ?
>=20
> -do there is way to recover ?
>=20
> =20
>=20
> =20
>=20
> Thanks,
>=20
> =20
>=20
> M=E9lanie
>=20

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31292-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 08:54:10 2007
Return-Path: <java-user-return-31292-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 77043 invoked from network); 30 Nov 2007 08:54:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 08:54:10 -0000
Received: (qmail 74222 invoked by uid 500); 30 Nov 2007 08:53:51 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 74190 invoked by uid 500); 30 Nov 2007 08:53:51 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 74178 invoked by uid 99); 30 Nov 2007 08:53:51 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 00:53:51 -0800
X-ASF-Spam-Status: No, hits=2.6 required=10.0
	tests=DNS_FROM_OPENWHOIS,SPF_HELO_PASS,SPF_PASS,WHOIS_MYPRIVREG
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lists@nabble.com designates 216.139.236.158 as permitted sender)
Received: from [216.139.236.158] (HELO kuber.nabble.com) (216.139.236.158)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 08:53:54 +0000
Received: from isper.nabble.com ([192.168.236.156])
	by kuber.nabble.com with esmtp (Exim 4.63)
	(envelope-from <lists@nabble.com>)
	id 1Iy1cr-00059Y-5G
	for java-user@lucene.apache.org; Fri, 30 Nov 2007 00:53:33 -0800
Message-ID: <14042394.post@talk.nabble.com>
Date: Fri, 30 Nov 2007 00:53:33 -0800 (PST)
From: reeja <d.reeja@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: prefix query search problem if a hyphen exist in the search
 word
In-Reply-To: <359a92830711270723m787e3c96yfda04de9216d94a0@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Nabble-From: d.reeja@gmail.com
References: <13966231.post@talk.nabble.com> <359a92830711270723m787e3c96yfda04de9216d94a0@mail.gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org


Yes, i am using standard analyzer both at indexing and query time.


Erick Erickson wrote:
> 
> What analyzers are you using both at index time and
> query time? StandardAnalyzer will, for instance, split
> the words at the hyphen.
> 
> I would recommend that you get a copy of Luke (google
> lucene luke) and examine both the contents of your index,
> and the query produced by using various analyzers. Also,
> query.toString() will show you a lot about
> what is actually happening.
> 
> Best
> Erick
> 
> On Nov 27, 2007 2:47 AM, reeja <d.reeja@gmail.com> wrote:
> 
>>
>> Hi,
>>  I faced some problem with prefix query search when the prefix text
>> contains
>> a hyphen. i'm using lucene-2.1.
>> Search query is like this ttl:co-operative it returns more than 50
>> results,
>> but if i convert the query like this ttl:co-operat* it  returns no
>> result.
>> again i entered a query ttl:11-amino it returns some results, then
>>  changed
>> the above query into ttl:11-amino* it will return some more results than
>> previous query.
>> I think if a character or text appeared before the hyphen may  cause the
>> pbroblem, if the text before hyphen is a number its work fine.
>> anybody can help me to correct this problem.
>>
>> Thanks
>> reeja
>>
>>
>> --
>> View this message in context:
>> http://www.nabble.com/prefix-query-search-problem-if-a-hyphen-exist-in-the-search-word-tf4880266.html#a13966231
>> Sent from the Lucene - Java Users mailing list archive at Nabble.com.
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
>> For additional commands, e-mail: java-user-help@lucene.apache.org
>>
>>
> 
> 

-- 
View this message in context: http://www.nabble.com/prefix-query-search-problem-if-a-hyphen-exist-in-the-search-word-tf4880266.html#a14042394
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31293-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 11:28:19 2007
Return-Path: <java-user-return-31293-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 27995 invoked from network); 30 Nov 2007 11:28:18 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 11:28:18 -0000
Received: (qmail 38881 invoked by uid 500); 30 Nov 2007 11:28:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 38846 invoked by uid 500); 30 Nov 2007 11:28:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 38827 invoked by uid 99); 30 Nov 2007 11:28:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 03:28:00 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of lucene@nitwit.de designates 80.67.29.24 as permitted sender)
Received: from [80.67.29.24] (HELO smtprelay10.ispgateway.de) (80.67.29.24)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 11:27:40 +0000
Received: (qmail 14327 invoked from network); 30 Nov 2007 11:27:40 -0000
Received: from unknown (HELO server.localdomain) ([pbs]153383@[85.178.195.84])
          (envelope-sender <lucene@nitwit.de>)
          by smtprelay10.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 30 Nov 2007 11:27:40 -0000
Received: from localhost (localhost [127.0.0.1])
	by server.localdomain (Postfix) with ESMTP id 150351B8AE6
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 12:27:51 +0100 (CET)
From: Timo Nentwig <lucene@nitwit.de>
To: java-user@lucene.apache.org
Subject: FieldSelector
Date: Fri, 30 Nov 2007 12:27:50 +0100
User-Agent: KMail/1.9.7
MIME-Version: 1.0
Content-Type: text/plain;
  charset="us-ascii"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711301227.50788.lucene@nitwit.de>
X-Virus-Checked: Checked by ClamAV on apache.org

Hi!

I do have different document types (Books, Magazines, Author whatever) in the 
index and a FieldSelector is document type specific (for Books LOAD isbn and 
title for Author name, ...). The document type can be determined by a field 
surprisingly called documentType.

How am I going to do this? Reading twice? First IndexReader.document() only 
the documentType and then choose proper FieldSelector and read again? 

Thanks,
timo

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31294-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 11:34:34 2007
Return-Path: <java-user-return-31294-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 29186 invoked from network); 30 Nov 2007 11:34:34 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 11:34:34 -0000
Received: (qmail 44399 invoked by uid 500); 30 Nov 2007 11:34:17 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 44249 invoked by uid 500); 30 Nov 2007 11:34:17 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 44233 invoked by uid 99); 30 Nov 2007 11:34:17 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 03:34:17 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [62.44.101.114] (HELO smtp.fmi.uni-sofia.bg) (62.44.101.114)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 11:34:17 +0000
Received: from kronecker.fmi.uni-sofia.bg ([62.44.101.234])
	by smtp.fmi.uni-sofia.bg (Kerio MailServer 6.2.1)
	for java-user@lucene.apache.org;
	Fri, 30 Nov 2007 13:31:17 +0200
Received: from [192.168.1.2] (client-82-199-207-51.speedy.sellinet.net [82.199.207.51])
	by kronecker.fmi.uni-sofia.bg (Postfix) with ESMTP id 2F4DA8013D
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 13:33:54 +0200 (EET)
Message-ID: <474FF522.6030803@triangle.bg>
Date: Fri, 30 Nov 2007 13:33:54 +0200
From: Ognyan Kulev <ogi@triangle.bg>
User-Agent: Icedove 1.5.0.14pre (X11/20071018)
MIME-Version: 1.0
To:  java-user@lucene.apache.org
Subject: IndexHTML and UTF-8
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

Hi,

I'm trying run org.apache.lucene.demo.IndexHTML on HTML files with
UTF-8. In JavaCC FAQ, it's said that just UTF-8 Reader should be given
to SimpleCharStream:
http://www.engr.mun.ca/~theo/JavaCC-FAQ/javacc-faq-moz.htm#tth_sEc3.21 .
I made the following change in HTMLDocument.java:

//old: FileInputStream fis = new FileInputStream(f);
InputStreamReader isr = new InputStreamReader(new FileInputStream(f),
"UTF-8");
HTMLParser parser = new HTMLParser(isr);

It doesn't help. I don't know if it's true but this text is in
SimpleCharStream:

"An implementation of interface CharStream, where the stream is assumed
to contain only ASCII characters (without unicode processing)."

The error is like that:

Parse Aborted: Lexical error at line 5, column 34.  Encountered:
"\u0411" (1041), after : ""

This is right after <meta name="Author" content=" . Interestingly, there
is <title> in cyrillic before that.

Any ideas? Or I have to look at alternatives like those in
http://wiki.apache.org/lucene-java/LuceneFAQ#head-e7d23f91df094d7baeceb46b04d518dc426d7d2e
(How can I index HTML documents?)

Regards,
Ognyan Kulev



---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31295-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 11:59:54 2007
Return-Path: <java-user-return-31295-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 34714 invoked from network); 30 Nov 2007 11:59:54 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 11:59:54 -0000
Received: (qmail 79627 invoked by uid 500); 30 Nov 2007 11:59:36 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 79596 invoked by uid 500); 30 Nov 2007 11:59:36 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 79584 invoked by uid 99); 30 Nov 2007 11:59:36 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 03:59:36 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (nike.apache.org: local policy)
Received: from [208.97.132.145] (HELO spunkymail-a3.g.dreamhost.com) (208.97.132.145)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 11:59:36 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a3.g.dreamhost.com (Postfix) with ESMTP id 3C6F715D48F
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 03:59:15 -0800 (PST)
Message-Id: <3766188C-8153-43B6-AC16-134E36F6348C@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <200711301227.50788.lucene@nitwit.de>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: FieldSelector
Date: Fri, 30 Nov 2007 06:59:13 -0500
References: <200711301227.50788.lucene@nitwit.de>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org

Hmmm, I think you should be able to rely on the fact that Fields are  
stored in order of indexing and then read back in that same order.   
Thus, index your documents making sure that the documentType is the  
first Field on the Document (and for performance reasons, the other  
fields you want to load are next).   Then, in your FieldSelector, you  
can, upon seeing the documentType, set the appropriate flags for when  
the other Fields are read..

Otherwise, the reading twice approach makes sense.

-Grant

On Nov 30, 2007, at 6:27 AM, Timo Nentwig wrote:

> Hi!
>
> I do have different document types (Books, Magazines, Author  
> whatever) in the
> index and a FieldSelector is document type specific (for Books LOAD  
> isbn and
> title for Author name, ...). The document type can be determined by  
> a field
> surprisingly called documentType.
>
> How am I going to do this? Reading twice? First  
> IndexReader.document() only
> the documentType and then choose proper FieldSelector and read again?
>
> Thanks,
> timo
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>

--------------------------
Grant Ingersoll
http://lucene.grantingersoll.com

Lucene Helpful Hints:
http://wiki.apache.org/lucene-java/BasicsOfPerformance
http://wiki.apache.org/lucene-java/LuceneFAQ




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31296-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 13:35:26 2007
Return-Path: <java-user-return-31296-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 71355 invoked from network); 30 Nov 2007 13:35:26 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 13:35:26 -0000
Received: (qmail 82432 invoked by uid 500); 30 Nov 2007 13:35:09 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 81784 invoked by uid 500); 30 Nov 2007 13:35:08 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 81773 invoked by uid 99); 30 Nov 2007 13:35:08 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 05:35:08 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 64.233.182.189 as permitted sender)
Received: from [64.233.182.189] (HELO nf-out-0910.google.com) (64.233.182.189)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 13:34:47 +0000
Received: by nf-out-0910.google.com with SMTP id d3so1966018nfc
        for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 05:34:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=XqRlcB1iY2j4lEoW1tmgUZRjvYXyB7ahCWatAqZ0qlw=;
        b=XKSnLprN7khAjOf1E8fqHb+rMq1wDkwyA/KPdEvOcQ7Fjy9clDiZHq2d+h4Q2pHX3vOtK9fpXQWgkyRvbYZy2miDv46kN2sejTIabXVUITPpu08vQ5aejqLyCWsE9c9u7D2VpEElar5yBUuDr4fHdSLRvQhYOpvggoNKjSe+gdk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=F4GYokzykLioNtpcCSWh3HORPC2McA7NiD4kiUhqz25QcBayuKPjlocsj223X1ei7o+iZn1fx+2lhxqyw7CMIDAx9iOO4k6Y4dxF2UHQ4s8IR/WlMZUJAY6vMJlURQ+po6vCaqQmqESSV9YSL3L43KVhFABoN3RnVS+bs7Ka/rg=
Received: by 10.82.116.15 with SMTP id o15mr7378288buc.1196429688804;
        Fri, 30 Nov 2007 05:34:48 -0800 (PST)
Received: from ?10.0.55.114? ( [202.125.143.68])
        by mx.google.com with ESMTPS id z34sm6597788ikz.2007.11.30.05.34.43
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 30 Nov 2007 05:34:46 -0800 (PST)
Message-ID: <4750115F.3080309@gmail.com>
Date: Fri, 30 Nov 2007 18:34:23 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: FSDirectory
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

I m facing problem with this code..

dir = new FSDirectory();

    dir.getDirectory(indexDir, true);

i get error that FSDirectory has protected access. So what i should use 
instead of it...


Liaqat

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31297-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 14:11:09 2007
Return-Path: <java-user-return-31297-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 87211 invoked from network); 30 Nov 2007 14:11:09 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 14:11:09 -0000
Received: (qmail 45698 invoked by uid 500); 30 Nov 2007 14:10:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 45665 invoked by uid 500); 30 Nov 2007 14:10:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 45654 invoked by uid 99); 30 Nov 2007 14:10:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 06:10:52 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.187 as permitted sender)
Received: from [209.85.134.187] (HELO mu-out-0910.google.com) (209.85.134.187)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 14:10:33 +0000
Received: by mu-out-0910.google.com with SMTP id i10so2623070mue
        for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 06:10:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=G66p2ESzYywrLPjtUm1vEOmTJhNJ2Un0UfoHHM0ZwRM=;
        b=HmnwoewRYp5aY0RWdOP1hRDC0n9LcotPLbdoEaChrVMMOYn44YGq/AbiTGapoOAauQK6vWCPk82/YNnMU7xvM6Pqxfg5fT0tROMYpzlMHDTGaescXLCNfx3asz4NS8OujmAm9IsmnjdCsH0RWrw0WslZxHVwzCgbacdEwQsaDY8=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=qi3xXQ2RRnAfhaYB9A8srKZeCiF34Hn5SI1FvAyE4S35onD+ilrMV5pPyxq3NsMZ7molb/bcUu4Sr51N2cYmgE80sTFqzmtcgkKTjbBW3CFp8S1igULs0aTxMRn1HLI8iI65Pp9c/Gv2foVcfcTmcDcNYMI9uAPJvyU5l4gyclo=
Received: by 10.82.175.17 with SMTP id x17mr4952181bue.1196431834203;
        Fri, 30 Nov 2007 06:10:34 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Fri, 30 Nov 2007 06:10:33 -0800 (PST)
Message-ID: <359a92830711300610t241c9b72la2f592885331f509@mail.gmail.com>
Date: Fri, 30 Nov 2007 09:10:33 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: FSDirectory
In-Reply-To: <4750115F.3080309@gmail.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_13185_13602200.1196431834137"
References: <4750115F.3080309@gmail.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_13185_13602200.1196431834137
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

A directory that your program can modify <G>. I assume that
you are running on a unix-like system and the directory you've
specified is protected from modification by whatever user
your process is identified as.

But two other things:
1> do you really want to create a new index as the "true" indicates?
2> This form is deprecated. I'm not sure what the first version that
deprecated this, but from the 2.1 documentation....
*getDirectory<file:///C:/lucene-2.1.0/docs/api/org/apache/lucene/store/FSDirectory.html#getDirectory%28java.io.File,%20boolean%29>
*(File <http://java.sun.com/j2se/1.4/docs/api/java/io/File.html> file,
boolean create)
          *Deprecated.* *Use IndexWriter's create flag, instead, to create a
new index.

*But I'd expect the same behavior from IndexWriter with the create flag...

Best
Erick

On Nov 30, 2007 8:34 AM, Liaqat Ali <liaqatalimian@gmail.com> wrote:

> I m facing problem with this code..
>
> dir = new FSDirectory();
>
>    dir.getDirectory(indexDir, true);
>
> i get error that FSDirectory has protected access. So what i should use
> instead of it...
>
>
> Liaqat
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_13185_13602200.1196431834137--

From java-user-return-31298-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 14:21:49 2007
Return-Path: <java-user-return-31298-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 92826 invoked from network); 30 Nov 2007 14:21:49 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 14:21:49 -0000
Received: (qmail 65287 invoked by uid 500); 30 Nov 2007 14:21:32 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 65244 invoked by uid 500); 30 Nov 2007 14:21:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 65222 invoked by uid 99); 30 Nov 2007 14:21:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 06:21:32 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=RCVD_IN_BL_SPAMCOP_NET,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of liaqatalimian@gmail.com designates 66.249.92.172 as permitted sender)
Received: from [66.249.92.172] (HELO ug-out-1314.google.com) (66.249.92.172)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 14:21:12 +0000
Received: by ug-out-1314.google.com with SMTP id m3so926675ugc
        for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 06:21:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        bh=r08kuPc6gZV/Gg0yIMSnMm/aPLz0nzitcaWevB4Ofbg=;
        b=Wadg2yoc3j8TLr6BqDfDrNwU6kC8FzqIduJRSZwgetE0Zu/1sC1s79WggM2l4Htl0itmb+W7n/io7HgJ2OuX5/Ip5Hpgm1D8oQaNeAaE6gfOo7ItE+HoS62Y4LxiKdgpwbtI12S1HukM+/6XG5qFZTA+/0/BBIQzGoVPMlMRqVk=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:user-agent:mime-version:to:subject:content-type:content-transfer-encoding;
        b=IXnVUTn6JhhfbKwxjRb60tp7ISy7+AaUU0ZAfZlyIaeZsFZFDSZ2EroXurNCt+qpPD7IoQ/gOxa2dWqWCZ9eDSZ3HftWwDUXCI4aLe8KKlupwpJaSSmn5DqPKy+r8reyaBP6o1ge1o659GCej0LO8nCjxU6NC/wukf7oL92b9kw=
Received: by 10.67.27.15 with SMTP id e15mr148722ugj.1196432473194;
        Fri, 30 Nov 2007 06:21:13 -0800 (PST)
Received: from ?10.0.55.114? ( [202.125.143.68])
        by mx.google.com with ESMTPS id e34sm9081462ugd.2007.11.30.06.21.08
        (version=TLSv1/SSLv3 cipher=RC4-MD5);
        Fri, 30 Nov 2007 06:21:11 -0800 (PST)
Message-ID: <47501C4A.2080300@gmail.com>
Date: Fri, 30 Nov 2007 19:20:58 +0500
From: Liaqat Ali <liaqatalimian@gmail.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
Subject: FSDirectory Again
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-Virus-Checked: Checked by ClamAV on apache.org

No you are not getting me.  I have this original code. What i should use 
instead of this code to create  a directory, because the dir 
=FSDirectory.getDirectory(indexDir, true) is deprecated.

import org.apache.lucene.store.Directory;
import org.apache.lucene.store.FSDirectory;

protected Directory dir;

  protected void setUp() throws IOException {
    String indexDir =
      System.getProperty("java.io.tmpdir", "tmp") +
      System.getProperty("file.separator") + "index-dir";
    dir = FSDirectory.getDirectory(indexDir, true);
    addDocuments(dir);
  }




---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31299-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 14:32:20 2007
Return-Path: <java-user-return-31299-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 98289 invoked from network); 30 Nov 2007 14:32:19 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 14:32:19 -0000
Received: (qmail 81012 invoked by uid 500); 30 Nov 2007 14:32:02 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 80987 invoked by uid 500); 30 Nov 2007 14:32:02 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 80976 invoked by uid 99); 30 Nov 2007 14:32:02 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 06:32:02 -0800
X-ASF-Spam-Status: No, hits=-2.0 required=10.0
	tests=HTML_MESSAGE,RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of gresh@us.ibm.com designates 32.97.182.146 as permitted sender)
Received: from [32.97.182.146] (HELO e6.ny.us.ibm.com) (32.97.182.146)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 14:32:03 +0000
Received: from d01relay04.pok.ibm.com (d01relay04.pok.ibm.com [9.56.227.236])
	by e6.ny.us.ibm.com (8.13.8/8.13.8) with ESMTP id lAUEXNRX003561
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 09:33:23 -0500
Received: from d01av01.pok.ibm.com (d01av01.pok.ibm.com [9.56.224.215])
	by d01relay04.pok.ibm.com (8.13.8/8.13.8/NCO v8.7) with ESMTP id lAUEVgNZ099036
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 09:31:42 -0500
Received: from d01av01.pok.ibm.com (loopback [127.0.0.1])
	by d01av01.pok.ibm.com (8.12.11.20060308/8.13.3) with ESMTP id lAUEVgQD006008
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 09:31:42 -0500
Received: from d01ml605.pok.ibm.com (d01ml605.pok.ibm.com [9.56.227.91])
	by d01av01.pok.ibm.com (8.12.11.20060308/8.12.11) with ESMTP id lAUEVgx7006001
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 09:31:42 -0500
In-Reply-To: <47501C4A.2080300@gmail.com>
To: java-user@lucene.apache.org
MIME-Version: 1.0
Subject: Re: FSDirectory Again
X-Mailer: Lotus Notes Release 7.0 HF277 June 21, 2006
From: Donna L Gresh <gresh@us.ibm.com>
Message-ID: <OF0B77F353.51EDC6D6-ON852573A3.004F8B74-852573A3.004FC4B2@us.ibm.com>
Date: Fri, 30 Nov 2007 09:31:40 -0500
X-MIMETrack: Serialize by Router on D01ML605/01/M/IBM(Release 8.0|August 02, 2007) at 11/30/2007
 09:31:41,
	Serialize complete at 11/30/2007 09:31:41
Content-Type: multipart/alternative; boundary="=_alternative 004FC3AD852573A3_="
X-Virus-Checked: Checked by ClamAV on apache.org

--=_alternative 004FC3AD852573A3_=
Content-Type: text/plain; charset="US-ASCII"

In general it is much nicer to say "I did not make myself clear" than "you 
are not getting me"

If you look on the java doc page for FSDirectory it tells you what do do 
instead of the deprecated method:


getDirectory(File file, boolean create) 
          Deprecated. Use IndexWriter's create flag, instead, to create a 
new index.


Here is the code I use
                Directory directory = FSDirectory.getDirectory(
directoryName);
....
                IndexWriter iwriter = new IndexWriter(directory, analyzer, 
reCreate);

Donna L. Gresh
Services Research, Mathematical Sciences Department
IBM T.J. Watson Research Center
(914) 945-2472
http://www.research.ibm.com/people/g/donnagresh
gresh@us.ibm.com


Liaqat Ali <liaqatalimian@gmail.com> wrote on 11/30/2007 09:20:58 AM:

> No you are not getting me.  I have this original code. What i should use 

> instead of this code to create  a directory, because the dir 
> =FSDirectory.getDirectory(indexDir, true) is deprecated.
> 
> import org.apache.lucene.store.Directory;
> import org.apache.lucene.store.FSDirectory;
> 
> protected Directory dir;
> 
>   protected void setUp() throws IOException {
>     String indexDir =
>       System.getProperty("java.io.tmpdir", "tmp") +
>       System.getProperty("file.separator") + "index-dir";
>     dir = FSDirectory.getDirectory(indexDir, true);
>     addDocuments(dir);
>   }
> 
> 
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 

--=_alternative 004FC3AD852573A3_=--

From java-user-return-31300-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 15:58:30 2007
Return-Path: <java-user-return-31300-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30221 invoked from network); 30 Nov 2007 15:58:30 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 15:58:30 -0000
Received: (qmail 14768 invoked by uid 500); 30 Nov 2007 15:58:12 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 14732 invoked by uid 500); 30 Nov 2007 15:58:12 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 14721 invoked by uid 99); 30 Nov 2007 15:58:12 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 07:58:12 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_HELO_PASS,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: domain of lucene@nitwit.de designates 80.67.29.7 as permitted sender)
Received: from [80.67.29.7] (HELO smtprelay07.ispgateway.de) (80.67.29.7)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 15:58:14 +0000
Received: (qmail 25273 invoked from network); 30 Nov 2007 15:57:50 -0000
Received: from unknown (HELO server.localdomain) ([pbs]153383@[85.178.195.84])
          (envelope-sender <lucene@nitwit.de>)
          by smtprelay07.ispgateway.de (qmail-ldap-1.03) with AES256-SHA encrypted SMTP
          for <java-user@lucene.apache.org>; 30 Nov 2007 15:57:50 -0000
Received: from localhost (localhost [127.0.0.1])
	by server.localdomain (Postfix) with ESMTP id 5A26F4ABC7A
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 16:58:02 +0100 (CET)
From: Timo Nentwig <lucene@nitwit.de>
To: java-user@lucene.apache.org
Subject: Re: FieldSelector
Date: Fri, 30 Nov 2007 16:58:02 +0100
User-Agent: KMail/1.9.7
References: <200711301227.50788.lucene@nitwit.de> <3766188C-8153-43B6-AC16-134E36F6348C@apache.org>
In-Reply-To: <3766188C-8153-43B6-AC16-134E36F6348C@apache.org>
MIME-Version: 1.0
Content-Type: text/plain;
  charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
Content-Disposition: inline
Message-Id: <200711301658.02229.lucene@nitwit.de>
X-Virus-Checked: Checked by ClamAV on apache.org

On Friday 30 November 2007 12:59:13 Grant Ingersoll wrote:
> Hmmm, I think you should be able to rely on the fact that Fields are
> stored in order of indexing and then read back in that same order.

Yeah, tought about that for a moment but this is just way to fragile.

> Otherwise, the reading twice approach makes sense.

Yes, it makes sense the question is whether it performs. The sense of a 
FieldSelector as I understand it is to save disk IO (ans maybe also save a 
couple of bytes RAM...).

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31301-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 18:14:45 2007
Return-Path: <java-user-return-31301-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 3203 invoked from network); 30 Nov 2007 18:14:44 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 18:14:44 -0000
Received: (qmail 10202 invoked by uid 500); 30 Nov 2007 18:14:26 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 10172 invoked by uid 500); 30 Nov 2007 18:14:26 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 10158 invoked by uid 99); 30 Nov 2007 18:14:26 -0000
Received: from nike.apache.org (HELO nike.apache.org) (192.87.106.230)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 10:14:25 -0800
X-ASF-Spam-Status: No, hits=-4.0 required=10.0
	tests=RCVD_IN_DNSWL_MED,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (nike.apache.org: local policy)
Received: from [13.1.64.93] (HELO alpha.xerox.com) (13.1.64.93)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 18:14:28 +0000
Received: from synergy1.parc.xerox.com ([13.1.101.60]) by alpha.xerox.com with SMTP id <223314(1)>; Fri, 30 Nov 2007 10:13:49 PST
Received: from parc.com ([127.0.0.1]) by synergy1.parc.xerox.com with SMTP id <58696>; Fri, 30 Nov 2007 10:13:39 PST
To: java-user@lucene.apache.org
Subject: Re: lucene-core-2.2.0.jar broken? CorruptIndexException? 
In-reply-to: <1196375823.32362.1223988889@webmail.messagingengine.com> 
References: <07Nov28.094136pst."58696"@synergy1.parc.xerox.com> <07Nov28.102301pst."58696"@synergy1.parc.xerox.com> <07Nov28.112847pst."58696"@synergy1.parc.xerox.com> <1196280278.23481.1223752059@webmail.messagingengine.com> <07Nov28.130137pst."58696"@synergy1.parc.xerox.com> <1196284625.4114.1223763677@webmail.messagingengine.com> <07Nov28.210649pst."58696"@synergy1.parc.xerox.com> <1196331025.25608.1223860421@webmail.messagingengine.com> <07Nov29.103456pst."58696"@synergy1.parc.xerox.com> <262FD71B-41F1-4AB6-A0E0-38A785F8CA95@apache.org> <07Nov29.112701pst."58696"@synergy1.parc.xerox.com> <507AA1FE-18DB-4DC6-AF68-C31171FC9AE8@apache.org> <07Nov29.141603pst."58696"@synergy1.parc.xerox.com> <1196375823.32362.1223988889@webmail.messagingengine.com>
Comments: In-reply-to "Michael McCandless" <lucene@mikemccandless.com>
    message dated "Thu, 29 Nov 2007 14:37:03 -0800."
Date: Fri, 30 Nov 2007 10:13:29 PST
From: Bill Janssen <janssen@parc.com>
Message-Id: <07Nov30.101339pst."58696"@synergy1.parc.xerox.com>
X-Virus-Checked: Checked by ClamAV on apache.org

> Your errors seem to happen around the same area (~20K docs).  If you
> skip the first say ~18K docs does the error still happen?  We need to
> somehow narrow this down.

I'm trying to boil down the documents to a set which I can deploy on a
DVD-ROM, so I can move the same set around from machine to machine.  But
today, unfortunately, I have to do some real work :-).

I'll see if I can get back to this over the weekend.

Bill

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31302-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 18:28:51 2007
Return-Path: <java-user-return-31302-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 13093 invoked from network); 30 Nov 2007 18:28:51 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 18:28:51 -0000
Received: (qmail 29609 invoked by uid 500); 30 Nov 2007 18:28:33 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 29583 invoked by uid 500); 30 Nov 2007 18:28:32 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 29572 invoked by uid 99); 30 Nov 2007 18:28:32 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 10:28:32 -0800
X-ASF-Spam-Status: No, hits=1.2 required=10.0
	tests=SPF_NEUTRAL
X-Spam-Check-By: apache.org
Received-SPF: neutral (athena.apache.org: local policy)
Received: from [208.97.132.5] (HELO spunkymail-a12.g.dreamhost.com) (208.97.132.5)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 18:28:12 +0000
Received: from [192.168.0.3] (adsl-074-229-189-244.sip.rmo.bellsouth.net [74.229.189.244])
	by spunkymail-a12.g.dreamhost.com (Postfix) with ESMTP id 47D7A7FAA
	for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 10:28:14 -0800 (PST)
Message-Id: <98340F18-AC0F-4545-9CE5-11638E3E0F8C@apache.org>
From: Grant Ingersoll <gsingers@apache.org>
To: java-user@lucene.apache.org
In-Reply-To: <200711301658.02229.lucene@nitwit.de>
Content-Type: text/plain; charset=US-ASCII; format=flowed; delsp=yes
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (Apple Message framework v915)
Subject: Re: FieldSelector
Date: Fri, 30 Nov 2007 13:28:12 -0500
References: <200711301227.50788.lucene@nitwit.de> <3766188C-8153-43B6-AC16-134E36F6348C@apache.org> <200711301658.02229.lucene@nitwit.de>
X-Mailer: Apple Mail (2.915)
X-Virus-Checked: Checked by ClamAV on apache.org


On Nov 30, 2007, at 10:58 AM, Timo Nentwig wrote:

> On Friday 30 November 2007 12:59:13 Grant Ingersoll wrote:
>> Hmmm, I think you should be able to rely on the fact that Fields are
>> stored in order of indexing and then read back in that same order.
>
> Yeah, tought about that for a moment but this is just way to fragile.

I can understand your hesitation, but good documentation of what you  
are doing and lots of comments should help :-)

>
>
>> Otherwise, the reading twice approach makes sense.
>
> Yes, it makes sense the question is whether it performs. The sense  
> of a
> FieldSelector as I understand it is to save disk IO (ans maybe also  
> save a
> couple of bytes RAM...).
>

I guess the question becomes what is the nature of your fields?  Do  
you have some really large fields that you want to avoid loading b/c  
they are not shown initially?  That is the main use case, I guess.

Have you actually done some profiling to see that you are hitting a  
bottleneck?

I wouldn't recommend it, but if it was really important to you, you  
could modify FieldsReader to be more intelligent about your fields,  
but again this would be fragile, too.

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31303-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 18:53:21 2007
Return-Path: <java-user-return-31303-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 25567 invoked from network); 30 Nov 2007 18:53:21 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 18:53:21 -0000
Received: (qmail 77772 invoked by uid 500); 30 Nov 2007 18:53:00 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 77747 invoked by uid 500); 30 Nov 2007 18:53:00 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 77736 invoked by uid 99); 30 Nov 2007 18:53:00 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 10:53:00 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [68.142.237.94] (HELO n9.bullet.re3.yahoo.com) (68.142.237.94)
    by apache.org (qpsmtpd/0.29) with SMTP; Fri, 30 Nov 2007 18:52:38 +0000
Received: from [68.142.237.88] by n9.bullet.re3.yahoo.com with NNFMP; 30 Nov 2007 18:52:40 -0000
Received: from [69.147.75.180] by t4.bullet.re3.yahoo.com with NNFMP; 30 Nov 2007 18:52:40 -0000
Received: from [127.0.0.1] by omp101.mail.re1.yahoo.com with NNFMP; 30 Nov 2007 18:52:40 -0000
X-Yahoo-Newman-Property: ymail-3
X-Yahoo-Newman-Id: 469278.28841.bm@omp101.mail.re1.yahoo.com
Received: (qmail 77977 invoked by uid 60001); 30 Nov 2007 18:52:40 -0000
DomainKey-Signature: a=rsa-sha1; q=dns; c=nofws;
  s=s1024; d=yahoo.com;
  h=X-YMail-OSG:Received:Date:From:Subject:To:MIME-Version:Content-Type:Content-Transfer-Encoding:Message-ID;
  b=wyaZ5qG6HHdUznM6Fb/OAbqtuY+X/TgfXqOOBV07HjGsG57fEHA2EYNpjRVwiz5A6e+vV551IOYIB7XMlRHB52PVZtCQZH7emjgm9k+HPcR/6RkbHyjnxSXU9ac7osUCliJKh8sworKZIDNPQIJ47+ZEUsqejC9KHAKIWi/jNSM=;
X-YMail-OSG: YRk7XdMVM1khzOIl8VQxtIGwzG2nLZ8nSirblVlavfn8Zenb0vGRuong0Z6w3nMzJg--
Received: from [59.94.103.32] by web57303.mail.re1.yahoo.com via HTTP; Fri, 30 Nov 2007 10:52:39 PST
Date: Fri, 30 Nov 2007 10:52:39 -0800 (PST)
From: Ruchi Thakur <ruchi.thak11@yahoo.com>
Subject: BooleanQuery TooManyClauses in wildcard search
To: java-user@lucene.apache.org
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="0-1579118598-1196448759=:77244"
Content-Transfer-Encoding: 8bit
Message-ID: <191027.77244.qm@web57303.mail.re1.yahoo.com>
X-Virus-Checked: Checked by ClamAV on apache.org

--0-1579118598-1196448759=:77244
Content-Type: text/plain; charset=iso-8859-1
Content-Transfer-Encoding: 8bit

 
  Hi there. 
I am a new Lucene user and I have been searching the group archives but couldn't solve the problem. I have just joined a project that uses Lucene. 
We use the StandardAnalyzer for indexing our documents and our query is as 
follows when we issue a search string of    t*      for example:
  +t* +cont_type:pa
   
  We get an Exception when we issue some of our wildcard text searches we get following Exception
  org.apache.lucene.search.BooleanQuery$TooManyClauses Exception : Max clause if 1024
   
  Please suggest.
   
  Regards,
  Ruchi
   
   
   
   
  
 

       
---------------------------------
Never miss a thing.   Make Yahoo your homepage.
--0-1579118598-1196448759=:77244--


From java-user-return-31304-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 19:08:07 2007
Return-Path: <java-user-return-31304-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 30941 invoked from network); 30 Nov 2007 19:08:07 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 19:08:07 -0000
Received: (qmail 4787 invoked by uid 500); 30 Nov 2007 19:07:48 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4760 invoked by uid 500); 30 Nov 2007 19:07:48 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4749 invoked by uid 99); 30 Nov 2007 19:07:48 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 11:07:48 -0800
X-ASF-Spam-Status: No, hits=-0.0 required=10.0
	tests=SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: local policy)
Received: from [194.125.145.37] (HELO mercury.propylon.com) (194.125.145.37)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 19:07:28 +0000
Received: from propylon-sdsl.sdsl.esat.net ([193.120.101.26] helo=[192.168.214.134])
	by mercury.propylon.com with esmtp (Exim 4.50)
	id 1IyB9d-0006aM-Lu
	for java-user@lucene.apache.org; Fri, 30 Nov 2007 19:04:06 +0000
Message-ID: <47505F66.40506@propylon.com>
Date: Fri, 30 Nov 2007 11:07:18 -0800
From: John Byrne <john.byrne@propylon.com>
User-Agent: Thunderbird 2.0.0.9 (Windows/20071031)
MIME-Version: 1.0
To: java-user@lucene.apache.org
References: <191027.77244.qm@web57303.mail.re1.yahoo.com>
In-Reply-To: <191027.77244.qm@web57303.mail.re1.yahoo.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
X-SA-Exim-Connect-IP: 193.120.101.26
X-SA-Exim-Mail-From: john.byrne@propylon.com
Subject: Re: BooleanQuery TooManyClauses in wildcard search
X-Spam-Checker-Version: SpamAssassin 3.0.3 (2005-04-27) on 
	mercury.propylon.com
X-Spam-Level: 
X-SA-Exim-Version: 4.2 (built Thu, 03 Mar 2005 10:44:12 +0100)
X-SA-Exim-Scanned: Yes (on mercury.propylon.com)
X-Virus-Checked: Checked by ClamAV on apache.org
X-Old-Spam-Status: No, score=0.1 required=5.0 tests=AWL autolearn=failed 
	version=3.0.3

Hi,

Your problem is that when you do a wildacrd search, Lucene expands the 
wildacrd term into all possible terms. So, searching for "stat*" 
produces a list of terms like "state", "states", "stating" etc. (It only 
uses terms that actually occur in your index, however). These terms are 
all added as OR clauses of a boolean query.

The thing is, be defult, there is a limit of 1024 caluses for a boolean 
query. If yuor wildacrd term expands into more than this, (which happens 
very easily), you get that exception you described. You can solve the 
issues by setting the maximum clause count yourself, using

BooleanQuery.setMaxClauseCount(int maxClauseCount)

See 
http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/core/index.html 
for mroe info.

Bear in mind that putting a wildcard near the start of the term results 
in a large number of boolean clauses, which increases memory usage. This 
is the reason for the default limit. This limit will also affect fuzzy 
queries, because they are expanded in the same way.

Regards,
JB

Ruchi Thakur wrote:
>  
>   Hi there. 
> I am a new Lucene user and I have been searching the group archives but couldn't solve the problem. I have just joined a project that uses Lucene. 
> We use the StandardAnalyzer for indexing our documents and our query is as 
> follows when we issue a search string of    t*      for example:
>   +t* +cont_type:pa
>    
>   We get an Exception when we issue some of our wildcard text searches we get following Exception
>   org.apache.lucene.search.BooleanQuery$TooManyClauses Exception : Max clause if 1024
>    
>   Please suggest.
>    
>   Regards,
>   Ruchi
>    
>    
>    
>    
>   
>  
>
>        
> ---------------------------------
> Never miss a thing.   Make Yahoo your homepage.
>   
> ------------------------------------------------------------------------
>
> No virus found in this incoming message.
> Checked by AVG Free Edition. 
> Version: 7.5.503 / Virus Database: 269.16.11/1161 - Release Date: 30/11/2007 12:12
>   


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


From java-user-return-31305-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org Fri Nov 30 20:12:11 2007
Return-Path: <java-user-return-31305-apmail-lucene-java-user-archive=lucene.apache.org@lucene.apache.org>
Delivered-To: apmail-lucene-java-user-archive@www.apache.org
Received: (qmail 62686 invoked from network); 30 Nov 2007 20:12:10 -0000
Received: from hermes.apache.org (HELO mail.apache.org) (140.211.11.2)
  by minotaur.apache.org with SMTP; 30 Nov 2007 20:12:10 -0000
Received: (qmail 4540 invoked by uid 500); 30 Nov 2007 20:11:52 -0000
Delivered-To: apmail-lucene-java-user-archive@lucene.apache.org
Received: (qmail 4486 invoked by uid 500); 30 Nov 2007 20:11:52 -0000
Mailing-List: contact java-user-help@lucene.apache.org; run by ezmlm
Precedence: bulk
List-Help: <mailto:java-user-help@lucene.apache.org>
List-Unsubscribe: <mailto:java-user-unsubscribe@lucene.apache.org>
List-Post: <mailto:java-user@lucene.apache.org>
List-Id: <java-user.lucene.apache.org>
Reply-To: java-user@lucene.apache.org
Delivered-To: mailing list java-user@lucene.apache.org
Received: (qmail 4471 invoked by uid 99); 30 Nov 2007 20:11:52 -0000
Received: from athena.apache.org (HELO athena.apache.org) (140.211.11.136)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 12:11:52 -0800
X-ASF-Spam-Status: No, hits=2.0 required=10.0
	tests=HTML_MESSAGE,SPF_PASS
X-Spam-Check-By: apache.org
Received-SPF: pass (athena.apache.org: domain of erickerickson@gmail.com designates 209.85.134.184 as permitted sender)
Received: from [209.85.134.184] (HELO mu-out-0910.google.com) (209.85.134.184)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Nov 2007 20:11:30 +0000
Received: by mu-out-0910.google.com with SMTP id i10so45839mue
        for <java-user@lucene.apache.org>; Fri, 30 Nov 2007 12:11:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=gamma;
        h=domainkey-signature:received:received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        bh=/JGfdU2i0rGdGn95eRhlXp9/U/IZ5LtS+2Rd/KvB/d0=;
        b=Ac5GF3tebRbcYreIBt4IKTSzeQazvAi6g3i0fwpyyannwJO/7tuhPXqU9chklSz6VmwSwMbWNqf0CLTS94nBi2lVeV7IbCac//kppmgG/LKHvG8Z5KGhoTOH6ngrXBeev6YCFMbIGWvMGRVz5s4+UMZ6D+wE4IvnwYCzmNjou98=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=gamma;
        h=received:message-id:date:from:to:subject:in-reply-to:mime-version:content-type:references;
        b=U+6DPwDXZ+bxyNibONt29DZWtnNRBMjE5ZZJ1hxWK94wBul/fV9O+dUMd102SfdkFC4tEjBLeYZ2GLMeVY6Uj8wTTuqOdPvfhUiCWndcUKXOJfJROK4J+LE0Lf34hKjK6s9jEofCcr/ZRAO+7atNGPY8y1HclSXomK9nLjS3ujg=
Received: by 10.82.180.17 with SMTP id c17mr765403buf.1196453490908;
        Fri, 30 Nov 2007 12:11:30 -0800 (PST)
Received: by 10.82.155.11 with HTTP; Fri, 30 Nov 2007 12:11:30 -0800 (PST)
Message-ID: <359a92830711301211g17a07b68k115df38dcce2822e@mail.gmail.com>
Date: Fri, 30 Nov 2007 15:11:30 -0500
From: "Erick Erickson" <erickerickson@gmail.com>
To: java-user@lucene.apache.org
Subject: Re: BooleanQuery TooManyClauses in wildcard search
In-Reply-To: <47505F66.40506@propylon.com>
MIME-Version: 1.0
Content-Type: multipart/alternative; 
	boundary="----=_Part_675_17010704.1196453490845"
References: <191027.77244.qm@web57303.mail.re1.yahoo.com>
	 <47505F66.40506@propylon.com>
X-Virus-Checked: Checked by ClamAV on apache.org

------=_Part_675_17010704.1196453490845
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

John's answer is spot-on. There's a wealth of information in the user group
archives that you should be able to search on discussing ways of providing
the functionality. One thread titled "I just don't get wildcards at all"
is one where the folks who know generously helped me out.

Once you find out how to search for that you'll know you're in the right
place.
Here's the searchable archive.....

http://www.gossamer-threads.com/lists/engine?do=search;search_forum=forum_2;;list=lucene

Make sure you select the "java user" from the top drop-down labeled
"Search".

Best
Erick

On Nov 30, 2007 2:07 PM, John Byrne <john.byrne@propylon.com> wrote:

> Hi,
>
> Your problem is that when you do a wildacrd search, Lucene expands the
> wildacrd term into all possible terms. So, searching for "stat*"
> produces a list of terms like "state", "states", "stating" etc. (It only
> uses terms that actually occur in your index, however). These terms are
> all added as OR clauses of a boolean query.
>
> The thing is, be defult, there is a limit of 1024 caluses for a boolean
> query. If yuor wildacrd term expands into more than this, (which happens
> very easily), you get that exception you described. You can solve the
> issues by setting the maximum clause count yourself, using
>
> BooleanQuery.setMaxClauseCount(int maxClauseCount)
>
> See
>
> http://lucene.zones.apache.org:8080/hudson/job/Lucene-Nightly/javadoc/core/index.html
> for mroe info.
>
> Bear in mind that putting a wildcard near the start of the term results
> in a large number of boolean clauses, which increases memory usage. This
> is the reason for the default limit. This limit will also affect fuzzy
> queries, because they are expanded in the same way.
>
> Regards,
> JB
>
> Ruchi Thakur wrote:
> >
> >   Hi there.
> > I am a new Lucene user and I have been searching the group archives but
> couldn't solve the problem. I have just joined a project that uses Lucene.
> > We use the StandardAnalyzer for indexing our documents and our query is
> as
> > follows when we issue a search string of    t*      for example:
> >   +t* +cont_type:pa
> >
> >   We get an Exception when we issue some of our wildcard text searches
> we get following Exception
> >   org.apache.lucene.search.BooleanQuery$TooManyClauses Exception : Max
> clause if 1024
> >
> >   Please suggest.
> >
> >   Regards,
> >   Ruchi
> >
> >
> >
> >
> >
> >
> >
> >
> > ---------------------------------
> > Never miss a thing.   Make Yahoo your homepage.
> >
> > ------------------------------------------------------------------------
> >
> > No virus found in this incoming message.
> > Checked by AVG Free Edition.
> > Version: 7.5.503 / Virus Database: 269.16.11/1161 - Release Date:
> 30/11/2007 12:12
> >
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
>
>

------=_Part_675_17010704.1196453490845--

